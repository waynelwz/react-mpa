import{r as Bv,p as z0,c as To,a as Kc,g as F0,j as bc,B as O0,_ as B0}from"./index.b910b3a2.js";var Nv={},Uv={};(function(Zo){function Au(m){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Au=function(_){return typeof _}:Au=function(_){return _&&typeof Symbol=="function"&&_.constructor===Symbol&&_!==Symbol.prototype?"symbol":typeof _},Au(m)}Object.defineProperty(Zo,"__esModule",{value:!0}),Zo.default=h;var d=v(Bv.exports),ee=te(z0.exports);function te(m){return m&&m.__esModule?m:{default:m}}function w(){if(typeof WeakMap!="function")return null;var m=new WeakMap;return w=function(){return m},m}function v(m){if(m&&m.__esModule)return m;if(m===null||Au(m)!=="object"&&typeof m!="function")return{default:m};var u=w();if(u&&u.has(m))return u.get(m);var _={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var A in m)if(Object.prototype.hasOwnProperty.call(m,A)){var b=s?Object.getOwnPropertyDescriptor(m,A):null;b&&(b.get||b.set)?Object.defineProperty(_,A,b):_[A]=m[A]}return _.default=m,u&&u.set(m,_),_}function S(m,u){if(!(m instanceof u))throw new TypeError("Cannot call a class as a function")}function M(m,u){for(var _=0;_<u.length;_++){var s=u[_];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(m,s.key,s)}}function e(m,u,_){return u&&M(m.prototype,u),_&&M(m,_),m}function a(m,u){if(typeof u!="function"&&u!==null)throw new TypeError("Super expression must either be null or a function");m.prototype=Object.create(u&&u.prototype,{constructor:{value:m,writable:!0,configurable:!0}}),u&&n(m,u)}function n(m,u){return n=Object.setPrototypeOf||function(s,A){return s.__proto__=A,s},n(m,u)}function r(m){var u=o();return function(){var s=i(m),A;if(u){var b=i(this).constructor;A=Reflect.construct(s,arguments,b)}else A=s.apply(this,arguments);return t(this,A)}}function t(m,u){return u&&(Au(u)==="object"||typeof u=="function")?u:c(m)}function c(m){if(m===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return m}function o(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function i(m){return i=Object.setPrototypeOf?Object.getPrototypeOf:function(_){return _.__proto__||Object.getPrototypeOf(_)},i(m)}var y=["AfterExport","AfterPlot","Animated","AnimatingFrame","AnimationInterrupted","AutoSize","BeforeExport","BeforeHover","ButtonClicked","Click","ClickAnnotation","Deselect","DoubleClick","Framework","Hover","LegendClick","LegendDoubleClick","Relayout","Relayouting","Restyle","Redraw","Selected","Selecting","SliderChange","SliderEnd","SliderStart","SunburstClick","Transitioning","TransitionInterrupted","Unhover"],p=["plotly_restyle","plotly_redraw","plotly_relayout","plotly_relayouting","plotly_doubleclick","plotly_animated","plotly_sunburstclick"],g=typeof window<"u";function h(m){var u=function(_){a(A,_);var s=r(A);function A(b){var f;return S(this,A),f=s.call(this,b),f.p=Promise.resolve(),f.resizeHandler=null,f.handlers={},f.syncWindowResize=f.syncWindowResize.bind(c(f)),f.syncEventHandlers=f.syncEventHandlers.bind(c(f)),f.attachUpdateEvents=f.attachUpdateEvents.bind(c(f)),f.getRef=f.getRef.bind(c(f)),f.handleUpdate=f.handleUpdate.bind(c(f)),f.figureCallback=f.figureCallback.bind(c(f)),f.updatePlotly=f.updatePlotly.bind(c(f)),f}return e(A,[{key:"updatePlotly",value:function(f,x,l){var L=this;this.p=this.p.then(function(){if(!L.unmounting){if(!L.el)throw new Error("Missing element reference");return m.react(L.el,{data:L.props.data,layout:L.props.layout,config:L.props.config,frames:L.props.frames})}}).then(function(){L.unmounting||(L.syncWindowResize(f),L.syncEventHandlers(),L.figureCallback(x),l&&L.attachUpdateEvents())}).catch(function(T){L.props.onError&&L.props.onError(T)})}},{key:"componentDidMount",value:function(){this.unmounting=!1,this.updatePlotly(!0,this.props.onInitialized,!0)}},{key:"componentDidUpdate",value:function(f){this.unmounting=!1;var x=f.frames&&f.frames.length?f.frames.length:0,l=this.props.frames&&this.props.frames.length?this.props.frames.length:0,L=!(f.layout===this.props.layout&&f.data===this.props.data&&f.config===this.props.config&&l===x),T=f.revision!==void 0,k=f.revision!==this.props.revision;!L&&(!T||T&&!k)||this.updatePlotly(!1,this.props.onUpdate,!1)}},{key:"componentWillUnmount",value:function(){this.unmounting=!0,this.figureCallback(this.props.onPurge),this.resizeHandler&&g&&(window.removeEventListener("resize",this.resizeHandler),this.resizeHandler=null),this.removeUpdateEvents(),m.purge(this.el)}},{key:"attachUpdateEvents",value:function(){var f=this;!this.el||!this.el.removeListener||p.forEach(function(x){f.el.on(x,f.handleUpdate)})}},{key:"removeUpdateEvents",value:function(){var f=this;!this.el||!this.el.removeListener||p.forEach(function(x){f.el.removeListener(x,f.handleUpdate)})}},{key:"handleUpdate",value:function(){this.figureCallback(this.props.onUpdate)}},{key:"figureCallback",value:function(f){if(typeof f=="function"){var x=this.el,l=x.data,L=x.layout,T=this.el._transitionData?this.el._transitionData._frames:null,k={data:l,layout:L,frames:T};f(k,this.el)}}},{key:"syncWindowResize",value:function(f){var x=this;!g||(this.props.useResizeHandler&&!this.resizeHandler?(this.resizeHandler=function(){return m.Plots.resize(x.el)},window.addEventListener("resize",this.resizeHandler),f&&this.resizeHandler()):!this.props.useResizeHandler&&this.resizeHandler&&(window.removeEventListener("resize",this.resizeHandler),this.resizeHandler=null))}},{key:"getRef",value:function(f){this.el=f,this.props.debug&&g&&(window.gd=this.el)}},{key:"syncEventHandlers",value:function(){var f=this;y.forEach(function(x){var l=f.props["on"+x],L=f.handlers[x],T=Boolean(L);l&&!T?f.addEventHandler(x,l):!l&&T?f.removeEventHandler(x):l&&T&&l!==L&&(f.removeEventHandler(x),f.addEventHandler(x,l))})}},{key:"addEventHandler",value:function(f,x){this.handlers[f]=x,this.el.on(this.getPlotlyEventName(f),this.handlers[f])}},{key:"removeEventHandler",value:function(f){this.el.removeListener(this.getPlotlyEventName(f),this.handlers[f]),delete this.handlers[f]}},{key:"getPlotlyEventName",value:function(f){return"plotly_"+f.toLowerCase()}},{key:"render",value:function(){return d.default.createElement("div",{id:this.props.divId,style:this.props.style,ref:this.getRef,className:this.props.className})}}]),A}(d.Component);return u.propTypes={data:ee.default.arrayOf(ee.default.object),config:ee.default.object,layout:ee.default.object,frames:ee.default.arrayOf(ee.default.object),revision:ee.default.number,onInitialized:ee.default.func,onPurge:ee.default.func,onError:ee.default.func,onUpdate:ee.default.func,debug:ee.default.bool,style:ee.default.object,className:ee.default.string,useResizeHandler:ee.default.bool,divId:ee.default.string},y.forEach(function(_){u.propTypes["on"+_]=ee.default.func}),u.defaultProps={debug:!1,useResizeHandler:!1,data:[],style:{position:"relative",display:"inline-block"}},u}})(Uv);var Hv={exports:{}};(function(Zo,Au){(function(d){Zo.exports=d()})(function(){return function(){function d(ee,te,w){function v(e,a){if(!te[e]){if(!ee[e]){var n=typeof Kc=="function"&&Kc;if(!a&&n)return n(e,!0);if(S)return S(e,!0);var r=new Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}var t=te[e]={exports:{}};ee[e][0].call(t.exports,function(c){var o=ee[e][1][c];return v(o||c)},t,t.exports,d,ee,te,w)}return te[e].exports}for(var S=typeof Kc=="function"&&Kc,M=0;M<w.length;M++)v(w[M]);return v}return d}()({1:[function(d,ee,te){var w=d("../src/lib"),v={"X,X div":'direction:ltr;font-family:"Open Sans",verdana,arial,sans-serif;margin:0;padding:0;',"X input,X button":'font-family:"Open Sans",verdana,arial,sans-serif;',"X input:focus,X button:focus":"outline:none;","X a":"text-decoration:none;","X a:hover":"text-decoration:none;","X .crisp":"shape-rendering:crispEdges;","X .user-select-none":"-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;-o-user-select:none;user-select:none;","X svg":"overflow:hidden;","X svg a":"fill:#447adb;","X svg a:hover":"fill:#3c6dc5;","X .main-svg":"position:absolute;top:0;left:0;pointer-events:none;","X .main-svg .draglayer":"pointer-events:all;","X .cursor-default":"cursor:default;","X .cursor-pointer":"cursor:pointer;","X .cursor-crosshair":"cursor:crosshair;","X .cursor-move":"cursor:move;","X .cursor-col-resize":"cursor:col-resize;","X .cursor-row-resize":"cursor:row-resize;","X .cursor-ns-resize":"cursor:ns-resize;","X .cursor-ew-resize":"cursor:ew-resize;","X .cursor-sw-resize":"cursor:sw-resize;","X .cursor-s-resize":"cursor:s-resize;","X .cursor-se-resize":"cursor:se-resize;","X .cursor-w-resize":"cursor:w-resize;","X .cursor-e-resize":"cursor:e-resize;","X .cursor-nw-resize":"cursor:nw-resize;","X .cursor-n-resize":"cursor:n-resize;","X .cursor-ne-resize":"cursor:ne-resize;","X .cursor-grab":"cursor:-webkit-grab;cursor:grab;","X .modebar":"position:absolute;top:2px;right:2px;","X .ease-bg":"-webkit-transition:background-color .3s ease 0s;-moz-transition:background-color .3s ease 0s;-ms-transition:background-color .3s ease 0s;-o-transition:background-color .3s ease 0s;transition:background-color .3s ease 0s;","X .modebar--hover>:not(.watermark)":"opacity:0;-webkit-transition:opacity .3s ease 0s;-moz-transition:opacity .3s ease 0s;-ms-transition:opacity .3s ease 0s;-o-transition:opacity .3s ease 0s;transition:opacity .3s ease 0s;","X:hover .modebar--hover .modebar-group":"opacity:1;","X .modebar-group":"float:left;display:inline-block;box-sizing:border-box;padding-left:8px;position:relative;vertical-align:middle;white-space:nowrap;","X .modebar-btn":"position:relative;font-size:16px;padding:3px 4px;height:22px;cursor:pointer;line-height:normal;box-sizing:border-box;","X .modebar-btn svg":"position:relative;top:2px;","X .modebar.vertical":"display:flex;flex-direction:column;flex-wrap:wrap;align-content:flex-end;max-height:100%;","X .modebar.vertical svg":"top:-1px;","X .modebar.vertical .modebar-group":"display:block;float:none;padding-left:0px;padding-bottom:8px;","X .modebar.vertical .modebar-group .modebar-btn":"display:block;text-align:center;","X [data-title]:before,X [data-title]:after":"position:absolute;-webkit-transform:translate3d(0, 0, 0);-moz-transform:translate3d(0, 0, 0);-ms-transform:translate3d(0, 0, 0);-o-transform:translate3d(0, 0, 0);transform:translate3d(0, 0, 0);display:none;opacity:0;z-index:1001;pointer-events:none;top:110%;right:50%;","X [data-title]:hover:before,X [data-title]:hover:after":"display:block;opacity:1;","X [data-title]:before":'content:"";position:absolute;background:rgba(0,0,0,0);border:6px solid rgba(0,0,0,0);z-index:1002;margin-top:-12px;border-bottom-color:#69738a;margin-right:-6px;',"X [data-title]:after":"content:attr(data-title);background:#69738a;color:#fff;padding:8px 10px;font-size:12px;line-height:12px;white-space:nowrap;margin-right:-18px;border-radius:2px;","X .vertical [data-title]:before,X .vertical [data-title]:after":"top:0%;right:200%;","X .vertical [data-title]:before":"border:6px solid rgba(0,0,0,0);border-left-color:#69738a;margin-top:8px;margin-right:-30px;",Y:'font-family:"Open Sans",verdana,arial,sans-serif;position:fixed;top:50px;right:20px;z-index:10000;font-size:10pt;max-width:180px;',"Y p":"margin:0;","Y .notifier-note":"min-width:180px;max-width:250px;border:1px solid #fff;z-index:3000;margin:0;background-color:#8c97af;background-color:rgba(140,151,175,.9);color:#fff;padding:10px;overflow-wrap:break-word;word-wrap:break-word;-ms-hyphens:auto;-webkit-hyphens:auto;hyphens:auto;","Y .notifier-close":"color:#fff;opacity:.8;float:right;padding:0 5px;background:none;border:none;font-size:20px;font-weight:bold;line-height:20px;","Y .notifier-close:hover":"color:#444;text-decoration:none;cursor:pointer;"};for(var S in v){var M=S.replace(/^,/," ,").replace(/X/g,".js-plotly-plot .plotly").replace(/Y/g,".plotly-notifier");w.addStyleRule(M,v[S])}},{"../src/lib":515}],2:[function(d,ee,te){ee.exports=d("../src/transforms/aggregate")},{"../src/transforms/aggregate":1127}],3:[function(d,ee,te){ee.exports=d("../src/traces/bar")},{"../src/traces/bar":665}],4:[function(d,ee,te){ee.exports=d("../src/traces/barpolar")},{"../src/traces/barpolar":678}],5:[function(d,ee,te){ee.exports=d("../src/traces/box")},{"../src/traces/box":688}],6:[function(d,ee,te){ee.exports=d("../src/components/calendars")},{"../src/components/calendars":365}],7:[function(d,ee,te){ee.exports=d("../src/traces/candlestick")},{"../src/traces/candlestick":697}],8:[function(d,ee,te){ee.exports=d("../src/traces/carpet")},{"../src/traces/carpet":716}],9:[function(d,ee,te){ee.exports=d("../src/traces/choropleth")},{"../src/traces/choropleth":730}],10:[function(d,ee,te){ee.exports=d("../src/traces/choroplethmapbox")},{"../src/traces/choroplethmapbox":737}],11:[function(d,ee,te){ee.exports=d("../src/traces/cone")},{"../src/traces/cone":743}],12:[function(d,ee,te){ee.exports=d("../src/traces/contour")},{"../src/traces/contour":758}],13:[function(d,ee,te){ee.exports=d("../src/traces/contourcarpet")},{"../src/traces/contourcarpet":769}],14:[function(d,ee,te){ee.exports=d("../src/core")},{"../src/core":493}],15:[function(d,ee,te){ee.exports=d("../src/traces/densitymapbox")},{"../src/traces/densitymapbox":777}],16:[function(d,ee,te){ee.exports=d("../src/transforms/filter")},{"../src/transforms/filter":1128}],17:[function(d,ee,te){ee.exports=d("../src/traces/funnel")},{"../src/traces/funnel":787}],18:[function(d,ee,te){ee.exports=d("../src/traces/funnelarea")},{"../src/traces/funnelarea":796}],19:[function(d,ee,te){ee.exports=d("../src/transforms/groupby")},{"../src/transforms/groupby":1129}],20:[function(d,ee,te){ee.exports=d("../src/traces/heatmap")},{"../src/traces/heatmap":809}],21:[function(d,ee,te){ee.exports=d("../src/traces/heatmapgl")},{"../src/traces/heatmapgl":820}],22:[function(d,ee,te){ee.exports=d("../src/traces/histogram")},{"../src/traces/histogram":832}],23:[function(d,ee,te){ee.exports=d("../src/traces/histogram2d")},{"../src/traces/histogram2d":838}],24:[function(d,ee,te){ee.exports=d("../src/traces/histogram2dcontour")},{"../src/traces/histogram2dcontour":842}],25:[function(d,ee,te){ee.exports=d("../src/traces/icicle")},{"../src/traces/icicle":848}],26:[function(d,ee,te){ee.exports=d("../src/traces/image")},{"../src/traces/image":861}],27:[function(d,ee,te){var w=d("./core");w.register([d("./bar"),d("./box"),d("./heatmap"),d("./histogram"),d("./histogram2d"),d("./histogram2dcontour"),d("./contour"),d("./scatterternary"),d("./violin"),d("./funnel"),d("./waterfall"),d("./image"),d("./pie"),d("./sunburst"),d("./treemap"),d("./icicle"),d("./funnelarea"),d("./scatter3d"),d("./surface"),d("./isosurface"),d("./volume"),d("./mesh3d"),d("./cone"),d("./streamtube"),d("./scattergeo"),d("./choropleth"),d("./scattergl"),d("./splom"),d("./pointcloud"),d("./heatmapgl"),d("./parcoords"),d("./parcats"),d("./scattermapbox"),d("./choroplethmapbox"),d("./densitymapbox"),d("./sankey"),d("./indicator"),d("./table"),d("./carpet"),d("./scattercarpet"),d("./contourcarpet"),d("./ohlc"),d("./candlestick"),d("./scatterpolar"),d("./scatterpolargl"),d("./barpolar"),d("./scattersmith"),d("./aggregate"),d("./filter"),d("./groupby"),d("./sort"),d("./calendars")]),ee.exports=w},{"./aggregate":2,"./bar":3,"./barpolar":4,"./box":5,"./calendars":6,"./candlestick":7,"./carpet":8,"./choropleth":9,"./choroplethmapbox":10,"./cone":11,"./contour":12,"./contourcarpet":13,"./core":14,"./densitymapbox":15,"./filter":16,"./funnel":17,"./funnelarea":18,"./groupby":19,"./heatmap":20,"./heatmapgl":21,"./histogram":22,"./histogram2d":23,"./histogram2dcontour":24,"./icicle":25,"./image":26,"./indicator":28,"./isosurface":29,"./mesh3d":30,"./ohlc":31,"./parcats":32,"./parcoords":33,"./pie":34,"./pointcloud":35,"./sankey":36,"./scatter3d":37,"./scattercarpet":38,"./scattergeo":39,"./scattergl":40,"./scattermapbox":41,"./scatterpolar":42,"./scatterpolargl":43,"./scattersmith":44,"./scatterternary":45,"./sort":46,"./splom":47,"./streamtube":48,"./sunburst":49,"./surface":50,"./table":51,"./treemap":52,"./violin":53,"./volume":54,"./waterfall":55}],28:[function(d,ee,te){ee.exports=d("../src/traces/indicator")},{"../src/traces/indicator":869}],29:[function(d,ee,te){ee.exports=d("../src/traces/isosurface")},{"../src/traces/isosurface":875}],30:[function(d,ee,te){ee.exports=d("../src/traces/mesh3d")},{"../src/traces/mesh3d":880}],31:[function(d,ee,te){ee.exports=d("../src/traces/ohlc")},{"../src/traces/ohlc":885}],32:[function(d,ee,te){ee.exports=d("../src/traces/parcats")},{"../src/traces/parcats":894}],33:[function(d,ee,te){ee.exports=d("../src/traces/parcoords")},{"../src/traces/parcoords":905}],34:[function(d,ee,te){ee.exports=d("../src/traces/pie")},{"../src/traces/pie":916}],35:[function(d,ee,te){ee.exports=d("../src/traces/pointcloud")},{"../src/traces/pointcloud":925}],36:[function(d,ee,te){ee.exports=d("../src/traces/sankey")},{"../src/traces/sankey":931}],37:[function(d,ee,te){ee.exports=d("../src/traces/scatter3d")},{"../src/traces/scatter3d":969}],38:[function(d,ee,te){ee.exports=d("../src/traces/scattercarpet")},{"../src/traces/scattercarpet":976}],39:[function(d,ee,te){ee.exports=d("../src/traces/scattergeo")},{"../src/traces/scattergeo":984}],40:[function(d,ee,te){ee.exports=d("../src/traces/scattergl")},{"../src/traces/scattergl":998}],41:[function(d,ee,te){ee.exports=d("../src/traces/scattermapbox")},{"../src/traces/scattermapbox":1008}],42:[function(d,ee,te){ee.exports=d("../src/traces/scatterpolar")},{"../src/traces/scatterpolar":1016}],43:[function(d,ee,te){ee.exports=d("../src/traces/scatterpolargl")},{"../src/traces/scatterpolargl":1024}],44:[function(d,ee,te){ee.exports=d("../src/traces/scattersmith")},{"../src/traces/scattersmith":1031}],45:[function(d,ee,te){ee.exports=d("../src/traces/scatterternary")},{"../src/traces/scatterternary":1039}],46:[function(d,ee,te){ee.exports=d("../src/transforms/sort")},{"../src/transforms/sort":1131}],47:[function(d,ee,te){ee.exports=d("../src/traces/splom")},{"../src/traces/splom":1049}],48:[function(d,ee,te){ee.exports=d("../src/traces/streamtube")},{"../src/traces/streamtube":1057}],49:[function(d,ee,te){ee.exports=d("../src/traces/sunburst")},{"../src/traces/sunburst":1065}],50:[function(d,ee,te){ee.exports=d("../src/traces/surface")},{"../src/traces/surface":1074}],51:[function(d,ee,te){ee.exports=d("../src/traces/table")},{"../src/traces/table":1082}],52:[function(d,ee,te){ee.exports=d("../src/traces/treemap")},{"../src/traces/treemap":1093}],53:[function(d,ee,te){ee.exports=d("../src/traces/violin")},{"../src/traces/violin":1106}],54:[function(d,ee,te){ee.exports=d("../src/traces/volume")},{"../src/traces/volume":1114}],55:[function(d,ee,te){ee.exports=d("../src/traces/waterfall")},{"../src/traces/waterfall":1122}],56:[function(d,ee,te){(function(w,v){typeof te=="object"&&typeof ee<"u"?v(te,d("d3-array"),d("d3-collection"),d("d3-shape"),d("elementary-circuits-directed-graph")):v(w.d3=w.d3||{},w.d3,w.d3,w.d3,null)})(this,function(w,v,S,M,e){e=e&&e.hasOwnProperty("default")?e.default:e;function a(ue){return ue.target.depth}function n(ue){return ue.depth}function r(ue,pe){return pe-1-ue.height}function t(ue,pe){return ue.sourceLinks.length?ue.depth:pe-1}function c(ue){return ue.targetLinks.length?ue.depth:ue.sourceLinks.length?v.min(ue.sourceLinks,a)-1:0}function o(ue){return function(){return ue}}var i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(ue){return typeof ue}:function(ue){return ue&&typeof Symbol=="function"&&ue.constructor===Symbol&&ue!==Symbol.prototype?"symbol":typeof ue};function y(ue,pe){return g(ue.source,pe.source)||ue.index-pe.index}function p(ue,pe){return g(ue.target,pe.target)||ue.index-pe.index}function g(ue,pe){return ue.partOfCycle===pe.partOfCycle?ue.y0-pe.y0:ue.circularLinkType==="top"||pe.circularLinkType==="bottom"?-1:1}function h(ue){return ue.value}function m(ue){return(ue.y0+ue.y1)/2}function u(ue){return m(ue.source)}function _(ue){return m(ue.target)}function s(ue){return ue.index}function A(ue){return ue.nodes}function b(ue){return ue.links}function f(ue,pe){var ge=ue.get(pe);if(!ge)throw new Error("missing: "+pe);return ge}function x(ue,pe){return pe(ue)}var l=25,L=10,T=.3;function k(){var ue=0,pe=0,ge=1,Te=1,_e=24,ze,Oe=s,Ye=t,be=A,Pe=b,Ge=32,Qe=2,Be,Le=null;function He(){var kt={nodes:be.apply(null,arguments),links:Pe.apply(null,arguments)};vt(kt),P(kt,Oe,Le),Rt(kt),Ft(kt),z(kt,Oe),Gt(kt,Ge,Oe),Dt(kt);for(var Ue=4,qe=0;qe<Ue;qe++)K(kt,Te,Oe),ne(kt,Te,Oe),q(kt,pe,Te,Oe),K(kt,Te,Oe),ne(kt,Te,Oe);return ye(kt,pe,Te),H(kt,Qe,Te,Oe),kt}He.nodeId=function(kt){return arguments.length?(Oe=typeof kt=="function"?kt:o(kt),He):Oe},He.nodeAlign=function(kt){return arguments.length?(Ye=typeof kt=="function"?kt:o(kt),He):Ye},He.nodeWidth=function(kt){return arguments.length?(_e=+kt,He):_e},He.nodePadding=function(kt){return arguments.length?(ze=+kt,He):ze},He.nodes=function(kt){return arguments.length?(be=typeof kt=="function"?kt:o(kt),He):be},He.links=function(kt){return arguments.length?(Pe=typeof kt=="function"?kt:o(kt),He):Pe},He.size=function(kt){return arguments.length?(ue=pe=0,ge=+kt[0],Te=+kt[1],He):[ge-ue,Te-pe]},He.extent=function(kt){return arguments.length?(ue=+kt[0][0],ge=+kt[1][0],pe=+kt[0][1],Te=+kt[1][1],He):[[ue,pe],[ge,Te]]},He.iterations=function(kt){return arguments.length?(Ge=+kt,He):Ge},He.circularLinkGap=function(kt){return arguments.length?(Qe=+kt,He):Qe},He.nodePaddingRatio=function(kt){return arguments.length?(Be=+kt,He):Be},He.sortNodes=function(kt){return arguments.length?(Le=kt,He):Le},He.update=function(kt){return z(kt,Oe),Dt(kt),kt.links.forEach(function(Ue){Ue.circular&&(Ue.circularLinkType=Ue.y0+Ue.y1<Te?"top":"bottom",Ue.source.circularLinkType=Ue.circularLinkType,Ue.target.circularLinkType=Ue.circularLinkType)}),K(kt,Te,Oe,!1),ne(kt,Te,Oe),H(kt,Qe,Te,Oe),kt};function vt(kt){kt.nodes.forEach(function(qe,Ve){qe.index=Ve,qe.sourceLinks=[],qe.targetLinks=[]});var Ue=S.map(kt.nodes,Oe);return kt.links.forEach(function(qe,Ve){qe.index=Ve;var Ae=qe.source,Ne=qe.target;(typeof Ae>"u"?"undefined":i(Ae))!=="object"&&(Ae=qe.source=f(Ue,Ae)),(typeof Ne>"u"?"undefined":i(Ne))!=="object"&&(Ne=qe.target=f(Ue,Ne)),Ae.sourceLinks.push(qe),Ne.targetLinks.push(qe)}),kt}function Rt(kt){kt.nodes.forEach(function(Ue){Ue.partOfCycle=!1,Ue.value=Math.max(v.sum(Ue.sourceLinks,h),v.sum(Ue.targetLinks,h)),Ue.sourceLinks.forEach(function(qe){qe.circular&&(Ue.partOfCycle=!0,Ue.circularLinkType=qe.circularLinkType)}),Ue.targetLinks.forEach(function(qe){qe.circular&&(Ue.partOfCycle=!0,Ue.circularLinkType=qe.circularLinkType)})})}function rr(kt){var Ue=0,qe=0,Ve=0,Ae=0,Ne=v.max(kt.nodes,function(Xe){return Xe.column});return kt.links.forEach(function(Xe){Xe.circular&&(Xe.circularLinkType=="top"?Ue=Ue+Xe.width:qe=qe+Xe.width,Xe.target.column==0&&(Ae=Ae+Xe.width),Xe.source.column==Ne&&(Ve=Ve+Xe.width))}),Ue=Ue>0?Ue+l+L:Ue,qe=qe>0?qe+l+L:qe,Ve=Ve>0?Ve+l+L:Ve,Ae=Ae>0?Ae+l+L:Ae,{top:Ue,bottom:qe,left:Ae,right:Ve}}function Lt(kt,Ue){var qe=v.max(kt.nodes,function(mt){return mt.column}),Ve=ge-ue,Ae=Te-pe,Ne=Ve+Ue.right+Ue.left,Xe=Ae+Ue.top+Ue.bottom,Je=Ve/Ne,_t=Ae/Xe;return ue=ue*Je+Ue.left,ge=Ue.right==0?ge:ge*Je,pe=pe*_t+Ue.top,Te=Te*_t,kt.nodes.forEach(function(mt){mt.x0=ue+mt.column*((ge-ue-_e)/qe),mt.x1=mt.x0+_e}),_t}function Ft(kt){var Ue,qe,Ve;for(Ue=kt.nodes,qe=[],Ve=0;Ue.length;++Ve,Ue=qe,qe=[])Ue.forEach(function(Ae){Ae.depth=Ve,Ae.sourceLinks.forEach(function(Ne){qe.indexOf(Ne.target)<0&&!Ne.circular&&qe.push(Ne.target)})});for(Ue=kt.nodes,qe=[],Ve=0;Ue.length;++Ve,Ue=qe,qe=[])Ue.forEach(function(Ae){Ae.height=Ve,Ae.targetLinks.forEach(function(Ne){qe.indexOf(Ne.source)<0&&!Ne.circular&&qe.push(Ne.source)})});kt.nodes.forEach(function(Ae){Ae.column=Math.floor(Ye.call(null,Ae,Ve))})}function Gt(kt,Ue,qe){var Ve=S.nest().key(function(mt){return mt.column}).sortKeys(v.ascending).entries(kt.nodes).map(function(mt){return mt.values});Xe(qe),_t();for(var Ae=1,Ne=Ue;Ne>0;--Ne)Je(Ae*=.99,qe),_t();function Xe(mt){if(Be){var Ot=1/0;Ve.forEach(function(qt){var Yt=Te*Be/(qt.length+1);Ot=Yt<Ot?Yt:Ot}),ze=Ot}var Kt=v.min(Ve,function(qt){return(Te-pe-(qt.length-1)*ze)/v.sum(qt,h)});Kt=Kt*T,kt.links.forEach(function(qt){qt.width=qt.value*Kt});var Nt=rr(kt),Wt=Lt(kt,Nt);Kt=Kt*Wt,kt.links.forEach(function(qt){qt.width=qt.value*Kt}),Ve.forEach(function(qt){var Yt=qt.length;qt.forEach(function(fr,Yr){fr.depth==Ve.length-1&&Yt==1||fr.depth==0&&Yt==1?(fr.y0=Te/2-fr.value*Kt,fr.y1=fr.y0+fr.value*Kt):fr.partOfCycle?R(fr,mt)==0?(fr.y0=Te/2+Yr,fr.y1=fr.y0+fr.value*Kt):fr.circularLinkType=="top"?(fr.y0=pe+Yr,fr.y1=fr.y0+fr.value*Kt):(fr.y0=Te-fr.value*Kt-Yr,fr.y1=fr.y0+fr.value*Kt):Nt.top==0||Nt.bottom==0?(fr.y0=(Te-pe)/Yt*Yr,fr.y1=fr.y0+fr.value*Kt):(fr.y0=(Te-pe)/2-Yt/2+Yr,fr.y1=fr.y0+fr.value*Kt)})})}function Je(mt,Ot){var Kt=Ve.length;Ve.forEach(function(Nt){var Wt=Nt.length,qt=Nt[0].depth;Nt.forEach(function(Yt){var fr;if((Yt.sourceLinks.length||Yt.targetLinks.length)&&!(Yt.partOfCycle&&R(Yt,Ot)>0))if(qt==0&&Wt==1)fr=Yt.y1-Yt.y0,Yt.y0=Te/2-fr/2,Yt.y1=Te/2+fr/2;else if(qt==Kt-1&&Wt==1)fr=Yt.y1-Yt.y0,Yt.y0=Te/2-fr/2,Yt.y1=Te/2+fr/2;else{var Yr=0,hn=v.mean(Yt.sourceLinks,_),Qr=v.mean(Yt.targetLinks,u);hn&&Qr?Yr=(hn+Qr)/2:Yr=hn||Qr;var at=(Yr-m(Yt))*mt;Yt.y0+=at,Yt.y1+=at}})})}function _t(){Ve.forEach(function(mt){var Ot,Kt,Nt=pe,Wt=mt.length,qt;for(mt.sort(g),qt=0;qt<Wt;++qt)Ot=mt[qt],Kt=Nt-Ot.y0,Kt>0&&(Ot.y0+=Kt,Ot.y1+=Kt),Nt=Ot.y1+ze;if(Kt=Nt-ze-Te,Kt>0)for(Nt=Ot.y0-=Kt,Ot.y1-=Kt,qt=Wt-2;qt>=0;--qt)Ot=mt[qt],Kt=Ot.y1+ze-Nt,Kt>0&&(Ot.y0-=Kt,Ot.y1-=Kt),Nt=Ot.y0})}}function Dt(kt){kt.nodes.forEach(function(Ue){Ue.sourceLinks.sort(p),Ue.targetLinks.sort(y)}),kt.nodes.forEach(function(Ue){var qe=Ue.y0,Ve=qe,Ae=Ue.y1,Ne=Ae;Ue.sourceLinks.forEach(function(Xe){Xe.circular?(Xe.y0=Ae-Xe.width/2,Ae=Ae-Xe.width):(Xe.y0=qe+Xe.width/2,qe+=Xe.width)}),Ue.targetLinks.forEach(function(Xe){Xe.circular?(Xe.y1=Ne-Xe.width/2,Ne=Ne-Xe.width):(Xe.y1=Ve+Xe.width/2,Ve+=Xe.width)})})}return He}function P(ue,pe,ge){var Te=0;if(ge===null){for(var _e=[],ze=0;ze<ue.links.length;ze++){var Oe=ue.links[ze],Ye=Oe.source.index,be=Oe.target.index;_e[Ye]||(_e[Ye]=[]),_e[be]||(_e[be]=[]),_e[Ye].indexOf(be)===-1&&_e[Ye].push(be)}var Pe=e(_e);Pe.sort(function(Le,He){return Le.length-He.length});var Ge={};for(ze=0;ze<Pe.length;ze++){var Qe=Pe[ze],Be=Qe.slice(-2);Ge[Be[0]]||(Ge[Be[0]]={}),Ge[Be[0]][Be[1]]=!0}ue.links.forEach(function(Le){var He=Le.target.index,vt=Le.source.index;He===vt||Ge[vt]&&Ge[vt][He]?(Le.circular=!0,Le.circularLinkID=Te,Te=Te+1):Le.circular=!1})}else ue.links.forEach(function(Le){Le.source[ge]<Le.target[ge]?Le.circular=!1:(Le.circular=!0,Le.circularLinkID=Te,Te=Te+1)})}function z(ue,pe){var ge=0,Te=0;ue.links.forEach(function(_e){_e.circular&&(_e.source.circularLinkType||_e.target.circularLinkType?_e.circularLinkType=_e.source.circularLinkType?_e.source.circularLinkType:_e.target.circularLinkType:_e.circularLinkType=ge<Te?"top":"bottom",_e.circularLinkType=="top"?ge=ge+1:Te=Te+1,ue.nodes.forEach(function(ze){(x(ze,pe)==x(_e.source,pe)||x(ze,pe)==x(_e.target,pe))&&(ze.circularLinkType=_e.circularLinkType)}))}),ue.links.forEach(function(_e){_e.circular&&(_e.source.circularLinkType==_e.target.circularLinkType&&(_e.circularLinkType=_e.source.circularLinkType),le(_e,pe)&&(_e.circularLinkType=_e.source.circularLinkType))})}function I(ue){var pe=Math.abs(ue.y1-ue.y0),ge=Math.abs(ue.target.x0-ue.source.x1);return Math.atan(ge/pe)}function D(ue,pe){return ue.source.column<pe.target.column?!1:!(ue.target.column>pe.source.column)}function R(ue,pe){var ge=0;ue.sourceLinks.forEach(function(_e){ge=_e.circular&&!le(_e,pe)?ge+1:ge});var Te=0;return ue.targetLinks.forEach(function(_e){Te=_e.circular&&!le(_e,pe)?Te+1:Te}),ge+Te}function B(ue){var pe=ue.source.sourceLinks,ge=0;pe.forEach(function(ze){ge=ze.circular?ge+1:ge});var Te=ue.target.targetLinks,_e=0;return Te.forEach(function(ze){_e=ze.circular?_e+1:_e}),!(ge>1||_e>1)}function F(ue,pe,ge){return ue.sort(J),ue.forEach(function(Te,_e){var ze=0;if(le(Te,ge)&&B(Te))Te.circularPathData.verticalBuffer=ze+Te.width/2;else{var Oe=0;for(Oe;Oe<_e;Oe++)if(D(ue[_e],ue[Oe])){var Ye=ue[Oe].circularPathData.verticalBuffer+ue[Oe].width/2+pe;ze=Ye>ze?Ye:ze}Te.circularPathData.verticalBuffer=ze+Te.width/2}}),ue}function H(ue,pe,ge,Te){var _e=5,ze=v.min(ue.links,function(be){return be.source.y0});ue.links.forEach(function(be){be.circular&&(be.circularPathData={})});var Oe=ue.links.filter(function(be){return be.circularLinkType=="top"});F(Oe,pe,Te);var Ye=ue.links.filter(function(be){return be.circularLinkType=="bottom"});F(Ye,pe,Te),ue.links.forEach(function(be){if(be.circular){if(be.circularPathData.arcRadius=be.width+L,be.circularPathData.leftNodeBuffer=_e,be.circularPathData.rightNodeBuffer=_e,be.circularPathData.sourceWidth=be.source.x1-be.source.x0,be.circularPathData.sourceX=be.source.x0+be.circularPathData.sourceWidth,be.circularPathData.targetX=be.target.x0,be.circularPathData.sourceY=be.y0,be.circularPathData.targetY=be.y1,le(be,Te)&&B(be))be.circularPathData.leftSmallArcRadius=L+be.width/2,be.circularPathData.leftLargeArcRadius=L+be.width/2,be.circularPathData.rightSmallArcRadius=L+be.width/2,be.circularPathData.rightLargeArcRadius=L+be.width/2,be.circularLinkType=="bottom"?(be.circularPathData.verticalFullExtent=be.source.y1+l+be.circularPathData.verticalBuffer,be.circularPathData.verticalLeftInnerExtent=be.circularPathData.verticalFullExtent-be.circularPathData.leftLargeArcRadius,be.circularPathData.verticalRightInnerExtent=be.circularPathData.verticalFullExtent-be.circularPathData.rightLargeArcRadius):(be.circularPathData.verticalFullExtent=be.source.y0-l-be.circularPathData.verticalBuffer,be.circularPathData.verticalLeftInnerExtent=be.circularPathData.verticalFullExtent+be.circularPathData.leftLargeArcRadius,be.circularPathData.verticalRightInnerExtent=be.circularPathData.verticalFullExtent+be.circularPathData.rightLargeArcRadius);else{var Pe=be.source.column,Ge=be.circularLinkType,Qe=ue.links.filter(function(He){return He.source.column==Pe&&He.circularLinkType==Ge});be.circularLinkType=="bottom"?Qe.sort(Y):Qe.sort(X);var Be=0;Qe.forEach(function(He,vt){He.circularLinkID==be.circularLinkID&&(be.circularPathData.leftSmallArcRadius=L+be.width/2+Be,be.circularPathData.leftLargeArcRadius=L+be.width/2+vt*pe+Be),Be=Be+He.width}),Pe=be.target.column,Qe=ue.links.filter(function(He){return He.target.column==Pe&&He.circularLinkType==Ge}),be.circularLinkType=="bottom"?Qe.sort(oe):Qe.sort(Z),Be=0,Qe.forEach(function(He,vt){He.circularLinkID==be.circularLinkID&&(be.circularPathData.rightSmallArcRadius=L+be.width/2+Be,be.circularPathData.rightLargeArcRadius=L+be.width/2+vt*pe+Be),Be=Be+He.width}),be.circularLinkType=="bottom"?(be.circularPathData.verticalFullExtent=Math.max(ge,be.source.y1,be.target.y1)+l+be.circularPathData.verticalBuffer,be.circularPathData.verticalLeftInnerExtent=be.circularPathData.verticalFullExtent-be.circularPathData.leftLargeArcRadius,be.circularPathData.verticalRightInnerExtent=be.circularPathData.verticalFullExtent-be.circularPathData.rightLargeArcRadius):(be.circularPathData.verticalFullExtent=ze-l-be.circularPathData.verticalBuffer,be.circularPathData.verticalLeftInnerExtent=be.circularPathData.verticalFullExtent+be.circularPathData.leftLargeArcRadius,be.circularPathData.verticalRightInnerExtent=be.circularPathData.verticalFullExtent+be.circularPathData.rightLargeArcRadius)}be.circularPathData.leftInnerExtent=be.circularPathData.sourceX+be.circularPathData.leftNodeBuffer,be.circularPathData.rightInnerExtent=be.circularPathData.targetX-be.circularPathData.rightNodeBuffer,be.circularPathData.leftFullExtent=be.circularPathData.sourceX+be.circularPathData.leftLargeArcRadius+be.circularPathData.leftNodeBuffer,be.circularPathData.rightFullExtent=be.circularPathData.targetX-be.circularPathData.rightLargeArcRadius-be.circularPathData.rightNodeBuffer}if(be.circular)be.path=G(be);else{var Le=M.linkHorizontal().source(function(He){var vt=He.source.x0+(He.source.x1-He.source.x0),Rt=He.y0;return[vt,Rt]}).target(function(He){var vt=He.target.x0,Rt=He.y1;return[vt,Rt]});be.path=Le(be)}})}function G(ue){var pe="";return ue.circularLinkType=="top"?pe="M"+ue.circularPathData.sourceX+" "+ue.circularPathData.sourceY+" L"+ue.circularPathData.leftInnerExtent+" "+ue.circularPathData.sourceY+" A"+ue.circularPathData.leftLargeArcRadius+" "+ue.circularPathData.leftSmallArcRadius+" 0 0 0 "+ue.circularPathData.leftFullExtent+" "+(ue.circularPathData.sourceY-ue.circularPathData.leftSmallArcRadius)+" L"+ue.circularPathData.leftFullExtent+" "+ue.circularPathData.verticalLeftInnerExtent+" A"+ue.circularPathData.leftLargeArcRadius+" "+ue.circularPathData.leftLargeArcRadius+" 0 0 0 "+ue.circularPathData.leftInnerExtent+" "+ue.circularPathData.verticalFullExtent+" L"+ue.circularPathData.rightInnerExtent+" "+ue.circularPathData.verticalFullExtent+" A"+ue.circularPathData.rightLargeArcRadius+" "+ue.circularPathData.rightLargeArcRadius+" 0 0 0 "+ue.circularPathData.rightFullExtent+" "+ue.circularPathData.verticalRightInnerExtent+" L"+ue.circularPathData.rightFullExtent+" "+(ue.circularPathData.targetY-ue.circularPathData.rightSmallArcRadius)+" A"+ue.circularPathData.rightLargeArcRadius+" "+ue.circularPathData.rightSmallArcRadius+" 0 0 0 "+ue.circularPathData.rightInnerExtent+" "+ue.circularPathData.targetY+" L"+ue.circularPathData.targetX+" "+ue.circularPathData.targetY:pe="M"+ue.circularPathData.sourceX+" "+ue.circularPathData.sourceY+" L"+ue.circularPathData.leftInnerExtent+" "+ue.circularPathData.sourceY+" A"+ue.circularPathData.leftLargeArcRadius+" "+ue.circularPathData.leftSmallArcRadius+" 0 0 1 "+ue.circularPathData.leftFullExtent+" "+(ue.circularPathData.sourceY+ue.circularPathData.leftSmallArcRadius)+" L"+ue.circularPathData.leftFullExtent+" "+ue.circularPathData.verticalLeftInnerExtent+" A"+ue.circularPathData.leftLargeArcRadius+" "+ue.circularPathData.leftLargeArcRadius+" 0 0 1 "+ue.circularPathData.leftInnerExtent+" "+ue.circularPathData.verticalFullExtent+" L"+ue.circularPathData.rightInnerExtent+" "+ue.circularPathData.verticalFullExtent+" A"+ue.circularPathData.rightLargeArcRadius+" "+ue.circularPathData.rightLargeArcRadius+" 0 0 1 "+ue.circularPathData.rightFullExtent+" "+ue.circularPathData.verticalRightInnerExtent+" L"+ue.circularPathData.rightFullExtent+" "+(ue.circularPathData.targetY+ue.circularPathData.rightSmallArcRadius)+" A"+ue.circularPathData.rightLargeArcRadius+" "+ue.circularPathData.rightSmallArcRadius+" 0 0 1 "+ue.circularPathData.rightInnerExtent+" "+ue.circularPathData.targetY+" L"+ue.circularPathData.targetX+" "+ue.circularPathData.targetY,pe}function J(ue,pe){return re(ue)==re(pe)?ue.circularLinkType=="bottom"?Y(ue,pe):X(ue,pe):re(pe)-re(ue)}function X(ue,pe){return ue.y0-pe.y0}function Y(ue,pe){return pe.y0-ue.y0}function Z(ue,pe){return ue.y1-pe.y1}function oe(ue,pe){return pe.y1-ue.y1}function re(ue){return ue.target.column-ue.source.column}function se(ue){return ue.target.x0-ue.source.x1}function N(ue,pe){var ge=I(ue),Te=se(pe)/Math.tan(ge),_e=ie(ue)=="up"?ue.y1+Te:ue.y1-Te;return _e}function U(ue,pe){var ge=I(ue),Te=se(pe)/Math.tan(ge),_e=ie(ue)=="up"?ue.y1-Te:ue.y1+Te;return _e}function q(ue,pe,ge,Te){ue.links.forEach(function(_e){if(!_e.circular&&_e.target.column-_e.source.column>1){var ze=_e.source.column+1,Oe=_e.target.column-1,Ye=1,be=Oe-ze+1;for(Ye=1;ze<=Oe;ze++,Ye++)ue.nodes.forEach(function(Pe){if(Pe.column==ze){var Ge=Ye/(be+1),Qe=Math.pow(1-Ge,3),Be=3*Ge*Math.pow(1-Ge,2),Le=3*Math.pow(Ge,2)*(1-Ge),He=Math.pow(Ge,3),vt=Qe*_e.y0+Be*_e.y0+Le*_e.y1+He*_e.y1,Rt=vt-_e.width/2,rr=vt+_e.width/2,Lt;Rt>Pe.y0&&Rt<Pe.y1?(Lt=Pe.y1-Rt+10,Lt=Pe.circularLinkType=="bottom"?Lt:-Lt,Pe=W(Pe,Lt,pe,ge),ue.nodes.forEach(function(Ft){x(Ft,Te)==x(Pe,Te)||Ft.column!=Pe.column||$(Pe,Ft)&&W(Ft,Lt,pe,ge)})):rr>Pe.y0&&rr<Pe.y1?(Lt=rr-Pe.y0+10,Pe=W(Pe,Lt,pe,ge),ue.nodes.forEach(function(Ft){x(Ft,Te)==x(Pe,Te)||Ft.column!=Pe.column||Ft.y0<Pe.y1&&Ft.y1>Pe.y1&&W(Ft,Lt,pe,ge)})):Rt<Pe.y0&&rr>Pe.y1&&(Lt=rr-Pe.y0+10,Pe=W(Pe,Lt,pe,ge),ue.nodes.forEach(function(Ft){x(Ft,Te)==x(Pe,Te)||Ft.column!=Pe.column||Ft.y0<Pe.y1&&Ft.y1>Pe.y1&&W(Ft,Lt,pe,ge)}))}})}})}function $(ue,pe){return ue.y0>pe.y0&&ue.y0<pe.y1||ue.y1>pe.y0&&ue.y1<pe.y1?!0:ue.y0<pe.y0&&ue.y1>pe.y1}function W(ue,pe,ge,Te){return ue.y0+pe>=ge&&ue.y1+pe<=Te&&(ue.y0=ue.y0+pe,ue.y1=ue.y1+pe,ue.targetLinks.forEach(function(_e){_e.y1=_e.y1+pe}),ue.sourceLinks.forEach(function(_e){_e.y0=_e.y0+pe})),ue}function K(ue,pe,ge,Te){ue.nodes.forEach(function(_e){Te&&_e.y+(_e.y1-_e.y0)>pe&&(_e.y=_e.y-(_e.y+(_e.y1-_e.y0)-pe));var ze=ue.links.filter(function(be){return x(be.source,ge)==x(_e,ge)}),Oe=ze.length;Oe>1&&ze.sort(function(be,Pe){if(!be.circular&&!Pe.circular){if(be.target.column==Pe.target.column)return be.y1-Pe.y1;if(ae(be,Pe)){if(be.target.column>Pe.target.column){var Ge=U(Pe,be);return be.y1-Ge}if(Pe.target.column>be.target.column){var Qe=U(be,Pe);return Qe-Pe.y1}}else return be.y1-Pe.y1}if(be.circular&&!Pe.circular)return be.circularLinkType=="top"?-1:1;if(Pe.circular&&!be.circular)return Pe.circularLinkType=="top"?1:-1;if(be.circular&&Pe.circular)return be.circularLinkType===Pe.circularLinkType&&be.circularLinkType=="top"?be.target.column===Pe.target.column?be.target.y1-Pe.target.y1:Pe.target.column-be.target.column:be.circularLinkType===Pe.circularLinkType&&be.circularLinkType=="bottom"?be.target.column===Pe.target.column?Pe.target.y1-be.target.y1:be.target.column-Pe.target.column:be.circularLinkType=="top"?-1:1});var Ye=_e.y0;ze.forEach(function(be){be.y0=Ye+be.width/2,Ye=Ye+be.width}),ze.forEach(function(be,Pe){if(be.circularLinkType=="bottom"){var Ge=Pe+1,Qe=0;for(Ge;Ge<Oe;Ge++)Qe=Qe+ze[Ge].width;be.y0=_e.y1-Qe-be.width/2}})})}function ne(ue,pe,ge){ue.nodes.forEach(function(Te){var _e=ue.links.filter(function(Ye){return x(Ye.target,ge)==x(Te,ge)}),ze=_e.length;ze>1&&_e.sort(function(Ye,be){if(!Ye.circular&&!be.circular){if(Ye.source.column==be.source.column)return Ye.y0-be.y0;if(ae(Ye,be)){if(be.source.column<Ye.source.column){var Pe=N(be,Ye);return Ye.y0-Pe}if(Ye.source.column<be.source.column){var Ge=N(Ye,be);return Ge-be.y0}}else return Ye.y0-be.y0}if(Ye.circular&&!be.circular)return Ye.circularLinkType=="top"?-1:1;if(be.circular&&!Ye.circular)return be.circularLinkType=="top"?1:-1;if(Ye.circular&&be.circular)return Ye.circularLinkType===be.circularLinkType&&Ye.circularLinkType=="top"?Ye.source.column===be.source.column?Ye.source.y1-be.source.y1:Ye.source.column-be.source.column:Ye.circularLinkType===be.circularLinkType&&Ye.circularLinkType=="bottom"?Ye.source.column===be.source.column?Ye.source.y1-be.source.y1:be.source.column-Ye.source.column:Ye.circularLinkType=="top"?-1:1});var Oe=Te.y0;_e.forEach(function(Ye){Ye.y1=Oe+Ye.width/2,Oe=Oe+Ye.width}),_e.forEach(function(Ye,be){if(Ye.circularLinkType=="bottom"){var Pe=be+1,Ge=0;for(Pe;Pe<ze;Pe++)Ge=Ge+_e[Pe].width;Ye.y1=Te.y1-Ge-Ye.width/2}})})}function ae(ue,pe){return ie(ue)==ie(pe)}function ie(ue){return ue.y0-ue.y1>0?"up":"down"}function le(ue,pe){return x(ue.source,pe)==x(ue.target,pe)}function ye(ue,pe,ge){var Te=ue.nodes,_e=ue.links,ze=!1,Oe=!1;if(_e.forEach(function(Be){Be.circularLinkType=="top"?ze=!0:Be.circularLinkType=="bottom"&&(Oe=!0)}),ze==!1||Oe==!1){var Ye=v.min(Te,function(Be){return Be.y0}),be=v.max(Te,function(Be){return Be.y1}),Pe=be-Ye,Ge=ge-pe,Qe=Ge/Pe;Te.forEach(function(Be){var Le=(Be.y1-Be.y0)*Qe;Be.y0=(Be.y0-Ye)*Qe,Be.y1=Be.y0+Le}),_e.forEach(function(Be){Be.y0=(Be.y0-Ye)*Qe,Be.y1=(Be.y1-Ye)*Qe,Be.width=Be.width*Qe})}}w.sankeyCircular=k,w.sankeyCenter=c,w.sankeyLeft=n,w.sankeyRight=r,w.sankeyJustify=t,Object.defineProperty(w,"__esModule",{value:!0})})},{"d3-array":107,"d3-collection":108,"d3-shape":119,"elementary-circuits-directed-graph":130}],57:[function(d,ee,te){(function(w,v){typeof te=="object"&&typeof ee<"u"?v(te,d("d3-array"),d("d3-collection"),d("d3-shape")):v(w.d3=w.d3||{},w.d3,w.d3,w.d3)})(this,function(w,v,S,M){function e(L){return L.target.depth}function a(L){return L.depth}function n(L,T){return T-1-L.height}function r(L,T){return L.sourceLinks.length?L.depth:T-1}function t(L){return L.targetLinks.length?L.depth:L.sourceLinks.length?v.min(L.sourceLinks,e)-1:0}function c(L){return function(){return L}}function o(L,T){return y(L.source,T.source)||L.index-T.index}function i(L,T){return y(L.target,T.target)||L.index-T.index}function y(L,T){return L.y0-T.y0}function p(L){return L.value}function g(L){return(L.y0+L.y1)/2}function h(L){return g(L.source)*L.value}function m(L){return g(L.target)*L.value}function u(L){return L.index}function _(L){return L.nodes}function s(L){return L.links}function A(L,T){var k=L.get(T);if(!k)throw new Error("missing: "+T);return k}var b=function(){var L=0,T=0,k=1,P=1,z=24,I=8,D=u,R=r,B=_,F=s,H=32,G=2/3;function J(){var se={nodes:B.apply(null,arguments),links:F.apply(null,arguments)};return X(se),Y(se),Z(se),oe(se),re(se),se}J.update=function(se){return re(se),se},J.nodeId=function(se){return arguments.length?(D=typeof se=="function"?se:c(se),J):D},J.nodeAlign=function(se){return arguments.length?(R=typeof se=="function"?se:c(se),J):R},J.nodeWidth=function(se){return arguments.length?(z=+se,J):z},J.nodePadding=function(se){return arguments.length?(I=+se,J):I},J.nodes=function(se){return arguments.length?(B=typeof se=="function"?se:c(se),J):B},J.links=function(se){return arguments.length?(F=typeof se=="function"?se:c(se),J):F},J.size=function(se){return arguments.length?(L=T=0,k=+se[0],P=+se[1],J):[k-L,P-T]},J.extent=function(se){return arguments.length?(L=+se[0][0],k=+se[1][0],T=+se[0][1],P=+se[1][1],J):[[L,T],[k,P]]},J.iterations=function(se){return arguments.length?(H=+se,J):H};function X(se){se.nodes.forEach(function(U,q){U.index=q,U.sourceLinks=[],U.targetLinks=[]});var N=S.map(se.nodes,D);se.links.forEach(function(U,q){U.index=q;var $=U.source,W=U.target;typeof $!="object"&&($=U.source=A(N,$)),typeof W!="object"&&(W=U.target=A(N,W)),$.sourceLinks.push(U),W.targetLinks.push(U)})}function Y(se){se.nodes.forEach(function(N){N.value=Math.max(v.sum(N.sourceLinks,p),v.sum(N.targetLinks,p))})}function Z(se){var N,U,q;for(N=se.nodes,U=[],q=0;N.length;++q,N=U,U=[])N.forEach(function(W){W.depth=q,W.sourceLinks.forEach(function(K){U.indexOf(K.target)<0&&U.push(K.target)})});for(N=se.nodes,U=[],q=0;N.length;++q,N=U,U=[])N.forEach(function(W){W.height=q,W.targetLinks.forEach(function(K){U.indexOf(K.source)<0&&U.push(K.source)})});var $=(k-L-z)/(q-1);se.nodes.forEach(function(W){W.x1=(W.x0=L+Math.max(0,Math.min(q-1,Math.floor(R.call(null,W,q))))*$)+z})}function oe(se){var N=S.nest().key(function(ae){return ae.x0}).sortKeys(v.ascending).entries(se.nodes).map(function(ae){return ae.values});$(),ne();for(var U=1,q=H;q>0;--q)K(U*=.99),ne(),W(U),ne();function $(){var ae=v.max(N,function(ye){return ye.length}),ie=G*(P-T)/(ae-1);I>ie&&(I=ie);var le=v.min(N,function(ye){return(P-T-(ye.length-1)*I)/v.sum(ye,p)});N.forEach(function(ye){ye.forEach(function(ue,pe){ue.y1=(ue.y0=pe)+ue.value*le})}),se.links.forEach(function(ye){ye.width=ye.value*le})}function W(ae){N.forEach(function(ie){ie.forEach(function(le){if(le.targetLinks.length){var ye=(v.sum(le.targetLinks,h)/v.sum(le.targetLinks,p)-g(le))*ae;le.y0+=ye,le.y1+=ye}})})}function K(ae){N.slice().reverse().forEach(function(ie){ie.forEach(function(le){if(le.sourceLinks.length){var ye=(v.sum(le.sourceLinks,m)/v.sum(le.sourceLinks,p)-g(le))*ae;le.y0+=ye,le.y1+=ye}})})}function ne(){N.forEach(function(ae){var ie,le,ye=T,ue=ae.length,pe;for(ae.sort(y),pe=0;pe<ue;++pe)ie=ae[pe],le=ye-ie.y0,le>0&&(ie.y0+=le,ie.y1+=le),ye=ie.y1+I;if(le=ye-I-P,le>0)for(ye=ie.y0-=le,ie.y1-=le,pe=ue-2;pe>=0;--pe)ie=ae[pe],le=ie.y1+I-ye,le>0&&(ie.y0-=le,ie.y1-=le),ye=ie.y0})}}function re(se){se.nodes.forEach(function(N){N.sourceLinks.sort(i),N.targetLinks.sort(o)}),se.nodes.forEach(function(N){var U=N.y0,q=U;N.sourceLinks.forEach(function($){$.y0=U+$.width/2,U+=$.width}),N.targetLinks.forEach(function($){$.y1=q+$.width/2,q+=$.width})})}return J};function f(L){return[L.source.x1,L.y0]}function x(L){return[L.target.x0,L.y1]}var l=function(){return M.linkHorizontal().source(f).target(x)};w.sankey=b,w.sankeyCenter=t,w.sankeyLeft=a,w.sankeyRight=n,w.sankeyJustify=r,w.sankeyLinkHorizontal=l,Object.defineProperty(w,"__esModule",{value:!0})})},{"d3-array":107,"d3-collection":108,"d3-shape":119}],58:[function(d,ee,te){(function(){var w={version:"3.8.0"},v=[].slice,S=function(fe){return v.call(fe)},M=self.document;function e(fe){return fe&&(fe.ownerDocument||fe.document||fe).documentElement}function a(fe){return fe&&(fe.ownerDocument&&fe.ownerDocument.defaultView||fe.document&&fe||fe.defaultView)}if(M)try{S(M.documentElement.childNodes)[0].nodeType}catch{S=function(xe){for(var Ee=xe.length,Fe=new Array(Ee);Ee--;)Fe[Ee]=xe[Ee];return Fe}}if(Date.now||(Date.now=function(){return+new Date}),M)try{M.createElement("DIV").style.setProperty("opacity",0,"")}catch{var n=this.Element.prototype,r=n.setAttribute,t=n.setAttributeNS,c=this.CSSStyleDeclaration.prototype,o=c.setProperty;n.setAttribute=function(xe,Ee){r.call(this,xe,Ee+"")},n.setAttributeNS=function(xe,Ee,Fe){t.call(this,xe,Ee,Fe+"")},c.setProperty=function(xe,Ee,Fe){o.call(this,xe,Ee+"",Fe)}}w.ascending=i;function i(fe,xe){return fe<xe?-1:fe>xe?1:fe>=xe?0:NaN}w.descending=function(fe,xe){return xe<fe?-1:xe>fe?1:xe>=fe?0:NaN},w.min=function(fe,xe){var Ee=-1,Fe=fe.length,Ie,je;if(arguments.length===1){for(;++Ee<Fe;)if((je=fe[Ee])!=null&&je>=je){Ie=je;break}for(;++Ee<Fe;)(je=fe[Ee])!=null&&Ie>je&&(Ie=je)}else{for(;++Ee<Fe;)if((je=xe.call(fe,fe[Ee],Ee))!=null&&je>=je){Ie=je;break}for(;++Ee<Fe;)(je=xe.call(fe,fe[Ee],Ee))!=null&&Ie>je&&(Ie=je)}return Ie},w.max=function(fe,xe){var Ee=-1,Fe=fe.length,Ie,je;if(arguments.length===1){for(;++Ee<Fe;)if((je=fe[Ee])!=null&&je>=je){Ie=je;break}for(;++Ee<Fe;)(je=fe[Ee])!=null&&je>Ie&&(Ie=je)}else{for(;++Ee<Fe;)if((je=xe.call(fe,fe[Ee],Ee))!=null&&je>=je){Ie=je;break}for(;++Ee<Fe;)(je=xe.call(fe,fe[Ee],Ee))!=null&&je>Ie&&(Ie=je)}return Ie},w.extent=function(fe,xe){var Ee=-1,Fe=fe.length,Ie,je,xt;if(arguments.length===1){for(;++Ee<Fe;)if((je=fe[Ee])!=null&&je>=je){Ie=xt=je;break}for(;++Ee<Fe;)(je=fe[Ee])!=null&&(Ie>je&&(Ie=je),xt<je&&(xt=je))}else{for(;++Ee<Fe;)if((je=xe.call(fe,fe[Ee],Ee))!=null&&je>=je){Ie=xt=je;break}for(;++Ee<Fe;)(je=xe.call(fe,fe[Ee],Ee))!=null&&(Ie>je&&(Ie=je),xt<je&&(xt=je))}return[Ie,xt]};function y(fe){return fe===null?NaN:+fe}function p(fe){return!isNaN(fe)}w.sum=function(fe,xe){var Ee=0,Fe=fe.length,Ie,je=-1;if(arguments.length===1)for(;++je<Fe;)p(Ie=+fe[je])&&(Ee+=Ie);else for(;++je<Fe;)p(Ie=+xe.call(fe,fe[je],je))&&(Ee+=Ie);return Ee},w.mean=function(fe,xe){var Ee=0,Fe=fe.length,Ie,je=-1,xt=Fe;if(arguments.length===1)for(;++je<Fe;)p(Ie=y(fe[je]))?Ee+=Ie:--xt;else for(;++je<Fe;)p(Ie=y(xe.call(fe,fe[je],je)))?Ee+=Ie:--xt;if(xt)return Ee/xt},w.quantile=function(fe,xe){var Ee=(fe.length-1)*xe+1,Fe=Math.floor(Ee),Ie=+fe[Fe-1],je=Ee-Fe;return je?Ie+je*(fe[Fe]-Ie):Ie},w.median=function(fe,xe){var Ee=[],Fe=fe.length,Ie,je=-1;if(arguments.length===1)for(;++je<Fe;)p(Ie=y(fe[je]))&&Ee.push(Ie);else for(;++je<Fe;)p(Ie=y(xe.call(fe,fe[je],je)))&&Ee.push(Ie);if(Ee.length)return w.quantile(Ee.sort(i),.5)},w.variance=function(fe,xe){var Ee=fe.length,Fe=0,Ie,je,xt=0,ht=-1,Ct=0;if(arguments.length===1)for(;++ht<Ee;)p(Ie=y(fe[ht]))&&(je=Ie-Fe,Fe+=je/++Ct,xt+=je*(Ie-Fe));else for(;++ht<Ee;)p(Ie=y(xe.call(fe,fe[ht],ht)))&&(je=Ie-Fe,Fe+=je/++Ct,xt+=je*(Ie-Fe));if(Ct>1)return xt/(Ct-1)},w.deviation=function(){var fe=w.variance.apply(this,arguments);return fe&&Math.sqrt(fe)};function g(fe){return{left:function(xe,Ee,Fe,Ie){for(arguments.length<3&&(Fe=0),arguments.length<4&&(Ie=xe.length);Fe<Ie;){var je=Fe+Ie>>>1;fe(xe[je],Ee)<0?Fe=je+1:Ie=je}return Fe},right:function(xe,Ee,Fe,Ie){for(arguments.length<3&&(Fe=0),arguments.length<4&&(Ie=xe.length);Fe<Ie;){var je=Fe+Ie>>>1;fe(xe[je],Ee)>0?Ie=je:Fe=je+1}return Fe}}}var h=g(i);w.bisectLeft=h.left,w.bisect=w.bisectRight=h.right,w.bisector=function(fe){return g(fe.length===1?function(xe,Ee){return i(fe(xe),Ee)}:fe)},w.shuffle=function(fe,xe,Ee){(Fe=arguments.length)<3&&(Ee=fe.length,Fe<2&&(xe=0));for(var Fe=Ee-xe,Ie,je;Fe;)je=Math.random()*Fe--|0,Ie=fe[Fe+xe],fe[Fe+xe]=fe[je+xe],fe[je+xe]=Ie;return fe},w.permute=function(fe,xe){for(var Ee=xe.length,Fe=new Array(Ee);Ee--;)Fe[Ee]=fe[xe[Ee]];return Fe},w.pairs=function(fe){for(var xe=0,Ee=fe.length-1,Fe=fe[0],Ie=new Array(Ee<0?0:Ee);xe<Ee;)Ie[xe]=[Fe,Fe=fe[++xe]];return Ie},w.transpose=function(fe){if(!(je=fe.length))return[];for(var xe=-1,Ee=w.min(fe,m),Fe=new Array(Ee);++xe<Ee;)for(var Ie=-1,je,xt=Fe[xe]=new Array(je);++Ie<je;)xt[Ie]=fe[Ie][xe];return Fe};function m(fe){return fe.length}w.zip=function(){return w.transpose(arguments)},w.keys=function(fe){var xe=[];for(var Ee in fe)xe.push(Ee);return xe},w.values=function(fe){var xe=[];for(var Ee in fe)xe.push(fe[Ee]);return xe},w.entries=function(fe){var xe=[];for(var Ee in fe)xe.push({key:Ee,value:fe[Ee]});return xe},w.merge=function(fe){for(var xe=fe.length,Ee,Fe=-1,Ie=0,je,xt;++Fe<xe;)Ie+=fe[Fe].length;for(je=new Array(Ie);--xe>=0;)for(xt=fe[xe],Ee=xt.length;--Ee>=0;)je[--Ie]=xt[Ee];return je};var u=Math.abs;w.range=function(fe,xe,Ee){if(arguments.length<3&&(Ee=1,arguments.length<2&&(xe=fe,fe=0)),(xe-fe)/Ee===1/0)throw new Error("infinite range");var Fe=[],Ie=_(u(Ee)),je=-1,xt;if(fe*=Ie,xe*=Ie,Ee*=Ie,Ee<0)for(;(xt=fe+Ee*++je)>xe;)Fe.push(xt/Ie);else for(;(xt=fe+Ee*++je)<xe;)Fe.push(xt/Ie);return Fe};function _(fe){for(var xe=1;fe*xe%1;)xe*=10;return xe}function s(fe,xe){for(var Ee in xe)Object.defineProperty(fe.prototype,Ee,{value:xe[Ee],enumerable:!1})}w.map=function(fe,xe){var Ee=new A;if(fe instanceof A)fe.forEach(function(ht,Ct){Ee.set(ht,Ct)});else if(Array.isArray(fe)){var Fe=-1,Ie=fe.length,je;if(arguments.length===1)for(;++Fe<Ie;)Ee.set(Fe,fe[Fe]);else for(;++Fe<Ie;)Ee.set(xe.call(fe,je=fe[Fe],Fe),je)}else for(var xt in fe)Ee.set(xt,fe[xt]);return Ee};function A(){this._=Object.create(null)}var b="__proto__",f="\0";s(A,{has:L,get:function(fe){return this._[x(fe)]},set:function(fe,xe){return this._[x(fe)]=xe},remove:T,keys:k,values:function(){var fe=[];for(var xe in this._)fe.push(this._[xe]);return fe},entries:function(){var fe=[];for(var xe in this._)fe.push({key:l(xe),value:this._[xe]});return fe},size:P,empty:z,forEach:function(fe){for(var xe in this._)fe.call(this,l(xe),this._[xe])}});function x(fe){return(fe+="")===b||fe[0]===f?f+fe:fe}function l(fe){return(fe+="")[0]===f?fe.slice(1):fe}function L(fe){return x(fe)in this._}function T(fe){return(fe=x(fe))in this._&&delete this._[fe]}function k(){var fe=[];for(var xe in this._)fe.push(l(xe));return fe}function P(){var fe=0;for(var xe in this._)++fe;return fe}function z(){for(var fe in this._)return!1;return!0}w.nest=function(){var fe={},xe=[],Ee=[],Fe,Ie;function je(ht,Ct,Xt){if(Xt>=xe.length)return Ie?Ie.call(fe,Ct):Fe?Ct.sort(Fe):Ct;for(var $t=-1,er=Ct.length,Ar=xe[Xt++],Jr,sn,Lr,Br=new A,Zr;++$t<er;)(Zr=Br.get(Jr=Ar(sn=Ct[$t])))?Zr.push(sn):Br.set(Jr,[sn]);return ht?(sn=ht(),Lr=function(nn,on){sn.set(nn,je(ht,on,Xt))}):(sn={},Lr=function(nn,on){sn[nn]=je(ht,on,Xt)}),Br.forEach(Lr),sn}function xt(ht,Ct){if(Ct>=xe.length)return ht;var Xt=[],$t=Ee[Ct++];return ht.forEach(function(er,Ar){Xt.push({key:er,values:xt(Ar,Ct)})}),$t?Xt.sort(function(er,Ar){return $t(er.key,Ar.key)}):Xt}return fe.map=function(ht,Ct){return je(Ct,ht,0)},fe.entries=function(ht){return xt(je(w.map,ht,0),0)},fe.key=function(ht){return xe.push(ht),fe},fe.sortKeys=function(ht){return Ee[xe.length-1]=ht,fe},fe.sortValues=function(ht){return Fe=ht,fe},fe.rollup=function(ht){return Ie=ht,fe},fe},w.set=function(fe){var xe=new I;if(fe)for(var Ee=0,Fe=fe.length;Ee<Fe;++Ee)xe.add(fe[Ee]);return xe};function I(){this._=Object.create(null)}s(I,{has:L,add:function(fe){return this._[x(fe+="")]=!0,fe},remove:T,values:k,size:P,empty:z,forEach:function(fe){for(var xe in this._)fe.call(this,l(xe))}}),w.behavior={};function D(fe){return fe}w.rebind=function(fe,xe){for(var Ee=1,Fe=arguments.length,Ie;++Ee<Fe;)fe[Ie=arguments[Ee]]=R(fe,xe,xe[Ie]);return fe};function R(fe,xe,Ee){return function(){var Fe=Ee.apply(xe,arguments);return Fe===xe?fe:Fe}}function B(fe,xe){if(xe in fe)return xe;xe=xe.charAt(0).toUpperCase()+xe.slice(1);for(var Ee=0,Fe=F.length;Ee<Fe;++Ee){var Ie=F[Ee]+xe;if(Ie in fe)return Ie}}var F=["webkit","ms","moz","Moz","o","O"];function H(){}w.dispatch=function(){for(var fe=new G,xe=-1,Ee=arguments.length;++xe<Ee;)fe[arguments[xe]]=J(fe);return fe};function G(){}G.prototype.on=function(fe,xe){var Ee=fe.indexOf("."),Fe="";if(Ee>=0&&(Fe=fe.slice(Ee+1),fe=fe.slice(0,Ee)),fe)return arguments.length<2?this[fe].on(Fe):this[fe].on(Fe,xe);if(arguments.length===2){if(xe==null)for(fe in this)this.hasOwnProperty(fe)&&this[fe].on(Fe,null);return this}};function J(fe){var xe=[],Ee=new A;function Fe(){for(var Ie=xe,je=-1,xt=Ie.length,ht;++je<xt;)(ht=Ie[je].on)&&ht.apply(this,arguments);return fe}return Fe.on=function(Ie,je){var xt=Ee.get(Ie),ht;return arguments.length<2?xt&&xt.on:(xt&&(xt.on=null,xe=xe.slice(0,ht=xe.indexOf(xt)).concat(xe.slice(ht+1)),Ee.remove(Ie)),je&&xe.push(Ee.set(Ie,{on:je})),fe)},Fe}w.event=null;function X(){w.event.preventDefault()}function Y(){for(var fe=w.event,xe;xe=fe.sourceEvent;)fe=xe;return fe}function Z(fe){for(var xe=new G,Ee=0,Fe=arguments.length;++Ee<Fe;)xe[arguments[Ee]]=J(xe);return xe.of=function(Ie,je){return function(xt){try{var ht=xt.sourceEvent=w.event;xt.target=fe,w.event=xt,xe[xt.type].apply(Ie,je)}finally{w.event=ht}}},xe}w.requote=function(fe){return fe.replace(oe,"\\$&")};var oe=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,re={}.__proto__?function(fe,xe){fe.__proto__=xe}:function(fe,xe){for(var Ee in xe)fe[Ee]=xe[Ee]};function se(fe){return re(fe,$),fe}var N=function(fe,xe){return xe.querySelector(fe)},U=function(fe,xe){return xe.querySelectorAll(fe)},q=function(fe,xe){var Ee=fe.matches||fe[B(fe,"matchesSelector")];return q=function(Fe,Ie){return Ee.call(Fe,Ie)},q(fe,xe)};typeof Sizzle=="function"&&(N=function(fe,xe){return Sizzle(fe,xe)[0]||null},U=Sizzle,q=Sizzle.matchesSelector),w.selection=function(){return w.select(M.documentElement)};var $=w.selection.prototype=[];$.select=function(fe){var xe=[],Ee,Fe,Ie,je;fe=W(fe);for(var xt=-1,ht=this.length;++xt<ht;){xe.push(Ee=[]),Ee.parentNode=(Ie=this[xt]).parentNode;for(var Ct=-1,Xt=Ie.length;++Ct<Xt;)(je=Ie[Ct])?(Ee.push(Fe=fe.call(je,je.__data__,Ct,xt)),Fe&&"__data__"in je&&(Fe.__data__=je.__data__)):Ee.push(null)}return se(xe)};function W(fe){return typeof fe=="function"?fe:function(){return N(fe,this)}}$.selectAll=function(fe){var xe=[],Ee,Fe;fe=K(fe);for(var Ie=-1,je=this.length;++Ie<je;)for(var xt=this[Ie],ht=-1,Ct=xt.length;++ht<Ct;)(Fe=xt[ht])&&(xe.push(Ee=S(fe.call(Fe,Fe.__data__,ht,Ie))),Ee.parentNode=Fe);return se(xe)};function K(fe){return typeof fe=="function"?fe:function(){return U(fe,this)}}var ne="http://www.w3.org/1999/xhtml",ae={svg:"http://www.w3.org/2000/svg",xhtml:ne,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};w.ns={prefix:ae,qualify:function(fe){var xe=fe.indexOf(":"),Ee=fe;return xe>=0&&(Ee=fe.slice(0,xe))!=="xmlns"&&(fe=fe.slice(xe+1)),ae.hasOwnProperty(Ee)?{space:ae[Ee],local:fe}:fe}},$.attr=function(fe,xe){if(arguments.length<2){if(typeof fe=="string"){var Ee=this.node();return fe=w.ns.qualify(fe),fe.local?Ee.getAttributeNS(fe.space,fe.local):Ee.getAttribute(fe)}for(xe in fe)this.each(ie(xe,fe[xe]));return this}return this.each(ie(fe,xe))};function ie(fe,xe){fe=w.ns.qualify(fe);function Ee(){this.removeAttribute(fe)}function Fe(){this.removeAttributeNS(fe.space,fe.local)}function Ie(){this.setAttribute(fe,xe)}function je(){this.setAttributeNS(fe.space,fe.local,xe)}function xt(){var Ct=xe.apply(this,arguments);Ct==null?this.removeAttribute(fe):this.setAttribute(fe,Ct)}function ht(){var Ct=xe.apply(this,arguments);Ct==null?this.removeAttributeNS(fe.space,fe.local):this.setAttributeNS(fe.space,fe.local,Ct)}return xe==null?fe.local?Fe:Ee:typeof xe=="function"?fe.local?ht:xt:fe.local?je:Ie}function le(fe){return fe.trim().replace(/\s+/g," ")}$.classed=function(fe,xe){if(arguments.length<2){if(typeof fe=="string"){var Ee=this.node(),Fe=(fe=ue(fe)).length,Ie=-1;if(xe=Ee.classList){for(;++Ie<Fe;)if(!xe.contains(fe[Ie]))return!1}else for(xe=Ee.getAttribute("class");++Ie<Fe;)if(!ye(fe[Ie]).test(xe))return!1;return!0}for(xe in fe)this.each(pe(xe,fe[xe]));return this}return this.each(pe(fe,xe))};function ye(fe){return new RegExp("(?:^|\\s+)"+w.requote(fe)+"(?:\\s+|$)","g")}function ue(fe){return(fe+"").trim().split(/^|\s+/)}function pe(fe,xe){fe=ue(fe).map(ge);var Ee=fe.length;function Fe(){for(var je=-1;++je<Ee;)fe[je](this,xe)}function Ie(){for(var je=-1,xt=xe.apply(this,arguments);++je<Ee;)fe[je](this,xt)}return typeof xe=="function"?Ie:Fe}function ge(fe){var xe=ye(fe);return function(Ee,Fe){if(Ie=Ee.classList)return Fe?Ie.add(fe):Ie.remove(fe);var Ie=Ee.getAttribute("class")||"";Fe?(xe.lastIndex=0,xe.test(Ie)||Ee.setAttribute("class",le(Ie+" "+fe))):Ee.setAttribute("class",le(Ie.replace(xe," ")))}}$.style=function(fe,xe,Ee){var Fe=arguments.length;if(Fe<3){if(typeof fe!="string"){Fe<2&&(xe="");for(Ee in fe)this.each(Te(Ee,fe[Ee],xe));return this}if(Fe<2){var Ie=this.node();return a(Ie).getComputedStyle(Ie,null).getPropertyValue(fe)}Ee=""}return this.each(Te(fe,xe,Ee))};function Te(fe,xe,Ee){function Fe(){this.style.removeProperty(fe)}function Ie(){this.style.setProperty(fe,xe,Ee)}function je(){var xt=xe.apply(this,arguments);xt==null?this.style.removeProperty(fe):this.style.setProperty(fe,xt,Ee)}return xe==null?Fe:typeof xe=="function"?je:Ie}$.property=function(fe,xe){if(arguments.length<2){if(typeof fe=="string")return this.node()[fe];for(xe in fe)this.each(_e(xe,fe[xe]));return this}return this.each(_e(fe,xe))};function _e(fe,xe){function Ee(){delete this[fe]}function Fe(){this[fe]=xe}function Ie(){var je=xe.apply(this,arguments);je==null?delete this[fe]:this[fe]=je}return xe==null?Ee:typeof xe=="function"?Ie:Fe}$.text=function(fe){return arguments.length?this.each(typeof fe=="function"?function(){var xe=fe.apply(this,arguments);this.textContent=xe==null?"":xe}:fe==null?function(){this.textContent=""}:function(){this.textContent=fe}):this.node().textContent},$.html=function(fe){return arguments.length?this.each(typeof fe=="function"?function(){var xe=fe.apply(this,arguments);this.innerHTML=xe==null?"":xe}:fe==null?function(){this.innerHTML=""}:function(){this.innerHTML=fe}):this.node().innerHTML},$.append=function(fe){return fe=ze(fe),this.select(function(){return this.appendChild(fe.apply(this,arguments))})};function ze(fe){function xe(){var Fe=this.ownerDocument,Ie=this.namespaceURI;return Ie===ne&&Fe.documentElement.namespaceURI===ne?Fe.createElement(fe):Fe.createElementNS(Ie,fe)}function Ee(){return this.ownerDocument.createElementNS(fe.space,fe.local)}return typeof fe=="function"?fe:(fe=w.ns.qualify(fe)).local?Ee:xe}$.insert=function(fe,xe){return fe=ze(fe),xe=W(xe),this.select(function(){return this.insertBefore(fe.apply(this,arguments),xe.apply(this,arguments)||null)})},$.remove=function(){return this.each(Oe)};function Oe(){var fe=this.parentNode;fe&&fe.removeChild(this)}$.data=function(fe,xe){var Ee=-1,Fe=this.length,Ie,je;if(!arguments.length){for(fe=new Array(Fe=(Ie=this[0]).length);++Ee<Fe;)(je=Ie[Ee])&&(fe[Ee]=je.__data__);return fe}function xt($t,er){var Ar,Jr=$t.length,sn=er.length,Lr=Math.min(Jr,sn),Br=new Array(sn),Zr=new Array(sn),nn=new Array(Jr),on,jr;if(xe){var Un=new A,ra=new Array(Jr),_a;for(Ar=-1;++Ar<Jr;)(on=$t[Ar])&&(Un.has(_a=xe.call(on,on.__data__,Ar))?nn[Ar]=on:Un.set(_a,on),ra[Ar]=_a);for(Ar=-1;++Ar<sn;)(on=Un.get(_a=xe.call(er,jr=er[Ar],Ar)))?on!==!0&&(Br[Ar]=on,on.__data__=jr):Zr[Ar]=Ye(jr),Un.set(_a,!0);for(Ar=-1;++Ar<Jr;)Ar in ra&&Un.get(ra[Ar])!==!0&&(nn[Ar]=$t[Ar])}else{for(Ar=-1;++Ar<Lr;)on=$t[Ar],jr=er[Ar],on?(on.__data__=jr,Br[Ar]=on):Zr[Ar]=Ye(jr);for(;Ar<sn;++Ar)Zr[Ar]=Ye(er[Ar]);for(;Ar<Jr;++Ar)nn[Ar]=$t[Ar]}Zr.update=Br,Zr.parentNode=Br.parentNode=nn.parentNode=$t.parentNode,ht.push(Zr),Ct.push(Br),Xt.push(nn)}var ht=Qe([]),Ct=se([]),Xt=se([]);if(typeof fe=="function")for(;++Ee<Fe;)xt(Ie=this[Ee],fe.call(Ie,Ie.parentNode.__data__,Ee));else for(;++Ee<Fe;)xt(Ie=this[Ee],fe);return Ct.enter=function(){return ht},Ct.exit=function(){return Xt},Ct};function Ye(fe){return{__data__:fe}}$.datum=function(fe){return arguments.length?this.property("__data__",fe):this.property("__data__")},$.filter=function(fe){var xe=[],Ee,Fe,Ie;typeof fe!="function"&&(fe=be(fe));for(var je=0,xt=this.length;je<xt;je++){xe.push(Ee=[]),Ee.parentNode=(Fe=this[je]).parentNode;for(var ht=0,Ct=Fe.length;ht<Ct;ht++)(Ie=Fe[ht])&&fe.call(Ie,Ie.__data__,ht,je)&&Ee.push(Ie)}return se(xe)};function be(fe){return function(){return q(this,fe)}}$.order=function(){for(var fe=-1,xe=this.length;++fe<xe;)for(var Ee=this[fe],Fe=Ee.length-1,Ie=Ee[Fe],je;--Fe>=0;)(je=Ee[Fe])&&(Ie&&Ie!==je.nextSibling&&Ie.parentNode.insertBefore(je,Ie),Ie=je);return this},$.sort=function(fe){fe=Pe.apply(this,arguments);for(var xe=-1,Ee=this.length;++xe<Ee;)this[xe].sort(fe);return this.order()};function Pe(fe){return arguments.length||(fe=i),function(xe,Ee){return xe&&Ee?fe(xe.__data__,Ee.__data__):!xe-!Ee}}$.each=function(fe){return Ge(this,function(xe,Ee,Fe){fe.call(xe,xe.__data__,Ee,Fe)})};function Ge(fe,xe){for(var Ee=0,Fe=fe.length;Ee<Fe;Ee++)for(var Ie=fe[Ee],je=0,xt=Ie.length,ht;je<xt;je++)(ht=Ie[je])&&xe(ht,je,Ee);return fe}$.call=function(fe){var xe=S(arguments);return fe.apply(xe[0]=this,xe),this},$.empty=function(){return!this.node()},$.node=function(){for(var fe=0,xe=this.length;fe<xe;fe++)for(var Ee=this[fe],Fe=0,Ie=Ee.length;Fe<Ie;Fe++){var je=Ee[Fe];if(je)return je}return null},$.size=function(){var fe=0;return Ge(this,function(){++fe}),fe};function Qe(fe){return re(fe,Be),fe}var Be=[];w.selection.enter=Qe,w.selection.enter.prototype=Be,Be.append=$.append,Be.empty=$.empty,Be.node=$.node,Be.call=$.call,Be.size=$.size,Be.select=function(fe){for(var xe=[],Ee,Fe,Ie,je,xt,ht=-1,Ct=this.length;++ht<Ct;){Ie=(je=this[ht]).update,xe.push(Ee=[]),Ee.parentNode=je.parentNode;for(var Xt=-1,$t=je.length;++Xt<$t;)(xt=je[Xt])?(Ee.push(Ie[Xt]=Fe=fe.call(je.parentNode,xt.__data__,Xt,ht)),Fe.__data__=xt.__data__):Ee.push(null)}return se(xe)},Be.insert=function(fe,xe){return arguments.length<2&&(xe=Le(this)),$.insert.call(this,fe,xe)};function Le(fe){var xe,Ee;return function(Fe,Ie,je){var xt=fe[je].update,ht=xt.length,Ct;for(je!=Ee&&(Ee=je,xe=0),Ie>=xe&&(xe=Ie+1);!(Ct=xt[xe])&&++xe<ht;);return Ct}}w.select=function(fe){var xe;return typeof fe=="string"?(xe=[N(fe,M)],xe.parentNode=M.documentElement):(xe=[fe],xe.parentNode=e(fe)),se([xe])},w.selectAll=function(fe){var xe;return typeof fe=="string"?(xe=S(U(fe,M)),xe.parentNode=M.documentElement):(xe=S(fe),xe.parentNode=null),se([xe])},$.on=function(fe,xe,Ee){var Fe=arguments.length;if(Fe<3){if(typeof fe!="string"){Fe<2&&(xe=!1);for(Ee in fe)this.each(He(Ee,fe[Ee],xe));return this}if(Fe<2)return(Fe=this.node()["__on"+fe])&&Fe._;Ee=!1}return this.each(He(fe,xe,Ee))};function He(fe,xe,Ee){var Fe="__on"+fe,Ie=fe.indexOf("."),je=Rt;Ie>0&&(fe=fe.slice(0,Ie));var xt=vt.get(fe);xt&&(fe=xt,je=rr);function ht(){var $t=this[Fe];$t&&(this.removeEventListener(fe,$t,$t.$),delete this[Fe])}function Ct(){var $t=je(xe,S(arguments));ht.call(this),this.addEventListener(fe,this[Fe]=$t,$t.$=Ee),$t._=xe}function Xt(){var $t=new RegExp("^__on([^.]+)"+w.requote(fe)+"$"),er;for(var Ar in this)if(er=Ar.match($t)){var Jr=this[Ar];this.removeEventListener(er[1],Jr,Jr.$),delete this[Ar]}}return Ie?xe?Ct:ht:xe?H:Xt}var vt=w.map({mouseenter:"mouseover",mouseleave:"mouseout"});M&&vt.forEach(function(fe){"on"+fe in M&&vt.remove(fe)});function Rt(fe,xe){return function(Ee){var Fe=w.event;w.event=Ee,xe[0]=this.__data__;try{fe.apply(this,xe)}finally{w.event=Fe}}}function rr(fe,xe){var Ee=Rt(fe,xe);return function(Fe){var Ie=this,je=Fe.relatedTarget;(!je||je!==Ie&&!(je.compareDocumentPosition(Ie)&8))&&Ee.call(Ie,Fe)}}var Lt,Ft=0;function Gt(fe){var xe=".dragsuppress-"+ ++Ft,Ee="click"+xe,Fe=w.select(a(fe)).on("touchmove"+xe,X).on("dragstart"+xe,X).on("selectstart"+xe,X);if(Lt==null&&(Lt="onselectstart"in fe?!1:B(fe.style,"userSelect")),Lt){var Ie=e(fe).style,je=Ie[Lt];Ie[Lt]="none"}return function(xt){if(Fe.on(xe,null),Lt&&(Ie[Lt]=je),xt){var ht=function(){Fe.on(Ee,null)};Fe.on(Ee,function(){X(),ht()},!0),setTimeout(ht,0)}}}w.mouse=function(fe){return kt(fe,Y())};var Dt=this.navigator&&/WebKit/.test(this.navigator.userAgent)?-1:0;function kt(fe,xe){xe.changedTouches&&(xe=xe.changedTouches[0]);var Ee=fe.ownerSVGElement||fe;if(Ee.createSVGPoint){var Fe=Ee.createSVGPoint();if(Dt<0){var Ie=a(fe);if(Ie.scrollX||Ie.scrollY){Ee=w.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important");var je=Ee[0][0].getScreenCTM();Dt=!(je.f||je.e),Ee.remove()}}return Dt?(Fe.x=xe.pageX,Fe.y=xe.pageY):(Fe.x=xe.clientX,Fe.y=xe.clientY),Fe=Fe.matrixTransform(fe.getScreenCTM().inverse()),[Fe.x,Fe.y]}var xt=fe.getBoundingClientRect();return[xe.clientX-xt.left-fe.clientLeft,xe.clientY-xt.top-fe.clientTop]}w.touch=function(fe,xe,Ee){if(arguments.length<3&&(Ee=xe,xe=Y().changedTouches),xe){for(var Fe=0,Ie=xe.length,je;Fe<Ie;++Fe)if((je=xe[Fe]).identifier===Ee)return kt(fe,je)}},w.behavior.drag=function(){var fe=Z(Ie,"drag","dragstart","dragend"),xe=null,Ee=je(H,w.mouse,a,"mousemove","mouseup"),Fe=je(Ue,w.touch,D,"touchmove","touchend");function Ie(){this.on("mousedown.drag",Ee).on("touchstart.drag",Fe)}function je(xt,ht,Ct,Xt,$t){return function(){var er=this,Ar=w.event.target.correspondingElement||w.event.target,Jr=er.parentNode,sn=fe.of(er,arguments),Lr=0,Br=xt(),Zr=".drag"+(Br==null?"":"-"+Br),nn,on=w.select(Ct(Ar)).on(Xt+Zr,ra).on($t+Zr,_a),jr=Gt(Ar),Un=ht(Jr,Br);xe?(nn=xe.apply(er,arguments),nn=[nn.x-Un[0],nn.y-Un[1]]):nn=[0,0],sn({type:"dragstart"});function ra(){var ia=ht(Jr,Br),Sa,la;!ia||(Sa=ia[0]-Un[0],la=ia[1]-Un[1],Lr|=Sa|la,Un=ia,sn({type:"drag",x:ia[0]+nn[0],y:ia[1]+nn[1],dx:Sa,dy:la}))}function _a(){!ht(Jr,Br)||(on.on(Xt+Zr,null).on($t+Zr,null),jr(Lr),sn({type:"dragend"}))}}}return Ie.origin=function(xt){return arguments.length?(xe=xt,Ie):xe},w.rebind(Ie,fe,"on")};function Ue(){return w.event.changedTouches[0].identifier}w.touches=function(fe,xe){return arguments.length<2&&(xe=Y().touches),xe?S(xe).map(function(Ee){var Fe=kt(fe,Ee);return Fe.identifier=Ee.identifier,Fe}):[]};var qe=1e-6,Ve=qe*qe,Ae=Math.PI,Ne=2*Ae,Xe=Ne-qe,Je=Ae/2,_t=Ae/180,mt=180/Ae;function Ot(fe,xe,Ee){return(xe[0]-fe[0])*(Ee[1]-fe[1])-(xe[1]-fe[1])*(Ee[0]-fe[0])}function Kt(fe){return fe>1?Je:fe<-1?-Je:Math.asin(fe)}function Nt(fe){return((fe=Math.exp(fe))-1/fe)/2}function Wt(fe){return((fe=Math.exp(fe))+1/fe)/2}function qt(fe){return((fe=Math.exp(2*fe))-1)/(fe+1)}var Yt=Math.SQRT2,fr=2,Yr=4;w.interpolateZoom=function(fe,xe){var Ee=fe[0],Fe=fe[1],Ie=fe[2],je=xe[0],xt=xe[1],ht=xe[2],Ct=je-Ee,Xt=xt-Fe,$t=Ct*Ct+Xt*Xt,er,Ar;if($t<Ve)Ar=Math.log(ht/Ie)/Yt,er=function(nn){return[Ee+nn*Ct,Fe+nn*Xt,Ie*Math.exp(Yt*nn*Ar)]};else{var Jr=Math.sqrt($t),sn=(ht*ht-Ie*Ie+Yr*$t)/(2*Ie*fr*Jr),Lr=(ht*ht-Ie*Ie-Yr*$t)/(2*ht*fr*Jr),Br=Math.log(Math.sqrt(sn*sn+1)-sn),Zr=Math.log(Math.sqrt(Lr*Lr+1)-Lr);Ar=(Zr-Br)/Yt,er=function(nn){var on=nn*Ar,jr=Wt(Br),Un=Ie/(fr*Jr)*(jr*qt(Yt*on+Br)-Nt(Br));return[Ee+Un*Ct,Fe+Un*Xt,Ie*jr/Wt(Yt*on+Br)]}}return er.duration=Ar*1e3,er},w.behavior.zoom=function(){var fe={x:0,y:0,k:1},xe,Ee,Fe,Ie=[960,500],je=hn,xt=250,ht=0,Ct="mousedown.zoom",Xt="mousemove.zoom",$t="mouseup.zoom",er,Ar="touchstart.zoom",Jr,sn=Z(on,"zoomstart","zoom","zoomend"),Lr,Br,Zr,nn;at||(at="onwheel"in M?(Qr=function(){return-w.event.deltaY*(w.event.deltaMode?120:1)},"wheel"):"onmousewheel"in M?(Qr=function(){return w.event.wheelDelta},"mousewheel"):(Qr=function(){return-w.event.detail},"MozMousePixelScroll"));function on(fa){fa.on(Ct,$a).on(at+".zoom",fo).on("dblclick.zoom",Ii).on(Ar,yi)}on.event=function(fa){fa.each(function(){var ai=sn.of(this,arguments),Xa=fe;Ya?w.select(this).transition().each("start.zoom",function(){fe=this.__chart__||{x:0,y:0,k:1},la(ai)}).tween("zoom:zoom",function(){var Si=Ie[0],si=Ie[1],io=Ee?Ee[0]:Si/2,Qi=Ee?Ee[1]:si/2,go=w.interpolateZoom([(io-fe.x)/fe.k,(Qi-fe.y)/fe.k,Si/fe.k],[(io-Xa.x)/Xa.k,(Qi-Xa.y)/Xa.k,Si/Xa.k]);return function(Go){var Fo=go(Go),Yo=Si/Fo[2];this.__chart__=fe={x:io-Fo[0]*Yo,y:Qi-Fo[1]*Yo,k:Yo},Na(ai)}}).each("interrupt.zoom",function(){Pa(ai)}).each("end.zoom",function(){Pa(ai)}):(this.__chart__=fe,la(ai),Na(ai),Pa(ai))})},on.translate=function(fa){return arguments.length?(fe={x:+fa[0],y:+fa[1],k:fe.k},Sa(),on):[fe.x,fe.y]},on.scale=function(fa){return arguments.length?(fe={x:fe.x,y:fe.y,k:null},ra(+fa),Sa(),on):fe.k},on.scaleExtent=function(fa){return arguments.length?(je=fa==null?hn:[+fa[0],+fa[1]],on):je},on.center=function(fa){return arguments.length?(Fe=fa&&[+fa[0],+fa[1]],on):Fe},on.size=function(fa){return arguments.length?(Ie=fa&&[+fa[0],+fa[1]],on):Ie},on.duration=function(fa){return arguments.length?(xt=+fa,on):xt},on.x=function(fa){return arguments.length?(Br=fa,Lr=fa.copy(),fe={x:0,y:0,k:1},on):Br},on.y=function(fa){return arguments.length?(nn=fa,Zr=fa.copy(),fe={x:0,y:0,k:1},on):nn};function jr(fa){return[(fa[0]-fe.x)/fe.k,(fa[1]-fe.y)/fe.k]}function Un(fa){return[fa[0]*fe.k+fe.x,fa[1]*fe.k+fe.y]}function ra(fa){fe.k=Math.max(je[0],Math.min(je[1],fa))}function _a(fa,ai){ai=Un(ai),fe.x+=fa[0]-ai[0],fe.y+=fa[1]-ai[1]}function ia(fa,ai,Xa,Si){fa.__chart__={x:fe.x,y:fe.y,k:fe.k},ra(Math.pow(2,Si)),_a(Ee=ai,Xa),fa=w.select(fa),xt>0&&(fa=fa.transition().duration(xt)),fa.call(on.event)}function Sa(){Br&&Br.domain(Lr.range().map(function(fa){return(fa-fe.x)/fe.k}).map(Lr.invert)),nn&&nn.domain(Zr.range().map(function(fa){return(fa-fe.y)/fe.k}).map(Zr.invert))}function la(fa){ht++||fa({type:"zoomstart"})}function Na(fa){Sa(),fa({type:"zoom",scale:fe.k,translate:[fe.x,fe.y]})}function Pa(fa){--ht||(fa({type:"zoomend"}),Ee=null)}function $a(){var fa=this,ai=sn.of(fa,arguments),Xa=0,Si=w.select(a(fa)).on(Xt,Qi).on($t,go),si=jr(w.mouse(fa)),io=Gt(fa);Dn.call(fa),la(ai);function Qi(){Xa=1,_a(w.mouse(fa),si),Na(ai)}function go(){Si.on(Xt,null).on($t,null),io(Xa),Pa(ai)}}function yi(){var fa=this,ai=sn.of(fa,arguments),Xa={},Si=0,si,io=".zoom-"+w.event.changedTouches[0].identifier,Qi="touchmove"+io,go="touchend"+io,Go=[],Fo=w.select(fa),Yo=Gt(fa);Bi(),la(ai),Fo.on(Ct,null).on(Ar,Bi);function Gi(){var xo=w.touches(fa);return si=fe.k,xo.forEach(function(eo){eo.identifier in Xa&&(Xa[eo.identifier]=jr(eo))}),xo}function Bi(){var xo=w.event.target;w.select(xo).on(Qi,Ia).on(go,Za),Go.push(xo);for(var eo=w.event.changedTouches,Po=0,Xi=eo.length;Po<Xi;++Po)Xa[eo[Po].identifier]=null;var Wo=Gi(),xs=Date.now();if(Wo.length===1){if(xs-Jr<500){var Nl=Wo[0];ia(fa,Nl,Xa[Nl.identifier],Math.floor(Math.log(fe.k)/Math.LN2)+1),X()}Jr=xs}else if(Wo.length>1){var Nl=Wo[0],Zi=Wo[1],qu=Nl[0]-Zi[0],Al=Nl[1]-Zi[1];Si=qu*qu+Al*Al}}function Ia(){var xo=w.touches(fa),eo,Po,Xi,Wo;Dn.call(fa);for(var xs=0,Nl=xo.length;xs<Nl;++xs,Wo=null)if(Xi=xo[xs],Wo=Xa[Xi.identifier]){if(Po)break;eo=Xi,Po=Wo}if(Wo){var Zi=(Zi=Xi[0]-eo[0])*Zi+(Zi=Xi[1]-eo[1])*Zi,qu=Si&&Math.sqrt(Zi/Si);eo=[(eo[0]+Xi[0])/2,(eo[1]+Xi[1])/2],Po=[(Po[0]+Wo[0])/2,(Po[1]+Wo[1])/2],ra(qu*si)}Jr=null,_a(eo,Po),Na(ai)}function Za(){if(w.event.touches.length){for(var xo=w.event.changedTouches,eo=0,Po=xo.length;eo<Po;++eo)delete Xa[xo[eo].identifier];for(var Xi in Xa)return void Gi()}w.selectAll(Go).on(io,null),Fo.on(Ct,$a).on(Ar,yi),Yo(),Pa(ai)}}function fo(){var fa=sn.of(this,arguments);er?clearTimeout(er):(Dn.call(this),xe=jr(Ee=Fe||w.mouse(this)),la(fa)),er=setTimeout(function(){er=null,Pa(fa)},50),X(),ra(Math.pow(2,Qr()*.002)*fe.k),_a(Ee,xe),Na(fa)}function Ii(){var fa=w.mouse(this),ai=Math.log(fe.k)/Math.LN2;ia(this,fa,jr(fa),w.event.shiftKey?Math.ceil(ai)-1:Math.floor(ai)+1)}return w.rebind(on,sn,"on")};var hn=[0,1/0],Qr,at;w.color=Jt;function Jt(){}Jt.prototype.toString=function(){return this.rgb()+""},w.hsl=Zt;function Zt(fe,xe,Ee){return this instanceof Zt?(this.h=+fe,this.s=+xe,void(this.l=+Ee)):arguments.length<2?fe instanceof Zt?new Zt(fe.h,fe.s,fe.l):Hr(""+fe,nr,Zt):new Zt(fe,xe,Ee)}var Ut=Zt.prototype=new Jt;Ut.brighter=function(fe){return fe=Math.pow(.7,arguments.length?fe:1),new Zt(this.h,this.s,this.l/fe)},Ut.darker=function(fe){return fe=Math.pow(.7,arguments.length?fe:1),new Zt(this.h,this.s,fe*this.l)},Ut.rgb=function(){return _r(this.h,this.s,this.l)};function _r(fe,xe,Ee){var Fe,Ie;fe=isNaN(fe)?0:(fe%=360)<0?fe+360:fe,xe=isNaN(xe)||xe<0?0:xe>1?1:xe,Ee=Ee<0?0:Ee>1?1:Ee,Ie=Ee<=.5?Ee*(1+xe):Ee+xe-Ee*xe,Fe=2*Ee-Ie;function je(ht){return ht>360?ht-=360:ht<0&&(ht+=360),ht<60?Fe+(Ie-Fe)*ht/60:ht<180?Ie:ht<240?Fe+(Ie-Fe)*(240-ht)/60:Fe}function xt(ht){return Math.round(je(ht)*255)}return new Ht(xt(fe+120),xt(fe),xt(fe-120))}w.hcl=rt;function rt(fe,xe,Ee){return this instanceof rt?(this.h=+fe,this.c=+xe,void(this.l=+Ee)):arguments.length<2?fe instanceof rt?new rt(fe.h,fe.c,fe.l):fe instanceof lt?ct(fe.l,fe.a,fe.b):ct((fe=mr((fe=w.rgb(fe)).r,fe.g,fe.b)).l,fe.a,fe.b):new rt(fe,xe,Ee)}var Ke=rt.prototype=new Jt;Ke.brighter=function(fe){return new rt(this.h,this.c,Math.min(100,this.l+wt*(arguments.length?fe:1)))},Ke.darker=function(fe){return new rt(this.h,this.c,Math.max(0,this.l-wt*(arguments.length?fe:1)))},Ke.rgb=function(){return st(this.h,this.c,this.l).rgb()};function st(fe,xe,Ee){return isNaN(fe)&&(fe=0),isNaN(xe)&&(xe=0),new lt(Ee,Math.cos(fe*=_t)*xe,Math.sin(fe)*xe)}w.lab=lt;function lt(fe,xe,Ee){return this instanceof lt?(this.l=+fe,this.a=+xe,void(this.b=+Ee)):arguments.length<2?fe instanceof lt?new lt(fe.l,fe.a,fe.b):fe instanceof rt?st(fe.h,fe.c,fe.l):mr((fe=Ht(fe)).r,fe.g,fe.b):new lt(fe,xe,Ee)}var wt=18,Pt=.95047,ke=1,Se=1.08883,nt=lt.prototype=new Jt;nt.brighter=function(fe){return new lt(Math.min(100,this.l+wt*(arguments.length?fe:1)),this.a,this.b)},nt.darker=function(fe){return new lt(Math.max(0,this.l-wt*(arguments.length?fe:1)),this.a,this.b)},nt.rgb=function(){return it(this.l,this.a,this.b)};function it(fe,xe,Ee){var Fe=(fe+16)/116,Ie=Fe+xe/500,je=Fe-Ee/200;return Ie=At(Ie)*Pt,Fe=At(Fe)*ke,je=At(je)*Se,new Ht(Tt(3.2404542*Ie-1.5371385*Fe-.4985314*je),Tt(-.969266*Ie+1.8760108*Fe+.041556*je),Tt(.0556434*Ie-.2040259*Fe+1.0572252*je))}function ct(fe,xe,Ee){return fe>0?new rt(Math.atan2(Ee,xe)*mt,Math.sqrt(xe*xe+Ee*Ee),fe):new rt(NaN,NaN,fe)}function At(fe){return fe>.206893034?fe*fe*fe:(fe-4/29)/7.787037}function dt(fe){return fe>.008856?Math.pow(fe,1/3):7.787037*fe+4/29}function Tt(fe){return Math.round(255*(fe<=.00304?12.92*fe:1.055*Math.pow(fe,1/2.4)-.055))}w.rgb=Ht;function Ht(fe,xe,Ee){return this instanceof Ht?(this.r=~~fe,this.g=~~xe,void(this.b=~~Ee)):arguments.length<2?fe instanceof Ht?new Ht(fe.r,fe.g,fe.b):Hr(""+fe,Ht,_r):new Ht(fe,xe,Ee)}function ir(fe){return new Ht(fe>>16,fe>>8&255,fe&255)}function kr(fe){return ir(fe)+""}var br=Ht.prototype=new Jt;br.brighter=function(fe){fe=Math.pow(.7,arguments.length?fe:1);var xe=this.r,Ee=this.g,Fe=this.b,Ie=30;return!xe&&!Ee&&!Fe?new Ht(Ie,Ie,Ie):(xe&&xe<Ie&&(xe=Ie),Ee&&Ee<Ie&&(Ee=Ie),Fe&&Fe<Ie&&(Fe=Ie),new Ht(Math.min(255,xe/fe),Math.min(255,Ee/fe),Math.min(255,Fe/fe)))},br.darker=function(fe){return fe=Math.pow(.7,arguments.length?fe:1),new Ht(fe*this.r,fe*this.g,fe*this.b)},br.hsl=function(){return nr(this.r,this.g,this.b)},br.toString=function(){return"#"+Mr(this.r)+Mr(this.g)+Mr(this.b)};function Mr(fe){return fe<16?"0"+Math.max(0,fe).toString(16):Math.min(255,fe).toString(16)}function Hr(fe,xe,Ee){var Fe=0,Ie=0,je=0,xt,ht,Ct;if(xt=/([a-z]+)\((.*)\)/.exec(fe=fe.toLowerCase()),xt)switch(ht=xt[2].split(","),xt[1]){case"hsl":return Ee(parseFloat(ht[0]),parseFloat(ht[1])/100,parseFloat(ht[2])/100);case"rgb":return xe(Nr(ht[0]),Nr(ht[1]),Nr(ht[2]))}return(Ct=Sr.get(fe))?xe(Ct.r,Ct.g,Ct.b):(fe!=null&&fe.charAt(0)==="#"&&!isNaN(Ct=parseInt(fe.slice(1),16))&&(fe.length===4?(Fe=(Ct&3840)>>4,Fe=Fe>>4|Fe,Ie=Ct&240,Ie=Ie>>4|Ie,je=Ct&15,je=je<<4|je):fe.length===7&&(Fe=(Ct&16711680)>>16,Ie=(Ct&65280)>>8,je=Ct&255)),xe(Fe,Ie,je))}function nr(fe,xe,Ee){var Fe=Math.min(fe/=255,xe/=255,Ee/=255),Ie=Math.max(fe,xe,Ee),je=Ie-Fe,xt,ht,Ct=(Ie+Fe)/2;return je?(ht=Ct<.5?je/(Ie+Fe):je/(2-Ie-Fe),fe==Ie?xt=(xe-Ee)/je+(xe<Ee?6:0):xe==Ie?xt=(Ee-fe)/je+2:xt=(fe-xe)/je+4,xt*=60):(xt=NaN,ht=Ct>0&&Ct<1?0:xt),new Zt(xt,ht,Ct)}function mr(fe,xe,Ee){fe=Pr(fe),xe=Pr(xe),Ee=Pr(Ee);var Fe=dt((.4124564*fe+.3575761*xe+.1804375*Ee)/Pt),Ie=dt((.2126729*fe+.7151522*xe+.072175*Ee)/ke),je=dt((.0193339*fe+.119192*xe+.9503041*Ee)/Se);return lt(116*Ie-16,500*(Fe-Ie),200*(Ie-je))}function Pr(fe){return(fe/=255)<=.04045?fe/12.92:Math.pow((fe+.055)/1.055,2.4)}function Nr(fe){var xe=parseFloat(fe);return fe.charAt(fe.length-1)==="%"?Math.round(xe*2.55):xe}var Sr=w.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});Sr.forEach(function(fe,xe){Sr.set(fe,ir(xe))});function tt(fe){return typeof fe=="function"?fe:function(){return fe}}w.functor=tt,w.xhr=Et(D);function Et(fe){return function(xe,Ee,Fe){return arguments.length===2&&typeof Ee=="function"&&(Fe=Ee,Ee=null),Vt(xe,Ee,fe,Fe)}}function Vt(fe,xe,Ee,Fe){var Ie={},je=w.dispatch("beforesend","progress","load","error"),xt={},ht=new XMLHttpRequest,Ct=null;self.XDomainRequest&&!("withCredentials"in ht)&&/^(http(s)?:)?\/\//.test(fe)&&(ht=new XDomainRequest),"onload"in ht?ht.onload=ht.onerror=Xt:ht.onreadystatechange=function(){ht.readyState>3&&Xt()};function Xt(){var $t=ht.status,er;if(!$t&&Cr(ht)||$t>=200&&$t<300||$t===304){try{er=Ee.call(Ie,ht)}catch(Ar){je.error.call(Ie,Ar);return}je.load.call(Ie,er)}else je.error.call(Ie,ht)}return ht.onprogress=function($t){var er=w.event;w.event=$t;try{je.progress.call(Ie,ht)}finally{w.event=er}},Ie.header=function($t,er){return $t=($t+"").toLowerCase(),arguments.length<2?xt[$t]:(er==null?delete xt[$t]:xt[$t]=er+"",Ie)},Ie.mimeType=function($t){return arguments.length?(xe=$t==null?null:$t+"",Ie):xe},Ie.responseType=function($t){return arguments.length?(Ct=$t,Ie):Ct},Ie.response=function($t){return Ee=$t,Ie},["get","post"].forEach(function($t){Ie[$t]=function(){return Ie.send.apply(Ie,[$t].concat(S(arguments)))}}),Ie.send=function($t,er,Ar){if(arguments.length===2&&typeof er=="function"&&(Ar=er,er=null),ht.open($t,fe,!0),xe!=null&&!("accept"in xt)&&(xt.accept=xe+",*/*"),ht.setRequestHeader)for(var Jr in xt)ht.setRequestHeader(Jr,xt[Jr]);return xe!=null&&ht.overrideMimeType&&ht.overrideMimeType(xe),Ct!=null&&(ht.responseType=Ct),Ar!=null&&Ie.on("error",Ar).on("load",function(sn){Ar(null,sn)}),je.beforesend.call(Ie,ht),ht.send(er==null?null:er),Ie},Ie.abort=function(){return ht.abort(),Ie},w.rebind(Ie,je,"on"),Fe==null?Ie:Ie.get(ar(Fe))}function ar(fe){return fe.length===1?function(xe,Ee){fe(xe==null?Ee:null)}:fe}function Cr(fe){var xe=fe.responseType;return xe&&xe!=="text"?fe.response:fe.responseText}w.dsv=function(fe,xe){var Ee=new RegExp('["'+fe+`
]`),Fe=fe.charCodeAt(0);function Ie(Xt,$t,er){arguments.length<3&&(er=$t,$t=null);var Ar=Vt(Xt,xe,$t==null?je:xt($t),er);return Ar.row=function(Jr){return arguments.length?Ar.response(($t=Jr)==null?je:xt(Jr)):$t},Ar}function je(Xt){return Ie.parse(Xt.responseText)}function xt(Xt){return function($t){return Ie.parse($t.responseText,Xt)}}Ie.parse=function(Xt,$t){var er;return Ie.parseRows(Xt,function(Ar,Jr){if(er)return er(Ar,Jr-1);var sn=function(Lr){for(var Br={},Zr=Ar.length,nn=0;nn<Zr;++nn)Br[Ar[nn]]=Lr[nn];return Br};er=$t?function(Lr,Br){return $t(sn(Lr),Br)}:sn})},Ie.parseRows=function(Xt,$t){var er={},Ar={},Jr=[],sn=Xt.length,Lr=0,Br=0,Zr,nn;function on(){if(Lr>=sn)return Ar;if(nn)return nn=!1,er;var Un=Lr;if(Xt.charCodeAt(Un)===34){for(var ra=Un;ra++<sn;)if(Xt.charCodeAt(ra)===34){if(Xt.charCodeAt(ra+1)!==34)break;++ra}Lr=ra+2;var _a=Xt.charCodeAt(ra+1);return _a===13?(nn=!0,Xt.charCodeAt(ra+2)===10&&++Lr):_a===10&&(nn=!0),Xt.slice(Un+1,ra).replace(/""/g,'"')}for(;Lr<sn;){var _a=Xt.charCodeAt(Lr++),ia=1;if(_a===10)nn=!0;else if(_a===13)nn=!0,Xt.charCodeAt(Lr)===10&&(++Lr,++ia);else if(_a!==Fe)continue;return Xt.slice(Un,Lr-ia)}return Xt.slice(Un)}for(;(Zr=on())!==Ar;){for(var jr=[];Zr!==er&&Zr!==Ar;)jr.push(Zr),Zr=on();$t&&(jr=$t(jr,Br++))==null||Jr.push(jr)}return Jr},Ie.format=function(Xt){if(Array.isArray(Xt[0]))return Ie.formatRows(Xt);var $t=new I,er=[];return Xt.forEach(function(Ar){for(var Jr in Ar)$t.has(Jr)||er.push($t.add(Jr))}),[er.map(Ct).join(fe)].concat(Xt.map(function(Ar){return er.map(function(Jr){return Ct(Ar[Jr])}).join(fe)})).join(`
`)},Ie.formatRows=function(Xt){return Xt.map(ht).join(`
`)};function ht(Xt){return Xt.map(Ct).join(fe)}function Ct(Xt){return Ee.test(Xt)?'"'+Xt.replace(/\"/g,'""')+'"':Xt}return Ie},w.csv=w.dsv(",","text/csv"),w.tsv=w.dsv("	","text/tab-separated-values");var Or,Ir,Tr,Wr,wn=this[B(this,"requestAnimationFrame")]||function(fe){setTimeout(fe,17)};w.timer=function(){ln.apply(this,arguments)};function ln(fe,xe,Ee){var Fe=arguments.length;Fe<2&&(xe=0),Fe<3&&(Ee=Date.now());var Ie=Ee+xe,je={c:fe,t:Ie,n:null};return Ir?Ir.n=je:Or=je,Ir=je,Tr||(Wr=clearTimeout(Wr),Tr=1,wn(Bn)),je}function Bn(){var fe=Cn(),xe=Wn()-fe;xe>24?(isFinite(xe)&&(clearTimeout(Wr),Wr=setTimeout(Bn,xe)),Tr=0):(Tr=1,wn(Bn))}w.timer.flush=function(){Cn(),Wn()};function Cn(){for(var fe=Date.now(),xe=Or;xe;)fe>=xe.t&&xe.c(fe-xe.t)&&(xe.c=null),xe=xe.n;return fe}function Wn(){for(var fe,xe=Or,Ee=1/0;xe;)xe.c?(xe.t<Ee&&(Ee=xe.t),xe=(fe=xe).n):xe=fe?fe.n=xe.n:Or=xe.n;return Ir=fe,Ee}w.round=function(fe,xe){return xe?Math.round(fe*(xe=Math.pow(10,xe)))/xe:Math.round(fe)},w.geom={};function Hn(fe){return fe[0]}function ga(fe){return fe[1]}w.geom.hull=function(fe){var xe=Hn,Ee=ga;if(arguments.length)return Fe(fe);function Fe(Ie){if(Ie.length<3)return[];var je=tt(xe),xt=tt(Ee),ht,Ct=Ie.length,Xt=[],$t=[];for(ht=0;ht<Ct;ht++)Xt.push([+je.call(this,Ie[ht],ht),+xt.call(this,Ie[ht],ht),ht]);for(Xt.sort(ci),ht=0;ht<Ct;ht++)$t.push([Xt[ht][0],-Xt[ht][1]]);var er=La(Xt),Ar=La($t),Jr=Ar[0]===er[0],sn=Ar[Ar.length-1]===er[er.length-1],Lr=[];for(ht=er.length-1;ht>=0;--ht)Lr.push(Ie[Xt[er[ht]][2]]);for(ht=+Jr;ht<Ar.length-sn;++ht)Lr.push(Ie[Xt[Ar[ht]][2]]);return Lr}return Fe.x=function(Ie){return arguments.length?(xe=Ie,Fe):xe},Fe.y=function(Ie){return arguments.length?(Ee=Ie,Fe):Ee},Fe};function La(fe){for(var xe=fe.length,Ee=[0,1],Fe=2,Ie=2;Ie<xe;Ie++){for(;Fe>1&&Ot(fe[Ee[Fe-2]],fe[Ee[Fe-1]],fe[Ie])<=0;)--Fe;Ee[Fe++]=Ie}return Ee.slice(0,Fe)}function ci(fe,xe){return fe[0]-xe[0]||fe[1]-xe[1]}w.geom.polygon=function(fe){return re(fe,Va),fe};var Va=w.geom.polygon.prototype=[];Va.area=function(){for(var fe=-1,xe=this.length,Ee,Fe=this[xe-1],Ie=0;++fe<xe;)Ee=Fe,Fe=this[fe],Ie+=Ee[1]*Fe[0]-Ee[0]*Fe[1];return Ie*.5},Va.centroid=function(fe){var xe=-1,Ee=this.length,Fe=0,Ie=0,je,xt=this[Ee-1],ht;for(arguments.length||(fe=-1/(6*this.area()));++xe<Ee;)je=xt,xt=this[xe],ht=je[0]*xt[1]-xt[0]*je[1],Fe+=(je[0]+xt[0])*ht,Ie+=(je[1]+xt[1])*ht;return[Fe*fe,Ie*fe]},Va.clip=function(fe){for(var xe,Ee=wr(fe),Fe=-1,Ie=this.length-wr(this),je,xt,ht=this[Ie-1],Ct,Xt,$t;++Fe<Ie;){for(xe=fe.slice(),fe.length=0,Ct=this[Fe],Xt=xe[(xt=xe.length-Ee)-1],je=-1;++je<xt;)$t=xe[je],ja($t,ht,Ct)?(ja(Xt,ht,Ct)||fe.push(Wa(Xt,$t,ht,Ct)),fe.push($t)):ja(Xt,ht,Ct)&&fe.push(Wa(Xt,$t,ht,Ct)),Xt=$t;Ee&&fe.push(fe[0]),ht=Ct}return fe};function ja(fe,xe,Ee){return(Ee[0]-xe[0])*(fe[1]-xe[1])<(Ee[1]-xe[1])*(fe[0]-xe[0])}function Wa(fe,xe,Ee,Fe){var Ie=fe[0],je=Ee[0],xt=xe[0]-Ie,ht=Fe[0]-je,Ct=fe[1],Xt=Ee[1],$t=xe[1]-Ct,er=Fe[1]-Xt,Ar=(ht*(Ct-Xt)-er*(Ie-je))/(er*xt-ht*$t);return[Ie+Ar*xt,Ct+Ar*$t]}function wr(fe){var xe=fe[0],Ee=fe[fe.length-1];return!(xe[0]-Ee[0]||xe[1]-Ee[1])}var pn,fn,An,Zn=[],ua,ea,Rn=[];function Xn(){sa(this),this.edge=this.site=this.circle=null}function Ua(fe){var xe=Zn.pop()||new Xn;return xe.site=fe,xe}function li(fe){yr(fe),An.remove(fe),Zn.push(fe),sa(fe)}function Bt(fe){var xe=fe.circle,Ee=xe.x,Fe=xe.cy,Ie={x:Ee,y:Fe},je=fe.P,xt=fe.N,ht=[fe];li(fe);for(var Ct=je;Ct.circle&&u(Ee-Ct.circle.x)<qe&&u(Fe-Ct.circle.cy)<qe;)je=Ct.P,ht.unshift(Ct),li(Ct),Ct=je;ht.unshift(Ct),yr(Ct);for(var Xt=xt;Xt.circle&&u(Ee-Xt.circle.x)<qe&&u(Fe-Xt.circle.cy)<qe;)xt=Xt.N,ht.push(Xt),li(Xt),Xt=xt;ht.push(Xt),yr(Xt);var $t=ht.length,er;for(er=1;er<$t;++er)Xt=ht[er],Ct=ht[er-1],aa(Xt.edge,Ct.site,Xt.site,Ie);Ct=ht[0],Xt=ht[$t-1],Xt.edge=_n(Ct.site,Xt.site,null,Ie),gr(Ct),gr(Xt)}function hr(fe){for(var xe=fe.x,Ee=fe.y,Fe,Ie,je,xt,ht=An._;ht;)if(je=rn(ht,Ee)-xe,je>qe)ht=ht.L;else if(xt=xe-vn(ht,Ee),xt>qe){if(!ht.R){Fe=ht;break}ht=ht.R}else{je>-qe?(Fe=ht.P,Ie=ht):xt>-qe?(Fe=ht,Ie=ht.N):Fe=Ie=ht;break}var Ct=Ua(fe);if(An.insert(Fe,Ct),!(!Fe&&!Ie)){if(Fe===Ie){yr(Fe),Ie=Ua(Fe.site),An.insert(Ct,Ie),Ct.edge=Ie.edge=_n(Fe.site,Ct.site),gr(Fe),gr(Ie);return}if(!Ie){Ct.edge=_n(Fe.site,Ct.site);return}yr(Fe),yr(Ie);var Xt=Fe.site,$t=Xt.x,er=Xt.y,Ar=fe.x-$t,Jr=fe.y-er,sn=Ie.site,Lr=sn.x-$t,Br=sn.y-er,Zr=2*(Ar*Br-Jr*Lr),nn=Ar*Ar+Jr*Jr,on=Lr*Lr+Br*Br,jr={x:(Br*nn-Jr*on)/Zr+$t,y:(Ar*on-Lr*nn)/Zr+er};aa(Ie.edge,Xt,sn,jr),Ct.edge=_n(Xt,fe,null,jr),Ie.edge=_n(fe,sn,null,jr),gr(Fe),gr(Ie)}}function rn(fe,xe){var Ee=fe.site,Fe=Ee.x,Ie=Ee.y,je=Ie-xe;if(!je)return Fe;var xt=fe.P;if(!xt)return-1/0;Ee=xt.site;var ht=Ee.x,Ct=Ee.y,Xt=Ct-xe;if(!Xt)return ht;var $t=ht-Fe,er=1/je-1/Xt,Ar=$t/Xt;return er?(-Ar+Math.sqrt(Ar*Ar-2*er*($t*$t/(-2*Xt)-Ct+Xt/2+Ie-je/2)))/er+Fe:(Fe+ht)/2}function vn(fe,xe){var Ee=fe.N;if(Ee)return rn(Ee,xe);var Fe=fe.site;return Fe.y===xe?Fe.x:1/0}function en(fe){this.site=fe,this.edges=[]}en.prototype.prepare=function(){for(var fe=this.edges,xe=fe.length,Ee;xe--;)Ee=fe[xe].edge,(!Ee.b||!Ee.a)&&fe.splice(xe,1);return fe.sort(xn),fe.length};function Tn(fe){for(var xe=fe[0][0],Ee=fe[1][0],Fe=fe[0][1],Ie=fe[1][1],je,xt,ht,Ct,Xt=fn,$t=Xt.length,er,Ar,Jr,sn,Lr,Br;$t--;)if(er=Xt[$t],!(!er||!er.prepare()))for(Jr=er.edges,sn=Jr.length,Ar=0;Ar<sn;)Br=Jr[Ar].end(),ht=Br.x,Ct=Br.y,Lr=Jr[++Ar%sn].start(),je=Lr.x,xt=Lr.y,(u(ht-je)>qe||u(Ct-xt)>qe)&&(Jr.splice(Ar,0,new pa(jn(er.site,Br,u(ht-xe)<qe&&Ie-Ct>qe?{x:xe,y:u(je-xe)<qe?xt:Ie}:u(Ct-Ie)<qe&&Ee-ht>qe?{x:u(xt-Ie)<qe?je:Ee,y:Ie}:u(ht-Ee)<qe&&Ct-Fe>qe?{x:Ee,y:u(je-Ee)<qe?xt:Fe}:u(Ct-Fe)<qe&&ht-xe>qe?{x:u(xt-Fe)<qe?je:xe,y:Fe}:null),er.site,null)),++sn)}function xn(fe,xe){return xe.angle-fe.angle}function un(){sa(this),this.x=this.y=this.arc=this.site=this.cy=null}function gr(fe){var xe=fe.P,Ee=fe.N;if(!(!xe||!Ee)){var Fe=xe.site,Ie=fe.site,je=Ee.site;if(Fe!==je){var xt=Ie.x,ht=Ie.y,Ct=Fe.x-xt,Xt=Fe.y-ht,$t=je.x-xt,Br=je.y-ht,er=2*(Ct*Br-Xt*$t);if(!(er>=-Ve)){var Ar=Ct*Ct+Xt*Xt,Jr=$t*$t+Br*Br,sn=(Br*Ar-Xt*Jr)/er,Lr=(Ct*Jr-$t*Ar)/er,Br=Lr+ht,Zr=Rn.pop()||new un;Zr.arc=fe,Zr.site=Ie,Zr.x=sn+xt,Zr.y=Br+Math.sqrt(sn*sn+Lr*Lr),Zr.cy=Br,fe.circle=Zr;for(var nn=null,on=ea._;on;)if(Zr.y<on.y||Zr.y===on.y&&Zr.x<=on.x)if(on.L)on=on.L;else{nn=on.P;break}else if(on.R)on=on.R;else{nn=on;break}ea.insert(nn,Zr),nn||(ua=Zr)}}}}function yr(fe){var xe=fe.circle;xe&&(xe.P||(ua=xe.N),ea.remove(xe),Rn.push(xe),sa(xe),fe.circle=null)}function zr(fe,xe,Ee,Fe){return function(Ie){var je=Ie.a,xt=Ie.b,ht=je.x,Ct=je.y,Xt=xt.x,$t=xt.y,er=0,Ar=1,Jr=Xt-ht,sn=$t-Ct,Lr;if(Lr=fe-ht,!(!Jr&&Lr>0)){if(Lr/=Jr,Jr<0){if(Lr<er)return;Lr<Ar&&(Ar=Lr)}else if(Jr>0){if(Lr>Ar)return;Lr>er&&(er=Lr)}if(Lr=Ee-ht,!(!Jr&&Lr<0)){if(Lr/=Jr,Jr<0){if(Lr>Ar)return;Lr>er&&(er=Lr)}else if(Jr>0){if(Lr<er)return;Lr<Ar&&(Ar=Lr)}if(Lr=xe-Ct,!(!sn&&Lr>0)){if(Lr/=sn,sn<0){if(Lr<er)return;Lr<Ar&&(Ar=Lr)}else if(sn>0){if(Lr>Ar)return;Lr>er&&(er=Lr)}if(Lr=Fe-Ct,!(!sn&&Lr<0)){if(Lr/=sn,sn<0){if(Lr>Ar)return;Lr>er&&(er=Lr)}else if(sn>0){if(Lr<er)return;Lr<Ar&&(Ar=Lr)}return er>0&&(Ie.a={x:ht+er*Jr,y:Ct+er*sn}),Ar<1&&(Ie.b={x:ht+Ar*Jr,y:Ct+Ar*sn}),Ie}}}}}}function gn(fe){for(var xe=pn,Ee=zr(fe[0][0],fe[0][1],fe[1][0],fe[1][1]),Fe=xe.length,Ie;Fe--;)Ie=xe[Fe],(!On(Ie,fe)||!Ee(Ie)||u(Ie.a.x-Ie.b.x)<qe&&u(Ie.a.y-Ie.b.y)<qe)&&(Ie.a=Ie.b=null,xe.splice(Fe,1))}function On(fe,xe){var Ee=fe.b;if(Ee)return!0;var Fe=fe.a,Ie=xe[0][0],je=xe[1][0],xt=xe[0][1],ht=xe[1][1],Ct=fe.l,Xt=fe.r,$t=Ct.x,er=Ct.y,Ar=Xt.x,Jr=Xt.y,sn=($t+Ar)/2,Lr=(er+Jr)/2,Br,Zr;if(Jr===er){if(sn<Ie||sn>=je)return;if($t>Ar){if(!Fe)Fe={x:sn,y:xt};else if(Fe.y>=ht)return;Ee={x:sn,y:ht}}else{if(!Fe)Fe={x:sn,y:ht};else if(Fe.y<xt)return;Ee={x:sn,y:xt}}}else if(Br=($t-Ar)/(Jr-er),Zr=Lr-Br*sn,Br<-1||Br>1)if($t>Ar){if(!Fe)Fe={x:(xt-Zr)/Br,y:xt};else if(Fe.y>=ht)return;Ee={x:(ht-Zr)/Br,y:ht}}else{if(!Fe)Fe={x:(ht-Zr)/Br,y:ht};else if(Fe.y<xt)return;Ee={x:(xt-Zr)/Br,y:xt}}else if(er<Jr){if(!Fe)Fe={x:Ie,y:Br*Ie+Zr};else if(Fe.x>=je)return;Ee={x:je,y:Br*je+Zr}}else{if(!Fe)Fe={x:je,y:Br*je+Zr};else if(Fe.x<Ie)return;Ee={x:Ie,y:Br*Ie+Zr}}return fe.a=Fe,fe.b=Ee,!0}function ta(fe,xe){this.l=fe,this.r=xe,this.a=this.b=null}function _n(fe,xe,Ee,Fe){var Ie=new ta(fe,xe);return pn.push(Ie),Ee&&aa(Ie,fe,xe,Ee),Fe&&aa(Ie,xe,fe,Fe),fn[fe.i].edges.push(new pa(Ie,fe,xe)),fn[xe.i].edges.push(new pa(Ie,xe,fe)),Ie}function jn(fe,xe,Ee){var Fe=new ta(fe,null);return Fe.a=xe,Fe.b=Ee,pn.push(Fe),Fe}function aa(fe,xe,Ee,Fe){!fe.a&&!fe.b?(fe.a=Fe,fe.l=xe,fe.r=Ee):fe.l===Ee?fe.b=Fe:fe.a=Fe}function pa(fe,xe,Ee){var Fe=fe.a,Ie=fe.b;this.edge=fe,this.site=xe,this.angle=Ee?Math.atan2(Ee.y-xe.y,Ee.x-xe.x):fe.l===xe?Math.atan2(Ie.x-Fe.x,Fe.y-Ie.y):Math.atan2(Fe.x-Ie.x,Ie.y-Fe.y)}pa.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}};function ma(){this._=null}function sa(fe){fe.U=fe.C=fe.L=fe.R=fe.P=fe.N=null}ma.prototype={insert:function(fe,xe){var Ee,Fe,Ie;if(fe){if(xe.P=fe,xe.N=fe.N,fe.N&&(fe.N.P=xe),fe.N=xe,fe.R){for(fe=fe.R;fe.L;)fe=fe.L;fe.L=xe}else fe.R=xe;Ee=fe}else this._?(fe=Ro(this._),xe.P=null,xe.N=fe,fe.P=fe.L=xe,Ee=fe):(xe.P=xe.N=null,this._=xe,Ee=null);for(xe.L=xe.R=null,xe.U=Ee,xe.C=!0,fe=xe;Ee&&Ee.C;)Fe=Ee.U,Ee===Fe.L?(Ie=Fe.R,Ie&&Ie.C?(Ee.C=Ie.C=!1,Fe.C=!0,fe=Fe):(fe===Ee.R&&(Aa(this,Ee),fe=Ee,Ee=fe.U),Ee.C=!1,Fe.C=!0,ho(this,Fe))):(Ie=Fe.L,Ie&&Ie.C?(Ee.C=Ie.C=!1,Fe.C=!0,fe=Fe):(fe===Ee.L&&(ho(this,Ee),fe=Ee,Ee=fe.U),Ee.C=!1,Fe.C=!0,Aa(this,Fe))),Ee=fe.U;this._.C=!1},remove:function(fe){fe.N&&(fe.N.P=fe.P),fe.P&&(fe.P.N=fe.N),fe.N=fe.P=null;var xe=fe.U,Ee,Fe=fe.L,Ie=fe.R,je,xt;if(Fe?Ie?je=Ro(Ie):je=Fe:je=Ie,xe?xe.L===fe?xe.L=je:xe.R=je:this._=je,Fe&&Ie?(xt=je.C,je.C=fe.C,je.L=Fe,Fe.U=je,je!==Ie?(xe=je.U,je.U=fe.U,fe=je.R,xe.L=fe,je.R=Ie,Ie.U=je):(je.U=xe,xe=je,fe=je.R)):(xt=fe.C,fe=je),fe&&(fe.U=xe),!xt){if(fe&&fe.C){fe.C=!1;return}do{if(fe===this._)break;if(fe===xe.L){if(Ee=xe.R,Ee.C&&(Ee.C=!1,xe.C=!0,Aa(this,xe),Ee=xe.R),Ee.L&&Ee.L.C||Ee.R&&Ee.R.C){(!Ee.R||!Ee.R.C)&&(Ee.L.C=!1,Ee.C=!0,ho(this,Ee),Ee=xe.R),Ee.C=xe.C,xe.C=Ee.R.C=!1,Aa(this,xe),fe=this._;break}}else if(Ee=xe.L,Ee.C&&(Ee.C=!1,xe.C=!0,ho(this,xe),Ee=xe.L),Ee.L&&Ee.L.C||Ee.R&&Ee.R.C){(!Ee.L||!Ee.L.C)&&(Ee.R.C=!1,Ee.C=!0,Aa(this,Ee),Ee=xe.L),Ee.C=xe.C,xe.C=Ee.L.C=!1,ho(this,xe),fe=this._;break}Ee.C=!0,fe=xe,xe=xe.U}while(!fe.C);fe&&(fe.C=!1)}}};function Aa(fe,xe){var Ee=xe,Fe=xe.R,Ie=Ee.U;Ie?Ie.L===Ee?Ie.L=Fe:Ie.R=Fe:fe._=Fe,Fe.U=Ie,Ee.U=Fe,Ee.R=Fe.L,Ee.R&&(Ee.R.U=Ee),Fe.L=Ee}function ho(fe,xe){var Ee=xe,Fe=xe.L,Ie=Ee.U;Ie?Ie.L===Ee?Ie.L=Fe:Ie.R=Fe:fe._=Fe,Fe.U=Ie,Ee.U=Fe,Ee.L=Fe.R,Ee.L&&(Ee.L.U=Ee),Fe.R=Ee}function Ro(fe){for(;fe.L;)fe=fe.L;return fe}function jo(fe,xe){var Ee=fe.sort(rl).pop(),Fe,Ie,je;for(pn=[],fn=new Array(fe.length),An=new ma,ea=new ma;;)if(je=ua,Ee&&(!je||Ee.y<je.y||Ee.y===je.y&&Ee.x<je.x))(Ee.x!==Fe||Ee.y!==Ie)&&(fn[Ee.i]=new en(Ee),hr(Ee),Fe=Ee.x,Ie=Ee.y),Ee=fe.pop();else if(je)Bt(je.arc);else break;xe&&(gn(xe),Tn(xe));var xt={cells:fn,edges:pn};return An=ea=pn=fn=null,xt}function rl(fe,xe){return xe.y-fe.y||xe.x-fe.x}w.geom.voronoi=function(fe){var xe=Hn,Ee=ga,Fe=xe,Ie=Ee,je=vl;if(fe)return xt(fe);function xt(Ct){var Xt=new Array(Ct.length),$t=je[0][0],er=je[0][1],Ar=je[1][0],Jr=je[1][1];return jo(ht(Ct),je).cells.forEach(function(sn,Lr){var Br=sn.edges,Zr=sn.site,nn=Xt[Lr]=Br.length?Br.map(function(on){var jr=on.start();return[jr.x,jr.y]}):Zr.x>=$t&&Zr.x<=Ar&&Zr.y>=er&&Zr.y<=Jr?[[$t,Jr],[Ar,Jr],[Ar,er],[$t,er]]:[];nn.point=Ct[Lr]}),Xt}function ht(Ct){return Ct.map(function(Xt,$t){return{x:Math.round(Fe(Xt,$t)/qe)*qe,y:Math.round(Ie(Xt,$t)/qe)*qe,i:$t}})}return xt.links=function(Ct){return jo(ht(Ct)).edges.filter(function(Xt){return Xt.l&&Xt.r}).map(function(Xt){return{source:Ct[Xt.l.i],target:Ct[Xt.r.i]}})},xt.triangles=function(Ct){var Xt=[];return jo(ht(Ct)).cells.forEach(function($t,er){for(var Ar=$t.site,Jr=$t.edges.sort(xn),sn=-1,Lr=Jr.length,Br,Zr=Jr[Lr-1].edge,nn=Zr.l===Ar?Zr.r:Zr.l;++sn<Lr;)Br=nn,Zr=Jr[sn].edge,nn=Zr.l===Ar?Zr.r:Zr.l,er<Br.i&&er<nn.i&&Gl(Ar,Br,nn)<0&&Xt.push([Ct[er],Ct[Br.i],Ct[nn.i]])}),Xt},xt.x=function(Ct){return arguments.length?(Fe=tt(xe=Ct),xt):xe},xt.y=function(Ct){return arguments.length?(Ie=tt(Ee=Ct),xt):Ee},xt.clipExtent=function(Ct){return arguments.length?(je=Ct==null?vl:Ct,xt):je===vl?null:je},xt.size=function(Ct){return arguments.length?xt.clipExtent(Ct&&[[0,0],Ct]):je===vl?null:je&&je[1]},xt};var vl=[[-1e6,-1e6],[1e6,1e6]];function Gl(fe,xe,Ee){return(fe.x-Ee.x)*(xe.y-fe.y)-(fe.x-xe.x)*(Ee.y-fe.y)}w.geom.delaunay=function(fe){return w.geom.voronoi().triangles(fe)},w.geom.quadtree=function(fe,xe,Ee,Fe,Ie){var je=Hn,xt=ga,ht;if(ht=arguments.length)return je=vi,xt=Vs,ht===3&&(Ie=Ee,Fe=xe,Ee=xe=0),Ct(fe);function Ct(Xt){var $t,er=tt(je),Ar=tt(xt),Jr,sn,Lr,Br,Zr,nn,on,jr;if(xe!=null)Zr=xe,nn=Ee,on=Fe,jr=Ie;else if(on=jr=-(Zr=nn=1/0),Jr=[],sn=[],Br=Xt.length,ht)for(Lr=0;Lr<Br;++Lr)$t=Xt[Lr],$t.x<Zr&&(Zr=$t.x),$t.y<nn&&(nn=$t.y),$t.x>on&&(on=$t.x),$t.y>jr&&(jr=$t.y),Jr.push($t.x),sn.push($t.y);else for(Lr=0;Lr<Br;++Lr){var Un=+er($t=Xt[Lr],Lr),ra=+Ar($t,Lr);Un<Zr&&(Zr=Un),ra<nn&&(nn=ra),Un>on&&(on=Un),ra>jr&&(jr=ra),Jr.push(Un),sn.push(ra)}var _a=on-Zr,ia=jr-nn;_a>ia?jr=nn+_a:on=Zr+ia;function Sa(Pa,$a,yi,fo,Ii,fa,ai,Xa){if(!(isNaN(yi)||isNaN(fo)))if(Pa.leaf){var Si=Pa.x,si=Pa.y;if(Si!=null)if(u(Si-yi)+u(si-fo)<.01)la(Pa,$a,yi,fo,Ii,fa,ai,Xa);else{var io=Pa.point;Pa.x=Pa.y=Pa.point=null,la(Pa,io,Si,si,Ii,fa,ai,Xa),la(Pa,$a,yi,fo,Ii,fa,ai,Xa)}else Pa.x=yi,Pa.y=fo,Pa.point=$a}else la(Pa,$a,yi,fo,Ii,fa,ai,Xa)}function la(Pa,$a,yi,fo,Ii,fa,ai,Xa){var Si=(Ii+ai)*.5,si=(fa+Xa)*.5,io=yi>=Si,Qi=fo>=si,go=Qi<<1|io;Pa.leaf=!1,Pa=Pa.nodes[go]||(Pa.nodes[go]=Ds()),io?Ii=Si:ai=Si,Qi?fa=si:Xa=si,Sa(Pa,$a,yi,fo,Ii,fa,ai,Xa)}var Na=Ds();if(Na.add=function(Pa){Sa(Na,Pa,+er(Pa,++Lr),+Ar(Pa,Lr),Zr,nn,on,jr)},Na.visit=function(Pa){Ui(Pa,Na,Zr,nn,on,jr)},Na.find=function(Pa){return Ao(Na,Pa[0],Pa[1],Zr,nn,on,jr)},Lr=-1,xe==null){for(;++Lr<Br;)Sa(Na,Xt[Lr],Jr[Lr],sn[Lr],Zr,nn,on,jr);--Lr}else Xt.forEach(Na.add);return Jr=sn=Xt=$t=null,Na}return Ct.x=function(Xt){return arguments.length?(je=Xt,Ct):je},Ct.y=function(Xt){return arguments.length?(xt=Xt,Ct):xt},Ct.extent=function(Xt){return arguments.length?(Xt==null?xe=Ee=Fe=Ie=null:(xe=+Xt[0][0],Ee=+Xt[0][1],Fe=+Xt[1][0],Ie=+Xt[1][1]),Ct):xe==null?null:[[xe,Ee],[Fe,Ie]]},Ct.size=function(Xt){return arguments.length?(Xt==null?xe=Ee=Fe=Ie=null:(xe=Ee=0,Fe=+Xt[0],Ie=+Xt[1]),Ct):xe==null?null:[Fe-xe,Ie-Ee]},Ct};function vi(fe){return fe.x}function Vs(fe){return fe.y}function Ds(){return{leaf:!0,nodes:[],point:null,x:null,y:null}}function Ui(fe,xe,Ee,Fe,Ie,je){if(!fe(xe,Ee,Fe,Ie,je)){var xt=(Ee+Ie)*.5,ht=(Fe+je)*.5,Ct=xe.nodes;Ct[0]&&Ui(fe,Ct[0],Ee,Fe,xt,ht),Ct[1]&&Ui(fe,Ct[1],xt,Fe,Ie,ht),Ct[2]&&Ui(fe,Ct[2],Ee,ht,xt,je),Ct[3]&&Ui(fe,Ct[3],xt,ht,Ie,je)}}function Ao(fe,xe,Ee,Fe,Ie,je,xt){var ht=1/0,Ct;return function Xt($t,er,Ar,Jr,sn){if(!(er>je||Ar>xt||Jr<Fe||sn<Ie)){if(Lr=$t.point){var Lr,Br=xe-$t.x,Zr=Ee-$t.y,nn=Br*Br+Zr*Zr;if(nn<ht){var on=Math.sqrt(ht=nn);Fe=xe-on,Ie=Ee-on,je=xe+on,xt=Ee+on,Ct=Lr}}for(var jr=$t.nodes,Un=(er+Jr)*.5,ra=(Ar+sn)*.5,_a=xe>=Un,ia=Ee>=ra,Sa=ia<<1|_a,la=Sa+4;Sa<la;++Sa)if($t=jr[Sa&3])switch(Sa&3){case 0:Xt($t,er,Ar,Un,ra);break;case 1:Xt($t,Un,Ar,Jr,ra);break;case 2:Xt($t,er,ra,Un,sn);break;case 3:Xt($t,Un,ra,Jr,sn);break}}}(fe,Fe,Ie,je,xt),Ct}w.interpolateRgb=pl;function pl(fe,xe){fe=w.rgb(fe),xe=w.rgb(xe);var Ee=fe.r,Fe=fe.g,Ie=fe.b,je=xe.r-Ee,xt=xe.g-Fe,ht=xe.b-Ie;return function(Ct){return"#"+Mr(Math.round(Ee+je*Ct))+Mr(Math.round(Fe+xt*Ct))+Mr(Math.round(Ie+ht*Ct))}}w.interpolateObject=vs;function vs(fe,xe){var Ee={},Fe={},Ie;for(Ie in fe)Ie in xe?Ee[Ie]=no(fe[Ie],xe[Ie]):Fe[Ie]=fe[Ie];for(Ie in xe)Ie in fe||(Fe[Ie]=xe[Ie]);return function(je){for(Ie in Ee)Fe[Ie]=Ee[Ie](je);return Fe}}w.interpolateNumber=Di;function Di(fe,xe){return fe=+fe,xe=+xe,function(Ee){return fe*(1-Ee)+xe*Ee}}w.interpolateString=nl;function nl(fe,xe){var Ee=Ki.lastIndex=Fi.lastIndex=0,Fe,Ie,je,xt=-1,ht=[],Ct=[];for(fe=fe+"",xe=xe+"";(Fe=Ki.exec(fe))&&(Ie=Fi.exec(xe));)(je=Ie.index)>Ee&&(je=xe.slice(Ee,je),ht[xt]?ht[xt]+=je:ht[++xt]=je),(Fe=Fe[0])===(Ie=Ie[0])?ht[xt]?ht[xt]+=Ie:ht[++xt]=Ie:(ht[++xt]=null,Ct.push({i:xt,x:Di(Fe,Ie)})),Ee=Fi.lastIndex;return Ee<xe.length&&(je=xe.slice(Ee),ht[xt]?ht[xt]+=je:ht[++xt]=je),ht.length<2?Ct[0]?(xe=Ct[0].x,function(Xt){return xe(Xt)+""}):function(){return xe}:(xe=Ct.length,function(Xt){for(var $t=0,er;$t<xe;++$t)ht[(er=Ct[$t]).i]=er.x(Xt);return ht.join("")})}var Ki=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Fi=new RegExp(Ki.source,"g");w.interpolate=no;function no(fe,xe){for(var Ee=w.interpolators.length,Fe;--Ee>=0&&!(Fe=w.interpolators[Ee](fe,xe)););return Fe}w.interpolators=[function(fe,xe){var Ee=typeof xe;return(Ee==="string"?Sr.has(xe.toLowerCase())||/^(#|rgb\(|hsl\()/i.test(xe)?pl:nl:xe instanceof Jt?pl:Array.isArray(xe)?Ji:Ee==="object"&&isNaN(xe)?vs:Di)(fe,xe)}],w.interpolateArray=Ji;function Ji(fe,xe){var Ee=[],Fe=[],Ie=fe.length,je=xe.length,xt=Math.min(fe.length,xe.length),ht;for(ht=0;ht<xt;++ht)Ee.push(no(fe[ht],xe[ht]));for(;ht<Ie;++ht)Fe[ht]=fe[ht];for(;ht<je;++ht)Fe[ht]=xe[ht];return function(Ct){for(ht=0;ht<xt;++ht)Fe[ht]=Ee[ht](Ct);return Fe}}var ts=function(){return D},Gs=w.map({linear:ts,poly:_s,quad:function(){return Mo},cubic:function(){return Mu},sin:function(){return Cl},exp:function(){return Su},circle:function(){return ku},elastic:Ys,back:Ll,bounce:function(){return ws}}),nu=w.map({in:D,out:au,"in-out":Rs,"out-in":function(fe){return Rs(au(fe))}});w.ease=function(fe){var xe=fe.indexOf("-"),Ee=xe>=0?fe.slice(0,xe):fe,Fe=xe>=0?fe.slice(xe+1):"in";return Ee=Gs.get(Ee)||ts,Fe=nu.get(Fe)||D,Ko(Fe(Ee.apply(null,v.call(arguments,1))))};function Ko(fe){return function(xe){return xe<=0?0:xe>=1?1:fe(xe)}}function au(fe){return function(xe){return 1-fe(1-xe)}}function Rs(fe){return function(xe){return .5*(xe<.5?fe(2*xe):2-fe(2-2*xe))}}function Mo(fe){return fe*fe}function Mu(fe){return fe*fe*fe}function Is(fe){if(fe<=0)return 0;if(fe>=1)return 1;var xe=fe*fe,Ee=xe*fe;return 4*(fe<.5?Ee:3*(fe-xe)+Ee-.75)}function _s(fe){return function(xe){return Math.pow(xe,fe)}}function Cl(fe){return 1-Math.cos(fe*Je)}function Su(fe){return Math.pow(2,10*(fe-1))}function ku(fe){return 1-Math.sqrt(1-fe*fe)}function Ys(fe,xe){var Ee;return arguments.length<2&&(xe=.45),arguments.length?Ee=xe/Ne*Math.asin(1/fe):(fe=1,Ee=xe/4),function(Fe){return 1+fe*Math.pow(2,-10*Fe)*Math.sin((Fe-Ee)*Ne/xe)}}function Ll(fe){return fe||(fe=1.70158),function(xe){return xe*xe*((fe+1)*xe-fe)}}function ws(fe){return fe<1/2.75?7.5625*fe*fe:fe<2/2.75?7.5625*(fe-=1.5/2.75)*fe+.75:fe<2.5/2.75?7.5625*(fe-=2.25/2.75)*fe+.9375:7.5625*(fe-=2.625/2.75)*fe+.984375}w.interpolateHcl=Yl;function Yl(fe,xe){fe=w.hcl(fe),xe=w.hcl(xe);var Ee=fe.h,Fe=fe.c,Ie=fe.l,je=xe.h-Ee,xt=xe.c-Fe,ht=xe.l-Ie;return isNaN(xt)&&(xt=0,Fe=isNaN(Fe)?xe.c:Fe),isNaN(je)?(je=0,Ee=isNaN(Ee)?xe.h:Ee):je>180?je-=360:je<-180&&(je+=360),function(Ct){return st(Ee+je*Ct,Fe+xt*Ct,Ie+ht*Ct)+""}}w.interpolateHsl=al;function al(fe,xe){fe=w.hsl(fe),xe=w.hsl(xe);var Ee=fe.h,Fe=fe.s,Ie=fe.l,je=xe.h-Ee,xt=xe.s-Fe,ht=xe.l-Ie;return isNaN(xt)&&(xt=0,Fe=isNaN(Fe)?xe.s:Fe),isNaN(je)?(je=0,Ee=isNaN(Ee)?xe.h:Ee):je>180?je-=360:je<-180&&(je+=360),function(Ct){return _r(Ee+je*Ct,Fe+xt*Ct,Ie+ht*Ct)+""}}w.interpolateLab=Wl;function Wl(fe,xe){fe=w.lab(fe),xe=w.lab(xe);var Ee=fe.l,Fe=fe.a,Ie=fe.b,je=xe.l-Ee,xt=xe.a-Fe,ht=xe.b-Ie;return function(Ct){return it(Ee+je*Ct,Fe+xt*Ct,Ie+ht*Ct)+""}}w.interpolateRound=iu;function iu(fe,xe){return xe-=fe,function(Ee){return Math.round(fe+xe*Ee)}}w.transform=function(fe){var xe=M.createElementNS(w.ns.prefix.svg,"g");return(w.transform=function(Ee){if(Ee!=null){xe.setAttribute("transform",Ee);var Fe=xe.transform.baseVal.consolidate()}return new Pl(Fe?Fe.matrix:Dl)})(fe)};function Pl(fe){var xe=[fe.a,fe.b],Ee=[fe.c,fe.d],Fe=Ws(xe),Ie=Eu(xe,Ee),je=Ws(Xl(Ee,xe,-Ie))||0;xe[0]*Ee[1]<Ee[0]*xe[1]&&(xe[0]*=-1,xe[1]*=-1,Fe*=-1,Ie*=-1),this.rotate=(Fe?Math.atan2(xe[1],xe[0]):Math.atan2(-Ee[0],Ee[1]))*mt,this.translate=[fe.e,fe.f],this.scale=[Fe,je],this.skew=je?Math.atan2(Ie,je)*mt:0}Pl.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};function Eu(fe,xe){return fe[0]*xe[0]+fe[1]*xe[1]}function Ws(fe){var xe=Math.sqrt(Eu(fe,fe));return xe&&(fe[0]/=xe,fe[1]/=xe),xe}function Xl(fe,xe,Ee){return fe[0]+=Ee*xe[0],fe[1]+=Ee*xe[1],fe}var Dl={a:1,b:0,c:0,d:1,e:0,f:0};w.interpolateTransform=Rl;function ps(fe){return fe.length?fe.pop()+",":""}function dl(fe,xe,Ee,Fe){if(fe[0]!==xe[0]||fe[1]!==xe[1]){var Ie=Ee.push("translate(",null,",",null,")");Fe.push({i:Ie-4,x:Di(fe[0],xe[0])},{i:Ie-2,x:Di(fe[1],xe[1])})}else(xe[0]||xe[1])&&Ee.push("translate("+xe+")")}function Zl(fe,xe,Ee,Fe){fe!==xe?(fe-xe>180?xe+=360:xe-fe>180&&(fe+=360),Fe.push({i:Ee.push(ps(Ee)+"rotate(",null,")")-2,x:Di(fe,xe)})):xe&&Ee.push(ps(Ee)+"rotate("+xe+")")}function ou(fe,xe,Ee,Fe){fe!==xe?Fe.push({i:Ee.push(ps(Ee)+"skewX(",null,")")-2,x:Di(fe,xe)}):xe&&Ee.push(ps(Ee)+"skewX("+xe+")")}function su(fe,xe,Ee,Fe){if(fe[0]!==xe[0]||fe[1]!==xe[1]){var Ie=Ee.push(ps(Ee)+"scale(",null,",",null,")");Fe.push({i:Ie-4,x:Di(fe[0],xe[0])},{i:Ie-2,x:Di(fe[1],xe[1])})}else(xe[0]!==1||xe[1]!==1)&&Ee.push(ps(Ee)+"scale("+xe+")")}function Rl(fe,xe){var Ee=[],Fe=[];return fe=w.transform(fe),xe=w.transform(xe),dl(fe.translate,xe.translate,Ee,Fe),Zl(fe.rotate,xe.rotate,Ee,Fe),ou(fe.skew,xe.skew,Ee,Fe),su(fe.scale,xe.scale,Ee,Fe),fe=xe=null,function(Ie){for(var je=-1,xt=Fe.length,ht;++je<xt;)Ee[(ht=Fe[je]).i]=ht.x(Ie);return Ee.join("")}}function Cu(fe,xe){return xe=(xe-=fe=+fe)||1/xe,function(Ee){return(Ee-fe)/xe}}function lu(fe,xe){return xe=(xe-=fe=+fe)||1/xe,function(Ee){return Math.max(0,Math.min(1,(Ee-fe)/xe))}}w.layout={},w.layout.bundle=function(){return function(fe){for(var xe=[],Ee=-1,Fe=fe.length;++Ee<Fe;)xe.push(Jo(fe[Ee]));return xe}};function Jo(fe){for(var xe=fe.source,Ee=fe.target,Fe=ol(xe,Ee),Ie=[xe];xe!==Fe;)xe=xe.parent,Ie.push(xe);for(var je=Ie.length;Ee!==Fe;)Ie.splice(je,0,Ee),Ee=Ee.parent;return Ie}function il(fe){for(var xe=[],Ee=fe.parent;Ee!=null;)xe.push(fe),fe=Ee,Ee=Ee.parent;return xe.push(fe),xe}function ol(fe,xe){if(fe===xe)return fe;for(var Ee=il(fe),Fe=il(xe),Ie=Ee.pop(),je=Fe.pop(),xt=null;Ie===je;)xt=Ie,Ie=Ee.pop(),je=Fe.pop();return xt}w.layout.chord=function(){var fe={},xe,Ee,Fe,Ie,je=0,xt,ht,Ct;function Xt(){var er={},Ar=[],Jr=w.range(Ie),sn=[],Lr,Br,Zr,nn,on;for(xe=[],Ee=[],Lr=0,nn=-1;++nn<Ie;){for(Br=0,on=-1;++on<Ie;)Br+=Fe[nn][on];Ar.push(Br),sn.push(w.range(Ie)),Lr+=Br}for(xt&&Jr.sort(function(Na,Pa){return xt(Ar[Na],Ar[Pa])}),ht&&sn.forEach(function(Na,Pa){Na.sort(function($a,yi){return ht(Fe[Pa][$a],Fe[Pa][yi])})}),Lr=(Ne-je*Ie)/Lr,Br=0,nn=-1;++nn<Ie;){for(Zr=Br,on=-1;++on<Ie;){var jr=Jr[nn],Un=sn[jr][on],ra=Fe[jr][Un],_a=Br,ia=Br+=ra*Lr;er[jr+"-"+Un]={index:jr,subindex:Un,startAngle:_a,endAngle:ia,value:ra}}Ee[jr]={index:jr,startAngle:Zr,endAngle:Br,value:Ar[jr]},Br+=je}for(nn=-1;++nn<Ie;)for(on=nn-1;++on<Ie;){var Sa=er[nn+"-"+on],la=er[on+"-"+nn];(Sa.value||la.value)&&xe.push(Sa.value<la.value?{source:la,target:Sa}:{source:Sa,target:la})}Ct&&$t()}function $t(){xe.sort(function(er,Ar){return Ct((er.source.value+er.target.value)/2,(Ar.source.value+Ar.target.value)/2)})}return fe.matrix=function(er){return arguments.length?(Ie=(Fe=er)&&Fe.length,xe=Ee=null,fe):Fe},fe.padding=function(er){return arguments.length?(je=er,xe=Ee=null,fe):je},fe.sortGroups=function(er){return arguments.length?(xt=er,xe=Ee=null,fe):xt},fe.sortSubgroups=function(er){return arguments.length?(ht=er,xe=null,fe):ht},fe.sortChords=function(er){return arguments.length?(Ct=er,xe&&$t(),fe):Ct},fe.chords=function(){return xe||Xt(),xe},fe.groups=function(){return Ee||Xt(),Ee},fe},w.layout.force=function(){var fe={},xe=w.dispatch("start","tick","end"),Ee,Fe=[1,1],Ie,je,xt=.9,ht=As,Ct=oo,Xt=-30,$t=yl,er=.1,Ar=.64,Jr=[],sn=[],Lr,Br,Zr;function nn(jr){return function(Un,ra,_a,ia){if(Un.point!==jr){var Sa=Un.cx-jr.x,la=Un.cy-jr.y,Na=ia-ra,Pa=Sa*Sa+la*la;if(Na*Na/Ar<Pa){if(Pa<$t){var $a=Un.charge/Pa;jr.px-=Sa*$a,jr.py-=la*$a}return!0}if(Un.point&&Pa&&Pa<$t){var $a=Un.pointCharge/Pa;jr.px-=Sa*$a,jr.py-=la*$a}}return!Un.charge}}fe.tick=function(){if((je*=.99)<.005)return Ee=null,xe.end({type:"end",alpha:je=0}),!0;var jr=Jr.length,Un=sn.length,ra,_a,ia,Sa,la,Na,Pa,$a,yi;for(_a=0;_a<Un;++_a)ia=sn[_a],Sa=ia.source,la=ia.target,$a=la.x-Sa.x,yi=la.y-Sa.y,(Na=$a*$a+yi*yi)&&(Na=je*Br[_a]*((Na=Math.sqrt(Na))-Lr[_a])/Na,$a*=Na,yi*=Na,la.x-=$a*(Pa=Sa.weight+la.weight?Sa.weight/(Sa.weight+la.weight):.5),la.y-=yi*Pa,Sa.x+=$a*(Pa=1-Pa),Sa.y+=yi*Pa);if((Pa=je*er)&&($a=Fe[0]/2,yi=Fe[1]/2,_a=-1,Pa))for(;++_a<jr;)ia=Jr[_a],ia.x+=($a-ia.x)*Pa,ia.y+=(yi-ia.y)*Pa;if(Xt)for(Ts(ra=w.geom.quadtree(Jr),je,Zr),_a=-1;++_a<jr;)(ia=Jr[_a]).fixed||ra.visit(nn(ia));for(_a=-1;++_a<jr;)ia=Jr[_a],ia.fixed?(ia.x=ia.px,ia.y=ia.py):(ia.x-=(ia.px-(ia.px=ia.x))*xt,ia.y-=(ia.py-(ia.py=ia.y))*xt);xe.tick({type:"tick",alpha:je})},fe.nodes=function(jr){return arguments.length?(Jr=jr,fe):Jr},fe.links=function(jr){return arguments.length?(sn=jr,fe):sn},fe.size=function(jr){return arguments.length?(Fe=jr,fe):Fe},fe.linkDistance=function(jr){return arguments.length?(ht=typeof jr=="function"?jr:+jr,fe):ht},fe.distance=fe.linkDistance,fe.linkStrength=function(jr){return arguments.length?(Ct=typeof jr=="function"?jr:+jr,fe):Ct},fe.friction=function(jr){return arguments.length?(xt=+jr,fe):xt},fe.charge=function(jr){return arguments.length?(Xt=typeof jr=="function"?jr:+jr,fe):Xt},fe.chargeDistance=function(jr){return arguments.length?($t=jr*jr,fe):Math.sqrt($t)},fe.gravity=function(jr){return arguments.length?(er=+jr,fe):er},fe.theta=function(jr){return arguments.length?(Ar=jr*jr,fe):Math.sqrt(Ar)},fe.alpha=function(jr){return arguments.length?(jr=+jr,je?jr>0?je=jr:(Ee.c=null,Ee.t=NaN,Ee=null,xe.end({type:"end",alpha:je=0})):jr>0&&(xe.start({type:"start",alpha:je=jr}),Ee=ln(fe.tick)),fe):je},fe.start=function(){var jr,Un=Jr.length,ra=sn.length,_a=Fe[0],ia=Fe[1],Sa,la;for(jr=0;jr<Un;++jr)(la=Jr[jr]).index=jr,la.weight=0;for(jr=0;jr<ra;++jr)la=sn[jr],typeof la.source=="number"&&(la.source=Jr[la.source]),typeof la.target=="number"&&(la.target=Jr[la.target]),++la.source.weight,++la.target.weight;for(jr=0;jr<Un;++jr)la=Jr[jr],isNaN(la.x)&&(la.x=Na("x",_a)),isNaN(la.y)&&(la.y=Na("y",ia)),isNaN(la.px)&&(la.px=la.x),isNaN(la.py)&&(la.py=la.y);if(Lr=[],typeof ht=="function")for(jr=0;jr<ra;++jr)Lr[jr]=+ht.call(this,sn[jr],jr);else for(jr=0;jr<ra;++jr)Lr[jr]=ht;if(Br=[],typeof Ct=="function")for(jr=0;jr<ra;++jr)Br[jr]=+Ct.call(this,sn[jr],jr);else for(jr=0;jr<ra;++jr)Br[jr]=Ct;if(Zr=[],typeof Xt=="function")for(jr=0;jr<Un;++jr)Zr[jr]=+Xt.call(this,Jr[jr],jr);else for(jr=0;jr<Un;++jr)Zr[jr]=Xt;function Na(Pa,$a){if(!Sa){for(Sa=new Array(Un),Ii=0;Ii<Un;++Ii)Sa[Ii]=[];for(Ii=0;Ii<ra;++Ii){var yi=sn[Ii];Sa[yi.source.index].push(yi.target),Sa[yi.target.index].push(yi.source)}}for(var fo=Sa[jr],Ii=-1,fa=fo.length,ai;++Ii<fa;)if(!isNaN(ai=fo[Ii][Pa]))return ai;return Math.random()*$a}return fe.resume()},fe.resume=function(){return fe.alpha(.1)},fe.stop=function(){return fe.alpha(0)},fe.drag=function(){if(Ie||(Ie=w.behavior.drag().origin(D).on("dragstart.force",jl).on("drag.force",on).on("dragend.force",ds)),!arguments.length)return Ie;this.on("mouseover.force",So).on("mouseout.force",Il).call(Ie)};function on(jr){jr.px=w.event.x,jr.py=w.event.y,fe.resume()}return w.rebind(fe,xe,"on")};function jl(fe){fe.fixed|=2}function ds(fe){fe.fixed&=-7}function So(fe){fe.fixed|=4,fe.px=fe.x,fe.py=fe.y}function Il(fe){fe.fixed&=-5}function Ts(fe,xe,Ee){var Fe=0,Ie=0;if(fe.charge=0,!fe.leaf)for(var je=fe.nodes,xt=je.length,ht=-1,Ct;++ht<xt;)Ct=je[ht],Ct!=null&&(Ts(Ct,xe,Ee),fe.charge+=Ct.charge,Fe+=Ct.charge*Ct.cx,Ie+=Ct.charge*Ct.cy);if(fe.point){fe.leaf||(fe.point.x+=Math.random()-.5,fe.point.y+=Math.random()-.5);var Xt=xe*Ee[fe.point.index];fe.charge+=fe.pointCharge=Xt,Fe+=Xt*fe.point.x,Ie+=Xt*fe.point.y}fe.cx=Fe/fe.charge,fe.cy=Ie/fe.charge}var As=20,oo=1,yl=1/0;w.layout.hierarchy=function(){var fe=zl,xe=xl,Ee=sl;function Fe(Ie){var je=[Ie],xt=[],ht;for(Ie.depth=0;(ht=je.pop())!=null;)if(xt.push(ht),(Xt=xe.call(Fe,ht,ht.depth))&&(Ct=Xt.length)){for(var Ct,Xt,$t;--Ct>=0;)je.push($t=Xt[Ct]),$t.parent=ht,$t.depth=ht.depth+1;Ee&&(ht.value=0),ht.children=Xt}else Ee&&(ht.value=+Ee.call(Fe,ht,ht.depth)||0),delete ht.children;return gs(Ie,function(er){var Ar,Jr;fe&&(Ar=er.children)&&Ar.sort(fe),Ee&&(Jr=er.parent)&&(Jr.value+=er.value)}),xt}return Fe.sort=function(Ie){return arguments.length?(fe=Ie,Fe):fe},Fe.children=function(Ie){return arguments.length?(xe=Ie,Fe):xe},Fe.value=function(Ie){return arguments.length?(Ee=Ie,Fe):Ee},Fe.revalue=function(Ie){return Ee&&(Xs(Ie,function(je){je.children&&(je.value=0)}),gs(Ie,function(je){var xt;je.children||(je.value=+Ee.call(Fe,je,je.depth)||0),(xt=je.parent)&&(xt.value+=je.value)})),Ie},Fe};function ml(fe,xe){return w.rebind(fe,xe,"sort","children","value"),fe.nodes=fe,fe.links=bl,fe}function Xs(fe,xe){for(var Ee=[fe];(fe=Ee.pop())!=null;)if(xe(fe),(Ie=fe.children)&&(Fe=Ie.length))for(var Fe,Ie;--Fe>=0;)Ee.push(Ie[Fe])}function gs(fe,xe){for(var Ee=[fe],Fe=[];(fe=Ee.pop())!=null;)if(Fe.push(fe),(xt=fe.children)&&(je=xt.length))for(var Ie=-1,je,xt;++Ie<je;)Ee.push(xt[Ie]);for(;(fe=Fe.pop())!=null;)xe(fe)}function xl(fe){return fe.children}function sl(fe){return fe.value}function zl(fe,xe){return xe.value-fe.value}function bl(fe){return w.merge(fe.map(function(xe){return(xe.children||[]).map(function(Ee){return{source:xe,target:Ee}})}))}w.layout.partition=function(){var fe=w.layout.hierarchy(),xe=[1,1];function Ee(je,xt,ht,Ct){var Xt=je.children;if(je.x=xt,je.y=je.depth*Ct,je.dx=ht,je.dy=Ct,Xt&&(er=Xt.length)){var $t=-1,er,Ar,Jr;for(ht=je.value?ht/je.value:0;++$t<er;)Ee(Ar=Xt[$t],xt,Jr=Ar.value*ht,Ct),xt+=Jr}}function Fe(je){var xt=je.children,ht=0;if(xt&&(Xt=xt.length))for(var Ct=-1,Xt;++Ct<Xt;)ht=Math.max(ht,Fe(xt[Ct]));return 1+ht}function Ie(je,xt){var ht=fe.call(this,je,xt);return Ee(ht[0],0,xe[0],xe[1]/Fe(ht[0])),ht}return Ie.size=function(je){return arguments.length?(xe=je,Ie):xe},ml(Ie,fe)},w.layout.pie=function(){var fe=Number,xe=Zs,Ee=0,Fe=Ne,Ie=0;function je(xt){var ht=xt.length,Ct=xt.map(function(nn,on){return+fe.call(je,nn,on)}),Xt=+(typeof Ee=="function"?Ee.apply(this,arguments):Ee),$t=(typeof Fe=="function"?Fe.apply(this,arguments):Fe)-Xt,er=Math.min(Math.abs($t)/ht,+(typeof Ie=="function"?Ie.apply(this,arguments):Ie)),Ar=er*($t<0?-1:1),Jr=w.sum(Ct),sn=Jr?($t-ht*Ar)/Jr:0,Lr=w.range(ht),Br=[],Zr;return xe!=null&&Lr.sort(xe===Zs?function(nn,on){return Ct[on]-Ct[nn]}:function(nn,on){return xe(xt[nn],xt[on])}),Lr.forEach(function(nn){Br[nn]={data:xt[nn],value:Zr=Ct[nn],startAngle:Xt,endAngle:Xt+=Zr*sn+Ar,padAngle:er}}),Br}return je.value=function(xt){return arguments.length?(fe=xt,je):fe},je.sort=function(xt){return arguments.length?(xe=xt,je):xe},je.startAngle=function(xt){return arguments.length?(Ee=xt,je):Ee},je.endAngle=function(xt){return arguments.length?(Fe=xt,je):Fe},je.padAngle=function(xt){return arguments.length?(Ie=xt,je):Ie},je};var Zs={};w.layout.stack=function(){var fe=D,xe=_l,Ee=js,Fe=Yu,Ie=Lu,je=rs;function xt(ht,Ct){if(!(sn=ht.length))return ht;var Xt=ht.map(function(nn,on){return fe.call(xt,nn,on)}),$t=Xt.map(function(nn){return nn.map(function(on,jr){return[Ie.call(xt,on,jr),je.call(xt,on,jr)]})}),er=xe.call(xt,$t,Ct);Xt=w.permute(Xt,er),$t=w.permute($t,er);var Ar=Ee.call(xt,$t,Ct),Jr=Xt[0].length,sn,Lr,Br,Zr;for(Br=0;Br<Jr;++Br)for(Fe.call(xt,Xt[0][Br],Zr=Ar[Br],$t[0][Br][1]),Lr=1;Lr<sn;++Lr)Fe.call(xt,Xt[Lr][Br],Zr+=$t[Lr-1][Br][1],$t[Lr][Br][1]);return ht}return xt.values=function(ht){return arguments.length?(fe=ht,xt):fe},xt.order=function(ht){return arguments.length?(xe=typeof ht=="function"?ht:Kl.get(ht)||_l,xt):xe},xt.offset=function(ht){return arguments.length?(Ee=typeof ht=="function"?ht:ll.get(ht)||js,xt):Ee},xt.x=function(ht){return arguments.length?(Ie=ht,xt):Ie},xt.y=function(ht){return arguments.length?(je=ht,xt):je},xt.out=function(ht){return arguments.length?(Fe=ht,xt):Fe},xt};function Lu(fe){return fe.x}function rs(fe){return fe.y}function Yu(fe,xe,Ee){fe.y0=xe,fe.y=Ee}var Kl=w.map({"inside-out":function(fe){var xe=fe.length,Ee,Fe,Ie=fe.map(wl),je=fe.map(uu),xt=w.range(xe).sort(function(er,Ar){return Ie[er]-Ie[Ar]}),ht=0,Ct=0,Xt=[],$t=[];for(Ee=0;Ee<xe;++Ee)Fe=xt[Ee],ht<Ct?(ht+=je[Fe],Xt.push(Fe)):(Ct+=je[Fe],$t.push(Fe));return $t.reverse().concat(Xt)},reverse:function(fe){return w.range(fe.length).reverse()},default:_l}),ll=w.map({silhouette:function(fe){var xe=fe.length,Ee=fe[0].length,Fe=[],Ie=0,je,xt,ht,Ct=[];for(xt=0;xt<Ee;++xt){for(je=0,ht=0;je<xe;je++)ht+=fe[je][xt][1];ht>Ie&&(Ie=ht),Fe.push(ht)}for(xt=0;xt<Ee;++xt)Ct[xt]=(Ie-Fe[xt])/2;return Ct},wiggle:function(fe){var xe=fe.length,Ee=fe[0],Fe=Ee.length,Ie,je,xt,ht,Ct,Xt,$t,er,Ar,Jr=[];for(Jr[0]=er=Ar=0,je=1;je<Fe;++je){for(Ie=0,ht=0;Ie<xe;++Ie)ht+=fe[Ie][je][1];for(Ie=0,Ct=0,$t=Ee[je][0]-Ee[je-1][0];Ie<xe;++Ie){for(xt=0,Xt=(fe[Ie][je][1]-fe[Ie][je-1][1])/(2*$t);xt<Ie;++xt)Xt+=(fe[xt][je][1]-fe[xt][je-1][1])/$t;Ct+=Xt*fe[Ie][je][1]}Jr[je]=er-=ht?Ct/ht*$t:0,er<Ar&&(Ar=er)}for(je=0;je<Fe;++je)Jr[je]-=Ar;return Jr},expand:function(fe){var xe=fe.length,Ee=fe[0].length,Fe=1/xe,Ie,je,xt,ht=[];for(je=0;je<Ee;++je){for(Ie=0,xt=0;Ie<xe;Ie++)xt+=fe[Ie][je][1];if(xt)for(Ie=0;Ie<xe;Ie++)fe[Ie][je][1]/=xt;else for(Ie=0;Ie<xe;Ie++)fe[Ie][je][1]=Fe}for(je=0;je<Ee;++je)ht[je]=0;return ht},zero:js});function _l(fe){return w.range(fe.length)}function js(fe){for(var xe=-1,Ee=fe[0].length,Fe=[];++xe<Ee;)Fe[xe]=0;return Fe}function wl(fe){for(var xe=1,Ee=0,Fe=fe[0][1],Ie,je=fe.length;xe<je;++xe)(Ie=fe[xe][1])>Fe&&(Ee=xe,Fe=Ie);return Ee}function uu(fe){return fe.reduce(fu,0)}function fu(fe,xe){return fe+xe[1]}w.layout.histogram=function(){var fe=!0,xe=Number,Ee=ul,Fe=Wu;function Ie(je,Ar){for(var ht=[],Ct=je.map(xe,this),Xt=Ee.call(this,Ct,Ar),$t=Fe.call(this,Xt,Ct,Ar),er,Ar=-1,Jr=Ct.length,sn=$t.length-1,Lr=fe?1:1/Jr,Br;++Ar<sn;)er=ht[Ar]=[],er.dx=$t[Ar+1]-(er.x=$t[Ar]),er.y=0;if(sn>0)for(Ar=-1;++Ar<Jr;)Br=Ct[Ar],Br>=Xt[0]&&Br<=Xt[1]&&(er=ht[w.bisect($t,Br,1,sn)-1],er.y+=Lr,er.push(je[Ar]));return ht}return Ie.value=function(je){return arguments.length?(xe=je,Ie):xe},Ie.range=function(je){return arguments.length?(Ee=tt(je),Ie):Ee},Ie.bins=function(je){return arguments.length?(Fe=typeof je=="number"?function(xt){return Ri(xt,je)}:tt(je),Ie):Fe},Ie.frequency=function(je){return arguments.length?(fe=!!je,Ie):fe},Ie};function Wu(fe,xe){return Ri(fe,Math.ceil(Math.log(xe.length)/Math.LN2+1))}function Ri(fe,xe){for(var Ee=-1,Fe=+fe[0],Ie=(fe[1]-Fe)/xe,je=[];++Ee<=xe;)je[Ee]=Ie*Ee+Fe;return je}function ul(fe){return[w.min(fe),w.max(fe)]}w.layout.pack=function(){var fe=w.layout.hierarchy().sort(Ks),xe=0,Ee=[1,1],Fe;function Ie(je,xt){var ht=fe.call(this,je,xt),Ct=ht[0],Xt=Ee[0],$t=Ee[1],er=Fe==null?Math.sqrt:typeof Fe=="function"?Fe:function(){return Fe};if(Ct.x=Ct.y=0,gs(Ct,function(Jr){Jr.r=+er(Jr.value)}),gs(Ct,so),xe){var Ar=xe*(Fe?1:Math.max(2*Ct.r/Xt,2*Ct.r/$t))/2;gs(Ct,function(Jr){Jr.r+=Ar}),gs(Ct,so),gs(Ct,function(Jr){Jr.r-=Ar})}return zs(Ct,Xt/2,$t/2,Fe?1:1/Math.max(2*Ct.r/Xt,2*Ct.r/$t)),ht}return Ie.size=function(je){return arguments.length?(Ee=je,Ie):Ee},Ie.radius=function(je){return arguments.length?(Fe=je==null||typeof je=="function"?je:+je,Ie):Fe},Ie.padding=function(je){return arguments.length?(xe=+je,Ie):xe},ml(Ie,fe)};function Ks(fe,xe){return fe.value-xe.value}function Qo(fe,xe){var Ee=fe._pack_next;fe._pack_next=xe,xe._pack_prev=fe,xe._pack_next=Ee,Ee._pack_prev=xe}function ns(fe,xe){fe._pack_next=xe,xe._pack_prev=fe}function Tl(fe,xe){var Ee=xe.x-fe.x,Fe=xe.y-fe.y,Ie=fe.r+xe.r;return .999*Ie*Ie>Ee*Ee+Fe*Fe}function so(fe){if(!(xe=fe.children)||!(Ar=xe.length))return;var xe,Ee=1/0,Fe=-1/0,Ie=1/0,je=-1/0,xt,ht,Ct,Xt,$t,er,Ar;function Jr(jr){Ee=Math.min(jr.x-jr.r,Ee),Fe=Math.max(jr.x+jr.r,Fe),Ie=Math.min(jr.y-jr.r,Ie),je=Math.max(jr.y+jr.r,je)}if(xe.forEach(cu),xt=xe[0],xt.x=-xt.r,xt.y=0,Jr(xt),Ar>1&&(ht=xe[1],ht.x=ht.r,ht.y=0,Jr(ht),Ar>2))for(Ct=xe[2],Fs(xt,ht,Ct),Jr(Ct),Qo(xt,Ct),xt._pack_prev=Ct,Qo(Ct,ht),ht=xt._pack_next,Xt=3;Xt<Ar;Xt++){Fs(xt,ht,Ct=xe[Xt]);var sn=0,Lr=1,Br=1;for($t=ht._pack_next;$t!==ht;$t=$t._pack_next,Lr++)if(Tl($t,Ct)){sn=1;break}if(sn==1)for(er=xt._pack_prev;er!==$t._pack_prev&&!Tl(er,Ct);er=er._pack_prev,Br++);sn?(Lr<Br||Lr==Br&&ht.r<xt.r?ns(xt,ht=$t):ns(xt=er,ht),Xt--):(Qo(xt,Ct),ht=Ct,Jr(Ct))}var Zr=(Ee+Fe)/2,nn=(Ie+je)/2,on=0;for(Xt=0;Xt<Ar;Xt++)Ct=xe[Xt],Ct.x-=Zr,Ct.y-=nn,on=Math.max(on,Ct.r+Math.sqrt(Ct.x*Ct.x+Ct.y*Ct.y));fe.r=on,xe.forEach(as)}function cu(fe){fe._pack_next=fe._pack_prev=fe}function as(fe){delete fe._pack_next,delete fe._pack_prev}function zs(fe,xe,Ee,Fe){var Ie=fe.children;if(fe.x=xe+=Fe*fe.x,fe.y=Ee+=Fe*fe.y,fe.r*=Fe,Ie)for(var je=-1,xt=Ie.length;++je<xt;)zs(Ie[je],xe,Ee,Fe)}function Fs(fe,xe,Ee){var Fe=fe.r+Ee.r,Ie=xe.x-fe.x,je=xe.y-fe.y;if(Fe&&(Ie||je)){var xt=xe.r+Ee.r,ht=Ie*Ie+je*je;xt*=xt,Fe*=Fe;var Ct=.5+(Fe-xt)/(2*ht),Xt=Math.sqrt(Math.max(0,2*xt*(Fe+ht)-(Fe-=ht)*Fe-xt*xt))/(2*ht);Ee.x=fe.x+Ct*Ie+Xt*je,Ee.y=fe.y+Ct*je-Xt*Ie}else Ee.x=fe.x+Fe,Ee.y=fe.y}w.layout.tree=function(){var fe=w.layout.hierarchy().sort(null).value(null),xe=Ms,Ee=[1,1],Fe=null;function Ie($t,er){var Ar=fe.call(this,$t,er),Jr=Ar[0],sn=je(Jr);if(gs(sn,xt),sn.parent.m=-sn.z,Xs(sn,ht),Fe)Xs(Jr,Xt);else{var Lr=Jr,Br=Jr,Zr=Jr;Xs(Jr,function(Un){Un.x<Lr.x&&(Lr=Un),Un.x>Br.x&&(Br=Un),Un.depth>Zr.depth&&(Zr=Un)});var nn=xe(Lr,Br)/2-Lr.x,on=Ee[0]/(Br.x+xe(Br,Lr)/2+nn),jr=Ee[1]/(Zr.depth||1);Xs(Jr,function(Un){Un.x=(Un.x+nn)*on,Un.y=Un.depth*jr})}return Ar}function je($t){for(var er={A:null,children:[$t]},Ar=[er],Jr;(Jr=Ar.pop())!=null;)for(var sn=Jr.children,Lr,Br=0,Zr=sn.length;Br<Zr;++Br)Ar.push((sn[Br]=Lr={_:sn[Br],parent:Jr,children:(Lr=sn[Br].children)&&Lr.slice()||[],A:null,a:null,z:0,m:0,c:0,s:0,t:null,i:Br}).a=Lr);return er.children[0]}function xt($t){var er=$t.children,Ar=$t.parent.children,Jr=$t.i?Ar[$t.i-1]:null;if(er.length){os($t);var sn=(er[0].z+er[er.length-1].z)/2;Jr?($t.z=Jr.z+xe($t._,Jr._),$t.m=$t.z-sn):$t.z=sn}else Jr&&($t.z=Jr.z+xe($t._,Jr._));$t.parent.A=Ct($t,Jr,$t.parent.A||Ar[0])}function ht($t){$t._.x=$t.z+$t.parent.m,$t.m+=$t.parent.m}function Ct($t,er,Ar){if(er){for(var Jr=$t,sn=$t,Lr=er,Br=Jr.parent.children[0],Zr=Jr.m,nn=sn.m,on=Lr.m,jr=Br.m,Un;Lr=Hi(Lr),Jr=is(Jr),Lr&&Jr;)Br=is(Br),sn=Hi(sn),sn.a=$t,Un=Lr.z+on-Jr.z-Zr+xe(Lr._,Jr._),Un>0&&(ko(hu(Lr,$t,Ar),$t,Un),Zr+=Un,nn+=Un),on+=Lr.m,Zr+=Jr.m,jr+=Br.m,nn+=sn.m;Lr&&!Hi(sn)&&(sn.t=Lr,sn.m+=on-nn),Jr&&!is(Br)&&(Br.t=Jr,Br.m+=Zr-jr,Ar=$t)}return Ar}function Xt($t){$t.x*=Ee[0],$t.y=$t.depth*Ee[1]}return Ie.separation=function($t){return arguments.length?(xe=$t,Ie):xe},Ie.size=function($t){return arguments.length?(Fe=(Ee=$t)==null?Xt:null,Ie):Fe?null:Ee},Ie.nodeSize=function($t){return arguments.length?(Fe=(Ee=$t)==null?null:Xt,Ie):Fe?Ee:null},ml(Ie,fe)};function Ms(fe,xe){return fe.parent==xe.parent?1:2}function is(fe){var xe=fe.children;return xe.length?xe[0]:fe.t}function Hi(fe){var xe=fe.children,Ee;return(Ee=xe.length)?xe[Ee-1]:fe.t}function ko(fe,xe,Ee){var Fe=Ee/(xe.i-fe.i);xe.c-=Fe,xe.s+=Ee,fe.c+=Fe,xe.z+=Ee,xe.m+=Ee}function os(fe){for(var xe=0,Ee=0,Fe=fe.children,Ie=Fe.length,je;--Ie>=0;)je=Fe[Ie],je.z+=xe,je.m+=xe,xe+=je.s+(Ee+=je.c)}function hu(fe,xe,Ee){return fe.a.parent===xe.parent?fe.a:Ee}w.layout.cluster=function(){var fe=w.layout.hierarchy().sort(null).value(null),xe=Ms,Ee=[1,1],Fe=!1;function Ie(je,xt){var ht=fe.call(this,je,xt),Ct=ht[0],Xt,$t=0;gs(Ct,function(Lr){var Br=Lr.children;Br&&Br.length?(Lr.x=vu(Br),Lr.y=Fl(Br)):(Lr.x=Xt?$t+=xe(Lr,Xt):0,Lr.y=0,Xt=Lr)});var er=gt(Ct),Ar=zt(Ct),Jr=er.x-xe(er,Ar)/2,sn=Ar.x+xe(Ar,er)/2;return gs(Ct,Fe?function(Lr){Lr.x=(Lr.x-Ct.x)*Ee[0],Lr.y=(Ct.y-Lr.y)*Ee[1]}:function(Lr){Lr.x=(Lr.x-Jr)/(sn-Jr)*Ee[0],Lr.y=(1-(Ct.y?Lr.y/Ct.y:1))*Ee[1]}),ht}return Ie.separation=function(je){return arguments.length?(xe=je,Ie):xe},Ie.size=function(je){return arguments.length?(Fe=(Ee=je)==null,Ie):Fe?null:Ee},Ie.nodeSize=function(je){return arguments.length?(Fe=(Ee=je)!=null,Ie):Fe?Ee:null},ml(Ie,fe)};function Fl(fe){return 1+w.max(fe,function(xe){return xe.y})}function vu(fe){return fe.reduce(function(xe,Ee){return xe+Ee.x},0)/fe.length}function gt(fe){var xe=fe.children;return xe&&xe.length?gt(xe[0]):fe}function zt(fe){var xe=fe.children,Ee;return xe&&(Ee=xe.length)?zt(xe[Ee-1]):fe}w.layout.treemap=function(){var fe=w.layout.hierarchy(),xe=Math.round,Ee=[1,1],Fe=null,Ie=cr,je=!1,xt,ht="squarify",Ct=.5*(1+Math.sqrt(5));function Xt(Lr,Br){for(var Zr=-1,nn=Lr.length,on,jr;++Zr<nn;)jr=(on=Lr[Zr]).value*(Br<0?0:Br),on.area=isNaN(jr)||jr<=0?0:jr}function $t(Lr){var Br=Lr.children;if(Br&&Br.length){var Zr=Ie(Lr),nn=[],on=Br.slice(),jr,Un=1/0,ra,_a=ht==="slice"?Zr.dx:ht==="dice"?Zr.dy:ht==="slice-dice"?Lr.depth&1?Zr.dy:Zr.dx:Math.min(Zr.dx,Zr.dy),ia;for(Xt(on,Zr.dx*Zr.dy/Lr.value),nn.area=0;(ia=on.length)>0;)nn.push(jr=on[ia-1]),nn.area+=jr.area,ht!=="squarify"||(ra=Ar(nn,_a))<=Un?(on.pop(),Un=ra):(nn.area-=nn.pop().area,Jr(nn,_a,Zr,!1),_a=Math.min(Zr.dx,Zr.dy),nn.length=nn.area=0,Un=1/0);nn.length&&(Jr(nn,_a,Zr,!0),nn.length=nn.area=0),Br.forEach($t)}}function er(Lr){var Br=Lr.children;if(Br&&Br.length){var Zr=Ie(Lr),nn=Br.slice(),on,jr=[];for(Xt(nn,Zr.dx*Zr.dy/Lr.value),jr.area=0;on=nn.pop();)jr.push(on),jr.area+=on.area,on.z!=null&&(Jr(jr,on.z?Zr.dx:Zr.dy,Zr,!nn.length),jr.length=jr.area=0);Br.forEach(er)}}function Ar(Lr,Br){for(var Zr=Lr.area,nn,on=0,jr=1/0,Un=-1,ra=Lr.length;++Un<ra;)!(nn=Lr[Un].area)||(nn<jr&&(jr=nn),nn>on&&(on=nn));return Zr*=Zr,Br*=Br,Zr?Math.max(Br*on*Ct/Zr,Zr/(Br*jr*Ct)):1/0}function Jr(Lr,Br,Zr,nn){var on=-1,jr=Lr.length,Un=Zr.x,ra=Zr.y,_a=Br?xe(Lr.area/Br):0,ia;if(Br==Zr.dx){for((nn||_a>Zr.dy)&&(_a=Zr.dy);++on<jr;)ia=Lr[on],ia.x=Un,ia.y=ra,ia.dy=_a,Un+=ia.dx=Math.min(Zr.x+Zr.dx-Un,_a?xe(ia.area/_a):0);ia.z=!0,ia.dx+=Zr.x+Zr.dx-Un,Zr.y+=_a,Zr.dy-=_a}else{for((nn||_a>Zr.dx)&&(_a=Zr.dx);++on<jr;)ia=Lr[on],ia.x=Un,ia.y=ra,ia.dx=_a,ra+=ia.dy=Math.min(Zr.y+Zr.dy-ra,_a?xe(ia.area/_a):0);ia.z=!1,ia.dy+=Zr.y+Zr.dy-ra,Zr.x+=_a,Zr.dx-=_a}}function sn(Lr){var Br=xt||fe(Lr),Zr=Br[0];return Zr.x=Zr.y=0,Zr.value?(Zr.dx=Ee[0],Zr.dy=Ee[1]):Zr.dx=Zr.dy=0,xt&&fe.revalue(Zr),Xt([Zr],Zr.dx*Zr.dy/Zr.value),(xt?er:$t)(Zr),je&&(xt=Br),Br}return sn.size=function(Lr){return arguments.length?(Ee=Lr,sn):Ee},sn.padding=function(Lr){if(!arguments.length)return Fe;function Br(on){var jr=Lr.call(sn,on,on.depth);return jr==null?cr(on):or(on,typeof jr=="number"?[jr,jr,jr,jr]:jr)}function Zr(on){return or(on,Lr)}var nn;return Ie=(Fe=Lr)==null?cr:(nn=typeof Lr)=="function"?Br:(nn==="number"&&(Lr=[Lr,Lr,Lr,Lr]),Zr),sn},sn.round=function(Lr){return arguments.length?(xe=Lr?Math.round:Number,sn):xe!=Number},sn.sticky=function(Lr){return arguments.length?(je=Lr,xt=null,sn):je},sn.ratio=function(Lr){return arguments.length?(Ct=Lr,sn):Ct},sn.mode=function(Lr){return arguments.length?(ht=Lr+"",sn):ht},ml(sn,fe)};function cr(fe){return{x:fe.x,y:fe.y,dx:fe.dx,dy:fe.dy}}function or(fe,xe){var Ee=fe.x+xe[3],Fe=fe.y+xe[0],Ie=fe.dx-xe[1]-xe[3],je=fe.dy-xe[0]-xe[2];return Ie<0&&(Ee+=Ie/2,Ie=0),je<0&&(Fe+=je/2,je=0),{x:Ee,y:Fe,dx:Ie,dy:je}}w.random={normal:function(fe,xe){var Ee=arguments.length;return Ee<2&&(xe=1),Ee<1&&(fe=0),function(){var Fe,Ie,je;do Fe=Math.random()*2-1,Ie=Math.random()*2-1,je=Fe*Fe+Ie*Ie;while(!je||je>1);return fe+xe*Fe*Math.sqrt(-2*Math.log(je)/je)}},logNormal:function(){var fe=w.random.normal.apply(w,arguments);return function(){return Math.exp(fe())}},bates:function(fe){var xe=w.random.irwinHall(fe);return function(){return xe()/fe}},irwinHall:function(fe){return function(){for(var xe=0,Ee=0;Ee<fe;Ee++)xe+=Math.random();return xe}}},w.scale={};function Rr(fe){var xe=fe[0],Ee=fe[fe.length-1];return xe<Ee?[xe,Ee]:[Ee,xe]}function tn(fe){return fe.rangeExtent?fe.rangeExtent():Rr(fe.range())}function dn(fe,xe,Ee,Fe){var Ie=Ee(fe[0],fe[1]),je=Fe(xe[0],xe[1]);return function(xt){return je(Ie(xt))}}function Mn(fe,xe){var Ee=0,Fe=fe.length-1,Ie=fe[Ee],je=fe[Fe],xt;return je<Ie&&(xt=Ee,Ee=Fe,Fe=xt,xt=Ie,Ie=je,je=xt),fe[Ee]=xe.floor(Ie),fe[Fe]=xe.ceil(je),fe}function Ln(fe){return fe?{floor:function(xe){return Math.floor(xe/fe)*fe},ceil:function(xe){return Math.ceil(xe/fe)*fe}}:Nn}var Nn={floor:D,ceil:D};function yn(fe,xe,Ee,Fe){var Ie=[],je=[],xt=0,ht=Math.min(fe.length,xe.length)-1;for(fe[ht]<fe[0]&&(fe=fe.slice().reverse(),xe=xe.slice().reverse());++xt<=ht;)Ie.push(Ee(fe[xt-1],fe[xt])),je.push(Fe(xe[xt-1],xe[xt]));return function(Ct){var Xt=w.bisect(fe,Ct,1,ht)-1;return je[Xt](Ie[Xt](Ct))}}w.scale.linear=function(){return zn([0,1],[0,1],no,!1)};function zn(fe,xe,Ee,Fe){var Ie,je;function xt(){var Ct=Math.min(fe.length,xe.length)>2?yn:dn,Xt=Fe?lu:Cu;return Ie=Ct(fe,xe,Xt,Ee),je=Ct(xe,fe,Xt,no),ht}function ht(Ct){return Ie(Ct)}return ht.invert=function(Ct){return je(Ct)},ht.domain=function(Ct){return arguments.length?(fe=Ct.map(Number),xt()):fe},ht.range=function(Ct){return arguments.length?(xe=Ct,xt()):xe},ht.rangeRound=function(Ct){return ht.range(Ct).interpolate(iu)},ht.clamp=function(Ct){return arguments.length?(Fe=Ct,xt()):Fe},ht.interpolate=function(Ct){return arguments.length?(Ee=Ct,xt()):Ee},ht.ticks=function(Ct){return za(fe,Ct)},ht.tickFormat=function(Ct,Xt){return d3_scale_linearTickFormat(fe,Ct,Xt)},ht.nice=function(Ct){return Vn(fe,Ct),xt()},ht.copy=function(){return zn(fe,xe,Ee,Fe)},xt()}function Pn(fe,xe){return w.rebind(fe,xe,"range","rangeRound","interpolate","clamp")}function Vn(fe,xe){return Mn(fe,Ln($n(fe,xe)[2])),Mn(fe,Ln($n(fe,xe)[2])),fe}function $n(fe,xe){xe==null&&(xe=10);var Ee=Rr(fe),Fe=Ee[1]-Ee[0],Ie=Math.pow(10,Math.floor(Math.log(Fe/xe)/Math.LN10)),je=xe/Fe*Ie;return je<=.15?Ie*=10:je<=.35?Ie*=5:je<=.75&&(Ie*=2),Ee[0]=Math.ceil(Ee[0]/Ie)*Ie,Ee[1]=Math.floor(Ee[1]/Ie)*Ie+Ie*.5,Ee[2]=Ie,Ee}function za(fe,xe){return w.range.apply(w,$n(fe,xe))}w.scale.log=function(){return ka(w.scale.linear().domain([0,1]),10,!0,[1,10])};function ka(fe,xe,Ee,Fe){function Ie(ht){return(Ee?Math.log(ht<0?0:ht):-Math.log(ht>0?0:-ht))/Math.log(xe)}function je(ht){return Ee?Math.pow(xe,ht):-Math.pow(xe,-ht)}function xt(ht){return fe(Ie(ht))}return xt.invert=function(ht){return je(fe.invert(ht))},xt.domain=function(ht){return arguments.length?(Ee=ht[0]>=0,fe.domain((Fe=ht.map(Number)).map(Ie)),xt):Fe},xt.base=function(ht){return arguments.length?(xe=+ht,fe.domain(Fe.map(Ie)),xt):xe},xt.nice=function(){var ht=Mn(Fe.map(Ie),Ee?Math:Fa);return fe.domain(ht),Fe=ht.map(je),xt},xt.ticks=function(){var ht=Rr(Fe),Ct=[],Xt=ht[0],$t=ht[1],er=Math.floor(Ie(Xt)),Ar=Math.ceil(Ie($t)),Jr=xe%1?2:xe;if(isFinite(Ar-er)){if(Ee){for(;er<Ar;er++)for(var sn=1;sn<Jr;sn++)Ct.push(je(er)*sn);Ct.push(je(er))}else for(Ct.push(je(er));er++<Ar;)for(var sn=Jr-1;sn>0;sn--)Ct.push(je(er)*sn);for(er=0;Ct[er]<Xt;er++);for(Ar=Ct.length;Ct[Ar-1]>$t;Ar--);Ct=Ct.slice(er,Ar)}return Ct},xt.copy=function(){return ka(fe.copy(),xe,Ee,Fe)},Pn(xt,fe)}var Fa={floor:function(fe){return-Math.ceil(-fe)},ceil:function(fe){return-Math.floor(-fe)}};w.scale.pow=function(){return Oa(w.scale.linear(),1,[0,1])};function Oa(fe,xe,Ee){var Fe=Jn(xe),Ie=Jn(1/xe);function je(xt){return fe(Fe(xt))}return je.invert=function(xt){return Ie(fe.invert(xt))},je.domain=function(xt){return arguments.length?(fe.domain((Ee=xt.map(Number)).map(Fe)),je):Ee},je.ticks=function(xt){return za(Ee,xt)},je.tickFormat=function(xt,ht){return d3_scale_linearTickFormat(Ee,xt,ht)},je.nice=function(xt){return je.domain(Vn(Ee,xt))},je.exponent=function(xt){return arguments.length?(Fe=Jn(xe=xt),Ie=Jn(1/xe),fe.domain(Ee.map(Fe)),je):xe},je.copy=function(){return Oa(fe.copy(),xe,Ee)},Pn(je,fe)}function Jn(fe){return function(xe){return xe<0?-Math.pow(-xe,fe):Math.pow(xe,fe)}}w.scale.sqrt=function(){return w.scale.pow().exponent(.5)},w.scale.ordinal=function(){return ha([],{t:"range",a:[[]]})};function ha(fe,xe){var Ee,Fe,Ie;function je(ht){return Fe[((Ee.get(ht)||(xe.t==="range"?Ee.set(ht,fe.push(ht)):NaN))-1)%Fe.length]}function xt(ht,Ct){return w.range(fe.length).map(function(Xt){return ht+Ct*Xt})}return je.domain=function(ht){if(!arguments.length)return fe;fe=[],Ee=new A;for(var Ct=-1,Xt=ht.length,$t;++Ct<Xt;)Ee.has($t=ht[Ct])||Ee.set($t,fe.push($t));return je[xe.t].apply(je,xe.a)},je.range=function(ht){return arguments.length?(Fe=ht,Ie=0,xe={t:"range",a:arguments},je):Fe},je.rangePoints=function(ht,Ct){arguments.length<2&&(Ct=0);var Xt=ht[0],$t=ht[1],er=fe.length<2?(Xt=(Xt+$t)/2,0):($t-Xt)/(fe.length-1+Ct);return Fe=xt(Xt+er*Ct/2,er),Ie=0,xe={t:"rangePoints",a:arguments},je},je.rangeRoundPoints=function(ht,Ct){arguments.length<2&&(Ct=0);var Xt=ht[0],$t=ht[1],er=fe.length<2?(Xt=$t=Math.round((Xt+$t)/2),0):($t-Xt)/(fe.length-1+Ct)|0;return Fe=xt(Xt+Math.round(er*Ct/2+($t-Xt-(fe.length-1+Ct)*er)/2),er),Ie=0,xe={t:"rangeRoundPoints",a:arguments},je},je.rangeBands=function(ht,Ct,Xt){arguments.length<2&&(Ct=0),arguments.length<3&&(Xt=Ct);var $t=ht[1]<ht[0],er=ht[$t-0],Ar=ht[1-$t],Jr=(Ar-er)/(fe.length-Ct+2*Xt);return Fe=xt(er+Jr*Xt,Jr),$t&&Fe.reverse(),Ie=Jr*(1-Ct),xe={t:"rangeBands",a:arguments},je},je.rangeRoundBands=function(ht,Ct,Xt){arguments.length<2&&(Ct=0),arguments.length<3&&(Xt=Ct);var $t=ht[1]<ht[0],er=ht[$t-0],Ar=ht[1-$t],Jr=Math.floor((Ar-er)/(fe.length-Ct+2*Xt));return Fe=xt(er+Math.round((Ar-er-(fe.length-Ct)*Jr)/2),Jr),$t&&Fe.reverse(),Ie=Math.round(Jr*(1-Ct)),xe={t:"rangeRoundBands",a:arguments},je},je.rangeBand=function(){return Ie},je.rangeExtent=function(){return Rr(xe.a[0])},je.copy=function(){return ha(fe,xe)},je.domain(fe)}w.scale.category10=function(){return w.scale.ordinal().range(Ga)},w.scale.category20=function(){return w.scale.ordinal().range(Qa)},w.scale.category20b=function(){return w.scale.ordinal().range(di)},w.scale.category20c=function(){return w.scale.ordinal().range(gi)};var Ga=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(kr),Qa=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(kr),di=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(kr),gi=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(kr);w.scale.quantile=function(){return mi([],[])};function mi(fe,xe){var Ee;function Fe(){var je=0,xt=xe.length;for(Ee=[];++je<xt;)Ee[je-1]=w.quantile(fe,je/xt);return Ie}function Ie(je){if(!isNaN(je=+je))return xe[w.bisect(Ee,je)]}return Ie.domain=function(je){return arguments.length?(fe=je.map(y).filter(p).sort(i),Fe()):fe},Ie.range=function(je){return arguments.length?(xe=je,Fe()):xe},Ie.quantiles=function(){return Ee},Ie.invertExtent=function(je){return je=xe.indexOf(je),je<0?[NaN,NaN]:[je>0?Ee[je-1]:fe[0],je<Ee.length?Ee[je]:fe[fe.length-1]]},Ie.copy=function(){return mi(fe,xe)},Fe()}w.scale.quantize=function(){return Ai(0,1,[0,1])};function Ai(fe,xe,Ee){var Fe,Ie;function je(ht){return Ee[Math.max(0,Math.min(Ie,Math.floor(Fe*(ht-fe))))]}function xt(){return Fe=Ee.length/(xe-fe),Ie=Ee.length-1,je}return je.domain=function(ht){return arguments.length?(fe=+ht[0],xe=+ht[ht.length-1],xt()):[fe,xe]},je.range=function(ht){return arguments.length?(Ee=ht,xt()):Ee},je.invertExtent=function(ht){return ht=Ee.indexOf(ht),ht=ht<0?NaN:ht/Fe+fe,[ht,ht+1/Fe]},je.copy=function(){return Ai(fe,xe,Ee)},xt()}w.scale.threshold=function(){return oi([.5],[0,1])};function oi(fe,xe){function Ee(Fe){if(Fe<=Fe)return xe[w.bisect(fe,Fe)]}return Ee.domain=function(Fe){return arguments.length?(fe=Fe,Ee):fe},Ee.range=function(Fe){return arguments.length?(xe=Fe,Ee):xe},Ee.invertExtent=function(Fe){return Fe=xe.indexOf(Fe),[fe[Fe-1],fe[Fe]]},Ee.copy=function(){return oi(fe,xe)},Ee}w.scale.identity=function(){return yo([0,1])};function yo(fe){function xe(Ee){return+Ee}return xe.invert=xe,xe.domain=xe.range=function(Ee){return arguments.length?(fe=Ee.map(xe),xe):fe},xe.ticks=function(Ee){return za(fe,Ee)},xe.tickFormat=function(Ee,Fe){return d3_scale_linearTickFormat(fe,Ee,Fe)},xe.copy=function(){return yo(fe)},xe}w.svg={};function qi(){return 0}w.svg.arc=function(){var fe=va,xe=xi,Ee=qi,Fe=Ja,Ie=lo,je=vo,xt=ss;function ht(){var Xt=Math.max(0,+fe.apply(this,arguments)),$t=Math.max(0,+xe.apply(this,arguments)),er=Ie.apply(this,arguments)-Je,Ar=je.apply(this,arguments)-Je,Jr=Math.abs(Ar-er),sn=er>Ar?0:1;if($t<Xt&&(Lr=$t,$t=Xt,Xt=Lr),Jr>=Xe)return Ct($t,sn)+(Xt?Ct(Xt,1-sn):"")+"Z";var Lr,Br,Zr,nn,on=0,jr=0,Un,ra,_a,ia,Sa,la,Na,Pa,$a=[];if((nn=(+xt.apply(this,arguments)||0)/2)&&(Zr=Fe===Ja?Math.sqrt(Xt*Xt+$t*$t):+Fe.apply(this,arguments),sn||(jr*=-1),$t&&(jr=Kt(Zr/$t*Math.sin(nn))),Xt&&(on=Kt(Zr/Xt*Math.sin(nn)))),$t){Un=$t*Math.cos(er+jr),ra=$t*Math.sin(er+jr),_a=$t*Math.cos(Ar-jr),ia=$t*Math.sin(Ar-jr);var yi=Math.abs(Ar-er-2*jr)<=Ae?0:1;if(jr&&Ss(Un,ra,_a,ia)===sn^yi){var fo=(er+Ar)/2;Un=$t*Math.cos(fo),ra=$t*Math.sin(fo),_a=ia=null}}else Un=ra=0;if(Xt){Sa=Xt*Math.cos(Ar-on),la=Xt*Math.sin(Ar-on),Na=Xt*Math.cos(er+on),Pa=Xt*Math.sin(er+on);var Ii=Math.abs(er-Ar+2*on)<=Ae?0:1;if(on&&Ss(Sa,la,Na,Pa)===1-sn^Ii){var fa=(er+Ar)/2;Sa=Xt*Math.cos(fa),la=Xt*Math.sin(fa),Na=Pa=null}}else Sa=la=0;if(Jr>qe&&(Lr=Math.min(Math.abs($t-Xt)/2,+Ee.apply(this,arguments)))>.001){Br=Xt<$t^sn?0:1;var ai=Lr,Xa=Lr;if(Jr<Ae){var Si=Na==null?[Sa,la]:_a==null?[Un,ra]:Wa([Un,ra],[Na,Pa],[_a,ia],[Sa,la]),si=Un-Si[0],io=ra-Si[1],Qi=_a-Si[0],go=ia-Si[1],Go=1/Math.sin(Math.acos((si*Qi+io*go)/(Math.sqrt(si*si+io*io)*Math.sqrt(Qi*Qi+go*go)))/2),Fo=Math.sqrt(Si[0]*Si[0]+Si[1]*Si[1]);Xa=Math.min(Lr,(Xt-Fo)/(Go-1)),ai=Math.min(Lr,($t-Fo)/(Go+1))}if(_a!=null){var Yo=Io(Na==null?[Sa,la]:[Na,Pa],[Un,ra],$t,ai,sn),Gi=Io([_a,ia],[Sa,la],$t,ai,sn);Lr===ai?$a.push("M",Yo[0],"A",ai,",",ai," 0 0,",Br," ",Yo[1],"A",$t,",",$t," 0 ",1-sn^Ss(Yo[1][0],Yo[1][1],Gi[1][0],Gi[1][1]),",",sn," ",Gi[1],"A",ai,",",ai," 0 0,",Br," ",Gi[0]):$a.push("M",Yo[0],"A",ai,",",ai," 0 1,",Br," ",Gi[0])}else $a.push("M",Un,",",ra);if(Na!=null){var Bi=Io([Un,ra],[Na,Pa],Xt,-Xa,sn),Ia=Io([Sa,la],_a==null?[Un,ra]:[_a,ia],Xt,-Xa,sn);Lr===Xa?$a.push("L",Ia[0],"A",Xa,",",Xa," 0 0,",Br," ",Ia[1],"A",Xt,",",Xt," 0 ",sn^Ss(Ia[1][0],Ia[1][1],Bi[1][0],Bi[1][1]),",",1-sn," ",Bi[1],"A",Xa,",",Xa," 0 0,",Br," ",Bi[0]):$a.push("L",Ia[0],"A",Xa,",",Xa," 0 0,",Br," ",Bi[0])}else $a.push("L",Sa,",",la)}else $a.push("M",Un,",",ra),_a!=null&&$a.push("A",$t,",",$t," 0 ",yi,",",sn," ",_a,",",ia),$a.push("L",Sa,",",la),Na!=null&&$a.push("A",Xt,",",Xt," 0 ",Ii,",",1-sn," ",Na,",",Pa);return $a.push("Z"),$a.join("")}function Ct(Xt,$t){return"M0,"+Xt+"A"+Xt+","+Xt+" 0 1,"+$t+" 0,"+-Xt+"A"+Xt+","+Xt+" 0 1,"+$t+" 0,"+Xt}return ht.innerRadius=function(Xt){return arguments.length?(fe=tt(Xt),ht):fe},ht.outerRadius=function(Xt){return arguments.length?(xe=tt(Xt),ht):xe},ht.cornerRadius=function(Xt){return arguments.length?(Ee=tt(Xt),ht):Ee},ht.padRadius=function(Xt){return arguments.length?(Fe=Xt==Ja?Ja:tt(Xt),ht):Fe},ht.startAngle=function(Xt){return arguments.length?(Ie=tt(Xt),ht):Ie},ht.endAngle=function(Xt){return arguments.length?(je=tt(Xt),ht):je},ht.padAngle=function(Xt){return arguments.length?(xt=tt(Xt),ht):xt},ht.centroid=function(){var Xt=(+fe.apply(this,arguments)+ +xe.apply(this,arguments))/2,$t=(+Ie.apply(this,arguments)+ +je.apply(this,arguments))/2-Je;return[Math.cos($t)*Xt,Math.sin($t)*Xt]},ht};var Ja="auto";function va(fe){return fe.innerRadius}function xi(fe){return fe.outerRadius}function lo(fe){return fe.startAngle}function vo(fe){return fe.endAngle}function ss(fe){return fe&&fe.padAngle}function Ss(fe,xe,Ee,Fe){return(fe-Ee)*xe-(xe-Fe)*fe>0?0:1}function Io(fe,xe,Ee,Fe,Ie){var je=fe[0]-xe[0],xt=fe[1]-xe[1],ht=(Ie?Fe:-Fe)/Math.sqrt(je*je+xt*xt),Ct=ht*xt,Xt=-ht*je,$t=fe[0]+Ct,er=fe[1]+Xt,Ar=xe[0]+Ct,Jr=xe[1]+Xt,sn=($t+Ar)/2,Lr=(er+Jr)/2,Br=Ar-$t,Zr=Jr-er,nn=Br*Br+Zr*Zr,on=Ee-Fe,jr=$t*Jr-Ar*er,Un=(Zr<0?-1:1)*Math.sqrt(Math.max(0,on*on*nn-jr*jr)),ra=(jr*Zr-Br*Un)/nn,_a=(-jr*Br-Zr*Un)/nn,ia=(jr*Zr+Br*Un)/nn,Sa=(-jr*Br+Zr*Un)/nn,la=ra-sn,Na=_a-Lr,Pa=ia-sn,$a=Sa-Lr;return la*la+Na*Na>Pa*Pa+$a*$a&&(ra=ia,_a=Sa),[[ra-Ct,_a-Xt],[ra*Ee/on,_a*Ee/on]]}function Js(){return!0}function ys(fe){var xe=Hn,Ee=ga,Fe=Js,Ie=mo,je=Ie.key,xt=.7;function ht(Ct){var Xt=[],$t=[],er=-1,Ar=Ct.length,Jr,sn=tt(xe),Lr=tt(Ee);function Br(){Xt.push("M",Ie(fe($t),xt))}for(;++er<Ar;)Fe.call(this,Jr=Ct[er],er)?$t.push([+sn.call(this,Jr,er),+Lr.call(this,Jr,er)]):$t.length&&(Br(),$t=[]);return $t.length&&Br(),Xt.length?Xt.join(""):null}return ht.x=function(Ct){return arguments.length?(xe=Ct,ht):xe},ht.y=function(Ct){return arguments.length?(Ee=Ct,ht):Ee},ht.defined=function(Ct){return arguments.length?(Fe=Ct,ht):Fe},ht.interpolate=function(Ct){return arguments.length?(typeof Ct=="function"?je=Ie=Ct:je=(Ie=ls.get(Ct)||mo).key,ht):je},ht.tension=function(Ct){return arguments.length?(xt=Ct,ht):xt},ht}w.svg.line=function(){return ys(D)};var ls=w.map({linear:mo,"linear-closed":Ol,step:Jl,"step-before":us,"step-after":pu,basis:ks,"basis-open":Xu,"basis-closed":Ru,bundle:Iu,cardinal:Pu,"cardinal-open":Bl,"cardinal-closed":vf,monotone:We});ls.forEach(function(fe,xe){xe.key=fe,xe.closed=/-closed$/.test(fe)});function mo(fe){return fe.length>1?fe.join("L"):fe+"Z"}function Ol(fe){return fe.join("L")+"Z"}function Jl(fe){for(var xe=0,Ee=fe.length,Fe=fe[0],Ie=[Fe[0],",",Fe[1]];++xe<Ee;)Ie.push("H",(Fe[0]+(Fe=fe[xe])[0])/2,"V",Fe[1]);return Ee>1&&Ie.push("H",Fe[0]),Ie.join("")}function us(fe){for(var xe=0,Ee=fe.length,Fe=fe[0],Ie=[Fe[0],",",Fe[1]];++xe<Ee;)Ie.push("V",(Fe=fe[xe])[1],"H",Fe[0]);return Ie.join("")}function pu(fe){for(var xe=0,Ee=fe.length,Fe=fe[0],Ie=[Fe[0],",",Fe[1]];++xe<Ee;)Ie.push("H",(Fe=fe[xe])[0],"V",Fe[1]);return Ie.join("")}function Bl(fe,xe){return fe.length<4?mo(fe):fe[1]+du(fe.slice(1,-1),Du(fe,xe))}function vf(fe,xe){return fe.length<3?Ol(fe):fe[0]+du((fe.push(fe[0]),fe),Du([fe[fe.length-2]].concat(fe,[fe[1]]),xe))}function Pu(fe,xe){return fe.length<3?mo(fe):fe[0]+du(fe,Du(fe,xe))}function du(fe,xe){if(xe.length<1||fe.length!=xe.length&&fe.length!=xe.length+2)return mo(fe);var Ee=fe.length!=xe.length,Fe="",Ie=fe[0],je=fe[1],xt=xe[0],ht=xt,Ct=1;if(Ee&&(Fe+="Q"+(je[0]-xt[0]*2/3)+","+(je[1]-xt[1]*2/3)+","+je[0]+","+je[1],Ie=fe[1],Ct=2),xe.length>1){ht=xe[1],je=fe[Ct],Ct++,Fe+="C"+(Ie[0]+xt[0])+","+(Ie[1]+xt[1])+","+(je[0]-ht[0])+","+(je[1]-ht[1])+","+je[0]+","+je[1];for(var Xt=2;Xt<xe.length;Xt++,Ct++)je=fe[Ct],ht=xe[Xt],Fe+="S"+(je[0]-ht[0])+","+(je[1]-ht[1])+","+je[0]+","+je[1]}if(Ee){var $t=fe[Ct];Fe+="Q"+(je[0]+ht[0]*2/3)+","+(je[1]+ht[1]*2/3)+","+$t[0]+","+$t[1]}return Fe}function Du(fe,xe){for(var Ee=[],Fe=(1-xe)/2,Ie,je=fe[0],xt=fe[1],ht=1,Ct=fe.length;++ht<Ct;)Ie=je,je=xt,xt=fe[ht],Ee.push([Fe*(xt[0]-Ie[0]),Fe*(xt[1]-Ie[1])]);return Ee}function ks(fe){if(fe.length<3)return mo(fe);var xe=1,Ee=fe.length,Fe=fe[0],Ie=Fe[0],je=Fe[1],xt=[Ie,Ie,Ie,(Fe=fe[1])[0]],ht=[je,je,je,Fe[1]],Ct=[Ie,",",je,"L",zo(ms,xt),",",zo(ms,ht)];for(fe.push(fe[Ee-1]);++xe<=Ee;)Fe=fe[xe],xt.shift(),xt.push(Fe[0]),ht.shift(),ht.push(Fe[1]),gu(Ct,xt,ht);return fe.pop(),Ct.push("L",Fe),Ct.join("")}function Xu(fe){if(fe.length<4)return mo(fe);for(var xe=[],Ee=-1,Fe=fe.length,Ie,je=[0],xt=[0];++Ee<3;)Ie=fe[Ee],je.push(Ie[0]),xt.push(Ie[1]);for(xe.push(zo(ms,je)+","+zo(ms,xt)),--Ee;++Ee<Fe;)Ie=fe[Ee],je.shift(),je.push(Ie[0]),xt.shift(),xt.push(Ie[1]),gu(xe,je,xt);return xe.join("")}function Ru(fe){for(var xe,Ee=-1,Fe=fe.length,Ie=Fe+4,je,xt=[],ht=[];++Ee<4;)je=fe[Ee%Fe],xt.push(je[0]),ht.push(je[1]);for(xe=[zo(ms,xt),",",zo(ms,ht)],--Ee;++Ee<Ie;)je=fe[Ee%Fe],xt.shift(),xt.push(je[0]),ht.shift(),ht.push(je[1]),gu(xe,xt,ht);return xe.join("")}function Iu(fe,xe){var Ee=fe.length-1;if(Ee)for(var Fe=fe[0][0],Ie=fe[0][1],je=fe[Ee][0]-Fe,xt=fe[Ee][1]-Ie,ht=-1,Ct,Xt;++ht<=Ee;)Ct=fe[ht],Xt=ht/Ee,Ct[0]=xe*Ct[0]+(1-xe)*(Fe+Xt*je),Ct[1]=xe*Ct[1]+(1-xe)*(Ie+Xt*xt);return ks(fe)}function zo(fe,xe){return fe[0]*xe[0]+fe[1]*xe[1]+fe[2]*xe[2]+fe[3]*xe[3]}var zu=[0,2/3,1/3,0],$u=[0,1/3,2/3,0],ms=[0,1/6,2/3,1/6];function gu(fe,xe,Ee){fe.push("C",zo(zu,xe),",",zo(zu,Ee),",",zo($u,xe),",",zo($u,Ee),",",zo(ms,xe),",",zo(ms,Ee))}function yu(fe,xe){return(xe[1]-fe[1])/(xe[0]-fe[0])}function Fu(fe){for(var xe=0,Ee=fe.length-1,Fe=[],Ie=fe[0],je=fe[1],xt=Fe[0]=yu(Ie,je);++xe<Ee;)Fe[xe]=(xt+(xt=yu(Ie=je,je=fe[xe+1])))/2;return Fe[xe]=xt,Fe}function De(fe){for(var xe=[],Ee,Fe,Ie,je,xt=Fu(fe),ht=-1,Ct=fe.length-1;++ht<Ct;)Ee=yu(fe[ht],fe[ht+1]),u(Ee)<qe?xt[ht]=xt[ht+1]=0:(Fe=xt[ht]/Ee,Ie=xt[ht+1]/Ee,je=Fe*Fe+Ie*Ie,je>9&&(je=Ee*3/Math.sqrt(je),xt[ht]=je*Fe,xt[ht+1]=je*Ie));for(ht=-1;++ht<=Ct;)je=(fe[Math.min(Ct,ht+1)][0]-fe[Math.max(0,ht-1)][0])/(6*(1+xt[ht]*xt[ht])),xe.push([je||0,xt[ht]*je||0]);return xe}function We(fe){return fe.length<3?mo(fe):fe[0]+du(fe,De(fe))}w.svg.line.radial=function(){var fe=ys(et);return fe.radius=fe.x,delete fe.x,fe.angle=fe.y,delete fe.y,fe};function et(fe){for(var xe,Ee=-1,Fe=fe.length,Ie,je;++Ee<Fe;)xe=fe[Ee],Ie=xe[0],je=xe[1]-Je,xe[0]=Ie*Math.cos(je),xe[1]=Ie*Math.sin(je);return fe}function ot(fe){var xe=Hn,Ee=Hn,Fe=0,Ie=ga,je=Js,xt=mo,ht=xt.key,Ct=xt,Xt="L",$t=.7;function er(Ar){var Jr=[],sn=[],Lr=[],Br=-1,Zr=Ar.length,nn,on=tt(xe),jr=tt(Fe),Un=xe===Ee?function(){return _a}:tt(Ee),ra=Fe===Ie?function(){return ia}:tt(Ie),_a,ia;function Sa(){Jr.push("M",xt(fe(Lr),$t),Xt,Ct(fe(sn.reverse()),$t),"Z")}for(;++Br<Zr;)je.call(this,nn=Ar[Br],Br)?(sn.push([_a=+on.call(this,nn,Br),ia=+jr.call(this,nn,Br)]),Lr.push([+Un.call(this,nn,Br),+ra.call(this,nn,Br)])):sn.length&&(Sa(),sn=[],Lr=[]);return sn.length&&Sa(),Jr.length?Jr.join(""):null}return er.x=function(Ar){return arguments.length?(xe=Ee=Ar,er):Ee},er.x0=function(Ar){return arguments.length?(xe=Ar,er):xe},er.x1=function(Ar){return arguments.length?(Ee=Ar,er):Ee},er.y=function(Ar){return arguments.length?(Fe=Ie=Ar,er):Ie},er.y0=function(Ar){return arguments.length?(Fe=Ar,er):Fe},er.y1=function(Ar){return arguments.length?(Ie=Ar,er):Ie},er.defined=function(Ar){return arguments.length?(je=Ar,er):je},er.interpolate=function(Ar){return arguments.length?(typeof Ar=="function"?ht=xt=Ar:ht=(xt=ls.get(Ar)||mo).key,Ct=xt.reverse||xt,Xt=xt.closed?"M":"L",er):ht},er.tension=function(Ar){return arguments.length?($t=Ar,er):$t},er}us.reverse=pu,pu.reverse=us,w.svg.area=function(){return ot(D)},w.svg.area.radial=function(){var fe=ot(et);return fe.radius=fe.x,delete fe.x,fe.innerRadius=fe.x0,delete fe.x0,fe.outerRadius=fe.x1,delete fe.x1,fe.angle=fe.y,delete fe.y,fe.startAngle=fe.y0,delete fe.y0,fe.endAngle=fe.y1,delete fe.y1,fe};function bt(fe){return fe.source}function yt(fe){return fe.target}w.svg.chord=function(){var fe=bt,xe=yt,Ee=Mt,Fe=lo,Ie=vo;function je($t,er){var Ar=xt(this,fe,$t,er),Jr=xt(this,xe,$t,er);return"M"+Ar.p0+Ct(Ar.r,Ar.p1,Ar.a1-Ar.a0)+(ht(Ar,Jr)?Xt(Ar.r,Ar.p1,Ar.r,Ar.p0):Xt(Ar.r,Ar.p1,Jr.r,Jr.p0)+Ct(Jr.r,Jr.p1,Jr.a1-Jr.a0)+Xt(Jr.r,Jr.p1,Ar.r,Ar.p0))+"Z"}function xt($t,er,Ar,Jr){var sn=er.call($t,Ar,Jr),Lr=Ee.call($t,sn,Jr),Br=Fe.call($t,sn,Jr)-Je,Zr=Ie.call($t,sn,Jr)-Je;return{r:Lr,a0:Br,a1:Zr,p0:[Lr*Math.cos(Br),Lr*Math.sin(Br)],p1:[Lr*Math.cos(Zr),Lr*Math.sin(Zr)]}}function ht($t,er){return $t.a0==er.a0&&$t.a1==er.a1}function Ct($t,er,Ar){return"A"+$t+","+$t+" 0 "+ +(Ar>Ae)+",1 "+er}function Xt($t,er,Ar,Jr){return"Q 0,0 "+Jr}return je.radius=function($t){return arguments.length?(Ee=tt($t),je):Ee},je.source=function($t){return arguments.length?(fe=tt($t),je):fe},je.target=function($t){return arguments.length?(xe=tt($t),je):xe},je.startAngle=function($t){return arguments.length?(Fe=tt($t),je):Fe},je.endAngle=function($t){return arguments.length?(Ie=tt($t),je):Ie},je};function Mt(fe){return fe.radius}w.svg.diagonal=function(){var fe=bt,xe=yt,Ee=ur;function Fe(Ie,je){var xt=fe.call(this,Ie,je),ht=xe.call(this,Ie,je),Ct=(xt.y+ht.y)/2,Xt=[xt,{x:xt.x,y:Ct},{x:ht.x,y:Ct},ht];return Xt=Xt.map(Ee),"M"+Xt[0]+"C"+Xt[1]+" "+Xt[2]+" "+Xt[3]}return Fe.source=function(Ie){return arguments.length?(fe=tt(Ie),Fe):fe},Fe.target=function(Ie){return arguments.length?(xe=tt(Ie),Fe):xe},Fe.projection=function(Ie){return arguments.length?(Ee=Ie,Fe):Ee},Fe};function ur(fe){return[fe.x,fe.y]}w.svg.diagonal.radial=function(){var fe=w.svg.diagonal(),xe=ur,Ee=fe.projection;return fe.projection=function(Fe){return arguments.length?Ee(pr(xe=Fe)):xe},fe};function pr(fe){return function(){var xe=fe.apply(this,arguments),Ee=xe[0],Fe=xe[1]-Je;return[Ee*Math.cos(Fe),Ee*Math.sin(Fe)]}}w.svg.symbol=function(){var fe=xr,xe=sr;function Ee(Fe,Ie){return(Xr.get(fe.call(this,Fe,Ie))||Dr)(xe.call(this,Fe,Ie))}return Ee.type=function(Fe){return arguments.length?(fe=tt(Fe),Ee):fe},Ee.size=function(Fe){return arguments.length?(xe=tt(Fe),Ee):xe},Ee};function sr(){return 64}function xr(){return"circle"}function Dr(fe){var xe=Math.sqrt(fe/Ae);return"M0,"+xe+"A"+xe+","+xe+" 0 1,1 0,"+-xe+"A"+xe+","+xe+" 0 1,1 0,"+xe+"Z"}var Xr=w.map({circle:Dr,cross:function(fe){var xe=Math.sqrt(fe/5)/2;return"M"+-3*xe+","+-xe+"H"+-xe+"V"+-3*xe+"H"+xe+"V"+-xe+"H"+3*xe+"V"+xe+"H"+xe+"V"+3*xe+"H"+-xe+"V"+xe+"H"+-3*xe+"Z"},diamond:function(fe){var xe=Math.sqrt(fe/(2*bn)),Ee=xe*bn;return"M0,"+-xe+"L"+Ee+",0 0,"+xe+" "+-Ee+",0Z"},square:function(fe){var xe=Math.sqrt(fe)/2;return"M"+-xe+","+-xe+"L"+xe+","+-xe+" "+xe+","+xe+" "+-xe+","+xe+"Z"},"triangle-down":function(fe){var xe=Math.sqrt(fe/qr),Ee=xe*qr/2;return"M0,"+Ee+"L"+xe+","+-Ee+" "+-xe+","+-Ee+"Z"},"triangle-up":function(fe){var xe=Math.sqrt(fe/qr),Ee=xe*qr/2;return"M0,"+-Ee+"L"+xe+","+Ee+" "+-xe+","+Ee+"Z"}});w.svg.symbolTypes=Xr.keys();var qr=Math.sqrt(3),bn=Math.tan(30*_t);$.transition=function(fe){for(var xe=Ya||++Ka,Ee=ri(fe),Fe=[],Ie,je,xt=ei||{time:Date.now(),ease:Is,delay:0,duration:250},ht=-1,Ct=this.length;++ht<Ct;){Fe.push(Ie=[]);for(var Xt=this[ht],$t=-1,er=Xt.length;++$t<er;)(je=Xt[$t])&&Vi(je,$t,Ee,xe,xt),Ie.push(je)}return da(Fe,Ee,xe)},$.interrupt=function(fe){return this.each(fe==null?Dn:Yn(ri(fe)))};var Dn=Yn(ri());function Yn(fe){return function(){var xe,Ee,Fe;(xe=this[fe])&&(Fe=xe[Ee=xe.active])&&(Fe.timer.c=null,Fe.timer.t=NaN,--xe.count?delete xe[Ee]:delete this[fe],xe.active+=.5,Fe.event&&Fe.event.interrupt.call(this,this.__data__,Fe.index))}}function da(fe,xe,Ee){return re(fe,xa),fe.namespace=xe,fe.id=Ee,fe}var xa=[],Ka=0,Ya,ei;xa.call=$.call,xa.empty=$.empty,xa.node=$.node,xa.size=$.size,w.transition=function(fe,xe){return fe&&fe.transition?Ya?fe.transition(xe):fe:w.selection().transition(fe)},w.transition.prototype=xa,xa.select=function(fe){var xe=this.id,Ee=this.namespace,Fe=[],Ie,je,xt;fe=W(fe);for(var ht=-1,Ct=this.length;++ht<Ct;){Fe.push(Ie=[]);for(var Xt=this[ht],$t=-1,er=Xt.length;++$t<er;)(xt=Xt[$t])&&(je=fe.call(xt,xt.__data__,$t,ht))?("__data__"in xt&&(je.__data__=xt.__data__),Vi(je,$t,Ee,xe,xt[Ee][xe]),Ie.push(je)):Ie.push(null)}return da(Fe,Ee,xe)},xa.selectAll=function(fe){var xe=this.id,Ee=this.namespace,Fe=[],Ie,je,xt,ht,Ct;fe=K(fe);for(var Xt=-1,$t=this.length;++Xt<$t;)for(var er=this[Xt],Ar=-1,Jr=er.length;++Ar<Jr;)if(xt=er[Ar]){Ct=xt[Ee][xe],je=fe.call(xt,xt.__data__,Ar,Xt),Fe.push(Ie=[]);for(var sn=-1,Lr=je.length;++sn<Lr;)(ht=je[sn])&&Vi(ht,sn,Ee,xe,Ct),Ie.push(ht)}return da(Fe,Ee,xe)},xa.filter=function(fe){var xe=[],Ee,Fe,Ie;typeof fe!="function"&&(fe=be(fe));for(var je=0,xt=this.length;je<xt;je++){xe.push(Ee=[]);for(var Fe=this[je],ht=0,Ct=Fe.length;ht<Ct;ht++)(Ie=Fe[ht])&&fe.call(Ie,Ie.__data__,ht,je)&&Ee.push(Ie)}return da(xe,this.namespace,this.id)},xa.tween=function(fe,xe){var Ee=this.id,Fe=this.namespace;return arguments.length<2?this.node()[Fe][Ee].tween.get(fe):Ge(this,xe==null?function(Ie){Ie[Fe][Ee].tween.remove(fe)}:function(Ie){Ie[Fe][Ee].tween.set(fe,xe)})};function hi(fe,xe,Ee,Fe){var Ie=fe.id,je=fe.namespace;return Ge(fe,typeof Ee=="function"?function(xt,ht,Ct){xt[je][Ie].tween.set(xe,Fe(Ee.call(xt,xt.__data__,ht,Ct)))}:(Ee=Fe(Ee),function(xt){xt[je][Ie].tween.set(xe,Ee)}))}xa.attr=function(fe,xe){if(arguments.length<2){for(xe in fe)this.attr(xe,fe[xe]);return this}var Ee=fe=="transform"?Rl:no,Fe=w.ns.qualify(fe);function Ie(){this.removeAttribute(Fe)}function je(){this.removeAttributeNS(Fe.space,Fe.local)}function xt(Ct){return Ct==null?Ie:(Ct+="",function(){var Xt=this.getAttribute(Fe),$t;return Xt!==Ct&&($t=Ee(Xt,Ct),function(er){this.setAttribute(Fe,$t(er))})})}function ht(Ct){return Ct==null?je:(Ct+="",function(){var Xt=this.getAttributeNS(Fe.space,Fe.local),$t;return Xt!==Ct&&($t=Ee(Xt,Ct),function(er){this.setAttributeNS(Fe.space,Fe.local,$t(er))})})}return hi(this,"attr."+fe,xe,Fe.local?ht:xt)},xa.attrTween=function(fe,xe){var Ee=w.ns.qualify(fe);function Fe(je,xt){var ht=xe.call(this,je,xt,this.getAttribute(Ee));return ht&&function(Ct){this.setAttribute(Ee,ht(Ct))}}function Ie(je,xt){var ht=xe.call(this,je,xt,this.getAttributeNS(Ee.space,Ee.local));return ht&&function(Ct){this.setAttributeNS(Ee.space,Ee.local,ht(Ct))}}return this.tween("attr."+fe,Ee.local?Ie:Fe)},xa.style=function(fe,xe,Ee){var Fe=arguments.length;if(Fe<3){if(typeof fe!="string"){Fe<2&&(xe="");for(Ee in fe)this.style(Ee,fe[Ee],xe);return this}Ee=""}function Ie(){this.style.removeProperty(fe)}function je(xt){return xt==null?Ie:(xt+="",function(){var ht=a(this).getComputedStyle(this,null).getPropertyValue(fe),Ct;return ht!==xt&&(Ct=no(ht,xt),function(Xt){this.style.setProperty(fe,Ct(Xt),Ee)})})}return hi(this,"style."+fe,xe,je)},xa.styleTween=function(fe,xe,Ee){arguments.length<3&&(Ee="");function Fe(Ie,je){var xt=xe.call(this,Ie,je,a(this).getComputedStyle(this,null).getPropertyValue(fe));return xt&&function(ht){this.style.setProperty(fe,xt(ht),Ee)}}return this.tween("style."+fe,Fe)},xa.text=function(fe){return hi(this,"text",fe,ao)};function ao(fe){return fe==null&&(fe=""),function(){this.textContent=fe}}xa.remove=function(){var fe=this.namespace;return this.each("end.transition",function(){var xe;this[fe].count<2&&(xe=this.parentNode)&&xe.removeChild(this)})},xa.ease=function(fe){var xe=this.id,Ee=this.namespace;return arguments.length<1?this.node()[Ee][xe].ease:(typeof fe!="function"&&(fe=w.ease.apply(w,arguments)),Ge(this,function(Fe){Fe[Ee][xe].ease=fe}))},xa.delay=function(fe){var xe=this.id,Ee=this.namespace;return arguments.length<1?this.node()[Ee][xe].delay:Ge(this,typeof fe=="function"?function(Fe,Ie,je){Fe[Ee][xe].delay=+fe.call(Fe,Fe.__data__,Ie,je)}:(fe=+fe,function(Fe){Fe[Ee][xe].delay=fe}))},xa.duration=function(fe){var xe=this.id,Ee=this.namespace;return arguments.length<1?this.node()[Ee][xe].duration:Ge(this,typeof fe=="function"?function(Fe,Ie,je){Fe[Ee][xe].duration=Math.max(1,fe.call(Fe,Fe.__data__,Ie,je))}:(fe=Math.max(1,fe),function(Fe){Fe[Ee][xe].duration=fe}))},xa.each=function(fe,xe){var Ee=this.id,Fe=this.namespace;if(arguments.length<2){var Ie=ei,je=Ya;try{Ya=Ee,Ge(this,function(xt,ht,Ct){ei=xt[Fe][Ee],fe.call(xt,xt.__data__,ht,Ct)})}finally{ei=Ie,Ya=je}}else Ge(this,function(xt){var ht=xt[Fe][Ee];(ht.event||(ht.event=w.dispatch("start","end","interrupt"))).on(fe,xe)});return this},xa.transition=function(){for(var fe=this.id,xe=++Ka,Ee=this.namespace,Fe=[],Ie,je,xt,ht,Ct=0,Xt=this.length;Ct<Xt;Ct++){Fe.push(Ie=[]);for(var je=this[Ct],$t=0,er=je.length;$t<er;$t++)(xt=je[$t])&&(ht=xt[Ee][fe],Vi(xt,$t,Ee,xe,{time:ht.time,ease:ht.ease,delay:ht.delay+ht.duration,duration:ht.duration})),Ie.push(xt)}return da(Fe,Ee,xe)};function ri(fe){return fe==null?"__transition__":"__transition_"+fe+"__"}function Vi(fe,xe,Ee,Fe,Ie){var je=fe[Ee]||(fe[Ee]={active:0,count:0}),xt=je[Fe],ht,Ct,Xt,$t,er;function Ar(Lr){var Br=xt.delay;if(Ct.t=Br+ht,Br<=Lr)return Jr(Lr-Br);Ct.c=Jr}function Jr(Lr){var Br=je.active,Zr=je[Br];Zr&&(Zr.timer.c=null,Zr.timer.t=NaN,--je.count,delete je[Br],Zr.event&&Zr.event.interrupt.call(fe,fe.__data__,Zr.index));for(var nn in je)if(+nn<Fe){var on=je[nn];on.timer.c=null,on.timer.t=NaN,--je.count,delete je[nn]}Ct.c=sn,ln(function(){return Ct.c&&sn(Lr||1)&&(Ct.c=null,Ct.t=NaN),1},0,ht),je.active=Fe,xt.event&&xt.event.start.call(fe,fe.__data__,xe),er=[],xt.tween.forEach(function(jr,Un){(Un=Un.call(fe,fe.__data__,xe))&&er.push(Un)}),$t=xt.ease,Xt=xt.duration}function sn(Lr){for(var Br=Lr/Xt,Zr=$t(Br),nn=er.length;nn>0;)er[--nn].call(fe,Zr);if(Br>=1)return xt.event&&xt.event.end.call(fe,fe.__data__,xe),--je.count?delete je[Fe]:delete fe[Ee],1}xt||(ht=Ie.time,Ct=ln(Ar,0,ht),xt=je[Fe]={tween:new A,time:ht,timer:Ct,delay:Ie.delay,duration:Ie.duration,ease:Ie.ease,index:xe},Ie=null,++je.count)}w.svg.axis=function(){var fe=w.scale.linear(),xe=uo,Ee=6,Fe=6,Ie=3,je=[10],xt=null,ht;function Ct(Xt){Xt.each(function(){var $t=w.select(this),er=this.__chart__||fe,Ar=this.__chart__=fe.copy(),Jr=xt==null?Ar.ticks?Ar.ticks.apply(Ar,je):Ar.domain():xt,sn=ht==null?Ar.tickFormat?Ar.tickFormat.apply(Ar,je):D:ht,Lr=$t.selectAll(".tick").data(Jr,Ar),Br=Lr.enter().insert("g",".domain").attr("class","tick").style("opacity",qe),Zr=w.transition(Lr.exit()).style("opacity",qe).remove(),nn=w.transition(Lr.order()).style("opacity",1),on=Math.max(Ee,0)+Ie,jr,Un=tn(Ar),ra=$t.selectAll(".domain").data([0]),_a=(ra.enter().append("path").attr("class","domain"),w.transition(ra));Br.append("line"),Br.append("text");var ia=Br.select("line"),Sa=nn.select("line"),la=Lr.select("text").text(sn),Na=Br.select("text"),Pa=nn.select("text"),$a=xe==="top"||xe==="left"?-1:1,yi,fo,Ii,fa;if(xe==="bottom"||xe==="top"?(jr=bi,yi="x",Ii="y",fo="x2",fa="y2",la.attr("dy",$a<0?"0em":".71em").style("text-anchor","middle"),_a.attr("d","M"+Un[0]+","+$a*Fe+"V0H"+Un[1]+"V"+$a*Fe)):(jr=Mi,yi="y",Ii="x",fo="y2",fa="x2",la.attr("dy",".32em").style("text-anchor",$a<0?"end":"start"),_a.attr("d","M"+$a*Fe+","+Un[0]+"H0V"+Un[1]+"H"+$a*Fe)),ia.attr(fa,$a*Ee),Na.attr(Ii,$a*on),Sa.attr(fo,0).attr(fa,$a*Ee),Pa.attr(yi,0).attr(Ii,$a*on),Ar.rangeBand){var ai=Ar,Xa=ai.rangeBand()/2;er=Ar=function(Si){return ai(Si)+Xa}}else er.rangeBand?er=Ar:Zr.call(jr,Ar,er);Br.call(jr,er,Ar),nn.call(jr,Ar,Ar)})}return Ct.scale=function(Xt){return arguments.length?(fe=Xt,Ct):fe},Ct.orient=function(Xt){return arguments.length?(xe=Xt in bo?Xt+"":uo,Ct):xe},Ct.ticks=function(){return arguments.length?(je=S(arguments),Ct):je},Ct.tickValues=function(Xt){return arguments.length?(xt=Xt,Ct):xt},Ct.tickFormat=function(Xt){return arguments.length?(ht=Xt,Ct):ht},Ct.tickSize=function(Xt){var $t=arguments.length;return $t?(Ee=+Xt,Fe=+arguments[$t-1],Ct):Ee},Ct.innerTickSize=function(Xt){return arguments.length?(Ee=+Xt,Ct):Ee},Ct.outerTickSize=function(Xt){return arguments.length?(Fe=+Xt,Ct):Fe},Ct.tickPadding=function(Xt){return arguments.length?(Ie=+Xt,Ct):Ie},Ct.tickSubdivide=function(){return arguments.length&&Ct},Ct};var uo="bottom",bo={top:1,right:1,bottom:1,left:1};function bi(fe,xe,Ee){fe.attr("transform",function(Fe){var Ie=xe(Fe);return"translate("+(isFinite(Ie)?Ie:Ee(Fe))+",0)"})}function Mi(fe,xe,Ee){fe.attr("transform",function(Fe){var Ie=xe(Fe);return"translate(0,"+(isFinite(Ie)?Ie:Ee(Fe))+")"})}w.svg.brush=function(){var fe=Z($t,"brushstart","brush","brushend"),xe=null,Ee=null,Fe=[0,0],Ie=[0,0],je,xt,ht=!0,Ct=!0,Xt=po[0];function $t(Lr){Lr.each(function(){var Br=w.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush",sn).on("touchstart.brush",sn),Zr=Br.selectAll(".background").data([0]);Zr.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair"),Br.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");var nn=Br.selectAll(".resize").data(Xt,D);nn.exit().remove(),nn.enter().append("g").attr("class",function(ra){return"resize "+ra}).style("cursor",function(ra){return fs[ra]}).append("rect").attr("x",function(ra){return/[ew]$/.test(ra)?-3:null}).attr("y",function(ra){return/^[ns]/.test(ra)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden"),nn.style("display",$t.empty()?"none":null);var on=w.transition(Br),jr=w.transition(Zr),Un;xe&&(Un=tn(xe),jr.attr("x",Un[0]).attr("width",Un[1]-Un[0]),Ar(on)),Ee&&(Un=tn(Ee),jr.attr("y",Un[0]).attr("height",Un[1]-Un[0]),Jr(on)),er(on)})}$t.event=function(Lr){Lr.each(function(){var Br=fe.of(this,arguments),Zr={x:Fe,y:Ie,i:je,j:xt},nn=this.__chart__||Zr;this.__chart__=Zr,Ya?w.select(this).transition().each("start.brush",function(){je=nn.i,xt=nn.j,Fe=nn.x,Ie=nn.y,Br({type:"brushstart"})}).tween("brush:brush",function(){var on=Ji(Fe,Zr.x),jr=Ji(Ie,Zr.y);return je=xt=null,function(Un){Fe=Zr.x=on(Un),Ie=Zr.y=jr(Un),Br({type:"brush",mode:"resize"})}}).each("end.brush",function(){je=Zr.i,xt=Zr.j,Br({type:"brush",mode:"resize"}),Br({type:"brushend"})}):(Br({type:"brushstart"}),Br({type:"brush",mode:"resize"}),Br({type:"brushend"}))})};function er(Lr){Lr.selectAll(".resize").attr("transform",function(Br){return"translate("+Fe[+/e$/.test(Br)]+","+Ie[+/^s/.test(Br)]+")"})}function Ar(Lr){Lr.select(".extent").attr("x",Fe[0]),Lr.selectAll(".extent,.n>rect,.s>rect").attr("width",Fe[1]-Fe[0])}function Jr(Lr){Lr.select(".extent").attr("y",Ie[0]),Lr.selectAll(".extent,.e>rect,.w>rect").attr("height",Ie[1]-Ie[0])}function sn(){var Lr=this,Br=w.select(w.event.target),Zr=fe.of(Lr,arguments),nn=w.select(Lr),on=Br.datum(),jr=!/^(n|s)$/.test(on)&&xe,Un=!/^(e|w)$/.test(on)&&Ee,ra=Br.classed("extent"),_a=Gt(Lr),ia,Sa=w.mouse(Lr),la,Na=w.select(a(Lr)).on("keydown.brush",yi).on("keyup.brush",fo);if(w.event.changedTouches?Na.on("touchmove.brush",Ii).on("touchend.brush",ai):Na.on("mousemove.brush",Ii).on("mouseup.brush",ai),nn.interrupt().selectAll("*").interrupt(),ra)Sa[0]=Fe[0]-Sa[0],Sa[1]=Ie[0]-Sa[1];else if(on){var Pa=+/w$/.test(on),$a=+/^n/.test(on);la=[Fe[1-Pa]-Sa[0],Ie[1-$a]-Sa[1]],Sa[0]=Fe[Pa],Sa[1]=Ie[$a]}else w.event.altKey&&(ia=Sa.slice());nn.style("pointer-events","none").selectAll(".resize").style("display",null),w.select("body").style("cursor",Br.style("cursor")),Zr({type:"brushstart"}),Ii();function yi(){w.event.keyCode==32&&(ra||(ia=null,Sa[0]-=Fe[1],Sa[1]-=Ie[1],ra=2),X())}function fo(){w.event.keyCode==32&&ra==2&&(Sa[0]+=Fe[1],Sa[1]+=Ie[1],ra=0,X())}function Ii(){var Xa=w.mouse(Lr),Si=!1;la&&(Xa[0]+=la[0],Xa[1]+=la[1]),ra||(w.event.altKey?(ia||(ia=[(Fe[0]+Fe[1])/2,(Ie[0]+Ie[1])/2]),Sa[0]=Fe[+(Xa[0]<ia[0])],Sa[1]=Ie[+(Xa[1]<ia[1])]):ia=null),jr&&fa(Xa,xe,0)&&(Ar(nn),Si=!0),Un&&fa(Xa,Ee,1)&&(Jr(nn),Si=!0),Si&&(er(nn),Zr({type:"brush",mode:ra?"move":"resize"}))}function fa(Xa,Si,si){var io=tn(Si),Qi=io[0],go=io[1],Go=Sa[si],Fo=si?Ie:Fe,Yo=Fo[1]-Fo[0],Gi,Bi;if(ra&&(Qi-=Go,go-=Yo+Go),Gi=(si?Ct:ht)?Math.max(Qi,Math.min(go,Xa[si])):Xa[si],ra?Bi=(Gi+=Go)+Yo:(ia&&(Go=Math.max(Qi,Math.min(go,2*ia[si]-Gi))),Go<Gi?(Bi=Gi,Gi=Go):Bi=Go),Fo[0]!=Gi||Fo[1]!=Bi)return si?xt=null:je=null,Fo[0]=Gi,Fo[1]=Bi,!0}function ai(){Ii(),nn.style("pointer-events","all").selectAll(".resize").style("display",$t.empty()?"none":null),w.select("body").style("cursor",null),Na.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),_a(),Zr({type:"brushend"})}}return $t.x=function(Lr){return arguments.length?(xe=Lr,Xt=po[!xe<<1|!Ee],$t):xe},$t.y=function(Lr){return arguments.length?(Ee=Lr,Xt=po[!xe<<1|!Ee],$t):Ee},$t.clamp=function(Lr){return arguments.length?(xe&&Ee?(ht=!!Lr[0],Ct=!!Lr[1]):xe?ht=!!Lr:Ee&&(Ct=!!Lr),$t):xe&&Ee?[ht,Ct]:xe?ht:Ee?Ct:null},$t.extent=function(Lr){var Br,Zr,nn,on,jr;return arguments.length?(xe&&(Br=Lr[0],Zr=Lr[1],Ee&&(Br=Br[0],Zr=Zr[0]),je=[Br,Zr],xe.invert&&(Br=xe(Br),Zr=xe(Zr)),Zr<Br&&(jr=Br,Br=Zr,Zr=jr),(Br!=Fe[0]||Zr!=Fe[1])&&(Fe=[Br,Zr])),Ee&&(nn=Lr[0],on=Lr[1],xe&&(nn=nn[1],on=on[1]),xt=[nn,on],Ee.invert&&(nn=Ee(nn),on=Ee(on)),on<nn&&(jr=nn,nn=on,on=jr),(nn!=Ie[0]||on!=Ie[1])&&(Ie=[nn,on])),$t):(xe&&(je?(Br=je[0],Zr=je[1]):(Br=Fe[0],Zr=Fe[1],xe.invert&&(Br=xe.invert(Br),Zr=xe.invert(Zr)),Zr<Br&&(jr=Br,Br=Zr,Zr=jr))),Ee&&(xt?(nn=xt[0],on=xt[1]):(nn=Ie[0],on=Ie[1],Ee.invert&&(nn=Ee.invert(nn),on=Ee.invert(on)),on<nn&&(jr=nn,nn=on,on=jr))),xe&&Ee?[[Br,nn],[Zr,on]]:xe?[Br,Zr]:Ee&&[nn,on])},$t.clear=function(){return $t.empty()||(Fe=[0,0],Ie=[0,0],je=xt=null),$t},$t.empty=function(){return!!xe&&Fe[0]==Fe[1]||!!Ee&&Ie[0]==Ie[1]},w.rebind($t,fe,"on")};var fs={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},po=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]];w.text=Et(function(fe){return fe.responseText}),w.json=function(fe,xe){return Vt(fe,"application/json",Lo,xe)};function Lo(fe){return JSON.parse(fe.responseText)}w.html=function(fe,xe){return Vt(fe,"text/html",Vo,xe)};function Vo(fe){var xe=M.createRange();return xe.selectNode(M.body),xe.createContextualFragment(fe.responseText)}w.xml=Et(function(fe){return fe.responseXML}),typeof ee=="object"&&ee.exports?ee.exports=w:this.d3=w}).apply(self)},{}],59:[function(d,ee,te){ee.exports=d("./quad")},{"./quad":60}],60:[function(d,ee,te){var w=d("binary-search-bounds"),v=d("clamp"),S=d("parse-rect"),M=d("array-bounds"),e=d("pick-by-alias"),a=d("defined"),n=d("flatten-vertex-data"),r=d("is-obj"),t=d("dtype"),c=d("math-log2"),o=1073741824;ee.exports=function(p,g){g||(g={}),p=n(p,"float64"),g=e(g,{bounds:"range bounds dataBox databox",maxDepth:"depth maxDepth maxdepth level maxLevel maxlevel levels",dtype:"type dtype format out dst output destination"});var h=a(g.maxDepth,255),m=a(g.bounds,M(p,2));m[0]===m[2]&&m[2]++,m[1]===m[3]&&m[3]++;var u=i(p,m),_=p.length>>>1,s;g.dtype||(g.dtype="array"),typeof g.dtype=="string"?s=new(t(g.dtype))(_):g.dtype&&(s=g.dtype,Array.isArray(s)&&(s.length=_));for(var A=0;A<_;++A)s[A]=A;var b=[],f=[],x=[],l=[];D(0,0,1,s,0,1);for(var L=0,T=0;T<b.length;T++){var k=b[T];if(s.set)s.set(k,L);else for(var P=0,z=k.length;P<z;P++)s[P+L]=k[P];var I=L+b[T].length;l[T]=[L,I],L=I}return s.range=R,s;function D(H,G,J,X,Y,Z){if(!X.length)return null;var oe=b[Y]||(b[Y]=[]),re=x[Y]||(x[Y]=[]),se=f[Y]||(f[Y]=[]),N=oe.length;if(Y++,Y>h||Z>o){for(var U=0;U<X.length;U++)oe.push(X[U]),re.push(Z),se.push(null,null,null,null);return N}if(oe.push(X[0]),re.push(Z),X.length<=1)return se.push(null,null,null,null),N;for(var q=J*.5,$=H+q,W=G+q,K=[],ne=[],ae=[],ie=[],le=1,ye=X.length;le<ye;le++){var ue=X[le],pe=u[ue*2],ge=u[ue*2+1];pe<$?ge<W?K.push(ue):ne.push(ue):ge<W?ae.push(ue):ie.push(ue)}return Z<<=2,se.push(D(H,G,q,K,Y,Z),D(H,W,q,ne,Y,Z+1),D($,G,q,ae,Y,Z+2),D($,W,q,ie,Y,Z+3)),N}function R(){for(var H=[],G=arguments.length;G--;)H[G]=arguments[G];var J;if(r(H[H.length-1])){var X=H.pop();!H.length&&(X.x!=null||X.l!=null||X.left!=null)&&(H=[X],J={}),J=e(X,{level:"level maxLevel",d:"d diam diameter r radius px pxSize pixel pixelSize maxD size minSize",lod:"lod details ranges offsets"})}else J={};H.length||(H=m);var Y=S.apply(void 0,H),Z=[Math.min(Y.x,Y.x+Y.width),Math.min(Y.y,Y.y+Y.height),Math.max(Y.x,Y.x+Y.width),Math.max(Y.y,Y.y+Y.height)],oe=Z[0],re=Z[1],se=Z[2],N=Z[3],U=i([oe,re,se,N],m),q=U[0],$=U[1],W=U[2],K=U[3],ne=a(J.level,b.length);if(J.d!=null){var ae;typeof J.d=="number"?ae=[J.d,J.d]:J.d.length&&(ae=J.d),ne=Math.min(Math.max(Math.ceil(-c(Math.abs(ae[0])/(m[2]-m[0]))),Math.ceil(-c(Math.abs(ae[1])/(m[3]-m[1])))),ne)}if(ne=Math.min(ne,b.length),J.lod)return B(q,$,W,K,ne);var ie=[];le(0,0,1,0,0,1);function le(ue,pe,ge,Te,_e,ze){if(!(_e===null||ze===null)){var Oe=ue+ge,Ye=pe+ge;if(!(q>Oe||$>Ye||W<ue||K<pe)&&!(Te>=ne)&&_e!==ze){var be=b[Te];ze===void 0&&(ze=be.length);for(var Pe=_e;Pe<ze;Pe++){var Ge=be[Pe],Qe=p[Ge*2],Be=p[Ge*2+1];Qe>=oe&&Qe<=se&&Be>=re&&Be<=N&&ie.push(Ge)}var Le=f[Te],He=Le[_e*4+0],vt=Le[_e*4+1],Rt=Le[_e*4+2],rr=Le[_e*4+3],Lt=ye(Le,_e+1),Ft=ge*.5,Gt=Te+1;le(ue,pe,Ft,Gt,He,vt||Rt||rr||Lt),le(ue,pe+Ft,Ft,Gt,vt,Rt||rr||Lt),le(ue+Ft,pe,Ft,Gt,Rt,rr||Lt),le(ue+Ft,pe+Ft,Ft,Gt,rr,Lt)}}}function ye(ue,pe){for(var ge=null,Te=0;ge===null;)if(ge=ue[pe*4+Te],Te++,Te>ue.length)return null;return ge}return ie}function B(H,G,J,X,Y){for(var Z=[],oe=0;oe<Y;oe++){var re=x[oe],se=l[oe][0],N=F(H,G,oe),U=F(J,X,oe),q=w.ge(re,N),$=w.gt(re,U,q,re.length-1);Z[oe]=[q+se,$+se]}return Z}function F(H,G,J){for(var X=1,Y=.5,Z=.5,oe=.5,re=0;re<J;re++)X<<=2,X+=H<Y?G<Z?0:1:G<Z?2:3,oe*=.5,Y+=H<Y?-oe:oe,Z+=G<Z?-oe:oe;return X}};function i(y,p){for(var g=p[0],h=p[1],m=p[2],u=p[3],_=1/(m-g),s=1/(u-h),A=new Array(y.length),b=0,f=y.length/2;b<f;b++)A[2*b]=v((y[2*b]-g)*_,0,1),A[2*b+1]=v((y[2*b+1]-h)*s,0,1);return A}},{"array-bounds":71,"binary-search-bounds":80,clamp:86,defined:124,dtype:127,"flatten-vertex-data":191,"is-obj":235,"math-log2":240,"parse-rect":249,"pick-by-alias":253}],61:[function(d,ee,te){Object.defineProperty(te,"__esModule",{value:!0});var w=d("@turf/meta"),v=6378137;function S(r){return w.geomReduce(r,function(t,c){return t+M(c)},0)}te.default=S;function M(r){var t=0,c;switch(r.type){case"Polygon":return e(r.coordinates);case"MultiPolygon":for(c=0;c<r.coordinates.length;c++)t+=e(r.coordinates[c]);return t;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}function e(r){var t=0;if(r&&r.length>0){t+=Math.abs(a(r[0]));for(var c=1;c<r.length;c++)t-=Math.abs(a(r[c]))}return t}function a(r){var t,c,o,i,y,p,g,h=0,m=r.length;if(m>2){for(g=0;g<m;g++)g===m-2?(i=m-2,y=m-1,p=0):g===m-1?(i=m-1,y=0,p=1):(i=g,y=g+1,p=g+2),t=r[i],c=r[y],o=r[p],h+=(n(o[0])-n(t[0]))*Math.sin(n(c[1]));h=h*v*v/2}return h}function n(r){return r*Math.PI/180}},{"@turf/meta":63}],62:[function(d,ee,te){Object.defineProperty(te,"__esModule",{value:!0}),te.earthRadius=63710088e-1,te.factors={centimeters:te.earthRadius*100,centimetres:te.earthRadius*100,degrees:te.earthRadius/111325,feet:te.earthRadius*3.28084,inches:te.earthRadius*39.37,kilometers:te.earthRadius/1e3,kilometres:te.earthRadius/1e3,meters:te.earthRadius,metres:te.earthRadius,miles:te.earthRadius/1609.344,millimeters:te.earthRadius*1e3,millimetres:te.earthRadius*1e3,nauticalmiles:te.earthRadius/1852,radians:1,yards:te.earthRadius*1.0936},te.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:1/1e3,kilometres:1/1e3,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/te.earthRadius,yards:1.0936133},te.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046};function w(T,k,P){P===void 0&&(P={});var z={type:"Feature"};return(P.id===0||P.id)&&(z.id=P.id),P.bbox&&(z.bbox=P.bbox),z.properties=k||{},z.geometry=T,z}te.feature=w;function v(T,k,P){switch(T){case"Point":return S(k).geometry;case"LineString":return n(k).geometry;case"Polygon":return e(k).geometry;case"MultiPoint":return o(k).geometry;case"MultiLineString":return c(k).geometry;case"MultiPolygon":return i(k).geometry;default:throw new Error(T+" is invalid")}}te.geometry=v;function S(T,k,P){if(P===void 0&&(P={}),!T)throw new Error("coordinates is required");if(!Array.isArray(T))throw new Error("coordinates must be an Array");if(T.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!f(T[0])||!f(T[1]))throw new Error("coordinates must contain numbers");var z={type:"Point",coordinates:T};return w(z,k,P)}te.point=S;function M(T,k,P){return P===void 0&&(P={}),t(T.map(function(z){return S(z,k)}),P)}te.points=M;function e(T,k,P){P===void 0&&(P={});for(var z=0,I=T;z<I.length;z++){var D=I[z];if(D.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var R=0;R<D[D.length-1].length;R++)if(D[D.length-1][R]!==D[0][R])throw new Error("First and last Position are not equivalent.")}var B={type:"Polygon",coordinates:T};return w(B,k,P)}te.polygon=e;function a(T,k,P){return P===void 0&&(P={}),t(T.map(function(z){return e(z,k)}),P)}te.polygons=a;function n(T,k,P){if(P===void 0&&(P={}),T.length<2)throw new Error("coordinates must be an array of two or more positions");var z={type:"LineString",coordinates:T};return w(z,k,P)}te.lineString=n;function r(T,k,P){return P===void 0&&(P={}),t(T.map(function(z){return n(z,k)}),P)}te.lineStrings=r;function t(T,k){k===void 0&&(k={});var P={type:"FeatureCollection"};return k.id&&(P.id=k.id),k.bbox&&(P.bbox=k.bbox),P.features=T,P}te.featureCollection=t;function c(T,k,P){P===void 0&&(P={});var z={type:"MultiLineString",coordinates:T};return w(z,k,P)}te.multiLineString=c;function o(T,k,P){P===void 0&&(P={});var z={type:"MultiPoint",coordinates:T};return w(z,k,P)}te.multiPoint=o;function i(T,k,P){P===void 0&&(P={});var z={type:"MultiPolygon",coordinates:T};return w(z,k,P)}te.multiPolygon=i;function y(T,k,P){P===void 0&&(P={});var z={type:"GeometryCollection",geometries:T};return w(z,k,P)}te.geometryCollection=y;function p(T,k){if(k===void 0&&(k=0),k&&!(k>=0))throw new Error("precision must be a positive number");var P=Math.pow(10,k||0);return Math.round(T*P)/P}te.round=p;function g(T,k){k===void 0&&(k="kilometers");var P=te.factors[k];if(!P)throw new Error(k+" units is invalid");return T*P}te.radiansToLength=g;function h(T,k){k===void 0&&(k="kilometers");var P=te.factors[k];if(!P)throw new Error(k+" units is invalid");return T/P}te.lengthToRadians=h;function m(T,k){return _(h(T,k))}te.lengthToDegrees=m;function u(T){var k=T%360;return k<0&&(k+=360),k}te.bearingToAzimuth=u;function _(T){var k=T%(2*Math.PI);return k*180/Math.PI}te.radiansToDegrees=_;function s(T){var k=T%360;return k*Math.PI/180}te.degreesToRadians=s;function A(T,k,P){if(k===void 0&&(k="kilometers"),P===void 0&&(P="kilometers"),!(T>=0))throw new Error("length must be a positive number");return g(h(T,k),P)}te.convertLength=A;function b(T,k,P){if(k===void 0&&(k="meters"),P===void 0&&(P="kilometers"),!(T>=0))throw new Error("area must be a positive number");var z=te.areaFactors[k];if(!z)throw new Error("invalid original units");var I=te.areaFactors[P];if(!I)throw new Error("invalid final units");return T/z*I}te.convertArea=b;function f(T){return!isNaN(T)&&T!==null&&!Array.isArray(T)}te.isNumber=f;function x(T){return!!T&&T.constructor===Object}te.isObject=x;function l(T){if(!T)throw new Error("bbox is required");if(!Array.isArray(T))throw new Error("bbox must be an Array");if(T.length!==4&&T.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");T.forEach(function(k){if(!f(k))throw new Error("bbox must only contain numbers")})}te.validateBBox=l;function L(T){if(!T)throw new Error("id is required");if(["string","number"].indexOf(typeof T)===-1)throw new Error("id must be a number or a string")}te.validateId=L},{}],63:[function(d,ee,te){Object.defineProperty(te,"__esModule",{value:!0});var w=d("@turf/helpers");function v(_,s,A){if(_!==null)for(var b,f,x,l,L,T,k,P=0,z=0,I,D=_.type,R=D==="FeatureCollection",B=D==="Feature",F=R?_.features.length:1,H=0;H<F;H++){k=R?_.features[H].geometry:B?_.geometry:_,I=k?k.type==="GeometryCollection":!1,L=I?k.geometries.length:1;for(var G=0;G<L;G++){var J=0,X=0;if(l=I?k.geometries[G]:k,l!==null){T=l.coordinates;var Y=l.type;switch(P=A&&(Y==="Polygon"||Y==="MultiPolygon")?1:0,Y){case null:break;case"Point":if(s(T,z,H,J,X)===!1)return!1;z++,J++;break;case"LineString":case"MultiPoint":for(b=0;b<T.length;b++){if(s(T[b],z,H,J,X)===!1)return!1;z++,Y==="MultiPoint"&&J++}Y==="LineString"&&J++;break;case"Polygon":case"MultiLineString":for(b=0;b<T.length;b++){for(f=0;f<T[b].length-P;f++){if(s(T[b][f],z,H,J,X)===!1)return!1;z++}Y==="MultiLineString"&&J++,Y==="Polygon"&&X++}Y==="Polygon"&&J++;break;case"MultiPolygon":for(b=0;b<T.length;b++){for(X=0,f=0;f<T[b].length;f++){for(x=0;x<T[b][f].length-P;x++){if(s(T[b][f][x],z,H,J,X)===!1)return!1;z++}X++}J++}break;case"GeometryCollection":for(b=0;b<l.geometries.length;b++)if(v(l.geometries[b],s,A)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function S(_,s,A,b){var f=A;return v(_,function(x,l,L,T,k){l===0&&A===void 0?f=x:f=s(f,x,l,L,T,k)},b),f}function M(_,s){var A;switch(_.type){case"FeatureCollection":for(A=0;A<_.features.length&&s(_.features[A].properties,A)!==!1;A++);break;case"Feature":s(_.properties,0);break}}function e(_,s,A){var b=A;return M(_,function(f,x){x===0&&A===void 0?b=f:b=s(b,f,x)}),b}function a(_,s){if(_.type==="Feature")s(_,0);else if(_.type==="FeatureCollection")for(var A=0;A<_.features.length&&s(_.features[A],A)!==!1;A++);}function n(_,s,A){var b=A;return a(_,function(f,x){x===0&&A===void 0?b=f:b=s(b,f,x)}),b}function r(_){var s=[];return v(_,function(A){s.push(A)}),s}function t(_,s){var A,b,f,x,l,L,T,k,P,z,I=0,D=_.type==="FeatureCollection",R=_.type==="Feature",B=D?_.features.length:1;for(A=0;A<B;A++){for(L=D?_.features[A].geometry:R?_.geometry:_,k=D?_.features[A].properties:R?_.properties:{},P=D?_.features[A].bbox:R?_.bbox:void 0,z=D?_.features[A].id:R?_.id:void 0,T=L?L.type==="GeometryCollection":!1,l=T?L.geometries.length:1,f=0;f<l;f++){if(x=T?L.geometries[f]:L,x===null){if(s(null,I,k,P,z)===!1)return!1;continue}switch(x.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(s(x,I,k,P,z)===!1)return!1;break}case"GeometryCollection":{for(b=0;b<x.geometries.length;b++)if(s(x.geometries[b],I,k,P,z)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}I++}}function c(_,s,A){var b=A;return t(_,function(f,x,l,L,T){x===0&&A===void 0?b=f:b=s(b,f,x,l,L,T)}),b}function o(_,s){t(_,function(A,b,f,x,l){var L=A===null?null:A.type;switch(L){case null:case"Point":case"LineString":case"Polygon":return s(w.feature(A,f,{bbox:x,id:l}),b,0)===!1?!1:void 0}var T;switch(L){case"MultiPoint":T="Point";break;case"MultiLineString":T="LineString";break;case"MultiPolygon":T="Polygon";break}for(var k=0;k<A.coordinates.length;k++){var P=A.coordinates[k],z={type:T,coordinates:P};if(s(w.feature(z,f),b,k)===!1)return!1}})}function i(_,s,A){var b=A;return o(_,function(f,x,l){x===0&&l===0&&A===void 0?b=f:b=s(b,f,x,l)}),b}function y(_,s){o(_,function(A,b,f){var x=0;if(!!A.geometry){var l=A.geometry.type;if(!(l==="Point"||l==="MultiPoint")){var L,T=0,k=0,P=0;if(v(A,function(z,I,D,R,B){if(L===void 0||b>T||R>k||B>P){L=z,T=b,k=R,P=B,x=0;return}var F=w.lineString([L,z],A.properties);if(s(F,b,f,B,x)===!1)return!1;x++,L=z})===!1)return!1}}})}function p(_,s,A){var b=A,f=!1;return y(_,function(x,l,L,T,k){f===!1&&A===void 0?b=x:b=s(b,x,l,L,T,k),f=!0}),b}function g(_,s){if(!_)throw new Error("geojson is required");o(_,function(A,b,f){if(A.geometry!==null){var x=A.geometry.type,l=A.geometry.coordinates;switch(x){case"LineString":if(s(A,b,f,0,0)===!1)return!1;break;case"Polygon":for(var L=0;L<l.length;L++)if(s(w.lineString(l[L],A.properties),b,f,L)===!1)return!1;break}}})}function h(_,s,A){var b=A;return g(_,function(f,x,l,L){x===0&&A===void 0?b=f:b=s(b,f,x,l,L)}),b}function m(_,s){if(s=s||{},!w.isObject(s))throw new Error("options is invalid");var A=s.featureIndex||0,b=s.multiFeatureIndex||0,f=s.geometryIndex||0,x=s.segmentIndex||0,l=s.properties,L;switch(_.type){case"FeatureCollection":A<0&&(A=_.features.length+A),l=l||_.features[A].properties,L=_.features[A].geometry;break;case"Feature":l=l||_.properties,L=_.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":L=_;break;default:throw new Error("geojson is invalid")}if(L===null)return null;var T=L.coordinates;switch(L.type){case"Point":case"MultiPoint":return null;case"LineString":return x<0&&(x=T.length+x-1),w.lineString([T[x],T[x+1]],l,s);case"Polygon":return f<0&&(f=T.length+f),x<0&&(x=T[f].length+x-1),w.lineString([T[f][x],T[f][x+1]],l,s);case"MultiLineString":return b<0&&(b=T.length+b),x<0&&(x=T[b].length+x-1),w.lineString([T[b][x],T[b][x+1]],l,s);case"MultiPolygon":return b<0&&(b=T.length+b),f<0&&(f=T[b].length+f),x<0&&(x=T[b][f].length-x-1),w.lineString([T[b][f][x],T[b][f][x+1]],l,s)}throw new Error("geojson is invalid")}function u(_,s){if(s=s||{},!w.isObject(s))throw new Error("options is invalid");var A=s.featureIndex||0,b=s.multiFeatureIndex||0,f=s.geometryIndex||0,x=s.coordIndex||0,l=s.properties,L;switch(_.type){case"FeatureCollection":A<0&&(A=_.features.length+A),l=l||_.features[A].properties,L=_.features[A].geometry;break;case"Feature":l=l||_.properties,L=_.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":L=_;break;default:throw new Error("geojson is invalid")}if(L===null)return null;var T=L.coordinates;switch(L.type){case"Point":return w.point(T,l,s);case"MultiPoint":return b<0&&(b=T.length+b),w.point(T[b],l,s);case"LineString":return x<0&&(x=T.length+x),w.point(T[x],l,s);case"Polygon":return f<0&&(f=T.length+f),x<0&&(x=T[f].length+x),w.point(T[f][x],l,s);case"MultiLineString":return b<0&&(b=T.length+b),x<0&&(x=T[b].length+x),w.point(T[b][x],l,s);case"MultiPolygon":return b<0&&(b=T.length+b),f<0&&(f=T[b].length+f),x<0&&(x=T[b][f].length-x),w.point(T[b][f][x],l,s)}throw new Error("geojson is invalid")}te.coordEach=v,te.coordReduce=S,te.propEach=M,te.propReduce=e,te.featureEach=a,te.featureReduce=n,te.coordAll=r,te.geomEach=t,te.geomReduce=c,te.flattenEach=o,te.flattenReduce=i,te.segmentEach=y,te.segmentReduce=p,te.lineEach=g,te.lineReduce=h,te.findSegment=m,te.findPoint=u},{"@turf/helpers":62}],64:[function(d,ee,te){Object.defineProperty(te,"__esModule",{value:!0});var w=d("@turf/meta");function v(S){var M=[1/0,1/0,-1/0,-1/0];return w.coordEach(S,function(e){M[0]>e[0]&&(M[0]=e[0]),M[1]>e[1]&&(M[1]=e[1]),M[2]<e[0]&&(M[2]=e[0]),M[3]<e[1]&&(M[3]=e[1])}),M}v.default=v,te.default=v},{"@turf/meta":66}],65:[function(d,ee,te){arguments[4][62][0].apply(te,arguments)},{dup:62}],66:[function(d,ee,te){arguments[4][63][0].apply(te,arguments)},{"@turf/helpers":65,dup:63}],67:[function(d,ee,te){Object.defineProperty(te,"__esModule",{value:!0});var w=d("@turf/meta"),v=d("@turf/helpers");function S(M,e){e===void 0&&(e={});var a=0,n=0,r=0;return w.coordEach(M,function(t){a+=t[0],n+=t[1],r++}),v.point([a/r,n/r],e.properties)}te.default=S},{"@turf/helpers":68,"@turf/meta":69}],68:[function(d,ee,te){Object.defineProperty(te,"__esModule",{value:!0}),te.earthRadius=63710088e-1,te.factors={centimeters:te.earthRadius*100,centimetres:te.earthRadius*100,degrees:te.earthRadius/111325,feet:te.earthRadius*3.28084,inches:te.earthRadius*39.37,kilometers:te.earthRadius/1e3,kilometres:te.earthRadius/1e3,meters:te.earthRadius,metres:te.earthRadius,miles:te.earthRadius/1609.344,millimeters:te.earthRadius*1e3,millimetres:te.earthRadius*1e3,nauticalmiles:te.earthRadius/1852,radians:1,yards:te.earthRadius/1.0936},te.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:1/1e3,kilometres:1/1e3,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/te.earthRadius,yards:1/1.0936},te.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046};function w(B,F,H){H===void 0&&(H={});var G={type:"Feature"};return(H.id===0||H.id)&&(G.id=H.id),H.bbox&&(G.bbox=H.bbox),G.properties=F||{},G.geometry=B,G}te.feature=w;function v(B,F,H){switch(B){case"Point":return S(F).geometry;case"LineString":return n(F).geometry;case"Polygon":return e(F).geometry;case"MultiPoint":return o(F).geometry;case"MultiLineString":return c(F).geometry;case"MultiPolygon":return i(F).geometry;default:throw new Error(B+" is invalid")}}te.geometry=v;function S(B,F,H){H===void 0&&(H={});var G={type:"Point",coordinates:B};return w(G,F,H)}te.point=S;function M(B,F,H){return H===void 0&&(H={}),t(B.map(function(G){return S(G,F)}),H)}te.points=M;function e(B,F,H){H===void 0&&(H={});for(var G=0,J=B;G<J.length;G++){var X=J[G];if(X.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var Y=0;Y<X[X.length-1].length;Y++)if(X[X.length-1][Y]!==X[0][Y])throw new Error("First and last Position are not equivalent.")}var Z={type:"Polygon",coordinates:B};return w(Z,F,H)}te.polygon=e;function a(B,F,H){return H===void 0&&(H={}),t(B.map(function(G){return e(G,F)}),H)}te.polygons=a;function n(B,F,H){if(H===void 0&&(H={}),B.length<2)throw new Error("coordinates must be an array of two or more positions");var G={type:"LineString",coordinates:B};return w(G,F,H)}te.lineString=n;function r(B,F,H){return H===void 0&&(H={}),t(B.map(function(G){return n(G,F)}),H)}te.lineStrings=r;function t(B,F){F===void 0&&(F={});var H={type:"FeatureCollection"};return F.id&&(H.id=F.id),F.bbox&&(H.bbox=F.bbox),H.features=B,H}te.featureCollection=t;function c(B,F,H){H===void 0&&(H={});var G={type:"MultiLineString",coordinates:B};return w(G,F,H)}te.multiLineString=c;function o(B,F,H){H===void 0&&(H={});var G={type:"MultiPoint",coordinates:B};return w(G,F,H)}te.multiPoint=o;function i(B,F,H){H===void 0&&(H={});var G={type:"MultiPolygon",coordinates:B};return w(G,F,H)}te.multiPolygon=i;function y(B,F,H){H===void 0&&(H={});var G={type:"GeometryCollection",geometries:B};return w(G,F,H)}te.geometryCollection=y;function p(B,F){if(F===void 0&&(F=0),F&&!(F>=0))throw new Error("precision must be a positive number");var H=Math.pow(10,F||0);return Math.round(B*H)/H}te.round=p;function g(B,F){F===void 0&&(F="kilometers");var H=te.factors[F];if(!H)throw new Error(F+" units is invalid");return B*H}te.radiansToLength=g;function h(B,F){F===void 0&&(F="kilometers");var H=te.factors[F];if(!H)throw new Error(F+" units is invalid");return B/H}te.lengthToRadians=h;function m(B,F){return _(h(B,F))}te.lengthToDegrees=m;function u(B){var F=B%360;return F<0&&(F+=360),F}te.bearingToAzimuth=u;function _(B){var F=B%(2*Math.PI);return F*180/Math.PI}te.radiansToDegrees=_;function s(B){var F=B%360;return F*Math.PI/180}te.degreesToRadians=s;function A(B,F,H){if(F===void 0&&(F="kilometers"),H===void 0&&(H="kilometers"),!(B>=0))throw new Error("length must be a positive number");return g(h(B,F),H)}te.convertLength=A;function b(B,F,H){if(F===void 0&&(F="meters"),H===void 0&&(H="kilometers"),!(B>=0))throw new Error("area must be a positive number");var G=te.areaFactors[F];if(!G)throw new Error("invalid original units");var J=te.areaFactors[H];if(!J)throw new Error("invalid final units");return B/G*J}te.convertArea=b;function f(B){return!isNaN(B)&&B!==null&&!Array.isArray(B)&&!/^\s*$/.test(B)}te.isNumber=f;function x(B){return!!B&&B.constructor===Object}te.isObject=x;function l(B){if(!B)throw new Error("bbox is required");if(!Array.isArray(B))throw new Error("bbox must be an Array");if(B.length!==4&&B.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");B.forEach(function(F){if(!f(F))throw new Error("bbox must only contain numbers")})}te.validateBBox=l;function L(B){if(!B)throw new Error("id is required");if(["string","number"].indexOf(typeof B)===-1)throw new Error("id must be a number or a string")}te.validateId=L;function T(){throw new Error("method has been renamed to `radiansToDegrees`")}te.radians2degrees=T;function k(){throw new Error("method has been renamed to `degreesToRadians`")}te.degrees2radians=k;function P(){throw new Error("method has been renamed to `lengthToDegrees`")}te.distanceToDegrees=P;function z(){throw new Error("method has been renamed to `lengthToRadians`")}te.distanceToRadians=z;function I(){throw new Error("method has been renamed to `radiansToLength`")}te.radiansToDistance=I;function D(){throw new Error("method has been renamed to `bearingToAzimuth`")}te.bearingToAngle=D;function R(){throw new Error("method has been renamed to `convertLength`")}te.convertDistance=R},{}],69:[function(d,ee,te){Object.defineProperty(te,"__esModule",{value:!0});var w=d("@turf/helpers");function v(_,s,A){if(_!==null)for(var b,f,x,l,L,T,k,P=0,z=0,I,D=_.type,R=D==="FeatureCollection",B=D==="Feature",F=R?_.features.length:1,H=0;H<F;H++){k=R?_.features[H].geometry:B?_.geometry:_,I=k?k.type==="GeometryCollection":!1,L=I?k.geometries.length:1;for(var G=0;G<L;G++){var J=0,X=0;if(l=I?k.geometries[G]:k,l!==null){T=l.coordinates;var Y=l.type;switch(P=A&&(Y==="Polygon"||Y==="MultiPolygon")?1:0,Y){case null:break;case"Point":if(s(T,z,H,J,X)===!1)return!1;z++,J++;break;case"LineString":case"MultiPoint":for(b=0;b<T.length;b++){if(s(T[b],z,H,J,X)===!1)return!1;z++,Y==="MultiPoint"&&J++}Y==="LineString"&&J++;break;case"Polygon":case"MultiLineString":for(b=0;b<T.length;b++){for(f=0;f<T[b].length-P;f++){if(s(T[b][f],z,H,J,X)===!1)return!1;z++}Y==="MultiLineString"&&J++,Y==="Polygon"&&X++}Y==="Polygon"&&J++;break;case"MultiPolygon":for(b=0;b<T.length;b++){for(X=0,f=0;f<T[b].length;f++){for(x=0;x<T[b][f].length-P;x++){if(s(T[b][f][x],z,H,J,X)===!1)return!1;z++}X++}J++}break;case"GeometryCollection":for(b=0;b<l.geometries.length;b++)if(v(l.geometries[b],s,A)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function S(_,s,A,b){var f=A;return v(_,function(x,l,L,T,k){l===0&&A===void 0?f=x:f=s(f,x,l,L,T,k)},b),f}function M(_,s){var A;switch(_.type){case"FeatureCollection":for(A=0;A<_.features.length&&s(_.features[A].properties,A)!==!1;A++);break;case"Feature":s(_.properties,0);break}}function e(_,s,A){var b=A;return M(_,function(f,x){x===0&&A===void 0?b=f:b=s(b,f,x)}),b}function a(_,s){if(_.type==="Feature")s(_,0);else if(_.type==="FeatureCollection")for(var A=0;A<_.features.length&&s(_.features[A],A)!==!1;A++);}function n(_,s,A){var b=A;return a(_,function(f,x){x===0&&A===void 0?b=f:b=s(b,f,x)}),b}function r(_){var s=[];return v(_,function(A){s.push(A)}),s}function t(_,s){var A,b,f,x,l,L,T,k,P,z,I=0,D=_.type==="FeatureCollection",R=_.type==="Feature",B=D?_.features.length:1;for(A=0;A<B;A++){for(L=D?_.features[A].geometry:R?_.geometry:_,k=D?_.features[A].properties:R?_.properties:{},P=D?_.features[A].bbox:R?_.bbox:void 0,z=D?_.features[A].id:R?_.id:void 0,T=L?L.type==="GeometryCollection":!1,l=T?L.geometries.length:1,f=0;f<l;f++){if(x=T?L.geometries[f]:L,x===null){if(s(null,I,k,P,z)===!1)return!1;continue}switch(x.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(s(x,I,k,P,z)===!1)return!1;break}case"GeometryCollection":{for(b=0;b<x.geometries.length;b++)if(s(x.geometries[b],I,k,P,z)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}I++}}function c(_,s,A){var b=A;return t(_,function(f,x,l,L,T){x===0&&A===void 0?b=f:b=s(b,f,x,l,L,T)}),b}function o(_,s){t(_,function(A,b,f,x,l){var L=A===null?null:A.type;switch(L){case null:case"Point":case"LineString":case"Polygon":return s(w.feature(A,f,{bbox:x,id:l}),b,0)===!1?!1:void 0}var T;switch(L){case"MultiPoint":T="Point";break;case"MultiLineString":T="LineString";break;case"MultiPolygon":T="Polygon";break}for(var k=0;k<A.coordinates.length;k++){var P=A.coordinates[k],z={type:T,coordinates:P};if(s(w.feature(z,f),b,k)===!1)return!1}})}function i(_,s,A){var b=A;return o(_,function(f,x,l){x===0&&l===0&&A===void 0?b=f:b=s(b,f,x,l)}),b}function y(_,s){o(_,function(A,b,f){var x=0;if(!!A.geometry){var l=A.geometry.type;if(!(l==="Point"||l==="MultiPoint")){var L,T=0,k=0,P=0;if(v(A,function(z,I,D,R,B){if(L===void 0||b>T||R>k||B>P){L=z,T=b,k=R,P=B,x=0;return}var F=w.lineString([L,z],A.properties);if(s(F,b,f,B,x)===!1)return!1;x++,L=z})===!1)return!1}}})}function p(_,s,A){var b=A,f=!1;return y(_,function(x,l,L,T,k){f===!1&&A===void 0?b=x:b=s(b,x,l,L,T,k),f=!0}),b}function g(_,s){if(!_)throw new Error("geojson is required");o(_,function(A,b,f){if(A.geometry!==null){var x=A.geometry.type,l=A.geometry.coordinates;switch(x){case"LineString":if(s(A,b,f,0,0)===!1)return!1;break;case"Polygon":for(var L=0;L<l.length;L++)if(s(w.lineString(l[L],A.properties),b,f,L)===!1)return!1;break}}})}function h(_,s,A){var b=A;return g(_,function(f,x,l,L){x===0&&A===void 0?b=f:b=s(b,f,x,l,L)}),b}function m(_,s){if(s=s||{},!w.isObject(s))throw new Error("options is invalid");var A=s.featureIndex||0,b=s.multiFeatureIndex||0,f=s.geometryIndex||0,x=s.segmentIndex||0,l=s.properties,L;switch(_.type){case"FeatureCollection":A<0&&(A=_.features.length+A),l=l||_.features[A].properties,L=_.features[A].geometry;break;case"Feature":l=l||_.properties,L=_.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":L=_;break;default:throw new Error("geojson is invalid")}if(L===null)return null;var T=L.coordinates;switch(L.type){case"Point":case"MultiPoint":return null;case"LineString":return x<0&&(x=T.length+x-1),w.lineString([T[x],T[x+1]],l,s);case"Polygon":return f<0&&(f=T.length+f),x<0&&(x=T[f].length+x-1),w.lineString([T[f][x],T[f][x+1]],l,s);case"MultiLineString":return b<0&&(b=T.length+b),x<0&&(x=T[b].length+x-1),w.lineString([T[b][x],T[b][x+1]],l,s);case"MultiPolygon":return b<0&&(b=T.length+b),f<0&&(f=T[b].length+f),x<0&&(x=T[b][f].length-x-1),w.lineString([T[b][f][x],T[b][f][x+1]],l,s)}throw new Error("geojson is invalid")}function u(_,s){if(s=s||{},!w.isObject(s))throw new Error("options is invalid");var A=s.featureIndex||0,b=s.multiFeatureIndex||0,f=s.geometryIndex||0,x=s.coordIndex||0,l=s.properties,L;switch(_.type){case"FeatureCollection":A<0&&(A=_.features.length+A),l=l||_.features[A].properties,L=_.features[A].geometry;break;case"Feature":l=l||_.properties,L=_.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":L=_;break;default:throw new Error("geojson is invalid")}if(L===null)return null;var T=L.coordinates;switch(L.type){case"Point":return w.point(T,l,s);case"MultiPoint":return b<0&&(b=T.length+b),w.point(T[b],l,s);case"LineString":return x<0&&(x=T.length+x),w.point(T[x],l,s);case"Polygon":return f<0&&(f=T.length+f),x<0&&(x=T[f].length+x),w.point(T[f][x],l,s);case"MultiLineString":return b<0&&(b=T.length+b),x<0&&(x=T[b].length+x),w.point(T[b][x],l,s);case"MultiPolygon":return b<0&&(b=T.length+b),f<0&&(f=T[b].length+f),x<0&&(x=T[b][f].length-x),w.point(T[b][f][x],l,s)}throw new Error("geojson is invalid")}te.coordEach=v,te.coordReduce=S,te.propEach=M,te.propReduce=e,te.featureEach=a,te.featureReduce=n,te.coordAll=r,te.geomEach=t,te.geomReduce=c,te.flattenEach=o,te.flattenReduce=i,te.segmentEach=y,te.segmentReduce=p,te.lineEach=g,te.lineReduce=h,te.findSegment=m,te.findPoint=u},{"@turf/helpers":68}],70:[function(d,ee,te){ee.exports=w;function w(v){var S=0,M=0,e=0,a=0;return v.map(function(n){n=n.slice();var r=n[0],t=r.toUpperCase();if(r!=t)switch(n[0]=t,r){case"a":n[6]+=e,n[7]+=a;break;case"v":n[1]+=a;break;case"h":n[1]+=e;break;default:for(var c=1;c<n.length;)n[c++]+=e,n[c++]+=a}switch(t){case"Z":e=S,a=M;break;case"H":e=n[1];break;case"V":a=n[1];break;case"M":e=S=n[1],a=M=n[2];break;default:e=n[n.length-2],a=n[n.length-1]}return n})}},{}],71:[function(d,ee,te){ee.exports=w;function w(v,S){if(!v||v.length==null)throw Error("Argument should be an array");S==null?S=1:S=Math.floor(S);for(var M=Array(S*2),e=0;e<S;e++){for(var a=-1/0,n=1/0,r=e,t=v.length;r<t;r+=S)v[r]>a&&(a=v[r]),v[r]<n&&(n=v[r]);M[e]=n,M[S+e]=a}return M}},{}],72:[function(d,ee,te){ee.exports=function(w,v,S){if(typeof Array.prototype.findIndex=="function")return w.findIndex(v,S);if(typeof v!="function")throw new TypeError("predicate must be a function");var M=Object(w),e=M.length;if(e===0)return-1;for(var a=0;a<e;a++)if(v.call(S,M[a],a,M))return a;return-1}},{}],73:[function(d,ee,te){var w=d("array-bounds");ee.exports=v;function v(S,M,e){if(!S||S.length==null)throw Error("Argument should be an array");M==null&&(M=1),e==null&&(e=w(S,M));for(var a=0;a<M;a++){var n=e[M+a],r=e[a],t=a,c=S.length;if(n===1/0&&r===-1/0)for(t=a;t<c;t+=M)S[t]=S[t]===n?1:S[t]===r?0:.5;else if(n===1/0)for(t=a;t<c;t+=M)S[t]=S[t]===n?1:0;else if(r===-1/0)for(t=a;t<c;t+=M)S[t]=S[t]===r?0:1;else{var o=n-r;for(t=a;t<c;t+=M)isNaN(S[t])||(S[t]=o===0?.5:(S[t]-r)/o)}}return S}},{"array-bounds":71}],74:[function(d,ee,te){ee.exports=function(v,S){var M=typeof v=="number",e=typeof S=="number";M&&!e?(S=v,v=0):!M&&!e&&(v=0,S=0),v=v|0,S=S|0;var a=S-v;if(a<0)throw new Error("array length must be positive");for(var n=new Array(a),r=0,t=v;r<a;r++,t++)n[r]=t;return n}},{}],75:[function(d,ee,te){(function(w){(function(){var v=d("object-assign");/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */function S(k,P){if(k===P)return 0;for(var z=k.length,I=P.length,D=0,R=Math.min(z,I);D<R;++D)if(k[D]!==P[D]){z=k[D],I=P[D];break}return z<I?-1:I<z?1:0}function M(k){return w.Buffer&&typeof w.Buffer.isBuffer=="function"?w.Buffer.isBuffer(k):!!(k!=null&&k._isBuffer)}var e=d("util/"),a=Object.prototype.hasOwnProperty,n=Array.prototype.slice,r=function(){return function(){}.name==="foo"}();function t(k){return Object.prototype.toString.call(k)}function c(k){return M(k)||typeof w.ArrayBuffer!="function"?!1:typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(k):k?!!(k instanceof DataView||k.buffer&&k.buffer instanceof ArrayBuffer):!1}var o=ee.exports=u,i=/\s*function\s+([^\(\s]*)\s*/;function y(k){if(!!e.isFunction(k)){if(r)return k.name;var P=k.toString(),z=P.match(i);return z&&z[1]}}o.AssertionError=function(P){this.name="AssertionError",this.actual=P.actual,this.expected=P.expected,this.operator=P.operator,P.message?(this.message=P.message,this.generatedMessage=!1):(this.message=h(this),this.generatedMessage=!0);var z=P.stackStartFunction||m;if(Error.captureStackTrace)Error.captureStackTrace(this,z);else{var I=new Error;if(I.stack){var D=I.stack,R=y(z),B=D.indexOf(`
`+R);if(B>=0){var F=D.indexOf(`
`,B+1);D=D.substring(F+1)}this.stack=D}}},e.inherits(o.AssertionError,Error);function p(k,P){return typeof k=="string"?k.length<P?k:k.slice(0,P):k}function g(k){if(r||!e.isFunction(k))return e.inspect(k);var P=y(k),z=P?": "+P:"";return"[Function"+z+"]"}function h(k){return p(g(k.actual),128)+" "+k.operator+" "+p(g(k.expected),128)}function m(k,P,z,I,D){throw new o.AssertionError({message:z,actual:k,expected:P,operator:I,stackStartFunction:D})}o.fail=m;function u(k,P){k||m(k,!0,P,"==",o.ok)}o.ok=u,o.equal=function(P,z,I){P!=z&&m(P,z,I,"==",o.equal)},o.notEqual=function(P,z,I){P==z&&m(P,z,I,"!=",o.notEqual)},o.deepEqual=function(P,z,I){_(P,z,!1)||m(P,z,I,"deepEqual",o.deepEqual)},o.deepStrictEqual=function(P,z,I){_(P,z,!0)||m(P,z,I,"deepStrictEqual",o.deepStrictEqual)};function _(k,P,z,I){if(k===P)return!0;if(M(k)&&M(P))return S(k,P)===0;if(e.isDate(k)&&e.isDate(P))return k.getTime()===P.getTime();if(e.isRegExp(k)&&e.isRegExp(P))return k.source===P.source&&k.global===P.global&&k.multiline===P.multiline&&k.lastIndex===P.lastIndex&&k.ignoreCase===P.ignoreCase;if((k===null||typeof k!="object")&&(P===null||typeof P!="object"))return z?k===P:k==P;if(c(k)&&c(P)&&t(k)===t(P)&&!(k instanceof Float32Array||k instanceof Float64Array))return S(new Uint8Array(k.buffer),new Uint8Array(P.buffer))===0;if(M(k)!==M(P))return!1;I=I||{actual:[],expected:[]};var D=I.actual.indexOf(k);return D!==-1&&D===I.expected.indexOf(P)?!0:(I.actual.push(k),I.expected.push(P),A(k,P,z,I))}function s(k){return Object.prototype.toString.call(k)=="[object Arguments]"}function A(k,P,z,I){if(k==null||P===null||P===void 0)return!1;if(e.isPrimitive(k)||e.isPrimitive(P))return k===P;if(z&&Object.getPrototypeOf(k)!==Object.getPrototypeOf(P))return!1;var D=s(k),R=s(P);if(D&&!R||!D&&R)return!1;if(D)return k=n.call(k),P=n.call(P),_(k,P,z);var B=T(k),F=T(P),H,G;if(B.length!==F.length)return!1;for(B.sort(),F.sort(),G=B.length-1;G>=0;G--)if(B[G]!==F[G])return!1;for(G=B.length-1;G>=0;G--)if(H=B[G],!_(k[H],P[H],z,I))return!1;return!0}o.notDeepEqual=function(P,z,I){_(P,z,!1)&&m(P,z,I,"notDeepEqual",o.notDeepEqual)},o.notDeepStrictEqual=b;function b(k,P,z){_(k,P,!0)&&m(k,P,z,"notDeepStrictEqual",b)}o.strictEqual=function(P,z,I){P!==z&&m(P,z,I,"===",o.strictEqual)},o.notStrictEqual=function(P,z,I){P===z&&m(P,z,I,"!==",o.notStrictEqual)};function f(k,P){if(!k||!P)return!1;if(Object.prototype.toString.call(P)=="[object RegExp]")return P.test(k);try{if(k instanceof P)return!0}catch{}return Error.isPrototypeOf(P)?!1:P.call({},k)===!0}function x(k){var P;try{k()}catch(z){P=z}return P}function l(k,P,z,I){var D;if(typeof P!="function")throw new TypeError('"block" argument must be a function');typeof z=="string"&&(I=z,z=null),D=x(P),I=(z&&z.name?" ("+z.name+").":".")+(I?" "+I:"."),k&&!D&&m(D,z,"Missing expected exception"+I);var R=typeof I=="string",B=!k&&e.isError(D),F=!k&&D&&!z;if((B&&R&&f(D,z)||F)&&m(D,z,"Got unwanted exception"+I),k&&D&&z&&!f(D,z)||!k&&D)throw D}o.throws=function(k,P,z){l(!0,k,P,z)},o.doesNotThrow=function(k,P,z){l(!1,k,P,z)},o.ifError=function(k){if(k)throw k};function L(k,P){k||m(k,!0,P,"==",L)}o.strict=v(L,o,{equal:o.strictEqual,deepEqual:o.deepStrictEqual,notEqual:o.notStrictEqual,notDeepEqual:o.notDeepStrictEqual}),o.strict.strict=o.strict;var T=Object.keys||function(k){var P=[];for(var z in k)a.call(k,z)&&P.push(z);return P}}).call(this)}).call(this,typeof To<"u"?To:typeof self<"u"?self:typeof window<"u"?window:{})},{"object-assign":247,"util/":78}],76:[function(d,ee,te){typeof Object.create=="function"?ee.exports=function(v,S){v.super_=S,v.prototype=Object.create(S.prototype,{constructor:{value:v,enumerable:!1,writable:!0,configurable:!0}})}:ee.exports=function(v,S){v.super_=S;var M=function(){};M.prototype=S.prototype,v.prototype=new M,v.prototype.constructor=v}},{}],77:[function(d,ee,te){ee.exports=function(v){return v&&typeof v=="object"&&typeof v.copy=="function"&&typeof v.fill=="function"&&typeof v.readUInt8=="function"}},{}],78:[function(d,ee,te){(function(w,v){(function(){var S=/%[sdj%]/g;te.format=function(F){if(!A(F)){for(var H=[],G=0;G<arguments.length;G++)H.push(a(arguments[G]));return H.join(" ")}for(var G=1,J=arguments,X=J.length,Y=String(F).replace(S,function(oe){if(oe==="%%")return"%";if(G>=X)return oe;switch(oe){case"%s":return String(J[G++]);case"%d":return Number(J[G++]);case"%j":try{return JSON.stringify(J[G++])}catch{return"[Circular]"}default:return oe}}),Z=J[G];G<X;Z=J[++G])u(Z)||!l(Z)?Y+=" "+Z:Y+=" "+a(Z);return Y},te.deprecate=function(F,H){if(f(v.process))return function(){return te.deprecate(F,H).apply(this,arguments)};if(w.noDeprecation===!0)return F;var G=!1;function J(){if(!G){if(w.throwDeprecation)throw new Error(H);w.traceDeprecation?console.trace(H):console.error(H),G=!0}return F.apply(this,arguments)}return J};var M={},e;te.debuglog=function(F){if(f(e)&&(e=w.env.NODE_DEBUG||""),F=F.toUpperCase(),!M[F])if(new RegExp("\\b"+F+"\\b","i").test(e)){var H=w.pid;M[F]=function(){var G=te.format.apply(te,arguments);console.error("%s %d: %s",F,H,G)}}else M[F]=function(){};return M[F]};function a(F,H){var G={seen:[],stylize:r};return arguments.length>=3&&(G.depth=arguments[2]),arguments.length>=4&&(G.colors=arguments[3]),m(H)?G.showHidden=H:H&&te._extend(G,H),f(G.showHidden)&&(G.showHidden=!1),f(G.depth)&&(G.depth=2),f(G.colors)&&(G.colors=!1),f(G.customInspect)&&(G.customInspect=!0),G.colors&&(G.stylize=n),c(G,F,G.depth)}te.inspect=a,a.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},a.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function n(F,H){var G=a.styles[H];return G?"\x1B["+a.colors[G][0]+"m"+F+"\x1B["+a.colors[G][1]+"m":F}function r(F,H){return F}function t(F){var H={};return F.forEach(function(G,J){H[G]=!0}),H}function c(F,H,G){if(F.customInspect&&H&&k(H.inspect)&&H.inspect!==te.inspect&&!(H.constructor&&H.constructor.prototype===H)){var J=H.inspect(G,F);return A(J)||(J=c(F,J,G)),J}var X=o(F,H);if(X)return X;var Y=Object.keys(H),Z=t(Y);if(F.showHidden&&(Y=Object.getOwnPropertyNames(H)),T(H)&&(Y.indexOf("message")>=0||Y.indexOf("description")>=0))return i(H);if(Y.length===0){if(k(H)){var oe=H.name?": "+H.name:"";return F.stylize("[Function"+oe+"]","special")}if(x(H))return F.stylize(RegExp.prototype.toString.call(H),"regexp");if(L(H))return F.stylize(Date.prototype.toString.call(H),"date");if(T(H))return i(H)}var re="",se=!1,N=["{","}"];if(h(H)&&(se=!0,N=["[","]"]),k(H)){var U=H.name?": "+H.name:"";re=" [Function"+U+"]"}if(x(H)&&(re=" "+RegExp.prototype.toString.call(H)),L(H)&&(re=" "+Date.prototype.toUTCString.call(H)),T(H)&&(re=" "+i(H)),Y.length===0&&(!se||H.length==0))return N[0]+re+N[1];if(G<0)return x(H)?F.stylize(RegExp.prototype.toString.call(H),"regexp"):F.stylize("[Object]","special");F.seen.push(H);var q;return se?q=y(F,H,G,Z,Y):q=Y.map(function($){return p(F,H,G,Z,$,se)}),F.seen.pop(),g(q,re,N)}function o(F,H){if(f(H))return F.stylize("undefined","undefined");if(A(H)){var G="'"+JSON.stringify(H).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return F.stylize(G,"string")}if(s(H))return F.stylize(""+H,"number");if(m(H))return F.stylize(""+H,"boolean");if(u(H))return F.stylize("null","null")}function i(F){return"["+Error.prototype.toString.call(F)+"]"}function y(F,H,G,J,X){for(var Y=[],Z=0,oe=H.length;Z<oe;++Z)B(H,String(Z))?Y.push(p(F,H,G,J,String(Z),!0)):Y.push("");return X.forEach(function(re){re.match(/^\d+$/)||Y.push(p(F,H,G,J,re,!0))}),Y}function p(F,H,G,J,X,Y){var Z,oe,re;if(re=Object.getOwnPropertyDescriptor(H,X)||{value:H[X]},re.get?re.set?oe=F.stylize("[Getter/Setter]","special"):oe=F.stylize("[Getter]","special"):re.set&&(oe=F.stylize("[Setter]","special")),B(J,X)||(Z="["+X+"]"),oe||(F.seen.indexOf(re.value)<0?(u(G)?oe=c(F,re.value,null):oe=c(F,re.value,G-1),oe.indexOf(`
`)>-1&&(Y?oe=oe.split(`
`).map(function(se){return"  "+se}).join(`
`).substr(2):oe=`
`+oe.split(`
`).map(function(se){return"   "+se}).join(`
`))):oe=F.stylize("[Circular]","special")),f(Z)){if(Y&&X.match(/^\d+$/))return oe;Z=JSON.stringify(""+X),Z.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(Z=Z.substr(1,Z.length-2),Z=F.stylize(Z,"name")):(Z=Z.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),Z=F.stylize(Z,"string"))}return Z+": "+oe}function g(F,H,G){var J=F.reduce(function(X,Y){return Y.indexOf(`
`)>=0,X+Y.replace(/\u001b\[\d\d?m/g,"").length+1},0);return J>60?G[0]+(H===""?"":H+`
 `)+" "+F.join(`,
  `)+" "+G[1]:G[0]+H+" "+F.join(", ")+" "+G[1]}function h(F){return Array.isArray(F)}te.isArray=h;function m(F){return typeof F=="boolean"}te.isBoolean=m;function u(F){return F===null}te.isNull=u;function _(F){return F==null}te.isNullOrUndefined=_;function s(F){return typeof F=="number"}te.isNumber=s;function A(F){return typeof F=="string"}te.isString=A;function b(F){return typeof F=="symbol"}te.isSymbol=b;function f(F){return F===void 0}te.isUndefined=f;function x(F){return l(F)&&z(F)==="[object RegExp]"}te.isRegExp=x;function l(F){return typeof F=="object"&&F!==null}te.isObject=l;function L(F){return l(F)&&z(F)==="[object Date]"}te.isDate=L;function T(F){return l(F)&&(z(F)==="[object Error]"||F instanceof Error)}te.isError=T;function k(F){return typeof F=="function"}te.isFunction=k;function P(F){return F===null||typeof F=="boolean"||typeof F=="number"||typeof F=="string"||typeof F=="symbol"||typeof F>"u"}te.isPrimitive=P,te.isBuffer=d("./support/isBuffer");function z(F){return Object.prototype.toString.call(F)}function I(F){return F<10?"0"+F.toString(10):F.toString(10)}var D=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function R(){var F=new Date,H=[I(F.getHours()),I(F.getMinutes()),I(F.getSeconds())].join(":");return[F.getDate(),D[F.getMonth()],H].join(" ")}te.log=function(){console.log("%s - %s",R(),te.format.apply(te,arguments))},te.inherits=d("inherits"),te._extend=function(F,H){if(!H||!l(H))return F;for(var G=Object.keys(H),J=G.length;J--;)F[G[J]]=H[G[J]];return F};function B(F,H){return Object.prototype.hasOwnProperty.call(F,H)}}).call(this)}).call(this,d("_process"),typeof To<"u"?To:typeof self<"u"?self:typeof window<"u"?window:{})},{"./support/isBuffer":77,_process:278,inherits:76}],79:[function(d,ee,te){te.byteLength=r,te.toByteArray=c,te.fromByteArray=y;for(var w=[],v=[],S=typeof Uint8Array<"u"?Uint8Array:Array,M="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e=0,a=M.length;e<a;++e)w[e]=M[e],v[M.charCodeAt(e)]=e;v["-".charCodeAt(0)]=62,v["_".charCodeAt(0)]=63;function n(p){var g=p.length;if(g%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var h=p.indexOf("=");h===-1&&(h=g);var m=h===g?0:4-h%4;return[h,m]}function r(p){var g=n(p),h=g[0],m=g[1];return(h+m)*3/4-m}function t(p,g,h){return(g+h)*3/4-h}function c(p){var g,h=n(p),m=h[0],u=h[1],_=new S(t(p,m,u)),s=0,A=u>0?m-4:m,b;for(b=0;b<A;b+=4)g=v[p.charCodeAt(b)]<<18|v[p.charCodeAt(b+1)]<<12|v[p.charCodeAt(b+2)]<<6|v[p.charCodeAt(b+3)],_[s++]=g>>16&255,_[s++]=g>>8&255,_[s++]=g&255;return u===2&&(g=v[p.charCodeAt(b)]<<2|v[p.charCodeAt(b+1)]>>4,_[s++]=g&255),u===1&&(g=v[p.charCodeAt(b)]<<10|v[p.charCodeAt(b+1)]<<4|v[p.charCodeAt(b+2)]>>2,_[s++]=g>>8&255,_[s++]=g&255),_}function o(p){return w[p>>18&63]+w[p>>12&63]+w[p>>6&63]+w[p&63]}function i(p,g,h){for(var m,u=[],_=g;_<h;_+=3)m=(p[_]<<16&16711680)+(p[_+1]<<8&65280)+(p[_+2]&255),u.push(o(m));return u.join("")}function y(p){for(var g,h=p.length,m=h%3,u=[],_=16383,s=0,A=h-m;s<A;s+=_)u.push(i(p,s,s+_>A?A:s+_));return m===1?(g=p[h-1],u.push(w[g>>2]+w[g<<4&63]+"==")):m===2&&(g=(p[h-2]<<8)+p[h-1],u.push(w[g>>10]+w[g>>4&63]+w[g<<2&63]+"=")),u.join("")}},{}],80:[function(d,ee,te){function w(n,r,t,c,o){for(var i=o+1;c<=o;){var y=c+o>>>1,p=n[y],g=t!==void 0?t(p,r):p-r;g>=0?(i=y,o=y-1):c=y+1}return i}function v(n,r,t,c,o){for(var i=o+1;c<=o;){var y=c+o>>>1,p=n[y],g=t!==void 0?t(p,r):p-r;g>0?(i=y,o=y-1):c=y+1}return i}function S(n,r,t,c,o){for(var i=c-1;c<=o;){var y=c+o>>>1,p=n[y],g=t!==void 0?t(p,r):p-r;g<0?(i=y,c=y+1):o=y-1}return i}function M(n,r,t,c,o){for(var i=c-1;c<=o;){var y=c+o>>>1,p=n[y],g=t!==void 0?t(p,r):p-r;g<=0?(i=y,c=y+1):o=y-1}return i}function e(n,r,t,c,o){for(;c<=o;){var i=c+o>>>1,y=n[i],p=t!==void 0?t(y,r):y-r;if(p===0)return i;p<=0?c=i+1:o=i-1}return-1}function a(n,r,t,c,o,i){return typeof t=="function"?i(n,r,t,c===void 0?0:c|0,o===void 0?n.length-1:o|0):i(n,r,void 0,t===void 0?0:t|0,c===void 0?n.length-1:c|0)}ee.exports={ge:function(n,r,t,c,o){return a(n,r,t,c,o,w)},gt:function(n,r,t,c,o){return a(n,r,t,c,o,v)},lt:function(n,r,t,c,o){return a(n,r,t,c,o,S)},le:function(n,r,t,c,o){return a(n,r,t,c,o,M)},eq:function(n,r,t,c,o){return a(n,r,t,c,o,e)}}},{}],81:[function(d,ee,te){var w=32;te.INT_BITS=w,te.INT_MAX=2147483647,te.INT_MIN=-1<<w-1,te.sign=function(M){return(M>0)-(M<0)},te.abs=function(M){var e=M>>w-1;return(M^e)-e},te.min=function(M,e){return e^(M^e)&-(M<e)},te.max=function(M,e){return M^(M^e)&-(M<e)},te.isPow2=function(M){return!(M&M-1)&&!!M},te.log2=function(M){var e,a;return e=(M>65535)<<4,M>>>=e,a=(M>255)<<3,M>>>=a,e|=a,a=(M>15)<<2,M>>>=a,e|=a,a=(M>3)<<1,M>>>=a,e|=a,e|M>>1},te.log10=function(M){return M>=1e9?9:M>=1e8?8:M>=1e7?7:M>=1e6?6:M>=1e5?5:M>=1e4?4:M>=1e3?3:M>=100?2:M>=10?1:0},te.popCount=function(M){return M=M-(M>>>1&1431655765),M=(M&858993459)+(M>>>2&858993459),(M+(M>>>4)&252645135)*16843009>>>24};function v(M){var e=32;return M&=-M,M&&e--,M&65535&&(e-=16),M&16711935&&(e-=8),M&252645135&&(e-=4),M&858993459&&(e-=2),M&1431655765&&(e-=1),e}te.countTrailingZeros=v,te.nextPow2=function(M){return M+=M===0,--M,M|=M>>>1,M|=M>>>2,M|=M>>>4,M|=M>>>8,M|=M>>>16,M+1},te.prevPow2=function(M){return M|=M>>>1,M|=M>>>2,M|=M>>>4,M|=M>>>8,M|=M>>>16,M-(M>>>1)},te.parity=function(M){return M^=M>>>16,M^=M>>>8,M^=M>>>4,M&=15,27030>>>M&1};var S=new Array(256);(function(M){for(var e=0;e<256;++e){var a=e,n=e,r=7;for(a>>>=1;a;a>>>=1)n<<=1,n|=a&1,--r;M[e]=n<<r&255}})(S),te.reverse=function(M){return S[M&255]<<24|S[M>>>8&255]<<16|S[M>>>16&255]<<8|S[M>>>24&255]},te.interleave2=function(M,e){return M&=65535,M=(M|M<<8)&16711935,M=(M|M<<4)&252645135,M=(M|M<<2)&858993459,M=(M|M<<1)&1431655765,e&=65535,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,M|e<<1},te.deinterleave2=function(M,e){return M=M>>>e&1431655765,M=(M|M>>>1)&858993459,M=(M|M>>>2)&252645135,M=(M|M>>>4)&16711935,M=(M|M>>>16)&65535,M<<16>>16},te.interleave3=function(M,e,a){return M&=1023,M=(M|M<<16)&4278190335,M=(M|M<<8)&251719695,M=(M|M<<4)&3272356035,M=(M|M<<2)&1227133513,e&=1023,e=(e|e<<16)&4278190335,e=(e|e<<8)&251719695,e=(e|e<<4)&3272356035,e=(e|e<<2)&1227133513,M|=e<<1,a&=1023,a=(a|a<<16)&4278190335,a=(a|a<<8)&251719695,a=(a|a<<4)&3272356035,a=(a|a<<2)&1227133513,M|a<<2},te.deinterleave3=function(M,e){return M=M>>>e&1227133513,M=(M|M>>>2)&3272356035,M=(M|M>>>4)&251719695,M=(M|M>>>8)&4278190335,M=(M|M>>>16)&1023,M<<22>>22},te.nextCombination=function(M){var e=M|M-1;return e+1|(~e&-~e)-1>>>v(M)+1}},{}],82:[function(d,ee,te){var w=d("clamp");ee.exports=S;var v=1e20;function S(a,n){n||(n={});var r=n.cutoff==null?.25:n.cutoff,t=n.radius==null?8:n.radius,c=n.channel||0,o,i,y,p,g,h,m,u,_,s,A;if(ArrayBuffer.isView(a)||Array.isArray(a)){if(!n.width||!n.height)throw Error("For raw data width and height should be provided by options");o=n.width,i=n.height,p=a,n.stride?h=n.stride:h=Math.floor(a.length/o/i)}else window.HTMLCanvasElement&&a instanceof window.HTMLCanvasElement?(u=a,m=u.getContext("2d"),o=u.width,i=u.height,_=m.getImageData(0,0,o,i),p=_.data,h=4):window.CanvasRenderingContext2D&&a instanceof window.CanvasRenderingContext2D?(u=a.canvas,m=a,o=u.width,i=u.height,_=m.getImageData(0,0,o,i),p=_.data,h=4):window.ImageData&&a instanceof window.ImageData&&(_=a,o=a.width,i=a.height,p=_.data,h=4);if(y=Math.max(o,i),window.Uint8ClampedArray&&p instanceof window.Uint8ClampedArray||window.Uint8Array&&p instanceof window.Uint8Array)for(g=p,p=Array(o*i),s=0,A=g.length;s<A;s++)p[s]=g[s*h+c]/255;else if(h!==1)throw Error("Raw data can have only 1 value per pixel");var b=Array(o*i),f=Array(o*i),x=Array(y),l=Array(y),L=Array(y+1),T=Array(y);for(s=0,A=o*i;s<A;s++){var k=p[s];b[s]=k===1?0:k===0?v:Math.pow(Math.max(0,.5-k),2),f[s]=k===1?v:k===0?0:Math.pow(Math.max(0,k-.5),2)}M(b,o,i,x,l,T,L),M(f,o,i,x,l,T,L);var P=window.Float32Array?new Float32Array(o*i):new Array(o*i);for(s=0,A=o*i;s<A;s++)P[s]=w(1-((b[s]-f[s])/t+r),0,1);return P}function M(a,n,r,t,c,o,i){for(var y=0;y<n;y++){for(var p=0;p<r;p++)t[p]=a[p*n+y];for(e(t,c,o,i,r),p=0;p<r;p++)a[p*n+y]=c[p]}for(p=0;p<r;p++){for(y=0;y<n;y++)t[y]=a[p*n+y];for(e(t,c,o,i,n),y=0;y<n;y++)a[p*n+y]=Math.sqrt(c[y])}}function e(a,n,r,t,c){r[0]=0,t[0]=-v,t[1]=+v;for(var o=1,i=0;o<c;o++){for(var y=(a[o]+o*o-(a[r[i]]+r[i]*r[i]))/(2*o-2*r[i]);y<=t[i];)i--,y=(a[o]+o*o-(a[r[i]]+r[i]*r[i]))/(2*o-2*r[i]);i++,r[i]=o,t[i]=y,t[i+1]=+v}for(o=0,i=0;o<c;o++){for(;t[i+1]<o;)i++;n[o]=(o-r[i])*(o-r[i])+a[r[i]]}}},{clamp:86}],83:[function(d,ee,te){},{}],84:[function(d,ee,te){var w=typeof Reflect=="object"?Reflect:null,v=w&&typeof w.apply=="function"?w.apply:function(s,A,b){return Function.prototype.apply.call(s,A,b)},S;w&&typeof w.ownKeys=="function"?S=w.ownKeys:Object.getOwnPropertySymbols?S=function(s){return Object.getOwnPropertyNames(s).concat(Object.getOwnPropertySymbols(s))}:S=function(s){return Object.getOwnPropertyNames(s)};function M(_){console&&console.warn&&console.warn(_)}var e=Number.isNaN||function(s){return s!==s};function a(){a.init.call(this)}ee.exports=a,ee.exports.once=u,a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var n=10;function r(_){if(typeof _!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof _)}Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return n},set:function(_){if(typeof _!="number"||_<0||e(_))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+_+".");n=_}}),a.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(s){if(typeof s!="number"||s<0||e(s))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+s+".");return this._maxListeners=s,this};function t(_){return _._maxListeners===void 0?a.defaultMaxListeners:_._maxListeners}a.prototype.getMaxListeners=function(){return t(this)},a.prototype.emit=function(s){for(var A=[],b=1;b<arguments.length;b++)A.push(arguments[b]);var f=s==="error",x=this._events;if(x!==void 0)f=f&&x.error===void 0;else if(!f)return!1;if(f){var l;if(A.length>0&&(l=A[0]),l instanceof Error)throw l;var L=new Error("Unhandled error."+(l?" ("+l.message+")":""));throw L.context=l,L}var T=x[s];if(T===void 0)return!1;if(typeof T=="function")v(T,this,A);else for(var k=T.length,P=g(T,k),b=0;b<k;++b)v(P[b],this,A);return!0};function c(_,s,A,b){var f,x,l;if(r(A),x=_._events,x===void 0?(x=_._events=Object.create(null),_._eventsCount=0):(x.newListener!==void 0&&(_.emit("newListener",s,A.listener?A.listener:A),x=_._events),l=x[s]),l===void 0)l=x[s]=A,++_._eventsCount;else if(typeof l=="function"?l=x[s]=b?[A,l]:[l,A]:b?l.unshift(A):l.push(A),f=t(_),f>0&&l.length>f&&!l.warned){l.warned=!0;var L=new Error("Possible EventEmitter memory leak detected. "+l.length+" "+String(s)+" listeners added. Use emitter.setMaxListeners() to increase limit");L.name="MaxListenersExceededWarning",L.emitter=_,L.type=s,L.count=l.length,M(L)}return _}a.prototype.addListener=function(s,A){return c(this,s,A,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(s,A){return c(this,s,A,!0)};function o(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function i(_,s,A){var b={fired:!1,wrapFn:void 0,target:_,type:s,listener:A},f=o.bind(b);return f.listener=A,b.wrapFn=f,f}a.prototype.once=function(s,A){return r(A),this.on(s,i(this,s,A)),this},a.prototype.prependOnceListener=function(s,A){return r(A),this.prependListener(s,i(this,s,A)),this},a.prototype.removeListener=function(s,A){var b,f,x,l,L;if(r(A),f=this._events,f===void 0)return this;if(b=f[s],b===void 0)return this;if(b===A||b.listener===A)--this._eventsCount===0?this._events=Object.create(null):(delete f[s],f.removeListener&&this.emit("removeListener",s,b.listener||A));else if(typeof b!="function"){for(x=-1,l=b.length-1;l>=0;l--)if(b[l]===A||b[l].listener===A){L=b[l].listener,x=l;break}if(x<0)return this;x===0?b.shift():h(b,x),b.length===1&&(f[s]=b[0]),f.removeListener!==void 0&&this.emit("removeListener",s,L||A)}return this},a.prototype.off=a.prototype.removeListener,a.prototype.removeAllListeners=function(s){var A,b,f;if(b=this._events,b===void 0)return this;if(b.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):b[s]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete b[s]),this;if(arguments.length===0){var x=Object.keys(b),l;for(f=0;f<x.length;++f)l=x[f],l!=="removeListener"&&this.removeAllListeners(l);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(A=b[s],typeof A=="function")this.removeListener(s,A);else if(A!==void 0)for(f=A.length-1;f>=0;f--)this.removeListener(s,A[f]);return this};function y(_,s,A){var b=_._events;if(b===void 0)return[];var f=b[s];return f===void 0?[]:typeof f=="function"?A?[f.listener||f]:[f]:A?m(f):g(f,f.length)}a.prototype.listeners=function(s){return y(this,s,!0)},a.prototype.rawListeners=function(s){return y(this,s,!1)},a.listenerCount=function(_,s){return typeof _.listenerCount=="function"?_.listenerCount(s):p.call(_,s)},a.prototype.listenerCount=p;function p(_){var s=this._events;if(s!==void 0){var A=s[_];if(typeof A=="function")return 1;if(A!==void 0)return A.length}return 0}a.prototype.eventNames=function(){return this._eventsCount>0?S(this._events):[]};function g(_,s){for(var A=new Array(s),b=0;b<s;++b)A[b]=_[b];return A}function h(_,s){for(;s+1<_.length;s++)_[s]=_[s+1];_.pop()}function m(_){for(var s=new Array(_.length),A=0;A<s.length;++A)s[A]=_[A].listener||_[A];return s}function u(_,s){return new Promise(function(A,b){function f(){x!==void 0&&_.removeListener("error",x),A([].slice.call(arguments))}var x;s!=="error"&&(x=function(L){_.removeListener(s,f),b(L)},_.once("error",x)),_.once(s,f)})}},{}],85:[function(d,ee,te){(function(w){(function(){var v=d("base64-js"),S=d("ieee754");te.Buffer=n,te.SlowBuffer=m,te.INSPECT_MAX_BYTES=50;var M=2147483647;te.kMaxLength=M,n.TYPED_ARRAY_SUPPORT=e(),!n.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function e(){try{var ae=new Uint8Array(1);return ae.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},ae.foo()===42}catch{return!1}}Object.defineProperty(n.prototype,"parent",{enumerable:!0,get:function(){if(!!n.isBuffer(this))return this.buffer}}),Object.defineProperty(n.prototype,"offset",{enumerable:!0,get:function(){if(!!n.isBuffer(this))return this.byteOffset}});function a(ae){if(ae>M)throw new RangeError('The value "'+ae+'" is invalid for option "size"');var ie=new Uint8Array(ae);return ie.__proto__=n.prototype,ie}function n(ae,ie,le){if(typeof ae=="number"){if(typeof ie=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return o(ae)}return r(ae,ie,le)}typeof Symbol<"u"&&Symbol.species!=null&&n[Symbol.species]===n&&Object.defineProperty(n,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),n.poolSize=8192;function r(ae,ie,le){if(typeof ae=="string")return i(ae,ie);if(ArrayBuffer.isView(ae))return y(ae);if(ae==null)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof ae);if(K(ae,ArrayBuffer)||ae&&K(ae.buffer,ArrayBuffer))return p(ae,ie,le);if(typeof ae=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var ye=ae.valueOf&&ae.valueOf();if(ye!=null&&ye!==ae)return n.from(ye,ie,le);var ue=g(ae);if(ue)return ue;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof ae[Symbol.toPrimitive]=="function")return n.from(ae[Symbol.toPrimitive]("string"),ie,le);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof ae)}n.from=function(ae,ie,le){return r(ae,ie,le)},n.prototype.__proto__=Uint8Array.prototype,n.__proto__=Uint8Array;function t(ae){if(typeof ae!="number")throw new TypeError('"size" argument must be of type number');if(ae<0)throw new RangeError('The value "'+ae+'" is invalid for option "size"')}function c(ae,ie,le){return t(ae),ae<=0?a(ae):ie!==void 0?typeof le=="string"?a(ae).fill(ie,le):a(ae).fill(ie):a(ae)}n.alloc=function(ae,ie,le){return c(ae,ie,le)};function o(ae){return t(ae),a(ae<0?0:h(ae)|0)}n.allocUnsafe=function(ae){return o(ae)},n.allocUnsafeSlow=function(ae){return o(ae)};function i(ae,ie){if((typeof ie!="string"||ie==="")&&(ie="utf8"),!n.isEncoding(ie))throw new TypeError("Unknown encoding: "+ie);var le=u(ae,ie)|0,ye=a(le),ue=ye.write(ae,ie);return ue!==le&&(ye=ye.slice(0,ue)),ye}function y(ae){for(var ie=ae.length<0?0:h(ae.length)|0,le=a(ie),ye=0;ye<ie;ye+=1)le[ye]=ae[ye]&255;return le}function p(ae,ie,le){if(ie<0||ae.byteLength<ie)throw new RangeError('"offset" is outside of buffer bounds');if(ae.byteLength<ie+(le||0))throw new RangeError('"length" is outside of buffer bounds');var ye;return ie===void 0&&le===void 0?ye=new Uint8Array(ae):le===void 0?ye=new Uint8Array(ae,ie):ye=new Uint8Array(ae,ie,le),ye.__proto__=n.prototype,ye}function g(ae){if(n.isBuffer(ae)){var ie=h(ae.length)|0,le=a(ie);return le.length===0||ae.copy(le,0,0,ie),le}if(ae.length!==void 0)return typeof ae.length!="number"||ne(ae.length)?a(0):y(ae);if(ae.type==="Buffer"&&Array.isArray(ae.data))return y(ae.data)}function h(ae){if(ae>=M)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+M.toString(16)+" bytes");return ae|0}function m(ae){return+ae!=ae&&(ae=0),n.alloc(+ae)}n.isBuffer=function(ie){return ie!=null&&ie._isBuffer===!0&&ie!==n.prototype},n.compare=function(ie,le){if(K(ie,Uint8Array)&&(ie=n.from(ie,ie.offset,ie.byteLength)),K(le,Uint8Array)&&(le=n.from(le,le.offset,le.byteLength)),!n.isBuffer(ie)||!n.isBuffer(le))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(ie===le)return 0;for(var ye=ie.length,ue=le.length,pe=0,ge=Math.min(ye,ue);pe<ge;++pe)if(ie[pe]!==le[pe]){ye=ie[pe],ue=le[pe];break}return ye<ue?-1:ue<ye?1:0},n.isEncoding=function(ie){switch(String(ie).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},n.concat=function(ie,le){if(!Array.isArray(ie))throw new TypeError('"list" argument must be an Array of Buffers');if(ie.length===0)return n.alloc(0);var ye;if(le===void 0)for(le=0,ye=0;ye<ie.length;++ye)le+=ie[ye].length;var ue=n.allocUnsafe(le),pe=0;for(ye=0;ye<ie.length;++ye){var ge=ie[ye];if(K(ge,Uint8Array)&&(ge=n.from(ge)),!n.isBuffer(ge))throw new TypeError('"list" argument must be an Array of Buffers');ge.copy(ue,pe),pe+=ge.length}return ue};function u(ae,ie){if(n.isBuffer(ae))return ae.length;if(ArrayBuffer.isView(ae)||K(ae,ArrayBuffer))return ae.byteLength;if(typeof ae!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof ae);var le=ae.length,ye=arguments.length>2&&arguments[2]===!0;if(!ye&&le===0)return 0;for(var ue=!1;;)switch(ie){case"ascii":case"latin1":case"binary":return le;case"utf8":case"utf-8":return N(ae).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return le*2;case"hex":return le>>>1;case"base64":return $(ae).length;default:if(ue)return ye?-1:N(ae).length;ie=(""+ie).toLowerCase(),ue=!0}}n.byteLength=u;function _(ae,ie,le){var ye=!1;if((ie===void 0||ie<0)&&(ie=0),ie>this.length||((le===void 0||le>this.length)&&(le=this.length),le<=0)||(le>>>=0,ie>>>=0,le<=ie))return"";for(ae||(ae="utf8");;)switch(ae){case"hex":return F(this,ie,le);case"utf8":case"utf-8":return z(this,ie,le);case"ascii":return R(this,ie,le);case"latin1":case"binary":return B(this,ie,le);case"base64":return P(this,ie,le);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return H(this,ie,le);default:if(ye)throw new TypeError("Unknown encoding: "+ae);ae=(ae+"").toLowerCase(),ye=!0}}n.prototype._isBuffer=!0;function s(ae,ie,le){var ye=ae[ie];ae[ie]=ae[le],ae[le]=ye}n.prototype.swap16=function(){var ie=this.length;if(ie%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var le=0;le<ie;le+=2)s(this,le,le+1);return this},n.prototype.swap32=function(){var ie=this.length;if(ie%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var le=0;le<ie;le+=4)s(this,le,le+3),s(this,le+1,le+2);return this},n.prototype.swap64=function(){var ie=this.length;if(ie%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var le=0;le<ie;le+=8)s(this,le,le+7),s(this,le+1,le+6),s(this,le+2,le+5),s(this,le+3,le+4);return this},n.prototype.toString=function(){var ie=this.length;return ie===0?"":arguments.length===0?z(this,0,ie):_.apply(this,arguments)},n.prototype.toLocaleString=n.prototype.toString,n.prototype.equals=function(ie){if(!n.isBuffer(ie))throw new TypeError("Argument must be a Buffer");return this===ie?!0:n.compare(this,ie)===0},n.prototype.inspect=function(){var ie="",le=te.INSPECT_MAX_BYTES;return ie=this.toString("hex",0,le).replace(/(.{2})/g,"$1 ").trim(),this.length>le&&(ie+=" ... "),"<Buffer "+ie+">"},n.prototype.compare=function(ie,le,ye,ue,pe){if(K(ie,Uint8Array)&&(ie=n.from(ie,ie.offset,ie.byteLength)),!n.isBuffer(ie))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof ie);if(le===void 0&&(le=0),ye===void 0&&(ye=ie?ie.length:0),ue===void 0&&(ue=0),pe===void 0&&(pe=this.length),le<0||ye>ie.length||ue<0||pe>this.length)throw new RangeError("out of range index");if(ue>=pe&&le>=ye)return 0;if(ue>=pe)return-1;if(le>=ye)return 1;if(le>>>=0,ye>>>=0,ue>>>=0,pe>>>=0,this===ie)return 0;for(var ge=pe-ue,Te=ye-le,_e=Math.min(ge,Te),ze=this.slice(ue,pe),Oe=ie.slice(le,ye),Ye=0;Ye<_e;++Ye)if(ze[Ye]!==Oe[Ye]){ge=ze[Ye],Te=Oe[Ye];break}return ge<Te?-1:Te<ge?1:0};function A(ae,ie,le,ye,ue){if(ae.length===0)return-1;if(typeof le=="string"?(ye=le,le=0):le>2147483647?le=2147483647:le<-2147483648&&(le=-2147483648),le=+le,ne(le)&&(le=ue?0:ae.length-1),le<0&&(le=ae.length+le),le>=ae.length){if(ue)return-1;le=ae.length-1}else if(le<0)if(ue)le=0;else return-1;if(typeof ie=="string"&&(ie=n.from(ie,ye)),n.isBuffer(ie))return ie.length===0?-1:b(ae,ie,le,ye,ue);if(typeof ie=="number")return ie=ie&255,typeof Uint8Array.prototype.indexOf=="function"?ue?Uint8Array.prototype.indexOf.call(ae,ie,le):Uint8Array.prototype.lastIndexOf.call(ae,ie,le):b(ae,[ie],le,ye,ue);throw new TypeError("val must be string, number or Buffer")}function b(ae,ie,le,ye,ue){var pe=1,ge=ae.length,Te=ie.length;if(ye!==void 0&&(ye=String(ye).toLowerCase(),ye==="ucs2"||ye==="ucs-2"||ye==="utf16le"||ye==="utf-16le")){if(ae.length<2||ie.length<2)return-1;pe=2,ge/=2,Te/=2,le/=2}function _e(Pe,Ge){return pe===1?Pe[Ge]:Pe.readUInt16BE(Ge*pe)}var ze;if(ue){var Oe=-1;for(ze=le;ze<ge;ze++)if(_e(ae,ze)===_e(ie,Oe===-1?0:ze-Oe)){if(Oe===-1&&(Oe=ze),ze-Oe+1===Te)return Oe*pe}else Oe!==-1&&(ze-=ze-Oe),Oe=-1}else for(le+Te>ge&&(le=ge-Te),ze=le;ze>=0;ze--){for(var Ye=!0,be=0;be<Te;be++)if(_e(ae,ze+be)!==_e(ie,be)){Ye=!1;break}if(Ye)return ze}return-1}n.prototype.includes=function(ie,le,ye){return this.indexOf(ie,le,ye)!==-1},n.prototype.indexOf=function(ie,le,ye){return A(this,ie,le,ye,!0)},n.prototype.lastIndexOf=function(ie,le,ye){return A(this,ie,le,ye,!1)};function f(ae,ie,le,ye){le=Number(le)||0;var ue=ae.length-le;ye?(ye=Number(ye),ye>ue&&(ye=ue)):ye=ue;var pe=ie.length;ye>pe/2&&(ye=pe/2);for(var ge=0;ge<ye;++ge){var Te=parseInt(ie.substr(ge*2,2),16);if(ne(Te))return ge;ae[le+ge]=Te}return ge}function x(ae,ie,le,ye){return W(N(ie,ae.length-le),ae,le,ye)}function l(ae,ie,le,ye){return W(U(ie),ae,le,ye)}function L(ae,ie,le,ye){return l(ae,ie,le,ye)}function T(ae,ie,le,ye){return W($(ie),ae,le,ye)}function k(ae,ie,le,ye){return W(q(ie,ae.length-le),ae,le,ye)}n.prototype.write=function(ie,le,ye,ue){if(le===void 0)ue="utf8",ye=this.length,le=0;else if(ye===void 0&&typeof le=="string")ue=le,ye=this.length,le=0;else if(isFinite(le))le=le>>>0,isFinite(ye)?(ye=ye>>>0,ue===void 0&&(ue="utf8")):(ue=ye,ye=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var pe=this.length-le;if((ye===void 0||ye>pe)&&(ye=pe),ie.length>0&&(ye<0||le<0)||le>this.length)throw new RangeError("Attempt to write outside buffer bounds");ue||(ue="utf8");for(var ge=!1;;)switch(ue){case"hex":return f(this,ie,le,ye);case"utf8":case"utf-8":return x(this,ie,le,ye);case"ascii":return l(this,ie,le,ye);case"latin1":case"binary":return L(this,ie,le,ye);case"base64":return T(this,ie,le,ye);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return k(this,ie,le,ye);default:if(ge)throw new TypeError("Unknown encoding: "+ue);ue=(""+ue).toLowerCase(),ge=!0}},n.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function P(ae,ie,le){return ie===0&&le===ae.length?v.fromByteArray(ae):v.fromByteArray(ae.slice(ie,le))}function z(ae,ie,le){le=Math.min(ae.length,le);for(var ye=[],ue=ie;ue<le;){var pe=ae[ue],ge=null,Te=pe>239?4:pe>223?3:pe>191?2:1;if(ue+Te<=le){var _e,ze,Oe,Ye;switch(Te){case 1:pe<128&&(ge=pe);break;case 2:_e=ae[ue+1],(_e&192)===128&&(Ye=(pe&31)<<6|_e&63,Ye>127&&(ge=Ye));break;case 3:_e=ae[ue+1],ze=ae[ue+2],(_e&192)===128&&(ze&192)===128&&(Ye=(pe&15)<<12|(_e&63)<<6|ze&63,Ye>2047&&(Ye<55296||Ye>57343)&&(ge=Ye));break;case 4:_e=ae[ue+1],ze=ae[ue+2],Oe=ae[ue+3],(_e&192)===128&&(ze&192)===128&&(Oe&192)===128&&(Ye=(pe&15)<<18|(_e&63)<<12|(ze&63)<<6|Oe&63,Ye>65535&&Ye<1114112&&(ge=Ye))}}ge===null?(ge=65533,Te=1):ge>65535&&(ge-=65536,ye.push(ge>>>10&1023|55296),ge=56320|ge&1023),ye.push(ge),ue+=Te}return D(ye)}var I=4096;function D(ae){var ie=ae.length;if(ie<=I)return String.fromCharCode.apply(String,ae);for(var le="",ye=0;ye<ie;)le+=String.fromCharCode.apply(String,ae.slice(ye,ye+=I));return le}function R(ae,ie,le){var ye="";le=Math.min(ae.length,le);for(var ue=ie;ue<le;++ue)ye+=String.fromCharCode(ae[ue]&127);return ye}function B(ae,ie,le){var ye="";le=Math.min(ae.length,le);for(var ue=ie;ue<le;++ue)ye+=String.fromCharCode(ae[ue]);return ye}function F(ae,ie,le){var ye=ae.length;(!ie||ie<0)&&(ie=0),(!le||le<0||le>ye)&&(le=ye);for(var ue="",pe=ie;pe<le;++pe)ue+=se(ae[pe]);return ue}function H(ae,ie,le){for(var ye=ae.slice(ie,le),ue="",pe=0;pe<ye.length;pe+=2)ue+=String.fromCharCode(ye[pe]+ye[pe+1]*256);return ue}n.prototype.slice=function(ie,le){var ye=this.length;ie=~~ie,le=le===void 0?ye:~~le,ie<0?(ie+=ye,ie<0&&(ie=0)):ie>ye&&(ie=ye),le<0?(le+=ye,le<0&&(le=0)):le>ye&&(le=ye),le<ie&&(le=ie);var ue=this.subarray(ie,le);return ue.__proto__=n.prototype,ue};function G(ae,ie,le){if(ae%1!==0||ae<0)throw new RangeError("offset is not uint");if(ae+ie>le)throw new RangeError("Trying to access beyond buffer length")}n.prototype.readUIntLE=function(ie,le,ye){ie=ie>>>0,le=le>>>0,ye||G(ie,le,this.length);for(var ue=this[ie],pe=1,ge=0;++ge<le&&(pe*=256);)ue+=this[ie+ge]*pe;return ue},n.prototype.readUIntBE=function(ie,le,ye){ie=ie>>>0,le=le>>>0,ye||G(ie,le,this.length);for(var ue=this[ie+--le],pe=1;le>0&&(pe*=256);)ue+=this[ie+--le]*pe;return ue},n.prototype.readUInt8=function(ie,le){return ie=ie>>>0,le||G(ie,1,this.length),this[ie]},n.prototype.readUInt16LE=function(ie,le){return ie=ie>>>0,le||G(ie,2,this.length),this[ie]|this[ie+1]<<8},n.prototype.readUInt16BE=function(ie,le){return ie=ie>>>0,le||G(ie,2,this.length),this[ie]<<8|this[ie+1]},n.prototype.readUInt32LE=function(ie,le){return ie=ie>>>0,le||G(ie,4,this.length),(this[ie]|this[ie+1]<<8|this[ie+2]<<16)+this[ie+3]*16777216},n.prototype.readUInt32BE=function(ie,le){return ie=ie>>>0,le||G(ie,4,this.length),this[ie]*16777216+(this[ie+1]<<16|this[ie+2]<<8|this[ie+3])},n.prototype.readIntLE=function(ie,le,ye){ie=ie>>>0,le=le>>>0,ye||G(ie,le,this.length);for(var ue=this[ie],pe=1,ge=0;++ge<le&&(pe*=256);)ue+=this[ie+ge]*pe;return pe*=128,ue>=pe&&(ue-=Math.pow(2,8*le)),ue},n.prototype.readIntBE=function(ie,le,ye){ie=ie>>>0,le=le>>>0,ye||G(ie,le,this.length);for(var ue=le,pe=1,ge=this[ie+--ue];ue>0&&(pe*=256);)ge+=this[ie+--ue]*pe;return pe*=128,ge>=pe&&(ge-=Math.pow(2,8*le)),ge},n.prototype.readInt8=function(ie,le){return ie=ie>>>0,le||G(ie,1,this.length),this[ie]&128?(255-this[ie]+1)*-1:this[ie]},n.prototype.readInt16LE=function(ie,le){ie=ie>>>0,le||G(ie,2,this.length);var ye=this[ie]|this[ie+1]<<8;return ye&32768?ye|4294901760:ye},n.prototype.readInt16BE=function(ie,le){ie=ie>>>0,le||G(ie,2,this.length);var ye=this[ie+1]|this[ie]<<8;return ye&32768?ye|4294901760:ye},n.prototype.readInt32LE=function(ie,le){return ie=ie>>>0,le||G(ie,4,this.length),this[ie]|this[ie+1]<<8|this[ie+2]<<16|this[ie+3]<<24},n.prototype.readInt32BE=function(ie,le){return ie=ie>>>0,le||G(ie,4,this.length),this[ie]<<24|this[ie+1]<<16|this[ie+2]<<8|this[ie+3]},n.prototype.readFloatLE=function(ie,le){return ie=ie>>>0,le||G(ie,4,this.length),S.read(this,ie,!0,23,4)},n.prototype.readFloatBE=function(ie,le){return ie=ie>>>0,le||G(ie,4,this.length),S.read(this,ie,!1,23,4)},n.prototype.readDoubleLE=function(ie,le){return ie=ie>>>0,le||G(ie,8,this.length),S.read(this,ie,!0,52,8)},n.prototype.readDoubleBE=function(ie,le){return ie=ie>>>0,le||G(ie,8,this.length),S.read(this,ie,!1,52,8)};function J(ae,ie,le,ye,ue,pe){if(!n.isBuffer(ae))throw new TypeError('"buffer" argument must be a Buffer instance');if(ie>ue||ie<pe)throw new RangeError('"value" argument is out of bounds');if(le+ye>ae.length)throw new RangeError("Index out of range")}n.prototype.writeUIntLE=function(ie,le,ye,ue){if(ie=+ie,le=le>>>0,ye=ye>>>0,!ue){var pe=Math.pow(2,8*ye)-1;J(this,ie,le,ye,pe,0)}var ge=1,Te=0;for(this[le]=ie&255;++Te<ye&&(ge*=256);)this[le+Te]=ie/ge&255;return le+ye},n.prototype.writeUIntBE=function(ie,le,ye,ue){if(ie=+ie,le=le>>>0,ye=ye>>>0,!ue){var pe=Math.pow(2,8*ye)-1;J(this,ie,le,ye,pe,0)}var ge=ye-1,Te=1;for(this[le+ge]=ie&255;--ge>=0&&(Te*=256);)this[le+ge]=ie/Te&255;return le+ye},n.prototype.writeUInt8=function(ie,le,ye){return ie=+ie,le=le>>>0,ye||J(this,ie,le,1,255,0),this[le]=ie&255,le+1},n.prototype.writeUInt16LE=function(ie,le,ye){return ie=+ie,le=le>>>0,ye||J(this,ie,le,2,65535,0),this[le]=ie&255,this[le+1]=ie>>>8,le+2},n.prototype.writeUInt16BE=function(ie,le,ye){return ie=+ie,le=le>>>0,ye||J(this,ie,le,2,65535,0),this[le]=ie>>>8,this[le+1]=ie&255,le+2},n.prototype.writeUInt32LE=function(ie,le,ye){return ie=+ie,le=le>>>0,ye||J(this,ie,le,4,4294967295,0),this[le+3]=ie>>>24,this[le+2]=ie>>>16,this[le+1]=ie>>>8,this[le]=ie&255,le+4},n.prototype.writeUInt32BE=function(ie,le,ye){return ie=+ie,le=le>>>0,ye||J(this,ie,le,4,4294967295,0),this[le]=ie>>>24,this[le+1]=ie>>>16,this[le+2]=ie>>>8,this[le+3]=ie&255,le+4},n.prototype.writeIntLE=function(ie,le,ye,ue){if(ie=+ie,le=le>>>0,!ue){var pe=Math.pow(2,8*ye-1);J(this,ie,le,ye,pe-1,-pe)}var ge=0,Te=1,_e=0;for(this[le]=ie&255;++ge<ye&&(Te*=256);)ie<0&&_e===0&&this[le+ge-1]!==0&&(_e=1),this[le+ge]=(ie/Te>>0)-_e&255;return le+ye},n.prototype.writeIntBE=function(ie,le,ye,ue){if(ie=+ie,le=le>>>0,!ue){var pe=Math.pow(2,8*ye-1);J(this,ie,le,ye,pe-1,-pe)}var ge=ye-1,Te=1,_e=0;for(this[le+ge]=ie&255;--ge>=0&&(Te*=256);)ie<0&&_e===0&&this[le+ge+1]!==0&&(_e=1),this[le+ge]=(ie/Te>>0)-_e&255;return le+ye},n.prototype.writeInt8=function(ie,le,ye){return ie=+ie,le=le>>>0,ye||J(this,ie,le,1,127,-128),ie<0&&(ie=255+ie+1),this[le]=ie&255,le+1},n.prototype.writeInt16LE=function(ie,le,ye){return ie=+ie,le=le>>>0,ye||J(this,ie,le,2,32767,-32768),this[le]=ie&255,this[le+1]=ie>>>8,le+2},n.prototype.writeInt16BE=function(ie,le,ye){return ie=+ie,le=le>>>0,ye||J(this,ie,le,2,32767,-32768),this[le]=ie>>>8,this[le+1]=ie&255,le+2},n.prototype.writeInt32LE=function(ie,le,ye){return ie=+ie,le=le>>>0,ye||J(this,ie,le,4,2147483647,-2147483648),this[le]=ie&255,this[le+1]=ie>>>8,this[le+2]=ie>>>16,this[le+3]=ie>>>24,le+4},n.prototype.writeInt32BE=function(ie,le,ye){return ie=+ie,le=le>>>0,ye||J(this,ie,le,4,2147483647,-2147483648),ie<0&&(ie=4294967295+ie+1),this[le]=ie>>>24,this[le+1]=ie>>>16,this[le+2]=ie>>>8,this[le+3]=ie&255,le+4};function X(ae,ie,le,ye,ue,pe){if(le+ye>ae.length)throw new RangeError("Index out of range");if(le<0)throw new RangeError("Index out of range")}function Y(ae,ie,le,ye,ue){return ie=+ie,le=le>>>0,ue||X(ae,ie,le,4),S.write(ae,ie,le,ye,23,4),le+4}n.prototype.writeFloatLE=function(ie,le,ye){return Y(this,ie,le,!0,ye)},n.prototype.writeFloatBE=function(ie,le,ye){return Y(this,ie,le,!1,ye)};function Z(ae,ie,le,ye,ue){return ie=+ie,le=le>>>0,ue||X(ae,ie,le,8),S.write(ae,ie,le,ye,52,8),le+8}n.prototype.writeDoubleLE=function(ie,le,ye){return Z(this,ie,le,!0,ye)},n.prototype.writeDoubleBE=function(ie,le,ye){return Z(this,ie,le,!1,ye)},n.prototype.copy=function(ie,le,ye,ue){if(!n.isBuffer(ie))throw new TypeError("argument should be a Buffer");if(ye||(ye=0),!ue&&ue!==0&&(ue=this.length),le>=ie.length&&(le=ie.length),le||(le=0),ue>0&&ue<ye&&(ue=ye),ue===ye||ie.length===0||this.length===0)return 0;if(le<0)throw new RangeError("targetStart out of bounds");if(ye<0||ye>=this.length)throw new RangeError("Index out of range");if(ue<0)throw new RangeError("sourceEnd out of bounds");ue>this.length&&(ue=this.length),ie.length-le<ue-ye&&(ue=ie.length-le+ye);var pe=ue-ye;if(this===ie&&typeof Uint8Array.prototype.copyWithin=="function")this.copyWithin(le,ye,ue);else if(this===ie&&ye<le&&le<ue)for(var ge=pe-1;ge>=0;--ge)ie[ge+le]=this[ge+ye];else Uint8Array.prototype.set.call(ie,this.subarray(ye,ue),le);return pe},n.prototype.fill=function(ie,le,ye,ue){if(typeof ie=="string"){if(typeof le=="string"?(ue=le,le=0,ye=this.length):typeof ye=="string"&&(ue=ye,ye=this.length),ue!==void 0&&typeof ue!="string")throw new TypeError("encoding must be a string");if(typeof ue=="string"&&!n.isEncoding(ue))throw new TypeError("Unknown encoding: "+ue);if(ie.length===1){var pe=ie.charCodeAt(0);(ue==="utf8"&&pe<128||ue==="latin1")&&(ie=pe)}}else typeof ie=="number"&&(ie=ie&255);if(le<0||this.length<le||this.length<ye)throw new RangeError("Out of range index");if(ye<=le)return this;le=le>>>0,ye=ye===void 0?this.length:ye>>>0,ie||(ie=0);var ge;if(typeof ie=="number")for(ge=le;ge<ye;++ge)this[ge]=ie;else{var Te=n.isBuffer(ie)?ie:n.from(ie,ue),_e=Te.length;if(_e===0)throw new TypeError('The value "'+ie+'" is invalid for argument "value"');for(ge=0;ge<ye-le;++ge)this[ge+le]=Te[ge%_e]}return this};var oe=/[^+/0-9A-Za-z-_]/g;function re(ae){if(ae=ae.split("=")[0],ae=ae.trim().replace(oe,""),ae.length<2)return"";for(;ae.length%4!==0;)ae=ae+"=";return ae}function se(ae){return ae<16?"0"+ae.toString(16):ae.toString(16)}function N(ae,ie){ie=ie||1/0;for(var le,ye=ae.length,ue=null,pe=[],ge=0;ge<ye;++ge){if(le=ae.charCodeAt(ge),le>55295&&le<57344){if(!ue){if(le>56319){(ie-=3)>-1&&pe.push(239,191,189);continue}else if(ge+1===ye){(ie-=3)>-1&&pe.push(239,191,189);continue}ue=le;continue}if(le<56320){(ie-=3)>-1&&pe.push(239,191,189),ue=le;continue}le=(ue-55296<<10|le-56320)+65536}else ue&&(ie-=3)>-1&&pe.push(239,191,189);if(ue=null,le<128){if((ie-=1)<0)break;pe.push(le)}else if(le<2048){if((ie-=2)<0)break;pe.push(le>>6|192,le&63|128)}else if(le<65536){if((ie-=3)<0)break;pe.push(le>>12|224,le>>6&63|128,le&63|128)}else if(le<1114112){if((ie-=4)<0)break;pe.push(le>>18|240,le>>12&63|128,le>>6&63|128,le&63|128)}else throw new Error("Invalid code point")}return pe}function U(ae){for(var ie=[],le=0;le<ae.length;++le)ie.push(ae.charCodeAt(le)&255);return ie}function q(ae,ie){for(var le,ye,ue,pe=[],ge=0;ge<ae.length&&!((ie-=2)<0);++ge)le=ae.charCodeAt(ge),ye=le>>8,ue=le%256,pe.push(ue),pe.push(ye);return pe}function $(ae){return v.toByteArray(re(ae))}function W(ae,ie,le,ye){for(var ue=0;ue<ye&&!(ue+le>=ie.length||ue>=ae.length);++ue)ie[ue+le]=ae[ue];return ue}function K(ae,ie){return ae instanceof ie||ae!=null&&ae.constructor!=null&&ae.constructor.name!=null&&ae.constructor.name===ie.name}function ne(ae){return ae!==ae}}).call(this)}).call(this,d("buffer").Buffer)},{"base64-js":79,buffer:85,ieee754:230}],86:[function(d,ee,te){ee.exports=w;function w(v,S,M){return S<M?v<S?S:v>M?M:v:v<M?M:v>S?S:v}},{}],87:[function(d,ee,te){var w=d("clamp");ee.exports=v,ee.exports.to=v,ee.exports.from=S;function v(M,e){e==null&&(e=!0);var a=M[0],n=M[1],r=M[2],t=M[3];t==null&&(t=e?1:255),e&&(a*=255,n*=255,r*=255,t*=255),a=w(a,0,255)&255,n=w(n,0,255)&255,r=w(r,0,255)&255,t=w(t,0,255)&255;var c=a*16777216+(n<<16)+(r<<8)+t;return c}function S(M,e){M=+M;var a=M>>>24,n=(M&16711680)>>>16,r=(M&65280)>>>8,t=M&255;return e===!1?[a,n,r,t]:[a/255,n/255,r/255,t/255]}},{clamp:86}],88:[function(d,ee,te){ee.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},{}],89:[function(d,ee,te){var w=d("color-rgba"),v=d("clamp"),S=d("dtype");ee.exports=function(a,n){(n==="float"||!n)&&(n="array"),n==="uint"&&(n="uint8"),n==="uint_clamped"&&(n="uint8_clamped");var r=S(n),t=new r(4),c=n!=="uint8"&&n!=="uint8_clamped";return(!a.length||typeof a=="string")&&(a=w(a),a[0]/=255,a[1]/=255,a[2]/=255),M(a)?(t[0]=a[0],t[1]=a[1],t[2]=a[2],t[3]=a[3]!=null?a[3]:255,c&&(t[0]/=255,t[1]/=255,t[2]/=255,t[3]/=255),t):(c?(t[0]=a[0],t[1]=a[1],t[2]=a[2],t[3]=a[3]!=null?a[3]:1):(t[0]=v(Math.floor(a[0]*255),0,255),t[1]=v(Math.floor(a[1]*255),0,255),t[2]=v(Math.floor(a[2]*255),0,255),t[3]=a[3]==null?255:v(Math.floor(a[3]*255),0,255)),t)};function M(e){return!!(e instanceof Uint8Array||e instanceof Uint8ClampedArray||Array.isArray(e)&&(e[0]>1||e[0]===0)&&(e[1]>1||e[1]===0)&&(e[2]>1||e[2]===0)&&(!e[3]||e[3]>1))}},{clamp:86,"color-rgba":91,dtype:127}],90:[function(d,ee,te){(function(w){(function(){var v=d("color-name"),S=d("is-plain-obj"),M=d("defined");ee.exports=a;var e={red:0,orange:60,yellow:120,green:180,blue:240,purple:300};function a(n){var r,t=[],c=1,o;if(typeof n=="string")if(v[n])t=v[n].slice(),o="rgb";else if(n==="transparent")c=0,o="rgb",t=[0,0,0];else if(/^#[A-Fa-f0-9]+$/.test(n)){var i=n.slice(1),y=i.length,p=y<=4;c=1,p?(t=[parseInt(i[0]+i[0],16),parseInt(i[1]+i[1],16),parseInt(i[2]+i[2],16)],y===4&&(c=parseInt(i[3]+i[3],16)/255)):(t=[parseInt(i[0]+i[1],16),parseInt(i[2]+i[3],16),parseInt(i[4]+i[5],16)],y===8&&(c=parseInt(i[6]+i[7],16)/255)),t[0]||(t[0]=0),t[1]||(t[1]=0),t[2]||(t[2]=0),o="rgb"}else if(r=/^((?:rgb|hs[lvb]|hwb|cmyk?|xy[zy]|gray|lab|lchu?v?|[ly]uv|lms)a?)\s*\(([^\)]*)\)/.exec(n)){var g=r[1],h=g==="rgb",i=g.replace(/a$/,"");o=i;var y=i==="cmyk"?4:i==="gray"?1:3;t=r[2].trim().split(/\s*,\s*/).map(function(s,A){if(/%$/.test(s))return A===y?parseFloat(s)/100:i==="rgb"?parseFloat(s)*255/100:parseFloat(s);if(i[A]==="h"){if(/deg$/.test(s))return parseFloat(s);if(e[s]!==void 0)return e[s]}return parseFloat(s)}),g===i&&t.push(1),c=h||t[y]===void 0?1:t[y],t=t.slice(0,y)}else n.length>10&&/[0-9](?:\s|\/)/.test(n)&&(t=n.match(/([0-9]+)/g).map(function(u){return parseFloat(u)}),o=n.match(/([a-z])/ig).join("").toLowerCase());else if(!isNaN(n))o="rgb",t=[n>>>16,(n&65280)>>>8,n&255];else if(S(n)){var m=M(n.r,n.red,n.R,null);m!==null?(o="rgb",t=[m,M(n.g,n.green,n.G),M(n.b,n.blue,n.B)]):(o="hsl",t=[M(n.h,n.hue,n.H),M(n.s,n.saturation,n.S),M(n.l,n.lightness,n.L,n.b,n.brightness)]),c=M(n.a,n.alpha,n.opacity,1),n.opacity!=null&&(c/=100)}else(Array.isArray(n)||w.ArrayBuffer&&ArrayBuffer.isView&&ArrayBuffer.isView(n))&&(t=[n[0],n[1],n[2]],o="rgb",c=n.length===4?n[3]:1);return{space:o,values:t,alpha:c}}}).call(this)}).call(this,typeof To<"u"?To:typeof self<"u"?self:typeof window<"u"?window:{})},{"color-name":88,defined:124,"is-plain-obj":236}],91:[function(d,ee,te){var w=d("color-parse"),v=d("color-space/hsl"),S=d("clamp");ee.exports=function(e){var a,n=w(e);return n.space?(a=Array(3),a[0]=S(n.values[0],0,255),a[1]=S(n.values[1],0,255),a[2]=S(n.values[2],0,255),n.space[0]==="h"&&(a=v.rgb(a)),a.push(S(n.alpha,0,1)),a):[]}},{clamp:86,"color-parse":90,"color-space/hsl":92}],92:[function(d,ee,te){var w=d("./rgb");ee.exports={name:"hsl",min:[0,0,0],max:[360,100,100],channel:["hue","saturation","lightness"],alias:["HSL"],rgb:function(v){var S=v[0]/360,M=v[1]/100,e=v[2]/100,a,n,r,t,c;if(M===0)return c=e*255,[c,c,c];e<.5?n=e*(1+M):n=e+M-e*M,a=2*e-n,t=[0,0,0];for(var o=0;o<3;o++)r=S+1/3*-(o-1),r<0?r++:r>1&&r--,6*r<1?c=a+(n-a)*6*r:2*r<1?c=n:3*r<2?c=a+(n-a)*(2/3-r)*6:c=a,t[o]=c*255;return t}},w.hsl=function(v){var S=v[0]/255,M=v[1]/255,e=v[2]/255,a=Math.min(S,M,e),n=Math.max(S,M,e),r=n-a,t,c,o;return n===a?t=0:S===n?t=(M-e)/r:M===n?t=2+(e-S)/r:e===n&&(t=4+(S-M)/r),t=Math.min(t*60,360),t<0&&(t+=360),o=(a+n)/2,n===a?c=0:o<=.5?c=r/(n+a):c=r/(2-n-a),[t,c*100,o*100]}},{"./rgb":93}],93:[function(d,ee,te){ee.exports={name:"rgb",min:[0,0,0],max:[255,255,255],channel:["red","green","blue"],alias:["RGB"]}},{}],94:[function(d,ee,te){ee.exports={AFG:"afghan",ALA:"\\b\\wland",ALB:"albania",DZA:"algeria",ASM:"^(?=.*americ).*samoa",AND:"andorra",AGO:"angola",AIA:"anguill?a",ATA:"antarctica",ATG:"antigua",ARG:"argentin",ARM:"armenia",ABW:"^(?!.*bonaire).*\\baruba",AUS:"australia",AUT:"^(?!.*hungary).*austria|\\baustri.*\\bemp",AZE:"azerbaijan",BHS:"bahamas",BHR:"bahrain",BGD:"bangladesh|^(?=.*east).*paki?stan",BRB:"barbados",BLR:"belarus|byelo",BEL:"^(?!.*luxem).*belgium",BLZ:"belize|^(?=.*british).*honduras",BEN:"benin|dahome",BMU:"bermuda",BTN:"bhutan",BOL:"bolivia",BES:"^(?=.*bonaire).*eustatius|^(?=.*carib).*netherlands|\\bbes.?islands",BIH:"herzegovina|bosnia",BWA:"botswana|bechuana",BVT:"bouvet",BRA:"brazil",IOT:"british.?indian.?ocean",BRN:"brunei",BGR:"bulgaria",BFA:"burkina|\\bfaso|upper.?volta",BDI:"burundi",CPV:"verde",KHM:"cambodia|kampuchea|khmer",CMR:"cameroon",CAN:"canada",CYM:"cayman",CAF:"\\bcentral.african.republic",TCD:"\\bchad",CHL:"\\bchile",CHN:"^(?!.*\\bmac)(?!.*\\bhong)(?!.*\\btai)(?!.*\\brep).*china|^(?=.*peo)(?=.*rep).*china",CXR:"christmas",CCK:"\\bcocos|keeling",COL:"colombia",COM:"comoro",COG:"^(?!.*\\bdem)(?!.*\\bd[\\.]?r)(?!.*kinshasa)(?!.*zaire)(?!.*belg)(?!.*l.opoldville)(?!.*free).*\\bcongo",COK:"\\bcook",CRI:"costa.?rica",CIV:"ivoire|ivory",HRV:"croatia",CUB:"\\bcuba",CUW:"^(?!.*bonaire).*\\bcura(c|\xE7)ao",CYP:"cyprus",CSK:"czechoslovakia",CZE:"^(?=.*rep).*czech|czechia|bohemia",COD:"\\bdem.*congo|congo.*\\bdem|congo.*\\bd[\\.]?r|\\bd[\\.]?r.*congo|belgian.?congo|congo.?free.?state|kinshasa|zaire|l.opoldville|drc|droc|rdc",DNK:"denmark",DJI:"djibouti",DMA:"dominica(?!n)",DOM:"dominican.rep",ECU:"ecuador",EGY:"egypt",SLV:"el.?salvador",GNQ:"guine.*eq|eq.*guine|^(?=.*span).*guinea",ERI:"eritrea",EST:"estonia",ETH:"ethiopia|abyssinia",FLK:"falkland|malvinas",FRO:"faroe|faeroe",FJI:"fiji",FIN:"finland",FRA:"^(?!.*\\bdep)(?!.*martinique).*france|french.?republic|\\bgaul",GUF:"^(?=.*french).*guiana",PYF:"french.?polynesia|tahiti",ATF:"french.?southern",GAB:"gabon",GMB:"gambia",GEO:"^(?!.*south).*georgia",DDR:"german.?democratic.?republic|democratic.?republic.*germany|east.germany",DEU:"^(?!.*east).*germany|^(?=.*\\bfed.*\\brep).*german",GHA:"ghana|gold.?coast",GIB:"gibraltar",GRC:"greece|hellenic|hellas",GRL:"greenland",GRD:"grenada",GLP:"guadeloupe",GUM:"\\bguam",GTM:"guatemala",GGY:"guernsey",GIN:"^(?!.*eq)(?!.*span)(?!.*bissau)(?!.*portu)(?!.*new).*guinea",GNB:"bissau|^(?=.*portu).*guinea",GUY:"guyana|british.?guiana",HTI:"haiti",HMD:"heard.*mcdonald",VAT:"holy.?see|vatican|papal.?st",HND:"^(?!.*brit).*honduras",HKG:"hong.?kong",HUN:"^(?!.*austr).*hungary",ISL:"iceland",IND:"india(?!.*ocea)",IDN:"indonesia",IRN:"\\biran|persia",IRQ:"\\biraq|mesopotamia",IRL:"(^ireland)|(^republic.*ireland)",IMN:"^(?=.*isle).*\\bman",ISR:"israel",ITA:"italy",JAM:"jamaica",JPN:"japan",JEY:"jersey",JOR:"jordan",KAZ:"kazak",KEN:"kenya|british.?east.?africa|east.?africa.?prot",KIR:"kiribati",PRK:"^(?=.*democrat|people|north|d.*p.*.r).*\\bkorea|dprk|korea.*(d.*p.*r)",KWT:"kuwait",KGZ:"kyrgyz|kirghiz",LAO:"\\blaos?\\b",LVA:"latvia",LBN:"lebanon",LSO:"lesotho|basuto",LBR:"liberia",LBY:"libya",LIE:"liechtenstein",LTU:"lithuania",LUX:"^(?!.*belg).*luxem",MAC:"maca(o|u)",MDG:"madagascar|malagasy",MWI:"malawi|nyasa",MYS:"malaysia",MDV:"maldive",MLI:"\\bmali\\b",MLT:"\\bmalta",MHL:"marshall",MTQ:"martinique",MRT:"mauritania",MUS:"mauritius",MYT:"\\bmayotte",MEX:"\\bmexic",FSM:"fed.*micronesia|micronesia.*fed",MCO:"monaco",MNG:"mongolia",MNE:"^(?!.*serbia).*montenegro",MSR:"montserrat",MAR:"morocco|\\bmaroc",MOZ:"mozambique",MMR:"myanmar|burma",NAM:"namibia",NRU:"nauru",NPL:"nepal",NLD:"^(?!.*\\bant)(?!.*\\bcarib).*netherlands",ANT:"^(?=.*\\bant).*(nether|dutch)",NCL:"new.?caledonia",NZL:"new.?zealand",NIC:"nicaragua",NER:"\\bniger(?!ia)",NGA:"nigeria",NIU:"niue",NFK:"norfolk",MNP:"mariana",NOR:"norway",OMN:"\\boman|trucial",PAK:"^(?!.*east).*paki?stan",PLW:"palau",PSE:"palestin|\\bgaza|west.?bank",PAN:"panama",PNG:"papua|new.?guinea",PRY:"paraguay",PER:"peru",PHL:"philippines",PCN:"pitcairn",POL:"poland",PRT:"portugal",PRI:"puerto.?rico",QAT:"qatar",KOR:"^(?!.*d.*p.*r)(?!.*democrat)(?!.*people)(?!.*north).*\\bkorea(?!.*d.*p.*r)",MDA:"moldov|b(a|e)ssarabia",REU:"r(e|\xE9)union",ROU:"r(o|u|ou)mania",RUS:"\\brussia|soviet.?union|u\\.?s\\.?s\\.?r|socialist.?republics",RWA:"rwanda",BLM:"barth(e|\xE9)lemy",SHN:"helena",KNA:"kitts|\\bnevis",LCA:"\\blucia",MAF:"^(?=.*collectivity).*martin|^(?=.*france).*martin(?!ique)|^(?=.*french).*martin(?!ique)",SPM:"miquelon",VCT:"vincent",WSM:"^(?!.*amer).*samoa",SMR:"san.?marino",STP:"\\bs(a|\xE3)o.?tom(e|\xE9)",SAU:"\\bsa\\w*.?arabia",SEN:"senegal",SRB:"^(?!.*monte).*serbia",SYC:"seychell",SLE:"sierra",SGP:"singapore",SXM:"^(?!.*martin)(?!.*saba).*maarten",SVK:"^(?!.*cze).*slovak",SVN:"slovenia",SLB:"solomon",SOM:"somali",ZAF:"south.africa|s\\\\..?africa",SGS:"south.?georgia|sandwich",SSD:"\\bs\\w*.?sudan",ESP:"spain",LKA:"sri.?lanka|ceylon",SDN:"^(?!.*\\bs(?!u)).*sudan",SUR:"surinam|dutch.?guiana",SJM:"svalbard",SWZ:"swaziland",SWE:"sweden",CHE:"switz|swiss",SYR:"syria",TWN:"taiwan|taipei|formosa|^(?!.*peo)(?=.*rep).*china",TJK:"tajik",THA:"thailand|\\bsiam",MKD:"macedonia|fyrom",TLS:"^(?=.*leste).*timor|^(?=.*east).*timor",TGO:"togo",TKL:"tokelau",TON:"tonga",TTO:"trinidad|tobago",TUN:"tunisia",TUR:"turkey",TKM:"turkmen",TCA:"turks",TUV:"tuvalu",UGA:"uganda",UKR:"ukrain",ARE:"emirates|^u\\.?a\\.?e\\.?$|united.?arab.?em",GBR:"united.?kingdom|britain|^u\\.?k\\.?$",TZA:"tanzania",USA:"united.?states\\b(?!.*islands)|\\bu\\.?s\\.?a\\.?\\b|^\\s*u\\.?s\\.?\\b(?!.*islands)",UMI:"minor.?outlying.?is",URY:"uruguay",UZB:"uzbek",VUT:"vanuatu|new.?hebrides",VEN:"venezuela",VNM:"^(?!.*republic).*viet.?nam|^(?=.*socialist).*viet.?nam",VGB:"^(?=.*\\bu\\.?\\s?k).*virgin|^(?=.*brit).*virgin|^(?=.*kingdom).*virgin",VIR:"^(?=.*\\bu\\.?\\s?s).*virgin|^(?=.*states).*virgin",WLF:"futuna|wallis",ESH:"western.sahara",YEM:"^(?!.*arab)(?!.*north)(?!.*sana)(?!.*peo)(?!.*dem)(?!.*south)(?!.*aden)(?!.*\\bp\\.?d\\.?r).*yemen",YMD:"^(?=.*peo).*yemen|^(?!.*rep)(?=.*dem).*yemen|^(?=.*south).*yemen|^(?=.*aden).*yemen|^(?=.*\\bp\\.?d\\.?r).*yemen",YUG:"yugoslavia",ZMB:"zambia|northern.?rhodesia",EAZ:"zanzibar",ZWE:"zimbabwe|^(?!.*northern).*rhodesia"}},{}],95:[function(d,ee,te){ee.exports=["xx-small","x-small","small","medium","large","x-large","xx-large","larger","smaller"]},{}],96:[function(d,ee,te){ee.exports=["normal","condensed","semi-condensed","extra-condensed","ultra-condensed","expanded","semi-expanded","extra-expanded","ultra-expanded"]},{}],97:[function(d,ee,te){ee.exports=["normal","italic","oblique"]},{}],98:[function(d,ee,te){ee.exports=["normal","bold","bolder","lighter","100","200","300","400","500","600","700","800","900"]},{}],99:[function(d,ee,te){ee.exports={parse:d("./parse"),stringify:d("./stringify")}},{"./parse":101,"./stringify":102}],100:[function(d,ee,te){var w=d("css-font-size-keywords");ee.exports={isSize:function(S){return/^[\d\.]/.test(S)||S.indexOf("/")!==-1||w.indexOf(S)!==-1}}},{"css-font-size-keywords":95}],101:[function(d,ee,te){var w=d("unquote"),v=d("css-global-keywords"),S=d("css-system-font-keywords"),M=d("css-font-weight-keywords"),e=d("css-font-style-keywords"),a=d("css-font-stretch-keywords"),n=d("string-split-by"),r=d("./lib/util").isSize;ee.exports=c;var t=c.cache={};function c(i){if(typeof i!="string")throw new Error("Font argument must be a string.");if(t[i])return t[i];if(i==="")throw new Error("Cannot parse an empty string.");if(S.indexOf(i)!==-1)return t[i]={system:i};for(var y={style:"normal",variant:"normal",weight:"normal",stretch:"normal",lineHeight:"normal",size:"1rem",family:["serif"]},p=n(i,/\s+/),g;g=p.shift();){if(v.indexOf(g)!==-1)return["style","variant","weight","stretch"].forEach(function(m){y[m]=g}),t[i]=y;if(e.indexOf(g)!==-1){y.style=g;continue}if(g==="normal"||g==="small-caps"){y.variant=g;continue}if(a.indexOf(g)!==-1){y.stretch=g;continue}if(M.indexOf(g)!==-1){y.weight=g;continue}if(r(g)){var h=n(g,"/");if(y.size=h[0],h[1]!=null?y.lineHeight=o(h[1]):p[0]==="/"&&(p.shift(),y.lineHeight=o(p.shift())),!p.length)throw new Error("Missing required font-family.");return y.family=n(p.join(" "),/\s*,\s*/).map(w),t[i]=y}throw new Error("Unknown or unsupported font token: "+g)}throw new Error("Missing required font-size.")}function o(i){var y=parseFloat(i);return y.toString()===i?y:i}},{"./lib/util":100,"css-font-stretch-keywords":96,"css-font-style-keywords":97,"css-font-weight-keywords":98,"css-global-keywords":103,"css-system-font-keywords":104,"string-split-by":306,unquote:329}],102:[function(d,ee,te){var w=d("pick-by-alias"),v=d("./lib/util").isSize,S=i(d("css-global-keywords")),M=i(d("css-system-font-keywords")),e=i(d("css-font-weight-keywords")),a=i(d("css-font-style-keywords")),n=i(d("css-font-stretch-keywords")),r={normal:1,"small-caps":1},t={serif:1,"sans-serif":1,monospace:1,cursive:1,fantasy:1,"system-ui":1},c={style:"normal",variant:"normal",weight:"normal",stretch:"normal",size:"1rem",lineHeight:"normal",family:"serif"};ee.exports=function(p){if(p=w(p,{style:"style fontstyle fontStyle font-style slope distinction",variant:"variant font-variant fontVariant fontvariant var capitalization",weight:"weight w font-weight fontWeight fontweight",stretch:"stretch font-stretch fontStretch fontstretch width",size:"size s font-size fontSize fontsize height em emSize",lineHeight:"lh line-height lineHeight lineheight leading",family:"font family fontFamily font-family fontfamily type typeface face",system:"system reserved default global"}),p.system)return p.system&&o(p.system,M),p.system;if(o(p.style,a),o(p.variant,r),o(p.weight,e),o(p.stretch,n),p.size==null&&(p.size=c.size),typeof p.size=="number"&&(p.size+="px"),!v)throw Error("Bad size value `"+p.size+"`");p.family||(p.family=c.family),Array.isArray(p.family)&&(p.family.length||(p.family=[c.family]),p.family=p.family.map(function(h){return t[h]?h:'"'+h+'"'}).join(", "));var g=[];return g.push(p.style),p.variant!==p.style&&g.push(p.variant),p.weight!==p.variant&&p.weight!==p.style&&g.push(p.weight),p.stretch!==p.weight&&p.stretch!==p.variant&&p.stretch!==p.style&&g.push(p.stretch),g.push(p.size+(p.lineHeight==null||p.lineHeight==="normal"||p.lineHeight+""=="1"?"":"/"+p.lineHeight)),g.push(p.family),g.filter(Boolean).join(" ")};function o(y,p){if(y&&!p[y]&&!S[y])throw Error("Unknown keyword `"+y+"`");return y}function i(y){for(var p={},g=0;g<y.length;g++)p[y[g]]=1;return p}},{"./lib/util":100,"css-font-stretch-keywords":96,"css-font-style-keywords":97,"css-font-weight-keywords":98,"css-global-keywords":103,"css-system-font-keywords":104,"pick-by-alias":253}],103:[function(d,ee,te){ee.exports=["inherit","initial","unset"]},{}],104:[function(d,ee,te){ee.exports=["caption","icon","menu","message-box","small-caption","status-bar"]},{}],105:[function(d,ee,te){var w=d("type/value/is"),v=d("type/value/ensure"),S=d("type/plain-function/ensure"),M=d("es5-ext/object/copy"),e=d("es5-ext/object/normalize-options"),a=d("es5-ext/object/map"),n=Function.prototype.bind,r=Object.defineProperty,t=Object.prototype.hasOwnProperty,c;c=function(o,i,y){var p=v(i)&&S(i.value),g;return g=M(i),delete g.writable,delete g.value,g.get=function(){return!y.overwriteDefinition&&t.call(this,o)?p:(i.value=n.call(p,y.resolveContext?y.resolveContext(this):this),r(this,o,i),this[o])},g},ee.exports=function(o){var i=e(arguments[1]);return w(i.resolveContext)&&S(i.resolveContext),a(o,function(y,p){return c(p,y,i)})}},{"es5-ext/object/copy":147,"es5-ext/object/map":155,"es5-ext/object/normalize-options":156,"type/plain-function/ensure":322,"type/value/ensure":326,"type/value/is":327}],106:[function(d,ee,te){var w=d("type/value/is"),v=d("type/plain-function/is"),S=d("es5-ext/object/assign"),M=d("es5-ext/object/normalize-options"),e=d("es5-ext/string/#/contains"),a=ee.exports=function(n,r){var t,c,o,i,y;return arguments.length<2||typeof n!="string"?(i=r,r=n,n=null):i=arguments[2],w(n)?(t=e.call(n,"c"),c=e.call(n,"e"),o=e.call(n,"w")):(t=o=!0,c=!1),y={value:r,configurable:t,enumerable:c,writable:o},i?S(M(i),y):y};a.gs=function(n,r,t){var c,o,i,y;return typeof n!="string"?(i=t,t=r,r=n,n=null):i=arguments[3],w(r)?v(r)?w(t)?v(t)||(i=t,t=void 0):t=void 0:(i=r,r=t=void 0):r=void 0,w(n)?(c=e.call(n,"c"),o=e.call(n,"e")):(c=!0,o=!1),y={get:r,set:t,configurable:c,enumerable:o},i?S(M(i),y):y}},{"es5-ext/object/assign":144,"es5-ext/object/normalize-options":156,"es5-ext/string/#/contains":163,"type/plain-function/is":323,"type/value/is":327}],107:[function(d,ee,te){(function(w,v){v(typeof te=="object"&&typeof ee<"u"?te:w.d3=w.d3||{})})(this,function(w){function v(N,U){return N<U?-1:N>U?1:N>=U?0:NaN}function S(N){return N.length===1&&(N=M(N)),{left:function(U,q,$,W){for($==null&&($=0),W==null&&(W=U.length);$<W;){var K=$+W>>>1;N(U[K],q)<0?$=K+1:W=K}return $},right:function(U,q,$,W){for($==null&&($=0),W==null&&(W=U.length);$<W;){var K=$+W>>>1;N(U[K],q)>0?W=K:$=K+1}return $}}}function M(N){return function(U,q){return v(N(U),q)}}var e=S(v),a=e.right,n=e.left;function r(N,U){U==null&&(U=t);for(var q=0,$=N.length-1,W=N[0],K=new Array($<0?0:$);q<$;)K[q]=U(W,W=N[++q]);return K}function t(N,U){return[N,U]}function c(N,U,q){var $=N.length,W=U.length,K=new Array($*W),ne,ae,ie,le;for(q==null&&(q=t),ne=ie=0;ne<$;++ne)for(le=N[ne],ae=0;ae<W;++ae,++ie)K[ie]=q(le,U[ae]);return K}function o(N,U){return U<N?-1:U>N?1:U>=N?0:NaN}function i(N){return N===null?NaN:+N}function y(N,U){var q=N.length,$=0,W=-1,K=0,ne,ae,ie=0;if(U==null)for(;++W<q;)isNaN(ne=i(N[W]))||(ae=ne-K,K+=ae/++$,ie+=ae*(ne-K));else for(;++W<q;)isNaN(ne=i(U(N[W],W,N)))||(ae=ne-K,K+=ae/++$,ie+=ae*(ne-K));if($>1)return ie/($-1)}function p(N,U){var q=y(N,U);return q&&Math.sqrt(q)}function g(N,U){var q=N.length,$=-1,W,K,ne;if(U==null){for(;++$<q;)if((W=N[$])!=null&&W>=W)for(K=ne=W;++$<q;)(W=N[$])!=null&&(K>W&&(K=W),ne<W&&(ne=W))}else for(;++$<q;)if((W=U(N[$],$,N))!=null&&W>=W)for(K=ne=W;++$<q;)(W=U(N[$],$,N))!=null&&(K>W&&(K=W),ne<W&&(ne=W));return[K,ne]}var h=Array.prototype,m=h.slice,u=h.map;function _(N){return function(){return N}}function s(N){return N}function A(N,U,q){N=+N,U=+U,q=(W=arguments.length)<2?(U=N,N=0,1):W<3?1:+q;for(var $=-1,W=Math.max(0,Math.ceil((U-N)/q))|0,K=new Array(W);++$<W;)K[$]=N+$*q;return K}var b=Math.sqrt(50),f=Math.sqrt(10),x=Math.sqrt(2);function l(N,U,q){var $,W=-1,K,ne,ae;if(U=+U,N=+N,q=+q,N===U&&q>0)return[N];if(($=U<N)&&(K=N,N=U,U=K),(ae=L(N,U,q))===0||!isFinite(ae))return[];if(ae>0)for(N=Math.ceil(N/ae),U=Math.floor(U/ae),ne=new Array(K=Math.ceil(U-N+1));++W<K;)ne[W]=(N+W)*ae;else for(N=Math.floor(N*ae),U=Math.ceil(U*ae),ne=new Array(K=Math.ceil(N-U+1));++W<K;)ne[W]=(N-W)/ae;return $&&ne.reverse(),ne}function L(N,U,q){var $=(U-N)/Math.max(0,q),W=Math.floor(Math.log($)/Math.LN10),K=$/Math.pow(10,W);return W>=0?(K>=b?10:K>=f?5:K>=x?2:1)*Math.pow(10,W):-Math.pow(10,-W)/(K>=b?10:K>=f?5:K>=x?2:1)}function T(N,U,q){var $=Math.abs(U-N)/Math.max(0,q),W=Math.pow(10,Math.floor(Math.log($)/Math.LN10)),K=$/W;return K>=b?W*=10:K>=f?W*=5:K>=x&&(W*=2),U<N?-W:W}function k(N){return Math.ceil(Math.log(N.length)/Math.LN2)+1}function P(){var N=s,U=g,q=k;function $(W){var K,ne=W.length,ae,ie=new Array(ne);for(K=0;K<ne;++K)ie[K]=N(W[K],K,W);var le=U(ie),ye=le[0],ue=le[1],pe=q(ie,ye,ue);Array.isArray(pe)||(pe=T(ye,ue,pe),pe=A(Math.ceil(ye/pe)*pe,ue,pe));for(var ge=pe.length;pe[0]<=ye;)pe.shift(),--ge;for(;pe[ge-1]>ue;)pe.pop(),--ge;var Te=new Array(ge+1),_e;for(K=0;K<=ge;++K)_e=Te[K]=[],_e.x0=K>0?pe[K-1]:ye,_e.x1=K<ge?pe[K]:ue;for(K=0;K<ne;++K)ae=ie[K],ye<=ae&&ae<=ue&&Te[a(pe,ae,0,ge)].push(W[K]);return Te}return $.value=function(W){return arguments.length?(N=typeof W=="function"?W:_(W),$):N},$.domain=function(W){return arguments.length?(U=typeof W=="function"?W:_([W[0],W[1]]),$):U},$.thresholds=function(W){return arguments.length?(q=typeof W=="function"?W:Array.isArray(W)?_(m.call(W)):_(W),$):q},$}function z(N,U,q){if(q==null&&(q=i),!!($=N.length)){if((U=+U)<=0||$<2)return+q(N[0],0,N);if(U>=1)return+q(N[$-1],$-1,N);var $,W=($-1)*U,K=Math.floor(W),ne=+q(N[K],K,N),ae=+q(N[K+1],K+1,N);return ne+(ae-ne)*(W-K)}}function I(N,U,q){return N=u.call(N,i).sort(v),Math.ceil((q-U)/(2*(z(N,.75)-z(N,.25))*Math.pow(N.length,-1/3)))}function D(N,U,q){return Math.ceil((q-U)/(3.5*p(N)*Math.pow(N.length,-1/3)))}function R(N,U){var q=N.length,$=-1,W,K;if(U==null){for(;++$<q;)if((W=N[$])!=null&&W>=W)for(K=W;++$<q;)(W=N[$])!=null&&W>K&&(K=W)}else for(;++$<q;)if((W=U(N[$],$,N))!=null&&W>=W)for(K=W;++$<q;)(W=U(N[$],$,N))!=null&&W>K&&(K=W);return K}function B(N,U){var q=N.length,$=q,W=-1,K,ne=0;if(U==null)for(;++W<q;)isNaN(K=i(N[W]))?--$:ne+=K;else for(;++W<q;)isNaN(K=i(U(N[W],W,N)))?--$:ne+=K;if($)return ne/$}function F(N,U){var q=N.length,$=-1,W,K=[];if(U==null)for(;++$<q;)isNaN(W=i(N[$]))||K.push(W);else for(;++$<q;)isNaN(W=i(U(N[$],$,N)))||K.push(W);return z(K.sort(v),.5)}function H(N){for(var U=N.length,q,$=-1,W=0,K,ne;++$<U;)W+=N[$].length;for(K=new Array(W);--U>=0;)for(ne=N[U],q=ne.length;--q>=0;)K[--W]=ne[q];return K}function G(N,U){var q=N.length,$=-1,W,K;if(U==null){for(;++$<q;)if((W=N[$])!=null&&W>=W)for(K=W;++$<q;)(W=N[$])!=null&&K>W&&(K=W)}else for(;++$<q;)if((W=U(N[$],$,N))!=null&&W>=W)for(K=W;++$<q;)(W=U(N[$],$,N))!=null&&K>W&&(K=W);return K}function J(N,U){for(var q=U.length,$=new Array(q);q--;)$[q]=N[U[q]];return $}function X(N,U){if(!!(q=N.length)){var q,$=0,W=0,K,ne=N[W];for(U==null&&(U=v);++$<q;)(U(K=N[$],ne)<0||U(ne,ne)!==0)&&(ne=K,W=$);if(U(ne,ne)===0)return W}}function Y(N,U,q){for(var $=(q==null?N.length:q)-(U=U==null?0:+U),W,K;$;)K=Math.random()*$--|0,W=N[$+U],N[$+U]=N[K+U],N[K+U]=W;return N}function Z(N,U){var q=N.length,$=-1,W,K=0;if(U==null)for(;++$<q;)(W=+N[$])&&(K+=W);else for(;++$<q;)(W=+U(N[$],$,N))&&(K+=W);return K}function oe(N){if(!(K=N.length))return[];for(var U=-1,q=G(N,re),$=new Array(q);++U<q;)for(var W=-1,K,ne=$[U]=new Array(K);++W<K;)ne[W]=N[W][U];return $}function re(N){return N.length}function se(){return oe(arguments)}w.bisect=a,w.bisectRight=a,w.bisectLeft=n,w.ascending=v,w.bisector=S,w.cross=c,w.descending=o,w.deviation=p,w.extent=g,w.histogram=P,w.thresholdFreedmanDiaconis=I,w.thresholdScott=D,w.thresholdSturges=k,w.max=R,w.mean=B,w.median=F,w.merge=H,w.min=G,w.pairs=r,w.permute=J,w.quantile=z,w.range=A,w.scan=X,w.shuffle=Y,w.sum=Z,w.ticks=l,w.tickIncrement=L,w.tickStep=T,w.transpose=oe,w.variance=y,w.zip=se,Object.defineProperty(w,"__esModule",{value:!0})})},{}],108:[function(d,ee,te){(function(w,v){v(typeof te=="object"&&typeof ee<"u"?te:w.d3=w.d3||{})})(this,function(w){var v="$";function S(){}S.prototype=M.prototype={constructor:S,has:function(h){return v+h in this},get:function(h){return this[v+h]},set:function(h,m){return this[v+h]=m,this},remove:function(h){var m=v+h;return m in this&&delete this[m]},clear:function(){for(var h in this)h[0]===v&&delete this[h]},keys:function(){var h=[];for(var m in this)m[0]===v&&h.push(m.slice(1));return h},values:function(){var h=[];for(var m in this)m[0]===v&&h.push(this[m]);return h},entries:function(){var h=[];for(var m in this)m[0]===v&&h.push({key:m.slice(1),value:this[m]});return h},size:function(){var h=0;for(var m in this)m[0]===v&&++h;return h},empty:function(){for(var h in this)if(h[0]===v)return!1;return!0},each:function(h){for(var m in this)m[0]===v&&h(this[m],m.slice(1),this)}};function M(h,m){var u=new S;if(h instanceof S)h.each(function(f,x){u.set(x,f)});else if(Array.isArray(h)){var _=-1,s=h.length,A;if(m==null)for(;++_<s;)u.set(_,h[_]);else for(;++_<s;)u.set(m(A=h[_],_,h),A)}else if(h)for(var b in h)u.set(b,h[b]);return u}function e(){var h=[],m=[],u,_,s;function A(f,x,l,L){if(x>=h.length)return u!=null&&f.sort(u),_!=null?_(f):f;for(var T=-1,k=f.length,P=h[x++],z,I,D=M(),R,B=l();++T<k;)(R=D.get(z=P(I=f[T])+""))?R.push(I):D.set(z,[I]);return D.each(function(F,H){L(B,H,A(F,x,l,L))}),B}function b(f,x){if(++x>h.length)return f;var l,L=m[x-1];return _!=null&&x>=h.length?l=f.entries():(l=[],f.each(function(T,k){l.push({key:k,values:b(T,x)})})),L!=null?l.sort(function(T,k){return L(T.key,k.key)}):l}return s={object:function(f){return A(f,0,a,n)},map:function(f){return A(f,0,r,t)},entries:function(f){return b(A(f,0,r,t),0)},key:function(f){return h.push(f),s},sortKeys:function(f){return m[h.length-1]=f,s},sortValues:function(f){return u=f,s},rollup:function(f){return _=f,s}}}function a(){return{}}function n(h,m,u){h[m]=u}function r(){return M()}function t(h,m,u){h.set(m,u)}function c(){}var o=M.prototype;c.prototype=i.prototype={constructor:c,has:o.has,add:function(h){return h+="",this[v+h]=h,this},remove:o.remove,clear:o.clear,values:o.keys,size:o.size,empty:o.empty,each:o.each};function i(h,m){var u=new c;if(h instanceof c)h.each(function(A){u.add(A)});else if(h){var _=-1,s=h.length;if(m==null)for(;++_<s;)u.add(h[_]);else for(;++_<s;)u.add(m(h[_],_,h))}return u}function y(h){var m=[];for(var u in h)m.push(u);return m}function p(h){var m=[];for(var u in h)m.push(h[u]);return m}function g(h){var m=[];for(var u in h)m.push({key:u,value:h[u]});return m}w.nest=e,w.set=i,w.map=M,w.keys=y,w.values=p,w.entries=g,Object.defineProperty(w,"__esModule",{value:!0})})},{}],109:[function(d,ee,te){(function(w,v){typeof te=="object"&&typeof ee<"u"?v(te):(w=w||self,v(w.d3=w.d3||{}))})(this,function(w){function v(Le,He,vt){Le.prototype=He.prototype=vt,vt.constructor=Le}function S(Le,He){var vt=Object.create(Le.prototype);for(var Rt in He)vt[Rt]=He[Rt];return vt}function M(){}var e=.7,a=1/e,n="\\s*([+-]?\\d+)\\s*",r="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",t="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",c=/^#([0-9a-f]{3,8})$/,o=new RegExp("^rgb\\("+[n,n,n]+"\\)$"),i=new RegExp("^rgb\\("+[t,t,t]+"\\)$"),y=new RegExp("^rgba\\("+[n,n,n,r]+"\\)$"),p=new RegExp("^rgba\\("+[t,t,t,r]+"\\)$"),g=new RegExp("^hsl\\("+[r,t,t]+"\\)$"),h=new RegExp("^hsla\\("+[r,t,t,r]+"\\)$"),m={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};v(M,A,{copy:function(Le){return Object.assign(new this.constructor,this,Le)},displayable:function(){return this.rgb().displayable()},hex:u,formatHex:u,formatHsl:_,formatRgb:s,toString:s});function u(){return this.rgb().formatHex()}function _(){return I(this).formatHsl()}function s(){return this.rgb().formatRgb()}function A(Le){var He,vt;return Le=(Le+"").trim().toLowerCase(),(He=c.exec(Le))?(vt=He[1].length,He=parseInt(He[1],16),vt===6?b(He):vt===3?new L(He>>8&15|He>>4&240,He>>4&15|He&240,(He&15)<<4|He&15,1):vt===8?f(He>>24&255,He>>16&255,He>>8&255,(He&255)/255):vt===4?f(He>>12&15|He>>8&240,He>>8&15|He>>4&240,He>>4&15|He&240,((He&15)<<4|He&15)/255):null):(He=o.exec(Le))?new L(He[1],He[2],He[3],1):(He=i.exec(Le))?new L(He[1]*255/100,He[2]*255/100,He[3]*255/100,1):(He=y.exec(Le))?f(He[1],He[2],He[3],He[4]):(He=p.exec(Le))?f(He[1]*255/100,He[2]*255/100,He[3]*255/100,He[4]):(He=g.exec(Le))?z(He[1],He[2]/100,He[3]/100,1):(He=h.exec(Le))?z(He[1],He[2]/100,He[3]/100,He[4]):m.hasOwnProperty(Le)?b(m[Le]):Le==="transparent"?new L(NaN,NaN,NaN,0):null}function b(Le){return new L(Le>>16&255,Le>>8&255,Le&255,1)}function f(Le,He,vt,Rt){return Rt<=0&&(Le=He=vt=NaN),new L(Le,He,vt,Rt)}function x(Le){return Le instanceof M||(Le=A(Le)),Le?(Le=Le.rgb(),new L(Le.r,Le.g,Le.b,Le.opacity)):new L}function l(Le,He,vt,Rt){return arguments.length===1?x(Le):new L(Le,He,vt,Rt==null?1:Rt)}function L(Le,He,vt,Rt){this.r=+Le,this.g=+He,this.b=+vt,this.opacity=+Rt}v(L,l,S(M,{brighter:function(Le){return Le=Le==null?a:Math.pow(a,Le),new L(this.r*Le,this.g*Le,this.b*Le,this.opacity)},darker:function(Le){return Le=Le==null?e:Math.pow(e,Le),new L(this.r*Le,this.g*Le,this.b*Le,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:T,formatHex:T,formatRgb:k,toString:k}));function T(){return"#"+P(this.r)+P(this.g)+P(this.b)}function k(){var Le=this.opacity;return Le=isNaN(Le)?1:Math.max(0,Math.min(1,Le)),(Le===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(Le===1?")":", "+Le+")")}function P(Le){return Le=Math.max(0,Math.min(255,Math.round(Le)||0)),(Le<16?"0":"")+Le.toString(16)}function z(Le,He,vt,Rt){return Rt<=0?Le=He=vt=NaN:vt<=0||vt>=1?Le=He=NaN:He<=0&&(Le=NaN),new R(Le,He,vt,Rt)}function I(Le){if(Le instanceof R)return new R(Le.h,Le.s,Le.l,Le.opacity);if(Le instanceof M||(Le=A(Le)),!Le)return new R;if(Le instanceof R)return Le;Le=Le.rgb();var He=Le.r/255,vt=Le.g/255,Rt=Le.b/255,rr=Math.min(He,vt,Rt),Lt=Math.max(He,vt,Rt),Ft=NaN,Gt=Lt-rr,Dt=(Lt+rr)/2;return Gt?(He===Lt?Ft=(vt-Rt)/Gt+(vt<Rt)*6:vt===Lt?Ft=(Rt-He)/Gt+2:Ft=(He-vt)/Gt+4,Gt/=Dt<.5?Lt+rr:2-Lt-rr,Ft*=60):Gt=Dt>0&&Dt<1?0:Ft,new R(Ft,Gt,Dt,Le.opacity)}function D(Le,He,vt,Rt){return arguments.length===1?I(Le):new R(Le,He,vt,Rt==null?1:Rt)}function R(Le,He,vt,Rt){this.h=+Le,this.s=+He,this.l=+vt,this.opacity=+Rt}v(R,D,S(M,{brighter:function(Le){return Le=Le==null?a:Math.pow(a,Le),new R(this.h,this.s,this.l*Le,this.opacity)},darker:function(Le){return Le=Le==null?e:Math.pow(e,Le),new R(this.h,this.s,this.l*Le,this.opacity)},rgb:function(){var Le=this.h%360+(this.h<0)*360,He=isNaN(Le)||isNaN(this.s)?0:this.s,vt=this.l,Rt=vt+(vt<.5?vt:1-vt)*He,rr=2*vt-Rt;return new L(B(Le>=240?Le-240:Le+120,rr,Rt),B(Le,rr,Rt),B(Le<120?Le+240:Le-120,rr,Rt),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var Le=this.opacity;return Le=isNaN(Le)?1:Math.max(0,Math.min(1,Le)),(Le===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(Le===1?")":", "+Le+")")}}));function B(Le,He,vt){return(Le<60?He+(vt-He)*Le/60:Le<180?vt:Le<240?He+(vt-He)*(240-Le)/60:He)*255}var F=Math.PI/180,H=180/Math.PI,G=18,J=.96422,X=1,Y=.82521,Z=4/29,oe=6/29,re=3*oe*oe,se=oe*oe*oe;function N(Le){if(Le instanceof $)return new $(Le.l,Le.a,Le.b,Le.opacity);if(Le instanceof ue)return pe(Le);Le instanceof L||(Le=x(Le));var He=ae(Le.r),vt=ae(Le.g),Rt=ae(Le.b),rr=W((.2225045*He+.7168786*vt+.0606169*Rt)/X),Lt,Ft;return He===vt&&vt===Rt?Lt=Ft=rr:(Lt=W((.4360747*He+.3850649*vt+.1430804*Rt)/J),Ft=W((.0139322*He+.0971045*vt+.7141733*Rt)/Y)),new $(116*rr-16,500*(Lt-rr),200*(rr-Ft),Le.opacity)}function U(Le,He){return new $(Le,0,0,He==null?1:He)}function q(Le,He,vt,Rt){return arguments.length===1?N(Le):new $(Le,He,vt,Rt==null?1:Rt)}function $(Le,He,vt,Rt){this.l=+Le,this.a=+He,this.b=+vt,this.opacity=+Rt}v($,q,S(M,{brighter:function(Le){return new $(this.l+G*(Le==null?1:Le),this.a,this.b,this.opacity)},darker:function(Le){return new $(this.l-G*(Le==null?1:Le),this.a,this.b,this.opacity)},rgb:function(){var Le=(this.l+16)/116,He=isNaN(this.a)?Le:Le+this.a/500,vt=isNaN(this.b)?Le:Le-this.b/200;return He=J*K(He),Le=X*K(Le),vt=Y*K(vt),new L(ne(3.1338561*He-1.6168667*Le-.4906146*vt),ne(-.9787684*He+1.9161415*Le+.033454*vt),ne(.0719453*He-.2289914*Le+1.4052427*vt),this.opacity)}}));function W(Le){return Le>se?Math.pow(Le,1/3):Le/re+Z}function K(Le){return Le>oe?Le*Le*Le:re*(Le-Z)}function ne(Le){return 255*(Le<=.0031308?12.92*Le:1.055*Math.pow(Le,1/2.4)-.055)}function ae(Le){return(Le/=255)<=.04045?Le/12.92:Math.pow((Le+.055)/1.055,2.4)}function ie(Le){if(Le instanceof ue)return new ue(Le.h,Le.c,Le.l,Le.opacity);if(Le instanceof $||(Le=N(Le)),Le.a===0&&Le.b===0)return new ue(NaN,0<Le.l&&Le.l<100?0:NaN,Le.l,Le.opacity);var He=Math.atan2(Le.b,Le.a)*H;return new ue(He<0?He+360:He,Math.sqrt(Le.a*Le.a+Le.b*Le.b),Le.l,Le.opacity)}function le(Le,He,vt,Rt){return arguments.length===1?ie(Le):new ue(vt,He,Le,Rt==null?1:Rt)}function ye(Le,He,vt,Rt){return arguments.length===1?ie(Le):new ue(Le,He,vt,Rt==null?1:Rt)}function ue(Le,He,vt,Rt){this.h=+Le,this.c=+He,this.l=+vt,this.opacity=+Rt}function pe(Le){if(isNaN(Le.h))return new $(Le.l,0,0,Le.opacity);var He=Le.h*F;return new $(Le.l,Math.cos(He)*Le.c,Math.sin(He)*Le.c,Le.opacity)}v(ue,ye,S(M,{brighter:function(Le){return new ue(this.h,this.c,this.l+G*(Le==null?1:Le),this.opacity)},darker:function(Le){return new ue(this.h,this.c,this.l-G*(Le==null?1:Le),this.opacity)},rgb:function(){return pe(this).rgb()}}));var ge=-.14861,Te=1.78277,_e=-.29227,ze=-.90649,Oe=1.97294,Ye=Oe*ze,be=Oe*Te,Pe=Te*_e-ze*ge;function Ge(Le){if(Le instanceof Be)return new Be(Le.h,Le.s,Le.l,Le.opacity);Le instanceof L||(Le=x(Le));var He=Le.r/255,vt=Le.g/255,Rt=Le.b/255,rr=(Pe*Rt+Ye*He-be*vt)/(Pe+Ye-be),Lt=Rt-rr,Ft=(Oe*(vt-rr)-_e*Lt)/ze,Gt=Math.sqrt(Ft*Ft+Lt*Lt)/(Oe*rr*(1-rr)),Dt=Gt?Math.atan2(Ft,Lt)*H-120:NaN;return new Be(Dt<0?Dt+360:Dt,Gt,rr,Le.opacity)}function Qe(Le,He,vt,Rt){return arguments.length===1?Ge(Le):new Be(Le,He,vt,Rt==null?1:Rt)}function Be(Le,He,vt,Rt){this.h=+Le,this.s=+He,this.l=+vt,this.opacity=+Rt}v(Be,Qe,S(M,{brighter:function(Le){return Le=Le==null?a:Math.pow(a,Le),new Be(this.h,this.s,this.l*Le,this.opacity)},darker:function(Le){return Le=Le==null?e:Math.pow(e,Le),new Be(this.h,this.s,this.l*Le,this.opacity)},rgb:function(){var Le=isNaN(this.h)?0:(this.h+120)*F,He=+this.l,vt=isNaN(this.s)?0:this.s*He*(1-He),Rt=Math.cos(Le),rr=Math.sin(Le);return new L(255*(He+vt*(ge*Rt+Te*rr)),255*(He+vt*(_e*Rt+ze*rr)),255*(He+vt*(Oe*Rt)),this.opacity)}})),w.color=A,w.cubehelix=Qe,w.gray=U,w.hcl=ye,w.hsl=D,w.lab=q,w.lch=le,w.rgb=l,Object.defineProperty(w,"__esModule",{value:!0})})},{}],110:[function(d,ee,te){(function(w,v){typeof te=="object"&&typeof ee<"u"?v(te):(w=w||self,v(w.d3=w.d3||{}))})(this,function(w){var v={value:function(){}};function S(){for(var r=0,t=arguments.length,c={},o;r<t;++r){if(!(o=arguments[r]+"")||o in c||/[\s.]/.test(o))throw new Error("illegal type: "+o);c[o]=[]}return new M(c)}function M(r){this._=r}function e(r,t){return r.trim().split(/^|\s+/).map(function(c){var o="",i=c.indexOf(".");if(i>=0&&(o=c.slice(i+1),c=c.slice(0,i)),c&&!t.hasOwnProperty(c))throw new Error("unknown type: "+c);return{type:c,name:o}})}M.prototype=S.prototype={constructor:M,on:function(r,t){var c=this._,o=e(r+"",c),i,y=-1,p=o.length;if(arguments.length<2){for(;++y<p;)if((i=(r=o[y]).type)&&(i=a(c[i],r.name)))return i;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++y<p;)if(i=(r=o[y]).type)c[i]=n(c[i],r.name,t);else if(t==null)for(i in c)c[i]=n(c[i],r.name,null);return this},copy:function(){var r={},t=this._;for(var c in t)r[c]=t[c].slice();return new M(r)},call:function(r,t){if((i=arguments.length-2)>0)for(var c=new Array(i),o=0,i,y;o<i;++o)c[o]=arguments[o+2];if(!this._.hasOwnProperty(r))throw new Error("unknown type: "+r);for(y=this._[r],o=0,i=y.length;o<i;++o)y[o].value.apply(t,c)},apply:function(r,t,c){if(!this._.hasOwnProperty(r))throw new Error("unknown type: "+r);for(var o=this._[r],i=0,y=o.length;i<y;++i)o[i].value.apply(t,c)}};function a(r,t){for(var c=0,o=r.length,i;c<o;++c)if((i=r[c]).name===t)return i.value}function n(r,t,c){for(var o=0,i=r.length;o<i;++o)if(r[o].name===t){r[o]=v,r=r.slice(0,o).concat(r.slice(o+1));break}return c!=null&&r.push({name:t,value:c}),r}w.dispatch=S,Object.defineProperty(w,"__esModule",{value:!0})})},{}],111:[function(d,ee,te){(function(w,v){typeof te=="object"&&typeof ee<"u"?v(te,d("d3-quadtree"),d("d3-collection"),d("d3-dispatch"),d("d3-timer")):v(w.d3=w.d3||{},w.d3,w.d3,w.d3,w.d3)})(this,function(w,v,S,M,e){function a(x,l){var L;x==null&&(x=0),l==null&&(l=0);function T(){var k,P=L.length,z,I=0,D=0;for(k=0;k<P;++k)z=L[k],I+=z.x,D+=z.y;for(I=I/P-x,D=D/P-l,k=0;k<P;++k)z=L[k],z.x-=I,z.y-=D}return T.initialize=function(k){L=k},T.x=function(k){return arguments.length?(x=+k,T):x},T.y=function(k){return arguments.length?(l=+k,T):l},T}function n(x){return function(){return x}}function r(){return(Math.random()-.5)*1e-6}function t(x){return x.x+x.vx}function c(x){return x.y+x.vy}function o(x){var l,L,T=1,k=1;typeof x!="function"&&(x=n(x==null?1:+x));function P(){for(var D,R=l.length,B,F,H,G,J,X,Y=0;Y<k;++Y)for(B=v.quadtree(l,t,c).visitAfter(z),D=0;D<R;++D)F=l[D],J=L[F.index],X=J*J,H=F.x+F.vx,G=F.y+F.vy,B.visit(Z);function Z(oe,re,se,N,U){var q=oe.data,$=oe.r,W=J+$;if(q){if(q.index>F.index){var K=H-q.x-q.vx,ne=G-q.y-q.vy,ae=K*K+ne*ne;ae<W*W&&(K===0&&(K=r(),ae+=K*K),ne===0&&(ne=r(),ae+=ne*ne),ae=(W-(ae=Math.sqrt(ae)))/ae*T,F.vx+=(K*=ae)*(W=($*=$)/(X+$)),F.vy+=(ne*=ae)*W,q.vx-=K*(W=1-W),q.vy-=ne*W)}return}return re>H+W||N<H-W||se>G+W||U<G-W}}function z(D){if(D.data)return D.r=L[D.data.index];for(var R=D.r=0;R<4;++R)D[R]&&D[R].r>D.r&&(D.r=D[R].r)}function I(){if(!!l){var D,R=l.length,B;for(L=new Array(R),D=0;D<R;++D)B=l[D],L[B.index]=+x(B,D,l)}}return P.initialize=function(D){l=D,I()},P.iterations=function(D){return arguments.length?(k=+D,P):k},P.strength=function(D){return arguments.length?(T=+D,P):T},P.radius=function(D){return arguments.length?(x=typeof D=="function"?D:n(+D),I(),P):x},P}function i(x){return x.index}function y(x,l){var L=x.get(l);if(!L)throw new Error("missing: "+l);return L}function p(x){var l=i,L=B,T,k=n(30),P,z,I,D,R=1;x==null&&(x=[]);function B(X){return 1/Math.min(I[X.source.index],I[X.target.index])}function F(X){for(var Y=0,Z=x.length;Y<R;++Y)for(var oe=0,re,se,N,U,q,$,W;oe<Z;++oe)re=x[oe],se=re.source,N=re.target,U=N.x+N.vx-se.x-se.vx||r(),q=N.y+N.vy-se.y-se.vy||r(),$=Math.sqrt(U*U+q*q),$=($-P[oe])/$*X*T[oe],U*=$,q*=$,N.vx-=U*(W=D[oe]),N.vy-=q*W,se.vx+=U*(W=1-W),se.vy+=q*W}function H(){if(!!z){var X,Y=z.length,Z=x.length,oe=S.map(z,l),re;for(X=0,I=new Array(Y);X<Z;++X)re=x[X],re.index=X,typeof re.source!="object"&&(re.source=y(oe,re.source)),typeof re.target!="object"&&(re.target=y(oe,re.target)),I[re.source.index]=(I[re.source.index]||0)+1,I[re.target.index]=(I[re.target.index]||0)+1;for(X=0,D=new Array(Z);X<Z;++X)re=x[X],D[X]=I[re.source.index]/(I[re.source.index]+I[re.target.index]);T=new Array(Z),G(),P=new Array(Z),J()}}function G(){if(!!z)for(var X=0,Y=x.length;X<Y;++X)T[X]=+L(x[X],X,x)}function J(){if(!!z)for(var X=0,Y=x.length;X<Y;++X)P[X]=+k(x[X],X,x)}return F.initialize=function(X){z=X,H()},F.links=function(X){return arguments.length?(x=X,H(),F):x},F.id=function(X){return arguments.length?(l=X,F):l},F.iterations=function(X){return arguments.length?(R=+X,F):R},F.strength=function(X){return arguments.length?(L=typeof X=="function"?X:n(+X),G(),F):L},F.distance=function(X){return arguments.length?(k=typeof X=="function"?X:n(+X),J(),F):k},F}function g(x){return x.x}function h(x){return x.y}var m=10,u=Math.PI*(3-Math.sqrt(5));function _(x){var l,L=1,T=.001,k=1-Math.pow(T,1/300),P=0,z=.6,I=S.map(),D=e.timer(B),R=M.dispatch("tick","end");x==null&&(x=[]);function B(){F(),R.call("tick",l),L<T&&(D.stop(),R.call("end",l))}function F(J){var X,Y=x.length,Z;J===void 0&&(J=1);for(var oe=0;oe<J;++oe)for(L+=(P-L)*k,I.each(function(re){re(L)}),X=0;X<Y;++X)Z=x[X],Z.fx==null?Z.x+=Z.vx*=z:(Z.x=Z.fx,Z.vx=0),Z.fy==null?Z.y+=Z.vy*=z:(Z.y=Z.fy,Z.vy=0);return l}function H(){for(var J=0,X=x.length,Y;J<X;++J){if(Y=x[J],Y.index=J,Y.fx!=null&&(Y.x=Y.fx),Y.fy!=null&&(Y.y=Y.fy),isNaN(Y.x)||isNaN(Y.y)){var Z=m*Math.sqrt(J),oe=J*u;Y.x=Z*Math.cos(oe),Y.y=Z*Math.sin(oe)}(isNaN(Y.vx)||isNaN(Y.vy))&&(Y.vx=Y.vy=0)}}function G(J){return J.initialize&&J.initialize(x),J}return H(),l={tick:F,restart:function(){return D.restart(B),l},stop:function(){return D.stop(),l},nodes:function(J){return arguments.length?(x=J,H(),I.each(G),l):x},alpha:function(J){return arguments.length?(L=+J,l):L},alphaMin:function(J){return arguments.length?(T=+J,l):T},alphaDecay:function(J){return arguments.length?(k=+J,l):+k},alphaTarget:function(J){return arguments.length?(P=+J,l):P},velocityDecay:function(J){return arguments.length?(z=1-J,l):1-z},force:function(J,X){return arguments.length>1?(X==null?I.remove(J):I.set(J,G(X)),l):I.get(J)},find:function(J,X,Y){var Z=0,oe=x.length,re,se,N,U,q;for(Y==null?Y=1/0:Y*=Y,Z=0;Z<oe;++Z)U=x[Z],re=J-U.x,se=X-U.y,N=re*re+se*se,N<Y&&(q=U,Y=N);return q},on:function(J,X){return arguments.length>1?(R.on(J,X),l):R.on(J)}}}function s(){var x,l,L,T=n(-30),k,P=1,z=1/0,I=.81;function D(H){var G,J=x.length,X=v.quadtree(x,g,h).visitAfter(B);for(L=H,G=0;G<J;++G)l=x[G],X.visit(F)}function R(){if(!!x){var H,G=x.length,J;for(k=new Array(G),H=0;H<G;++H)J=x[H],k[J.index]=+T(J,H,x)}}function B(H){var G=0,J,X,Y=0,Z,oe,re;if(H.length){for(Z=oe=re=0;re<4;++re)(J=H[re])&&(X=Math.abs(J.value))&&(G+=J.value,Y+=X,Z+=X*J.x,oe+=X*J.y);H.x=Z/Y,H.y=oe/Y}else{J=H,J.x=J.data.x,J.y=J.data.y;do G+=k[J.data.index];while(J=J.next)}H.value=G}function F(H,G,J,X){if(!H.value)return!0;var Y=H.x-l.x,Z=H.y-l.y,oe=X-G,re=Y*Y+Z*Z;if(oe*oe/I<re)return re<z&&(Y===0&&(Y=r(),re+=Y*Y),Z===0&&(Z=r(),re+=Z*Z),re<P&&(re=Math.sqrt(P*re)),l.vx+=Y*H.value*L/re,l.vy+=Z*H.value*L/re),!0;if(H.length||re>=z)return;(H.data!==l||H.next)&&(Y===0&&(Y=r(),re+=Y*Y),Z===0&&(Z=r(),re+=Z*Z),re<P&&(re=Math.sqrt(P*re)));do H.data!==l&&(oe=k[H.data.index]*L/re,l.vx+=Y*oe,l.vy+=Z*oe);while(H=H.next)}return D.initialize=function(H){x=H,R()},D.strength=function(H){return arguments.length?(T=typeof H=="function"?H:n(+H),R(),D):T},D.distanceMin=function(H){return arguments.length?(P=H*H,D):Math.sqrt(P)},D.distanceMax=function(H){return arguments.length?(z=H*H,D):Math.sqrt(z)},D.theta=function(H){return arguments.length?(I=H*H,D):Math.sqrt(I)},D}function A(x,l,L){var T,k=n(.1),P,z;typeof x!="function"&&(x=n(+x)),l==null&&(l=0),L==null&&(L=0);function I(R){for(var B=0,F=T.length;B<F;++B){var H=T[B],G=H.x-l||1e-6,J=H.y-L||1e-6,X=Math.sqrt(G*G+J*J),Y=(z[B]-X)*P[B]*R/X;H.vx+=G*Y,H.vy+=J*Y}}function D(){if(!!T){var R,B=T.length;for(P=new Array(B),z=new Array(B),R=0;R<B;++R)z[R]=+x(T[R],R,T),P[R]=isNaN(z[R])?0:+k(T[R],R,T)}}return I.initialize=function(R){T=R,D()},I.strength=function(R){return arguments.length?(k=typeof R=="function"?R:n(+R),D(),I):k},I.radius=function(R){return arguments.length?(x=typeof R=="function"?R:n(+R),D(),I):x},I.x=function(R){return arguments.length?(l=+R,I):l},I.y=function(R){return arguments.length?(L=+R,I):L},I}function b(x){var l=n(.1),L,T,k;typeof x!="function"&&(x=n(x==null?0:+x));function P(I){for(var D=0,R=L.length,B;D<R;++D)B=L[D],B.vx+=(k[D]-B.x)*T[D]*I}function z(){if(!!L){var I,D=L.length;for(T=new Array(D),k=new Array(D),I=0;I<D;++I)T[I]=isNaN(k[I]=+x(L[I],I,L))?0:+l(L[I],I,L)}}return P.initialize=function(I){L=I,z()},P.strength=function(I){return arguments.length?(l=typeof I=="function"?I:n(+I),z(),P):l},P.x=function(I){return arguments.length?(x=typeof I=="function"?I:n(+I),z(),P):x},P}function f(x){var l=n(.1),L,T,k;typeof x!="function"&&(x=n(x==null?0:+x));function P(I){for(var D=0,R=L.length,B;D<R;++D)B=L[D],B.vy+=(k[D]-B.y)*T[D]*I}function z(){if(!!L){var I,D=L.length;for(T=new Array(D),k=new Array(D),I=0;I<D;++I)T[I]=isNaN(k[I]=+x(L[I],I,L))?0:+l(L[I],I,L)}}return P.initialize=function(I){L=I,z()},P.strength=function(I){return arguments.length?(l=typeof I=="function"?I:n(+I),z(),P):l},P.y=function(I){return arguments.length?(x=typeof I=="function"?I:n(+I),z(),P):x},P}w.forceCenter=a,w.forceCollide=o,w.forceLink=p,w.forceManyBody=s,w.forceRadial=A,w.forceSimulation=_,w.forceX=b,w.forceY=f,Object.defineProperty(w,"__esModule",{value:!0})})},{"d3-collection":108,"d3-dispatch":110,"d3-quadtree":118,"d3-timer":123}],112:[function(d,ee,te){(function(w,v){typeof te=="object"&&typeof ee<"u"?v(te):(w=typeof globalThis<"u"?globalThis:w||self,v(w.d3=w.d3||{}))})(this,function(w){function v(x){return Math.abs(x=Math.round(x))>=1e21?x.toLocaleString("en").replace(/,/g,""):x.toString(10)}function S(x,l){if((L=(x=l?x.toExponential(l-1):x.toExponential()).indexOf("e"))<0)return null;var L,T=x.slice(0,L);return[T.length>1?T[0]+T.slice(2):T,+x.slice(L+1)]}function M(x){return x=S(Math.abs(x)),x?x[1]:NaN}function e(x,l){return function(L,T){for(var k=L.length,P=[],z=0,I=x[0],D=0;k>0&&I>0&&(D+I+1>T&&(I=Math.max(1,T-D)),P.push(L.substring(k-=I,k+I)),!((D+=I+1)>T));)I=x[z=(z+1)%x.length];return P.reverse().join(l)}}function a(x){return function(l){return l.replace(/[0-9]/g,function(L){return x[+L]})}}var n=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function r(x){if(!(l=n.exec(x)))throw new Error("invalid format: "+x);var l;return new t({fill:l[1],align:l[2],sign:l[3],symbol:l[4],zero:l[5],width:l[6],comma:l[7],precision:l[8]&&l[8].slice(1),trim:l[9],type:l[10]})}r.prototype=t.prototype;function t(x){this.fill=x.fill===void 0?" ":x.fill+"",this.align=x.align===void 0?">":x.align+"",this.sign=x.sign===void 0?"-":x.sign+"",this.symbol=x.symbol===void 0?"":x.symbol+"",this.zero=!!x.zero,this.width=x.width===void 0?void 0:+x.width,this.comma=!!x.comma,this.precision=x.precision===void 0?void 0:+x.precision,this.trim=!!x.trim,this.type=x.type===void 0?"":x.type+""}t.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function c(x){e:for(var l=x.length,L=1,T=-1,k;L<l;++L)switch(x[L]){case".":T=k=L;break;case"0":T===0&&(T=L),k=L;break;default:if(!+x[L])break e;T>0&&(T=0);break}return T>0?x.slice(0,T)+x.slice(k+1):x}var o;function i(x,l){var L=S(x,l);if(!L)return x+"";var T=L[0],k=L[1],P=k-(o=Math.max(-8,Math.min(8,Math.floor(k/3)))*3)+1,z=T.length;return P===z?T:P>z?T+new Array(P-z+1).join("0"):P>0?T.slice(0,P)+"."+T.slice(P):"0."+new Array(1-P).join("0")+S(x,Math.max(0,l+P-1))[0]}function y(x,l){var L=S(x,l);if(!L)return x+"";var T=L[0],k=L[1];return k<0?"0."+new Array(-k).join("0")+T:T.length>k+1?T.slice(0,k+1)+"."+T.slice(k+1):T+new Array(k-T.length+2).join("0")}var p={"%":function(x,l){return(x*100).toFixed(l)},b:function(x){return Math.round(x).toString(2)},c:function(x){return x+""},d:v,e:function(x,l){return x.toExponential(l)},f:function(x,l){return x.toFixed(l)},g:function(x,l){return x.toPrecision(l)},o:function(x){return Math.round(x).toString(8)},p:function(x,l){return y(x*100,l)},r:y,s:i,X:function(x){return Math.round(x).toString(16).toUpperCase()},x:function(x){return Math.round(x).toString(16)}};function g(x){return x}var h=Array.prototype.map,m=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function u(x){var l=x.grouping===void 0||x.thousands===void 0?g:e(h.call(x.grouping,Number),x.thousands+""),L=x.currency===void 0?"":x.currency[0]+"",T=x.currency===void 0?"":x.currency[1]+"",k=x.decimal===void 0?".":x.decimal+"",P=x.numerals===void 0?g:a(h.call(x.numerals,String)),z=x.percent===void 0?"%":x.percent+"",I=x.minus===void 0?"-":x.minus+"",D=x.nan===void 0?"NaN":x.nan+"";function R(F){F=r(F);var H=F.fill,G=F.align,J=F.sign,X=F.symbol,Y=F.zero,Z=F.width,oe=F.comma,re=F.precision,se=F.trim,N=F.type;N==="n"?(oe=!0,N="g"):p[N]||(re===void 0&&(re=12),se=!0,N="g"),(Y||H==="0"&&G==="=")&&(Y=!0,H="0",G="=");var U=X==="$"?L:X==="#"&&/[boxX]/.test(N)?"0"+N.toLowerCase():"",q=X==="$"?T:/[%p]/.test(N)?z:"",$=p[N],W=/[defgprs%]/.test(N);re=re===void 0?6:/[gprs]/.test(N)?Math.max(1,Math.min(21,re)):Math.max(0,Math.min(20,re));function K(ne){var ae=U,ie=q,le,ye,ue;if(N==="c")ie=$(ne)+ie,ne="";else{ne=+ne;var pe=ne<0||1/ne<0;if(ne=isNaN(ne)?D:$(Math.abs(ne),re),se&&(ne=c(ne)),pe&&+ne==0&&J!=="+"&&(pe=!1),ae=(pe?J==="("?J:I:J==="-"||J==="("?"":J)+ae,ie=(N==="s"?m[8+o/3]:"")+ie+(pe&&J==="("?")":""),W){for(le=-1,ye=ne.length;++le<ye;)if(ue=ne.charCodeAt(le),48>ue||ue>57){ie=(ue===46?k+ne.slice(le+1):ne.slice(le))+ie,ne=ne.slice(0,le);break}}}oe&&!Y&&(ne=l(ne,1/0));var ge=ae.length+ne.length+ie.length,Te=ge<Z?new Array(Z-ge+1).join(H):"";switch(oe&&Y&&(ne=l(Te+ne,Te.length?Z-ie.length:1/0),Te=""),G){case"<":ne=ae+ne+ie+Te;break;case"=":ne=ae+Te+ne+ie;break;case"^":ne=Te.slice(0,ge=Te.length>>1)+ae+ne+ie+Te.slice(ge);break;default:ne=Te+ae+ne+ie;break}return P(ne)}return K.toString=function(){return F+""},K}function B(F,H){var G=R((F=r(F),F.type="f",F)),J=Math.max(-8,Math.min(8,Math.floor(M(H)/3)))*3,X=Math.pow(10,-J),Y=m[8+J/3];return function(Z){return G(X*Z)+Y}}return{format:R,formatPrefix:B}}var _;s({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"});function s(x){return _=u(x),w.format=_.format,w.formatPrefix=_.formatPrefix,_}function A(x){return Math.max(0,-M(Math.abs(x)))}function b(x,l){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(M(l)/3)))*3-M(Math.abs(x)))}function f(x,l){return x=Math.abs(x),l=Math.abs(l)-x,Math.max(0,M(l)-M(x))+1}w.FormatSpecifier=t,w.formatDefaultLocale=s,w.formatLocale=u,w.formatSpecifier=r,w.precisionFixed=A,w.precisionPrefix=b,w.precisionRound=f,Object.defineProperty(w,"__esModule",{value:!0})})},{}],113:[function(d,ee,te){(function(w,v){typeof te=="object"&&typeof ee<"u"?v(te,d("d3-geo"),d("d3-array")):v(w.d3=w.d3||{},w.d3,w.d3)})(this,function(w,v,S){var M=Math.abs,e=Math.atan,a=Math.atan2,n=Math.cos,r=Math.exp,t=Math.floor,c=Math.log,o=Math.max,i=Math.min,y=Math.pow,p=Math.round,g=Math.sign||function(De){return De>0?1:De<0?-1:0},h=Math.sin,m=Math.tan,u=1e-6,_=1e-12,s=Math.PI,A=s/2,b=s/4,f=Math.SQRT1_2,x=D(2),l=D(s),L=s*2,T=180/s,k=s/180;function P(De){return De?De/Math.sin(De):1}function z(De){return De>1?A:De<-1?-A:Math.asin(De)}function I(De){return De>1?0:De<-1?s:Math.acos(De)}function D(De){return De>0?Math.sqrt(De):0}function R(De){return De=r(2*De),(De-1)/(De+1)}function B(De){return(r(De)-r(-De))/2}function F(De){return(r(De)+r(-De))/2}function H(De){return c(De+D(De*De+1))}function G(De){return c(De+D(De*De-1))}function J(De){var We=m(De/2),et=2*c(n(De/2))/(We*We);function ot(bt,yt){var Mt=n(bt),ur=n(yt),pr=h(yt),sr=ur*Mt,xr=-((1-sr?c((1+sr)/2)/(1-sr):-.5)+et/(1+sr));return[xr*ur*h(bt),xr*pr]}return ot.invert=function(bt,yt){var Mt=D(bt*bt+yt*yt),ur=-De/2,pr=50,sr;if(!Mt)return[0,0];do{var xr=ur/2,Dr=n(xr),Xr=h(xr),qr=Xr/Dr,bn=-c(M(Dr));ur-=sr=(2/qr*bn-et*qr-Mt)/(-bn/(Xr*Xr)+1-et/(2*Dr*Dr))*(Dr<0?.7:1)}while(M(sr)>u&&--pr>0);var Dn=h(ur);return[a(bt*Dn,Mt*n(ur)),z(yt*Dn/Mt)]},ot}function X(){var De=A,We=v.geoProjectionMutator(J),et=We(De);return et.radius=function(ot){return arguments.length?We(De=ot*k):De*T},et.scale(179.976).clipAngle(147)}function Y(De,We){var et=n(We),ot=P(I(et*n(De/=2)));return[2*et*h(De)*ot,h(We)*ot]}Y.invert=function(De,We){if(!(De*De+4*We*We>s*s+u)){var et=De,ot=We,bt=25;do{var yt=h(et),Mt=h(et/2),ur=n(et/2),pr=h(ot),sr=n(ot),xr=h(2*ot),Dr=pr*pr,Xr=sr*sr,qr=Mt*Mt,bn=1-Xr*ur*ur,Dn=bn?I(sr*ur)*D(Yn=1/bn):Yn=0,Yn,da=2*Dn*sr*Mt-De,xa=Dn*pr-We,Ka=Yn*(Xr*qr+Dn*sr*ur*Dr),Ya=Yn*(.5*yt*xr-Dn*2*pr*Mt),ei=Yn*.25*(xr*Mt-Dn*pr*Xr*yt),hi=Yn*(Dr*ur+Dn*qr*sr),ao=Ya*ei-hi*Ka;if(!ao)break;var ri=(xa*Ya-da*hi)/ao,Vi=(da*ei-xa*Ka)/ao;et-=ri,ot-=Vi}while((M(ri)>u||M(Vi)>u)&&--bt>0);return[et,ot]}};function Z(){return v.geoProjection(Y).scale(152.63)}function oe(De){var We=h(De),et=n(De),ot=De>=0?1:-1,bt=m(ot*De),yt=(1+We-et)/2;function Mt(ur,pr){var sr=n(pr),xr=n(ur/=2);return[(1+sr)*h(ur),(ot*pr>-a(xr,bt)-.001?0:-ot*10)+yt+h(pr)*et-(1+sr)*We*xr]}return Mt.invert=function(ur,pr){var sr=0,xr=0,Dr=50;do{var Xr=n(sr),qr=h(sr),bn=n(xr),Dn=h(xr),Yn=1+bn,da=Yn*qr-ur,xa=yt+Dn*et-Yn*We*Xr-pr,Ka=Yn*Xr/2,Ya=-qr*Dn,ei=We*Yn*qr/2,hi=et*bn+We*Xr*Dn,ao=Ya*ei-hi*Ka,ri=(xa*Ya-da*hi)/ao/2,Vi=(da*ei-xa*Ka)/ao;M(Vi)>2&&(Vi/=2),sr-=ri,xr-=Vi}while((M(ri)>u||M(Vi)>u)&&--Dr>0);return ot*xr>-a(n(sr),bt)-.001?[sr*2,xr]:null},Mt}function re(){var De=20*k,We=De>=0?1:-1,et=m(We*De),ot=v.geoProjectionMutator(oe),bt=ot(De),yt=bt.stream;return bt.parallel=function(Mt){return arguments.length?(et=m((We=(De=Mt*k)>=0?1:-1)*De),ot(De)):De*T},bt.stream=function(Mt){var ur=bt.rotate(),pr=yt(Mt),sr=(bt.rotate([0,0]),yt(Mt)),xr=bt.precision();return bt.rotate(ur),pr.sphere=function(){sr.polygonStart(),sr.lineStart();for(var Dr=We*-180;We*Dr<180;Dr+=We*90)sr.point(Dr,We*90);if(De)for(;We*(Dr-=3*We*xr)>=-180;)sr.point(Dr,We*-a(n(Dr*k/2),et)*T);sr.lineEnd(),sr.polygonEnd()},pr},bt.scale(218.695).center([0,28.0974])}function se(De,We){var et=m(We/2),ot=D(1-et*et),bt=1+ot*n(De/=2),yt=h(De)*ot/bt,Mt=et/bt,ur=yt*yt,pr=Mt*Mt;return[4/3*yt*(3+ur-3*pr),4/3*Mt*(3+3*ur-pr)]}se.invert=function(De,We){if(De*=3/8,We*=3/8,!De&&M(We)>1)return null;var et=De*De,ot=We*We,bt=1+et+ot,yt=D((bt-D(bt*bt-4*We*We))/2),Mt=z(yt)/3,ur=yt?G(M(We/yt))/3:H(M(De))/3,pr=n(Mt),sr=F(ur),xr=sr*sr-pr*pr;return[g(De)*2*a(B(ur)*pr,.25-xr),g(We)*2*a(sr*h(Mt),.25+xr)]};function N(){return v.geoProjection(se).scale(66.1603)}var U=D(8),q=c(1+x);function $(De,We){var et=M(We);return et<b?[De,c(m(b+We/2))]:[De*n(et)*(2*x-1/h(et)),g(We)*(2*x*(et-b)-c(m(et/2)))]}$.invert=function(De,We){if((yt=M(We))<q)return[De,2*e(r(We))-A];var et=b,ot=25,bt,yt;do{var Mt=n(et/2),ur=m(et/2);et-=bt=(U*(et-b)-c(ur)-yt)/(U-Mt*Mt/(2*ur))}while(M(bt)>_&&--ot>0);return[De/(n(et)*(U-1/h(et))),g(We)*et]};function W(){return v.geoProjection($).scale(112.314)}function K(De){var We=2*s/De;function et(ot,bt){var yt=v.geoAzimuthalEquidistantRaw(ot,bt);if(M(ot)>A){var Mt=a(yt[1],yt[0]),ur=D(yt[0]*yt[0]+yt[1]*yt[1]),pr=We*p((Mt-A)/We)+A,sr=a(h(Mt-=pr),2-n(Mt));Mt=pr+z(s/ur*h(sr))-sr,yt[0]=ur*n(Mt),yt[1]=ur*h(Mt)}return yt}return et.invert=function(ot,bt){var yt=D(ot*ot+bt*bt);if(yt>A){var Mt=a(bt,ot),ur=We*p((Mt-A)/We)+A,pr=Mt>ur?-1:1,sr=yt*n(ur-Mt),xr=1/m(pr*I((sr-s)/D(s*(s-2*sr)+yt*yt)));Mt=ur+2*e((xr+pr*D(xr*xr-3))/3),ot=yt*n(Mt),bt=yt*h(Mt)}return v.geoAzimuthalEquidistantRaw.invert(ot,bt)},et}function ne(){var De=5,We=v.geoProjectionMutator(K),et=We(De),ot=et.stream,bt=.01,yt=-n(bt*k),Mt=h(bt*k);return et.lobes=function(ur){return arguments.length?We(De=+ur):De},et.stream=function(ur){var pr=et.rotate(),sr=ot(ur),xr=(et.rotate([0,0]),ot(ur));return et.rotate(pr),sr.sphere=function(){xr.polygonStart(),xr.lineStart();for(var Dr=0,Xr=360/De,qr=2*s/De,bn=90-180/De,Dn=A;Dr<De;++Dr,bn-=Xr,Dn-=qr)xr.point(a(Mt*n(Dn),yt)*T,z(Mt*h(Dn))*T),bn<-90?(xr.point(-90,-180-bn-bt),xr.point(-90,-180-bn+bt)):(xr.point(90,bn+bt),xr.point(90,bn-bt));xr.lineEnd(),xr.polygonEnd()},sr},et.scale(87.8076).center([0,17.1875]).clipAngle(180-.001)}function ae(De,We){if(arguments.length<2&&(We=De),We===1)return v.geoAzimuthalEqualAreaRaw;if(We===1/0)return ie;function et(ot,bt){var yt=v.geoAzimuthalEqualAreaRaw(ot/We,bt);return yt[0]*=De,yt}return et.invert=function(ot,bt){var yt=v.geoAzimuthalEqualAreaRaw.invert(ot/De,bt);return yt[0]*=We,yt},et}function ie(De,We){return[De*n(We)/n(We/=2),2*h(We)]}ie.invert=function(De,We){var et=2*z(We/2);return[De*n(et/2)/n(et),et]};function le(){var De=2,We=v.geoProjectionMutator(ae),et=We(De);return et.coefficient=function(ot){return arguments.length?We(De=+ot):De},et.scale(169.529)}function ye(De,We,et){var ot=100,bt,yt,Mt;et=et===void 0?0:+et,We=+We;do yt=De(et),Mt=De(et+u),yt===Mt&&(Mt=yt+u),et-=bt=-1*u*(yt-We)/(yt-Mt);while(ot-- >0&&M(bt)>u);return ot<0?NaN:et}function ue(De,We,et){return We===void 0&&(We=40),et===void 0&&(et=_),function(ot,bt,yt,Mt){var ur,pr,sr;yt=yt===void 0?0:+yt,Mt=Mt===void 0?0:+Mt;for(var xr=0;xr<We;xr++){var Dr=De(yt,Mt),Xr=Dr[0]-ot,qr=Dr[1]-bt;if(M(Xr)<et&&M(qr)<et)break;var bn=Xr*Xr+qr*qr;if(bn>ur){yt-=pr/=2,Mt-=sr/=2;continue}ur=bn;var Dn=(yt>0?-1:1)*et,Yn=(Mt>0?-1:1)*et,da=De(yt+Dn,Mt),xa=De(yt,Mt+Yn),Ka=(da[0]-Dr[0])/Dn,Ya=(da[1]-Dr[1])/Dn,ei=(xa[0]-Dr[0])/Yn,hi=(xa[1]-Dr[1])/Yn,ao=hi*Ka-Ya*ei,ri=(M(ao)<.5?.5:1)/ao;if(pr=(qr*ei-Xr*hi)*ri,sr=(Xr*Ya-qr*Ka)*ri,yt+=pr,Mt+=sr,M(pr)<et&&M(sr)<et)break}return[yt,Mt]}}function pe(){var De=ae(1.68,2),We=1.4,et=12;function ot(bt,yt){if(bt+yt<-We){var Mt=(bt-yt+1.6)*(bt+yt+We)/8;bt+=Mt,yt-=.8*Mt*h(yt+s/2)}var ur=De(bt,yt),pr=(1-n(bt*yt))/et;return ur[1]<0&&(ur[0]*=1+pr),ur[1]>0&&(ur[1]*=1+pr/1.5*ur[0]*ur[0]),ur}return ot.invert=ue(ot),ot}function ge(){return v.geoProjection(pe()).rotate([-16.5,-42]).scale(176.57).center([7.93,.09])}function Te(De,We){var et=De*h(We),ot=30,bt;do We-=bt=(We+h(We)-et)/(1+n(We));while(M(bt)>u&&--ot>0);return We/2}function _e(De,We,et){function ot(bt,yt){return[De*bt*n(yt=Te(et,yt)),We*h(yt)]}return ot.invert=function(bt,yt){return yt=z(yt/We),[bt/(De*n(yt)),z((2*yt+h(2*yt))/et)]},ot}var ze=_e(x/A,x,s);function Oe(){return v.geoProjection(ze).scale(169.529)}var Ye=2.00276,be=1.11072;function Pe(De,We){var et=Te(s,We);return[Ye*De/(1/n(We)+be/n(et)),(We+x*h(et))/Ye]}Pe.invert=function(De,We){var et=Ye*We,ot=We<0?-b:b,bt=25,yt,Mt;do Mt=et-x*h(ot),ot-=yt=(h(2*ot)+2*ot-s*h(Mt))/(2*n(2*ot)+2+s*n(Mt)*x*n(ot));while(M(yt)>u&&--bt>0);return Mt=et-x*h(ot),[De*(1/n(Mt)+be/n(ot))/Ye,Mt]};function Ge(){return v.geoProjection(Pe).scale(160.857)}function Qe(De){var We=0,et=v.geoProjectionMutator(De),ot=et(We);return ot.parallel=function(bt){return arguments.length?et(We=bt*k):We*T},ot}function Be(De,We){return[De*n(We),We]}Be.invert=function(De,We){return[De/n(We),We]};function Le(){return v.geoProjection(Be).scale(152.63)}function He(De){if(!De)return Be;var We=1/m(De);function et(ot,bt){var yt=We+De-bt,Mt=yt&&ot*n(bt)/yt;return[yt*h(Mt),We-yt*n(Mt)]}return et.invert=function(ot,bt){var yt=D(ot*ot+(bt=We-bt)*bt),Mt=We+De-yt;return[yt/n(Mt)*a(ot,bt),Mt]},et}function vt(){return Qe(He).scale(123.082).center([0,26.1441]).parallel(45)}function Rt(De){function We(et,ot){var bt=A-ot,yt=bt&&et*De*h(bt)/bt;return[bt*h(yt)/De,A-bt*n(yt)]}return We.invert=function(et,ot){var bt=et*De,yt=A-ot,Mt=D(bt*bt+yt*yt),ur=a(bt,yt);return[(Mt?Mt/h(Mt):1)*ur/De,A-Mt]},We}function rr(){var De=.5,We=v.geoProjectionMutator(Rt),et=We(De);return et.fraction=function(ot){return arguments.length?We(De=+ot):De},et.scale(158.837)}var Lt=_e(1,4/s,s);function Ft(){return v.geoProjection(Lt).scale(152.63)}function Gt(De,We,et,ot,bt,yt){var Mt=n(yt),ur;if(M(De)>1||M(yt)>1)ur=I(et*bt+We*ot*Mt);else{var pr=h(De/2),sr=h(yt/2);ur=2*z(D(pr*pr+We*ot*sr*sr))}return M(ur)>u?[ur,a(ot*h(yt),We*bt-et*ot*Mt)]:[0,0]}function Dt(De,We,et){return I((De*De+We*We-et*et)/(2*De*We))}function kt(De){return De-2*s*t((De+s)/(2*s))}function Ue(De,We,et){for(var ot=[[De[0],De[1],h(De[1]),n(De[1])],[We[0],We[1],h(We[1]),n(We[1])],[et[0],et[1],h(et[1]),n(et[1])]],bt=ot[2],yt,Mt=0;Mt<3;++Mt,bt=yt)yt=ot[Mt],bt.v=Gt(yt[1]-bt[1],bt[3],bt[2],yt[3],yt[2],yt[0]-bt[0]),bt.point=[0,0];var ur=Dt(ot[0].v[0],ot[2].v[0],ot[1].v[0]),pr=Dt(ot[0].v[0],ot[1].v[0],ot[2].v[0]),sr=s-ur;ot[2].point[1]=0,ot[0].point[0]=-(ot[1].point[0]=ot[0].v[0]/2);var xr=[ot[2].point[0]=ot[0].point[0]+ot[2].v[0]*n(ur),2*(ot[0].point[1]=ot[1].point[1]=ot[2].v[0]*h(ur))];function Dr(Xr,qr){var bn=h(qr),Dn=n(qr),Yn=new Array(3),da;for(da=0;da<3;++da){var xa=ot[da];if(Yn[da]=Gt(qr-xa[1],xa[3],xa[2],Dn,bn,Xr-xa[0]),!Yn[da][0])return xa.point;Yn[da][1]=kt(Yn[da][1]-xa.v[1])}var Ka=xr.slice();for(da=0;da<3;++da){var Ya=da==2?0:da+1,ei=Dt(ot[da].v[0],Yn[da][0],Yn[Ya][0]);Yn[da][1]<0&&(ei=-ei),da?da==1?(ei=pr-ei,Ka[0]-=Yn[da][0]*n(ei),Ka[1]-=Yn[da][0]*h(ei)):(ei=sr-ei,Ka[0]+=Yn[da][0]*n(ei),Ka[1]+=Yn[da][0]*h(ei)):(Ka[0]+=Yn[da][0]*n(ei),Ka[1]-=Yn[da][0]*h(ei))}return Ka[0]/=3,Ka[1]/=3,Ka}return Dr}function qe(De){return De[0]*=k,De[1]*=k,De}function Ve(){return Ae([0,22],[45,22],[22.5,-22]).scale(380).center([22.5,2])}function Ae(De,We,et){var ot=v.geoCentroid({type:"MultiPoint",coordinates:[De,We,et]}),bt=[-ot[0],-ot[1]],yt=v.geoRotation(bt),Mt=Ue(qe(yt(De)),qe(yt(We)),qe(yt(et)));Mt.invert=ue(Mt);var ur=v.geoProjection(Mt).rotate(bt),pr=ur.center;return delete ur.rotate,ur.center=function(sr){return arguments.length?pr(yt(sr)):yt.invert(pr())},ur.clipAngle(90)}function Ne(De,We){var et=D(1-h(We));return[2/l*De*et,l*(1-et)]}Ne.invert=function(De,We){var et=(et=We/l-1)*et;return[et>0?De*D(s/et)/2:0,z(1-et)]};function Xe(){return v.geoProjection(Ne).scale(95.6464).center([0,30])}function Je(De){var We=m(De);function et(ot,bt){return[ot,(ot?ot/h(ot):1)*(h(bt)*n(ot)-We*n(bt))]}return et.invert=We?function(ot,bt){ot&&(bt*=h(ot)/ot);var yt=n(ot);return[ot,2*a(D(yt*yt+We*We-bt*bt)-yt,We-bt)]}:function(ot,bt){return[ot,z(ot?bt*m(ot)/ot:bt)]},et}function _t(){return Qe(Je).scale(249.828).clipAngle(90)}var mt=D(3);function Ot(De,We){return[mt*De*(2*n(2*We/3)-1)/l,mt*l*h(We/3)]}Ot.invert=function(De,We){var et=3*z(We/(mt*l));return[l*De/(mt*(2*n(2*et/3)-1)),et]};function Kt(){return v.geoProjection(Ot).scale(156.19)}function Nt(De){var We=n(De);function et(ot,bt){return[ot*We,h(bt)/We]}return et.invert=function(ot,bt){return[ot/We,z(bt*We)]},et}function Wt(){return Qe(Nt).parallel(38.58).scale(195.044)}function qt(De){var We=n(De);function et(ot,bt){return[ot*We,(1+We)*m(bt/2)]}return et.invert=function(ot,bt){return[ot/We,e(bt/(1+We))*2]},et}function Yt(){return Qe(qt).scale(124.75)}function fr(De,We){var et=D(8/(3*s));return[et*De*(1-M(We)/s),et*We]}fr.invert=function(De,We){var et=D(8/(3*s)),ot=We/et;return[De/(et*(1-M(ot)/s)),ot]};function Yr(){return v.geoProjection(fr).scale(165.664)}function hn(De,We){var et=D(4-3*h(M(We)));return[2/D(6*s)*De*et,g(We)*D(2*s/3)*(2-et)]}hn.invert=function(De,We){var et=2-M(We)/D(2*s/3);return[De*D(6*s)/(2*et),g(We)*z((4-et*et)/3)]};function Qr(){return v.geoProjection(hn).scale(165.664)}function at(De,We){var et=D(s*(4+s));return[2/et*De*(1+D(1-4*We*We/(s*s))),4/et*We]}at.invert=function(De,We){var et=D(s*(4+s))/2;return[De*et/(1+D(1-We*We*(4+s)/(4*s))),We*et/2]};function Jt(){return v.geoProjection(at).scale(180.739)}function Zt(De,We){var et=(2+A)*h(We);We/=2;for(var ot=0,bt=1/0;ot<10&&M(bt)>u;ot++){var yt=n(We);We-=bt=(We+h(We)*(yt+2)-et)/(2*yt*(1+yt))}return[2/D(s*(4+s))*De*(1+n(We)),2*D(s/(4+s))*h(We)]}Zt.invert=function(De,We){var et=We*D((4+s)/s)/2,ot=z(et),bt=n(ot);return[De/(2/D(s*(4+s))*(1+bt)),z((ot+et*(bt+2))/(2+A))]};function Ut(){return v.geoProjection(Zt).scale(180.739)}function _r(De,We){return[De*(1+n(We))/D(2+s),2*We/D(2+s)]}_r.invert=function(De,We){var et=D(2+s),ot=We*et/2;return[et*De/(1+n(ot)),ot]};function rt(){return v.geoProjection(_r).scale(173.044)}function Ke(De,We){for(var et=(1+A)*h(We),ot=0,bt=1/0;ot<10&&M(bt)>u;ot++)We-=bt=(We+h(We)-et)/(1+n(We));return et=D(2+s),[De*(1+n(We))/et,2*We/et]}Ke.invert=function(De,We){var et=1+A,ot=D(et/2);return[De*2*ot/(1+n(We*=ot)),z((We+h(We))/et)]};function st(){return v.geoProjection(Ke).scale(173.044)}var lt=3+2*x;function wt(De,We){var et=h(De/=2),ot=n(De),bt=D(n(We)),yt=n(We/=2),Mt=h(We)/(yt+x*ot*bt),ur=D(2/(1+Mt*Mt)),pr=D((x*yt+(ot+et)*bt)/(x*yt+(ot-et)*bt));return[lt*(ur*(pr-1/pr)-2*c(pr)),lt*(ur*Mt*(pr+1/pr)-2*e(Mt))]}wt.invert=function(De,We){if(!(yt=se.invert(De/1.2,We*1.065)))return null;var et=yt[0],ot=yt[1],bt=20,yt;De/=lt,We/=lt;do{var Mt=et/2,ur=ot/2,pr=h(Mt),sr=n(Mt),xr=h(ur),Dr=n(ur),Xr=n(ot),qr=D(Xr),bn=xr/(Dr+x*sr*qr),Dn=bn*bn,Yn=D(2/(1+Dn)),da=x*Dr+(sr+pr)*qr,xa=x*Dr+(sr-pr)*qr,Ka=da/xa,Ya=D(Ka),ei=Ya-1/Ya,hi=Ya+1/Ya,ao=Yn*ei-2*c(Ya)-De,ri=Yn*bn*hi-2*e(bn)-We,Vi=xr&&f*qr*pr*Dn/xr,uo=(x*sr*Dr+qr)/(2*(Dr+x*sr*qr)*(Dr+x*sr*qr)*qr),bo=-.5*bn*Yn*Yn*Yn,bi=bo*Vi,Mi=bo*uo,fs=(fs=2*Dr+x*qr*(sr-pr))*fs*Ya,po=(x*sr*Dr*qr+Xr)/fs,Lo=-(x*pr*xr)/(qr*fs),Vo=ei*bi-2*po/Ya+Yn*(po+po/Ka),fe=ei*Mi-2*Lo/Ya+Yn*(Lo+Lo/Ka),xe=bn*hi*bi-2*Vi/(1+Dn)+Yn*hi*Vi+Yn*bn*(po-po/Ka),Ee=bn*hi*Mi-2*uo/(1+Dn)+Yn*hi*uo+Yn*bn*(Lo-Lo/Ka),Fe=fe*xe-Ee*Vo;if(!Fe)break;var Ie=(ri*fe-ao*Ee)/Fe,je=(ao*xe-ri*Vo)/Fe;et-=Ie,ot=o(-A,i(A,ot-je))}while((M(Ie)>u||M(je)>u)&&--bt>0);return M(M(ot)-A)<u?[0,ot]:bt&&[et,ot]};function Pt(){return v.geoProjection(wt).scale(62.5271)}var ke=n(35*k);function Se(De,We){var et=m(We/2);return[De*ke*D(1-et*et),(1+ke)*et]}Se.invert=function(De,We){var et=We/(1+ke);return[De&&De/(ke*D(1-et*et)),2*e(et)]};function nt(){return v.geoProjection(Se).scale(137.152)}function it(De,We){var et=We/2,ot=n(et);return[2*De/l*n(We)*ot*ot,l*m(et)]}it.invert=function(De,We){var et=e(We/l),ot=n(et),bt=2*et;return[De*l/2/(n(bt)*ot*ot),bt]};function ct(){return v.geoProjection(it).scale(135.264)}function At(De){var We=1-De,et=yt(s,0)[0]-yt(-s,0)[0],ot=yt(0,A)[1]-yt(0,-A)[1],bt=D(2*ot/et);function yt(pr,sr){var xr=n(sr),Dr=h(sr);return[xr/(We+De*xr)*pr,We*sr+De*Dr]}function Mt(pr,sr){var xr=yt(pr,sr);return[xr[0]*bt,xr[1]/bt]}function ur(pr){return Mt(0,pr)[1]}return Mt.invert=function(pr,sr){var xr=ye(ur,sr),Dr=pr/bt*(De+We/n(xr));return[Dr,xr]},Mt}function dt(){var De=.5,We=v.geoProjectionMutator(At),et=We(De);return et.alpha=function(ot){return arguments.length?We(De=+ot):De},et.scale(168.725)}function Tt(De){return[De[0]/2,z(m(De[1]/2*k))*T]}function Ht(De){return[De[0]*2,2*e(h(De[1]*k))*T]}function ir(De){De==null&&(De=v.geoOrthographic);var We=De(),et=v.geoEquirectangular().scale(T).precision(0).clipAngle(null).translate([0,0]);function ot(yt){return We(Tt(yt))}We.invert&&(ot.invert=function(yt){return Ht(We.invert(yt))}),ot.stream=function(yt){var Mt=We.stream(yt),ur=et.stream({point:function(pr,sr){Mt.point(pr/2,z(m(-sr/2*k))*T)},lineStart:function(){Mt.lineStart()},lineEnd:function(){Mt.lineEnd()},polygonStart:function(){Mt.polygonStart()},polygonEnd:function(){Mt.polygonEnd()}});return ur.sphere=Mt.sphere,ur};function bt(yt){ot[yt]=function(){return arguments.length?(We[yt].apply(We,arguments),ot):We[yt]()}}return ot.rotate=function(yt){return arguments.length?(et.rotate(yt),ot):et.rotate()},ot.center=function(yt){return arguments.length?(We.center(Tt(yt)),ot):Ht(We.center())},bt("angle"),bt("clipAngle"),bt("clipExtent"),bt("fitExtent"),bt("fitHeight"),bt("fitSize"),bt("fitWidth"),bt("scale"),bt("translate"),bt("precision"),ot.scale(249.5)}function kr(De,We){var et=2*s/We,ot=De*De;function bt(yt,Mt){var ur=v.geoAzimuthalEquidistantRaw(yt,Mt),pr=ur[0],sr=ur[1],xr=pr*pr+sr*sr;if(xr>ot){var Dr=D(xr),Xr=a(sr,pr),qr=et*p(Xr/et),bn=Xr-qr,Dn=De*n(bn),Yn=(De*h(bn)-bn*h(Dn))/(A-Dn),da=br(bn,Yn),xa=(s-De)/Mr(da,Dn,s);pr=Dr;var Ka=50,Ya;do pr-=Ya=(De+Mr(da,Dn,pr)*xa-Dr)/(da(pr)*xa);while(M(Ya)>u&&--Ka>0);sr=bn*h(pr),pr<A&&(sr-=Yn*(pr-A));var ei=h(qr),hi=n(qr);ur[0]=pr*hi-sr*ei,ur[1]=pr*ei+sr*hi}return ur}return bt.invert=function(yt,Mt){var ur=yt*yt+Mt*Mt;if(ur>ot){var pr=D(ur),sr=a(Mt,yt),xr=et*p(sr/et),Dr=sr-xr;yt=pr*n(Dr),Mt=pr*h(Dr);for(var Xr=yt-A,qr=h(yt),bn=Mt/qr,Dn=yt<A?1/0:0,Yn=10;;){var da=De*h(bn),xa=De*n(bn),Ka=h(xa),Ya=A-xa,ei=(da-bn*Ka)/Ya,hi=br(bn,ei);if(M(Dn)<_||!--Yn)break;bn-=Dn=(bn*qr-ei*Xr-Mt)/(qr-Xr*2*(Ya*(xa+bn*da*n(xa)-Ka)-da*(da-bn*Ka))/(Ya*Ya))}pr=De+Mr(hi,xa,yt)*(s-De)/Mr(hi,xa,s),sr=xr+bn,yt=pr*n(sr),Mt=pr*h(sr)}return v.geoAzimuthalEquidistantRaw.invert(yt,Mt)},bt}function br(De,We){return function(et){var ot=De*n(et);return et<A&&(ot-=We),D(1+ot*ot)}}function Mr(De,We,et){for(var ot=50,bt=(et-We)/ot,yt=De(We)+De(et),Mt=1,ur=We;Mt<ot;++Mt)yt+=2*De(ur+=bt);return yt*.5*bt}function Hr(){var De=6,We=30*k,et=n(We),ot=h(We),bt=v.geoProjectionMutator(kr),yt=bt(We,De),Mt=yt.stream,ur=.01,pr=-n(ur*k),sr=h(ur*k);return yt.radius=function(xr){return arguments.length?(et=n(We=xr*k),ot=h(We),bt(We,De)):We*T},yt.lobes=function(xr){return arguments.length?bt(We,De=+xr):De},yt.stream=function(xr){var Dr=yt.rotate(),Xr=Mt(xr),qr=(yt.rotate([0,0]),Mt(xr));return yt.rotate(Dr),Xr.sphere=function(){qr.polygonStart(),qr.lineStart();for(var bn=0,Dn=2*s/De,Yn=0;bn<De;++bn,Yn-=Dn)qr.point(a(sr*n(Yn),pr)*T,z(sr*h(Yn))*T),qr.point(a(ot*n(Yn-Dn/2),et)*T,z(ot*h(Yn-Dn/2))*T);qr.lineEnd(),qr.polygonEnd()},Xr},yt.rotate([90,-40]).scale(91.7095).clipAngle(180-.001)}function nr(De,We,et,ot,bt,yt,Mt,ur){arguments.length<8&&(ur=0);function pr(sr,xr){if(!xr)return[De*sr/s,0];var Dr=xr*xr,Xr=De+Dr*(We+Dr*(et+Dr*ot)),qr=xr*(bt-1+Dr*(yt-ur+Dr*Mt)),bn=(Xr*Xr+qr*qr)/(2*qr),Dn=sr*z(Xr/bn)/s;return[bn*h(Dn),xr*(1+Dr*ur)+bn*(1-n(Dn))]}return pr.invert=function(sr,xr){var Dr=s*sr/De,Xr=xr,qr,bn,Dn=50;do{var Yn=Xr*Xr,da=De+Yn*(We+Yn*(et+Yn*ot)),xa=Xr*(bt-1+Yn*(yt-ur+Yn*Mt)),Ka=da*da+xa*xa,Ya=2*xa,ei=Ka/Ya,hi=ei*ei,ao=z(da/ei)/s,ri=Dr*ao,Vi=da*da,uo=(2*We+Yn*(4*et+Yn*6*ot))*Xr,bo=bt+Yn*(3*yt+Yn*5*Mt),bi=2*(da*uo+xa*(bo-1)),Mi=2*(bo-1),fs=(bi*Ya-Ka*Mi)/(Ya*Ya),po=n(ri),Lo=h(ri),Vo=ei*po,fe=ei*Lo,xe=Dr/s*(1/D(1-Vi/hi))*(uo*ei-da*fs)/hi,Ee=fe-sr,Fe=Xr*(1+Yn*ur)+ei-Vo-xr,Ie=fs*Lo+Vo*xe,je=Vo*ao,xt=1+fs-(fs*po-fe*xe),ht=fe*ao,Ct=Ie*ht-xt*je;if(!Ct)break;Dr-=qr=(Fe*Ie-Ee*xt)/Ct,Xr-=bn=(Ee*ht-Fe*je)/Ct}while((M(qr)>u||M(bn)>u)&&--Dn>0);return[Dr,Xr]},pr}var mr=nr(2.8284,-1.6988,.75432,-.18071,1.76003,-.38914,.042555);function Pr(){return v.geoProjection(mr).scale(149.995)}var Nr=nr(2.583819,-.835827,.170354,-.038094,1.543313,-.411435,.082742);function Sr(){return v.geoProjection(Nr).scale(153.93)}var tt=nr(5/6*s,-.62636,-.0344,0,1.3493,-.05524,0,.045);function Et(){return v.geoProjection(tt).scale(130.945)}function Vt(De,We){var et=De*De,ot=We*We;return[De*(1-.162388*ot)*(.87-952426e-9*et*et),We*(1+ot/12)]}Vt.invert=function(De,We){var et=De,ot=We,bt=50,yt;do{var Mt=ot*ot;ot-=yt=(ot*(1+Mt/12)-We)/(1+Mt/4)}while(M(yt)>u&&--bt>0);bt=50,De/=1-.162388*Mt;do{var ur=(ur=et*et)*ur;et-=yt=(et*(.87-952426e-9*ur)-De)/(.87-.00476213*ur)}while(M(yt)>u&&--bt>0);return[et,ot]};function ar(){return v.geoProjection(Vt).scale(131.747)}var Cr=nr(2.6516,-.76534,.19123,-.047094,1.36289,-.13965,.031762);function Or(){return v.geoProjection(Cr).scale(131.087)}function Ir(De){var We=De(A,0)[0]-De(-A,0)[0];function et(ot,bt){var yt=ot>0?-.5:.5,Mt=De(ot+yt*s,bt);return Mt[0]-=yt*We,Mt}return De.invert&&(et.invert=function(ot,bt){var yt=ot>0?-.5:.5,Mt=De.invert(ot+yt*We,bt),ur=Mt[0]-yt*s;return ur<-s?ur+=2*s:ur>s&&(ur-=2*s),Mt[0]=ur,Mt}),et}function Tr(De,We){var et=g(De),ot=g(We),bt=n(We),yt=n(De)*bt,Mt=h(De)*bt,ur=h(ot*We);De=M(a(Mt,ur)),We=z(yt),M(De-A)>u&&(De%=A);var pr=Wr(De>s/4?A-De:De,We);return De>s/4&&(ur=pr[0],pr[0]=-pr[1],pr[1]=-ur),pr[0]*=et,pr[1]*=-ot,pr}Tr.invert=function(De,We){M(De)>1&&(De=g(De)*2-De),M(We)>1&&(We=g(We)*2-We);var et=g(De),ot=g(We),bt=-et*De,yt=-ot*We,Mt=yt/bt<1,ur=wn(Mt?yt:bt,Mt?bt:yt),pr=ur[0],sr=ur[1],xr=n(sr);return Mt&&(pr=-A-pr),[et*(a(h(pr)*xr,-h(sr))+s),ot*z(n(pr)*xr)]};function Wr(De,We){if(We===A)return[0,0];var et=h(We),ot=et*et,bt=ot*ot,yt=1+bt,Mt=1+3*bt,ur=1-bt,pr=z(1/D(yt)),sr=ur+ot*yt*pr,xr=(1-et)/sr,Dr=D(xr),Xr=xr*yt,qr=D(Xr),bn=Dr*ur,Dn,Yn;if(De===0)return[0,-(bn+ot*qr)];var da=n(We),xa=1/da,Ka=2*et*da,Ya=(-3*ot+pr*Mt)*Ka,ei=(-sr*da-(1-et)*Ya)/(sr*sr),hi=.5*ei/Dr,ao=ur*hi-2*ot*Dr*Ka,ri=ot*yt*ei+xr*Mt*Ka,Vi=-xa*Ka,uo=-xa*ri,bo=-2*xa*ao,bi=4*De/s,Mi;if(De>.222*s||We<s/4&&De>.175*s){if(Dn=(bn+ot*D(Xr*(1+bt)-bn*bn))/(1+bt),De>s/4)return[Dn,Dn];var fs=Dn,po=.5*Dn;Dn=.5*(po+fs),Yn=50;do{var Lo=D(Xr-Dn*Dn),Vo=Dn*(bo+Vi*Lo)+uo*z(Dn/qr)-bi;if(!Vo)break;Vo<0?po=Dn:fs=Dn,Dn=.5*(po+fs)}while(M(fs-po)>u&&--Yn>0)}else{Dn=u,Yn=25;do{var fe=Dn*Dn,xe=D(Xr-fe),Ee=bo+Vi*xe,Fe=Dn*Ee+uo*z(Dn/qr)-bi,Ie=Ee+(uo-Vi*fe)/xe;Dn-=Mi=xe?Fe/Ie:0}while(M(Mi)>u&&--Yn>0)}return[Dn,-bn-ot*D(Xr-Dn*Dn)]}function wn(De,We){for(var et=0,ot=1,bt=.5,yt=50;;){var Mt=bt*bt,ur=D(bt),pr=z(1/D(1+Mt)),sr=1-Mt+bt*(1+Mt)*pr,xr=(1-ur)/sr,Dr=D(xr),Xr=xr*(1+Mt),qr=Dr*(1-Mt),bn=Xr-De*De,Dn=D(bn),Yn=We+qr+bt*Dn;if(M(ot-et)<_||--yt===0||Yn===0)break;Yn>0?et=bt:ot=bt,bt=.5*(et+ot)}if(!yt)return null;var da=z(ur),xa=n(da),Ka=1/xa,Ya=2*ur*xa,ei=(-3*bt+pr*(1+3*Mt))*Ya,hi=(-sr*xa-(1-ur)*ei)/(sr*sr),ao=.5*hi/Dr,ri=(1-Mt)*ao-2*bt*Dr*Ya,Vi=-2*Ka*ri,uo=-Ka*Ya,bo=-Ka*(bt*(1+Mt)*hi+xr*(1+3*Mt)*Ya);return[s/4*(De*(Vi+uo*Dn)+bo*z(De/D(Xr))),da]}function ln(){return v.geoProjection(Ir(Tr)).scale(239.75)}function Bn(De,We,et){var ot,bt,yt;return De?(ot=Cn(De,et),We?(bt=Cn(We,1-et),yt=bt[1]*bt[1]+et*ot[0]*ot[0]*bt[0]*bt[0],[[ot[0]*bt[2]/yt,ot[1]*ot[2]*bt[0]*bt[1]/yt],[ot[1]*bt[1]/yt,-ot[0]*ot[2]*bt[0]*bt[2]/yt],[ot[2]*bt[1]*bt[2]/yt,-et*ot[0]*ot[1]*bt[0]/yt]]):[[ot[0],0],[ot[1],0],[ot[2],0]]):(bt=Cn(We,1-et),[[0,bt[0]/bt[1]],[1/bt[1],0],[bt[2]/bt[1],0]])}function Cn(De,We){var et,ot,bt,yt,Mt;if(We<u)return yt=h(De),ot=n(De),et=We*(De-yt*ot)/4,[yt-et*ot,ot+et*yt,1-We*yt*yt/2,De-et];if(We>=1-u)return et=(1-We)/4,ot=F(De),yt=R(De),bt=1/ot,Mt=ot*B(De),[yt+et*(Mt-De)/(ot*ot),bt-et*yt*bt*(Mt-De),bt+et*yt*bt*(Mt+De),2*e(r(De))-A+et*(Mt-De)/ot];var ur=[1,0,0,0,0,0,0,0,0],pr=[D(We),0,0,0,0,0,0,0,0],sr=0;for(ot=D(1-We),Mt=1;M(pr[sr]/ur[sr])>u&&sr<8;)et=ur[sr++],pr[sr]=(et-ot)/2,ur[sr]=(et+ot)/2,ot=D(et*ot),Mt*=2;bt=Mt*ur[sr]*De;do yt=pr[sr]*h(ot=bt)/ur[sr],bt=(z(yt)+bt)/2;while(--sr);return[h(bt),yt=n(bt),yt/n(bt-ot),bt]}function Wn(De,We,et){var ot=M(De),bt=M(We),yt=B(bt);if(ot){var Mt=1/h(ot),ur=1/(m(ot)*m(ot)),pr=-(ur+et*(yt*yt*Mt*Mt)-1+et),sr=(et-1)*ur,xr=(-pr+D(pr*pr-4*sr))/2;return[Hn(e(1/D(xr)),et)*g(De),Hn(e(D((xr/ur-1)/et)),1-et)*g(We)]}return[0,Hn(e(yt),1-et)*g(We)]}function Hn(De,We){if(!We)return De;if(We===1)return c(m(De/2+b));for(var et=1,ot=D(1-We),bt=D(We),yt=0;M(bt)>u;yt++){if(De%s){var Mt=e(ot*m(De)/et);Mt<0&&(Mt+=s),De+=Mt+~~(De/s)*s}else De+=De;bt=(et+ot)/2,ot=D(et*ot),bt=((et=bt)-ot)/2}return De/(y(2,yt)*et)}function ga(De,We){var et=(x-1)/(x+1),ot=D(1-et*et),bt=Hn(A,ot*ot),yt=-1,Mt=c(m(s/4+M(We)/2)),ur=r(yt*Mt)/D(et),pr=La(ur*n(yt*De),ur*h(yt*De)),sr=Wn(pr[0],pr[1],ot*ot);return[-sr[1],(We>=0?1:-1)*(.5*bt-sr[0])]}function La(De,We){var et=De*De,ot=We+1,bt=1-et-We*We;return[.5*((De>=0?A:-A)-a(bt,2*De)),-.25*c(bt*bt+4*et)+.5*c(ot*ot+et)]}function ci(De,We){var et=We[0]*We[0]+We[1]*We[1];return[(De[0]*We[0]+De[1]*We[1])/et,(De[1]*We[0]-De[0]*We[1])/et]}ga.invert=function(De,We){var et=(x-1)/(x+1),ot=D(1-et*et),bt=Hn(A,ot*ot),yt=-1,Mt=Bn(.5*bt-We,-De,ot*ot),ur=ci(Mt[0],Mt[1]),pr=a(ur[1],ur[0])/yt;return[pr,2*e(r(.5/yt*c(et*ur[0]*ur[0]+et*ur[1]*ur[1])))-A]};function Va(){return v.geoProjection(Ir(ga)).scale(151.496)}function ja(De){var We=h(De),et=n(De),ot=Wa(De);ot.invert=Wa(-De);function bt(yt,Mt){var ur=ot(yt,Mt);yt=ur[0],Mt=ur[1];var pr=h(Mt),sr=n(Mt),xr=n(yt),Dr=I(We*pr+et*sr*xr),Xr=h(Dr),qr=M(Xr)>u?Dr/Xr:1;return[qr*et*h(yt),(M(yt)>A?qr:-qr)*(We*sr-et*pr*xr)]}return bt.invert=function(yt,Mt){var ur=D(yt*yt+Mt*Mt),pr=-h(ur),sr=n(ur),xr=ur*sr,Dr=-Mt*pr,Xr=ur*We,qr=D(xr*xr+Dr*Dr-Xr*Xr),bn=a(xr*Xr+Dr*qr,Dr*Xr-xr*qr),Dn=(ur>A?-1:1)*a(yt*pr,ur*n(bn)*sr+Mt*h(bn)*pr);return ot.invert(Dn,bn)},bt}function Wa(De){var We=h(De),et=n(De);return function(ot,bt){var yt=n(bt),Mt=n(ot)*yt,ur=h(ot)*yt,pr=h(bt);return[a(ur,Mt*et-pr*We),z(pr*et+Mt*We)]}}function wr(){var De=0,We=v.geoProjectionMutator(ja),et=We(De),ot=et.rotate,bt=et.stream,yt=v.geoCircle();return et.parallel=function(Mt){if(!arguments.length)return De*T;var ur=et.rotate();return We(De=Mt*k).rotate(ur)},et.rotate=function(Mt){return arguments.length?(ot.call(et,[Mt[0],Mt[1]-De*T]),yt.center([-Mt[0],-Mt[1]]),et):(Mt=ot.call(et),Mt[1]+=De*T,Mt)},et.stream=function(Mt){return Mt=bt(Mt),Mt.sphere=function(){Mt.polygonStart();var ur=.01,pr=yt.radius(90-ur)().coordinates[0],sr=pr.length-1,xr=-1,Dr;for(Mt.lineStart();++xr<sr;)Mt.point((Dr=pr[xr])[0],Dr[1]);for(Mt.lineEnd(),pr=yt.radius(90+ur)().coordinates[0],sr=pr.length-1,Mt.lineStart();--xr>=0;)Mt.point((Dr=pr[xr])[0],Dr[1]);Mt.lineEnd(),Mt.polygonEnd()},Mt},et.scale(79.4187).parallel(45).clipAngle(180-.001)}var pn=3,fn=z(1-1/pn)*T,An=Nt(0);function Zn(De){var We=fn*k,et=Ne(s,We)[0]-Ne(-s,We)[0],ot=An(0,We)[1],bt=Ne(0,We)[1],yt=l-bt,Mt=L/De,ur=4/L,pr=ot+yt*yt*4/L;function sr(xr,Dr){var Xr,qr=M(Dr);if(qr>We){var bn=i(De-1,o(0,t((xr+s)/Mt)));xr+=s*(De-1)/De-bn*Mt,Xr=Ne(xr,qr),Xr[0]=Xr[0]*L/et-L*(De-1)/(2*De)+bn*L/De,Xr[1]=ot+(Xr[1]-bt)*4*yt/L,Dr<0&&(Xr[1]=-Xr[1])}else Xr=An(xr,Dr);return Xr[0]*=ur,Xr[1]/=pr,Xr}return sr.invert=function(xr,Dr){xr/=ur,Dr*=pr;var Xr=M(Dr);if(Xr>ot){var qr=i(De-1,o(0,t((xr+s)/Mt)));xr=(xr+s*(De-1)/De-qr*Mt)*et/L;var bn=Ne.invert(xr,.25*(Xr-ot)*L/yt+bt);return bn[0]-=s*(De-1)/De-qr*Mt,Dr<0&&(bn[1]=-bn[1]),bn}return An.invert(xr,Dr)},sr}function ua(De,We){return[De,We&1?90-u:fn]}function ea(De,We){return[De,We&1?-90+u:-fn]}function Rn(De){return[De[0]*(1-u),De[1]]}function Xn(De){var We=[].concat(S.range(-180,180+De/2,De).map(ua),S.range(180,-180-De/2,-De).map(ea));return{type:"Polygon",coordinates:[De===180?We.map(Rn):We]}}function Ua(){var De=4,We=v.geoProjectionMutator(Zn),et=We(De),ot=et.stream;return et.lobes=function(bt){return arguments.length?We(De=+bt):De},et.stream=function(bt){var yt=et.rotate(),Mt=ot(bt),ur=(et.rotate([0,0]),ot(bt));return et.rotate(yt),Mt.sphere=function(){v.geoStream(Xn(180/De),ur)},Mt},et.scale(239.75)}function li(De){var We=1+De,et=h(1/We),ot=z(et),bt=2*D(s/(yt=s+4*ot*We)),yt,Mt=.5*bt*(We+D(De*(2+De))),ur=De*De,pr=We*We;function sr(xr,Dr){var Xr=1-h(Dr),qr,bn;if(Xr&&Xr<2){var Dn=A-Dr,Yn=25,da;do{var xa=h(Dn),Ka=n(Dn),Ya=ot+a(xa,We-Ka),ei=1+pr-2*We*Ka;Dn-=da=(Dn-ur*ot-We*xa+ei*Ya-.5*Xr*yt)/(2*We*xa*Ya)}while(M(da)>_&&--Yn>0);qr=bt*D(ei),bn=xr*Ya/s}else qr=bt*(De+Xr),bn=xr*ot/s;return[qr*h(bn),Mt-qr*n(bn)]}return sr.invert=function(xr,Dr){var Xr=xr*xr+(Dr-=Mt)*Dr,qr=(1+pr-Xr/(bt*bt))/(2*We),bn=I(qr),Dn=h(bn),Yn=ot+a(Dn,We-qr);return[z(xr/D(Xr))*s/Yn,z(1-2*(bn-ur*ot-We*Dn+(1+pr-2*We*qr)*Yn)/yt)]},sr}function Bt(){var De=1,We=v.geoProjectionMutator(li),et=We(De);return et.ratio=function(ot){return arguments.length?We(De=+ot):De},et.scale(167.774).center([0,18.67])}var hr=.7109889596207567,rn=.0528035274542;function vn(De,We){return We>-hr?(De=ze(De,We),De[1]+=rn,De):Be(De,We)}vn.invert=function(De,We){return We>-hr?ze.invert(De,We-rn):Be.invert(De,We)};function en(){return v.geoProjection(vn).rotate([-20,-55]).scale(164.263).center([0,-5.4036])}function Tn(De,We){return M(We)>hr?(De=ze(De,We),De[1]-=We>0?rn:-rn,De):Be(De,We)}Tn.invert=function(De,We){return M(We)>hr?ze.invert(De,We+(We>0?rn:-rn)):Be.invert(De,We)};function xn(){return v.geoProjection(Tn).scale(152.63)}function un(De,We,et,ot){var bt=D(4*s/(2*et+(1+De-We/2)*h(2*et)+(De+We)/2*h(4*et)+We/2*h(6*et))),yt=D(ot*h(et)*D((1+De*n(2*et)+We*n(4*et))/(1+De+We))),Mt=et*pr(1);function ur(Dr){return D(1+De*n(2*Dr)+We*n(4*Dr))}function pr(Dr){var Xr=Dr*et;return(2*Xr+(1+De-We/2)*h(2*Xr)+(De+We)/2*h(4*Xr)+We/2*h(6*Xr))/et}function sr(Dr){return ur(Dr)*h(Dr)}var xr=function(Dr,Xr){var qr=et*ye(pr,Mt*h(Xr)/et,Xr/s);isNaN(qr)&&(qr=et*g(Xr));var bn=bt*ur(qr);return[bn*yt*Dr/s*n(qr),bn/yt*h(qr)]};return xr.invert=function(Dr,Xr){var qr=ye(sr,Xr*yt/bt);return[Dr*s/(n(qr)*bt*yt*ur(qr)),z(et*pr(qr/et)/Mt)]},et===0&&(bt=D(ot/s),xr=function(Dr,Xr){return[Dr*bt,h(Xr)/bt]},xr.invert=function(Dr,Xr){return[Dr/bt,z(Xr*bt)]}),xr}function gr(){var De=1,We=0,et=45*k,ot=2,bt=v.geoProjectionMutator(un),yt=bt(De,We,et,ot);return yt.a=function(Mt){return arguments.length?bt(De=+Mt,We,et,ot):De},yt.b=function(Mt){return arguments.length?bt(De,We=+Mt,et,ot):We},yt.psiMax=function(Mt){return arguments.length?bt(De,We,et=+Mt*k,ot):et*T},yt.ratio=function(Mt){return arguments.length?bt(De,We,et,ot=+Mt):ot},yt.scale(180.739)}function yr(De,We,et,ot,bt,yt,Mt,ur,pr,sr,xr){if(xr.nanEncountered)return NaN;var Dr,Xr,qr,bn,Dn,Yn,da,xa,Ka,Ya;if(Dr=et-We,Xr=De(We+Dr*.25),qr=De(et-Dr*.25),isNaN(Xr)){xr.nanEncountered=!0;return}if(isNaN(qr)){xr.nanEncountered=!0;return}return bn=Dr*(ot+4*Xr+bt)/12,Dn=Dr*(bt+4*qr+yt)/12,Yn=bn+Dn,Ya=(Yn-Mt)/15,sr>pr?(xr.maxDepthCount++,Yn+Ya):Math.abs(Ya)<ur?Yn+Ya:(da=We+Dr*.5,xa=yr(De,We,da,ot,Xr,bt,bn,ur*.5,pr,sr+1,xr),isNaN(xa)?(xr.nanEncountered=!0,NaN):(Ka=yr(De,da,et,bt,qr,yt,Dn,ur*.5,pr,sr+1,xr),isNaN(Ka)?(xr.nanEncountered=!0,NaN):xa+Ka))}function zr(De,We,et,ot,bt){var yt={maxDepthCount:0,nanEncountered:!1};ot===void 0&&(ot=1e-8),bt===void 0&&(bt=20);var Mt=De(We),ur=De(.5*(We+et)),pr=De(et),sr=(Mt+4*ur+pr)*(et-We)/6,xr=yr(De,We,et,Mt,ur,pr,sr,ot,bt,1,yt);return xr}function gn(De,We,et){function ot(qr){return De+(1-De)*y(1-y(qr,We),1/We)}function bt(qr){return zr(ot,0,qr,1e-4)}for(var yt=1/bt(1),Mt=1e3,ur=(1+1e-8)*yt,pr=[],sr=0;sr<=Mt;sr++)pr.push(bt(sr/Mt)*ur);function xr(qr){var bn=0,Dn=Mt,Yn=Mt>>1;do pr[Yn]>qr?Dn=Yn:bn=Yn,Yn=bn+Dn>>1;while(Yn>bn);var da=pr[Yn+1]-pr[Yn];return da&&(da=(qr-pr[Yn+1])/da),(Yn+1+da)/Mt}var Dr=2*xr(1)/s*yt/et,Xr=function(qr,bn){var Dn=xr(M(h(bn))),Yn=ot(Dn)*qr;return Dn/=Dr,[Yn,bn>=0?Dn:-Dn]};return Xr.invert=function(qr,bn){var Dn;return bn*=Dr,M(bn)<1&&(Dn=g(bn)*z(bt(M(bn))*yt)),[qr/ot(M(bn)),Dn]},Xr}function On(){var De=0,We=2.5,et=1.183136,ot=v.geoProjectionMutator(gn),bt=ot(De,We,et);return bt.alpha=function(yt){return arguments.length?ot(De=+yt,We,et):De},bt.k=function(yt){return arguments.length?ot(De,We=+yt,et):We},bt.gamma=function(yt){return arguments.length?ot(De,We,et=+yt):et},bt.scale(152.63)}function ta(De,We){return M(De[0]-We[0])<u&&M(De[1]-We[1])<u}function _n(De,We){for(var et=-1,ot=De.length,bt=De[0],yt,Mt,ur,pr=[];++et<ot;){yt=De[et],Mt=(yt[0]-bt[0])/We,ur=(yt[1]-bt[1])/We;for(var sr=0;sr<We;++sr)pr.push([bt[0]+sr*Mt,bt[1]+sr*ur]);bt=yt}return pr.push(yt),pr}function jn(De){var We=[],et,ot,bt,yt,Mt,ur,pr,sr=De[0].length;for(pr=0;pr<sr;++pr)et=De[0][pr],ot=et[0][0],bt=et[0][1],yt=et[1][1],Mt=et[2][0],ur=et[2][1],We.push(_n([[ot+u,bt+u],[ot+u,yt-u],[Mt-u,yt-u],[Mt-u,ur+u]],30));for(pr=De[1].length-1;pr>=0;--pr)et=De[1][pr],ot=et[0][0],bt=et[0][1],yt=et[1][1],Mt=et[2][0],ur=et[2][1],We.push(_n([[Mt-u,ur-u],[Mt-u,yt+u],[ot+u,yt+u],[ot+u,bt-u]],30));return{type:"Polygon",coordinates:[S.merge(We)]}}function aa(De,We,et){var ot,bt;function yt(pr,sr){for(var xr=sr<0?-1:1,Dr=We[+(sr<0)],Xr=0,qr=Dr.length-1;Xr<qr&&pr>Dr[Xr][2][0];++Xr);var bn=De(pr-Dr[Xr][1][0],sr);return bn[0]+=De(Dr[Xr][1][0],xr*sr>xr*Dr[Xr][0][1]?Dr[Xr][0][1]:sr)[0],bn}et?yt.invert=et(yt):De.invert&&(yt.invert=function(pr,sr){for(var xr=bt[+(sr<0)],Dr=We[+(sr<0)],Xr=0,qr=xr.length;Xr<qr;++Xr){var bn=xr[Xr];if(bn[0][0]<=pr&&pr<bn[1][0]&&bn[0][1]<=sr&&sr<bn[1][1]){var Dn=De.invert(pr-De(Dr[Xr][1][0],0)[0],sr);return Dn[0]+=Dr[Xr][1][0],ta(yt(Dn[0],Dn[1]),[pr,sr])?Dn:null}}});var Mt=v.geoProjection(yt),ur=Mt.stream;return Mt.stream=function(pr){var sr=Mt.rotate(),xr=ur(pr),Dr=(Mt.rotate([0,0]),ur(pr));return Mt.rotate(sr),xr.sphere=function(){v.geoStream(ot,Dr)},xr},Mt.lobes=function(pr){return arguments.length?(ot=jn(pr),We=pr.map(function(sr){return sr.map(function(xr){return[[xr[0][0]*k,xr[0][1]*k],[xr[1][0]*k,xr[1][1]*k],[xr[2][0]*k,xr[2][1]*k]]})}),bt=We.map(function(sr){return sr.map(function(xr){var Dr=De(xr[0][0],xr[0][1])[0],Xr=De(xr[2][0],xr[2][1])[0],qr=De(xr[1][0],xr[0][1])[1],bn=De(xr[1][0],xr[1][1])[1],Dn;return qr>bn&&(Dn=qr,qr=bn,bn=Dn),[[Dr,qr],[Xr,bn]]})}),Mt):We.map(function(sr){return sr.map(function(xr){return[[xr[0][0]*T,xr[0][1]*T],[xr[1][0]*T,xr[1][1]*T],[xr[2][0]*T,xr[2][1]*T]]})})},We!=null&&Mt.lobes(We),Mt}var pa=[[[[-180,0],[-100,90],[-40,0]],[[-40,0],[30,90],[180,0]]],[[[-180,0],[-160,-90],[-100,0]],[[-100,0],[-60,-90],[-20,0]],[[-20,0],[20,-90],[80,0]],[[80,0],[140,-90],[180,0]]]];function ma(){return aa(Pe,pa).scale(160.857)}var sa=[[[[-180,0],[-100,90],[-40,0]],[[-40,0],[30,90],[180,0]]],[[[-180,0],[-160,-90],[-100,0]],[[-100,0],[-60,-90],[-20,0]],[[-20,0],[20,-90],[80,0]],[[80,0],[140,-90],[180,0]]]];function Aa(){return aa(Tn,sa).scale(152.63)}var ho=[[[[-180,0],[-100,90],[-40,0]],[[-40,0],[30,90],[180,0]]],[[[-180,0],[-160,-90],[-100,0]],[[-100,0],[-60,-90],[-20,0]],[[-20,0],[20,-90],[80,0]],[[80,0],[140,-90],[180,0]]]];function Ro(){return aa(ze,ho).scale(169.529)}var jo=[[[[-180,0],[-90,90],[0,0]],[[0,0],[90,90],[180,0]]],[[[-180,0],[-90,-90],[0,0]],[[0,0],[90,-90],[180,0]]]];function rl(){return aa(ze,jo).scale(169.529).rotate([20,0])}var vl=[[[[-180,35],[-30,90],[0,35]],[[0,35],[30,90],[180,35]]],[[[-180,-10],[-102,-90],[-65,-10]],[[-65,-10],[5,-90],[77,-10]],[[77,-10],[103,-90],[180,-10]]]];function Gl(){return aa(vn,vl,ue).rotate([-20,-55]).scale(164.263).center([0,-5.4036])}var vi=[[[[-180,0],[-110,90],[-40,0]],[[-40,0],[0,90],[40,0]],[[40,0],[110,90],[180,0]]],[[[-180,0],[-110,-90],[-40,0]],[[-40,0],[0,-90],[40,0]],[[40,0],[110,-90],[180,0]]]];function Vs(){return aa(Be,vi).scale(152.63).rotate([-20,0])}function Ds(De,We){return[3/L*De*D(s*s/3-We*We),We]}Ds.invert=function(De,We){return[L/3*De/D(s*s/3-We*We),We]};function Ui(){return v.geoProjection(Ds).scale(158.837)}function Ao(De){function We(et,ot){if(M(M(ot)-A)<u)return[0,ot<0?-2:2];var bt=h(ot),yt=y((1+bt)/(1-bt),De/2),Mt=.5*(yt+1/yt)+n(et*=De);return[2*h(et)/Mt,(yt-1/yt)/Mt]}return We.invert=function(et,ot){var bt=M(ot);if(M(bt-2)<u)return et?null:[0,g(ot)*A];if(bt>2)return null;et/=2,ot/=2;var yt=et*et,Mt=ot*ot,ur=2*ot/(1+yt+Mt);return ur=y((1+ur)/(1-ur),1/De),[a(2*et,1-yt-Mt)/De,z((ur-1)/(ur+1))]},We}function pl(){var De=.5,We=v.geoProjectionMutator(Ao),et=We(De);return et.spacing=function(ot){return arguments.length?We(De=+ot):De},et.scale(124.75)}var vs=s/x;function Di(De,We){return[De*(1+D(n(We)))/2,We/(n(We/2)*n(De/6))]}Di.invert=function(De,We){var et=M(De),ot=M(We),bt=u,yt=A;ot<vs?yt*=ot/vs:bt+=6*I(vs/ot);for(var Mt=0;Mt<25;Mt++){var ur=h(yt),pr=D(n(yt)),sr=h(yt/2),xr=n(yt/2),Dr=h(bt/6),Xr=n(bt/6),qr=.5*bt*(1+pr)-et,bn=yt/(xr*Xr)-ot,Dn=pr?-.25*bt*ur/pr:0,Yn=.5*(1+pr),da=(1+.5*yt*sr/xr)/(xr*Xr),xa=yt/xr*(Dr/6)/(Xr*Xr),Ka=Dn*xa-da*Yn,Ya=(qr*xa-bn*Yn)/Ka,ei=(bn*Dn-qr*da)/Ka;if(yt-=Ya,bt-=ei,M(Ya)<u&&M(ei)<u)break}return[De<0?-bt:bt,We<0?-yt:yt]};function nl(){return v.geoProjection(Di).scale(97.2672)}function Ki(De,We){var et=De*De,ot=We*We;return[De*(.975534+ot*(-.119161+et*-.0143059+ot*-.0547009)),We*(1.00384+et*(.0802894+ot*-.02855+et*199025e-9)+ot*(.0998909+ot*-.0491032))]}Ki.invert=function(De,We){var et=g(De)*s,ot=We/2,bt=50;do{var yt=et*et,Mt=ot*ot,ur=et*ot,pr=et*(.975534+Mt*(-.119161+yt*-.0143059+Mt*-.0547009))-De,sr=ot*(1.00384+yt*(.0802894+Mt*-.02855+yt*199025e-9)+Mt*(.0998909+Mt*-.0491032))-We,xr=.975534-Mt*(.119161+3*yt*.0143059+Mt*.0547009),Dr=-ur*(2*.119161+4*.0547009*Mt+2*.0143059*yt),Xr=ur*(2*.0802894+4*199025e-9*yt+2*-.02855*Mt),qr=1.00384+yt*(.0802894+199025e-9*yt)+Mt*(3*(.0998909-.02855*yt)-5*.0491032*Mt),bn=Dr*Xr-qr*xr,Dn=(sr*Dr-pr*qr)/bn,Yn=(pr*Xr-sr*xr)/bn;et-=Dn,ot-=Yn}while((M(Dn)>u||M(Yn)>u)&&--bt>0);return bt&&[et,ot]};function Fi(){return v.geoProjection(Ki).scale(139.98)}function no(De,We){return[h(De)/n(We),m(We)*n(De)]}no.invert=function(De,We){var et=De*De,ot=We*We,bt=ot+1,yt=et+bt,Mt=De?f*D((yt-D(yt*yt-4*et))/et):1/D(bt);return[z(De*Mt),g(We)*I(Mt)]};function Ji(){return v.geoProjection(no).scale(144.049).clipAngle(90-.001)}function ts(De){var We=n(De),et=m(b+De/2);function ot(bt,yt){var Mt=yt-De,ur=M(Mt)<u?bt*We:M(ur=b+yt/2)<u||M(M(ur)-A)<u?0:bt*Mt/c(m(ur)/et);return[ur,Mt]}return ot.invert=function(bt,yt){var Mt,ur=yt+De;return[M(yt)<u?bt/We:M(Mt=b+ur/2)<u||M(M(Mt)-A)<u?0:bt*c(m(Mt)/et)/yt,ur]},ot}function Gs(){return Qe(ts).parallel(40).scale(158.837)}function nu(De,We){return[De,1.25*c(m(b+.4*We))]}nu.invert=function(De,We){return[De,2.5*e(r(.8*We))-.625*s]};function Ko(){return v.geoProjection(nu).scale(108.318)}function au(De){var We=De.length-1;function et(ot,bt){for(var yt=n(bt),Mt=2/(1+yt*n(ot)),ur=Mt*yt*h(ot),pr=Mt*h(bt),sr=We,xr=De[sr],Dr=xr[0],Xr=xr[1],qr;--sr>=0;)xr=De[sr],Dr=xr[0]+ur*(qr=Dr)-pr*Xr,Xr=xr[1]+ur*Xr+pr*qr;return Dr=ur*(qr=Dr)-pr*Xr,Xr=ur*Xr+pr*qr,[Dr,Xr]}return et.invert=function(ot,bt){var yt=20,Mt=ot,ur=bt;do{for(var pr=We,sr=De[pr],xr=sr[0],Dr=sr[1],Xr=0,qr=0,bn;--pr>=0;)sr=De[pr],Xr=xr+Mt*(bn=Xr)-ur*qr,qr=Dr+Mt*qr+ur*bn,xr=sr[0]+Mt*(bn=xr)-ur*Dr,Dr=sr[1]+Mt*Dr+ur*bn;Xr=xr+Mt*(bn=Xr)-ur*qr,qr=Dr+Mt*qr+ur*bn,xr=Mt*(bn=xr)-ur*Dr-ot,Dr=Mt*Dr+ur*bn-bt;var Dn=Xr*Xr+qr*qr,Yn,da;Mt-=Yn=(xr*Xr+Dr*qr)/Dn,ur-=da=(Dr*Xr-xr*qr)/Dn}while(M(Yn)+M(da)>u*u&&--yt>0);if(yt){var xa=D(Mt*Mt+ur*ur),Ka=2*e(xa*.5),Ya=h(Ka);return[a(Mt*Ya,xa*n(Ka)),xa?z(ur*Ya/xa):0]}},et}var Rs=[[.9972523,0],[.0052513,-.0041175],[.0074606,.0048125],[-.0153783,-.1968253],[.0636871,-.1408027],[.3660976,-.2937382]],Mo=[[.98879,0],[0,0],[-.050909,0],[0,0],[.075528,0]],Mu=[[.984299,0],[.0211642,.0037608],[-.1036018,-.0575102],[-.0329095,-.0320119],[.0499471,.1223335],[.026046,.0899805],[7388e-7,-.1435792],[.0075848,-.1334108],[-.0216473,.0776645],[-.0225161,.0853673]],Is=[[.9245,0],[0,0],[.01943,0]],_s=[[.721316,0],[0,0],[-.00881625,-.00617325]];function Cl(){return ws(Rs,[152,-64]).scale(1400).center([-160.908,62.4864]).clipAngle(30).angle(7.8)}function Su(){return ws(Mo,[95,-38]).scale(1e3).clipAngle(55).center([-96.5563,38.8675])}function ku(){return ws(Mu,[120,-45]).scale(359.513).clipAngle(55).center([-117.474,53.0628])}function Ys(){return ws(Is,[-20,-18]).scale(209.091).center([20,16.7214]).clipAngle(82)}function Ll(){return ws(_s,[165,10]).scale(250).clipAngle(130).center([-165,-10])}function ws(De,We){var et=v.geoProjection(au(De)).rotate(We).clipAngle(90),ot=v.geoRotation(We),bt=et.center;return delete et.rotate,et.center=function(yt){return arguments.length?bt(ot(yt)):ot.invert(bt())},et}var Yl=D(6),al=D(7);function Wl(De,We){var et=z(7*h(We)/(3*Yl));return[Yl*De*(2*n(2*et/3)-1)/al,9*h(et/3)/al]}Wl.invert=function(De,We){var et=3*z(We*al/9);return[De*al/(Yl*(2*n(2*et/3)-1)),z(h(et)*3*Yl/7)]};function iu(){return v.geoProjection(Wl).scale(164.859)}function Pl(De,We){for(var et=(1+f)*h(We),ot=We,bt=0,yt;bt<25&&(ot-=yt=(h(ot/2)+h(ot)-et)/(.5*n(ot/2)+n(ot)),!(M(yt)<u));bt++);return[De*(1+2*n(ot)/n(ot/2))/(3*x),2*D(3)*h(ot/2)/D(2+x)]}Pl.invert=function(De,We){var et=We*D(2+x)/(2*D(3)),ot=2*z(et);return[3*x*De/(1+2*n(ot)/n(ot/2)),z((et+h(ot))/(1+f))]};function Eu(){return v.geoProjection(Pl).scale(188.209)}function Ws(De,We){for(var et=D(6/(4+s)),ot=(1+s/4)*h(We),bt=We/2,yt=0,Mt;yt<25&&(bt-=Mt=(bt/2+h(bt)-ot)/(.5+n(bt)),!(M(Mt)<u));yt++);return[et*(.5+n(bt))*De/1.5,et*bt]}Ws.invert=function(De,We){var et=D(6/(4+s)),ot=We/et;return M(M(ot)-A)<u&&(ot=ot<0?-A:A),[1.5*De/(et*(.5+n(ot))),z((ot/2+h(ot))/(1+s/4))]};function Xl(){return v.geoProjection(Ws).scale(166.518)}function Dl(De,We){var et=We*We,ot=et*et,bt=et*ot;return[De*(.84719-.13063*et+bt*bt*(-.04515+.05494*et-.02326*ot+.00331*bt)),We*(1.01183+ot*ot*(-.02625+.01926*et-.00396*ot))]}Dl.invert=function(De,We){var et=We,ot=25,bt,yt,Mt,ur;do yt=et*et,Mt=yt*yt,et-=bt=(et*(1.01183+Mt*Mt*(-.02625+.01926*yt-.00396*Mt))-We)/(1.01183+Mt*Mt*(9*-.02625+11*.01926*yt+13*-.00396*Mt));while(M(bt)>_&&--ot>0);return yt=et*et,Mt=yt*yt,ur=yt*Mt,[De/(.84719-.13063*yt+ur*ur*(-.04515+.05494*yt-.02326*Mt+.00331*ur)),et]};function ps(){return v.geoProjection(Dl).scale(175.295)}function dl(De,We){return[De*(1+n(We))/2,2*(We-m(We/2))]}dl.invert=function(De,We){for(var et=We/2,ot=0,bt=1/0;ot<10&&M(bt)>u;++ot){var yt=n(We/2);We-=bt=(We-m(We/2)-et)/(1-.5/(yt*yt))}return[2*De/(1+n(We)),We]};function Zl(){return v.geoProjection(dl).scale(152.63)}var ou=[[[[-180,0],[-90,90],[0,0]],[[0,0],[90,90],[180,0]]],[[[-180,0],[-90,-90],[0,0]],[[0,0],[90,-90],[180,0]]]];function su(){return aa(ae(1/0),ou).rotate([20,0]).scale(152.63)}function Rl(De,We){var et=h(We),ot=n(We),bt=g(De);if(De===0||M(We)===A)return[0,We];if(We===0)return[De,0];if(M(De)===A)return[De*ot,A*et];var yt=s/(2*De)-2*De/s,Mt=2*We/s,ur=(1-Mt*Mt)/(et-Mt),pr=yt*yt,sr=ur*ur,xr=1+pr/sr,Dr=1+sr/pr,Xr=(yt*et/ur-yt/2)/xr,qr=(sr*et/pr+ur/2)/Dr,bn=Xr*Xr+ot*ot/xr,Dn=qr*qr-(sr*et*et/pr+ur*et-1)/Dr;return[A*(Xr+D(bn)*bt),A*(qr+D(Dn<0?0:Dn)*g(-We*yt)*bt)]}Rl.invert=function(De,We){De/=A,We/=A;var et=De*De,ot=We*We,bt=et+ot,yt=s*s;return[De?(bt-1+D((1-bt)*(1-bt)+4*et))/(2*De)*A:0,ye(function(Mt){return bt*(s*h(Mt)-2*Mt)*s+4*Mt*Mt*(We-h(Mt))+2*s*Mt-yt*We},0)]};function Cu(){return v.geoProjection(Rl).scale(127.267)}var lu=1.0148,Jo=.23185,il=-.14499,ol=.02406,jl=lu,ds=5*Jo,So=7*il,Il=9*ol,Ts=1.790857183;function As(De,We){var et=We*We;return[De,We*(lu+et*et*(Jo+et*(il+ol*et)))]}As.invert=function(De,We){We>Ts?We=Ts:We<-Ts&&(We=-Ts);var et=We,ot;do{var bt=et*et;et-=ot=(et*(lu+bt*bt*(Jo+bt*(il+ol*bt)))-We)/(jl+bt*bt*(ds+bt*(So+Il*bt)))}while(M(ot)>u);return[De,et]};function oo(){return v.geoProjection(As).scale(139.319)}function yl(De,We){if(M(We)<u)return[De,0];var et=m(We),ot=De*h(We);return[h(ot)/et,We+(1-n(ot))/et]}yl.invert=function(De,We){if(M(We)<u)return[De,0];var et=De*De+We*We,ot=We*.5,bt=10,yt;do{var Mt=m(ot),ur=1/n(ot),pr=et-2*We*ot+ot*ot;ot-=yt=(Mt*pr+2*(ot-We))/(2+pr*ur*ur+2*(ot-We)*Mt)}while(M(yt)>u&&--bt>0);return Mt=m(ot),[(M(We)<M(ot+1/Mt)?z(De*Mt):g(We)*g(De)*(I(M(De*Mt))+A))/h(ot),ot]};function ml(){return v.geoProjection(yl).scale(103.74)}function Xs(De,We){var et=sl(De[1],De[0]),ot=sl(We[1],We[0]),bt=bl(et,ot),yt=zl(et)/zl(ot);return xl([1,0,De[0][0],0,1,De[0][1]],xl([yt,0,0,0,yt,0],xl([n(bt),h(bt),0,-h(bt),n(bt),0],[1,0,-We[0][0],0,1,-We[0][1]])))}function gs(De){var We=1/(De[0]*De[4]-De[1]*De[3]);return[We*De[4],-We*De[1],We*(De[1]*De[5]-De[2]*De[4]),-We*De[3],We*De[0],We*(De[2]*De[3]-De[0]*De[5])]}function xl(De,We){return[De[0]*We[0]+De[1]*We[3],De[0]*We[1]+De[1]*We[4],De[0]*We[2]+De[1]*We[5]+De[2],De[3]*We[0]+De[4]*We[3],De[3]*We[1]+De[4]*We[4],De[3]*We[2]+De[4]*We[5]+De[5]]}function sl(De,We){return[De[0]-We[0],De[1]-We[1]]}function zl(De){return D(De[0]*De[0]+De[1]*De[1])}function bl(De,We){return a(De[0]*We[1]-De[1]*We[0],De[0]*We[0]+De[1]*We[1])}function Zs(De,We,et){ot(De,{transform:null});function ot(sr,xr){if(sr.edges=Kl(sr.face),xr.face){var Dr=sr.shared=Yu(sr.face,xr.face),Xr=Xs(Dr.map(xr.project),Dr.map(sr.project));sr.transform=xr.transform?xl(xr.transform,Xr):Xr;for(var qr=xr.edges,bn=0,Dn=qr.length;bn<Dn;++bn)rs(Dr[0],qr[bn][1])&&rs(Dr[1],qr[bn][0])&&(qr[bn]=sr),rs(Dr[0],qr[bn][0])&&rs(Dr[1],qr[bn][1])&&(qr[bn]=sr);for(qr=sr.edges,bn=0,Dn=qr.length;bn<Dn;++bn)rs(Dr[0],qr[bn][0])&&rs(Dr[1],qr[bn][1])&&(qr[bn]=xr),rs(Dr[0],qr[bn][1])&&rs(Dr[1],qr[bn][0])&&(qr[bn]=xr)}else sr.transform=xr.transform;return sr.children&&sr.children.forEach(function(Yn){ot(Yn,sr)}),sr}function bt(sr,xr){var Dr=We(sr,xr),Xr=Dr.project([sr*T,xr*T]),qr;return(qr=Dr.transform)?[qr[0]*Xr[0]+qr[1]*Xr[1]+qr[2],-(qr[3]*Xr[0]+qr[4]*Xr[1]+qr[5])]:(Xr[1]=-Xr[1],Xr)}ll(De)&&(bt.invert=function(sr,xr){var Dr=yt(De,[sr,-xr]);return Dr&&(Dr[0]*=k,Dr[1]*=k,Dr)});function yt(sr,xr){var Dr=sr.project.invert,Xr=sr.transform,qr=xr;if(Xr&&(Xr=gs(Xr),qr=[Xr[0]*qr[0]+Xr[1]*qr[1]+Xr[2],Xr[3]*qr[0]+Xr[4]*qr[1]+Xr[5]]),Dr&&sr===Mt(bn=Dr(qr)))return bn;for(var bn,Dn=sr.children,Yn=0,da=Dn&&Dn.length;Yn<da;++Yn)if(bn=yt(Dn[Yn],xr))return bn}function Mt(sr){return We(sr[0]*k,sr[1]*k)}var ur=v.geoProjection(bt),pr=ur.stream;return ur.stream=function(sr){var xr=ur.rotate(),Dr=pr(sr),Xr=(ur.rotate([0,0]),pr(sr));return ur.rotate(xr),Dr.sphere=function(){Xr.polygonStart(),Xr.lineStart(),Lu(Xr,De),Xr.lineEnd(),Xr.polygonEnd()},Dr},ur.angle(et==null?-30:et*T)}function Lu(De,We,et){var ot,bt=We.edges,yt=bt.length,Mt,ur={type:"MultiPoint",coordinates:We.face},pr=We.face.filter(function(Dn){return M(Dn[1])!==90}),sr=v.geoBounds({type:"MultiPoint",coordinates:pr}),xr=!1,Dr=-1,Xr=sr[1][0]-sr[0][0],qr=Xr===180||Xr===360?[(sr[0][0]+sr[1][0])/2,(sr[0][1]+sr[1][1])/2]:v.geoCentroid(ur);if(et)for(;++Dr<yt&&bt[Dr]!==et;);++Dr;for(var bn=0;bn<yt;++bn)Mt=bt[(bn+Dr)%yt],Array.isArray(Mt)?(xr||(De.point((ot=v.geoInterpolate(Mt[0],qr)(u))[0],ot[1]),xr=!0),De.point((ot=v.geoInterpolate(Mt[1],qr)(u))[0],ot[1])):(xr=!1,Mt!==et&&Lu(De,Mt,We))}function rs(De,We){return De&&We&&De[0]===We[0]&&De[1]===We[1]}function Yu(De,We){for(var et,ot,bt=De.length,yt=null,Mt=0;Mt<bt;++Mt){et=De[Mt];for(var ur=We.length;--ur>=0;)if(ot=We[ur],et[0]===ot[0]&&et[1]===ot[1]){if(yt)return[yt,et];yt=et}}}function Kl(De){for(var We=De.length,et=[],ot=De[We-1],bt=0;bt<We;++bt)et.push([ot,ot=De[bt]]);return et}function ll(De){return De.project.invert||De.children&&De.children.some(ll)}var _l=[[0,90],[-90,0],[0,0],[90,0],[180,0],[0,-90]],js=[[0,2,1],[0,3,2],[5,1,2],[5,2,3],[0,1,4],[0,4,3],[5,4,1],[5,3,4]].map(function(De){return De.map(function(We){return _l[We]})});function wl(De){De=De||function(et){var ot=v.geoCentroid({type:"MultiPoint",coordinates:et});return v.geoGnomonic().scale(1).translate([0,0]).rotate([-ot[0],-ot[1]])};var We=js.map(function(et){return{face:et,project:De(et)}});return[-1,0,0,1,0,1,4,5].forEach(function(et,ot){var bt=We[et];bt&&(bt.children||(bt.children=[])).push(We[ot])}),Zs(We[0],function(et,ot){return We[et<-s/2?ot<0?6:4:et<0?ot<0?2:0:et<s/2?ot<0?3:1:ot<0?7:5]}).angle(-30).scale(101.858).center([0,45])}var uu=2/D(3);function fu(De,We){var et=Ne(De,We);return[et[0]*uu,et[1]]}fu.invert=function(De,We){return Ne.invert(De/uu,We)};function Wu(De){De=De||function(et){var ot=v.geoCentroid({type:"MultiPoint",coordinates:et});return v.geoProjection(fu).translate([0,0]).scale(1).rotate(ot[1]>0?[-ot[0],0]:[180-ot[0],180])};var We=js.map(function(et){return{face:et,project:De(et)}});return[-1,0,0,1,0,1,4,5].forEach(function(et,ot){var bt=We[et];bt&&(bt.children||(bt.children=[])).push(We[ot])}),Zs(We[0],function(et,ot){return We[et<-s/2?ot<0?6:4:et<0?ot<0?2:0:et<s/2?ot<0?3:1:ot<0?7:5]}).angle(-30).scale(121.906).center([0,48.5904])}function Ri(De){De=De||function(Mt){var ur=Mt.length===6?v.geoCentroid({type:"MultiPoint",coordinates:Mt}):Mt[0];return v.geoGnomonic().scale(1).translate([0,0]).rotate([-ur[0],-ur[1]])};var We=js.map(function(Mt){for(var ur=Mt.map(ns),pr=ur.length,sr=ur[pr-1],xr,Dr=[],Xr=0;Xr<pr;++Xr)xr=ur[Xr],Dr.push(Qo([sr[0]*.9486832980505138+xr[0]*.31622776601683794,sr[1]*.9486832980505138+xr[1]*.31622776601683794,sr[2]*.9486832980505138+xr[2]*.31622776601683794]),Qo([xr[0]*.9486832980505138+sr[0]*.31622776601683794,xr[1]*.9486832980505138+sr[1]*.31622776601683794,xr[2]*.9486832980505138+sr[2]*.31622776601683794])),sr=xr;return Dr}),et=[],ot=[-1,0,0,1,0,1,4,5];We.forEach(function(Mt,ur){for(var pr=js[ur],sr=pr.length,xr=et[ur]=[],Dr=0;Dr<sr;++Dr)We.push([pr[Dr],Mt[(Dr*2+2)%(2*sr)],Mt[(Dr*2+1)%(2*sr)]]),ot.push(ur),xr.push(Ks(ns(Mt[(Dr*2+2)%(2*sr)]),ns(Mt[(Dr*2+1)%(2*sr)])))});var bt=We.map(function(Mt){return{project:De(Mt),face:Mt}});ot.forEach(function(Mt,ur){var pr=bt[Mt];pr&&(pr.children||(pr.children=[])).push(bt[ur])});function yt(Mt,ur){var pr=n(ur),sr=[pr*n(Mt),pr*h(Mt),h(ur)],xr=Mt<-s/2?ur<0?6:4:Mt<0?ur<0?2:0:Mt<s/2?ur<0?3:1:ur<0?7:5,Dr=et[xr];return bt[ul(Dr[0],sr)<0?8+3*xr:ul(Dr[1],sr)<0?8+3*xr+1:ul(Dr[2],sr)<0?8+3*xr+2:xr]}return Zs(bt[0],yt).angle(-30).scale(110.625).center([0,45])}function ul(De,We){for(var et=0,ot=De.length,bt=0;et<ot;++et)bt+=De[et]*We[et];return bt}function Ks(De,We){return[De[1]*We[2]-De[2]*We[1],De[2]*We[0]-De[0]*We[2],De[0]*We[1]-De[1]*We[0]]}function Qo(De){return[a(De[1],De[0])*T,z(o(-1,i(1,De[2])))*T]}function ns(De){var We=De[0]*k,et=De[1]*k,ot=n(et);return[ot*n(We),ot*h(We),h(et)]}function Tl(){}function so(De){if((et=De.length)<4)return!1;for(var We=0,et,ot=De[et-1][1]*De[0][0]-De[et-1][0]*De[0][1];++We<et;)ot+=De[We-1][1]*De[We][0]-De[We-1][0]*De[We][1];return ot<=0}function cu(De,We){for(var et=We[0],ot=We[1],bt=!1,yt=0,Mt=De.length,ur=Mt-1;yt<Mt;ur=yt++){var pr=De[yt],sr=pr[0],xr=pr[1],Dr=De[ur],Xr=Dr[0],qr=Dr[1];xr>ot^qr>ot&&et<(Xr-sr)*(ot-xr)/(qr-xr)+sr&&(bt=!bt)}return bt}function as(De,We){var et=We.stream,ot;if(!et)throw new Error("invalid projection");switch(De&&De.type){case"Feature":ot=Fs;break;case"FeatureCollection":ot=zs;break;default:ot=is;break}return ot(De,et)}function zs(De,We){return{type:"FeatureCollection",features:De.features.map(function(et){return Fs(et,We)})}}function Fs(De,We){return{type:"Feature",id:De.id,properties:De.properties,geometry:is(De.geometry,We)}}function Ms(De,We){return{type:"GeometryCollection",geometries:De.geometries.map(function(et){return is(et,We)})}}function is(De,We){if(!De)return null;if(De.type==="GeometryCollection")return Ms(De,We);var et;switch(De.type){case"Point":et=os;break;case"MultiPoint":et=os;break;case"LineString":et=hu;break;case"MultiLineString":et=hu;break;case"Polygon":et=Fl;break;case"MultiPolygon":et=Fl;break;case"Sphere":et=Fl;break;default:return null}return v.geoStream(De,We(et)),et.result()}var Hi=[],ko=[],os={point:function(De,We){Hi.push([De,We])},result:function(){var De=Hi.length?Hi.length<2?{type:"Point",coordinates:Hi[0]}:{type:"MultiPoint",coordinates:Hi}:null;return Hi=[],De}},hu={lineStart:Tl,point:function(De,We){Hi.push([De,We])},lineEnd:function(){Hi.length&&(ko.push(Hi),Hi=[])},result:function(){var De=ko.length?ko.length<2?{type:"LineString",coordinates:ko[0]}:{type:"MultiLineString",coordinates:ko}:null;return ko=[],De}},Fl={polygonStart:Tl,lineStart:Tl,point:function(De,We){Hi.push([De,We])},lineEnd:function(){var De=Hi.length;if(De){do Hi.push(Hi[0].slice());while(++De<4);ko.push(Hi),Hi=[]}},polygonEnd:Tl,result:function(){if(!ko.length)return null;var De=[],We=[];return ko.forEach(function(et){so(et)?De.push([et]):We.push(et)}),We.forEach(function(et){var ot=et[0];De.some(function(bt){if(cu(bt[0],ot))return bt.push(et),!0})||De.push([et])}),ko=[],De.length?De.length>1?{type:"MultiPolygon",coordinates:De}:{type:"Polygon",coordinates:De[0]}:null}};function vu(De){var We=De(A,0)[0]-De(-A,0)[0];function et(ot,bt){var yt=M(ot)<A,Mt=De(yt?ot:ot>0?ot-s:ot+s,bt),ur=(Mt[0]-Mt[1])*f,pr=(Mt[0]+Mt[1])*f;if(yt)return[ur,pr];var sr=We*f,xr=ur>0^pr>0?-1:1;return[xr*ur-g(pr)*sr,xr*pr-g(ur)*sr]}return De.invert&&(et.invert=function(ot,bt){var yt=(ot+bt)*f,Mt=(bt-ot)*f,ur=M(yt)<.5*We&&M(Mt)<.5*We;if(!ur){var pr=We*f,sr=yt>0^Mt>0?-1:1,xr=-sr*ot+(Mt>0?1:-1)*pr,Dr=-sr*bt+(yt>0?1:-1)*pr;yt=(-xr-Dr)*f,Mt=(xr-Dr)*f}var Xr=De.invert(yt,Mt);return ur||(Xr[0]+=yt>0?s:-s),Xr}),v.geoProjection(et).rotate([-90,-90,45]).clipAngle(180-.001)}function gt(){return vu(Tr).scale(176.423)}function zt(){return vu(ga).scale(111.48)}function cr(De,We){if(!(0<=(We=+We)&&We<=20))throw new Error("invalid digits");function et(sr){var xr=sr.length,Dr=2,Xr=new Array(xr);for(Xr[0]=+sr[0].toFixed(We),Xr[1]=+sr[1].toFixed(We);Dr<xr;)Xr[Dr]=sr[Dr],++Dr;return Xr}function ot(sr){return sr.map(et)}function bt(sr){for(var xr=et(sr[0]),Dr=[xr],Xr=1;Xr<sr.length;Xr++){var qr=et(sr[Xr]);(qr.length>2||qr[0]!=xr[0]||qr[1]!=xr[1])&&(Dr.push(qr),xr=qr)}return Dr.length===1&&sr.length>1&&Dr.push(et(sr[sr.length-1])),Dr}function yt(sr){return sr.map(bt)}function Mt(sr){if(sr==null)return sr;var xr;switch(sr.type){case"GeometryCollection":xr={type:"GeometryCollection",geometries:sr.geometries.map(Mt)};break;case"Point":xr={type:"Point",coordinates:et(sr.coordinates)};break;case"MultiPoint":xr={type:sr.type,coordinates:ot(sr.coordinates)};break;case"LineString":xr={type:sr.type,coordinates:bt(sr.coordinates)};break;case"MultiLineString":case"Polygon":xr={type:sr.type,coordinates:yt(sr.coordinates)};break;case"MultiPolygon":xr={type:"MultiPolygon",coordinates:sr.coordinates.map(yt)};break;default:return sr}return sr.bbox!=null&&(xr.bbox=sr.bbox),xr}function ur(sr){var xr={type:"Feature",properties:sr.properties,geometry:Mt(sr.geometry)};return sr.id!=null&&(xr.id=sr.id),sr.bbox!=null&&(xr.bbox=sr.bbox),xr}if(De!=null)switch(De.type){case"Feature":return ur(De);case"FeatureCollection":{var pr={type:"FeatureCollection",features:De.features.map(ur)};return De.bbox!=null&&(pr.bbox=De.bbox),pr}default:return Mt(De)}return De}function or(De){var We=h(De);function et(ot,bt){var yt=We?m(ot*We/2)/We:ot/2;if(!bt)return[2*yt,-De];var Mt=2*e(yt*h(bt)),ur=1/m(bt);return[h(Mt)*ur,bt+(1-n(Mt))*ur-De]}return et.invert=function(ot,bt){if(M(bt+=De)<u)return[We?2*e(We*ot/2)/We:ot,0];var yt=ot*ot+bt*bt,Mt=0,ur=10,pr;do{var sr=m(Mt),xr=1/n(Mt),Dr=yt-2*bt*Mt+Mt*Mt;Mt-=pr=(sr*Dr+2*(Mt-bt))/(2+Dr*xr*xr+2*(Mt-bt)*sr)}while(M(pr)>u&&--ur>0);var Xr=ot*(sr=m(Mt)),qr=m(M(bt)<M(Mt+1/sr)?z(Xr)*.5:I(Xr)*.5+s/4)/h(Mt);return[We?2*e(We*qr)/We:2*qr,Mt]},et}function Rr(){return Qe(or).scale(131.215)}var tn=[[.9986,-.062],[1,0],[.9986,.062],[.9954,.124],[.99,.186],[.9822,.248],[.973,.31],[.96,.372],[.9427,.434],[.9216,.4958],[.8962,.5571],[.8679,.6176],[.835,.6769],[.7986,.7346],[.7597,.7903],[.7186,.8435],[.6732,.8936],[.6213,.9394],[.5722,.9761],[.5322,1]];tn.forEach(function(De){De[1]*=1.0144});function dn(De,We){var et=i(18,M(We)*36/s),ot=t(et),bt=et-ot,yt=(Dr=tn[ot])[0],Mt=Dr[1],ur=(Dr=tn[++ot])[0],pr=Dr[1],sr=(Dr=tn[i(19,++ot)])[0],xr=Dr[1],Dr;return[De*(ur+bt*(sr-yt)/2+bt*bt*(sr-2*ur+yt)/2),(We>0?A:-A)*(pr+bt*(xr-Mt)/2+bt*bt*(xr-2*pr+Mt)/2)]}dn.invert=function(De,We){var et=We/A,ot=et*90,bt=i(18,M(ot/5)),yt=o(0,t(bt));do{var Mt=tn[yt][1],ur=tn[yt+1][1],pr=tn[i(19,yt+2)][1],sr=pr-Mt,xr=pr-2*ur+Mt,Dr=2*(M(et)-ur)/sr,Xr=xr/sr,qr=Dr*(1-Xr*Dr*(1-2*Xr*Dr));if(qr>=0||yt===1){ot=(We>=0?5:-5)*(qr+bt);var bn=50,Dn;do bt=i(18,M(ot)/5),yt=t(bt),qr=bt-yt,Mt=tn[yt][1],ur=tn[yt+1][1],pr=tn[i(19,yt+2)][1],ot-=(Dn=(We>=0?A:-A)*(ur+qr*(pr-Mt)/2+qr*qr*(pr-2*ur+Mt)/2)-We)*T;while(M(Dn)>_&&--bn>0);break}}while(--yt>=0);var Yn=tn[yt][0],da=tn[yt+1][0],xa=tn[i(19,yt+2)][0];return[De/(da+qr*(xa-Yn)/2+qr*qr*(xa-2*da+Yn)/2),ot*k]};function Mn(){return v.geoProjection(dn).scale(152.63)}function Ln(De){function We(et,ot){var bt=n(ot),yt=(De-1)/(De-bt*n(et));return[yt*bt*h(et),yt*h(ot)]}return We.invert=function(et,ot){var bt=et*et+ot*ot,yt=D(bt),Mt=(De-D(1-bt*(De+1)/(De-1)))/((De-1)/yt+yt/(De-1));return[a(et*Mt,yt*D(1-Mt*Mt)),yt?z(ot*Mt/yt):0]},We}function Nn(De,We){var et=Ln(De);if(!We)return et;var ot=n(We),bt=h(We);function yt(Mt,ur){var pr=et(Mt,ur),sr=pr[1],xr=sr*bt/(De-1)+ot;return[pr[0]*ot/xr,sr/xr]}return yt.invert=function(Mt,ur){var pr=(De-1)/(De-1-ur*bt);return et.invert(pr*Mt,pr*ur*ot)},yt}function yn(){var De=2,We=0,et=v.geoProjectionMutator(Nn),ot=et(De,We);return ot.distance=function(bt){return arguments.length?et(De=+bt,We):De},ot.tilt=function(bt){return arguments.length?et(De,We=bt*k):We*T},ot.scale(432.147).clipAngle(I(1/De)*T-1e-6)}var zn=1e-4,Pn=1e4,Vn=-180,$n=Vn+zn,za=180,ka=za-zn,Fa=-90,Oa=Fa+zn,Jn=90,ha=Jn-zn;function Ga(De){return De.length>0}function Qa(De){return Math.floor(De*Pn)/Pn}function di(De){return De===Fa||De===Jn?[0,De]:[Vn,Qa(De)]}function gi(De){var We=De[0],et=De[1],ot=!1;return We<=$n?(We=Vn,ot=!0):We>=ka&&(We=za,ot=!0),et<=Oa?(et=Fa,ot=!0):et>=ha&&(et=Jn,ot=!0),ot?[We,et]:De}function mi(De){return De.map(gi)}function Ai(De,We,et){for(var ot=0,bt=De.length;ot<bt;++ot){var yt=De[ot].slice();et.push({index:-1,polygon:We,ring:yt});for(var Mt=0,ur=yt.length;Mt<ur;++Mt){var pr=yt[Mt],sr=pr[0],xr=pr[1];if(sr<=$n||sr>=ka||xr<=Oa||xr>=ha){yt[Mt]=gi(pr);for(var Dr=Mt+1;Dr<ur;++Dr){var Xr=yt[Dr],qr=Xr[0],bn=Xr[1];if(qr>$n&&qr<ka&&bn>Oa&&bn<ha)break}if(Dr===Mt+1)continue;if(Mt){var Dn={index:-1,polygon:We,ring:yt.slice(0,Mt+1)};Dn.ring[Dn.ring.length-1]=di(xr),et[et.length-1]=Dn}else et.pop();if(Dr>=ur)break;et.push({index:-1,polygon:We,ring:yt=yt.slice(Dr-1)}),yt[0]=di(yt[0][1]),Mt=-1,ur=yt.length}}}}function oi(De){var We,et=De.length,ot={},bt={},yt,Mt,ur,pr,sr;for(We=0;We<et;++We){if(yt=De[We],Mt=yt.ring[0],pr=yt.ring[yt.ring.length-1],Mt[0]===pr[0]&&Mt[1]===pr[1]){yt.polygon.push(yt.ring),De[We]=null;continue}yt.index=We,ot[Mt]=bt[pr]=yt}for(We=0;We<et;++We)if(yt=De[We],yt){if(Mt=yt.ring[0],pr=yt.ring[yt.ring.length-1],ur=bt[Mt],sr=ot[pr],delete ot[Mt],delete bt[pr],Mt[0]===pr[0]&&Mt[1]===pr[1]){yt.polygon.push(yt.ring);continue}ur?(delete bt[Mt],delete ot[ur.ring[0]],ur.ring.pop(),De[ur.index]=null,yt={index:-1,polygon:ur.polygon,ring:ur.ring.concat(yt.ring)},ur===sr?yt.polygon.push(yt.ring):(yt.index=et++,De.push(ot[yt.ring[0]]=bt[yt.ring[yt.ring.length-1]]=yt))):sr?(delete ot[pr],delete bt[sr.ring[sr.ring.length-1]],yt.ring.pop(),yt={index:et++,polygon:sr.polygon,ring:yt.ring.concat(sr.ring)},De[sr.index]=null,De.push(ot[yt.ring[0]]=bt[yt.ring[yt.ring.length-1]]=yt)):(yt.ring.push(yt.ring[0]),yt.polygon.push(yt.ring))}}function yo(De){var We={type:"Feature",geometry:qi(De.geometry)};return De.id!=null&&(We.id=De.id),De.bbox!=null&&(We.bbox=De.bbox),De.properties!=null&&(We.properties=De.properties),We}function qi(De){if(De==null)return De;var We,et,ot,bt;switch(De.type){case"GeometryCollection":We={type:"GeometryCollection",geometries:De.geometries.map(qi)};break;case"Point":We={type:"Point",coordinates:gi(De.coordinates)};break;case"MultiPoint":case"LineString":We={type:De.type,coordinates:mi(De.coordinates)};break;case"MultiLineString":We={type:"MultiLineString",coordinates:De.coordinates.map(mi)};break;case"Polygon":{var yt=[];Ai(De.coordinates,yt,et=[]),oi(et),We={type:"Polygon",coordinates:yt};break}case"MultiPolygon":{et=[],ot=-1,bt=De.coordinates.length;for(var Mt=new Array(bt);++ot<bt;)Ai(De.coordinates[ot],Mt[ot]=[],et);oi(et),We={type:"MultiPolygon",coordinates:Mt.filter(Ga)};break}default:return De}return De.bbox!=null&&(We.bbox=De.bbox),We}function Ja(De){if(De==null)return De;switch(De.type){case"Feature":return yo(De);case"FeatureCollection":{var We={type:"FeatureCollection",features:De.features.map(yo)};return De.bbox!=null&&(We.bbox=De.bbox),We}default:return qi(De)}}function va(De,We){var et=m(We/2),ot=h(b*et);return[De*(.74482-.34588*ot*ot),1.70711*et]}va.invert=function(De,We){var et=We/1.70711,ot=h(b*et);return[De/(.74482-.34588*ot*ot),2*e(et)]};function xi(){return v.geoProjection(va).scale(146.153)}function lo(De,We,et){var ot=v.geoInterpolate(We,et),bt=ot(.5),yt=v.geoRotation([-bt[0],-bt[1]])(We),Mt=ot.distance/2,ur=-z(h(yt[1]*k)/h(Mt)),pr=[-bt[0],-bt[1],-(yt[0]>0?s-ur:ur)*T],sr=v.geoProjection(De(Mt)).rotate(pr),xr=v.geoRotation(pr),Dr=sr.center;return delete sr.rotate,sr.center=function(Xr){return arguments.length?Dr(xr(Xr)):xr.invert(Dr())},sr.clipAngle(90)}function vo(De){var We=n(De);function et(ot,bt){var yt=v.geoGnomonicRaw(ot,bt);return yt[0]*=We,yt}return et.invert=function(ot,bt){return v.geoGnomonicRaw.invert(ot/We,bt)},et}function ss(){return Ss([-158,21.5],[-77,39]).clipAngle(60).scale(400)}function Ss(De,We){return lo(vo,De,We)}function Io(De){if(!(De*=2))return v.geoAzimuthalEquidistantRaw;var We=-De/2,et=-We,ot=De*De,bt=m(et),yt=.5/h(et);function Mt(ur,pr){var sr=I(n(pr)*n(ur-We)),xr=I(n(pr)*n(ur-et)),Dr=pr<0?-1:1;return sr*=sr,xr*=xr,[(sr-xr)/(2*De),Dr*D(4*ot*xr-(ot-sr+xr)*(ot-sr+xr))/(2*De)]}return Mt.invert=function(ur,pr){var sr=pr*pr,xr=n(D(sr+(Xr=ur+We)*Xr)),Dr=n(D(sr+(Xr=ur+et)*Xr)),Xr,qr;return[a(qr=xr-Dr,Xr=(xr+Dr)*bt),(pr<0?-1:1)*I(D(Xr*Xr+qr*qr)*yt)]},Mt}function Js(){return ys([-158,21.5],[-77,39]).clipAngle(130).scale(122.571)}function ys(De,We){return lo(Io,De,We)}function ls(De,We){if(M(We)<u)return[De,0];var et=M(We/A),ot=z(et);if(M(De)<u||M(M(We)-A)<u)return[0,g(We)*s*m(ot/2)];var bt=n(ot),yt=M(s/De-De/s)/2,Mt=yt*yt,ur=bt/(et+bt-1),pr=ur*(2/et-1),sr=pr*pr,xr=sr+Mt,Dr=ur-sr,Xr=Mt+ur;return[g(De)*s*(yt*Dr+D(Mt*Dr*Dr-xr*(ur*ur-sr)))/xr,g(We)*s*(pr*Xr-yt*D((Mt+1)*xr-Xr*Xr))/xr]}ls.invert=function(De,We){if(M(We)<u)return[De,0];if(M(De)<u)return[0,A*h(2*e(We/s))];var et=(De/=s)*De,ot=(We/=s)*We,bt=et+ot,yt=bt*bt,Mt=-M(We)*(1+bt),ur=Mt-2*ot+et,pr=-2*Mt+1+2*ot+yt,sr=ot/pr+(2*ur*ur*ur/(pr*pr*pr)-9*Mt*ur/(pr*pr))/27,xr=(Mt-ur*ur/(3*pr))/pr,Dr=2*D(-xr/3),Xr=I(3*sr/(xr*Dr))/3;return[s*(bt-1+D(1+2*(et-ot)+yt))/(2*De),g(We)*s*(-Dr*n(Xr+s/3)-ur/(3*pr))]};function mo(){return v.geoProjection(ls).scale(79.4183)}function Ol(De,We){if(M(We)<u)return[De,0];var et=M(We/A),ot=z(et);if(M(De)<u||M(M(We)-A)<u)return[0,g(We)*s*m(ot/2)];var bt=n(ot),yt=M(s/De-De/s)/2,Mt=yt*yt,ur=bt*(D(1+Mt)-yt*bt)/(1+Mt*et*et);return[g(De)*s*ur,g(We)*s*D(1-ur*(2*yt+ur))]}Ol.invert=function(De,We){if(!De)return[0,A*h(2*e(We/s))];var et=M(De/s),ot=(1-et*et-(We/=s)*We)/(2*et),bt=ot*ot,yt=D(bt+1);return[g(De)*s*(yt-ot),g(We)*A*h(2*a(D((1-2*ot*et)*(ot+yt)-et),D(yt+ot+et)))]};function Jl(){return v.geoProjection(Ol).scale(79.4183)}function us(De,We){if(M(We)<u)return[De,0];var et=We/A,ot=z(et);if(M(De)<u||M(M(We)-A)<u)return[0,s*m(ot/2)];var bt=(s/De-De/s)/2,yt=et/(1+n(ot));return[s*(g(De)*D(bt*bt+1-yt*yt)-bt),s*yt]}us.invert=function(De,We){if(!We)return[De,0];var et=We/s,ot=(s*s*(1-et*et)-De*De)/(2*s*De);return[De?s*(g(De)*D(ot*ot+1)-ot):0,A*h(2*e(et))]};function pu(){return v.geoProjection(us).scale(79.4183)}function Bl(De,We){if(!We)return[De,0];var et=M(We);if(!De||et===A)return[0,We];var ot=et/A,bt=ot*ot,yt=(8*ot-bt*(bt+2)-5)/(2*bt*(ot-1)),Mt=yt*yt,ur=ot*yt,pr=bt+Mt+2*ur,sr=ot+3*yt,xr=De/A,Dr=xr+1/xr,Xr=g(M(De)-A)*D(Dr*Dr-4),qr=Xr*Xr,bn=pr*(bt+Mt*qr-1)+(1-bt)*(bt*(sr*sr+4*Mt)+12*ur*Mt+4*Mt*Mt),Dn=(Xr*(pr+Mt-1)+2*D(bn))/(4*pr+qr);return[g(De)*A*Dn,g(We)*A*D(1+Xr*M(Dn)-Dn*Dn)]}Bl.invert=function(De,We){var et;if(!De||!We)return[De,We];We/=s;var ot=g(De)*De/A,bt=(ot*ot-1+4*We*We)/M(ot),yt=bt*bt,Mt=2*We,ur=50;do{var pr=Mt*Mt,sr=(8*Mt-pr*(pr+2)-5)/(2*pr*(Mt-1)),xr=(3*Mt-pr*Mt-10)/(2*pr*Mt),Dr=sr*sr,Xr=Mt*sr,qr=Mt+sr,bn=qr*qr,Dn=Mt+3*sr,Yn=bn*(pr+Dr*yt-1)+(1-pr)*(pr*(Dn*Dn+4*Dr)+Dr*(12*Xr+4*Dr)),da=-2*qr*(4*Xr*Dr+(1-4*pr+3*pr*pr)*(1+xr)+Dr*(-6+14*pr-yt+(-8+8*pr-2*yt)*xr)+Xr*(-8+12*pr+(-10+10*pr-yt)*xr)),xa=D(Yn),Ka=bt*(bn+Dr-1)+2*xa-ot*(4*bn+yt),Ya=bt*(2*sr*xr+2*qr*(1+xr))+da/xa-8*qr*(bt*(-1+Dr+bn)+2*xa)*(1+xr)/(yt+4*bn);Mt-=et=Ka/Ya}while(et>u&&--ur>0);return[g(De)*(D(bt*bt+4)+bt)*s/4,A*Mt]};function vf(){return v.geoProjection(Bl).scale(127.16)}function Pu(De,We,et,ot,bt){function yt(Mt,ur){var pr=et*h(ot*ur),sr=D(1-pr*pr),xr=D(2/(1+sr*n(Mt*=bt)));return[De*sr*xr*h(Mt),We*pr*xr]}return yt.invert=function(Mt,ur){var pr=Mt/De,sr=ur/We,xr=D(pr*pr+sr*sr),Dr=2*z(xr/2);return[a(Mt*m(Dr),De*xr)/bt,xr&&z(ur*h(Dr)/(We*et*xr))/ot]},yt}function du(De,We,et,ot){var bt=s/3;De=o(De,u),We=o(We,u),De=i(De,A),We=i(We,s-u),et=o(et,0),et=i(et,100-u),ot=o(ot,u);var yt=et/100+1,Mt=ot/100,ur=I(yt*n(bt))/bt,pr=h(De)/h(ur*A),sr=We/s,xr=D(Mt*h(De/2)/h(We/2)),Dr=xr/D(sr*pr*ur),Xr=1/(xr*D(sr*pr*ur));return Pu(Dr,Xr,pr,ur,sr)}function Du(){var De=65*k,We=60*k,et=20,ot=200,bt=v.geoProjectionMutator(du),yt=bt(De,We,et,ot);return yt.poleline=function(Mt){return arguments.length?bt(De=+Mt*k,We,et,ot):De*T},yt.parallels=function(Mt){return arguments.length?bt(De,We=+Mt*k,et,ot):We*T},yt.inflation=function(Mt){return arguments.length?bt(De,We,et=+Mt,ot):et},yt.ratio=function(Mt){return arguments.length?bt(De,We,et,ot=+Mt):ot},yt.scale(163.775)}function ks(){return Du().poleline(65).parallels(60).inflation(0).ratio(200).scale(172.633)}var Xu=4*s+3*D(3),Ru=2*D(2*s*D(3)/Xu),Iu=_e(Ru*D(3)/s,Ru,Xu/6);function zo(){return v.geoProjection(Iu).scale(176.84)}function zu(De,We){return[De*D(1-3*We*We/(s*s)),We]}zu.invert=function(De,We){return[De/D(1-3*We*We/(s*s)),We]};function $u(){return v.geoProjection(zu).scale(152.63)}function ms(De,We){var et=n(We),ot=n(De)*et,bt=1-ot,yt=n(De=a(h(De)*et,-h(We))),Mt=h(De);return et=D(1-ot*ot),[Mt*et-yt*bt,-yt*et-Mt*bt]}ms.invert=function(De,We){var et=(De*De+We*We)/-2,ot=D(-et*(2+et)),bt=We*et+De*ot,yt=De*et-We*ot,Mt=D(yt*yt+bt*bt);return[a(ot*bt,Mt*(1+et)),Mt?-z(ot*yt/Mt):0]};function gu(){return v.geoProjection(ms).rotate([0,-90,45]).scale(124.75).clipAngle(180-.001)}function yu(De,We){var et=Y(De,We);return[(et[0]+De/A)/2,(et[1]+We)/2]}yu.invert=function(De,We){var et=De,ot=We,bt=25;do{var yt=n(ot),Mt=h(ot),ur=h(2*ot),pr=Mt*Mt,sr=yt*yt,xr=h(et),Dr=n(et/2),Xr=h(et/2),qr=Xr*Xr,bn=1-sr*Dr*Dr,Dn=bn?I(yt*Dr)*D(Yn=1/bn):Yn=0,Yn,da=.5*(2*Dn*yt*Xr+et/A)-De,xa=.5*(Dn*Mt+ot)-We,Ka=.5*Yn*(sr*qr+Dn*yt*Dr*pr)+.5/A,Ya=Yn*(xr*ur/4-Dn*Mt*Xr),ei=.125*Yn*(ur*Xr-Dn*Mt*sr*xr),hi=.5*Yn*(pr*Dr+Dn*qr*yt)+.5,ao=Ya*ei-hi*Ka,ri=(xa*Ya-da*hi)/ao,Vi=(da*ei-xa*Ka)/ao;et-=ri,ot-=Vi}while((M(ri)>u||M(Vi)>u)&&--bt>0);return[et,ot]};function Fu(){return v.geoProjection(yu).scale(158.837)}w.geoNaturalEarth=v.geoNaturalEarth1,w.geoNaturalEarthRaw=v.geoNaturalEarth1Raw,w.geoAiry=X,w.geoAiryRaw=J,w.geoAitoff=Z,w.geoAitoffRaw=Y,w.geoArmadillo=re,w.geoArmadilloRaw=oe,w.geoAugust=N,w.geoAugustRaw=se,w.geoBaker=W,w.geoBakerRaw=$,w.geoBerghaus=ne,w.geoBerghausRaw=K,w.geoBertin1953=ge,w.geoBertin1953Raw=pe,w.geoBoggs=Ge,w.geoBoggsRaw=Pe,w.geoBonne=vt,w.geoBonneRaw=He,w.geoBottomley=rr,w.geoBottomleyRaw=Rt,w.geoBromley=Ft,w.geoBromleyRaw=Lt,w.geoChamberlin=Ae,w.geoChamberlinRaw=Ue,w.geoChamberlinAfrica=Ve,w.geoCollignon=Xe,w.geoCollignonRaw=Ne,w.geoCraig=_t,w.geoCraigRaw=Je,w.geoCraster=Kt,w.geoCrasterRaw=Ot,w.geoCylindricalEqualArea=Wt,w.geoCylindricalEqualAreaRaw=Nt,w.geoCylindricalStereographic=Yt,w.geoCylindricalStereographicRaw=qt,w.geoEckert1=Yr,w.geoEckert1Raw=fr,w.geoEckert2=Qr,w.geoEckert2Raw=hn,w.geoEckert3=Jt,w.geoEckert3Raw=at,w.geoEckert4=Ut,w.geoEckert4Raw=Zt,w.geoEckert5=rt,w.geoEckert5Raw=_r,w.geoEckert6=st,w.geoEckert6Raw=Ke,w.geoEisenlohr=Pt,w.geoEisenlohrRaw=wt,w.geoFahey=nt,w.geoFaheyRaw=Se,w.geoFoucaut=ct,w.geoFoucautRaw=it,w.geoFoucautSinusoidal=dt,w.geoFoucautSinusoidalRaw=At,w.geoGilbert=ir,w.geoGingery=Hr,w.geoGingeryRaw=kr,w.geoGinzburg4=Pr,w.geoGinzburg4Raw=mr,w.geoGinzburg5=Sr,w.geoGinzburg5Raw=Nr,w.geoGinzburg6=Et,w.geoGinzburg6Raw=tt,w.geoGinzburg8=ar,w.geoGinzburg8Raw=Vt,w.geoGinzburg9=Or,w.geoGinzburg9Raw=Cr,w.geoGringorten=ln,w.geoGringortenRaw=Tr,w.geoGuyou=Va,w.geoGuyouRaw=ga,w.geoHammer=le,w.geoHammerRaw=ae,w.geoHammerRetroazimuthal=wr,w.geoHammerRetroazimuthalRaw=ja,w.geoHealpix=Ua,w.geoHealpixRaw=Zn,w.geoHill=Bt,w.geoHillRaw=li,w.geoHomolosine=xn,w.geoHomolosineRaw=Tn,w.geoHufnagel=gr,w.geoHufnagelRaw=un,w.geoHyperelliptical=On,w.geoHyperellipticalRaw=gn,w.geoInterrupt=aa,w.geoInterruptedBoggs=ma,w.geoInterruptedHomolosine=Aa,w.geoInterruptedMollweide=Ro,w.geoInterruptedMollweideHemispheres=rl,w.geoInterruptedSinuMollweide=Gl,w.geoInterruptedSinusoidal=Vs,w.geoKavrayskiy7=Ui,w.geoKavrayskiy7Raw=Ds,w.geoLagrange=pl,w.geoLagrangeRaw=Ao,w.geoLarrivee=nl,w.geoLarriveeRaw=Di,w.geoLaskowski=Fi,w.geoLaskowskiRaw=Ki,w.geoLittrow=Ji,w.geoLittrowRaw=no,w.geoLoximuthal=Gs,w.geoLoximuthalRaw=ts,w.geoMiller=Ko,w.geoMillerRaw=nu,w.geoModifiedStereographic=ws,w.geoModifiedStereographicRaw=au,w.geoModifiedStereographicAlaska=Cl,w.geoModifiedStereographicGs48=Su,w.geoModifiedStereographicGs50=ku,w.geoModifiedStereographicMiller=Ys,w.geoModifiedStereographicLee=Ll,w.geoMollweide=Oe,w.geoMollweideRaw=ze,w.geoMtFlatPolarParabolic=iu,w.geoMtFlatPolarParabolicRaw=Wl,w.geoMtFlatPolarQuartic=Eu,w.geoMtFlatPolarQuarticRaw=Pl,w.geoMtFlatPolarSinusoidal=Xl,w.geoMtFlatPolarSinusoidalRaw=Ws,w.geoNaturalEarth2=ps,w.geoNaturalEarth2Raw=Dl,w.geoNellHammer=Zl,w.geoNellHammerRaw=dl,w.geoInterruptedQuarticAuthalic=su,w.geoNicolosi=Cu,w.geoNicolosiRaw=Rl,w.geoPatterson=oo,w.geoPattersonRaw=As,w.geoPolyconic=ml,w.geoPolyconicRaw=yl,w.geoPolyhedral=Zs,w.geoPolyhedralButterfly=wl,w.geoPolyhedralCollignon=Wu,w.geoPolyhedralWaterman=Ri,w.geoProject=as,w.geoGringortenQuincuncial=gt,w.geoPeirceQuincuncial=zt,w.geoPierceQuincuncial=zt,w.geoQuantize=cr,w.geoQuincuncial=vu,w.geoRectangularPolyconic=Rr,w.geoRectangularPolyconicRaw=or,w.geoRobinson=Mn,w.geoRobinsonRaw=dn,w.geoSatellite=yn,w.geoSatelliteRaw=Nn,w.geoSinuMollweide=en,w.geoSinuMollweideRaw=vn,w.geoSinusoidal=Le,w.geoSinusoidalRaw=Be,w.geoStitch=Ja,w.geoTimes=xi,w.geoTimesRaw=va,w.geoTwoPointAzimuthal=Ss,w.geoTwoPointAzimuthalRaw=vo,w.geoTwoPointAzimuthalUsa=ss,w.geoTwoPointEquidistant=ys,w.geoTwoPointEquidistantRaw=Io,w.geoTwoPointEquidistantUsa=Js,w.geoVanDerGrinten=mo,w.geoVanDerGrintenRaw=ls,w.geoVanDerGrinten2=Jl,w.geoVanDerGrinten2Raw=Ol,w.geoVanDerGrinten3=pu,w.geoVanDerGrinten3Raw=us,w.geoVanDerGrinten4=vf,w.geoVanDerGrinten4Raw=Bl,w.geoWagner=Du,w.geoWagner7=ks,w.geoWagnerRaw=du,w.geoWagner4=zo,w.geoWagner4Raw=Iu,w.geoWagner6=$u,w.geoWagner6Raw=zu,w.geoWiechel=gu,w.geoWiechelRaw=ms,w.geoWinkel3=Fu,w.geoWinkel3Raw=yu,Object.defineProperty(w,"__esModule",{value:!0})})},{"d3-array":107,"d3-geo":114}],114:[function(d,ee,te){(function(w,v){typeof te=="object"&&typeof ee<"u"?v(te,d("d3-array")):(w=w||self,v(w.d3=w.d3||{},w.d3))})(this,function(w,v){function S(){return new M}function M(){this.reset()}M.prototype={constructor:M,reset:function(){this.s=this.t=0},add:function(gt){a(e,gt,this.t),a(this,e.s,this.s),this.s?this.t+=e.t:this.s=e.t},valueOf:function(){return this.s}};var e=new M;function a(gt,zt,cr){var or=gt.s=zt+cr,Rr=or-zt,tn=or-Rr;gt.t=zt-tn+(cr-Rr)}var n=1e-6,r=1e-12,t=Math.PI,c=t/2,o=t/4,i=t*2,y=180/t,p=t/180,g=Math.abs,h=Math.atan,m=Math.atan2,u=Math.cos,_=Math.ceil,s=Math.exp,A=Math.log,b=Math.pow,f=Math.sin,x=Math.sign||function(gt){return gt>0?1:gt<0?-1:0},l=Math.sqrt,L=Math.tan;function T(gt){return gt>1?0:gt<-1?t:Math.acos(gt)}function k(gt){return gt>1?c:gt<-1?-c:Math.asin(gt)}function P(gt){return(gt=f(gt/2))*gt}function z(){}function I(gt,zt){gt&&R.hasOwnProperty(gt.type)&&R[gt.type](gt,zt)}var D={Feature:function(gt,zt){I(gt.geometry,zt)},FeatureCollection:function(gt,zt){for(var cr=gt.features,or=-1,Rr=cr.length;++or<Rr;)I(cr[or].geometry,zt)}},R={Sphere:function(gt,zt){zt.sphere()},Point:function(gt,zt){gt=gt.coordinates,zt.point(gt[0],gt[1],gt[2])},MultiPoint:function(gt,zt){for(var cr=gt.coordinates,or=-1,Rr=cr.length;++or<Rr;)gt=cr[or],zt.point(gt[0],gt[1],gt[2])},LineString:function(gt,zt){B(gt.coordinates,zt,0)},MultiLineString:function(gt,zt){for(var cr=gt.coordinates,or=-1,Rr=cr.length;++or<Rr;)B(cr[or],zt,0)},Polygon:function(gt,zt){F(gt.coordinates,zt)},MultiPolygon:function(gt,zt){for(var cr=gt.coordinates,or=-1,Rr=cr.length;++or<Rr;)F(cr[or],zt)},GeometryCollection:function(gt,zt){for(var cr=gt.geometries,or=-1,Rr=cr.length;++or<Rr;)I(cr[or],zt)}};function B(gt,zt,cr){var or=-1,Rr=gt.length-cr,tn;for(zt.lineStart();++or<Rr;)tn=gt[or],zt.point(tn[0],tn[1],tn[2]);zt.lineEnd()}function F(gt,zt){var cr=-1,or=gt.length;for(zt.polygonStart();++cr<or;)B(gt[cr],zt,1);zt.polygonEnd()}function H(gt,zt){gt&&D.hasOwnProperty(gt.type)?D[gt.type](gt,zt):I(gt,zt)}var G=S(),J=S(),X,Y,Z,oe,re,se={point:z,lineStart:z,lineEnd:z,polygonStart:function(){G.reset(),se.lineStart=N,se.lineEnd=U},polygonEnd:function(){var gt=+G;J.add(gt<0?i+gt:gt),this.lineStart=this.lineEnd=this.point=z},sphere:function(){J.add(i)}};function N(){se.point=q}function U(){$(X,Y)}function q(gt,zt){se.point=$,X=gt,Y=zt,gt*=p,zt*=p,Z=gt,oe=u(zt=zt/2+o),re=f(zt)}function $(gt,zt){gt*=p,zt*=p,zt=zt/2+o;var cr=gt-Z,or=cr>=0?1:-1,Rr=or*cr,tn=u(zt),dn=f(zt),Mn=re*dn,Ln=oe*tn+Mn*u(Rr),Nn=Mn*or*f(Rr);G.add(m(Nn,Ln)),Z=gt,oe=tn,re=dn}function W(gt){return J.reset(),H(gt,se),J*2}function K(gt){return[m(gt[1],gt[0]),k(gt[2])]}function ne(gt){var zt=gt[0],cr=gt[1],or=u(cr);return[or*u(zt),or*f(zt),f(cr)]}function ae(gt,zt){return gt[0]*zt[0]+gt[1]*zt[1]+gt[2]*zt[2]}function ie(gt,zt){return[gt[1]*zt[2]-gt[2]*zt[1],gt[2]*zt[0]-gt[0]*zt[2],gt[0]*zt[1]-gt[1]*zt[0]]}function le(gt,zt){gt[0]+=zt[0],gt[1]+=zt[1],gt[2]+=zt[2]}function ye(gt,zt){return[gt[0]*zt,gt[1]*zt,gt[2]*zt]}function ue(gt){var zt=l(gt[0]*gt[0]+gt[1]*gt[1]+gt[2]*gt[2]);gt[0]/=zt,gt[1]/=zt,gt[2]/=zt}var pe,ge,Te,_e,ze,Oe,Ye,be,Pe=S(),Ge,Qe,Be={point:Le,lineStart:vt,lineEnd:Rt,polygonStart:function(){Be.point=rr,Be.lineStart=Lt,Be.lineEnd=Ft,Pe.reset(),se.polygonStart()},polygonEnd:function(){se.polygonEnd(),Be.point=Le,Be.lineStart=vt,Be.lineEnd=Rt,G<0?(pe=-(Te=180),ge=-(_e=90)):Pe>n?_e=90:Pe<-n&&(ge=-90),Qe[0]=pe,Qe[1]=Te},sphere:function(){pe=-(Te=180),ge=-(_e=90)}};function Le(gt,zt){Ge.push(Qe=[pe=gt,Te=gt]),zt<ge&&(ge=zt),zt>_e&&(_e=zt)}function He(gt,zt){var cr=ne([gt*p,zt*p]);if(be){var or=ie(be,cr),Rr=[or[1],-or[0],0],tn=ie(Rr,or);ue(tn),tn=K(tn);var dn=gt-ze,Mn=dn>0?1:-1,Ln=tn[0]*y*Mn,Nn,yn=g(dn)>180;yn^(Mn*ze<Ln&&Ln<Mn*gt)?(Nn=tn[1]*y,Nn>_e&&(_e=Nn)):(Ln=(Ln+360)%360-180,yn^(Mn*ze<Ln&&Ln<Mn*gt)?(Nn=-tn[1]*y,Nn<ge&&(ge=Nn)):(zt<ge&&(ge=zt),zt>_e&&(_e=zt))),yn?gt<ze?Gt(pe,gt)>Gt(pe,Te)&&(Te=gt):Gt(gt,Te)>Gt(pe,Te)&&(pe=gt):Te>=pe?(gt<pe&&(pe=gt),gt>Te&&(Te=gt)):gt>ze?Gt(pe,gt)>Gt(pe,Te)&&(Te=gt):Gt(gt,Te)>Gt(pe,Te)&&(pe=gt)}else Ge.push(Qe=[pe=gt,Te=gt]);zt<ge&&(ge=zt),zt>_e&&(_e=zt),be=cr,ze=gt}function vt(){Be.point=He}function Rt(){Qe[0]=pe,Qe[1]=Te,Be.point=Le,be=null}function rr(gt,zt){if(be){var cr=gt-ze;Pe.add(g(cr)>180?cr+(cr>0?360:-360):cr)}else Oe=gt,Ye=zt;se.point(gt,zt),He(gt,zt)}function Lt(){se.lineStart()}function Ft(){rr(Oe,Ye),se.lineEnd(),g(Pe)>n&&(pe=-(Te=180)),Qe[0]=pe,Qe[1]=Te,be=null}function Gt(gt,zt){return(zt-=gt)<0?zt+360:zt}function Dt(gt,zt){return gt[0]-zt[0]}function kt(gt,zt){return gt[0]<=gt[1]?gt[0]<=zt&&zt<=gt[1]:zt<gt[0]||gt[1]<zt}function Ue(gt){var zt,cr,or,Rr,tn,dn,Mn;if(_e=Te=-(pe=ge=1/0),Ge=[],H(gt,Be),cr=Ge.length){for(Ge.sort(Dt),zt=1,or=Ge[0],tn=[or];zt<cr;++zt)Rr=Ge[zt],kt(or,Rr[0])||kt(or,Rr[1])?(Gt(or[0],Rr[1])>Gt(or[0],or[1])&&(or[1]=Rr[1]),Gt(Rr[0],or[1])>Gt(or[0],or[1])&&(or[0]=Rr[0])):tn.push(or=Rr);for(dn=-1/0,cr=tn.length-1,zt=0,or=tn[cr];zt<=cr;or=Rr,++zt)Rr=tn[zt],(Mn=Gt(or[1],Rr[0]))>dn&&(dn=Mn,pe=Rr[0],Te=or[1])}return Ge=Qe=null,pe===1/0||ge===1/0?[[NaN,NaN],[NaN,NaN]]:[[pe,ge],[Te,_e]]}var qe,Ve,Ae,Ne,Xe,Je,_t,mt,Ot,Kt,Nt,Wt,qt,Yt,fr,Yr,hn={sphere:z,point:Qr,lineStart:Jt,lineEnd:_r,polygonStart:function(){hn.lineStart=rt,hn.lineEnd=Ke},polygonEnd:function(){hn.lineStart=Jt,hn.lineEnd=_r}};function Qr(gt,zt){gt*=p,zt*=p;var cr=u(zt);at(cr*u(gt),cr*f(gt),f(zt))}function at(gt,zt,cr){++qe,Ae+=(gt-Ae)/qe,Ne+=(zt-Ne)/qe,Xe+=(cr-Xe)/qe}function Jt(){hn.point=Zt}function Zt(gt,zt){gt*=p,zt*=p;var cr=u(zt);Yt=cr*u(gt),fr=cr*f(gt),Yr=f(zt),hn.point=Ut,at(Yt,fr,Yr)}function Ut(gt,zt){gt*=p,zt*=p;var cr=u(zt),or=cr*u(gt),Rr=cr*f(gt),tn=f(zt),dn=m(l((dn=fr*tn-Yr*Rr)*dn+(dn=Yr*or-Yt*tn)*dn+(dn=Yt*Rr-fr*or)*dn),Yt*or+fr*Rr+Yr*tn);Ve+=dn,Je+=dn*(Yt+(Yt=or)),_t+=dn*(fr+(fr=Rr)),mt+=dn*(Yr+(Yr=tn)),at(Yt,fr,Yr)}function _r(){hn.point=Qr}function rt(){hn.point=st}function Ke(){lt(Wt,qt),hn.point=Qr}function st(gt,zt){Wt=gt,qt=zt,gt*=p,zt*=p,hn.point=lt;var cr=u(zt);Yt=cr*u(gt),fr=cr*f(gt),Yr=f(zt),at(Yt,fr,Yr)}function lt(gt,zt){gt*=p,zt*=p;var cr=u(zt),or=cr*u(gt),Rr=cr*f(gt),tn=f(zt),dn=fr*tn-Yr*Rr,Mn=Yr*or-Yt*tn,Ln=Yt*Rr-fr*or,Nn=l(dn*dn+Mn*Mn+Ln*Ln),yn=k(Nn),zn=Nn&&-yn/Nn;Ot+=zn*dn,Kt+=zn*Mn,Nt+=zn*Ln,Ve+=yn,Je+=yn*(Yt+(Yt=or)),_t+=yn*(fr+(fr=Rr)),mt+=yn*(Yr+(Yr=tn)),at(Yt,fr,Yr)}function wt(gt){qe=Ve=Ae=Ne=Xe=Je=_t=mt=Ot=Kt=Nt=0,H(gt,hn);var zt=Ot,cr=Kt,or=Nt,Rr=zt*zt+cr*cr+or*or;return Rr<r&&(zt=Je,cr=_t,or=mt,Ve<n&&(zt=Ae,cr=Ne,or=Xe),Rr=zt*zt+cr*cr+or*or,Rr<r)?[NaN,NaN]:[m(cr,zt)*y,k(or/l(Rr))*y]}function Pt(gt){return function(){return gt}}function ke(gt,zt){function cr(or,Rr){return or=gt(or,Rr),zt(or[0],or[1])}return gt.invert&&zt.invert&&(cr.invert=function(or,Rr){return or=zt.invert(or,Rr),or&&gt.invert(or[0],or[1])}),cr}function Se(gt,zt){return[g(gt)>t?gt+Math.round(-gt/i)*i:gt,zt]}Se.invert=Se;function nt(gt,zt,cr){return(gt%=i)?zt||cr?ke(ct(gt),At(zt,cr)):ct(gt):zt||cr?At(zt,cr):Se}function it(gt){return function(zt,cr){return zt+=gt,[zt>t?zt-i:zt<-t?zt+i:zt,cr]}}function ct(gt){var zt=it(gt);return zt.invert=it(-gt),zt}function At(gt,zt){var cr=u(gt),or=f(gt),Rr=u(zt),tn=f(zt);function dn(Mn,Ln){var Nn=u(Ln),yn=u(Mn)*Nn,zn=f(Mn)*Nn,Pn=f(Ln),Vn=Pn*cr+yn*or;return[m(zn*Rr-Vn*tn,yn*cr-Pn*or),k(Vn*Rr+zn*tn)]}return dn.invert=function(Mn,Ln){var Nn=u(Ln),yn=u(Mn)*Nn,zn=f(Mn)*Nn,Pn=f(Ln),Vn=Pn*Rr-zn*tn;return[m(zn*Rr+Pn*tn,yn*cr+Vn*or),k(Vn*cr-yn*or)]},dn}function dt(gt){gt=nt(gt[0]*p,gt[1]*p,gt.length>2?gt[2]*p:0);function zt(cr){return cr=gt(cr[0]*p,cr[1]*p),cr[0]*=y,cr[1]*=y,cr}return zt.invert=function(cr){return cr=gt.invert(cr[0]*p,cr[1]*p),cr[0]*=y,cr[1]*=y,cr},zt}function Tt(gt,zt,cr,or,Rr,tn){if(!!cr){var dn=u(zt),Mn=f(zt),Ln=or*cr;Rr==null?(Rr=zt+or*i,tn=zt-Ln/2):(Rr=Ht(dn,Rr),tn=Ht(dn,tn),(or>0?Rr<tn:Rr>tn)&&(Rr+=or*i));for(var Nn,yn=Rr;or>0?yn>tn:yn<tn;yn-=Ln)Nn=K([dn,-Mn*u(yn),-Mn*f(yn)]),gt.point(Nn[0],Nn[1])}}function Ht(gt,zt){zt=ne(zt),zt[0]-=gt,ue(zt);var cr=T(-zt[1]);return((-zt[2]<0?-cr:cr)+i-n)%i}function ir(){var gt=Pt([0,0]),zt=Pt(90),cr=Pt(6),or,Rr,tn={point:dn};function dn(Ln,Nn){or.push(Ln=Rr(Ln,Nn)),Ln[0]*=y,Ln[1]*=y}function Mn(){var Ln=gt.apply(this,arguments),Nn=zt.apply(this,arguments)*p,yn=cr.apply(this,arguments)*p;return or=[],Rr=nt(-Ln[0]*p,-Ln[1]*p,0).invert,Tt(tn,Nn,yn,1),Ln={type:"Polygon",coordinates:[or]},or=Rr=null,Ln}return Mn.center=function(Ln){return arguments.length?(gt=typeof Ln=="function"?Ln:Pt([+Ln[0],+Ln[1]]),Mn):gt},Mn.radius=function(Ln){return arguments.length?(zt=typeof Ln=="function"?Ln:Pt(+Ln),Mn):zt},Mn.precision=function(Ln){return arguments.length?(cr=typeof Ln=="function"?Ln:Pt(+Ln),Mn):cr},Mn}function kr(){var gt=[],zt;return{point:function(cr,or,Rr){zt.push([cr,or,Rr])},lineStart:function(){gt.push(zt=[])},lineEnd:z,rejoin:function(){gt.length>1&&gt.push(gt.pop().concat(gt.shift()))},result:function(){var cr=gt;return gt=[],zt=null,cr}}}function br(gt,zt){return g(gt[0]-zt[0])<n&&g(gt[1]-zt[1])<n}function Mr(gt,zt,cr,or){this.x=gt,this.z=zt,this.o=cr,this.e=or,this.v=!1,this.n=this.p=null}function Hr(gt,zt,cr,or,Rr){var tn=[],dn=[],Mn,Ln;if(gt.forEach(function($n){if(!((za=$n.length-1)<=0)){var za,ka=$n[0],Fa=$n[za],Oa;if(br(ka,Fa)){if(!ka[2]&&!Fa[2]){for(Rr.lineStart(),Mn=0;Mn<za;++Mn)Rr.point((ka=$n[Mn])[0],ka[1]);Rr.lineEnd();return}Fa[0]+=2*n}tn.push(Oa=new Mr(ka,$n,null,!0)),dn.push(Oa.o=new Mr(ka,null,Oa,!1)),tn.push(Oa=new Mr(Fa,$n,null,!1)),dn.push(Oa.o=new Mr(Fa,null,Oa,!0))}}),!!tn.length){for(dn.sort(zt),nr(tn),nr(dn),Mn=0,Ln=dn.length;Mn<Ln;++Mn)dn[Mn].e=cr=!cr;for(var Nn=tn[0],yn,zn;;){for(var Pn=Nn,Vn=!0;Pn.v;)if((Pn=Pn.n)===Nn)return;yn=Pn.z,Rr.lineStart();do{if(Pn.v=Pn.o.v=!0,Pn.e){if(Vn)for(Mn=0,Ln=yn.length;Mn<Ln;++Mn)Rr.point((zn=yn[Mn])[0],zn[1]);else or(Pn.x,Pn.n.x,1,Rr);Pn=Pn.n}else{if(Vn)for(yn=Pn.p.z,Mn=yn.length-1;Mn>=0;--Mn)Rr.point((zn=yn[Mn])[0],zn[1]);else or(Pn.x,Pn.p.x,-1,Rr);Pn=Pn.p}Pn=Pn.o,yn=Pn.z,Vn=!Vn}while(!Pn.v);Rr.lineEnd()}}}function nr(gt){if(!!(zt=gt.length)){for(var zt,cr=0,or=gt[0],Rr;++cr<zt;)or.n=Rr=gt[cr],Rr.p=or,or=Rr;or.n=Rr=gt[0],Rr.p=or}}var mr=S();function Pr(gt){return g(gt[0])<=t?gt[0]:x(gt[0])*((g(gt[0])+t)%i-t)}function Nr(gt,zt){var cr=Pr(zt),or=zt[1],Rr=f(or),tn=[f(cr),-u(cr),0],dn=0,Mn=0;mr.reset(),Rr===1?or=c+n:Rr===-1&&(or=-c-n);for(var Ln=0,Nn=gt.length;Ln<Nn;++Ln)if(!!(zn=(yn=gt[Ln]).length))for(var yn,zn,Pn=yn[zn-1],Vn=Pr(Pn),$n=Pn[1]/2+o,za=f($n),ka=u($n),Fa=0;Fa<zn;++Fa,Vn=Jn,za=Ga,ka=Qa,Pn=Oa){var Oa=yn[Fa],Jn=Pr(Oa),ha=Oa[1]/2+o,Ga=f(ha),Qa=u(ha),di=Jn-Vn,gi=di>=0?1:-1,mi=gi*di,Ai=mi>t,oi=za*Ga;if(mr.add(m(oi*gi*f(mi),ka*Qa+oi*u(mi))),dn+=Ai?di+gi*i:di,Ai^Vn>=cr^Jn>=cr){var yo=ie(ne(Pn),ne(Oa));ue(yo);var qi=ie(tn,yo);ue(qi);var Ja=(Ai^di>=0?-1:1)*k(qi[2]);(or>Ja||or===Ja&&(yo[0]||yo[1]))&&(Mn+=Ai^di>=0?1:-1)}}return(dn<-n||dn<n&&mr<-n)^Mn&1}function Sr(gt,zt,cr,or){return function(Rr){var tn=zt(Rr),dn=kr(),Mn=zt(dn),Ln=!1,Nn,yn,zn,Pn={point:Vn,lineStart:za,lineEnd:ka,polygonStart:function(){Pn.point=Fa,Pn.lineStart=Oa,Pn.lineEnd=Jn,yn=[],Nn=[]},polygonEnd:function(){Pn.point=Vn,Pn.lineStart=za,Pn.lineEnd=ka,yn=v.merge(yn);var ha=Nr(Nn,or);yn.length?(Ln||(Rr.polygonStart(),Ln=!0),Hr(yn,Et,ha,cr,Rr)):ha&&(Ln||(Rr.polygonStart(),Ln=!0),Rr.lineStart(),cr(null,null,1,Rr),Rr.lineEnd()),Ln&&(Rr.polygonEnd(),Ln=!1),yn=Nn=null},sphere:function(){Rr.polygonStart(),Rr.lineStart(),cr(null,null,1,Rr),Rr.lineEnd(),Rr.polygonEnd()}};function Vn(ha,Ga){gt(ha,Ga)&&Rr.point(ha,Ga)}function $n(ha,Ga){tn.point(ha,Ga)}function za(){Pn.point=$n,tn.lineStart()}function ka(){Pn.point=Vn,tn.lineEnd()}function Fa(ha,Ga){zn.push([ha,Ga]),Mn.point(ha,Ga)}function Oa(){Mn.lineStart(),zn=[]}function Jn(){Fa(zn[0][0],zn[0][1]),Mn.lineEnd();var ha=Mn.clean(),Ga=dn.result(),Qa,di=Ga.length,gi,mi,Ai;if(zn.pop(),Nn.push(zn),zn=null,!!di){if(ha&1){if(mi=Ga[0],(gi=mi.length-1)>0){for(Ln||(Rr.polygonStart(),Ln=!0),Rr.lineStart(),Qa=0;Qa<gi;++Qa)Rr.point((Ai=mi[Qa])[0],Ai[1]);Rr.lineEnd()}return}di>1&&ha&2&&Ga.push(Ga.pop().concat(Ga.shift())),yn.push(Ga.filter(tt))}}return Pn}}function tt(gt){return gt.length>1}function Et(gt,zt){return((gt=gt.x)[0]<0?gt[1]-c-n:c-gt[1])-((zt=zt.x)[0]<0?zt[1]-c-n:c-zt[1])}var Vt=Sr(function(){return!0},ar,Or,[-t,-c]);function ar(gt){var zt=NaN,cr=NaN,or=NaN,Rr;return{lineStart:function(){gt.lineStart(),Rr=1},point:function(tn,dn){var Mn=tn>0?t:-t,Ln=g(tn-zt);g(Ln-t)<n?(gt.point(zt,cr=(cr+dn)/2>0?c:-c),gt.point(or,cr),gt.lineEnd(),gt.lineStart(),gt.point(Mn,cr),gt.point(tn,cr),Rr=0):or!==Mn&&Ln>=t&&(g(zt-or)<n&&(zt-=or*n),g(tn-Mn)<n&&(tn-=Mn*n),cr=Cr(zt,cr,tn,dn),gt.point(or,cr),gt.lineEnd(),gt.lineStart(),gt.point(Mn,cr),Rr=0),gt.point(zt=tn,cr=dn),or=Mn},lineEnd:function(){gt.lineEnd(),zt=cr=NaN},clean:function(){return 2-Rr}}}function Cr(gt,zt,cr,or){var Rr,tn,dn=f(gt-cr);return g(dn)>n?h((f(zt)*(tn=u(or))*f(cr)-f(or)*(Rr=u(zt))*f(gt))/(Rr*tn*dn)):(zt+or)/2}function Or(gt,zt,cr,or){var Rr;if(gt==null)Rr=cr*c,or.point(-t,Rr),or.point(0,Rr),or.point(t,Rr),or.point(t,0),or.point(t,-Rr),or.point(0,-Rr),or.point(-t,-Rr),or.point(-t,0),or.point(-t,Rr);else if(g(gt[0]-zt[0])>n){var tn=gt[0]<zt[0]?t:-t;Rr=cr*tn/2,or.point(-tn,Rr),or.point(0,Rr),or.point(tn,Rr)}else or.point(zt[0],zt[1])}function Ir(gt){var zt=u(gt),cr=6*p,or=zt>0,Rr=g(zt)>n;function tn(yn,zn,Pn,Vn){Tt(Vn,gt,cr,Pn,yn,zn)}function dn(yn,zn){return u(yn)*u(zn)>zt}function Mn(yn){var zn,Pn,Vn,$n,za;return{lineStart:function(){$n=Vn=!1,za=1},point:function(ka,Fa){var Oa=[ka,Fa],Jn,ha=dn(ka,Fa),Ga=or?ha?0:Nn(ka,Fa):ha?Nn(ka+(ka<0?t:-t),Fa):0;if(!zn&&($n=Vn=ha)&&yn.lineStart(),ha!==Vn&&(Jn=Ln(zn,Oa),(!Jn||br(zn,Jn)||br(Oa,Jn))&&(Oa[2]=1)),ha!==Vn)za=0,ha?(yn.lineStart(),Jn=Ln(Oa,zn),yn.point(Jn[0],Jn[1])):(Jn=Ln(zn,Oa),yn.point(Jn[0],Jn[1],2),yn.lineEnd()),zn=Jn;else if(Rr&&zn&&or^ha){var Qa;!(Ga&Pn)&&(Qa=Ln(Oa,zn,!0))&&(za=0,or?(yn.lineStart(),yn.point(Qa[0][0],Qa[0][1]),yn.point(Qa[1][0],Qa[1][1]),yn.lineEnd()):(yn.point(Qa[1][0],Qa[1][1]),yn.lineEnd(),yn.lineStart(),yn.point(Qa[0][0],Qa[0][1],3)))}ha&&(!zn||!br(zn,Oa))&&yn.point(Oa[0],Oa[1]),zn=Oa,Vn=ha,Pn=Ga},lineEnd:function(){Vn&&yn.lineEnd(),zn=null},clean:function(){return za|($n&&Vn)<<1}}}function Ln(yn,zn,Pn){var Vn=ne(yn),$n=ne(zn),za=[1,0,0],ka=ie(Vn,$n),Fa=ae(ka,ka),Oa=ka[0],Jn=Fa-Oa*Oa;if(!Jn)return!Pn&&yn;var ha=zt*Fa/Jn,Ga=-zt*Oa/Jn,Qa=ie(za,ka),di=ye(za,ha),gi=ye(ka,Ga);le(di,gi);var mi=Qa,Ai=ae(di,mi),oi=ae(mi,mi),yo=Ai*Ai-oi*(ae(di,di)-1);if(!(yo<0)){var qi=l(yo),Ja=ye(mi,(-Ai-qi)/oi);if(le(Ja,di),Ja=K(Ja),!Pn)return Ja;var va=yn[0],xi=zn[0],lo=yn[1],vo=zn[1],ss;xi<va&&(ss=va,va=xi,xi=ss);var Ss=xi-va,Io=g(Ss-t)<n,Js=Io||Ss<n;if(!Io&&vo<lo&&(ss=lo,lo=vo,vo=ss),Js?Io?lo+vo>0^Ja[1]<(g(Ja[0]-va)<n?lo:vo):lo<=Ja[1]&&Ja[1]<=vo:Ss>t^(va<=Ja[0]&&Ja[0]<=xi)){var ys=ye(mi,(-Ai+qi)/oi);return le(ys,di),[Ja,K(ys)]}}}function Nn(yn,zn){var Pn=or?gt:t-gt,Vn=0;return yn<-Pn?Vn|=1:yn>Pn&&(Vn|=2),zn<-Pn?Vn|=4:zn>Pn&&(Vn|=8),Vn}return Sr(dn,Mn,tn,or?[0,-gt]:[-t,gt-t])}function Tr(gt,zt,cr,or,Rr,tn){var dn=gt[0],Mn=gt[1],Ln=zt[0],Nn=zt[1],yn=0,zn=1,Pn=Ln-dn,Vn=Nn-Mn,$n;if($n=cr-dn,!(!Pn&&$n>0)){if($n/=Pn,Pn<0){if($n<yn)return;$n<zn&&(zn=$n)}else if(Pn>0){if($n>zn)return;$n>yn&&(yn=$n)}if($n=Rr-dn,!(!Pn&&$n<0)){if($n/=Pn,Pn<0){if($n>zn)return;$n>yn&&(yn=$n)}else if(Pn>0){if($n<yn)return;$n<zn&&(zn=$n)}if($n=or-Mn,!(!Vn&&$n>0)){if($n/=Vn,Vn<0){if($n<yn)return;$n<zn&&(zn=$n)}else if(Vn>0){if($n>zn)return;$n>yn&&(yn=$n)}if($n=tn-Mn,!(!Vn&&$n<0)){if($n/=Vn,Vn<0){if($n>zn)return;$n>yn&&(yn=$n)}else if(Vn>0){if($n<yn)return;$n<zn&&(zn=$n)}return yn>0&&(gt[0]=dn+yn*Pn,gt[1]=Mn+yn*Vn),zn<1&&(zt[0]=dn+zn*Pn,zt[1]=Mn+zn*Vn),!0}}}}}var Wr=1e9,wn=-Wr;function ln(gt,zt,cr,or){function Rr(Nn,yn){return gt<=Nn&&Nn<=cr&&zt<=yn&&yn<=or}function tn(Nn,yn,zn,Pn){var Vn=0,$n=0;if(Nn==null||(Vn=dn(Nn,zn))!==($n=dn(yn,zn))||Ln(Nn,yn)<0^zn>0)do Pn.point(Vn===0||Vn===3?gt:cr,Vn>1?or:zt);while((Vn=(Vn+zn+4)%4)!==$n);else Pn.point(yn[0],yn[1])}function dn(Nn,yn){return g(Nn[0]-gt)<n?yn>0?0:3:g(Nn[0]-cr)<n?yn>0?2:1:g(Nn[1]-zt)<n?yn>0?1:0:yn>0?3:2}function Mn(Nn,yn){return Ln(Nn.x,yn.x)}function Ln(Nn,yn){var zn=dn(Nn,1),Pn=dn(yn,1);return zn!==Pn?zn-Pn:zn===0?yn[1]-Nn[1]:zn===1?Nn[0]-yn[0]:zn===2?Nn[1]-yn[1]:yn[0]-Nn[0]}return function(Nn){var yn=Nn,zn=kr(),Pn,Vn,$n,za,ka,Fa,Oa,Jn,ha,Ga,Qa,di={point:gi,lineStart:yo,lineEnd:qi,polygonStart:Ai,polygonEnd:oi};function gi(va,xi){Rr(va,xi)&&yn.point(va,xi)}function mi(){for(var va=0,xi=0,lo=Vn.length;xi<lo;++xi)for(var vo=Vn[xi],ss=1,Ss=vo.length,Io=vo[0],Js,ys,ls=Io[0],mo=Io[1];ss<Ss;++ss)Js=ls,ys=mo,Io=vo[ss],ls=Io[0],mo=Io[1],ys<=or?mo>or&&(ls-Js)*(or-ys)>(mo-ys)*(gt-Js)&&++va:mo<=or&&(ls-Js)*(or-ys)<(mo-ys)*(gt-Js)&&--va;return va}function Ai(){yn=zn,Pn=[],Vn=[],Qa=!0}function oi(){var va=mi(),xi=Qa&&va,lo=(Pn=v.merge(Pn)).length;(xi||lo)&&(Nn.polygonStart(),xi&&(Nn.lineStart(),tn(null,null,1,Nn),Nn.lineEnd()),lo&&Hr(Pn,Mn,va,tn,Nn),Nn.polygonEnd()),yn=Nn,Pn=Vn=$n=null}function yo(){di.point=Ja,Vn&&Vn.push($n=[]),Ga=!0,ha=!1,Oa=Jn=NaN}function qi(){Pn&&(Ja(za,ka),Fa&&ha&&zn.rejoin(),Pn.push(zn.result())),di.point=gi,ha&&yn.lineEnd()}function Ja(va,xi){var lo=Rr(va,xi);if(Vn&&$n.push([va,xi]),Ga)za=va,ka=xi,Fa=lo,Ga=!1,lo&&(yn.lineStart(),yn.point(va,xi));else if(lo&&ha)yn.point(va,xi);else{var vo=[Oa=Math.max(wn,Math.min(Wr,Oa)),Jn=Math.max(wn,Math.min(Wr,Jn))],ss=[va=Math.max(wn,Math.min(Wr,va)),xi=Math.max(wn,Math.min(Wr,xi))];Tr(vo,ss,gt,zt,cr,or)?(ha||(yn.lineStart(),yn.point(vo[0],vo[1])),yn.point(ss[0],ss[1]),lo||yn.lineEnd(),Qa=!1):lo&&(yn.lineStart(),yn.point(va,xi),Qa=!1)}Oa=va,Jn=xi,ha=lo}return di}}function Bn(){var gt=0,zt=0,cr=960,or=500,Rr,tn,dn;return dn={stream:function(Mn){return Rr&&tn===Mn?Rr:Rr=ln(gt,zt,cr,or)(tn=Mn)},extent:function(Mn){return arguments.length?(gt=+Mn[0][0],zt=+Mn[0][1],cr=+Mn[1][0],or=+Mn[1][1],Rr=tn=null,dn):[[gt,zt],[cr,or]]}}}var Cn=S(),Wn,Hn,ga,La={sphere:z,point:z,lineStart:ci,lineEnd:z,polygonStart:z,polygonEnd:z};function ci(){La.point=ja,La.lineEnd=Va}function Va(){La.point=La.lineEnd=z}function ja(gt,zt){gt*=p,zt*=p,Wn=gt,Hn=f(zt),ga=u(zt),La.point=Wa}function Wa(gt,zt){gt*=p,zt*=p;var cr=f(zt),or=u(zt),Rr=g(gt-Wn),tn=u(Rr),dn=f(Rr),Mn=or*dn,Ln=ga*cr-Hn*or*tn,Nn=Hn*cr+ga*or*tn;Cn.add(m(l(Mn*Mn+Ln*Ln),Nn)),Wn=gt,Hn=cr,ga=or}function wr(gt){return Cn.reset(),H(gt,La),+Cn}var pn=[null,null],fn={type:"LineString",coordinates:pn};function An(gt,zt){return pn[0]=gt,pn[1]=zt,wr(fn)}var Zn={Feature:function(gt,zt){return ea(gt.geometry,zt)},FeatureCollection:function(gt,zt){for(var cr=gt.features,or=-1,Rr=cr.length;++or<Rr;)if(ea(cr[or].geometry,zt))return!0;return!1}},ua={Sphere:function(){return!0},Point:function(gt,zt){return Rn(gt.coordinates,zt)},MultiPoint:function(gt,zt){for(var cr=gt.coordinates,or=-1,Rr=cr.length;++or<Rr;)if(Rn(cr[or],zt))return!0;return!1},LineString:function(gt,zt){return Xn(gt.coordinates,zt)},MultiLineString:function(gt,zt){for(var cr=gt.coordinates,or=-1,Rr=cr.length;++or<Rr;)if(Xn(cr[or],zt))return!0;return!1},Polygon:function(gt,zt){return Ua(gt.coordinates,zt)},MultiPolygon:function(gt,zt){for(var cr=gt.coordinates,or=-1,Rr=cr.length;++or<Rr;)if(Ua(cr[or],zt))return!0;return!1},GeometryCollection:function(gt,zt){for(var cr=gt.geometries,or=-1,Rr=cr.length;++or<Rr;)if(ea(cr[or],zt))return!0;return!1}};function ea(gt,zt){return gt&&ua.hasOwnProperty(gt.type)?ua[gt.type](gt,zt):!1}function Rn(gt,zt){return An(gt,zt)===0}function Xn(gt,zt){for(var cr,or,Rr,tn=0,dn=gt.length;tn<dn;tn++){if(or=An(gt[tn],zt),or===0||tn>0&&(Rr=An(gt[tn],gt[tn-1]),Rr>0&&cr<=Rr&&or<=Rr&&(cr+or-Rr)*(1-Math.pow((cr-or)/Rr,2))<r*Rr))return!0;cr=or}return!1}function Ua(gt,zt){return!!Nr(gt.map(li),Bt(zt))}function li(gt){return gt=gt.map(Bt),gt.pop(),gt}function Bt(gt){return[gt[0]*p,gt[1]*p]}function hr(gt,zt){return(gt&&Zn.hasOwnProperty(gt.type)?Zn[gt.type]:ea)(gt,zt)}function rn(gt,zt,cr){var or=v.range(gt,zt-n,cr).concat(zt);return function(Rr){return or.map(function(tn){return[Rr,tn]})}}function vn(gt,zt,cr){var or=v.range(gt,zt-n,cr).concat(zt);return function(Rr){return or.map(function(tn){return[tn,Rr]})}}function en(){var gt,zt,cr,or,Rr,tn,dn,Mn,Ln=10,Nn=Ln,yn=90,zn=360,Pn,Vn,$n,za,ka=2.5;function Fa(){return{type:"MultiLineString",coordinates:Oa()}}function Oa(){return v.range(_(or/yn)*yn,cr,yn).map($n).concat(v.range(_(Mn/zn)*zn,dn,zn).map(za)).concat(v.range(_(zt/Ln)*Ln,gt,Ln).filter(function(Jn){return g(Jn%yn)>n}).map(Pn)).concat(v.range(_(tn/Nn)*Nn,Rr,Nn).filter(function(Jn){return g(Jn%zn)>n}).map(Vn))}return Fa.lines=function(){return Oa().map(function(Jn){return{type:"LineString",coordinates:Jn}})},Fa.outline=function(){return{type:"Polygon",coordinates:[$n(or).concat(za(dn).slice(1),$n(cr).reverse().slice(1),za(Mn).reverse().slice(1))]}},Fa.extent=function(Jn){return arguments.length?Fa.extentMajor(Jn).extentMinor(Jn):Fa.extentMinor()},Fa.extentMajor=function(Jn){return arguments.length?(or=+Jn[0][0],cr=+Jn[1][0],Mn=+Jn[0][1],dn=+Jn[1][1],or>cr&&(Jn=or,or=cr,cr=Jn),Mn>dn&&(Jn=Mn,Mn=dn,dn=Jn),Fa.precision(ka)):[[or,Mn],[cr,dn]]},Fa.extentMinor=function(Jn){return arguments.length?(zt=+Jn[0][0],gt=+Jn[1][0],tn=+Jn[0][1],Rr=+Jn[1][1],zt>gt&&(Jn=zt,zt=gt,gt=Jn),tn>Rr&&(Jn=tn,tn=Rr,Rr=Jn),Fa.precision(ka)):[[zt,tn],[gt,Rr]]},Fa.step=function(Jn){return arguments.length?Fa.stepMajor(Jn).stepMinor(Jn):Fa.stepMinor()},Fa.stepMajor=function(Jn){return arguments.length?(yn=+Jn[0],zn=+Jn[1],Fa):[yn,zn]},Fa.stepMinor=function(Jn){return arguments.length?(Ln=+Jn[0],Nn=+Jn[1],Fa):[Ln,Nn]},Fa.precision=function(Jn){return arguments.length?(ka=+Jn,Pn=rn(tn,Rr,90),Vn=vn(zt,gt,ka),$n=rn(Mn,dn,90),za=vn(or,cr,ka),Fa):ka},Fa.extentMajor([[-180,-90+n],[180,90-n]]).extentMinor([[-180,-80-n],[180,80+n]])}function Tn(){return en()()}function xn(gt,zt){var cr=gt[0]*p,or=gt[1]*p,Rr=zt[0]*p,tn=zt[1]*p,dn=u(or),Mn=f(or),Ln=u(tn),Nn=f(tn),yn=dn*u(cr),zn=dn*f(cr),Pn=Ln*u(Rr),Vn=Ln*f(Rr),$n=2*k(l(P(tn-or)+dn*Ln*P(Rr-cr))),za=f($n),ka=$n?function(Fa){var Oa=f(Fa*=$n)/za,Jn=f($n-Fa)/za,ha=Jn*yn+Oa*Pn,Ga=Jn*zn+Oa*Vn,Qa=Jn*Mn+Oa*Nn;return[m(Ga,ha)*y,m(Qa,l(ha*ha+Ga*Ga))*y]}:function(){return[cr*y,or*y]};return ka.distance=$n,ka}function un(gt){return gt}var gr=S(),yr=S(),zr,gn,On,ta,_n={point:z,lineStart:z,lineEnd:z,polygonStart:function(){_n.lineStart=jn,_n.lineEnd=ma},polygonEnd:function(){_n.lineStart=_n.lineEnd=_n.point=z,gr.add(g(yr)),yr.reset()},result:function(){var gt=gr/2;return gr.reset(),gt}};function jn(){_n.point=aa}function aa(gt,zt){_n.point=pa,zr=On=gt,gn=ta=zt}function pa(gt,zt){yr.add(ta*gt-On*zt),On=gt,ta=zt}function ma(){pa(zr,gn)}var sa=1/0,Aa=sa,ho=-sa,Ro=ho,jo={point:rl,lineStart:z,lineEnd:z,polygonStart:z,polygonEnd:z,result:function(){var gt=[[sa,Aa],[ho,Ro]];return ho=Ro=-(Aa=sa=1/0),gt}};function rl(gt,zt){gt<sa&&(sa=gt),gt>ho&&(ho=gt),zt<Aa&&(Aa=zt),zt>Ro&&(Ro=zt)}var vl=0,Gl=0,vi=0,Vs=0,Ds=0,Ui=0,Ao=0,pl=0,vs=0,Di,nl,Ki,Fi,no={point:Ji,lineStart:ts,lineEnd:Ko,polygonStart:function(){no.lineStart=au,no.lineEnd=Rs},polygonEnd:function(){no.point=Ji,no.lineStart=ts,no.lineEnd=Ko},result:function(){var gt=vs?[Ao/vs,pl/vs]:Ui?[Vs/Ui,Ds/Ui]:vi?[vl/vi,Gl/vi]:[NaN,NaN];return vl=Gl=vi=Vs=Ds=Ui=Ao=pl=vs=0,gt}};function Ji(gt,zt){vl+=gt,Gl+=zt,++vi}function ts(){no.point=Gs}function Gs(gt,zt){no.point=nu,Ji(Ki=gt,Fi=zt)}function nu(gt,zt){var cr=gt-Ki,or=zt-Fi,Rr=l(cr*cr+or*or);Vs+=Rr*(Ki+gt)/2,Ds+=Rr*(Fi+zt)/2,Ui+=Rr,Ji(Ki=gt,Fi=zt)}function Ko(){no.point=Ji}function au(){no.point=Mo}function Rs(){Mu(Di,nl)}function Mo(gt,zt){no.point=Mu,Ji(Di=Ki=gt,nl=Fi=zt)}function Mu(gt,zt){var cr=gt-Ki,or=zt-Fi,Rr=l(cr*cr+or*or);Vs+=Rr*(Ki+gt)/2,Ds+=Rr*(Fi+zt)/2,Ui+=Rr,Rr=Fi*gt-Ki*zt,Ao+=Rr*(Ki+gt),pl+=Rr*(Fi+zt),vs+=Rr*3,Ji(Ki=gt,Fi=zt)}function Is(gt){this._context=gt}Is.prototype={_radius:4.5,pointRadius:function(gt){return this._radius=gt,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(gt,zt){switch(this._point){case 0:{this._context.moveTo(gt,zt),this._point=1;break}case 1:{this._context.lineTo(gt,zt);break}default:{this._context.moveTo(gt+this._radius,zt),this._context.arc(gt,zt,this._radius,0,i);break}}},result:z};var _s=S(),Cl,Su,ku,Ys,Ll,ws={point:z,lineStart:function(){ws.point=Yl},lineEnd:function(){Cl&&al(Su,ku),ws.point=z},polygonStart:function(){Cl=!0},polygonEnd:function(){Cl=null},result:function(){var gt=+_s;return _s.reset(),gt}};function Yl(gt,zt){ws.point=al,Su=Ys=gt,ku=Ll=zt}function al(gt,zt){Ys-=gt,Ll-=zt,_s.add(l(Ys*Ys+Ll*Ll)),Ys=gt,Ll=zt}function Wl(){this._string=[]}Wl.prototype={_radius:4.5,_circle:iu(4.5),pointRadius:function(gt){return(gt=+gt)!==this._radius&&(this._radius=gt,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._string.push("Z"),this._point=NaN},point:function(gt,zt){switch(this._point){case 0:{this._string.push("M",gt,",",zt),this._point=1;break}case 1:{this._string.push("L",gt,",",zt);break}default:{this._circle==null&&(this._circle=iu(this._radius)),this._string.push("M",gt,",",zt,this._circle);break}}},result:function(){if(this._string.length){var gt=this._string.join("");return this._string=[],gt}else return null}};function iu(gt){return"m0,"+gt+"a"+gt+","+gt+" 0 1,1 0,"+-2*gt+"a"+gt+","+gt+" 0 1,1 0,"+2*gt+"z"}function Pl(gt,zt){var cr=4.5,or,Rr;function tn(dn){return dn&&(typeof cr=="function"&&Rr.pointRadius(+cr.apply(this,arguments)),H(dn,or(Rr))),Rr.result()}return tn.area=function(dn){return H(dn,or(_n)),_n.result()},tn.measure=function(dn){return H(dn,or(ws)),ws.result()},tn.bounds=function(dn){return H(dn,or(jo)),jo.result()},tn.centroid=function(dn){return H(dn,or(no)),no.result()},tn.projection=function(dn){return arguments.length?(or=dn==null?(gt=null,un):(gt=dn).stream,tn):gt},tn.context=function(dn){return arguments.length?(Rr=dn==null?(zt=null,new Wl):new Is(zt=dn),typeof cr!="function"&&Rr.pointRadius(cr),tn):zt},tn.pointRadius=function(dn){return arguments.length?(cr=typeof dn=="function"?dn:(Rr.pointRadius(+dn),+dn),tn):cr},tn.projection(gt).context(zt)}function Eu(gt){return{stream:Ws(gt)}}function Ws(gt){return function(zt){var cr=new Xl;for(var or in gt)cr[or]=gt[or];return cr.stream=zt,cr}}function Xl(){}Xl.prototype={constructor:Xl,point:function(gt,zt){this.stream.point(gt,zt)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function Dl(gt,zt,cr){var or=gt.clipExtent&&gt.clipExtent();return gt.scale(150).translate([0,0]),or!=null&&gt.clipExtent(null),H(cr,gt.stream(jo)),zt(jo.result()),or!=null&&gt.clipExtent(or),gt}function ps(gt,zt,cr){return Dl(gt,function(or){var Rr=zt[1][0]-zt[0][0],tn=zt[1][1]-zt[0][1],dn=Math.min(Rr/(or[1][0]-or[0][0]),tn/(or[1][1]-or[0][1])),Mn=+zt[0][0]+(Rr-dn*(or[1][0]+or[0][0]))/2,Ln=+zt[0][1]+(tn-dn*(or[1][1]+or[0][1]))/2;gt.scale(150*dn).translate([Mn,Ln])},cr)}function dl(gt,zt,cr){return ps(gt,[[0,0],zt],cr)}function Zl(gt,zt,cr){return Dl(gt,function(or){var Rr=+zt,tn=Rr/(or[1][0]-or[0][0]),dn=(Rr-tn*(or[1][0]+or[0][0]))/2,Mn=-tn*or[0][1];gt.scale(150*tn).translate([dn,Mn])},cr)}function ou(gt,zt,cr){return Dl(gt,function(or){var Rr=+zt,tn=Rr/(or[1][1]-or[0][1]),dn=-tn*or[0][0],Mn=(Rr-tn*(or[1][1]+or[0][1]))/2;gt.scale(150*tn).translate([dn,Mn])},cr)}var su=16,Rl=u(30*p);function Cu(gt,zt){return+zt?Jo(gt,zt):lu(gt)}function lu(gt){return Ws({point:function(zt,cr){zt=gt(zt,cr),this.stream.point(zt[0],zt[1])}})}function Jo(gt,zt){function cr(or,Rr,tn,dn,Mn,Ln,Nn,yn,zn,Pn,Vn,$n,za,ka){var Fa=Nn-or,Oa=yn-Rr,Jn=Fa*Fa+Oa*Oa;if(Jn>4*zt&&za--){var ha=dn+Pn,Ga=Mn+Vn,Qa=Ln+$n,di=l(ha*ha+Ga*Ga+Qa*Qa),gi=k(Qa/=di),mi=g(g(Qa)-1)<n||g(tn-zn)<n?(tn+zn)/2:m(Ga,ha),Ai=gt(mi,gi),oi=Ai[0],yo=Ai[1],qi=oi-or,Ja=yo-Rr,va=Oa*qi-Fa*Ja;(va*va/Jn>zt||g((Fa*qi+Oa*Ja)/Jn-.5)>.3||dn*Pn+Mn*Vn+Ln*$n<Rl)&&(cr(or,Rr,tn,dn,Mn,Ln,oi,yo,mi,ha/=di,Ga/=di,Qa,za,ka),ka.point(oi,yo),cr(oi,yo,mi,ha,Ga,Qa,Nn,yn,zn,Pn,Vn,$n,za,ka))}}return function(or){var Rr,tn,dn,Mn,Ln,Nn,yn,zn,Pn,Vn,$n,za,ka={point:Fa,lineStart:Oa,lineEnd:ha,polygonStart:function(){or.polygonStart(),ka.lineStart=Ga},polygonEnd:function(){or.polygonEnd(),ka.lineStart=Oa}};function Fa(gi,mi){gi=gt(gi,mi),or.point(gi[0],gi[1])}function Oa(){zn=NaN,ka.point=Jn,or.lineStart()}function Jn(gi,mi){var Ai=ne([gi,mi]),oi=gt(gi,mi);cr(zn,Pn,yn,Vn,$n,za,zn=oi[0],Pn=oi[1],yn=gi,Vn=Ai[0],$n=Ai[1],za=Ai[2],su,or),or.point(zn,Pn)}function ha(){ka.point=Fa,or.lineEnd()}function Ga(){Oa(),ka.point=Qa,ka.lineEnd=di}function Qa(gi,mi){Jn(Rr=gi,mi),tn=zn,dn=Pn,Mn=Vn,Ln=$n,Nn=za,ka.point=Jn}function di(){cr(zn,Pn,yn,Vn,$n,za,tn,dn,Rr,Mn,Ln,Nn,su,or),ka.lineEnd=ha,ha()}return ka}}var il=Ws({point:function(gt,zt){this.stream.point(gt*p,zt*p)}});function ol(gt){return Ws({point:function(zt,cr){var or=gt(zt,cr);return this.stream.point(or[0],or[1])}})}function jl(gt,zt,cr,or,Rr){function tn(dn,Mn){return dn*=or,Mn*=Rr,[zt+gt*dn,cr-gt*Mn]}return tn.invert=function(dn,Mn){return[(dn-zt)/gt*or,(cr-Mn)/gt*Rr]},tn}function ds(gt,zt,cr,or,Rr,tn){var dn=u(tn),Mn=f(tn),Ln=dn*gt,Nn=Mn*gt,yn=dn/gt,zn=Mn/gt,Pn=(Mn*cr-dn*zt)/gt,Vn=(Mn*zt+dn*cr)/gt;function $n(za,ka){return za*=or,ka*=Rr,[Ln*za-Nn*ka+zt,cr-Nn*za-Ln*ka]}return $n.invert=function(za,ka){return[or*(yn*za-zn*ka+Pn),Rr*(Vn-zn*za-yn*ka)]},$n}function So(gt){return Il(function(){return gt})()}function Il(gt){var zt,cr=150,or=480,Rr=250,tn=0,dn=0,Mn=0,Ln=0,Nn=0,yn,zn=0,Pn=1,Vn=1,$n=null,za=Vt,ka=null,Fa,Oa,Jn,ha=un,Ga=.5,Qa,di,gi,mi,Ai;function oi(va){return gi(va[0]*p,va[1]*p)}function yo(va){return va=gi.invert(va[0],va[1]),va&&[va[0]*y,va[1]*y]}oi.stream=function(va){return mi&&Ai===va?mi:mi=il(ol(yn)(za(Qa(ha(Ai=va)))))},oi.preclip=function(va){return arguments.length?(za=va,$n=void 0,Ja()):za},oi.postclip=function(va){return arguments.length?(ha=va,ka=Fa=Oa=Jn=null,Ja()):ha},oi.clipAngle=function(va){return arguments.length?(za=+va?Ir($n=va*p):($n=null,Vt),Ja()):$n*y},oi.clipExtent=function(va){return arguments.length?(ha=va==null?(ka=Fa=Oa=Jn=null,un):ln(ka=+va[0][0],Fa=+va[0][1],Oa=+va[1][0],Jn=+va[1][1]),Ja()):ka==null?null:[[ka,Fa],[Oa,Jn]]},oi.scale=function(va){return arguments.length?(cr=+va,qi()):cr},oi.translate=function(va){return arguments.length?(or=+va[0],Rr=+va[1],qi()):[or,Rr]},oi.center=function(va){return arguments.length?(tn=va[0]%360*p,dn=va[1]%360*p,qi()):[tn*y,dn*y]},oi.rotate=function(va){return arguments.length?(Mn=va[0]%360*p,Ln=va[1]%360*p,Nn=va.length>2?va[2]%360*p:0,qi()):[Mn*y,Ln*y,Nn*y]},oi.angle=function(va){return arguments.length?(zn=va%360*p,qi()):zn*y},oi.reflectX=function(va){return arguments.length?(Pn=va?-1:1,qi()):Pn<0},oi.reflectY=function(va){return arguments.length?(Vn=va?-1:1,qi()):Vn<0},oi.precision=function(va){return arguments.length?(Qa=Cu(di,Ga=va*va),Ja()):l(Ga)},oi.fitExtent=function(va,xi){return ps(oi,va,xi)},oi.fitSize=function(va,xi){return dl(oi,va,xi)},oi.fitWidth=function(va,xi){return Zl(oi,va,xi)},oi.fitHeight=function(va,xi){return ou(oi,va,xi)};function qi(){var va=ds(cr,0,0,Pn,Vn,zn).apply(null,zt(tn,dn)),xi=(zn?ds:jl)(cr,or-va[0],Rr-va[1],Pn,Vn,zn);return yn=nt(Mn,Ln,Nn),di=ke(zt,xi),gi=ke(yn,di),Qa=Cu(di,Ga),Ja()}function Ja(){return mi=Ai=null,oi}return function(){return zt=gt.apply(this,arguments),oi.invert=zt.invert&&yo,qi()}}function Ts(gt){var zt=0,cr=t/3,or=Il(gt),Rr=or(zt,cr);return Rr.parallels=function(tn){return arguments.length?or(zt=tn[0]*p,cr=tn[1]*p):[zt*y,cr*y]},Rr}function As(gt){var zt=u(gt);function cr(or,Rr){return[or*zt,f(Rr)/zt]}return cr.invert=function(or,Rr){return[or/zt,k(Rr*zt)]},cr}function oo(gt,zt){var cr=f(gt),or=(cr+f(zt))/2;if(g(or)<n)return As(gt);var Rr=1+cr*(2*or-cr),tn=l(Rr)/or;function dn(Mn,Ln){var Nn=l(Rr-2*or*f(Ln))/or;return[Nn*f(Mn*=or),tn-Nn*u(Mn)]}return dn.invert=function(Mn,Ln){var Nn=tn-Ln,yn=m(Mn,g(Nn))*x(Nn);return Nn*or<0&&(yn-=t*x(Mn)*x(Nn)),[yn/or,k((Rr-(Mn*Mn+Nn*Nn)*or*or)/(2*or))]},dn}function yl(){return Ts(oo).scale(155.424).center([0,33.6442])}function ml(){return yl().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function Xs(gt){var zt=gt.length;return{point:function(cr,or){for(var Rr=-1;++Rr<zt;)gt[Rr].point(cr,or)},sphere:function(){for(var cr=-1;++cr<zt;)gt[cr].sphere()},lineStart:function(){for(var cr=-1;++cr<zt;)gt[cr].lineStart()},lineEnd:function(){for(var cr=-1;++cr<zt;)gt[cr].lineEnd()},polygonStart:function(){for(var cr=-1;++cr<zt;)gt[cr].polygonStart()},polygonEnd:function(){for(var cr=-1;++cr<zt;)gt[cr].polygonEnd()}}}function gs(){var gt,zt,cr=ml(),or,Rr=yl().rotate([154,0]).center([-2,58.5]).parallels([55,65]),tn,dn=yl().rotate([157,0]).center([-3,19.9]).parallels([8,18]),Mn,Ln,Nn={point:function(Pn,Vn){Ln=[Pn,Vn]}};function yn(Pn){var Vn=Pn[0],$n=Pn[1];return Ln=null,or.point(Vn,$n),Ln||(tn.point(Vn,$n),Ln)||(Mn.point(Vn,$n),Ln)}yn.invert=function(Pn){var Vn=cr.scale(),$n=cr.translate(),za=(Pn[0]-$n[0])/Vn,ka=(Pn[1]-$n[1])/Vn;return(ka>=.12&&ka<.234&&za>=-.425&&za<-.214?Rr:ka>=.166&&ka<.234&&za>=-.214&&za<-.115?dn:cr).invert(Pn)},yn.stream=function(Pn){return gt&&zt===Pn?gt:gt=Xs([cr.stream(zt=Pn),Rr.stream(Pn),dn.stream(Pn)])},yn.precision=function(Pn){return arguments.length?(cr.precision(Pn),Rr.precision(Pn),dn.precision(Pn),zn()):cr.precision()},yn.scale=function(Pn){return arguments.length?(cr.scale(Pn),Rr.scale(Pn*.35),dn.scale(Pn),yn.translate(cr.translate())):cr.scale()},yn.translate=function(Pn){if(!arguments.length)return cr.translate();var Vn=cr.scale(),$n=+Pn[0],za=+Pn[1];return or=cr.translate(Pn).clipExtent([[$n-.455*Vn,za-.238*Vn],[$n+.455*Vn,za+.238*Vn]]).stream(Nn),tn=Rr.translate([$n-.307*Vn,za+.201*Vn]).clipExtent([[$n-.425*Vn+n,za+.12*Vn+n],[$n-.214*Vn-n,za+.234*Vn-n]]).stream(Nn),Mn=dn.translate([$n-.205*Vn,za+.212*Vn]).clipExtent([[$n-.214*Vn+n,za+.166*Vn+n],[$n-.115*Vn-n,za+.234*Vn-n]]).stream(Nn),zn()},yn.fitExtent=function(Pn,Vn){return ps(yn,Pn,Vn)},yn.fitSize=function(Pn,Vn){return dl(yn,Pn,Vn)},yn.fitWidth=function(Pn,Vn){return Zl(yn,Pn,Vn)},yn.fitHeight=function(Pn,Vn){return ou(yn,Pn,Vn)};function zn(){return gt=zt=null,yn}return yn.scale(1070)}function xl(gt){return function(zt,cr){var or=u(zt),Rr=u(cr),tn=gt(or*Rr);return[tn*Rr*f(zt),tn*f(cr)]}}function sl(gt){return function(zt,cr){var or=l(zt*zt+cr*cr),Rr=gt(or),tn=f(Rr),dn=u(Rr);return[m(zt*tn,or*dn),k(or&&cr*tn/or)]}}var zl=xl(function(gt){return l(2/(1+gt))});zl.invert=sl(function(gt){return 2*k(gt/2)});function bl(){return So(zl).scale(124.75).clipAngle(180-.001)}var Zs=xl(function(gt){return(gt=T(gt))&&gt/f(gt)});Zs.invert=sl(function(gt){return gt});function Lu(){return So(Zs).scale(79.4188).clipAngle(180-.001)}function rs(gt,zt){return[gt,A(L((c+zt)/2))]}rs.invert=function(gt,zt){return[gt,2*h(s(zt))-c]};function Yu(){return Kl(rs).scale(961/i)}function Kl(gt){var zt=So(gt),cr=zt.center,or=zt.scale,Rr=zt.translate,tn=zt.clipExtent,dn=null,Mn,Ln,Nn;zt.scale=function(zn){return arguments.length?(or(zn),yn()):or()},zt.translate=function(zn){return arguments.length?(Rr(zn),yn()):Rr()},zt.center=function(zn){return arguments.length?(cr(zn),yn()):cr()},zt.clipExtent=function(zn){return arguments.length?(zn==null?dn=Mn=Ln=Nn=null:(dn=+zn[0][0],Mn=+zn[0][1],Ln=+zn[1][0],Nn=+zn[1][1]),yn()):dn==null?null:[[dn,Mn],[Ln,Nn]]};function yn(){var zn=t*or(),Pn=zt(dt(zt.rotate()).invert([0,0]));return tn(dn==null?[[Pn[0]-zn,Pn[1]-zn],[Pn[0]+zn,Pn[1]+zn]]:gt===rs?[[Math.max(Pn[0]-zn,dn),Mn],[Math.min(Pn[0]+zn,Ln),Nn]]:[[dn,Math.max(Pn[1]-zn,Mn)],[Ln,Math.min(Pn[1]+zn,Nn)]])}return yn()}function ll(gt){return L((c+gt)/2)}function _l(gt,zt){var cr=u(gt),or=gt===zt?f(gt):A(cr/u(zt))/A(ll(zt)/ll(gt)),Rr=cr*b(ll(gt),or)/or;if(!or)return rs;function tn(dn,Mn){Rr>0?Mn<-c+n&&(Mn=-c+n):Mn>c-n&&(Mn=c-n);var Ln=Rr/b(ll(Mn),or);return[Ln*f(or*dn),Rr-Ln*u(or*dn)]}return tn.invert=function(dn,Mn){var Ln=Rr-Mn,Nn=x(or)*l(dn*dn+Ln*Ln),yn=m(dn,g(Ln))*x(Ln);return Ln*or<0&&(yn-=t*x(dn)*x(Ln)),[yn/or,2*h(b(Rr/Nn,1/or))-c]},tn}function js(){return Ts(_l).scale(109.5).parallels([30,30])}function wl(gt,zt){return[gt,zt]}wl.invert=wl;function uu(){return So(wl).scale(152.63)}function fu(gt,zt){var cr=u(gt),or=gt===zt?f(gt):(cr-u(zt))/(zt-gt),Rr=cr/or+gt;if(g(or)<n)return wl;function tn(dn,Mn){var Ln=Rr-Mn,Nn=or*dn;return[Ln*f(Nn),Rr-Ln*u(Nn)]}return tn.invert=function(dn,Mn){var Ln=Rr-Mn,Nn=m(dn,g(Ln))*x(Ln);return Ln*or<0&&(Nn-=t*x(dn)*x(Ln)),[Nn/or,Rr-x(or)*l(dn*dn+Ln*Ln)]},tn}function Wu(){return Ts(fu).scale(131.154).center([0,13.9389])}var Ri=1.340264,ul=-.081106,Ks=893e-6,Qo=.003796,ns=l(3)/2,Tl=12;function so(gt,zt){var cr=k(ns*f(zt)),or=cr*cr,Rr=or*or*or;return[gt*u(cr)/(ns*(Ri+3*ul*or+Rr*(7*Ks+9*Qo*or))),cr*(Ri+ul*or+Rr*(Ks+Qo*or))]}so.invert=function(gt,zt){for(var cr=zt,or=cr*cr,Rr=or*or*or,tn=0,dn,Mn,Ln;tn<Tl&&(Mn=cr*(Ri+ul*or+Rr*(Ks+Qo*or))-zt,Ln=Ri+3*ul*or+Rr*(7*Ks+9*Qo*or),cr-=dn=Mn/Ln,or=cr*cr,Rr=or*or*or,!(g(dn)<r));++tn);return[ns*gt*(Ri+3*ul*or+Rr*(7*Ks+9*Qo*or))/u(cr),k(f(cr)/ns)]};function cu(){return So(so).scale(177.158)}function as(gt,zt){var cr=u(zt),or=u(gt)*cr;return[cr*f(gt)/or,f(zt)/or]}as.invert=sl(h);function zs(){return So(as).scale(144.049).clipAngle(60)}function Fs(){var gt=1,zt=0,cr=0,or=1,Rr=1,tn=0,dn,Mn,Ln=null,Nn,yn,zn,Pn=1,Vn=1,$n=Ws({point:function(ha,Ga){var Qa=Jn([ha,Ga]);this.stream.point(Qa[0],Qa[1])}}),za=un,ka,Fa;function Oa(){return Pn=gt*or,Vn=gt*Rr,ka=Fa=null,Jn}function Jn(ha){var Ga=ha[0]*Pn,Qa=ha[1]*Vn;if(tn){var di=Qa*dn-Ga*Mn;Ga=Ga*dn+Qa*Mn,Qa=di}return[Ga+zt,Qa+cr]}return Jn.invert=function(ha){var Ga=ha[0]-zt,Qa=ha[1]-cr;if(tn){var di=Qa*dn+Ga*Mn;Ga=Ga*dn-Qa*Mn,Qa=di}return[Ga/Pn,Qa/Vn]},Jn.stream=function(ha){return ka&&Fa===ha?ka:ka=$n(za(Fa=ha))},Jn.postclip=function(ha){return arguments.length?(za=ha,Ln=Nn=yn=zn=null,Oa()):za},Jn.clipExtent=function(ha){return arguments.length?(za=ha==null?(Ln=Nn=yn=zn=null,un):ln(Ln=+ha[0][0],Nn=+ha[0][1],yn=+ha[1][0],zn=+ha[1][1]),Oa()):Ln==null?null:[[Ln,Nn],[yn,zn]]},Jn.scale=function(ha){return arguments.length?(gt=+ha,Oa()):gt},Jn.translate=function(ha){return arguments.length?(zt=+ha[0],cr=+ha[1],Oa()):[zt,cr]},Jn.angle=function(ha){return arguments.length?(tn=ha%360*p,Mn=f(tn),dn=u(tn),Oa()):tn*y},Jn.reflectX=function(ha){return arguments.length?(or=ha?-1:1,Oa()):or<0},Jn.reflectY=function(ha){return arguments.length?(Rr=ha?-1:1,Oa()):Rr<0},Jn.fitExtent=function(ha,Ga){return ps(Jn,ha,Ga)},Jn.fitSize=function(ha,Ga){return dl(Jn,ha,Ga)},Jn.fitWidth=function(ha,Ga){return Zl(Jn,ha,Ga)},Jn.fitHeight=function(ha,Ga){return ou(Jn,ha,Ga)},Jn}function Ms(gt,zt){var cr=zt*zt,or=cr*cr;return[gt*(.8707-.131979*cr+or*(-.013791+or*(.003971*cr-.001529*or))),zt*(1.007226+cr*(.015085+or*(-.044475+.028874*cr-.005916*or)))]}Ms.invert=function(gt,zt){var cr=zt,or=25,Rr;do{var tn=cr*cr,dn=tn*tn;cr-=Rr=(cr*(1.007226+tn*(.015085+dn*(-.044475+.028874*tn-.005916*dn)))-zt)/(1.007226+tn*(.015085*3+dn*(-.044475*7+.028874*9*tn-.005916*11*dn)))}while(g(Rr)>n&&--or>0);return[gt/(.8707+(tn=cr*cr)*(-.131979+tn*(-.013791+tn*tn*tn*(.003971-.001529*tn)))),cr]};function is(){return So(Ms).scale(175.295)}function Hi(gt,zt){return[u(zt)*f(gt),f(zt)]}Hi.invert=sl(k);function ko(){return So(Hi).scale(249.5).clipAngle(90+n)}function os(gt,zt){var cr=u(zt),or=1+u(gt)*cr;return[cr*f(gt)/or,f(zt)/or]}os.invert=sl(function(gt){return 2*h(gt)});function hu(){return So(os).scale(250).clipAngle(142)}function Fl(gt,zt){return[A(L((c+zt)/2)),-gt]}Fl.invert=function(gt,zt){return[-zt,2*h(s(gt))-c]};function vu(){var gt=Kl(Fl),zt=gt.center,cr=gt.rotate;return gt.center=function(or){return arguments.length?zt([-or[1],or[0]]):(or=zt(),[or[1],-or[0]])},gt.rotate=function(or){return arguments.length?cr([or[0],or[1],or.length>2?or[2]+90:90]):(or=cr(),[or[0],or[1],or[2]-90])},cr([0,0,90]).scale(159.155)}w.geoAlbers=ml,w.geoAlbersUsa=gs,w.geoArea=W,w.geoAzimuthalEqualArea=bl,w.geoAzimuthalEqualAreaRaw=zl,w.geoAzimuthalEquidistant=Lu,w.geoAzimuthalEquidistantRaw=Zs,w.geoBounds=Ue,w.geoCentroid=wt,w.geoCircle=ir,w.geoClipAntimeridian=Vt,w.geoClipCircle=Ir,w.geoClipExtent=Bn,w.geoClipRectangle=ln,w.geoConicConformal=js,w.geoConicConformalRaw=_l,w.geoConicEqualArea=yl,w.geoConicEqualAreaRaw=oo,w.geoConicEquidistant=Wu,w.geoConicEquidistantRaw=fu,w.geoContains=hr,w.geoDistance=An,w.geoEqualEarth=cu,w.geoEqualEarthRaw=so,w.geoEquirectangular=uu,w.geoEquirectangularRaw=wl,w.geoGnomonic=zs,w.geoGnomonicRaw=as,w.geoGraticule=en,w.geoGraticule10=Tn,w.geoIdentity=Fs,w.geoInterpolate=xn,w.geoLength=wr,w.geoMercator=Yu,w.geoMercatorRaw=rs,w.geoNaturalEarth1=is,w.geoNaturalEarth1Raw=Ms,w.geoOrthographic=ko,w.geoOrthographicRaw=Hi,w.geoPath=Pl,w.geoProjection=So,w.geoProjectionMutator=Il,w.geoRotation=dt,w.geoStereographic=hu,w.geoStereographicRaw=os,w.geoStream=H,w.geoTransform=Eu,w.geoTransverseMercator=vu,w.geoTransverseMercatorRaw=Fl,Object.defineProperty(w,"__esModule",{value:!0})})},{"d3-array":107}],115:[function(d,ee,te){(function(w,v){typeof te=="object"&&typeof ee<"u"?v(te):(w=w||self,v(w.d3=w.d3||{}))})(this,function(w){function v(Ve,Ae){return Ve.parent===Ae.parent?1:2}function S(Ve){return Ve.reduce(M,0)/Ve.length}function M(Ve,Ae){return Ve+Ae.x}function e(Ve){return 1+Ve.reduce(a,0)}function a(Ve,Ae){return Math.max(Ve,Ae.y)}function n(Ve){for(var Ae;Ae=Ve.children;)Ve=Ae[0];return Ve}function r(Ve){for(var Ae;Ae=Ve.children;)Ve=Ae[Ae.length-1];return Ve}function t(){var Ve=v,Ae=1,Ne=1,Xe=!1;function Je(_t){var mt,Ot=0;_t.eachAfter(function(Yt){var fr=Yt.children;fr?(Yt.x=S(fr),Yt.y=e(fr)):(Yt.x=mt?Ot+=Ve(Yt,mt):0,Yt.y=0,mt=Yt)});var Kt=n(_t),Nt=r(_t),Wt=Kt.x-Ve(Kt,Nt)/2,qt=Nt.x+Ve(Nt,Kt)/2;return _t.eachAfter(Xe?function(Yt){Yt.x=(Yt.x-_t.x)*Ae,Yt.y=(_t.y-Yt.y)*Ne}:function(Yt){Yt.x=(Yt.x-Wt)/(qt-Wt)*Ae,Yt.y=(1-(_t.y?Yt.y/_t.y:1))*Ne})}return Je.separation=function(_t){return arguments.length?(Ve=_t,Je):Ve},Je.size=function(_t){return arguments.length?(Xe=!1,Ae=+_t[0],Ne=+_t[1],Je):Xe?null:[Ae,Ne]},Je.nodeSize=function(_t){return arguments.length?(Xe=!0,Ae=+_t[0],Ne=+_t[1],Je):Xe?[Ae,Ne]:null},Je}function c(Ve){var Ae=0,Ne=Ve.children,Xe=Ne&&Ne.length;if(!Xe)Ae=1;else for(;--Xe>=0;)Ae+=Ne[Xe].value;Ve.value=Ae}function o(){return this.eachAfter(c)}function i(Ve){var Ae=this,Ne,Xe=[Ae],Je,_t,mt;do for(Ne=Xe.reverse(),Xe=[];Ae=Ne.pop();)if(Ve(Ae),Je=Ae.children,Je)for(_t=0,mt=Je.length;_t<mt;++_t)Xe.push(Je[_t]);while(Xe.length);return this}function y(Ve){for(var Ae=this,Ne=[Ae],Xe,Je;Ae=Ne.pop();)if(Ve(Ae),Xe=Ae.children,Xe)for(Je=Xe.length-1;Je>=0;--Je)Ne.push(Xe[Je]);return this}function p(Ve){for(var Ae=this,Ne=[Ae],Xe=[],Je,_t,mt;Ae=Ne.pop();)if(Xe.push(Ae),Je=Ae.children,Je)for(_t=0,mt=Je.length;_t<mt;++_t)Ne.push(Je[_t]);for(;Ae=Xe.pop();)Ve(Ae);return this}function g(Ve){return this.eachAfter(function(Ae){for(var Ne=+Ve(Ae.data)||0,Xe=Ae.children,Je=Xe&&Xe.length;--Je>=0;)Ne+=Xe[Je].value;Ae.value=Ne})}function h(Ve){return this.eachBefore(function(Ae){Ae.children&&Ae.children.sort(Ve)})}function m(Ve){for(var Ae=this,Ne=u(Ae,Ve),Xe=[Ae];Ae!==Ne;)Ae=Ae.parent,Xe.push(Ae);for(var Je=Xe.length;Ve!==Ne;)Xe.splice(Je,0,Ve),Ve=Ve.parent;return Xe}function u(Ve,Ae){if(Ve===Ae)return Ve;var Ne=Ve.ancestors(),Xe=Ae.ancestors(),Je=null;for(Ve=Ne.pop(),Ae=Xe.pop();Ve===Ae;)Je=Ve,Ve=Ne.pop(),Ae=Xe.pop();return Je}function _(){for(var Ve=this,Ae=[Ve];Ve=Ve.parent;)Ae.push(Ve);return Ae}function s(){var Ve=[];return this.each(function(Ae){Ve.push(Ae)}),Ve}function A(){var Ve=[];return this.eachBefore(function(Ae){Ae.children||Ve.push(Ae)}),Ve}function b(){var Ve=this,Ae=[];return Ve.each(function(Ne){Ne!==Ve&&Ae.push({source:Ne.parent,target:Ne})}),Ae}function f(Ve,Ae){var Ne=new k(Ve),Xe=+Ve.value&&(Ne.value=Ve.value),Je,_t=[Ne],mt,Ot,Kt,Nt;for(Ae==null&&(Ae=l);Je=_t.pop();)if(Xe&&(Je.value=+Je.data.value),(Ot=Ae(Je.data))&&(Nt=Ot.length))for(Je.children=new Array(Nt),Kt=Nt-1;Kt>=0;--Kt)_t.push(mt=Je.children[Kt]=new k(Ot[Kt])),mt.parent=Je,mt.depth=Je.depth+1;return Ne.eachBefore(T)}function x(){return f(this).eachBefore(L)}function l(Ve){return Ve.children}function L(Ve){Ve.data=Ve.data.data}function T(Ve){var Ae=0;do Ve.height=Ae;while((Ve=Ve.parent)&&Ve.height<++Ae)}function k(Ve){this.data=Ve,this.depth=this.height=0,this.parent=null}k.prototype=f.prototype={constructor:k,count:o,each:i,eachAfter:p,eachBefore:y,sum:g,sort:h,path:m,ancestors:_,descendants:s,leaves:A,links:b,copy:x};var P=Array.prototype.slice;function z(Ve){for(var Ae=Ve.length,Ne,Xe;Ae;)Xe=Math.random()*Ae--|0,Ne=Ve[Ae],Ve[Ae]=Ve[Xe],Ve[Xe]=Ne;return Ve}function I(Ve){for(var Ae=0,Ne=(Ve=z(P.call(Ve))).length,Xe=[],Je,_t;Ae<Ne;)Je=Ve[Ae],_t&&B(_t,Je)?++Ae:(_t=H(Xe=D(Xe,Je)),Ae=0);return _t}function D(Ve,Ae){var Ne,Xe;if(F(Ae,Ve))return[Ae];for(Ne=0;Ne<Ve.length;++Ne)if(R(Ae,Ve[Ne])&&F(J(Ve[Ne],Ae),Ve))return[Ve[Ne],Ae];for(Ne=0;Ne<Ve.length-1;++Ne)for(Xe=Ne+1;Xe<Ve.length;++Xe)if(R(J(Ve[Ne],Ve[Xe]),Ae)&&R(J(Ve[Ne],Ae),Ve[Xe])&&R(J(Ve[Xe],Ae),Ve[Ne])&&F(X(Ve[Ne],Ve[Xe],Ae),Ve))return[Ve[Ne],Ve[Xe],Ae];throw new Error}function R(Ve,Ae){var Ne=Ve.r-Ae.r,Xe=Ae.x-Ve.x,Je=Ae.y-Ve.y;return Ne<0||Ne*Ne<Xe*Xe+Je*Je}function B(Ve,Ae){var Ne=Ve.r-Ae.r+1e-6,Xe=Ae.x-Ve.x,Je=Ae.y-Ve.y;return Ne>0&&Ne*Ne>Xe*Xe+Je*Je}function F(Ve,Ae){for(var Ne=0;Ne<Ae.length;++Ne)if(!B(Ve,Ae[Ne]))return!1;return!0}function H(Ve){switch(Ve.length){case 1:return G(Ve[0]);case 2:return J(Ve[0],Ve[1]);case 3:return X(Ve[0],Ve[1],Ve[2])}}function G(Ve){return{x:Ve.x,y:Ve.y,r:Ve.r}}function J(Ve,Ae){var Ne=Ve.x,Xe=Ve.y,Je=Ve.r,_t=Ae.x,mt=Ae.y,Ot=Ae.r,Kt=_t-Ne,Nt=mt-Xe,Wt=Ot-Je,qt=Math.sqrt(Kt*Kt+Nt*Nt);return{x:(Ne+_t+Kt/qt*Wt)/2,y:(Xe+mt+Nt/qt*Wt)/2,r:(qt+Je+Ot)/2}}function X(Ve,Ae,Ne){var Xe=Ve.x,Je=Ve.y,_t=Ve.r,mt=Ae.x,Ot=Ae.y,Kt=Ae.r,Nt=Ne.x,Wt=Ne.y,qt=Ne.r,Yt=Xe-mt,fr=Xe-Nt,Yr=Je-Ot,hn=Je-Wt,Qr=Kt-_t,at=qt-_t,Jt=Xe*Xe+Je*Je-_t*_t,Zt=Jt-mt*mt-Ot*Ot+Kt*Kt,Ut=Jt-Nt*Nt-Wt*Wt+qt*qt,_r=fr*Yr-Yt*hn,rt=(Yr*Ut-hn*Zt)/(_r*2)-Xe,Ke=(hn*Qr-Yr*at)/_r,st=(fr*Zt-Yt*Ut)/(_r*2)-Je,lt=(Yt*at-fr*Qr)/_r,wt=Ke*Ke+lt*lt-1,Pt=2*(_t+rt*Ke+st*lt),ke=rt*rt+st*st-_t*_t,Se=-(wt?(Pt+Math.sqrt(Pt*Pt-4*wt*ke))/(2*wt):ke/Pt);return{x:Xe+rt+Ke*Se,y:Je+st+lt*Se,r:Se}}function Y(Ve,Ae,Ne){var Xe=Ve.x-Ae.x,Je,_t,mt=Ve.y-Ae.y,Ot,Kt,Nt=Xe*Xe+mt*mt;Nt?(_t=Ae.r+Ne.r,_t*=_t,Kt=Ve.r+Ne.r,Kt*=Kt,_t>Kt?(Je=(Nt+Kt-_t)/(2*Nt),Ot=Math.sqrt(Math.max(0,Kt/Nt-Je*Je)),Ne.x=Ve.x-Je*Xe-Ot*mt,Ne.y=Ve.y-Je*mt+Ot*Xe):(Je=(Nt+_t-Kt)/(2*Nt),Ot=Math.sqrt(Math.max(0,_t/Nt-Je*Je)),Ne.x=Ae.x+Je*Xe-Ot*mt,Ne.y=Ae.y+Je*mt+Ot*Xe)):(Ne.x=Ae.x+Ne.r,Ne.y=Ae.y)}function Z(Ve,Ae){var Ne=Ve.r+Ae.r-1e-6,Xe=Ae.x-Ve.x,Je=Ae.y-Ve.y;return Ne>0&&Ne*Ne>Xe*Xe+Je*Je}function oe(Ve){var Ae=Ve._,Ne=Ve.next._,Xe=Ae.r+Ne.r,Je=(Ae.x*Ne.r+Ne.x*Ae.r)/Xe,_t=(Ae.y*Ne.r+Ne.y*Ae.r)/Xe;return Je*Je+_t*_t}function re(Ve){this._=Ve,this.next=null,this.previous=null}function se(Ve){if(!(Je=Ve.length))return 0;var Ae,Ne,Xe,Je,_t,mt,Ot,Kt,Nt,Wt,qt;if(Ae=Ve[0],Ae.x=0,Ae.y=0,!(Je>1))return Ae.r;if(Ne=Ve[1],Ae.x=-Ne.r,Ne.x=Ae.r,Ne.y=0,!(Je>2))return Ae.r+Ne.r;Y(Ne,Ae,Xe=Ve[2]),Ae=new re(Ae),Ne=new re(Ne),Xe=new re(Xe),Ae.next=Xe.previous=Ne,Ne.next=Ae.previous=Xe,Xe.next=Ne.previous=Ae;e:for(Ot=3;Ot<Je;++Ot){Y(Ae._,Ne._,Xe=Ve[Ot]),Xe=new re(Xe),Kt=Ne.next,Nt=Ae.previous,Wt=Ne._.r,qt=Ae._.r;do if(Wt<=qt){if(Z(Kt._,Xe._)){Ne=Kt,Ae.next=Ne,Ne.previous=Ae,--Ot;continue e}Wt+=Kt._.r,Kt=Kt.next}else{if(Z(Nt._,Xe._)){Ae=Nt,Ae.next=Ne,Ne.previous=Ae,--Ot;continue e}qt+=Nt._.r,Nt=Nt.previous}while(Kt!==Nt.next);for(Xe.previous=Ae,Xe.next=Ne,Ae.next=Ne.previous=Ne=Xe,_t=oe(Ae);(Xe=Xe.next)!==Ne;)(mt=oe(Xe))<_t&&(Ae=Xe,_t=mt);Ne=Ae.next}for(Ae=[Ne._],Xe=Ne;(Xe=Xe.next)!==Ne;)Ae.push(Xe._);for(Xe=I(Ae),Ot=0;Ot<Je;++Ot)Ae=Ve[Ot],Ae.x-=Xe.x,Ae.y-=Xe.y;return Xe.r}function N(Ve){return se(Ve),Ve}function U(Ve){return Ve==null?null:q(Ve)}function q(Ve){if(typeof Ve!="function")throw new Error;return Ve}function $(){return 0}function W(Ve){return function(){return Ve}}function K(Ve){return Math.sqrt(Ve.value)}function ne(){var Ve=null,Ae=1,Ne=1,Xe=$;function Je(_t){return _t.x=Ae/2,_t.y=Ne/2,Ve?_t.eachBefore(ae(Ve)).eachAfter(ie(Xe,.5)).eachBefore(le(1)):_t.eachBefore(ae(K)).eachAfter(ie($,1)).eachAfter(ie(Xe,_t.r/Math.min(Ae,Ne))).eachBefore(le(Math.min(Ae,Ne)/(2*_t.r))),_t}return Je.radius=function(_t){return arguments.length?(Ve=U(_t),Je):Ve},Je.size=function(_t){return arguments.length?(Ae=+_t[0],Ne=+_t[1],Je):[Ae,Ne]},Je.padding=function(_t){return arguments.length?(Xe=typeof _t=="function"?_t:W(+_t),Je):Xe},Je}function ae(Ve){return function(Ae){Ae.children||(Ae.r=Math.max(0,+Ve(Ae)||0))}}function ie(Ve,Ae){return function(Ne){if(Xe=Ne.children){var Xe,Je,_t=Xe.length,mt=Ve(Ne)*Ae||0,Ot;if(mt)for(Je=0;Je<_t;++Je)Xe[Je].r+=mt;if(Ot=se(Xe),mt)for(Je=0;Je<_t;++Je)Xe[Je].r-=mt;Ne.r=Ot+mt}}}function le(Ve){return function(Ae){var Ne=Ae.parent;Ae.r*=Ve,Ne&&(Ae.x=Ne.x+Ve*Ae.x,Ae.y=Ne.y+Ve*Ae.y)}}function ye(Ve){Ve.x0=Math.round(Ve.x0),Ve.y0=Math.round(Ve.y0),Ve.x1=Math.round(Ve.x1),Ve.y1=Math.round(Ve.y1)}function ue(Ve,Ae,Ne,Xe,Je){for(var _t=Ve.children,mt,Ot=-1,Kt=_t.length,Nt=Ve.value&&(Xe-Ae)/Ve.value;++Ot<Kt;)mt=_t[Ot],mt.y0=Ne,mt.y1=Je,mt.x0=Ae,mt.x1=Ae+=mt.value*Nt}function pe(){var Ve=1,Ae=1,Ne=0,Xe=!1;function Je(mt){var Ot=mt.height+1;return mt.x0=mt.y0=Ne,mt.x1=Ve,mt.y1=Ae/Ot,mt.eachBefore(_t(Ae,Ot)),Xe&&mt.eachBefore(ye),mt}function _t(mt,Ot){return function(Kt){Kt.children&&ue(Kt,Kt.x0,mt*(Kt.depth+1)/Ot,Kt.x1,mt*(Kt.depth+2)/Ot);var Nt=Kt.x0,Wt=Kt.y0,qt=Kt.x1-Ne,Yt=Kt.y1-Ne;qt<Nt&&(Nt=qt=(Nt+qt)/2),Yt<Wt&&(Wt=Yt=(Wt+Yt)/2),Kt.x0=Nt,Kt.y0=Wt,Kt.x1=qt,Kt.y1=Yt}}return Je.round=function(mt){return arguments.length?(Xe=!!mt,Je):Xe},Je.size=function(mt){return arguments.length?(Ve=+mt[0],Ae=+mt[1],Je):[Ve,Ae]},Je.padding=function(mt){return arguments.length?(Ne=+mt,Je):Ne},Je}var ge="$",Te={depth:-1},_e={};function ze(Ve){return Ve.id}function Oe(Ve){return Ve.parentId}function Ye(){var Ve=ze,Ae=Oe;function Ne(Xe){var Je,_t,mt=Xe.length,Ot,Kt,Nt,Wt=new Array(mt),qt,Yt,fr={};for(_t=0;_t<mt;++_t)Je=Xe[_t],Nt=Wt[_t]=new k(Je),(qt=Ve(Je,_t,Xe))!=null&&(qt+="")&&(Yt=ge+(Nt.id=qt),fr[Yt]=Yt in fr?_e:Nt);for(_t=0;_t<mt;++_t)if(Nt=Wt[_t],qt=Ae(Xe[_t],_t,Xe),qt==null||!(qt+="")){if(Ot)throw new Error("multiple roots");Ot=Nt}else{if(Kt=fr[ge+qt],!Kt)throw new Error("missing: "+qt);if(Kt===_e)throw new Error("ambiguous: "+qt);Kt.children?Kt.children.push(Nt):Kt.children=[Nt],Nt.parent=Kt}if(!Ot)throw new Error("no root");if(Ot.parent=Te,Ot.eachBefore(function(Yr){Yr.depth=Yr.parent.depth+1,--mt}).eachBefore(T),Ot.parent=null,mt>0)throw new Error("cycle");return Ot}return Ne.id=function(Xe){return arguments.length?(Ve=q(Xe),Ne):Ve},Ne.parentId=function(Xe){return arguments.length?(Ae=q(Xe),Ne):Ae},Ne}function be(Ve,Ae){return Ve.parent===Ae.parent?1:2}function Pe(Ve){var Ae=Ve.children;return Ae?Ae[0]:Ve.t}function Ge(Ve){var Ae=Ve.children;return Ae?Ae[Ae.length-1]:Ve.t}function Qe(Ve,Ae,Ne){var Xe=Ne/(Ae.i-Ve.i);Ae.c-=Xe,Ae.s+=Ne,Ve.c+=Xe,Ae.z+=Ne,Ae.m+=Ne}function Be(Ve){for(var Ae=0,Ne=0,Xe=Ve.children,Je=Xe.length,_t;--Je>=0;)_t=Xe[Je],_t.z+=Ae,_t.m+=Ae,Ae+=_t.s+(Ne+=_t.c)}function Le(Ve,Ae,Ne){return Ve.a.parent===Ae.parent?Ve.a:Ne}function He(Ve,Ae){this._=Ve,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=Ae}He.prototype=Object.create(k.prototype);function vt(Ve){for(var Ae=new He(Ve,0),Ne,Xe=[Ae],Je,_t,mt,Ot;Ne=Xe.pop();)if(_t=Ne._.children)for(Ne.children=new Array(Ot=_t.length),mt=Ot-1;mt>=0;--mt)Xe.push(Je=Ne.children[mt]=new He(_t[mt],mt)),Je.parent=Ne;return(Ae.parent=new He(null,0)).children=[Ae],Ae}function Rt(){var Ve=be,Ae=1,Ne=1,Xe=null;function Je(Nt){var Wt=vt(Nt);if(Wt.eachAfter(_t),Wt.parent.m=-Wt.z,Wt.eachBefore(mt),Xe)Nt.eachBefore(Kt);else{var qt=Nt,Yt=Nt,fr=Nt;Nt.eachBefore(function(Jt){Jt.x<qt.x&&(qt=Jt),Jt.x>Yt.x&&(Yt=Jt),Jt.depth>fr.depth&&(fr=Jt)});var Yr=qt===Yt?1:Ve(qt,Yt)/2,hn=Yr-qt.x,Qr=Ae/(Yt.x+Yr+hn),at=Ne/(fr.depth||1);Nt.eachBefore(function(Jt){Jt.x=(Jt.x+hn)*Qr,Jt.y=Jt.depth*at})}return Nt}function _t(Nt){var Wt=Nt.children,qt=Nt.parent.children,Yt=Nt.i?qt[Nt.i-1]:null;if(Wt){Be(Nt);var fr=(Wt[0].z+Wt[Wt.length-1].z)/2;Yt?(Nt.z=Yt.z+Ve(Nt._,Yt._),Nt.m=Nt.z-fr):Nt.z=fr}else Yt&&(Nt.z=Yt.z+Ve(Nt._,Yt._));Nt.parent.A=Ot(Nt,Yt,Nt.parent.A||qt[0])}function mt(Nt){Nt._.x=Nt.z+Nt.parent.m,Nt.m+=Nt.parent.m}function Ot(Nt,Wt,qt){if(Wt){for(var Yt=Nt,fr=Nt,Yr=Wt,hn=Yt.parent.children[0],Qr=Yt.m,at=fr.m,Jt=Yr.m,Zt=hn.m,Ut;Yr=Ge(Yr),Yt=Pe(Yt),Yr&&Yt;)hn=Pe(hn),fr=Ge(fr),fr.a=Nt,Ut=Yr.z+Jt-Yt.z-Qr+Ve(Yr._,Yt._),Ut>0&&(Qe(Le(Yr,Nt,qt),Nt,Ut),Qr+=Ut,at+=Ut),Jt+=Yr.m,Qr+=Yt.m,Zt+=hn.m,at+=fr.m;Yr&&!Ge(fr)&&(fr.t=Yr,fr.m+=Jt-at),Yt&&!Pe(hn)&&(hn.t=Yt,hn.m+=Qr-Zt,qt=Nt)}return qt}function Kt(Nt){Nt.x*=Ae,Nt.y=Nt.depth*Ne}return Je.separation=function(Nt){return arguments.length?(Ve=Nt,Je):Ve},Je.size=function(Nt){return arguments.length?(Xe=!1,Ae=+Nt[0],Ne=+Nt[1],Je):Xe?null:[Ae,Ne]},Je.nodeSize=function(Nt){return arguments.length?(Xe=!0,Ae=+Nt[0],Ne=+Nt[1],Je):Xe?[Ae,Ne]:null},Je}function rr(Ve,Ae,Ne,Xe,Je){for(var _t=Ve.children,mt,Ot=-1,Kt=_t.length,Nt=Ve.value&&(Je-Ne)/Ve.value;++Ot<Kt;)mt=_t[Ot],mt.x0=Ae,mt.x1=Xe,mt.y0=Ne,mt.y1=Ne+=mt.value*Nt}var Lt=(1+Math.sqrt(5))/2;function Ft(Ve,Ae,Ne,Xe,Je,_t){for(var mt=[],Ot=Ae.children,Kt,Nt,Wt=0,qt=0,Yt=Ot.length,fr,Yr,hn=Ae.value,Qr,at,Jt,Zt,Ut,_r,rt;Wt<Yt;){fr=Je-Ne,Yr=_t-Xe;do Qr=Ot[qt++].value;while(!Qr&&qt<Yt);for(at=Jt=Qr,_r=Math.max(Yr/fr,fr/Yr)/(hn*Ve),rt=Qr*Qr*_r,Ut=Math.max(Jt/rt,rt/at);qt<Yt;++qt){if(Qr+=Nt=Ot[qt].value,Nt<at&&(at=Nt),Nt>Jt&&(Jt=Nt),rt=Qr*Qr*_r,Zt=Math.max(Jt/rt,rt/at),Zt>Ut){Qr-=Nt;break}Ut=Zt}mt.push(Kt={value:Qr,dice:fr<Yr,children:Ot.slice(Wt,qt)}),Kt.dice?ue(Kt,Ne,Xe,Je,hn?Xe+=Yr*Qr/hn:_t):rr(Kt,Ne,Xe,hn?Ne+=fr*Qr/hn:Je,_t),hn-=Qr,Wt=qt}return mt}var Gt=function Ve(Ae){function Ne(Xe,Je,_t,mt,Ot){Ft(Ae,Xe,Je,_t,mt,Ot)}return Ne.ratio=function(Xe){return Ve((Xe=+Xe)>1?Xe:1)},Ne}(Lt);function Dt(){var Ve=Gt,Ae=!1,Ne=1,Xe=1,Je=[0],_t=$,mt=$,Ot=$,Kt=$,Nt=$;function Wt(Yt){return Yt.x0=Yt.y0=0,Yt.x1=Ne,Yt.y1=Xe,Yt.eachBefore(qt),Je=[0],Ae&&Yt.eachBefore(ye),Yt}function qt(Yt){var fr=Je[Yt.depth],Yr=Yt.x0+fr,hn=Yt.y0+fr,Qr=Yt.x1-fr,at=Yt.y1-fr;Qr<Yr&&(Yr=Qr=(Yr+Qr)/2),at<hn&&(hn=at=(hn+at)/2),Yt.x0=Yr,Yt.y0=hn,Yt.x1=Qr,Yt.y1=at,Yt.children&&(fr=Je[Yt.depth+1]=_t(Yt)/2,Yr+=Nt(Yt)-fr,hn+=mt(Yt)-fr,Qr-=Ot(Yt)-fr,at-=Kt(Yt)-fr,Qr<Yr&&(Yr=Qr=(Yr+Qr)/2),at<hn&&(hn=at=(hn+at)/2),Ve(Yt,Yr,hn,Qr,at))}return Wt.round=function(Yt){return arguments.length?(Ae=!!Yt,Wt):Ae},Wt.size=function(Yt){return arguments.length?(Ne=+Yt[0],Xe=+Yt[1],Wt):[Ne,Xe]},Wt.tile=function(Yt){return arguments.length?(Ve=q(Yt),Wt):Ve},Wt.padding=function(Yt){return arguments.length?Wt.paddingInner(Yt).paddingOuter(Yt):Wt.paddingInner()},Wt.paddingInner=function(Yt){return arguments.length?(_t=typeof Yt=="function"?Yt:W(+Yt),Wt):_t},Wt.paddingOuter=function(Yt){return arguments.length?Wt.paddingTop(Yt).paddingRight(Yt).paddingBottom(Yt).paddingLeft(Yt):Wt.paddingTop()},Wt.paddingTop=function(Yt){return arguments.length?(mt=typeof Yt=="function"?Yt:W(+Yt),Wt):mt},Wt.paddingRight=function(Yt){return arguments.length?(Ot=typeof Yt=="function"?Yt:W(+Yt),Wt):Ot},Wt.paddingBottom=function(Yt){return arguments.length?(Kt=typeof Yt=="function"?Yt:W(+Yt),Wt):Kt},Wt.paddingLeft=function(Yt){return arguments.length?(Nt=typeof Yt=="function"?Yt:W(+Yt),Wt):Nt},Wt}function kt(Ve,Ae,Ne,Xe,Je){var _t=Ve.children,mt,Ot=_t.length,Kt,Nt=new Array(Ot+1);for(Nt[0]=Kt=mt=0;mt<Ot;++mt)Nt[mt+1]=Kt+=_t[mt].value;Wt(0,Ot,Ve.value,Ae,Ne,Xe,Je);function Wt(qt,Yt,fr,Yr,hn,Qr,at){if(qt>=Yt-1){var Jt=_t[qt];Jt.x0=Yr,Jt.y0=hn,Jt.x1=Qr,Jt.y1=at;return}for(var Zt=Nt[qt],Ut=fr/2+Zt,_r=qt+1,rt=Yt-1;_r<rt;){var Ke=_r+rt>>>1;Nt[Ke]<Ut?_r=Ke+1:rt=Ke}Ut-Nt[_r-1]<Nt[_r]-Ut&&qt+1<_r&&--_r;var st=Nt[_r]-Zt,lt=fr-st;if(Qr-Yr>at-hn){var wt=(Yr*lt+Qr*st)/fr;Wt(qt,_r,st,Yr,hn,wt,at),Wt(_r,Yt,lt,wt,hn,Qr,at)}else{var Pt=(hn*lt+at*st)/fr;Wt(qt,_r,st,Yr,hn,Qr,Pt),Wt(_r,Yt,lt,Yr,Pt,Qr,at)}}}function Ue(Ve,Ae,Ne,Xe,Je){(Ve.depth&1?rr:ue)(Ve,Ae,Ne,Xe,Je)}var qe=function Ve(Ae){function Ne(Xe,Je,_t,mt,Ot){if((Kt=Xe._squarify)&&Kt.ratio===Ae)for(var Kt,Nt,Wt,qt,Yt=-1,fr,Yr=Kt.length,hn=Xe.value;++Yt<Yr;){for(Nt=Kt[Yt],Wt=Nt.children,qt=Nt.value=0,fr=Wt.length;qt<fr;++qt)Nt.value+=Wt[qt].value;Nt.dice?ue(Nt,Je,_t,mt,_t+=(Ot-_t)*Nt.value/hn):rr(Nt,Je,_t,Je+=(mt-Je)*Nt.value/hn,Ot),hn-=Nt.value}else Xe._squarify=Kt=Ft(Ae,Xe,Je,_t,mt,Ot),Kt.ratio=Ae}return Ne.ratio=function(Xe){return Ve((Xe=+Xe)>1?Xe:1)},Ne}(Lt);w.cluster=t,w.hierarchy=f,w.pack=ne,w.packEnclose=I,w.packSiblings=N,w.partition=pe,w.stratify=Ye,w.tree=Rt,w.treemap=Dt,w.treemapBinary=kt,w.treemapDice=ue,w.treemapResquarify=qe,w.treemapSlice=rr,w.treemapSliceDice=Ue,w.treemapSquarify=Gt,Object.defineProperty(w,"__esModule",{value:!0})})},{}],116:[function(d,ee,te){(function(w,v){typeof te=="object"&&typeof ee<"u"?v(te,d("d3-color")):(w=w||self,v(w.d3=w.d3||{},w.d3))})(this,function(w,v){function S(be,Pe,Ge,Qe,Be){var Le=be*be,He=Le*be;return((1-3*be+3*Le-He)*Pe+(4-6*Le+3*He)*Ge+(1+3*be+3*Le-3*He)*Qe+He*Be)/6}function M(be){var Pe=be.length-1;return function(Ge){var Qe=Ge<=0?Ge=0:Ge>=1?(Ge=1,Pe-1):Math.floor(Ge*Pe),Be=be[Qe],Le=be[Qe+1],He=Qe>0?be[Qe-1]:2*Be-Le,vt=Qe<Pe-1?be[Qe+2]:2*Le-Be;return S((Ge-Qe/Pe)*Pe,He,Be,Le,vt)}}function e(be){var Pe=be.length;return function(Ge){var Qe=Math.floor(((Ge%=1)<0?++Ge:Ge)*Pe),Be=be[(Qe+Pe-1)%Pe],Le=be[Qe%Pe],He=be[(Qe+1)%Pe],vt=be[(Qe+2)%Pe];return S((Ge-Qe/Pe)*Pe,Be,Le,He,vt)}}function a(be){return function(){return be}}function n(be,Pe){return function(Ge){return be+Ge*Pe}}function r(be,Pe,Ge){return be=Math.pow(be,Ge),Pe=Math.pow(Pe,Ge)-be,Ge=1/Ge,function(Qe){return Math.pow(be+Qe*Pe,Ge)}}function t(be,Pe){var Ge=Pe-be;return Ge?n(be,Ge>180||Ge<-180?Ge-360*Math.round(Ge/360):Ge):a(isNaN(be)?Pe:be)}function c(be){return(be=+be)==1?o:function(Pe,Ge){return Ge-Pe?r(Pe,Ge,be):a(isNaN(Pe)?Ge:Pe)}}function o(be,Pe){var Ge=Pe-be;return Ge?n(be,Ge):a(isNaN(be)?Pe:be)}var i=function be(Pe){var Ge=c(Pe);function Qe(Be,Le){var He=Ge((Be=v.rgb(Be)).r,(Le=v.rgb(Le)).r),vt=Ge(Be.g,Le.g),Rt=Ge(Be.b,Le.b),rr=o(Be.opacity,Le.opacity);return function(Lt){return Be.r=He(Lt),Be.g=vt(Lt),Be.b=Rt(Lt),Be.opacity=rr(Lt),Be+""}}return Qe.gamma=be,Qe}(1);function y(be){return function(Pe){var Ge=Pe.length,Qe=new Array(Ge),Be=new Array(Ge),Le=new Array(Ge),He,vt;for(He=0;He<Ge;++He)vt=v.rgb(Pe[He]),Qe[He]=vt.r||0,Be[He]=vt.g||0,Le[He]=vt.b||0;return Qe=be(Qe),Be=be(Be),Le=be(Le),vt.opacity=1,function(Rt){return vt.r=Qe(Rt),vt.g=Be(Rt),vt.b=Le(Rt),vt+""}}}var p=y(M),g=y(e);function h(be,Pe){Pe||(Pe=[]);var Ge=be?Math.min(Pe.length,be.length):0,Qe=Pe.slice(),Be;return function(Le){for(Be=0;Be<Ge;++Be)Qe[Be]=be[Be]*(1-Le)+Pe[Be]*Le;return Qe}}function m(be){return ArrayBuffer.isView(be)&&!(be instanceof DataView)}function u(be,Pe){return(m(Pe)?h:_)(be,Pe)}function _(be,Pe){var Ge=Pe?Pe.length:0,Qe=be?Math.min(Ge,be.length):0,Be=new Array(Qe),Le=new Array(Ge),He;for(He=0;He<Qe;++He)Be[He]=k(be[He],Pe[He]);for(;He<Ge;++He)Le[He]=Pe[He];return function(vt){for(He=0;He<Qe;++He)Le[He]=Be[He](vt);return Le}}function s(be,Pe){var Ge=new Date;return be=+be,Pe=+Pe,function(Qe){return Ge.setTime(be*(1-Qe)+Pe*Qe),Ge}}function A(be,Pe){return be=+be,Pe=+Pe,function(Ge){return be*(1-Ge)+Pe*Ge}}function b(be,Pe){var Ge={},Qe={},Be;(be===null||typeof be!="object")&&(be={}),(Pe===null||typeof Pe!="object")&&(Pe={});for(Be in Pe)Be in be?Ge[Be]=k(be[Be],Pe[Be]):Qe[Be]=Pe[Be];return function(Le){for(Be in Ge)Qe[Be]=Ge[Be](Le);return Qe}}var f=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,x=new RegExp(f.source,"g");function l(be){return function(){return be}}function L(be){return function(Pe){return be(Pe)+""}}function T(be,Pe){var Ge=f.lastIndex=x.lastIndex=0,Qe,Be,Le,He=-1,vt=[],Rt=[];for(be=be+"",Pe=Pe+"";(Qe=f.exec(be))&&(Be=x.exec(Pe));)(Le=Be.index)>Ge&&(Le=Pe.slice(Ge,Le),vt[He]?vt[He]+=Le:vt[++He]=Le),(Qe=Qe[0])===(Be=Be[0])?vt[He]?vt[He]+=Be:vt[++He]=Be:(vt[++He]=null,Rt.push({i:He,x:A(Qe,Be)})),Ge=x.lastIndex;return Ge<Pe.length&&(Le=Pe.slice(Ge),vt[He]?vt[He]+=Le:vt[++He]=Le),vt.length<2?Rt[0]?L(Rt[0].x):l(Pe):(Pe=Rt.length,function(rr){for(var Lt=0,Ft;Lt<Pe;++Lt)vt[(Ft=Rt[Lt]).i]=Ft.x(rr);return vt.join("")})}function k(be,Pe){var Ge=typeof Pe,Qe;return Pe==null||Ge==="boolean"?a(Pe):(Ge==="number"?A:Ge==="string"?(Qe=v.color(Pe))?(Pe=Qe,i):T:Pe instanceof v.color?i:Pe instanceof Date?s:m(Pe)?h:Array.isArray(Pe)?_:typeof Pe.valueOf!="function"&&typeof Pe.toString!="function"||isNaN(Pe)?b:A)(be,Pe)}function P(be){var Pe=be.length;return function(Ge){return be[Math.max(0,Math.min(Pe-1,Math.floor(Ge*Pe)))]}}function z(be,Pe){var Ge=t(+be,+Pe);return function(Qe){var Be=Ge(Qe);return Be-360*Math.floor(Be/360)}}function I(be,Pe){return be=+be,Pe=+Pe,function(Ge){return Math.round(be*(1-Ge)+Pe*Ge)}}var D=180/Math.PI,R={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function B(be,Pe,Ge,Qe,Be,Le){var He,vt,Rt;return(He=Math.sqrt(be*be+Pe*Pe))&&(be/=He,Pe/=He),(Rt=be*Ge+Pe*Qe)&&(Ge-=be*Rt,Qe-=Pe*Rt),(vt=Math.sqrt(Ge*Ge+Qe*Qe))&&(Ge/=vt,Qe/=vt,Rt/=vt),be*Qe<Pe*Ge&&(be=-be,Pe=-Pe,Rt=-Rt,He=-He),{translateX:Be,translateY:Le,rotate:Math.atan2(Pe,be)*D,skewX:Math.atan(Rt)*D,scaleX:He,scaleY:vt}}var F,H,G,J;function X(be){return be==="none"?R:(F||(F=document.createElement("DIV"),H=document.documentElement,G=document.defaultView),F.style.transform=be,be=G.getComputedStyle(H.appendChild(F),null).getPropertyValue("transform"),H.removeChild(F),be=be.slice(7,-1).split(","),B(+be[0],+be[1],+be[2],+be[3],+be[4],+be[5]))}function Y(be){return be==null||(J||(J=document.createElementNS("http://www.w3.org/2000/svg","g")),J.setAttribute("transform",be),!(be=J.transform.baseVal.consolidate()))?R:(be=be.matrix,B(be.a,be.b,be.c,be.d,be.e,be.f))}function Z(be,Pe,Ge,Qe){function Be(rr){return rr.length?rr.pop()+" ":""}function Le(rr,Lt,Ft,Gt,Dt,kt){if(rr!==Ft||Lt!==Gt){var Ue=Dt.push("translate(",null,Pe,null,Ge);kt.push({i:Ue-4,x:A(rr,Ft)},{i:Ue-2,x:A(Lt,Gt)})}else(Ft||Gt)&&Dt.push("translate("+Ft+Pe+Gt+Ge)}function He(rr,Lt,Ft,Gt){rr!==Lt?(rr-Lt>180?Lt+=360:Lt-rr>180&&(rr+=360),Gt.push({i:Ft.push(Be(Ft)+"rotate(",null,Qe)-2,x:A(rr,Lt)})):Lt&&Ft.push(Be(Ft)+"rotate("+Lt+Qe)}function vt(rr,Lt,Ft,Gt){rr!==Lt?Gt.push({i:Ft.push(Be(Ft)+"skewX(",null,Qe)-2,x:A(rr,Lt)}):Lt&&Ft.push(Be(Ft)+"skewX("+Lt+Qe)}function Rt(rr,Lt,Ft,Gt,Dt,kt){if(rr!==Ft||Lt!==Gt){var Ue=Dt.push(Be(Dt)+"scale(",null,",",null,")");kt.push({i:Ue-4,x:A(rr,Ft)},{i:Ue-2,x:A(Lt,Gt)})}else(Ft!==1||Gt!==1)&&Dt.push(Be(Dt)+"scale("+Ft+","+Gt+")")}return function(rr,Lt){var Ft=[],Gt=[];return rr=be(rr),Lt=be(Lt),Le(rr.translateX,rr.translateY,Lt.translateX,Lt.translateY,Ft,Gt),He(rr.rotate,Lt.rotate,Ft,Gt),vt(rr.skewX,Lt.skewX,Ft,Gt),Rt(rr.scaleX,rr.scaleY,Lt.scaleX,Lt.scaleY,Ft,Gt),rr=Lt=null,function(Dt){for(var kt=-1,Ue=Gt.length,qe;++kt<Ue;)Ft[(qe=Gt[kt]).i]=qe.x(Dt);return Ft.join("")}}}var oe=Z(X,"px, ","px)","deg)"),re=Z(Y,", ",")",")"),se=Math.SQRT2,N=2,U=4,q=1e-12;function $(be){return((be=Math.exp(be))+1/be)/2}function W(be){return((be=Math.exp(be))-1/be)/2}function K(be){return((be=Math.exp(2*be))-1)/(be+1)}function ne(be,Pe){var Ge=be[0],Qe=be[1],Be=be[2],Le=Pe[0],He=Pe[1],vt=Pe[2],Rt=Le-Ge,rr=He-Qe,Lt=Rt*Rt+rr*rr,Ft,Gt;if(Lt<q)Gt=Math.log(vt/Be)/se,Ft=function(Ae){return[Ge+Ae*Rt,Qe+Ae*rr,Be*Math.exp(se*Ae*Gt)]};else{var Dt=Math.sqrt(Lt),kt=(vt*vt-Be*Be+U*Lt)/(2*Be*N*Dt),Ue=(vt*vt-Be*Be-U*Lt)/(2*vt*N*Dt),qe=Math.log(Math.sqrt(kt*kt+1)-kt),Ve=Math.log(Math.sqrt(Ue*Ue+1)-Ue);Gt=(Ve-qe)/se,Ft=function(Ae){var Ne=Ae*Gt,Xe=$(qe),Je=Be/(N*Dt)*(Xe*K(se*Ne+qe)-W(qe));return[Ge+Je*Rt,Qe+Je*rr,Be*Xe/$(se*Ne+qe)]}}return Ft.duration=Gt*1e3,Ft}function ae(be){return function(Pe,Ge){var Qe=be((Pe=v.hsl(Pe)).h,(Ge=v.hsl(Ge)).h),Be=o(Pe.s,Ge.s),Le=o(Pe.l,Ge.l),He=o(Pe.opacity,Ge.opacity);return function(vt){return Pe.h=Qe(vt),Pe.s=Be(vt),Pe.l=Le(vt),Pe.opacity=He(vt),Pe+""}}}var ie=ae(t),le=ae(o);function ye(be,Pe){var Ge=o((be=v.lab(be)).l,(Pe=v.lab(Pe)).l),Qe=o(be.a,Pe.a),Be=o(be.b,Pe.b),Le=o(be.opacity,Pe.opacity);return function(He){return be.l=Ge(He),be.a=Qe(He),be.b=Be(He),be.opacity=Le(He),be+""}}function ue(be){return function(Pe,Ge){var Qe=be((Pe=v.hcl(Pe)).h,(Ge=v.hcl(Ge)).h),Be=o(Pe.c,Ge.c),Le=o(Pe.l,Ge.l),He=o(Pe.opacity,Ge.opacity);return function(vt){return Pe.h=Qe(vt),Pe.c=Be(vt),Pe.l=Le(vt),Pe.opacity=He(vt),Pe+""}}}var pe=ue(t),ge=ue(o);function Te(be){return function Pe(Ge){Ge=+Ge;function Qe(Be,Le){var He=be((Be=v.cubehelix(Be)).h,(Le=v.cubehelix(Le)).h),vt=o(Be.s,Le.s),Rt=o(Be.l,Le.l),rr=o(Be.opacity,Le.opacity);return function(Lt){return Be.h=He(Lt),Be.s=vt(Lt),Be.l=Rt(Math.pow(Lt,Ge)),Be.opacity=rr(Lt),Be+""}}return Qe.gamma=Pe,Qe}(1)}var _e=Te(t),ze=Te(o);function Oe(be,Pe){for(var Ge=0,Qe=Pe.length-1,Be=Pe[0],Le=new Array(Qe<0?0:Qe);Ge<Qe;)Le[Ge]=be(Be,Be=Pe[++Ge]);return function(He){var vt=Math.max(0,Math.min(Qe-1,Math.floor(He*=Qe)));return Le[vt](He-vt)}}function Ye(be,Pe){for(var Ge=new Array(Pe),Qe=0;Qe<Pe;++Qe)Ge[Qe]=be(Qe/(Pe-1));return Ge}w.interpolate=k,w.interpolateArray=u,w.interpolateBasis=M,w.interpolateBasisClosed=e,w.interpolateCubehelix=_e,w.interpolateCubehelixLong=ze,w.interpolateDate=s,w.interpolateDiscrete=P,w.interpolateHcl=pe,w.interpolateHclLong=ge,w.interpolateHsl=ie,w.interpolateHslLong=le,w.interpolateHue=z,w.interpolateLab=ye,w.interpolateNumber=A,w.interpolateNumberArray=h,w.interpolateObject=b,w.interpolateRgb=i,w.interpolateRgbBasis=p,w.interpolateRgbBasisClosed=g,w.interpolateRound=I,w.interpolateString=T,w.interpolateTransformCss=oe,w.interpolateTransformSvg=re,w.interpolateZoom=ne,w.piecewise=Oe,w.quantize=Ye,Object.defineProperty(w,"__esModule",{value:!0})})},{"d3-color":109}],117:[function(d,ee,te){(function(w,v){typeof te=="object"&&typeof ee<"u"?v(te):(w=w||self,v(w.d3=w.d3||{}))})(this,function(w){var v=Math.PI,S=2*v,M=1e-6,e=S-M;function a(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function n(){return new a}a.prototype=n.prototype={constructor:a,moveTo:function(r,t){this._+="M"+(this._x0=this._x1=+r)+","+(this._y0=this._y1=+t)},closePath:function(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(r,t){this._+="L"+(this._x1=+r)+","+(this._y1=+t)},quadraticCurveTo:function(r,t,c,o){this._+="Q"+ +r+","+ +t+","+(this._x1=+c)+","+(this._y1=+o)},bezierCurveTo:function(r,t,c,o,i,y){this._+="C"+ +r+","+ +t+","+ +c+","+ +o+","+(this._x1=+i)+","+(this._y1=+y)},arcTo:function(r,t,c,o,i){r=+r,t=+t,c=+c,o=+o,i=+i;var y=this._x1,p=this._y1,g=c-r,h=o-t,m=y-r,u=p-t,_=m*m+u*u;if(i<0)throw new Error("negative radius: "+i);if(this._x1===null)this._+="M"+(this._x1=r)+","+(this._y1=t);else if(_>M)if(!(Math.abs(u*g-h*m)>M)||!i)this._+="L"+(this._x1=r)+","+(this._y1=t);else{var s=c-y,A=o-p,b=g*g+h*h,f=s*s+A*A,x=Math.sqrt(b),l=Math.sqrt(_),L=i*Math.tan((v-Math.acos((b+_-f)/(2*x*l)))/2),T=L/l,k=L/x;Math.abs(T-1)>M&&(this._+="L"+(r+T*m)+","+(t+T*u)),this._+="A"+i+","+i+",0,0,"+ +(u*s>m*A)+","+(this._x1=r+k*g)+","+(this._y1=t+k*h)}},arc:function(r,t,c,o,i,y){r=+r,t=+t,c=+c,y=!!y;var p=c*Math.cos(o),g=c*Math.sin(o),h=r+p,m=t+g,u=1^y,_=y?o-i:i-o;if(c<0)throw new Error("negative radius: "+c);this._x1===null?this._+="M"+h+","+m:(Math.abs(this._x1-h)>M||Math.abs(this._y1-m)>M)&&(this._+="L"+h+","+m),c&&(_<0&&(_=_%S+S),_>e?this._+="A"+c+","+c+",0,1,"+u+","+(r-p)+","+(t-g)+"A"+c+","+c+",0,1,"+u+","+(this._x1=h)+","+(this._y1=m):_>M&&(this._+="A"+c+","+c+",0,"+ +(_>=v)+","+u+","+(this._x1=r+c*Math.cos(i))+","+(this._y1=t+c*Math.sin(i))))},rect:function(r,t,c,o){this._+="M"+(this._x0=this._x1=+r)+","+(this._y0=this._y1=+t)+"h"+ +c+"v"+ +o+"h"+-c+"Z"},toString:function(){return this._}},w.path=n,Object.defineProperty(w,"__esModule",{value:!0})})},{}],118:[function(d,ee,te){(function(w,v){typeof te=="object"&&typeof ee<"u"?v(te):(w=w||self,v(w.d3=w.d3||{}))})(this,function(w){function v(x){var l=+this._x.call(null,x),L=+this._y.call(null,x);return S(this.cover(l,L),l,L,x)}function S(x,l,L,T){if(isNaN(l)||isNaN(L))return x;var k,P=x._root,z={data:T},I=x._x0,D=x._y0,R=x._x1,B=x._y1,F,H,G,J,X,Y,Z,oe;if(!P)return x._root=z,x;for(;P.length;)if((X=l>=(F=(I+R)/2))?I=F:R=F,(Y=L>=(H=(D+B)/2))?D=H:B=H,k=P,!(P=P[Z=Y<<1|X]))return k[Z]=z,x;if(G=+x._x.call(null,P.data),J=+x._y.call(null,P.data),l===G&&L===J)return z.next=P,k?k[Z]=z:x._root=z,x;do k=k?k[Z]=new Array(4):x._root=new Array(4),(X=l>=(F=(I+R)/2))?I=F:R=F,(Y=L>=(H=(D+B)/2))?D=H:B=H;while((Z=Y<<1|X)===(oe=(J>=H)<<1|G>=F));return k[oe]=P,k[Z]=z,x}function M(x){var l,L,T=x.length,k,P,z=new Array(T),I=new Array(T),D=1/0,R=1/0,B=-1/0,F=-1/0;for(L=0;L<T;++L)isNaN(k=+this._x.call(null,l=x[L]))||isNaN(P=+this._y.call(null,l))||(z[L]=k,I[L]=P,k<D&&(D=k),k>B&&(B=k),P<R&&(R=P),P>F&&(F=P));if(D>B||R>F)return this;for(this.cover(D,R).cover(B,F),L=0;L<T;++L)S(this,z[L],I[L],x[L]);return this}function e(x,l){if(isNaN(x=+x)||isNaN(l=+l))return this;var L=this._x0,T=this._y0,k=this._x1,P=this._y1;if(isNaN(L))k=(L=Math.floor(x))+1,P=(T=Math.floor(l))+1;else{for(var z=k-L,I=this._root,D,R;L>x||x>=k||T>l||l>=P;)switch(R=(l<T)<<1|x<L,D=new Array(4),D[R]=I,I=D,z*=2,R){case 0:k=L+z,P=T+z;break;case 1:L=k-z,P=T+z;break;case 2:k=L+z,T=P-z;break;case 3:L=k-z,T=P-z;break}this._root&&this._root.length&&(this._root=I)}return this._x0=L,this._y0=T,this._x1=k,this._y1=P,this}function a(){var x=[];return this.visit(function(l){if(!l.length)do x.push(l.data);while(l=l.next)}),x}function n(x){return arguments.length?this.cover(+x[0][0],+x[0][1]).cover(+x[1][0],+x[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function r(x,l,L,T,k){this.node=x,this.x0=l,this.y0=L,this.x1=T,this.y1=k}function t(x,l,L){var T,k=this._x0,P=this._y0,z,I,D,R,B=this._x1,F=this._y1,H=[],G=this._root,J,X;for(G&&H.push(new r(G,k,P,B,F)),L==null?L=1/0:(k=x-L,P=l-L,B=x+L,F=l+L,L*=L);J=H.pop();)if(!(!(G=J.node)||(z=J.x0)>B||(I=J.y0)>F||(D=J.x1)<k||(R=J.y1)<P))if(G.length){var Y=(z+D)/2,Z=(I+R)/2;H.push(new r(G[3],Y,Z,D,R),new r(G[2],z,Z,Y,R),new r(G[1],Y,I,D,Z),new r(G[0],z,I,Y,Z)),(X=(l>=Z)<<1|x>=Y)&&(J=H[H.length-1],H[H.length-1]=H[H.length-1-X],H[H.length-1-X]=J)}else{var oe=x-+this._x.call(null,G.data),re=l-+this._y.call(null,G.data),se=oe*oe+re*re;if(se<L){var N=Math.sqrt(L=se);k=x-N,P=l-N,B=x+N,F=l+N,T=G.data}}return T}function c(x){if(isNaN(B=+this._x.call(null,x))||isNaN(F=+this._y.call(null,x)))return this;var l,L=this._root,T,k,P,z=this._x0,I=this._y0,D=this._x1,R=this._y1,B,F,H,G,J,X,Y,Z;if(!L)return this;if(L.length)for(;;){if((J=B>=(H=(z+D)/2))?z=H:D=H,(X=F>=(G=(I+R)/2))?I=G:R=G,l=L,!(L=L[Y=X<<1|J]))return this;if(!L.length)break;(l[Y+1&3]||l[Y+2&3]||l[Y+3&3])&&(T=l,Z=Y)}for(;L.data!==x;)if(k=L,!(L=L.next))return this;return(P=L.next)&&delete L.next,k?(P?k.next=P:delete k.next,this):l?(P?l[Y]=P:delete l[Y],(L=l[0]||l[1]||l[2]||l[3])&&L===(l[3]||l[2]||l[1]||l[0])&&!L.length&&(T?T[Z]=L:this._root=L),this):(this._root=P,this)}function o(x){for(var l=0,L=x.length;l<L;++l)this.remove(x[l]);return this}function i(){return this._root}function y(){var x=0;return this.visit(function(l){if(!l.length)do++x;while(l=l.next)}),x}function p(x){var l=[],L,T=this._root,k,P,z,I,D;for(T&&l.push(new r(T,this._x0,this._y0,this._x1,this._y1));L=l.pop();)if(!x(T=L.node,P=L.x0,z=L.y0,I=L.x1,D=L.y1)&&T.length){var R=(P+I)/2,B=(z+D)/2;(k=T[3])&&l.push(new r(k,R,B,I,D)),(k=T[2])&&l.push(new r(k,P,B,R,D)),(k=T[1])&&l.push(new r(k,R,z,I,B)),(k=T[0])&&l.push(new r(k,P,z,R,B))}return this}function g(x){var l=[],L=[],T;for(this._root&&l.push(new r(this._root,this._x0,this._y0,this._x1,this._y1));T=l.pop();){var k=T.node;if(k.length){var P,z=T.x0,I=T.y0,D=T.x1,R=T.y1,B=(z+D)/2,F=(I+R)/2;(P=k[0])&&l.push(new r(P,z,I,B,F)),(P=k[1])&&l.push(new r(P,B,I,D,F)),(P=k[2])&&l.push(new r(P,z,F,B,R)),(P=k[3])&&l.push(new r(P,B,F,D,R))}L.push(T)}for(;T=L.pop();)x(T.node,T.x0,T.y0,T.x1,T.y1);return this}function h(x){return x[0]}function m(x){return arguments.length?(this._x=x,this):this._x}function u(x){return x[1]}function _(x){return arguments.length?(this._y=x,this):this._y}function s(x,l,L){var T=new A(l==null?h:l,L==null?u:L,NaN,NaN,NaN,NaN);return x==null?T:T.addAll(x)}function A(x,l,L,T,k,P){this._x=x,this._y=l,this._x0=L,this._y0=T,this._x1=k,this._y1=P,this._root=void 0}function b(x){for(var l={data:x.data},L=l;x=x.next;)L=L.next={data:x.data};return l}var f=s.prototype=A.prototype;f.copy=function(){var x=new A(this._x,this._y,this._x0,this._y0,this._x1,this._y1),l=this._root,L,T;if(!l)return x;if(!l.length)return x._root=b(l),x;for(L=[{source:l,target:x._root=new Array(4)}];l=L.pop();)for(var k=0;k<4;++k)(T=l.source[k])&&(T.length?L.push({source:T,target:l.target[k]=new Array(4)}):l.target[k]=b(T));return x},f.add=v,f.addAll=M,f.cover=e,f.data=a,f.extent=n,f.find=t,f.remove=c,f.removeAll=o,f.root=i,f.size=y,f.visit=p,f.visitAfter=g,f.x=m,f.y=_,w.quadtree=s,Object.defineProperty(w,"__esModule",{value:!0})})},{}],119:[function(d,ee,te){(function(w,v){typeof te=="object"&&typeof ee<"u"?v(te,d("d3-path")):(w=w||self,v(w.d3=w.d3||{},w.d3))})(this,function(w,v){function S(tt){return function(){return tt}}var M=Math.abs,e=Math.atan2,a=Math.cos,n=Math.max,r=Math.min,t=Math.sin,c=Math.sqrt,o=1e-12,i=Math.PI,y=i/2,p=2*i;function g(tt){return tt>1?0:tt<-1?i:Math.acos(tt)}function h(tt){return tt>=1?y:tt<=-1?-y:Math.asin(tt)}function m(tt){return tt.innerRadius}function u(tt){return tt.outerRadius}function _(tt){return tt.startAngle}function s(tt){return tt.endAngle}function A(tt){return tt&&tt.padAngle}function b(tt,Et,Vt,ar,Cr,Or,Ir,Tr){var Wr=Vt-tt,wn=ar-Et,ln=Ir-Cr,Bn=Tr-Or,Cn=Bn*Wr-ln*wn;if(!(Cn*Cn<o))return Cn=(ln*(Et-Or)-Bn*(tt-Cr))/Cn,[tt+Cn*Wr,Et+Cn*wn]}function f(tt,Et,Vt,ar,Cr,Or,Ir){var Tr=tt-Vt,Wr=Et-ar,wn=(Ir?Or:-Or)/c(Tr*Tr+Wr*Wr),ln=wn*Wr,Bn=-wn*Tr,Cn=tt+ln,Wn=Et+Bn,Hn=Vt+ln,ga=ar+Bn,La=(Cn+Hn)/2,ci=(Wn+ga)/2,Va=Hn-Cn,ja=ga-Wn,Wa=Va*Va+ja*ja,wr=Cr-Or,pn=Cn*ga-Hn*Wn,fn=(ja<0?-1:1)*c(n(0,wr*wr*Wa-pn*pn)),An=(pn*ja-Va*fn)/Wa,Zn=(-pn*Va-ja*fn)/Wa,ua=(pn*ja+Va*fn)/Wa,ea=(-pn*Va+ja*fn)/Wa,Rn=An-La,Xn=Zn-ci,Ua=ua-La,li=ea-ci;return Rn*Rn+Xn*Xn>Ua*Ua+li*li&&(An=ua,Zn=ea),{cx:An,cy:Zn,x01:-ln,y01:-Bn,x11:An*(Cr/wr-1),y11:Zn*(Cr/wr-1)}}function x(){var tt=m,Et=u,Vt=S(0),ar=null,Cr=_,Or=s,Ir=A,Tr=null;function Wr(){var wn,ln,Bn=+tt.apply(this,arguments),Cn=+Et.apply(this,arguments),Wn=Cr.apply(this,arguments)-y,Hn=Or.apply(this,arguments)-y,ga=M(Hn-Wn),La=Hn>Wn;if(Tr||(Tr=wn=v.path()),Cn<Bn&&(ln=Cn,Cn=Bn,Bn=ln),!(Cn>o))Tr.moveTo(0,0);else if(ga>p-o)Tr.moveTo(Cn*a(Wn),Cn*t(Wn)),Tr.arc(0,0,Cn,Wn,Hn,!La),Bn>o&&(Tr.moveTo(Bn*a(Hn),Bn*t(Hn)),Tr.arc(0,0,Bn,Hn,Wn,La));else{var ci=Wn,Va=Hn,ja=Wn,Wa=Hn,wr=ga,pn=ga,fn=Ir.apply(this,arguments)/2,An=fn>o&&(ar?+ar.apply(this,arguments):c(Bn*Bn+Cn*Cn)),Zn=r(M(Cn-Bn)/2,+Vt.apply(this,arguments)),ua=Zn,ea=Zn,Rn,Xn;if(An>o){var Ua=h(An/Bn*t(fn)),li=h(An/Cn*t(fn));(wr-=Ua*2)>o?(Ua*=La?1:-1,ja+=Ua,Wa-=Ua):(wr=0,ja=Wa=(Wn+Hn)/2),(pn-=li*2)>o?(li*=La?1:-1,ci+=li,Va-=li):(pn=0,ci=Va=(Wn+Hn)/2)}var Bt=Cn*a(ci),hr=Cn*t(ci),rn=Bn*a(Wa),vn=Bn*t(Wa);if(Zn>o){var en=Cn*a(Va),Tn=Cn*t(Va),xn=Bn*a(ja),un=Bn*t(ja),gr;if(ga<i&&(gr=b(Bt,hr,xn,un,en,Tn,rn,vn))){var yr=Bt-gr[0],zr=hr-gr[1],gn=en-gr[0],On=Tn-gr[1],ta=1/t(g((yr*gn+zr*On)/(c(yr*yr+zr*zr)*c(gn*gn+On*On)))/2),_n=c(gr[0]*gr[0]+gr[1]*gr[1]);ua=r(Zn,(Bn-_n)/(ta-1)),ea=r(Zn,(Cn-_n)/(ta+1))}}pn>o?ea>o?(Rn=f(xn,un,Bt,hr,Cn,ea,La),Xn=f(en,Tn,rn,vn,Cn,ea,La),Tr.moveTo(Rn.cx+Rn.x01,Rn.cy+Rn.y01),ea<Zn?Tr.arc(Rn.cx,Rn.cy,ea,e(Rn.y01,Rn.x01),e(Xn.y01,Xn.x01),!La):(Tr.arc(Rn.cx,Rn.cy,ea,e(Rn.y01,Rn.x01),e(Rn.y11,Rn.x11),!La),Tr.arc(0,0,Cn,e(Rn.cy+Rn.y11,Rn.cx+Rn.x11),e(Xn.cy+Xn.y11,Xn.cx+Xn.x11),!La),Tr.arc(Xn.cx,Xn.cy,ea,e(Xn.y11,Xn.x11),e(Xn.y01,Xn.x01),!La))):(Tr.moveTo(Bt,hr),Tr.arc(0,0,Cn,ci,Va,!La)):Tr.moveTo(Bt,hr),!(Bn>o)||!(wr>o)?Tr.lineTo(rn,vn):ua>o?(Rn=f(rn,vn,en,Tn,Bn,-ua,La),Xn=f(Bt,hr,xn,un,Bn,-ua,La),Tr.lineTo(Rn.cx+Rn.x01,Rn.cy+Rn.y01),ua<Zn?Tr.arc(Rn.cx,Rn.cy,ua,e(Rn.y01,Rn.x01),e(Xn.y01,Xn.x01),!La):(Tr.arc(Rn.cx,Rn.cy,ua,e(Rn.y01,Rn.x01),e(Rn.y11,Rn.x11),!La),Tr.arc(0,0,Bn,e(Rn.cy+Rn.y11,Rn.cx+Rn.x11),e(Xn.cy+Xn.y11,Xn.cx+Xn.x11),La),Tr.arc(Xn.cx,Xn.cy,ua,e(Xn.y11,Xn.x11),e(Xn.y01,Xn.x01),!La))):Tr.arc(0,0,Bn,Wa,ja,La)}if(Tr.closePath(),wn)return Tr=null,wn+""||null}return Wr.centroid=function(){var wn=(+tt.apply(this,arguments)+ +Et.apply(this,arguments))/2,ln=(+Cr.apply(this,arguments)+ +Or.apply(this,arguments))/2-i/2;return[a(ln)*wn,t(ln)*wn]},Wr.innerRadius=function(wn){return arguments.length?(tt=typeof wn=="function"?wn:S(+wn),Wr):tt},Wr.outerRadius=function(wn){return arguments.length?(Et=typeof wn=="function"?wn:S(+wn),Wr):Et},Wr.cornerRadius=function(wn){return arguments.length?(Vt=typeof wn=="function"?wn:S(+wn),Wr):Vt},Wr.padRadius=function(wn){return arguments.length?(ar=wn==null?null:typeof wn=="function"?wn:S(+wn),Wr):ar},Wr.startAngle=function(wn){return arguments.length?(Cr=typeof wn=="function"?wn:S(+wn),Wr):Cr},Wr.endAngle=function(wn){return arguments.length?(Or=typeof wn=="function"?wn:S(+wn),Wr):Or},Wr.padAngle=function(wn){return arguments.length?(Ir=typeof wn=="function"?wn:S(+wn),Wr):Ir},Wr.context=function(wn){return arguments.length?(Tr=wn==null?null:wn,Wr):Tr},Wr}function l(tt){this._context=tt}l.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(tt,Et){switch(tt=+tt,Et=+Et,this._point){case 0:this._point=1,this._line?this._context.lineTo(tt,Et):this._context.moveTo(tt,Et);break;case 1:this._point=2;default:this._context.lineTo(tt,Et);break}}};function L(tt){return new l(tt)}function T(tt){return tt[0]}function k(tt){return tt[1]}function P(){var tt=T,Et=k,Vt=S(!0),ar=null,Cr=L,Or=null;function Ir(Tr){var Wr,wn=Tr.length,ln,Bn=!1,Cn;for(ar==null&&(Or=Cr(Cn=v.path())),Wr=0;Wr<=wn;++Wr)!(Wr<wn&&Vt(ln=Tr[Wr],Wr,Tr))===Bn&&((Bn=!Bn)?Or.lineStart():Or.lineEnd()),Bn&&Or.point(+tt(ln,Wr,Tr),+Et(ln,Wr,Tr));if(Cn)return Or=null,Cn+""||null}return Ir.x=function(Tr){return arguments.length?(tt=typeof Tr=="function"?Tr:S(+Tr),Ir):tt},Ir.y=function(Tr){return arguments.length?(Et=typeof Tr=="function"?Tr:S(+Tr),Ir):Et},Ir.defined=function(Tr){return arguments.length?(Vt=typeof Tr=="function"?Tr:S(!!Tr),Ir):Vt},Ir.curve=function(Tr){return arguments.length?(Cr=Tr,ar!=null&&(Or=Cr(ar)),Ir):Cr},Ir.context=function(Tr){return arguments.length?(Tr==null?ar=Or=null:Or=Cr(ar=Tr),Ir):ar},Ir}function z(){var tt=T,Et=null,Vt=S(0),ar=k,Cr=S(!0),Or=null,Ir=L,Tr=null;function Wr(ln){var Bn,Cn,Wn,Hn=ln.length,ga,La=!1,ci,Va=new Array(Hn),ja=new Array(Hn);for(Or==null&&(Tr=Ir(ci=v.path())),Bn=0;Bn<=Hn;++Bn){if(!(Bn<Hn&&Cr(ga=ln[Bn],Bn,ln))===La)if(La=!La)Cn=Bn,Tr.areaStart(),Tr.lineStart();else{for(Tr.lineEnd(),Tr.lineStart(),Wn=Bn-1;Wn>=Cn;--Wn)Tr.point(Va[Wn],ja[Wn]);Tr.lineEnd(),Tr.areaEnd()}La&&(Va[Bn]=+tt(ga,Bn,ln),ja[Bn]=+Vt(ga,Bn,ln),Tr.point(Et?+Et(ga,Bn,ln):Va[Bn],ar?+ar(ga,Bn,ln):ja[Bn]))}if(ci)return Tr=null,ci+""||null}function wn(){return P().defined(Cr).curve(Ir).context(Or)}return Wr.x=function(ln){return arguments.length?(tt=typeof ln=="function"?ln:S(+ln),Et=null,Wr):tt},Wr.x0=function(ln){return arguments.length?(tt=typeof ln=="function"?ln:S(+ln),Wr):tt},Wr.x1=function(ln){return arguments.length?(Et=ln==null?null:typeof ln=="function"?ln:S(+ln),Wr):Et},Wr.y=function(ln){return arguments.length?(Vt=typeof ln=="function"?ln:S(+ln),ar=null,Wr):Vt},Wr.y0=function(ln){return arguments.length?(Vt=typeof ln=="function"?ln:S(+ln),Wr):Vt},Wr.y1=function(ln){return arguments.length?(ar=ln==null?null:typeof ln=="function"?ln:S(+ln),Wr):ar},Wr.lineX0=Wr.lineY0=function(){return wn().x(tt).y(Vt)},Wr.lineY1=function(){return wn().x(tt).y(ar)},Wr.lineX1=function(){return wn().x(Et).y(Vt)},Wr.defined=function(ln){return arguments.length?(Cr=typeof ln=="function"?ln:S(!!ln),Wr):Cr},Wr.curve=function(ln){return arguments.length?(Ir=ln,Or!=null&&(Tr=Ir(Or)),Wr):Ir},Wr.context=function(ln){return arguments.length?(ln==null?Or=Tr=null:Tr=Ir(Or=ln),Wr):Or},Wr}function I(tt,Et){return Et<tt?-1:Et>tt?1:Et>=tt?0:NaN}function D(tt){return tt}function R(){var tt=D,Et=I,Vt=null,ar=S(0),Cr=S(p),Or=S(0);function Ir(Tr){var Wr,wn=Tr.length,ln,Bn,Cn=0,Wn=new Array(wn),Hn=new Array(wn),ga=+ar.apply(this,arguments),La=Math.min(p,Math.max(-p,Cr.apply(this,arguments)-ga)),ci,Va=Math.min(Math.abs(La)/wn,Or.apply(this,arguments)),ja=Va*(La<0?-1:1),Wa;for(Wr=0;Wr<wn;++Wr)(Wa=Hn[Wn[Wr]=Wr]=+tt(Tr[Wr],Wr,Tr))>0&&(Cn+=Wa);for(Et!=null?Wn.sort(function(wr,pn){return Et(Hn[wr],Hn[pn])}):Vt!=null&&Wn.sort(function(wr,pn){return Vt(Tr[wr],Tr[pn])}),Wr=0,Bn=Cn?(La-wn*ja)/Cn:0;Wr<wn;++Wr,ga=ci)ln=Wn[Wr],Wa=Hn[ln],ci=ga+(Wa>0?Wa*Bn:0)+ja,Hn[ln]={data:Tr[ln],index:Wr,value:Wa,startAngle:ga,endAngle:ci,padAngle:Va};return Hn}return Ir.value=function(Tr){return arguments.length?(tt=typeof Tr=="function"?Tr:S(+Tr),Ir):tt},Ir.sortValues=function(Tr){return arguments.length?(Et=Tr,Vt=null,Ir):Et},Ir.sort=function(Tr){return arguments.length?(Vt=Tr,Et=null,Ir):Vt},Ir.startAngle=function(Tr){return arguments.length?(ar=typeof Tr=="function"?Tr:S(+Tr),Ir):ar},Ir.endAngle=function(Tr){return arguments.length?(Cr=typeof Tr=="function"?Tr:S(+Tr),Ir):Cr},Ir.padAngle=function(Tr){return arguments.length?(Or=typeof Tr=="function"?Tr:S(+Tr),Ir):Or},Ir}var B=H(L);function F(tt){this._curve=tt}F.prototype={areaStart:function(){this._curve.areaStart()},areaEnd:function(){this._curve.areaEnd()},lineStart:function(){this._curve.lineStart()},lineEnd:function(){this._curve.lineEnd()},point:function(tt,Et){this._curve.point(Et*Math.sin(tt),Et*-Math.cos(tt))}};function H(tt){function Et(Vt){return new F(tt(Vt))}return Et._curve=tt,Et}function G(tt){var Et=tt.curve;return tt.angle=tt.x,delete tt.x,tt.radius=tt.y,delete tt.y,tt.curve=function(Vt){return arguments.length?Et(H(Vt)):Et()._curve},tt}function J(){return G(P().curve(B))}function X(){var tt=z().curve(B),Et=tt.curve,Vt=tt.lineX0,ar=tt.lineX1,Cr=tt.lineY0,Or=tt.lineY1;return tt.angle=tt.x,delete tt.x,tt.startAngle=tt.x0,delete tt.x0,tt.endAngle=tt.x1,delete tt.x1,tt.radius=tt.y,delete tt.y,tt.innerRadius=tt.y0,delete tt.y0,tt.outerRadius=tt.y1,delete tt.y1,tt.lineStartAngle=function(){return G(Vt())},delete tt.lineX0,tt.lineEndAngle=function(){return G(ar())},delete tt.lineX1,tt.lineInnerRadius=function(){return G(Cr())},delete tt.lineY0,tt.lineOuterRadius=function(){return G(Or())},delete tt.lineY1,tt.curve=function(Ir){return arguments.length?Et(H(Ir)):Et()._curve},tt}function Y(tt,Et){return[(Et=+Et)*Math.cos(tt-=Math.PI/2),Et*Math.sin(tt)]}var Z=Array.prototype.slice;function oe(tt){return tt.source}function re(tt){return tt.target}function se(tt){var Et=oe,Vt=re,ar=T,Cr=k,Or=null;function Ir(){var Tr,Wr=Z.call(arguments),wn=Et.apply(this,Wr),ln=Vt.apply(this,Wr);if(Or||(Or=Tr=v.path()),tt(Or,+ar.apply(this,(Wr[0]=wn,Wr)),+Cr.apply(this,Wr),+ar.apply(this,(Wr[0]=ln,Wr)),+Cr.apply(this,Wr)),Tr)return Or=null,Tr+""||null}return Ir.source=function(Tr){return arguments.length?(Et=Tr,Ir):Et},Ir.target=function(Tr){return arguments.length?(Vt=Tr,Ir):Vt},Ir.x=function(Tr){return arguments.length?(ar=typeof Tr=="function"?Tr:S(+Tr),Ir):ar},Ir.y=function(Tr){return arguments.length?(Cr=typeof Tr=="function"?Tr:S(+Tr),Ir):Cr},Ir.context=function(Tr){return arguments.length?(Or=Tr==null?null:Tr,Ir):Or},Ir}function N(tt,Et,Vt,ar,Cr){tt.moveTo(Et,Vt),tt.bezierCurveTo(Et=(Et+ar)/2,Vt,Et,Cr,ar,Cr)}function U(tt,Et,Vt,ar,Cr){tt.moveTo(Et,Vt),tt.bezierCurveTo(Et,Vt=(Vt+Cr)/2,ar,Vt,ar,Cr)}function q(tt,Et,Vt,ar,Cr){var Or=Y(Et,Vt),Ir=Y(Et,Vt=(Vt+Cr)/2),Tr=Y(ar,Vt),Wr=Y(ar,Cr);tt.moveTo(Or[0],Or[1]),tt.bezierCurveTo(Ir[0],Ir[1],Tr[0],Tr[1],Wr[0],Wr[1])}function $(){return se(N)}function W(){return se(U)}function K(){var tt=se(q);return tt.angle=tt.x,delete tt.x,tt.radius=tt.y,delete tt.y,tt}var ne={draw:function(tt,Et){var Vt=Math.sqrt(Et/i);tt.moveTo(Vt,0),tt.arc(0,0,Vt,0,p)}},ae={draw:function(tt,Et){var Vt=Math.sqrt(Et/5)/2;tt.moveTo(-3*Vt,-Vt),tt.lineTo(-Vt,-Vt),tt.lineTo(-Vt,-3*Vt),tt.lineTo(Vt,-3*Vt),tt.lineTo(Vt,-Vt),tt.lineTo(3*Vt,-Vt),tt.lineTo(3*Vt,Vt),tt.lineTo(Vt,Vt),tt.lineTo(Vt,3*Vt),tt.lineTo(-Vt,3*Vt),tt.lineTo(-Vt,Vt),tt.lineTo(-3*Vt,Vt),tt.closePath()}},ie=Math.sqrt(1/3),le=ie*2,ye={draw:function(tt,Et){var Vt=Math.sqrt(Et/le),ar=Vt*ie;tt.moveTo(0,-Vt),tt.lineTo(ar,0),tt.lineTo(0,Vt),tt.lineTo(-ar,0),tt.closePath()}},ue=.8908130915292852,pe=Math.sin(i/10)/Math.sin(7*i/10),ge=Math.sin(p/10)*pe,Te=-Math.cos(p/10)*pe,_e={draw:function(tt,Et){var Vt=Math.sqrt(Et*ue),ar=ge*Vt,Cr=Te*Vt;tt.moveTo(0,-Vt),tt.lineTo(ar,Cr);for(var Or=1;Or<5;++Or){var Ir=p*Or/5,Tr=Math.cos(Ir),Wr=Math.sin(Ir);tt.lineTo(Wr*Vt,-Tr*Vt),tt.lineTo(Tr*ar-Wr*Cr,Wr*ar+Tr*Cr)}tt.closePath()}},ze={draw:function(tt,Et){var Vt=Math.sqrt(Et),ar=-Vt/2;tt.rect(ar,ar,Vt,Vt)}},Oe=Math.sqrt(3),Ye={draw:function(tt,Et){var Vt=-Math.sqrt(Et/(Oe*3));tt.moveTo(0,Vt*2),tt.lineTo(-Oe*Vt,-Vt),tt.lineTo(Oe*Vt,-Vt),tt.closePath()}},be=-.5,Pe=Math.sqrt(3)/2,Ge=1/Math.sqrt(12),Qe=(Ge/2+1)*3,Be={draw:function(tt,Et){var Vt=Math.sqrt(Et/Qe),ar=Vt/2,Cr=Vt*Ge,Or=ar,Ir=Vt*Ge+Vt,Tr=-Or,Wr=Ir;tt.moveTo(ar,Cr),tt.lineTo(Or,Ir),tt.lineTo(Tr,Wr),tt.lineTo(be*ar-Pe*Cr,Pe*ar+be*Cr),tt.lineTo(be*Or-Pe*Ir,Pe*Or+be*Ir),tt.lineTo(be*Tr-Pe*Wr,Pe*Tr+be*Wr),tt.lineTo(be*ar+Pe*Cr,be*Cr-Pe*ar),tt.lineTo(be*Or+Pe*Ir,be*Ir-Pe*Or),tt.lineTo(be*Tr+Pe*Wr,be*Wr-Pe*Tr),tt.closePath()}},Le=[ne,ae,ye,ze,_e,Ye,Be];function He(){var tt=S(ne),Et=S(64),Vt=null;function ar(){var Cr;if(Vt||(Vt=Cr=v.path()),tt.apply(this,arguments).draw(Vt,+Et.apply(this,arguments)),Cr)return Vt=null,Cr+""||null}return ar.type=function(Cr){return arguments.length?(tt=typeof Cr=="function"?Cr:S(Cr),ar):tt},ar.size=function(Cr){return arguments.length?(Et=typeof Cr=="function"?Cr:S(+Cr),ar):Et},ar.context=function(Cr){return arguments.length?(Vt=Cr==null?null:Cr,ar):Vt},ar}function vt(){}function Rt(tt,Et,Vt){tt._context.bezierCurveTo((2*tt._x0+tt._x1)/3,(2*tt._y0+tt._y1)/3,(tt._x0+2*tt._x1)/3,(tt._y0+2*tt._y1)/3,(tt._x0+4*tt._x1+Et)/6,(tt._y0+4*tt._y1+Vt)/6)}function rr(tt){this._context=tt}rr.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Rt(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(tt,Et){switch(tt=+tt,Et=+Et,this._point){case 0:this._point=1,this._line?this._context.lineTo(tt,Et):this._context.moveTo(tt,Et);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Rt(this,tt,Et);break}this._x0=this._x1,this._x1=tt,this._y0=this._y1,this._y1=Et}};function Lt(tt){return new rr(tt)}function Ft(tt){this._context=tt}Ft.prototype={areaStart:vt,areaEnd:vt,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(tt,Et){switch(tt=+tt,Et=+Et,this._point){case 0:this._point=1,this._x2=tt,this._y2=Et;break;case 1:this._point=2,this._x3=tt,this._y3=Et;break;case 2:this._point=3,this._x4=tt,this._y4=Et,this._context.moveTo((this._x0+4*this._x1+tt)/6,(this._y0+4*this._y1+Et)/6);break;default:Rt(this,tt,Et);break}this._x0=this._x1,this._x1=tt,this._y0=this._y1,this._y1=Et}};function Gt(tt){return new Ft(tt)}function Dt(tt){this._context=tt}Dt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(tt,Et){switch(tt=+tt,Et=+Et,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var Vt=(this._x0+4*this._x1+tt)/6,ar=(this._y0+4*this._y1+Et)/6;this._line?this._context.lineTo(Vt,ar):this._context.moveTo(Vt,ar);break;case 3:this._point=4;default:Rt(this,tt,Et);break}this._x0=this._x1,this._x1=tt,this._y0=this._y1,this._y1=Et}};function kt(tt){return new Dt(tt)}function Ue(tt,Et){this._basis=new rr(tt),this._beta=Et}Ue.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var tt=this._x,Et=this._y,Vt=tt.length-1;if(Vt>0)for(var ar=tt[0],Cr=Et[0],Or=tt[Vt]-ar,Ir=Et[Vt]-Cr,Tr=-1,Wr;++Tr<=Vt;)Wr=Tr/Vt,this._basis.point(this._beta*tt[Tr]+(1-this._beta)*(ar+Wr*Or),this._beta*Et[Tr]+(1-this._beta)*(Cr+Wr*Ir));this._x=this._y=null,this._basis.lineEnd()},point:function(tt,Et){this._x.push(+tt),this._y.push(+Et)}};var qe=function tt(Et){function Vt(ar){return Et===1?new rr(ar):new Ue(ar,Et)}return Vt.beta=function(ar){return tt(+ar)},Vt}(.85);function Ve(tt,Et,Vt){tt._context.bezierCurveTo(tt._x1+tt._k*(tt._x2-tt._x0),tt._y1+tt._k*(tt._y2-tt._y0),tt._x2+tt._k*(tt._x1-Et),tt._y2+tt._k*(tt._y1-Vt),tt._x2,tt._y2)}function Ae(tt,Et){this._context=tt,this._k=(1-Et)/6}Ae.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:Ve(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(tt,Et){switch(tt=+tt,Et=+Et,this._point){case 0:this._point=1,this._line?this._context.lineTo(tt,Et):this._context.moveTo(tt,Et);break;case 1:this._point=2,this._x1=tt,this._y1=Et;break;case 2:this._point=3;default:Ve(this,tt,Et);break}this._x0=this._x1,this._x1=this._x2,this._x2=tt,this._y0=this._y1,this._y1=this._y2,this._y2=Et}};var Ne=function tt(Et){function Vt(ar){return new Ae(ar,Et)}return Vt.tension=function(ar){return tt(+ar)},Vt}(0);function Xe(tt,Et){this._context=tt,this._k=(1-Et)/6}Xe.prototype={areaStart:vt,areaEnd:vt,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(tt,Et){switch(tt=+tt,Et=+Et,this._point){case 0:this._point=1,this._x3=tt,this._y3=Et;break;case 1:this._point=2,this._context.moveTo(this._x4=tt,this._y4=Et);break;case 2:this._point=3,this._x5=tt,this._y5=Et;break;default:Ve(this,tt,Et);break}this._x0=this._x1,this._x1=this._x2,this._x2=tt,this._y0=this._y1,this._y1=this._y2,this._y2=Et}};var Je=function tt(Et){function Vt(ar){return new Xe(ar,Et)}return Vt.tension=function(ar){return tt(+ar)},Vt}(0);function _t(tt,Et){this._context=tt,this._k=(1-Et)/6}_t.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(tt,Et){switch(tt=+tt,Et=+Et,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Ve(this,tt,Et);break}this._x0=this._x1,this._x1=this._x2,this._x2=tt,this._y0=this._y1,this._y1=this._y2,this._y2=Et}};var mt=function tt(Et){function Vt(ar){return new _t(ar,Et)}return Vt.tension=function(ar){return tt(+ar)},Vt}(0);function Ot(tt,Et,Vt){var ar=tt._x1,Cr=tt._y1,Or=tt._x2,Ir=tt._y2;if(tt._l01_a>o){var Tr=2*tt._l01_2a+3*tt._l01_a*tt._l12_a+tt._l12_2a,Wr=3*tt._l01_a*(tt._l01_a+tt._l12_a);ar=(ar*Tr-tt._x0*tt._l12_2a+tt._x2*tt._l01_2a)/Wr,Cr=(Cr*Tr-tt._y0*tt._l12_2a+tt._y2*tt._l01_2a)/Wr}if(tt._l23_a>o){var wn=2*tt._l23_2a+3*tt._l23_a*tt._l12_a+tt._l12_2a,ln=3*tt._l23_a*(tt._l23_a+tt._l12_a);Or=(Or*wn+tt._x1*tt._l23_2a-Et*tt._l12_2a)/ln,Ir=(Ir*wn+tt._y1*tt._l23_2a-Vt*tt._l12_2a)/ln}tt._context.bezierCurveTo(ar,Cr,Or,Ir,tt._x2,tt._y2)}function Kt(tt,Et){this._context=tt,this._alpha=Et}Kt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(tt,Et){if(tt=+tt,Et=+Et,this._point){var Vt=this._x2-tt,ar=this._y2-Et;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(Vt*Vt+ar*ar,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(tt,Et):this._context.moveTo(tt,Et);break;case 1:this._point=2;break;case 2:this._point=3;default:Ot(this,tt,Et);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=tt,this._y0=this._y1,this._y1=this._y2,this._y2=Et}};var Nt=function tt(Et){function Vt(ar){return Et?new Kt(ar,Et):new Ae(ar,0)}return Vt.alpha=function(ar){return tt(+ar)},Vt}(.5);function Wt(tt,Et){this._context=tt,this._alpha=Et}Wt.prototype={areaStart:vt,areaEnd:vt,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(tt,Et){if(tt=+tt,Et=+Et,this._point){var Vt=this._x2-tt,ar=this._y2-Et;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(Vt*Vt+ar*ar,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=tt,this._y3=Et;break;case 1:this._point=2,this._context.moveTo(this._x4=tt,this._y4=Et);break;case 2:this._point=3,this._x5=tt,this._y5=Et;break;default:Ot(this,tt,Et);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=tt,this._y0=this._y1,this._y1=this._y2,this._y2=Et}};var qt=function tt(Et){function Vt(ar){return Et?new Wt(ar,Et):new Xe(ar,0)}return Vt.alpha=function(ar){return tt(+ar)},Vt}(.5);function Yt(tt,Et){this._context=tt,this._alpha=Et}Yt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(tt,Et){if(tt=+tt,Et=+Et,this._point){var Vt=this._x2-tt,ar=this._y2-Et;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(Vt*Vt+ar*ar,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Ot(this,tt,Et);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=tt,this._y0=this._y1,this._y1=this._y2,this._y2=Et}};var fr=function tt(Et){function Vt(ar){return Et?new Yt(ar,Et):new _t(ar,0)}return Vt.alpha=function(ar){return tt(+ar)},Vt}(.5);function Yr(tt){this._context=tt}Yr.prototype={areaStart:vt,areaEnd:vt,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(tt,Et){tt=+tt,Et=+Et,this._point?this._context.lineTo(tt,Et):(this._point=1,this._context.moveTo(tt,Et))}};function hn(tt){return new Yr(tt)}function Qr(tt){return tt<0?-1:1}function at(tt,Et,Vt){var ar=tt._x1-tt._x0,Cr=Et-tt._x1,Or=(tt._y1-tt._y0)/(ar||Cr<0&&-0),Ir=(Vt-tt._y1)/(Cr||ar<0&&-0),Tr=(Or*Cr+Ir*ar)/(ar+Cr);return(Qr(Or)+Qr(Ir))*Math.min(Math.abs(Or),Math.abs(Ir),.5*Math.abs(Tr))||0}function Jt(tt,Et){var Vt=tt._x1-tt._x0;return Vt?(3*(tt._y1-tt._y0)/Vt-Et)/2:Et}function Zt(tt,Et,Vt){var ar=tt._x0,Cr=tt._y0,Or=tt._x1,Ir=tt._y1,Tr=(Or-ar)/3;tt._context.bezierCurveTo(ar+Tr,Cr+Tr*Et,Or-Tr,Ir-Tr*Vt,Or,Ir)}function Ut(tt){this._context=tt}Ut.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Zt(this,this._t0,Jt(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(tt,Et){var Vt=NaN;if(tt=+tt,Et=+Et,!(tt===this._x1&&Et===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(tt,Et):this._context.moveTo(tt,Et);break;case 1:this._point=2;break;case 2:this._point=3,Zt(this,Jt(this,Vt=at(this,tt,Et)),Vt);break;default:Zt(this,this._t0,Vt=at(this,tt,Et));break}this._x0=this._x1,this._x1=tt,this._y0=this._y1,this._y1=Et,this._t0=Vt}}};function _r(tt){this._context=new rt(tt)}(_r.prototype=Object.create(Ut.prototype)).point=function(tt,Et){Ut.prototype.point.call(this,Et,tt)};function rt(tt){this._context=tt}rt.prototype={moveTo:function(tt,Et){this._context.moveTo(Et,tt)},closePath:function(){this._context.closePath()},lineTo:function(tt,Et){this._context.lineTo(Et,tt)},bezierCurveTo:function(tt,Et,Vt,ar,Cr,Or){this._context.bezierCurveTo(Et,tt,ar,Vt,Or,Cr)}};function Ke(tt){return new Ut(tt)}function st(tt){return new _r(tt)}function lt(tt){this._context=tt}lt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var tt=this._x,Et=this._y,Vt=tt.length;if(Vt)if(this._line?this._context.lineTo(tt[0],Et[0]):this._context.moveTo(tt[0],Et[0]),Vt===2)this._context.lineTo(tt[1],Et[1]);else for(var ar=wt(tt),Cr=wt(Et),Or=0,Ir=1;Ir<Vt;++Or,++Ir)this._context.bezierCurveTo(ar[0][Or],Cr[0][Or],ar[1][Or],Cr[1][Or],tt[Ir],Et[Ir]);(this._line||this._line!==0&&Vt===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(tt,Et){this._x.push(+tt),this._y.push(+Et)}};function wt(tt){var Et,Vt=tt.length-1,ar,Cr=new Array(Vt),Or=new Array(Vt),Ir=new Array(Vt);for(Cr[0]=0,Or[0]=2,Ir[0]=tt[0]+2*tt[1],Et=1;Et<Vt-1;++Et)Cr[Et]=1,Or[Et]=4,Ir[Et]=4*tt[Et]+2*tt[Et+1];for(Cr[Vt-1]=2,Or[Vt-1]=7,Ir[Vt-1]=8*tt[Vt-1]+tt[Vt],Et=1;Et<Vt;++Et)ar=Cr[Et]/Or[Et-1],Or[Et]-=ar,Ir[Et]-=ar*Ir[Et-1];for(Cr[Vt-1]=Ir[Vt-1]/Or[Vt-1],Et=Vt-2;Et>=0;--Et)Cr[Et]=(Ir[Et]-Cr[Et+1])/Or[Et];for(Or[Vt-1]=(tt[Vt]+Cr[Vt-1])/2,Et=0;Et<Vt-1;++Et)Or[Et]=2*tt[Et+1]-Cr[Et+1];return[Cr,Or]}function Pt(tt){return new lt(tt)}function ke(tt,Et){this._context=tt,this._t=Et}ke.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(tt,Et){switch(tt=+tt,Et=+Et,this._point){case 0:this._point=1,this._line?this._context.lineTo(tt,Et):this._context.moveTo(tt,Et);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,Et),this._context.lineTo(tt,Et);else{var Vt=this._x*(1-this._t)+tt*this._t;this._context.lineTo(Vt,this._y),this._context.lineTo(Vt,Et)}break}}this._x=tt,this._y=Et}};function Se(tt){return new ke(tt,.5)}function nt(tt){return new ke(tt,0)}function it(tt){return new ke(tt,1)}function ct(tt,Et){if((Ir=tt.length)>1)for(var Vt=1,ar,Cr,Or=tt[Et[0]],Ir,Tr=Or.length;Vt<Ir;++Vt)for(Cr=Or,Or=tt[Et[Vt]],ar=0;ar<Tr;++ar)Or[ar][1]+=Or[ar][0]=isNaN(Cr[ar][1])?Cr[ar][0]:Cr[ar][1]}function At(tt){for(var Et=tt.length,Vt=new Array(Et);--Et>=0;)Vt[Et]=Et;return Vt}function dt(tt,Et){return tt[Et]}function Tt(){var tt=S([]),Et=At,Vt=ct,ar=dt;function Cr(Or){var Ir=tt.apply(this,arguments),Tr,Wr=Or.length,wn=Ir.length,ln=new Array(wn),Bn;for(Tr=0;Tr<wn;++Tr){for(var Cn=Ir[Tr],Wn=ln[Tr]=new Array(Wr),Hn=0,ga;Hn<Wr;++Hn)Wn[Hn]=ga=[0,+ar(Or[Hn],Cn,Hn,Or)],ga.data=Or[Hn];Wn.key=Cn}for(Tr=0,Bn=Et(ln);Tr<wn;++Tr)ln[Bn[Tr]].index=Tr;return Vt(ln,Bn),ln}return Cr.keys=function(Or){return arguments.length?(tt=typeof Or=="function"?Or:S(Z.call(Or)),Cr):tt},Cr.value=function(Or){return arguments.length?(ar=typeof Or=="function"?Or:S(+Or),Cr):ar},Cr.order=function(Or){return arguments.length?(Et=Or==null?At:typeof Or=="function"?Or:S(Z.call(Or)),Cr):Et},Cr.offset=function(Or){return arguments.length?(Vt=Or==null?ct:Or,Cr):Vt},Cr}function Ht(tt,Et){if((ar=tt.length)>0){for(var Vt,ar,Cr=0,Or=tt[0].length,Ir;Cr<Or;++Cr){for(Ir=Vt=0;Vt<ar;++Vt)Ir+=tt[Vt][Cr][1]||0;if(Ir)for(Vt=0;Vt<ar;++Vt)tt[Vt][Cr][1]/=Ir}ct(tt,Et)}}function ir(tt,Et){if((Wr=tt.length)>0)for(var Vt,ar=0,Cr,Or,Ir,Tr,Wr,wn=tt[Et[0]].length;ar<wn;++ar)for(Ir=Tr=0,Vt=0;Vt<Wr;++Vt)(Or=(Cr=tt[Et[Vt]][ar])[1]-Cr[0])>0?(Cr[0]=Ir,Cr[1]=Ir+=Or):Or<0?(Cr[1]=Tr,Cr[0]=Tr+=Or):(Cr[0]=0,Cr[1]=Or)}function kr(tt,Et){if((Cr=tt.length)>0){for(var Vt=0,ar=tt[Et[0]],Cr,Or=ar.length;Vt<Or;++Vt){for(var Ir=0,Tr=0;Ir<Cr;++Ir)Tr+=tt[Ir][Vt][1]||0;ar[Vt][1]+=ar[Vt][0]=-Tr/2}ct(tt,Et)}}function br(tt,Et){if(!(!((Ir=tt.length)>0)||!((Or=(Cr=tt[Et[0]]).length)>0))){for(var Vt=0,ar=1,Cr,Or,Ir;ar<Or;++ar){for(var Tr=0,Wr=0,wn=0;Tr<Ir;++Tr){for(var ln=tt[Et[Tr]],Bn=ln[ar][1]||0,Cn=ln[ar-1][1]||0,Wn=(Bn-Cn)/2,Hn=0;Hn<Tr;++Hn){var ga=tt[Et[Hn]],La=ga[ar][1]||0,ci=ga[ar-1][1]||0;Wn+=La-ci}Wr+=Bn,wn+=Wn*Bn}Cr[ar-1][1]+=Cr[ar-1][0]=Vt,Wr&&(Vt-=wn/Wr)}Cr[ar-1][1]+=Cr[ar-1][0]=Vt,ct(tt,Et)}}function Mr(tt){var Et=tt.map(Hr);return At(tt).sort(function(Vt,ar){return Et[Vt]-Et[ar]})}function Hr(tt){for(var Et=-1,Vt=0,ar=tt.length,Cr,Or=-1/0;++Et<ar;)(Cr=+tt[Et][1])>Or&&(Or=Cr,Vt=Et);return Vt}function nr(tt){var Et=tt.map(mr);return At(tt).sort(function(Vt,ar){return Et[Vt]-Et[ar]})}function mr(tt){for(var Et=0,Vt=-1,ar=tt.length,Cr;++Vt<ar;)(Cr=+tt[Vt][1])&&(Et+=Cr);return Et}function Pr(tt){return nr(tt).reverse()}function Nr(tt){var Et=tt.length,Vt,ar,Cr=tt.map(mr),Or=Mr(tt),Ir=0,Tr=0,Wr=[],wn=[];for(Vt=0;Vt<Et;++Vt)ar=Or[Vt],Ir<Tr?(Ir+=Cr[ar],Wr.push(ar)):(Tr+=Cr[ar],wn.push(ar));return wn.reverse().concat(Wr)}function Sr(tt){return At(tt).reverse()}w.arc=x,w.area=z,w.areaRadial=X,w.curveBasis=Lt,w.curveBasisClosed=Gt,w.curveBasisOpen=kt,w.curveBundle=qe,w.curveCardinal=Ne,w.curveCardinalClosed=Je,w.curveCardinalOpen=mt,w.curveCatmullRom=Nt,w.curveCatmullRomClosed=qt,w.curveCatmullRomOpen=fr,w.curveLinear=L,w.curveLinearClosed=hn,w.curveMonotoneX=Ke,w.curveMonotoneY=st,w.curveNatural=Pt,w.curveStep=Se,w.curveStepAfter=it,w.curveStepBefore=nt,w.line=P,w.lineRadial=J,w.linkHorizontal=$,w.linkRadial=K,w.linkVertical=W,w.pie=R,w.pointRadial=Y,w.radialArea=X,w.radialLine=J,w.stack=Tt,w.stackOffsetDiverging=ir,w.stackOffsetExpand=Ht,w.stackOffsetNone=ct,w.stackOffsetSilhouette=kr,w.stackOffsetWiggle=br,w.stackOrderAppearance=Mr,w.stackOrderAscending=nr,w.stackOrderDescending=Pr,w.stackOrderInsideOut=Nr,w.stackOrderNone=At,w.stackOrderReverse=Sr,w.symbol=He,w.symbolCircle=ne,w.symbolCross=ae,w.symbolDiamond=ye,w.symbolSquare=ze,w.symbolStar=_e,w.symbolTriangle=Ye,w.symbolWye=Be,w.symbols=Le,Object.defineProperty(w,"__esModule",{value:!0})})},{"d3-path":117}],120:[function(d,ee,te){(function(w,v){typeof te=="object"&&typeof ee<"u"?v(te,d("d3-time")):(w=w||self,v(w.d3=w.d3||{},w.d3))})(this,function(w,v){function S(Ue){if(0<=Ue.y&&Ue.y<100){var qe=new Date(-1,Ue.m,Ue.d,Ue.H,Ue.M,Ue.S,Ue.L);return qe.setFullYear(Ue.y),qe}return new Date(Ue.y,Ue.m,Ue.d,Ue.H,Ue.M,Ue.S,Ue.L)}function M(Ue){if(0<=Ue.y&&Ue.y<100){var qe=new Date(Date.UTC(-1,Ue.m,Ue.d,Ue.H,Ue.M,Ue.S,Ue.L));return qe.setUTCFullYear(Ue.y),qe}return new Date(Date.UTC(Ue.y,Ue.m,Ue.d,Ue.H,Ue.M,Ue.S,Ue.L))}function e(Ue,qe,Ve){return{y:Ue,m:qe,d:Ve,H:0,M:0,S:0,L:0}}function a(Ue){var qe=Ue.dateTime,Ve=Ue.date,Ae=Ue.time,Ne=Ue.periods,Xe=Ue.days,Je=Ue.shortDays,_t=Ue.months,mt=Ue.shortMonths,Ot=y(Ne),Kt=p(Ne),Nt=y(Xe),Wt=p(Xe),qt=y(Je),Yt=p(Je),fr=y(_t),Yr=p(_t),hn=y(mt),Qr=p(mt),at={a:it,A:ct,b:At,B:dt,c:null,d:F,e:F,f:Y,H,I:G,j:J,L:X,m:Z,M:oe,p:Tt,q:Ht,Q:He,s:vt,S:re,u:se,U:N,V:U,w:q,W:$,x:null,X:null,y:W,Y:K,Z:ne,"%":Le},Jt={a:ir,A:kr,b:br,B:Mr,c:null,d:ae,e:ae,f:pe,H:ie,I:le,j:ye,L:ue,m:ge,M:Te,p:Hr,q:nr,Q:He,s:vt,S:_e,u:ze,U:Oe,V:Ye,w:be,W:Pe,x:null,X:null,y:Ge,Y:Qe,Z:Be,"%":Le},Zt={a:st,A:lt,b:wt,B:Pt,c:ke,d:l,e:l,f:I,H:T,I:T,j:L,L:z,m:x,M:k,p:Ke,q:f,Q:R,s:B,S:P,u:h,U:m,V:u,w:g,W:_,x:Se,X:nt,y:A,Y:s,Z:b,"%":D};at.x=Ut(Ve,at),at.X=Ut(Ae,at),at.c=Ut(qe,at),Jt.x=Ut(Ve,Jt),Jt.X=Ut(Ae,Jt),Jt.c=Ut(qe,Jt);function Ut(mr,Pr){return function(Nr){var Sr=[],tt=-1,Et=0,Vt=mr.length,ar,Cr,Or;for(Nr instanceof Date||(Nr=new Date(+Nr));++tt<Vt;)mr.charCodeAt(tt)===37&&(Sr.push(mr.slice(Et,tt)),(Cr=n[ar=mr.charAt(++tt)])!=null?ar=mr.charAt(++tt):Cr=ar==="e"?" ":"0",(Or=Pr[ar])&&(ar=Or(Nr,Cr)),Sr.push(ar),Et=tt+1);return Sr.push(mr.slice(Et,tt)),Sr.join("")}}function _r(mr,Pr){return function(Nr){var Sr=e(1900,void 0,1),tt=rt(Sr,mr,Nr+="",0),Et,Vt;if(tt!=Nr.length)return null;if("Q"in Sr)return new Date(Sr.Q);if("s"in Sr)return new Date(Sr.s*1e3+("L"in Sr?Sr.L:0));if(Pr&&!("Z"in Sr)&&(Sr.Z=0),"p"in Sr&&(Sr.H=Sr.H%12+Sr.p*12),Sr.m===void 0&&(Sr.m="q"in Sr?Sr.q:0),"V"in Sr){if(Sr.V<1||Sr.V>53)return null;"w"in Sr||(Sr.w=1),"Z"in Sr?(Et=M(e(Sr.y,0,1)),Vt=Et.getUTCDay(),Et=Vt>4||Vt===0?v.utcMonday.ceil(Et):v.utcMonday(Et),Et=v.utcDay.offset(Et,(Sr.V-1)*7),Sr.y=Et.getUTCFullYear(),Sr.m=Et.getUTCMonth(),Sr.d=Et.getUTCDate()+(Sr.w+6)%7):(Et=S(e(Sr.y,0,1)),Vt=Et.getDay(),Et=Vt>4||Vt===0?v.timeMonday.ceil(Et):v.timeMonday(Et),Et=v.timeDay.offset(Et,(Sr.V-1)*7),Sr.y=Et.getFullYear(),Sr.m=Et.getMonth(),Sr.d=Et.getDate()+(Sr.w+6)%7)}else("W"in Sr||"U"in Sr)&&("w"in Sr||(Sr.w="u"in Sr?Sr.u%7:"W"in Sr?1:0),Vt="Z"in Sr?M(e(Sr.y,0,1)).getUTCDay():S(e(Sr.y,0,1)).getDay(),Sr.m=0,Sr.d="W"in Sr?(Sr.w+6)%7+Sr.W*7-(Vt+5)%7:Sr.w+Sr.U*7-(Vt+6)%7);return"Z"in Sr?(Sr.H+=Sr.Z/100|0,Sr.M+=Sr.Z%100,M(Sr)):S(Sr)}}function rt(mr,Pr,Nr,Sr){for(var tt=0,Et=Pr.length,Vt=Nr.length,ar,Cr;tt<Et;){if(Sr>=Vt)return-1;if(ar=Pr.charCodeAt(tt++),ar===37){if(ar=Pr.charAt(tt++),Cr=Zt[ar in n?Pr.charAt(tt++):ar],!Cr||(Sr=Cr(mr,Nr,Sr))<0)return-1}else if(ar!=Nr.charCodeAt(Sr++))return-1}return Sr}function Ke(mr,Pr,Nr){var Sr=Ot.exec(Pr.slice(Nr));return Sr?(mr.p=Kt[Sr[0].toLowerCase()],Nr+Sr[0].length):-1}function st(mr,Pr,Nr){var Sr=qt.exec(Pr.slice(Nr));return Sr?(mr.w=Yt[Sr[0].toLowerCase()],Nr+Sr[0].length):-1}function lt(mr,Pr,Nr){var Sr=Nt.exec(Pr.slice(Nr));return Sr?(mr.w=Wt[Sr[0].toLowerCase()],Nr+Sr[0].length):-1}function wt(mr,Pr,Nr){var Sr=hn.exec(Pr.slice(Nr));return Sr?(mr.m=Qr[Sr[0].toLowerCase()],Nr+Sr[0].length):-1}function Pt(mr,Pr,Nr){var Sr=fr.exec(Pr.slice(Nr));return Sr?(mr.m=Yr[Sr[0].toLowerCase()],Nr+Sr[0].length):-1}function ke(mr,Pr,Nr){return rt(mr,qe,Pr,Nr)}function Se(mr,Pr,Nr){return rt(mr,Ve,Pr,Nr)}function nt(mr,Pr,Nr){return rt(mr,Ae,Pr,Nr)}function it(mr){return Je[mr.getDay()]}function ct(mr){return Xe[mr.getDay()]}function At(mr){return mt[mr.getMonth()]}function dt(mr){return _t[mr.getMonth()]}function Tt(mr){return Ne[+(mr.getHours()>=12)]}function Ht(mr){return 1+~~(mr.getMonth()/3)}function ir(mr){return Je[mr.getUTCDay()]}function kr(mr){return Xe[mr.getUTCDay()]}function br(mr){return mt[mr.getUTCMonth()]}function Mr(mr){return _t[mr.getUTCMonth()]}function Hr(mr){return Ne[+(mr.getUTCHours()>=12)]}function nr(mr){return 1+~~(mr.getUTCMonth()/3)}return{format:function(mr){var Pr=Ut(mr+="",at);return Pr.toString=function(){return mr},Pr},parse:function(mr){var Pr=_r(mr+="",!1);return Pr.toString=function(){return mr},Pr},utcFormat:function(mr){var Pr=Ut(mr+="",Jt);return Pr.toString=function(){return mr},Pr},utcParse:function(mr){var Pr=_r(mr+="",!0);return Pr.toString=function(){return mr},Pr}}}var n={"-":"",_:" ",0:"0"},r=/^\s*\d+/,t=/^%/,c=/[\\^$*+?|[\]().{}]/g;function o(Ue,qe,Ve){var Ae=Ue<0?"-":"",Ne=(Ae?-Ue:Ue)+"",Xe=Ne.length;return Ae+(Xe<Ve?new Array(Ve-Xe+1).join(qe)+Ne:Ne)}function i(Ue){return Ue.replace(c,"\\$&")}function y(Ue){return new RegExp("^(?:"+Ue.map(i).join("|")+")","i")}function p(Ue){for(var qe={},Ve=-1,Ae=Ue.length;++Ve<Ae;)qe[Ue[Ve].toLowerCase()]=Ve;return qe}function g(Ue,qe,Ve){var Ae=r.exec(qe.slice(Ve,Ve+1));return Ae?(Ue.w=+Ae[0],Ve+Ae[0].length):-1}function h(Ue,qe,Ve){var Ae=r.exec(qe.slice(Ve,Ve+1));return Ae?(Ue.u=+Ae[0],Ve+Ae[0].length):-1}function m(Ue,qe,Ve){var Ae=r.exec(qe.slice(Ve,Ve+2));return Ae?(Ue.U=+Ae[0],Ve+Ae[0].length):-1}function u(Ue,qe,Ve){var Ae=r.exec(qe.slice(Ve,Ve+2));return Ae?(Ue.V=+Ae[0],Ve+Ae[0].length):-1}function _(Ue,qe,Ve){var Ae=r.exec(qe.slice(Ve,Ve+2));return Ae?(Ue.W=+Ae[0],Ve+Ae[0].length):-1}function s(Ue,qe,Ve){var Ae=r.exec(qe.slice(Ve,Ve+4));return Ae?(Ue.y=+Ae[0],Ve+Ae[0].length):-1}function A(Ue,qe,Ve){var Ae=r.exec(qe.slice(Ve,Ve+2));return Ae?(Ue.y=+Ae[0]+(+Ae[0]>68?1900:2e3),Ve+Ae[0].length):-1}function b(Ue,qe,Ve){var Ae=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(qe.slice(Ve,Ve+6));return Ae?(Ue.Z=Ae[1]?0:-(Ae[2]+(Ae[3]||"00")),Ve+Ae[0].length):-1}function f(Ue,qe,Ve){var Ae=r.exec(qe.slice(Ve,Ve+1));return Ae?(Ue.q=Ae[0]*3-3,Ve+Ae[0].length):-1}function x(Ue,qe,Ve){var Ae=r.exec(qe.slice(Ve,Ve+2));return Ae?(Ue.m=Ae[0]-1,Ve+Ae[0].length):-1}function l(Ue,qe,Ve){var Ae=r.exec(qe.slice(Ve,Ve+2));return Ae?(Ue.d=+Ae[0],Ve+Ae[0].length):-1}function L(Ue,qe,Ve){var Ae=r.exec(qe.slice(Ve,Ve+3));return Ae?(Ue.m=0,Ue.d=+Ae[0],Ve+Ae[0].length):-1}function T(Ue,qe,Ve){var Ae=r.exec(qe.slice(Ve,Ve+2));return Ae?(Ue.H=+Ae[0],Ve+Ae[0].length):-1}function k(Ue,qe,Ve){var Ae=r.exec(qe.slice(Ve,Ve+2));return Ae?(Ue.M=+Ae[0],Ve+Ae[0].length):-1}function P(Ue,qe,Ve){var Ae=r.exec(qe.slice(Ve,Ve+2));return Ae?(Ue.S=+Ae[0],Ve+Ae[0].length):-1}function z(Ue,qe,Ve){var Ae=r.exec(qe.slice(Ve,Ve+3));return Ae?(Ue.L=+Ae[0],Ve+Ae[0].length):-1}function I(Ue,qe,Ve){var Ae=r.exec(qe.slice(Ve,Ve+6));return Ae?(Ue.L=Math.floor(Ae[0]/1e3),Ve+Ae[0].length):-1}function D(Ue,qe,Ve){var Ae=t.exec(qe.slice(Ve,Ve+1));return Ae?Ve+Ae[0].length:-1}function R(Ue,qe,Ve){var Ae=r.exec(qe.slice(Ve));return Ae?(Ue.Q=+Ae[0],Ve+Ae[0].length):-1}function B(Ue,qe,Ve){var Ae=r.exec(qe.slice(Ve));return Ae?(Ue.s=+Ae[0],Ve+Ae[0].length):-1}function F(Ue,qe){return o(Ue.getDate(),qe,2)}function H(Ue,qe){return o(Ue.getHours(),qe,2)}function G(Ue,qe){return o(Ue.getHours()%12||12,qe,2)}function J(Ue,qe){return o(1+v.timeDay.count(v.timeYear(Ue),Ue),qe,3)}function X(Ue,qe){return o(Ue.getMilliseconds(),qe,3)}function Y(Ue,qe){return X(Ue,qe)+"000"}function Z(Ue,qe){return o(Ue.getMonth()+1,qe,2)}function oe(Ue,qe){return o(Ue.getMinutes(),qe,2)}function re(Ue,qe){return o(Ue.getSeconds(),qe,2)}function se(Ue){var qe=Ue.getDay();return qe===0?7:qe}function N(Ue,qe){return o(v.timeSunday.count(v.timeYear(Ue)-1,Ue),qe,2)}function U(Ue,qe){var Ve=Ue.getDay();return Ue=Ve>=4||Ve===0?v.timeThursday(Ue):v.timeThursday.ceil(Ue),o(v.timeThursday.count(v.timeYear(Ue),Ue)+(v.timeYear(Ue).getDay()===4),qe,2)}function q(Ue){return Ue.getDay()}function $(Ue,qe){return o(v.timeMonday.count(v.timeYear(Ue)-1,Ue),qe,2)}function W(Ue,qe){return o(Ue.getFullYear()%100,qe,2)}function K(Ue,qe){return o(Ue.getFullYear()%1e4,qe,4)}function ne(Ue){var qe=Ue.getTimezoneOffset();return(qe>0?"-":(qe*=-1,"+"))+o(qe/60|0,"0",2)+o(qe%60,"0",2)}function ae(Ue,qe){return o(Ue.getUTCDate(),qe,2)}function ie(Ue,qe){return o(Ue.getUTCHours(),qe,2)}function le(Ue,qe){return o(Ue.getUTCHours()%12||12,qe,2)}function ye(Ue,qe){return o(1+v.utcDay.count(v.utcYear(Ue),Ue),qe,3)}function ue(Ue,qe){return o(Ue.getUTCMilliseconds(),qe,3)}function pe(Ue,qe){return ue(Ue,qe)+"000"}function ge(Ue,qe){return o(Ue.getUTCMonth()+1,qe,2)}function Te(Ue,qe){return o(Ue.getUTCMinutes(),qe,2)}function _e(Ue,qe){return o(Ue.getUTCSeconds(),qe,2)}function ze(Ue){var qe=Ue.getUTCDay();return qe===0?7:qe}function Oe(Ue,qe){return o(v.utcSunday.count(v.utcYear(Ue)-1,Ue),qe,2)}function Ye(Ue,qe){var Ve=Ue.getUTCDay();return Ue=Ve>=4||Ve===0?v.utcThursday(Ue):v.utcThursday.ceil(Ue),o(v.utcThursday.count(v.utcYear(Ue),Ue)+(v.utcYear(Ue).getUTCDay()===4),qe,2)}function be(Ue){return Ue.getUTCDay()}function Pe(Ue,qe){return o(v.utcMonday.count(v.utcYear(Ue)-1,Ue),qe,2)}function Ge(Ue,qe){return o(Ue.getUTCFullYear()%100,qe,2)}function Qe(Ue,qe){return o(Ue.getUTCFullYear()%1e4,qe,4)}function Be(){return"+0000"}function Le(){return"%"}function He(Ue){return+Ue}function vt(Ue){return Math.floor(+Ue/1e3)}var Rt;rr({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function rr(Ue){return Rt=a(Ue),w.timeFormat=Rt.format,w.timeParse=Rt.parse,w.utcFormat=Rt.utcFormat,w.utcParse=Rt.utcParse,Rt}var Lt="%Y-%m-%dT%H:%M:%S.%LZ";function Ft(Ue){return Ue.toISOString()}var Gt=Date.prototype.toISOString?Ft:w.utcFormat(Lt);function Dt(Ue){var qe=new Date(Ue);return isNaN(qe)?null:qe}var kt=+new Date("2000-01-01T00:00:00.000Z")?Dt:w.utcParse(Lt);w.isoFormat=Gt,w.isoParse=kt,w.timeFormatDefaultLocale=rr,w.timeFormatLocale=a,Object.defineProperty(w,"__esModule",{value:!0})})},{"d3-time":121}],121:[function(d,ee,te){(function(w,v){typeof te=="object"&&typeof ee<"u"?v(te):(w=w||self,v(w.d3=w.d3||{}))})(this,function(w){var v=new Date,S=new Date;function M(be,Pe,Ge,Qe){function Be(Le){return be(Le=arguments.length===0?new Date:new Date(+Le)),Le}return Be.floor=function(Le){return be(Le=new Date(+Le)),Le},Be.ceil=function(Le){return be(Le=new Date(Le-1)),Pe(Le,1),be(Le),Le},Be.round=function(Le){var He=Be(Le),vt=Be.ceil(Le);return Le-He<vt-Le?He:vt},Be.offset=function(Le,He){return Pe(Le=new Date(+Le),He==null?1:Math.floor(He)),Le},Be.range=function(Le,He,vt){var Rt=[],rr;if(Le=Be.ceil(Le),vt=vt==null?1:Math.floor(vt),!(Le<He)||!(vt>0))return Rt;do Rt.push(rr=new Date(+Le)),Pe(Le,vt),be(Le);while(rr<Le&&Le<He);return Rt},Be.filter=function(Le){return M(function(He){if(He>=He)for(;be(He),!Le(He);)He.setTime(He-1)},function(He,vt){if(He>=He)if(vt<0)for(;++vt<=0;)for(;Pe(He,-1),!Le(He););else for(;--vt>=0;)for(;Pe(He,1),!Le(He););})},Ge&&(Be.count=function(Le,He){return v.setTime(+Le),S.setTime(+He),be(v),be(S),Math.floor(Ge(v,S))},Be.every=function(Le){return Le=Math.floor(Le),!isFinite(Le)||!(Le>0)?null:Le>1?Be.filter(Qe?function(He){return Qe(He)%Le===0}:function(He){return Be.count(0,He)%Le===0}):Be}),Be}var e=M(function(){},function(be,Pe){be.setTime(+be+Pe)},function(be,Pe){return Pe-be});e.every=function(be){return be=Math.floor(be),!isFinite(be)||!(be>0)?null:be>1?M(function(Pe){Pe.setTime(Math.floor(Pe/be)*be)},function(Pe,Ge){Pe.setTime(+Pe+Ge*be)},function(Pe,Ge){return(Ge-Pe)/be}):e};var a=e.range,n=1e3,r=6e4,t=36e5,c=864e5,o=6048e5,i=M(function(be){be.setTime(be-be.getMilliseconds())},function(be,Pe){be.setTime(+be+Pe*n)},function(be,Pe){return(Pe-be)/n},function(be){return be.getUTCSeconds()}),y=i.range,p=M(function(be){be.setTime(be-be.getMilliseconds()-be.getSeconds()*n)},function(be,Pe){be.setTime(+be+Pe*r)},function(be,Pe){return(Pe-be)/r},function(be){return be.getMinutes()}),g=p.range,h=M(function(be){be.setTime(be-be.getMilliseconds()-be.getSeconds()*n-be.getMinutes()*r)},function(be,Pe){be.setTime(+be+Pe*t)},function(be,Pe){return(Pe-be)/t},function(be){return be.getHours()}),m=h.range,u=M(function(be){be.setHours(0,0,0,0)},function(be,Pe){be.setDate(be.getDate()+Pe)},function(be,Pe){return(Pe-be-(Pe.getTimezoneOffset()-be.getTimezoneOffset())*r)/c},function(be){return be.getDate()-1}),_=u.range;function s(be){return M(function(Pe){Pe.setDate(Pe.getDate()-(Pe.getDay()+7-be)%7),Pe.setHours(0,0,0,0)},function(Pe,Ge){Pe.setDate(Pe.getDate()+Ge*7)},function(Pe,Ge){return(Ge-Pe-(Ge.getTimezoneOffset()-Pe.getTimezoneOffset())*r)/o})}var A=s(0),b=s(1),f=s(2),x=s(3),l=s(4),L=s(5),T=s(6),k=A.range,P=b.range,z=f.range,I=x.range,D=l.range,R=L.range,B=T.range,F=M(function(be){be.setDate(1),be.setHours(0,0,0,0)},function(be,Pe){be.setMonth(be.getMonth()+Pe)},function(be,Pe){return Pe.getMonth()-be.getMonth()+(Pe.getFullYear()-be.getFullYear())*12},function(be){return be.getMonth()}),H=F.range,G=M(function(be){be.setMonth(0,1),be.setHours(0,0,0,0)},function(be,Pe){be.setFullYear(be.getFullYear()+Pe)},function(be,Pe){return Pe.getFullYear()-be.getFullYear()},function(be){return be.getFullYear()});G.every=function(be){return!isFinite(be=Math.floor(be))||!(be>0)?null:M(function(Pe){Pe.setFullYear(Math.floor(Pe.getFullYear()/be)*be),Pe.setMonth(0,1),Pe.setHours(0,0,0,0)},function(Pe,Ge){Pe.setFullYear(Pe.getFullYear()+Ge*be)})};var J=G.range,X=M(function(be){be.setUTCSeconds(0,0)},function(be,Pe){be.setTime(+be+Pe*r)},function(be,Pe){return(Pe-be)/r},function(be){return be.getUTCMinutes()}),Y=X.range,Z=M(function(be){be.setUTCMinutes(0,0,0)},function(be,Pe){be.setTime(+be+Pe*t)},function(be,Pe){return(Pe-be)/t},function(be){return be.getUTCHours()}),oe=Z.range,re=M(function(be){be.setUTCHours(0,0,0,0)},function(be,Pe){be.setUTCDate(be.getUTCDate()+Pe)},function(be,Pe){return(Pe-be)/c},function(be){return be.getUTCDate()-1}),se=re.range;function N(be){return M(function(Pe){Pe.setUTCDate(Pe.getUTCDate()-(Pe.getUTCDay()+7-be)%7),Pe.setUTCHours(0,0,0,0)},function(Pe,Ge){Pe.setUTCDate(Pe.getUTCDate()+Ge*7)},function(Pe,Ge){return(Ge-Pe)/o})}var U=N(0),q=N(1),$=N(2),W=N(3),K=N(4),ne=N(5),ae=N(6),ie=U.range,le=q.range,ye=$.range,ue=W.range,pe=K.range,ge=ne.range,Te=ae.range,_e=M(function(be){be.setUTCDate(1),be.setUTCHours(0,0,0,0)},function(be,Pe){be.setUTCMonth(be.getUTCMonth()+Pe)},function(be,Pe){return Pe.getUTCMonth()-be.getUTCMonth()+(Pe.getUTCFullYear()-be.getUTCFullYear())*12},function(be){return be.getUTCMonth()}),ze=_e.range,Oe=M(function(be){be.setUTCMonth(0,1),be.setUTCHours(0,0,0,0)},function(be,Pe){be.setUTCFullYear(be.getUTCFullYear()+Pe)},function(be,Pe){return Pe.getUTCFullYear()-be.getUTCFullYear()},function(be){return be.getUTCFullYear()});Oe.every=function(be){return!isFinite(be=Math.floor(be))||!(be>0)?null:M(function(Pe){Pe.setUTCFullYear(Math.floor(Pe.getUTCFullYear()/be)*be),Pe.setUTCMonth(0,1),Pe.setUTCHours(0,0,0,0)},function(Pe,Ge){Pe.setUTCFullYear(Pe.getUTCFullYear()+Ge*be)})};var Ye=Oe.range;w.timeDay=u,w.timeDays=_,w.timeFriday=L,w.timeFridays=R,w.timeHour=h,w.timeHours=m,w.timeInterval=M,w.timeMillisecond=e,w.timeMilliseconds=a,w.timeMinute=p,w.timeMinutes=g,w.timeMonday=b,w.timeMondays=P,w.timeMonth=F,w.timeMonths=H,w.timeSaturday=T,w.timeSaturdays=B,w.timeSecond=i,w.timeSeconds=y,w.timeSunday=A,w.timeSundays=k,w.timeThursday=l,w.timeThursdays=D,w.timeTuesday=f,w.timeTuesdays=z,w.timeWednesday=x,w.timeWednesdays=I,w.timeWeek=A,w.timeWeeks=k,w.timeYear=G,w.timeYears=J,w.utcDay=re,w.utcDays=se,w.utcFriday=ne,w.utcFridays=ge,w.utcHour=Z,w.utcHours=oe,w.utcMillisecond=e,w.utcMilliseconds=a,w.utcMinute=X,w.utcMinutes=Y,w.utcMonday=q,w.utcMondays=le,w.utcMonth=_e,w.utcMonths=ze,w.utcSaturday=ae,w.utcSaturdays=Te,w.utcSecond=i,w.utcSeconds=y,w.utcSunday=U,w.utcSundays=ie,w.utcThursday=K,w.utcThursdays=pe,w.utcTuesday=$,w.utcTuesdays=ye,w.utcWednesday=W,w.utcWednesdays=ue,w.utcWeek=U,w.utcWeeks=ie,w.utcYear=Oe,w.utcYears=Ye,Object.defineProperty(w,"__esModule",{value:!0})})},{}],122:[function(d,ee,te){arguments[4][121][0].apply(te,arguments)},{dup:121}],123:[function(d,ee,te){(function(w,v){typeof te=="object"&&typeof ee<"u"?v(te):(w=w||self,v(w.d3=w.d3||{}))})(this,function(w){var v=0,S=0,M=0,e=1e3,a,n,r=0,t=0,c=0,o=typeof performance=="object"&&performance.now?performance:Date,i=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(x){setTimeout(x,17)};function y(){return t||(i(p),t=o.now()+c)}function p(){t=0}function g(){this._call=this._time=this._next=null}g.prototype=h.prototype={constructor:g,restart:function(x,l,L){if(typeof x!="function")throw new TypeError("callback is not a function");L=(L==null?y():+L)+(l==null?0:+l),!this._next&&n!==this&&(n?n._next=this:a=this,n=this),this._call=x,this._time=L,A()},stop:function(){this._call&&(this._call=null,this._time=1/0,A())}};function h(x,l,L){var T=new g;return T.restart(x,l,L),T}function m(){y(),++v;for(var x=a,l;x;)(l=t-x._time)>=0&&x._call.call(null,l),x=x._next;--v}function u(){t=(r=o.now())+c,v=S=0;try{m()}finally{v=0,s(),t=0}}function _(){var x=o.now(),l=x-r;l>e&&(c-=l,r=x)}function s(){for(var x,l=a,L,T=1/0;l;)l._call?(T>l._time&&(T=l._time),x=l,l=l._next):(L=l._next,l._next=null,l=x?x._next=L:a=L);n=x,A(T)}function A(x){if(!v){S&&(S=clearTimeout(S));var l=x-t;l>24?(x<1/0&&(S=setTimeout(u,x-o.now()-c)),M&&(M=clearInterval(M))):(M||(r=o.now(),M=setInterval(_,e)),v=1,i(u))}}function b(x,l,L){var T=new g;return l=l==null?0:+l,T.restart(function(k){T.stop(),x(k+l)},l,L),T}function f(x,l,L){var T=new g,k=l;return l==null?(T.restart(x,l,L),T):(l=+l,L=L==null?y():+L,T.restart(function P(z){z+=k,T.restart(P,k+=l,L),x(z)},l,L),T)}w.interval=f,w.now=y,w.timeout=b,w.timer=h,w.timerFlush=m,Object.defineProperty(w,"__esModule",{value:!0})})},{}],124:[function(d,ee,te){ee.exports=function(){for(var w=0;w<arguments.length;w++)if(arguments[w]!==void 0)return arguments[w]}},{}],125:[function(d,ee,te){ee.exports=M;var w=M.canvas=document.createElement("canvas"),v=w.getContext("2d"),S=e([32,126]);M.createPairs=e,M.ascii=S;function M(a,n){Array.isArray(a)&&(a=a.join(", "));var r={},t,c=16,o=.05;n&&(n.length===2&&typeof n[0]=="number"?t=e(n):Array.isArray(n)?t=n:(n.o?t=e(n.o):n.pairs&&(t=n.pairs),n.fontSize&&(c=n.fontSize),n.threshold!=null&&(o=n.threshold))),t||(t=S),v.font=c+"px "+a;for(var i=0;i<t.length;i++){var y=t[i],p=v.measureText(y[0]).width+v.measureText(y[1]).width,g=v.measureText(y).width;if(Math.abs(p-g)>c*o){var h=(g-p)/c;r[y]=h*1e3}}return r}function e(a){for(var n=[],r=a[0];r<=a[1];r++)for(var t=String.fromCharCode(r),c=a[0];c<a[1];c++){var o=String.fromCharCode(c),i=t+o;n.push(i)}return n}},{}],126:[function(d,ee,te){var w=d("abs-svg-path"),v=d("normalize-svg-path"),S={M:"moveTo",C:"bezierCurveTo"};ee.exports=function(M,e){M.beginPath(),v(w(e)).forEach(function(a){var n=a[0],r=a.slice(1);M[S[n]].apply(M,r)}),M.closePath()}},{"abs-svg-path":70,"normalize-svg-path":246}],127:[function(d,ee,te){ee.exports=function(w){switch(w){case"int8":return Int8Array;case"int16":return Int16Array;case"int32":return Int32Array;case"uint8":return Uint8Array;case"uint16":return Uint16Array;case"uint32":return Uint32Array;case"float32":return Float32Array;case"float64":return Float64Array;case"array":return Array;case"uint8_clamped":return Uint8ClampedArray}}},{}],128:[function(d,ee,te){function w(M,e,a){var n=M[a]|0;if(n<=0)return[];var r=new Array(n),t;if(a===M.length-1)for(t=0;t<n;++t)r[t]=e;else for(t=0;t<n;++t)r[t]=w(M,e,a+1);return r}function v(M,e){var a,n;for(a=new Array(M),n=0;n<M;++n)a[n]=e;return a}function S(M,e){switch(typeof e>"u"&&(e=0),typeof M){case"number":if(M>0)return v(M|0,e);break;case"object":if(typeof M.length=="number")return w(M,e,0);break}return[]}ee.exports=S},{}],129:[function(d,ee,te){ee.exports=w,ee.exports.default=w;function w(R,B,F){F=F||2;var H=B&&B.length,G=H?B[0]*F:R.length,J=v(R,0,G,F,!0),X=[];if(!J||J.next===J.prev)return X;var Y,Z,oe,re,se,N,U;if(H&&(J=t(R,B,J,F)),R.length>80*F){Y=oe=R[0],Z=re=R[1];for(var q=F;q<G;q+=F)se=R[q],N=R[q+1],se<Y&&(Y=se),N<Z&&(Z=N),se>oe&&(oe=se),N>re&&(re=N);U=Math.max(oe-Y,re-Z),U=U!==0?1/U:0}return M(J,X,F,Y,Z,U),X}function v(R,B,F,H,G){var J,X;if(G===D(R,B,F,H)>0)for(J=B;J<F;J+=H)X=P(J,R[J],R[J+1],X);else for(J=F-H;J>=B;J-=H)X=P(J,R[J],R[J+1],X);return X&&A(X,X.next)&&(z(X),X=X.next),X}function S(R,B){if(!R)return R;B||(B=R);var F=R,H;do if(H=!1,!F.steiner&&(A(F,F.next)||s(F.prev,F,F.next)===0)){if(z(F),F=B=F.prev,F===F.next)break;H=!0}else F=F.next;while(H||F!==B);return B}function M(R,B,F,H,G,J,X){if(!!R){!X&&J&&p(R,H,G,J);for(var Y=R,Z,oe;R.prev!==R.next;){if(Z=R.prev,oe=R.next,J?a(R,H,G,J):e(R)){B.push(Z.i/F),B.push(R.i/F),B.push(oe.i/F),z(R),R=oe.next,Y=oe.next;continue}if(R=oe,R===Y){X?X===1?(R=n(S(R),B,F),M(R,B,F,H,G,J,2)):X===2&&r(R,B,F,H,G,J):M(S(R),B,F,H,G,J,1);break}}}}function e(R){var B=R.prev,F=R,H=R.next;if(s(B,F,H)>=0)return!1;for(var G=R.next.next;G!==R.prev;){if(u(B.x,B.y,F.x,F.y,H.x,H.y,G.x,G.y)&&s(G.prev,G,G.next)>=0)return!1;G=G.next}return!0}function a(R,B,F,H){var G=R.prev,J=R,X=R.next;if(s(G,J,X)>=0)return!1;for(var Y=G.x<J.x?G.x<X.x?G.x:X.x:J.x<X.x?J.x:X.x,Z=G.y<J.y?G.y<X.y?G.y:X.y:J.y<X.y?J.y:X.y,oe=G.x>J.x?G.x>X.x?G.x:X.x:J.x>X.x?J.x:X.x,re=G.y>J.y?G.y>X.y?G.y:X.y:J.y>X.y?J.y:X.y,se=h(Y,Z,B,F,H),N=h(oe,re,B,F,H),U=R.prevZ,q=R.nextZ;U&&U.z>=se&&q&&q.z<=N;){if(U!==R.prev&&U!==R.next&&u(G.x,G.y,J.x,J.y,X.x,X.y,U.x,U.y)&&s(U.prev,U,U.next)>=0||(U=U.prevZ,q!==R.prev&&q!==R.next&&u(G.x,G.y,J.x,J.y,X.x,X.y,q.x,q.y)&&s(q.prev,q,q.next)>=0))return!1;q=q.nextZ}for(;U&&U.z>=se;){if(U!==R.prev&&U!==R.next&&u(G.x,G.y,J.x,J.y,X.x,X.y,U.x,U.y)&&s(U.prev,U,U.next)>=0)return!1;U=U.prevZ}for(;q&&q.z<=N;){if(q!==R.prev&&q!==R.next&&u(G.x,G.y,J.x,J.y,X.x,X.y,q.x,q.y)&&s(q.prev,q,q.next)>=0)return!1;q=q.nextZ}return!0}function n(R,B,F){var H=R;do{var G=H.prev,J=H.next.next;!A(G,J)&&b(G,H,H.next,J)&&L(G,J)&&L(J,G)&&(B.push(G.i/F),B.push(H.i/F),B.push(J.i/F),z(H),z(H.next),H=R=J),H=H.next}while(H!==R);return S(H)}function r(R,B,F,H,G,J){var X=R;do{for(var Y=X.next.next;Y!==X.prev;){if(X.i!==Y.i&&_(X,Y)){var Z=k(X,Y);X=S(X,X.next),Z=S(Z,Z.next),M(X,B,F,H,G,J),M(Z,B,F,H,G,J);return}Y=Y.next}X=X.next}while(X!==R)}function t(R,B,F,H){var G=[],J,X,Y,Z,oe;for(J=0,X=B.length;J<X;J++)Y=B[J]*H,Z=J<X-1?B[J+1]*H:R.length,oe=v(R,Y,Z,H,!1),oe===oe.next&&(oe.steiner=!0),G.push(m(oe));for(G.sort(c),J=0;J<G.length;J++)o(G[J],F),F=S(F,F.next);return F}function c(R,B){return R.x-B.x}function o(R,B){if(B=i(R,B),B){var F=k(B,R);S(B,B.next),S(F,F.next)}}function i(R,B){var F=B,H=R.x,G=R.y,J=-1/0,X;do{if(G<=F.y&&G>=F.next.y&&F.next.y!==F.y){var Y=F.x+(G-F.y)*(F.next.x-F.x)/(F.next.y-F.y);if(Y<=H&&Y>J){if(J=Y,Y===H){if(G===F.y)return F;if(G===F.next.y)return F.next}X=F.x<F.next.x?F:F.next}}F=F.next}while(F!==B);if(!X)return null;if(H===J)return X;var Z=X,oe=X.x,re=X.y,se=1/0,N;F=X;do H>=F.x&&F.x>=oe&&H!==F.x&&u(G<re?H:J,G,oe,re,G<re?J:H,G,F.x,F.y)&&(N=Math.abs(G-F.y)/(H-F.x),L(F,R)&&(N<se||N===se&&(F.x>X.x||F.x===X.x&&y(X,F)))&&(X=F,se=N)),F=F.next;while(F!==Z);return X}function y(R,B){return s(R.prev,R,B.prev)<0&&s(B.next,R,R.next)<0}function p(R,B,F,H){var G=R;do G.z===null&&(G.z=h(G.x,G.y,B,F,H)),G.prevZ=G.prev,G.nextZ=G.next,G=G.next;while(G!==R);G.prevZ.nextZ=null,G.prevZ=null,g(G)}function g(R){var B,F,H,G,J,X,Y,Z,oe=1;do{for(F=R,R=null,J=null,X=0;F;){for(X++,H=F,Y=0,B=0;B<oe&&(Y++,H=H.nextZ,!!H);B++);for(Z=oe;Y>0||Z>0&&H;)Y!==0&&(Z===0||!H||F.z<=H.z)?(G=F,F=F.nextZ,Y--):(G=H,H=H.nextZ,Z--),J?J.nextZ=G:R=G,G.prevZ=J,J=G;F=H}J.nextZ=null,oe*=2}while(X>1);return R}function h(R,B,F,H,G){return R=32767*(R-F)*G,B=32767*(B-H)*G,R=(R|R<<8)&16711935,R=(R|R<<4)&252645135,R=(R|R<<2)&858993459,R=(R|R<<1)&1431655765,B=(B|B<<8)&16711935,B=(B|B<<4)&252645135,B=(B|B<<2)&858993459,B=(B|B<<1)&1431655765,R|B<<1}function m(R){var B=R,F=R;do(B.x<F.x||B.x===F.x&&B.y<F.y)&&(F=B),B=B.next;while(B!==R);return F}function u(R,B,F,H,G,J,X,Y){return(G-X)*(B-Y)-(R-X)*(J-Y)>=0&&(R-X)*(H-Y)-(F-X)*(B-Y)>=0&&(F-X)*(J-Y)-(G-X)*(H-Y)>=0}function _(R,B){return R.next.i!==B.i&&R.prev.i!==B.i&&!l(R,B)&&(L(R,B)&&L(B,R)&&T(R,B)&&(s(R.prev,R,B.prev)||s(R,B.prev,B))||A(R,B)&&s(R.prev,R,R.next)>0&&s(B.prev,B,B.next)>0)}function s(R,B,F){return(B.y-R.y)*(F.x-B.x)-(B.x-R.x)*(F.y-B.y)}function A(R,B){return R.x===B.x&&R.y===B.y}function b(R,B,F,H){var G=x(s(R,B,F)),J=x(s(R,B,H)),X=x(s(F,H,R)),Y=x(s(F,H,B));return!!(G!==J&&X!==Y||G===0&&f(R,F,B)||J===0&&f(R,H,B)||X===0&&f(F,R,H)||Y===0&&f(F,B,H))}function f(R,B,F){return B.x<=Math.max(R.x,F.x)&&B.x>=Math.min(R.x,F.x)&&B.y<=Math.max(R.y,F.y)&&B.y>=Math.min(R.y,F.y)}function x(R){return R>0?1:R<0?-1:0}function l(R,B){var F=R;do{if(F.i!==R.i&&F.next.i!==R.i&&F.i!==B.i&&F.next.i!==B.i&&b(F,F.next,R,B))return!0;F=F.next}while(F!==R);return!1}function L(R,B){return s(R.prev,R,R.next)<0?s(R,B,R.next)>=0&&s(R,R.prev,B)>=0:s(R,B,R.prev)<0||s(R,R.next,B)<0}function T(R,B){var F=R,H=!1,G=(R.x+B.x)/2,J=(R.y+B.y)/2;do F.y>J!=F.next.y>J&&F.next.y!==F.y&&G<(F.next.x-F.x)*(J-F.y)/(F.next.y-F.y)+F.x&&(H=!H),F=F.next;while(F!==R);return H}function k(R,B){var F=new I(R.i,R.x,R.y),H=new I(B.i,B.x,B.y),G=R.next,J=B.prev;return R.next=B,B.prev=R,F.next=G,G.prev=F,H.next=F,F.prev=H,J.next=H,H.prev=J,H}function P(R,B,F,H){var G=new I(R,B,F);return H?(G.next=H.next,G.prev=H,H.next.prev=G,H.next=G):(G.prev=G,G.next=G),G}function z(R){R.next.prev=R.prev,R.prev.next=R.next,R.prevZ&&(R.prevZ.nextZ=R.nextZ),R.nextZ&&(R.nextZ.prevZ=R.prevZ)}function I(R,B,F){this.i=R,this.x=B,this.y=F,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}w.deviation=function(R,B,F,H){var G=B&&B.length,J=G?B[0]*F:R.length,X=Math.abs(D(R,0,J,F));if(G)for(var Y=0,Z=B.length;Y<Z;Y++){var oe=B[Y]*F,re=Y<Z-1?B[Y+1]*F:R.length;X-=Math.abs(D(R,oe,re,F))}var se=0;for(Y=0;Y<H.length;Y+=3){var N=H[Y]*F,U=H[Y+1]*F,q=H[Y+2]*F;se+=Math.abs((R[N]-R[q])*(R[U+1]-R[N+1])-(R[N]-R[U])*(R[q+1]-R[N+1]))}return X===0&&se===0?0:Math.abs((se-X)/X)};function D(R,B,F,H){for(var G=0,J=B,X=F-H;J<F;J+=H)G+=(R[X]-R[J])*(R[J+1]+R[X+1]),X=J;return G}w.flatten=function(R){for(var B=R[0][0].length,F={vertices:[],holes:[],dimensions:B},H=0,G=0;G<R.length;G++){for(var J=0;J<R[G].length;J++)for(var X=0;X<B;X++)F.vertices.push(R[G][J][X]);G>0&&(H+=R[G-1].length,F.holes.push(H))}return F}},{}],130:[function(d,ee,te){var w=d("strongly-connected-components");ee.exports=function(S,M){var e=[],a=[],n=[],r={},t=[],c;function o(A){n[A]=!1,r.hasOwnProperty(A)&&Object.keys(r[A]).forEach(function(b){delete r[A][b],n[b]&&o(b)})}function i(A){var b=!1;a.push(A),n[A]=!0;var f,x;for(f=0;f<t[A].length;f++)x=t[A][f],x===c?(y(c,a),b=!0):n[x]||(b=i(x));if(b)o(A);else for(f=0;f<t[A].length;f++){x=t[A][f];var l=r[x];l||(l={},r[x]=l),l[x]=!0}return a.pop(),b}function y(A,b){var f=[].concat(b).concat(A);M?M(i):e.push(f)}function p(A){for(var b=0;b<S.length;b++)b<A&&(S[b]=[]),S[b]=S[b].filter(function(f){return f>=A})}function g(A){p(A);for(var b=S,f=w(b),x=f.components.filter(function(I){return I.length>1}),l=1/0,L,T=0;T<x.length;T++)for(var k=0;k<x[T].length;k++)x[T][k]<l&&(l=x[T][k],L=T);var P=x[L];if(!P)return!1;var z=S.map(function(I,D){return P.indexOf(D)===-1?[]:I.filter(function(R){return P.indexOf(R)!==-1})});return{leastVertex:l,adjList:z}}c=0;for(var h=S.length;c<h;){var m=g(c);if(c=m.leastVertex,t=m.adjList,t){for(var u=0;u<t.length;u++)for(var _=0;_<t[u].length;_++){var s=t[u][_];n[+s]=!1,r[s]={}}i(c),c=c+1}else c=h}if(!M)return e}},{"strongly-connected-components":307}],131:[function(d,ee,te){var w=d("../../object/valid-value");ee.exports=function(){return w(this).length=0,this}},{"../../object/valid-value":162}],132:[function(d,ee,te){ee.exports=d("./is-implemented")()?Array.from:d("./shim")},{"./is-implemented":133,"./shim":134}],133:[function(d,ee,te){ee.exports=function(){var w=Array.from,v,S;return typeof w!="function"?!1:(v=["raz","dwa"],S=w(v),Boolean(S&&S!==v&&S[1]==="dwa"))}},{}],134:[function(d,ee,te){var w=d("es6-symbol").iterator,v=d("../../function/is-arguments"),S=d("../../function/is-function"),M=d("../../number/to-pos-integer"),e=d("../../object/valid-callable"),a=d("../../object/valid-value"),n=d("../../object/is-value"),r=d("../../string/is-string"),t=Array.isArray,c=Function.prototype.call,o={configurable:!0,enumerable:!0,writable:!0,value:null},i=Object.defineProperty;ee.exports=function(y){var p=arguments[1],g=arguments[2],h,m,u,_,s,A,b,f,x,l;if(y=Object(a(y)),n(p)&&e(p),!this||this===Array||!S(this)){if(!p){if(v(y))return s=y.length,s!==1?Array.apply(null,y):(_=new Array(1),_[0]=y[0],_);if(t(y)){for(_=new Array(s=y.length),m=0;m<s;++m)_[m]=y[m];return _}}_=[]}else h=this;if(!t(y)){if((x=y[w])!==void 0){for(b=e(x).call(y),h&&(_=new h),f=b.next(),m=0;!f.done;)l=p?c.call(p,g,f.value,m):f.value,h?(o.value=l,i(_,m,o)):_[m]=l,f=b.next(),++m;s=m}else if(r(y)){for(s=y.length,h&&(_=new h),m=0,u=0;m<s;++m)l=y[m],m+1<s&&(A=l.charCodeAt(0),A>=55296&&A<=56319&&(l+=y[++m])),l=p?c.call(p,g,l,u):l,h?(o.value=l,i(_,u,o)):_[u]=l,++u;s=u}}if(s===void 0)for(s=M(y.length),h&&(_=new h(s)),m=0;m<s;++m)l=p?c.call(p,g,y[m],m):y[m],h?(o.value=l,i(_,m,o)):_[m]=l;return h&&(o.value=null,_.length=s),_}},{"../../function/is-arguments":135,"../../function/is-function":136,"../../number/to-pos-integer":142,"../../object/is-value":151,"../../object/valid-callable":160,"../../object/valid-value":162,"../../string/is-string":166,"es6-symbol":175}],135:[function(d,ee,te){var w=Object.prototype.toString,v=w.call(function(){return arguments}());ee.exports=function(S){return w.call(S)===v}},{}],136:[function(d,ee,te){var w=Object.prototype.toString,v=RegExp.prototype.test.bind(/^[object [A-Za-z0-9]*Function]$/);ee.exports=function(S){return typeof S=="function"&&v(w.call(S))}},{}],137:[function(d,ee,te){ee.exports=function(){}},{}],138:[function(d,ee,te){ee.exports=d("./is-implemented")()?Math.sign:d("./shim")},{"./is-implemented":139,"./shim":140}],139:[function(d,ee,te){ee.exports=function(){var w=Math.sign;return typeof w!="function"?!1:w(10)===1&&w(-20)===-1}},{}],140:[function(d,ee,te){ee.exports=function(w){return w=Number(w),isNaN(w)||w===0?w:w>0?1:-1}},{}],141:[function(d,ee,te){var w=d("../math/sign"),v=Math.abs,S=Math.floor;ee.exports=function(M){return isNaN(M)?0:(M=Number(M),M===0||!isFinite(M)?M:w(M)*S(v(M)))}},{"../math/sign":138}],142:[function(d,ee,te){var w=d("./to-integer"),v=Math.max;ee.exports=function(S){return v(0,w(S))}},{"./to-integer":141}],143:[function(d,ee,te){var w=d("./valid-callable"),v=d("./valid-value"),S=Function.prototype.bind,M=Function.prototype.call,e=Object.keys,a=Object.prototype.propertyIsEnumerable;ee.exports=function(n,r){return function(t,c){var o,i=arguments[2],y=arguments[3];return t=Object(v(t)),w(c),o=e(t),y&&o.sort(typeof y=="function"?S.call(y,t):void 0),typeof n!="function"&&(n=o[n]),M.call(n,o,function(p,g){return a.call(t,p)?M.call(c,i,t[p],p,t,g):r})}}},{"./valid-callable":160,"./valid-value":162}],144:[function(d,ee,te){ee.exports=d("./is-implemented")()?Object.assign:d("./shim")},{"./is-implemented":145,"./shim":146}],145:[function(d,ee,te){ee.exports=function(){var w=Object.assign,v;return typeof w!="function"?!1:(v={foo:"raz"},w(v,{bar:"dwa"},{trzy:"trzy"}),v.foo+v.bar+v.trzy==="razdwatrzy")}},{}],146:[function(d,ee,te){var w=d("../keys"),v=d("../valid-value"),S=Math.max;ee.exports=function(M,e){var a,n,r=S(arguments.length,2),t;for(M=Object(v(M)),t=function(c){try{M[c]=e[c]}catch(o){a||(a=o)}},n=1;n<r;++n)e=arguments[n],w(e).forEach(t);if(a!==void 0)throw a;return M}},{"../keys":152,"../valid-value":162}],147:[function(d,ee,te){var w=d("../array/from"),v=d("./assign"),S=d("./valid-value");ee.exports=function(M){var e=Object(S(M)),a=arguments[1],n=Object(arguments[2]);if(e!==M&&!a)return e;var r={};return a?w(a,function(t){(n.ensure||t in M)&&(r[t]=M[t])}):v(r,M),r}},{"../array/from":132,"./assign":144,"./valid-value":162}],148:[function(d,ee,te){var w=Object.create,v;d("./set-prototype-of/is-implemented")()||(v=d("./set-prototype-of/shim")),ee.exports=function(){var S,M,e;return!v||v.level!==1?w:(S={},M={},e={configurable:!1,enumerable:!1,writable:!0,value:void 0},Object.getOwnPropertyNames(Object.prototype).forEach(function(a){if(a==="__proto__"){M[a]={configurable:!0,enumerable:!1,writable:!0,value:void 0};return}M[a]=e}),Object.defineProperties(S,M),Object.defineProperty(v,"nullPolyfill",{configurable:!1,enumerable:!1,writable:!1,value:S}),function(a,n){return w(a===null?S:a,n)})}()},{"./set-prototype-of/is-implemented":158,"./set-prototype-of/shim":159}],149:[function(d,ee,te){ee.exports=d("./_iterate")("forEach")},{"./_iterate":143}],150:[function(d,ee,te){var w=d("./is-value"),v={function:!0,object:!0};ee.exports=function(S){return w(S)&&v[typeof S]||!1}},{"./is-value":151}],151:[function(d,ee,te){var w=d("../function/noop")();ee.exports=function(v){return v!==w&&v!==null}},{"../function/noop":137}],152:[function(d,ee,te){ee.exports=d("./is-implemented")()?Object.keys:d("./shim")},{"./is-implemented":153,"./shim":154}],153:[function(d,ee,te){ee.exports=function(){try{return Object.keys("primitive"),!0}catch{return!1}}},{}],154:[function(d,ee,te){var w=d("../is-value"),v=Object.keys;ee.exports=function(S){return v(w(S)?Object(S):S)}},{"../is-value":151}],155:[function(d,ee,te){var w=d("./valid-callable"),v=d("./for-each"),S=Function.prototype.call;ee.exports=function(M,e){var a={},n=arguments[2];return w(e),v(M,function(r,t,c,o){a[t]=S.call(e,n,r,t,c,o)}),a}},{"./for-each":149,"./valid-callable":160}],156:[function(d,ee,te){var w=d("./is-value"),v=Array.prototype.forEach,S=Object.create,M=function(e,a){var n;for(n in e)a[n]=e[n]};ee.exports=function(e){var a=S(null);return v.call(arguments,function(n){!w(n)||M(Object(n),a)}),a}},{"./is-value":151}],157:[function(d,ee,te){ee.exports=d("./is-implemented")()?Object.setPrototypeOf:d("./shim")},{"./is-implemented":158,"./shim":159}],158:[function(d,ee,te){var w=Object.create,v=Object.getPrototypeOf,S={};ee.exports=function(){var M=Object.setPrototypeOf,e=arguments[0]||w;return typeof M!="function"?!1:v(M(e(null),S))===S}},{}],159:[function(d,ee,te){var w=d("../is-object"),v=d("../valid-value"),S=Object.prototype.isPrototypeOf,M=Object.defineProperty,e={configurable:!0,enumerable:!1,writable:!0,value:void 0},a;a=function(n,r){if(v(n),r===null||w(r))return n;throw new TypeError("Prototype must be null or an object")},ee.exports=function(n){var r,t;return n?(n.level===2?n.set?(t=n.set,r=function(c,o){return t.call(a(c,o),o),c}):r=function(c,o){return a(c,o).__proto__=o,c}:r=function c(o,i){var y;return a(o,i),y=S.call(c.nullPolyfill,o),y&&delete c.nullPolyfill.__proto__,i===null&&(i=c.nullPolyfill),o.__proto__=i,y&&M(c.nullPolyfill,"__proto__",e),o},Object.defineProperty(r,"level",{configurable:!1,enumerable:!1,writable:!1,value:n.level})):null}(function(){var n=Object.create(null),r={},t,c=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__");if(c){try{t=c.set,t.call(n,r)}catch{}if(Object.getPrototypeOf(n)===r)return{set:t,level:2}}return n.__proto__=r,Object.getPrototypeOf(n)===r?{level:2}:(n={},n.__proto__=r,Object.getPrototypeOf(n)===r?{level:1}:!1)}()),d("../create")},{"../create":148,"../is-object":150,"../valid-value":162}],160:[function(d,ee,te){ee.exports=function(w){if(typeof w!="function")throw new TypeError(w+" is not a function");return w}},{}],161:[function(d,ee,te){var w=d("./is-object");ee.exports=function(v){if(!w(v))throw new TypeError(v+" is not an Object");return v}},{"./is-object":150}],162:[function(d,ee,te){var w=d("./is-value");ee.exports=function(v){if(!w(v))throw new TypeError("Cannot use null or undefined");return v}},{"./is-value":151}],163:[function(d,ee,te){ee.exports=d("./is-implemented")()?String.prototype.contains:d("./shim")},{"./is-implemented":164,"./shim":165}],164:[function(d,ee,te){var w="razdwatrzy";ee.exports=function(){return typeof w.contains!="function"?!1:w.contains("dwa")===!0&&w.contains("foo")===!1}},{}],165:[function(d,ee,te){var w=String.prototype.indexOf;ee.exports=function(v){return w.call(this,v,arguments[1])>-1}},{}],166:[function(d,ee,te){var w=Object.prototype.toString,v=w.call("");ee.exports=function(S){return typeof S=="string"||S&&typeof S=="object"&&(S instanceof String||w.call(S)===v)||!1}},{}],167:[function(d,ee,te){var w=Object.create(null),v=Math.random;ee.exports=function(){var S;do S=v().toString(36).slice(2);while(w[S]);return S}},{}],168:[function(d,ee,te){var w=d("es5-ext/object/set-prototype-of"),v=d("es5-ext/string/#/contains"),S=d("d"),M=d("es6-symbol"),e=d("./"),a=Object.defineProperty,n;n=ee.exports=function(r,t){if(!(this instanceof n))throw new TypeError("Constructor requires 'new'");e.call(this,r),t?v.call(t,"key+value")?t="key+value":v.call(t,"key")?t="key":t="value":t="value",a(this,"__kind__",S("",t))},w&&w(n,e),delete n.prototype.constructor,n.prototype=Object.create(e.prototype,{_resolve:S(function(r){return this.__kind__==="value"?this.__list__[r]:this.__kind__==="key+value"?[r,this.__list__[r]]:r})}),a(n.prototype,M.toStringTag,S("c","Array Iterator"))},{"./":171,d:106,"es5-ext/object/set-prototype-of":157,"es5-ext/string/#/contains":163,"es6-symbol":175}],169:[function(d,ee,te){var w=d("es5-ext/function/is-arguments"),v=d("es5-ext/object/valid-callable"),S=d("es5-ext/string/is-string"),M=d("./get"),e=Array.isArray,a=Function.prototype.call,n=Array.prototype.some;ee.exports=function(r,t){var c,o=arguments[2],i,y,p,g,h,m,u;if(e(r)||w(r)?c="array":S(r)?c="string":r=M(r),v(t),y=function(){p=!0},c==="array"){n.call(r,function(_){return a.call(t,o,_,y),p});return}if(c==="string"){for(h=r.length,g=0;g<h&&(m=r[g],g+1<h&&(u=m.charCodeAt(0),u>=55296&&u<=56319&&(m+=r[++g])),a.call(t,o,m,y),!p);++g);return}for(i=r.next();!i.done;){if(a.call(t,o,i.value,y),p)return;i=r.next()}}},{"./get":170,"es5-ext/function/is-arguments":135,"es5-ext/object/valid-callable":160,"es5-ext/string/is-string":166}],170:[function(d,ee,te){var w=d("es5-ext/function/is-arguments"),v=d("es5-ext/string/is-string"),S=d("./array"),M=d("./string"),e=d("./valid-iterable"),a=d("es6-symbol").iterator;ee.exports=function(n){return typeof e(n)[a]=="function"?n[a]():w(n)?new S(n):v(n)?new M(n):new S(n)}},{"./array":168,"./string":173,"./valid-iterable":174,"es5-ext/function/is-arguments":135,"es5-ext/string/is-string":166,"es6-symbol":175}],171:[function(d,ee,te){var w=d("es5-ext/array/#/clear"),v=d("es5-ext/object/assign"),S=d("es5-ext/object/valid-callable"),M=d("es5-ext/object/valid-value"),e=d("d"),a=d("d/auto-bind"),n=d("es6-symbol"),r=Object.defineProperty,t=Object.defineProperties,c;ee.exports=c=function(o,i){if(!(this instanceof c))throw new TypeError("Constructor requires 'new'");t(this,{__list__:e("w",M(o)),__context__:e("w",i),__nextIndex__:e("w",0)}),i&&(S(i.on),i.on("_add",this._onAdd),i.on("_delete",this._onDelete),i.on("_clear",this._onClear))},delete c.prototype.constructor,t(c.prototype,v({_next:e(function(){var o;if(!!this.__list__){if(this.__redo__&&(o=this.__redo__.shift(),o!==void 0))return o;if(this.__nextIndex__<this.__list__.length)return this.__nextIndex__++;this._unBind()}}),next:e(function(){return this._createResult(this._next())}),_createResult:e(function(o){return o===void 0?{done:!0,value:void 0}:{done:!1,value:this._resolve(o)}}),_resolve:e(function(o){return this.__list__[o]}),_unBind:e(function(){this.__list__=null,delete this.__redo__,this.__context__&&(this.__context__.off("_add",this._onAdd),this.__context__.off("_delete",this._onDelete),this.__context__.off("_clear",this._onClear),this.__context__=null)}),toString:e(function(){return"[object "+(this[n.toStringTag]||"Object")+"]"})},a({_onAdd:e(function(o){if(!(o>=this.__nextIndex__)){if(++this.__nextIndex__,!this.__redo__){r(this,"__redo__",e("c",[o]));return}this.__redo__.forEach(function(i,y){i>=o&&(this.__redo__[y]=++i)},this),this.__redo__.push(o)}}),_onDelete:e(function(o){var i;o>=this.__nextIndex__||(--this.__nextIndex__,this.__redo__&&(i=this.__redo__.indexOf(o),i!==-1&&this.__redo__.splice(i,1),this.__redo__.forEach(function(y,p){y>o&&(this.__redo__[p]=--y)},this)))}),_onClear:e(function(){this.__redo__&&w.call(this.__redo__),this.__nextIndex__=0})}))),r(c.prototype,n.iterator,e(function(){return this}))},{d:106,"d/auto-bind":105,"es5-ext/array/#/clear":131,"es5-ext/object/assign":144,"es5-ext/object/valid-callable":160,"es5-ext/object/valid-value":162,"es6-symbol":175}],172:[function(d,ee,te){var w=d("es5-ext/function/is-arguments"),v=d("es5-ext/object/is-value"),S=d("es5-ext/string/is-string"),M=d("es6-symbol").iterator,e=Array.isArray;ee.exports=function(a){return v(a)?e(a)||S(a)||w(a)?!0:typeof a[M]=="function":!1}},{"es5-ext/function/is-arguments":135,"es5-ext/object/is-value":151,"es5-ext/string/is-string":166,"es6-symbol":175}],173:[function(d,ee,te){var w=d("es5-ext/object/set-prototype-of"),v=d("d"),S=d("es6-symbol"),M=d("./"),e=Object.defineProperty,a;a=ee.exports=function(n){if(!(this instanceof a))throw new TypeError("Constructor requires 'new'");n=String(n),M.call(this,n),e(this,"__length__",v("",n.length))},w&&w(a,M),delete a.prototype.constructor,a.prototype=Object.create(M.prototype,{_next:v(function(){if(!!this.__list__){if(this.__nextIndex__<this.__length__)return this.__nextIndex__++;this._unBind()}}),_resolve:v(function(n){var r=this.__list__[n],t;return this.__nextIndex__===this.__length__?r:(t=r.charCodeAt(0),t>=55296&&t<=56319?r+this.__list__[this.__nextIndex__++]:r)})}),e(a.prototype,S.toStringTag,v("c","String Iterator"))},{"./":171,d:106,"es5-ext/object/set-prototype-of":157,"es6-symbol":175}],174:[function(d,ee,te){var w=d("./is-iterable");ee.exports=function(v){if(!w(v))throw new TypeError(v+" is not iterable");return v}},{"./is-iterable":172}],175:[function(d,ee,te){ee.exports=d("./is-implemented")()?d("ext/global-this").Symbol:d("./polyfill")},{"./is-implemented":176,"./polyfill":181,"ext/global-this":188}],176:[function(d,ee,te){var w=d("ext/global-this"),v={object:!0,symbol:!0};ee.exports=function(){var S=w.Symbol,M;if(typeof S!="function")return!1;M=S("test symbol");try{String(M)}catch{return!1}return!(!v[typeof S.iterator]||!v[typeof S.toPrimitive]||!v[typeof S.toStringTag])}},{"ext/global-this":188}],177:[function(d,ee,te){ee.exports=function(w){return w?typeof w=="symbol"?!0:!w.constructor||w.constructor.name!=="Symbol"?!1:w[w.constructor.toStringTag]==="Symbol":!1}},{}],178:[function(d,ee,te){var w=d("d"),v=Object.create,S=Object.defineProperty,M=Object.prototype,e=v(null);ee.exports=function(a){for(var n=0,r,t;e[a+(n||"")];)++n;return a+=n||"",e[a]=!0,r="@@"+a,S(M,r,w.gs(null,function(c){t||(t=!0,S(this,r,w(c)),t=!1)})),r}},{d:106}],179:[function(d,ee,te){var w=d("d"),v=d("ext/global-this").Symbol;ee.exports=function(S){return Object.defineProperties(S,{hasInstance:w("",v&&v.hasInstance||S("hasInstance")),isConcatSpreadable:w("",v&&v.isConcatSpreadable||S("isConcatSpreadable")),iterator:w("",v&&v.iterator||S("iterator")),match:w("",v&&v.match||S("match")),replace:w("",v&&v.replace||S("replace")),search:w("",v&&v.search||S("search")),species:w("",v&&v.species||S("species")),split:w("",v&&v.split||S("split")),toPrimitive:w("",v&&v.toPrimitive||S("toPrimitive")),toStringTag:w("",v&&v.toStringTag||S("toStringTag")),unscopables:w("",v&&v.unscopables||S("unscopables"))})}},{d:106,"ext/global-this":188}],180:[function(d,ee,te){var w=d("d"),v=d("../../../validate-symbol"),S=Object.create(null);ee.exports=function(M){return Object.defineProperties(M,{for:w(function(e){return S[e]?S[e]:S[e]=M(String(e))}),keyFor:w(function(e){var a;v(e);for(a in S)if(S[a]===e)return a})})}},{"../../../validate-symbol":182,d:106}],181:[function(d,ee,te){var w=d("d"),v=d("./validate-symbol"),S=d("ext/global-this").Symbol,M=d("./lib/private/generate-name"),e=d("./lib/private/setup/standard-symbols"),a=d("./lib/private/setup/symbol-registry"),n=Object.create,r=Object.defineProperties,t=Object.defineProperty,c,o,i;if(typeof S=="function")try{String(S()),i=!0}catch{}else S=null;o=function(p){if(this instanceof o)throw new TypeError("Symbol is not a constructor");return c(p)},ee.exports=c=function y(p){var g;if(this instanceof y)throw new TypeError("Symbol is not a constructor");return i?S(p):(g=n(o.prototype),p=p===void 0?"":String(p),r(g,{__description__:w("",p),__name__:w("",M(p))}))},e(c),a(c),r(o.prototype,{constructor:w(c),toString:w("",function(){return this.__name__})}),r(c.prototype,{toString:w(function(){return"Symbol ("+v(this).__description__+")"}),valueOf:w(function(){return v(this)})}),t(c.prototype,c.toPrimitive,w("",function(){var y=v(this);return typeof y=="symbol"?y:y.toString()})),t(c.prototype,c.toStringTag,w("c","Symbol")),t(o.prototype,c.toStringTag,w("c",c.prototype[c.toStringTag])),t(o.prototype,c.toPrimitive,w("c",c.prototype[c.toPrimitive]))},{"./lib/private/generate-name":178,"./lib/private/setup/standard-symbols":179,"./lib/private/setup/symbol-registry":180,"./validate-symbol":182,d:106,"ext/global-this":188}],182:[function(d,ee,te){var w=d("./is-symbol");ee.exports=function(v){if(!w(v))throw new TypeError(v+" is not a symbol");return v}},{"./is-symbol":177}],183:[function(d,ee,te){ee.exports=d("./is-implemented")()?WeakMap:d("./polyfill")},{"./is-implemented":184,"./polyfill":186}],184:[function(d,ee,te){ee.exports=function(){var w,v;if(typeof WeakMap!="function")return!1;try{w=new WeakMap([[v={},"one"],[{},"two"],[{},"three"]])}catch{return!1}return!(String(w)!=="[object WeakMap]"||typeof w.set!="function"||w.set({},1)!==w||typeof w.delete!="function"||typeof w.has!="function"||w.get(v)!=="one")}},{}],185:[function(d,ee,te){ee.exports=function(){return typeof WeakMap!="function"?!1:Object.prototype.toString.call(new WeakMap)==="[object WeakMap]"}()},{}],186:[function(d,ee,te){var w=d("es5-ext/object/is-value"),v=d("es5-ext/object/set-prototype-of"),S=d("es5-ext/object/valid-object"),M=d("es5-ext/object/valid-value"),e=d("es5-ext/string/random-uniq"),a=d("d"),n=d("es6-iterator/get"),r=d("es6-iterator/for-of"),t=d("es6-symbol").toStringTag,c=d("./is-native-implemented"),o=Array.isArray,i=Object.defineProperty,y=Object.prototype.hasOwnProperty,p=Object.getPrototypeOf,g;ee.exports=g=function(){var h=arguments[0],m;if(!(this instanceof g))throw new TypeError("Constructor requires 'new'");return m=c&&v&&WeakMap!==g?v(new WeakMap,p(this)):this,w(h)&&(o(h)||(h=n(h))),i(m,"__weakMapData__",a("c","$weakMap$"+e())),h&&r(h,function(u){M(u),m.set(u[0],u[1])}),m},c&&(v&&v(g,WeakMap),g.prototype=Object.create(WeakMap.prototype,{constructor:a(g)})),Object.defineProperties(g.prototype,{delete:a(function(h){return y.call(S(h),this.__weakMapData__)?(delete h[this.__weakMapData__],!0):!1}),get:a(function(h){if(!!y.call(S(h),this.__weakMapData__))return h[this.__weakMapData__]}),has:a(function(h){return y.call(S(h),this.__weakMapData__)}),set:a(function(h,m){return i(S(h),this.__weakMapData__,a("c",m)),this}),toString:a(function(){return"[object WeakMap]"})}),i(g.prototype,t,a("c","WeakMap"))},{"./is-native-implemented":185,d:106,"es5-ext/object/is-value":151,"es5-ext/object/set-prototype-of":157,"es5-ext/object/valid-object":161,"es5-ext/object/valid-value":162,"es5-ext/string/random-uniq":167,"es6-iterator/for-of":169,"es6-iterator/get":170,"es6-symbol":175}],187:[function(d,ee,te){var w=function(){if(typeof self=="object"&&self)return self;if(typeof window=="object"&&window)return window;throw new Error("Unable to resolve global `this`")};ee.exports=function(){if(this)return this;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch{return w()}try{return __global__||w()}finally{delete Object.prototype.__global__}}()},{}],188:[function(d,ee,te){ee.exports=d("./is-implemented")()?globalThis:d("./implementation")},{"./implementation":187,"./is-implemented":189}],189:[function(d,ee,te){ee.exports=function(){return typeof globalThis!="object"||!globalThis?!1:globalThis.Array===Array}},{}],190:[function(d,ee,te){var w=d("is-string-blank");ee.exports=function(v){var S=typeof v;if(S==="string"){var M=v;if(v=+v,v===0&&w(M))return!1}else if(S!=="number")return!1;return v-v<1}},{"is-string-blank":237}],191:[function(d,ee,te){var w=d("dtype");ee.exports=v;function v(S,M,e){if(!S)throw new TypeError("must specify data as first parameter");if(e=+(e||0)|0,Array.isArray(S)&&S[0]&&typeof S[0][0]=="number"){var a=S[0].length,n=S.length*a,r,t,c,o;(!M||typeof M=="string")&&(M=new(w(M||"float32"))(n+e));var i=M.length-e;if(n!==i)throw new Error("source length "+n+" ("+a+"x"+S.length+") does not match destination length "+i);for(r=0,c=e;r<S.length;r++)for(t=0;t<a;t++)M[c++]=S[r][t]===null?NaN:S[r][t]}else if(!M||typeof M=="string"){var y=w(M||"float32");if(Array.isArray(S)||M==="array")for(M=new y(S.length+e),r=0,c=e,o=M.length;c<o;c++,r++)M[c]=S[r]===null?NaN:S[r];else e===0?M=new y(S):(M=new y(S.length+e),M.set(S,e))}else M.set(S,e);return M}},{dtype:127}],192:[function(d,ee,te){var w=d("css-font/stringify"),v=[32,126];ee.exports=S;function S(M){M=M||{};var e=M.shape?M.shape:M.canvas?[M.canvas.width,M.canvas.height]:[512,512],a=M.canvas||document.createElement("canvas"),n=M.font,r=typeof M.step=="number"?[M.step,M.step]:M.step||[32,32],t=M.chars||v;if(n&&typeof n!="string"&&(n=w(n)),!Array.isArray(t))t=String(t).split("");else if(t.length===2&&typeof t[0]=="number"&&typeof t[1]=="number"){for(var c=[],o=t[0],i=0;o<=t[1];o++)c[i++]=String.fromCharCode(o);t=c}e=e.slice(),a.width=e[0],a.height=e[1];var y=a.getContext("2d");y.fillStyle="#000",y.fillRect(0,0,a.width,a.height),y.font=n,y.textAlign="center",y.textBaseline="middle",y.fillStyle="#fff";for(var p=r[0]/2,g=r[1]/2,o=0;o<t.length;o++)y.fillText(t[o],p,g),(p+=r[0])>e[0]-r[0]/2&&(p=r[0]/2,g+=r[1]);return a}},{"css-font/stringify":102}],193:[function(d,ee,te){ee.exports=w,w.canvas=document.createElement("canvas"),w.cache={};function w(o,a){a||(a={}),(typeof o=="string"||Array.isArray(o))&&(a.family=o);var n=Array.isArray(a.family)?a.family.join(", "):a.family;if(!n)throw Error("`family` must be defined");var r=a.size||a.fontSize||a.em||48,t=a.weight||a.fontWeight||"",c=a.style||a.fontStyle||"",o=[c,t,r].join(" ")+"px "+n,i=a.origin||"top";if(w.cache[n]&&r<=w.cache[n].em)return v(w.cache[n],i);var y=a.canvas||w.canvas,p=y.getContext("2d"),g={upper:a.upper!==void 0?a.upper:"H",lower:a.lower!==void 0?a.lower:"x",descent:a.descent!==void 0?a.descent:"p",ascent:a.ascent!==void 0?a.ascent:"h",tittle:a.tittle!==void 0?a.tittle:"i",overshoot:a.overshoot!==void 0?a.overshoot:"O"},h=Math.ceil(r*1.5);y.height=h,y.width=h*.5,p.font=o;var m="H",u={top:0};p.clearRect(0,0,h,h),p.textBaseline="top",p.fillStyle="black",p.fillText(m,0,0);var _=S(p.getImageData(0,0,h,h));p.clearRect(0,0,h,h),p.textBaseline="bottom",p.fillText(m,0,h);var s=S(p.getImageData(0,0,h,h));u.lineHeight=u.bottom=h-s+_,p.clearRect(0,0,h,h),p.textBaseline="alphabetic",p.fillText(m,0,h);var A=S(p.getImageData(0,0,h,h)),b=h-A-1+_;u.baseline=u.alphabetic=b,p.clearRect(0,0,h,h),p.textBaseline="middle",p.fillText(m,0,h*.5);var f=S(p.getImageData(0,0,h,h));u.median=u.middle=h-f-1+_-h*.5,p.clearRect(0,0,h,h),p.textBaseline="hanging",p.fillText(m,0,h*.5);var x=S(p.getImageData(0,0,h,h));u.hanging=h-x-1+_-h*.5,p.clearRect(0,0,h,h),p.textBaseline="ideographic",p.fillText(m,0,h);var l=S(p.getImageData(0,0,h,h));if(u.ideographic=h-l-1+_,g.upper&&(p.clearRect(0,0,h,h),p.textBaseline="top",p.fillText(g.upper,0,0),u.upper=S(p.getImageData(0,0,h,h)),u.capHeight=u.baseline-u.upper),g.lower&&(p.clearRect(0,0,h,h),p.textBaseline="top",p.fillText(g.lower,0,0),u.lower=S(p.getImageData(0,0,h,h)),u.xHeight=u.baseline-u.lower),g.tittle&&(p.clearRect(0,0,h,h),p.textBaseline="top",p.fillText(g.tittle,0,0),u.tittle=S(p.getImageData(0,0,h,h))),g.ascent&&(p.clearRect(0,0,h,h),p.textBaseline="top",p.fillText(g.ascent,0,0),u.ascent=S(p.getImageData(0,0,h,h))),g.descent&&(p.clearRect(0,0,h,h),p.textBaseline="top",p.fillText(g.descent,0,0),u.descent=M(p.getImageData(0,0,h,h))),g.overshoot){p.clearRect(0,0,h,h),p.textBaseline="top",p.fillText(g.overshoot,0,0);var L=M(p.getImageData(0,0,h,h));u.overshoot=L-b}for(var T in u)u[T]/=r;return u.em=r,w.cache[n]=u,v(u,i)}function v(e,a){var n={};typeof a=="string"&&(a=e[a]);for(var r in e)r!=="em"&&(n[r]=e[r]-a);return n}function S(e){for(var a=e.height,n=e.data,r=3;r<n.length;r+=4)if(n[r]!==0)return Math.floor((r-3)*.25/a)}function M(e){for(var a=e.height,n=e.data,r=n.length-1;r>0;r-=4)if(n[r]!==0)return Math.floor((r-3)*.25/a)}},{}],194:[function(d,ee,te){ee.exports=w;function w(v,S){if(typeof v!="string")throw new TypeError("must specify type string");if(S=S||{},typeof document>"u"&&!S.canvas)return null;var M=S.canvas||document.createElement("canvas");typeof S.width=="number"&&(M.width=S.width),typeof S.height=="number"&&(M.height=S.height);var e=S,a;try{var n=[v];v.indexOf("webgl")===0&&n.push("experimental-"+v);for(var r=0;r<n.length;r++)if(a=M.getContext(n[r],e),a)return a}catch{a=null}return a||null}},{}],195:[function(d,ee,te){ee.exports=w;function w(v,S){var M=S[0],e=S[1],a=S[2],n=S[3],r=S[4],t=S[5],c=S[6],o=S[7],i=S[8],y=S[9],p=S[10],g=S[11],h=S[12],m=S[13],u=S[14],_=S[15];return v[0]=t*(p*_-g*u)-y*(c*_-o*u)+m*(c*g-o*p),v[1]=-(e*(p*_-g*u)-y*(a*_-n*u)+m*(a*g-n*p)),v[2]=e*(c*_-o*u)-t*(a*_-n*u)+m*(a*o-n*c),v[3]=-(e*(c*g-o*p)-t*(a*g-n*p)+y*(a*o-n*c)),v[4]=-(r*(p*_-g*u)-i*(c*_-o*u)+h*(c*g-o*p)),v[5]=M*(p*_-g*u)-i*(a*_-n*u)+h*(a*g-n*p),v[6]=-(M*(c*_-o*u)-r*(a*_-n*u)+h*(a*o-n*c)),v[7]=M*(c*g-o*p)-r*(a*g-n*p)+i*(a*o-n*c),v[8]=r*(y*_-g*m)-i*(t*_-o*m)+h*(t*g-o*y),v[9]=-(M*(y*_-g*m)-i*(e*_-n*m)+h*(e*g-n*y)),v[10]=M*(t*_-o*m)-r*(e*_-n*m)+h*(e*o-n*t),v[11]=-(M*(t*g-o*y)-r*(e*g-n*y)+i*(e*o-n*t)),v[12]=-(r*(y*u-p*m)-i*(t*u-c*m)+h*(t*p-c*y)),v[13]=M*(y*u-p*m)-i*(e*u-a*m)+h*(e*p-a*y),v[14]=-(M*(t*u-c*m)-r*(e*u-a*m)+h*(e*c-a*t)),v[15]=M*(t*p-c*y)-r*(e*p-a*y)+i*(e*c-a*t),v}},{}],196:[function(d,ee,te){ee.exports=w;function w(v){var S=new Float32Array(16);return S[0]=v[0],S[1]=v[1],S[2]=v[2],S[3]=v[3],S[4]=v[4],S[5]=v[5],S[6]=v[6],S[7]=v[7],S[8]=v[8],S[9]=v[9],S[10]=v[10],S[11]=v[11],S[12]=v[12],S[13]=v[13],S[14]=v[14],S[15]=v[15],S}},{}],197:[function(d,ee,te){ee.exports=w;function w(v,S){return v[0]=S[0],v[1]=S[1],v[2]=S[2],v[3]=S[3],v[4]=S[4],v[5]=S[5],v[6]=S[6],v[7]=S[7],v[8]=S[8],v[9]=S[9],v[10]=S[10],v[11]=S[11],v[12]=S[12],v[13]=S[13],v[14]=S[14],v[15]=S[15],v}},{}],198:[function(d,ee,te){ee.exports=w;function w(){var v=new Float32Array(16);return v[0]=1,v[1]=0,v[2]=0,v[3]=0,v[4]=0,v[5]=1,v[6]=0,v[7]=0,v[8]=0,v[9]=0,v[10]=1,v[11]=0,v[12]=0,v[13]=0,v[14]=0,v[15]=1,v}},{}],199:[function(d,ee,te){ee.exports=w;function w(v){var S=v[0],M=v[1],e=v[2],a=v[3],n=v[4],r=v[5],t=v[6],c=v[7],o=v[8],i=v[9],y=v[10],p=v[11],g=v[12],h=v[13],m=v[14],u=v[15],_=S*r-M*n,s=S*t-e*n,A=S*c-a*n,b=M*t-e*r,f=M*c-a*r,x=e*c-a*t,l=o*h-i*g,L=o*m-y*g,T=o*u-p*g,k=i*m-y*h,P=i*u-p*h,z=y*u-p*m;return _*z-s*P+A*k+b*T-f*L+x*l}},{}],200:[function(d,ee,te){ee.exports=w;function w(v,S){var M=S[0],e=S[1],a=S[2],n=S[3],r=M+M,t=e+e,c=a+a,o=M*r,i=e*r,y=e*t,p=a*r,g=a*t,h=a*c,m=n*r,u=n*t,_=n*c;return v[0]=1-y-h,v[1]=i+_,v[2]=p-u,v[3]=0,v[4]=i-_,v[5]=1-o-h,v[6]=g+m,v[7]=0,v[8]=p+u,v[9]=g-m,v[10]=1-o-y,v[11]=0,v[12]=0,v[13]=0,v[14]=0,v[15]=1,v}},{}],201:[function(d,ee,te){ee.exports=w;function w(v,S,M){var e,a,n,r=M[0],t=M[1],c=M[2],o=Math.sqrt(r*r+t*t+c*c);return Math.abs(o)<1e-6?null:(o=1/o,r*=o,t*=o,c*=o,e=Math.sin(S),a=Math.cos(S),n=1-a,v[0]=r*r*n+a,v[1]=t*r*n+c*e,v[2]=c*r*n-t*e,v[3]=0,v[4]=r*t*n-c*e,v[5]=t*t*n+a,v[6]=c*t*n+r*e,v[7]=0,v[8]=r*c*n+t*e,v[9]=t*c*n-r*e,v[10]=c*c*n+a,v[11]=0,v[12]=0,v[13]=0,v[14]=0,v[15]=1,v)}},{}],202:[function(d,ee,te){ee.exports=w;function w(v,S,M){var e=S[0],a=S[1],n=S[2],r=S[3],t=e+e,c=a+a,o=n+n,i=e*t,y=e*c,p=e*o,g=a*c,h=a*o,m=n*o,u=r*t,_=r*c,s=r*o;return v[0]=1-(g+m),v[1]=y+s,v[2]=p-_,v[3]=0,v[4]=y-s,v[5]=1-(i+m),v[6]=h+u,v[7]=0,v[8]=p+_,v[9]=h-u,v[10]=1-(i+g),v[11]=0,v[12]=M[0],v[13]=M[1],v[14]=M[2],v[15]=1,v}},{}],203:[function(d,ee,te){ee.exports=w;function w(v,S){return v[0]=S[0],v[1]=0,v[2]=0,v[3]=0,v[4]=0,v[5]=S[1],v[6]=0,v[7]=0,v[8]=0,v[9]=0,v[10]=S[2],v[11]=0,v[12]=0,v[13]=0,v[14]=0,v[15]=1,v}},{}],204:[function(d,ee,te){ee.exports=w;function w(v,S){return v[0]=1,v[1]=0,v[2]=0,v[3]=0,v[4]=0,v[5]=1,v[6]=0,v[7]=0,v[8]=0,v[9]=0,v[10]=1,v[11]=0,v[12]=S[0],v[13]=S[1],v[14]=S[2],v[15]=1,v}},{}],205:[function(d,ee,te){ee.exports=w;function w(v,S){var M=Math.sin(S),e=Math.cos(S);return v[0]=1,v[1]=0,v[2]=0,v[3]=0,v[4]=0,v[5]=e,v[6]=M,v[7]=0,v[8]=0,v[9]=-M,v[10]=e,v[11]=0,v[12]=0,v[13]=0,v[14]=0,v[15]=1,v}},{}],206:[function(d,ee,te){ee.exports=w;function w(v,S){var M=Math.sin(S),e=Math.cos(S);return v[0]=e,v[1]=0,v[2]=-M,v[3]=0,v[4]=0,v[5]=1,v[6]=0,v[7]=0,v[8]=M,v[9]=0,v[10]=e,v[11]=0,v[12]=0,v[13]=0,v[14]=0,v[15]=1,v}},{}],207:[function(d,ee,te){ee.exports=w;function w(v,S){var M=Math.sin(S),e=Math.cos(S);return v[0]=e,v[1]=M,v[2]=0,v[3]=0,v[4]=-M,v[5]=e,v[6]=0,v[7]=0,v[8]=0,v[9]=0,v[10]=1,v[11]=0,v[12]=0,v[13]=0,v[14]=0,v[15]=1,v}},{}],208:[function(d,ee,te){ee.exports=w;function w(v,S,M,e,a,n,r){var t=1/(M-S),c=1/(a-e),o=1/(n-r);return v[0]=n*2*t,v[1]=0,v[2]=0,v[3]=0,v[4]=0,v[5]=n*2*c,v[6]=0,v[7]=0,v[8]=(M+S)*t,v[9]=(a+e)*c,v[10]=(r+n)*o,v[11]=-1,v[12]=0,v[13]=0,v[14]=r*n*2*o,v[15]=0,v}},{}],209:[function(d,ee,te){ee.exports=w;function w(v){return v[0]=1,v[1]=0,v[2]=0,v[3]=0,v[4]=0,v[5]=1,v[6]=0,v[7]=0,v[8]=0,v[9]=0,v[10]=1,v[11]=0,v[12]=0,v[13]=0,v[14]=0,v[15]=1,v}},{}],210:[function(d,ee,te){ee.exports={create:d("./create"),clone:d("./clone"),copy:d("./copy"),identity:d("./identity"),transpose:d("./transpose"),invert:d("./invert"),adjoint:d("./adjoint"),determinant:d("./determinant"),multiply:d("./multiply"),translate:d("./translate"),scale:d("./scale"),rotate:d("./rotate"),rotateX:d("./rotateX"),rotateY:d("./rotateY"),rotateZ:d("./rotateZ"),fromRotation:d("./fromRotation"),fromRotationTranslation:d("./fromRotationTranslation"),fromScaling:d("./fromScaling"),fromTranslation:d("./fromTranslation"),fromXRotation:d("./fromXRotation"),fromYRotation:d("./fromYRotation"),fromZRotation:d("./fromZRotation"),fromQuat:d("./fromQuat"),frustum:d("./frustum"),perspective:d("./perspective"),perspectiveFromFieldOfView:d("./perspectiveFromFieldOfView"),ortho:d("./ortho"),lookAt:d("./lookAt"),str:d("./str")}},{"./adjoint":195,"./clone":196,"./copy":197,"./create":198,"./determinant":199,"./fromQuat":200,"./fromRotation":201,"./fromRotationTranslation":202,"./fromScaling":203,"./fromTranslation":204,"./fromXRotation":205,"./fromYRotation":206,"./fromZRotation":207,"./frustum":208,"./identity":209,"./invert":211,"./lookAt":212,"./multiply":213,"./ortho":214,"./perspective":215,"./perspectiveFromFieldOfView":216,"./rotate":217,"./rotateX":218,"./rotateY":219,"./rotateZ":220,"./scale":221,"./str":222,"./translate":223,"./transpose":224}],211:[function(d,ee,te){ee.exports=w;function w(v,S){var M=S[0],e=S[1],a=S[2],n=S[3],r=S[4],t=S[5],c=S[6],o=S[7],i=S[8],y=S[9],p=S[10],g=S[11],h=S[12],m=S[13],u=S[14],_=S[15],s=M*t-e*r,A=M*c-a*r,b=M*o-n*r,f=e*c-a*t,x=e*o-n*t,l=a*o-n*c,L=i*m-y*h,T=i*u-p*h,k=i*_-g*h,P=y*u-p*m,z=y*_-g*m,I=p*_-g*u,D=s*I-A*z+b*P+f*k-x*T+l*L;return D?(D=1/D,v[0]=(t*I-c*z+o*P)*D,v[1]=(a*z-e*I-n*P)*D,v[2]=(m*l-u*x+_*f)*D,v[3]=(p*x-y*l-g*f)*D,v[4]=(c*k-r*I-o*T)*D,v[5]=(M*I-a*k+n*T)*D,v[6]=(u*b-h*l-_*A)*D,v[7]=(i*l-p*b+g*A)*D,v[8]=(r*z-t*k+o*L)*D,v[9]=(e*k-M*z-n*L)*D,v[10]=(h*x-m*b+_*s)*D,v[11]=(y*b-i*x-g*s)*D,v[12]=(t*T-r*P-c*L)*D,v[13]=(M*P-e*T+a*L)*D,v[14]=(m*A-h*f-u*s)*D,v[15]=(i*f-y*A+p*s)*D,v):null}},{}],212:[function(d,ee,te){var w=d("./identity");ee.exports=v;function v(S,M,e,a){var n,r,t,c,o,i,y,p,g,h,m=M[0],u=M[1],_=M[2],s=a[0],A=a[1],b=a[2],f=e[0],x=e[1],l=e[2];return Math.abs(m-f)<1e-6&&Math.abs(u-x)<1e-6&&Math.abs(_-l)<1e-6?w(S):(y=m-f,p=u-x,g=_-l,h=1/Math.sqrt(y*y+p*p+g*g),y*=h,p*=h,g*=h,n=A*g-b*p,r=b*y-s*g,t=s*p-A*y,h=Math.sqrt(n*n+r*r+t*t),h?(h=1/h,n*=h,r*=h,t*=h):(n=0,r=0,t=0),c=p*t-g*r,o=g*n-y*t,i=y*r-p*n,h=Math.sqrt(c*c+o*o+i*i),h?(h=1/h,c*=h,o*=h,i*=h):(c=0,o=0,i=0),S[0]=n,S[1]=c,S[2]=y,S[3]=0,S[4]=r,S[5]=o,S[6]=p,S[7]=0,S[8]=t,S[9]=i,S[10]=g,S[11]=0,S[12]=-(n*m+r*u+t*_),S[13]=-(c*m+o*u+i*_),S[14]=-(y*m+p*u+g*_),S[15]=1,S)}},{"./identity":209}],213:[function(d,ee,te){ee.exports=w;function w(v,S,M){var e=S[0],a=S[1],n=S[2],r=S[3],t=S[4],c=S[5],o=S[6],i=S[7],y=S[8],p=S[9],g=S[10],h=S[11],m=S[12],u=S[13],_=S[14],s=S[15],A=M[0],b=M[1],f=M[2],x=M[3];return v[0]=A*e+b*t+f*y+x*m,v[1]=A*a+b*c+f*p+x*u,v[2]=A*n+b*o+f*g+x*_,v[3]=A*r+b*i+f*h+x*s,A=M[4],b=M[5],f=M[6],x=M[7],v[4]=A*e+b*t+f*y+x*m,v[5]=A*a+b*c+f*p+x*u,v[6]=A*n+b*o+f*g+x*_,v[7]=A*r+b*i+f*h+x*s,A=M[8],b=M[9],f=M[10],x=M[11],v[8]=A*e+b*t+f*y+x*m,v[9]=A*a+b*c+f*p+x*u,v[10]=A*n+b*o+f*g+x*_,v[11]=A*r+b*i+f*h+x*s,A=M[12],b=M[13],f=M[14],x=M[15],v[12]=A*e+b*t+f*y+x*m,v[13]=A*a+b*c+f*p+x*u,v[14]=A*n+b*o+f*g+x*_,v[15]=A*r+b*i+f*h+x*s,v}},{}],214:[function(d,ee,te){ee.exports=w;function w(v,S,M,e,a,n,r){var t=1/(S-M),c=1/(e-a),o=1/(n-r);return v[0]=-2*t,v[1]=0,v[2]=0,v[3]=0,v[4]=0,v[5]=-2*c,v[6]=0,v[7]=0,v[8]=0,v[9]=0,v[10]=2*o,v[11]=0,v[12]=(S+M)*t,v[13]=(a+e)*c,v[14]=(r+n)*o,v[15]=1,v}},{}],215:[function(d,ee,te){ee.exports=w;function w(v,S,M,e,a){var n=1/Math.tan(S/2),r=1/(e-a);return v[0]=n/M,v[1]=0,v[2]=0,v[3]=0,v[4]=0,v[5]=n,v[6]=0,v[7]=0,v[8]=0,v[9]=0,v[10]=(a+e)*r,v[11]=-1,v[12]=0,v[13]=0,v[14]=2*a*e*r,v[15]=0,v}},{}],216:[function(d,ee,te){ee.exports=w;function w(v,S,M,e){var a=Math.tan(S.upDegrees*Math.PI/180),n=Math.tan(S.downDegrees*Math.PI/180),r=Math.tan(S.leftDegrees*Math.PI/180),t=Math.tan(S.rightDegrees*Math.PI/180),c=2/(r+t),o=2/(a+n);return v[0]=c,v[1]=0,v[2]=0,v[3]=0,v[4]=0,v[5]=o,v[6]=0,v[7]=0,v[8]=-((r-t)*c*.5),v[9]=(a-n)*o*.5,v[10]=e/(M-e),v[11]=-1,v[12]=0,v[13]=0,v[14]=e*M/(M-e),v[15]=0,v}},{}],217:[function(d,ee,te){ee.exports=w;function w(v,S,M,e){var a=e[0],n=e[1],r=e[2],t=Math.sqrt(a*a+n*n+r*r),c,o,i,y,p,g,h,m,u,_,s,A,b,f,x,l,L,T,k,P,z,I,D,R;return Math.abs(t)<1e-6?null:(t=1/t,a*=t,n*=t,r*=t,c=Math.sin(M),o=Math.cos(M),i=1-o,y=S[0],p=S[1],g=S[2],h=S[3],m=S[4],u=S[5],_=S[6],s=S[7],A=S[8],b=S[9],f=S[10],x=S[11],l=a*a*i+o,L=n*a*i+r*c,T=r*a*i-n*c,k=a*n*i-r*c,P=n*n*i+o,z=r*n*i+a*c,I=a*r*i+n*c,D=n*r*i-a*c,R=r*r*i+o,v[0]=y*l+m*L+A*T,v[1]=p*l+u*L+b*T,v[2]=g*l+_*L+f*T,v[3]=h*l+s*L+x*T,v[4]=y*k+m*P+A*z,v[5]=p*k+u*P+b*z,v[6]=g*k+_*P+f*z,v[7]=h*k+s*P+x*z,v[8]=y*I+m*D+A*R,v[9]=p*I+u*D+b*R,v[10]=g*I+_*D+f*R,v[11]=h*I+s*D+x*R,S!==v&&(v[12]=S[12],v[13]=S[13],v[14]=S[14],v[15]=S[15]),v)}},{}],218:[function(d,ee,te){ee.exports=w;function w(v,S,M){var e=Math.sin(M),a=Math.cos(M),n=S[4],r=S[5],t=S[6],c=S[7],o=S[8],i=S[9],y=S[10],p=S[11];return S!==v&&(v[0]=S[0],v[1]=S[1],v[2]=S[2],v[3]=S[3],v[12]=S[12],v[13]=S[13],v[14]=S[14],v[15]=S[15]),v[4]=n*a+o*e,v[5]=r*a+i*e,v[6]=t*a+y*e,v[7]=c*a+p*e,v[8]=o*a-n*e,v[9]=i*a-r*e,v[10]=y*a-t*e,v[11]=p*a-c*e,v}},{}],219:[function(d,ee,te){ee.exports=w;function w(v,S,M){var e=Math.sin(M),a=Math.cos(M),n=S[0],r=S[1],t=S[2],c=S[3],o=S[8],i=S[9],y=S[10],p=S[11];return S!==v&&(v[4]=S[4],v[5]=S[5],v[6]=S[6],v[7]=S[7],v[12]=S[12],v[13]=S[13],v[14]=S[14],v[15]=S[15]),v[0]=n*a-o*e,v[1]=r*a-i*e,v[2]=t*a-y*e,v[3]=c*a-p*e,v[8]=n*e+o*a,v[9]=r*e+i*a,v[10]=t*e+y*a,v[11]=c*e+p*a,v}},{}],220:[function(d,ee,te){ee.exports=w;function w(v,S,M){var e=Math.sin(M),a=Math.cos(M),n=S[0],r=S[1],t=S[2],c=S[3],o=S[4],i=S[5],y=S[6],p=S[7];return S!==v&&(v[8]=S[8],v[9]=S[9],v[10]=S[10],v[11]=S[11],v[12]=S[12],v[13]=S[13],v[14]=S[14],v[15]=S[15]),v[0]=n*a+o*e,v[1]=r*a+i*e,v[2]=t*a+y*e,v[3]=c*a+p*e,v[4]=o*a-n*e,v[5]=i*a-r*e,v[6]=y*a-t*e,v[7]=p*a-c*e,v}},{}],221:[function(d,ee,te){ee.exports=w;function w(v,S,M){var e=M[0],a=M[1],n=M[2];return v[0]=S[0]*e,v[1]=S[1]*e,v[2]=S[2]*e,v[3]=S[3]*e,v[4]=S[4]*a,v[5]=S[5]*a,v[6]=S[6]*a,v[7]=S[7]*a,v[8]=S[8]*n,v[9]=S[9]*n,v[10]=S[10]*n,v[11]=S[11]*n,v[12]=S[12],v[13]=S[13],v[14]=S[14],v[15]=S[15],v}},{}],222:[function(d,ee,te){ee.exports=w;function w(v){return"mat4("+v[0]+", "+v[1]+", "+v[2]+", "+v[3]+", "+v[4]+", "+v[5]+", "+v[6]+", "+v[7]+", "+v[8]+", "+v[9]+", "+v[10]+", "+v[11]+", "+v[12]+", "+v[13]+", "+v[14]+", "+v[15]+")"}},{}],223:[function(d,ee,te){ee.exports=w;function w(v,S,M){var e=M[0],a=M[1],n=M[2],r,t,c,o,i,y,p,g,h,m,u,_;return S===v?(v[12]=S[0]*e+S[4]*a+S[8]*n+S[12],v[13]=S[1]*e+S[5]*a+S[9]*n+S[13],v[14]=S[2]*e+S[6]*a+S[10]*n+S[14],v[15]=S[3]*e+S[7]*a+S[11]*n+S[15]):(r=S[0],t=S[1],c=S[2],o=S[3],i=S[4],y=S[5],p=S[6],g=S[7],h=S[8],m=S[9],u=S[10],_=S[11],v[0]=r,v[1]=t,v[2]=c,v[3]=o,v[4]=i,v[5]=y,v[6]=p,v[7]=g,v[8]=h,v[9]=m,v[10]=u,v[11]=_,v[12]=r*e+i*a+h*n+S[12],v[13]=t*e+y*a+m*n+S[13],v[14]=c*e+p*a+u*n+S[14],v[15]=o*e+g*a+_*n+S[15]),v}},{}],224:[function(d,ee,te){ee.exports=w;function w(v,S){if(v===S){var M=S[1],e=S[2],a=S[3],n=S[6],r=S[7],t=S[11];v[1]=S[4],v[2]=S[8],v[3]=S[12],v[4]=M,v[6]=S[9],v[7]=S[13],v[8]=e,v[9]=n,v[11]=S[14],v[12]=a,v[13]=r,v[14]=t}else v[0]=S[0],v[1]=S[4],v[2]=S[8],v[3]=S[12],v[4]=S[1],v[5]=S[5],v[6]=S[9],v[7]=S[13],v[8]=S[2],v[9]=S[6],v[10]=S[10],v[11]=S[14],v[12]=S[3],v[13]=S[7],v[14]=S[11],v[15]=S[15];return v}},{}],225:[function(d,ee,te){var w=d("css-font"),v=d("pick-by-alias"),S=d("regl"),M=d("gl-util/context"),e=d("es6-weak-map"),a=d("color-normalize"),n=d("font-atlas"),r=d("typedarray-pool"),t=d("parse-rect"),c=d("is-plain-obj"),o=d("parse-unit"),i=d("to-px"),y=d("detect-kerning"),p=d("object-assign"),g=d("font-measure"),h=d("flatten-vertex-data"),m=d("bit-twiddle"),u=m.nextPow2,_=new e,s=!1;if(document.body){var A=document.body.appendChild(document.createElement("div"));A.style.font="italic small-caps bold condensed 16px/2 cursive",getComputedStyle(A).fontStretch&&(s=!0),document.body.removeChild(A)}var b=function(l){f(l)?(l={regl:l},this.gl=l.regl._gl):this.gl=M(l),this.shader=_.get(this.gl),this.shader?this.regl=this.shader.regl:this.regl=l.regl||S({gl:this.gl}),this.charBuffer=this.regl.buffer({type:"uint8",usage:"stream"}),this.sizeBuffer=this.regl.buffer({type:"float",usage:"stream"}),this.shader||(this.shader=this.createShader(),_.set(this.gl,this.shader)),this.batch=[],this.fontSize=[],this.font=[],this.fontAtlas=[],this.draw=this.shader.draw.bind(this),this.render=function(){this.regl._refresh(),this.draw(this.batch)},this.canvas=this.gl.canvas,this.update(c(l)?l:{})};b.prototype.createShader=function(){var l=this.regl,L=l({blend:{enable:!0,color:[0,0,0,1],func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},stencil:{enable:!1},depth:{enable:!1},count:l.prop("count"),offset:l.prop("offset"),attributes:{charOffset:{offset:4,stride:8,buffer:l.this("sizeBuffer")},width:{offset:0,stride:8,buffer:l.this("sizeBuffer")},char:l.this("charBuffer"),position:l.this("position")},uniforms:{atlasSize:function(k,P){return[P.atlas.width,P.atlas.height]},atlasDim:function(k,P){return[P.atlas.cols,P.atlas.rows]},atlas:function(k,P){return P.atlas.texture},charStep:function(k,P){return P.atlas.step},em:function(k,P){return P.atlas.em},color:l.prop("color"),opacity:l.prop("opacity"),viewport:l.this("viewportArray"),scale:l.this("scale"),align:l.prop("align"),baseline:l.prop("baseline"),translate:l.this("translate"),positionOffset:l.prop("positionOffset")},primitive:"points",viewport:l.this("viewport"),vert:`
			precision highp float;
			attribute float width, charOffset, char;
			attribute vec2 position;
			uniform float fontSize, charStep, em, align, baseline;
			uniform vec4 viewport;
			uniform vec4 color;
			uniform vec2 atlasSize, atlasDim, scale, translate, positionOffset;
			varying vec2 charCoord, charId;
			varying float charWidth;
			varying vec4 fontColor;
			void main () {
				vec2 offset = floor(em * (vec2(align + charOffset, baseline)
					+ vec2(positionOffset.x, -positionOffset.y)))
					/ (viewport.zw * scale.xy);

				vec2 position = (position + translate) * scale;
				position += offset * scale;

				charCoord = position * viewport.zw + viewport.xy;

				gl_Position = vec4(position * 2. - 1., 0, 1);

				gl_PointSize = charStep;

				charId.x = mod(char, atlasDim.x);
				charId.y = floor(char / atlasDim.x);

				charWidth = width * em;

				fontColor = color / 255.;
			}`,frag:`
			precision highp float;
			uniform float fontSize, charStep, opacity;
			uniform vec2 atlasSize;
			uniform vec4 viewport;
			uniform sampler2D atlas;
			varying vec4 fontColor;
			varying vec2 charCoord, charId;
			varying float charWidth;

			float lightness(vec4 color) {
				return color.r * 0.299 + color.g * 0.587 + color.b * 0.114;
			}

			void main () {
				vec2 uv = gl_FragCoord.xy - charCoord + charStep * .5;
				float halfCharStep = floor(charStep * .5 + .5);

				// invert y and shift by 1px (FF expecially needs that)
				uv.y = charStep - uv.y;

				// ignore points outside of character bounding box
				float halfCharWidth = ceil(charWidth * .5);
				if (floor(uv.x) > halfCharStep + halfCharWidth ||
					floor(uv.x) < halfCharStep - halfCharWidth) return;

				uv += charId * charStep;
				uv = uv / atlasSize;

				vec4 color = fontColor;
				vec4 mask = texture2D(atlas, uv);

				float maskY = lightness(mask);
				// float colorY = lightness(color);
				color.a *= maskY;
				color.a *= opacity;

				// color.a += .1;

				// antialiasing, see yiq color space y-channel formula
				// color.rgb += (1. - color.rgb) * (1. - mask.rgb);

				gl_FragColor = color;
			}`}),T={};return{regl:l,draw:L,atlas:T}},b.prototype.update=function(l){var L=this;if(typeof l=="string")l={text:l};else if(!l)return;l=v(l,{position:"position positions coord coords coordinates",font:"font fontFace fontface typeface cssFont css-font family fontFamily",fontSize:"fontSize fontsize size font-size",text:"text texts chars characters value values symbols",align:"align alignment textAlign textbaseline",baseline:"baseline textBaseline textbaseline",direction:"dir direction textDirection",color:"color colour fill fill-color fillColor textColor textcolor",kerning:"kerning kern",range:"range dataBox",viewport:"vp viewport viewBox viewbox viewPort",opacity:"opacity alpha transparency visible visibility opaque",offset:"offset positionOffset padding shift indent indentation"},!0),l.opacity!=null&&(Array.isArray(l.opacity)?this.opacity=l.opacity.map(function(be){return parseFloat(be)}):this.opacity=parseFloat(l.opacity)),l.viewport!=null&&(this.viewport=t(l.viewport),this.viewportArray=[this.viewport.x,this.viewport.y,this.viewport.width,this.viewport.height]),this.viewport==null&&(this.viewport={x:0,y:0,width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight},this.viewportArray=[this.viewport.x,this.viewport.y,this.viewport.width,this.viewport.height]),l.kerning!=null&&(this.kerning=l.kerning),l.offset!=null&&(typeof l.offset=="number"&&(l.offset=[l.offset,0]),this.positionOffset=h(l.offset)),l.direction&&(this.direction=l.direction),l.range&&(this.range=l.range,this.scale=[1/(l.range[2]-l.range[0]),1/(l.range[3]-l.range[1])],this.translate=[-l.range[0],-l.range[1]]),l.scale&&(this.scale=l.scale),l.translate&&(this.translate=l.translate),this.scale||(this.scale=[1/this.viewport.width,1/this.viewport.height]),this.translate||(this.translate=[0,0]),!this.font.length&&!l.font&&(l.font=b.baseFontSize+"px sans-serif");var T=!1,k=!1;if(l.font&&(Array.isArray(l.font)?l.font:[l.font]).forEach(function(be,Pe){if(typeof be=="string")try{be=w.parse(be)}catch{be=w.parse(b.baseFontSize+"px "+be)}else be=w.parse(w.stringify(be));var Ge=w.stringify({size:b.baseFontSize,family:be.family,stretch:s?be.stretch:void 0,variant:be.variant,weight:be.weight,style:be.style}),Qe=o(be.size),Be=Math.round(Qe[0]*i(Qe[1]));if(Be!==L.fontSize[Pe]&&(k=!0,L.fontSize[Pe]=Be),(!L.font[Pe]||Ge!=L.font[Pe].baseString)&&(T=!0,L.font[Pe]=b.fonts[Ge],!L.font[Pe])){var Le=be.family.join(", "),He=[be.style];be.style!=be.variant&&He.push(be.variant),be.variant!=be.weight&&He.push(be.weight),s&&be.weight!=be.stretch&&He.push(be.stretch),L.font[Pe]={baseString:Ge,family:Le,weight:be.weight,stretch:be.stretch,style:be.style,variant:be.variant,width:{},kerning:{},metrics:g(Le,{origin:"top",fontSize:b.baseFontSize,fontStyle:He.join(" ")})},b.fonts[Ge]=L.font[Pe]}}),(T||k)&&this.font.forEach(function(be,Pe){var Ge=w.stringify({size:L.fontSize[Pe],family:be.family,stretch:s?be.stretch:void 0,variant:be.variant,weight:be.weight,style:be.style});if(L.fontAtlas[Pe]=L.shader.atlas[Ge],!L.fontAtlas[Pe]){var Qe=be.metrics;L.shader.atlas[Ge]=L.fontAtlas[Pe]={fontString:Ge,step:Math.ceil(L.fontSize[Pe]*Qe.bottom*.5)*2,em:L.fontSize[Pe],cols:0,rows:0,height:0,width:0,chars:[],ids:{},texture:L.regl.texture()}}l.text==null&&(l.text=L.text)}),typeof l.text=="string"&&l.position&&l.position.length>2){for(var P=Array(l.position.length*.5),z=0;z<P.length;z++)P[z]=l.text;l.text=P}var I;if(l.text!=null||T){if(this.textOffsets=[0],Array.isArray(l.text)){this.count=l.text[0].length,this.counts=[this.count];for(var D=1;D<l.text.length;D++)this.textOffsets[D]=this.textOffsets[D-1]+l.text[D-1].length,this.count+=l.text[D].length,this.counts.push(l.text[D].length);this.text=l.text.join("")}else this.text=l.text,this.count=this.text.length,this.counts=[this.count];I=[],this.font.forEach(function(be,Pe){b.atlasContext.font=be.baseString;for(var Ge=L.fontAtlas[Pe],Qe=0;Qe<L.text.length;Qe++){var Be=L.text.charAt(Qe);if(Ge.ids[Be]==null&&(Ge.ids[Be]=Ge.chars.length,Ge.chars.push(Be),I.push(Be)),be.width[Be]==null&&(be.width[Be]=b.atlasContext.measureText(Be).width/b.baseFontSize,L.kerning)){var Le=[];for(var He in be.width)Le.push(He+Be,Be+He);p(be.kerning,y(be.family,{pairs:Le}))}}})}if(l.position)if(l.position.length>2){for(var R=!l.position[0].length,B=r.mallocFloat(this.count*2),F=0,H=0;F<this.counts.length;F++){var G=this.counts[F];if(R)for(var J=0;J<G;J++)B[H++]=l.position[F*2],B[H++]=l.position[F*2+1];else for(var X=0;X<G;X++)B[H++]=l.position[F][0],B[H++]=l.position[F][1]}this.position.call?this.position({type:"float",data:B}):this.position=this.regl.buffer({type:"float",data:B}),r.freeFloat(B)}else this.position.destroy&&this.position.destroy(),this.position={constant:l.position};if(l.text||T){var Y=r.mallocUint8(this.count),Z=r.mallocFloat(this.count*2);this.textWidth=[];for(var oe=0,re=0;oe<this.counts.length;oe++){for(var se=this.counts[oe],N=this.font[oe]||this.font[0],U=this.fontAtlas[oe]||this.fontAtlas[0],q=0;q<se;q++){var $=this.text.charAt(re),W=this.text.charAt(re-1);if(Y[re]=U.ids[$],Z[re*2]=N.width[$],q){var K=Z[re*2-2],ne=Z[re*2],ae=Z[re*2-1],ie=ae+K*.5+ne*.5;if(this.kerning){var le=N.kerning[W+$];le&&(ie+=le*.001)}Z[re*2+1]=ie}else Z[re*2+1]=Z[re*2]*.5;re++}this.textWidth.push(Z.length?Z[re*2-2]*.5+Z[re*2-1]:0)}l.align||(l.align=this.align),this.charBuffer({data:Y,type:"uint8",usage:"stream"}),this.sizeBuffer({data:Z,type:"float",usage:"stream"}),r.freeUint8(Y),r.freeFloat(Z),I.length&&this.font.forEach(function(be,Pe){var Ge=L.fontAtlas[Pe],Qe=Ge.step,Be=Math.floor(b.maxAtlasSize/Qe),Le=Math.min(Be,Ge.chars.length),He=Math.ceil(Ge.chars.length/Le),vt=u(Le*Qe),Rt=u(He*Qe);Ge.width=vt,Ge.height=Rt,Ge.rows=He,Ge.cols=Le,Ge.em&&Ge.texture({data:n({canvas:b.atlasCanvas,font:Ge.fontString,chars:Ge.chars,shape:[vt,Rt],step:[Qe,Qe]})})})}if(l.align&&(this.align=l.align,this.alignOffset=this.textWidth.map(function(be,Pe){var Ge=Array.isArray(L.align)?L.align.length>1?L.align[Pe]:L.align[0]:L.align;if(typeof Ge=="number")return Ge;switch(Ge){case"right":case"end":return-be;case"center":case"centre":case"middle":return-be*.5}return 0})),this.baseline==null&&l.baseline==null&&(l.baseline=0),l.baseline!=null&&(this.baseline=l.baseline,Array.isArray(this.baseline)||(this.baseline=[this.baseline]),this.baselineOffset=this.baseline.map(function(be,Pe){var Ge=(L.font[Pe]||L.font[0]).metrics,Qe=0;return Qe+=Ge.bottom*.5,typeof be=="number"?Qe+=be-Ge.baseline:Qe+=-Ge[be],Qe*=-1,Qe})),l.color!=null)if(l.color||(l.color="transparent"),typeof l.color=="string"||!isNaN(l.color))this.color=a(l.color,"uint8");else{var ye;if(typeof l.color[0]=="number"&&l.color.length>this.counts.length){var ue=l.color.length;ye=r.mallocUint8(ue);for(var pe=(l.color.subarray||l.color.slice).bind(l.color),ge=0;ge<ue;ge+=4)ye.set(a(pe(ge,ge+4),"uint8"),ge)}else{var Te=l.color.length;ye=r.mallocUint8(Te*4);for(var _e=0;_e<Te;_e++)ye.set(a(l.color[_e]||0,"uint8"),_e*4)}this.color=ye}if(l.position||l.text||l.color||l.baseline||l.align||l.font||l.offset||l.opacity){var ze=this.color.length>4||this.baselineOffset.length>1||this.align&&this.align.length>1||this.fontAtlas.length>1||this.positionOffset.length>2;if(ze){var Oe=Math.max(this.position.length*.5||0,this.color.length*.25||0,this.baselineOffset.length||0,this.alignOffset.length||0,this.font.length||0,this.opacity.length||0,this.positionOffset.length*.5||0);this.batch=Array(Oe);for(var Ye=0;Ye<this.batch.length;Ye++)this.batch[Ye]={count:this.counts.length>1?this.counts[Ye]:this.counts[0],offset:this.textOffsets.length>1?this.textOffsets[Ye]:this.textOffsets[0],color:this.color?this.color.length<=4?this.color:this.color.subarray(Ye*4,Ye*4+4):[0,0,0,255],opacity:Array.isArray(this.opacity)?this.opacity[Ye]:this.opacity,baseline:this.baselineOffset[Ye]!=null?this.baselineOffset[Ye]:this.baselineOffset[0],align:this.align?this.alignOffset[Ye]!=null?this.alignOffset[Ye]:this.alignOffset[0]:0,atlas:this.fontAtlas[Ye]||this.fontAtlas[0],positionOffset:this.positionOffset.length>2?this.positionOffset.subarray(Ye*2,Ye*2+2):this.positionOffset}}else this.count?this.batch=[{count:this.count,offset:0,color:this.color||[0,0,0,255],opacity:Array.isArray(this.opacity)?this.opacity[0]:this.opacity,baseline:this.baselineOffset[0],align:this.alignOffset?this.alignOffset[0]:0,atlas:this.fontAtlas[0],positionOffset:this.positionOffset}]:this.batch=[]}},b.prototype.destroy=function(){},b.prototype.kerning=!0,b.prototype.position={constant:new Float32Array(2)},b.prototype.translate=null,b.prototype.scale=null,b.prototype.font=null,b.prototype.text="",b.prototype.positionOffset=[0,0],b.prototype.opacity=1,b.prototype.color=new Uint8Array([0,0,0,255]),b.prototype.alignOffset=[0,0],b.maxAtlasSize=1024,b.atlasCanvas=document.createElement("canvas"),b.atlasContext=b.atlasCanvas.getContext("2d",{alpha:!1}),b.baseFontSize=64,b.fonts={};function f(x){return typeof x=="function"&&x._gl&&x.prop&&x.texture&&x.buffer}ee.exports=b},{"bit-twiddle":81,"color-normalize":89,"css-font":99,"detect-kerning":125,"es6-weak-map":183,"flatten-vertex-data":191,"font-atlas":192,"font-measure":193,"gl-util/context":226,"is-plain-obj":236,"object-assign":247,"parse-rect":249,"parse-unit":251,"pick-by-alias":253,regl:284,"to-px":315,"typedarray-pool":328}],226:[function(d,ee,te){(function(w){(function(){var v=d("pick-by-alias");ee.exports=function(t){if(t?typeof t=="string"&&(t={container:t}):t={},M(t)?t={container:t}:e(t)?t={container:t}:a(t)?t={gl:t}:t=v(t,{container:"container target element el canvas holder parent parentNode wrapper use ref root node",gl:"gl context webgl glContext",attrs:"attributes attrs contextAttributes",pixelRatio:"pixelRatio pxRatio px ratio pxratio pixelratio",width:"w width",height:"h height"},!0),t.pixelRatio||(t.pixelRatio=w.pixelRatio||1),t.gl)return t.gl;if(t.canvas&&(t.container=t.canvas.parentNode),t.container){if(typeof t.container=="string"){var c=document.querySelector(t.container);if(!c)throw Error("Element "+t.container+" is not found");t.container=c}M(t.container)?(t.canvas=t.container,t.container=t.canvas.parentNode):t.canvas||(t.canvas=n(),t.container.appendChild(t.canvas),S(t))}else if(!t.canvas)if(typeof document<"u")t.container=document.body||document.documentElement,t.canvas=n(),t.container.appendChild(t.canvas),S(t);else throw Error("Not DOM environment. Use headless-gl.");return t.gl||["webgl","experimental-webgl","webgl-experimental"].some(function(o){try{t.gl=t.canvas.getContext(o,t.attrs)}catch{}return t.gl}),t.gl};function S(r){if(r.container)if(r.container==document.body)document.body.style.width||(r.canvas.width=r.width||r.pixelRatio*w.innerWidth),document.body.style.height||(r.canvas.height=r.height||r.pixelRatio*w.innerHeight);else{var t=r.container.getBoundingClientRect();r.canvas.width=r.width||t.right-t.left,r.canvas.height=r.height||t.bottom-t.top}}function M(r){return typeof r.getContext=="function"&&"width"in r&&"height"in r}function e(r){return typeof r.nodeName=="string"&&typeof r.appendChild=="function"&&typeof r.getBoundingClientRect=="function"}function a(r){return typeof r.drawArrays=="function"||typeof r.drawElements=="function"}function n(){var r=document.createElement("canvas");return r.style.position="absolute",r.style.top=0,r.style.left=0,r}}).call(this)}).call(this,typeof To<"u"?To:typeof self<"u"?self:typeof window<"u"?window:{})},{"pick-by-alias":253}],227:[function(d,ee,te){ee.exports=function(w){typeof w=="string"&&(w=[w]);for(var v=[].slice.call(arguments,1),S=[],M=0;M<w.length-1;M++)S.push(w[M],v[M]||"");return S.push(w[M]),S.join("")}},{}],228:[function(d,ee,te){(function(w){(function(){var v=d("is-browser"),S;typeof w.matchMedia=="function"?S=!w.matchMedia("(hover: none)").matches:S=v,ee.exports=S}).call(this)}).call(this,typeof To<"u"?To:typeof self<"u"?self:typeof window<"u"?window:{})},{"is-browser":232}],229:[function(d,ee,te){var w=d("is-browser");function v(){var S=!1;try{var M=Object.defineProperty({},"passive",{get:function(){S=!0}});window.addEventListener("test",null,M),window.removeEventListener("test",null,M)}catch{S=!1}return S}ee.exports=w&&v()},{"is-browser":232}],230:[function(d,ee,te){te.read=function(w,v,S,M,e){var a,n,r=e*8-M-1,t=(1<<r)-1,c=t>>1,o=-7,i=S?e-1:0,y=S?-1:1,p=w[v+i];for(i+=y,a=p&(1<<-o)-1,p>>=-o,o+=r;o>0;a=a*256+w[v+i],i+=y,o-=8);for(n=a&(1<<-o)-1,a>>=-o,o+=M;o>0;n=n*256+w[v+i],i+=y,o-=8);if(a===0)a=1-c;else{if(a===t)return n?NaN:(p?-1:1)*(1/0);n=n+Math.pow(2,M),a=a-c}return(p?-1:1)*n*Math.pow(2,a-M)},te.write=function(w,v,S,M,e,a){var n,r,t,c=a*8-e-1,o=(1<<c)-1,i=o>>1,y=e===23?Math.pow(2,-24)-Math.pow(2,-77):0,p=M?0:a-1,g=M?1:-1,h=v<0||v===0&&1/v<0?1:0;for(v=Math.abs(v),isNaN(v)||v===1/0?(r=isNaN(v)?1:0,n=o):(n=Math.floor(Math.log(v)/Math.LN2),v*(t=Math.pow(2,-n))<1&&(n--,t*=2),n+i>=1?v+=y/t:v+=y*Math.pow(2,1-i),v*t>=2&&(n++,t/=2),n+i>=o?(r=0,n=o):n+i>=1?(r=(v*t-1)*Math.pow(2,e),n=n+i):(r=v*Math.pow(2,i-1)*Math.pow(2,e),n=0));e>=8;w[S+p]=r&255,p+=g,r/=256,e-=8);for(n=n<<e|r,c+=e;c>0;w[S+p]=n&255,p+=g,n/=256,c-=8);w[S+p-g]|=h*128}},{}],231:[function(d,ee,te){typeof Object.create=="function"?ee.exports=function(v,S){S&&(v.super_=S,v.prototype=Object.create(S.prototype,{constructor:{value:v,enumerable:!1,writable:!0,configurable:!0}}))}:ee.exports=function(v,S){if(S){v.super_=S;var M=function(){};M.prototype=S.prototype,v.prototype=new M,v.prototype.constructor=v}}},{}],232:[function(d,ee,te){ee.exports=!0},{}],233:[function(d,ee,te){ee.exports=typeof navigator<"u"&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion))},{}],234:[function(d,ee,te){ee.exports=S,ee.exports.isMobile=S,ee.exports.default=S;var w=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i,v=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino|android|ipad|playbook|silk/i;function S(M){M||(M={});var e=M.ua;if(!e&&typeof navigator<"u"&&(e=navigator.userAgent),e&&e.headers&&typeof e.headers["user-agent"]=="string"&&(e=e.headers["user-agent"]),typeof e!="string")return!1;var a=M.tablet?v.test(e):w.test(e);return!a&&M.tablet&&M.featureDetect&&navigator&&navigator.maxTouchPoints>1&&e.indexOf("Macintosh")!==-1&&e.indexOf("Safari")!==-1&&(a=!0),a}},{}],235:[function(d,ee,te){ee.exports=function(w){var v=typeof w;return w!==null&&(v==="object"||v==="function")}},{}],236:[function(d,ee,te){var w=Object.prototype.toString;ee.exports=function(v){var S;return w.call(v)==="[object Object]"&&(S=Object.getPrototypeOf(v),S===null||S===Object.getPrototypeOf({}))}},{}],237:[function(d,ee,te){ee.exports=function(w){for(var v=w.length,S,M=0;M<v;M++)if(S=w.charCodeAt(M),(S<9||S>13)&&S!==32&&S!==133&&S!==160&&S!==5760&&S!==6158&&(S<8192||S>8205)&&S!==8232&&S!==8233&&S!==8239&&S!==8287&&S!==8288&&S!==12288&&S!==65279)return!1;return!0}},{}],238:[function(d,ee,te){ee.exports=function(v){return typeof v!="string"?!1:(v=v.trim(),!!(/^[mzlhvcsqta]\s*[-+.0-9][^mlhvzcsqta]+/i.test(v)&&/[\dz]$/i.test(v)&&v.length>4))}},{}],239:[function(d,ee,te){(function(w,v){typeof te=="object"&&typeof ee<"u"?ee.exports=v():(w=w||self,w.mapboxgl=v())})(this,function(){var w,v,S;function M(e,a){if(!w)w=a;else if(!v)v=a;else{var n="var sharedChunk = {}; ("+w+")(sharedChunk); ("+v+")(sharedChunk);",r={};w(r),S=a(r),S.workerUrl=window.URL.createObjectURL(new Blob([n],{type:"text/javascript"}))}}return M(["exports"],function(e){function a(E,C){return C={exports:{}},E(C,C.exports),C.exports}var n="1.10.1",r=t;function t(E,C,O,Q){this.cx=3*E,this.bx=3*(O-E)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*C,this.by=3*(Q-C)-this.cy,this.ay=1-this.cy-this.by,this.p1x=E,this.p1y=Q,this.p2x=O,this.p2y=Q}t.prototype.sampleCurveX=function(E){return((this.ax*E+this.bx)*E+this.cx)*E},t.prototype.sampleCurveY=function(E){return((this.ay*E+this.by)*E+this.cy)*E},t.prototype.sampleCurveDerivativeX=function(E){return(3*this.ax*E+2*this.bx)*E+this.cx},t.prototype.solveCurveX=function(E,C){typeof C>"u"&&(C=1e-6);var O,Q,he,me,we;for(he=E,we=0;we<8;we++){if(me=this.sampleCurveX(he)-E,Math.abs(me)<C)return he;var Re=this.sampleCurveDerivativeX(he);if(Math.abs(Re)<1e-6)break;he=he-me/Re}if(O=0,Q=1,he=E,he<O)return O;if(he>Q)return Q;for(;O<Q;){if(me=this.sampleCurveX(he),Math.abs(me-E)<C)return he;E>me?O=he:Q=he,he=(Q-O)*.5+O}return he},t.prototype.solve=function(E,C){return this.sampleCurveY(this.solveCurveX(E,C))};var c=o;function o(E,C){this.x=E,this.y=C}o.prototype={clone:function(){return new o(this.x,this.y)},add:function(E){return this.clone()._add(E)},sub:function(E){return this.clone()._sub(E)},multByPoint:function(E){return this.clone()._multByPoint(E)},divByPoint:function(E){return this.clone()._divByPoint(E)},mult:function(E){return this.clone()._mult(E)},div:function(E){return this.clone()._div(E)},rotate:function(E){return this.clone()._rotate(E)},rotateAround:function(E,C){return this.clone()._rotateAround(E,C)},matMult:function(E){return this.clone()._matMult(E)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(E){return this.x===E.x&&this.y===E.y},dist:function(E){return Math.sqrt(this.distSqr(E))},distSqr:function(E){var C=E.x-this.x,O=E.y-this.y;return C*C+O*O},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(E){return Math.atan2(this.y-E.y,this.x-E.x)},angleWith:function(E){return this.angleWithSep(E.x,E.y)},angleWithSep:function(E,C){return Math.atan2(this.x*C-this.y*E,this.x*E+this.y*C)},_matMult:function(E){var C=E[0]*this.x+E[1]*this.y,O=E[2]*this.x+E[3]*this.y;return this.x=C,this.y=O,this},_add:function(E){return this.x+=E.x,this.y+=E.y,this},_sub:function(E){return this.x-=E.x,this.y-=E.y,this},_mult:function(E){return this.x*=E,this.y*=E,this},_div:function(E){return this.x/=E,this.y/=E,this},_multByPoint:function(E){return this.x*=E.x,this.y*=E.y,this},_divByPoint:function(E){return this.x/=E.x,this.y/=E.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var E=this.y;return this.y=this.x,this.x=-E,this},_rotate:function(E){var C=Math.cos(E),O=Math.sin(E),Q=C*this.x-O*this.y,he=O*this.x+C*this.y;return this.x=Q,this.y=he,this},_rotateAround:function(E,C){var O=Math.cos(E),Q=Math.sin(E),he=C.x+O*(this.x-C.x)-Q*(this.y-C.y),me=C.y+Q*(this.x-C.x)+O*(this.y-C.y);return this.x=he,this.y=me,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},o.convert=function(E){return E instanceof o?E:Array.isArray(E)?new o(E[0],E[1]):E};function i(E,C){if(Array.isArray(E)){if(!Array.isArray(C)||E.length!==C.length)return!1;for(var O=0;O<E.length;O++)if(!i(E[O],C[O]))return!1;return!0}if(typeof E=="object"&&E!==null&&C!==null){if(typeof C!="object")return!1;var Q=Object.keys(E);if(Q.length!==Object.keys(C).length)return!1;for(var he in E)if(!i(E[he],C[he]))return!1;return!0}return E===C}function y(E){if(E<=0)return 0;if(E>=1)return 1;var C=E*E,O=C*E;return 4*(E<.5?O:3*(E-C)+O-.75)}function p(E,C,O,Q){var he=new r(E,C,O,Q);return function(me){return he.solve(me)}}var g=p(.25,.1,.25,1);function h(E,C,O){return Math.min(O,Math.max(C,E))}function m(E,C,O){var Q=O-C,he=((E-C)%Q+Q)%Q+C;return he===C?O:he}function u(E,C,O){if(!E.length)return O(null,[]);var Q=E.length,he=new Array(E.length),me=null;E.forEach(function(we,Re){C(we,function($e,ft){$e&&(me=$e),he[Re]=ft,--Q===0&&O(me,he)})})}function _(E){var C=[];for(var O in E)C.push(E[O]);return C}function s(E,C){var O=[];for(var Q in E)Q in C||O.push(Q);return O}function A(E){for(var C=[],O=arguments.length-1;O-- >0;)C[O]=arguments[O+1];for(var Q=0,he=C;Q<he.length;Q+=1){var me=he[Q];for(var we in me)E[we]=me[we]}return E}function b(E,C){for(var O={},Q=0;Q<C.length;Q++){var he=C[Q];he in E&&(O[he]=E[he])}return O}var f=1;function x(){return f++}function l(){function E(C){return C?(C^Math.random()*16>>C/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,E)}return E()}function L(E){return E?/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(E):!1}function T(E,C){E.forEach(function(O){!C[O]||(C[O]=C[O].bind(C))})}function k(E,C){return E.indexOf(C,E.length-C.length)!==-1}function P(E,C,O){var Q={};for(var he in E)Q[he]=C.call(O||this,E[he],he,E);return Q}function z(E,C,O){var Q={};for(var he in E)C.call(O||this,E[he],he,E)&&(Q[he]=E[he]);return Q}function I(E){return Array.isArray(E)?E.map(I):typeof E=="object"&&E?P(E,I):E}function D(E,C){for(var O=0;O<E.length;O++)if(C.indexOf(E[O])>=0)return!0;return!1}var R={};function B(E){R[E]||(typeof console<"u"&&console.warn(E),R[E]=!0)}function F(E,C,O){return(O.y-E.y)*(C.x-E.x)>(C.y-E.y)*(O.x-E.x)}function H(E){for(var C=0,O=0,Q=E.length,he=Q-1,me=void 0,we=void 0;O<Q;he=O++)me=E[O],we=E[he],C+=(we.x-me.x)*(me.y+we.y);return C}function G(E){var C=E[0],O=E[1],Q=E[2];return O+=90,O*=Math.PI/180,Q*=Math.PI/180,{x:C*Math.cos(O)*Math.sin(Q),y:C*Math.sin(O)*Math.sin(Q),z:C*Math.cos(Q)}}function J(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function X(E){var C=/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,O={};if(E.replace(C,function(he,me,we,Re){var $e=we||Re;return O[me]=$e?$e.toLowerCase():!0,""}),O["max-age"]){var Q=parseInt(O["max-age"],10);isNaN(Q)?delete O["max-age"]:O["max-age"]=Q}return O}var Y=null;function Z(E){if(Y==null){var C=E.navigator?E.navigator.userAgent:null;Y=!!E.safari||!!(C&&(/\b(iPad|iPhone|iPod)\b/.test(C)||!!C.match("Safari")&&!C.match("Chrome")))}return Y}function oe(E){try{var C=self[E];return C.setItem("_mapbox_test_",1),C.removeItem("_mapbox_test_"),!0}catch{return!1}}function re(E){return self.btoa(encodeURIComponent(E).replace(/%([0-9A-F]{2})/g,function(C,O){return String.fromCharCode(Number("0x"+O))}))}function se(E){return decodeURIComponent(self.atob(E).split("").map(function(C){return"%"+("00"+C.charCodeAt(0).toString(16)).slice(-2)}).join(""))}var N=self.performance&&self.performance.now?self.performance.now.bind(self.performance):Date.now.bind(Date),U=self.requestAnimationFrame||self.mozRequestAnimationFrame||self.webkitRequestAnimationFrame||self.msRequestAnimationFrame,q=self.cancelAnimationFrame||self.mozCancelAnimationFrame||self.webkitCancelAnimationFrame||self.msCancelAnimationFrame,$,W,K={now:N,frame:function(C){var O=U(C);return{cancel:function(){return q(O)}}},getImageData:function(C,O){O===void 0&&(O=0);var Q=self.document.createElement("canvas"),he=Q.getContext("2d");if(!he)throw new Error("failed to create canvas 2d context");return Q.width=C.width,Q.height=C.height,he.drawImage(C,0,0,C.width,C.height),he.getImageData(-O,-O,C.width+2*O,C.height+2*O)},resolveURL:function(C){return $||($=self.document.createElement("a")),$.href=C,$.href},hardwareConcurrency:self.navigator.hardwareConcurrency||4,get devicePixelRatio(){return self.devicePixelRatio},get prefersReducedMotion(){return self.matchMedia?(W==null&&(W=self.matchMedia("(prefers-reduced-motion: reduce)")),W.matches):!1}},ne={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},ae={supported:!1,testSupport:pe},ie,le=!1,ye,ue=!1;self.document&&(ye=self.document.createElement("img"),ye.onload=function(){ie&&ge(ie),ie=null,ue=!0},ye.onerror=function(){le=!0,ie=null},ye.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");function pe(E){le||!ye||(ue?ge(E):ie=E)}function ge(E){var C=E.createTexture();E.bindTexture(E.TEXTURE_2D,C);try{if(E.texImage2D(E.TEXTURE_2D,0,E.RGBA,E.RGBA,E.UNSIGNED_BYTE,ye),E.isContextLost())return;ae.supported=!0}catch{}E.deleteTexture(C),le=!0}var Te="01";function _e(){for(var E="1",C="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",O="",Q=0;Q<10;Q++)O+=C[Math.floor(Math.random()*62)];var he=12*60*60*1e3,me=[E,Te,O].join(""),we=Date.now()+he;return{token:me,tokenExpiresAt:we}}var ze=function(C,O){this._transformRequestFn=C,this._customAccessToken=O,this._createSkuToken()};ze.prototype._createSkuToken=function(){var C=_e();this._skuToken=C.token,this._skuTokenExpiresAt=C.tokenExpiresAt},ze.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},ze.prototype.transformRequest=function(C,O){return this._transformRequestFn?this._transformRequestFn(C,O)||{url:C}:{url:C}},ze.prototype.normalizeStyleURL=function(C,O){if(!Oe(C))return C;var Q=Be(C);return Q.path="/styles/v1"+Q.path,this._makeAPIURL(Q,this._customAccessToken||O)},ze.prototype.normalizeGlyphsURL=function(C,O){if(!Oe(C))return C;var Q=Be(C);return Q.path="/fonts/v1"+Q.path,this._makeAPIURL(Q,this._customAccessToken||O)},ze.prototype.normalizeSourceURL=function(C,O){if(!Oe(C))return C;var Q=Be(C);return Q.path="/v4/"+Q.authority+".json",Q.params.push("secure"),this._makeAPIURL(Q,this._customAccessToken||O)},ze.prototype.normalizeSpriteURL=function(C,O,Q,he){var me=Be(C);return Oe(C)?(me.path="/styles/v1"+me.path+"/sprite"+O+Q,this._makeAPIURL(me,this._customAccessToken||he)):(me.path+=""+O+Q,Le(me))},ze.prototype.normalizeTileURL=function(C,O){if(this._isSkuTokenExpired()&&this._createSkuToken(),C&&!Oe(C))return C;var Q=Be(C),he=/(\.(png|jpg)\d*)(?=$)/,me=/^.+\/v4\//,we=K.devicePixelRatio>=2||O===512?"@2x":"",Re=ae.supported?".webp":"$1";Q.path=Q.path.replace(he,""+we+Re),Q.path=Q.path.replace(me,"/"),Q.path="/v4"+Q.path;var $e=this._customAccessToken||Ge(Q.params)||ne.ACCESS_TOKEN;return ne.REQUIRE_ACCESS_TOKEN&&$e&&this._skuToken&&Q.params.push("sku="+this._skuToken),this._makeAPIURL(Q,$e)},ze.prototype.canonicalizeTileURL=function(C,O){var Q="/v4/",he=/\.[\w]+$/,me=Be(C);if(!me.path.match(/(^\/v4\/)/)||!me.path.match(he))return C;var we="mapbox://tiles/";we+=me.path.replace(Q,"");var Re=me.params;return O&&(Re=Re.filter(function($e){return!$e.match(/^access_token=/)})),Re.length&&(we+="?"+Re.join("&")),we},ze.prototype.canonicalizeTileset=function(C,O){for(var Q=O?Oe(O):!1,he=[],me=0,we=C.tiles||[];me<we.length;me+=1){var Re=we[me];be(Re)?he.push(this.canonicalizeTileURL(Re,Q)):he.push(Re)}return he},ze.prototype._makeAPIURL=function(C,O){var Q="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",he=Be(ne.API_URL);if(C.protocol=he.protocol,C.authority=he.authority,he.path!=="/"&&(C.path=""+he.path+C.path),!ne.REQUIRE_ACCESS_TOKEN)return Le(C);if(O=O||ne.ACCESS_TOKEN,!O)throw new Error("An API access token is required to use Mapbox GL. "+Q);if(O[0]==="s")throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+Q);return C.params=C.params.filter(function(me){return me.indexOf("access_token")===-1}),C.params.push("access_token="+O),Le(C)};function Oe(E){return E.indexOf("mapbox:")===0}var Ye=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function be(E){return Ye.test(E)}function Pe(E){return E.indexOf("sku=")>0&&be(E)}function Ge(E){for(var C=0,O=E;C<O.length;C+=1){var Q=O[C],he=Q.match(/^access_token=(.*)$/);if(he)return he[1]}return null}var Qe=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Be(E){var C=E.match(Qe);if(!C)throw new Error("Unable to parse URL object");return{protocol:C[1],authority:C[2],path:C[3]||"/",params:C[4]?C[4].split("&"):[]}}function Le(E){var C=E.params.length?"?"+E.params.join("&"):"";return E.protocol+"://"+E.authority+E.path+C}var He="mapbox.eventData";function vt(E){if(!E)return null;var C=E.split(".");if(!C||C.length!==3)return null;try{var O=JSON.parse(se(C[1]));return O}catch{return null}}var Rt=function(C){this.type=C,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};Rt.prototype.getStorageKey=function(C){var O=vt(ne.ACCESS_TOKEN),Q="";return O&&O.u?Q=re(O.u):Q=ne.ACCESS_TOKEN||"",C?He+"."+C+":"+Q:He+":"+Q},Rt.prototype.fetchEventData=function(){var C=oe("localStorage"),O=this.getStorageKey(),Q=this.getStorageKey("uuid");if(C)try{var he=self.localStorage.getItem(O);he&&(this.eventData=JSON.parse(he));var me=self.localStorage.getItem(Q);me&&(this.anonId=me)}catch{B("Unable to read from LocalStorage")}},Rt.prototype.saveEventData=function(){var C=oe("localStorage"),O=this.getStorageKey(),Q=this.getStorageKey("uuid");if(C)try{self.localStorage.setItem(Q,this.anonId),Object.keys(this.eventData).length>=1&&self.localStorage.setItem(O,JSON.stringify(this.eventData))}catch{B("Unable to write to LocalStorage")}},Rt.prototype.processRequests=function(C){},Rt.prototype.postEvent=function(C,O,Q,he){var me=this;if(!!ne.EVENTS_URL){var we=Be(ne.EVENTS_URL);we.params.push("access_token="+(he||ne.ACCESS_TOKEN||""));var Re={event:this.type,created:new Date(C).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:n,skuId:Te,userId:this.anonId},$e=O?A(Re,O):Re,ft={url:Le(we),headers:{"Content-Type":"text/plain"},body:JSON.stringify([$e])};this.pendingRequest=wt(ft,function(pt){me.pendingRequest=null,Q(pt),me.saveEventData(),me.processRequests(he)})}},Rt.prototype.queueRequest=function(C,O){this.queue.push(C),this.processRequests(O)};var rr=function(E){function C(){E.call(this,"map.load"),this.success={},this.skuToken=""}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.postMapLoadEvent=function(Q,he,me,we){this.skuToken=me,(ne.EVENTS_URL&&we||ne.ACCESS_TOKEN&&Array.isArray(Q)&&Q.some(function(Re){return Oe(Re)||be(Re)}))&&this.queueRequest({id:he,timestamp:Date.now()},we)},C.prototype.processRequests=function(Q){var he=this;if(!(this.pendingRequest||this.queue.length===0)){var me=this.queue.shift(),we=me.id,Re=me.timestamp;we&&this.success[we]||(this.anonId||this.fetchEventData(),L(this.anonId)||(this.anonId=l()),this.postEvent(Re,{skuToken:this.skuToken},function($e){$e||we&&(he.success[we]=!0)},Q))}},C}(Rt),Lt=function(E){function C(O){E.call(this,"appUserTurnstile"),this._customAccessToken=O}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.postTurnstileEvent=function(Q,he){ne.EVENTS_URL&&ne.ACCESS_TOKEN&&Array.isArray(Q)&&Q.some(function(me){return Oe(me)||be(me)})&&this.queueRequest(Date.now(),he)},C.prototype.processRequests=function(Q){var he=this;if(!(this.pendingRequest||this.queue.length===0)){(!this.anonId||!this.eventData.lastSuccess||!this.eventData.tokenU)&&this.fetchEventData();var me=vt(ne.ACCESS_TOKEN),we=me?me.u:ne.ACCESS_TOKEN,Re=we!==this.eventData.tokenU;L(this.anonId)||(this.anonId=l(),Re=!0);var $e=this.queue.shift();if(this.eventData.lastSuccess){var ft=new Date(this.eventData.lastSuccess),pt=new Date($e),It=($e-this.eventData.lastSuccess)/(24*60*60*1e3);Re=Re||It>=1||It<-1||ft.getDate()!==pt.getDate()}else Re=!0;if(!Re)return this.processRequests();this.postEvent($e,{"enabled.telemetry":!1},function(tr){tr||(he.eventData.lastSuccess=$e,he.eventData.tokenU=we)},Q)}},C}(Rt),Ft=new Lt,Gt=Ft.postTurnstileEvent.bind(Ft),Dt=new rr,kt=Dt.postMapLoadEvent.bind(Dt),Ue="mapbox-tiles",qe=500,Ve=50,Ae=1e3*60*7,Ne;function Xe(){self.caches&&!Ne&&(Ne=self.caches.open(Ue))}var Je;function _t(E,C){if(Je===void 0)try{new Response(new ReadableStream),Je=!0}catch{Je=!1}Je?C(E.body):E.blob().then(C)}function mt(E,C,O){if(Xe(),!!Ne){var Q={status:C.status,statusText:C.statusText,headers:new self.Headers};C.headers.forEach(function(we,Re){return Q.headers.set(Re,we)});var he=X(C.headers.get("Cache-Control")||"");if(!he["no-store"]){he["max-age"]&&Q.headers.set("Expires",new Date(O+he["max-age"]*1e3).toUTCString());var me=new Date(Q.headers.get("Expires")).getTime()-O;me<Ae||_t(C,function(we){var Re=new self.Response(we,Q);Xe(),Ne&&Ne.then(function($e){return $e.put(Ot(E.url),Re)}).catch(function($e){return B($e.message)})})}}}function Ot(E){var C=E.indexOf("?");return C<0?E:E.slice(0,C)}function Kt(E,C){if(Xe(),!Ne)return C(null);var O=Ot(E.url);Ne.then(function(Q){Q.match(O).then(function(he){var me=Nt(he);Q.delete(O),me&&Q.put(O,he.clone()),C(null,he,me)}).catch(C)}).catch(C)}function Nt(E){if(!E)return!1;var C=new Date(E.headers.get("Expires")||0),O=X(E.headers.get("Cache-Control")||"");return C>Date.now()&&!O["no-cache"]}var Wt=1/0;function qt(E){Wt++,Wt>Ve&&(E.getActor().send("enforceCacheSizeLimit",qe),Wt=0)}function Yt(E){Xe(),Ne&&Ne.then(function(C){C.keys().then(function(O){for(var Q=0;Q<O.length-E;Q++)C.delete(O[Q])})})}function fr(E){var C=self.caches.delete(Ue);E&&C.catch(E).then(function(){return E()})}function Yr(E,C){qe=E,Ve=C}var hn;function Qr(){return hn==null&&(hn=self.OffscreenCanvas&&new self.OffscreenCanvas(1,1).getContext("2d")&&typeof self.createImageBitmap=="function"),hn}var at={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(at);var Jt=function(E){function C(O,Q,he){Q===401&&be(he)&&(O+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),E.call(this,O),this.status=Q,this.url=he,this.name=this.constructor.name,this.message=O}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},C}(Error),Zt=J()?function(){return self.worker&&self.worker.referrer}:function(){return(self.location.protocol==="blob:"?self.parent:self).location.href},Ut=function(E){return/^file:/.test(E)||/^file:/.test(Zt())&&!/^\w+:/.test(E)};function _r(E,C){var O=new self.AbortController,Q=new self.Request(E.url,{method:E.method||"GET",body:E.body,credentials:E.credentials,headers:E.headers,referrer:Zt(),signal:O.signal}),he=!1,me=!1,we=Pe(Q.url);E.type==="json"&&Q.headers.set("Accept","application/json");var Re=function(ft,pt,It){if(!me){if(ft&&ft.message!=="SecurityError"&&B(ft),pt&&It)return $e(pt);var tr=Date.now();self.fetch(Q).then(function(Qt){if(Qt.ok){var dr=we?Qt.clone():null;return $e(Qt,dr,tr)}else return C(new Jt(Qt.statusText,Qt.status,E.url))}).catch(function(Qt){Qt.code!==20&&C(new Error(Qt.message))})}},$e=function(ft,pt,It){(E.type==="arrayBuffer"?ft.arrayBuffer():E.type==="json"?ft.json():ft.text()).then(function(tr){me||(pt&&It&&mt(Q,pt,It),he=!0,C(null,tr,ft.headers.get("Cache-Control"),ft.headers.get("Expires")))}).catch(function(tr){me||C(new Error(tr.message))})};return we?Kt(Q,Re):Re(null,null),{cancel:function(){me=!0,he||O.abort()}}}function rt(E,C){var O=new self.XMLHttpRequest;O.open(E.method||"GET",E.url,!0),E.type==="arrayBuffer"&&(O.responseType="arraybuffer");for(var Q in E.headers)O.setRequestHeader(Q,E.headers[Q]);return E.type==="json"&&(O.responseType="text",O.setRequestHeader("Accept","application/json")),O.withCredentials=E.credentials==="include",O.onerror=function(){C(new Error(O.statusText))},O.onload=function(){if((O.status>=200&&O.status<300||O.status===0)&&O.response!==null){var he=O.response;if(E.type==="json")try{he=JSON.parse(O.response)}catch(me){return C(me)}C(null,he,O.getResponseHeader("Cache-Control"),O.getResponseHeader("Expires"))}else C(new Jt(O.statusText,O.status,E.url))},O.send(E.body),{cancel:function(){return O.abort()}}}var Ke=function(E,C){if(!Ut(E.url)){if(self.fetch&&self.Request&&self.AbortController&&self.Request.prototype.hasOwnProperty("signal"))return _r(E,C);if(J()&&self.worker&&self.worker.actor){var O=!0;return self.worker.actor.send("getResource",E,C,void 0,O)}}return rt(E,C)},st=function(E,C){return Ke(A(E,{type:"json"}),C)},lt=function(E,C){return Ke(A(E,{type:"arrayBuffer"}),C)},wt=function(E,C){return Ke(A(E,{method:"POST"}),C)};function Pt(E){var C=self.document.createElement("a");return C.href=E,C.protocol===self.document.location.protocol&&C.host===self.document.location.host}var ke="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function Se(E,C,O,Q){var he=new self.Image,me=self.URL;he.onload=function(){C(null,he),me.revokeObjectURL(he.src)},he.onerror=function(){return C(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var we=new self.Blob([new Uint8Array(E)],{type:"image/png"});he.cacheControl=O,he.expires=Q,he.src=E.byteLength?me.createObjectURL(we):ke}function nt(E,C){var O=new self.Blob([new Uint8Array(E)],{type:"image/png"});self.createImageBitmap(O).then(function(Q){C(null,Q)}).catch(function(Q){C(new Error("Could not load image because of "+Q.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))})}var it,ct,At=function(){it=[],ct=0};At();var dt=function(E,C){if(ae.supported&&(E.headers||(E.headers={}),E.headers.accept="image/webp,*/*"),ct>=ne.MAX_PARALLEL_IMAGE_REQUESTS){var O={requestParameters:E,callback:C,cancelled:!1,cancel:function(){this.cancelled=!0}};return it.push(O),O}ct++;var Q=!1,he=function(){if(!Q)for(Q=!0,ct--;it.length&&ct<ne.MAX_PARALLEL_IMAGE_REQUESTS;){var we=it.shift(),Re=we.requestParameters,$e=we.callback,ft=we.cancelled;ft||(we.cancel=dt(Re,$e).cancel)}},me=lt(E,function(we,Re,$e,ft){he(),we?C(we):Re&&(Qr()?nt(Re,C):Se(Re,C,$e,ft))});return{cancel:function(){me.cancel(),he()}}},Tt=function(E,C){var O=self.document.createElement("video");O.muted=!0,O.onloadstart=function(){C(null,O)};for(var Q=0;Q<E.length;Q++){var he=self.document.createElement("source");Pt(E[Q])||(O.crossOrigin="Anonymous"),he.src=E[Q],O.appendChild(he)}return{cancel:function(){}}};function Ht(E,C,O){var Q=O[E]&&O[E].indexOf(C)!==-1;Q||(O[E]=O[E]||[],O[E].push(C))}function ir(E,C,O){if(O&&O[E]){var Q=O[E].indexOf(C);Q!==-1&&O[E].splice(Q,1)}}var kr=function(C,O){O===void 0&&(O={}),A(this,O),this.type=C},br=function(E){function C(O,Q){Q===void 0&&(Q={}),E.call(this,"error",A({error:O},Q))}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C}(kr),Mr=function(){};Mr.prototype.on=function(C,O){return this._listeners=this._listeners||{},Ht(C,O,this._listeners),this},Mr.prototype.off=function(C,O){return ir(C,O,this._listeners),ir(C,O,this._oneTimeListeners),this},Mr.prototype.once=function(C,O){return this._oneTimeListeners=this._oneTimeListeners||{},Ht(C,O,this._oneTimeListeners),this},Mr.prototype.fire=function(C,O){typeof C=="string"&&(C=new kr(C,O||{}));var Q=C.type;if(this.listens(Q)){C.target=this;for(var he=this._listeners&&this._listeners[Q]?this._listeners[Q].slice():[],me=0,we=he;me<we.length;me+=1){var Re=we[me];Re.call(this,C)}for(var $e=this._oneTimeListeners&&this._oneTimeListeners[Q]?this._oneTimeListeners[Q].slice():[],ft=0,pt=$e;ft<pt.length;ft+=1){var It=pt[ft];ir(Q,It,this._oneTimeListeners),It.call(this,C)}var tr=this._eventedParent;tr&&(A(C,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),tr.fire(C))}else C instanceof br&&console.error(C.error);return this},Mr.prototype.listens=function(C){return this._listeners&&this._listeners[C]&&this._listeners[C].length>0||this._oneTimeListeners&&this._oneTimeListeners[C]&&this._oneTimeListeners[C].length>0||this._eventedParent&&this._eventedParent.listens(C)},Mr.prototype.setEventedParent=function(C,O){return this._eventedParent=C,this._eventedParentData=O,this};var Hr=8,nr={version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},mr={"*":{type:"source"}},Pr=["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],Nr={type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},"*":{type:"*"}},Sr={type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},"*":{type:"*"}},tt={type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},"*":{type:"*"}},Et={type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},Vt={type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},ar={type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},Cr={id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},Or=["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],Ir={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},Tr={"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},Wr={"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},wn={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},ln={"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},Bn={"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},Cn={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},Wn={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},Hn={type:"array",value:"*"},ga={type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},La={type:"enum",values:{Point:{},LineString:{},Polygon:{}}},ci={type:"array",minimum:0,maximum:24,value:["number","color"],length:2},Va={type:"array",value:"*",minimum:1},ja={type:"enum",values:{let:{group:"Variable binding"},var:{group:"Variable binding"},literal:{group:"Types"},array:{group:"Types"},at:{group:"Lookup"},in:{group:"Lookup"},"index-of":{group:"Lookup"},slice:{group:"Lookup"},case:{group:"Decision"},match:{group:"Decision"},coalesce:{group:"Decision"},step:{group:"Ramps, scales, curves"},interpolate:{group:"Ramps, scales, curves"},"interpolate-hcl":{group:"Ramps, scales, curves"},"interpolate-lab":{group:"Ramps, scales, curves"},ln2:{group:"Math"},pi:{group:"Math"},e:{group:"Math"},typeof:{group:"Types"},string:{group:"Types"},number:{group:"Types"},boolean:{group:"Types"},object:{group:"Types"},collator:{group:"Types"},format:{group:"Types"},image:{group:"Types"},"number-format":{group:"Types"},"to-string":{group:"Types"},"to-number":{group:"Types"},"to-boolean":{group:"Types"},"to-rgba":{group:"Color"},"to-color":{group:"Types"},rgb:{group:"Color"},rgba:{group:"Color"},get:{group:"Lookup"},has:{group:"Lookup"},length:{group:"Lookup"},properties:{group:"Feature data"},"feature-state":{group:"Feature data"},"geometry-type":{group:"Feature data"},id:{group:"Feature data"},zoom:{group:"Zoom"},"heatmap-density":{group:"Heatmap"},"line-progress":{group:"Feature data"},accumulated:{group:"Feature data"},"+":{group:"Math"},"*":{group:"Math"},"-":{group:"Math"},"/":{group:"Math"},"%":{group:"Math"},"^":{group:"Math"},sqrt:{group:"Math"},log10:{group:"Math"},ln:{group:"Math"},log2:{group:"Math"},sin:{group:"Math"},cos:{group:"Math"},tan:{group:"Math"},asin:{group:"Math"},acos:{group:"Math"},atan:{group:"Math"},min:{group:"Math"},max:{group:"Math"},round:{group:"Math"},abs:{group:"Math"},ceil:{group:"Math"},floor:{group:"Math"},distance:{group:"Math"},"==":{group:"Decision"},"!=":{group:"Decision"},">":{group:"Decision"},"<":{group:"Decision"},">=":{group:"Decision"},"<=":{group:"Decision"},all:{group:"Decision"},any:{group:"Decision"},"!":{group:"Decision"},within:{group:"Decision"},"is-supported-script":{group:"String"},upcase:{group:"String"},downcase:{group:"String"},concat:{group:"String"},"resolved-locale":{group:"String"}}},Wa={anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},wr=["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],pn={"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},fn={"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},An={"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},Zn={"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},ua={"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},ea={"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},Rn={"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},Xn={"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},Ua={duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},li={"*":{type:"string"}},Bt={$version:Hr,$root:nr,sources:mr,source:Pr,source_vector:Nr,source_raster:Sr,source_raster_dem:tt,source_geojson:Et,source_video:Vt,source_image:ar,layer:Cr,layout:Or,layout_background:Ir,layout_fill:Tr,layout_circle:Wr,layout_heatmap:wn,"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:ln,layout_symbol:Bn,layout_raster:Cn,layout_hillshade:Wn,filter:Hn,filter_operator:ga,geometry_type:La,function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:ci,expression:Va,expression_name:ja,light:Wa,paint:wr,paint_fill:pn,"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:fn,paint_circle:An,paint_heatmap:Zn,paint_symbol:ua,paint_raster:ea,paint_hillshade:Rn,paint_background:Xn,transition:Ua,"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:li},hr=function(C,O,Q,he){this.message=(C?C+": ":"")+Q,he&&(this.identifier=he),O!=null&&O.__line__&&(this.line=O.__line__)};function rn(E){var C=E.key,O=E.value;return O?[new hr(C,O,"constants have been deprecated as of v8")]:[]}function vn(E){for(var C=[],O=arguments.length-1;O-- >0;)C[O]=arguments[O+1];for(var Q=0,he=C;Q<he.length;Q+=1){var me=he[Q];for(var we in me)E[we]=me[we]}return E}function en(E){return E instanceof Number||E instanceof String||E instanceof Boolean?E.valueOf():E}function Tn(E){if(Array.isArray(E))return E.map(Tn);if(E instanceof Object&&!(E instanceof Number||E instanceof String||E instanceof Boolean)){var C={};for(var O in E)C[O]=Tn(E[O]);return C}return en(E)}var xn=function(E){function C(O,Q){E.call(this,Q),this.message=Q,this.key=O}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C}(Error),un=function(C,O){O===void 0&&(O=[]),this.parent=C,this.bindings={};for(var Q=0,he=O;Q<he.length;Q+=1){var me=he[Q],we=me[0],Re=me[1];this.bindings[we]=Re}};un.prototype.concat=function(C){return new un(this,C)},un.prototype.get=function(C){if(this.bindings[C])return this.bindings[C];if(this.parent)return this.parent.get(C);throw new Error(C+" not found in scope.")},un.prototype.has=function(C){return this.bindings[C]?!0:this.parent?this.parent.has(C):!1};var gr={kind:"null"},yr={kind:"number"},zr={kind:"string"},gn={kind:"boolean"},On={kind:"color"},ta={kind:"object"},_n={kind:"value"},jn={kind:"error"},aa={kind:"collator"},pa={kind:"formatted"},ma={kind:"resolvedImage"};function sa(E,C){return{kind:"array",itemType:E,N:C}}function Aa(E){if(E.kind==="array"){var C=Aa(E.itemType);return typeof E.N=="number"?"array<"+C+", "+E.N+">":E.itemType.kind==="value"?"array":"array<"+C+">"}else return E.kind}var ho=[gr,yr,zr,gn,On,pa,ta,sa(_n),ma];function Ro(E,C){if(C.kind==="error")return null;if(E.kind==="array"){if(C.kind==="array"&&(C.N===0&&C.itemType.kind==="value"||!Ro(E.itemType,C.itemType))&&(typeof E.N!="number"||E.N===C.N))return null}else{if(E.kind===C.kind)return null;if(E.kind==="value")for(var O=0,Q=ho;O<Q.length;O+=1){var he=Q[O];if(!Ro(he,C))return null}}return"Expected "+Aa(E)+" but found "+Aa(C)+" instead."}function jo(E,C){return C.some(function(O){return O.kind===E.kind})}function rl(E,C){return C.some(function(O){return O==="null"?E===null:O==="array"?Array.isArray(E):O==="object"?E&&!Array.isArray(E)&&typeof E=="object":O===typeof E})}var vl=a(function(E,C){var O={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function Q(ft){return ft=Math.round(ft),ft<0?0:ft>255?255:ft}function he(ft){return ft<0?0:ft>1?1:ft}function me(ft){return ft[ft.length-1]==="%"?Q(parseFloat(ft)/100*255):Q(parseInt(ft))}function we(ft){return ft[ft.length-1]==="%"?he(parseFloat(ft)/100):he(parseFloat(ft))}function Re(ft,pt,It){return It<0?It+=1:It>1&&(It-=1),It*6<1?ft+(pt-ft)*It*6:It*2<1?pt:It*3<2?ft+(pt-ft)*(2/3-It)*6:ft}function $e(ft){var pt=ft.replace(/ /g,"").toLowerCase();if(pt in O)return O[pt].slice();if(pt[0]==="#"){if(pt.length===4){var It=parseInt(pt.substr(1),16);return It>=0&&It<=4095?[(It&3840)>>4|(It&3840)>>8,It&240|(It&240)>>4,It&15|(It&15)<<4,1]:null}else if(pt.length===7){var It=parseInt(pt.substr(1),16);return It>=0&&It<=16777215?[(It&16711680)>>16,(It&65280)>>8,It&255,1]:null}return null}var tr=pt.indexOf("("),Qt=pt.indexOf(")");if(tr!==-1&&Qt+1===pt.length){var dr=pt.substr(0,tr),Fr=pt.substr(tr+1,Qt-(tr+1)).split(","),an=1;switch(dr){case"rgba":if(Fr.length!==4)return null;an=we(Fr.pop());case"rgb":return Fr.length!==3?null:[me(Fr[0]),me(Fr[1]),me(Fr[2]),an];case"hsla":if(Fr.length!==4)return null;an=we(Fr.pop());case"hsl":if(Fr.length!==3)return null;var $r=(parseFloat(Fr[0])%360+360)%360/360,kn=we(Fr[1]),mn=we(Fr[2]),Sn=mn<=.5?mn*(kn+1):mn+kn-mn*kn,In=mn*2-Sn;return[Q(Re(In,Sn,$r+1/3)*255),Q(Re(In,Sn,$r)*255),Q(Re(In,Sn,$r-1/3)*255),an];default:return null}}return null}try{C.parseCSSColor=$e}catch{}}),Gl=vl.parseCSSColor,vi=function(C,O,Q,he){he===void 0&&(he=1),this.r=C,this.g=O,this.b=Q,this.a=he};vi.parse=function(C){if(!!C){if(C instanceof vi)return C;if(typeof C=="string"){var O=Gl(C);if(!!O)return new vi(O[0]/255*O[3],O[1]/255*O[3],O[2]/255*O[3],O[3])}}},vi.prototype.toString=function(){var C=this.toArray(),O=C[0],Q=C[1],he=C[2],me=C[3];return"rgba("+Math.round(O)+","+Math.round(Q)+","+Math.round(he)+","+me+")"},vi.prototype.toArray=function(){var C=this,O=C.r,Q=C.g,he=C.b,me=C.a;return me===0?[0,0,0,0]:[O*255/me,Q*255/me,he*255/me,me]},vi.black=new vi(0,0,0,1),vi.white=new vi(1,1,1,1),vi.transparent=new vi(0,0,0,0),vi.red=new vi(1,0,0,1);var Vs=function(C,O,Q){C?this.sensitivity=O?"variant":"case":this.sensitivity=O?"accent":"base",this.locale=Q,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};Vs.prototype.compare=function(C,O){return this.collator.compare(C,O)},Vs.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var Ds=function(C,O,Q,he,me){this.text=C,this.image=O,this.scale=Q,this.fontStack=he,this.textColor=me},Ui=function(C){this.sections=C};Ui.fromString=function(C){return new Ui([new Ds(C,null,null,null,null)])},Ui.prototype.isEmpty=function(){return this.sections.length===0?!0:!this.sections.some(function(C){return C.text.length!==0||C.image&&C.image.name.length!==0})},Ui.factory=function(C){return C instanceof Ui?C:Ui.fromString(C)},Ui.prototype.toString=function(){return this.sections.length===0?"":this.sections.map(function(C){return C.text}).join("")},Ui.prototype.serialize=function(){for(var C=["format"],O=0,Q=this.sections;O<Q.length;O+=1){var he=Q[O];if(he.image){C.push(["image",he.image.name]);continue}C.push(he.text);var me={};he.fontStack&&(me["text-font"]=["literal",he.fontStack.split(",")]),he.scale&&(me["font-scale"]=he.scale),he.textColor&&(me["text-color"]=["rgba"].concat(he.textColor.toArray())),C.push(me)}return C};var Ao=function(C){this.name=C.name,this.available=C.available};Ao.prototype.toString=function(){return this.name},Ao.fromString=function(C){return C?new Ao({name:C,available:!1}):null},Ao.prototype.serialize=function(){return["image",this.name]};function pl(E,C,O,Q){if(!(typeof E=="number"&&E>=0&&E<=255&&typeof C=="number"&&C>=0&&C<=255&&typeof O=="number"&&O>=0&&O<=255)){var he=typeof Q=="number"?[E,C,O,Q]:[E,C,O];return"Invalid rgba value ["+he.join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}return typeof Q>"u"||typeof Q=="number"&&Q>=0&&Q<=1?null:"Invalid rgba value ["+[E,C,O,Q].join(", ")+"]: 'a' must be between 0 and 1."}function vs(E){if(E===null)return!0;if(typeof E=="string")return!0;if(typeof E=="boolean")return!0;if(typeof E=="number")return!0;if(E instanceof vi)return!0;if(E instanceof Vs)return!0;if(E instanceof Ui)return!0;if(E instanceof Ao)return!0;if(Array.isArray(E)){for(var C=0,O=E;C<O.length;C+=1){var Q=O[C];if(!vs(Q))return!1}return!0}else if(typeof E=="object"){for(var he in E)if(!vs(E[he]))return!1;return!0}else return!1}function Di(E){if(E===null)return gr;if(typeof E=="string")return zr;if(typeof E=="boolean")return gn;if(typeof E=="number")return yr;if(E instanceof vi)return On;if(E instanceof Vs)return aa;if(E instanceof Ui)return pa;if(E instanceof Ao)return ma;if(Array.isArray(E)){for(var C=E.length,O,Q=0,he=E;Q<he.length;Q+=1){var me=he[Q],we=Di(me);if(!O)O=we;else{if(O===we)continue;O=_n;break}}return sa(O||_n,C)}else return ta}function nl(E){var C=typeof E;return E===null?"":C==="string"||C==="number"||C==="boolean"?String(E):E instanceof vi||E instanceof Ui||E instanceof Ao?E.toString():JSON.stringify(E)}var Ki=function(C,O){this.type=C,this.value=O};Ki.parse=function(C,O){if(C.length!==2)return O.error("'literal' expression requires exactly one argument, but found "+(C.length-1)+" instead.");if(!vs(C[1]))return O.error("invalid value");var Q=C[1],he=Di(Q),me=O.expectedType;return he.kind==="array"&&he.N===0&&me&&me.kind==="array"&&(typeof me.N!="number"||me.N===0)&&(he=me),new Ki(he,Q)},Ki.prototype.evaluate=function(){return this.value},Ki.prototype.eachChild=function(){},Ki.prototype.outputDefined=function(){return!0},Ki.prototype.serialize=function(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof vi?["rgba"].concat(this.value.toArray()):this.value instanceof Ui?this.value.serialize():this.value};var Fi=function(C){this.name="ExpressionEvaluationError",this.message=C};Fi.prototype.toJSON=function(){return this.message};var no={string:zr,number:yr,boolean:gn,object:ta},Ji=function(C,O){this.type=C,this.args=O};Ji.parse=function(C,O){if(C.length<2)return O.error("Expected at least one argument.");var Q=1,he,me=C[0];if(me==="array"){var we;if(C.length>2){var Re=C[1];if(typeof Re!="string"||!(Re in no)||Re==="object")return O.error('The item type argument of "array" must be one of string, number, boolean',1);we=no[Re],Q++}else we=_n;var $e;if(C.length>3){if(C[2]!==null&&(typeof C[2]!="number"||C[2]<0||C[2]!==Math.floor(C[2])))return O.error('The length argument to "array" must be a positive integer literal',2);$e=C[2],Q++}he=sa(we,$e)}else he=no[me];for(var ft=[];Q<C.length;Q++){var pt=O.parse(C[Q],Q,_n);if(!pt)return null;ft.push(pt)}return new Ji(he,ft)},Ji.prototype.evaluate=function(C){for(var O=0;O<this.args.length;O++){var Q=this.args[O].evaluate(C),he=Ro(this.type,Di(Q));if(he){if(O===this.args.length-1)throw new Fi("Expected value to be of type "+Aa(this.type)+", but found "+Aa(Di(Q))+" instead.")}else return Q}return null},Ji.prototype.eachChild=function(C){this.args.forEach(C)},Ji.prototype.outputDefined=function(){return this.args.every(function(C){return C.outputDefined()})},Ji.prototype.serialize=function(){var C=this.type,O=[C.kind];if(C.kind==="array"){var Q=C.itemType;if(Q.kind==="string"||Q.kind==="number"||Q.kind==="boolean"){O.push(Q.kind);var he=C.N;(typeof he=="number"||this.args.length>1)&&O.push(he)}}return O.concat(this.args.map(function(me){return me.serialize()}))};var ts=function(C){this.type=pa,this.sections=C};ts.parse=function(C,O){if(C.length<2)return O.error("Expected at least one argument.");var Q=C[1];if(!Array.isArray(Q)&&typeof Q=="object")return O.error("First argument must be an image or text section.");for(var he=[],me=!1,we=1;we<=C.length-1;++we){var Re=C[we];if(me&&typeof Re=="object"&&!Array.isArray(Re)){me=!1;var $e=null;if(Re["font-scale"]&&($e=O.parse(Re["font-scale"],1,yr),!$e))return null;var ft=null;if(Re["text-font"]&&(ft=O.parse(Re["text-font"],1,sa(zr)),!ft))return null;var pt=null;if(Re["text-color"]&&(pt=O.parse(Re["text-color"],1,On),!pt))return null;var It=he[he.length-1];It.scale=$e,It.font=ft,It.textColor=pt}else{var tr=O.parse(C[we],1,_n);if(!tr)return null;var Qt=tr.type.kind;if(Qt!=="string"&&Qt!=="value"&&Qt!=="null"&&Qt!=="resolvedImage")return O.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");me=!0,he.push({content:tr,scale:null,font:null,textColor:null})}}return new ts(he)},ts.prototype.evaluate=function(C){var O=function(Q){var he=Q.content.evaluate(C);return Di(he)===ma?new Ds("",he,null,null,null):new Ds(nl(he),null,Q.scale?Q.scale.evaluate(C):null,Q.font?Q.font.evaluate(C).join(","):null,Q.textColor?Q.textColor.evaluate(C):null)};return new Ui(this.sections.map(O))},ts.prototype.eachChild=function(C){for(var O=0,Q=this.sections;O<Q.length;O+=1){var he=Q[O];C(he.content),he.scale&&C(he.scale),he.font&&C(he.font),he.textColor&&C(he.textColor)}},ts.prototype.outputDefined=function(){return!1},ts.prototype.serialize=function(){for(var C=["format"],O=0,Q=this.sections;O<Q.length;O+=1){var he=Q[O];C.push(he.content.serialize());var me={};he.scale&&(me["font-scale"]=he.scale.serialize()),he.font&&(me["text-font"]=he.font.serialize()),he.textColor&&(me["text-color"]=he.textColor.serialize()),C.push(me)}return C};var Gs=function(C){this.type=ma,this.input=C};Gs.parse=function(C,O){if(C.length!==2)return O.error("Expected two arguments.");var Q=O.parse(C[1],1,zr);return Q?new Gs(Q):O.error("No image name provided.")},Gs.prototype.evaluate=function(C){var O=this.input.evaluate(C),Q=Ao.fromString(O);return Q&&C.availableImages&&(Q.available=C.availableImages.indexOf(O)>-1),Q},Gs.prototype.eachChild=function(C){C(this.input)},Gs.prototype.outputDefined=function(){return!1},Gs.prototype.serialize=function(){return["image",this.input.serialize()]};var nu={"to-boolean":gn,"to-color":On,"to-number":yr,"to-string":zr},Ko=function(C,O){this.type=C,this.args=O};Ko.parse=function(C,O){if(C.length<2)return O.error("Expected at least one argument.");var Q=C[0];if((Q==="to-boolean"||Q==="to-string")&&C.length!==2)return O.error("Expected one argument.");for(var he=nu[Q],me=[],we=1;we<C.length;we++){var Re=O.parse(C[we],we,_n);if(!Re)return null;me.push(Re)}return new Ko(he,me)},Ko.prototype.evaluate=function(C){if(this.type.kind==="boolean")return Boolean(this.args[0].evaluate(C));if(this.type.kind==="color"){for(var O,Q,he=0,me=this.args;he<me.length;he+=1){var we=me[he];if(O=we.evaluate(C),Q=null,O instanceof vi)return O;if(typeof O=="string"){var Re=C.parseColor(O);if(Re)return Re}else if(Array.isArray(O)&&(O.length<3||O.length>4?Q="Invalid rbga value "+JSON.stringify(O)+": expected an array containing either three or four numeric values.":Q=pl(O[0],O[1],O[2],O[3]),!Q))return new vi(O[0]/255,O[1]/255,O[2]/255,O[3])}throw new Fi(Q||"Could not parse color from value '"+(typeof O=="string"?O:String(JSON.stringify(O)))+"'")}else if(this.type.kind==="number"){for(var $e=null,ft=0,pt=this.args;ft<pt.length;ft+=1){var It=pt[ft];if($e=It.evaluate(C),$e===null)return 0;var tr=Number($e);if(!isNaN(tr))return tr}throw new Fi("Could not convert "+JSON.stringify($e)+" to number.")}else return this.type.kind==="formatted"?Ui.fromString(nl(this.args[0].evaluate(C))):this.type.kind==="resolvedImage"?Ao.fromString(nl(this.args[0].evaluate(C))):nl(this.args[0].evaluate(C))},Ko.prototype.eachChild=function(C){this.args.forEach(C)},Ko.prototype.outputDefined=function(){return this.args.every(function(C){return C.outputDefined()})},Ko.prototype.serialize=function(){if(this.type.kind==="formatted")return new ts([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new Gs(this.args[0]).serialize();var C=["to-"+this.type.kind];return this.eachChild(function(O){C.push(O.serialize())}),C};var au=["Unknown","Point","LineString","Polygon"],Rs=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};Rs.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},Rs.prototype.geometryType=function(){return this.feature?typeof this.feature.type=="number"?au[this.feature.type]:this.feature.type:null},Rs.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},Rs.prototype.canonicalID=function(){return this.canonical},Rs.prototype.properties=function(){return this.feature&&this.feature.properties||{}},Rs.prototype.parseColor=function(C){var O=this._parseColorCache[C];return O||(O=this._parseColorCache[C]=vi.parse(C)),O};var Mo=function(C,O,Q,he){this.name=C,this.type=O,this._evaluate=Q,this.args=he};Mo.prototype.evaluate=function(C){return this._evaluate(C,this.args)},Mo.prototype.eachChild=function(C){this.args.forEach(C)},Mo.prototype.outputDefined=function(){return!1},Mo.prototype.serialize=function(){return[this.name].concat(this.args.map(function(C){return C.serialize()}))},Mo.parse=function(C,O){var Q,he=C[0],me=Mo.definitions[he];if(!me)return O.error('Unknown expression "'+he+'". If you wanted a literal array, use ["literal", [...]].',0);for(var we=Array.isArray(me)?me[0]:me.type,Re=Array.isArray(me)?[[me[1],me[2]]]:me.overloads,$e=Re.filter(function(Ca){var Da=Ca[0];return!Array.isArray(Da)||Da.length===C.length-1}),ft=null,pt=0,It=$e;pt<It.length;pt+=1){var tr=It[pt],Qt=tr[0],dr=tr[1];ft=new So(O.registry,O.path,null,O.scope);for(var Fr=[],an=!1,$r=1;$r<C.length;$r++){var kn=C[$r],mn=Array.isArray(Qt)?Qt[$r-1]:Qt.type,Sn=ft.parse(kn,1+Fr.length,mn);if(!Sn){an=!0;break}Fr.push(Sn)}if(!an){if(Array.isArray(Qt)&&Qt.length!==Fr.length){ft.error("Expected "+Qt.length+" arguments, but found "+Fr.length+" instead.");continue}for(var In=0;In<Fr.length;In++){var Gn=Array.isArray(Qt)?Qt[In]:Qt.type,oa=Fr[In];ft.concat(In+1).checkSubtype(Gn,oa.type)}if(ft.errors.length===0)return new Mo(he,we,dr,Fr)}}if($e.length===1)(Q=O.errors).push.apply(Q,ft.errors);else{for(var na=$e.length?$e:Re,Ra=na.map(function(Ca){var Da=Ca[0];return Mu(Da)}).join(" | "),wa=[],Ma=1;Ma<C.length;Ma++){var ti=O.parse(C[Ma],1+wa.length);if(!ti)return null;wa.push(Aa(ti.type))}O.error("Expected arguments of type "+Ra+", but found ("+wa.join(", ")+") instead.")}return null},Mo.register=function(C,O){Mo.definitions=O;for(var Q in O)C[Q]=Mo};function Mu(E){return Array.isArray(E)?"("+E.map(Aa).join(", ")+")":"("+Aa(E.type)+"...)"}var Is=function(C,O,Q){this.type=aa,this.locale=Q,this.caseSensitive=C,this.diacriticSensitive=O};Is.parse=function(C,O){if(C.length!==2)return O.error("Expected one argument.");var Q=C[1];if(typeof Q!="object"||Array.isArray(Q))return O.error("Collator options argument must be an object.");var he=O.parse(Q["case-sensitive"]===void 0?!1:Q["case-sensitive"],1,gn);if(!he)return null;var me=O.parse(Q["diacritic-sensitive"]===void 0?!1:Q["diacritic-sensitive"],1,gn);if(!me)return null;var we=null;return Q.locale&&(we=O.parse(Q.locale,1,zr),!we)?null:new Is(he,me,we)},Is.prototype.evaluate=function(C){return new Vs(this.caseSensitive.evaluate(C),this.diacriticSensitive.evaluate(C),this.locale?this.locale.evaluate(C):null)},Is.prototype.eachChild=function(C){C(this.caseSensitive),C(this.diacriticSensitive),this.locale&&C(this.locale)},Is.prototype.outputDefined=function(){return!1},Is.prototype.serialize=function(){var C={};return C["case-sensitive"]=this.caseSensitive.serialize(),C["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(C.locale=this.locale.serialize()),["collator",C]};var _s=8192;function Cl(E,C){E[0]=Math.min(E[0],C[0]),E[1]=Math.min(E[1],C[1]),E[2]=Math.max(E[2],C[0]),E[3]=Math.max(E[3],C[1])}function Su(E){return(180+E)/360}function ku(E){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+E*Math.PI/360)))/360}function Ys(E,C){return!(E[0]<=C[0]||E[2]>=C[2]||E[1]<=C[1]||E[3]>=C[3])}function Ll(E,C){var O=Su(E[0]),Q=ku(E[1]),he=Math.pow(2,C.z);return[Math.round(O*he*_s),Math.round(Q*he*_s)]}function ws(E,C,O){var Q=E[0]-C[0],he=E[1]-C[1],me=E[0]-O[0],we=E[1]-O[1];return Q*we-me*he===0&&Q*me<=0&&he*we<=0}function Yl(E,C,O){return C[1]>E[1]!=O[1]>E[1]&&E[0]<(O[0]-C[0])*(E[1]-C[1])/(O[1]-C[1])+C[0]}function al(E,C){for(var O=!1,Q=0,he=C.length;Q<he;Q++)for(var me=C[Q],we=0,Re=me.length;we<Re-1;we++){if(ws(E,me[we],me[we+1]))return!1;Yl(E,me[we],me[we+1])&&(O=!O)}return O}function Wl(E,C){for(var O=0;O<C.length;O++)if(al(E,C[O]))return!0;return!1}function iu(E,C){return E[0]*C[1]-E[1]*C[0]}function Pl(E,C,O,Q){var he=E[0]-O[0],me=E[1]-O[1],we=C[0]-O[0],Re=C[1]-O[1],$e=Q[0]-O[0],ft=Q[1]-O[1],pt=he*ft-$e*me,It=we*ft-$e*Re;return pt>0&&It<0||pt<0&&It>0}function Eu(E,C,O,Q){var he=[C[0]-E[0],C[1]-E[1]],me=[Q[0]-O[0],Q[1]-O[1]];return iu(me,he)===0?!1:!!(Pl(E,C,O,Q)&&Pl(O,Q,E,C))}function Ws(E,C,O){for(var Q=0,he=O;Q<he.length;Q+=1)for(var me=he[Q],we=0;we<me.length-1;++we)if(Eu(E,C,me[we],me[we+1]))return!0;return!1}function Xl(E,C){for(var O=0;O<E.length;++O)if(!al(E[O],C))return!1;for(var Q=0;Q<E.length-1;++Q)if(Ws(E[Q],E[Q+1],C))return!1;return!0}function Dl(E,C){for(var O=0;O<C.length;O++)if(Xl(E,C[O]))return!0;return!1}function ps(E,C,O){for(var Q=[],he=0;he<E.length;he++){for(var me=[],we=0;we<E[he].length;we++){var Re=Ll(E[he][we],O);Cl(C,Re),me.push(Re)}Q.push(me)}return Q}function dl(E,C,O){for(var Q=[],he=0;he<E.length;he++){var me=ps(E[he],C,O);Q.push(me)}return Q}function Zl(E,C,O,Q){if(E[0]<O[0]||E[0]>O[2]){var he=Q*.5,me=E[0]-O[0]>he?-Q:O[0]-E[0]>he?Q:0;me===0&&(me=E[0]-O[2]>he?-Q:O[2]-E[0]>he?Q:0),E[0]+=me}Cl(C,E)}function ou(E){E[0]=E[1]=1/0,E[2]=E[3]=-1/0}function su(E,C,O,Q){for(var he=Math.pow(2,Q.z)*_s,me=[Q.x*_s,Q.y*_s],we=[],Re=0,$e=E;Re<$e.length;Re+=1)for(var ft=$e[Re],pt=0,It=ft;pt<It.length;pt+=1){var tr=It[pt],Qt=[tr.x+me[0],tr.y+me[1]];Zl(Qt,C,O,he),we.push(Qt)}return we}function Rl(E,C,O,Q){for(var he=Math.pow(2,Q.z)*_s,me=[Q.x*_s,Q.y*_s],we=[],Re=0,$e=E;Re<$e.length;Re+=1){for(var ft=$e[Re],pt=[],It=0,tr=ft;It<tr.length;It+=1){var Qt=tr[It],dr=[Qt.x+me[0],Qt.y+me[1]];Cl(C,dr),pt.push(dr)}we.push(pt)}if(C[2]-C[0]<=he/2){ou(C);for(var Fr=0,an=we;Fr<an.length;Fr+=1)for(var $r=an[Fr],kn=0,mn=$r;kn<mn.length;kn+=1){var Sn=mn[kn];Zl(Sn,C,O,he)}}return we}function Cu(E,C){var O=[1/0,1/0,-1/0,-1/0],Q=[1/0,1/0,-1/0,-1/0],he=E.canonicalID();if(C.type==="Polygon"){var me=ps(C.coordinates,Q,he),we=su(E.geometry(),O,Q,he);if(!Ys(O,Q))return!1;for(var Re=0,$e=we;Re<$e.length;Re+=1){var ft=$e[Re];if(!al(ft,me))return!1}}if(C.type==="MultiPolygon"){var pt=dl(C.coordinates,Q,he),It=su(E.geometry(),O,Q,he);if(!Ys(O,Q))return!1;for(var tr=0,Qt=It;tr<Qt.length;tr+=1){var dr=Qt[tr];if(!Wl(dr,pt))return!1}}return!0}function lu(E,C){var O=[1/0,1/0,-1/0,-1/0],Q=[1/0,1/0,-1/0,-1/0],he=E.canonicalID();if(C.type==="Polygon"){var me=ps(C.coordinates,Q,he),we=Rl(E.geometry(),O,Q,he);if(!Ys(O,Q))return!1;for(var Re=0,$e=we;Re<$e.length;Re+=1){var ft=$e[Re];if(!Xl(ft,me))return!1}}if(C.type==="MultiPolygon"){var pt=dl(C.coordinates,Q,he),It=Rl(E.geometry(),O,Q,he);if(!Ys(O,Q))return!1;for(var tr=0,Qt=It;tr<Qt.length;tr+=1){var dr=Qt[tr];if(!Dl(dr,pt))return!1}}return!0}var Jo=function(C,O){this.type=gn,this.geojson=C,this.geometries=O};Jo.parse=function(C,O){if(C.length!==2)return O.error("'within' expression requires exactly one argument, but found "+(C.length-1)+" instead.");if(vs(C[1])){var Q=C[1];if(Q.type==="FeatureCollection")for(var he=0;he<Q.features.length;++he){var me=Q.features[he].geometry.type;if(me==="Polygon"||me==="MultiPolygon")return new Jo(Q,Q.features[he].geometry)}else if(Q.type==="Feature"){var we=Q.geometry.type;if(we==="Polygon"||we==="MultiPolygon")return new Jo(Q,Q.geometry)}else if(Q.type==="Polygon"||Q.type==="MultiPolygon")return new Jo(Q,Q)}return O.error("'within' expression requires valid geojson object that contains polygon geometry type.")},Jo.prototype.evaluate=function(C){if(C.geometry()!=null&&C.canonicalID()!=null){if(C.geometryType()==="Point")return Cu(C,this.geometries);if(C.geometryType()==="LineString")return lu(C,this.geometries)}return!1},Jo.prototype.eachChild=function(){},Jo.prototype.outputDefined=function(){return!0},Jo.prototype.serialize=function(){return["within",this.geojson]};function il(E){if(E instanceof Mo){if(E.name==="get"&&E.args.length===1)return!1;if(E.name==="feature-state")return!1;if(E.name==="has"&&E.args.length===1)return!1;if(E.name==="properties"||E.name==="geometry-type"||E.name==="id")return!1;if(/^filter-/.test(E.name))return!1}if(E instanceof Jo)return!1;var C=!0;return E.eachChild(function(O){C&&!il(O)&&(C=!1)}),C}function ol(E){if(E instanceof Mo&&E.name==="feature-state")return!1;var C=!0;return E.eachChild(function(O){C&&!ol(O)&&(C=!1)}),C}function jl(E,C){if(E instanceof Mo&&C.indexOf(E.name)>=0)return!1;var O=!0;return E.eachChild(function(Q){O&&!jl(Q,C)&&(O=!1)}),O}var ds=function(C,O){this.type=O.type,this.name=C,this.boundExpression=O};ds.parse=function(C,O){if(C.length!==2||typeof C[1]!="string")return O.error("'var' expression requires exactly one string literal argument.");var Q=C[1];return O.scope.has(Q)?new ds(Q,O.scope.get(Q)):O.error('Unknown variable "'+Q+'". Make sure "'+Q+'" has been bound in an enclosing "let" expression before using it.',1)},ds.prototype.evaluate=function(C){return this.boundExpression.evaluate(C)},ds.prototype.eachChild=function(){},ds.prototype.outputDefined=function(){return!1},ds.prototype.serialize=function(){return["var",this.name]};var So=function(C,O,Q,he,me){O===void 0&&(O=[]),he===void 0&&(he=new un),me===void 0&&(me=[]),this.registry=C,this.path=O,this.key=O.map(function(we){return"["+we+"]"}).join(""),this.scope=he,this.errors=me,this.expectedType=Q};So.prototype.parse=function(C,O,Q,he,me){return me===void 0&&(me={}),O?this.concat(O,Q,he)._parse(C,me):this._parse(C,me)},So.prototype._parse=function(C,O){(C===null||typeof C=="string"||typeof C=="boolean"||typeof C=="number")&&(C=["literal",C]);function Q(pt,It,tr){return tr==="assert"?new Ji(It,[pt]):tr==="coerce"?new Ko(It,[pt]):pt}if(Array.isArray(C)){if(C.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var he=C[0];if(typeof he!="string")return this.error("Expression name must be a string, but found "+typeof he+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var me=this.registry[he];if(me){var we=me.parse(C,this);if(!we)return null;if(this.expectedType){var Re=this.expectedType,$e=we.type;if((Re.kind==="string"||Re.kind==="number"||Re.kind==="boolean"||Re.kind==="object"||Re.kind==="array")&&$e.kind==="value")we=Q(we,Re,O.typeAnnotation||"assert");else if((Re.kind==="color"||Re.kind==="formatted"||Re.kind==="resolvedImage")&&($e.kind==="value"||$e.kind==="string"))we=Q(we,Re,O.typeAnnotation||"coerce");else if(this.checkSubtype(Re,$e))return null}if(!(we instanceof Ki)&&we.type.kind!=="resolvedImage"&&Il(we)){var ft=new Rs;try{we=new Ki(we.type,we.evaluate(ft))}catch(pt){return this.error(pt.message),null}}return we}return this.error('Unknown expression "'+he+'". If you wanted a literal array, use ["literal", [...]].',0)}else return typeof C>"u"?this.error("'undefined' value invalid. Use null instead."):typeof C=="object"?this.error('Bare objects invalid. Use ["literal", {...}] instead.'):this.error("Expected an array, but found "+typeof C+" instead.")},So.prototype.concat=function(C,O,Q){var he=typeof C=="number"?this.path.concat(C):this.path,me=Q?this.scope.concat(Q):this.scope;return new So(this.registry,he,O||null,me,this.errors)},So.prototype.error=function(C){for(var O=[],Q=arguments.length-1;Q-- >0;)O[Q]=arguments[Q+1];var he=""+this.key+O.map(function(me){return"["+me+"]"}).join("");this.errors.push(new xn(he,C))},So.prototype.checkSubtype=function(C,O){var Q=Ro(C,O);return Q&&this.error(Q),Q};function Il(E){if(E instanceof ds)return Il(E.boundExpression);if(E instanceof Mo&&E.name==="error")return!1;if(E instanceof Is)return!1;if(E instanceof Jo)return!1;var C=E instanceof Ko||E instanceof Ji,O=!0;return E.eachChild(function(Q){C?O=O&&Il(Q):O=O&&Q instanceof Ki}),O?il(E)&&jl(E,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"]):!1}function Ts(E,C){for(var O=E.length-1,Q=0,he=O,me=0,we,Re;Q<=he;)if(me=Math.floor((Q+he)/2),we=E[me],Re=E[me+1],we<=C){if(me===O||C<Re)return me;Q=me+1}else if(we>C)he=me-1;else throw new Fi("Input is not a number.");return 0}var As=function(C,O,Q){this.type=C,this.input=O,this.labels=[],this.outputs=[];for(var he=0,me=Q;he<me.length;he+=1){var we=me[he],Re=we[0],$e=we[1];this.labels.push(Re),this.outputs.push($e)}};As.parse=function(C,O){if(C.length-1<4)return O.error("Expected at least 4 arguments, but found only "+(C.length-1)+".");if((C.length-1)%2!==0)return O.error("Expected an even number of arguments.");var Q=O.parse(C[1],1,yr);if(!Q)return null;var he=[],me=null;O.expectedType&&O.expectedType.kind!=="value"&&(me=O.expectedType);for(var we=1;we<C.length;we+=2){var Re=we===1?-1/0:C[we],$e=C[we+1],ft=we,pt=we+1;if(typeof Re!="number")return O.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',ft);if(he.length&&he[he.length-1][0]>=Re)return O.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',ft);var It=O.parse($e,pt,me);if(!It)return null;me=me||It.type,he.push([Re,It])}return new As(me,Q,he)},As.prototype.evaluate=function(C){var O=this.labels,Q=this.outputs;if(O.length===1)return Q[0].evaluate(C);var he=this.input.evaluate(C);if(he<=O[0])return Q[0].evaluate(C);var me=O.length;if(he>=O[me-1])return Q[me-1].evaluate(C);var we=Ts(O,he);return Q[we].evaluate(C)},As.prototype.eachChild=function(C){C(this.input);for(var O=0,Q=this.outputs;O<Q.length;O+=1){var he=Q[O];C(he)}},As.prototype.outputDefined=function(){return this.outputs.every(function(C){return C.outputDefined()})},As.prototype.serialize=function(){for(var C=["step",this.input.serialize()],O=0;O<this.labels.length;O++)O>0&&C.push(this.labels[O]),C.push(this.outputs[O].serialize());return C};function oo(E,C,O){return E*(1-O)+C*O}function yl(E,C,O){return new vi(oo(E.r,C.r,O),oo(E.g,C.g,O),oo(E.b,C.b,O),oo(E.a,C.a,O))}function ml(E,C,O){return E.map(function(Q,he){return oo(Q,C[he],O)})}var Xs=Object.freeze({__proto__:null,number:oo,color:yl,array:ml}),gs=.95047,xl=1,sl=1.08883,zl=4/29,bl=6/29,Zs=3*bl*bl,Lu=bl*bl*bl,rs=Math.PI/180,Yu=180/Math.PI;function Kl(E){return E>Lu?Math.pow(E,1/3):E/Zs+zl}function ll(E){return E>bl?E*E*E:Zs*(E-zl)}function _l(E){return 255*(E<=.0031308?12.92*E:1.055*Math.pow(E,1/2.4)-.055)}function js(E){return E/=255,E<=.04045?E/12.92:Math.pow((E+.055)/1.055,2.4)}function wl(E){var C=js(E.r),O=js(E.g),Q=js(E.b),he=Kl((.4124564*C+.3575761*O+.1804375*Q)/gs),me=Kl((.2126729*C+.7151522*O+.072175*Q)/xl),we=Kl((.0193339*C+.119192*O+.9503041*Q)/sl);return{l:116*me-16,a:500*(he-me),b:200*(me-we),alpha:E.a}}function uu(E){var C=(E.l+16)/116,O=isNaN(E.a)?C:C+E.a/500,Q=isNaN(E.b)?C:C-E.b/200;return C=xl*ll(C),O=gs*ll(O),Q=sl*ll(Q),new vi(_l(3.2404542*O-1.5371385*C-.4985314*Q),_l(-.969266*O+1.8760108*C+.041556*Q),_l(.0556434*O-.2040259*C+1.0572252*Q),E.alpha)}function fu(E,C,O){return{l:oo(E.l,C.l,O),a:oo(E.a,C.a,O),b:oo(E.b,C.b,O),alpha:oo(E.alpha,C.alpha,O)}}function Wu(E){var C=wl(E),O=C.l,Q=C.a,he=C.b,me=Math.atan2(he,Q)*Yu;return{h:me<0?me+360:me,c:Math.sqrt(Q*Q+he*he),l:O,alpha:E.a}}function Ri(E){var C=E.h*rs,O=E.c,Q=E.l;return uu({l:Q,a:Math.cos(C)*O,b:Math.sin(C)*O,alpha:E.alpha})}function ul(E,C,O){var Q=C-E;return E+O*(Q>180||Q<-180?Q-360*Math.round(Q/360):Q)}function Ks(E,C,O){return{h:ul(E.h,C.h,O),c:oo(E.c,C.c,O),l:oo(E.l,C.l,O),alpha:oo(E.alpha,C.alpha,O)}}var Qo={forward:wl,reverse:uu,interpolate:fu},ns={forward:Wu,reverse:Ri,interpolate:Ks},Tl=Object.freeze({__proto__:null,lab:Qo,hcl:ns}),so=function(C,O,Q,he,me){this.type=C,this.operator=O,this.interpolation=Q,this.input=he,this.labels=[],this.outputs=[];for(var we=0,Re=me;we<Re.length;we+=1){var $e=Re[we],ft=$e[0],pt=$e[1];this.labels.push(ft),this.outputs.push(pt)}};so.interpolationFactor=function(C,O,Q,he){var me=0;if(C.name==="exponential")me=cu(O,C.base,Q,he);else if(C.name==="linear")me=cu(O,1,Q,he);else if(C.name==="cubic-bezier"){var we=C.controlPoints,Re=new r(we[0],we[1],we[2],we[3]);me=Re.solve(cu(O,1,Q,he))}return me},so.parse=function(C,O){var Q=C[0],he=C[1],me=C[2],we=C.slice(3);if(!Array.isArray(he)||he.length===0)return O.error("Expected an interpolation type expression.",1);if(he[0]==="linear")he={name:"linear"};else if(he[0]==="exponential"){var Re=he[1];if(typeof Re!="number")return O.error("Exponential interpolation requires a numeric base.",1,1);he={name:"exponential",base:Re}}else if(he[0]==="cubic-bezier"){var $e=he.slice(1);if($e.length!==4||$e.some(function($r){return typeof $r!="number"||$r<0||$r>1}))return O.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);he={name:"cubic-bezier",controlPoints:$e}}else return O.error("Unknown interpolation type "+String(he[0]),1,0);if(C.length-1<4)return O.error("Expected at least 4 arguments, but found only "+(C.length-1)+".");if((C.length-1)%2!==0)return O.error("Expected an even number of arguments.");if(me=O.parse(me,2,yr),!me)return null;var ft=[],pt=null;Q==="interpolate-hcl"||Q==="interpolate-lab"?pt=On:O.expectedType&&O.expectedType.kind!=="value"&&(pt=O.expectedType);for(var It=0;It<we.length;It+=2){var tr=we[It],Qt=we[It+1],dr=It+3,Fr=It+4;if(typeof tr!="number")return O.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',dr);if(ft.length&&ft[ft.length-1][0]>=tr)return O.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',dr);var an=O.parse(Qt,Fr,pt);if(!an)return null;pt=pt||an.type,ft.push([tr,an])}return pt.kind!=="number"&&pt.kind!=="color"&&!(pt.kind==="array"&&pt.itemType.kind==="number"&&typeof pt.N=="number")?O.error("Type "+Aa(pt)+" is not interpolatable."):new so(pt,Q,he,me,ft)},so.prototype.evaluate=function(C){var O=this.labels,Q=this.outputs;if(O.length===1)return Q[0].evaluate(C);var he=this.input.evaluate(C);if(he<=O[0])return Q[0].evaluate(C);var me=O.length;if(he>=O[me-1])return Q[me-1].evaluate(C);var we=Ts(O,he),Re=O[we],$e=O[we+1],ft=so.interpolationFactor(this.interpolation,he,Re,$e),pt=Q[we].evaluate(C),It=Q[we+1].evaluate(C);return this.operator==="interpolate"?Xs[this.type.kind.toLowerCase()](pt,It,ft):this.operator==="interpolate-hcl"?ns.reverse(ns.interpolate(ns.forward(pt),ns.forward(It),ft)):Qo.reverse(Qo.interpolate(Qo.forward(pt),Qo.forward(It),ft))},so.prototype.eachChild=function(C){C(this.input);for(var O=0,Q=this.outputs;O<Q.length;O+=1){var he=Q[O];C(he)}},so.prototype.outputDefined=function(){return this.outputs.every(function(C){return C.outputDefined()})},so.prototype.serialize=function(){var C;this.interpolation.name==="linear"?C=["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?C=["linear"]:C=["exponential",this.interpolation.base]:C=["cubic-bezier"].concat(this.interpolation.controlPoints);for(var O=[this.operator,C,this.input.serialize()],Q=0;Q<this.labels.length;Q++)O.push(this.labels[Q],this.outputs[Q].serialize());return O};function cu(E,C,O,Q){var he=Q-O,me=E-O;return he===0?0:C===1?me/he:(Math.pow(C,me)-1)/(Math.pow(C,he)-1)}var as=function(C,O){this.type=C,this.args=O};as.parse=function(C,O){if(C.length<2)return O.error("Expectected at least one argument.");var Q=null,he=O.expectedType;he&&he.kind!=="value"&&(Q=he);for(var me=[],we=0,Re=C.slice(1);we<Re.length;we+=1){var $e=Re[we],ft=O.parse($e,1+me.length,Q,void 0,{typeAnnotation:"omit"});if(!ft)return null;Q=Q||ft.type,me.push(ft)}var pt=he&&me.some(function(It){return Ro(he,It.type)});return pt?new as(_n,me):new as(Q,me)},as.prototype.evaluate=function(C){for(var O=null,Q=0,he,me=0,we=this.args;me<we.length;me+=1){var Re=we[me];if(Q++,O=Re.evaluate(C),O&&O instanceof Ao&&!O.available&&(he||(he=O.name),O=null,Q===this.args.length&&(O=he)),O!==null)break}return O},as.prototype.eachChild=function(C){this.args.forEach(C)},as.prototype.outputDefined=function(){return this.args.every(function(C){return C.outputDefined()})},as.prototype.serialize=function(){var C=["coalesce"];return this.eachChild(function(O){C.push(O.serialize())}),C};var zs=function(C,O){this.type=O.type,this.bindings=[].concat(C),this.result=O};zs.prototype.evaluate=function(C){return this.result.evaluate(C)},zs.prototype.eachChild=function(C){for(var O=0,Q=this.bindings;O<Q.length;O+=1){var he=Q[O];C(he[1])}C(this.result)},zs.parse=function(C,O){if(C.length<4)return O.error("Expected at least 3 arguments, but found "+(C.length-1)+" instead.");for(var Q=[],he=1;he<C.length-1;he+=2){var me=C[he];if(typeof me!="string")return O.error("Expected string, but found "+typeof me+" instead.",he);if(/[^a-zA-Z0-9_]/.test(me))return O.error("Variable names must contain only alphanumeric characters or '_'.",he);var we=O.parse(C[he+1],he+1);if(!we)return null;Q.push([me,we])}var Re=O.parse(C[C.length-1],C.length-1,O.expectedType,Q);return Re?new zs(Q,Re):null},zs.prototype.outputDefined=function(){return this.result.outputDefined()},zs.prototype.serialize=function(){for(var C=["let"],O=0,Q=this.bindings;O<Q.length;O+=1){var he=Q[O],me=he[0],we=he[1];C.push(me,we.serialize())}return C.push(this.result.serialize()),C};var Fs=function(C,O,Q){this.type=C,this.index=O,this.input=Q};Fs.parse=function(C,O){if(C.length!==3)return O.error("Expected 2 arguments, but found "+(C.length-1)+" instead.");var Q=O.parse(C[1],1,yr),he=O.parse(C[2],2,sa(O.expectedType||_n));if(!Q||!he)return null;var me=he.type;return new Fs(me.itemType,Q,he)},Fs.prototype.evaluate=function(C){var O=this.index.evaluate(C),Q=this.input.evaluate(C);if(O<0)throw new Fi("Array index out of bounds: "+O+" < 0.");if(O>=Q.length)throw new Fi("Array index out of bounds: "+O+" > "+(Q.length-1)+".");if(O!==Math.floor(O))throw new Fi("Array index must be an integer, but found "+O+" instead.");return Q[O]},Fs.prototype.eachChild=function(C){C(this.index),C(this.input)},Fs.prototype.outputDefined=function(){return!1},Fs.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var Ms=function(C,O){this.type=gn,this.needle=C,this.haystack=O};Ms.parse=function(C,O){if(C.length!==3)return O.error("Expected 2 arguments, but found "+(C.length-1)+" instead.");var Q=O.parse(C[1],1,_n),he=O.parse(C[2],2,_n);return!Q||!he?null:jo(Q.type,[gn,zr,yr,gr,_n])?new Ms(Q,he):O.error("Expected first argument to be of type boolean, string, number or null, but found "+Aa(Q.type)+" instead")},Ms.prototype.evaluate=function(C){var O=this.needle.evaluate(C),Q=this.haystack.evaluate(C);if(!Q)return!1;if(!rl(O,["boolean","string","number","null"]))throw new Fi("Expected first argument to be of type boolean, string, number or null, but found "+Aa(Di(O))+" instead.");if(!rl(Q,["string","array"]))throw new Fi("Expected second argument to be of type array or string, but found "+Aa(Di(Q))+" instead.");return Q.indexOf(O)>=0},Ms.prototype.eachChild=function(C){C(this.needle),C(this.haystack)},Ms.prototype.outputDefined=function(){return!0},Ms.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var is=function(C,O,Q){this.type=yr,this.needle=C,this.haystack=O,this.fromIndex=Q};is.parse=function(C,O){if(C.length<=2||C.length>=5)return O.error("Expected 3 or 4 arguments, but found "+(C.length-1)+" instead.");var Q=O.parse(C[1],1,_n),he=O.parse(C[2],2,_n);if(!Q||!he)return null;if(!jo(Q.type,[gn,zr,yr,gr,_n]))return O.error("Expected first argument to be of type boolean, string, number or null, but found "+Aa(Q.type)+" instead");if(C.length===4){var me=O.parse(C[3],3,yr);return me?new is(Q,he,me):null}else return new is(Q,he)},is.prototype.evaluate=function(C){var O=this.needle.evaluate(C),Q=this.haystack.evaluate(C);if(!rl(O,["boolean","string","number","null"]))throw new Fi("Expected first argument to be of type boolean, string, number or null, but found "+Aa(Di(O))+" instead.");if(!rl(Q,["string","array"]))throw new Fi("Expected second argument to be of type array or string, but found "+Aa(Di(Q))+" instead.");if(this.fromIndex){var he=this.fromIndex.evaluate(C);return Q.indexOf(O,he)}return Q.indexOf(O)},is.prototype.eachChild=function(C){C(this.needle),C(this.haystack),this.fromIndex&&C(this.fromIndex)},is.prototype.outputDefined=function(){return!1},is.prototype.serialize=function(){if(this.fromIndex!=null&&this.fromIndex!==void 0){var C=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),C]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var Hi=function(C,O,Q,he,me,we){this.inputType=C,this.type=O,this.input=Q,this.cases=he,this.outputs=me,this.otherwise=we};Hi.parse=function(C,O){if(C.length<5)return O.error("Expected at least 4 arguments, but found only "+(C.length-1)+".");if(C.length%2!==1)return O.error("Expected an even number of arguments.");var Q,he;O.expectedType&&O.expectedType.kind!=="value"&&(he=O.expectedType);for(var me={},we=[],Re=2;Re<C.length-1;Re+=2){var $e=C[Re],ft=C[Re+1];Array.isArray($e)||($e=[$e]);var pt=O.concat(Re);if($e.length===0)return pt.error("Expected at least one branch label.");for(var It=0,tr=$e;It<tr.length;It+=1){var Qt=tr[It];if(typeof Qt!="number"&&typeof Qt!="string")return pt.error("Branch labels must be numbers or strings.");if(typeof Qt=="number"&&Math.abs(Qt)>Number.MAX_SAFE_INTEGER)return pt.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if(typeof Qt=="number"&&Math.floor(Qt)!==Qt)return pt.error("Numeric branch labels must be integer values.");if(!Q)Q=Di(Qt);else if(pt.checkSubtype(Q,Di(Qt)))return null;if(typeof me[String(Qt)]<"u")return pt.error("Branch labels must be unique.");me[String(Qt)]=we.length}var dr=O.parse(ft,Re,he);if(!dr)return null;he=he||dr.type,we.push(dr)}var Fr=O.parse(C[1],1,_n);if(!Fr)return null;var an=O.parse(C[C.length-1],C.length-1,he);return!an||Fr.type.kind!=="value"&&O.concat(1).checkSubtype(Q,Fr.type)?null:new Hi(Q,he,Fr,me,we,an)},Hi.prototype.evaluate=function(C){var O=this.input.evaluate(C),Q=Di(O)===this.inputType&&this.outputs[this.cases[O]]||this.otherwise;return Q.evaluate(C)},Hi.prototype.eachChild=function(C){C(this.input),this.outputs.forEach(C),C(this.otherwise)},Hi.prototype.outputDefined=function(){return this.outputs.every(function(C){return C.outputDefined()})&&this.otherwise.outputDefined()},Hi.prototype.serialize=function(){for(var C=this,O=["match",this.input.serialize()],Q=Object.keys(this.cases).sort(),he=[],me={},we=0,Re=Q;we<Re.length;we+=1){var $e=Re[we],ft=me[this.cases[$e]];ft===void 0?(me[this.cases[$e]]=he.length,he.push([this.cases[$e],[$e]])):he[ft][1].push($e)}for(var pt=function(Fr){return C.inputType.kind==="number"?Number(Fr):Fr},It=0,tr=he;It<tr.length;It+=1){var Qt=tr[It],ft=Qt[0],dr=Qt[1];dr.length===1?O.push(pt(dr[0])):O.push(dr.map(pt)),O.push(this.outputs[outputIndex$1].serialize())}return O.push(this.otherwise.serialize()),O};var ko=function(C,O,Q){this.type=C,this.branches=O,this.otherwise=Q};ko.parse=function(C,O){if(C.length<4)return O.error("Expected at least 3 arguments, but found only "+(C.length-1)+".");if(C.length%2!==0)return O.error("Expected an odd number of arguments.");var Q;O.expectedType&&O.expectedType.kind!=="value"&&(Q=O.expectedType);for(var he=[],me=1;me<C.length-1;me+=2){var we=O.parse(C[me],me,gn);if(!we)return null;var Re=O.parse(C[me+1],me+1,Q);if(!Re)return null;he.push([we,Re]),Q=Q||Re.type}var $e=O.parse(C[C.length-1],C.length-1,Q);return $e?new ko(Q,he,$e):null},ko.prototype.evaluate=function(C){for(var O=0,Q=this.branches;O<Q.length;O+=1){var he=Q[O],me=he[0],we=he[1];if(me.evaluate(C))return we.evaluate(C)}return this.otherwise.evaluate(C)},ko.prototype.eachChild=function(C){for(var O=0,Q=this.branches;O<Q.length;O+=1){var he=Q[O],me=he[0],we=he[1];C(me),C(we)}C(this.otherwise)},ko.prototype.outputDefined=function(){return this.branches.every(function(C){C[0];var O=C[1];return O.outputDefined()})&&this.otherwise.outputDefined()},ko.prototype.serialize=function(){var C=["case"];return this.eachChild(function(O){C.push(O.serialize())}),C};var os=function(C,O,Q,he){this.type=C,this.input=O,this.beginIndex=Q,this.endIndex=he};os.parse=function(C,O){if(C.length<=2||C.length>=5)return O.error("Expected 3 or 4 arguments, but found "+(C.length-1)+" instead.");var Q=O.parse(C[1],1,_n),he=O.parse(C[2],2,yr);if(!Q||!he)return null;if(!jo(Q.type,[sa(_n),zr,_n]))return O.error("Expected first argument to be of type array or string, but found "+Aa(Q.type)+" instead");if(C.length===4){var me=O.parse(C[3],3,yr);return me?new os(Q.type,Q,he,me):null}else return new os(Q.type,Q,he)},os.prototype.evaluate=function(C){var O=this.input.evaluate(C),Q=this.beginIndex.evaluate(C);if(!rl(O,["string","array"]))throw new Fi("Expected first argument to be of type array or string, but found "+Aa(Di(O))+" instead.");if(this.endIndex){var he=this.endIndex.evaluate(C);return O.slice(Q,he)}return O.slice(Q)},os.prototype.eachChild=function(C){C(this.input),C(this.beginIndex),this.endIndex&&C(this.endIndex)},os.prototype.outputDefined=function(){return!1},os.prototype.serialize=function(){if(this.endIndex!=null&&this.endIndex!==void 0){var C=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),C]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};function hu(E,C){return E==="=="||E==="!="?C.kind==="boolean"||C.kind==="string"||C.kind==="number"||C.kind==="null"||C.kind==="value":C.kind==="string"||C.kind==="number"||C.kind==="value"}function Fl(E,C,O){return C===O}function vu(E,C,O){return C!==O}function gt(E,C,O){return C<O}function zt(E,C,O){return C>O}function cr(E,C,O){return C<=O}function or(E,C,O){return C>=O}function Rr(E,C,O,Q){return Q.compare(C,O)===0}function tn(E,C,O,Q){return!Rr(E,C,O,Q)}function dn(E,C,O,Q){return Q.compare(C,O)<0}function Mn(E,C,O,Q){return Q.compare(C,O)>0}function Ln(E,C,O,Q){return Q.compare(C,O)<=0}function Nn(E,C,O,Q){return Q.compare(C,O)>=0}function yn(E,C,O){var Q=E!=="=="&&E!=="!=";return function(){function he(me,we,Re){this.type=gn,this.lhs=me,this.rhs=we,this.collator=Re,this.hasUntypedArgument=me.type.kind==="value"||we.type.kind==="value"}return he.parse=function(we,Re){if(we.length!==3&&we.length!==4)return Re.error("Expected two or three arguments.");var $e=we[0],ft=Re.parse(we[1],1,_n);if(!ft)return null;if(!hu($e,ft.type))return Re.concat(1).error('"'+$e+`" comparisons are not supported for type '`+Aa(ft.type)+"'.");var pt=Re.parse(we[2],2,_n);if(!pt)return null;if(!hu($e,pt.type))return Re.concat(2).error('"'+$e+`" comparisons are not supported for type '`+Aa(pt.type)+"'.");if(ft.type.kind!==pt.type.kind&&ft.type.kind!=="value"&&pt.type.kind!=="value")return Re.error("Cannot compare types '"+Aa(ft.type)+"' and '"+Aa(pt.type)+"'.");Q&&(ft.type.kind==="value"&&pt.type.kind!=="value"?ft=new Ji(pt.type,[ft]):ft.type.kind!=="value"&&pt.type.kind==="value"&&(pt=new Ji(ft.type,[pt])));var It=null;if(we.length===4){if(ft.type.kind!=="string"&&pt.type.kind!=="string"&&ft.type.kind!=="value"&&pt.type.kind!=="value")return Re.error("Cannot use collator to compare non-string types.");if(It=Re.parse(we[3],3,aa),!It)return null}return new he(ft,pt,It)},he.prototype.evaluate=function(we){var Re=this.lhs.evaluate(we),$e=this.rhs.evaluate(we);if(Q&&this.hasUntypedArgument){var ft=Di(Re),pt=Di($e);if(ft.kind!==pt.kind||!(ft.kind==="string"||ft.kind==="number"))throw new Fi('Expected arguments for "'+E+'" to be (string, string) or (number, number), but found ('+ft.kind+", "+pt.kind+") instead.")}if(this.collator&&!Q&&this.hasUntypedArgument){var It=Di(Re),tr=Di($e);if(It.kind!=="string"||tr.kind!=="string")return C(we,Re,$e)}return this.collator?O(we,Re,$e,this.collator.evaluate(we)):C(we,Re,$e)},he.prototype.eachChild=function(we){we(this.lhs),we(this.rhs),this.collator&&we(this.collator)},he.prototype.outputDefined=function(){return!0},he.prototype.serialize=function(){var we=[E];return this.eachChild(function(Re){we.push(Re.serialize())}),we},he}()}var zn=yn("==",Fl,Rr),Pn=yn("!=",vu,tn),Vn=yn("<",gt,dn),$n=yn(">",zt,Mn),za=yn("<=",cr,Ln),ka=yn(">=",or,Nn),Fa=function(C,O,Q,he,me){this.type=zr,this.number=C,this.locale=O,this.currency=Q,this.minFractionDigits=he,this.maxFractionDigits=me};Fa.parse=function(C,O){if(C.length!==3)return O.error("Expected two arguments.");var Q=O.parse(C[1],1,yr);if(!Q)return null;var he=C[2];if(typeof he!="object"||Array.isArray(he))return O.error("NumberFormat options argument must be an object.");var me=null;if(he.locale&&(me=O.parse(he.locale,1,zr),!me))return null;var we=null;if(he.currency&&(we=O.parse(he.currency,1,zr),!we))return null;var Re=null;if(he["min-fraction-digits"]&&(Re=O.parse(he["min-fraction-digits"],1,yr),!Re))return null;var $e=null;return he["max-fraction-digits"]&&($e=O.parse(he["max-fraction-digits"],1,yr),!$e)?null:new Fa(Q,me,we,Re,$e)},Fa.prototype.evaluate=function(C){return new Intl.NumberFormat(this.locale?this.locale.evaluate(C):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(C):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(C):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(C):void 0}).format(this.number.evaluate(C))},Fa.prototype.eachChild=function(C){C(this.number),this.locale&&C(this.locale),this.currency&&C(this.currency),this.minFractionDigits&&C(this.minFractionDigits),this.maxFractionDigits&&C(this.maxFractionDigits)},Fa.prototype.outputDefined=function(){return!1},Fa.prototype.serialize=function(){var C={};return this.locale&&(C.locale=this.locale.serialize()),this.currency&&(C.currency=this.currency.serialize()),this.minFractionDigits&&(C["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(C["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),C]};var Oa=function(C){this.type=yr,this.input=C};Oa.parse=function(C,O){if(C.length!==2)return O.error("Expected 1 argument, but found "+(C.length-1)+" instead.");var Q=O.parse(C[1],1);return Q?Q.type.kind!=="array"&&Q.type.kind!=="string"&&Q.type.kind!=="value"?O.error("Expected argument of type string or array, but found "+Aa(Q.type)+" instead."):new Oa(Q):null},Oa.prototype.evaluate=function(C){var O=this.input.evaluate(C);if(typeof O=="string")return O.length;if(Array.isArray(O))return O.length;throw new Fi("Expected value to be of type string or array, but found "+Aa(Di(O))+" instead.")},Oa.prototype.eachChild=function(C){C(this.input)},Oa.prototype.outputDefined=function(){return!1},Oa.prototype.serialize=function(){var C=["length"];return this.eachChild(function(O){C.push(O.serialize())}),C};var Jn={"==":zn,"!=":Pn,">":$n,"<":Vn,">=":ka,"<=":za,array:Ji,at:Fs,boolean:Ji,case:ko,coalesce:as,collator:Is,format:ts,image:Gs,in:Ms,"index-of":is,interpolate:so,"interpolate-hcl":so,"interpolate-lab":so,length:Oa,let:zs,literal:Ki,match:Hi,number:Ji,"number-format":Fa,object:Ji,slice:os,step:As,string:Ji,"to-boolean":Ko,"to-color":Ko,"to-number":Ko,"to-string":Ko,var:ds,within:Jo};function ha(E,C){var O=C[0],Q=C[1],he=C[2],me=C[3];O=O.evaluate(E),Q=Q.evaluate(E),he=he.evaluate(E);var we=me?me.evaluate(E):1,Re=pl(O,Q,he,we);if(Re)throw new Fi(Re);return new vi(O/255*we,Q/255*we,he/255*we,we)}function Ga(E,C){return E in C}function Qa(E,C){var O=C[E];return typeof O>"u"?null:O}function di(E,C,O,Q){for(;O<=Q;){var he=O+Q>>1;if(C[he]===E)return!0;C[he]>E?Q=he-1:O=he+1}return!1}function gi(E){return{type:E}}Mo.register(Jn,{error:[jn,[zr],function(E,C){var O=C[0];throw new Fi(O.evaluate(E))}],typeof:[zr,[_n],function(E,C){var O=C[0];return Aa(Di(O.evaluate(E)))}],"to-rgba":[sa(yr,4),[On],function(E,C){var O=C[0];return O.evaluate(E).toArray()}],rgb:[On,[yr,yr,yr],ha],rgba:[On,[yr,yr,yr,yr],ha],has:{type:gn,overloads:[[[zr],function(E,C){var O=C[0];return Ga(O.evaluate(E),E.properties())}],[[zr,ta],function(E,C){var O=C[0],Q=C[1];return Ga(O.evaluate(E),Q.evaluate(E))}]]},get:{type:_n,overloads:[[[zr],function(E,C){var O=C[0];return Qa(O.evaluate(E),E.properties())}],[[zr,ta],function(E,C){var O=C[0],Q=C[1];return Qa(O.evaluate(E),Q.evaluate(E))}]]},"feature-state":[_n,[zr],function(E,C){var O=C[0];return Qa(O.evaluate(E),E.featureState||{})}],properties:[ta,[],function(E){return E.properties()}],"geometry-type":[zr,[],function(E){return E.geometryType()}],id:[_n,[],function(E){return E.id()}],zoom:[yr,[],function(E){return E.globals.zoom}],"heatmap-density":[yr,[],function(E){return E.globals.heatmapDensity||0}],"line-progress":[yr,[],function(E){return E.globals.lineProgress||0}],accumulated:[_n,[],function(E){return E.globals.accumulated===void 0?null:E.globals.accumulated}],"+":[yr,gi(yr),function(E,C){for(var O=0,Q=0,he=C;Q<he.length;Q+=1){var me=he[Q];O+=me.evaluate(E)}return O}],"*":[yr,gi(yr),function(E,C){for(var O=1,Q=0,he=C;Q<he.length;Q+=1){var me=he[Q];O*=me.evaluate(E)}return O}],"-":{type:yr,overloads:[[[yr,yr],function(E,C){var O=C[0],Q=C[1];return O.evaluate(E)-Q.evaluate(E)}],[[yr],function(E,C){var O=C[0];return-O.evaluate(E)}]]},"/":[yr,[yr,yr],function(E,C){var O=C[0],Q=C[1];return O.evaluate(E)/Q.evaluate(E)}],"%":[yr,[yr,yr],function(E,C){var O=C[0],Q=C[1];return O.evaluate(E)%Q.evaluate(E)}],ln2:[yr,[],function(){return Math.LN2}],pi:[yr,[],function(){return Math.PI}],e:[yr,[],function(){return Math.E}],"^":[yr,[yr,yr],function(E,C){var O=C[0],Q=C[1];return Math.pow(O.evaluate(E),Q.evaluate(E))}],sqrt:[yr,[yr],function(E,C){var O=C[0];return Math.sqrt(O.evaluate(E))}],log10:[yr,[yr],function(E,C){var O=C[0];return Math.log(O.evaluate(E))/Math.LN10}],ln:[yr,[yr],function(E,C){var O=C[0];return Math.log(O.evaluate(E))}],log2:[yr,[yr],function(E,C){var O=C[0];return Math.log(O.evaluate(E))/Math.LN2}],sin:[yr,[yr],function(E,C){var O=C[0];return Math.sin(O.evaluate(E))}],cos:[yr,[yr],function(E,C){var O=C[0];return Math.cos(O.evaluate(E))}],tan:[yr,[yr],function(E,C){var O=C[0];return Math.tan(O.evaluate(E))}],asin:[yr,[yr],function(E,C){var O=C[0];return Math.asin(O.evaluate(E))}],acos:[yr,[yr],function(E,C){var O=C[0];return Math.acos(O.evaluate(E))}],atan:[yr,[yr],function(E,C){var O=C[0];return Math.atan(O.evaluate(E))}],min:[yr,gi(yr),function(E,C){return Math.min.apply(Math,C.map(function(O){return O.evaluate(E)}))}],max:[yr,gi(yr),function(E,C){return Math.max.apply(Math,C.map(function(O){return O.evaluate(E)}))}],abs:[yr,[yr],function(E,C){var O=C[0];return Math.abs(O.evaluate(E))}],round:[yr,[yr],function(E,C){var O=C[0],Q=O.evaluate(E);return Q<0?-Math.round(-Q):Math.round(Q)}],floor:[yr,[yr],function(E,C){var O=C[0];return Math.floor(O.evaluate(E))}],ceil:[yr,[yr],function(E,C){var O=C[0];return Math.ceil(O.evaluate(E))}],"filter-==":[gn,[zr,_n],function(E,C){var O=C[0],Q=C[1];return E.properties()[O.value]===Q.value}],"filter-id-==":[gn,[_n],function(E,C){var O=C[0];return E.id()===O.value}],"filter-type-==":[gn,[zr],function(E,C){var O=C[0];return E.geometryType()===O.value}],"filter-<":[gn,[zr,_n],function(E,C){var O=C[0],Q=C[1],he=E.properties()[O.value],me=Q.value;return typeof he==typeof me&&he<me}],"filter-id-<":[gn,[_n],function(E,C){var O=C[0],Q=E.id(),he=O.value;return typeof Q==typeof he&&Q<he}],"filter->":[gn,[zr,_n],function(E,C){var O=C[0],Q=C[1],he=E.properties()[O.value],me=Q.value;return typeof he==typeof me&&he>me}],"filter-id->":[gn,[_n],function(E,C){var O=C[0],Q=E.id(),he=O.value;return typeof Q==typeof he&&Q>he}],"filter-<=":[gn,[zr,_n],function(E,C){var O=C[0],Q=C[1],he=E.properties()[O.value],me=Q.value;return typeof he==typeof me&&he<=me}],"filter-id-<=":[gn,[_n],function(E,C){var O=C[0],Q=E.id(),he=O.value;return typeof Q==typeof he&&Q<=he}],"filter->=":[gn,[zr,_n],function(E,C){var O=C[0],Q=C[1],he=E.properties()[O.value],me=Q.value;return typeof he==typeof me&&he>=me}],"filter-id->=":[gn,[_n],function(E,C){var O=C[0],Q=E.id(),he=O.value;return typeof Q==typeof he&&Q>=he}],"filter-has":[gn,[_n],function(E,C){var O=C[0];return O.value in E.properties()}],"filter-has-id":[gn,[],function(E){return E.id()!==null&&E.id()!==void 0}],"filter-type-in":[gn,[sa(zr)],function(E,C){var O=C[0];return O.value.indexOf(E.geometryType())>=0}],"filter-id-in":[gn,[sa(_n)],function(E,C){var O=C[0];return O.value.indexOf(E.id())>=0}],"filter-in-small":[gn,[zr,sa(_n)],function(E,C){var O=C[0],Q=C[1];return Q.value.indexOf(E.properties()[O.value])>=0}],"filter-in-large":[gn,[zr,sa(_n)],function(E,C){var O=C[0],Q=C[1];return di(E.properties()[O.value],Q.value,0,Q.value.length-1)}],all:{type:gn,overloads:[[[gn,gn],function(E,C){var O=C[0],Q=C[1];return O.evaluate(E)&&Q.evaluate(E)}],[gi(gn),function(E,C){for(var O=0,Q=C;O<Q.length;O+=1){var he=Q[O];if(!he.evaluate(E))return!1}return!0}]]},any:{type:gn,overloads:[[[gn,gn],function(E,C){var O=C[0],Q=C[1];return O.evaluate(E)||Q.evaluate(E)}],[gi(gn),function(E,C){for(var O=0,Q=C;O<Q.length;O+=1){var he=Q[O];if(he.evaluate(E))return!0}return!1}]]},"!":[gn,[gn],function(E,C){var O=C[0];return!O.evaluate(E)}],"is-supported-script":[gn,[zr],function(E,C){var O=C[0],Q=E.globals&&E.globals.isSupportedScript;return Q?Q(O.evaluate(E)):!0}],upcase:[zr,[zr],function(E,C){var O=C[0];return O.evaluate(E).toUpperCase()}],downcase:[zr,[zr],function(E,C){var O=C[0];return O.evaluate(E).toLowerCase()}],concat:[zr,gi(_n),function(E,C){return C.map(function(O){return nl(O.evaluate(E))}).join("")}],"resolved-locale":[zr,[aa],function(E,C){var O=C[0];return O.evaluate(E).resolvedLocale()}]});function mi(E){return{result:"success",value:E}}function Ai(E){return{result:"error",value:E}}function oi(E){return E["property-type"]==="data-driven"||E["property-type"]==="cross-faded-data-driven"}function yo(E){return!!E.expression&&E.expression.parameters.indexOf("zoom")>-1}function qi(E){return!!E.expression&&E.expression.interpolated}function Ja(E){return E instanceof Number?"number":E instanceof String?"string":E instanceof Boolean?"boolean":Array.isArray(E)?"array":E===null?"null":typeof E}function va(E){return typeof E=="object"&&E!==null&&!Array.isArray(E)}function xi(E){return E}function lo(E,C){var O=C.type==="color",Q=E.stops&&typeof E.stops[0][0]=="object",he=Q||E.property!==void 0,me=Q||!he,we=E.type||(qi(C)?"exponential":"interval");if(O&&(E=vn({},E),E.stops&&(E.stops=E.stops.map(function(na){return[na[0],vi.parse(na[1])]})),E.default?E.default=vi.parse(E.default):E.default=vi.parse(C.default)),E.colorSpace&&E.colorSpace!=="rgb"&&!Tl[E.colorSpace])throw new Error("Unknown color space: "+E.colorSpace);var Re,$e,ft;if(we==="exponential")Re=Io;else if(we==="interval")Re=Ss;else if(we==="categorical"){Re=ss,$e=Object.create(null);for(var pt=0,It=E.stops;pt<It.length;pt+=1){var tr=It[pt];$e[tr[0]]=tr[1]}ft=typeof E.stops[0][0]}else if(we==="identity")Re=Js;else throw new Error('Unknown function type "'+we+'"');if(Q){for(var Qt={},dr=[],Fr=0;Fr<E.stops.length;Fr++){var an=E.stops[Fr],$r=an[0].zoom;Qt[$r]===void 0&&(Qt[$r]={zoom:$r,type:E.type,property:E.property,default:E.default,stops:[]},dr.push($r)),Qt[$r].stops.push([an[0].value,an[1]])}for(var kn=[],mn=0,Sn=dr;mn<Sn.length;mn+=1){var In=Sn[mn];kn.push([Qt[In].zoom,lo(Qt[In],C)])}var Gn={name:"linear"};return{kind:"composite",interpolationType:Gn,interpolationFactor:so.interpolationFactor.bind(void 0,Gn),zoomStops:kn.map(function(na){return na[0]}),evaluate:function(Ra,wa){var Ma=Ra.zoom;return Io({stops:kn,base:E.base},C,Ma).evaluate(Ma,wa)}}}else if(me){var oa=we==="exponential"?{name:"exponential",base:E.base!==void 0?E.base:1}:null;return{kind:"camera",interpolationType:oa,interpolationFactor:so.interpolationFactor.bind(void 0,oa),zoomStops:E.stops.map(function(na){return na[0]}),evaluate:function(na){var Ra=na.zoom;return Re(E,C,Ra,$e,ft)}}}else return{kind:"source",evaluate:function(Ra,wa){var Ma=wa&&wa.properties?wa.properties[E.property]:void 0;return Ma===void 0?vo(E.default,C.default):Re(E,C,Ma,$e,ft)}}}function vo(E,C,O){if(E!==void 0)return E;if(C!==void 0)return C;if(O!==void 0)return O}function ss(E,C,O,Q,he){var me=typeof O===he?Q[O]:void 0;return vo(me,E.default,C.default)}function Ss(E,C,O){if(Ja(O)!=="number")return vo(E.default,C.default);var Q=E.stops.length;if(Q===1||O<=E.stops[0][0])return E.stops[0][1];if(O>=E.stops[Q-1][0])return E.stops[Q-1][1];var he=Ts(E.stops.map(function(me){return me[0]}),O);return E.stops[he][1]}function Io(E,C,O){var Q=E.base!==void 0?E.base:1;if(Ja(O)!=="number")return vo(E.default,C.default);var he=E.stops.length;if(he===1||O<=E.stops[0][0])return E.stops[0][1];if(O>=E.stops[he-1][0])return E.stops[he-1][1];var me=Ts(E.stops.map(function(It){return It[0]}),O),we=ys(O,Q,E.stops[me][0],E.stops[me+1][0]),Re=E.stops[me][1],$e=E.stops[me+1][1],ft=Xs[C.type]||xi;if(E.colorSpace&&E.colorSpace!=="rgb"){var pt=Tl[E.colorSpace];ft=function(It,tr){return pt.reverse(pt.interpolate(pt.forward(It),pt.forward(tr),we))}}return typeof Re.evaluate=="function"?{evaluate:function(){for(var tr=[],Qt=arguments.length;Qt--;)tr[Qt]=arguments[Qt];var dr=Re.evaluate.apply(void 0,tr),Fr=$e.evaluate.apply(void 0,tr);if(!(dr===void 0||Fr===void 0))return ft(dr,Fr,we)}}:ft(Re,$e,we)}function Js(E,C,O){return C.type==="color"?O=vi.parse(O):C.type==="formatted"?O=Ui.fromString(O.toString()):C.type==="resolvedImage"?O=Ao.fromString(O.toString()):Ja(O)!==C.type&&(C.type!=="enum"||!C.values[O])&&(O=void 0),vo(O,E.default,C.default)}function ys(E,C,O,Q){var he=Q-O,me=E-O;return he===0?0:C===1?me/he:(Math.pow(C,me)-1)/(Math.pow(C,he)-1)}var ls=function(C,O){this.expression=C,this._warningHistory={},this._evaluator=new Rs,this._defaultValue=O?Du(O):null,this._enumValues=O&&O.type==="enum"?O.values:null};ls.prototype.evaluateWithoutErrorHandling=function(C,O,Q,he,me,we){return this._evaluator.globals=C,this._evaluator.feature=O,this._evaluator.featureState=Q,this._evaluator.canonical=he,this._evaluator.availableImages=me||null,this._evaluator.formattedSection=we,this.expression.evaluate(this._evaluator)},ls.prototype.evaluate=function(C,O,Q,he,me,we){this._evaluator.globals=C,this._evaluator.feature=O||null,this._evaluator.featureState=Q||null,this._evaluator.canonical=he,this._evaluator.availableImages=me||null,this._evaluator.formattedSection=we||null;try{var Re=this.expression.evaluate(this._evaluator);if(Re==null||typeof Re=="number"&&Re!==Re)return this._defaultValue;if(this._enumValues&&!(Re in this._enumValues))throw new Fi("Expected value to be one of "+Object.keys(this._enumValues).map(function($e){return JSON.stringify($e)}).join(", ")+", but found "+JSON.stringify(Re)+" instead.");return Re}catch($e){return this._warningHistory[$e.message]||(this._warningHistory[$e.message]=!0,typeof console<"u"&&console.warn($e.message)),this._defaultValue}};function mo(E){return Array.isArray(E)&&E.length>0&&typeof E[0]=="string"&&E[0]in Jn}function Ol(E,C){var O=new So(Jn,[],C?du(C):void 0),Q=O.parse(E,void 0,void 0,void 0,C&&C.type==="string"?{typeAnnotation:"coerce"}:void 0);return Q?mi(new ls(Q,C)):Ai(O.errors)}var Jl=function(C,O){this.kind=C,this._styleExpression=O,this.isStateDependent=C!=="constant"&&!ol(O.expression)};Jl.prototype.evaluateWithoutErrorHandling=function(C,O,Q,he,me,we){return this._styleExpression.evaluateWithoutErrorHandling(C,O,Q,he,me,we)},Jl.prototype.evaluate=function(C,O,Q,he,me,we){return this._styleExpression.evaluate(C,O,Q,he,me,we)};var us=function(C,O,Q,he){this.kind=C,this.zoomStops=Q,this._styleExpression=O,this.isStateDependent=C!=="camera"&&!ol(O.expression),this.interpolationType=he};us.prototype.evaluateWithoutErrorHandling=function(C,O,Q,he,me,we){return this._styleExpression.evaluateWithoutErrorHandling(C,O,Q,he,me,we)},us.prototype.evaluate=function(C,O,Q,he,me,we){return this._styleExpression.evaluate(C,O,Q,he,me,we)},us.prototype.interpolationFactor=function(C,O,Q){return this.interpolationType?so.interpolationFactor(this.interpolationType,C,O,Q):0};function pu(E,C){if(E=Ol(E,C),E.result==="error")return E;var O=E.value.expression,Q=il(O);if(!Q&&!oi(C))return Ai([new xn("","data expressions not supported")]);var he=jl(O,["zoom"]);if(!he&&!yo(C))return Ai([new xn("","zoom expressions not supported")]);var me=Pu(O);if(!me&&!he)return Ai([new xn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')]);if(me instanceof xn)return Ai([me]);if(me instanceof so&&!qi(C))return Ai([new xn("",'"interpolate" expressions cannot be used with this property')]);if(!me)return mi(Q?new Jl("constant",E.value):new Jl("source",E.value));var we=me instanceof so?me.interpolation:void 0;return mi(Q?new us("camera",E.value,me.labels,we):new us("composite",E.value,me.labels,we))}var Bl=function(C,O){this._parameters=C,this._specification=O,vn(this,lo(this._parameters,this._specification))};Bl.deserialize=function(C){return new Bl(C._parameters,C._specification)},Bl.serialize=function(C){return{_parameters:C._parameters,_specification:C._specification}};function vf(E,C){if(va(E))return new Bl(E,C);if(mo(E)){var O=pu(E,C);if(O.result==="error")throw new Error(O.value.map(function(he){return he.key+": "+he.message}).join(", "));return O.value}else{var Q=E;return typeof E=="string"&&C.type==="color"&&(Q=vi.parse(E)),{kind:"constant",evaluate:function(){return Q}}}}function Pu(E){var C=null;if(E instanceof zs)C=Pu(E.result);else if(E instanceof as)for(var O=0,Q=E.args;O<Q.length;O+=1){var he=Q[O];if(C=Pu(he),C)break}else(E instanceof As||E instanceof so)&&E.input instanceof Mo&&E.input.name==="zoom"&&(C=E);return C instanceof xn||E.eachChild(function(me){var we=Pu(me);we instanceof xn?C=we:!C&&we?C=new xn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):C&&we&&C!==we&&(C=new xn("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),C}function du(E){var C={color:On,string:zr,number:yr,enum:zr,boolean:gn,formatted:pa,resolvedImage:ma};return E.type==="array"?sa(C[E.value]||_n,E.length):C[E.type]}function Du(E){return E.type==="color"&&va(E.default)?new vi(0,0,0,0):E.type==="color"?vi.parse(E.default)||null:E.default===void 0?null:E.default}function ks(E){var C=E.key,O=E.value,Q=E.valueSpec||{},he=E.objectElementValidators||{},me=E.style,we=E.styleSpec,Re=[],$e=Ja(O);if($e!=="object")return[new hr(C,O,"object expected, "+$e+" found")];for(var ft in O){var pt=ft.split(".")[0],It=Q[pt]||Q["*"],tr=void 0;if(he[pt])tr=he[pt];else if(Q[pt])tr=hi;else if(he["*"])tr=he["*"];else if(Q["*"])tr=hi;else{Re.push(new hr(C,O[ft],'unknown property "'+ft+'"'));continue}Re=Re.concat(tr({key:(C&&C+".")+ft,value:O[ft],valueSpec:It,style:me,styleSpec:we,object:O,objectKey:ft},O))}for(var Qt in Q)he[Qt]||Q[Qt].required&&Q[Qt].default===void 0&&O[Qt]===void 0&&Re.push(new hr(C,O,'missing required property "'+Qt+'"'));return Re}function Xu(E){var C=E.value,O=E.valueSpec,Q=E.style,he=E.styleSpec,me=E.key,we=E.arrayElementValidator||hi;if(Ja(C)!=="array")return[new hr(me,C,"array expected, "+Ja(C)+" found")];if(O.length&&C.length!==O.length)return[new hr(me,C,"array length "+O.length+" expected, length "+C.length+" found")];if(O["min-length"]&&C.length<O["min-length"])return[new hr(me,C,"array length at least "+O["min-length"]+" expected, length "+C.length+" found")];var Re={type:O.value,values:O.values};he.$version<7&&(Re.function=O.function),Ja(O.value)==="object"&&(Re=O.value);for(var $e=[],ft=0;ft<C.length;ft++)$e=$e.concat(we({array:C,arrayIndex:ft,value:C[ft],valueSpec:Re,style:Q,styleSpec:he,key:me+"["+ft+"]"}));return $e}function Ru(E){var C=E.key,O=E.value,Q=E.valueSpec,he=Ja(O);return he==="number"&&O!==O&&(he="NaN"),he!=="number"?[new hr(C,O,"number expected, "+he+" found")]:"minimum"in Q&&O<Q.minimum?[new hr(C,O,O+" is less than the minimum value "+Q.minimum)]:"maximum"in Q&&O>Q.maximum?[new hr(C,O,O+" is greater than the maximum value "+Q.maximum)]:[]}function Iu(E){var C=E.valueSpec,O=en(E.value.type),Q,he={},me,we,Re=O!=="categorical"&&E.value.property===void 0,$e=!Re,ft=Ja(E.value.stops)==="array"&&Ja(E.value.stops[0])==="array"&&Ja(E.value.stops[0][0])==="object",pt=ks({key:E.key,value:E.value,valueSpec:E.styleSpec.function,style:E.style,styleSpec:E.styleSpec,objectElementValidators:{stops:It,default:dr}});return O==="identity"&&Re&&pt.push(new hr(E.key,E.value,'missing required property "property"')),O!=="identity"&&!E.value.stops&&pt.push(new hr(E.key,E.value,'missing required property "stops"')),O==="exponential"&&E.valueSpec.expression&&!qi(E.valueSpec)&&pt.push(new hr(E.key,E.value,"exponential functions not supported")),E.styleSpec.$version>=8&&($e&&!oi(E.valueSpec)?pt.push(new hr(E.key,E.value,"property functions not supported")):Re&&!yo(E.valueSpec)&&pt.push(new hr(E.key,E.value,"zoom functions not supported"))),(O==="categorical"||ft)&&E.value.property===void 0&&pt.push(new hr(E.key,E.value,'"property" property is required')),pt;function It(Fr){if(O==="identity")return[new hr(Fr.key,Fr.value,'identity function may not have a "stops" property')];var an=[],$r=Fr.value;return an=an.concat(Xu({key:Fr.key,value:$r,valueSpec:Fr.valueSpec,style:Fr.style,styleSpec:Fr.styleSpec,arrayElementValidator:tr})),Ja($r)==="array"&&$r.length===0&&an.push(new hr(Fr.key,$r,"array must have at least one stop")),an}function tr(Fr){var an=[],$r=Fr.value,kn=Fr.key;if(Ja($r)!=="array")return[new hr(kn,$r,"array expected, "+Ja($r)+" found")];if($r.length!==2)return[new hr(kn,$r,"array length 2 expected, length "+$r.length+" found")];if(ft){if(Ja($r[0])!=="object")return[new hr(kn,$r,"object expected, "+Ja($r[0])+" found")];if($r[0].zoom===void 0)return[new hr(kn,$r,"object stop key must have zoom")];if($r[0].value===void 0)return[new hr(kn,$r,"object stop key must have value")];if(we&&we>en($r[0].zoom))return[new hr(kn,$r[0].zoom,"stop zoom values must appear in ascending order")];en($r[0].zoom)!==we&&(we=en($r[0].zoom),me=void 0,he={}),an=an.concat(ks({key:kn+"[0]",value:$r[0],valueSpec:{zoom:{}},style:Fr.style,styleSpec:Fr.styleSpec,objectElementValidators:{zoom:Ru,value:Qt}}))}else an=an.concat(Qt({key:kn+"[0]",value:$r[0],valueSpec:{},style:Fr.style,styleSpec:Fr.styleSpec},$r));return mo(Tn($r[1]))?an.concat([new hr(kn+"[1]",$r[1],"expressions are not allowed in function stops.")]):an.concat(hi({key:kn+"[1]",value:$r[1],valueSpec:C,style:Fr.style,styleSpec:Fr.styleSpec}))}function Qt(Fr,an){var $r=Ja(Fr.value),kn=en(Fr.value),mn=Fr.value!==null?Fr.value:an;if(!Q)Q=$r;else if($r!==Q)return[new hr(Fr.key,mn,$r+" stop domain type must match previous stop domain type "+Q)];if($r!=="number"&&$r!=="string"&&$r!=="boolean")return[new hr(Fr.key,mn,"stop domain value must be a number, string, or boolean")];if($r!=="number"&&O!=="categorical"){var Sn="number expected, "+$r+" found";return oi(C)&&O===void 0&&(Sn+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new hr(Fr.key,mn,Sn)]}return O==="categorical"&&$r==="number"&&(!isFinite(kn)||Math.floor(kn)!==kn)?[new hr(Fr.key,mn,"integer expected, found "+kn)]:O!=="categorical"&&$r==="number"&&me!==void 0&&kn<me?[new hr(Fr.key,mn,"stop domain values must appear in ascending order")]:(me=kn,O==="categorical"&&kn in he?[new hr(Fr.key,mn,"stop domain values must be unique")]:(he[kn]=!0,[]))}function dr(Fr){return hi({key:Fr.key,value:Fr.value,valueSpec:C,style:Fr.style,styleSpec:Fr.styleSpec})}}function zo(E){var C=(E.expressionContext==="property"?pu:Ol)(Tn(E.value),E.valueSpec);if(C.result==="error")return C.value.map(function(Q){return new hr(""+E.key+Q.key,E.value,Q.message)});var O=C.value.expression||C.value._styleExpression.expression;if(E.expressionContext==="property"&&E.propertyKey==="text-font"&&!O.outputDefined())return[new hr(E.key,E.value,'Invalid data expression for "'+E.propertyKey+'". Output values must be contained as literals within the expression.')];if(E.expressionContext==="property"&&E.propertyType==="layout"&&!ol(O))return[new hr(E.key,E.value,'"feature-state" data expressions are not supported with layout properties.')];if(E.expressionContext==="filter"&&!ol(O))return[new hr(E.key,E.value,'"feature-state" data expressions are not supported with filters.')];if(E.expressionContext&&E.expressionContext.indexOf("cluster")===0){if(!jl(O,["zoom","feature-state"]))return[new hr(E.key,E.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(E.expressionContext==="cluster-initial"&&!il(O))return[new hr(E.key,E.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function zu(E){var C=E.value,O=E.key,Q=Ja(C);return Q!=="boolean"?[new hr(O,C,"boolean expected, "+Q+" found")]:[]}function $u(E){var C=E.key,O=E.value,Q=Ja(O);return Q!=="string"?[new hr(C,O,"color expected, "+Q+" found")]:Gl(O)===null?[new hr(C,O,'color expected, "'+O+'" found')]:[]}function ms(E){var C=E.key,O=E.value,Q=E.valueSpec,he=[];return Array.isArray(Q.values)?Q.values.indexOf(en(O))===-1&&he.push(new hr(C,O,"expected one of ["+Q.values.join(", ")+"], "+JSON.stringify(O)+" found")):Object.keys(Q.values).indexOf(en(O))===-1&&he.push(new hr(C,O,"expected one of ["+Object.keys(Q.values).join(", ")+"], "+JSON.stringify(O)+" found")),he}function gu(E){if(E===!0||E===!1)return!0;if(!Array.isArray(E)||E.length===0)return!1;switch(E[0]){case"has":return E.length>=2&&E[1]!=="$id"&&E[1]!=="$type";case"in":return E.length>=3&&(typeof E[1]!="string"||Array.isArray(E[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return E.length!==3||Array.isArray(E[1])||Array.isArray(E[2]);case"any":case"all":for(var C=0,O=E.slice(1);C<O.length;C+=1){var Q=O[C];if(!gu(Q)&&typeof Q!="boolean")return!1}return!0;default:return!0}}var yu={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Fu(E){if(E==null)return{filter:function(){return!0},needGeometry:!1};gu(E)||(E=et(E));var C=Ol(E,yu);if(C.result==="error")throw new Error(C.value.map(function(Q){return Q.key+": "+Q.message}).join(", "));var O=We(E);return{filter:function(Q,he,me){return C.value.evaluate(Q,he,{},me)},needGeometry:O}}function De(E,C){return E<C?-1:E>C?1:0}function We(E){if(!Array.isArray(E))return!1;if(E[0]==="within")return!0;for(var C=1;C<E.length;C++)if(We(E[C]))return!0;return!1}function et(E){if(!E)return!0;var C=E[0];if(E.length<=1)return C!=="any";var O=C==="=="?ot(E[1],E[2],"=="):C==="!="?ur(ot(E[1],E[2],"==")):C==="<"||C===">"||C==="<="||C===">="?ot(E[1],E[2],C):C==="any"?bt(E.slice(1)):C==="all"?["all"].concat(E.slice(1).map(et)):C==="none"?["all"].concat(E.slice(1).map(et).map(ur)):C==="in"?yt(E[1],E.slice(2)):C==="!in"?ur(yt(E[1],E.slice(2))):C==="has"?Mt(E[1]):C==="!has"?ur(Mt(E[1])):C==="within"?E:!0;return O}function ot(E,C,O){switch(E){case"$type":return["filter-type-"+O,C];case"$id":return["filter-id-"+O,C];default:return["filter-"+O,E,C]}}function bt(E){return["any"].concat(E.map(et))}function yt(E,C){if(C.length===0)return!1;switch(E){case"$type":return["filter-type-in",["literal",C]];case"$id":return["filter-id-in",["literal",C]];default:return C.length>200&&!C.some(function(O){return typeof O!=typeof C[0]})?["filter-in-large",E,["literal",C.sort(De)]]:["filter-in-small",E,["literal",C]]}}function Mt(E){switch(E){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",E]}}function ur(E){return["!",E]}function pr(E){return gu(Tn(E.value))?zo(vn({},E,{expressionContext:"filter",valueSpec:{value:"boolean"}})):sr(E)}function sr(E){var C=E.value,O=E.key;if(Ja(C)!=="array")return[new hr(O,C,"array expected, "+Ja(C)+" found")];var Q=E.styleSpec,he,me=[];if(C.length<1)return[new hr(O,C,"filter array must have at least 1 element")];switch(me=me.concat(ms({key:O+"[0]",value:C[0],valueSpec:Q.filter_operator,style:E.style,styleSpec:E.styleSpec})),en(C[0])){case"<":case"<=":case">":case">=":C.length>=2&&en(C[1])==="$type"&&me.push(new hr(O,C,'"$type" cannot be use with operator "'+C[0]+'"'));case"==":case"!=":C.length!==3&&me.push(new hr(O,C,'filter array for operator "'+C[0]+'" must have 3 elements'));case"in":case"!in":C.length>=2&&(he=Ja(C[1]),he!=="string"&&me.push(new hr(O+"[1]",C[1],"string expected, "+he+" found")));for(var we=2;we<C.length;we++)he=Ja(C[we]),en(C[1])==="$type"?me=me.concat(ms({key:O+"["+we+"]",value:C[we],valueSpec:Q.geometry_type,style:E.style,styleSpec:E.styleSpec})):he!=="string"&&he!=="number"&&he!=="boolean"&&me.push(new hr(O+"["+we+"]",C[we],"string, number, or boolean expected, "+he+" found"));break;case"any":case"all":case"none":for(var Re=1;Re<C.length;Re++)me=me.concat(sr({key:O+"["+Re+"]",value:C[Re],style:E.style,styleSpec:E.styleSpec}));break;case"has":case"!has":he=Ja(C[1]),C.length!==2?me.push(new hr(O,C,'filter array for "'+C[0]+'" operator must have 2 elements')):he!=="string"&&me.push(new hr(O+"[1]",C[1],"string expected, "+he+" found"));break;case"within":he=Ja(C[1]),C.length!==2?me.push(new hr(O,C,'filter array for "'+C[0]+'" operator must have 2 elements')):he!=="object"&&me.push(new hr(O+"[1]",C[1],"object expected, "+he+" found"));break}return me}function xr(E,C){var O=E.key,Q=E.style,he=E.styleSpec,me=E.value,we=E.objectKey,Re=he[C+"_"+E.layerType];if(!Re)return[];var $e=we.match(/^(.*)-transition$/);if(C==="paint"&&$e&&Re[$e[1]]&&Re[$e[1]].transition)return hi({key:O,value:me,valueSpec:he.transition,style:Q,styleSpec:he});var ft=E.valueSpec||Re[we];if(!ft)return[new hr(O,me,'unknown property "'+we+'"')];var pt;if(Ja(me)==="string"&&oi(ft)&&!ft.tokens&&(pt=/^{([^}]+)}$/.exec(me)))return[new hr(O,me,'"'+we+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(pt[1])+" }`.")];var It=[];return E.layerType==="symbol"&&(we==="text-field"&&Q&&!Q.glyphs&&It.push(new hr(O,me,'use of "text-field" requires a style "glyphs" property')),we==="text-font"&&va(Tn(me))&&en(me.type)==="identity"&&It.push(new hr(O,me,'"text-font" does not support identity functions'))),It.concat(hi({key:E.key,value:me,valueSpec:ft,style:Q,styleSpec:he,expressionContext:"property",propertyType:C,propertyKey:we}))}function Dr(E){return xr(E,"paint")}function Xr(E){return xr(E,"layout")}function qr(E){var C=[],O=E.value,Q=E.key,he=E.style,me=E.styleSpec;!O.type&&!O.ref&&C.push(new hr(Q,O,'either "type" or "ref" is required'));var we=en(O.type),Re=en(O.ref);if(O.id)for(var $e=en(O.id),ft=0;ft<E.arrayIndex;ft++){var pt=he.layers[ft];en(pt.id)===$e&&C.push(new hr(Q,O.id,'duplicate layer id "'+O.id+'", previously used at line '+pt.id.__line__))}if("ref"in O){["type","source","source-layer","filter","layout"].forEach(function(dr){dr in O&&C.push(new hr(Q,O[dr],'"'+dr+'" is prohibited for ref layers'))});var It;he.layers.forEach(function(dr){en(dr.id)===Re&&(It=dr)}),It?It.ref?C.push(new hr(Q,O.ref,"ref cannot reference another ref layer")):we=en(It.type):C.push(new hr(Q,O.ref,'ref layer "'+Re+'" not found'))}else if(we!=="background")if(!O.source)C.push(new hr(Q,O,'missing required property "source"'));else{var tr=he.sources&&he.sources[O.source],Qt=tr&&en(tr.type);tr?Qt==="vector"&&we==="raster"?C.push(new hr(Q,O.source,'layer "'+O.id+'" requires a raster source')):Qt==="raster"&&we!=="raster"?C.push(new hr(Q,O.source,'layer "'+O.id+'" requires a vector source')):Qt==="vector"&&!O["source-layer"]?C.push(new hr(Q,O,'layer "'+O.id+'" must specify a "source-layer"')):Qt==="raster-dem"&&we!=="hillshade"?C.push(new hr(Q,O.source,"raster-dem source can only be used with layer type 'hillshade'.")):we==="line"&&O.paint&&O.paint["line-gradient"]&&(Qt!=="geojson"||!tr.lineMetrics)&&C.push(new hr(Q,O,'layer "'+O.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):C.push(new hr(Q,O.source,'source "'+O.source+'" not found'))}return C=C.concat(ks({key:Q,value:O,valueSpec:me.layer,style:E.style,styleSpec:E.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return hi({key:Q+".type",value:O.type,valueSpec:me.layer.type,style:E.style,styleSpec:E.styleSpec,object:O,objectKey:"type"})},filter:pr,layout:function(Fr){return ks({layer:O,key:Fr.key,value:Fr.value,style:Fr.style,styleSpec:Fr.styleSpec,objectElementValidators:{"*":function($r){return Xr(vn({layerType:we},$r))}}})},paint:function(Fr){return ks({layer:O,key:Fr.key,value:Fr.value,style:Fr.style,styleSpec:Fr.styleSpec,objectElementValidators:{"*":function($r){return Dr(vn({layerType:we},$r))}}})}}})),C}function bn(E){var C=E.value,O=E.key,Q=Ja(C);return Q!=="string"?[new hr(O,C,"string expected, "+Q+" found")]:[]}var Dn={promoteId:da};function Yn(E){var C=E.value,O=E.key,Q=E.styleSpec,he=E.style;if(!C.type)return[new hr(O,C,'"type" is required')];var me=en(C.type),we;switch(me){case"vector":case"raster":case"raster-dem":return we=ks({key:O,value:C,valueSpec:Q["source_"+me.replace("-","_")],style:E.style,styleSpec:Q,objectElementValidators:Dn}),we;case"geojson":if(we=ks({key:O,value:C,valueSpec:Q.source_geojson,style:he,styleSpec:Q,objectElementValidators:Dn}),C.cluster)for(var Re in C.clusterProperties){var $e=C.clusterProperties[Re],ft=$e[0],pt=$e[1],It=typeof ft=="string"?[ft,["accumulated"],["get",Re]]:ft;we.push.apply(we,zo({key:O+"."+Re+".map",value:pt,expressionContext:"cluster-map"})),we.push.apply(we,zo({key:O+"."+Re+".reduce",value:It,expressionContext:"cluster-reduce"}))}return we;case"video":return ks({key:O,value:C,valueSpec:Q.source_video,style:he,styleSpec:Q});case"image":return ks({key:O,value:C,valueSpec:Q.source_image,style:he,styleSpec:Q});case"canvas":return[new hr(O,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return ms({key:O+".type",value:C.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:he,styleSpec:Q})}}function da(E){var C=E.key,O=E.value;if(Ja(O)==="string")return bn({key:C,value:O});var Q=[];for(var he in O)Q.push.apply(Q,bn({key:C+"."+he,value:O[he]}));return Q}function xa(E){var C=E.value,O=E.styleSpec,Q=O.light,he=E.style,me=[],we=Ja(C);if(C===void 0)return me;if(we!=="object")return me=me.concat([new hr("light",C,"object expected, "+we+" found")]),me;for(var Re in C){var $e=Re.match(/^(.*)-transition$/);$e&&Q[$e[1]]&&Q[$e[1]].transition?me=me.concat(hi({key:Re,value:C[Re],valueSpec:O.transition,style:he,styleSpec:O})):Q[Re]?me=me.concat(hi({key:Re,value:C[Re],valueSpec:Q[Re],style:he,styleSpec:O})):me=me.concat([new hr(Re,C[Re],'unknown property "'+Re+'"')])}return me}function Ka(E){return bn(E).length===0?[]:zo(E)}function Ya(E){return bn(E).length===0?[]:zo(E)}var ei={"*":function(){return[]},array:Xu,boolean:zu,number:Ru,color:$u,constants:rn,enum:ms,filter:pr,function:Iu,layer:qr,object:ks,source:Yn,light:xa,string:bn,formatted:Ka,resolvedImage:Ya};function hi(E){var C=E.value,O=E.valueSpec,Q=E.styleSpec;if(O.expression&&va(en(C)))return Iu(E);if(O.expression&&mo(Tn(C)))return zo(E);if(O.type&&ei[O.type])return ei[O.type](E);var he=ks(vn({},E,{valueSpec:O.type?Q[O.type]:O}));return he}function ao(E){var C=E.value,O=E.key,Q=bn(E);return Q.length||(C.indexOf("{fontstack}")===-1&&Q.push(new hr(O,C,'"glyphs" url must include a "{fontstack}" token')),C.indexOf("{range}")===-1&&Q.push(new hr(O,C,'"glyphs" url must include a "{range}" token'))),Q}function ri(E,C){C===void 0&&(C=Bt);var O=[];return O=O.concat(hi({key:"",value:E,valueSpec:C.$root,styleSpec:C,style:E,objectElementValidators:{glyphs:ao,"*":function(){return[]}}})),E.constants&&(O=O.concat(rn({key:"constants",value:E.constants,style:E,styleSpec:C}))),Vi(O)}ri.source=uo(Yn),ri.light=uo(xa),ri.layer=uo(qr),ri.filter=uo(pr),ri.paintProperty=uo(Dr),ri.layoutProperty=uo(Xr);function Vi(E){return[].concat(E).sort(function(C,O){return C.line-O.line})}function uo(E){return function(){for(var C=[],O=arguments.length;O--;)C[O]=arguments[O];return Vi(E.apply(this,C))}}var bo=ri,bi=bo.light,Mi=bo.paintProperty,fs=bo.layoutProperty;function po(E,C){var O=!1;if(C&&C.length)for(var Q=0,he=C;Q<he.length;Q+=1){var me=he[Q];E.fire(new br(new Error(me.message))),O=!0}return O}var Lo=fe,Vo=3;function fe(E,C,O){var Q=this.cells=[];if(E instanceof ArrayBuffer){this.arrayBuffer=E;var he=new Int32Array(this.arrayBuffer);E=he[0],C=he[1],O=he[2],this.d=C+2*O;for(var me=0;me<this.d*this.d;me++){var we=he[Vo+me],Re=he[Vo+me+1];Q.push(we===Re?null:he.subarray(we,Re))}var $e=he[Vo+Q.length],ft=he[Vo+Q.length+1];this.keys=he.subarray($e,ft),this.bboxes=he.subarray(ft),this.insert=this._insertReadonly}else{this.d=C+2*O;for(var pt=0;pt<this.d*this.d;pt++)Q.push([]);this.keys=[],this.bboxes=[]}this.n=C,this.extent=E,this.padding=O,this.scale=C/E,this.uid=0;var It=O/C*E;this.min=-It,this.max=E+It}fe.prototype.insert=function(E,C,O,Q,he){this._forEachCell(C,O,Q,he,this._insertCell,this.uid++),this.keys.push(E),this.bboxes.push(C),this.bboxes.push(O),this.bboxes.push(Q),this.bboxes.push(he)},fe.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},fe.prototype._insertCell=function(E,C,O,Q,he,me){this.cells[he].push(me)},fe.prototype.query=function(E,C,O,Q,he){var me=this.min,we=this.max;if(E<=me&&C<=me&&we<=O&&we<=Q&&!he)return Array.prototype.slice.call(this.keys);var Re=[],$e={};return this._forEachCell(E,C,O,Q,this._queryCell,Re,$e,he),Re},fe.prototype._queryCell=function(E,C,O,Q,he,me,we,Re){var $e=this.cells[he];if($e!==null)for(var ft=this.keys,pt=this.bboxes,It=0;It<$e.length;It++){var tr=$e[It];if(we[tr]===void 0){var Qt=tr*4;(Re?Re(pt[Qt+0],pt[Qt+1],pt[Qt+2],pt[Qt+3]):E<=pt[Qt+2]&&C<=pt[Qt+3]&&O>=pt[Qt+0]&&Q>=pt[Qt+1])?(we[tr]=!0,me.push(ft[tr])):we[tr]=!1}}},fe.prototype._forEachCell=function(E,C,O,Q,he,me,we,Re){for(var $e=this._convertToCellCoord(E),ft=this._convertToCellCoord(C),pt=this._convertToCellCoord(O),It=this._convertToCellCoord(Q),tr=$e;tr<=pt;tr++)for(var Qt=ft;Qt<=It;Qt++){var dr=this.d*Qt+tr;if(!(Re&&!Re(this._convertFromCellCoord(tr),this._convertFromCellCoord(Qt),this._convertFromCellCoord(tr+1),this._convertFromCellCoord(Qt+1)))&&he.call(this,E,C,O,Q,dr,me,we,Re))return}},fe.prototype._convertFromCellCoord=function(E){return(E-this.padding)/this.scale},fe.prototype._convertToCellCoord=function(E){return Math.max(0,Math.min(this.d-1,Math.floor(E*this.scale)+this.padding))},fe.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var E=this.cells,C=Vo+this.cells.length+1+1,O=0,Q=0;Q<this.cells.length;Q++)O+=this.cells[Q].length;var he=new Int32Array(C+O+this.keys.length+this.bboxes.length);he[0]=this.extent,he[1]=this.n,he[2]=this.padding;for(var me=C,we=0;we<E.length;we++){var Re=E[we];he[Vo+we]=me,he.set(Re,me),me+=Re.length}return he[Vo+E.length]=me,he.set(this.keys,me),me+=this.keys.length,he[Vo+E.length+1]=me,he.set(this.bboxes,me),me+=this.bboxes.length,he.buffer};var xe=self.ImageData,Ee=self.ImageBitmap,Fe={};function Ie(E,C,O){O===void 0&&(O={}),Object.defineProperty(C,"_classRegistryKey",{value:E,writeable:!1}),Fe[E]={klass:C,omit:O.omit||[],shallow:O.shallow||[]}}Ie("Object",Object),Lo.serialize=function(C,O){var Q=C.toArrayBuffer();return O&&O.push(Q),{buffer:Q}},Lo.deserialize=function(C){return new Lo(C.buffer)},Ie("Grid",Lo),Ie("Color",vi),Ie("Error",Error),Ie("ResolvedImage",Ao),Ie("StylePropertyFunction",Bl),Ie("StyleExpression",ls,{omit:["_evaluator"]}),Ie("ZoomDependentExpression",us),Ie("ZoomConstantExpression",Jl),Ie("CompoundExpression",Mo,{omit:["_evaluate"]});for(var je in Jn)Jn[je]._classRegistryKey||Ie("Expression_"+je,Jn[je]);function xt(E){return E&&typeof ArrayBuffer<"u"&&(E instanceof ArrayBuffer||E.constructor&&E.constructor.name==="ArrayBuffer")}function ht(E){return Ee&&E instanceof Ee}function Ct(E,C){if(E==null||typeof E=="boolean"||typeof E=="number"||typeof E=="string"||E instanceof Boolean||E instanceof Number||E instanceof String||E instanceof Date||E instanceof RegExp)return E;if(xt(E)||ht(E))return C&&C.push(E),E;if(ArrayBuffer.isView(E)){var O=E;return C&&C.push(O.buffer),O}if(E instanceof xe)return C&&C.push(E.data.buffer),E;if(Array.isArray(E)){for(var Q=[],he=0,me=E;he<me.length;he+=1){var we=me[he];Q.push(Ct(we,C))}return Q}if(typeof E=="object"){var Re=E.constructor,$e=Re._classRegistryKey;if(!$e)throw new Error("can't serialize object of unregistered class");var ft=Re.serialize?Re.serialize(E,C):{};if(!Re.serialize){for(var pt in E)if(!!E.hasOwnProperty(pt)&&!(Fe[$e].omit.indexOf(pt)>=0)){var It=E[pt];ft[pt]=Fe[$e].shallow.indexOf(pt)>=0?It:Ct(It,C)}E instanceof Error&&(ft.message=E.message)}if(ft.$name)throw new Error("$name property is reserved for worker serialization logic.");return $e!=="Object"&&(ft.$name=$e),ft}throw new Error("can't serialize object of type "+typeof E)}function Xt(E){if(E==null||typeof E=="boolean"||typeof E=="number"||typeof E=="string"||E instanceof Boolean||E instanceof Number||E instanceof String||E instanceof Date||E instanceof RegExp||xt(E)||ht(E)||ArrayBuffer.isView(E)||E instanceof xe)return E;if(Array.isArray(E))return E.map(Xt);if(typeof E=="object"){var C=E.$name||"Object",O=Fe[C],Q=O.klass;if(!Q)throw new Error("can't deserialize unregistered class "+C);if(Q.deserialize)return Q.deserialize(E);for(var he=Object.create(Q.prototype),me=0,we=Object.keys(E);me<we.length;me+=1){var Re=we[me];if(Re!=="$name"){var $e=E[Re];he[Re]=Fe[C].shallow.indexOf(Re)>=0?$e:Xt($e)}}return he}throw new Error("can't deserialize object of type "+typeof E)}var $t=function(){this.first=!0};$t.prototype.update=function(C,O){var Q=Math.floor(C);return this.first?(this.first=!1,this.lastIntegerZoom=Q,this.lastIntegerZoomTime=0,this.lastZoom=C,this.lastFloorZoom=Q,!0):(this.lastFloorZoom>Q?(this.lastIntegerZoom=Q+1,this.lastIntegerZoomTime=O):this.lastFloorZoom<Q&&(this.lastIntegerZoom=Q,this.lastIntegerZoomTime=O),C!==this.lastZoom?(this.lastZoom=C,this.lastFloorZoom=Q,!0):!1)};var er={"Latin-1 Supplement":function(E){return E>=128&&E<=255},Arabic:function(E){return E>=1536&&E<=1791},"Arabic Supplement":function(E){return E>=1872&&E<=1919},"Arabic Extended-A":function(E){return E>=2208&&E<=2303},"Hangul Jamo":function(E){return E>=4352&&E<=4607},"Unified Canadian Aboriginal Syllabics":function(E){return E>=5120&&E<=5759},Khmer:function(E){return E>=6016&&E<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(E){return E>=6320&&E<=6399},"General Punctuation":function(E){return E>=8192&&E<=8303},"Letterlike Symbols":function(E){return E>=8448&&E<=8527},"Number Forms":function(E){return E>=8528&&E<=8591},"Miscellaneous Technical":function(E){return E>=8960&&E<=9215},"Control Pictures":function(E){return E>=9216&&E<=9279},"Optical Character Recognition":function(E){return E>=9280&&E<=9311},"Enclosed Alphanumerics":function(E){return E>=9312&&E<=9471},"Geometric Shapes":function(E){return E>=9632&&E<=9727},"Miscellaneous Symbols":function(E){return E>=9728&&E<=9983},"Miscellaneous Symbols and Arrows":function(E){return E>=11008&&E<=11263},"CJK Radicals Supplement":function(E){return E>=11904&&E<=12031},"Kangxi Radicals":function(E){return E>=12032&&E<=12255},"Ideographic Description Characters":function(E){return E>=12272&&E<=12287},"CJK Symbols and Punctuation":function(E){return E>=12288&&E<=12351},Hiragana:function(E){return E>=12352&&E<=12447},Katakana:function(E){return E>=12448&&E<=12543},Bopomofo:function(E){return E>=12544&&E<=12591},"Hangul Compatibility Jamo":function(E){return E>=12592&&E<=12687},Kanbun:function(E){return E>=12688&&E<=12703},"Bopomofo Extended":function(E){return E>=12704&&E<=12735},"CJK Strokes":function(E){return E>=12736&&E<=12783},"Katakana Phonetic Extensions":function(E){return E>=12784&&E<=12799},"Enclosed CJK Letters and Months":function(E){return E>=12800&&E<=13055},"CJK Compatibility":function(E){return E>=13056&&E<=13311},"CJK Unified Ideographs Extension A":function(E){return E>=13312&&E<=19903},"Yijing Hexagram Symbols":function(E){return E>=19904&&E<=19967},"CJK Unified Ideographs":function(E){return E>=19968&&E<=40959},"Yi Syllables":function(E){return E>=40960&&E<=42127},"Yi Radicals":function(E){return E>=42128&&E<=42191},"Hangul Jamo Extended-A":function(E){return E>=43360&&E<=43391},"Hangul Syllables":function(E){return E>=44032&&E<=55215},"Hangul Jamo Extended-B":function(E){return E>=55216&&E<=55295},"Private Use Area":function(E){return E>=57344&&E<=63743},"CJK Compatibility Ideographs":function(E){return E>=63744&&E<=64255},"Arabic Presentation Forms-A":function(E){return E>=64336&&E<=65023},"Vertical Forms":function(E){return E>=65040&&E<=65055},"CJK Compatibility Forms":function(E){return E>=65072&&E<=65103},"Small Form Variants":function(E){return E>=65104&&E<=65135},"Arabic Presentation Forms-B":function(E){return E>=65136&&E<=65279},"Halfwidth and Fullwidth Forms":function(E){return E>=65280&&E<=65519}};function Ar(E){for(var C=0,O=E;C<O.length;C+=1){var Q=O[C];if(Br(Q.charCodeAt(0)))return!0}return!1}function Jr(E){for(var C=0,O=E;C<O.length;C+=1){var Q=O[C];if(!sn(Q.charCodeAt(0)))return!1}return!0}function sn(E){return!(er.Arabic(E)||er["Arabic Supplement"](E)||er["Arabic Extended-A"](E)||er["Arabic Presentation Forms-A"](E)||er["Arabic Presentation Forms-B"](E))}function Lr(E){return E<11904?!1:!!(er["Bopomofo Extended"](E)||er.Bopomofo(E)||er["CJK Compatibility Forms"](E)||er["CJK Compatibility Ideographs"](E)||er["CJK Compatibility"](E)||er["CJK Radicals Supplement"](E)||er["CJK Strokes"](E)||er["CJK Symbols and Punctuation"](E)||er["CJK Unified Ideographs Extension A"](E)||er["CJK Unified Ideographs"](E)||er["Enclosed CJK Letters and Months"](E)||er["Halfwidth and Fullwidth Forms"](E)||er.Hiragana(E)||er["Ideographic Description Characters"](E)||er["Kangxi Radicals"](E)||er["Katakana Phonetic Extensions"](E)||er.Katakana(E)||er["Vertical Forms"](E)||er["Yi Radicals"](E)||er["Yi Syllables"](E))}function Br(E){return E===746||E===747?!0:E<4352?!1:!!(er["Bopomofo Extended"](E)||er.Bopomofo(E)||er["CJK Compatibility Forms"](E)&&!(E>=65097&&E<=65103)||er["CJK Compatibility Ideographs"](E)||er["CJK Compatibility"](E)||er["CJK Radicals Supplement"](E)||er["CJK Strokes"](E)||er["CJK Symbols and Punctuation"](E)&&!(E>=12296&&E<=12305)&&!(E>=12308&&E<=12319)&&E!==12336||er["CJK Unified Ideographs Extension A"](E)||er["CJK Unified Ideographs"](E)||er["Enclosed CJK Letters and Months"](E)||er["Hangul Compatibility Jamo"](E)||er["Hangul Jamo Extended-A"](E)||er["Hangul Jamo Extended-B"](E)||er["Hangul Jamo"](E)||er["Hangul Syllables"](E)||er.Hiragana(E)||er["Ideographic Description Characters"](E)||er.Kanbun(E)||er["Kangxi Radicals"](E)||er["Katakana Phonetic Extensions"](E)||er.Katakana(E)&&E!==12540||er["Halfwidth and Fullwidth Forms"](E)&&E!==65288&&E!==65289&&E!==65293&&!(E>=65306&&E<=65310)&&E!==65339&&E!==65341&&E!==65343&&!(E>=65371&&E<=65503)&&E!==65507&&!(E>=65512&&E<=65519)||er["Small Form Variants"](E)&&!(E>=65112&&E<=65118)&&!(E>=65123&&E<=65126)||er["Unified Canadian Aboriginal Syllabics"](E)||er["Unified Canadian Aboriginal Syllabics Extended"](E)||er["Vertical Forms"](E)||er["Yijing Hexagram Symbols"](E)||er["Yi Syllables"](E)||er["Yi Radicals"](E))}function Zr(E){return!!(er["Latin-1 Supplement"](E)&&(E===167||E===169||E===174||E===177||E===188||E===189||E===190||E===215||E===247)||er["General Punctuation"](E)&&(E===8214||E===8224||E===8225||E===8240||E===8241||E===8251||E===8252||E===8258||E===8263||E===8264||E===8265||E===8273)||er["Letterlike Symbols"](E)||er["Number Forms"](E)||er["Miscellaneous Technical"](E)&&(E>=8960&&E<=8967||E>=8972&&E<=8991||E>=8996&&E<=9e3||E===9003||E>=9085&&E<=9114||E>=9150&&E<=9165||E===9167||E>=9169&&E<=9179||E>=9186&&E<=9215)||er["Control Pictures"](E)&&E!==9251||er["Optical Character Recognition"](E)||er["Enclosed Alphanumerics"](E)||er["Geometric Shapes"](E)||er["Miscellaneous Symbols"](E)&&!(E>=9754&&E<=9759)||er["Miscellaneous Symbols and Arrows"](E)&&(E>=11026&&E<=11055||E>=11088&&E<=11097||E>=11192&&E<=11243)||er["CJK Symbols and Punctuation"](E)||er.Katakana(E)||er["Private Use Area"](E)||er["CJK Compatibility Forms"](E)||er["Small Form Variants"](E)||er["Halfwidth and Fullwidth Forms"](E)||E===8734||E===8756||E===8757||E>=9984&&E<=10087||E>=10102&&E<=10131||E===65532||E===65533)}function nn(E){return!(Br(E)||Zr(E))}function on(E){return er.Arabic(E)||er["Arabic Supplement"](E)||er["Arabic Extended-A"](E)||er["Arabic Presentation Forms-A"](E)||er["Arabic Presentation Forms-B"](E)}function jr(E){return E>=1424&&E<=2303||er["Arabic Presentation Forms-A"](E)||er["Arabic Presentation Forms-B"](E)}function Un(E,C){return!(!C&&jr(E)||E>=2304&&E<=3583||E>=3840&&E<=4255||er.Khmer(E))}function ra(E){for(var C=0,O=E;C<O.length;C+=1){var Q=O[C];if(jr(Q.charCodeAt(0)))return!0}return!1}function _a(E,C){for(var O=0,Q=E;O<Q.length;O+=1){var he=Q[O];if(!Un(he.charCodeAt(0),C))return!1}return!0}var ia={unavailable:"unavailable",deferred:"deferred",loading:"loading",loaded:"loaded",error:"error"},Sa=null,la=ia.unavailable,Na=null,Pa=function(E){E&&typeof E=="string"&&E.indexOf("NetworkError")>-1&&(la=ia.error),Sa&&Sa(E)};function $a(){yi.fire(new kr("pluginStateChange",{pluginStatus:la,pluginURL:Na}))}var yi=new Mr,fo=function(){return la},Ii=function(E){return E({pluginStatus:la,pluginURL:Na}),yi.on("pluginStateChange",E),E},fa=function(E,C,O){if(O===void 0&&(O=!1),la===ia.deferred||la===ia.loading||la===ia.loaded)throw new Error("setRTLTextPlugin cannot be called multiple times.");Na=K.resolveURL(E),la=ia.deferred,Sa=C,$a(),O||ai()},ai=function(){if(la!==ia.deferred||!Na)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");la=ia.loading,$a(),Na&&lt({url:Na},function(E){E?Pa(E):(la=ia.loaded,$a())})},Xa={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return la===ia.loaded||Xa.applyArabicShaping!=null},isLoading:function(){return la===ia.loading},setState:function(C){la=C.pluginStatus,Na=C.pluginURL},isParsed:function(){return Xa.applyArabicShaping!=null&&Xa.processBidirectionalText!=null&&Xa.processStyledBidirectionalText!=null},getPluginURL:function(){return Na}},Si=function(){!Xa.isLoading()&&!Xa.isLoaded()&&fo()==="deferred"&&ai()},si=function(C,O){this.zoom=C,O?(this.now=O.now,this.fadeDuration=O.fadeDuration,this.zoomHistory=O.zoomHistory,this.transition=O.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new $t,this.transition={})};si.prototype.isSupportedScript=function(C){return _a(C,Xa.isLoaded())},si.prototype.crossFadingFactor=function(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},si.prototype.getCrossfadeParameters=function(){var C=this.zoom,O=C-Math.floor(C),Q=this.crossFadingFactor();return C>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:O+(1-O)*Q}:{fromScale:.5,toScale:1,t:1-(1-Q)*O}};var io=function(C,O){this.property=C,this.value=O,this.expression=vf(O===void 0?C.specification.default:O,C.specification)};io.prototype.isDataDriven=function(){return this.expression.kind==="source"||this.expression.kind==="composite"},io.prototype.possiblyEvaluate=function(C,O,Q){return this.property.possiblyEvaluate(this,C,O,Q)};var Qi=function(C){this.property=C,this.value=new io(C,void 0)};Qi.prototype.transitioned=function(C,O){return new Go(this.property,this.value,O,A({},C.transition,this.transition),C.now)},Qi.prototype.untransitioned=function(){return new Go(this.property,this.value,null,{},0)};var go=function(C){this._properties=C,this._values=Object.create(C.defaultTransitionablePropertyValues)};go.prototype.getValue=function(C){return I(this._values[C].value.value)},go.prototype.setValue=function(C,O){this._values.hasOwnProperty(C)||(this._values[C]=new Qi(this._values[C].property)),this._values[C].value=new io(this._values[C].property,O===null?void 0:I(O))},go.prototype.getTransition=function(C){return I(this._values[C].transition)},go.prototype.setTransition=function(C,O){this._values.hasOwnProperty(C)||(this._values[C]=new Qi(this._values[C].property)),this._values[C].transition=I(O)||void 0},go.prototype.serialize=function(){for(var C={},O=0,Q=Object.keys(this._values);O<Q.length;O+=1){var he=Q[O],me=this.getValue(he);me!==void 0&&(C[he]=me);var we=this.getTransition(he);we!==void 0&&(C[he+"-transition"]=we)}return C},go.prototype.transitioned=function(C,O){for(var Q=new Fo(this._properties),he=0,me=Object.keys(this._values);he<me.length;he+=1){var we=me[he];Q._values[we]=this._values[we].transitioned(C,O._values[we])}return Q},go.prototype.untransitioned=function(){for(var C=new Fo(this._properties),O=0,Q=Object.keys(this._values);O<Q.length;O+=1){var he=Q[O];C._values[he]=this._values[he].untransitioned()}return C};var Go=function(C,O,Q,he,me){this.property=C,this.value=O,this.begin=me+he.delay||0,this.end=this.begin+he.duration||0,C.specification.transition&&(he.delay||he.duration)&&(this.prior=Q)};Go.prototype.possiblyEvaluate=function(C,O,Q){var he=C.now||0,me=this.value.possiblyEvaluate(C,O,Q),we=this.prior;if(we){if(he>this.end)return this.prior=null,me;if(this.value.isDataDriven())return this.prior=null,me;if(he<this.begin)return we.possiblyEvaluate(C,O,Q);var Re=(he-this.begin)/(this.end-this.begin);return this.property.interpolate(we.possiblyEvaluate(C,O,Q),me,y(Re))}else return me};var Fo=function(C){this._properties=C,this._values=Object.create(C.defaultTransitioningPropertyValues)};Fo.prototype.possiblyEvaluate=function(C,O,Q){for(var he=new Bi(this._properties),me=0,we=Object.keys(this._values);me<we.length;me+=1){var Re=we[me];he._values[Re]=this._values[Re].possiblyEvaluate(C,O,Q)}return he},Fo.prototype.hasTransition=function(){for(var C=0,O=Object.keys(this._values);C<O.length;C+=1){var Q=O[C];if(this._values[Q].prior)return!0}return!1};var Yo=function(C){this._properties=C,this._values=Object.create(C.defaultPropertyValues)};Yo.prototype.getValue=function(C){return I(this._values[C].value)},Yo.prototype.setValue=function(C,O){this._values[C]=new io(this._values[C].property,O===null?void 0:I(O))},Yo.prototype.serialize=function(){for(var C={},O=0,Q=Object.keys(this._values);O<Q.length;O+=1){var he=Q[O],me=this.getValue(he);me!==void 0&&(C[he]=me)}return C},Yo.prototype.possiblyEvaluate=function(C,O,Q){for(var he=new Bi(this._properties),me=0,we=Object.keys(this._values);me<we.length;me+=1){var Re=we[me];he._values[Re]=this._values[Re].possiblyEvaluate(C,O,Q)}return he};var Gi=function(C,O,Q){this.property=C,this.value=O,this.parameters=Q};Gi.prototype.isConstant=function(){return this.value.kind==="constant"},Gi.prototype.constantOr=function(C){return this.value.kind==="constant"?this.value.value:C},Gi.prototype.evaluate=function(C,O,Q,he){return this.property.evaluate(this.value,this.parameters,C,O,Q,he)};var Bi=function(C){this._properties=C,this._values=Object.create(C.defaultPossiblyEvaluatedValues)};Bi.prototype.get=function(C){return this._values[C]};var Ia=function(C){this.specification=C};Ia.prototype.possiblyEvaluate=function(C,O){return C.expression.evaluate(O)},Ia.prototype.interpolate=function(C,O,Q){var he=Xs[this.specification.type];return he?he(C,O,Q):C};var Za=function(C,O){this.specification=C,this.overrides=O};Za.prototype.possiblyEvaluate=function(C,O,Q,he){return C.expression.kind==="constant"||C.expression.kind==="camera"?new Gi(this,{kind:"constant",value:C.expression.evaluate(O,null,{},Q,he)},O):new Gi(this,C.expression,O)},Za.prototype.interpolate=function(C,O,Q){if(C.value.kind!=="constant"||O.value.kind!=="constant")return C;if(C.value.value===void 0||O.value.value===void 0)return new Gi(this,{kind:"constant",value:void 0},C.parameters);var he=Xs[this.specification.type];return he?new Gi(this,{kind:"constant",value:he(C.value.value,O.value.value,Q)},C.parameters):C},Za.prototype.evaluate=function(C,O,Q,he,me,we){return C.kind==="constant"?C.value:C.evaluate(O,Q,he,me,we)};var xo=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.possiblyEvaluate=function(Q,he,me,we){if(Q.value===void 0)return new Gi(this,{kind:"constant",value:void 0},he);if(Q.expression.kind==="constant"){var Re=Q.expression.evaluate(he,null,{},me,we),$e=Q.property.specification.type==="resolvedImage",ft=$e&&typeof Re!="string"?Re.name:Re,pt=this._calculate(ft,ft,ft,he);return new Gi(this,{kind:"constant",value:pt},he)}else if(Q.expression.kind==="camera"){var It=this._calculate(Q.expression.evaluate({zoom:he.zoom-1}),Q.expression.evaluate({zoom:he.zoom}),Q.expression.evaluate({zoom:he.zoom+1}),he);return new Gi(this,{kind:"constant",value:It},he)}else return new Gi(this,Q.expression,he)},C.prototype.evaluate=function(Q,he,me,we,Re,$e){if(Q.kind==="source"){var ft=Q.evaluate(he,me,we,Re,$e);return this._calculate(ft,ft,ft,he)}else return Q.kind==="composite"?this._calculate(Q.evaluate({zoom:Math.floor(he.zoom)-1},me,we),Q.evaluate({zoom:Math.floor(he.zoom)},me,we),Q.evaluate({zoom:Math.floor(he.zoom)+1},me,we),he):Q.value},C.prototype._calculate=function(Q,he,me,we){var Re=we.zoom;return Re>we.zoomHistory.lastIntegerZoom?{from:Q,to:he}:{from:me,to:he}},C.prototype.interpolate=function(Q){return Q},C}(Za),eo=function(C){this.specification=C};eo.prototype.possiblyEvaluate=function(C,O,Q,he){if(C.value!==void 0)if(C.expression.kind==="constant"){var me=C.expression.evaluate(O,null,{},Q,he);return this._calculate(me,me,me,O)}else return this._calculate(C.expression.evaluate(new si(Math.floor(O.zoom-1),O)),C.expression.evaluate(new si(Math.floor(O.zoom),O)),C.expression.evaluate(new si(Math.floor(O.zoom+1),O)),O)},eo.prototype._calculate=function(C,O,Q,he){var me=he.zoom;return me>he.zoomHistory.lastIntegerZoom?{from:C,to:O}:{from:Q,to:O}},eo.prototype.interpolate=function(C){return C};var Po=function(C){this.specification=C};Po.prototype.possiblyEvaluate=function(C,O,Q,he){return!!C.expression.evaluate(O,null,{},Q,he)},Po.prototype.interpolate=function(){return!1};var Xi=function(C){this.properties=C,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(var O in C){var Q=C[O];Q.specification.overridable&&this.overridableProperties.push(O);var he=this.defaultPropertyValues[O]=new io(Q,void 0),me=this.defaultTransitionablePropertyValues[O]=new Qi(Q);this.defaultTransitioningPropertyValues[O]=me.untransitioned(),this.defaultPossiblyEvaluatedValues[O]=he.possiblyEvaluate({})}};Ie("DataDrivenProperty",Za),Ie("DataConstantProperty",Ia),Ie("CrossFadedDataDrivenProperty",xo),Ie("CrossFadedProperty",eo),Ie("ColorRampProperty",Po);var Wo="-transition",xs=function(E){function C(O,Q){if(E.call(this),this.id=O.id,this.type=O.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},O.type!=="custom"&&(O=O,this.metadata=O.metadata,this.minzoom=O.minzoom,this.maxzoom=O.maxzoom,O.type!=="background"&&(this.source=O.source,this.sourceLayer=O["source-layer"],this.filter=O.filter),Q.layout&&(this._unevaluatedLayout=new Yo(Q.layout)),Q.paint)){this._transitionablePaint=new go(Q.paint);for(var he in O.paint)this.setPaintProperty(he,O.paint[he],{validate:!1});for(var me in O.layout)this.setLayoutProperty(me,O.layout[me],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Bi(Q.paint)}}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},C.prototype.getLayoutProperty=function(Q){return Q==="visibility"?this.visibility:this._unevaluatedLayout.getValue(Q)},C.prototype.setLayoutProperty=function(Q,he,me){if(me===void 0&&(me={}),he!=null){var we="layers."+this.id+".layout."+Q;if(this._validate(fs,we,Q,he,me))return}if(Q==="visibility"){this.visibility=he;return}this._unevaluatedLayout.setValue(Q,he)},C.prototype.getPaintProperty=function(Q){return k(Q,Wo)?this._transitionablePaint.getTransition(Q.slice(0,-Wo.length)):this._transitionablePaint.getValue(Q)},C.prototype.setPaintProperty=function(Q,he,me){if(me===void 0&&(me={}),he!=null){var we="layers."+this.id+".paint."+Q;if(this._validate(Mi,we,Q,he,me))return!1}if(k(Q,Wo))return this._transitionablePaint.setTransition(Q.slice(0,-Wo.length),he||void 0),!1;var Re=this._transitionablePaint._values[Q],$e=Re.property.specification["property-type"]==="cross-faded-data-driven",ft=Re.value.isDataDriven(),pt=Re.value;this._transitionablePaint.setValue(Q,he),this._handleSpecialPaintPropertyUpdate(Q);var It=this._transitionablePaint._values[Q].value,tr=It.isDataDriven();return tr||ft||$e||this._handleOverridablePaintPropertyUpdate(Q,pt,It)},C.prototype._handleSpecialPaintPropertyUpdate=function(Q){},C.prototype._handleOverridablePaintPropertyUpdate=function(Q,he,me){return!1},C.prototype.isHidden=function(Q){return this.minzoom&&Q<this.minzoom||this.maxzoom&&Q>=this.maxzoom?!0:this.visibility==="none"},C.prototype.updateTransitions=function(Q){this._transitioningPaint=this._transitionablePaint.transitioned(Q,this._transitioningPaint)},C.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},C.prototype.recalculate=function(Q,he){Q.getCrossfadeParameters&&(this._crossfadeParameters=Q.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(Q,void 0,he)),this.paint=this._transitioningPaint.possiblyEvaluate(Q,void 0,he)},C.prototype.serialize=function(){var Q={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(Q.layout=Q.layout||{},Q.layout.visibility=this.visibility),z(Q,function(he,me){return he!==void 0&&!(me==="layout"&&!Object.keys(he).length)&&!(me==="paint"&&!Object.keys(he).length)})},C.prototype._validate=function(Q,he,me,we,Re){return Re===void 0&&(Re={}),Re&&Re.validate===!1?!1:po(this,Q.call(bo,{key:he,layerType:this.type,objectKey:me,value:we,styleSpec:Bt,style:{glyphs:!0,sprite:!0}}))},C.prototype.is3D=function(){return!1},C.prototype.isTileClipped=function(){return!1},C.prototype.hasOffscreenPass=function(){return!1},C.prototype.resize=function(){},C.prototype.isStateDependent=function(){for(var Q in this.paint._values){var he=this.paint.get(Q);if(!(!(he instanceof Gi)||!oi(he.property.specification))&&(he.value.kind==="source"||he.value.kind==="composite")&&he.value.isStateDependent)return!0}return!1},C}(Mr),Nl={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},Zi=function(C,O){this._structArray=C,this._pos1=O*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},qu=128,Al=5,Oi=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};Oi.serialize=function(C,O){return C._trim(),O&&(C.isTransferred=!0,O.push(C.arrayBuffer)),{length:C.length,arrayBuffer:C.arrayBuffer}},Oi.deserialize=function(C){var O=Object.create(this.prototype);return O.arrayBuffer=C.arrayBuffer,O.length=C.length,O.capacity=C.arrayBuffer.byteLength/O.bytesPerElement,O._refreshViews(),O},Oi.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},Oi.prototype.clear=function(){this.length=0},Oi.prototype.resize=function(C){this.reserve(C),this.length=C},Oi.prototype.reserve=function(C){if(C>this.capacity){this.capacity=Math.max(C,Math.floor(this.capacity*Al),qu),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var O=this.uint8;this._refreshViews(),O&&this.uint8.set(O)}},Oi.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};function Do(E,C){C===void 0&&(C=1);var O=0,Q=0,he=E.map(function(we){var Re=Jc(we.type),$e=O=Mf(O,Math.max(C,Re)),ft=we.components||1;return Q=Math.max(Q,Re),O+=Re*ft,{name:we.name,type:we.type,components:ft,offset:$e}}),me=Mf(O,Math.max(Q,C));return{members:he,size:me,alignment:C}}function Jc(E){return Nl[E].BYTES_PER_ELEMENT}function Mf(E,C){return Math.ceil(E/C)*C}var pf=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},C.prototype.emplaceBack=function(Q,he){var me=this.length;return this.resize(me+1),this.emplace(me,Q,he)},C.prototype.emplace=function(Q,he,me){var we=Q*2;return this.int16[we+0]=he,this.int16[we+1]=me,Q},C}(Oi);pf.prototype.bytesPerElement=4,Ie("StructArrayLayout2i4",pf);var Ou=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},C.prototype.emplaceBack=function(Q,he,me,we){var Re=this.length;return this.resize(Re+1),this.emplace(Re,Q,he,me,we)},C.prototype.emplace=function(Q,he,me,we,Re){var $e=Q*4;return this.int16[$e+0]=he,this.int16[$e+1]=me,this.int16[$e+2]=we,this.int16[$e+3]=Re,Q},C}(Oi);Ou.prototype.bytesPerElement=8,Ie("StructArrayLayout4i8",Ou);var ef=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},C.prototype.emplaceBack=function(Q,he,me,we,Re,$e){var ft=this.length;return this.resize(ft+1),this.emplace(ft,Q,he,me,we,Re,$e)},C.prototype.emplace=function(Q,he,me,we,Re,$e,ft){var pt=Q*6;return this.int16[pt+0]=he,this.int16[pt+1]=me,this.int16[pt+2]=we,this.int16[pt+3]=Re,this.int16[pt+4]=$e,this.int16[pt+5]=ft,Q},C}(Oi);ef.prototype.bytesPerElement=12,Ie("StructArrayLayout2i4i12",ef);var Sf=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},C.prototype.emplaceBack=function(Q,he,me,we,Re,$e){var ft=this.length;return this.resize(ft+1),this.emplace(ft,Q,he,me,we,Re,$e)},C.prototype.emplace=function(Q,he,me,we,Re,$e,ft){var pt=Q*4,It=Q*8;return this.int16[pt+0]=he,this.int16[pt+1]=me,this.uint8[It+4]=we,this.uint8[It+5]=Re,this.uint8[It+6]=$e,this.uint8[It+7]=ft,Q},C}(Oi);Sf.prototype.bytesPerElement=8,Ie("StructArrayLayout2i4ub8",Sf);var Os=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},C.prototype.emplaceBack=function(Q,he,me,we,Re,$e,ft,pt,It,tr){var Qt=this.length;return this.resize(Qt+1),this.emplace(Qt,Q,he,me,we,Re,$e,ft,pt,It,tr)},C.prototype.emplace=function(Q,he,me,we,Re,$e,ft,pt,It,tr,Qt){var dr=Q*9,Fr=Q*18;return this.uint16[dr+0]=he,this.uint16[dr+1]=me,this.uint16[dr+2]=we,this.uint16[dr+3]=Re,this.uint16[dr+4]=$e,this.uint16[dr+5]=ft,this.uint16[dr+6]=pt,this.uint16[dr+7]=It,this.uint8[Fr+16]=tr,this.uint8[Fr+17]=Qt,Q},C}(Oi);Os.prototype.bytesPerElement=18,Ie("StructArrayLayout8ui2ub18",Os);var Bu=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},C.prototype.emplaceBack=function(Q,he,me,we,Re,$e,ft,pt,It,tr,Qt,dr){var Fr=this.length;return this.resize(Fr+1),this.emplace(Fr,Q,he,me,we,Re,$e,ft,pt,It,tr,Qt,dr)},C.prototype.emplace=function(Q,he,me,we,Re,$e,ft,pt,It,tr,Qt,dr,Fr){var an=Q*12;return this.int16[an+0]=he,this.int16[an+1]=me,this.int16[an+2]=we,this.int16[an+3]=Re,this.uint16[an+4]=$e,this.uint16[an+5]=ft,this.uint16[an+6]=pt,this.uint16[an+7]=It,this.int16[an+8]=tr,this.int16[an+9]=Qt,this.int16[an+10]=dr,this.int16[an+11]=Fr,Q},C}(Oi);Bu.prototype.bytesPerElement=24,Ie("StructArrayLayout4i4ui4i24",Bu);var $f=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},C.prototype.emplaceBack=function(Q,he,me){var we=this.length;return this.resize(we+1),this.emplace(we,Q,he,me)},C.prototype.emplace=function(Q,he,me,we){var Re=Q*3;return this.float32[Re+0]=he,this.float32[Re+1]=me,this.float32[Re+2]=we,Q},C}(Oi);$f.prototype.bytesPerElement=12,Ie("StructArrayLayout3f12",$f);var qf=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},C.prototype.emplaceBack=function(Q){var he=this.length;return this.resize(he+1),this.emplace(he,Q)},C.prototype.emplace=function(Q,he){var me=Q*1;return this.uint32[me+0]=he,Q},C}(Oi);qf.prototype.bytesPerElement=4,Ie("StructArrayLayout1ul4",qf);var df=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},C.prototype.emplaceBack=function(Q,he,me,we,Re,$e,ft,pt,It){var tr=this.length;return this.resize(tr+1),this.emplace(tr,Q,he,me,we,Re,$e,ft,pt,It)},C.prototype.emplace=function(Q,he,me,we,Re,$e,ft,pt,It,tr){var Qt=Q*10,dr=Q*5;return this.int16[Qt+0]=he,this.int16[Qt+1]=me,this.int16[Qt+2]=we,this.int16[Qt+3]=Re,this.int16[Qt+4]=$e,this.int16[Qt+5]=ft,this.uint32[dr+3]=pt,this.uint16[Qt+8]=It,this.uint16[Qt+9]=tr,Q},C}(Oi);df.prototype.bytesPerElement=20,Ie("StructArrayLayout6i1ul2ui20",df);var kf=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},C.prototype.emplaceBack=function(Q,he,me,we,Re,$e){var ft=this.length;return this.resize(ft+1),this.emplace(ft,Q,he,me,we,Re,$e)},C.prototype.emplace=function(Q,he,me,we,Re,$e,ft){var pt=Q*6;return this.int16[pt+0]=he,this.int16[pt+1]=me,this.int16[pt+2]=we,this.int16[pt+3]=Re,this.int16[pt+4]=$e,this.int16[pt+5]=ft,Q},C}(Oi);kf.prototype.bytesPerElement=12,Ie("StructArrayLayout2i2i2i12",kf);var mu=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},C.prototype.emplaceBack=function(Q,he,me,we,Re){var $e=this.length;return this.resize($e+1),this.emplace($e,Q,he,me,we,Re)},C.prototype.emplace=function(Q,he,me,we,Re,$e){var ft=Q*4,pt=Q*8;return this.float32[ft+0]=he,this.float32[ft+1]=me,this.float32[ft+2]=we,this.int16[pt+6]=Re,this.int16[pt+7]=$e,Q},C}(Oi);mu.prototype.bytesPerElement=16,Ie("StructArrayLayout2f1f2i16",mu);var Qs=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},C.prototype.emplaceBack=function(Q,he,me,we){var Re=this.length;return this.resize(Re+1),this.emplace(Re,Q,he,me,we)},C.prototype.emplace=function(Q,he,me,we,Re){var $e=Q*12,ft=Q*3;return this.uint8[$e+0]=he,this.uint8[$e+1]=me,this.float32[ft+1]=we,this.float32[ft+2]=Re,Q},C}(Oi);Qs.prototype.bytesPerElement=12,Ie("StructArrayLayout2ub2f12",Qs);var xu=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},C.prototype.emplaceBack=function(Q,he,me){var we=this.length;return this.resize(we+1),this.emplace(we,Q,he,me)},C.prototype.emplace=function(Q,he,me,we){var Re=Q*3;return this.uint16[Re+0]=he,this.uint16[Re+1]=me,this.uint16[Re+2]=we,Q},C}(Oi);xu.prototype.bytesPerElement=6,Ie("StructArrayLayout3ui6",xu);var gf=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},C.prototype.emplaceBack=function(Q,he,me,we,Re,$e,ft,pt,It,tr,Qt,dr,Fr,an,$r,kn,mn){var Sn=this.length;return this.resize(Sn+1),this.emplace(Sn,Q,he,me,we,Re,$e,ft,pt,It,tr,Qt,dr,Fr,an,$r,kn,mn)},C.prototype.emplace=function(Q,he,me,we,Re,$e,ft,pt,It,tr,Qt,dr,Fr,an,$r,kn,mn,Sn){var In=Q*24,Gn=Q*12,oa=Q*48;return this.int16[In+0]=he,this.int16[In+1]=me,this.uint16[In+2]=we,this.uint16[In+3]=Re,this.uint32[Gn+2]=$e,this.uint32[Gn+3]=ft,this.uint32[Gn+4]=pt,this.uint16[In+10]=It,this.uint16[In+11]=tr,this.uint16[In+12]=Qt,this.float32[Gn+7]=dr,this.float32[Gn+8]=Fr,this.uint8[oa+36]=an,this.uint8[oa+37]=$r,this.uint8[oa+38]=kn,this.uint32[Gn+10]=mn,this.int16[In+22]=Sn,Q},C}(Oi);gf.prototype.bytesPerElement=48,Ie("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",gf);var Ef=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},C.prototype.emplaceBack=function(Q,he,me,we,Re,$e,ft,pt,It,tr,Qt,dr,Fr,an,$r,kn,mn,Sn,In,Gn,oa,na,Ra,wa,Ma,ti,Ca,Da){var fi=this.length;return this.resize(fi+1),this.emplace(fi,Q,he,me,we,Re,$e,ft,pt,It,tr,Qt,dr,Fr,an,$r,kn,mn,Sn,In,Gn,oa,na,Ra,wa,Ma,ti,Ca,Da)},C.prototype.emplace=function(Q,he,me,we,Re,$e,ft,pt,It,tr,Qt,dr,Fr,an,$r,kn,mn,Sn,In,Gn,oa,na,Ra,wa,Ma,ti,Ca,Da,fi){var qa=Q*34,ki=Q*17;return this.int16[qa+0]=he,this.int16[qa+1]=me,this.int16[qa+2]=we,this.int16[qa+3]=Re,this.int16[qa+4]=$e,this.int16[qa+5]=ft,this.int16[qa+6]=pt,this.int16[qa+7]=It,this.uint16[qa+8]=tr,this.uint16[qa+9]=Qt,this.uint16[qa+10]=dr,this.uint16[qa+11]=Fr,this.uint16[qa+12]=an,this.uint16[qa+13]=$r,this.uint16[qa+14]=kn,this.uint16[qa+15]=mn,this.uint16[qa+16]=Sn,this.uint16[qa+17]=In,this.uint16[qa+18]=Gn,this.uint16[qa+19]=oa,this.uint16[qa+20]=na,this.uint16[qa+21]=Ra,this.uint16[qa+22]=wa,this.uint32[ki+12]=Ma,this.float32[ki+13]=ti,this.float32[ki+14]=Ca,this.float32[ki+15]=Da,this.float32[ki+16]=fi,Q},C}(Oi);Ef.prototype.bytesPerElement=68,Ie("StructArrayLayout8i15ui1ul4f68",Ef);var tf=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},C.prototype.emplaceBack=function(Q){var he=this.length;return this.resize(he+1),this.emplace(he,Q)},C.prototype.emplace=function(Q,he){var me=Q*1;return this.float32[me+0]=he,Q},C}(Oi);tf.prototype.bytesPerElement=4,Ie("StructArrayLayout1f4",tf);var ec=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},C.prototype.emplaceBack=function(Q,he,me){var we=this.length;return this.resize(we+1),this.emplace(we,Q,he,me)},C.prototype.emplace=function(Q,he,me,we){var Re=Q*3;return this.int16[Re+0]=he,this.int16[Re+1]=me,this.int16[Re+2]=we,Q},C}(Oi);ec.prototype.bytesPerElement=6,Ie("StructArrayLayout3i6",ec);var Nu=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},C.prototype.emplaceBack=function(Q,he,me){var we=this.length;return this.resize(we+1),this.emplace(we,Q,he,me)},C.prototype.emplace=function(Q,he,me,we){var Re=Q*2,$e=Q*4;return this.uint32[Re+0]=he,this.uint16[$e+2]=me,this.uint16[$e+3]=we,Q},C}(Oi);Nu.prototype.bytesPerElement=8,Ie("StructArrayLayout1ul2ui8",Nu);var yf=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},C.prototype.emplaceBack=function(Q,he){var me=this.length;return this.resize(me+1),this.emplace(me,Q,he)},C.prototype.emplace=function(Q,he,me){var we=Q*2;return this.uint16[we+0]=he,this.uint16[we+1]=me,Q},C}(Oi);yf.prototype.bytesPerElement=4,Ie("StructArrayLayout2ui4",yf);var rf=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},C.prototype.emplaceBack=function(Q){var he=this.length;return this.resize(he+1),this.emplace(he,Q)},C.prototype.emplace=function(Q,he){var me=Q*1;return this.uint16[me+0]=he,Q},C}(Oi);rf.prototype.bytesPerElement=2,Ie("StructArrayLayout1ui2",rf);var Uu=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},C.prototype.emplaceBack=function(Q,he){var me=this.length;return this.resize(me+1),this.emplace(me,Q,he)},C.prototype.emplace=function(Q,he,me){var we=Q*2;return this.float32[we+0]=he,this.float32[we+1]=me,Q},C}(Oi);Uu.prototype.bytesPerElement=8,Ie("StructArrayLayout2f8",Uu);var tc=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},C.prototype.emplaceBack=function(Q,he,me,we){var Re=this.length;return this.resize(Re+1),this.emplace(Re,Q,he,me,we)},C.prototype.emplace=function(Q,he,me,we,Re){var $e=Q*4;return this.float32[$e+0]=he,this.float32[$e+1]=me,this.float32[$e+2]=we,this.float32[$e+3]=Re,Q},C}(Oi);tc.prototype.bytesPerElement=16,Ie("StructArrayLayout4f16",tc);var _c=function(E){function C(){E.apply(this,arguments)}E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C;var O={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return O.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},O.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},O.x1.get=function(){return this._structArray.int16[this._pos2+2]},O.y1.get=function(){return this._structArray.int16[this._pos2+3]},O.x2.get=function(){return this._structArray.int16[this._pos2+4]},O.y2.get=function(){return this._structArray.int16[this._pos2+5]},O.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},O.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},O.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},O.anchorPoint.get=function(){return new c(this.anchorPointX,this.anchorPointY)},Object.defineProperties(C.prototype,O),C}(Zi);_c.prototype.size=20;var Hu=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.get=function(Q){return new _c(this,Q)},C}(df);Ie("CollisionBoxArray",Hu);var rc=function(E){function C(){E.apply(this,arguments)}E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C;var O={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return O.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},O.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},O.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},O.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},O.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},O.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},O.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},O.segment.get=function(){return this._structArray.uint16[this._pos2+10]},O.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},O.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},O.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},O.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},O.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},O.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},O.placedOrientation.set=function(Q){this._structArray.uint8[this._pos1+37]=Q},O.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},O.hidden.set=function(Q){this._structArray.uint8[this._pos1+38]=Q},O.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},O.crossTileID.set=function(Q){this._structArray.uint32[this._pos4+10]=Q},O.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(C.prototype,O),C}(Zi);rc.prototype.size=48;var nf=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.get=function(Q){return new rc(this,Q)},C}(gf);Ie("PlacedSymbolArray",nf);var wc=function(E){function C(){E.apply(this,arguments)}E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C;var O={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return O.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},O.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},O.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},O.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},O.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},O.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},O.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},O.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},O.key.get=function(){return this._structArray.uint16[this._pos2+8]},O.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},O.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},O.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},O.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},O.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},O.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},O.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},O.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},O.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},O.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},O.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},O.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},O.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},O.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},O.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},O.crossTileID.set=function(Q){this._structArray.uint32[this._pos4+12]=Q},O.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},O.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},O.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},O.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(C.prototype,O),C}(Zi);wc.prototype.size=68;var Tc=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.get=function(Q){return new wc(this,Q)},C}(Ef);Ie("SymbolInstanceArray",Tc);var Ul=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.getoffsetX=function(Q){return this.float32[Q*1+0]},C}(tf);Ie("GlyphOffsetArray",Ul);var Ac=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.getx=function(Q){return this.int16[Q*3+0]},C.prototype.gety=function(Q){return this.int16[Q*3+1]},C.prototype.gettileUnitDistanceFromAnchor=function(Q){return this.int16[Q*3+2]},C}(ec);Ie("SymbolLineVertexArray",Ac);var Mc=function(E){function C(){E.apply(this,arguments)}E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C;var O={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return O.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},O.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},O.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(C.prototype,O),C}(Zi);Mc.prototype.size=8;var nc=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.get=function(Q){return new Mc(this,Q)},C}(Nu);Ie("FeatureIndexArray",nc);var Sc=Do([{name:"a_pos",components:2,type:"Int16"}],4),ce=Sc.members,V=function(C){C===void 0&&(C=[]),this.segments=C};V.prototype.prepareSegment=function(C,O,Q,he){var me=this.segments[this.segments.length-1];return C>V.MAX_VERTEX_ARRAY_LENGTH&&B("Max vertices per segment is "+V.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+C),(!me||me.vertexLength+C>V.MAX_VERTEX_ARRAY_LENGTH||me.sortKey!==he)&&(me={vertexOffset:O.length,primitiveOffset:Q.length,vertexLength:0,primitiveLength:0},he!==void 0&&(me.sortKey=he),this.segments.push(me)),me},V.prototype.get=function(){return this.segments},V.prototype.destroy=function(){for(var C=0,O=this.segments;C<O.length;C+=1){var Q=O[C];for(var he in Q.vaos)Q.vaos[he].destroy()}},V.simpleSegment=function(C,O,Q,he){return new V([{vertexOffset:C,primitiveOffset:O,vertexLength:Q,primitiveLength:he,vaos:{},sortKey:0}])},V.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Ie("SegmentVector",V);function ve(E,C){return E=h(Math.floor(E),0,255),C=h(Math.floor(C),0,255),256*E+C}var j=Do([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint8"},{name:"a_pixel_ratio_to",components:1,type:"Uint8"}]),de=a(function(E){function C(O,Q){var he,me,we,Re,$e,ft,pt,It;for(he=O.length&3,me=O.length-he,we=Q,$e=3432918353,ft=461845907,It=0;It<me;)pt=O.charCodeAt(It)&255|(O.charCodeAt(++It)&255)<<8|(O.charCodeAt(++It)&255)<<16|(O.charCodeAt(++It)&255)<<24,++It,pt=(pt&65535)*$e+(((pt>>>16)*$e&65535)<<16)&4294967295,pt=pt<<15|pt>>>17,pt=(pt&65535)*ft+(((pt>>>16)*ft&65535)<<16)&4294967295,we^=pt,we=we<<13|we>>>19,Re=(we&65535)*5+(((we>>>16)*5&65535)<<16)&4294967295,we=(Re&65535)+27492+(((Re>>>16)+58964&65535)<<16);switch(pt=0,he){case 3:pt^=(O.charCodeAt(It+2)&255)<<16;case 2:pt^=(O.charCodeAt(It+1)&255)<<8;case 1:pt^=O.charCodeAt(It)&255,pt=(pt&65535)*$e+(((pt>>>16)*$e&65535)<<16)&4294967295,pt=pt<<15|pt>>>17,pt=(pt&65535)*ft+(((pt>>>16)*ft&65535)<<16)&4294967295,we^=pt}return we^=O.length,we^=we>>>16,we=(we&65535)*2246822507+(((we>>>16)*2246822507&65535)<<16)&4294967295,we^=we>>>13,we=(we&65535)*3266489909+(((we>>>16)*3266489909&65535)<<16)&4294967295,we^=we>>>16,we>>>0}E.exports=C}),Me=a(function(E){function C(O,Q){for(var he=O.length,me=Q^he,we=0,Re;he>=4;)Re=O.charCodeAt(we)&255|(O.charCodeAt(++we)&255)<<8|(O.charCodeAt(++we)&255)<<16|(O.charCodeAt(++we)&255)<<24,Re=(Re&65535)*1540483477+(((Re>>>16)*1540483477&65535)<<16),Re^=Re>>>24,Re=(Re&65535)*1540483477+(((Re>>>16)*1540483477&65535)<<16),me=(me&65535)*1540483477+(((me>>>16)*1540483477&65535)<<16)^Re,he-=4,++we;switch(he){case 3:me^=(O.charCodeAt(we+2)&255)<<16;case 2:me^=(O.charCodeAt(we+1)&255)<<8;case 1:me^=O.charCodeAt(we)&255,me=(me&65535)*1540483477+(((me>>>16)*1540483477&65535)<<16)}return me^=me>>>13,me=(me&65535)*1540483477+(((me>>>16)*1540483477&65535)<<16),me^=me>>>15,me>>>0}E.exports=C}),Ce=de,Ze=de,ut=Me;Ce.murmur3=Ze,Ce.murmur2=ut;var St=function(){this.ids=[],this.positions=[],this.indexed=!1};St.prototype.add=function(C,O,Q,he){this.ids.push(lr(C)),this.positions.push(O,Q,he)},St.prototype.getPositions=function(C){for(var O=lr(C),Q=0,he=this.ids.length-1;Q<he;){var me=Q+he>>1;this.ids[me]>=O?he=me:Q=me+1}for(var we=[];this.ids[Q]===O;){var Re=this.positions[3*Q],$e=this.positions[3*Q+1],ft=this.positions[3*Q+2];we.push({index:Re,start:$e,end:ft}),Q++}return we},St.serialize=function(C,O){var Q=new Float64Array(C.ids),he=new Uint32Array(C.positions);return vr(Q,he,0,Q.length-1),O&&O.push(Q.buffer,he.buffer),{ids:Q,positions:he}},St.deserialize=function(C){var O=new St;return O.ids=C.ids,O.positions=C.positions,O.indexed=!0,O};var jt=Math.pow(2,53)-1;function lr(E){var C=+E;return!isNaN(C)&&C<=jt?C:Ce(String(E))}function vr(E,C,O,Q){for(;O<Q;){for(var he=E[O+Q>>1],me=O-1,we=Q+1;;){do me++;while(E[me]<he);do we--;while(E[we]>he);if(me>=we)break;Er(E,me,we),Er(C,3*me,3*we),Er(C,3*me+1,3*we+1),Er(C,3*me+2,3*we+2)}we-O<Q-we?(vr(E,C,O,we),O=we+1):(vr(E,C,we+1,Q),Q=we)}}function Er(E,C,O){var Q=E[C];E[C]=E[O],E[O]=Q}Ie("FeaturePositionMap",St);var Vr=function(C,O){this.gl=C.gl,this.location=O},Gr=function(E){function C(O,Q){E.call(this,O,Q),this.current=0}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.set=function(Q){this.current!==Q&&(this.current=Q,this.gl.uniform1i(this.location,Q))},C}(Vr),Ur=function(E){function C(O,Q){E.call(this,O,Q),this.current=0}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.set=function(Q){this.current!==Q&&(this.current=Q,this.gl.uniform1f(this.location,Q))},C}(Vr),Kr=function(E){function C(O,Q){E.call(this,O,Q),this.current=[0,0]}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.set=function(Q){(Q[0]!==this.current[0]||Q[1]!==this.current[1])&&(this.current=Q,this.gl.uniform2f(this.location,Q[0],Q[1]))},C}(Vr),cn=function(E){function C(O,Q){E.call(this,O,Q),this.current=[0,0,0]}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.set=function(Q){(Q[0]!==this.current[0]||Q[1]!==this.current[1]||Q[2]!==this.current[2])&&(this.current=Q,this.gl.uniform3f(this.location,Q[0],Q[1],Q[2]))},C}(Vr),En=function(E){function C(O,Q){E.call(this,O,Q),this.current=[0,0,0,0]}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.set=function(Q){(Q[0]!==this.current[0]||Q[1]!==this.current[1]||Q[2]!==this.current[2]||Q[3]!==this.current[3])&&(this.current=Q,this.gl.uniform4f(this.location,Q[0],Q[1],Q[2],Q[3]))},C}(Vr),Fn=function(E){function C(O,Q){E.call(this,O,Q),this.current=vi.transparent}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.set=function(Q){(Q.r!==this.current.r||Q.g!==this.current.g||Q.b!==this.current.b||Q.a!==this.current.a)&&(this.current=Q,this.gl.uniform4f(this.location,Q.r,Q.g,Q.b,Q.a))},C}(Vr),Kn=new Float32Array(16),qn=function(E){function C(O,Q){E.call(this,O,Q),this.current=Kn}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.set=function(Q){if(Q[12]!==this.current[12]||Q[0]!==this.current[0]){this.current=Q,this.gl.uniformMatrix4fv(this.location,!1,Q);return}for(var he=1;he<16;he++)if(Q[he]!==this.current[he]){this.current=Q,this.gl.uniformMatrix4fv(this.location,!1,Q);break}},C}(Vr);function Qn(E){return[ve(255*E.r,255*E.g),ve(255*E.b,255*E.a)]}var ca=function(C,O,Q){this.value=C,this.uniformNames=O.map(function(he){return"u_"+he}),this.type=Q};ca.prototype.setUniform=function(C,O,Q){C.set(Q.constantOr(this.value))},ca.prototype.getBinding=function(C,O,Q){return this.type==="color"?new Fn(C,O):new Ur(C,O)};var ba=function(C,O){this.uniformNames=O.map(function(Q){return"u_"+Q}),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};ba.prototype.setConstantPatternPositions=function(C,O){this.pixelRatioFrom=O.pixelRatio,this.pixelRatioTo=C.pixelRatio,this.patternFrom=O.tlbr,this.patternTo=C.tlbr},ba.prototype.setUniform=function(C,O,Q,he){var me=he==="u_pattern_to"?this.patternTo:he==="u_pattern_from"?this.patternFrom:he==="u_pixel_ratio_to"?this.pixelRatioTo:he==="u_pixel_ratio_from"?this.pixelRatioFrom:null;me&&C.set(me)},ba.prototype.getBinding=function(C,O,Q){return Q.substr(0,9)==="u_pattern"?new En(C,O):new Ur(C,O)};var ya=function(C,O,Q,he){this.expression=C,this.type=Q,this.maxValue=0,this.paintVertexAttributes=O.map(function(me){return{name:"a_"+me,type:"Float32",components:Q==="color"?2:1,offset:0}}),this.paintVertexArray=new he};ya.prototype.populatePaintArray=function(C,O,Q,he,me){var we=this.paintVertexArray.length,Re=this.expression.evaluate(new si(0),O,{},he,[],me);this.paintVertexArray.resize(C),this._setPaintValue(we,C,Re)},ya.prototype.updatePaintArray=function(C,O,Q,he){var me=this.expression.evaluate({zoom:0},Q,he);this._setPaintValue(C,O,me)},ya.prototype._setPaintValue=function(C,O,Q){if(this.type==="color")for(var he=Qn(Q),me=C;me<O;me++)this.paintVertexArray.emplace(me,he[0],he[1]);else{for(var we=C;we<O;we++)this.paintVertexArray.emplace(we,Q);this.maxValue=Math.max(this.maxValue,Math.abs(Q))}},ya.prototype.upload=function(C){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=C.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},ya.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var Ta=function(C,O,Q,he,me,we){this.expression=C,this.uniformNames=O.map(function(Re){return"u_"+Re+"_t"}),this.type=Q,this.useIntegerZoom=he,this.zoom=me,this.maxValue=0,this.paintVertexAttributes=O.map(function(Re){return{name:"a_"+Re,type:"Float32",components:Q==="color"?4:2,offset:0}}),this.paintVertexArray=new we};Ta.prototype.populatePaintArray=function(C,O,Q,he,me){var we=this.expression.evaluate(new si(this.zoom),O,{},he,[],me),Re=this.expression.evaluate(new si(this.zoom+1),O,{},he,[],me),$e=this.paintVertexArray.length;this.paintVertexArray.resize(C),this._setPaintValue($e,C,we,Re)},Ta.prototype.updatePaintArray=function(C,O,Q,he){var me=this.expression.evaluate({zoom:this.zoom},Q,he),we=this.expression.evaluate({zoom:this.zoom+1},Q,he);this._setPaintValue(C,O,me,we)},Ta.prototype._setPaintValue=function(C,O,Q,he){if(this.type==="color")for(var me=Qn(Q),we=Qn(he),Re=C;Re<O;Re++)this.paintVertexArray.emplace(Re,me[0],me[1],we[0],we[1]);else{for(var $e=C;$e<O;$e++)this.paintVertexArray.emplace($e,Q,he);this.maxValue=Math.max(this.maxValue,Math.abs(Q),Math.abs(he))}},Ta.prototype.upload=function(C){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=C.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Ta.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},Ta.prototype.setUniform=function(C,O){var Q=this.useIntegerZoom?Math.floor(O.zoom):O.zoom,he=h(this.expression.interpolationFactor(Q,this.zoom,this.zoom+1),0,1);C.set(he)},Ta.prototype.getBinding=function(C,O,Q){return new Ur(C,O)};var Ea=function(C,O,Q,he,me,we){this.expression=C,this.type=O,this.useIntegerZoom=Q,this.zoom=he,this.layerId=we,this.zoomInPaintVertexArray=new me,this.zoomOutPaintVertexArray=new me};Ea.prototype.populatePaintArray=function(C,O,Q){var he=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(C),this.zoomOutPaintVertexArray.resize(C),this._setPaintValues(he,C,O.patterns&&O.patterns[this.layerId],Q)},Ea.prototype.updatePaintArray=function(C,O,Q,he,me){this._setPaintValues(C,O,Q.patterns&&Q.patterns[this.layerId],me)},Ea.prototype._setPaintValues=function(C,O,Q,he){if(!(!he||!Q)){var me=Q.min,we=Q.mid,Re=Q.max,$e=he[me],ft=he[we],pt=he[Re];if(!(!$e||!ft||!pt))for(var It=C;It<O;It++)this.zoomInPaintVertexArray.emplace(It,ft.tl[0],ft.tl[1],ft.br[0],ft.br[1],$e.tl[0],$e.tl[1],$e.br[0],$e.br[1],ft.pixelRatio,$e.pixelRatio),this.zoomOutPaintVertexArray.emplace(It,ft.tl[0],ft.tl[1],ft.br[0],ft.br[1],pt.tl[0],pt.tl[1],pt.br[0],pt.br[1],ft.pixelRatio,pt.pixelRatio)}},Ea.prototype.upload=function(C){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=C.createVertexBuffer(this.zoomInPaintVertexArray,j.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=C.createVertexBuffer(this.zoomOutPaintVertexArray,j.members,this.expression.isStateDependent))},Ea.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var Ha=function(C,O,Q,he){this.binders={},this.layoutAttributes=he,this._buffers=[];var me=[];for(var we in C.paint._values)if(!!Q(we)){var Re=C.paint.get(we);if(!(!(Re instanceof Gi)||!oi(Re.property.specification))){var $e=Li(we,C.type),ft=Re.value,pt=Re.property.specification.type,It=Re.property.useIntegerZoom,tr=Re.property.specification["property-type"],Qt=tr==="cross-faded"||tr==="cross-faded-data-driven";if(ft.kind==="constant")this.binders[we]=Qt?new ba(ft.value,$e):new ca(ft.value,$e,pt),me.push("/u_"+we);else if(ft.kind==="source"||Qt){var dr=pi(we,pt,"source");this.binders[we]=Qt?new Ea(ft,pt,It,O,dr,C.id):new ya(ft,$e,pt,dr),me.push("/a_"+we)}else{var Fr=pi(we,pt,"composite");this.binders[we]=new Ta(ft,$e,pt,It,O,Fr),me.push("/z_"+we)}}}this.cacheKey=me.sort().join("")};Ha.prototype.getMaxValue=function(C){var O=this.binders[C];return O instanceof ya||O instanceof Ta?O.maxValue:0},Ha.prototype.populatePaintArrays=function(C,O,Q,he,me){for(var we in this.binders){var Re=this.binders[we];(Re instanceof ya||Re instanceof Ta||Re instanceof Ea)&&Re.populatePaintArray(C,O,Q,he,me)}},Ha.prototype.setConstantPatternPositions=function(C,O){for(var Q in this.binders){var he=this.binders[Q];he instanceof ba&&he.setConstantPatternPositions(C,O)}},Ha.prototype.updatePaintArrays=function(C,O,Q,he,me){var we=!1;for(var Re in C)for(var $e=O.getPositions(Re),ft=0,pt=$e;ft<pt.length;ft+=1){var It=pt[ft],tr=Q.feature(It.index);for(var Qt in this.binders){var dr=this.binders[Qt];if((dr instanceof ya||dr instanceof Ta||dr instanceof Ea)&&dr.expression.isStateDependent===!0){var Fr=he.paint.get(Qt);dr.expression=Fr.value,dr.updatePaintArray(It.start,It.end,tr,C[Re],me),we=!0}}}return we},Ha.prototype.defines=function(){var C=[];for(var O in this.binders){var Q=this.binders[O];(Q instanceof ca||Q instanceof ba)&&C.push.apply(C,Q.uniformNames.map(function(he){return"#define HAS_UNIFORM_"+he}))}return C},Ha.prototype.getPaintVertexBuffers=function(){return this._buffers},Ha.prototype.getUniforms=function(C,O){var Q=[];for(var he in this.binders){var me=this.binders[he];if(me instanceof ca||me instanceof ba||me instanceof Ta)for(var we=0,Re=me.uniformNames;we<Re.length;we+=1){var $e=Re[we];if(O[$e]){var ft=me.getBinding(C,O[$e],$e);Q.push({name:$e,property:he,binding:ft})}}}return Q},Ha.prototype.setUniforms=function(C,O,Q,he){for(var me=0,we=O;me<we.length;me+=1){var Re=we[me],$e=Re.name,ft=Re.property,pt=Re.binding;this.binders[ft].setUniform(pt,he,Q.get(ft),$e)}},Ha.prototype.updatePaintBuffers=function(C){this._buffers=[];for(var O in this.binders){var Q=this.binders[O];if(C&&Q instanceof Ea){var he=C.fromScale===2?Q.zoomInPaintVertexBuffer:Q.zoomOutPaintVertexBuffer;he&&this._buffers.push(he)}else(Q instanceof ya||Q instanceof Ta)&&Q.paintVertexBuffer&&this._buffers.push(Q.paintVertexBuffer)}},Ha.prototype.upload=function(C){for(var O in this.binders){var Q=this.binders[O];(Q instanceof ya||Q instanceof Ta||Q instanceof Ea)&&Q.upload(C)}this.updatePaintBuffers()},Ha.prototype.destroy=function(){for(var C in this.binders){var O=this.binders[C];(O instanceof ya||O instanceof Ta||O instanceof Ea)&&O.destroy()}};var ni=function(C,O,Q,he){he===void 0&&(he=function(){return!0}),this.programConfigurations={};for(var me=0,we=O;me<we.length;me+=1){var Re=we[me];this.programConfigurations[Re.id]=new Ha(Re,Q,he,C)}this.needsUpload=!1,this._featureMap=new St,this._bufferOffset=0};ni.prototype.populatePaintArrays=function(C,O,Q,he,me,we){for(var Re in this.programConfigurations)this.programConfigurations[Re].populatePaintArrays(C,O,he,me,we);O.id!==void 0&&this._featureMap.add(O.id,Q,this._bufferOffset,C),this._bufferOffset=C,this.needsUpload=!0},ni.prototype.updatePaintArrays=function(C,O,Q,he){for(var me=0,we=Q;me<we.length;me+=1){var Re=we[me];this.needsUpload=this.programConfigurations[Re.id].updatePaintArrays(C,this._featureMap,O,Re,he)||this.needsUpload}},ni.prototype.get=function(C){return this.programConfigurations[C]},ni.prototype.upload=function(C){if(!!this.needsUpload){for(var O in this.programConfigurations)this.programConfigurations[O].upload(C);this.needsUpload=!1}},ni.prototype.destroy=function(){for(var C in this.programConfigurations)this.programConfigurations[C].destroy()};function Li(E,C){var O={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]};return O[E]||[E.replace(C+"-","").replace(/-/g,"_")]}function ui(E){var C={"line-pattern":{source:Os,composite:Os},"fill-pattern":{source:Os,composite:Os},"fill-extrusion-pattern":{source:Os,composite:Os}};return C[E]}function pi(E,C,O){var Q={color:{source:Uu,composite:tc},number:{source:tf,composite:Uu}},he=ui(E);return he&&he[O]||Q[C][O]}Ie("ConstantBinder",ca),Ie("CrossFadedConstantBinder",ba),Ie("SourceExpressionBinder",ya),Ie("CrossFadedCompositeBinder",Ea),Ie("CompositeExpressionBinder",Ta),Ie("ProgramConfiguration",Ha,{omit:["_buffers"]}),Ie("ProgramConfigurationSet",ni);var Ba=8192;function Pi(E){return{min:-1*Math.pow(2,E-1),max:Math.pow(2,E-1)-1}}var zi=Pi(15);function Ni(E){for(var C=Ba/E.extent,O=E.loadGeometry(),Q=0;Q<O.length;Q++)for(var he=O[Q],me=0;me<he.length;me++){var we=he[me];we.x=Math.round(we.x*C),we.y=Math.round(we.y*C),(we.x<zi.min||we.x>zi.max||we.y<zi.min||we.y>zi.max)&&(B("Geometry exceeds allowed extent, reduce your vector tile buffer size"),we.x=h(we.x,zi.min,zi.max),we.y=h(we.y,zi.min,zi.max))}return O}function _i(E,C,O,Q,he){E.emplaceBack(C*2+(Q+1)/2,O*2+(he+1)/2)}var ji=function(C){this.zoom=C.zoom,this.overscaling=C.overscaling,this.layers=C.layers,this.layerIds=this.layers.map(function(O){return O.id}),this.index=C.index,this.hasPattern=!1,this.layoutVertexArray=new pf,this.indexArray=new xu,this.segments=new V,this.programConfigurations=new ni(ce,C.layers,C.zoom),this.stateDependentLayerIds=this.layers.filter(function(O){return O.isStateDependent()}).map(function(O){return O.id})};ji.prototype.populate=function(C,O,Q){var he=this.layers[0],me=[],we=null;he.type==="circle"&&(we=he.layout.get("circle-sort-key"));for(var Re=0,$e=C;Re<$e.length;Re+=1){var ft=$e[Re],pt=ft.feature,It=ft.id,tr=ft.index,Qt=ft.sourceLayerIndex,dr=this.layers[0]._featureFilter.needGeometry,Fr={type:pt.type,id:It,properties:pt.properties,geometry:dr?Ni(pt):[]};if(!!this.layers[0]._featureFilter.filter(new si(this.zoom),Fr,Q)){dr||(Fr.geometry=Ni(pt));var an=we?we.evaluate(Fr,{},Q):void 0,$r={id:It,properties:pt.properties,type:pt.type,sourceLayerIndex:Qt,index:tr,geometry:Fr.geometry,patterns:{},sortKey:an};me.push($r)}}we&&me.sort(function(wa,Ma){return wa.sortKey-Ma.sortKey});for(var kn=0,mn=me;kn<mn.length;kn+=1){var Sn=mn[kn],In=Sn,Gn=In.geometry,oa=In.index,na=In.sourceLayerIndex,Ra=C[oa].feature;this.addFeature(Sn,Gn,oa,Q),O.featureIndex.insert(Ra,Gn,oa,na,this.index)}},ji.prototype.update=function(C,O,Q){!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(C,O,this.stateDependentLayers,Q)},ji.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},ji.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},ji.prototype.upload=function(C){this.uploaded||(this.layoutVertexBuffer=C.createVertexBuffer(this.layoutVertexArray,ce),this.indexBuffer=C.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(C),this.uploaded=!0},ji.prototype.destroy=function(){!this.layoutVertexBuffer||(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},ji.prototype.addFeature=function(C,O,Q,he){for(var me=0,we=O;me<we.length;me+=1)for(var Re=we[me],$e=0,ft=Re;$e<ft.length;$e+=1){var pt=ft[$e],It=pt.x,tr=pt.y;if(!(It<0||It>=Ba||tr<0||tr>=Ba)){var Qt=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,C.sortKey),dr=Qt.vertexLength;_i(this.layoutVertexArray,It,tr,-1,-1),_i(this.layoutVertexArray,It,tr,1,-1),_i(this.layoutVertexArray,It,tr,1,1),_i(this.layoutVertexArray,It,tr,-1,1),this.indexArray.emplaceBack(dr,dr+1,dr+2),this.indexArray.emplaceBack(dr,dr+3,dr+2),Qt.vertexLength+=4,Qt.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,C,Q,{},he)},Ie("CircleBucket",ji,{omit:["layers"]});function ii(E,C){for(var O=0;O<E.length;O++)if(Bs(C,E[O]))return!0;for(var Q=0;Q<C.length;Q++)if(Bs(E,C[Q]))return!0;return!!Sl(E,C)}function wi(E,C,O){return!!(Bs(E,C)||$l(C,E,O))}function _o(E,C){if(E.length===1)return ql(C,E[0]);for(var O=0;O<C.length;O++)for(var Q=C[O],he=0;he<Q.length;he++)if(Bs(E,Q[he]))return!0;for(var me=0;me<E.length;me++)if(ql(C,E[me]))return!0;for(var we=0;we<C.length;we++)if(Sl(E,C[we]))return!0;return!1}function Oo(E,C,O){for(var Q=0;Q<C.length;Q++){var he=C[Q];if(E.length>=3){for(var me=0;me<he.length;me++)if(Bs(E,he[me]))return!0}if(Ml(E,he,O))return!0}return!1}function Ml(E,C,O){if(E.length>1){if(Sl(E,C))return!0;for(var Q=0;Q<C.length;Q++)if($l(C[Q],E,O))return!0}for(var he=0;he<E.length;he++)if($l(E[he],C,O))return!0;return!1}function Sl(E,C){if(E.length===0||C.length===0)return!1;for(var O=0;O<E.length-1;O++)for(var Q=E[O],he=E[O+1],me=0;me<C.length-1;me++){var we=C[me],Re=C[me+1];if(Ql(Q,he,we,Re))return!0}return!1}function Ql(E,C,O,Q){return F(E,O,Q)!==F(C,O,Q)&&F(E,C,O)!==F(E,C,Q)}function $l(E,C,O){var Q=O*O;if(C.length===1)return E.distSqr(C[0])<Q;for(var he=1;he<C.length;he++){var me=C[he-1],we=C[he];if(bu(E,me,we)<Q)return!0}return!1}function bu(E,C,O){var Q=C.distSqr(O);if(Q===0)return E.distSqr(C);var he=((E.x-C.x)*(O.x-C.x)+(E.y-C.y)*(O.y-C.y))/Q;return he<0?E.distSqr(C):he>1?E.distSqr(O):E.distSqr(O.sub(C)._mult(he)._add(C))}function ql(E,C){for(var O=!1,Q,he,me,we=0;we<E.length;we++){Q=E[we];for(var Re=0,$e=Q.length-1;Re<Q.length;$e=Re++)he=Q[Re],me=Q[$e],he.y>C.y!=me.y>C.y&&C.x<(me.x-he.x)*(C.y-he.y)/(me.y-he.y)+he.x&&(O=!O)}return O}function Bs(E,C){for(var O=!1,Q=0,he=E.length-1;Q<E.length;he=Q++){var me=E[Q],we=E[he];me.y>C.y!=we.y>C.y&&C.x<(we.x-me.x)*(C.y-me.y)/(we.y-me.y)+me.x&&(O=!O)}return O}function Vu(E,C,O,Q,he){for(var me=0,we=E;me<we.length;me+=1){var Re=we[me];if(C<=Re.x&&O<=Re.y&&Q>=Re.x&&he>=Re.y)return!0}var $e=[new c(C,O),new c(C,he),new c(Q,he),new c(Q,O)];if(E.length>2)for(var ft=0,pt=$e;ft<pt.length;ft+=1){var It=pt[ft];if(Bs(E,It))return!0}for(var tr=0;tr<E.length-1;tr++){var Qt=E[tr],dr=E[tr+1];if(bs(Qt,dr,$e))return!0}return!1}function bs(E,C,O){var Q=O[0],he=O[2];if(E.x<Q.x&&C.x<Q.x||E.x>he.x&&C.x>he.x||E.y<Q.y&&C.y<Q.y||E.y>he.y&&C.y>he.y)return!1;var me=F(E,C,O[0]);return me!==F(E,C,O[1])||me!==F(E,C,O[2])||me!==F(E,C,O[3])}function fl(E,C,O){var Q=C.paint.get(E).value;return Q.kind==="constant"?Q.value:O.programConfigurations.get(C.id).getMaxValue(E)}function eu(E){return Math.sqrt(E[0]*E[0]+E[1]*E[1])}function Hl(E,C,O,Q,he){if(!C[0]&&!C[1])return E;var me=c.convert(C)._mult(he);O==="viewport"&&me._rotate(-Q);for(var we=[],Re=0;Re<E.length;Re++){var $e=E[Re];we.push($e.sub(me))}return we}var tu=new Xi({"circle-sort-key":new Za(Bt.layout_circle["circle-sort-key"])}),Cf=new Xi({"circle-radius":new Za(Bt.paint_circle["circle-radius"]),"circle-color":new Za(Bt.paint_circle["circle-color"]),"circle-blur":new Za(Bt.paint_circle["circle-blur"]),"circle-opacity":new Za(Bt.paint_circle["circle-opacity"]),"circle-translate":new Ia(Bt.paint_circle["circle-translate"]),"circle-translate-anchor":new Ia(Bt.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Ia(Bt.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Ia(Bt.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Za(Bt.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Za(Bt.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Za(Bt.paint_circle["circle-stroke-opacity"])}),Zu={paint:Cf,layout:tu},cs=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var E=arguments,C=0,O=arguments.length;O--;)C+=E[O]*E[O];return Math.sqrt(C)});function mf(){var E=new cs(4);return cs!=Float32Array&&(E[1]=0,E[2]=0),E[0]=1,E[3]=1,E}function Es(E,C,O){var Q=C[0],he=C[1],me=C[2],we=C[3],Re=Math.sin(O),$e=Math.cos(O);return E[0]=Q*$e+me*Re,E[1]=he*$e+we*Re,E[2]=Q*-Re+me*$e,E[3]=he*-Re+we*$e,E}function xf(){var E=new cs(9);return cs!=Float32Array&&(E[1]=0,E[2]=0,E[3]=0,E[5]=0,E[6]=0,E[7]=0),E[0]=1,E[4]=1,E[8]=1,E}function Lf(E,C){var O=Math.sin(C),Q=Math.cos(C);return E[0]=Q,E[1]=O,E[2]=0,E[3]=-O,E[4]=Q,E[5]=0,E[6]=0,E[7]=0,E[8]=1,E}function Pf(){var E=new cs(16);return cs!=Float32Array&&(E[1]=0,E[2]=0,E[3]=0,E[4]=0,E[6]=0,E[7]=0,E[8]=0,E[9]=0,E[11]=0,E[12]=0,E[13]=0,E[14]=0),E[0]=1,E[5]=1,E[10]=1,E[15]=1,E}function kc(E){var C=new cs(16);return C[0]=E[0],C[1]=E[1],C[2]=E[2],C[3]=E[3],C[4]=E[4],C[5]=E[5],C[6]=E[6],C[7]=E[7],C[8]=E[8],C[9]=E[9],C[10]=E[10],C[11]=E[11],C[12]=E[12],C[13]=E[13],C[14]=E[14],C[15]=E[15],C}function Df(E){return E[0]=1,E[1]=0,E[2]=0,E[3]=0,E[4]=0,E[5]=1,E[6]=0,E[7]=0,E[8]=0,E[9]=0,E[10]=1,E[11]=0,E[12]=0,E[13]=0,E[14]=0,E[15]=1,E}function af(E,C){var O=C[0],Q=C[1],he=C[2],me=C[3],we=C[4],Re=C[5],$e=C[6],ft=C[7],pt=C[8],It=C[9],tr=C[10],Qt=C[11],dr=C[12],Fr=C[13],an=C[14],$r=C[15],kn=O*Re-Q*we,mn=O*$e-he*we,Sn=O*ft-me*we,In=Q*$e-he*Re,Gn=Q*ft-me*Re,oa=he*ft-me*$e,na=pt*Fr-It*dr,Ra=pt*an-tr*dr,wa=pt*$r-Qt*dr,Ma=It*an-tr*Fr,ti=It*$r-Qt*Fr,Ca=tr*$r-Qt*an,Da=kn*Ca-mn*ti+Sn*Ma+In*wa-Gn*Ra+oa*na;return Da?(Da=1/Da,E[0]=(Re*Ca-$e*ti+ft*Ma)*Da,E[1]=(he*ti-Q*Ca-me*Ma)*Da,E[2]=(Fr*oa-an*Gn+$r*In)*Da,E[3]=(tr*Gn-It*oa-Qt*In)*Da,E[4]=($e*wa-we*Ca-ft*Ra)*Da,E[5]=(O*Ca-he*wa+me*Ra)*Da,E[6]=(an*Sn-dr*oa-$r*mn)*Da,E[7]=(pt*oa-tr*Sn+Qt*mn)*Da,E[8]=(we*ti-Re*wa+ft*na)*Da,E[9]=(Q*wa-O*ti-me*na)*Da,E[10]=(dr*Gn-Fr*Sn+$r*kn)*Da,E[11]=(It*Sn-pt*Gn-Qt*kn)*Da,E[12]=(Re*Ra-we*Ma-$e*na)*Da,E[13]=(O*Ma-Q*Ra+he*na)*Da,E[14]=(Fr*mn-dr*In-an*kn)*Da,E[15]=(pt*In-It*mn+tr*kn)*Da,E):null}function of(E,C,O){var Q=C[0],he=C[1],me=C[2],we=C[3],Re=C[4],$e=C[5],ft=C[6],pt=C[7],It=C[8],tr=C[9],Qt=C[10],dr=C[11],Fr=C[12],an=C[13],$r=C[14],kn=C[15],mn=O[0],Sn=O[1],In=O[2],Gn=O[3];return E[0]=mn*Q+Sn*Re+In*It+Gn*Fr,E[1]=mn*he+Sn*$e+In*tr+Gn*an,E[2]=mn*me+Sn*ft+In*Qt+Gn*$r,E[3]=mn*we+Sn*pt+In*dr+Gn*kn,mn=O[4],Sn=O[5],In=O[6],Gn=O[7],E[4]=mn*Q+Sn*Re+In*It+Gn*Fr,E[5]=mn*he+Sn*$e+In*tr+Gn*an,E[6]=mn*me+Sn*ft+In*Qt+Gn*$r,E[7]=mn*we+Sn*pt+In*dr+Gn*kn,mn=O[8],Sn=O[9],In=O[10],Gn=O[11],E[8]=mn*Q+Sn*Re+In*It+Gn*Fr,E[9]=mn*he+Sn*$e+In*tr+Gn*an,E[10]=mn*me+Sn*ft+In*Qt+Gn*$r,E[11]=mn*we+Sn*pt+In*dr+Gn*kn,mn=O[12],Sn=O[13],In=O[14],Gn=O[15],E[12]=mn*Q+Sn*Re+In*It+Gn*Fr,E[13]=mn*he+Sn*$e+In*tr+Gn*an,E[14]=mn*me+Sn*ft+In*Qt+Gn*$r,E[15]=mn*we+Sn*pt+In*dr+Gn*kn,E}function Eo(E,C,O){var Q=O[0],he=O[1],me=O[2],we,Re,$e,ft,pt,It,tr,Qt,dr,Fr,an,$r;return C===E?(E[12]=C[0]*Q+C[4]*he+C[8]*me+C[12],E[13]=C[1]*Q+C[5]*he+C[9]*me+C[13],E[14]=C[2]*Q+C[6]*he+C[10]*me+C[14],E[15]=C[3]*Q+C[7]*he+C[11]*me+C[15]):(we=C[0],Re=C[1],$e=C[2],ft=C[3],pt=C[4],It=C[5],tr=C[6],Qt=C[7],dr=C[8],Fr=C[9],an=C[10],$r=C[11],E[0]=we,E[1]=Re,E[2]=$e,E[3]=ft,E[4]=pt,E[5]=It,E[6]=tr,E[7]=Qt,E[8]=dr,E[9]=Fr,E[10]=an,E[11]=$r,E[12]=we*Q+pt*he+dr*me+C[12],E[13]=Re*Q+It*he+Fr*me+C[13],E[14]=$e*Q+tr*he+an*me+C[14],E[15]=ft*Q+Qt*he+$r*me+C[15]),E}function $s(E,C,O){var Q=O[0],he=O[1],me=O[2];return E[0]=C[0]*Q,E[1]=C[1]*Q,E[2]=C[2]*Q,E[3]=C[3]*Q,E[4]=C[4]*he,E[5]=C[5]*he,E[6]=C[6]*he,E[7]=C[7]*he,E[8]=C[8]*me,E[9]=C[9]*me,E[10]=C[10]*me,E[11]=C[11]*me,E[12]=C[12],E[13]=C[13],E[14]=C[14],E[15]=C[15],E}function qs(E,C,O){var Q=Math.sin(O),he=Math.cos(O),me=C[4],we=C[5],Re=C[6],$e=C[7],ft=C[8],pt=C[9],It=C[10],tr=C[11];return C!==E&&(E[0]=C[0],E[1]=C[1],E[2]=C[2],E[3]=C[3],E[12]=C[12],E[13]=C[13],E[14]=C[14],E[15]=C[15]),E[4]=me*he+ft*Q,E[5]=we*he+pt*Q,E[6]=Re*he+It*Q,E[7]=$e*he+tr*Q,E[8]=ft*he-me*Q,E[9]=pt*he-we*Q,E[10]=It*he-Re*Q,E[11]=tr*he-$e*Q,E}function Rf(E,C,O){var Q=Math.sin(O),he=Math.cos(O),me=C[0],we=C[1],Re=C[2],$e=C[3],ft=C[4],pt=C[5],It=C[6],tr=C[7];return C!==E&&(E[8]=C[8],E[9]=C[9],E[10]=C[10],E[11]=C[11],E[12]=C[12],E[13]=C[13],E[14]=C[14],E[15]=C[15]),E[0]=me*he+ft*Q,E[1]=we*he+pt*Q,E[2]=Re*he+It*Q,E[3]=$e*he+tr*Q,E[4]=ft*he-me*Q,E[5]=pt*he-we*Q,E[6]=It*he-Re*Q,E[7]=tr*he-$e*Q,E}function ac(E,C,O,Q,he){var me=1/Math.tan(C/2),we;return E[0]=me/O,E[1]=0,E[2]=0,E[3]=0,E[4]=0,E[5]=me,E[6]=0,E[7]=0,E[8]=0,E[9]=0,E[11]=-1,E[12]=0,E[13]=0,E[15]=0,he!=null&&he!==1/0?(we=1/(Q-he),E[10]=(he+Q)*we,E[14]=2*he*Q*we):(E[10]=-1,E[14]=-2*Q),E}function Qc(E,C,O,Q,he,me,we){var Re=1/(C-O),$e=1/(Q-he),ft=1/(me-we);return E[0]=-2*Re,E[1]=0,E[2]=0,E[3]=0,E[4]=0,E[5]=-2*$e,E[6]=0,E[7]=0,E[8]=0,E[9]=0,E[10]=2*ft,E[11]=0,E[12]=(C+O)*Re,E[13]=(he+Q)*$e,E[14]=(we+me)*ft,E[15]=1,E}var $c=of;function bf(){var E=new cs(3);return cs!=Float32Array&&(E[0]=0,E[1]=0,E[2]=0),E}function qc(E){var C=new cs(3);return C[0]=E[0],C[1]=E[1],C[2]=E[2],C}function If(E,C,O){return E[0]=C[0]+O[0],E[1]=C[1]+O[1],E[2]=C[2]+O[2],E}function eh(E,C,O){return E[0]=C[0]-O[0],E[1]=C[1]-O[1],E[2]=C[2]-O[2],E}function th(E,C,O){return E[0]=C[0]*O,E[1]=C[1]*O,E[2]=C[2]*O,E}function ic(E,C){var O=C[0],Q=C[1],he=C[2],me=O*O+Q*Q+he*he;return me>0&&(me=1/Math.sqrt(me)),E[0]=C[0]*me,E[1]=C[1]*me,E[2]=C[2]*me,E}function Gv(E,C){return E[0]*C[0]+E[1]*C[1]+E[2]*C[2]}function Yv(E,C,O){var Q=C[0],he=C[1],me=C[2],we=O[0],Re=O[1],$e=O[2];return E[0]=he*$e-me*Re,E[1]=me*we-Q*$e,E[2]=Q*Re-he*we,E}function Wv(E,C,O){var Q=C[0],he=C[1],me=C[2];return E[0]=Q*O[0]+he*O[3]+me*O[6],E[1]=Q*O[1]+he*O[4]+me*O[7],E[2]=Q*O[2]+he*O[5]+me*O[8],E}var Xv=eh;(function(){var E=bf();return function(C,O,Q,he,me,we){var Re,$e;for(O||(O=3),Q||(Q=0),he?$e=Math.min(he*O+Q,C.length):$e=C.length,Re=Q;Re<$e;Re+=O)E[0]=C[Re],E[1]=C[Re+1],E[2]=C[Re+2],me(E,E,we),C[Re]=E[0],C[Re+1]=E[1],C[Re+2]=E[2];return C}})();function Zv(){var E=new cs(4);return cs!=Float32Array&&(E[0]=0,E[1]=0,E[2]=0,E[3]=0),E}function jv(E,C,O){return E[0]=C[0]*O,E[1]=C[1]*O,E[2]=C[2]*O,E[3]=C[3]*O,E}function Kv(E,C){return E[0]*C[0]+E[1]*C[1]+E[2]*C[2]+E[3]*C[3]}function Ec(E,C,O){var Q=C[0],he=C[1],me=C[2],we=C[3];return E[0]=O[0]*Q+O[4]*he+O[8]*me+O[12]*we,E[1]=O[1]*Q+O[5]*he+O[9]*me+O[13]*we,E[2]=O[2]*Q+O[6]*he+O[10]*me+O[14]*we,E[3]=O[3]*Q+O[7]*he+O[11]*me+O[15]*we,E}(function(){var E=Zv();return function(C,O,Q,he,me,we){var Re,$e;for(O||(O=4),Q||(Q=0),he?$e=Math.min(he*O+Q,C.length):$e=C.length,Re=Q;Re<$e;Re+=O)E[0]=C[Re],E[1]=C[Re+1],E[2]=C[Re+2],E[3]=C[Re+3],me(E,E,we),C[Re]=E[0],C[Re+1]=E[1],C[Re+2]=E[2],C[Re+3]=E[3];return C}})();function Jv(){var E=new cs(2);return cs!=Float32Array&&(E[0]=0,E[1]=0),E}function Qv(E){var C=E[0],O=E[1];return C*C+O*O}var $v=Qv;(function(){var E=Jv();return function(C,O,Q,he,me,we){var Re,$e;for(O||(O=2),Q||(Q=0),he?$e=Math.min(he*O+Q,C.length):$e=C.length,Re=Q;Re<$e;Re+=O)E[0]=C[Re],E[1]=C[Re+1],me(E,E,we),C[Re]=E[0],C[Re+1]=E[1];return C}})();var qv=function(E){function C(O){E.call(this,O,Zu)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.createBucket=function(Q){return new ji(Q)},C.prototype.queryRadius=function(Q){var he=Q;return fl("circle-radius",this,he)+fl("circle-stroke-width",this,he)+eu(this.paint.get("circle-translate"))},C.prototype.queryIntersectsFeature=function(Q,he,me,we,Re,$e,ft,pt){for(var It=Hl(Q,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),$e.angle,ft),tr=this.paint.get("circle-radius").evaluate(he,me),Qt=this.paint.get("circle-stroke-width").evaluate(he,me),dr=tr+Qt,Fr=this.paint.get("circle-pitch-alignment")==="map",an=Fr?It:ep(It,pt),$r=Fr?dr*ft:dr,kn=0,mn=we;kn<mn.length;kn+=1)for(var Sn=mn[kn],In=0,Gn=Sn;In<Gn.length;In+=1){var oa=Gn[In],na=Fr?oa:kh(oa,pt),Ra=$r,wa=Ec([],[oa.x,oa.y,0,1],pt);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?Ra*=wa[3]/$e.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(Ra*=$e.cameraToCenterDistance/wa[3]),wi(an,na,Ra))return!0}return!1},C}(xs);function kh(E,C){var O=Ec([],[E.x,E.y,0,1],C);return new c(O[0]/O[3],O[1]/O[3])}function ep(E,C){return E.map(function(O){return kh(O,C)})}var Eh=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C}(ji);Ie("HeatmapBucket",Eh,{omit:["layers"]});function rh(E,C,O,Q){var he=C.width,me=C.height;if(!Q)Q=new Uint8Array(he*me*O);else if(Q instanceof Uint8ClampedArray)Q=new Uint8Array(Q.buffer);else if(Q.length!==he*me*O)throw new RangeError("mismatched image size");return E.width=he,E.height=me,E.data=Q,E}function Ch(E,C,O){var Q=C.width,he=C.height;if(!(Q===E.width&&he===E.height)){var me=rh({},{width:Q,height:he},O);nh(E,me,{x:0,y:0},{x:0,y:0},{width:Math.min(E.width,Q),height:Math.min(E.height,he)},O),E.width=Q,E.height=he,E.data=me.data}}function nh(E,C,O,Q,he,me){if(he.width===0||he.height===0)return C;if(he.width>E.width||he.height>E.height||O.x>E.width-he.width||O.y>E.height-he.height)throw new RangeError("out of range source coordinates for image copy");if(he.width>C.width||he.height>C.height||Q.x>C.width-he.width||Q.y>C.height-he.height)throw new RangeError("out of range destination coordinates for image copy");for(var we=E.data,Re=C.data,$e=0;$e<he.height;$e++)for(var ft=((O.y+$e)*E.width+O.x)*me,pt=((Q.y+$e)*C.width+Q.x)*me,It=0;It<he.width*me;It++)Re[pt+It]=we[ft+It];return C}var _f=function(C,O){rh(this,C,1,O)};_f.prototype.resize=function(C){Ch(this,C,1)},_f.prototype.clone=function(){return new _f({width:this.width,height:this.height},new Uint8Array(this.data))},_f.copy=function(C,O,Q,he,me){nh(C,O,Q,he,me,1)};var el=function(C,O){rh(this,C,4,O)};el.prototype.resize=function(C){Ch(this,C,4)},el.prototype.replace=function(C,O){O?this.data.set(C):C instanceof Uint8ClampedArray?this.data=new Uint8Array(C.buffer):this.data=C},el.prototype.clone=function(){return new el({width:this.width,height:this.height},new Uint8Array(this.data))},el.copy=function(C,O,Q,he,me){nh(C,O,Q,he,me,4)},Ie("AlphaImage",_f),Ie("RGBAImage",el);var tp=new Xi({"heatmap-radius":new Za(Bt.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Za(Bt.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Ia(Bt.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Po(Bt.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Ia(Bt.paint_heatmap["heatmap-opacity"])}),rp={paint:tp};function Lh(E,C){for(var O=new Uint8Array(1024),Q={},he=0,me=0;he<256;he++,me+=4){Q[C]=he/255;var we=E.evaluate(Q);O[me+0]=Math.floor(we.r*255/we.a),O[me+1]=Math.floor(we.g*255/we.a),O[me+2]=Math.floor(we.b*255/we.a),O[me+3]=Math.floor(we.a*255)}return new el({width:256,height:1},O)}var np=function(E){function C(O){E.call(this,O,rp),this._updateColorRamp()}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.createBucket=function(Q){return new Eh(Q)},C.prototype._handleSpecialPaintPropertyUpdate=function(Q){Q==="heatmap-color"&&this._updateColorRamp()},C.prototype._updateColorRamp=function(){var Q=this._transitionablePaint._values["heatmap-color"].value.expression;this.colorRamp=Lh(Q,"heatmapDensity"),this.colorRampTexture=null},C.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},C.prototype.queryRadius=function(){return 0},C.prototype.queryIntersectsFeature=function(){return!1},C.prototype.hasOffscreenPass=function(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"},C}(xs),ap=new Xi({"hillshade-illumination-direction":new Ia(Bt.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Ia(Bt.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Ia(Bt.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Ia(Bt.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Ia(Bt.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Ia(Bt.paint_hillshade["hillshade-accent-color"])}),ip={paint:ap},op=function(E){function C(O){E.call(this,O,ip)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.hasOffscreenPass=function(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"},C}(xs),sp=Do([{name:"a_pos",components:2,type:"Int16"}],4),Ph=sp.members,ah=Cc,lp=Cc;function Cc(E,C,O){O=O||2;var Q=C&&C.length,he=Q?C[0]*O:E.length,me=Dh(E,0,he,O,!0),we=[];if(!me||me.next===me.prev)return we;var Re,$e,ft,pt,It,tr,Qt;if(Q&&(me=vp(E,C,me,O)),E.length>80*O){Re=ft=E[0],$e=pt=E[1];for(var dr=O;dr<he;dr+=O)It=E[dr],tr=E[dr+1],It<Re&&(Re=It),tr<$e&&($e=tr),It>ft&&(ft=It),tr>pt&&(pt=tr);Qt=Math.max(ft-Re,pt-$e),Qt=Qt!==0?1/Qt:0}return oc(me,we,O,Re,$e,Qt),we}function Dh(E,C,O,Q,he){var me,we;if(he===sh(E,C,O,Q)>0)for(me=C;me<O;me+=Q)we=zh(me,E[me],E[me+1],we);else for(me=O-Q;me>=C;me-=Q)we=zh(me,E[me],E[me+1],we);return we&&Lc(we,we.next)&&(lc(we),we=we.next),we}function sf(E,C){if(!E)return E;C||(C=E);var O=E,Q;do if(Q=!1,!O.steiner&&(Lc(O,O.next)||Bo(O.prev,O,O.next)===0)){if(lc(O),O=C=O.prev,O===O.next)break;Q=!0}else O=O.next;while(Q||O!==C);return C}function oc(E,C,O,Q,he,me,we){if(!!E){!we&&me&&mp(E,Q,he,me);for(var Re=E,$e,ft;E.prev!==E.next;){if($e=E.prev,ft=E.next,me?fp(E,Q,he,me):up(E)){C.push($e.i/O),C.push(E.i/O),C.push(ft.i/O),lc(E),E=ft.next,Re=ft.next;continue}if(E=ft,E===Re){we?we===1?(E=cp(sf(E),C,O),oc(E,C,O,Q,he,me,2)):we===2&&hp(E,C,O,Q,he,me):oc(sf(E),C,O,Q,he,me,1);break}}}}function up(E){var C=E.prev,O=E,Q=E.next;if(Bo(C,O,Q)>=0)return!1;for(var he=E.next.next;he!==E.prev;){if(zf(C.x,C.y,O.x,O.y,Q.x,Q.y,he.x,he.y)&&Bo(he.prev,he,he.next)>=0)return!1;he=he.next}return!0}function fp(E,C,O,Q){var he=E.prev,me=E,we=E.next;if(Bo(he,me,we)>=0)return!1;for(var Re=he.x<me.x?he.x<we.x?he.x:we.x:me.x<we.x?me.x:we.x,$e=he.y<me.y?he.y<we.y?he.y:we.y:me.y<we.y?me.y:we.y,ft=he.x>me.x?he.x>we.x?he.x:we.x:me.x>we.x?me.x:we.x,pt=he.y>me.y?he.y>we.y?he.y:we.y:me.y>we.y?me.y:we.y,It=ih(Re,$e,C,O,Q),tr=ih(ft,pt,C,O,Q),Qt=E.prevZ,dr=E.nextZ;Qt&&Qt.z>=It&&dr&&dr.z<=tr;){if(Qt!==E.prev&&Qt!==E.next&&zf(he.x,he.y,me.x,me.y,we.x,we.y,Qt.x,Qt.y)&&Bo(Qt.prev,Qt,Qt.next)>=0||(Qt=Qt.prevZ,dr!==E.prev&&dr!==E.next&&zf(he.x,he.y,me.x,me.y,we.x,we.y,dr.x,dr.y)&&Bo(dr.prev,dr,dr.next)>=0))return!1;dr=dr.nextZ}for(;Qt&&Qt.z>=It;){if(Qt!==E.prev&&Qt!==E.next&&zf(he.x,he.y,me.x,me.y,we.x,we.y,Qt.x,Qt.y)&&Bo(Qt.prev,Qt,Qt.next)>=0)return!1;Qt=Qt.prevZ}for(;dr&&dr.z<=tr;){if(dr!==E.prev&&dr!==E.next&&zf(he.x,he.y,me.x,me.y,we.x,we.y,dr.x,dr.y)&&Bo(dr.prev,dr,dr.next)>=0)return!1;dr=dr.nextZ}return!0}function cp(E,C,O){var Q=E;do{var he=Q.prev,me=Q.next.next;!Lc(he,me)&&Rh(he,Q,Q.next,me)&&sc(he,me)&&sc(me,he)&&(C.push(he.i/O),C.push(Q.i/O),C.push(me.i/O),lc(Q),lc(Q.next),Q=E=me),Q=Q.next}while(Q!==E);return sf(Q)}function hp(E,C,O,Q,he,me){var we=E;do{for(var Re=we.next.next;Re!==we.prev;){if(we.i!==Re.i&&_p(we,Re)){var $e=Ih(we,Re);we=sf(we,we.next),$e=sf($e,$e.next),oc(we,C,O,Q,he,me),oc($e,C,O,Q,he,me);return}Re=Re.next}we=we.next}while(we!==E)}function vp(E,C,O,Q){var he=[],me,we,Re,$e,ft;for(me=0,we=C.length;me<we;me++)Re=C[me]*Q,$e=me<we-1?C[me+1]*Q:E.length,ft=Dh(E,Re,$e,Q,!1),ft===ft.next&&(ft.steiner=!0),he.push(bp(ft));for(he.sort(pp),me=0;me<he.length;me++)dp(he[me],O),O=sf(O,O.next);return O}function pp(E,C){return E.x-C.x}function dp(E,C){if(C=gp(E,C),C){var O=Ih(C,E);sf(C,C.next),sf(O,O.next)}}function gp(E,C){var O=C,Q=E.x,he=E.y,me=-1/0,we;do{if(he<=O.y&&he>=O.next.y&&O.next.y!==O.y){var Re=O.x+(he-O.y)*(O.next.x-O.x)/(O.next.y-O.y);if(Re<=Q&&Re>me){if(me=Re,Re===Q){if(he===O.y)return O;if(he===O.next.y)return O.next}we=O.x<O.next.x?O:O.next}}O=O.next}while(O!==C);if(!we)return null;if(Q===me)return we;var $e=we,ft=we.x,pt=we.y,It=1/0,tr;O=we;do Q>=O.x&&O.x>=ft&&Q!==O.x&&zf(he<pt?Q:me,he,ft,pt,he<pt?me:Q,he,O.x,O.y)&&(tr=Math.abs(he-O.y)/(Q-O.x),sc(O,E)&&(tr<It||tr===It&&(O.x>we.x||O.x===we.x&&yp(we,O)))&&(we=O,It=tr)),O=O.next;while(O!==$e);return we}function yp(E,C){return Bo(E.prev,E,C.prev)<0&&Bo(C.next,E,E.next)<0}function mp(E,C,O,Q){var he=E;do he.z===null&&(he.z=ih(he.x,he.y,C,O,Q)),he.prevZ=he.prev,he.nextZ=he.next,he=he.next;while(he!==E);he.prevZ.nextZ=null,he.prevZ=null,xp(he)}function xp(E){var C,O,Q,he,me,we,Re,$e,ft=1;do{for(O=E,E=null,me=null,we=0;O;){for(we++,Q=O,Re=0,C=0;C<ft&&(Re++,Q=Q.nextZ,!!Q);C++);for($e=ft;Re>0||$e>0&&Q;)Re!==0&&($e===0||!Q||O.z<=Q.z)?(he=O,O=O.nextZ,Re--):(he=Q,Q=Q.nextZ,$e--),me?me.nextZ=he:E=he,he.prevZ=me,me=he;O=Q}me.nextZ=null,ft*=2}while(we>1);return E}function ih(E,C,O,Q,he){return E=32767*(E-O)*he,C=32767*(C-Q)*he,E=(E|E<<8)&16711935,E=(E|E<<4)&252645135,E=(E|E<<2)&858993459,E=(E|E<<1)&1431655765,C=(C|C<<8)&16711935,C=(C|C<<4)&252645135,C=(C|C<<2)&858993459,C=(C|C<<1)&1431655765,E|C<<1}function bp(E){var C=E,O=E;do(C.x<O.x||C.x===O.x&&C.y<O.y)&&(O=C),C=C.next;while(C!==E);return O}function zf(E,C,O,Q,he,me,we,Re){return(he-we)*(C-Re)-(E-we)*(me-Re)>=0&&(E-we)*(Q-Re)-(O-we)*(C-Re)>=0&&(O-we)*(me-Re)-(he-we)*(Q-Re)>=0}function _p(E,C){return E.next.i!==C.i&&E.prev.i!==C.i&&!wp(E,C)&&(sc(E,C)&&sc(C,E)&&Tp(E,C)&&(Bo(E.prev,E,C.prev)||Bo(E,C.prev,C))||Lc(E,C)&&Bo(E.prev,E,E.next)>0&&Bo(C.prev,C,C.next)>0)}function Bo(E,C,O){return(C.y-E.y)*(O.x-C.x)-(C.x-E.x)*(O.y-C.y)}function Lc(E,C){return E.x===C.x&&E.y===C.y}function Rh(E,C,O,Q){var he=Dc(Bo(E,C,O)),me=Dc(Bo(E,C,Q)),we=Dc(Bo(O,Q,E)),Re=Dc(Bo(O,Q,C));return!!(he!==me&&we!==Re||he===0&&Pc(E,O,C)||me===0&&Pc(E,Q,C)||we===0&&Pc(O,E,Q)||Re===0&&Pc(O,C,Q))}function Pc(E,C,O){return C.x<=Math.max(E.x,O.x)&&C.x>=Math.min(E.x,O.x)&&C.y<=Math.max(E.y,O.y)&&C.y>=Math.min(E.y,O.y)}function Dc(E){return E>0?1:E<0?-1:0}function wp(E,C){var O=E;do{if(O.i!==E.i&&O.next.i!==E.i&&O.i!==C.i&&O.next.i!==C.i&&Rh(O,O.next,E,C))return!0;O=O.next}while(O!==E);return!1}function sc(E,C){return Bo(E.prev,E,E.next)<0?Bo(E,C,E.next)>=0&&Bo(E,E.prev,C)>=0:Bo(E,C,E.prev)<0||Bo(E,E.next,C)<0}function Tp(E,C){var O=E,Q=!1,he=(E.x+C.x)/2,me=(E.y+C.y)/2;do O.y>me!=O.next.y>me&&O.next.y!==O.y&&he<(O.next.x-O.x)*(me-O.y)/(O.next.y-O.y)+O.x&&(Q=!Q),O=O.next;while(O!==E);return Q}function Ih(E,C){var O=new oh(E.i,E.x,E.y),Q=new oh(C.i,C.x,C.y),he=E.next,me=C.prev;return E.next=C,C.prev=E,O.next=he,he.prev=O,Q.next=O,O.prev=Q,me.next=Q,Q.prev=me,Q}function zh(E,C,O,Q){var he=new oh(E,C,O);return Q?(he.next=Q.next,he.prev=Q,Q.next.prev=he,Q.next=he):(he.prev=he,he.next=he),he}function lc(E){E.next.prev=E.prev,E.prev.next=E.next,E.prevZ&&(E.prevZ.nextZ=E.nextZ),E.nextZ&&(E.nextZ.prevZ=E.prevZ)}function oh(E,C,O){this.i=E,this.x=C,this.y=O,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}Cc.deviation=function(E,C,O,Q){var he=C&&C.length,me=he?C[0]*O:E.length,we=Math.abs(sh(E,0,me,O));if(he)for(var Re=0,$e=C.length;Re<$e;Re++){var ft=C[Re]*O,pt=Re<$e-1?C[Re+1]*O:E.length;we-=Math.abs(sh(E,ft,pt,O))}var It=0;for(Re=0;Re<Q.length;Re+=3){var tr=Q[Re]*O,Qt=Q[Re+1]*O,dr=Q[Re+2]*O;It+=Math.abs((E[tr]-E[dr])*(E[Qt+1]-E[tr+1])-(E[tr]-E[Qt])*(E[dr+1]-E[tr+1]))}return we===0&&It===0?0:Math.abs((It-we)/we)};function sh(E,C,O,Q){for(var he=0,me=C,we=O-Q;me<O;me+=Q)he+=(E[we]-E[me])*(E[me+1]+E[we+1]),we=me;return he}Cc.flatten=function(E){for(var C=E[0][0].length,O={vertices:[],holes:[],dimensions:C},Q=0,he=0;he<E.length;he++){for(var me=0;me<E[he].length;me++)for(var we=0;we<C;we++)O.vertices.push(E[he][me][we]);he>0&&(Q+=E[he-1].length,O.holes.push(Q))}return O},ah.default=lp;function Ap(E,C,O,Q,he){Fh(E,C,O||0,Q||E.length-1,he||Mp)}function Fh(E,C,O,Q,he){for(;Q>O;){if(Q-O>600){var me=Q-O+1,we=C-O+1,Re=Math.log(me),$e=.5*Math.exp(2*Re/3),ft=.5*Math.sqrt(Re*$e*(me-$e)/me)*(we-me/2<0?-1:1),pt=Math.max(O,Math.floor(C-we*$e/me+ft)),It=Math.min(Q,Math.floor(C+(me-we)*$e/me+ft));Fh(E,C,pt,It,he)}var tr=E[C],Qt=O,dr=Q;for(uc(E,O,C),he(E[Q],tr)>0&&uc(E,O,Q);Qt<dr;){for(uc(E,Qt,dr),Qt++,dr--;he(E[Qt],tr)<0;)Qt++;for(;he(E[dr],tr)>0;)dr--}he(E[O],tr)===0?uc(E,O,dr):(dr++,uc(E,dr,Q)),dr<=C&&(O=dr+1),C<=dr&&(Q=dr-1)}}function uc(E,C,O){var Q=E[C];E[C]=E[O],E[O]=Q}function Mp(E,C){return E<C?-1:E>C?1:0}function lh(E,C){var O=E.length;if(O<=1)return[E];for(var Q=[],he,me,we=0;we<O;we++){var Re=H(E[we]);Re!==0&&(E[we].area=Math.abs(Re),me===void 0&&(me=Re<0),me===Re<0?(he&&Q.push(he),he=[E[we]]):he.push(E[we]))}if(he&&Q.push(he),C>1)for(var $e=0;$e<Q.length;$e++)Q[$e].length<=C||(Ap(Q[$e],C,1,Q[$e].length-1,Sp),Q[$e]=Q[$e].slice(0,C));return Q}function Sp(E,C){return C.area-E.area}function uh(E,C,O){for(var Q=O.patternDependencies,he=!1,me=0,we=C;me<we.length;me+=1){var Re=we[me],$e=Re.paint.get(E+"-pattern");$e.isConstant()||(he=!0);var ft=$e.constantOr(null);ft&&(he=!0,Q[ft.to]=!0,Q[ft.from]=!0)}return he}function fh(E,C,O,Q,he){for(var me=he.patternDependencies,we=0,Re=C;we<Re.length;we+=1){var $e=Re[we],ft=$e.paint.get(E+"-pattern"),pt=ft.value;if(pt.kind!=="constant"){var It=pt.evaluate({zoom:Q-1},O,{},he.availableImages),tr=pt.evaluate({zoom:Q},O,{},he.availableImages),Qt=pt.evaluate({zoom:Q+1},O,{},he.availableImages);It=It&&It.name?It.name:It,tr=tr&&tr.name?tr.name:tr,Qt=Qt&&Qt.name?Qt.name:Qt,me[It]=!0,me[tr]=!0,me[Qt]=!0,O.patterns[$e.id]={min:It,mid:tr,max:Qt}}}return O}var kp=500,_u=function(C){this.zoom=C.zoom,this.overscaling=C.overscaling,this.layers=C.layers,this.layerIds=this.layers.map(function(O){return O.id}),this.index=C.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new pf,this.indexArray=new xu,this.indexArray2=new yf,this.programConfigurations=new ni(Ph,C.layers,C.zoom),this.segments=new V,this.segments2=new V,this.stateDependentLayerIds=this.layers.filter(function(O){return O.isStateDependent()}).map(function(O){return O.id})};_u.prototype.populate=function(C,O,Q){this.hasPattern=uh("fill",this.layers,O);for(var he=this.layers[0].layout.get("fill-sort-key"),me=[],we=0,Re=C;we<Re.length;we+=1){var $e=Re[we],ft=$e.feature,pt=$e.id,It=$e.index,tr=$e.sourceLayerIndex,Qt=this.layers[0]._featureFilter.needGeometry,dr={type:ft.type,id:pt,properties:ft.properties,geometry:Qt?Ni(ft):[]};if(!!this.layers[0]._featureFilter.filter(new si(this.zoom),dr,Q)){Qt||(dr.geometry=Ni(ft));var Fr=he?he.evaluate(dr,{},Q,O.availableImages):void 0,an={id:pt,properties:ft.properties,type:ft.type,sourceLayerIndex:tr,index:It,geometry:dr.geometry,patterns:{},sortKey:Fr};me.push(an)}}he&&me.sort(function(wa,Ma){return wa.sortKey-Ma.sortKey});for(var $r=0,kn=me;$r<kn.length;$r+=1){var mn=kn[$r],Sn=mn,In=Sn.geometry,Gn=Sn.index,oa=Sn.sourceLayerIndex;if(this.hasPattern){var na=fh("fill",this.layers,mn,this.zoom,O);this.patternFeatures.push(na)}else this.addFeature(mn,In,Gn,Q,{});var Ra=C[Gn].feature;O.featureIndex.insert(Ra,In,Gn,oa,this.index)}},_u.prototype.update=function(C,O,Q){!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(C,O,this.stateDependentLayers,Q)},_u.prototype.addFeatures=function(C,O,Q){for(var he=0,me=this.patternFeatures;he<me.length;he+=1){var we=me[he];this.addFeature(we,we.geometry,we.index,O,Q)}},_u.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},_u.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},_u.prototype.upload=function(C){this.uploaded||(this.layoutVertexBuffer=C.createVertexBuffer(this.layoutVertexArray,Ph),this.indexBuffer=C.createIndexBuffer(this.indexArray),this.indexBuffer2=C.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(C),this.uploaded=!0},_u.prototype.destroy=function(){!this.layoutVertexBuffer||(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},_u.prototype.addFeature=function(C,O,Q,he,me){for(var we=0,Re=lh(O,kp);we<Re.length;we+=1){for(var $e=Re[we],ft=0,pt=0,It=$e;pt<It.length;pt+=1){var tr=It[pt];ft+=tr.length}for(var Qt=this.segments.prepareSegment(ft,this.layoutVertexArray,this.indexArray),dr=Qt.vertexLength,Fr=[],an=[],$r=0,kn=$e;$r<kn.length;$r+=1){var mn=kn[$r];if(mn.length!==0){mn!==$e[0]&&an.push(Fr.length/2);var Sn=this.segments2.prepareSegment(mn.length,this.layoutVertexArray,this.indexArray2),In=Sn.vertexLength;this.layoutVertexArray.emplaceBack(mn[0].x,mn[0].y),this.indexArray2.emplaceBack(In+mn.length-1,In),Fr.push(mn[0].x),Fr.push(mn[0].y);for(var Gn=1;Gn<mn.length;Gn++)this.layoutVertexArray.emplaceBack(mn[Gn].x,mn[Gn].y),this.indexArray2.emplaceBack(In+Gn-1,In+Gn),Fr.push(mn[Gn].x),Fr.push(mn[Gn].y);Sn.vertexLength+=mn.length,Sn.primitiveLength+=mn.length}}for(var oa=ah(Fr,an),na=0;na<oa.length;na+=3)this.indexArray.emplaceBack(dr+oa[na],dr+oa[na+1],dr+oa[na+2]);Qt.vertexLength+=ft,Qt.primitiveLength+=oa.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,C,Q,me,he)},Ie("FillBucket",_u,{omit:["layers","patternFeatures"]});var Ep=new Xi({"fill-sort-key":new Za(Bt.layout_fill["fill-sort-key"])}),Cp=new Xi({"fill-antialias":new Ia(Bt.paint_fill["fill-antialias"]),"fill-opacity":new Za(Bt.paint_fill["fill-opacity"]),"fill-color":new Za(Bt.paint_fill["fill-color"]),"fill-outline-color":new Za(Bt.paint_fill["fill-outline-color"]),"fill-translate":new Ia(Bt.paint_fill["fill-translate"]),"fill-translate-anchor":new Ia(Bt.paint_fill["fill-translate-anchor"]),"fill-pattern":new xo(Bt.paint_fill["fill-pattern"])}),Lp={paint:Cp,layout:Ep},Pp=function(E){function C(O){E.call(this,O,Lp)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.recalculate=function(Q,he){E.prototype.recalculate.call(this,Q,he);var me=this.paint._values["fill-outline-color"];me.value.kind==="constant"&&me.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},C.prototype.createBucket=function(Q){return new _u(Q)},C.prototype.queryRadius=function(){return eu(this.paint.get("fill-translate"))},C.prototype.queryIntersectsFeature=function(Q,he,me,we,Re,$e,ft){var pt=Hl(Q,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),$e.angle,ft);return _o(pt,we)},C.prototype.isTileClipped=function(){return!0},C}(xs),Dp=Do([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),Oh=Dp.members,Bh=Ff;function Ff(E,C,O,Q,he){this.properties={},this.extent=O,this.type=0,this._pbf=E,this._geometry=-1,this._keys=Q,this._values=he,E.readFields(Rp,this,C)}function Rp(E,C,O){E==1?C.id=O.readVarint():E==2?Ip(O,C):E==3?C.type=O.readVarint():E==4&&(C._geometry=O.pos)}function Ip(E,C){for(var O=E.readVarint()+E.pos;E.pos<O;){var Q=C._keys[E.readVarint()],he=C._values[E.readVarint()];C.properties[Q]=he}}Ff.types=["Unknown","Point","LineString","Polygon"],Ff.prototype.loadGeometry=function(){var E=this._pbf;E.pos=this._geometry;for(var C=E.readVarint()+E.pos,O=1,Q=0,he=0,me=0,we=[],Re;E.pos<C;){if(Q<=0){var $e=E.readVarint();O=$e&7,Q=$e>>3}if(Q--,O===1||O===2)he+=E.readSVarint(),me+=E.readSVarint(),O===1&&(Re&&we.push(Re),Re=[]),Re.push(new c(he,me));else if(O===7)Re&&Re.push(Re[0].clone());else throw new Error("unknown command "+O)}return Re&&we.push(Re),we},Ff.prototype.bbox=function(){var E=this._pbf;E.pos=this._geometry;for(var C=E.readVarint()+E.pos,O=1,Q=0,he=0,me=0,we=1/0,Re=-1/0,$e=1/0,ft=-1/0;E.pos<C;){if(Q<=0){var pt=E.readVarint();O=pt&7,Q=pt>>3}if(Q--,O===1||O===2)he+=E.readSVarint(),me+=E.readSVarint(),he<we&&(we=he),he>Re&&(Re=he),me<$e&&($e=me),me>ft&&(ft=me);else if(O!==7)throw new Error("unknown command "+O)}return[we,$e,Re,ft]},Ff.prototype.toGeoJSON=function(E,C,O){var Q=this.extent*Math.pow(2,O),he=this.extent*E,me=this.extent*C,we=this.loadGeometry(),Re=Ff.types[this.type],$e,ft;function pt(Qt){for(var dr=0;dr<Qt.length;dr++){var Fr=Qt[dr],an=180-(Fr.y+me)*360/Q;Qt[dr]=[(Fr.x+he)*360/Q-180,360/Math.PI*Math.atan(Math.exp(an*Math.PI/180))-90]}}switch(this.type){case 1:var It=[];for($e=0;$e<we.length;$e++)It[$e]=we[$e][0];we=It,pt(we);break;case 2:for($e=0;$e<we.length;$e++)pt(we[$e]);break;case 3:for(we=zp(we),$e=0;$e<we.length;$e++)for(ft=0;ft<we[$e].length;ft++)pt(we[$e][ft]);break}we.length===1?we=we[0]:Re="Multi"+Re;var tr={type:"Feature",geometry:{type:Re,coordinates:we},properties:this.properties};return"id"in this&&(tr.id=this.id),tr};function zp(E){var C=E.length;if(C<=1)return[E];for(var O=[],Q,he,me=0;me<C;me++){var we=Fp(E[me]);we!==0&&(he===void 0&&(he=we<0),he===we<0?(Q&&O.push(Q),Q=[E[me]]):Q.push(E[me]))}return Q&&O.push(Q),O}function Fp(E){for(var C=0,O=0,Q=E.length,he=Q-1,me,we;O<Q;he=O++)me=E[O],we=E[he],C+=(we.x-me.x)*(me.y+we.y);return C}var Nh=Uh;function Uh(E,C){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=E,this._keys=[],this._values=[],this._features=[],E.readFields(Op,this,C),this.length=this._features.length}function Op(E,C,O){E===15?C.version=O.readVarint():E===1?C.name=O.readString():E===5?C.extent=O.readVarint():E===2?C._features.push(O.pos):E===3?C._keys.push(O.readString()):E===4&&C._values.push(Bp(O))}function Bp(E){for(var C=null,O=E.readVarint()+E.pos;E.pos<O;){var Q=E.readVarint()>>3;C=Q===1?E.readString():Q===2?E.readFloat():Q===3?E.readDouble():Q===4?E.readVarint64():Q===5?E.readVarint():Q===6?E.readSVarint():Q===7?E.readBoolean():null}return C}Uh.prototype.feature=function(E){if(E<0||E>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[E];var C=this._pbf.readVarint()+this._pbf.pos;return new Bh(this._pbf,C,this.extent,this._keys,this._values)};var Np=Up;function Up(E,C){this.layers=E.readFields(Hp,{},C)}function Hp(E,C,O){if(E===3){var Q=new Nh(O,O.readVarint()+O.pos);Q.length&&(C[Q.name]=Q)}}var Vp=Np,Gp=Bh,Yp=Nh,Of={VectorTile:Vp,VectorTileFeature:Gp,VectorTileLayer:Yp},Wp=Of.VectorTileFeature.types,Xp=500,ch=Math.pow(2,13);function fc(E,C,O,Q,he,me,we,Re){E.emplaceBack(C,O,Math.floor(Q*ch)*2+we,he*ch*2,me*ch*2,Math.round(Re))}var wu=function(C){this.zoom=C.zoom,this.overscaling=C.overscaling,this.layers=C.layers,this.layerIds=this.layers.map(function(O){return O.id}),this.index=C.index,this.hasPattern=!1,this.layoutVertexArray=new ef,this.indexArray=new xu,this.programConfigurations=new ni(Oh,C.layers,C.zoom),this.segments=new V,this.stateDependentLayerIds=this.layers.filter(function(O){return O.isStateDependent()}).map(function(O){return O.id})};wu.prototype.populate=function(C,O,Q){this.features=[],this.hasPattern=uh("fill-extrusion",this.layers,O);for(var he=0,me=C;he<me.length;he+=1){var we=me[he],Re=we.feature,$e=we.id,ft=we.index,pt=we.sourceLayerIndex,It=this.layers[0]._featureFilter.needGeometry,tr={type:Re.type,id:$e,properties:Re.properties,geometry:It?Ni(Re):[]};if(!!this.layers[0]._featureFilter.filter(new si(this.zoom),tr,Q)){var Qt={id:$e,sourceLayerIndex:pt,index:ft,geometry:It?tr.geometry:Ni(Re),properties:Re.properties,type:Re.type,patterns:{}};typeof Re.id<"u"&&(Qt.id=Re.id),this.hasPattern?this.features.push(fh("fill-extrusion",this.layers,Qt,this.zoom,O)):this.addFeature(Qt,Qt.geometry,ft,Q,{}),O.featureIndex.insert(Re,Qt.geometry,ft,pt,this.index,!0)}}},wu.prototype.addFeatures=function(C,O,Q){for(var he=0,me=this.features;he<me.length;he+=1){var we=me[he],Re=we.geometry;this.addFeature(we,Re,we.index,O,Q)}},wu.prototype.update=function(C,O,Q){!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(C,O,this.stateDependentLayers,Q)},wu.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},wu.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},wu.prototype.upload=function(C){this.uploaded||(this.layoutVertexBuffer=C.createVertexBuffer(this.layoutVertexArray,Oh),this.indexBuffer=C.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(C),this.uploaded=!0},wu.prototype.destroy=function(){!this.layoutVertexBuffer||(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},wu.prototype.addFeature=function(C,O,Q,he,me){for(var we=0,Re=lh(O,Xp);we<Re.length;we+=1){for(var $e=Re[we],ft=0,pt=0,It=$e;pt<It.length;pt+=1){var tr=It[pt];ft+=tr.length}for(var Qt=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),dr=0,Fr=$e;dr<Fr.length;dr+=1){var an=Fr[dr];if(an.length!==0&&!jp(an))for(var $r=0,kn=0;kn<an.length;kn++){var mn=an[kn];if(kn>=1){var Sn=an[kn-1];if(!Zp(mn,Sn)){Qt.vertexLength+4>V.MAX_VERTEX_ARRAY_LENGTH&&(Qt=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var In=mn.sub(Sn)._perp()._unit(),Gn=Sn.dist(mn);$r+Gn>32768&&($r=0),fc(this.layoutVertexArray,mn.x,mn.y,In.x,In.y,0,0,$r),fc(this.layoutVertexArray,mn.x,mn.y,In.x,In.y,0,1,$r),$r+=Gn,fc(this.layoutVertexArray,Sn.x,Sn.y,In.x,In.y,0,0,$r),fc(this.layoutVertexArray,Sn.x,Sn.y,In.x,In.y,0,1,$r);var oa=Qt.vertexLength;this.indexArray.emplaceBack(oa,oa+2,oa+1),this.indexArray.emplaceBack(oa+1,oa+2,oa+3),Qt.vertexLength+=4,Qt.primitiveLength+=2}}}}if(Qt.vertexLength+ft>V.MAX_VERTEX_ARRAY_LENGTH&&(Qt=this.segments.prepareSegment(ft,this.layoutVertexArray,this.indexArray)),Wp[C.type]==="Polygon"){for(var na=[],Ra=[],wa=Qt.vertexLength,Ma=0,ti=$e;Ma<ti.length;Ma+=1){var Ca=ti[Ma];if(Ca.length!==0){Ca!==$e[0]&&Ra.push(na.length/2);for(var Da=0;Da<Ca.length;Da++){var fi=Ca[Da];fc(this.layoutVertexArray,fi.x,fi.y,0,0,1,1,0),na.push(fi.x),na.push(fi.y)}}}for(var qa=ah(na,Ra),ki=0;ki<qa.length;ki+=3)this.indexArray.emplaceBack(wa+qa[ki],wa+qa[ki+2],wa+qa[ki+1]);Qt.primitiveLength+=qa.length/3,Qt.vertexLength+=ft}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,C,Q,me,he)},Ie("FillExtrusionBucket",wu,{omit:["layers","features"]});function Zp(E,C){return E.x===C.x&&(E.x<0||E.x>Ba)||E.y===C.y&&(E.y<0||E.y>Ba)}function jp(E){return E.every(function(C){return C.x<0})||E.every(function(C){return C.x>Ba})||E.every(function(C){return C.y<0})||E.every(function(C){return C.y>Ba})}var Kp=new Xi({"fill-extrusion-opacity":new Ia(Bt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Za(Bt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Ia(Bt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Ia(Bt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new xo(Bt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Za(Bt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Za(Bt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Ia(Bt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])}),Jp={paint:Kp},Qp=function(E){function C(O){E.call(this,O,Jp)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.createBucket=function(Q){return new wu(Q)},C.prototype.queryRadius=function(){return eu(this.paint.get("fill-extrusion-translate"))},C.prototype.is3D=function(){return!0},C.prototype.queryIntersectsFeature=function(Q,he,me,we,Re,$e,ft,pt){var It=Hl(Q,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),$e.angle,ft),tr=this.paint.get("fill-extrusion-height").evaluate(he,me),Qt=this.paint.get("fill-extrusion-base").evaluate(he,me),dr=ed(It,pt,$e,0),Fr=qp(we,Qt,tr,pt),an=Fr[0],$r=Fr[1];return $p(an,$r,dr)},C}(xs);function cc(E,C){return E.x*C.x+E.y*C.y}function Hh(E,C){if(E.length===1){for(var O=0,Q=C[O++],he;!he||Q.equals(he);)if(he=C[O++],!he)return 1/0;for(;O<C.length;O++){var me=C[O],we=E[0],Re=he.sub(Q),$e=me.sub(Q),ft=we.sub(Q),pt=cc(Re,Re),It=cc(Re,$e),tr=cc($e,$e),Qt=cc(ft,Re),dr=cc(ft,$e),Fr=pt*tr-It*It,an=(tr*Qt-It*dr)/Fr,$r=(pt*dr-It*Qt)/Fr,kn=1-an-$r,mn=Q.z*kn+he.z*an+me.z*$r;if(isFinite(mn))return mn}return 1/0}else{for(var Sn=1/0,In=0,Gn=C;In<Gn.length;In+=1){var oa=Gn[In];Sn=Math.min(Sn,oa.z)}return Sn}}function $p(E,C,O){var Q=1/0;_o(O,C)&&(Q=Hh(O,C[0]));for(var he=0;he<C.length;he++)for(var me=C[he],we=E[he],Re=0;Re<me.length-1;Re++){var $e=me[Re],ft=me[Re+1],pt=we[Re],It=we[Re+1],tr=[$e,ft,It,pt,$e];ii(O,tr)&&(Q=Math.min(Q,Hh(O,tr)))}return Q===1/0?!1:Q}function qp(E,C,O,Q){for(var he=[],me=[],we=Q[8]*C,Re=Q[9]*C,$e=Q[10]*C,ft=Q[11]*C,pt=Q[8]*O,It=Q[9]*O,tr=Q[10]*O,Qt=Q[11]*O,dr=0,Fr=E;dr<Fr.length;dr+=1){for(var an=Fr[dr],$r=[],kn=[],mn=0,Sn=an;mn<Sn.length;mn+=1){var In=Sn[mn],Gn=In.x,oa=In.y,na=Q[0]*Gn+Q[4]*oa+Q[12],Ra=Q[1]*Gn+Q[5]*oa+Q[13],wa=Q[2]*Gn+Q[6]*oa+Q[14],Ma=Q[3]*Gn+Q[7]*oa+Q[15],ti=na+we,Ca=Ra+Re,Da=wa+$e,fi=Ma+ft,qa=na+pt,ki=Ra+It,Wi=wa+tr,Ei=Ma+Qt,Ci=new c(ti/fi,Ca/fi);Ci.z=Da/fi,$r.push(Ci);var Ti=new c(qa/Ei,ki/Ei);Ti.z=Wi/Ei,kn.push(Ti)}he.push($r),me.push(kn)}return[he,me]}function ed(E,C,O,Q){for(var he=[],me=0,we=E;me<we.length;me+=1){var Re=we[me],$e=[Re.x,Re.y,Q,1];Ec($e,$e,C),he.push(new c($e[0]/$e[3],$e[1]/$e[3]))}return he}var td=Do([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),Vh=td.members,rd=Of.VectorTileFeature.types,Gh=63,nd=Math.cos(75/2*(Math.PI/180)),ad=15,id=20,od=15,Yh=1/2,Wh=Math.pow(2,od-1)/Yh,tl=function(C){this.zoom=C.zoom,this.overscaling=C.overscaling,this.layers=C.layers,this.layerIds=this.layers.map(function(O){return O.id}),this.index=C.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Sf,this.indexArray=new xu,this.programConfigurations=new ni(Vh,C.layers,C.zoom),this.segments=new V,this.stateDependentLayerIds=this.layers.filter(function(O){return O.isStateDependent()}).map(function(O){return O.id})};tl.prototype.populate=function(C,O,Q){this.hasPattern=uh("line",this.layers,O);for(var he=this.layers[0].layout.get("line-sort-key"),me=[],we=0,Re=C;we<Re.length;we+=1){var $e=Re[we],ft=$e.feature,pt=$e.id,It=$e.index,tr=$e.sourceLayerIndex,Qt=this.layers[0]._featureFilter.needGeometry,dr={type:ft.type,id:pt,properties:ft.properties,geometry:Qt?Ni(ft):[]};if(!!this.layers[0]._featureFilter.filter(new si(this.zoom),dr,Q)){Qt||(dr.geometry=Ni(ft));var Fr=he?he.evaluate(dr,{},Q):void 0,an={id:pt,properties:ft.properties,type:ft.type,sourceLayerIndex:tr,index:It,geometry:dr.geometry,patterns:{},sortKey:Fr};me.push(an)}}he&&me.sort(function(wa,Ma){return wa.sortKey-Ma.sortKey});for(var $r=0,kn=me;$r<kn.length;$r+=1){var mn=kn[$r],Sn=mn,In=Sn.geometry,Gn=Sn.index,oa=Sn.sourceLayerIndex;if(this.hasPattern){var na=fh("line",this.layers,mn,this.zoom,O);this.patternFeatures.push(na)}else this.addFeature(mn,In,Gn,Q,{});var Ra=C[Gn].feature;O.featureIndex.insert(Ra,In,Gn,oa,this.index)}},tl.prototype.update=function(C,O,Q){!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(C,O,this.stateDependentLayers,Q)},tl.prototype.addFeatures=function(C,O,Q){for(var he=0,me=this.patternFeatures;he<me.length;he+=1){var we=me[he];this.addFeature(we,we.geometry,we.index,O,Q)}},tl.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},tl.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},tl.prototype.upload=function(C){this.uploaded||(this.layoutVertexBuffer=C.createVertexBuffer(this.layoutVertexArray,Vh),this.indexBuffer=C.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(C),this.uploaded=!0},tl.prototype.destroy=function(){!this.layoutVertexBuffer||(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},tl.prototype.addFeature=function(C,O,Q,he,me){for(var we=this.layers[0].layout,Re=we.get("line-join").evaluate(C,{}),$e=we.get("line-cap"),ft=we.get("line-miter-limit"),pt=we.get("line-round-limit"),It=0,tr=O;It<tr.length;It+=1){var Qt=tr[It];this.addLine(Qt,C,Re,$e,ft,pt)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,C,Q,me,he)},tl.prototype.addLine=function(C,O,Q,he,me,we){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,!!O.properties&&O.properties.hasOwnProperty("mapbox_clip_start")&&O.properties.hasOwnProperty("mapbox_clip_end")){this.clipStart=+O.properties.mapbox_clip_start,this.clipEnd=+O.properties.mapbox_clip_end;for(var Re=0;Re<C.length-1;Re++)this.totalDistance+=C[Re].dist(C[Re+1]);this.updateScaledDistance()}for(var $e=rd[O.type]==="Polygon",ft=C.length;ft>=2&&C[ft-1].equals(C[ft-2]);)ft--;for(var pt=0;pt<ft-1&&C[pt].equals(C[pt+1]);)pt++;if(!(ft<($e?3:2))){Q==="bevel"&&(me=1.05);var It=this.overscaling<=16?ad*Ba/(512*this.overscaling):0,tr=this.segments.prepareSegment(ft*10,this.layoutVertexArray,this.indexArray),Qt,dr=void 0,Fr=void 0,an=void 0,$r=void 0;this.e1=this.e2=-1,$e&&(Qt=C[ft-2],$r=C[pt].sub(Qt)._unit()._perp());for(var kn=pt;kn<ft;kn++)if(Fr=kn===ft-1?$e?C[pt+1]:void 0:C[kn+1],!(Fr&&C[kn].equals(Fr))){$r&&(an=$r),Qt&&(dr=Qt),Qt=C[kn],$r=Fr?Fr.sub(Qt)._unit()._perp():an,an=an||$r;var mn=an.add($r);(mn.x!==0||mn.y!==0)&&mn._unit();var Sn=an.x*$r.x+an.y*$r.y,In=mn.x*$r.x+mn.y*$r.y,Gn=In!==0?1/In:1/0,oa=2*Math.sqrt(2-2*In),na=In<nd&&dr&&Fr,Ra=an.x*$r.y-an.y*$r.x>0;if(na&&kn>pt){var wa=Qt.dist(dr);if(wa>2*It){var Ma=Qt.sub(Qt.sub(dr)._mult(It/wa)._round());this.updateDistance(dr,Ma),this.addCurrentVertex(Ma,an,0,0,tr),dr=Ma}}var ti=dr&&Fr,Ca=ti?Q:$e?"butt":he;if(ti&&Ca==="round"&&(Gn<we?Ca="miter":Gn<=2&&(Ca="fakeround")),Ca==="miter"&&Gn>me&&(Ca="bevel"),Ca==="bevel"&&(Gn>2&&(Ca="flipbevel"),Gn<me&&(Ca="miter")),dr&&this.updateDistance(dr,Qt),Ca==="miter")mn._mult(Gn),this.addCurrentVertex(Qt,mn,0,0,tr);else if(Ca==="flipbevel"){if(Gn>100)mn=$r.mult(-1);else{var Da=Gn*an.add($r).mag()/an.sub($r).mag();mn._perp()._mult(Da*(Ra?-1:1))}this.addCurrentVertex(Qt,mn,0,0,tr),this.addCurrentVertex(Qt,mn.mult(-1),0,0,tr)}else if(Ca==="bevel"||Ca==="fakeround"){var fi=-Math.sqrt(Gn*Gn-1),qa=Ra?fi:0,ki=Ra?0:fi;if(dr&&this.addCurrentVertex(Qt,an,qa,ki,tr),Ca==="fakeround")for(var Wi=Math.round(oa*180/Math.PI/id),Ei=1;Ei<Wi;Ei++){var Ci=Ei/Wi;if(Ci!==.5){var Ti=Ci-.5,$i=1.0904+Sn*(-3.2452+Sn*(3.55645-Sn*1.43519)),ro=.848013+Sn*(-1.06021+Sn*.215638);Ci=Ci+Ci*Ti*(Ci-1)*($i*Ti*Ti+ro)}var wo=$r.sub(an)._mult(Ci)._add(an)._unit()._mult(Ra?-1:1);this.addHalfVertex(Qt,wo.x,wo.y,!1,Ra,0,tr)}Fr&&this.addCurrentVertex(Qt,$r,-qa,-ki,tr)}else if(Ca==="butt")this.addCurrentVertex(Qt,mn,0,0,tr);else if(Ca==="square"){var Co=dr?1:-1;this.addCurrentVertex(Qt,mn,Co,Co,tr)}else Ca==="round"&&(dr&&(this.addCurrentVertex(Qt,an,0,0,tr),this.addCurrentVertex(Qt,an,1,1,tr,!0)),Fr&&(this.addCurrentVertex(Qt,$r,-1,-1,tr,!0),this.addCurrentVertex(Qt,$r,0,0,tr)));if(na&&kn<ft-1){var qo=Qt.dist(Fr);if(qo>2*It){var Ho=Qt.add(Fr.sub(Qt)._mult(It/qo)._round());this.updateDistance(Qt,Ho),this.addCurrentVertex(Ho,$r,0,0,tr),Qt=Ho}}}}},tl.prototype.addCurrentVertex=function(C,O,Q,he,me,we){we===void 0&&(we=!1);var Re=O.x+O.y*Q,$e=O.y-O.x*Q,ft=-O.x+O.y*he,pt=-O.y-O.x*he;this.addHalfVertex(C,Re,$e,we,!1,Q,me),this.addHalfVertex(C,ft,pt,we,!0,-he,me),this.distance>Wh/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(C,O,Q,he,me,we))},tl.prototype.addHalfVertex=function(C,O,Q,he,me,we,Re){var $e=C.x,ft=C.y,pt=this.scaledDistance*Yh;this.layoutVertexArray.emplaceBack(($e<<1)+(he?1:0),(ft<<1)+(me?1:0),Math.round(Gh*O)+128,Math.round(Gh*Q)+128,(we===0?0:we<0?-1:1)+1|(pt&63)<<2,pt>>6);var It=Re.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,It),Re.primitiveLength++),me?this.e2=It:this.e1=It},tl.prototype.updateScaledDistance=function(){this.scaledDistance=this.totalDistance>0?(this.clipStart+(this.clipEnd-this.clipStart)*this.distance/this.totalDistance)*(Wh-1):this.distance},tl.prototype.updateDistance=function(C,O){this.distance+=C.dist(O),this.updateScaledDistance()},Ie("LineBucket",tl,{omit:["layers","patternFeatures"]});var sd=new Xi({"line-cap":new Ia(Bt.layout_line["line-cap"]),"line-join":new Za(Bt.layout_line["line-join"]),"line-miter-limit":new Ia(Bt.layout_line["line-miter-limit"]),"line-round-limit":new Ia(Bt.layout_line["line-round-limit"]),"line-sort-key":new Za(Bt.layout_line["line-sort-key"])}),ld=new Xi({"line-opacity":new Za(Bt.paint_line["line-opacity"]),"line-color":new Za(Bt.paint_line["line-color"]),"line-translate":new Ia(Bt.paint_line["line-translate"]),"line-translate-anchor":new Ia(Bt.paint_line["line-translate-anchor"]),"line-width":new Za(Bt.paint_line["line-width"]),"line-gap-width":new Za(Bt.paint_line["line-gap-width"]),"line-offset":new Za(Bt.paint_line["line-offset"]),"line-blur":new Za(Bt.paint_line["line-blur"]),"line-dasharray":new eo(Bt.paint_line["line-dasharray"]),"line-pattern":new xo(Bt.paint_line["line-pattern"]),"line-gradient":new Po(Bt.paint_line["line-gradient"])}),Xh={paint:ld,layout:sd},ud=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.possiblyEvaluate=function(Q,he){return he=new si(Math.floor(he.zoom),{now:he.now,fadeDuration:he.fadeDuration,zoomHistory:he.zoomHistory,transition:he.transition}),E.prototype.possiblyEvaluate.call(this,Q,he)},C.prototype.evaluate=function(Q,he,me,we){return he=A({},he,{zoom:Math.floor(he.zoom)}),E.prototype.evaluate.call(this,Q,he,me,we)},C}(Za),Zh=new ud(Xh.paint.properties["line-width"].specification);Zh.useIntegerZoom=!0;var fd=function(E){function C(O){E.call(this,O,Xh)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype._handleSpecialPaintPropertyUpdate=function(Q){Q==="line-gradient"&&this._updateGradient()},C.prototype._updateGradient=function(){var Q=this._transitionablePaint._values["line-gradient"].value.expression;this.gradient=Lh(Q,"lineProgress"),this.gradientTexture=null},C.prototype.recalculate=function(Q,he){E.prototype.recalculate.call(this,Q,he),this.paint._values["line-floorwidth"]=Zh.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,Q)},C.prototype.createBucket=function(Q){return new tl(Q)},C.prototype.queryRadius=function(Q){var he=Q,me=jh(fl("line-width",this,he),fl("line-gap-width",this,he)),we=fl("line-offset",this,he);return me/2+Math.abs(we)+eu(this.paint.get("line-translate"))},C.prototype.queryIntersectsFeature=function(Q,he,me,we,Re,$e,ft){var pt=Hl(Q,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),$e.angle,ft),It=ft/2*jh(this.paint.get("line-width").evaluate(he,me),this.paint.get("line-gap-width").evaluate(he,me)),tr=this.paint.get("line-offset").evaluate(he,me);return tr&&(we=cd(we,tr*ft)),Oo(pt,we,It)},C.prototype.isTileClipped=function(){return!0},C}(xs);function jh(E,C){return C>0?C+2*E:E}function cd(E,C){for(var O=[],Q=new c(0,0),he=0;he<E.length;he++){for(var me=E[he],we=[],Re=0;Re<me.length;Re++){var $e=me[Re-1],ft=me[Re],pt=me[Re+1],It=Re===0?Q:ft.sub($e)._unit()._perp(),tr=Re===me.length-1?Q:pt.sub(ft)._unit()._perp(),Qt=It._add(tr)._unit(),dr=Qt.x*tr.x+Qt.y*tr.y;Qt._mult(1/dr),we.push(Qt._mult(C)._add(ft))}O.push(we)}return O}var hh=Do([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),hd=Do([{name:"a_projected_pos",components:3,type:"Float32"}],4);Do([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);var vd=Do([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]);Do([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);var Kh=Do([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),pd=Do([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);Do([{name:"triangle",components:3,type:"Uint16"}]),Do([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Do([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Do([{type:"Float32",name:"offsetX"}]),Do([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);function dd(E,C,O){var Q=C.layout.get("text-transform").evaluate(O,{});return Q==="uppercase"?E=E.toLocaleUpperCase():Q==="lowercase"&&(E=E.toLocaleLowerCase()),Xa.applyArabicShaping&&(E=Xa.applyArabicShaping(E)),E}function gd(E,C,O){return E.sections.forEach(function(Q){Q.text=dd(Q.text,C,O)}),E}function yd(E){var C={},O={},Q=[],he=0;function me($r){Q.push(E[$r]),he++}function we($r,kn,mn){var Sn=O[$r];return delete O[$r],O[kn]=Sn,Q[Sn].geometry[0].pop(),Q[Sn].geometry[0]=Q[Sn].geometry[0].concat(mn[0]),Sn}function Re($r,kn,mn){var Sn=C[kn];return delete C[kn],C[$r]=Sn,Q[Sn].geometry[0].shift(),Q[Sn].geometry[0]=mn[0].concat(Q[Sn].geometry[0]),Sn}function $e($r,kn,mn){var Sn=mn?kn[0][kn[0].length-1]:kn[0][0];return $r+":"+Sn.x+":"+Sn.y}for(var ft=0;ft<E.length;ft++){var pt=E[ft],It=pt.geometry,tr=pt.text?pt.text.toString():null;if(!tr){me(ft);continue}var Qt=$e(tr,It),dr=$e(tr,It,!0);if(Qt in O&&dr in C&&O[Qt]!==C[dr]){var Fr=Re(Qt,dr,It),an=we(Qt,dr,Q[Fr].geometry);delete C[Qt],delete O[dr],O[$e(tr,Q[an].geometry,!0)]=an,Q[Fr].geometry=null}else Qt in O?we(Qt,dr,It):dr in C?Re(Qt,dr,It):(me(ft),C[Qt]=he-1,O[dr]=he-1)}return Q.filter(function($r){return $r.geometry})}var hc={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42"};function md(E){for(var C="",O=0;O<E.length;O++){var Q=E.charCodeAt(O+1)||null,he=E.charCodeAt(O-1)||null,me=(!Q||!nn(Q)||hc[E[O+1]])&&(!he||!nn(he)||hc[E[O-1]]);me&&hc[E[O]]?C+=hc[E[O]]:C+=E[O]}return C}var hs=24,xd=function(E,C,O,Q,he){var me,we,Re=he*8-Q-1,$e=(1<<Re)-1,ft=$e>>1,pt=-7,It=O?he-1:0,tr=O?-1:1,Qt=E[C+It];for(It+=tr,me=Qt&(1<<-pt)-1,Qt>>=-pt,pt+=Re;pt>0;me=me*256+E[C+It],It+=tr,pt-=8);for(we=me&(1<<-pt)-1,me>>=-pt,pt+=Q;pt>0;we=we*256+E[C+It],It+=tr,pt-=8);if(me===0)me=1-ft;else{if(me===$e)return we?NaN:(Qt?-1:1)*(1/0);we=we+Math.pow(2,Q),me=me-ft}return(Qt?-1:1)*we*Math.pow(2,me-Q)},bd=function(E,C,O,Q,he,me){var we,Re,$e,ft=me*8-he-1,pt=(1<<ft)-1,It=pt>>1,tr=he===23?Math.pow(2,-24)-Math.pow(2,-77):0,Qt=Q?0:me-1,dr=Q?1:-1,Fr=C<0||C===0&&1/C<0?1:0;for(C=Math.abs(C),isNaN(C)||C===1/0?(Re=isNaN(C)?1:0,we=pt):(we=Math.floor(Math.log(C)/Math.LN2),C*($e=Math.pow(2,-we))<1&&(we--,$e*=2),we+It>=1?C+=tr/$e:C+=tr*Math.pow(2,1-It),C*$e>=2&&(we++,$e/=2),we+It>=pt?(Re=0,we=pt):we+It>=1?(Re=(C*$e-1)*Math.pow(2,he),we=we+It):(Re=C*Math.pow(2,It-1)*Math.pow(2,he),we=0));he>=8;E[O+Qt]=Re&255,Qt+=dr,Re/=256,he-=8);for(we=we<<he|Re,ft+=he;ft>0;E[O+Qt]=we&255,Qt+=dr,we/=256,ft-=8);E[O+Qt-dr]|=Fr*128},Rc={read:xd,write:bd},Ic=to;function to(E){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(E)?E:new Uint8Array(E||0),this.pos=0,this.type=0,this.length=this.buf.length}to.Varint=0,to.Fixed64=1,to.Bytes=2,to.Fixed32=5;var vh=(1<<16)*(1<<16),Jh=1/vh,_d=12,Qh=typeof TextDecoder>"u"?null:new TextDecoder("utf8");to.prototype={destroy:function(){this.buf=null},readFields:function(E,C,O){for(O=O||this.length;this.pos<O;){var Q=this.readVarint(),he=Q>>3,me=this.pos;this.type=Q&7,E(he,C,this),this.pos===me&&this.skip(Q)}return C},readMessage:function(E,C){return this.readFields(E,C,this.readVarint()+this.pos)},readFixed32:function(){var E=zc(this.buf,this.pos);return this.pos+=4,E},readSFixed32:function(){var E=qh(this.buf,this.pos);return this.pos+=4,E},readFixed64:function(){var E=zc(this.buf,this.pos)+zc(this.buf,this.pos+4)*vh;return this.pos+=8,E},readSFixed64:function(){var E=zc(this.buf,this.pos)+qh(this.buf,this.pos+4)*vh;return this.pos+=8,E},readFloat:function(){var E=Rc.read(this.buf,this.pos,!0,23,4);return this.pos+=4,E},readDouble:function(){var E=Rc.read(this.buf,this.pos,!0,52,8);return this.pos+=8,E},readVarint:function(E){var C=this.buf,O,Q;return Q=C[this.pos++],O=Q&127,Q<128||(Q=C[this.pos++],O|=(Q&127)<<7,Q<128)||(Q=C[this.pos++],O|=(Q&127)<<14,Q<128)||(Q=C[this.pos++],O|=(Q&127)<<21,Q<128)?O:(Q=C[this.pos],O|=(Q&15)<<28,wd(O,E,this))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var E=this.readVarint();return E%2===1?(E+1)/-2:E/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var E=this.readVarint()+this.pos,C=this.pos;return this.pos=E,E-C>=_d&&Qh?Fd(this.buf,C,E):zd(this.buf,C,E)},readBytes:function(){var E=this.readVarint()+this.pos,C=this.buf.subarray(this.pos,E);return this.pos=E,C},readPackedVarint:function(E,C){if(this.type!==to.Bytes)return E.push(this.readVarint(C));var O=ju(this);for(E=E||[];this.pos<O;)E.push(this.readVarint(C));return E},readPackedSVarint:function(E){if(this.type!==to.Bytes)return E.push(this.readSVarint());var C=ju(this);for(E=E||[];this.pos<C;)E.push(this.readSVarint());return E},readPackedBoolean:function(E){if(this.type!==to.Bytes)return E.push(this.readBoolean());var C=ju(this);for(E=E||[];this.pos<C;)E.push(this.readBoolean());return E},readPackedFloat:function(E){if(this.type!==to.Bytes)return E.push(this.readFloat());var C=ju(this);for(E=E||[];this.pos<C;)E.push(this.readFloat());return E},readPackedDouble:function(E){if(this.type!==to.Bytes)return E.push(this.readDouble());var C=ju(this);for(E=E||[];this.pos<C;)E.push(this.readDouble());return E},readPackedFixed32:function(E){if(this.type!==to.Bytes)return E.push(this.readFixed32());var C=ju(this);for(E=E||[];this.pos<C;)E.push(this.readFixed32());return E},readPackedSFixed32:function(E){if(this.type!==to.Bytes)return E.push(this.readSFixed32());var C=ju(this);for(E=E||[];this.pos<C;)E.push(this.readSFixed32());return E},readPackedFixed64:function(E){if(this.type!==to.Bytes)return E.push(this.readFixed64());var C=ju(this);for(E=E||[];this.pos<C;)E.push(this.readFixed64());return E},readPackedSFixed64:function(E){if(this.type!==to.Bytes)return E.push(this.readSFixed64());var C=ju(this);for(E=E||[];this.pos<C;)E.push(this.readSFixed64());return E},skip:function(E){var C=E&7;if(C===to.Varint)for(;this.buf[this.pos++]>127;);else if(C===to.Bytes)this.pos=this.readVarint()+this.pos;else if(C===to.Fixed32)this.pos+=4;else if(C===to.Fixed64)this.pos+=8;else throw new Error("Unimplemented type: "+C)},writeTag:function(E,C){this.writeVarint(E<<3|C)},realloc:function(E){for(var C=this.length||16;C<this.pos+E;)C*=2;if(C!==this.length){var O=new Uint8Array(C);O.set(this.buf),this.buf=O,this.length=C}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(E){this.realloc(4),Nf(this.buf,E,this.pos),this.pos+=4},writeSFixed32:function(E){this.realloc(4),Nf(this.buf,E,this.pos),this.pos+=4},writeFixed64:function(E){this.realloc(8),Nf(this.buf,E&-1,this.pos),Nf(this.buf,Math.floor(E*Jh),this.pos+4),this.pos+=8},writeSFixed64:function(E){this.realloc(8),Nf(this.buf,E&-1,this.pos),Nf(this.buf,Math.floor(E*Jh),this.pos+4),this.pos+=8},writeVarint:function(E){if(E=+E||0,E>268435455||E<0){Td(E,this);return}this.realloc(4),this.buf[this.pos++]=E&127|(E>127?128:0),!(E<=127)&&(this.buf[this.pos++]=(E>>>=7)&127|(E>127?128:0),!(E<=127)&&(this.buf[this.pos++]=(E>>>=7)&127|(E>127?128:0),!(E<=127)&&(this.buf[this.pos++]=E>>>7&127)))},writeSVarint:function(E){this.writeVarint(E<0?-E*2-1:E*2)},writeBoolean:function(E){this.writeVarint(Boolean(E))},writeString:function(E){E=String(E),this.realloc(E.length*4),this.pos++;var C=this.pos;this.pos=Od(this.buf,E,this.pos);var O=this.pos-C;O>=128&&$h(C,O,this),this.pos=C-1,this.writeVarint(O),this.pos+=O},writeFloat:function(E){this.realloc(4),Rc.write(this.buf,E,this.pos,!0,23,4),this.pos+=4},writeDouble:function(E){this.realloc(8),Rc.write(this.buf,E,this.pos,!0,52,8),this.pos+=8},writeBytes:function(E){var C=E.length;this.writeVarint(C),this.realloc(C);for(var O=0;O<C;O++)this.buf[this.pos++]=E[O]},writeRawMessage:function(E,C){this.pos++;var O=this.pos;E(C,this);var Q=this.pos-O;Q>=128&&$h(O,Q,this),this.pos=O-1,this.writeVarint(Q),this.pos+=Q},writeMessage:function(E,C,O){this.writeTag(E,to.Bytes),this.writeRawMessage(C,O)},writePackedVarint:function(E,C){C.length&&this.writeMessage(E,Sd,C)},writePackedSVarint:function(E,C){C.length&&this.writeMessage(E,kd,C)},writePackedBoolean:function(E,C){C.length&&this.writeMessage(E,Ld,C)},writePackedFloat:function(E,C){C.length&&this.writeMessage(E,Ed,C)},writePackedDouble:function(E,C){C.length&&this.writeMessage(E,Cd,C)},writePackedFixed32:function(E,C){C.length&&this.writeMessage(E,Pd,C)},writePackedSFixed32:function(E,C){C.length&&this.writeMessage(E,Dd,C)},writePackedFixed64:function(E,C){C.length&&this.writeMessage(E,Rd,C)},writePackedSFixed64:function(E,C){C.length&&this.writeMessage(E,Id,C)},writeBytesField:function(E,C){this.writeTag(E,to.Bytes),this.writeBytes(C)},writeFixed32Field:function(E,C){this.writeTag(E,to.Fixed32),this.writeFixed32(C)},writeSFixed32Field:function(E,C){this.writeTag(E,to.Fixed32),this.writeSFixed32(C)},writeFixed64Field:function(E,C){this.writeTag(E,to.Fixed64),this.writeFixed64(C)},writeSFixed64Field:function(E,C){this.writeTag(E,to.Fixed64),this.writeSFixed64(C)},writeVarintField:function(E,C){this.writeTag(E,to.Varint),this.writeVarint(C)},writeSVarintField:function(E,C){this.writeTag(E,to.Varint),this.writeSVarint(C)},writeStringField:function(E,C){this.writeTag(E,to.Bytes),this.writeString(C)},writeFloatField:function(E,C){this.writeTag(E,to.Fixed32),this.writeFloat(C)},writeDoubleField:function(E,C){this.writeTag(E,to.Fixed64),this.writeDouble(C)},writeBooleanField:function(E,C){this.writeVarintField(E,Boolean(C))}};function wd(E,C,O){var Q=O.buf,he,me;if(me=Q[O.pos++],he=(me&112)>>4,me<128||(me=Q[O.pos++],he|=(me&127)<<3,me<128)||(me=Q[O.pos++],he|=(me&127)<<10,me<128)||(me=Q[O.pos++],he|=(me&127)<<17,me<128)||(me=Q[O.pos++],he|=(me&127)<<24,me<128)||(me=Q[O.pos++],he|=(me&1)<<31,me<128))return Bf(E,he,C);throw new Error("Expected varint not more than 10 bytes")}function ju(E){return E.type===to.Bytes?E.readVarint()+E.pos:E.pos+1}function Bf(E,C,O){return O?C*4294967296+(E>>>0):(C>>>0)*4294967296+(E>>>0)}function Td(E,C){var O,Q;if(E>=0?(O=E%4294967296|0,Q=E/4294967296|0):(O=~(-E%4294967296),Q=~(-E/4294967296),O^4294967295?O=O+1|0:(O=0,Q=Q+1|0)),E>=18446744073709552e3||E<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");C.realloc(10),Ad(O,Q,C),Md(Q,C)}function Ad(E,C,O){O.buf[O.pos++]=E&127|128,E>>>=7,O.buf[O.pos++]=E&127|128,E>>>=7,O.buf[O.pos++]=E&127|128,E>>>=7,O.buf[O.pos++]=E&127|128,E>>>=7,O.buf[O.pos]=E&127}function Md(E,C){var O=(E&7)<<4;C.buf[C.pos++]|=O|((E>>>=3)?128:0),E&&(C.buf[C.pos++]=E&127|((E>>>=7)?128:0),E&&(C.buf[C.pos++]=E&127|((E>>>=7)?128:0),E&&(C.buf[C.pos++]=E&127|((E>>>=7)?128:0),E&&(C.buf[C.pos++]=E&127|((E>>>=7)?128:0),E&&(C.buf[C.pos++]=E&127)))))}function $h(E,C,O){var Q=C<=16383?1:C<=2097151?2:C<=268435455?3:Math.floor(Math.log(C)/(Math.LN2*7));O.realloc(Q);for(var he=O.pos-1;he>=E;he--)O.buf[he+Q]=O.buf[he]}function Sd(E,C){for(var O=0;O<E.length;O++)C.writeVarint(E[O])}function kd(E,C){for(var O=0;O<E.length;O++)C.writeSVarint(E[O])}function Ed(E,C){for(var O=0;O<E.length;O++)C.writeFloat(E[O])}function Cd(E,C){for(var O=0;O<E.length;O++)C.writeDouble(E[O])}function Ld(E,C){for(var O=0;O<E.length;O++)C.writeBoolean(E[O])}function Pd(E,C){for(var O=0;O<E.length;O++)C.writeFixed32(E[O])}function Dd(E,C){for(var O=0;O<E.length;O++)C.writeSFixed32(E[O])}function Rd(E,C){for(var O=0;O<E.length;O++)C.writeFixed64(E[O])}function Id(E,C){for(var O=0;O<E.length;O++)C.writeSFixed64(E[O])}function zc(E,C){return(E[C]|E[C+1]<<8|E[C+2]<<16)+E[C+3]*16777216}function Nf(E,C,O){E[O]=C,E[O+1]=C>>>8,E[O+2]=C>>>16,E[O+3]=C>>>24}function qh(E,C){return(E[C]|E[C+1]<<8|E[C+2]<<16)+(E[C+3]<<24)}function zd(E,C,O){for(var Q="",he=C;he<O;){var me=E[he],we=null,Re=me>239?4:me>223?3:me>191?2:1;if(he+Re>O)break;var $e,ft,pt;Re===1?me<128&&(we=me):Re===2?($e=E[he+1],($e&192)===128&&(we=(me&31)<<6|$e&63,we<=127&&(we=null))):Re===3?($e=E[he+1],ft=E[he+2],($e&192)===128&&(ft&192)===128&&(we=(me&15)<<12|($e&63)<<6|ft&63,(we<=2047||we>=55296&&we<=57343)&&(we=null))):Re===4&&($e=E[he+1],ft=E[he+2],pt=E[he+3],($e&192)===128&&(ft&192)===128&&(pt&192)===128&&(we=(me&15)<<18|($e&63)<<12|(ft&63)<<6|pt&63,(we<=65535||we>=1114112)&&(we=null))),we===null?(we=65533,Re=1):we>65535&&(we-=65536,Q+=String.fromCharCode(we>>>10&1023|55296),we=56320|we&1023),Q+=String.fromCharCode(we),he+=Re}return Q}function Fd(E,C,O){return Qh.decode(E.subarray(C,O))}function Od(E,C,O){for(var Q=0,he,me;Q<C.length;Q++){if(he=C.charCodeAt(Q),he>55295&&he<57344)if(me)if(he<56320){E[O++]=239,E[O++]=191,E[O++]=189,me=he;continue}else he=me-55296<<10|he-56320|65536,me=null;else{he>56319||Q+1===C.length?(E[O++]=239,E[O++]=191,E[O++]=189):me=he;continue}else me&&(E[O++]=239,E[O++]=191,E[O++]=189,me=null);he<128?E[O++]=he:(he<2048?E[O++]=he>>6|192:(he<65536?E[O++]=he>>12|224:(E[O++]=he>>18|240,E[O++]=he>>12&63|128),E[O++]=he>>6&63|128),E[O++]=he&63|128)}return O}var ph=3;function Bd(E,C,O){E===1&&O.readMessage(Nd,C)}function Nd(E,C,O){if(E===3){var Q=O.readMessage(Ud,{}),he=Q.id,me=Q.bitmap,we=Q.width,Re=Q.height,$e=Q.left,ft=Q.top,pt=Q.advance;C.push({id:he,bitmap:new _f({width:we+2*ph,height:Re+2*ph},me),metrics:{width:we,height:Re,left:$e,top:ft,advance:pt}})}}function Ud(E,C,O){E===1?C.id=O.readVarint():E===2?C.bitmap=O.readBytes():E===3?C.width=O.readVarint():E===4?C.height=O.readVarint():E===5?C.left=O.readSVarint():E===6?C.top=O.readSVarint():E===7&&(C.advance=O.readVarint())}function Hd(E){return new Ic(E).readFields(Bd,[])}var ev=ph;function tv(E){for(var C=0,O=0,Q=0,he=E;Q<he.length;Q+=1){var me=he[Q];C+=me.w*me.h,O=Math.max(O,me.w)}E.sort(function(an,$r){return $r.h-an.h});for(var we=Math.max(Math.ceil(Math.sqrt(C/.95)),O),Re=[{x:0,y:0,w:we,h:1/0}],$e=0,ft=0,pt=0,It=E;pt<It.length;pt+=1)for(var tr=It[pt],Qt=Re.length-1;Qt>=0;Qt--){var dr=Re[Qt];if(!(tr.w>dr.w||tr.h>dr.h)){if(tr.x=dr.x,tr.y=dr.y,ft=Math.max(ft,tr.y+tr.h),$e=Math.max($e,tr.x+tr.w),tr.w===dr.w&&tr.h===dr.h){var Fr=Re.pop();Qt<Re.length&&(Re[Qt]=Fr)}else tr.h===dr.h?(dr.x+=tr.w,dr.w-=tr.w):tr.w===dr.w?(dr.y+=tr.h,dr.h-=tr.h):(Re.push({x:dr.x+tr.w,y:dr.y,w:dr.w-tr.w,h:tr.h}),dr.y+=tr.h,dr.h-=tr.h);break}}return{w:$e,h:ft,fill:C/($e*ft)||0}}var cl=1,Fc=function(C,O){var Q=O.pixelRatio,he=O.version,me=O.stretchX,we=O.stretchY,Re=O.content;this.paddedRect=C,this.pixelRatio=Q,this.stretchX=me,this.stretchY=we,this.content=Re,this.version=he},vc={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};vc.tl.get=function(){return[this.paddedRect.x+cl,this.paddedRect.y+cl]},vc.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-cl,this.paddedRect.y+this.paddedRect.h-cl]},vc.tlbr.get=function(){return this.tl.concat(this.br)},vc.displaySize.get=function(){return[(this.paddedRect.w-cl*2)/this.pixelRatio,(this.paddedRect.h-cl*2)/this.pixelRatio]},Object.defineProperties(Fc.prototype,vc);var pc=function(C,O){var Q={},he={};this.haveRenderCallbacks=[];var me=[];this.addImages(C,Q,me),this.addImages(O,he,me);var we=tv(me),Re=we.w,$e=we.h,ft=new el({width:Re||1,height:$e||1});for(var pt in C){var It=C[pt],tr=Q[pt].paddedRect;el.copy(It.data,ft,{x:0,y:0},{x:tr.x+cl,y:tr.y+cl},It.data)}for(var Qt in O){var dr=O[Qt],Fr=he[Qt].paddedRect,an=Fr.x+cl,$r=Fr.y+cl,kn=dr.data.width,mn=dr.data.height;el.copy(dr.data,ft,{x:0,y:0},{x:an,y:$r},dr.data),el.copy(dr.data,ft,{x:0,y:mn-1},{x:an,y:$r-1},{width:kn,height:1}),el.copy(dr.data,ft,{x:0,y:0},{x:an,y:$r+mn},{width:kn,height:1}),el.copy(dr.data,ft,{x:kn-1,y:0},{x:an-1,y:$r},{width:1,height:mn}),el.copy(dr.data,ft,{x:0,y:0},{x:an+kn,y:$r},{width:1,height:mn})}this.image=ft,this.iconPositions=Q,this.patternPositions=he};pc.prototype.addImages=function(C,O,Q){for(var he in C){var me=C[he],we={x:0,y:0,w:me.data.width+2*cl,h:me.data.height+2*cl};Q.push(we),O[he]=new Fc(we,me),me.hasRenderCallback&&this.haveRenderCallbacks.push(he)}},pc.prototype.patchUpdatedImages=function(C,O){C.dispatchRenderCallbacks(this.haveRenderCallbacks);for(var Q in C.updatedImages)this.patchUpdatedImage(this.iconPositions[Q],C.getImage(Q),O),this.patchUpdatedImage(this.patternPositions[Q],C.getImage(Q),O)},pc.prototype.patchUpdatedImage=function(C,O,Q){if(!(!C||!O)&&C.version!==O.version){C.version=O.version;var he=C.tl,me=he[0],we=he[1];Q.update(O.data,void 0,{x:me,y:we})}},Ie("ImagePosition",Fc),Ie("ImageAtlas",pc);var kl={horizontal:1,vertical:2,horizontalOnly:3},dc=-17;function Vd(E){for(var C=0,O=E;C<O.length;C+=1){var Q=O[C];if(Q.positionedGlyphs.length!==0)return!1}return!0}var rv=57344,nv=63743,Uf=function(){this.scale=1,this.fontStack="",this.imageName=null};Uf.forText=function(C,O){var Q=new Uf;return Q.scale=C||1,Q.fontStack=O,Q},Uf.forImage=function(C){var O=new Uf;return O.imageName=C,O};var Cs=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};Cs.fromFeature=function(C,O){for(var Q=new Cs,he=0;he<C.sections.length;he++){var me=C.sections[he];me.image?Q.addImageSection(me):Q.addTextSection(me,O)}return Q},Cs.prototype.length=function(){return this.text.length},Cs.prototype.getSection=function(C){return this.sections[this.sectionIndex[C]]},Cs.prototype.getSectionIndex=function(C){return this.sectionIndex[C]},Cs.prototype.getCharCode=function(C){return this.text.charCodeAt(C)},Cs.prototype.verticalizePunctuation=function(){this.text=md(this.text)},Cs.prototype.trim=function(){for(var C=0,O=0;O<this.text.length&&Gu[this.text.charCodeAt(O)];O++)C++;for(var Q=this.text.length,he=this.text.length-1;he>=0&&he>=C&&Gu[this.text.charCodeAt(he)];he--)Q--;this.text=this.text.substring(C,Q),this.sectionIndex=this.sectionIndex.slice(C,Q)},Cs.prototype.substring=function(C,O){var Q=new Cs;return Q.text=this.text.substring(C,O),Q.sectionIndex=this.sectionIndex.slice(C,O),Q.sections=this.sections,Q},Cs.prototype.toString=function(){return this.text},Cs.prototype.getMaxScale=function(){var C=this;return this.sectionIndex.reduce(function(O,Q){return Math.max(O,C.sections[Q].scale)},0)},Cs.prototype.addTextSection=function(C,O){this.text+=C.text,this.sections.push(Uf.forText(C.scale,C.fontStack||O));for(var Q=this.sections.length-1,he=0;he<C.text.length;++he)this.sectionIndex.push(Q)},Cs.prototype.addImageSection=function(C){var O=C.image?C.image.name:"";if(O.length===0){B("Can't add FormattedSection with an empty image.");return}var Q=this.getNextImageSectionCharCode();if(!Q){B("Reached maximum number of images "+(nv-rv+2));return}this.text+=String.fromCharCode(Q),this.sections.push(Uf.forImage(O)),this.sectionIndex.push(this.sections.length-1)},Cs.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=nv?null:++this.imageSectionID:(this.imageSectionID=rv,this.imageSectionID)};function Gd(E,C){for(var O=[],Q=E.text,he=0,me=0,we=C;me<we.length;me+=1){var Re=we[me];O.push(E.substring(he,Re)),he=Re}return he<Q.length&&O.push(E.substring(he,Q.length)),O}function Oc(E,C,O,Q,he,me,we,Re,$e,ft,pt,It,tr,Qt,dr,Fr){var an=Cs.fromFeature(E,he);It===kl.vertical&&an.verticalizePunctuation();var $r,kn=Xa.processBidirectionalText,mn=Xa.processStyledBidirectionalText;if(kn&&an.sections.length===1){$r=[];for(var Sn=kn(an.toString(),dh(an,ft,me,C,Q,Qt,dr)),In=0,Gn=Sn;In<Gn.length;In+=1){var oa=Gn[In],na=new Cs;na.text=oa,na.sections=an.sections;for(var Ra=0;Ra<oa.length;Ra++)na.sectionIndex.push(0);$r.push(na)}}else if(mn){$r=[];for(var wa=mn(an.text,an.sectionIndex,dh(an,ft,me,C,Q,Qt,dr)),Ma=0,ti=wa;Ma<ti.length;Ma+=1){var Ca=ti[Ma],Da=new Cs;Da.text=Ca[0],Da.sectionIndex=Ca[1],Da.sections=an.sections,$r.push(Da)}}else $r=Gd(an,dh(an,ft,me,C,Q,Qt,dr));var fi=[],qa={positionedLines:fi,text:an.toString(),top:pt[1],bottom:pt[1],left:pt[0],right:pt[0],writingMode:It,iconsInText:!1,verticalizable:!1};return Xd(qa,C,O,Q,$r,we,Re,$e,It,ft,tr,Fr),Vd(fi)?!1:qa}var Gu={};Gu[9]=!0,Gu[10]=!0,Gu[11]=!0,Gu[12]=!0,Gu[13]=!0,Gu[32]=!0;var hl={};hl[10]=!0,hl[32]=!0,hl[38]=!0,hl[40]=!0,hl[41]=!0,hl[43]=!0,hl[45]=!0,hl[47]=!0,hl[173]=!0,hl[183]=!0,hl[8203]=!0,hl[8208]=!0,hl[8211]=!0,hl[8231]=!0;function av(E,C,O,Q,he,me){if(C.imageName){var $e=Q[C.imageName];return $e?$e.displaySize[0]*C.scale*hs/me+he:0}else{var we=O[C.fontStack],Re=we&&we[E];return Re?Re.metrics.advance*C.scale+he:0}}function Yd(E,C,O,Q,he,me){for(var we=0,Re=0;Re<E.length();Re++){var $e=E.getSection(Re);we+=av(E.getCharCode(Re),$e,Q,he,C,me)}var ft=Math.max(1,Math.ceil(we/O));return we/ft}function iv(E,C,O,Q){var he=Math.pow(E-C,2);return Q?E<C?he/2:he*2:he+Math.abs(O)*O}function Wd(E,C,O){var Q=0;return E===10&&(Q-=1e4),O&&(Q+=150),(E===40||E===65288)&&(Q+=50),(C===41||C===65289)&&(Q+=50),Q}function ov(E,C,O,Q,he,me){for(var we=null,Re=iv(C,O,he,me),$e=0,ft=Q;$e<ft.length;$e+=1){var pt=ft[$e],It=C-pt.x,tr=iv(It,O,he,me)+pt.badness;tr<=Re&&(we=pt,Re=tr)}return{index:E,x:C,priorBreak:we,badness:Re}}function sv(E){return E?sv(E.priorBreak).concat(E.index):[]}function dh(E,C,O,Q,he,me,we){if(me!=="point")return[];if(!E)return[];for(var Re=[],$e=Yd(E,C,O,Q,he,we),ft=E.text.indexOf("\u200B")>=0,pt=0,It=0;It<E.length();It++){var tr=E.getSection(It),Qt=E.getCharCode(It);if(Gu[Qt]||(pt+=av(Qt,tr,Q,he,C,we)),It<E.length()-1){var dr=Lr(Qt);(hl[Qt]||dr||tr.imageName)&&Re.push(ov(It+1,pt,$e,Re,Wd(Qt,E.getCharCode(It+1),dr&&ft),!1))}}return sv(ov(E.length(),pt,$e,Re,0,!0))}function gh(E){var C=.5,O=.5;switch(E){case"right":case"top-right":case"bottom-right":C=1;break;case"left":case"top-left":case"bottom-left":C=0;break}switch(E){case"bottom":case"bottom-right":case"bottom-left":O=1;break;case"top":case"top-right":case"top-left":O=0;break}return{horizontalAlign:C,verticalAlign:O}}function Xd(E,C,O,Q,he,me,we,Re,$e,ft,pt,It){for(var tr=0,Qt=dc,dr=0,Fr=0,an=Re==="right"?1:Re==="left"?0:.5,$r=0,kn=0,mn=he;kn<mn.length;kn+=1){var Sn=mn[kn];Sn.trim();var In=Sn.getMaxScale(),Gn=(In-1)*hs,oa={positionedGlyphs:[],lineOffset:0};E.positionedLines[$r]=oa;var na=oa.positionedGlyphs,Ra=0;if(!Sn.length()){Qt+=me,++$r;continue}for(var wa=0;wa<Sn.length();wa++){var Ma=Sn.getSection(wa),ti=Sn.getSectionIndex(wa),Ca=Sn.getCharCode(wa),Da=0,fi=null,qa=null,ki=null,Wi=hs,Ei=!($e===kl.horizontal||!pt&&!Br(Ca)||pt&&(Gu[Ca]||on(Ca)));if(Ma.imageName){var wo=Q[Ma.imageName];if(!wo)continue;ki=Ma.imageName,E.iconsInText=E.iconsInText||!0,qa=wo.paddedRect;var Co=wo.displaySize;Ma.scale=Ma.scale*hs/It,fi={width:Co[0],height:Co[1],left:cl,top:-ev,advance:Ei?Co[1]:Co[0]};var qo=hs-Co[1]*Ma.scale;Da=Gn+qo,Wi=fi.advance;var Ho=Ei?Co[0]*Ma.scale-hs*In:Co[1]*Ma.scale-hs*In;Ho>0&&Ho>Ra&&(Ra=Ho)}else{var Ci=O[Ma.fontStack],Ti=Ci&&Ci[Ca];if(Ti&&Ti.rect)qa=Ti.rect,fi=Ti.metrics;else{var $i=C[Ma.fontStack],ro=$i&&$i[Ca];if(!ro)continue;fi=ro.metrics}Da=(In-Ma.scale)*hs}Ei?(E.verticalizable=!0,na.push({glyph:Ca,imageName:ki,x:tr,y:Qt+Da,vertical:Ei,scale:Ma.scale,fontStack:Ma.fontStack,sectionIndex:ti,metrics:fi,rect:qa}),tr+=Wi*Ma.scale+ft):(na.push({glyph:Ca,imageName:ki,x:tr,y:Qt+Da,vertical:Ei,scale:Ma.scale,fontStack:Ma.fontStack,sectionIndex:ti,metrics:fi,rect:qa}),tr+=fi.advance*Ma.scale+ft)}if(na.length!==0){var Ls=tr-ft;dr=Math.max(Ls,dr),Zd(na,0,na.length-1,an,Ra)}tr=0;var Ps=me*In+Ra;oa.lineOffset=Math.max(Ra,Gn),Qt+=Ps,Fr=Math.max(Ps,Fr),++$r}var es=Qt-dc,Ns=gh(we),Us=Ns.horizontalAlign,Xo=Ns.verticalAlign;jd(E.positionedLines,an,Us,Xo,dr,Fr,me,es,he.length),E.top+=-Xo*es,E.bottom=E.top+es,E.left+=-Us*dr,E.right=E.left+dr}function Zd(E,C,O,Q,he){if(!(!Q&&!he))for(var me=E[O],we=me.metrics.advance*me.scale,Re=(E[O].x+we)*Q,$e=C;$e<=O;$e++)E[$e].x-=Re,E[$e].y+=he}function jd(E,C,O,Q,he,me,we,Re,$e){var ft=(C-O)*he,pt=0;me!==we?pt=-Re*Q-dc:pt=(-Q*$e+.5)*we;for(var It=0,tr=E;It<tr.length;It+=1)for(var Qt=tr[It],dr=0,Fr=Qt.positionedGlyphs;dr<Fr.length;dr+=1){var an=Fr[dr];an.x+=ft,an.y+=pt}}function Kd(E,C,O){var Q=gh(O),he=Q.horizontalAlign,me=Q.verticalAlign,we=C[0],Re=C[1],$e=we-E.displaySize[0]*he,ft=$e+E.displaySize[0],pt=Re-E.displaySize[1]*me,It=pt+E.displaySize[1];return{image:E,top:pt,bottom:It,left:$e,right:ft}}function lv(E,C,O,Q,he,me){var we=E.image,Re;if(we.content){var $e=we.content,ft=we.pixelRatio||1;Re=[$e[0]/ft,$e[1]/ft,we.displaySize[0]-$e[2]/ft,we.displaySize[1]-$e[3]/ft]}var pt=C.left*me,It=C.right*me,tr,Qt,dr,Fr;O==="width"||O==="both"?(Fr=he[0]+pt-Q[3],Qt=he[0]+It+Q[1]):(Fr=he[0]+(pt+It-we.displaySize[0])/2,Qt=Fr+we.displaySize[0]);var an=C.top*me,$r=C.bottom*me;return O==="height"||O==="both"?(tr=he[1]+an-Q[0],dr=he[1]+$r+Q[2]):(tr=he[1]+(an+$r-we.displaySize[1])/2,dr=tr+we.displaySize[1]),{image:we,top:tr,right:Qt,bottom:dr,left:Fr,collisionPadding:Re}}var Hf=function(E){function C(O,Q,he,me){E.call(this,O,Q),this.angle=he,me!==void 0&&(this.segment=me)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.clone=function(){return new C(this.x,this.y,this.angle,this.segment)},C}(c);Ie("Anchor",Hf);var Tu=128;function yh(E,C){var O=C.expression;if(O.kind==="constant"){var Q=O.evaluate(new si(E+1));return{kind:"constant",layoutSize:Q}}else{if(O.kind==="source")return{kind:"source"};for(var he=O.zoomStops,me=O.interpolationType,we=0;we<he.length&&he[we]<=E;)we++;we=Math.max(0,we-1);for(var Re=we;Re<he.length&&he[Re]<E+1;)Re++;Re=Math.min(he.length-1,Re);var $e=he[we],ft=he[Re];if(O.kind==="composite")return{kind:"composite",minZoom:$e,maxZoom:ft,interpolationType:me};var pt=O.evaluate(new si($e)),It=O.evaluate(new si(ft));return{kind:"camera",minZoom:$e,maxZoom:ft,minSize:pt,maxSize:It,interpolationType:me}}}function uv(E,C,O){var Q=C.uSize,he=C.uSizeT,me=O.lowerSize,we=O.upperSize;return E.kind==="source"?me/Tu:E.kind==="composite"?oo(me/Tu,we/Tu,he):Q}function fv(E,C){var O=0,Q=0;if(E.kind==="constant")Q=E.layoutSize;else if(E.kind!=="source"){var he=E.interpolationType,me=E.minZoom,we=E.maxZoom,Re=he?h(so.interpolationFactor(he,C,me,we),0,1):0;E.kind==="camera"?Q=oo(E.minSize,E.maxSize,Re):O=Re}return{uSizeT:O,uSize:Q}}var Jd=Object.freeze({__proto__:null,getSizeData:yh,evaluateSizeForFeature:uv,evaluateSizeForZoom:fv,SIZE_PACK_FACTOR:Tu});function cv(E,C,O,Q,he){if(C.segment===void 0)return!0;for(var me=C,we=C.segment+1,Re=0;Re>-O/2;){if(we--,we<0)return!1;Re-=E[we].dist(me),me=E[we]}Re+=E[we].dist(E[we+1]),we++;for(var $e=[],ft=0;Re<O/2;){var pt=E[we-1],It=E[we],tr=E[we+1];if(!tr)return!1;var Qt=pt.angleTo(It)-It.angleTo(tr);for(Qt=Math.abs((Qt+3*Math.PI)%(Math.PI*2)-Math.PI),$e.push({distance:Re,angleDelta:Qt}),ft+=Qt;Re-$e[0].distance>Q;)ft-=$e.shift().angleDelta;if(ft>he)return!1;we++,Re+=It.dist(tr)}return!0}function hv(E){for(var C=0,O=0;O<E.length-1;O++)C+=E[O].dist(E[O+1]);return C}function vv(E,C,O){return E?3/5*C*O:0}function pv(E,C){return Math.max(E?E.right-E.left:0,C?C.right-C.left:0)}function Qd(E,C,O,Q,he,me){for(var we=vv(O,he,me),Re=pv(O,Q)*me,$e=0,ft=hv(E)/2,pt=0;pt<E.length-1;pt++){var It=E[pt],tr=E[pt+1],Qt=It.dist(tr);if($e+Qt>ft){var dr=(ft-$e)/Qt,Fr=oo(It.x,tr.x,dr),an=oo(It.y,tr.y,dr),$r=new Hf(Fr,an,tr.angleTo(It),pt);return $r._round(),!we||cv(E,$r,Re,we,C)?$r:void 0}$e+=Qt}}function $d(E,C,O,Q,he,me,we,Re,$e){var ft=vv(Q,me,we),pt=pv(Q,he),It=pt*we,tr=E[0].x===0||E[0].x===$e||E[0].y===0||E[0].y===$e;C-It<C/4&&(C=It+C/4);var Qt=me*2,dr=tr?C/2*Re%C:(pt/2+Qt)*we*Re%C;return dv(E,dr,C,ft,O,It,tr,!1,$e)}function dv(E,C,O,Q,he,me,we,Re,$e){for(var ft=me/2,pt=hv(E),It=0,tr=C-O,Qt=[],dr=0;dr<E.length-1;dr++){for(var Fr=E[dr],an=E[dr+1],$r=Fr.dist(an),kn=an.angleTo(Fr);tr+O<It+$r;){tr+=O;var mn=(tr-It)/$r,Sn=oo(Fr.x,an.x,mn),In=oo(Fr.y,an.y,mn);if(Sn>=0&&Sn<$e&&In>=0&&In<$e&&tr-ft>=0&&tr+ft<=pt){var Gn=new Hf(Sn,In,kn,dr);Gn._round(),(!Q||cv(E,Gn,me,Q,he))&&Qt.push(Gn)}}It+=$r}return!Re&&!Qt.length&&!we&&(Qt=dv(E,It/2,O,Q,he,me,we,!0,$e)),Qt}function gv(E,C,O,Q,he){for(var me=[],we=0;we<E.length;we++)for(var Re=E[we],$e=void 0,ft=0;ft<Re.length-1;ft++){var pt=Re[ft],It=Re[ft+1];pt.x<C&&It.x<C||(pt.x<C?pt=new c(C,pt.y+(It.y-pt.y)*((C-pt.x)/(It.x-pt.x)))._round():It.x<C&&(It=new c(C,pt.y+(It.y-pt.y)*((C-pt.x)/(It.x-pt.x)))._round()),!(pt.y<O&&It.y<O)&&(pt.y<O?pt=new c(pt.x+(It.x-pt.x)*((O-pt.y)/(It.y-pt.y)),O)._round():It.y<O&&(It=new c(pt.x+(It.x-pt.x)*((O-pt.y)/(It.y-pt.y)),O)._round()),!(pt.x>=Q&&It.x>=Q)&&(pt.x>=Q?pt=new c(Q,pt.y+(It.y-pt.y)*((Q-pt.x)/(It.x-pt.x)))._round():It.x>=Q&&(It=new c(Q,pt.y+(It.y-pt.y)*((Q-pt.x)/(It.x-pt.x)))._round()),!(pt.y>=he&&It.y>=he)&&(pt.y>=he?pt=new c(pt.x+(It.x-pt.x)*((he-pt.y)/(It.y-pt.y)),he)._round():It.y>=he&&(It=new c(pt.x+(It.x-pt.x)*((he-pt.y)/(It.y-pt.y)),he)._round()),(!$e||!pt.equals($e[$e.length-1]))&&($e=[pt],me.push($e)),$e.push(It)))))}return me}var Vf=cl;function yv(E,C,O,Q){var he=[],me=E.image,we=me.pixelRatio,Re=me.paddedRect.w-2*Vf,$e=me.paddedRect.h-2*Vf,ft=E.right-E.left,pt=E.bottom-E.top,It=me.stretchX||[[0,Re]],tr=me.stretchY||[[0,$e]],Qt=function(Ci,Ti){return Ci+Ti[1]-Ti[0]},dr=It.reduce(Qt,0),Fr=tr.reduce(Qt,0),an=Re-dr,$r=$e-Fr,kn=0,mn=dr,Sn=0,In=Fr,Gn=0,oa=an,na=0,Ra=$r;if(me.content&&Q){var wa=me.content;kn=Bc(It,0,wa[0]),Sn=Bc(tr,0,wa[1]),mn=Bc(It,wa[0],wa[2]),In=Bc(tr,wa[1],wa[3]),Gn=wa[0]-kn,na=wa[1]-Sn,oa=wa[2]-wa[0]-mn,Ra=wa[3]-wa[1]-In}var Ma=function(Ci,Ti,$i,ro){var wo=Nc(Ci.stretch-kn,mn,ft,E.left),Co=Uc(Ci.fixed-Gn,oa,Ci.stretch,dr),qo=Nc(Ti.stretch-Sn,In,pt,E.top),Ho=Uc(Ti.fixed-na,Ra,Ti.stretch,Fr),Ls=Nc($i.stretch-kn,mn,ft,E.left),Ps=Uc($i.fixed-Gn,oa,$i.stretch,dr),es=Nc(ro.stretch-Sn,In,pt,E.top),Ns=Uc(ro.fixed-na,Ra,ro.stretch,Fr),Us=new c(wo,qo),Xo=new c(Ls,qo),Hs=new c(Ls,es),El=new c(wo,es),Qu=new c(Co/we,Ho/we),ff=new c(Ps/we,Ns/we),cf=C*Math.PI/180;if(cf){var hf=Math.sin(cf),Jf=Math.cos(cf),ru=[Jf,-hf,hf,Jf];Us._matMult(ru),Xo._matMult(ru),El._matMult(ru),Hs._matMult(ru)}var Xc=Ci.stretch+Ci.fixed,Mh=$i.stretch+$i.fixed,Zc=Ti.stretch+Ti.fixed,Sh=ro.stretch+ro.fixed,Vl={x:me.paddedRect.x+Vf+Xc,y:me.paddedRect.y+Vf+Zc,w:Mh-Xc,h:Sh-Zc},Qf=oa/we/ft,jc=Ra/we/pt;return{tl:Us,tr:Xo,bl:El,br:Hs,tex:Vl,writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Qu,pixelOffsetBR:ff,minFontScaleX:Qf,minFontScaleY:jc,isSDF:O}};if(!Q||!me.stretchX&&!me.stretchY)he.push(Ma({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:Re+1},{fixed:0,stretch:$e+1}));else for(var ti=mv(It,an,dr),Ca=mv(tr,$r,Fr),Da=0;Da<ti.length-1;Da++)for(var fi=ti[Da],qa=ti[Da+1],ki=0;ki<Ca.length-1;ki++){var Wi=Ca[ki],Ei=Ca[ki+1];he.push(Ma(fi,Wi,qa,Ei))}return he}function Bc(E,C,O){for(var Q=0,he=0,me=E;he<me.length;he+=1){var we=me[he];Q+=Math.max(C,Math.min(O,we[1]))-Math.max(C,Math.min(O,we[0]))}return Q}function mv(E,C,O){for(var Q=[{fixed:-Vf,stretch:0}],he=0,me=E;he<me.length;he+=1){var we=me[he],Re=we[0],$e=we[1],ft=Q[Q.length-1];Q.push({fixed:Re-ft.stretch,stretch:ft.stretch}),Q.push({fixed:Re-ft.stretch,stretch:ft.stretch+($e-Re)})}return Q.push({fixed:C+Vf,stretch:O}),Q}function Nc(E,C,O,Q){return E/C*O+Q}function Uc(E,C,O,Q){return E-C*O/Q}function qd(E,C,O,Q,he,me,we,Re){for(var $e=Q.layout.get("text-rotate").evaluate(me,{})*Math.PI/180,ft=[],pt=0,It=C.positionedLines;pt<It.length;pt+=1)for(var tr=It[pt],Qt=0,dr=tr.positionedGlyphs;Qt<dr.length;Qt+=1){var Fr=dr[Qt];if(!!Fr.rect){var an=Fr.rect||{},$r=1,kn=ev+$r,mn=!0,Sn=1,In=0,Gn=(he||Re)&&Fr.vertical,oa=Fr.metrics.advance*Fr.scale/2;if(Re&&C.verticalizable){var na=(Fr.scale-1)*hs,Ra=(hs-Fr.metrics.width*Fr.scale)/2;In=tr.lineOffset/2-(Fr.imageName?-Ra:na)}if(Fr.imageName){var wa=we[Fr.imageName];mn=wa.sdf,Sn=wa.pixelRatio,kn=cl/Sn}var Ma=he?[Fr.x+oa,Fr.y]:[0,0],ti=he?[0,0]:[Fr.x+oa+O[0],Fr.y+O[1]-In],Ca=[0,0];Gn&&(Ca=ti,ti=[0,0]);var Da=(Fr.metrics.left-kn)*Fr.scale-oa+ti[0],fi=(-Fr.metrics.top-kn)*Fr.scale+ti[1],qa=Da+an.w*Fr.scale/Sn,ki=fi+an.h*Fr.scale/Sn,Wi=new c(Da,fi),Ei=new c(qa,fi),Ci=new c(Da,ki),Ti=new c(qa,ki);if(Gn){var $i=new c(-oa,oa-dc),ro=-Math.PI/2,wo=hs/2-oa,Co=Fr.imageName?wo:0,qo=new c(5-dc-wo,-Co),Ho=new(Function.prototype.bind.apply(c,[null].concat(Ca)));Wi._rotateAround(ro,$i)._add(qo)._add(Ho),Ei._rotateAround(ro,$i)._add(qo)._add(Ho),Ci._rotateAround(ro,$i)._add(qo)._add(Ho),Ti._rotateAround(ro,$i)._add(qo)._add(Ho)}if($e){var Ls=Math.sin($e),Ps=Math.cos($e),es=[Ps,-Ls,Ls,Ps];Wi._matMult(es),Ei._matMult(es),Ci._matMult(es),Ti._matMult(es)}var Ns=new c(0,0),Us=new c(0,0),Xo=0,Hs=0;ft.push({tl:Wi,tr:Ei,bl:Ci,br:Ti,tex:an,writingMode:C.writingMode,glyphOffset:Ma,sectionIndex:Fr.sectionIndex,isSDF:mn,pixelOffsetTL:Ns,pixelOffsetBR:Us,minFontScaleX:Xo,minFontScaleY:Hs})}}return ft}var Hc=function(C,O,Q,he,me,we,Re,$e,ft,pt){if(this.boxStartIndex=C.length,ft){var It=we.top,tr=we.bottom,Qt=we.collisionPadding;Qt&&(It-=Qt[1],tr+=Qt[3]);var dr=tr-It;dr>0&&(dr=Math.max(10,dr),this.circleDiameter=dr)}else{var Fr=we.top*Re-$e,an=we.bottom*Re+$e,$r=we.left*Re-$e,kn=we.right*Re+$e,mn=we.collisionPadding;if(mn&&($r-=mn[0]*Re,Fr-=mn[1]*Re,kn+=mn[2]*Re,an+=mn[3]*Re),pt){var Sn=new c($r,Fr),In=new c(kn,Fr),Gn=new c($r,an),oa=new c(kn,an),na=pt*Math.PI/180;Sn._rotate(na),In._rotate(na),Gn._rotate(na),oa._rotate(na),$r=Math.min(Sn.x,In.x,Gn.x,oa.x),kn=Math.max(Sn.x,In.x,Gn.x,oa.x),Fr=Math.min(Sn.y,In.y,Gn.y,oa.y),an=Math.max(Sn.y,In.y,Gn.y,oa.y)}C.emplaceBack(O.x,O.y,$r,Fr,kn,an,Q,he,me)}this.boxEndIndex=C.length},Gf=function(C,O){if(C===void 0&&(C=[]),O===void 0&&(O=e0),this.data=C,this.length=this.data.length,this.compare=O,this.length>0)for(var Q=(this.length>>1)-1;Q>=0;Q--)this._down(Q)};Gf.prototype.push=function(C){this.data.push(C),this.length++,this._up(this.length-1)},Gf.prototype.pop=function(){if(this.length!==0){var C=this.data[0],O=this.data.pop();return this.length--,this.length>0&&(this.data[0]=O,this._down(0)),C}},Gf.prototype.peek=function(){return this.data[0]},Gf.prototype._up=function(C){for(var O=this,Q=O.data,he=O.compare,me=Q[C];C>0;){var we=C-1>>1,Re=Q[we];if(he(me,Re)>=0)break;Q[C]=Re,C=we}Q[C]=me},Gf.prototype._down=function(C){for(var O=this,Q=O.data,he=O.compare,me=this.length>>1,we=Q[C];C<me;){var Re=(C<<1)+1,$e=Q[Re],ft=Re+1;if(ft<this.length&&he(Q[ft],$e)<0&&(Re=ft,$e=Q[ft]),he($e,we)>=0)break;Q[C]=$e,C=Re}Q[C]=we};function e0(E,C){return E<C?-1:E>C?1:0}function t0(E,C,O){C===void 0&&(C=1),O===void 0&&(O=!1);for(var Q=1/0,he=1/0,me=-1/0,we=-1/0,Re=E[0],$e=0;$e<Re.length;$e++){var ft=Re[$e];(!$e||ft.x<Q)&&(Q=ft.x),(!$e||ft.y<he)&&(he=ft.y),(!$e||ft.x>me)&&(me=ft.x),(!$e||ft.y>we)&&(we=ft.y)}var pt=me-Q,It=we-he,tr=Math.min(pt,It),Qt=tr/2,dr=new Gf([],r0);if(tr===0)return new c(Q,he);for(var Fr=Q;Fr<me;Fr+=tr)for(var an=he;an<we;an+=tr)dr.push(new Yf(Fr+Qt,an+Qt,Qt,E));for(var $r=a0(E),kn=dr.length;dr.length;){var mn=dr.pop();(mn.d>$r.d||!$r.d)&&($r=mn,O&&console.log("found best %d after %d probes",Math.round(1e4*mn.d)/1e4,kn)),!(mn.max-$r.d<=C)&&(Qt=mn.h/2,dr.push(new Yf(mn.p.x-Qt,mn.p.y-Qt,Qt,E)),dr.push(new Yf(mn.p.x+Qt,mn.p.y-Qt,Qt,E)),dr.push(new Yf(mn.p.x-Qt,mn.p.y+Qt,Qt,E)),dr.push(new Yf(mn.p.x+Qt,mn.p.y+Qt,Qt,E)),kn+=4)}return O&&(console.log("num probes: "+kn),console.log("best distance: "+$r.d)),$r.p}function r0(E,C){return C.max-E.max}function Yf(E,C,O,Q){this.p=new c(E,C),this.h=O,this.d=n0(this.p,Q),this.max=this.d+this.h*Math.SQRT2}function n0(E,C){for(var O=!1,Q=1/0,he=0;he<C.length;he++)for(var me=C[he],we=0,Re=me.length,$e=Re-1;we<Re;$e=we++){var ft=me[we],pt=me[$e];ft.y>E.y!=pt.y>E.y&&E.x<(pt.x-ft.x)*(E.y-ft.y)/(pt.y-ft.y)+ft.x&&(O=!O),Q=Math.min(Q,bu(E,ft,pt))}return(O?1:-1)*Math.sqrt(Q)}function a0(E){for(var C=0,O=0,Q=0,he=E[0],me=0,we=he.length,Re=we-1;me<we;Re=me++){var $e=he[me],ft=he[Re],pt=$e.x*ft.y-ft.x*$e.y;O+=($e.x+ft.x)*pt,Q+=($e.y+ft.y)*pt,C+=pt*3}return new Yf(O/C,Q/C,0,E)}var Wf=7,mh=Number.POSITIVE_INFINITY;function xv(E,C){function O(he,me){var we=0,Re=0;me<0&&(me=0);var $e=me/Math.sqrt(2);switch(he){case"top-right":case"top-left":Re=$e-Wf;break;case"bottom-right":case"bottom-left":Re=-$e+Wf;break;case"bottom":Re=-me+Wf;break;case"top":Re=me-Wf;break}switch(he){case"top-right":case"bottom-right":we=-$e;break;case"top-left":case"bottom-left":we=$e;break;case"left":we=me;break;case"right":we=-me;break}return[we,Re]}function Q(he,me,we){var Re=0,$e=0;switch(me=Math.abs(me),we=Math.abs(we),he){case"top-right":case"top-left":case"top":$e=we-Wf;break;case"bottom-right":case"bottom-left":case"bottom":$e=-we+Wf;break}switch(he){case"top-right":case"bottom-right":case"right":Re=-me;break;case"top-left":case"bottom-left":case"left":Re=me;break}return[Re,$e]}return C[1]!==mh?Q(E,C[0],C[1]):O(E,C[0])}function i0(E,C,O,Q,he,me,we){E.createArrays();var Re=512*E.overscaling;E.tilePixelRatio=Ba/Re,E.compareText={},E.iconsNeedLinear=!1;var $e=E.layers[0].layout,ft=E.layers[0]._unevaluatedLayout._values,pt={};if(E.textSizeData.kind==="composite"){var It=E.textSizeData,tr=It.minZoom,Qt=It.maxZoom;pt.compositeTextSizes=[ft["text-size"].possiblyEvaluate(new si(tr),we),ft["text-size"].possiblyEvaluate(new si(Qt),we)]}if(E.iconSizeData.kind==="composite"){var dr=E.iconSizeData,Fr=dr.minZoom,an=dr.maxZoom;pt.compositeIconSizes=[ft["icon-size"].possiblyEvaluate(new si(Fr),we),ft["icon-size"].possiblyEvaluate(new si(an),we)]}pt.layoutTextSize=ft["text-size"].possiblyEvaluate(new si(E.zoom+1),we),pt.layoutIconSize=ft["icon-size"].possiblyEvaluate(new si(E.zoom+1),we),pt.textMaxSize=ft["text-size"].possiblyEvaluate(new si(18));for(var $r=$e.get("text-line-height")*hs,kn=$e.get("text-rotation-alignment")==="map"&&$e.get("symbol-placement")!=="point",mn=$e.get("text-keep-upright"),Sn=$e.get("text-size"),In=function(){var na=oa[Gn],Ra=$e.get("text-font").evaluate(na,{},we).join(","),wa=Sn.evaluate(na,{},we),Ma=pt.layoutTextSize.evaluate(na,{},we),ti=pt.layoutIconSize.evaluate(na,{},we),Ca={horizontal:{},vertical:void 0},Da=na.text,fi=[0,0];if(Da){var qa=Da.toString(),ki=$e.get("text-letter-spacing").evaluate(na,{},we)*hs,Wi=Jr(qa)?ki:0,Ei=$e.get("text-anchor").evaluate(na,{},we),Ci=$e.get("text-variable-anchor");if(!Ci){var Ti=$e.get("text-radial-offset").evaluate(na,{},we);Ti?fi=xv(Ei,[Ti*hs,mh]):fi=$e.get("text-offset").evaluate(na,{},we).map(function(Qu){return Qu*hs})}var $i=kn?"center":$e.get("text-justify").evaluate(na,{},we),ro=$e.get("symbol-placement"),wo=ro==="point"?$e.get("text-max-width").evaluate(na,{},we)*hs:0,Co=function(){E.allowVerticalPlacement&&Ar(qa)&&(Ca.vertical=Oc(Da,C,O,he,Ra,wo,$r,Ei,"left",Wi,fi,kl.vertical,!0,ro,Ma,wa))};if(!kn&&Ci){for(var qo=$i==="auto"?Ci.map(function(Qu){return xh(Qu)}):[$i],Ho=!1,Ls=0;Ls<qo.length;Ls++){var Ps=qo[Ls];if(!Ca.horizontal[Ps])if(Ho)Ca.horizontal[Ps]=Ca.horizontal[0];else{var es=Oc(Da,C,O,he,Ra,wo,$r,"center",Ps,Wi,fi,kl.horizontal,!1,ro,Ma,wa);es&&(Ca.horizontal[Ps]=es,Ho=es.positionedLines.length===1)}}Co()}else{$i==="auto"&&($i=xh(Ei));var Ns=Oc(Da,C,O,he,Ra,wo,$r,Ei,$i,Wi,fi,kl.horizontal,!1,ro,Ma,wa);Ns&&(Ca.horizontal[$i]=Ns),Co(),Ar(qa)&&kn&&mn&&(Ca.vertical=Oc(Da,C,O,he,Ra,wo,$r,Ei,$i,Wi,fi,kl.vertical,!1,ro,Ma,wa))}}var Us=void 0,Xo=!1;if(na.icon&&na.icon.name){var Hs=Q[na.icon.name];Hs&&(Us=Kd(he[na.icon.name],$e.get("icon-offset").evaluate(na,{},we),$e.get("icon-anchor").evaluate(na,{},we)),Xo=Hs.sdf,E.sdfIcons===void 0?E.sdfIcons=Hs.sdf:E.sdfIcons!==Hs.sdf&&B("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Hs.pixelRatio!==E.pixelRatio||$e.get("icon-rotate").constantOr(1)!==0)&&(E.iconsNeedLinear=!0))}var El=_v(Ca.horizontal)||Ca.vertical;E.iconsInText=El?El.iconsInText:!1,(El||Us)&&o0(E,na,Ca,Us,Q,pt,Ma,ti,fi,Xo,we)},Gn=0,oa=E.features;Gn<oa.length;Gn+=1)In();me&&E.generateCollisionDebugBuffers()}function xh(E){switch(E){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function o0(E,C,O,Q,he,me,we,Re,$e,ft,pt){var It=me.textMaxSize.evaluate(C,{});It===void 0&&(It=we);var tr=E.layers[0].layout,Qt=tr.get("icon-offset").evaluate(C,{},pt),dr=_v(O.horizontal),Fr=24,an=we/Fr,$r=E.tilePixelRatio*an,kn=E.tilePixelRatio*It/Fr,mn=E.tilePixelRatio*Re,Sn=E.tilePixelRatio*tr.get("symbol-spacing"),In=tr.get("text-padding")*E.tilePixelRatio,Gn=tr.get("icon-padding")*E.tilePixelRatio,oa=tr.get("text-max-angle")/180*Math.PI,na=tr.get("text-rotation-alignment")==="map"&&tr.get("symbol-placement")!=="point",Ra=tr.get("icon-rotation-alignment")==="map"&&tr.get("symbol-placement")!=="point",wa=tr.get("symbol-placement"),Ma=Sn/2,ti=tr.get("icon-text-fit"),Ca;Q&&ti!=="none"&&(E.allowVerticalPlacement&&O.vertical&&(Ca=lv(Q,O.vertical,ti,tr.get("icon-text-fit-padding"),Qt,an)),dr&&(Q=lv(Q,dr,ti,tr.get("icon-text-fit-padding"),Qt,an)));var Da=function(Jf,ru){ru.x<0||ru.x>=Ba||ru.y<0||ru.y>=Ba||s0(E,ru,Jf,O,Q,he,Ca,E.layers[0],E.collisionBoxArray,C.index,C.sourceLayerIndex,E.index,$r,In,na,$e,mn,Gn,Ra,Qt,C,me,ft,pt,we)};if(wa==="line")for(var fi=0,qa=gv(C.geometry,0,0,Ba,Ba);fi<qa.length;fi+=1)for(var ki=qa[fi],Wi=$d(ki,Sn,oa,O.vertical||dr,Q,Fr,kn,E.overscaling,Ba),Ei=0,Ci=Wi;Ei<Ci.length;Ei+=1){var Ti=Ci[Ei],$i=dr;(!$i||!l0(E,$i.text,Ma,Ti))&&Da(ki,Ti)}else if(wa==="line-center")for(var ro=0,wo=C.geometry;ro<wo.length;ro+=1){var Co=wo[ro];if(Co.length>1){var qo=Qd(Co,oa,O.vertical||dr,Q,Fr,kn);qo&&Da(Co,qo)}}else if(C.type==="Polygon")for(var Ho=0,Ls=lh(C.geometry,0);Ho<Ls.length;Ho+=1){var Ps=Ls[Ho],es=t0(Ps,16);Da(Ps[0],new Hf(es.x,es.y,0))}else if(C.type==="LineString")for(var Ns=0,Us=C.geometry;Ns<Us.length;Ns+=1){var Xo=Us[Ns];Da(Xo,new Hf(Xo[0].x,Xo[0].y,0))}else if(C.type==="Point")for(var Hs=0,El=C.geometry;Hs<El.length;Hs+=1)for(var Qu=El[Hs],ff=0,cf=Qu;ff<cf.length;ff+=1){var hf=cf[ff];Da([hf],new Hf(hf.x,hf.y,0))}}var gc=255,lf=gc*Tu;function bv(E,C,O,Q,he,me,we,Re,$e,ft,pt,It,tr,Qt,dr){var Fr=qd(C,O,Re,he,me,we,Q,E.allowVerticalPlacement),an=E.textSizeData,$r=null;an.kind==="source"?($r=[Tu*he.layout.get("text-size").evaluate(we,{})],$r[0]>lf&&B(E.layerIds[0]+': Value for "text-size" is >= '+gc+'. Reduce your "text-size".')):an.kind==="composite"&&($r=[Tu*Qt.compositeTextSizes[0].evaluate(we,{},dr),Tu*Qt.compositeTextSizes[1].evaluate(we,{},dr)],($r[0]>lf||$r[1]>lf)&&B(E.layerIds[0]+': Value for "text-size" is >= '+gc+'. Reduce your "text-size".')),E.addSymbols(E.text,Fr,$r,Re,me,we,ft,C,$e.lineStartIndex,$e.lineLength,tr,dr);for(var kn=0,mn=pt;kn<mn.length;kn+=1){var Sn=mn[kn];It[Sn]=E.text.placedSymbolArray.length-1}return Fr.length*4}function _v(E){for(var C in E)return E[C];return null}function s0(E,C,O,Q,he,me,we,Re,$e,ft,pt,It,tr,Qt,dr,Fr,an,$r,kn,mn,Sn,In,Gn,oa,na){var Ra,wa=E.addToLineVertexArray(C,O),Ma,ti,Ca,Da,fi=0,qa=0,ki=0,Wi=0,Ei=-1,Ci=-1,Ti={},$i=Ce(""),ro=0,wo=0;if(Re._unevaluatedLayout.getValue("text-radial-offset")===void 0?(Ra=Re.layout.get("text-offset").evaluate(Sn,{},oa).map(function(xc){return xc*hs}),ro=Ra[0],wo=Ra[1]):(ro=Re.layout.get("text-radial-offset").evaluate(Sn,{},oa)*hs,wo=mh),E.allowVerticalPlacement&&Q.vertical){var Co=Re.layout.get("text-rotate").evaluate(Sn,{},oa),qo=Co+90,Ho=Q.vertical;Ca=new Hc($e,C,ft,pt,It,Ho,tr,Qt,dr,qo),we&&(Da=new Hc($e,C,ft,pt,It,we,an,$r,dr,qo))}if(he){var Ls=Re.layout.get("icon-rotate").evaluate(Sn,{}),Ps=Re.layout.get("icon-text-fit")!=="none",es=yv(he,Ls,Gn,Ps),Ns=we?yv(we,Ls,Gn,Ps):void 0;ti=new Hc($e,C,ft,pt,It,he,an,$r,!1,Ls),fi=es.length*4;var Us=E.iconSizeData,Xo=null;Us.kind==="source"?(Xo=[Tu*Re.layout.get("icon-size").evaluate(Sn,{})],Xo[0]>lf&&B(E.layerIds[0]+': Value for "icon-size" is >= '+gc+'. Reduce your "icon-size".')):Us.kind==="composite"&&(Xo=[Tu*In.compositeIconSizes[0].evaluate(Sn,{},oa),Tu*In.compositeIconSizes[1].evaluate(Sn,{},oa)],(Xo[0]>lf||Xo[1]>lf)&&B(E.layerIds[0]+': Value for "icon-size" is >= '+gc+'. Reduce your "icon-size".')),E.addSymbols(E.icon,es,Xo,mn,kn,Sn,!1,C,wa.lineStartIndex,wa.lineLength,-1,oa),Ei=E.icon.placedSymbolArray.length-1,Ns&&(qa=Ns.length*4,E.addSymbols(E.icon,Ns,Xo,mn,kn,Sn,kl.vertical,C,wa.lineStartIndex,wa.lineLength,-1,oa),Ci=E.icon.placedSymbolArray.length-1)}for(var Hs in Q.horizontal){var El=Q.horizontal[Hs];if(!Ma){$i=Ce(El.text);var Qu=Re.layout.get("text-rotate").evaluate(Sn,{},oa);Ma=new Hc($e,C,ft,pt,It,El,tr,Qt,dr,Qu)}var ff=El.positionedLines.length===1;if(ki+=bv(E,C,El,me,Re,dr,Sn,Fr,wa,Q.vertical?kl.horizontal:kl.horizontalOnly,ff?Object.keys(Q.horizontal):[Hs],Ti,Ei,In,oa),ff)break}Q.vertical&&(Wi+=bv(E,C,Q.vertical,me,Re,dr,Sn,Fr,wa,kl.vertical,["vertical"],Ti,Ci,In,oa));var cf=Ma?Ma.boxStartIndex:E.collisionBoxArray.length,hf=Ma?Ma.boxEndIndex:E.collisionBoxArray.length,Jf=Ca?Ca.boxStartIndex:E.collisionBoxArray.length,ru=Ca?Ca.boxEndIndex:E.collisionBoxArray.length,Xc=ti?ti.boxStartIndex:E.collisionBoxArray.length,Mh=ti?ti.boxEndIndex:E.collisionBoxArray.length,Zc=Da?Da.boxStartIndex:E.collisionBoxArray.length,Sh=Da?Da.boxEndIndex:E.collisionBoxArray.length,Vl=-1,Qf=function(xc,Ov){return xc&&xc.circleDiameter?Math.max(xc.circleDiameter,Ov):Ov};Vl=Qf(Ma,Vl),Vl=Qf(Ca,Vl),Vl=Qf(ti,Vl),Vl=Qf(Da,Vl);var jc=Vl>-1?1:0;jc&&(Vl*=na/hs),E.glyphOffsetArray.length>=Yi.MAX_GLYPHS&&B("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Sn.sortKey!==void 0&&E.addToSortKeyRanges(E.symbolInstances.length,Sn.sortKey),E.symbolInstances.emplaceBack(C.x,C.y,Ti.right>=0?Ti.right:-1,Ti.center>=0?Ti.center:-1,Ti.left>=0?Ti.left:-1,Ti.vertical||-1,Ei,Ci,$i,cf,hf,Jf,ru,Xc,Mh,Zc,Sh,ft,ki,Wi,fi,qa,jc,0,tr,ro,wo,Vl)}function l0(E,C,O,Q){var he=E.compareText;if(!(C in he))he[C]=[];else for(var me=he[C],we=me.length-1;we>=0;we--)if(Q.dist(me[we])<O)return!0;return he[C].push(Q),!1}var u0=Of.VectorTileFeature.types,f0=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Vc(E,C,O,Q,he,me,we,Re,$e,ft,pt,It,tr){var Qt=Re?Math.min(lf,Math.round(Re[0])):0,dr=Re?Math.min(lf,Math.round(Re[1])):0;E.emplaceBack(C,O,Math.round(Q*32),Math.round(he*32),me,we,(Qt<<1)+($e?1:0),dr,ft*16,pt*16,It*256,tr*256)}function bh(E,C,O){E.emplaceBack(C.x,C.y,O),E.emplaceBack(C.x,C.y,O),E.emplaceBack(C.x,C.y,O),E.emplaceBack(C.x,C.y,O)}function c0(E){for(var C=0,O=E.sections;C<O.length;C+=1){var Q=O[C];if(ra(Q.text))return!0}return!1}var Xf=function(C){this.layoutVertexArray=new Bu,this.indexArray=new xu,this.programConfigurations=C,this.segments=new V,this.dynamicLayoutVertexArray=new $f,this.opacityVertexArray=new qf,this.placedSymbolArray=new nf};Xf.prototype.isEmpty=function(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0},Xf.prototype.upload=function(C,O,Q,he){this.isEmpty()||(Q&&(this.layoutVertexBuffer=C.createVertexBuffer(this.layoutVertexArray,hh.members),this.indexBuffer=C.createIndexBuffer(this.indexArray,O),this.dynamicLayoutVertexBuffer=C.createVertexBuffer(this.dynamicLayoutVertexArray,hd.members,!0),this.opacityVertexBuffer=C.createVertexBuffer(this.opacityVertexArray,f0,!0),this.opacityVertexBuffer.itemSize=1),(Q||he)&&this.programConfigurations.upload(C))},Xf.prototype.destroy=function(){!this.layoutVertexBuffer||(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},Ie("SymbolBuffers",Xf);var yc=function(C,O,Q){this.layoutVertexArray=new C,this.layoutAttributes=O,this.indexArray=new Q,this.segments=new V,this.collisionVertexArray=new Qs};yc.prototype.upload=function(C){this.layoutVertexBuffer=C.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=C.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=C.createVertexBuffer(this.collisionVertexArray,vd.members,!0)},yc.prototype.destroy=function(){!this.layoutVertexBuffer||(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},Ie("CollisionBuffers",yc);var Yi=function(C){this.collisionBoxArray=C.collisionBoxArray,this.zoom=C.zoom,this.overscaling=C.overscaling,this.layers=C.layers,this.layerIds=this.layers.map(function($e){return $e.id}),this.index=C.index,this.pixelRatio=C.pixelRatio,this.sourceLayerIndex=C.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Df([]),this.placementViewportMatrix=Df([]);var O=this.layers[0],Q=O._unevaluatedLayout._values;this.textSizeData=yh(this.zoom,Q["text-size"]),this.iconSizeData=yh(this.zoom,Q["icon-size"]);var he=this.layers[0].layout,me=he.get("symbol-sort-key"),we=he.get("symbol-z-order");this.sortFeaturesByKey=we!=="viewport-y"&&me.constantOr(1)!==void 0;var Re=we==="viewport-y"||we==="auto"&&!this.sortFeaturesByKey;this.sortFeaturesByY=Re&&(he.get("text-allow-overlap")||he.get("icon-allow-overlap")||he.get("text-ignore-placement")||he.get("icon-ignore-placement")),he.get("symbol-placement")==="point"&&(this.writingModes=he.get("text-writing-mode").map(function($e){return kl[$e]})),this.stateDependentLayerIds=this.layers.filter(function($e){return $e.isStateDependent()}).map(function($e){return $e.id}),this.sourceID=C.sourceID};Yi.prototype.createArrays=function(){this.text=new Xf(new ni(hh.members,this.layers,this.zoom,function(C){return/^text/.test(C)})),this.icon=new Xf(new ni(hh.members,this.layers,this.zoom,function(C){return/^icon/.test(C)})),this.glyphOffsetArray=new Ul,this.lineVertexArray=new Ac,this.symbolInstances=new Tc},Yi.prototype.calculateGlyphDependencies=function(C,O,Q,he,me){for(var we=0;we<C.length;we++)if(O[C.charCodeAt(we)]=!0,(Q||he)&&me){var Re=hc[C.charAt(we)];Re&&(O[Re.charCodeAt(0)]=!0)}},Yi.prototype.populate=function(C,O,Q){var he=this.layers[0],me=he.layout,we=me.get("text-font"),Re=me.get("text-field"),$e=me.get("icon-image"),ft=(Re.value.kind!=="constant"||Re.value.value instanceof Ui&&!Re.value.value.isEmpty()||Re.value.value.toString().length>0)&&(we.value.kind!=="constant"||we.value.value.length>0),pt=$e.value.kind!=="constant"||!!$e.value.value||Object.keys($e.parameters).length>0,It=me.get("symbol-sort-key");if(this.features=[],!(!ft&&!pt)){for(var tr=O.iconDependencies,Qt=O.glyphDependencies,dr=O.availableImages,Fr=new si(this.zoom),an=0,$r=C;an<$r.length;an+=1){var kn=$r[an],mn=kn.feature,Sn=kn.id,In=kn.index,Gn=kn.sourceLayerIndex,oa=he._featureFilter.needGeometry,na={type:mn.type,id:Sn,properties:mn.properties,geometry:oa?Ni(mn):[]};if(!!he._featureFilter.filter(Fr,na,Q)){oa||(na.geometry=Ni(mn));var Ra=void 0;if(ft){var wa=he.getValueAndResolveTokens("text-field",na,Q,dr),Ma=Ui.factory(wa);c0(Ma)&&(this.hasRTLText=!0),(!this.hasRTLText||fo()==="unavailable"||this.hasRTLText&&Xa.isParsed())&&(Ra=gd(Ma,he,na))}var ti=void 0;if(pt){var Ca=he.getValueAndResolveTokens("icon-image",na,Q,dr);Ca instanceof Ao?ti=Ca:ti=Ao.fromString(Ca)}if(!(!Ra&&!ti)){var Da=this.sortFeaturesByKey?It.evaluate(na,{},Q):void 0,fi={id:Sn,text:Ra,icon:ti,index:In,sourceLayerIndex:Gn,geometry:Ni(mn),properties:mn.properties,type:u0[mn.type],sortKey:Da};if(this.features.push(fi),ti&&(tr[ti.name]=!0),Ra){var qa=we.evaluate(na,{},Q).join(","),ki=me.get("text-rotation-alignment")==="map"&&me.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(kl.vertical)>=0;for(var Wi=0,Ei=Ra.sections;Wi<Ei.length;Wi+=1){var Ci=Ei[Wi];if(Ci.image)tr[Ci.image.name]=!0;else{var Ti=Ar(Ra.toString()),$i=Ci.fontStack||qa,ro=Qt[$i]=Qt[$i]||{};this.calculateGlyphDependencies(Ci.text,ro,ki,this.allowVerticalPlacement,Ti)}}}}}}me.get("symbol-placement")==="line"&&(this.features=yd(this.features)),this.sortFeaturesByKey&&this.features.sort(function(wo,Co){return wo.sortKey-Co.sortKey})}},Yi.prototype.update=function(C,O,Q){!this.stateDependentLayers.length||(this.text.programConfigurations.updatePaintArrays(C,O,this.layers,Q),this.icon.programConfigurations.updatePaintArrays(C,O,this.layers,Q))},Yi.prototype.isEmpty=function(){return this.symbolInstances.length===0&&!this.hasRTLText},Yi.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},Yi.prototype.upload=function(C){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(C),this.iconCollisionBox.upload(C)),this.text.upload(C,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(C,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},Yi.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},Yi.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},Yi.prototype.addToLineVertexArray=function(C,O){var Q=this.lineVertexArray.length;if(C.segment!==void 0){for(var he=C.dist(O[C.segment+1]),me=C.dist(O[C.segment]),we={},Re=C.segment+1;Re<O.length;Re++)we[Re]={x:O[Re].x,y:O[Re].y,tileUnitDistanceFromAnchor:he},Re<O.length-1&&(he+=O[Re+1].dist(O[Re]));for(var $e=C.segment||0;$e>=0;$e--)we[$e]={x:O[$e].x,y:O[$e].y,tileUnitDistanceFromAnchor:me},$e>0&&(me+=O[$e-1].dist(O[$e]));for(var ft=0;ft<O.length;ft++){var pt=we[ft];this.lineVertexArray.emplaceBack(pt.x,pt.y,pt.tileUnitDistanceFromAnchor)}}return{lineStartIndex:Q,lineLength:this.lineVertexArray.length-Q}},Yi.prototype.addSymbols=function(C,O,Q,he,me,we,Re,$e,ft,pt,It,tr){for(var Qt=C.indexArray,dr=C.layoutVertexArray,Fr=C.segments.prepareSegment(4*O.length,dr,Qt,we.sortKey),an=this.glyphOffsetArray.length,$r=Fr.vertexLength,kn=this.allowVerticalPlacement&&Re===kl.vertical?Math.PI/2:0,mn=we.text&&we.text.sections,Sn=0;Sn<O.length;Sn++){var In=O[Sn],Gn=In.tl,oa=In.tr,na=In.bl,Ra=In.br,wa=In.tex,Ma=In.pixelOffsetTL,ti=In.pixelOffsetBR,Ca=In.minFontScaleX,Da=In.minFontScaleY,fi=In.glyphOffset,qa=In.isSDF,ki=In.sectionIndex,Wi=Fr.vertexLength,Ei=fi[1];Vc(dr,$e.x,$e.y,Gn.x,Ei+Gn.y,wa.x,wa.y,Q,qa,Ma.x,Ma.y,Ca,Da),Vc(dr,$e.x,$e.y,oa.x,Ei+oa.y,wa.x+wa.w,wa.y,Q,qa,ti.x,Ma.y,Ca,Da),Vc(dr,$e.x,$e.y,na.x,Ei+na.y,wa.x,wa.y+wa.h,Q,qa,Ma.x,ti.y,Ca,Da),Vc(dr,$e.x,$e.y,Ra.x,Ei+Ra.y,wa.x+wa.w,wa.y+wa.h,Q,qa,ti.x,ti.y,Ca,Da),bh(C.dynamicLayoutVertexArray,$e,kn),Qt.emplaceBack(Wi,Wi+1,Wi+2),Qt.emplaceBack(Wi+1,Wi+2,Wi+3),Fr.vertexLength+=4,Fr.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(fi[0]),(Sn===O.length-1||ki!==O[Sn+1].sectionIndex)&&C.programConfigurations.populatePaintArrays(dr.length,we,we.index,{},tr,mn&&mn[ki])}C.placedSymbolArray.emplaceBack($e.x,$e.y,an,this.glyphOffsetArray.length-an,$r,ft,pt,$e.segment,Q?Q[0]:0,Q?Q[1]:0,he[0],he[1],Re,0,!1,0,It)},Yi.prototype._addCollisionDebugVertex=function(C,O,Q,he,me,we){return O.emplaceBack(0,0),C.emplaceBack(Q.x,Q.y,he,me,Math.round(we.x),Math.round(we.y))},Yi.prototype.addCollisionDebugVertices=function(C,O,Q,he,me,we,Re){var $e=me.segments.prepareSegment(4,me.layoutVertexArray,me.indexArray),ft=$e.vertexLength,pt=me.layoutVertexArray,It=me.collisionVertexArray,tr=Re.anchorX,Qt=Re.anchorY;this._addCollisionDebugVertex(pt,It,we,tr,Qt,new c(C,O)),this._addCollisionDebugVertex(pt,It,we,tr,Qt,new c(Q,O)),this._addCollisionDebugVertex(pt,It,we,tr,Qt,new c(Q,he)),this._addCollisionDebugVertex(pt,It,we,tr,Qt,new c(C,he)),$e.vertexLength+=4;var dr=me.indexArray;dr.emplaceBack(ft,ft+1),dr.emplaceBack(ft+1,ft+2),dr.emplaceBack(ft+2,ft+3),dr.emplaceBack(ft+3,ft),$e.primitiveLength+=4},Yi.prototype.addDebugCollisionBoxes=function(C,O,Q,he){for(var me=C;me<O;me++){var we=this.collisionBoxArray.get(me),Re=we.x1,$e=we.y1,ft=we.x2,pt=we.y2;this.addCollisionDebugVertices(Re,$e,ft,pt,he?this.textCollisionBox:this.iconCollisionBox,we.anchorPoint,Q)}},Yi.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new yc(kf,Kh.members,yf),this.iconCollisionBox=new yc(kf,Kh.members,yf);for(var C=0;C<this.symbolInstances.length;C++){var O=this.symbolInstances.get(C);this.addDebugCollisionBoxes(O.textBoxStartIndex,O.textBoxEndIndex,O,!0),this.addDebugCollisionBoxes(O.verticalTextBoxStartIndex,O.verticalTextBoxEndIndex,O,!0),this.addDebugCollisionBoxes(O.iconBoxStartIndex,O.iconBoxEndIndex,O,!1),this.addDebugCollisionBoxes(O.verticalIconBoxStartIndex,O.verticalIconBoxEndIndex,O,!1)}},Yi.prototype._deserializeCollisionBoxesForSymbol=function(C,O,Q,he,me,we,Re,$e,ft){for(var pt={},It=O;It<Q;It++){var tr=C.get(It);pt.textBox={x1:tr.x1,y1:tr.y1,x2:tr.x2,y2:tr.y2,anchorPointX:tr.anchorPointX,anchorPointY:tr.anchorPointY},pt.textFeatureIndex=tr.featureIndex;break}for(var Qt=he;Qt<me;Qt++){var dr=C.get(Qt);pt.verticalTextBox={x1:dr.x1,y1:dr.y1,x2:dr.x2,y2:dr.y2,anchorPointX:dr.anchorPointX,anchorPointY:dr.anchorPointY},pt.verticalTextFeatureIndex=dr.featureIndex;break}for(var Fr=we;Fr<Re;Fr++){var an=C.get(Fr);pt.iconBox={x1:an.x1,y1:an.y1,x2:an.x2,y2:an.y2,anchorPointX:an.anchorPointX,anchorPointY:an.anchorPointY},pt.iconFeatureIndex=an.featureIndex;break}for(var $r=$e;$r<ft;$r++){var kn=C.get($r);pt.verticalIconBox={x1:kn.x1,y1:kn.y1,x2:kn.x2,y2:kn.y2,anchorPointX:kn.anchorPointX,anchorPointY:kn.anchorPointY},pt.verticalIconFeatureIndex=kn.featureIndex;break}return pt},Yi.prototype.deserializeCollisionBoxes=function(C){this.collisionArrays=[];for(var O=0;O<this.symbolInstances.length;O++){var Q=this.symbolInstances.get(O);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(C,Q.textBoxStartIndex,Q.textBoxEndIndex,Q.verticalTextBoxStartIndex,Q.verticalTextBoxEndIndex,Q.iconBoxStartIndex,Q.iconBoxEndIndex,Q.verticalIconBoxStartIndex,Q.verticalIconBoxEndIndex))}},Yi.prototype.hasTextData=function(){return this.text.segments.get().length>0},Yi.prototype.hasIconData=function(){return this.icon.segments.get().length>0},Yi.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},Yi.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},Yi.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},Yi.prototype.addIndicesForPlacedSymbol=function(C,O){for(var Q=C.placedSymbolArray.get(O),he=Q.vertexStartIndex+Q.numGlyphs*4,me=Q.vertexStartIndex;me<he;me+=4)C.indexArray.emplaceBack(me,me+1,me+2),C.indexArray.emplaceBack(me+1,me+2,me+3)},Yi.prototype.getSortedSymbolIndexes=function(C){if(this.sortedAngle===C&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;for(var O=Math.sin(C),Q=Math.cos(C),he=[],me=[],we=[],Re=0;Re<this.symbolInstances.length;++Re){we.push(Re);var $e=this.symbolInstances.get(Re);he.push(Math.round(O*$e.anchorX+Q*$e.anchorY)|0),me.push($e.featureIndex)}return we.sort(function(ft,pt){return he[ft]-he[pt]||me[pt]-me[ft]}),we},Yi.prototype.addToSortKeyRanges=function(C,O){var Q=this.sortKeyRanges[this.sortKeyRanges.length-1];Q&&Q.sortKey===O?Q.symbolInstanceEnd=C+1:this.sortKeyRanges.push({sortKey:O,symbolInstanceStart:C,symbolInstanceEnd:C+1})},Yi.prototype.sortFeatures=function(C){var O=this;if(!!this.sortFeaturesByY&&this.sortedAngle!==C&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(C),this.sortedAngle=C,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var Q=0,he=this.symbolInstanceIndexes;Q<he.length;Q+=1){var me=he[Q],we=this.symbolInstances.get(me);this.featureSortOrder.push(we.featureIndex),[we.rightJustifiedTextSymbolIndex,we.centerJustifiedTextSymbolIndex,we.leftJustifiedTextSymbolIndex].forEach(function(Re,$e,ft){Re>=0&&ft.indexOf(Re)===$e&&O.addIndicesForPlacedSymbol(O.text,Re)}),we.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,we.verticalPlacedTextSymbolIndex),we.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,we.placedIconSymbolIndex),we.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,we.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},Ie("SymbolBucket",Yi,{omit:["layers","collisionBoxArray","features","compareText"]}),Yi.MAX_GLYPHS=65535,Yi.addDynamicAttributes=bh;function h0(E,C){return C.replace(/{([^{}]+)}/g,function(O,Q){return Q in E?String(E[Q]):""})}var v0=new Xi({"symbol-placement":new Ia(Bt.layout_symbol["symbol-placement"]),"symbol-spacing":new Ia(Bt.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Ia(Bt.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Za(Bt.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Ia(Bt.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Ia(Bt.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Ia(Bt.layout_symbol["icon-ignore-placement"]),"icon-optional":new Ia(Bt.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Ia(Bt.layout_symbol["icon-rotation-alignment"]),"icon-size":new Za(Bt.layout_symbol["icon-size"]),"icon-text-fit":new Ia(Bt.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Ia(Bt.layout_symbol["icon-text-fit-padding"]),"icon-image":new Za(Bt.layout_symbol["icon-image"]),"icon-rotate":new Za(Bt.layout_symbol["icon-rotate"]),"icon-padding":new Ia(Bt.layout_symbol["icon-padding"]),"icon-keep-upright":new Ia(Bt.layout_symbol["icon-keep-upright"]),"icon-offset":new Za(Bt.layout_symbol["icon-offset"]),"icon-anchor":new Za(Bt.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Ia(Bt.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Ia(Bt.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Ia(Bt.layout_symbol["text-rotation-alignment"]),"text-field":new Za(Bt.layout_symbol["text-field"]),"text-font":new Za(Bt.layout_symbol["text-font"]),"text-size":new Za(Bt.layout_symbol["text-size"]),"text-max-width":new Za(Bt.layout_symbol["text-max-width"]),"text-line-height":new Ia(Bt.layout_symbol["text-line-height"]),"text-letter-spacing":new Za(Bt.layout_symbol["text-letter-spacing"]),"text-justify":new Za(Bt.layout_symbol["text-justify"]),"text-radial-offset":new Za(Bt.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Ia(Bt.layout_symbol["text-variable-anchor"]),"text-anchor":new Za(Bt.layout_symbol["text-anchor"]),"text-max-angle":new Ia(Bt.layout_symbol["text-max-angle"]),"text-writing-mode":new Ia(Bt.layout_symbol["text-writing-mode"]),"text-rotate":new Za(Bt.layout_symbol["text-rotate"]),"text-padding":new Ia(Bt.layout_symbol["text-padding"]),"text-keep-upright":new Ia(Bt.layout_symbol["text-keep-upright"]),"text-transform":new Za(Bt.layout_symbol["text-transform"]),"text-offset":new Za(Bt.layout_symbol["text-offset"]),"text-allow-overlap":new Ia(Bt.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Ia(Bt.layout_symbol["text-ignore-placement"]),"text-optional":new Ia(Bt.layout_symbol["text-optional"])}),p0=new Xi({"icon-opacity":new Za(Bt.paint_symbol["icon-opacity"]),"icon-color":new Za(Bt.paint_symbol["icon-color"]),"icon-halo-color":new Za(Bt.paint_symbol["icon-halo-color"]),"icon-halo-width":new Za(Bt.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Za(Bt.paint_symbol["icon-halo-blur"]),"icon-translate":new Ia(Bt.paint_symbol["icon-translate"]),"icon-translate-anchor":new Ia(Bt.paint_symbol["icon-translate-anchor"]),"text-opacity":new Za(Bt.paint_symbol["text-opacity"]),"text-color":new Za(Bt.paint_symbol["text-color"],{runtimeType:On,getOverride:function(E){return E.textColor},hasOverride:function(E){return!!E.textColor}}),"text-halo-color":new Za(Bt.paint_symbol["text-halo-color"]),"text-halo-width":new Za(Bt.paint_symbol["text-halo-width"]),"text-halo-blur":new Za(Bt.paint_symbol["text-halo-blur"]),"text-translate":new Ia(Bt.paint_symbol["text-translate"]),"text-translate-anchor":new Ia(Bt.paint_symbol["text-translate-anchor"])}),_h={paint:p0,layout:v0},Zf=function(C){this.type=C.property.overrides?C.property.overrides.runtimeType:gr,this.defaultValue=C};Zf.prototype.evaluate=function(C){if(C.formattedSection){var O=this.defaultValue.property.overrides;if(O&&O.hasOverride(C.formattedSection))return O.getOverride(C.formattedSection)}return C.feature&&C.featureState?this.defaultValue.evaluate(C.feature,C.featureState):this.defaultValue.property.specification.default},Zf.prototype.eachChild=function(C){if(!this.defaultValue.isConstant()){var O=this.defaultValue.value;C(O._styleExpression.expression)}},Zf.prototype.outputDefined=function(){return!1},Zf.prototype.serialize=function(){return null},Ie("FormatSectionOverride",Zf,{omit:["defaultValue"]});var d0=function(E){function C(O){E.call(this,O,_h)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.recalculate=function(Q,he){if(E.prototype.recalculate.call(this,Q,he),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout.get("symbol-placement")!=="point"?this.layout._values["icon-rotation-alignment"]="map":this.layout._values["icon-rotation-alignment"]="viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout.get("symbol-placement")!=="point"?this.layout._values["text-rotation-alignment"]="map":this.layout._values["text-rotation-alignment"]="viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){var me=this.layout.get("text-writing-mode");if(me){for(var we=[],Re=0,$e=me;Re<$e.length;Re+=1){var ft=$e[Re];we.indexOf(ft)<0&&we.push(ft)}this.layout._values["text-writing-mode"]=we}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},C.prototype.getValueAndResolveTokens=function(Q,he,me,we){var Re=this.layout.get(Q).evaluate(he,{},me,we),$e=this._unevaluatedLayout._values[Q];return!$e.isDataDriven()&&!mo($e.value)&&Re?h0(he.properties,Re):Re},C.prototype.createBucket=function(Q){return new Yi(Q)},C.prototype.queryRadius=function(){return 0},C.prototype.queryIntersectsFeature=function(){return!1},C.prototype._setPaintOverrides=function(){for(var Q=0,he=_h.paint.overridableProperties;Q<he.length;Q+=1){var me=he[Q];if(!!C.hasPaintOverride(this.layout,me)){var we=this.paint.get(me),Re=new Zf(we),$e=new ls(Re,we.property.specification),ft=null;we.value.kind==="constant"||we.value.kind==="source"?ft=new Jl("source",$e):ft=new us("composite",$e,we.value.zoomStops,we.value._interpolationType),this.paint._values[me]=new Gi(we.property,ft,we.parameters)}}},C.prototype._handleOverridablePaintPropertyUpdate=function(Q,he,me){return!this.layout||he.isDataDriven()||me.isDataDriven()?!1:C.hasPaintOverride(this.layout,Q)},C.hasPaintOverride=function(Q,he){var me=Q.get("text-field"),we=_h.paint.properties[he],Re=!1,$e=function(It){for(var tr=0,Qt=It;tr<Qt.length;tr+=1){var dr=Qt[tr];if(we.overrides&&we.overrides.hasOverride(dr)){Re=!0;return}}};if(me.value.kind==="constant"&&me.value.value instanceof Ui)$e(me.value.value.sections);else if(me.value.kind==="source"){var ft=function(It){if(!Re)if(It instanceof Ki&&Di(It.value)===pa){var tr=It.value;$e(tr.sections)}else It instanceof ts?$e(It.sections):It.eachChild(ft)},pt=me.value;pt._styleExpression&&ft(pt._styleExpression.expression)}return Re},C}(xs),g0=new Xi({"background-color":new Ia(Bt.paint_background["background-color"]),"background-pattern":new eo(Bt.paint_background["background-pattern"]),"background-opacity":new Ia(Bt.paint_background["background-opacity"])}),y0={paint:g0},m0=function(E){function C(O){E.call(this,O,y0)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C}(xs),x0=new Xi({"raster-opacity":new Ia(Bt.paint_raster["raster-opacity"]),"raster-hue-rotate":new Ia(Bt.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Ia(Bt.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Ia(Bt.paint_raster["raster-brightness-max"]),"raster-saturation":new Ia(Bt.paint_raster["raster-saturation"]),"raster-contrast":new Ia(Bt.paint_raster["raster-contrast"]),"raster-resampling":new Ia(Bt.paint_raster["raster-resampling"]),"raster-fade-duration":new Ia(Bt.paint_raster["raster-fade-duration"])}),b0={paint:x0},_0=function(E){function C(O){E.call(this,O,b0)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C}(xs);function w0(E){var C=[],O=E.id;return O===void 0&&C.push({message:"layers."+O+': missing required property "id"'}),E.render===void 0&&C.push({message:"layers."+O+': missing required method "render"'}),E.renderingMode&&E.renderingMode!=="2d"&&E.renderingMode!=="3d"&&C.push({message:"layers."+O+': property "renderingMode" must be either "2d" or "3d"'}),C}var T0=function(E){function C(O){E.call(this,O,{}),this.implementation=O}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.is3D=function(){return this.implementation.renderingMode==="3d"},C.prototype.hasOffscreenPass=function(){return this.implementation.prerender!==void 0},C.prototype.recalculate=function(){},C.prototype.updateTransitions=function(){},C.prototype.hasTransition=function(){},C.prototype.serialize=function(){},C.prototype.onAdd=function(Q){this.implementation.onAdd&&this.implementation.onAdd(Q,Q.painter.context.gl)},C.prototype.onRemove=function(Q){this.implementation.onRemove&&this.implementation.onRemove(Q,Q.painter.context.gl)},C}(xs),A0={circle:qv,heatmap:np,hillshade:op,fill:Pp,"fill-extrusion":Qp,line:fd,symbol:d0,background:m0,raster:_0};function M0(E){return E.type==="custom"?new T0(E):new A0[E.type](E)}var wv=self.HTMLImageElement,Tv=self.HTMLCanvasElement,Av=self.HTMLVideoElement,Mv=self.ImageData,Gc=self.ImageBitmap,wf=function(C,O,Q,he){this.context=C,this.format=Q,this.texture=C.gl.createTexture(),this.update(O,he)};wf.prototype.update=function(C,O,Q){var he=C.width,me=C.height,we=(!this.size||this.size[0]!==he||this.size[1]!==me)&&!Q,Re=this,$e=Re.context,ft=$e.gl;if(this.useMipmap=Boolean(O&&O.useMipmap),ft.bindTexture(ft.TEXTURE_2D,this.texture),$e.pixelStoreUnpackFlipY.set(!1),$e.pixelStoreUnpack.set(1),$e.pixelStoreUnpackPremultiplyAlpha.set(this.format===ft.RGBA&&(!O||O.premultiply!==!1)),we)this.size=[he,me],C instanceof wv||C instanceof Tv||C instanceof Av||C instanceof Mv||Gc&&C instanceof Gc?ft.texImage2D(ft.TEXTURE_2D,0,this.format,this.format,ft.UNSIGNED_BYTE,C):ft.texImage2D(ft.TEXTURE_2D,0,this.format,he,me,0,this.format,ft.UNSIGNED_BYTE,C.data);else{var pt=Q||{x:0,y:0},It=pt.x,tr=pt.y;C instanceof wv||C instanceof Tv||C instanceof Av||C instanceof Mv||Gc&&C instanceof Gc?ft.texSubImage2D(ft.TEXTURE_2D,0,It,tr,ft.RGBA,ft.UNSIGNED_BYTE,C):ft.texSubImage2D(ft.TEXTURE_2D,0,It,tr,he,me,ft.RGBA,ft.UNSIGNED_BYTE,C.data)}this.useMipmap&&this.isSizePowerOfTwo()&&ft.generateMipmap(ft.TEXTURE_2D)},wf.prototype.bind=function(C,O,Q){var he=this,me=he.context,we=me.gl;we.bindTexture(we.TEXTURE_2D,this.texture),Q===we.LINEAR_MIPMAP_NEAREST&&!this.isSizePowerOfTwo()&&(Q=we.LINEAR),C!==this.filter&&(we.texParameteri(we.TEXTURE_2D,we.TEXTURE_MAG_FILTER,C),we.texParameteri(we.TEXTURE_2D,we.TEXTURE_MIN_FILTER,Q||C),this.filter=C),O!==this.wrap&&(we.texParameteri(we.TEXTURE_2D,we.TEXTURE_WRAP_S,O),we.texParameteri(we.TEXTURE_2D,we.TEXTURE_WRAP_T,O),this.wrap=O)},wf.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1===0},wf.prototype.destroy=function(){var C=this.context,O=C.gl;O.deleteTexture(this.texture),this.texture=null};var wh=function(C){var O=this;this._callback=C,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){O._triggered=!1,O._callback()})};wh.prototype.trigger=function(){var C=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(function(){C._triggered=!1,C._callback()},0))},wh.prototype.remove=function(){delete this._channel,this._callback=function(){}};var jf=function(C,O,Q){this.target=C,this.parent=O,this.mapId=Q,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},T(["receive","process"],this),this.invoker=new wh(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=J()?C:self};jf.prototype.send=function(C,O,Q,he,me){var we=this;me===void 0&&(me=!1);var Re=Math.round(Math.random()*1e18).toString(36).substring(0,10);Q&&(this.callbacks[Re]=Q);var $e=Z(this.globalScope)?void 0:[];return this.target.postMessage({id:Re,type:C,hasCallback:!!Q,targetMapId:he,mustQueue:me,sourceMapId:this.mapId,data:Ct(O,$e)},$e),{cancel:function(){Q&&delete we.callbacks[Re],we.target.postMessage({id:Re,type:"<cancel>",targetMapId:he,sourceMapId:we.mapId})}}},jf.prototype.receive=function(C){var O=C.data,Q=O.id;if(!!Q&&!(O.targetMapId&&this.mapId!==O.targetMapId))if(O.type==="<cancel>"){delete this.tasks[Q];var he=this.cancelCallbacks[Q];delete this.cancelCallbacks[Q],he&&he()}else J()||O.mustQueue?(this.tasks[Q]=O,this.taskQueue.push(Q),this.invoker.trigger()):this.processTask(Q,O)},jf.prototype.process=function(){if(!!this.taskQueue.length){var C=this.taskQueue.shift(),O=this.tasks[C];delete this.tasks[C],this.taskQueue.length&&this.invoker.trigger(),O&&this.processTask(C,O)}},jf.prototype.processTask=function(C,O){var Q=this;if(O.type==="<response>"){var he=this.callbacks[C];delete this.callbacks[C],he&&(O.error?he(Xt(O.error)):he(null,Xt(O.data)))}else{var me=!1,we=Z(this.globalScope)?void 0:[],Re=O.hasCallback?function(tr,Qt){me=!0,delete Q.cancelCallbacks[C],Q.target.postMessage({id:C,type:"<response>",sourceMapId:Q.mapId,error:tr?Ct(tr):null,data:Ct(Qt,we)},we)}:function(tr){me=!0},$e=null,ft=Xt(O.data);if(this.parent[O.type])$e=this.parent[O.type](O.sourceMapId,ft,Re);else if(this.parent.getWorkerSource){var pt=O.type.split("."),It=this.parent.getWorkerSource(O.sourceMapId,pt[0],ft.source);$e=It[pt[1]](ft,Re)}else Re(new Error("Could not find function "+O.type));!me&&$e&&$e.cancel&&(this.cancelCallbacks[C]=$e.cancel)}},jf.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};function S0(E,C,O){C=Math.pow(2,O)-C-1;var Q=Sv(E*256,C*256,O),he=Sv((E+1)*256,(C+1)*256,O);return Q[0]+","+Q[1]+","+he[0]+","+he[1]}function Sv(E,C,O){var Q=2*Math.PI*6378137/256/Math.pow(2,O),he=E*Q-2*Math.PI*6378137/2,me=C*Q-2*Math.PI*6378137/2;return[he,me]}var No=function(C,O){C&&(O?this.setSouthWest(C).setNorthEast(O):C.length===4?this.setSouthWest([C[0],C[1]]).setNorthEast([C[2],C[3]]):this.setSouthWest(C[0]).setNorthEast(C[1]))};No.prototype.setNorthEast=function(C){return this._ne=C instanceof co?new co(C.lng,C.lat):co.convert(C),this},No.prototype.setSouthWest=function(C){return this._sw=C instanceof co?new co(C.lng,C.lat):co.convert(C),this},No.prototype.extend=function(C){var O=this._sw,Q=this._ne,he,me;if(C instanceof co)he=C,me=C;else if(C instanceof No){if(he=C._sw,me=C._ne,!he||!me)return this}else{if(Array.isArray(C))if(C.length===4||C.every(Array.isArray)){var we=C;return this.extend(No.convert(we))}else{var Re=C;return this.extend(co.convert(Re))}return this}return!O&&!Q?(this._sw=new co(he.lng,he.lat),this._ne=new co(me.lng,me.lat)):(O.lng=Math.min(he.lng,O.lng),O.lat=Math.min(he.lat,O.lat),Q.lng=Math.max(me.lng,Q.lng),Q.lat=Math.max(me.lat,Q.lat)),this},No.prototype.getCenter=function(){return new co((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},No.prototype.getSouthWest=function(){return this._sw},No.prototype.getNorthEast=function(){return this._ne},No.prototype.getNorthWest=function(){return new co(this.getWest(),this.getNorth())},No.prototype.getSouthEast=function(){return new co(this.getEast(),this.getSouth())},No.prototype.getWest=function(){return this._sw.lng},No.prototype.getSouth=function(){return this._sw.lat},No.prototype.getEast=function(){return this._ne.lng},No.prototype.getNorth=function(){return this._ne.lat},No.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},No.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},No.prototype.isEmpty=function(){return!(this._sw&&this._ne)},No.prototype.contains=function(C){var O=co.convert(C),Q=O.lng,he=O.lat,me=this._sw.lat<=he&&he<=this._ne.lat,we=this._sw.lng<=Q&&Q<=this._ne.lng;return this._sw.lng>this._ne.lng&&(we=this._sw.lng>=Q&&Q>=this._ne.lng),me&&we},No.convert=function(C){return!C||C instanceof No?C:new No(C)};var kv=63710088e-1,co=function(C,O){if(isNaN(C)||isNaN(O))throw new Error("Invalid LngLat object: ("+C+", "+O+")");if(this.lng=+C,this.lat=+O,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};co.prototype.wrap=function(){return new co(m(this.lng,-180,180),this.lat)},co.prototype.toArray=function(){return[this.lng,this.lat]},co.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},co.prototype.distanceTo=function(C){var O=Math.PI/180,Q=this.lat*O,he=C.lat*O,me=Math.sin(Q)*Math.sin(he)+Math.cos(Q)*Math.cos(he)*Math.cos((C.lng-this.lng)*O),we=kv*Math.acos(Math.min(me,1));return we},co.prototype.toBounds=function(C){C===void 0&&(C=0);var O=40075017,Q=360*C/O,he=Q/Math.cos(Math.PI/180*this.lat);return new No(new co(this.lng-he,this.lat-Q),new co(this.lng+he,this.lat+Q))},co.convert=function(C){if(C instanceof co)return C;if(Array.isArray(C)&&(C.length===2||C.length===3))return new co(Number(C[0]),Number(C[1]));if(!Array.isArray(C)&&typeof C=="object"&&C!==null)return new co(Number("lng"in C?C.lng:C.lon),Number(C.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var Ev=2*Math.PI*kv;function Cv(E){return Ev*Math.cos(E*Math.PI/180)}function Lv(E){return(180+E)/360}function Pv(E){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+E*Math.PI/360)))/360}function Dv(E,C){return E/Cv(C)}function k0(E){return E*360-180}function Th(E){var C=180-E*360;return 360/Math.PI*Math.atan(Math.exp(C*Math.PI/180))-90}function E0(E,C){return E*Cv(Th(C))}function C0(E){return 1/Math.cos(E*Math.PI/180)}var Tf=function(C,O,Q){Q===void 0&&(Q=0),this.x=+C,this.y=+O,this.z=+Q};Tf.fromLngLat=function(C,O){O===void 0&&(O=0);var Q=co.convert(C);return new Tf(Lv(Q.lng),Pv(Q.lat),Dv(O,Q.lat))},Tf.prototype.toLngLat=function(){return new co(k0(this.x),Th(this.y))},Tf.prototype.toAltitude=function(){return E0(this.z,this.y)},Tf.prototype.meterInMercatorCoordinateUnits=function(){return 1/Ev*C0(Th(this.y))};var Af=function(C,O,Q){this.z=C,this.x=O,this.y=Q,this.key=mc(0,C,C,O,Q)};Af.prototype.equals=function(C){return this.z===C.z&&this.x===C.x&&this.y===C.y},Af.prototype.url=function(C,O){var Q=S0(this.x,this.y,this.z),he=L0(this.z,this.x,this.y);return C[(this.x+this.y)%C.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String(O==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",he).replace("{bbox-epsg-3857}",Q)},Af.prototype.getTilePoint=function(C){var O=Math.pow(2,this.z);return new c((C.x*O-this.x)*Ba,(C.y*O-this.y)*Ba)},Af.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var Rv=function(C,O){this.wrap=C,this.canonical=O,this.key=mc(C,O.z,O.z,O.x,O.y)},Uo=function(C,O,Q,he,me){this.overscaledZ=C,this.wrap=O,this.canonical=new Af(Q,+he,+me),this.key=mc(O,C,Q,he,me)};Uo.prototype.equals=function(C){return this.overscaledZ===C.overscaledZ&&this.wrap===C.wrap&&this.canonical.equals(C.canonical)},Uo.prototype.scaledTo=function(C){var O=this.canonical.z-C;return C>this.canonical.z?new Uo(C,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Uo(C,this.wrap,C,this.canonical.x>>O,this.canonical.y>>O)},Uo.prototype.calculateScaledKey=function(C,O){var Q=this.canonical.z-C;return C>this.canonical.z?mc(this.wrap*+O,C,this.canonical.z,this.canonical.x,this.canonical.y):mc(this.wrap*+O,C,C,this.canonical.x>>Q,this.canonical.y>>Q)},Uo.prototype.isChildOf=function(C){if(C.wrap!==this.wrap)return!1;var O=this.canonical.z-C.canonical.z;return C.overscaledZ===0||C.overscaledZ<this.overscaledZ&&C.canonical.x===this.canonical.x>>O&&C.canonical.y===this.canonical.y>>O},Uo.prototype.children=function(C){if(this.overscaledZ>=C)return[new Uo(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var O=this.canonical.z+1,Q=this.canonical.x*2,he=this.canonical.y*2;return[new Uo(O,this.wrap,O,Q,he),new Uo(O,this.wrap,O,Q+1,he),new Uo(O,this.wrap,O,Q,he+1),new Uo(O,this.wrap,O,Q+1,he+1)]},Uo.prototype.isLessThan=function(C){return this.wrap<C.wrap?!0:this.wrap>C.wrap?!1:this.overscaledZ<C.overscaledZ?!0:this.overscaledZ>C.overscaledZ?!1:this.canonical.x<C.canonical.x?!0:this.canonical.x>C.canonical.x?!1:this.canonical.y<C.canonical.y},Uo.prototype.wrapped=function(){return new Uo(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},Uo.prototype.unwrapTo=function(C){return new Uo(this.overscaledZ,C,this.canonical.z,this.canonical.x,this.canonical.y)},Uo.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},Uo.prototype.toUnwrapped=function(){return new Rv(this.wrap,this.canonical)},Uo.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},Uo.prototype.getTilePoint=function(C){return this.canonical.getTilePoint(new Tf(C.x-this.wrap,C.y))};function mc(E,C,O,Q,he){E*=2,E<0&&(E=E*-1-1);var me=1<<O;return(me*me*E+me*he+Q).toString(36)+O.toString(36)+C.toString(36)}function L0(E,C,O){for(var Q="",he,me=E;me>0;me--)he=1<<me-1,Q+=(C&he?1:0)+(O&he?2:0);return Q}Ie("CanonicalTileID",Af),Ie("OverscaledTileID",Uo,{omit:["posMatrix"]});var Ku=function(C,O,Q){if(this.uid=C,O.height!==O.width)throw new RangeError("DEM tiles must be square");if(Q&&Q!=="mapbox"&&Q!=="terrarium")return B('"'+Q+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=O.height;var he=this.dim=O.height-2;this.data=new Uint32Array(O.data.buffer),this.encoding=Q||"mapbox";for(var me=0;me<he;me++)this.data[this._idx(-1,me)]=this.data[this._idx(0,me)],this.data[this._idx(he,me)]=this.data[this._idx(he-1,me)],this.data[this._idx(me,-1)]=this.data[this._idx(me,0)],this.data[this._idx(me,he)]=this.data[this._idx(me,he-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(he,-1)]=this.data[this._idx(he-1,0)],this.data[this._idx(-1,he)]=this.data[this._idx(0,he-1)],this.data[this._idx(he,he)]=this.data[this._idx(he-1,he-1)]};Ku.prototype.get=function(C,O){var Q=new Uint8Array(this.data.buffer),he=this._idx(C,O)*4,me=this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox;return me(Q[he],Q[he+1],Q[he+2])},Ku.prototype.getUnpackVector=function(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},Ku.prototype._idx=function(C,O){if(C<-1||C>=this.dim+1||O<-1||O>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(O+1)*this.stride+(C+1)},Ku.prototype._unpackMapbox=function(C,O,Q){return(C*256*256+O*256+Q)/10-1e4},Ku.prototype._unpackTerrarium=function(C,O,Q){return C*256+O+Q/256-32768},Ku.prototype.getPixels=function(){return new el({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},Ku.prototype.backfillBorder=function(C,O,Q){if(this.dim!==C.dim)throw new Error("dem dimension mismatch");var he=O*this.dim,me=O*this.dim+this.dim,we=Q*this.dim,Re=Q*this.dim+this.dim;switch(O){case-1:he=me-1;break;case 1:me=he+1;break}switch(Q){case-1:we=Re-1;break;case 1:Re=we+1;break}for(var $e=-O*this.dim,ft=-Q*this.dim,pt=we;pt<Re;pt++)for(var It=he;It<me;It++)this.data[this._idx(It,pt)]=C.data[this._idx(It+$e,pt+ft)]},Ie("DEMData",Ku);function P0(E,C){var O={};if(!C)return O;for(var Q=function(){var we=me[he],Re=we.layerIds.map(function(It){return C.getLayer(It)}).filter(Boolean);if(Re.length!==0){we.layers=Re,we.stateDependentLayerIds&&(we.stateDependentLayers=we.stateDependentLayerIds.map(function(It){return Re.filter(function(tr){return tr.id===It})[0]}));for(var $e=0,ft=Re;$e<ft.length;$e+=1){var pt=ft[$e];O[pt.id]=we}}},he=0,me=E;he<me.length;he+=1)Q();return O}var Yc=function(C){this._stringToNumber={},this._numberToString=[];for(var O=0;O<C.length;O++){var Q=C[O];this._stringToNumber[Q]=O,this._numberToString[O]=Q}};Yc.prototype.encode=function(C){return this._stringToNumber[C]},Yc.prototype.decode=function(C){return this._numberToString[C]};var Wc=function(C,O,Q,he,me){this.type="Feature",this._vectorTileFeature=C,C._z=O,C._x=Q,C._y=he,this.properties=C.properties,this.id=me},Ah={geometry:{configurable:!0}};Ah.geometry.get=function(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},Ah.geometry.set=function(E){this._geometry=E},Wc.prototype.toJSON=function(){var C={geometry:this.geometry};for(var O in this)O==="_geometry"||O==="_vectorTileFeature"||(C[O]=this[O]);return C},Object.defineProperties(Wc.prototype,Ah);var Kf=function(){this.state={},this.stateChanges={},this.deletedStates={}};Kf.prototype.updateState=function(C,O,Q){var he=String(O);if(this.stateChanges[C]=this.stateChanges[C]||{},this.stateChanges[C][he]=this.stateChanges[C][he]||{},A(this.stateChanges[C][he],Q),this.deletedStates[C]===null){this.deletedStates[C]={};for(var me in this.state[C])me!==he&&(this.deletedStates[C][me]=null)}else{var we=this.deletedStates[C]&&this.deletedStates[C][he]===null;if(we){this.deletedStates[C][he]={};for(var Re in this.state[C][he])Q[Re]||(this.deletedStates[C][he][Re]=null)}else for(var $e in Q){var ft=this.deletedStates[C]&&this.deletedStates[C][he]&&this.deletedStates[C][he][$e]===null;ft&&delete this.deletedStates[C][he][$e]}}},Kf.prototype.removeFeatureState=function(C,O,Q){var he=this.deletedStates[C]===null;if(!he){var me=String(O);if(this.deletedStates[C]=this.deletedStates[C]||{},Q&&O!==void 0)this.deletedStates[C][me]!==null&&(this.deletedStates[C][me]=this.deletedStates[C][me]||{},this.deletedStates[C][me][Q]=null);else if(O!==void 0){var we=this.stateChanges[C]&&this.stateChanges[C][me];if(we){this.deletedStates[C][me]={};for(Q in this.stateChanges[C][me])this.deletedStates[C][me][Q]=null}else this.deletedStates[C][me]=null}else this.deletedStates[C]=null}},Kf.prototype.getState=function(C,O){var Q=String(O),he=this.state[C]||{},me=this.stateChanges[C]||{},we=A({},he[Q],me[Q]);if(this.deletedStates[C]===null)return{};if(this.deletedStates[C]){var Re=this.deletedStates[C][O];if(Re===null)return{};for(var $e in Re)delete we[$e]}return we},Kf.prototype.initializeTileState=function(C,O){C.setFeatureState(this.state,O)},Kf.prototype.coalesceChanges=function(C,O){var Q={};for(var he in this.stateChanges){this.state[he]=this.state[he]||{};var me={};for(var we in this.stateChanges[he])this.state[he][we]||(this.state[he][we]={}),A(this.state[he][we],this.stateChanges[he][we]),me[we]=this.state[he][we];Q[he]=me}for(var Re in this.deletedStates){this.state[Re]=this.state[Re]||{};var $e={};if(this.deletedStates[Re]===null)for(var ft in this.state[Re])$e[ft]={},this.state[Re][ft]={};else for(var pt in this.deletedStates[Re]){var It=this.deletedStates[Re][pt]===null;if(It)this.state[Re][pt]={};else for(var tr=0,Qt=Object.keys(this.deletedStates[Re][pt]);tr<Qt.length;tr+=1){var dr=Qt[tr];delete this.state[Re][pt][dr]}$e[pt]=this.state[Re][pt]}Q[Re]=Q[Re]||{},A(Q[Re],$e)}if(this.stateChanges={},this.deletedStates={},Object.keys(Q).length!==0)for(var Fr in C){var an=C[Fr];an.setFeatureState(Q,O)}};var Ju=function(C,O){this.tileID=C,this.x=C.canonical.x,this.y=C.canonical.y,this.z=C.canonical.z,this.grid=new Lo(Ba,16,0),this.grid3D=new Lo(Ba,16,0),this.featureIndexArray=new nc,this.promoteId=O};Ju.prototype.insert=function(C,O,Q,he,me,we){var Re=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(Q,he,me);for(var $e=we?this.grid3D:this.grid,ft=0;ft<O.length;ft++){for(var pt=O[ft],It=[1/0,1/0,-1/0,-1/0],tr=0;tr<pt.length;tr++){var Qt=pt[tr];It[0]=Math.min(It[0],Qt.x),It[1]=Math.min(It[1],Qt.y),It[2]=Math.max(It[2],Qt.x),It[3]=Math.max(It[3],Qt.y)}It[0]<Ba&&It[1]<Ba&&It[2]>=0&&It[3]>=0&&$e.insert(Re,It[0],It[1],It[2],It[3])}},Ju.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new Of.VectorTile(new Ic(this.rawTileData)).layers,this.sourceLayerCoder=new Yc(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},Ju.prototype.query=function(C,O,Q,he){var me=this;this.loadVTLayers();for(var we=C.params||{},Re=Ba/C.tileSize/C.scale,$e=Fu(we.filter),ft=C.queryGeometry,pt=C.queryPadding*Re,It=zv(ft),tr=this.grid.query(It.minX-pt,It.minY-pt,It.maxX+pt,It.maxY+pt),Qt=zv(C.cameraQueryGeometry),dr=this.grid3D.query(Qt.minX-pt,Qt.minY-pt,Qt.maxX+pt,Qt.maxY+pt,function(Gn,oa,na,Ra){return Vu(C.cameraQueryGeometry,Gn-pt,oa-pt,na+pt,Ra+pt)}),Fr=0,an=dr;Fr<an.length;Fr+=1){var $r=an[Fr];tr.push($r)}tr.sort(D0);for(var kn={},mn,Sn=function(Gn){var oa=tr[Gn];if(oa!==mn){mn=oa;var na=me.featureIndexArray.get(oa),Ra=null;me.loadMatchingFeature(kn,na.bucketIndex,na.sourceLayerIndex,na.featureIndex,$e,we.layers,we.availableImages,O,Q,he,function(wa,Ma,ti){return Ra||(Ra=Ni(wa)),Ma.queryIntersectsFeature(ft,wa,ti,Ra,me.z,C.transform,Re,C.pixelPosMatrix)})}},In=0;In<tr.length;In++)Sn(In);return kn},Ju.prototype.loadMatchingFeature=function(C,O,Q,he,me,we,Re,$e,ft,pt,It){var tr=this.bucketLayerIDs[O];if(!(we&&!D(we,tr))){var Qt=this.sourceLayerCoder.decode(Q),dr=this.vtLayers[Qt],Fr=dr.feature(he);if(!!me.filter(new si(this.tileID.overscaledZ),Fr))for(var an=this.getId(Fr,Qt),$r=0;$r<tr.length;$r++){var kn=tr[$r];if(!(we&&we.indexOf(kn)<0)){var mn=$e[kn];if(!!mn){var Sn={};an!==void 0&&pt&&(Sn=pt.getState(mn.sourceLayer||"_geojsonTileLayer",an));var In=ft[kn];In.paint=Iv(In.paint,mn.paint,Fr,Sn,Re),In.layout=Iv(In.layout,mn.layout,Fr,Sn,Re);var Gn=!It||It(Fr,mn,Sn);if(!!Gn){var oa=new Wc(Fr,this.z,this.x,this.y,an);oa.layer=In;var na=C[kn];na===void 0&&(na=C[kn]=[]),na.push({featureIndex:he,feature:oa,intersectionZ:Gn})}}}}}},Ju.prototype.lookupSymbolFeatures=function(C,O,Q,he,me,we,Re,$e){var ft={};this.loadVTLayers();for(var pt=Fu(me),It=0,tr=C;It<tr.length;It+=1){var Qt=tr[It];this.loadMatchingFeature(ft,Q,he,Qt,pt,we,Re,$e,O)}return ft},Ju.prototype.hasLayer=function(C){for(var O=0,Q=this.bucketLayerIDs;O<Q.length;O+=1)for(var he=Q[O],me=0,we=he;me<we.length;me+=1){var Re=we[me];if(C===Re)return!0}return!1},Ju.prototype.getId=function(C,O){var Q=C.id;if(this.promoteId){var he=typeof this.promoteId=="string"?this.promoteId:this.promoteId[O];Q=C.properties[he],typeof Q=="boolean"&&(Q=Number(Q))}return Q},Ie("FeatureIndex",Ju,{omit:["rawTileData","sourceLayerCoder"]});function Iv(E,C,O,Q,he){return P(E,function(me,we){var Re=C instanceof Bi?C.get(we):null;return Re&&Re.evaluate?Re.evaluate(O,Q,he):Re})}function zv(E){for(var C=1/0,O=1/0,Q=-1/0,he=-1/0,me=0,we=E;me<we.length;me+=1){var Re=we[me];C=Math.min(C,Re.x),O=Math.min(O,Re.y),Q=Math.max(Q,Re.x),he=Math.max(he,Re.y)}return{minX:C,minY:O,maxX:Q,maxY:he}}function D0(E,C){return C-E}var R0=3e4,$o=function(C,O){this.tileID=C,this.uid=x(),this.uses=0,this.tileSize=O,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};$o.prototype.registerFadeDuration=function(C){var O=C+this.timeAdded;O<K.now()||this.fadeEndTime&&O<this.fadeEndTime||(this.fadeEndTime=O)},$o.prototype.wasRequested=function(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"},$o.prototype.loadVectorData=function(C,O,Q){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",!C){this.collisionBoxArray=new Hu;return}C.featureIndex&&(this.latestFeatureIndex=C.featureIndex,C.rawTileData?(this.latestRawTileData=C.rawTileData,this.latestFeatureIndex.rawTileData=C.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=C.collisionBoxArray,this.buckets=P0(C.buckets,O.style),this.hasSymbolBuckets=!1;for(var he in this.buckets){var me=this.buckets[he];if(me instanceof Yi)if(this.hasSymbolBuckets=!0,Q)me.justReloaded=!0;else break}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var we in this.buckets){var Re=this.buckets[we];if(Re instanceof Yi&&Re.hasRTLText){this.hasRTLText=!0,Si();break}}this.queryPadding=0;for(var $e in this.buckets){var ft=this.buckets[$e];this.queryPadding=Math.max(this.queryPadding,O.style.getLayer($e).queryRadius(ft))}C.imageAtlas&&(this.imageAtlas=C.imageAtlas),C.glyphAtlasImage&&(this.glyphAtlasImage=C.glyphAtlasImage)},$o.prototype.unloadVectorData=function(){for(var C in this.buckets)this.buckets[C].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},$o.prototype.getBucket=function(C){return this.buckets[C.id]},$o.prototype.upload=function(C){for(var O in this.buckets){var Q=this.buckets[O];Q.uploadPending()&&Q.upload(C)}var he=C.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new wf(C,this.imageAtlas.image,he.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new wf(C,this.glyphAtlasImage,he.ALPHA),this.glyphAtlasImage=null)},$o.prototype.prepare=function(C){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(C,this.imageAtlasTexture)},$o.prototype.queryRenderedFeatures=function(C,O,Q,he,me,we,Re,$e,ft,pt){return!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData?{}:this.latestFeatureIndex.query({queryGeometry:he,cameraQueryGeometry:me,scale:we,tileSize:this.tileSize,pixelPosMatrix:pt,transform:$e,params:Re,queryPadding:this.queryPadding*ft},C,O,Q)},$o.prototype.querySourceFeatures=function(C,O){var Q=this.latestFeatureIndex;if(!(!Q||!Q.rawTileData)){var he=Q.loadVTLayers(),me=O?O.sourceLayer:"",we=he._geojsonTileLayer||he[me];if(!!we)for(var Re=Fu(O&&O.filter),$e=this.tileID.canonical,ft=$e.z,pt=$e.x,It=$e.y,tr={z:ft,x:pt,y:It},Qt=0;Qt<we.length;Qt++){var dr=we.feature(Qt);if(Re.filter(new si(this.tileID.overscaledZ),dr)){var Fr=Q.getId(dr,me),an=new Wc(dr,ft,pt,It,Fr);an.tile=tr,C.push(an)}}}},$o.prototype.hasData=function(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"},$o.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},$o.prototype.setExpiryData=function(C){var O=this.expirationTime;if(C.cacheControl){var Q=X(C.cacheControl);Q["max-age"]&&(this.expirationTime=Date.now()+Q["max-age"]*1e3)}else C.expires&&(this.expirationTime=new Date(C.expires).getTime());if(this.expirationTime){var he=Date.now(),me=!1;if(this.expirationTime>he)me=!1;else if(!O)me=!0;else if(this.expirationTime<O)me=!0;else{var we=this.expirationTime-O;we?this.expirationTime=he+Math.max(we,R0):me=!0}me?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},$o.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)},$o.prototype.setFeatureState=function(C,O){if(!(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(C).length===0)){var Q=this.latestFeatureIndex.loadVTLayers();for(var he in this.buckets)if(!!O.style.hasLayer(he)){var me=this.buckets[he],we=me.layers[0].sourceLayer||"_geojsonTileLayer",Re=Q[we],$e=C[we];if(!(!Re||!$e||Object.keys($e).length===0)){me.update($e,Re,this.imageAtlas&&this.imageAtlas.patternPositions||{});var ft=O&&O.style&&O.style.getLayer(he);ft&&(this.queryPadding=Math.max(this.queryPadding,ft.queryRadius(me)))}}}},$o.prototype.holdingForFade=function(){return this.symbolFadeHoldUntil!==void 0},$o.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<K.now()},$o.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},$o.prototype.setHoldDuration=function(C){this.symbolFadeHoldUntil=K.now()+C},$o.prototype.setDependencies=function(C,O){for(var Q={},he=0,me=O;he<me.length;he+=1){var we=me[he];Q[we]=!0}this.dependencies[C]=Q},$o.prototype.hasDependency=function(C,O){for(var Q=0,he=C;Q<he.length;Q+=1){var me=he[Q],we=this.dependencies[me];if(we)for(var Re=0,$e=O;Re<$e.length;Re+=1){var ft=$e[Re];if(we[ft])return!0}}return!1};var I0=["type","source","source-layer","minzoom","maxzoom","filter","layout"],uf=self.performance,Fv=function(C){this._marks={start:[C.url,"start"].join("#"),end:[C.url,"end"].join("#"),measure:C.url.toString()},uf.mark(this._marks.start)};Fv.prototype.finish=function(){uf.mark(this._marks.end);var C=uf.getEntriesByName(this._marks.measure);return C.length===0&&(uf.measure(this._marks.measure,this._marks.start,this._marks.end),C=uf.getEntriesByName(this._marks.measure),uf.clearMarks(this._marks.start),uf.clearMarks(this._marks.end),uf.clearMeasures(this._marks.measure)),C},e.Actor=jf,e.AlphaImage=_f,e.CanonicalTileID=Af,e.CollisionBoxArray=Hu,e.Color=vi,e.DEMData=Ku,e.DataConstantProperty=Ia,e.DictionaryCoder=Yc,e.EXTENT=Ba,e.ErrorEvent=br,e.EvaluationParameters=si,e.Event=kr,e.Evented=Mr,e.FeatureIndex=Ju,e.FillBucket=_u,e.FillExtrusionBucket=wu,e.ImageAtlas=pc,e.ImagePosition=Fc,e.LineBucket=tl,e.LngLat=co,e.LngLatBounds=No,e.MercatorCoordinate=Tf,e.ONE_EM=hs,e.OverscaledTileID=Uo,e.Point=c,e.Point$1=c,e.Properties=Xi,e.Protobuf=Ic,e.RGBAImage=el,e.RequestManager=ze,e.RequestPerformance=Fv,e.ResourceType=at,e.SegmentVector=V,e.SourceFeatureState=Kf,e.StructArrayLayout1ui2=rf,e.StructArrayLayout2f1f2i16=mu,e.StructArrayLayout2i4=pf,e.StructArrayLayout3ui6=xu,e.StructArrayLayout4i8=Ou,e.SymbolBucket=Yi,e.Texture=wf,e.Tile=$o,e.Transitionable=go,e.Uniform1f=Ur,e.Uniform1i=Gr,e.Uniform2f=Kr,e.Uniform3f=cn,e.Uniform4f=En,e.UniformColor=Fn,e.UniformMatrix4f=qn,e.UnwrappedTileID=Rv,e.ValidationError=hr,e.WritingMode=kl,e.ZoomHistory=$t,e.add=If,e.addDynamicAttributes=bh,e.asyncAll=u,e.bezier=p,e.bindAll=T,e.browser=K,e.cacheEntryPossiblyAdded=qt,e.clamp=h,e.clearTileCache=fr,e.clipLine=gv,e.clone=kc,e.clone$1=I,e.clone$2=qc,e.collisionCircleLayout=pd,e.config=ne,e.create=Pf,e.create$1=xf,e.create$2=mf,e.createCommonjsModule=a,e.createExpression=Ol,e.createLayout=Do,e.createStyleLayer=M0,e.cross=Yv,e.deepEqual=i,e.dot=Gv,e.dot$1=Kv,e.ease=g,e.emitValidationErrors=po,e.endsWith=k,e.enforceCacheSizeLimit=Yt,e.evaluateSizeForFeature=uv,e.evaluateSizeForZoom=fv,e.evaluateVariableOffset=xv,e.evented=yi,e.extend=A,e.featureFilter=Fu,e.filterObject=z,e.fromRotation=Lf,e.getAnchorAlignment=gh,e.getAnchorJustification=xh,e.getArrayBuffer=lt,e.getImage=dt,e.getJSON=st,e.getRTLTextPluginStatus=fo,e.getReferrer=Zt,e.getVideo=Tt,e.identity=Df,e.invert=af,e.isChar=er,e.isMapboxURL=Oe,e.keysDifference=s,e.makeRequest=Ke,e.mapObject=P,e.mercatorXfromLng=Lv,e.mercatorYfromLat=Pv,e.mercatorZfromAltitude=Dv,e.mul=$c,e.multiply=of,e.mvt=Of,e.normalize=ic,e.number=oo,e.offscreenCanvasSupported=Qr,e.ortho=Qc,e.parseGlyphPBF=Hd,e.pbf=Ic,e.performSymbolLayout=i0,e.perspective=ac,e.pick=b,e.plugin=Xa,e.polygonIntersectsPolygon=ii,e.postMapLoadEvent=kt,e.postTurnstileEvent=Gt,e.potpack=tv,e.refProperties=I0,e.register=Ie,e.registerForPluginStateChange=Ii,e.rotate=Es,e.rotateX=qs,e.rotateZ=Rf,e.scale=$s,e.scale$1=jv,e.scale$2=th,e.setCacheLimits=Yr,e.setRTLTextPlugin=fa,e.sphericalToCartesian=G,e.sqrLen=$v,e.styleSpec=Bt,e.sub=Xv,e.symbolSize=Jd,e.transformMat3=Wv,e.transformMat4=Ec,e.translate=Eo,e.triggerPluginCompletionEvent=Pa,e.uniqueId=x,e.validateCustomStyleLayer=w0,e.validateLight=bi,e.validateStyle=bo,e.values=_,e.vectorTile=Of,e.version=n,e.warnOnce=B,e.webpSupported=ae,e.window=self,e.wrap=m}),M(["./shared"],function(e){function a(rt){var Ke=typeof rt;if(Ke==="number"||Ke==="boolean"||Ke==="string"||rt===void 0||rt===null)return JSON.stringify(rt);if(Array.isArray(rt)){for(var st="[",lt=0,wt=rt;lt<wt.length;lt+=1){var Pt=wt[lt];st+=a(Pt)+","}return st+"]"}for(var ke=Object.keys(rt).sort(),Se="{",nt=0;nt<ke.length;nt++)Se+=JSON.stringify(ke[nt])+":"+a(rt[ke[nt]])+",";return Se+"}"}function n(rt){for(var Ke="",st=0,lt=e.refProperties;st<lt.length;st+=1){var wt=lt[st];Ke+="/"+a(rt[wt])}return Ke}function r(rt,Ke){for(var st={},lt=0;lt<rt.length;lt++){var wt=Ke&&Ke[rt[lt].id]||n(rt[lt]);Ke&&(Ke[rt[lt].id]=wt);var Pt=st[wt];Pt||(Pt=st[wt]=[]),Pt.push(rt[lt])}var ke=[];for(var Se in st)ke.push(st[Se]);return ke}var t=function(Ke){this.keyCache={},Ke&&this.replace(Ke)};t.prototype.replace=function(Ke){this._layerConfigs={},this._layers={},this.update(Ke,[])},t.prototype.update=function(Ke,st){for(var lt=this,wt=0,Pt=Ke;wt<Pt.length;wt+=1){var ke=Pt[wt];this._layerConfigs[ke.id]=ke;var Se=this._layers[ke.id]=e.createStyleLayer(ke);Se._featureFilter=e.featureFilter(Se.filter),this.keyCache[ke.id]&&delete this.keyCache[ke.id]}for(var nt=0,it=st;nt<it.length;nt+=1){var ct=it[nt];delete this.keyCache[ct],delete this._layerConfigs[ct],delete this._layers[ct]}this.familiesBySource={};for(var At=r(e.values(this._layerConfigs),this.keyCache),dt=0,Tt=At;dt<Tt.length;dt+=1){var Ht=Tt[dt],ir=Ht.map(function(mr){return lt._layers[mr.id]}),kr=ir[0];if(kr.visibility!=="none"){var br=kr.source||"",Mr=this.familiesBySource[br];Mr||(Mr=this.familiesBySource[br]={});var Hr=kr.sourceLayer||"_geojsonTileLayer",nr=Mr[Hr];nr||(nr=Mr[Hr]=[]),nr.push(ir)}}};var c=1,o=function(Ke){var st={},lt=[];for(var wt in Ke){var Pt=Ke[wt],ke=st[wt]={};for(var Se in Pt){var nt=Pt[+Se];if(!(!nt||nt.bitmap.width===0||nt.bitmap.height===0)){var it={x:0,y:0,w:nt.bitmap.width+2*c,h:nt.bitmap.height+2*c};lt.push(it),ke[Se]={rect:it,metrics:nt.metrics}}}}var ct=e.potpack(lt),At=ct.w,dt=ct.h,Tt=new e.AlphaImage({width:At||1,height:dt||1});for(var Ht in Ke){var ir=Ke[Ht];for(var kr in ir){var br=ir[+kr];if(!(!br||br.bitmap.width===0||br.bitmap.height===0)){var Mr=st[Ht][kr].rect;e.AlphaImage.copy(br.bitmap,Tt,{x:0,y:0},{x:Mr.x+c,y:Mr.y+c},br.bitmap)}}}this.image=Tt,this.positions=st};e.register("GlyphAtlas",o);var i=function(Ke){this.tileID=new e.OverscaledTileID(Ke.tileID.overscaledZ,Ke.tileID.wrap,Ke.tileID.canonical.z,Ke.tileID.canonical.x,Ke.tileID.canonical.y),this.uid=Ke.uid,this.zoom=Ke.zoom,this.pixelRatio=Ke.pixelRatio,this.tileSize=Ke.tileSize,this.source=Ke.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=Ke.showCollisionBoxes,this.collectResourceTiming=!!Ke.collectResourceTiming,this.returnDependencies=!!Ke.returnDependencies,this.promoteId=Ke.promoteId};i.prototype.parse=function(Ke,st,lt,wt,Pt){var ke=this;this.status="parsing",this.data=Ke,this.collisionBoxArray=new e.CollisionBoxArray;var Se=new e.DictionaryCoder(Object.keys(Ke.layers).sort()),nt=new e.FeatureIndex(this.tileID,this.promoteId);nt.bucketLayerIDs=[];var it={},ct={featureIndex:nt,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:lt},At=st.familiesBySource[this.source];for(var dt in At){var Tt=Ke.layers[dt];if(!!Tt){Tt.version===1&&e.warnOnce('Vector tile source "'+this.source+'" layer "'+dt+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var Ht=Se.encode(dt),ir=[],kr=0;kr<Tt.length;kr++){var br=Tt.feature(kr),Mr=nt.getId(br,dt);ir.push({feature:br,id:Mr,index:kr,sourceLayerIndex:Ht})}for(var Hr=0,nr=At[dt];Hr<nr.length;Hr+=1){var mr=nr[Hr],Pr=mr[0];if(!(Pr.minzoom&&this.zoom<Math.floor(Pr.minzoom))&&!(Pr.maxzoom&&this.zoom>=Pr.maxzoom)&&Pr.visibility!=="none"){y(mr,this.zoom,lt);var Nr=it[Pr.id]=Pr.createBucket({index:nt.bucketLayerIDs.length,layers:mr,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Ht,sourceID:this.source});Nr.populate(ir,ct,this.tileID.canonical),nt.bucketLayerIDs.push(mr.map(function(Tr){return Tr.id}))}}}}var Sr,tt,Et,Vt,ar=e.mapObject(ct.glyphDependencies,function(Tr){return Object.keys(Tr).map(Number)});Object.keys(ar).length?wt.send("getGlyphs",{uid:this.uid,stacks:ar},function(Tr,Wr){Sr||(Sr=Tr,tt=Wr,Ir.call(ke))}):tt={};var Cr=Object.keys(ct.iconDependencies);Cr.length?wt.send("getImages",{icons:Cr,source:this.source,tileID:this.tileID,type:"icons"},function(Tr,Wr){Sr||(Sr=Tr,Et=Wr,Ir.call(ke))}):Et={};var Or=Object.keys(ct.patternDependencies);Or.length?wt.send("getImages",{icons:Or,source:this.source,tileID:this.tileID,type:"patterns"},function(Tr,Wr){Sr||(Sr=Tr,Vt=Wr,Ir.call(ke))}):Vt={},Ir.call(this);function Ir(){if(Sr)return Pt(Sr);if(tt&&Et&&Vt){var Tr=new o(tt),Wr=new e.ImageAtlas(Et,Vt);for(var wn in it){var ln=it[wn];ln instanceof e.SymbolBucket?(y(ln.layers,this.zoom,lt),e.performSymbolLayout(ln,tt,Tr.positions,Et,Wr.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):ln.hasPattern&&(ln instanceof e.LineBucket||ln instanceof e.FillBucket||ln instanceof e.FillExtrusionBucket)&&(y(ln.layers,this.zoom,lt),ln.addFeatures(ct,this.tileID.canonical,Wr.patternPositions))}this.status="done",Pt(null,{buckets:e.values(it).filter(function(Bn){return!Bn.isEmpty()}),featureIndex:nt,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Tr.image,imageAtlas:Wr,glyphMap:this.returnDependencies?tt:null,iconMap:this.returnDependencies?Et:null,glyphPositions:this.returnDependencies?Tr.positions:null})}}};function y(rt,Ke,st){for(var lt=new e.EvaluationParameters(Ke),wt=0,Pt=rt;wt<Pt.length;wt+=1){var ke=Pt[wt];ke.recalculate(lt,st)}}function p(rt,Ke){var st=e.getArrayBuffer(rt.request,function(lt,wt,Pt,ke){lt?Ke(lt):wt&&Ke(null,{vectorTile:new e.vectorTile.VectorTile(new e.pbf(wt)),rawData:wt,cacheControl:Pt,expires:ke})});return function(){st.cancel(),Ke()}}var g=function(Ke,st,lt,wt){this.actor=Ke,this.layerIndex=st,this.availableImages=lt,this.loadVectorData=wt||p,this.loading={},this.loaded={}};g.prototype.loadTile=function(Ke,st){var lt=this,wt=Ke.uid;this.loading||(this.loading={});var Pt=Ke&&Ke.request&&Ke.request.collectResourceTiming?new e.RequestPerformance(Ke.request):!1,ke=this.loading[wt]=new i(Ke);ke.abort=this.loadVectorData(Ke,function(Se,nt){if(delete lt.loading[wt],Se||!nt)return ke.status="done",lt.loaded[wt]=ke,st(Se);var it=nt.rawData,ct={};nt.expires&&(ct.expires=nt.expires),nt.cacheControl&&(ct.cacheControl=nt.cacheControl);var At={};if(Pt){var dt=Pt.finish();dt&&(At.resourceTiming=JSON.parse(JSON.stringify(dt)))}ke.vectorTile=nt.vectorTile,ke.parse(nt.vectorTile,lt.layerIndex,lt.availableImages,lt.actor,function(Tt,Ht){if(Tt||!Ht)return st(Tt);st(null,e.extend({rawTileData:it.slice(0)},Ht,ct,At))}),lt.loaded=lt.loaded||{},lt.loaded[wt]=ke})},g.prototype.reloadTile=function(Ke,st){var lt=this,wt=this.loaded,Pt=Ke.uid,ke=this;if(wt&&wt[Pt]){var Se=wt[Pt];Se.showCollisionBoxes=Ke.showCollisionBoxes;var nt=function(it,ct){var At=Se.reloadCallback;At&&(delete Se.reloadCallback,Se.parse(Se.vectorTile,ke.layerIndex,lt.availableImages,ke.actor,At)),st(it,ct)};Se.status==="parsing"?Se.reloadCallback=nt:Se.status==="done"&&(Se.vectorTile?Se.parse(Se.vectorTile,this.layerIndex,this.availableImages,this.actor,nt):nt())}},g.prototype.abortTile=function(Ke,st){var lt=this.loading,wt=Ke.uid;lt&&lt[wt]&&lt[wt].abort&&(lt[wt].abort(),delete lt[wt]),st()},g.prototype.removeTile=function(Ke,st){var lt=this.loaded,wt=Ke.uid;lt&&lt[wt]&&delete lt[wt],st()};var h=e.window.ImageBitmap,m=function(){this.loaded={}};m.prototype.loadTile=function(Ke,st){var lt=Ke.uid,wt=Ke.encoding,Pt=Ke.rawImageData,ke=h&&Pt instanceof h?this.getImageData(Pt):Pt,Se=new e.DEMData(lt,ke,wt);this.loaded=this.loaded||{},this.loaded[lt]=Se,st(null,Se)},m.prototype.getImageData=function(Ke){(!this.offscreenCanvas||!this.offscreenCanvasContext)&&(this.offscreenCanvas=new OffscreenCanvas(Ke.width,Ke.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=Ke.width,this.offscreenCanvas.height=Ke.height,this.offscreenCanvasContext.drawImage(Ke,0,0,Ke.width,Ke.height);var st=this.offscreenCanvasContext.getImageData(-1,-1,Ke.width+2,Ke.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new e.RGBAImage({width:st.width,height:st.height},st.data)},m.prototype.removeTile=function(Ke){var st=this.loaded,lt=Ke.uid;st&&st[lt]&&delete st[lt]};var u=_;function _(rt,Ke){var st=rt&&rt.type,lt;if(st==="FeatureCollection")for(lt=0;lt<rt.features.length;lt++)_(rt.features[lt],Ke);else if(st==="GeometryCollection")for(lt=0;lt<rt.geometries.length;lt++)_(rt.geometries[lt],Ke);else if(st==="Feature")_(rt.geometry,Ke);else if(st==="Polygon")s(rt.coordinates,Ke);else if(st==="MultiPolygon")for(lt=0;lt<rt.coordinates.length;lt++)s(rt.coordinates[lt],Ke);return rt}function s(rt,Ke){if(rt.length!==0){A(rt[0],Ke);for(var st=1;st<rt.length;st++)A(rt[st],!Ke)}}function A(rt,Ke){for(var st=0,lt=0,wt=rt.length,Pt=wt-1;lt<wt;Pt=lt++)st+=(rt[lt][0]-rt[Pt][0])*(rt[Pt][1]+rt[lt][1]);st>=0!=!!Ke&&rt.reverse()}var b=e.vectorTile.VectorTileFeature.prototype.toGeoJSON,f=function(Ke){this._feature=Ke,this.extent=e.EXTENT,this.type=Ke.type,this.properties=Ke.tags,"id"in Ke&&!isNaN(Ke.id)&&(this.id=parseInt(Ke.id,10))};f.prototype.loadGeometry=function(){if(this._feature.type===1){for(var Ke=[],st=0,lt=this._feature.geometry;st<lt.length;st+=1){var wt=lt[st];Ke.push([new e.Point$1(wt[0],wt[1])])}return Ke}else{for(var Pt=[],ke=0,Se=this._feature.geometry;ke<Se.length;ke+=1){for(var nt=Se[ke],it=[],ct=0,At=nt;ct<At.length;ct+=1){var dt=At[ct];it.push(new e.Point$1(dt[0],dt[1]))}Pt.push(it)}return Pt}},f.prototype.toGeoJSON=function(Ke,st,lt){return b.call(this,Ke,st,lt)};var x=function(Ke){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=e.EXTENT,this.length=Ke.length,this._features=Ke};x.prototype.feature=function(Ke){return new f(this._features[Ke])};var l=e.vectorTile.VectorTileFeature,L=T;function T(rt,Ke){this.options=Ke||{},this.features=rt,this.length=rt.length}T.prototype.feature=function(rt){return new k(this.features[rt],this.options.extent)};function k(rt,Ke){this.id=typeof rt.id=="number"?rt.id:void 0,this.type=rt.type,this.rawGeometry=rt.type===1?[rt.geometry]:rt.geometry,this.properties=rt.tags,this.extent=Ke||4096}k.prototype.loadGeometry=function(){var rt=this.rawGeometry;this.geometry=[];for(var Ke=0;Ke<rt.length;Ke++){for(var st=rt[Ke],lt=[],wt=0;wt<st.length;wt++)lt.push(new e.Point$1(st[wt][0],st[wt][1]));this.geometry.push(lt)}return this.geometry},k.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var rt=this.geometry,Ke=1/0,st=-1/0,lt=1/0,wt=-1/0,Pt=0;Pt<rt.length;Pt++)for(var ke=rt[Pt],Se=0;Se<ke.length;Se++){var nt=ke[Se];Ke=Math.min(Ke,nt.x),st=Math.max(st,nt.x),lt=Math.min(lt,nt.y),wt=Math.max(wt,nt.y)}return[Ke,lt,st,wt]},k.prototype.toGeoJSON=l.prototype.toGeoJSON;var P=R,z=R,I=B,D=L;function R(rt){var Ke=new e.pbf;return F(rt,Ke),Ke.finish()}function B(rt,Ke){Ke=Ke||{};var st={};for(var lt in rt)st[lt]=new L(rt[lt].features,Ke),st[lt].name=lt,st[lt].version=Ke.version,st[lt].extent=Ke.extent;return R({layers:st})}function F(rt,Ke){for(var st in rt.layers)Ke.writeMessage(3,H,rt.layers[st])}function H(rt,Ke){Ke.writeVarintField(15,rt.version||1),Ke.writeStringField(1,rt.name||""),Ke.writeVarintField(5,rt.extent||4096);var st,lt={keys:[],values:[],keycache:{},valuecache:{}};for(st=0;st<rt.length;st++)lt.feature=rt.feature(st),Ke.writeMessage(2,G,lt);var wt=lt.keys;for(st=0;st<wt.length;st++)Ke.writeStringField(3,wt[st]);var Pt=lt.values;for(st=0;st<Pt.length;st++)Ke.writeMessage(4,oe,Pt[st])}function G(rt,Ke){var st=rt.feature;st.id!==void 0&&Ke.writeVarintField(1,st.id),Ke.writeMessage(2,J,rt),Ke.writeVarintField(3,st.type),Ke.writeMessage(4,Z,st)}function J(rt,Ke){var st=rt.feature,lt=rt.keys,wt=rt.values,Pt=rt.keycache,ke=rt.valuecache;for(var Se in st.properties){var nt=Pt[Se];typeof nt>"u"&&(lt.push(Se),nt=lt.length-1,Pt[Se]=nt),Ke.writeVarint(nt);var it=st.properties[Se],ct=typeof it;ct!=="string"&&ct!=="boolean"&&ct!=="number"&&(it=JSON.stringify(it));var At=ct+":"+it,dt=ke[At];typeof dt>"u"&&(wt.push(it),dt=wt.length-1,ke[At]=dt),Ke.writeVarint(dt)}}function X(rt,Ke){return(Ke<<3)+(rt&7)}function Y(rt){return rt<<1^rt>>31}function Z(rt,Ke){for(var st=rt.loadGeometry(),lt=rt.type,wt=0,Pt=0,ke=st.length,Se=0;Se<ke;Se++){var nt=st[Se],it=1;lt===1&&(it=nt.length),Ke.writeVarint(X(1,it));for(var ct=lt===3?nt.length-1:nt.length,At=0;At<ct;At++){At===1&&lt!==1&&Ke.writeVarint(X(2,ct-1));var dt=nt[At].x-wt,Tt=nt[At].y-Pt;Ke.writeVarint(Y(dt)),Ke.writeVarint(Y(Tt)),wt+=dt,Pt+=Tt}lt===3&&Ke.writeVarint(X(7,1))}}function oe(rt,Ke){var st=typeof rt;st==="string"?Ke.writeStringField(1,rt):st==="boolean"?Ke.writeBooleanField(7,rt):st==="number"&&(rt%1!==0?Ke.writeDoubleField(3,rt):rt<0?Ke.writeSVarintField(6,rt):Ke.writeVarintField(5,rt))}P.fromVectorTileJs=z,P.fromGeojsonVt=I,P.GeoJSONWrapper=D;function re(rt,Ke,st,lt,wt,Pt){if(!(wt-lt<=st)){var ke=lt+wt>>1;se(rt,Ke,ke,lt,wt,Pt%2),re(rt,Ke,st,lt,ke-1,Pt+1),re(rt,Ke,st,ke+1,wt,Pt+1)}}function se(rt,Ke,st,lt,wt,Pt){for(;wt>lt;){if(wt-lt>600){var ke=wt-lt+1,Se=st-lt+1,nt=Math.log(ke),it=.5*Math.exp(2*nt/3),ct=.5*Math.sqrt(nt*it*(ke-it)/ke)*(Se-ke/2<0?-1:1),At=Math.max(lt,Math.floor(st-Se*it/ke+ct)),dt=Math.min(wt,Math.floor(st+(ke-Se)*it/ke+ct));se(rt,Ke,st,At,dt,Pt)}var Tt=Ke[2*st+Pt],Ht=lt,ir=wt;for(N(rt,Ke,lt,st),Ke[2*wt+Pt]>Tt&&N(rt,Ke,lt,wt);Ht<ir;){for(N(rt,Ke,Ht,ir),Ht++,ir--;Ke[2*Ht+Pt]<Tt;)Ht++;for(;Ke[2*ir+Pt]>Tt;)ir--}Ke[2*lt+Pt]===Tt?N(rt,Ke,lt,ir):(ir++,N(rt,Ke,ir,wt)),ir<=st&&(lt=ir+1),st<=ir&&(wt=ir-1)}}function N(rt,Ke,st,lt){U(rt,st,lt),U(Ke,2*st,2*lt),U(Ke,2*st+1,2*lt+1)}function U(rt,Ke,st){var lt=rt[Ke];rt[Ke]=rt[st],rt[st]=lt}function q(rt,Ke,st,lt,wt,Pt,ke){for(var Se=[0,rt.length-1,0],nt=[],it,ct;Se.length;){var At=Se.pop(),dt=Se.pop(),Tt=Se.pop();if(dt-Tt<=ke){for(var Ht=Tt;Ht<=dt;Ht++)it=Ke[2*Ht],ct=Ke[2*Ht+1],it>=st&&it<=wt&&ct>=lt&&ct<=Pt&&nt.push(rt[Ht]);continue}var ir=Math.floor((Tt+dt)/2);it=Ke[2*ir],ct=Ke[2*ir+1],it>=st&&it<=wt&&ct>=lt&&ct<=Pt&&nt.push(rt[ir]);var kr=(At+1)%2;(At===0?st<=it:lt<=ct)&&(Se.push(Tt),Se.push(ir-1),Se.push(kr)),(At===0?wt>=it:Pt>=ct)&&(Se.push(ir+1),Se.push(dt),Se.push(kr))}return nt}function $(rt,Ke,st,lt,wt,Pt){for(var ke=[0,rt.length-1,0],Se=[],nt=wt*wt;ke.length;){var it=ke.pop(),ct=ke.pop(),At=ke.pop();if(ct-At<=Pt){for(var dt=At;dt<=ct;dt++)W(Ke[2*dt],Ke[2*dt+1],st,lt)<=nt&&Se.push(rt[dt]);continue}var Tt=Math.floor((At+ct)/2),Ht=Ke[2*Tt],ir=Ke[2*Tt+1];W(Ht,ir,st,lt)<=nt&&Se.push(rt[Tt]);var kr=(it+1)%2;(it===0?st-wt<=Ht:lt-wt<=ir)&&(ke.push(At),ke.push(Tt-1),ke.push(kr)),(it===0?st+wt>=Ht:lt+wt>=ir)&&(ke.push(Tt+1),ke.push(ct),ke.push(kr))}return Se}function W(rt,Ke,st,lt){var wt=rt-st,Pt=Ke-lt;return wt*wt+Pt*Pt}var K=function(rt){return rt[0]},ne=function(rt){return rt[1]},ae=function(Ke,st,lt,wt,Pt){st===void 0&&(st=K),lt===void 0&&(lt=ne),wt===void 0&&(wt=64),Pt===void 0&&(Pt=Float64Array),this.nodeSize=wt,this.points=Ke;for(var ke=Ke.length<65536?Uint16Array:Uint32Array,Se=this.ids=new ke(Ke.length),nt=this.coords=new Pt(Ke.length*2),it=0;it<Ke.length;it++)Se[it]=it,nt[2*it]=st(Ke[it]),nt[2*it+1]=lt(Ke[it]);re(Se,nt,wt,0,Se.length-1,0)};ae.prototype.range=function(Ke,st,lt,wt){return q(this.ids,this.coords,Ke,st,lt,wt,this.nodeSize)},ae.prototype.within=function(Ke,st,lt){return $(this.ids,this.coords,Ke,st,lt,this.nodeSize)};var ie={minZoom:0,maxZoom:16,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(rt){return rt}},le=function(Ke){this.options=Ye(Object.create(ie),Ke),this.trees=new Array(this.options.maxZoom+1)};le.prototype.load=function(Ke){var st=this.options,lt=st.log,wt=st.minZoom,Pt=st.maxZoom,ke=st.nodeSize;lt&&console.time("total time");var Se="prepare "+Ke.length+" points";lt&&console.time(Se),this.points=Ke;for(var nt=[],it=0;it<Ke.length;it++)!Ke[it].geometry||nt.push(ue(Ke[it],it));this.trees[Pt+1]=new ae(nt,be,Pe,ke,Float32Array),lt&&console.timeEnd(Se);for(var ct=Pt;ct>=wt;ct--){var At=+Date.now();nt=this._cluster(nt,ct),this.trees[ct]=new ae(nt,be,Pe,ke,Float32Array),lt&&console.log("z%d: %d clusters in %dms",ct,nt.length,+Date.now()-At)}return lt&&console.timeEnd("total time"),this},le.prototype.getClusters=function(Ke,st){var lt=((Ke[0]+180)%360+360)%360-180,wt=Math.max(-90,Math.min(90,Ke[1])),Pt=Ke[2]===180?180:((Ke[2]+180)%360+360)%360-180,ke=Math.max(-90,Math.min(90,Ke[3]));if(Ke[2]-Ke[0]>=360)lt=-180,Pt=180;else if(lt>Pt){var Se=this.getClusters([lt,wt,180,ke],st),nt=this.getClusters([-180,wt,Pt,ke],st);return Se.concat(nt)}for(var it=this.trees[this._limitZoom(st)],ct=it.range(Te(lt),_e(ke),Te(Pt),_e(wt)),At=[],dt=0,Tt=ct;dt<Tt.length;dt+=1){var Ht=Tt[dt],ir=it.points[Ht];At.push(ir.numPoints?pe(ir):this.points[ir.index])}return At},le.prototype.getChildren=function(Ke){var st=this._getOriginId(Ke),lt=this._getOriginZoom(Ke),wt="No cluster with the specified id.",Pt=this.trees[lt];if(!Pt)throw new Error(wt);var ke=Pt.points[st];if(!ke)throw new Error(wt);for(var Se=this.options.radius/(this.options.extent*Math.pow(2,lt-1)),nt=Pt.within(ke.x,ke.y,Se),it=[],ct=0,At=nt;ct<At.length;ct+=1){var dt=At[ct],Tt=Pt.points[dt];Tt.parentId===Ke&&it.push(Tt.numPoints?pe(Tt):this.points[Tt.index])}if(it.length===0)throw new Error(wt);return it},le.prototype.getLeaves=function(Ke,st,lt){st=st||10,lt=lt||0;var wt=[];return this._appendLeaves(wt,Ke,st,lt,0),wt},le.prototype.getTile=function(Ke,st,lt){var wt=this.trees[this._limitZoom(Ke)],Pt=Math.pow(2,Ke),ke=this.options,Se=ke.extent,nt=ke.radius,it=nt/Se,ct=(lt-it)/Pt,At=(lt+1+it)/Pt,dt={features:[]};return this._addTileFeatures(wt.range((st-it)/Pt,ct,(st+1+it)/Pt,At),wt.points,st,lt,Pt,dt),st===0&&this._addTileFeatures(wt.range(1-it/Pt,ct,1,At),wt.points,Pt,lt,Pt,dt),st===Pt-1&&this._addTileFeatures(wt.range(0,ct,it/Pt,At),wt.points,-1,lt,Pt,dt),dt.features.length?dt:null},le.prototype.getClusterExpansionZoom=function(Ke){for(var st=this._getOriginZoom(Ke)-1;st<=this.options.maxZoom;){var lt=this.getChildren(Ke);if(st++,lt.length!==1)break;Ke=lt[0].properties.cluster_id}return st},le.prototype._appendLeaves=function(Ke,st,lt,wt,Pt){for(var ke=this.getChildren(st),Se=0,nt=ke;Se<nt.length;Se+=1){var it=nt[Se],ct=it.properties;if(ct&&ct.cluster?Pt+ct.point_count<=wt?Pt+=ct.point_count:Pt=this._appendLeaves(Ke,ct.cluster_id,lt,wt,Pt):Pt<wt?Pt++:Ke.push(it),Ke.length===lt)break}return Pt},le.prototype._addTileFeatures=function(Ke,st,lt,wt,Pt,ke){for(var Se=0,nt=Ke;Se<nt.length;Se+=1){var it=nt[Se],ct=st[it],At=ct.numPoints,dt={type:1,geometry:[[Math.round(this.options.extent*(ct.x*Pt-lt)),Math.round(this.options.extent*(ct.y*Pt-wt))]],tags:At?ge(ct):this.points[ct.index].properties},Tt=void 0;At?Tt=ct.id:this.options.generateId?Tt=ct.index:this.points[ct.index].id&&(Tt=this.points[ct.index].id),Tt!==void 0&&(dt.id=Tt),ke.features.push(dt)}},le.prototype._limitZoom=function(Ke){return Math.max(this.options.minZoom,Math.min(Ke,this.options.maxZoom+1))},le.prototype._cluster=function(Ke,st){for(var lt=[],wt=this.options,Pt=wt.radius,ke=wt.extent,Se=wt.reduce,nt=Pt/(ke*Math.pow(2,st)),it=0;it<Ke.length;it++){var ct=Ke[it];if(!(ct.zoom<=st)){ct.zoom=st;for(var At=this.trees[st+1],dt=At.within(ct.x,ct.y,nt),Tt=ct.numPoints||1,Ht=ct.x*Tt,ir=ct.y*Tt,kr=Se&&Tt>1?this._map(ct,!0):null,br=(it<<5)+(st+1)+this.points.length,Mr=0,Hr=dt;Mr<Hr.length;Mr+=1){var nr=Hr[Mr],mr=At.points[nr];if(!(mr.zoom<=st)){mr.zoom=st;var Pr=mr.numPoints||1;Ht+=mr.x*Pr,ir+=mr.y*Pr,Tt+=Pr,mr.parentId=br,Se&&(kr||(kr=this._map(ct,!0)),Se(kr,this._map(mr)))}}Tt===1?lt.push(ct):(ct.parentId=br,lt.push(ye(Ht/Tt,ir/Tt,br,Tt,kr)))}}return lt},le.prototype._getOriginId=function(Ke){return Ke-this.points.length>>5},le.prototype._getOriginZoom=function(Ke){return(Ke-this.points.length)%32},le.prototype._map=function(Ke,st){if(Ke.numPoints)return st?Ye({},Ke.properties):Ke.properties;var lt=this.points[Ke.index].properties,wt=this.options.map(lt);return st&&wt===lt?Ye({},wt):wt};function ye(rt,Ke,st,lt,wt){return{x:rt,y:Ke,zoom:1/0,id:st,parentId:-1,numPoints:lt,properties:wt}}function ue(rt,Ke){var st=rt.geometry.coordinates,lt=st[0],wt=st[1];return{x:Te(lt),y:_e(wt),zoom:1/0,index:Ke,parentId:-1}}function pe(rt){return{type:"Feature",id:rt.id,properties:ge(rt),geometry:{type:"Point",coordinates:[ze(rt.x),Oe(rt.y)]}}}function ge(rt){var Ke=rt.numPoints,st=Ke>=1e4?Math.round(Ke/1e3)+"k":Ke>=1e3?Math.round(Ke/100)/10+"k":Ke;return Ye(Ye({},rt.properties),{cluster:!0,cluster_id:rt.id,point_count:Ke,point_count_abbreviated:st})}function Te(rt){return rt/360+.5}function _e(rt){var Ke=Math.sin(rt*Math.PI/180),st=.5-.25*Math.log((1+Ke)/(1-Ke))/Math.PI;return st<0?0:st>1?1:st}function ze(rt){return(rt-.5)*360}function Oe(rt){var Ke=(180-rt*360)*Math.PI/180;return 360*Math.atan(Math.exp(Ke))/Math.PI-90}function Ye(rt,Ke){for(var st in Ke)rt[st]=Ke[st];return rt}function be(rt){return rt.x}function Pe(rt){return rt.y}function Ge(rt,Ke,st,lt){for(var wt=lt,Pt=st-Ke>>1,ke=st-Ke,Se,nt=rt[Ke],it=rt[Ke+1],ct=rt[st],At=rt[st+1],dt=Ke+3;dt<st;dt+=3){var Tt=Qe(rt[dt],rt[dt+1],nt,it,ct,At);if(Tt>wt)Se=dt,wt=Tt;else if(Tt===wt){var Ht=Math.abs(dt-Pt);Ht<ke&&(Se=dt,ke=Ht)}}wt>lt&&(Se-Ke>3&&Ge(rt,Ke,Se,lt),rt[Se+2]=wt,st-Se>3&&Ge(rt,Se,st,lt))}function Qe(rt,Ke,st,lt,wt,Pt){var ke=wt-st,Se=Pt-lt;if(ke!==0||Se!==0){var nt=((rt-st)*ke+(Ke-lt)*Se)/(ke*ke+Se*Se);nt>1?(st=wt,lt=Pt):nt>0&&(st+=ke*nt,lt+=Se*nt)}return ke=rt-st,Se=Ke-lt,ke*ke+Se*Se}function Be(rt,Ke,st,lt){var wt={id:typeof rt>"u"?null:rt,type:Ke,geometry:st,tags:lt,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return Le(wt),wt}function Le(rt){var Ke=rt.geometry,st=rt.type;if(st==="Point"||st==="MultiPoint"||st==="LineString")He(rt,Ke);else if(st==="Polygon"||st==="MultiLineString")for(var lt=0;lt<Ke.length;lt++)He(rt,Ke[lt]);else if(st==="MultiPolygon")for(lt=0;lt<Ke.length;lt++)for(var wt=0;wt<Ke[lt].length;wt++)He(rt,Ke[lt][wt])}function He(rt,Ke){for(var st=0;st<Ke.length;st+=3)rt.minX=Math.min(rt.minX,Ke[st]),rt.minY=Math.min(rt.minY,Ke[st+1]),rt.maxX=Math.max(rt.maxX,Ke[st]),rt.maxY=Math.max(rt.maxY,Ke[st+1])}function vt(rt,Ke){var st=[];if(rt.type==="FeatureCollection")for(var lt=0;lt<rt.features.length;lt++)Rt(st,rt.features[lt],Ke,lt);else rt.type==="Feature"?Rt(st,rt,Ke):Rt(st,{geometry:rt},Ke);return st}function Rt(rt,Ke,st,lt){if(!!Ke.geometry){var wt=Ke.geometry.coordinates,Pt=Ke.geometry.type,ke=Math.pow(st.tolerance/((1<<st.maxZoom)*st.extent),2),Se=[],nt=Ke.id;if(st.promoteId?nt=Ke.properties[st.promoteId]:st.generateId&&(nt=lt||0),Pt==="Point")rr(wt,Se);else if(Pt==="MultiPoint")for(var it=0;it<wt.length;it++)rr(wt[it],Se);else if(Pt==="LineString")Lt(wt,Se,ke,!1);else if(Pt==="MultiLineString")if(st.lineMetrics){for(it=0;it<wt.length;it++)Se=[],Lt(wt[it],Se,ke,!1),rt.push(Be(nt,"LineString",Se,Ke.properties));return}else Ft(wt,Se,ke,!1);else if(Pt==="Polygon")Ft(wt,Se,ke,!0);else if(Pt==="MultiPolygon")for(it=0;it<wt.length;it++){var ct=[];Ft(wt[it],ct,ke,!0),Se.push(ct)}else if(Pt==="GeometryCollection"){for(it=0;it<Ke.geometry.geometries.length;it++)Rt(rt,{id:nt,geometry:Ke.geometry.geometries[it],properties:Ke.properties},st,lt);return}else throw new Error("Input data is not a valid GeoJSON object.");rt.push(Be(nt,Pt,Se,Ke.properties))}}function rr(rt,Ke){Ke.push(Gt(rt[0])),Ke.push(Dt(rt[1])),Ke.push(0)}function Lt(rt,Ke,st,lt){for(var wt,Pt,ke=0,Se=0;Se<rt.length;Se++){var nt=Gt(rt[Se][0]),it=Dt(rt[Se][1]);Ke.push(nt),Ke.push(it),Ke.push(0),Se>0&&(lt?ke+=(wt*it-nt*Pt)/2:ke+=Math.sqrt(Math.pow(nt-wt,2)+Math.pow(it-Pt,2))),wt=nt,Pt=it}var ct=Ke.length-3;Ke[2]=1,Ge(Ke,0,ct,st),Ke[ct+2]=1,Ke.size=Math.abs(ke),Ke.start=0,Ke.end=Ke.size}function Ft(rt,Ke,st,lt){for(var wt=0;wt<rt.length;wt++){var Pt=[];Lt(rt[wt],Pt,st,lt),Ke.push(Pt)}}function Gt(rt){return rt/360+.5}function Dt(rt){var Ke=Math.sin(rt*Math.PI/180),st=.5-.25*Math.log((1+Ke)/(1-Ke))/Math.PI;return st<0?0:st>1?1:st}function kt(rt,Ke,st,lt,wt,Pt,ke,Se){if(st/=Ke,lt/=Ke,Pt>=st&&ke<lt)return rt;if(ke<st||Pt>=lt)return null;for(var nt=[],it=0;it<rt.length;it++){var ct=rt[it],At=ct.geometry,dt=ct.type,Tt=wt===0?ct.minX:ct.minY,Ht=wt===0?ct.maxX:ct.maxY;if(Tt>=st&&Ht<lt){nt.push(ct);continue}else if(Ht<st||Tt>=lt)continue;var ir=[];if(dt==="Point"||dt==="MultiPoint")Ue(At,ir,st,lt,wt);else if(dt==="LineString")qe(At,ir,st,lt,wt,!1,Se.lineMetrics);else if(dt==="MultiLineString")Ae(At,ir,st,lt,wt,!1);else if(dt==="Polygon")Ae(At,ir,st,lt,wt,!0);else if(dt==="MultiPolygon")for(var kr=0;kr<At.length;kr++){var br=[];Ae(At[kr],br,st,lt,wt,!0),br.length&&ir.push(br)}if(ir.length){if(Se.lineMetrics&&dt==="LineString"){for(kr=0;kr<ir.length;kr++)nt.push(Be(ct.id,dt,ir[kr],ct.tags));continue}(dt==="LineString"||dt==="MultiLineString")&&(ir.length===1?(dt="LineString",ir=ir[0]):dt="MultiLineString"),(dt==="Point"||dt==="MultiPoint")&&(dt=ir.length===3?"Point":"MultiPoint"),nt.push(Be(ct.id,dt,ir,ct.tags))}}return nt.length?nt:null}function Ue(rt,Ke,st,lt,wt){for(var Pt=0;Pt<rt.length;Pt+=3){var ke=rt[Pt+wt];ke>=st&&ke<=lt&&(Ke.push(rt[Pt]),Ke.push(rt[Pt+1]),Ke.push(rt[Pt+2]))}}function qe(rt,Ke,st,lt,wt,Pt,ke){for(var Se=Ve(rt),nt=wt===0?Xe:Je,it=rt.start,ct,At,dt=0;dt<rt.length-3;dt+=3){var Tt=rt[dt],Ht=rt[dt+1],ir=rt[dt+2],kr=rt[dt+3],br=rt[dt+4],Mr=wt===0?Tt:Ht,Hr=wt===0?kr:br,nr=!1;ke&&(ct=Math.sqrt(Math.pow(Tt-kr,2)+Math.pow(Ht-br,2))),Mr<st?Hr>st&&(At=nt(Se,Tt,Ht,kr,br,st),ke&&(Se.start=it+ct*At)):Mr>lt?Hr<lt&&(At=nt(Se,Tt,Ht,kr,br,lt),ke&&(Se.start=it+ct*At)):Ne(Se,Tt,Ht,ir),Hr<st&&Mr>=st&&(At=nt(Se,Tt,Ht,kr,br,st),nr=!0),Hr>lt&&Mr<=lt&&(At=nt(Se,Tt,Ht,kr,br,lt),nr=!0),!Pt&&nr&&(ke&&(Se.end=it+ct*At),Ke.push(Se),Se=Ve(rt)),ke&&(it+=ct)}var mr=rt.length-3;Tt=rt[mr],Ht=rt[mr+1],ir=rt[mr+2],Mr=wt===0?Tt:Ht,Mr>=st&&Mr<=lt&&Ne(Se,Tt,Ht,ir),mr=Se.length-3,Pt&&mr>=3&&(Se[mr]!==Se[0]||Se[mr+1]!==Se[1])&&Ne(Se,Se[0],Se[1],Se[2]),Se.length&&Ke.push(Se)}function Ve(rt){var Ke=[];return Ke.size=rt.size,Ke.start=rt.start,Ke.end=rt.end,Ke}function Ae(rt,Ke,st,lt,wt,Pt){for(var ke=0;ke<rt.length;ke++)qe(rt[ke],Ke,st,lt,wt,Pt,!1)}function Ne(rt,Ke,st,lt){rt.push(Ke),rt.push(st),rt.push(lt)}function Xe(rt,Ke,st,lt,wt,Pt){var ke=(Pt-Ke)/(lt-Ke);return rt.push(Pt),rt.push(st+(wt-st)*ke),rt.push(1),ke}function Je(rt,Ke,st,lt,wt,Pt){var ke=(Pt-st)/(wt-st);return rt.push(Ke+(lt-Ke)*ke),rt.push(Pt),rt.push(1),ke}function _t(rt,Ke){var st=Ke.buffer/Ke.extent,lt=rt,wt=kt(rt,1,-1-st,st,0,-1,2,Ke),Pt=kt(rt,1,1-st,2+st,0,-1,2,Ke);return(wt||Pt)&&(lt=kt(rt,1,-st,1+st,0,-1,2,Ke)||[],wt&&(lt=mt(wt,1).concat(lt)),Pt&&(lt=lt.concat(mt(Pt,-1)))),lt}function mt(rt,Ke){for(var st=[],lt=0;lt<rt.length;lt++){var wt=rt[lt],Pt=wt.type,ke;if(Pt==="Point"||Pt==="MultiPoint"||Pt==="LineString")ke=Ot(wt.geometry,Ke);else if(Pt==="MultiLineString"||Pt==="Polygon"){ke=[];for(var Se=0;Se<wt.geometry.length;Se++)ke.push(Ot(wt.geometry[Se],Ke))}else if(Pt==="MultiPolygon")for(ke=[],Se=0;Se<wt.geometry.length;Se++){for(var nt=[],it=0;it<wt.geometry[Se].length;it++)nt.push(Ot(wt.geometry[Se][it],Ke));ke.push(nt)}st.push(Be(wt.id,Pt,ke,wt.tags))}return st}function Ot(rt,Ke){var st=[];st.size=rt.size,rt.start!==void 0&&(st.start=rt.start,st.end=rt.end);for(var lt=0;lt<rt.length;lt+=3)st.push(rt[lt]+Ke,rt[lt+1],rt[lt+2]);return st}function Kt(rt,Ke){if(rt.transformed)return rt;var st=1<<rt.z,lt=rt.x,wt=rt.y,Pt,ke,Se;for(Pt=0;Pt<rt.features.length;Pt++){var nt=rt.features[Pt],it=nt.geometry,ct=nt.type;if(nt.geometry=[],ct===1)for(ke=0;ke<it.length;ke+=2)nt.geometry.push(Nt(it[ke],it[ke+1],Ke,st,lt,wt));else for(ke=0;ke<it.length;ke++){var At=[];for(Se=0;Se<it[ke].length;Se+=2)At.push(Nt(it[ke][Se],it[ke][Se+1],Ke,st,lt,wt));nt.geometry.push(At)}}return rt.transformed=!0,rt}function Nt(rt,Ke,st,lt,wt,Pt){return[Math.round(st*(rt*lt-wt)),Math.round(st*(Ke*lt-Pt))]}function Wt(rt,Ke,st,lt,wt){for(var Pt=Ke===wt.maxZoom?0:wt.tolerance/((1<<Ke)*wt.extent),ke={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:st,y:lt,z:Ke,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Se=0;Se<rt.length;Se++){ke.numFeatures++,qt(ke,rt[Se],Pt,wt);var nt=rt[Se].minX,it=rt[Se].minY,ct=rt[Se].maxX,At=rt[Se].maxY;nt<ke.minX&&(ke.minX=nt),it<ke.minY&&(ke.minY=it),ct>ke.maxX&&(ke.maxX=ct),At>ke.maxY&&(ke.maxY=At)}return ke}function qt(rt,Ke,st,lt){var wt=Ke.geometry,Pt=Ke.type,ke=[];if(Pt==="Point"||Pt==="MultiPoint")for(var Se=0;Se<wt.length;Se+=3)ke.push(wt[Se]),ke.push(wt[Se+1]),rt.numPoints++,rt.numSimplified++;else if(Pt==="LineString")Yt(ke,wt,rt,st,!1,!1);else if(Pt==="MultiLineString"||Pt==="Polygon")for(Se=0;Se<wt.length;Se++)Yt(ke,wt[Se],rt,st,Pt==="Polygon",Se===0);else if(Pt==="MultiPolygon")for(var nt=0;nt<wt.length;nt++){var it=wt[nt];for(Se=0;Se<it.length;Se++)Yt(ke,it[Se],rt,st,!0,Se===0)}if(ke.length){var ct=Ke.tags||null;if(Pt==="LineString"&&lt.lineMetrics){ct={};for(var At in Ke.tags)ct[At]=Ke.tags[At];ct.mapbox_clip_start=wt.start/wt.size,ct.mapbox_clip_end=wt.end/wt.size}var dt={geometry:ke,type:Pt==="Polygon"||Pt==="MultiPolygon"?3:Pt==="LineString"||Pt==="MultiLineString"?2:1,tags:ct};Ke.id!==null&&(dt.id=Ke.id),rt.features.push(dt)}}function Yt(rt,Ke,st,lt,wt,Pt){var ke=lt*lt;if(lt>0&&Ke.size<(wt?ke:lt)){st.numPoints+=Ke.length/3;return}for(var Se=[],nt=0;nt<Ke.length;nt+=3)(lt===0||Ke[nt+2]>ke)&&(st.numSimplified++,Se.push(Ke[nt]),Se.push(Ke[nt+1])),st.numPoints++;wt&&fr(Se,Pt),rt.push(Se)}function fr(rt,Ke){for(var st=0,lt=0,wt=rt.length,Pt=wt-2;lt<wt;Pt=lt,lt+=2)st+=(rt[lt]-rt[Pt])*(rt[lt+1]+rt[Pt+1]);if(st>0===Ke)for(lt=0,wt=rt.length;lt<wt/2;lt+=2){var ke=rt[lt],Se=rt[lt+1];rt[lt]=rt[wt-2-lt],rt[lt+1]=rt[wt-1-lt],rt[wt-2-lt]=ke,rt[wt-1-lt]=Se}}function Yr(rt,Ke){return new hn(rt,Ke)}function hn(rt,Ke){Ke=this.options=at(Object.create(this.options),Ke);var st=Ke.debug;if(st&&console.time("preprocess data"),Ke.maxZoom<0||Ke.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(Ke.promoteId&&Ke.generateId)throw new Error("promoteId and generateId cannot be used together.");var lt=vt(rt,Ke);this.tiles={},this.tileCoords=[],st&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",Ke.indexMaxZoom,Ke.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),lt=_t(lt,Ke),lt.length&&this.splitTile(lt,0,0,0),st&&(lt.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}hn.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},hn.prototype.splitTile=function(rt,Ke,st,lt,wt,Pt,ke){for(var Se=[rt,Ke,st,lt],nt=this.options,it=nt.debug;Se.length;){lt=Se.pop(),st=Se.pop(),Ke=Se.pop(),rt=Se.pop();var ct=1<<Ke,At=Qr(Ke,st,lt),dt=this.tiles[At];if(!dt&&(it>1&&console.time("creation"),dt=this.tiles[At]=Wt(rt,Ke,st,lt,nt),this.tileCoords.push({z:Ke,x:st,y:lt}),it)){it>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",Ke,st,lt,dt.numFeatures,dt.numPoints,dt.numSimplified),console.timeEnd("creation"));var Tt="z"+Ke;this.stats[Tt]=(this.stats[Tt]||0)+1,this.total++}if(dt.source=rt,wt){if(Ke===nt.maxZoom||Ke===wt)continue;var Ht=1<<wt-Ke;if(st!==Math.floor(Pt/Ht)||lt!==Math.floor(ke/Ht))continue}else if(Ke===nt.indexMaxZoom||dt.numPoints<=nt.indexMaxPoints)continue;if(dt.source=null,rt.length!==0){it>1&&console.time("clipping");var ir=.5*nt.buffer/nt.extent,kr=.5-ir,br=.5+ir,Mr=1+ir,Hr,nr,mr,Pr,Nr,Sr;Hr=nr=mr=Pr=null,Nr=kt(rt,ct,st-ir,st+br,0,dt.minX,dt.maxX,nt),Sr=kt(rt,ct,st+kr,st+Mr,0,dt.minX,dt.maxX,nt),rt=null,Nr&&(Hr=kt(Nr,ct,lt-ir,lt+br,1,dt.minY,dt.maxY,nt),nr=kt(Nr,ct,lt+kr,lt+Mr,1,dt.minY,dt.maxY,nt),Nr=null),Sr&&(mr=kt(Sr,ct,lt-ir,lt+br,1,dt.minY,dt.maxY,nt),Pr=kt(Sr,ct,lt+kr,lt+Mr,1,dt.minY,dt.maxY,nt),Sr=null),it>1&&console.timeEnd("clipping"),Se.push(Hr||[],Ke+1,st*2,lt*2),Se.push(nr||[],Ke+1,st*2,lt*2+1),Se.push(mr||[],Ke+1,st*2+1,lt*2),Se.push(Pr||[],Ke+1,st*2+1,lt*2+1)}}},hn.prototype.getTile=function(rt,Ke,st){var lt=this.options,wt=lt.extent,Pt=lt.debug;if(rt<0||rt>24)return null;var ke=1<<rt;Ke=(Ke%ke+ke)%ke;var Se=Qr(rt,Ke,st);if(this.tiles[Se])return Kt(this.tiles[Se],wt);Pt>1&&console.log("drilling down to z%d-%d-%d",rt,Ke,st);for(var nt=rt,it=Ke,ct=st,At;!At&&nt>0;)nt--,it=Math.floor(it/2),ct=Math.floor(ct/2),At=this.tiles[Qr(nt,it,ct)];return!At||!At.source?null:(Pt>1&&console.log("found parent tile z%d-%d-%d",nt,it,ct),Pt>1&&console.time("drilling down"),this.splitTile(At.source,nt,it,ct,rt,Ke,st),Pt>1&&console.timeEnd("drilling down"),this.tiles[Se]?Kt(this.tiles[Se],wt):null)};function Qr(rt,Ke,st){return((1<<rt)*st+Ke)*32+rt}function at(rt,Ke){for(var st in Ke)rt[st]=Ke[st];return rt}function Jt(rt,Ke){var st=rt.tileID.canonical;if(!this._geoJSONIndex)return Ke(null,null);var lt=this._geoJSONIndex.getTile(st.z,st.x,st.y);if(!lt)return Ke(null,null);var wt=new x(lt.features),Pt=P(wt);(Pt.byteOffset!==0||Pt.byteLength!==Pt.buffer.byteLength)&&(Pt=new Uint8Array(Pt)),Ke(null,{vectorTile:wt,rawData:Pt.buffer})}var Zt=function(rt){function Ke(st,lt,wt,Pt){rt.call(this,st,lt,wt,Jt),Pt&&(this.loadGeoJSON=Pt)}return rt&&(Ke.__proto__=rt),Ke.prototype=Object.create(rt&&rt.prototype),Ke.prototype.constructor=Ke,Ke.prototype.loadData=function(lt,wt){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=wt,this._pendingLoadDataParams=lt,this._state&&this._state!=="Idle"?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},Ke.prototype._loadData=function(){var lt=this;if(!(!this._pendingCallback||!this._pendingLoadDataParams)){var wt=this._pendingCallback,Pt=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var ke=Pt&&Pt.request&&Pt.request.collectResourceTiming?new e.RequestPerformance(Pt.request):!1;this.loadGeoJSON(Pt,function(Se,nt){if(Se||!nt)return wt(Se);if(typeof nt!="object")return wt(new Error("Input data given to '"+Pt.source+"' is not a valid GeoJSON object."));u(nt,!0);try{lt._geoJSONIndex=Pt.cluster?new le(Ut(Pt)).load(nt.features):Yr(nt,Pt.geojsonVtOptions)}catch(At){return wt(At)}lt.loaded={};var it={};if(ke){var ct=ke.finish();ct&&(it.resourceTiming={},it.resourceTiming[Pt.source]=JSON.parse(JSON.stringify(ct)))}wt(null,it)})}},Ke.prototype.coalesce=function(){this._state==="Coalescing"?this._state="Idle":this._state==="NeedsLoadData"&&(this._state="Coalescing",this._loadData())},Ke.prototype.reloadTile=function(lt,wt){var Pt=this.loaded,ke=lt.uid;return Pt&&Pt[ke]?rt.prototype.reloadTile.call(this,lt,wt):this.loadTile(lt,wt)},Ke.prototype.loadGeoJSON=function(lt,wt){if(lt.request)e.getJSON(lt.request,wt);else if(typeof lt.data=="string")try{return wt(null,JSON.parse(lt.data))}catch{return wt(new Error("Input data given to '"+lt.source+"' is not a valid GeoJSON object."))}else return wt(new Error("Input data given to '"+lt.source+"' is not a valid GeoJSON object."))},Ke.prototype.removeSource=function(lt,wt){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),wt()},Ke.prototype.getClusterExpansionZoom=function(lt,wt){try{wt(null,this._geoJSONIndex.getClusterExpansionZoom(lt.clusterId))}catch(Pt){wt(Pt)}},Ke.prototype.getClusterChildren=function(lt,wt){try{wt(null,this._geoJSONIndex.getChildren(lt.clusterId))}catch(Pt){wt(Pt)}},Ke.prototype.getClusterLeaves=function(lt,wt){try{wt(null,this._geoJSONIndex.getLeaves(lt.clusterId,lt.limit,lt.offset))}catch(Pt){wt(Pt)}},Ke}(g);function Ut(rt){var Ke=rt.superclusterOptions,st=rt.clusterProperties;if(!st||!Ke)return Ke;for(var lt={},wt={},Pt={accumulated:null,zoom:0},ke={properties:null},Se=Object.keys(st),nt=0,it=Se;nt<it.length;nt+=1){var ct=it[nt],At=st[ct],dt=At[0],Tt=At[1],Ht=e.createExpression(Tt),ir=e.createExpression(typeof dt=="string"?[dt,["accumulated"],["get",ct]]:dt);lt[ct]=Ht.value,wt[ct]=ir.value}return Ke.map=function(kr){ke.properties=kr;for(var br={},Mr=0,Hr=Se;Mr<Hr.length;Mr+=1){var nr=Hr[Mr];br[nr]=lt[nr].evaluate(Pt,ke)}return br},Ke.reduce=function(kr,br){ke.properties=br;for(var Mr=0,Hr=Se;Mr<Hr.length;Mr+=1){var nr=Hr[Mr];Pt.accumulated=kr[nr],kr[nr]=wt[nr].evaluate(Pt,ke)}},Ke}var _r=function(Ke){var st=this;this.self=Ke,this.actor=new e.Actor(Ke,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:g,geojson:Zt},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(lt,wt){if(st.workerSourceTypes[lt])throw new Error('Worker source with name "'+lt+'" already registered.');st.workerSourceTypes[lt]=wt},this.self.registerRTLTextPlugin=function(lt){if(e.plugin.isParsed())throw new Error("RTL text plugin already registered.");e.plugin.applyArabicShaping=lt.applyArabicShaping,e.plugin.processBidirectionalText=lt.processBidirectionalText,e.plugin.processStyledBidirectionalText=lt.processStyledBidirectionalText}};return _r.prototype.setReferrer=function(Ke,st){this.referrer=st},_r.prototype.setImages=function(Ke,st,lt){this.availableImages[Ke]=st;for(var wt in this.workerSources[Ke]){var Pt=this.workerSources[Ke][wt];for(var ke in Pt)Pt[ke].availableImages=st}lt()},_r.prototype.setLayers=function(Ke,st,lt){this.getLayerIndex(Ke).replace(st),lt()},_r.prototype.updateLayers=function(Ke,st,lt){this.getLayerIndex(Ke).update(st.layers,st.removedIds),lt()},_r.prototype.loadTile=function(Ke,st,lt){this.getWorkerSource(Ke,st.type,st.source).loadTile(st,lt)},_r.prototype.loadDEMTile=function(Ke,st,lt){this.getDEMWorkerSource(Ke,st.source).loadTile(st,lt)},_r.prototype.reloadTile=function(Ke,st,lt){this.getWorkerSource(Ke,st.type,st.source).reloadTile(st,lt)},_r.prototype.abortTile=function(Ke,st,lt){this.getWorkerSource(Ke,st.type,st.source).abortTile(st,lt)},_r.prototype.removeTile=function(Ke,st,lt){this.getWorkerSource(Ke,st.type,st.source).removeTile(st,lt)},_r.prototype.removeDEMTile=function(Ke,st){this.getDEMWorkerSource(Ke,st.source).removeTile(st)},_r.prototype.removeSource=function(Ke,st,lt){if(!(!this.workerSources[Ke]||!this.workerSources[Ke][st.type]||!this.workerSources[Ke][st.type][st.source])){var wt=this.workerSources[Ke][st.type][st.source];delete this.workerSources[Ke][st.type][st.source],wt.removeSource!==void 0?wt.removeSource(st,lt):lt()}},_r.prototype.loadWorkerSource=function(Ke,st,lt){try{this.self.importScripts(st.url),lt()}catch(wt){lt(wt.toString())}},_r.prototype.syncRTLPluginState=function(Ke,st,lt){try{e.plugin.setState(st);var wt=e.plugin.getPluginURL();if(e.plugin.isLoaded()&&!e.plugin.isParsed()&&wt!=null){this.self.importScripts(wt);var Pt=e.plugin.isParsed(),ke=Pt?void 0:new Error("RTL Text Plugin failed to import scripts from "+wt);lt(ke,Pt)}}catch(Se){lt(Se.toString())}},_r.prototype.getAvailableImages=function(Ke){var st=this.availableImages[Ke];return st||(st=[]),st},_r.prototype.getLayerIndex=function(Ke){var st=this.layerIndexes[Ke];return st||(st=this.layerIndexes[Ke]=new t),st},_r.prototype.getWorkerSource=function(Ke,st,lt){var wt=this;if(this.workerSources[Ke]||(this.workerSources[Ke]={}),this.workerSources[Ke][st]||(this.workerSources[Ke][st]={}),!this.workerSources[Ke][st][lt]){var Pt={send:function(ke,Se,nt){wt.actor.send(ke,Se,nt,Ke)}};this.workerSources[Ke][st][lt]=new this.workerSourceTypes[st](Pt,this.getLayerIndex(Ke),this.getAvailableImages(Ke))}return this.workerSources[Ke][st][lt]},_r.prototype.getDEMWorkerSource=function(Ke,st){return this.demWorkerSources[Ke]||(this.demWorkerSources[Ke]={}),this.demWorkerSources[Ke][st]||(this.demWorkerSources[Ke][st]=new m),this.demWorkerSources[Ke][st]},_r.prototype.enforceCacheSizeLimit=function(Ke,st){e.enforceCacheSizeLimit(st)},typeof WorkerGlobalScope<"u"&&typeof e.window<"u"&&e.window instanceof WorkerGlobalScope&&(e.window.worker=new _r(e.window)),_r}),M(["./shared"],function(e){var a=e.createCommonjsModule(function(ce){ce.exports?ce.exports=V:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=V,window.mapboxgl.notSupportedReason=ve);function V(Ur){return!ve(Ur)}function ve(Ur){if(!j())return"not a browser";if(!de())return"insufficent Array support";if(!Me())return"insufficient Function support";if(!Ce())return"insufficient Object support";if(!Ze())return"insufficient JSON support";if(!ut())return"insufficient worker support";if(!St())return"insufficient Uint8ClampedArray support";if(!jt())return"insufficient ArrayBuffer support";if(!lr())return"insufficient Canvas/getImageData support";if(!Er(Ur&&Ur.failIfMajorPerformanceCaveat))return"insufficient WebGL support"}function j(){return typeof window<"u"&&typeof document<"u"}function de(){return Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray}function Me(){return Function.prototype&&Function.prototype.bind}function Ce(){return Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions}function Ze(){return"JSON"in window&&"parse"in JSON&&"stringify"in JSON}function ut(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var Ur=new Blob([""],{type:"text/javascript"}),Kr=URL.createObjectURL(Ur),cn,En;try{En=new Worker(Kr),cn=!0}catch{cn=!1}return En&&En.terminate(),URL.revokeObjectURL(Kr),cn}function St(){return"Uint8ClampedArray"in window}function jt(){return ArrayBuffer.isView}function lr(){var Ur=document.createElement("canvas");Ur.width=Ur.height=1;var Kr=Ur.getContext("2d");if(!Kr)return!1;var cn=Kr.getImageData(0,0,1,1);return cn&&cn.width===Ur.width}var vr={};function Er(Ur){return vr[Ur]===void 0&&(vr[Ur]=Gr(Ur)),vr[Ur]}V.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};function Vr(Ur){var Kr=document.createElement("canvas"),cn=Object.create(V.webGLContextAttributes);return cn.failIfMajorPerformanceCaveat=Ur,Kr.probablySupportsContext?Kr.probablySupportsContext("webgl",cn)||Kr.probablySupportsContext("experimental-webgl",cn):Kr.supportsContext?Kr.supportsContext("webgl",cn)||Kr.supportsContext("experimental-webgl",cn):Kr.getContext("webgl",cn)||Kr.getContext("experimental-webgl",cn)}function Gr(Ur){var Kr=Vr(Ur);if(!Kr)return!1;var cn=Kr.createShader(Kr.VERTEX_SHADER);return!cn||Kr.isContextLost()?!1:(Kr.shaderSource(cn,"void main() {}"),Kr.compileShader(cn),Kr.getShaderParameter(cn,Kr.COMPILE_STATUS)===!0)}}),n={};n.create=function(ce,V,ve){var j=e.window.document.createElement(ce);return V!==void 0&&(j.className=V),ve&&ve.appendChild(j),j},n.createNS=function(ce,V){var ve=e.window.document.createElementNS(ce,V);return ve};var r=e.window.document.documentElement.style;function t(ce){if(!r)return ce[0];for(var V=0;V<ce.length;V++)if(ce[V]in r)return ce[V];return ce[0]}var c=t(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),o;n.disableDrag=function(){r&&c&&(o=r[c],r[c]="none")},n.enableDrag=function(){r&&c&&(r[c]=o)};var i=t(["transform","WebkitTransform"]);n.setTransform=function(ce,V){ce.style[i]=V};var y=!1;try{var p=Object.defineProperty({},"passive",{get:function(){y=!0}});e.window.addEventListener("test",p,p),e.window.removeEventListener("test",p,p)}catch{y=!1}n.addEventListener=function(ce,V,ve,j){j===void 0&&(j={}),"passive"in j&&y?ce.addEventListener(V,ve,j):ce.addEventListener(V,ve,j.capture)},n.removeEventListener=function(ce,V,ve,j){j===void 0&&(j={}),"passive"in j&&y?ce.removeEventListener(V,ve,j):ce.removeEventListener(V,ve,j.capture)};var g=function(ce){ce.preventDefault(),ce.stopPropagation(),e.window.removeEventListener("click",g,!0)};n.suppressClick=function(){e.window.addEventListener("click",g,!0),e.window.setTimeout(function(){e.window.removeEventListener("click",g,!0)},0)},n.mousePos=function(ce,V){var ve=ce.getBoundingClientRect();return new e.Point(V.clientX-ve.left-ce.clientLeft,V.clientY-ve.top-ce.clientTop)},n.touchPos=function(ce,V){for(var ve=ce.getBoundingClientRect(),j=[],de=0;de<V.length;de++)j.push(new e.Point(V[de].clientX-ve.left-ce.clientLeft,V[de].clientY-ve.top-ce.clientTop));return j},n.mouseButton=function(ce){return typeof e.window.InstallTrigger<"u"&&ce.button===2&&ce.ctrlKey&&e.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:ce.button},n.remove=function(ce){ce.parentNode&&ce.parentNode.removeChild(ce)};function h(ce,V,ve){var j,de,Me,Ce=e.browser.devicePixelRatio>1?"@2x":"",Ze=e.getJSON(V.transformRequest(V.normalizeSpriteURL(ce,Ce,".json"),e.ResourceType.SpriteJSON),function(jt,lr){Ze=null,Me||(Me=jt,j=lr,St())}),ut=e.getImage(V.transformRequest(V.normalizeSpriteURL(ce,Ce,".png"),e.ResourceType.SpriteImage),function(jt,lr){ut=null,Me||(Me=jt,de=lr,St())});function St(){if(Me)ve(Me);else if(j&&de){var jt=e.browser.getImageData(de),lr={};for(var vr in j){var Er=j[vr],Vr=Er.width,Gr=Er.height,Ur=Er.x,Kr=Er.y,cn=Er.sdf,En=Er.pixelRatio,Fn=Er.stretchX,Kn=Er.stretchY,qn=Er.content,Qn=new e.RGBAImage({width:Vr,height:Gr});e.RGBAImage.copy(jt,Qn,{x:Ur,y:Kr},{x:0,y:0},{width:Vr,height:Gr}),lr[vr]={data:Qn,pixelRatio:En,sdf:cn,stretchX:Fn,stretchY:Kn,content:qn}}ve(null,lr)}}return{cancel:function(){Ze&&(Ze.cancel(),Ze=null),ut&&(ut.cancel(),ut=null)}}}function m(ce){var V=ce.userImage;if(V&&V.render){var ve=V.render();if(ve)return ce.data.replace(new Uint8Array(V.data.buffer)),!0}return!1}var u=1,_=function(ce){function V(){ce.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new e.RGBAImage({width:1,height:1}),this.dirty=!0}return ce&&(V.__proto__=ce),V.prototype=Object.create(ce&&ce.prototype),V.prototype.constructor=V,V.prototype.isLoaded=function(){return this.loaded},V.prototype.setLoaded=function(j){if(this.loaded!==j&&(this.loaded=j,j)){for(var de=0,Me=this.requestors;de<Me.length;de+=1){var Ce=Me[de],Ze=Ce.ids,ut=Ce.callback;this._notify(Ze,ut)}this.requestors=[]}},V.prototype.getImage=function(j){return this.images[j]},V.prototype.addImage=function(j,de){this._validate(j,de)&&(this.images[j]=de)},V.prototype._validate=function(j,de){var Me=!0;return this._validateStretch(de.stretchX,de.data&&de.data.width)||(this.fire(new e.ErrorEvent(new Error('Image "'+j+'" has invalid "stretchX" value'))),Me=!1),this._validateStretch(de.stretchY,de.data&&de.data.height)||(this.fire(new e.ErrorEvent(new Error('Image "'+j+'" has invalid "stretchY" value'))),Me=!1),this._validateContent(de.content,de)||(this.fire(new e.ErrorEvent(new Error('Image "'+j+'" has invalid "content" value'))),Me=!1),Me},V.prototype._validateStretch=function(j,de){if(!j)return!0;for(var Me=0,Ce=0,Ze=j;Ce<Ze.length;Ce+=1){var ut=Ze[Ce];if(ut[0]<Me||ut[1]<ut[0]||de<ut[1])return!1;Me=ut[1]}return!0},V.prototype._validateContent=function(j,de){return j?!(j.length!==4||j[0]<0||de.data.width<j[0]||j[1]<0||de.data.height<j[1]||j[2]<0||de.data.width<j[2]||j[3]<0||de.data.height<j[3]||j[2]<j[0]||j[3]<j[1]):!0},V.prototype.updateImage=function(j,de){var Me=this.images[j];de.version=Me.version+1,this.images[j]=de,this.updatedImages[j]=!0},V.prototype.removeImage=function(j){var de=this.images[j];delete this.images[j],delete this.patterns[j],de.userImage&&de.userImage.onRemove&&de.userImage.onRemove()},V.prototype.listImages=function(){return Object.keys(this.images)},V.prototype.getImages=function(j,de){var Me=!0;if(!this.isLoaded())for(var Ce=0,Ze=j;Ce<Ze.length;Ce+=1){var ut=Ze[Ce];this.images[ut]||(Me=!1)}this.isLoaded()||Me?this._notify(j,de):this.requestors.push({ids:j,callback:de})},V.prototype._notify=function(j,de){for(var Me={},Ce=0,Ze=j;Ce<Ze.length;Ce+=1){var ut=Ze[Ce];this.images[ut]||this.fire(new e.Event("styleimagemissing",{id:ut}));var St=this.images[ut];St?Me[ut]={data:St.data.clone(),pixelRatio:St.pixelRatio,sdf:St.sdf,version:St.version,stretchX:St.stretchX,stretchY:St.stretchY,content:St.content,hasRenderCallback:Boolean(St.userImage&&St.userImage.render)}:e.warnOnce('Image "'+ut+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}de(null,Me)},V.prototype.getPixelSize=function(){var j=this.atlasImage,de=j.width,Me=j.height;return{width:de,height:Me}},V.prototype.getPattern=function(j){var de=this.patterns[j],Me=this.getImage(j);if(!Me)return null;if(de&&de.position.version===Me.version)return de.position;if(de)de.position.version=Me.version;else{var Ce=Me.data.width+u*2,Ze=Me.data.height+u*2,ut={w:Ce,h:Ze,x:0,y:0},St=new e.ImagePosition(ut,Me);this.patterns[j]={bin:ut,position:St}}return this._updatePatternAtlas(),this.patterns[j].position},V.prototype.bind=function(j){var de=j.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new e.Texture(j,this.atlasImage,de.RGBA),this.atlasTexture.bind(de.LINEAR,de.CLAMP_TO_EDGE)},V.prototype._updatePatternAtlas=function(){var j=[];for(var de in this.patterns)j.push(this.patterns[de].bin);var Me=e.potpack(j),Ce=Me.w,Ze=Me.h,ut=this.atlasImage;ut.resize({width:Ce||1,height:Ze||1});for(var St in this.patterns){var jt=this.patterns[St],lr=jt.bin,vr=lr.x+u,Er=lr.y+u,Vr=this.images[St].data,Gr=Vr.width,Ur=Vr.height;e.RGBAImage.copy(Vr,ut,{x:0,y:0},{x:vr,y:Er},{width:Gr,height:Ur}),e.RGBAImage.copy(Vr,ut,{x:0,y:Ur-1},{x:vr,y:Er-1},{width:Gr,height:1}),e.RGBAImage.copy(Vr,ut,{x:0,y:0},{x:vr,y:Er+Ur},{width:Gr,height:1}),e.RGBAImage.copy(Vr,ut,{x:Gr-1,y:0},{x:vr-1,y:Er},{width:1,height:Ur}),e.RGBAImage.copy(Vr,ut,{x:0,y:0},{x:vr+Gr,y:Er},{width:1,height:Ur})}this.dirty=!0},V.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},V.prototype.dispatchRenderCallbacks=function(j){for(var de=0,Me=j;de<Me.length;de+=1){var Ce=Me[de];if(!this.callbackDispatchedThisFrame[Ce]){this.callbackDispatchedThisFrame[Ce]=!0;var Ze=this.images[Ce],ut=m(Ze);ut&&this.updateImage(Ce,Ze)}}},V}(e.Evented);function s(ce,V,ve,j,de){var Me=V*256,Ce=Me+255,Ze=j.transformRequest(j.normalizeGlyphsURL(ve).replace("{fontstack}",ce).replace("{range}",Me+"-"+Ce),e.ResourceType.Glyphs);e.getArrayBuffer(Ze,function(ut,St){if(ut)de(ut);else if(St){for(var jt={},lr=0,vr=e.parseGlyphPBF(St);lr<vr.length;lr+=1){var Er=vr[lr];jt[Er.id]=Er}de(null,jt)}})}var A=x,b=x,f=1e20;function x(ce,V,ve,j,de,Me){this.fontSize=ce||24,this.buffer=V===void 0?3:V,this.cutoff=j||.25,this.fontFamily=de||"sans-serif",this.fontWeight=Me||"normal",this.radius=ve||8;var Ce=this.size=this.fontSize+this.buffer*2;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=Ce,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(Ce*Ce),this.gridInner=new Float64Array(Ce*Ce),this.f=new Float64Array(Ce),this.d=new Float64Array(Ce),this.z=new Float64Array(Ce+1),this.v=new Int16Array(Ce),this.middle=Math.round(Ce/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}x.prototype.draw=function(ce){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(ce,this.buffer,this.middle);for(var V=this.ctx.getImageData(0,0,this.size,this.size),ve=new Uint8ClampedArray(this.size*this.size),j=0;j<this.size*this.size;j++){var de=V.data[j*4+3]/255;this.gridOuter[j]=de===1?0:de===0?f:Math.pow(Math.max(0,.5-de),2),this.gridInner[j]=de===1?f:de===0?0:Math.pow(Math.max(0,de-.5),2)}for(l(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),l(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),j=0;j<this.size*this.size;j++){var Me=this.gridOuter[j]-this.gridInner[j];ve[j]=Math.max(0,Math.min(255,Math.round(255-255*(Me/this.radius+this.cutoff))))}return ve};function l(ce,V,ve,j,de,Me,Ce){for(var Ze=0;Ze<V;Ze++){for(var ut=0;ut<ve;ut++)j[ut]=ce[ut*V+Ze];for(L(j,de,Me,Ce,ve),ut=0;ut<ve;ut++)ce[ut*V+Ze]=de[ut]}for(ut=0;ut<ve;ut++){for(Ze=0;Ze<V;Ze++)j[Ze]=ce[ut*V+Ze];for(L(j,de,Me,Ce,V),Ze=0;Ze<V;Ze++)ce[ut*V+Ze]=Math.sqrt(de[Ze])}}function L(ce,V,ve,j,de){ve[0]=0,j[0]=-f,j[1]=+f;for(var Me=1,Ce=0;Me<de;Me++){for(var Ze=(ce[Me]+Me*Me-(ce[ve[Ce]]+ve[Ce]*ve[Ce]))/(2*Me-2*ve[Ce]);Ze<=j[Ce];)Ce--,Ze=(ce[Me]+Me*Me-(ce[ve[Ce]]+ve[Ce]*ve[Ce]))/(2*Me-2*ve[Ce]);Ce++,ve[Ce]=Me,j[Ce]=Ze,j[Ce+1]=+f}for(Me=0,Ce=0;Me<de;Me++){for(;j[Ce+1]<Me;)Ce++;V[Me]=(Me-ve[Ce])*(Me-ve[Ce])+ce[ve[Ce]]}}A.default=b;var T=function(V,ve){this.requestManager=V,this.localIdeographFontFamily=ve,this.entries={}};T.prototype.setURL=function(V){this.url=V},T.prototype.getGlyphs=function(V,ve){var j=this,de=[];for(var Me in V)for(var Ce=0,Ze=V[Me];Ce<Ze.length;Ce+=1){var ut=Ze[Ce];de.push({stack:Me,id:ut})}e.asyncAll(de,function(St,jt){var lr=St.stack,vr=St.id,Er=j.entries[lr];Er||(Er=j.entries[lr]={glyphs:{},requests:{},ranges:{}});var Vr=Er.glyphs[vr];if(Vr!==void 0){jt(null,{stack:lr,id:vr,glyph:Vr});return}if(Vr=j._tinySDF(Er,lr,vr),Vr){Er.glyphs[vr]=Vr,jt(null,{stack:lr,id:vr,glyph:Vr});return}var Gr=Math.floor(vr/256);if(Gr*256>65535){jt(new Error("glyphs > 65535 not supported"));return}if(Er.ranges[Gr]){jt(null,{stack:lr,id:vr,glyph:Vr});return}var Ur=Er.requests[Gr];Ur||(Ur=Er.requests[Gr]=[],T.loadGlyphRange(lr,Gr,j.url,j.requestManager,function(Kr,cn){if(cn){for(var En in cn)j._doesCharSupportLocalGlyph(+En)||(Er.glyphs[+En]=cn[+En]);Er.ranges[Gr]=!0}for(var Fn=0,Kn=Ur;Fn<Kn.length;Fn+=1){var qn=Kn[Fn];qn(Kr,cn)}delete Er.requests[Gr]})),Ur.push(function(Kr,cn){Kr?jt(Kr):cn&&jt(null,{stack:lr,id:vr,glyph:cn[vr]||null})})},function(St,jt){if(St)ve(St);else if(jt){for(var lr={},vr=0,Er=jt;vr<Er.length;vr+=1){var Vr=Er[vr],Gr=Vr.stack,Ur=Vr.id,Kr=Vr.glyph;(lr[Gr]||(lr[Gr]={}))[Ur]=Kr&&{id:Kr.id,bitmap:Kr.bitmap.clone(),metrics:Kr.metrics}}ve(null,lr)}})},T.prototype._doesCharSupportLocalGlyph=function(V){return!!this.localIdeographFontFamily&&(e.isChar["CJK Unified Ideographs"](V)||e.isChar["Hangul Syllables"](V)||e.isChar.Hiragana(V)||e.isChar.Katakana(V))},T.prototype._tinySDF=function(V,ve,j){var de=this.localIdeographFontFamily;if(!!de&&!!this._doesCharSupportLocalGlyph(j)){var Me=V.tinySDF;if(!Me){var Ce="400";/bold/i.test(ve)?Ce="900":/medium/i.test(ve)?Ce="500":/light/i.test(ve)&&(Ce="200"),Me=V.tinySDF=new T.TinySDF(24,3,8,.25,de,Ce)}return{id:j,bitmap:new e.AlphaImage({width:30,height:30},Me.draw(String.fromCharCode(j))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},T.loadGlyphRange=s,T.TinySDF=A;var k=function(){this.specification=e.styleSpec.light.position};k.prototype.possiblyEvaluate=function(V,ve){return e.sphericalToCartesian(V.expression.evaluate(ve))},k.prototype.interpolate=function(V,ve,j){return{x:e.number(V.x,ve.x,j),y:e.number(V.y,ve.y,j),z:e.number(V.z,ve.z,j)}};var P=new e.Properties({anchor:new e.DataConstantProperty(e.styleSpec.light.anchor),position:new k,color:new e.DataConstantProperty(e.styleSpec.light.color),intensity:new e.DataConstantProperty(e.styleSpec.light.intensity)}),z="-transition",I=function(ce){function V(ve){ce.call(this),this._transitionable=new e.Transitionable(P),this.setLight(ve),this._transitioning=this._transitionable.untransitioned()}return ce&&(V.__proto__=ce),V.prototype=Object.create(ce&&ce.prototype),V.prototype.constructor=V,V.prototype.getLight=function(){return this._transitionable.serialize()},V.prototype.setLight=function(j,de){if(de===void 0&&(de={}),!this._validate(e.validateLight,j,de))for(var Me in j){var Ce=j[Me];e.endsWith(Me,z)?this._transitionable.setTransition(Me.slice(0,-z.length),Ce):this._transitionable.setValue(Me,Ce)}},V.prototype.updateTransitions=function(j){this._transitioning=this._transitionable.transitioned(j,this._transitioning)},V.prototype.hasTransition=function(){return this._transitioning.hasTransition()},V.prototype.recalculate=function(j){this.properties=this._transitioning.possiblyEvaluate(j)},V.prototype._validate=function(j,de,Me){return Me&&Me.validate===!1?!1:e.emitValidationErrors(this,j.call(e.validateStyle,e.extend({value:de,style:{glyphs:!0,sprite:!0},styleSpec:e.styleSpec})))},V}(e.Evented),D=function(V,ve){this.width=V,this.height=ve,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};D.prototype.getDash=function(V,ve){var j=V.join(",")+String(ve);return this.dashEntry[j]||(this.dashEntry[j]=this.addDash(V,ve)),this.dashEntry[j]},D.prototype.getDashRanges=function(V,ve,j){var de=V.length%2===1,Me=[],Ce=de?-V[V.length-1]*j:0,Ze=V[0]*j,ut=!0;Me.push({left:Ce,right:Ze,isDash:ut,zeroLength:V[0]===0});for(var St=V[0],jt=1;jt<V.length;jt++){ut=!ut;var lr=V[jt];Ce=St*j,St+=lr,Ze=St*j,Me.push({left:Ce,right:Ze,isDash:ut,zeroLength:lr===0})}return Me},D.prototype.addRoundDash=function(V,ve,j){for(var de=ve/2,Me=-j;Me<=j;Me++)for(var Ce=this.nextRow+j+Me,Ze=this.width*Ce,ut=0,St=V[ut],jt=0;jt<this.width;jt++){jt/St.right>1&&(St=V[++ut]);var lr=Math.abs(jt-St.left),vr=Math.abs(jt-St.right),Er=Math.min(lr,vr),Vr=void 0,Gr=Me/j*(de+1);if(St.isDash){var Ur=de-Math.abs(Gr);Vr=Math.sqrt(Er*Er+Ur*Ur)}else Vr=de-Math.sqrt(Er*Er+Gr*Gr);this.data[Ze+jt]=Math.max(0,Math.min(255,Vr+128))}},D.prototype.addRegularDash=function(V){for(var ve=V.length-1;ve>=0;--ve){var j=V[ve],de=V[ve+1];j.zeroLength?V.splice(ve,1):de&&de.isDash===j.isDash&&(de.left=j.left,V.splice(ve,1))}var Me=V[0],Ce=V[V.length-1];Me.isDash===Ce.isDash&&(Me.left=Ce.left-this.width,Ce.right=Me.right+this.width);for(var Ze=this.width*this.nextRow,ut=0,St=V[ut],jt=0;jt<this.width;jt++){jt/St.right>1&&(St=V[++ut]);var lr=Math.abs(jt-St.left),vr=Math.abs(jt-St.right),Er=Math.min(lr,vr),Vr=St.isDash?Er:-Er;this.data[Ze+jt]=Math.max(0,Math.min(255,Vr+128))}},D.prototype.addDash=function(V,ve){var j=ve?7:0,de=2*j+1;if(this.nextRow+de>this.height)return e.warnOnce("LineAtlas out of space"),null;for(var Me=0,Ce=0;Ce<V.length;Ce++)Me+=V[Ce];if(Me!==0){var Ze=this.width/Me,ut=this.getDashRanges(V,this.width,Ze);ve?this.addRoundDash(ut,Ze,j):this.addRegularDash(ut)}var St={y:(this.nextRow+j+.5)/this.height,height:2*j/this.height,width:Me};return this.nextRow+=de,this.dirty=!0,St},D.prototype.bind=function(V){var ve=V.gl;this.texture?(ve.bindTexture(ve.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,ve.texSubImage2D(ve.TEXTURE_2D,0,0,0,this.width,this.height,ve.ALPHA,ve.UNSIGNED_BYTE,this.data))):(this.texture=ve.createTexture(),ve.bindTexture(ve.TEXTURE_2D,this.texture),ve.texParameteri(ve.TEXTURE_2D,ve.TEXTURE_WRAP_S,ve.REPEAT),ve.texParameteri(ve.TEXTURE_2D,ve.TEXTURE_WRAP_T,ve.REPEAT),ve.texParameteri(ve.TEXTURE_2D,ve.TEXTURE_MIN_FILTER,ve.LINEAR),ve.texParameteri(ve.TEXTURE_2D,ve.TEXTURE_MAG_FILTER,ve.LINEAR),ve.texImage2D(ve.TEXTURE_2D,0,ve.ALPHA,this.width,this.height,0,ve.ALPHA,ve.UNSIGNED_BYTE,this.data))};var R=function ce(V,ve){this.workerPool=V,this.actors=[],this.currentActor=0,this.id=e.uniqueId();for(var j=this.workerPool.acquire(this.id),de=0;de<j.length;de++){var Me=j[de],Ce=new ce.Actor(Me,ve,this.id);Ce.name="Worker "+de,this.actors.push(Ce)}};R.prototype.broadcast=function(V,ve,j){j=j||function(){},e.asyncAll(this.actors,function(de,Me){de.send(V,ve,Me)},j)},R.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},R.prototype.remove=function(){this.actors.forEach(function(V){V.remove()}),this.actors=[],this.workerPool.release(this.id)},R.Actor=e.Actor;function B(ce,V,ve){var j=function(de,Me){if(de)return ve(de);if(Me){var Ce=e.pick(e.extend(Me,ce),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);Me.vector_layers&&(Ce.vectorLayers=Me.vector_layers,Ce.vectorLayerIds=Ce.vectorLayers.map(function(Ze){return Ze.id})),Ce.tiles=V.canonicalizeTileset(Ce,ce.url),ve(null,Ce)}};return ce.url?e.getJSON(V.transformRequest(V.normalizeSourceURL(ce.url),e.ResourceType.Source),j):e.browser.frame(function(){return j(null,ce)})}var F=function(V,ve,j){this.bounds=e.LngLatBounds.convert(this.validateBounds(V)),this.minzoom=ve||0,this.maxzoom=j||24};F.prototype.validateBounds=function(V){return!Array.isArray(V)||V.length!==4?[-180,-90,180,90]:[Math.max(-180,V[0]),Math.max(-90,V[1]),Math.min(180,V[2]),Math.min(90,V[3])]},F.prototype.contains=function(V){var ve=Math.pow(2,V.z),j={minX:Math.floor(e.mercatorXfromLng(this.bounds.getWest())*ve),minY:Math.floor(e.mercatorYfromLat(this.bounds.getNorth())*ve),maxX:Math.ceil(e.mercatorXfromLng(this.bounds.getEast())*ve),maxY:Math.ceil(e.mercatorYfromLat(this.bounds.getSouth())*ve)},de=V.x>=j.minX&&V.x<j.maxX&&V.y>=j.minY&&V.y<j.maxY;return de};var H=function(ce){function V(ve,j,de,Me){if(ce.call(this),this.id=ve,this.dispatcher=de,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,e.extend(this,e.pick(j,["url","scheme","tileSize","promoteId"])),this._options=e.extend({type:"vector"},j),this._collectResourceTiming=j.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(Me)}return ce&&(V.__proto__=ce),V.prototype=Object.create(ce&&ce.prototype),V.prototype.constructor=V,V.prototype.load=function(){var j=this;this._loaded=!1,this.fire(new e.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=B(this._options,this.map._requestManager,function(de,Me){j._tileJSONRequest=null,j._loaded=!0,de?j.fire(new e.ErrorEvent(de)):Me&&(e.extend(j,Me),Me.bounds&&(j.tileBounds=new F(Me.bounds,j.minzoom,j.maxzoom)),e.postTurnstileEvent(Me.tiles,j.map._requestManager._customAccessToken),e.postMapLoadEvent(Me.tiles,j.map._getMapId(),j.map._requestManager._skuToken,j.map._requestManager._customAccessToken),j.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"})),j.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"})))})},V.prototype.loaded=function(){return this._loaded},V.prototype.hasTile=function(j){return!this.tileBounds||this.tileBounds.contains(j.canonical)},V.prototype.onAdd=function(j){this.map=j,this.load()},V.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},V.prototype.serialize=function(){return e.extend({},this._options)},V.prototype.loadTile=function(j,de){var Me=this.map._requestManager.normalizeTileURL(j.tileID.canonical.url(this.tiles,this.scheme)),Ce={request:this.map._requestManager.transformRequest(Me,e.ResourceType.Tile),uid:j.uid,tileID:j.tileID,zoom:j.tileID.overscaledZ,tileSize:this.tileSize*j.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:e.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};Ce.request.collectResourceTiming=this._collectResourceTiming,!j.actor||j.state==="expired"?(j.actor=this.dispatcher.getActor(),j.request=j.actor.send("loadTile",Ce,Ze.bind(this))):j.state==="loading"?j.reloadCallback=de:j.request=j.actor.send("reloadTile",Ce,Ze.bind(this));function Ze(ut,St){if(delete j.request,j.aborted)return de(null);if(ut&&ut.status!==404)return de(ut);St&&St.resourceTiming&&(j.resourceTiming=St.resourceTiming),this.map._refreshExpiredTiles&&St&&j.setExpiryData(St),j.loadVectorData(St,this.map.painter),e.cacheEntryPossiblyAdded(this.dispatcher),de(null),j.reloadCallback&&(this.loadTile(j,j.reloadCallback),j.reloadCallback=null)}},V.prototype.abortTile=function(j){j.request&&(j.request.cancel(),delete j.request),j.actor&&j.actor.send("abortTile",{uid:j.uid,type:this.type,source:this.id},void 0)},V.prototype.unloadTile=function(j){j.unloadVectorData(),j.actor&&j.actor.send("removeTile",{uid:j.uid,type:this.type,source:this.id},void 0)},V.prototype.hasTransition=function(){return!1},V}(e.Evented),G=function(ce){function V(ve,j,de,Me){ce.call(this),this.id=ve,this.dispatcher=de,this.setEventedParent(Me),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=e.extend({type:"raster"},j),e.extend(this,e.pick(j,["url","scheme","tileSize"]))}return ce&&(V.__proto__=ce),V.prototype=Object.create(ce&&ce.prototype),V.prototype.constructor=V,V.prototype.load=function(){var j=this;this._loaded=!1,this.fire(new e.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=B(this._options,this.map._requestManager,function(de,Me){j._tileJSONRequest=null,j._loaded=!0,de?j.fire(new e.ErrorEvent(de)):Me&&(e.extend(j,Me),Me.bounds&&(j.tileBounds=new F(Me.bounds,j.minzoom,j.maxzoom)),e.postTurnstileEvent(Me.tiles),e.postMapLoadEvent(Me.tiles,j.map._getMapId(),j.map._requestManager._skuToken),j.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"})),j.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"})))})},V.prototype.loaded=function(){return this._loaded},V.prototype.onAdd=function(j){this.map=j,this.load()},V.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},V.prototype.serialize=function(){return e.extend({},this._options)},V.prototype.hasTile=function(j){return!this.tileBounds||this.tileBounds.contains(j.canonical)},V.prototype.loadTile=function(j,de){var Me=this,Ce=this.map._requestManager.normalizeTileURL(j.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);j.request=e.getImage(this.map._requestManager.transformRequest(Ce,e.ResourceType.Tile),function(Ze,ut){if(delete j.request,j.aborted)j.state="unloaded",de(null);else if(Ze)j.state="errored",de(Ze);else if(ut){Me.map._refreshExpiredTiles&&j.setExpiryData(ut),delete ut.cacheControl,delete ut.expires;var St=Me.map.painter.context,jt=St.gl;j.texture=Me.map.painter.getTileTexture(ut.width),j.texture?j.texture.update(ut,{useMipmap:!0}):(j.texture=new e.Texture(St,ut,jt.RGBA,{useMipmap:!0}),j.texture.bind(jt.LINEAR,jt.CLAMP_TO_EDGE,jt.LINEAR_MIPMAP_NEAREST),St.extTextureFilterAnisotropic&&jt.texParameterf(jt.TEXTURE_2D,St.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,St.extTextureFilterAnisotropicMax)),j.state="loaded",e.cacheEntryPossiblyAdded(Me.dispatcher),de(null)}})},V.prototype.abortTile=function(j,de){j.request&&(j.request.cancel(),delete j.request),de()},V.prototype.unloadTile=function(j,de){j.texture&&this.map.painter.saveTileTexture(j.texture),de()},V.prototype.hasTransition=function(){return!1},V}(e.Evented),J=function(ce){function V(ve,j,de,Me){ce.call(this,ve,j,de,Me),this.type="raster-dem",this.maxzoom=22,this._options=e.extend({type:"raster-dem"},j),this.encoding=j.encoding||"mapbox"}return ce&&(V.__proto__=ce),V.prototype=Object.create(ce&&ce.prototype),V.prototype.constructor=V,V.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},V.prototype.loadTile=function(j,de){var Me=this.map._requestManager.normalizeTileURL(j.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);j.request=e.getImage(this.map._requestManager.transformRequest(Me,e.ResourceType.Tile),Ce.bind(this)),j.neighboringTiles=this._getNeighboringTiles(j.tileID);function Ce(ut,St){if(delete j.request,j.aborted)j.state="unloaded",de(null);else if(ut)j.state="errored",de(ut);else if(St){this.map._refreshExpiredTiles&&j.setExpiryData(St),delete St.cacheControl,delete St.expires;var jt=e.window.ImageBitmap&&St instanceof e.window.ImageBitmap&&e.offscreenCanvasSupported(),lr=jt?St:e.browser.getImageData(St,1),vr={uid:j.uid,coord:j.tileID,source:this.id,rawImageData:lr,encoding:this.encoding};(!j.actor||j.state==="expired")&&(j.actor=this.dispatcher.getActor(),j.actor.send("loadDEMTile",vr,Ze.bind(this)))}}function Ze(ut,St){ut&&(j.state="errored",de(ut)),St&&(j.dem=St,j.needsHillshadePrepare=!0,j.state="loaded",de(null))}},V.prototype._getNeighboringTiles=function(j){var de=j.canonical,Me=Math.pow(2,de.z),Ce=(de.x-1+Me)%Me,Ze=de.x===0?j.wrap-1:j.wrap,ut=(de.x+1+Me)%Me,St=de.x+1===Me?j.wrap+1:j.wrap,jt={};return jt[new e.OverscaledTileID(j.overscaledZ,Ze,de.z,Ce,de.y).key]={backfilled:!1},jt[new e.OverscaledTileID(j.overscaledZ,St,de.z,ut,de.y).key]={backfilled:!1},de.y>0&&(jt[new e.OverscaledTileID(j.overscaledZ,Ze,de.z,Ce,de.y-1).key]={backfilled:!1},jt[new e.OverscaledTileID(j.overscaledZ,j.wrap,de.z,de.x,de.y-1).key]={backfilled:!1},jt[new e.OverscaledTileID(j.overscaledZ,St,de.z,ut,de.y-1).key]={backfilled:!1}),de.y+1<Me&&(jt[new e.OverscaledTileID(j.overscaledZ,Ze,de.z,Ce,de.y+1).key]={backfilled:!1},jt[new e.OverscaledTileID(j.overscaledZ,j.wrap,de.z,de.x,de.y+1).key]={backfilled:!1},jt[new e.OverscaledTileID(j.overscaledZ,St,de.z,ut,de.y+1).key]={backfilled:!1}),jt},V.prototype.unloadTile=function(j){j.demTexture&&this.map.painter.saveTileTexture(j.demTexture),j.fbo&&(j.fbo.destroy(),delete j.fbo),j.dem&&delete j.dem,delete j.neighboringTiles,j.state="unloaded",j.actor&&j.actor.send("removeDEMTile",{uid:j.uid,source:this.id})},V}(G),X=function(ce){function V(ve,j,de,Me){ce.call(this),this.id=ve,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=de.getActor(),this.setEventedParent(Me),this._data=j.data,this._options=e.extend({},j),this._collectResourceTiming=j.collectResourceTiming,this._resourceTiming=[],j.maxzoom!==void 0&&(this.maxzoom=j.maxzoom),j.type&&(this.type=j.type),j.attribution&&(this.attribution=j.attribution),this.promoteId=j.promoteId;var Ce=e.EXTENT/this.tileSize;this.workerOptions=e.extend({source:this.id,cluster:j.cluster||!1,geojsonVtOptions:{buffer:(j.buffer!==void 0?j.buffer:128)*Ce,tolerance:(j.tolerance!==void 0?j.tolerance:.375)*Ce,extent:e.EXTENT,maxZoom:this.maxzoom,lineMetrics:j.lineMetrics||!1,generateId:j.generateId||!1},superclusterOptions:{maxZoom:j.clusterMaxZoom!==void 0?Math.min(j.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,extent:e.EXTENT,radius:(j.clusterRadius||50)*Ce,log:!1,generateId:j.generateId||!1},clusterProperties:j.clusterProperties},j.workerOptions)}return ce&&(V.__proto__=ce),V.prototype=Object.create(ce&&ce.prototype),V.prototype.constructor=V,V.prototype.load=function(){var j=this;this.fire(new e.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(de){if(de){j.fire(new e.ErrorEvent(de));return}var Me={dataType:"source",sourceDataType:"metadata"};j._collectResourceTiming&&j._resourceTiming&&j._resourceTiming.length>0&&(Me.resourceTiming=j._resourceTiming,j._resourceTiming=[]),j.fire(new e.Event("data",Me))})},V.prototype.onAdd=function(j){this.map=j,this.load()},V.prototype.setData=function(j){var de=this;return this._data=j,this.fire(new e.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(Me){if(Me){de.fire(new e.ErrorEvent(Me));return}var Ce={dataType:"source",sourceDataType:"content"};de._collectResourceTiming&&de._resourceTiming&&de._resourceTiming.length>0&&(Ce.resourceTiming=de._resourceTiming,de._resourceTiming=[]),de.fire(new e.Event("data",Ce))}),this},V.prototype.getClusterExpansionZoom=function(j,de){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:j,source:this.id},de),this},V.prototype.getClusterChildren=function(j,de){return this.actor.send("geojson.getClusterChildren",{clusterId:j,source:this.id},de),this},V.prototype.getClusterLeaves=function(j,de,Me,Ce){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:j,limit:de,offset:Me},Ce),this},V.prototype._updateWorkerData=function(j){var de=this;this._loaded=!1;var Me=e.extend({},this.workerOptions),Ce=this._data;typeof Ce=="string"?(Me.request=this.map._requestManager.transformRequest(e.browser.resolveURL(Ce),e.ResourceType.Source),Me.request.collectResourceTiming=this._collectResourceTiming):Me.data=JSON.stringify(Ce),this.actor.send(this.type+".loadData",Me,function(Ze,ut){de._removed||ut&&ut.abandoned||(de._loaded=!0,ut&&ut.resourceTiming&&ut.resourceTiming[de.id]&&(de._resourceTiming=ut.resourceTiming[de.id].slice(0)),de.actor.send(de.type+".coalesce",{source:Me.source},null),j(Ze))})},V.prototype.loaded=function(){return this._loaded},V.prototype.loadTile=function(j,de){var Me=this,Ce=j.actor?"reloadTile":"loadTile";j.actor=this.actor;var Ze={type:this.type,uid:j.uid,tileID:j.tileID,zoom:j.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:e.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};j.request=this.actor.send(Ce,Ze,function(ut,St){return delete j.request,j.unloadVectorData(),j.aborted?de(null):ut?de(ut):(j.loadVectorData(St,Me.map.painter,Ce==="reloadTile"),de(null))})},V.prototype.abortTile=function(j){j.request&&(j.request.cancel(),delete j.request),j.aborted=!0},V.prototype.unloadTile=function(j){j.unloadVectorData(),this.actor.send("removeTile",{uid:j.uid,type:this.type,source:this.id})},V.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},V.prototype.serialize=function(){return e.extend({},this._options,{type:this.type,data:this._data})},V.prototype.hasTransition=function(){return!1},V}(e.Evented),Y=e.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),Z=function(ce){function V(ve,j,de,Me){ce.call(this),this.id=ve,this.dispatcher=de,this.coordinates=j.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(Me),this.options=j}return ce&&(V.__proto__=ce),V.prototype=Object.create(ce&&ce.prototype),V.prototype.constructor=V,V.prototype.load=function(j,de){var Me=this;this._loaded=!1,this.fire(new e.Event("dataloading",{dataType:"source"})),this.url=this.options.url,e.getImage(this.map._requestManager.transformRequest(this.url,e.ResourceType.Image),function(Ce,Ze){Me._loaded=!0,Ce?Me.fire(new e.ErrorEvent(Ce)):Ze&&(Me.image=Ze,j&&(Me.coordinates=j),de&&de(),Me._finishLoading())})},V.prototype.loaded=function(){return this._loaded},V.prototype.updateImage=function(j){var de=this;return!this.image||!j.url?this:(this.options.url=j.url,this.load(j.coordinates,function(){de.texture=null}),this)},V.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"})))},V.prototype.onAdd=function(j){this.map=j,this.load()},V.prototype.setCoordinates=function(j){var de=this;this.coordinates=j;var Me=j.map(e.MercatorCoordinate.fromLngLat);this.tileID=oe(Me),this.minzoom=this.maxzoom=this.tileID.z;var Ce=Me.map(function(Ze){return de.tileID.getTilePoint(Ze)._round()});return this._boundsArray=new e.StructArrayLayout4i8,this._boundsArray.emplaceBack(Ce[0].x,Ce[0].y,0,0),this._boundsArray.emplaceBack(Ce[1].x,Ce[1].y,e.EXTENT,0),this._boundsArray.emplaceBack(Ce[3].x,Ce[3].y,0,e.EXTENT),this._boundsArray.emplaceBack(Ce[2].x,Ce[2].y,e.EXTENT,e.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"})),this},V.prototype.prepare=function(){if(!(Object.keys(this.tiles).length===0||!this.image)){var j=this.map.painter.context,de=j.gl;this.boundsBuffer||(this.boundsBuffer=j.createVertexBuffer(this._boundsArray,Y.members)),this.boundsSegments||(this.boundsSegments=e.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new e.Texture(j,this.image,de.RGBA),this.texture.bind(de.LINEAR,de.CLAMP_TO_EDGE));for(var Me in this.tiles){var Ce=this.tiles[Me];Ce.state!=="loaded"&&(Ce.state="loaded",Ce.texture=this.texture)}}},V.prototype.loadTile=function(j,de){this.tileID&&this.tileID.equals(j.tileID.canonical)?(this.tiles[String(j.tileID.wrap)]=j,j.buckets={},de(null)):(j.state="errored",de(null))},V.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},V.prototype.hasTransition=function(){return!1},V}(e.Evented);function oe(ce){for(var V=1/0,ve=1/0,j=-1/0,de=-1/0,Me=0,Ce=ce;Me<Ce.length;Me+=1){var Ze=Ce[Me];V=Math.min(V,Ze.x),ve=Math.min(ve,Ze.y),j=Math.max(j,Ze.x),de=Math.max(de,Ze.y)}var ut=j-V,St=de-ve,jt=Math.max(ut,St),lr=Math.max(0,Math.floor(-Math.log(jt)/Math.LN2)),vr=Math.pow(2,lr);return new e.CanonicalTileID(lr,Math.floor((V+j)/2*vr),Math.floor((ve+de)/2*vr))}var re=function(ce){function V(ve,j,de,Me){ce.call(this,ve,j,de,Me),this.roundZoom=!0,this.type="video",this.options=j}return ce&&(V.__proto__=ce),V.prototype=Object.create(ce&&ce.prototype),V.prototype.constructor=V,V.prototype.load=function(){var j=this;this._loaded=!1;var de=this.options;this.urls=[];for(var Me=0,Ce=de.urls;Me<Ce.length;Me+=1){var Ze=Ce[Me];this.urls.push(this.map._requestManager.transformRequest(Ze,e.ResourceType.Source).url)}e.getVideo(this.urls,function(ut,St){j._loaded=!0,ut?j.fire(new e.ErrorEvent(ut)):St&&(j.video=St,j.video.loop=!0,j.video.addEventListener("playing",function(){j.map.triggerRepaint()}),j.map&&j.video.play(),j._finishLoading())})},V.prototype.pause=function(){this.video&&this.video.pause()},V.prototype.play=function(){this.video&&this.video.play()},V.prototype.seek=function(j){if(this.video){var de=this.video.seekable;j<de.start(0)||j>de.end(0)?this.fire(new e.ErrorEvent(new e.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+de.start(0)+" and "+de.end(0)+"-second mark."))):this.video.currentTime=j}},V.prototype.getVideo=function(){return this.video},V.prototype.onAdd=function(j){this.map||(this.map=j,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},V.prototype.prepare=function(){if(!(Object.keys(this.tiles).length===0||this.video.readyState<2)){var j=this.map.painter.context,de=j.gl;this.boundsBuffer||(this.boundsBuffer=j.createVertexBuffer(this._boundsArray,Y.members)),this.boundsSegments||(this.boundsSegments=e.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(de.LINEAR,de.CLAMP_TO_EDGE),de.texSubImage2D(de.TEXTURE_2D,0,0,0,de.RGBA,de.UNSIGNED_BYTE,this.video)):(this.texture=new e.Texture(j,this.video,de.RGBA),this.texture.bind(de.LINEAR,de.CLAMP_TO_EDGE));for(var Me in this.tiles){var Ce=this.tiles[Me];Ce.state!=="loaded"&&(Ce.state="loaded",Ce.texture=this.texture)}}},V.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},V.prototype.hasTransition=function(){return this.video&&!this.video.paused},V}(Z),se=function(ce){function V(ve,j,de,Me){ce.call(this,ve,j,de,Me),j.coordinates?(!Array.isArray(j.coordinates)||j.coordinates.length!==4||j.coordinates.some(function(Ce){return!Array.isArray(Ce)||Ce.length!==2||Ce.some(function(Ze){return typeof Ze!="number"})}))&&this.fire(new e.ErrorEvent(new e.ValidationError("sources."+ve,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new e.ErrorEvent(new e.ValidationError("sources."+ve,null,'missing required property "coordinates"'))),j.animate&&typeof j.animate!="boolean"&&this.fire(new e.ErrorEvent(new e.ValidationError("sources."+ve,null,'optional "animate" property must be a boolean value'))),j.canvas?typeof j.canvas!="string"&&!(j.canvas instanceof e.window.HTMLCanvasElement)&&this.fire(new e.ErrorEvent(new e.ValidationError("sources."+ve,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new e.ErrorEvent(new e.ValidationError("sources."+ve,null,'missing required property "canvas"'))),this.options=j,this.animate=j.animate!==void 0?j.animate:!0}return ce&&(V.__proto__=ce),V.prototype=Object.create(ce&&ce.prototype),V.prototype.constructor=V,V.prototype.load=function(){if(this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof e.window.HTMLCanvasElement?this.options.canvas:e.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()){this.fire(new e.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero.")));return}this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading()},V.prototype.getCanvas=function(){return this.canvas},V.prototype.onAdd=function(j){this.map=j,this.load(),this.canvas&&this.animate&&this.play()},V.prototype.onRemove=function(){this.pause()},V.prototype.prepare=function(){var j=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,j=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,j=!0),!this._hasInvalidDimensions()&&Object.keys(this.tiles).length!==0){var de=this.map.painter.context,Me=de.gl;this.boundsBuffer||(this.boundsBuffer=de.createVertexBuffer(this._boundsArray,Y.members)),this.boundsSegments||(this.boundsSegments=e.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(j||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new e.Texture(de,this.canvas,Me.RGBA,{premultiply:!0});for(var Ce in this.tiles){var Ze=this.tiles[Ce];Ze.state!=="loaded"&&(Ze.state="loaded",Ze.texture=this.texture)}}},V.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},V.prototype.hasTransition=function(){return this._playing},V.prototype._hasInvalidDimensions=function(){for(var j=0,de=[this.canvas.width,this.canvas.height];j<de.length;j+=1){var Me=de[j];if(isNaN(Me)||Me<=0)return!0}return!1},V}(Z),N={vector:H,raster:G,"raster-dem":J,geojson:X,video:re,image:Z,canvas:se},U=function(ce,V,ve,j){var de=new N[V.type](ce,V,ve,j);if(de.id!==ce)throw new Error("Expected Source id to be "+ce+" instead of "+de.id);return e.bindAll(["load","abort","unload","serialize","prepare"],de),de},q=function(ce){return N[ce]},$=function(ce,V){N[ce]=V};function W(ce,V){var ve=e.identity([]);return e.translate(ve,ve,[1,1,0]),e.scale(ve,ve,[ce.width*.5,ce.height*.5,1]),e.multiply(ve,ve,ce.calculatePosMatrix(V.toUnwrapped()))}function K(ce,V,ve){if(ce)for(var j=0,de=ce;j<de.length;j+=1){var Me=de[j],Ce=V[Me];if(Ce&&Ce.source===ve&&Ce.type==="fill-extrusion")return!0}else for(var Ze in V){var ut=V[Ze];if(ut.source===ve&&ut.type==="fill-extrusion")return!0}return!1}function ne(ce,V,ve,j,de,Me){var Ce=K(de&&de.layers,V,ce.id),Ze=Me.maxPitchScaleFactor(),ut=ce.tilesIn(j,Ze,Ce);ut.sort(le);for(var St=[],jt=0,lr=ut;jt<lr.length;jt+=1){var vr=lr[jt];St.push({wrappedTileID:vr.tileID.wrapped().key,queryResults:vr.tile.queryRenderedFeatures(V,ve,ce._state,vr.queryGeometry,vr.cameraQueryGeometry,vr.scale,de,Me,Ze,W(ce.transform,vr.tileID))})}var Er=ye(St);for(var Vr in Er)Er[Vr].forEach(function(Gr){var Ur=Gr.feature,Kr=ce.getFeatureState(Ur.layer["source-layer"],Ur.id);Ur.source=Ur.layer.source,Ur.layer["source-layer"]&&(Ur.sourceLayer=Ur.layer["source-layer"]),Ur.state=Kr});return Er}function ae(ce,V,ve,j,de,Me,Ce){for(var Ze={},ut=Me.queryRenderedSymbols(j),St=[],jt=0,lr=Object.keys(ut).map(Number);jt<lr.length;jt+=1){var vr=lr[jt];St.push(Ce[vr])}St.sort(le);for(var Er=function(){var cn=Gr[Vr],En=cn.featureIndex.lookupSymbolFeatures(ut[cn.bucketInstanceId],V,cn.bucketIndex,cn.sourceLayerIndex,de.filter,de.layers,de.availableImages,ce);for(var Fn in En){var Kn=Ze[Fn]=Ze[Fn]||[],qn=En[Fn];qn.sort(function(ya,Ta){var Ea=cn.featureSortOrder;if(Ea){var Ha=Ea.indexOf(ya.featureIndex),ni=Ea.indexOf(Ta.featureIndex);return ni-Ha}else return Ta.featureIndex-ya.featureIndex});for(var Qn=0,ca=qn;Qn<ca.length;Qn+=1){var ba=ca[Qn];Kn.push(ba)}}},Vr=0,Gr=St;Vr<Gr.length;Vr+=1)Er();var Ur=function(cn){Ze[cn].forEach(function(En){var Fn=En.feature,Kn=ce[cn],qn=ve[Kn.source],Qn=qn.getFeatureState(Fn.layer["source-layer"],Fn.id);Fn.source=Fn.layer.source,Fn.layer["source-layer"]&&(Fn.sourceLayer=Fn.layer["source-layer"]),Fn.state=Qn})};for(var Kr in Ze)Ur(Kr);return Ze}function ie(ce,V){for(var ve=ce.getRenderableIds().map(function(ut){return ce.getTileByID(ut)}),j=[],de={},Me=0;Me<ve.length;Me++){var Ce=ve[Me],Ze=Ce.tileID.canonical.key;de[Ze]||(de[Ze]=!0,Ce.querySourceFeatures(j,V))}return j}function le(ce,V){var ve=ce.tileID,j=V.tileID;return ve.overscaledZ-j.overscaledZ||ve.canonical.y-j.canonical.y||ve.wrap-j.wrap||ve.canonical.x-j.canonical.x}function ye(ce){for(var V={},ve={},j=0,de=ce;j<de.length;j+=1){var Me=de[j],Ce=Me.queryResults,Ze=Me.wrappedTileID,ut=ve[Ze]=ve[Ze]||{};for(var St in Ce)for(var jt=Ce[St],lr=ut[St]=ut[St]||{},vr=V[St]=V[St]||[],Er=0,Vr=jt;Er<Vr.length;Er+=1){var Gr=Vr[Er];lr[Gr.featureIndex]||(lr[Gr.featureIndex]=!0,vr.push(Gr))}}return V}var ue=function(V,ve){this.max=V,this.onRemove=ve,this.reset()};ue.prototype.reset=function(){for(var V in this.data)for(var ve=0,j=this.data[V];ve<j.length;ve+=1){var de=j[ve];de.timeout&&clearTimeout(de.timeout),this.onRemove(de.value)}return this.data={},this.order=[],this},ue.prototype.add=function(V,ve,j){var de=this,Me=V.wrapped().key;this.data[Me]===void 0&&(this.data[Me]=[]);var Ce={value:ve,timeout:void 0};if(j!==void 0&&(Ce.timeout=setTimeout(function(){de.remove(V,Ce)},j)),this.data[Me].push(Ce),this.order.push(Me),this.order.length>this.max){var Ze=this._getAndRemoveByKey(this.order[0]);Ze&&this.onRemove(Ze)}return this},ue.prototype.has=function(V){return V.wrapped().key in this.data},ue.prototype.getAndRemove=function(V){return this.has(V)?this._getAndRemoveByKey(V.wrapped().key):null},ue.prototype._getAndRemoveByKey=function(V){var ve=this.data[V].shift();return ve.timeout&&clearTimeout(ve.timeout),this.data[V].length===0&&delete this.data[V],this.order.splice(this.order.indexOf(V),1),ve.value},ue.prototype.getByKey=function(V){var ve=this.data[V];return ve?ve[0].value:null},ue.prototype.get=function(V){if(!this.has(V))return null;var ve=this.data[V.wrapped().key][0];return ve.value},ue.prototype.remove=function(V,ve){if(!this.has(V))return this;var j=V.wrapped().key,de=ve===void 0?0:this.data[j].indexOf(ve),Me=this.data[j][de];return this.data[j].splice(de,1),Me.timeout&&clearTimeout(Me.timeout),this.data[j].length===0&&delete this.data[j],this.onRemove(Me.value),this.order.splice(this.order.indexOf(j),1),this},ue.prototype.setMaxSize=function(V){for(this.max=V;this.order.length>this.max;){var ve=this._getAndRemoveByKey(this.order[0]);ve&&this.onRemove(ve)}return this},ue.prototype.filter=function(V){var ve=[];for(var j in this.data)for(var de=0,Me=this.data[j];de<Me.length;de+=1){var Ce=Me[de];V(Ce.value)||ve.push(Ce)}for(var Ze=0,ut=ve;Ze<ut.length;Ze+=1){var St=ut[Ze];this.remove(St.value.tileID,St)}};var pe=function(V,ve,j){this.context=V;var de=V.gl;this.buffer=de.createBuffer(),this.dynamicDraw=Boolean(j),this.context.unbindVAO(),V.bindElementBuffer.set(this.buffer),de.bufferData(de.ELEMENT_ARRAY_BUFFER,ve.arrayBuffer,this.dynamicDraw?de.DYNAMIC_DRAW:de.STATIC_DRAW),this.dynamicDraw||delete ve.arrayBuffer};pe.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},pe.prototype.updateData=function(V){var ve=this.context.gl;this.context.unbindVAO(),this.bind(),ve.bufferSubData(ve.ELEMENT_ARRAY_BUFFER,0,V.arrayBuffer)},pe.prototype.destroy=function(){var V=this.context.gl;this.buffer&&(V.deleteBuffer(this.buffer),delete this.buffer)};var ge={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},Te=function(V,ve,j,de){this.length=ve.length,this.attributes=j,this.itemSize=ve.bytesPerElement,this.dynamicDraw=de,this.context=V;var Me=V.gl;this.buffer=Me.createBuffer(),V.bindVertexBuffer.set(this.buffer),Me.bufferData(Me.ARRAY_BUFFER,ve.arrayBuffer,this.dynamicDraw?Me.DYNAMIC_DRAW:Me.STATIC_DRAW),this.dynamicDraw||delete ve.arrayBuffer};Te.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},Te.prototype.updateData=function(V){var ve=this.context.gl;this.bind(),ve.bufferSubData(ve.ARRAY_BUFFER,0,V.arrayBuffer)},Te.prototype.enableAttributes=function(V,ve){for(var j=0;j<this.attributes.length;j++){var de=this.attributes[j],Me=ve.attributes[de.name];Me!==void 0&&V.enableVertexAttribArray(Me)}},Te.prototype.setVertexAttribPointers=function(V,ve,j){for(var de=0;de<this.attributes.length;de++){var Me=this.attributes[de],Ce=ve.attributes[Me.name];Ce!==void 0&&V.vertexAttribPointer(Ce,Me.components,V[ge[Me.type]],!1,this.itemSize,Me.offset+this.itemSize*(j||0))}},Te.prototype.destroy=function(){var V=this.context.gl;this.buffer&&(V.deleteBuffer(this.buffer),delete this.buffer)};var _e=function(V){this.gl=V.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};_e.prototype.get=function(){return this.current},_e.prototype.set=function(V){},_e.prototype.getDefault=function(){return this.default},_e.prototype.setDefault=function(){this.set(this.default)};var ze=function(ce){function V(){ce.apply(this,arguments)}return ce&&(V.__proto__=ce),V.prototype=Object.create(ce&&ce.prototype),V.prototype.constructor=V,V.prototype.getDefault=function(){return e.Color.transparent},V.prototype.set=function(j){var de=this.current;j.r===de.r&&j.g===de.g&&j.b===de.b&&j.a===de.a&&!this.dirty||(this.gl.clearColor(j.r,j.g,j.b,j.a),this.current=j,this.dirty=!1)},V}(_e),Oe=function(ce){function V(){ce.apply(this,arguments)}return ce&&(V.__proto__=ce),V.prototype=Object.create(ce&&ce.prototype),V.prototype.constructor=V,V.prototype.getDefault=function(){return 1},V.prototype.set=function(j){j===this.current&&!this.dirty||(this.gl.clearDepth(j),this.current=j,this.dirty=!1)},V}(_e),Ye=function(ce){function V(){ce.apply(this,arguments)}return ce&&(V.__proto__=ce),V.prototype=Object.create(ce&&ce.prototype),V.prototype.constructor=V,V.prototype.getDefault=function(){return 0},V.prototype.set=function(j){j===this.current&&!this.dirty||(this.gl.clearStencil(j),this.current=j,this.dirty=!1)},V}(_e),be=function(ce){function V(){ce.apply(this,arguments)}return ce&&(V.__proto__=ce),V.prototype=Object.create(ce&&ce.prototype),V.prototype.constructor=V,V.prototype.getDefault=function(){return[!0,!0,!0,!0]},V.prototype.set=function(j){var de=this.current;j[0]===de[0]&&j[1]===de[1]&&j[2]===de[2]&&j[3]===de[3]&&!this.dirty||(this.gl.colorMask(j[0],j[1],j[2],j[3]),this.current=j,this.dirty=!1)},V}(_e),Pe=function(ce){function V(){ce.apply(this,arguments)}return ce&&(V.__proto__=ce),V.prototype=Object.create(ce&&ce.prototype),V.prototype.constructor=V,V.prototype.getDefault=function(){return!0},V.prototype.set=function(j){j===this.current&&!this.dirty||(this.gl.depthMask(j),this.current=j,this.dirty=!1)},V}(_e),Ge=function(ce){function V(){ce.apply(this,arguments)}return ce&&(V.__proto__=ce),V.prototype=Object.create(ce&&ce.prototype),V.prototype.constructor=V,V.prototype.getDefault=function(){return 255},V.prototype.set=function(j){j===this.current&&!this.dirty||(this.gl.stencilMask(j),this.current=j,this.dirty=!1)},V}(_e),Qe=function(ce){function V(){ce.apply(this,arguments)}return ce&&(V.__proto__=ce),V.prototype=Object.create(ce&&ce.prototype),V.prototype.constructor=V,V.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},V.prototype.set=function(j){var de=this.current;j.func===de.func&&j.ref===de.ref&&j.mask===de.mask&&!this.dirty||(this.gl.stencilFunc(j.func,j.ref,j.mask),this.current=j,this.dirty=!1)},V}(_e),Be=function(ce){function V(){ce.apply(this,arguments)}return ce&&(V.__proto__=ce),V.prototype=Object.create(ce&&ce.prototype),V.prototype.constructor=V,V.prototype.getDefault=function(){var j=this.gl;return[j.KEEP,j.KEEP,j.KEEP]},V.prototype.set=function(j){var de=this.current;j[0]===de[0]&&j[1]===de[1]&&j[2]===de[2]&&!this.dirty||(this.gl.stencilOp(j[0],j[1],j[2]),this.current=j,this.dirty=!1)},V}(_e),Le=function(ce){function V(){ce.apply(this,arguments)}return ce&&(V.__proto__=ce),V.prototype=Object.create(ce&&ce.prototype),V.prototype.constructor=V,V.prototype.getDefault=function(){return!1},V.prototype.set=function(j){if(!(j===this.current&&!this.dirty)){var de=this.gl;j?de.enable(de.STENCIL_TEST):de.disable(de.STENCIL_TEST),this.current=j,this.dirty=!1}},V}(_e),He=function(ce){function V(){ce.apply(this,arguments)}return ce&&(V.__proto__=ce),V.prototype=Object.create(ce&&ce.prototype),V.prototype.constructor=V,V.prototype.getDefault=function(){return[0,1]},V.prototype.set=function(j){var de=this.current;j[0]===de[0]&&j[1]===de[1]&&!this.dirty||(this.gl.depthRange(j[0],j[1]),this.current=j,this.dirty=!1)},V}(_e),vt=function(ce){function V(){ce.apply(this,arguments)}return ce&&(V.__proto__=ce),V.prototype=Object.create(ce&&ce.prototype),V.prototype.constructor=V,V.prototype.getDefault=function(){return!1},V.prototype.set=function(j){if(!(j===this.current&&!this.dirty)){var de=this.gl;j?de.enable(de.DEPTH_TEST):de.disable(de.DEPTH_TEST),this.current=j,this.dirty=!1}},V}(_e),Rt=function(ce){function V(){ce.apply(this,arguments)}return ce&&(V.__proto__=ce),V.prototype=Object.create(ce&&ce.prototype),V.prototype.constructor=V,V.prototype.getDefault=function(){return this.gl.LESS},V.prototype.set=function(j){j===this.current&&!this.dirty||(this.gl.depthFunc(j),this.current=j,this.dirty=!1)},V}(_e),rr=function(ce){function V(){ce.apply(this,arguments)}return ce&&(V.__proto__=ce),V.prototype=Object.create(ce&&ce.prototype),V.prototype.constructor=V,V.prototype.getDefault=function(){return!1},V.prototype.set=function(j){if(!(j===this.current&&!this.dirty)){var de=this.gl;j?de.enable(de.BLEND):de.disable(de.BLEND),this.current=j,this.dirty=!1}},V}(_e),Lt=function(ce){function V(){ce.apply(this,arguments)}return ce&&(V.__proto__=ce),V.prototype=Object.create(ce&&ce.prototype),V.prototype.constructor=V,V.prototype.getDefault=function(){var j=this.gl;return[j.ONE,j.ZERO]},V.prototype.set=function(j){var de=this.current;j[0]===de[0]&&j[1]===de[1]&&!this.dirty||(this.gl.blendFunc(j[0],j[1]),this.current=j,this.dirty=!1)},V}(_e),Ft=function(ce){function V(){ce.apply(this,arguments)}return ce&&(V.__proto__=ce),V.prototype=Object.create(ce&&ce.prototype),V.prototype.constructor=V,V.prototype.getDefault=function(){return e.Color.transparent},V.prototype.set=function(j){var de=this.current;j.r===de.r&&j.g===de.g&&j.b===de.b&&j.a===de.a&&!this.dirty||(this.gl.blendColor(j.r,j.g,j.b,j.a),this.current=j,this.dirty=!1)},V}(_e),Gt=function(ce){function V(){ce.apply(this,arguments)}return ce&&(V.__proto__=ce),V.prototype=Object.create(ce&&ce.prototype),V.prototype.constructor=V,V.prototype.getDefault=function(){return this.gl.FUNC_ADD},V.prototype.set=function(j){j===this.current&&!this.dirty||(this.gl.blendEquation(j),this.current=j,this.dirty=!1)},V}(_e),Dt=function(ce){function V(){ce.apply(this,arguments)}return ce&&(V.__proto__=ce),V.prototype=Object.create(ce&&ce.prototype),V.prototype.constructor=V,V.prototype.getDefault=function(){return!1},V.prototype.set=function(j){if(!(j===this.current&&!this.dirty)){var de=this.gl;j?de.enable(de.CULL_FACE):de.disable(de.CULL_FACE),this.current=j,this.dirty=!1}},V}(_e),kt=function(ce){function V(){ce.apply(this,arguments)}return ce&&(V.__proto__=ce),V.prototype=Object.create(ce&&ce.prototype),V.prototype.constructor=V,V.prototype.getDefault=function(){return this.gl.BACK},V.prototype.set=function(j){j===this.current&&!this.dirty||(this.gl.cullFace(j),this.current=j,this.dirty=!1)},V}(_e),Ue=function(ce){function V(){ce.apply(this,arguments)}return ce&&(V.__proto__=ce),V.prototype=Object.create(ce&&ce.prototype),V.prototype.constructor=V,V.prototype.getDefault=function(){return this.gl.CCW},V.prototype.set=function(j){j===this.current&&!this.dirty||(this.gl.frontFace(j),this.current=j,this.dirty=!1)},V}(_e),qe=function(ce){function V(){ce.apply(this,arguments)}return ce&&(V.__proto__=ce),V.prototype=Object.create(ce&&ce.prototype),V.prototype.constructor=V,V.prototype.getDefault=function(){return null},V.prototype.set=function(j){j===this.current&&!this.dirty||(this.gl.useProgram(j),this.current=j,this.dirty=!1)},V}(_e),Ve=function(ce){function V(){ce.apply(this,arguments)}return ce&&(V.__proto__=ce),V.prototype=Object.create(ce&&ce.prototype),V.prototype.constructor=V,V.prototype.getDefault=function(){return this.gl.TEXTURE0},V.prototype.set=function(j){j===this.current&&!this.dirty||(this.gl.activeTexture(j),this.current=j,this.dirty=!1)},V}(_e),Ae=function(ce){function V(){ce.apply(this,arguments)}return ce&&(V.__proto__=ce),V.prototype=Object.create(ce&&ce.prototype),V.prototype.constructor=V,V.prototype.getDefault=function(){var j=this.gl;return[0,0,j.drawingBufferWidth,j.drawingBufferHeight]},V.prototype.set=function(j){var de=this.current;j[0]===de[0]&&j[1]===de[1]&&j[2]===de[2]&&j[3]===de[3]&&!this.dirty||(this.gl.viewport(j[0],j[1],j[2],j[3]),this.current=j,this.dirty=!1)},V}(_e),Ne=function(ce){function V(){ce.apply(this,arguments)}return ce&&(V.__proto__=ce),V.prototype=Object.create(ce&&ce.prototype),V.prototype.constructor=V,V.prototype.getDefault=function(){return null},V.prototype.set=function(j){if(!(j===this.current&&!this.dirty)){var de=this.gl;de.bindFramebuffer(de.FRAMEBUFFER,j),this.current=j,this.dirty=!1}},V}(_e),Xe=function(ce){function V(){ce.apply(this,arguments)}return ce&&(V.__proto__=ce),V.prototype=Object.create(ce&&ce.prototype),V.prototype.constructor=V,V.prototype.getDefault=function(){return null},V.prototype.set=function(j){if(!(j===this.current&&!this.dirty)){var de=this.gl;de.bindRenderbuffer(de.RENDERBUFFER,j),this.current=j,this.dirty=!1}},V}(_e),Je=function(ce){function V(){ce.apply(this,arguments)}return ce&&(V.__proto__=ce),V.prototype=Object.create(ce&&ce.prototype),V.prototype.constructor=V,V.prototype.getDefault=function(){return null},V.prototype.set=function(j){if(!(j===this.current&&!this.dirty)){var de=this.gl;de.bindTexture(de.TEXTURE_2D,j),this.current=j,this.dirty=!1}},V}(_e),_t=function(ce){function V(){ce.apply(this,arguments)}return ce&&(V.__proto__=ce),V.prototype=Object.create(ce&&ce.prototype),V.prototype.constructor=V,V.prototype.getDefault=function(){return null},V.prototype.set=function(j){if(!(j===this.current&&!this.dirty)){var de=this.gl;de.bindBuffer(de.ARRAY_BUFFER,j),this.current=j,this.dirty=!1}},V}(_e),mt=function(ce){function V(){ce.apply(this,arguments)}return ce&&(V.__proto__=ce),V.prototype=Object.create(ce&&ce.prototype),V.prototype.constructor=V,V.prototype.getDefault=function(){return null},V.prototype.set=function(j){var de=this.gl;de.bindBuffer(de.ELEMENT_ARRAY_BUFFER,j),this.current=j,this.dirty=!1},V}(_e),Ot=function(ce){function V(ve){ce.call(this,ve),this.vao=ve.extVertexArrayObject}return ce&&(V.__proto__=ce),V.prototype=Object.create(ce&&ce.prototype),V.prototype.constructor=V,V.prototype.getDefault=function(){return null},V.prototype.set=function(j){!this.vao||j===this.current&&!this.dirty||(this.vao.bindVertexArrayOES(j),this.current=j,this.dirty=!1)},V}(_e),Kt=function(ce){function V(){ce.apply(this,arguments)}return ce&&(V.__proto__=ce),V.prototype=Object.create(ce&&ce.prototype),V.prototype.constructor=V,V.prototype.getDefault=function(){return 4},V.prototype.set=function(j){if(!(j===this.current&&!this.dirty)){var de=this.gl;de.pixelStorei(de.UNPACK_ALIGNMENT,j),this.current=j,this.dirty=!1}},V}(_e),Nt=function(ce){function V(){ce.apply(this,arguments)}return ce&&(V.__proto__=ce),V.prototype=Object.create(ce&&ce.prototype),V.prototype.constructor=V,V.prototype.getDefault=function(){return!1},V.prototype.set=function(j){if(!(j===this.current&&!this.dirty)){var de=this.gl;de.pixelStorei(de.UNPACK_PREMULTIPLY_ALPHA_WEBGL,j),this.current=j,this.dirty=!1}},V}(_e),Wt=function(ce){function V(){ce.apply(this,arguments)}return ce&&(V.__proto__=ce),V.prototype=Object.create(ce&&ce.prototype),V.prototype.constructor=V,V.prototype.getDefault=function(){return!1},V.prototype.set=function(j){if(!(j===this.current&&!this.dirty)){var de=this.gl;de.pixelStorei(de.UNPACK_FLIP_Y_WEBGL,j),this.current=j,this.dirty=!1}},V}(_e),qt=function(ce){function V(ve,j){ce.call(this,ve),this.context=ve,this.parent=j}return ce&&(V.__proto__=ce),V.prototype=Object.create(ce&&ce.prototype),V.prototype.constructor=V,V.prototype.getDefault=function(){return null},V}(_e),Yt=function(ce){function V(){ce.apply(this,arguments)}return ce&&(V.__proto__=ce),V.prototype=Object.create(ce&&ce.prototype),V.prototype.constructor=V,V.prototype.setDirty=function(){this.dirty=!0},V.prototype.set=function(j){if(!(j===this.current&&!this.dirty)){this.context.bindFramebuffer.set(this.parent);var de=this.gl;de.framebufferTexture2D(de.FRAMEBUFFER,de.COLOR_ATTACHMENT0,de.TEXTURE_2D,j,0),this.current=j,this.dirty=!1}},V}(qt),fr=function(ce){function V(){ce.apply(this,arguments)}return ce&&(V.__proto__=ce),V.prototype=Object.create(ce&&ce.prototype),V.prototype.constructor=V,V.prototype.set=function(j){if(!(j===this.current&&!this.dirty)){this.context.bindFramebuffer.set(this.parent);var de=this.gl;de.framebufferRenderbuffer(de.FRAMEBUFFER,de.DEPTH_ATTACHMENT,de.RENDERBUFFER,j),this.current=j,this.dirty=!1}},V}(qt),Yr=function(V,ve,j,de){this.context=V,this.width=ve,this.height=j;var Me=V.gl,Ce=this.framebuffer=Me.createFramebuffer();this.colorAttachment=new Yt(V,Ce),de&&(this.depthAttachment=new fr(V,Ce))};Yr.prototype.destroy=function(){var V=this.context.gl,ve=this.colorAttachment.get();if(ve&&V.deleteTexture(ve),this.depthAttachment){var j=this.depthAttachment.get();j&&V.deleteRenderbuffer(j)}V.deleteFramebuffer(this.framebuffer)};var hn=519,Qr=function(V,ve,j){this.func=V,this.mask=ve,this.range=j};Qr.ReadOnly=!1,Qr.ReadWrite=!0,Qr.disabled=new Qr(hn,Qr.ReadOnly,[0,1]);var at=519,Jt=7680,Zt=function(V,ve,j,de,Me,Ce){this.test=V,this.ref=ve,this.mask=j,this.fail=de,this.depthFail=Me,this.pass=Ce};Zt.disabled=new Zt({func:at,mask:0},0,0,Jt,Jt,Jt);var Ut=0,_r=1,rt=771,Ke=function(V,ve,j){this.blendFunction=V,this.blendColor=ve,this.mask=j};Ke.Replace=[_r,Ut],Ke.disabled=new Ke(Ke.Replace,e.Color.transparent,[!1,!1,!1,!1]),Ke.unblended=new Ke(Ke.Replace,e.Color.transparent,[!0,!0,!0,!0]),Ke.alphaBlended=new Ke([_r,rt],e.Color.transparent,[!0,!0,!0,!0]);var st=1029,lt=2305,wt=function(V,ve,j){this.enable=V,this.mode=ve,this.frontFace=j};wt.disabled=new wt(!1,st,lt),wt.backCCW=new wt(!0,st,lt);var Pt=function(V){this.gl=V,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new ze(this),this.clearDepth=new Oe(this),this.clearStencil=new Ye(this),this.colorMask=new be(this),this.depthMask=new Pe(this),this.stencilMask=new Ge(this),this.stencilFunc=new Qe(this),this.stencilOp=new Be(this),this.stencilTest=new Le(this),this.depthRange=new He(this),this.depthTest=new vt(this),this.depthFunc=new Rt(this),this.blend=new rr(this),this.blendFunc=new Lt(this),this.blendColor=new Ft(this),this.blendEquation=new Gt(this),this.cullFace=new Dt(this),this.cullFaceSide=new kt(this),this.frontFace=new Ue(this),this.program=new qe(this),this.activeTexture=new Ve(this),this.viewport=new Ae(this),this.bindFramebuffer=new Ne(this),this.bindRenderbuffer=new Xe(this),this.bindTexture=new Je(this),this.bindVertexBuffer=new _t(this),this.bindElementBuffer=new mt(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new Ot(this),this.pixelStoreUnpack=new Kt(this),this.pixelStoreUnpackPremultiplyAlpha=new Nt(this),this.pixelStoreUnpackFlipY=new Wt(this),this.extTextureFilterAnisotropic=V.getExtension("EXT_texture_filter_anisotropic")||V.getExtension("MOZ_EXT_texture_filter_anisotropic")||V.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=V.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=V.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(V.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=V.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=V.getExtension("EXT_disjoint_timer_query")};Pt.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},Pt.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},Pt.prototype.createIndexBuffer=function(V,ve){return new pe(this,V,ve)},Pt.prototype.createVertexBuffer=function(V,ve,j){return new Te(this,V,ve,j)},Pt.prototype.createRenderbuffer=function(V,ve,j){var de=this.gl,Me=de.createRenderbuffer();return this.bindRenderbuffer.set(Me),de.renderbufferStorage(de.RENDERBUFFER,V,ve,j),this.bindRenderbuffer.set(null),Me},Pt.prototype.createFramebuffer=function(V,ve,j){return new Yr(this,V,ve,j)},Pt.prototype.clear=function(V){var ve=V.color,j=V.depth,de=this.gl,Me=0;ve&&(Me|=de.COLOR_BUFFER_BIT,this.clearColor.set(ve),this.colorMask.set([!0,!0,!0,!0])),typeof j<"u"&&(Me|=de.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(j),this.depthMask.set(!0)),de.clear(Me)},Pt.prototype.setCullFace=function(V){V.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(V.mode),this.frontFace.set(V.frontFace))},Pt.prototype.setDepthMode=function(V){V.func===this.gl.ALWAYS&&!V.mask?this.depthTest.set(!1):(this.depthTest.set(!0),this.depthFunc.set(V.func),this.depthMask.set(V.mask),this.depthRange.set(V.range))},Pt.prototype.setStencilMode=function(V){V.test.func===this.gl.ALWAYS&&!V.mask?this.stencilTest.set(!1):(this.stencilTest.set(!0),this.stencilMask.set(V.mask),this.stencilOp.set([V.fail,V.depthFail,V.pass]),this.stencilFunc.set({func:V.test.func,ref:V.ref,mask:V.test.mask}))},Pt.prototype.setColorMode=function(V){e.deepEqual(V.blendFunction,Ke.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(V.blendFunction),this.blendColor.set(V.blendColor)),this.colorMask.set(V.mask)},Pt.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var ke=function(ce){function V(ve,j,de){var Me=this;ce.call(this),this.id=ve,this.dispatcher=de,this.on("data",function(Ce){Ce.dataType==="source"&&Ce.sourceDataType==="metadata"&&(Me._sourceLoaded=!0),Me._sourceLoaded&&!Me._paused&&Ce.dataType==="source"&&Ce.sourceDataType==="content"&&(Me.reload(),Me.transform&&Me.update(Me.transform))}),this.on("error",function(){Me._sourceErrored=!0}),this._source=U(ve,j,de,this),this._tiles={},this._cache=new ue(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new e.SourceFeatureState}return ce&&(V.__proto__=ce),V.prototype=Object.create(ce&&ce.prototype),V.prototype.constructor=V,V.prototype.onAdd=function(j){this.map=j,this._maxTileCacheSize=j?j._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(j)},V.prototype.onRemove=function(j){this._source&&this._source.onRemove&&this._source.onRemove(j)},V.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(var j in this._tiles){var de=this._tiles[j];if(de.state!=="loaded"&&de.state!=="errored")return!1}return!0},V.prototype.getSource=function(){return this._source},V.prototype.pause=function(){this._paused=!0},V.prototype.resume=function(){if(!!this._paused){var j=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,j&&this.reload(),this.transform&&this.update(this.transform)}},V.prototype._loadTile=function(j,de){return this._source.loadTile(j,de)},V.prototype._unloadTile=function(j){if(this._source.unloadTile)return this._source.unloadTile(j,function(){})},V.prototype._abortTile=function(j){if(this._source.abortTile)return this._source.abortTile(j,function(){})},V.prototype.serialize=function(){return this._source.serialize()},V.prototype.prepare=function(j){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(var de in this._tiles){var Me=this._tiles[de];Me.upload(j),Me.prepare(this.map.style.imageManager)}},V.prototype.getIds=function(){return e.values(this._tiles).map(function(j){return j.tileID}).sort(Se).map(function(j){return j.key})},V.prototype.getRenderableIds=function(j){var de=this,Me=[];for(var Ce in this._tiles)this._isIdRenderable(Ce,j)&&Me.push(this._tiles[Ce]);return j?Me.sort(function(Ze,ut){var St=Ze.tileID,jt=ut.tileID,lr=new e.Point(St.canonical.x,St.canonical.y)._rotate(de.transform.angle),vr=new e.Point(jt.canonical.x,jt.canonical.y)._rotate(de.transform.angle);return St.overscaledZ-jt.overscaledZ||vr.y-lr.y||vr.x-lr.x}).map(function(Ze){return Ze.tileID.key}):Me.map(function(Ze){return Ze.tileID}).sort(Se).map(function(Ze){return Ze.key})},V.prototype.hasRenderableParent=function(j){var de=this.findLoadedParent(j,0);return de?this._isIdRenderable(de.tileID.key):!1},V.prototype._isIdRenderable=function(j,de){return this._tiles[j]&&this._tiles[j].hasData()&&!this._coveredTiles[j]&&(de||!this._tiles[j].holdingForFade())},V.prototype.reload=function(){if(this._paused){this._shouldReloadOnResume=!0;return}this._cache.reset();for(var j in this._tiles)this._tiles[j].state!=="errored"&&this._reloadTile(j,"reloading")},V.prototype._reloadTile=function(j,de){var Me=this._tiles[j];!Me||(Me.state!=="loading"&&(Me.state=de),this._loadTile(Me,this._tileLoaded.bind(this,Me,j,de)))},V.prototype._tileLoaded=function(j,de,Me,Ce){if(Ce){j.state="errored",Ce.status!==404?this._source.fire(new e.ErrorEvent(Ce,{tile:j})):this.update(this.transform);return}j.timeAdded=e.browser.now(),Me==="expired"&&(j.refreshedUponExpiration=!0),this._setTileReloadTimer(de,j),this.getSource().type==="raster-dem"&&j.dem&&this._backfillDEM(j),this._state.initializeTileState(j,this.map?this.map.painter:null),this._source.fire(new e.Event("data",{dataType:"source",tile:j,coord:j.tileID}))},V.prototype._backfillDEM=function(j){for(var de=this.getRenderableIds(),Me=0;Me<de.length;Me++){var Ce=de[Me];if(j.neighboringTiles&&j.neighboringTiles[Ce]){var Ze=this.getTileByID(Ce);ut(j,Ze),ut(Ze,j)}}function ut(St,jt){St.needsHillshadePrepare=!0;var lr=jt.tileID.canonical.x-St.tileID.canonical.x,vr=jt.tileID.canonical.y-St.tileID.canonical.y,Er=Math.pow(2,St.tileID.canonical.z),Vr=jt.tileID.key;lr===0&&vr===0||Math.abs(vr)>1||(Math.abs(lr)>1&&(Math.abs(lr+Er)===1?lr+=Er:Math.abs(lr-Er)===1&&(lr-=Er)),!(!jt.dem||!St.dem)&&(St.dem.backfillBorder(jt.dem,lr,vr),St.neighboringTiles&&St.neighboringTiles[Vr]&&(St.neighboringTiles[Vr].backfilled=!0)))}},V.prototype.getTile=function(j){return this.getTileByID(j.key)},V.prototype.getTileByID=function(j){return this._tiles[j]},V.prototype._retainLoadedChildren=function(j,de,Me,Ce){for(var Ze in this._tiles){var ut=this._tiles[Ze];if(!(Ce[Ze]||!ut.hasData()||ut.tileID.overscaledZ<=de||ut.tileID.overscaledZ>Me)){for(var St=ut.tileID;ut&&ut.tileID.overscaledZ>de+1;){var jt=ut.tileID.scaledTo(ut.tileID.overscaledZ-1);ut=this._tiles[jt.key],ut&&ut.hasData()&&(St=jt)}for(var lr=St;lr.overscaledZ>de;)if(lr=lr.scaledTo(lr.overscaledZ-1),j[lr.key]){Ce[St.key]=St;break}}}},V.prototype.findLoadedParent=function(j,de){if(j.key in this._loadedParentTiles){var Me=this._loadedParentTiles[j.key];return Me&&Me.tileID.overscaledZ>=de?Me:null}for(var Ce=j.overscaledZ-1;Ce>=de;Ce--){var Ze=j.scaledTo(Ce),ut=this._getLoadedTile(Ze);if(ut)return ut}},V.prototype._getLoadedTile=function(j){var de=this._tiles[j.key];if(de&&de.hasData())return de;var Me=this._cache.getByKey(j.wrapped().key);return Me},V.prototype.updateCacheSize=function(j){var de=Math.ceil(j.width/this._source.tileSize)+1,Me=Math.ceil(j.height/this._source.tileSize)+1,Ce=de*Me,Ze=5,ut=Math.floor(Ce*Ze),St=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,ut):ut;this._cache.setMaxSize(St)},V.prototype.handleWrapJump=function(j){var de=this._prevLng===void 0?j:this._prevLng,Me=j-de,Ce=Me/360,Ze=Math.round(Ce);if(this._prevLng=j,Ze){var ut={};for(var St in this._tiles){var jt=this._tiles[St];jt.tileID=jt.tileID.unwrapTo(jt.tileID.wrap+Ze),ut[jt.tileID.key]=jt}this._tiles=ut;for(var lr in this._timers)clearTimeout(this._timers[lr]),delete this._timers[lr];for(var vr in this._tiles){var Er=this._tiles[vr];this._setTileReloadTimer(vr,Er)}}},V.prototype.update=function(j){var de=this;if(this.transform=j,!(!this._sourceLoaded||this._paused)){this.updateCacheSize(j),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={};var Me;this.used?this._source.tileID?Me=j.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(ya){return new e.OverscaledTileID(ya.canonical.z,ya.wrap,ya.canonical.z,ya.canonical.x,ya.canonical.y)}):(Me=j.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(Me=Me.filter(function(ya){return de._source.hasTile(ya)}))):Me=[];var Ce=j.coveringZoomLevel(this._source),Ze=Math.max(Ce-V.maxOverzooming,this._source.minzoom),ut=Math.max(Ce+V.maxUnderzooming,this._source.minzoom),St=this._updateRetainedTiles(Me,Ce);if(nt(this._source.type)){for(var jt={},lr={},vr=Object.keys(St),Er=0,Vr=vr;Er<Vr.length;Er+=1){var Gr=Vr[Er],Ur=St[Gr],Kr=this._tiles[Gr];if(!(!Kr||Kr.fadeEndTime&&Kr.fadeEndTime<=e.browser.now())){var cn=this.findLoadedParent(Ur,Ze);cn&&(this._addTile(cn.tileID),jt[cn.tileID.key]=cn.tileID),lr[Gr]=Ur}}this._retainLoadedChildren(lr,Ce,ut,St);for(var En in jt)St[En]||(this._coveredTiles[En]=!0,St[En]=jt[En])}for(var Fn in St)this._tiles[Fn].clearFadeHold();for(var Kn=e.keysDifference(this._tiles,St),qn=0,Qn=Kn;qn<Qn.length;qn+=1){var ca=Qn[qn],ba=this._tiles[ca];ba.hasSymbolBuckets&&!ba.holdingForFade()?ba.setHoldDuration(this.map._fadeDuration):(!ba.hasSymbolBuckets||ba.symbolFadeFinished())&&this._removeTile(ca)}this._updateLoadedParentTileCache()}},V.prototype.releaseSymbolFadeTiles=function(){for(var j in this._tiles)this._tiles[j].holdingForFade()&&this._removeTile(j)},V.prototype._updateRetainedTiles=function(j,de){for(var Me={},Ce={},Ze=Math.max(de-V.maxOverzooming,this._source.minzoom),ut=Math.max(de+V.maxUnderzooming,this._source.minzoom),St={},jt=0,lr=j;jt<lr.length;jt+=1){var vr=lr[jt],Er=this._addTile(vr);Me[vr.key]=vr,!Er.hasData()&&de<this._source.maxzoom&&(St[vr.key]=vr)}this._retainLoadedChildren(St,de,ut,Me);for(var Vr=0,Gr=j;Vr<Gr.length;Vr+=1){var Ur=Gr[Vr],Kr=this._tiles[Ur.key];if(!Kr.hasData()){if(de+1>this._source.maxzoom){var cn=Ur.children(this._source.maxzoom)[0],En=this.getTile(cn);if(!!En&&En.hasData()){Me[cn.key]=cn;continue}}else{var Fn=Ur.children(this._source.maxzoom);if(Me[Fn[0].key]&&Me[Fn[1].key]&&Me[Fn[2].key]&&Me[Fn[3].key])continue}for(var Kn=Kr.wasRequested(),qn=Ur.overscaledZ-1;qn>=Ze;--qn){var Qn=Ur.scaledTo(qn);if(Ce[Qn.key]||(Ce[Qn.key]=!0,Kr=this.getTile(Qn),!Kr&&Kn&&(Kr=this._addTile(Qn)),Kr&&(Me[Qn.key]=Qn,Kn=Kr.wasRequested(),Kr.hasData())))break}}}return Me},V.prototype._updateLoadedParentTileCache=function(){this._loadedParentTiles={};for(var j in this._tiles){for(var de=[],Me=void 0,Ce=this._tiles[j].tileID;Ce.overscaledZ>0;){if(Ce.key in this._loadedParentTiles){Me=this._loadedParentTiles[Ce.key];break}de.push(Ce.key);var Ze=Ce.scaledTo(Ce.overscaledZ-1);if(Me=this._getLoadedTile(Ze),Me)break;Ce=Ze}for(var ut=0,St=de;ut<St.length;ut+=1){var jt=St[ut];this._loadedParentTiles[jt]=Me}}},V.prototype._addTile=function(j){var de=this._tiles[j.key];if(de)return de;de=this._cache.getAndRemove(j),de&&(this._setTileReloadTimer(j.key,de),de.tileID=j,this._state.initializeTileState(de,this.map?this.map.painter:null),this._cacheTimers[j.key]&&(clearTimeout(this._cacheTimers[j.key]),delete this._cacheTimers[j.key],this._setTileReloadTimer(j.key,de)));var Me=Boolean(de);return Me||(de=new e.Tile(j,this._source.tileSize*j.overscaleFactor()),this._loadTile(de,this._tileLoaded.bind(this,de,j.key,de.state))),de?(de.uses++,this._tiles[j.key]=de,Me||this._source.fire(new e.Event("dataloading",{tile:de,coord:de.tileID,dataType:"source"})),de):null},V.prototype._setTileReloadTimer=function(j,de){var Me=this;j in this._timers&&(clearTimeout(this._timers[j]),delete this._timers[j]);var Ce=de.getExpiryTimeout();Ce&&(this._timers[j]=setTimeout(function(){Me._reloadTile(j,"expired"),delete Me._timers[j]},Ce))},V.prototype._removeTile=function(j){var de=this._tiles[j];!de||(de.uses--,delete this._tiles[j],this._timers[j]&&(clearTimeout(this._timers[j]),delete this._timers[j]),!(de.uses>0)&&(de.hasData()&&de.state!=="reloading"?this._cache.add(de.tileID,de,de.getExpiryTimeout()):(de.aborted=!0,this._abortTile(de),this._unloadTile(de))))},V.prototype.clearTiles=function(){this._shouldReloadOnResume=!1,this._paused=!1;for(var j in this._tiles)this._removeTile(j);this._cache.reset()},V.prototype.tilesIn=function(j,de,Me){var Ce=this,Ze=[],ut=this.transform;if(!ut)return Ze;for(var St=Me?ut.getCameraQueryGeometry(j):j,jt=j.map(function(qn){return ut.pointCoordinate(qn)}),lr=St.map(function(qn){return ut.pointCoordinate(qn)}),vr=this.getIds(),Er=1/0,Vr=1/0,Gr=-1/0,Ur=-1/0,Kr=0,cn=lr;Kr<cn.length;Kr+=1){var En=cn[Kr];Er=Math.min(Er,En.x),Vr=Math.min(Vr,En.y),Gr=Math.max(Gr,En.x),Ur=Math.max(Ur,En.y)}for(var Fn=function(qn){var Qn=Ce._tiles[vr[qn]];if(!Qn.holdingForFade()){var ca=Qn.tileID,ba=Math.pow(2,ut.zoom-Qn.tileID.overscaledZ),ya=de*Qn.queryPadding*e.EXTENT/Qn.tileSize/ba,Ta=[ca.getTilePoint(new e.MercatorCoordinate(Er,Vr)),ca.getTilePoint(new e.MercatorCoordinate(Gr,Ur))];if(Ta[0].x-ya<e.EXTENT&&Ta[0].y-ya<e.EXTENT&&Ta[1].x+ya>=0&&Ta[1].y+ya>=0){var Ea=jt.map(function(ni){return ca.getTilePoint(ni)}),Ha=lr.map(function(ni){return ca.getTilePoint(ni)});Ze.push({tile:Qn,tileID:ca,queryGeometry:Ea,cameraQueryGeometry:Ha,scale:ba})}}},Kn=0;Kn<vr.length;Kn++)Fn(Kn);return Ze},V.prototype.getVisibleCoordinates=function(j){for(var de=this,Me=this.getRenderableIds(j).map(function(St){return de._tiles[St].tileID}),Ce=0,Ze=Me;Ce<Ze.length;Ce+=1){var ut=Ze[Ce];ut.posMatrix=this.transform.calculatePosMatrix(ut.toUnwrapped())}return Me},V.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(nt(this._source.type))for(var j in this._tiles){var de=this._tiles[j];if(de.fadeEndTime!==void 0&&de.fadeEndTime>=e.browser.now())return!0}return!1},V.prototype.setFeatureState=function(j,de,Me){j=j||"_geojsonTileLayer",this._state.updateState(j,de,Me)},V.prototype.removeFeatureState=function(j,de,Me){j=j||"_geojsonTileLayer",this._state.removeFeatureState(j,de,Me)},V.prototype.getFeatureState=function(j,de){return j=j||"_geojsonTileLayer",this._state.getState(j,de)},V.prototype.setDependencies=function(j,de,Me){var Ce=this._tiles[j];Ce&&Ce.setDependencies(de,Me)},V.prototype.reloadTilesForDependencies=function(j,de){for(var Me in this._tiles){var Ce=this._tiles[Me];Ce.hasDependency(j,de)&&this._reloadTile(Me,"reloading")}this._cache.filter(function(Ze){return!Ze.hasDependency(j,de)})},V}(e.Evented);ke.maxOverzooming=10,ke.maxUnderzooming=3;function Se(ce,V){var ve=Math.abs(ce.wrap*2)-+(ce.wrap<0),j=Math.abs(V.wrap*2)-+(V.wrap<0);return ce.overscaledZ-V.overscaledZ||j-ve||V.canonical.y-ce.canonical.y||V.canonical.x-ce.canonical.x}function nt(ce){return ce==="raster"||ce==="image"||ce==="video"}function it(){return new e.window.Worker(Sc.workerUrl)}var ct="mapboxgl_preloaded_worker_pool",At=function(){this.active={}};At.prototype.acquire=function(V){if(!this.workers)for(this.workers=[];this.workers.length<At.workerCount;)this.workers.push(new it);return this.active[V]=!0,this.workers.slice()},At.prototype.release=function(V){delete this.active[V],this.numActive()===0&&(this.workers.forEach(function(ve){ve.terminate()}),this.workers=null)},At.prototype.isPreloaded=function(){return!!this.active[ct]},At.prototype.numActive=function(){return Object.keys(this.active).length};var dt=Math.floor(e.browser.hardwareConcurrency/2);At.workerCount=Math.max(Math.min(dt,6),1);var Tt;function Ht(){return Tt||(Tt=new At),Tt}function ir(){var ce=Ht();ce.acquire(ct)}function kr(){var ce=Tt;ce&&(ce.isPreloaded()&&ce.numActive()===1?(ce.release(ct),Tt=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))}function br(ce,V){var ve={};for(var j in ce)j!=="ref"&&(ve[j]=ce[j]);return e.refProperties.forEach(function(de){de in V&&(ve[de]=V[de])}),ve}function Mr(ce){ce=ce.slice();for(var V=Object.create(null),ve=0;ve<ce.length;ve++)V[ce[ve].id]=ce[ve];for(var j=0;j<ce.length;j++)"ref"in ce[j]&&(ce[j]=br(ce[j],V[ce[j].ref]));return ce}function Hr(){var ce={},V=e.styleSpec.$version;for(var ve in e.styleSpec.$root){var j=e.styleSpec.$root[ve];if(j.required){var de=null;ve==="version"?de=V:j.type==="array"?de=[]:de={},de!=null&&(ce[ve]=de)}}return ce}var nr={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function mr(ce,V,ve){ve.push({command:nr.addSource,args:[ce,V[ce]]})}function Pr(ce,V,ve){V.push({command:nr.removeSource,args:[ce]}),ve[ce]=!0}function Nr(ce,V,ve,j){Pr(ce,ve,j),mr(ce,V,ve)}function Sr(ce,V,ve){var j;for(j in ce[ve])if(!!ce[ve].hasOwnProperty(j)&&j!=="data"&&!e.deepEqual(ce[ve][j],V[ve][j]))return!1;for(j in V[ve])if(!!V[ve].hasOwnProperty(j)&&j!=="data"&&!e.deepEqual(ce[ve][j],V[ve][j]))return!1;return!0}function tt(ce,V,ve,j){ce=ce||{},V=V||{};var de;for(de in ce)!ce.hasOwnProperty(de)||V.hasOwnProperty(de)||Pr(de,ve,j);for(de in V)!V.hasOwnProperty(de)||(ce.hasOwnProperty(de)?e.deepEqual(ce[de],V[de])||(ce[de].type==="geojson"&&V[de].type==="geojson"&&Sr(ce,V,de)?ve.push({command:nr.setGeoJSONSourceData,args:[de,V[de].data]}):Nr(de,V,ve,j)):mr(de,V,ve))}function Et(ce,V,ve,j,de,Me){ce=ce||{},V=V||{};var Ce;for(Ce in ce)!ce.hasOwnProperty(Ce)||e.deepEqual(ce[Ce],V[Ce])||ve.push({command:Me,args:[j,Ce,V[Ce],de]});for(Ce in V)!V.hasOwnProperty(Ce)||ce.hasOwnProperty(Ce)||e.deepEqual(ce[Ce],V[Ce])||ve.push({command:Me,args:[j,Ce,V[Ce],de]})}function Vt(ce){return ce.id}function ar(ce,V){return ce[V.id]=V,ce}function Cr(ce,V,ve){ce=ce||[],V=V||[];var j=ce.map(Vt),de=V.map(Vt),Me=ce.reduce(ar,{}),Ce=V.reduce(ar,{}),Ze=j.slice(),ut=Object.create(null),St,jt,lr,vr,Er,Vr,Gr;for(St=0,jt=0;St<j.length;St++)lr=j[St],Ce.hasOwnProperty(lr)?jt++:(ve.push({command:nr.removeLayer,args:[lr]}),Ze.splice(Ze.indexOf(lr,jt),1));for(St=0,jt=0;St<de.length;St++)lr=de[de.length-1-St],Ze[Ze.length-1-St]!==lr&&(Me.hasOwnProperty(lr)?(ve.push({command:nr.removeLayer,args:[lr]}),Ze.splice(Ze.lastIndexOf(lr,Ze.length-jt),1)):jt++,Vr=Ze[Ze.length-St],ve.push({command:nr.addLayer,args:[Ce[lr],Vr]}),Ze.splice(Ze.length-St,0,lr),ut[lr]=!0);for(St=0;St<de.length;St++)if(lr=de[St],vr=Me[lr],Er=Ce[lr],!(ut[lr]||e.deepEqual(vr,Er))){if(!e.deepEqual(vr.source,Er.source)||!e.deepEqual(vr["source-layer"],Er["source-layer"])||!e.deepEqual(vr.type,Er.type)){ve.push({command:nr.removeLayer,args:[lr]}),Vr=Ze[Ze.lastIndexOf(lr)+1],ve.push({command:nr.addLayer,args:[Er,Vr]});continue}Et(vr.layout,Er.layout,ve,lr,null,nr.setLayoutProperty),Et(vr.paint,Er.paint,ve,lr,null,nr.setPaintProperty),e.deepEqual(vr.filter,Er.filter)||ve.push({command:nr.setFilter,args:[lr,Er.filter]}),(!e.deepEqual(vr.minzoom,Er.minzoom)||!e.deepEqual(vr.maxzoom,Er.maxzoom))&&ve.push({command:nr.setLayerZoomRange,args:[lr,Er.minzoom,Er.maxzoom]});for(Gr in vr)!vr.hasOwnProperty(Gr)||Gr==="layout"||Gr==="paint"||Gr==="filter"||Gr==="metadata"||Gr==="minzoom"||Gr==="maxzoom"||(Gr.indexOf("paint.")===0?Et(vr[Gr],Er[Gr],ve,lr,Gr.slice(6),nr.setPaintProperty):e.deepEqual(vr[Gr],Er[Gr])||ve.push({command:nr.setLayerProperty,args:[lr,Gr,Er[Gr]]}));for(Gr in Er)!Er.hasOwnProperty(Gr)||vr.hasOwnProperty(Gr)||Gr==="layout"||Gr==="paint"||Gr==="filter"||Gr==="metadata"||Gr==="minzoom"||Gr==="maxzoom"||(Gr.indexOf("paint.")===0?Et(vr[Gr],Er[Gr],ve,lr,Gr.slice(6),nr.setPaintProperty):e.deepEqual(vr[Gr],Er[Gr])||ve.push({command:nr.setLayerProperty,args:[lr,Gr,Er[Gr]]}))}}function Or(ce,V){if(!ce)return[{command:nr.setStyle,args:[V]}];var ve=[];try{if(!e.deepEqual(ce.version,V.version))return[{command:nr.setStyle,args:[V]}];e.deepEqual(ce.center,V.center)||ve.push({command:nr.setCenter,args:[V.center]}),e.deepEqual(ce.zoom,V.zoom)||ve.push({command:nr.setZoom,args:[V.zoom]}),e.deepEqual(ce.bearing,V.bearing)||ve.push({command:nr.setBearing,args:[V.bearing]}),e.deepEqual(ce.pitch,V.pitch)||ve.push({command:nr.setPitch,args:[V.pitch]}),e.deepEqual(ce.sprite,V.sprite)||ve.push({command:nr.setSprite,args:[V.sprite]}),e.deepEqual(ce.glyphs,V.glyphs)||ve.push({command:nr.setGlyphs,args:[V.glyphs]}),e.deepEqual(ce.transition,V.transition)||ve.push({command:nr.setTransition,args:[V.transition]}),e.deepEqual(ce.light,V.light)||ve.push({command:nr.setLight,args:[V.light]});var j={},de=[];tt(ce.sources,V.sources,de,j);var Me=[];ce.layers&&ce.layers.forEach(function(Ce){j[Ce.source]?ve.push({command:nr.removeLayer,args:[Ce.id]}):Me.push(Ce)}),ve=ve.concat(de),Cr(Me,V.layers,ve)}catch(Ce){console.warn("Unable to compute style diff:",Ce),ve=[{command:nr.setStyle,args:[V]}]}return ve}var Ir=function(V,ve){this.reset(V,ve)};Ir.prototype.reset=function(V,ve){this.points=V||[],this._distances=[0];for(var j=1;j<this.points.length;j++)this._distances[j]=this._distances[j-1]+this.points[j].dist(this.points[j-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(ve||0,this.length*.5),this.paddedLength=this.length-this.padding*2},Ir.prototype.lerp=function(V){if(this.points.length===1)return this.points[0];V=e.clamp(V,0,1);for(var ve=1,j=this._distances[ve],de=V*this.paddedLength+this.padding;j<de&&ve<this._distances.length;)j=this._distances[++ve];var Me=ve-1,Ce=this._distances[Me],Ze=j-Ce,ut=Ze>0?(de-Ce)/Ze:0;return this.points[Me].mult(1-ut).add(this.points[ve].mult(ut))};var Tr=function(V,ve,j){var de=this.boxCells=[],Me=this.circleCells=[];this.xCellCount=Math.ceil(V/j),this.yCellCount=Math.ceil(ve/j);for(var Ce=0;Ce<this.xCellCount*this.yCellCount;Ce++)de.push([]),Me.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=V,this.height=ve,this.xScale=this.xCellCount/V,this.yScale=this.yCellCount/ve,this.boxUid=0,this.circleUid=0};Tr.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},Tr.prototype.insert=function(V,ve,j,de,Me){this._forEachCell(ve,j,de,Me,this._insertBoxCell,this.boxUid++),this.boxKeys.push(V),this.bboxes.push(ve),this.bboxes.push(j),this.bboxes.push(de),this.bboxes.push(Me)},Tr.prototype.insertCircle=function(V,ve,j,de){this._forEachCell(ve-de,j-de,ve+de,j+de,this._insertCircleCell,this.circleUid++),this.circleKeys.push(V),this.circles.push(ve),this.circles.push(j),this.circles.push(de)},Tr.prototype._insertBoxCell=function(V,ve,j,de,Me,Ce){this.boxCells[Me].push(Ce)},Tr.prototype._insertCircleCell=function(V,ve,j,de,Me,Ce){this.circleCells[Me].push(Ce)},Tr.prototype._query=function(V,ve,j,de,Me,Ce){if(j<0||V>this.width||de<0||ve>this.height)return Me?!1:[];var Ze=[];if(V<=0&&ve<=0&&this.width<=j&&this.height<=de){if(Me)return!0;for(var ut=0;ut<this.boxKeys.length;ut++)Ze.push({key:this.boxKeys[ut],x1:this.bboxes[ut*4],y1:this.bboxes[ut*4+1],x2:this.bboxes[ut*4+2],y2:this.bboxes[ut*4+3]});for(var St=0;St<this.circleKeys.length;St++){var jt=this.circles[St*3],lr=this.circles[St*3+1],vr=this.circles[St*3+2];Ze.push({key:this.circleKeys[St],x1:jt-vr,y1:lr-vr,x2:jt+vr,y2:lr+vr})}return Ce?Ze.filter(Ce):Ze}else{var Er={hitTest:Me,seenUids:{box:{},circle:{}}};return this._forEachCell(V,ve,j,de,this._queryCell,Ze,Er,Ce),Me?Ze.length>0:Ze}},Tr.prototype._queryCircle=function(V,ve,j,de,Me){var Ce=V-j,Ze=V+j,ut=ve-j,St=ve+j;if(Ze<0||Ce>this.width||St<0||ut>this.height)return de?!1:[];var jt=[],lr={hitTest:de,circle:{x:V,y:ve,radius:j},seenUids:{box:{},circle:{}}};return this._forEachCell(Ce,ut,Ze,St,this._queryCellCircle,jt,lr,Me),de?jt.length>0:jt},Tr.prototype.query=function(V,ve,j,de,Me){return this._query(V,ve,j,de,!1,Me)},Tr.prototype.hitTest=function(V,ve,j,de,Me){return this._query(V,ve,j,de,!0,Me)},Tr.prototype.hitTestCircle=function(V,ve,j,de){return this._queryCircle(V,ve,j,!0,de)},Tr.prototype._queryCell=function(V,ve,j,de,Me,Ce,Ze,ut){var St=Ze.seenUids,jt=this.boxCells[Me];if(jt!==null)for(var lr=this.bboxes,vr=0,Er=jt;vr<Er.length;vr+=1){var Vr=Er[vr];if(!St.box[Vr]){St.box[Vr]=!0;var Gr=Vr*4;if(V<=lr[Gr+2]&&ve<=lr[Gr+3]&&j>=lr[Gr+0]&&de>=lr[Gr+1]&&(!ut||ut(this.boxKeys[Vr]))){if(Ze.hitTest)return Ce.push(!0),!0;Ce.push({key:this.boxKeys[Vr],x1:lr[Gr],y1:lr[Gr+1],x2:lr[Gr+2],y2:lr[Gr+3]})}}}var Ur=this.circleCells[Me];if(Ur!==null)for(var Kr=this.circles,cn=0,En=Ur;cn<En.length;cn+=1){var Fn=En[cn];if(!St.circle[Fn]){St.circle[Fn]=!0;var Kn=Fn*3;if(this._circleAndRectCollide(Kr[Kn],Kr[Kn+1],Kr[Kn+2],V,ve,j,de)&&(!ut||ut(this.circleKeys[Fn]))){if(Ze.hitTest)return Ce.push(!0),!0;var qn=Kr[Kn],Qn=Kr[Kn+1],ca=Kr[Kn+2];Ce.push({key:this.circleKeys[Fn],x1:qn-ca,y1:Qn-ca,x2:qn+ca,y2:Qn+ca})}}}},Tr.prototype._queryCellCircle=function(V,ve,j,de,Me,Ce,Ze,ut){var St=Ze.circle,jt=Ze.seenUids,lr=this.boxCells[Me];if(lr!==null)for(var vr=this.bboxes,Er=0,Vr=lr;Er<Vr.length;Er+=1){var Gr=Vr[Er];if(!jt.box[Gr]){jt.box[Gr]=!0;var Ur=Gr*4;if(this._circleAndRectCollide(St.x,St.y,St.radius,vr[Ur+0],vr[Ur+1],vr[Ur+2],vr[Ur+3])&&(!ut||ut(this.boxKeys[Gr])))return Ce.push(!0),!0}}var Kr=this.circleCells[Me];if(Kr!==null)for(var cn=this.circles,En=0,Fn=Kr;En<Fn.length;En+=1){var Kn=Fn[En];if(!jt.circle[Kn]){jt.circle[Kn]=!0;var qn=Kn*3;if(this._circlesCollide(cn[qn],cn[qn+1],cn[qn+2],St.x,St.y,St.radius)&&(!ut||ut(this.circleKeys[Kn])))return Ce.push(!0),!0}}},Tr.prototype._forEachCell=function(V,ve,j,de,Me,Ce,Ze,ut){for(var St=this._convertToXCellCoord(V),jt=this._convertToYCellCoord(ve),lr=this._convertToXCellCoord(j),vr=this._convertToYCellCoord(de),Er=St;Er<=lr;Er++)for(var Vr=jt;Vr<=vr;Vr++){var Gr=this.xCellCount*Vr+Er;if(Me.call(this,V,ve,j,de,Gr,Ce,Ze,ut))return}},Tr.prototype._convertToXCellCoord=function(V){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(V*this.xScale)))},Tr.prototype._convertToYCellCoord=function(V){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(V*this.yScale)))},Tr.prototype._circlesCollide=function(V,ve,j,de,Me,Ce){var Ze=de-V,ut=Me-ve,St=j+Ce;return St*St>Ze*Ze+ut*ut},Tr.prototype._circleAndRectCollide=function(V,ve,j,de,Me,Ce,Ze){var ut=(Ce-de)/2,St=Math.abs(V-(de+ut));if(St>ut+j)return!1;var jt=(Ze-Me)/2,lr=Math.abs(ve-(Me+jt));if(lr>jt+j)return!1;if(St<=ut||lr<=jt)return!0;var vr=St-ut,Er=lr-jt;return vr*vr+Er*Er<=j*j};function Wr(ce,V,ve,j,de){var Me=e.create();return V?(e.scale(Me,Me,[1/de,1/de,1]),ve||e.rotateZ(Me,Me,j.angle)):e.multiply(Me,j.labelPlaneMatrix,ce),Me}function wn(ce,V,ve,j,de){if(V){var Me=e.clone(ce);return e.scale(Me,Me,[de,de,1]),ve||e.rotateZ(Me,Me,-j.angle),Me}else return j.glCoordMatrix}function ln(ce,V){var ve=[ce.x,ce.y,0,1];wr(ve,ve,V);var j=ve[3];return{point:new e.Point(ve[0]/j,ve[1]/j),signedDistanceFromCamera:j}}function Bn(ce,V){return .5+.5*(ce/V)}function Cn(ce,V){var ve=ce[0]/ce[3],j=ce[1]/ce[3],de=ve>=-V[0]&&ve<=V[0]&&j>=-V[1]&&j<=V[1];return de}function Wn(ce,V,ve,j,de,Me,Ce,Ze){var ut=j?ce.textSizeData:ce.iconSizeData,St=e.evaluateSizeForZoom(ut,ve.transform.zoom),jt=[256/ve.width*2+1,256/ve.height*2+1],lr=j?ce.text.dynamicLayoutVertexArray:ce.icon.dynamicLayoutVertexArray;lr.clear();for(var vr=ce.lineVertexArray,Er=j?ce.text.placedSymbolArray:ce.icon.placedSymbolArray,Vr=ve.transform.width/ve.transform.height,Gr=!1,Ur=0;Ur<Er.length;Ur++){var Kr=Er.get(Ur);if(Kr.hidden||Kr.writingMode===e.WritingMode.vertical&&!Gr){Wa(Kr.numGlyphs,lr);continue}Gr=!1;var cn=[Kr.anchorX,Kr.anchorY,0,1];if(e.transformMat4(cn,cn,V),!Cn(cn,jt)){Wa(Kr.numGlyphs,lr);continue}var En=cn[3],Fn=Bn(ve.transform.cameraToCenterDistance,En),Kn=e.evaluateSizeForFeature(ut,St,Kr),qn=Ce?Kn/Fn:Kn*Fn,Qn=new e.Point(Kr.anchorX,Kr.anchorY),ca=ln(Qn,de).point,ba={},ya=La(Kr,qn,!1,Ze,V,de,Me,ce.glyphOffsetArray,vr,lr,ca,Qn,ba,Vr);Gr=ya.useVertical,(ya.notEnoughRoom||Gr||ya.needsFlipping&&La(Kr,qn,!0,Ze,V,de,Me,ce.glyphOffsetArray,vr,lr,ca,Qn,ba,Vr).notEnoughRoom)&&Wa(Kr.numGlyphs,lr)}j?ce.text.dynamicLayoutVertexBuffer.updateData(lr):ce.icon.dynamicLayoutVertexBuffer.updateData(lr)}function Hn(ce,V,ve,j,de,Me,Ce,Ze,ut,St,jt){var lr=Ze.glyphStartIndex+Ze.numGlyphs,vr=Ze.lineStartIndex,Er=Ze.lineStartIndex+Ze.lineLength,Vr=V.getoffsetX(Ze.glyphStartIndex),Gr=V.getoffsetX(lr-1),Ur=Va(ce*Vr,ve,j,de,Me,Ce,Ze.segment,vr,Er,ut,St,jt);if(!Ur)return null;var Kr=Va(ce*Gr,ve,j,de,Me,Ce,Ze.segment,vr,Er,ut,St,jt);return Kr?{first:Ur,last:Kr}:null}function ga(ce,V,ve,j){if(ce===e.WritingMode.horizontal){var de=Math.abs(ve.y-V.y),Me=Math.abs(ve.x-V.x)*j;if(de>Me)return{useVertical:!0}}return(ce===e.WritingMode.vertical?V.y<ve.y:V.x>ve.x)?{needsFlipping:!0}:null}function La(ce,V,ve,j,de,Me,Ce,Ze,ut,St,jt,lr,vr,Er){var Vr=V/24,Gr=ce.lineOffsetX*Vr,Ur=ce.lineOffsetY*Vr,Kr;if(ce.numGlyphs>1){var cn=ce.glyphStartIndex+ce.numGlyphs,En=ce.lineStartIndex,Fn=ce.lineStartIndex+ce.lineLength,Kn=Hn(Vr,Ze,Gr,Ur,ve,jt,lr,ce,ut,Me,vr);if(!Kn)return{notEnoughRoom:!0};var qn=ln(Kn.first.point,Ce).point,Qn=ln(Kn.last.point,Ce).point;if(j&&!ve){var ca=ga(ce.writingMode,qn,Qn,Er);if(ca)return ca}Kr=[Kn.first];for(var ba=ce.glyphStartIndex+1;ba<cn-1;ba++)Kr.push(Va(Vr*Ze.getoffsetX(ba),Gr,Ur,ve,jt,lr,ce.segment,En,Fn,ut,Me,vr));Kr.push(Kn.last)}else{if(j&&!ve){var ya=ln(lr,de).point,Ta=ce.lineStartIndex+ce.segment+1,Ea=new e.Point(ut.getx(Ta),ut.gety(Ta)),Ha=ln(Ea,de),ni=Ha.signedDistanceFromCamera>0?Ha.point:ci(lr,Ea,ya,1,de),Li=ga(ce.writingMode,ya,ni,Er);if(Li)return Li}var ui=Va(Vr*Ze.getoffsetX(ce.glyphStartIndex),Gr,Ur,ve,jt,lr,ce.segment,ce.lineStartIndex,ce.lineStartIndex+ce.lineLength,ut,Me,vr);if(!ui)return{notEnoughRoom:!0};Kr=[ui]}for(var pi=0,Ba=Kr;pi<Ba.length;pi+=1){var Pi=Ba[pi];e.addDynamicAttributes(St,Pi.point,Pi.angle)}return{}}function ci(ce,V,ve,j,de){var Me=ln(ce.add(ce.sub(V)._unit()),de).point,Ce=ve.sub(Me);return ve.add(Ce._mult(j/Ce.mag()))}function Va(ce,V,ve,j,de,Me,Ce,Ze,ut,St,jt,lr){var vr=j?ce-V:ce+V,Er=vr>0?1:-1,Vr=0;j&&(Er*=-1,Vr=Math.PI),Er<0&&(Vr+=Math.PI);for(var Gr=Er>0?Ze+Ce:Ze+Ce+1,Ur=de,Kr=de,cn=0,En=0,Fn=Math.abs(vr),Kn=[];cn+En<=Fn;){if(Gr+=Er,Gr<Ze||Gr>=ut)return null;if(Kr=Ur,Kn.push(Ur),Ur=lr[Gr],Ur===void 0){var qn=new e.Point(St.getx(Gr),St.gety(Gr)),Qn=ln(qn,jt);if(Qn.signedDistanceFromCamera>0)Ur=lr[Gr]=Qn.point;else{var ca=Gr-Er,ba=cn===0?Me:new e.Point(St.getx(ca),St.gety(ca));Ur=ci(ba,qn,Kr,Fn-cn+1,jt)}}cn+=En,En=Kr.dist(Ur)}var ya=(Fn-cn)/En,Ta=Ur.sub(Kr),Ea=Ta.mult(ya)._add(Kr);Ea._add(Ta._unit()._perp()._mult(ve*Er));var Ha=Vr+Math.atan2(Ur.y-Kr.y,Ur.x-Kr.x);return Kn.push(Ea),{point:Ea,angle:Ha,path:Kn}}var ja=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Wa(ce,V){for(var ve=0;ve<ce;ve++){var j=V.length;V.resize(j+4),V.float32.set(ja,j*3)}}function wr(ce,V,ve){var j=V[0],de=V[1];return ce[0]=ve[0]*j+ve[4]*de+ve[12],ce[1]=ve[1]*j+ve[5]*de+ve[13],ce[3]=ve[3]*j+ve[7]*de+ve[15],ce}var pn=100,fn=function(V,ve,j){ve===void 0&&(ve=new Tr(V.width+2*pn,V.height+2*pn,25)),j===void 0&&(j=new Tr(V.width+2*pn,V.height+2*pn,25)),this.transform=V,this.grid=ve,this.ignoredGrid=j,this.pitchfactor=Math.cos(V._pitch)*V.cameraToCenterDistance,this.screenRightBoundary=V.width+pn,this.screenBottomBoundary=V.height+pn,this.gridRightBoundary=V.width+2*pn,this.gridBottomBoundary=V.height+2*pn};fn.prototype.placeCollisionBox=function(V,ve,j,de,Me){var Ce=this.projectAndGetPerspectiveRatio(de,V.anchorPointX,V.anchorPointY),Ze=j*Ce.perspectiveRatio,ut=V.x1*Ze+Ce.point.x,St=V.y1*Ze+Ce.point.y,jt=V.x2*Ze+Ce.point.x,lr=V.y2*Ze+Ce.point.y;return!this.isInsideGrid(ut,St,jt,lr)||!ve&&this.grid.hitTest(ut,St,jt,lr,Me)?{box:[],offscreen:!1}:{box:[ut,St,jt,lr],offscreen:this.isOffscreen(ut,St,jt,lr)}},fn.prototype.placeCollisionCircles=function(V,ve,j,de,Me,Ce,Ze,ut,St,jt,lr,vr,Er){var Vr=[],Gr=new e.Point(ve.anchorX,ve.anchorY),Ur=ln(Gr,Ce),Kr=Bn(this.transform.cameraToCenterDistance,Ur.signedDistanceFromCamera),cn=jt?Me/Kr:Me*Kr,En=cn/e.ONE_EM,Fn=ln(Gr,Ze).point,Kn={},qn=ve.lineOffsetX*En,Qn=ve.lineOffsetY*En,ca=Hn(En,de,qn,Qn,!1,Fn,Gr,ve,j,Ze,Kn),ba=!1,ya=!1,Ta=!0;if(ca){for(var Ea=vr*.5*Kr+Er,Ha=new e.Point(-pn,-pn),ni=new e.Point(this.screenRightBoundary,this.screenBottomBoundary),Li=new Ir,ui=ca.first,pi=ca.last,Ba=[],Pi=ui.path.length-1;Pi>=1;Pi--)Ba.push(ui.path[Pi]);for(var zi=1;zi<pi.path.length;zi++)Ba.push(pi.path[zi]);var Ni=Ea*2.5;if(ut){var _i=Ba.map(function(tu){return ln(tu,ut)});_i.some(function(tu){return tu.signedDistanceFromCamera<=0})?Ba=[]:Ba=_i.map(function(tu){return tu.point})}var ji=[];if(Ba.length>0){for(var ii=Ba[0].clone(),wi=Ba[0].clone(),_o=1;_o<Ba.length;_o++)ii.x=Math.min(ii.x,Ba[_o].x),ii.y=Math.min(ii.y,Ba[_o].y),wi.x=Math.max(wi.x,Ba[_o].x),wi.y=Math.max(wi.y,Ba[_o].y);ii.x>=Ha.x&&wi.x<=ni.x&&ii.y>=Ha.y&&wi.y<=ni.y?ji=[Ba]:wi.x<Ha.x||ii.x>ni.x||wi.y<Ha.y||ii.y>ni.y?ji=[]:ji=e.clipLine([Ba],Ha.x,Ha.y,ni.x,ni.y)}for(var Oo=0,Ml=ji;Oo<Ml.length;Oo+=1){var Sl=Ml[Oo];Li.reset(Sl,Ea*.25);var Ql=0;Li.length<=.5*Ea?Ql=1:Ql=Math.ceil(Li.paddedLength/Ni)+1;for(var $l=0;$l<Ql;$l++){var bu=$l/Math.max(Ql-1,1),ql=Li.lerp(bu),Bs=ql.x+pn,Vu=ql.y+pn;Vr.push(Bs,Vu,Ea,0);var bs=Bs-Ea,fl=Vu-Ea,eu=Bs+Ea,Hl=Vu+Ea;if(Ta=Ta&&this.isOffscreen(bs,fl,eu,Hl),ya=ya||this.isInsideGrid(bs,fl,eu,Hl),!V&&this.grid.hitTestCircle(Bs,Vu,Ea,lr)&&(ba=!0,!St))return{circles:[],offscreen:!1,collisionDetected:ba}}}}return{circles:!St&&ba||!ya?[]:Vr,offscreen:Ta,collisionDetected:ba}},fn.prototype.queryRenderedSymbols=function(V){if(V.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};for(var ve=[],j=1/0,de=1/0,Me=-1/0,Ce=-1/0,Ze=0,ut=V;Ze<ut.length;Ze+=1){var St=ut[Ze],jt=new e.Point(St.x+pn,St.y+pn);j=Math.min(j,jt.x),de=Math.min(de,jt.y),Me=Math.max(Me,jt.x),Ce=Math.max(Ce,jt.y),ve.push(jt)}for(var lr=this.grid.query(j,de,Me,Ce).concat(this.ignoredGrid.query(j,de,Me,Ce)),vr={},Er={},Vr=0,Gr=lr;Vr<Gr.length;Vr+=1){var Ur=Gr[Vr],Kr=Ur.key;if(vr[Kr.bucketInstanceId]===void 0&&(vr[Kr.bucketInstanceId]={}),!vr[Kr.bucketInstanceId][Kr.featureIndex]){var cn=[new e.Point(Ur.x1,Ur.y1),new e.Point(Ur.x2,Ur.y1),new e.Point(Ur.x2,Ur.y2),new e.Point(Ur.x1,Ur.y2)];!e.polygonIntersectsPolygon(ve,cn)||(vr[Kr.bucketInstanceId][Kr.featureIndex]=!0,Er[Kr.bucketInstanceId]===void 0&&(Er[Kr.bucketInstanceId]=[]),Er[Kr.bucketInstanceId].push(Kr.featureIndex))}}return Er},fn.prototype.insertCollisionBox=function(V,ve,j,de,Me){var Ce=ve?this.ignoredGrid:this.grid,Ze={bucketInstanceId:j,featureIndex:de,collisionGroupID:Me};Ce.insert(Ze,V[0],V[1],V[2],V[3])},fn.prototype.insertCollisionCircles=function(V,ve,j,de,Me){for(var Ce=ve?this.ignoredGrid:this.grid,Ze={bucketInstanceId:j,featureIndex:de,collisionGroupID:Me},ut=0;ut<V.length;ut+=4)Ce.insertCircle(Ze,V[ut],V[ut+1],V[ut+2])},fn.prototype.projectAndGetPerspectiveRatio=function(V,ve,j){var de=[ve,j,0,1];wr(de,de,V);var Me=new e.Point((de[0]/de[3]+1)/2*this.transform.width+pn,(-de[1]/de[3]+1)/2*this.transform.height+pn);return{point:Me,perspectiveRatio:.5+.5*(this.transform.cameraToCenterDistance/de[3])}},fn.prototype.isOffscreen=function(V,ve,j,de){return j<pn||V>=this.screenRightBoundary||de<pn||ve>this.screenBottomBoundary},fn.prototype.isInsideGrid=function(V,ve,j,de){return j>=0&&V<this.gridRightBoundary&&de>=0&&ve<this.gridBottomBoundary},fn.prototype.getViewportMatrix=function(){var V=e.identity([]);return e.translate(V,V,[-pn,-pn,0]),V};function An(ce,V,ve){return V*(e.EXTENT/(ce.tileSize*Math.pow(2,ve-ce.tileID.overscaledZ)))}var Zn=function(V,ve,j,de){V?this.opacity=Math.max(0,Math.min(1,V.opacity+(V.placed?ve:-ve))):this.opacity=de&&j?1:0,this.placed=j};Zn.prototype.isHidden=function(){return this.opacity===0&&!this.placed};var ua=function(V,ve,j,de,Me){this.text=new Zn(V?V.text:null,ve,j,Me),this.icon=new Zn(V?V.icon:null,ve,de,Me)};ua.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var ea=function(V,ve,j){this.text=V,this.icon=ve,this.skipFade=j},Rn=function(){this.invProjMatrix=e.create(),this.viewportMatrix=e.create(),this.circles=[]},Xn=function(V,ve,j,de,Me){this.bucketInstanceId=V,this.featureIndex=ve,this.sourceLayerIndex=j,this.bucketIndex=de,this.tileID=Me},Ua=function(V){this.crossSourceCollisions=V,this.maxGroupID=0,this.collisionGroups={}};Ua.prototype.get=function(V){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[V]){var ve=++this.maxGroupID;this.collisionGroups[V]={ID:ve,predicate:function(j){return j.collisionGroupID===ve}}}return this.collisionGroups[V]};function li(ce,V,ve,j,de){var Me=e.getAnchorAlignment(ce),Ce=Me.horizontalAlign,Ze=Me.verticalAlign,ut=-(Ce-.5)*V,St=-(Ze-.5)*ve,jt=e.evaluateVariableOffset(ce,j);return new e.Point(ut+jt[0]*de,St+jt[1]*de)}function Bt(ce,V,ve,j,de,Me){var Ce=ce.x1,Ze=ce.x2,ut=ce.y1,St=ce.y2,jt=ce.anchorPointX,lr=ce.anchorPointY,vr=new e.Point(V,ve);return j&&vr._rotate(de?Me:-Me),{x1:Ce+vr.x,y1:ut+vr.y,x2:Ze+vr.x,y2:St+vr.y,anchorPointX:jt,anchorPointY:lr}}var hr=function(V,ve,j,de){this.transform=V.clone(),this.collisionIndex=new fn(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=ve,this.retainedQueryData={},this.collisionGroups=new Ua(j),this.collisionCircleArrays={},this.prevPlacement=de,de&&(de.prevPlacement=void 0),this.placedOrientations={}};hr.prototype.getBucketParts=function(V,ve,j,de){var Me=j.getBucket(ve),Ce=j.latestFeatureIndex;if(!(!Me||!Ce||ve.id!==Me.layerIds[0])){var Ze=j.collisionBoxArray,ut=Me.layers[0].layout,St=Math.pow(2,this.transform.zoom-j.tileID.overscaledZ),jt=j.tileSize/e.EXTENT,lr=this.transform.calculatePosMatrix(j.tileID.toUnwrapped()),vr=ut.get("text-pitch-alignment")==="map",Er=ut.get("text-rotation-alignment")==="map",Vr=An(j,1,this.transform.zoom),Gr=Wr(lr,vr,Er,this.transform,Vr),Ur=null;if(vr){var Kr=wn(lr,vr,Er,this.transform,Vr);Ur=e.multiply([],this.transform.labelPlaneMatrix,Kr)}this.retainedQueryData[Me.bucketInstanceId]=new Xn(Me.bucketInstanceId,Ce,Me.sourceLayerIndex,Me.index,j.tileID);var cn={bucket:Me,layout:ut,posMatrix:lr,textLabelPlaneMatrix:Gr,labelToScreenMatrix:Ur,scale:St,textPixelRatio:jt,holdingForFade:j.holdingForFade(),collisionBoxArray:Ze,partiallyEvaluatedTextSize:e.evaluateSizeForZoom(Me.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(Me.sourceID)};if(de)for(var En=0,Fn=Me.sortKeyRanges;En<Fn.length;En+=1){var Kn=Fn[En],qn=Kn.sortKey,Qn=Kn.symbolInstanceStart,ca=Kn.symbolInstanceEnd;V.push({sortKey:qn,symbolInstanceStart:Qn,symbolInstanceEnd:ca,parameters:cn})}else V.push({symbolInstanceStart:0,symbolInstanceEnd:Me.symbolInstances.length,parameters:cn})}},hr.prototype.attemptAnchorPlacement=function(V,ve,j,de,Me,Ce,Ze,ut,St,jt,lr,vr,Er,Vr,Gr){var Ur=[vr.textOffset0,vr.textOffset1],Kr=li(V,j,de,Ur,Me),cn=this.collisionIndex.placeCollisionBox(Bt(ve,Kr.x,Kr.y,Ce,Ze,this.transform.angle),lr,ut,St,jt.predicate);if(Gr){var En=this.collisionIndex.placeCollisionBox(Bt(Gr,Kr.x,Kr.y,Ce,Ze,this.transform.angle),lr,ut,St,jt.predicate);if(En.box.length===0)return}if(cn.box.length>0){var Fn;return this.prevPlacement&&this.prevPlacement.variableOffsets[vr.crossTileID]&&this.prevPlacement.placements[vr.crossTileID]&&this.prevPlacement.placements[vr.crossTileID].text&&(Fn=this.prevPlacement.variableOffsets[vr.crossTileID].anchor),this.variableOffsets[vr.crossTileID]={textOffset:Ur,width:j,height:de,anchor:V,textBoxScale:Me,prevAnchor:Fn},this.markUsedJustification(Er,V,vr,Vr),Er.allowVerticalPlacement&&(this.markUsedOrientation(Er,Vr,vr),this.placedOrientations[vr.crossTileID]=Vr),{shift:Kr,placedGlyphBoxes:cn}}},hr.prototype.placeLayerBucketPart=function(V,ve,j){var de=this,Me=V.parameters,Ce=Me.bucket,Ze=Me.layout,ut=Me.posMatrix,St=Me.textLabelPlaneMatrix,jt=Me.labelToScreenMatrix,lr=Me.textPixelRatio,vr=Me.holdingForFade,Er=Me.collisionBoxArray,Vr=Me.partiallyEvaluatedTextSize,Gr=Me.collisionGroup,Ur=Ze.get("text-optional"),Kr=Ze.get("icon-optional"),cn=Ze.get("text-allow-overlap"),En=Ze.get("icon-allow-overlap"),Fn=Ze.get("text-rotation-alignment")==="map",Kn=Ze.get("text-pitch-alignment")==="map",qn=Ze.get("icon-text-fit")!=="none",Qn=Ze.get("symbol-z-order")==="viewport-y",ca=cn&&(En||!Ce.hasIconData()||Kr),ba=En&&(cn||!Ce.hasTextData()||Ur);!Ce.collisionArrays&&Er&&Ce.deserializeCollisionBoxes(Er);var ya=function(ui,pi){if(!ve[ui.crossTileID]){if(vr){de.placements[ui.crossTileID]=new ea(!1,!1,!1);return}var Ba=!1,Pi=!1,zi=!0,Ni=null,_i={box:null,offscreen:null},ji={box:null,offscreen:null},ii=null,wi=null,_o=null,Oo=0,Ml=0,Sl=0;pi.textFeatureIndex?Oo=pi.textFeatureIndex:ui.useRuntimeCollisionCircles&&(Oo=ui.featureIndex),pi.verticalTextFeatureIndex&&(Ml=pi.verticalTextFeatureIndex);var Ql=pi.textBox;if(Ql){var $l=function(Eo){var $s=e.WritingMode.horizontal;if(Ce.allowVerticalPlacement&&!Eo&&de.prevPlacement){var qs=de.prevPlacement.placedOrientations[ui.crossTileID];qs&&(de.placedOrientations[ui.crossTileID]=qs,$s=qs,de.markUsedOrientation(Ce,$s,ui))}return $s},bu=function(Eo,$s){if(Ce.allowVerticalPlacement&&ui.numVerticalGlyphVertices>0&&pi.verticalTextBox)for(var qs=0,Rf=Ce.writingModes;qs<Rf.length;qs+=1){var ac=Rf[qs];if(ac===e.WritingMode.vertical?(_i=$s(),ji=_i):_i=Eo(),_i&&_i.box&&_i.box.length)break}else _i=Eo()};if(Ze.get("text-variable-anchor")){var bs=Ze.get("text-variable-anchor");if(de.prevPlacement&&de.prevPlacement.variableOffsets[ui.crossTileID]){var fl=de.prevPlacement.variableOffsets[ui.crossTileID];bs.indexOf(fl.anchor)>0&&(bs=bs.filter(function(Eo){return Eo!==fl.anchor}),bs.unshift(fl.anchor))}var eu=function(Eo,$s,qs){for(var Rf=Eo.x2-Eo.x1,ac=Eo.y2-Eo.y1,Qc=ui.textBoxScale,$c=qn&&!En?$s:null,bf={box:[],offscreen:!1},qc=cn?bs.length*2:bs.length,If=0;If<qc;++If){var eh=bs[If%bs.length],th=If>=bs.length,ic=de.attemptAnchorPlacement(eh,Eo,Rf,ac,Qc,Fn,Kn,lr,ut,Gr,th,ui,Ce,qs,$c);if(ic&&(bf=ic.placedGlyphBoxes,bf&&bf.box&&bf.box.length)){Ba=!0,Ni=ic.shift;break}}return bf},Hl=function(){return eu(Ql,pi.iconBox,e.WritingMode.horizontal)},tu=function(){var Eo=pi.verticalTextBox,$s=_i&&_i.box&&_i.box.length;return Ce.allowVerticalPlacement&&!$s&&ui.numVerticalGlyphVertices>0&&Eo?eu(Eo,pi.verticalIconBox,e.WritingMode.vertical):{box:null,offscreen:null}};bu(Hl,tu),_i&&(Ba=_i.box,zi=_i.offscreen);var Cf=$l(_i&&_i.box);if(!Ba&&de.prevPlacement){var Zu=de.prevPlacement.variableOffsets[ui.crossTileID];Zu&&(de.variableOffsets[ui.crossTileID]=Zu,de.markUsedJustification(Ce,Zu.anchor,ui,Cf))}}else{var ql=function(Eo,$s){var qs=de.collisionIndex.placeCollisionBox(Eo,cn,lr,ut,Gr.predicate);return qs&&qs.box&&qs.box.length&&(de.markUsedOrientation(Ce,$s,ui),de.placedOrientations[ui.crossTileID]=$s),qs},Bs=function(){return ql(Ql,e.WritingMode.horizontal)},Vu=function(){var Eo=pi.verticalTextBox;return Ce.allowVerticalPlacement&&ui.numVerticalGlyphVertices>0&&Eo?ql(Eo,e.WritingMode.vertical):{box:null,offscreen:null}};bu(Bs,Vu),$l(_i&&_i.box&&_i.box.length)}}if(ii=_i,Ba=ii&&ii.box&&ii.box.length>0,zi=ii&&ii.offscreen,ui.useRuntimeCollisionCircles){var cs=Ce.text.placedSymbolArray.get(ui.centerJustifiedTextSymbolIndex),mf=e.evaluateSizeForFeature(Ce.textSizeData,Vr,cs),Es=Ze.get("text-padding"),xf=ui.collisionCircleDiameter;wi=de.collisionIndex.placeCollisionCircles(cn,cs,Ce.lineVertexArray,Ce.glyphOffsetArray,mf,ut,St,jt,j,Kn,Gr.predicate,xf,Es),Ba=cn||wi.circles.length>0&&!wi.collisionDetected,zi=zi&&wi.offscreen}if(pi.iconFeatureIndex&&(Sl=pi.iconFeatureIndex),pi.iconBox){var Lf=function(Eo){var $s=qn&&Ni?Bt(Eo,Ni.x,Ni.y,Fn,Kn,de.transform.angle):Eo;return de.collisionIndex.placeCollisionBox($s,En,lr,ut,Gr.predicate)};ji&&ji.box&&ji.box.length&&pi.verticalIconBox?(_o=Lf(pi.verticalIconBox),Pi=_o.box.length>0):(_o=Lf(pi.iconBox),Pi=_o.box.length>0),zi=zi&&_o.offscreen}var Pf=Ur||ui.numHorizontalGlyphVertices===0&&ui.numVerticalGlyphVertices===0,kc=Kr||ui.numIconVertices===0;if(!Pf&&!kc?Pi=Ba=Pi&&Ba:kc?Pf||(Pi=Pi&&Ba):Ba=Pi&&Ba,Ba&&ii&&ii.box&&(ji&&ji.box&&Ml?de.collisionIndex.insertCollisionBox(ii.box,Ze.get("text-ignore-placement"),Ce.bucketInstanceId,Ml,Gr.ID):de.collisionIndex.insertCollisionBox(ii.box,Ze.get("text-ignore-placement"),Ce.bucketInstanceId,Oo,Gr.ID)),Pi&&_o&&de.collisionIndex.insertCollisionBox(_o.box,Ze.get("icon-ignore-placement"),Ce.bucketInstanceId,Sl,Gr.ID),wi&&(Ba&&de.collisionIndex.insertCollisionCircles(wi.circles,Ze.get("text-ignore-placement"),Ce.bucketInstanceId,Oo,Gr.ID),j)){var Df=Ce.bucketInstanceId,af=de.collisionCircleArrays[Df];af===void 0&&(af=de.collisionCircleArrays[Df]=new Rn);for(var of=0;of<wi.circles.length;of+=4)af.circles.push(wi.circles[of+0]),af.circles.push(wi.circles[of+1]),af.circles.push(wi.circles[of+2]),af.circles.push(wi.collisionDetected?1:0)}de.placements[ui.crossTileID]=new ea(Ba||ca,Pi||ba,zi||Ce.justReloaded),ve[ui.crossTileID]=!0}};if(Qn)for(var Ta=Ce.getSortedSymbolIndexes(this.transform.angle),Ea=Ta.length-1;Ea>=0;--Ea){var Ha=Ta[Ea];ya(Ce.symbolInstances.get(Ha),Ce.collisionArrays[Ha])}else for(var ni=V.symbolInstanceStart;ni<V.symbolInstanceEnd;ni++)ya(Ce.symbolInstances.get(ni),Ce.collisionArrays[ni]);if(j&&Ce.bucketInstanceId in this.collisionCircleArrays){var Li=this.collisionCircleArrays[Ce.bucketInstanceId];e.invert(Li.invProjMatrix,ut),Li.viewportMatrix=this.collisionIndex.getViewportMatrix()}Ce.justReloaded=!1},hr.prototype.markUsedJustification=function(V,ve,j,de){var Me={left:j.leftJustifiedTextSymbolIndex,center:j.centerJustifiedTextSymbolIndex,right:j.rightJustifiedTextSymbolIndex},Ce;de===e.WritingMode.vertical?Ce=j.verticalPlacedTextSymbolIndex:Ce=Me[e.getAnchorJustification(ve)];for(var Ze=[j.leftJustifiedTextSymbolIndex,j.centerJustifiedTextSymbolIndex,j.rightJustifiedTextSymbolIndex,j.verticalPlacedTextSymbolIndex],ut=0,St=Ze;ut<St.length;ut+=1){var jt=St[ut];jt>=0&&(Ce>=0&&jt!==Ce?V.text.placedSymbolArray.get(jt).crossTileID=0:V.text.placedSymbolArray.get(jt).crossTileID=j.crossTileID)}},hr.prototype.markUsedOrientation=function(V,ve,j){for(var de=ve===e.WritingMode.horizontal||ve===e.WritingMode.horizontalOnly?ve:0,Me=ve===e.WritingMode.vertical?ve:0,Ce=[j.leftJustifiedTextSymbolIndex,j.centerJustifiedTextSymbolIndex,j.rightJustifiedTextSymbolIndex],Ze=0,ut=Ce;Ze<ut.length;Ze+=1){var St=ut[Ze];V.text.placedSymbolArray.get(St).placedOrientation=de}j.verticalPlacedTextSymbolIndex&&(V.text.placedSymbolArray.get(j.verticalPlacedTextSymbolIndex).placedOrientation=Me)},hr.prototype.commit=function(V){this.commitTime=V,this.zoomAtLastRecencyCheck=this.transform.zoom;var ve=this.prevPlacement,j=!1;this.prevZoomAdjustment=ve?ve.zoomAdjustment(this.transform.zoom):0;var de=ve?ve.symbolFadeChange(V):1,Me=ve?ve.opacities:{},Ce=ve?ve.variableOffsets:{},Ze=ve?ve.placedOrientations:{};for(var ut in this.placements){var St=this.placements[ut],jt=Me[ut];jt?(this.opacities[ut]=new ua(jt,de,St.text,St.icon),j=j||St.text!==jt.text.placed||St.icon!==jt.icon.placed):(this.opacities[ut]=new ua(null,de,St.text,St.icon,St.skipFade),j=j||St.text||St.icon)}for(var lr in Me){var vr=Me[lr];if(!this.opacities[lr]){var Er=new ua(vr,de,!1,!1);Er.isHidden()||(this.opacities[lr]=Er,j=j||vr.text.placed||vr.icon.placed)}}for(var Vr in Ce)!this.variableOffsets[Vr]&&this.opacities[Vr]&&!this.opacities[Vr].isHidden()&&(this.variableOffsets[Vr]=Ce[Vr]);for(var Gr in Ze)!this.placedOrientations[Gr]&&this.opacities[Gr]&&!this.opacities[Gr].isHidden()&&(this.placedOrientations[Gr]=Ze[Gr]);j?this.lastPlacementChangeTime=V:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=ve?ve.lastPlacementChangeTime:V)},hr.prototype.updateLayerOpacities=function(V,ve){for(var j={},de=0,Me=ve;de<Me.length;de+=1){var Ce=Me[de],Ze=Ce.getBucket(V);Ze&&Ce.latestFeatureIndex&&V.id===Ze.layerIds[0]&&this.updateBucketOpacities(Ze,j,Ce.collisionBoxArray)}},hr.prototype.updateBucketOpacities=function(V,ve,j){var de=this;V.hasTextData()&&V.text.opacityVertexArray.clear(),V.hasIconData()&&V.icon.opacityVertexArray.clear(),V.hasIconCollisionBoxData()&&V.iconCollisionBox.collisionVertexArray.clear(),V.hasTextCollisionBoxData()&&V.textCollisionBox.collisionVertexArray.clear();var Me=V.layers[0].layout,Ce=new ua(null,0,!1,!1,!0),Ze=Me.get("text-allow-overlap"),ut=Me.get("icon-allow-overlap"),St=Me.get("text-variable-anchor"),jt=Me.get("text-rotation-alignment")==="map",lr=Me.get("text-pitch-alignment")==="map",vr=Me.get("icon-text-fit")!=="none",Er=new ua(null,0,Ze&&(ut||!V.hasIconData()||Me.get("icon-optional")),ut&&(Ze||!V.hasTextData()||Me.get("text-optional")),!0);!V.collisionArrays&&j&&(V.hasIconCollisionBoxData()||V.hasTextCollisionBoxData())&&V.deserializeCollisionBoxes(j);for(var Vr=function(cn,En,Fn){for(var Kn=0;Kn<En/4;Kn++)cn.opacityVertexArray.emplaceBack(Fn)},Gr=function(cn){var En=V.symbolInstances.get(cn),Fn=En.numHorizontalGlyphVertices,Kn=En.numVerticalGlyphVertices,qn=En.crossTileID,Qn=ve[qn],ca=de.opacities[qn];Qn?ca=Ce:ca||(ca=Er,de.opacities[qn]=ca),ve[qn]=!0;var ba=Fn>0||Kn>0,ya=En.numIconVertices>0,Ta=de.placedOrientations[En.crossTileID],Ea=Ta===e.WritingMode.vertical,Ha=Ta===e.WritingMode.horizontal||Ta===e.WritingMode.horizontalOnly;if(ba){var ni=zr(ca.text),Li=Ea?gn:ni;Vr(V.text,Fn,Li);var ui=Ha?gn:ni;Vr(V.text,Kn,ui);var pi=ca.text.isHidden();[En.rightJustifiedTextSymbolIndex,En.centerJustifiedTextSymbolIndex,En.leftJustifiedTextSymbolIndex].forEach(function(Sl){Sl>=0&&(V.text.placedSymbolArray.get(Sl).hidden=pi||Ea?1:0)}),En.verticalPlacedTextSymbolIndex>=0&&(V.text.placedSymbolArray.get(En.verticalPlacedTextSymbolIndex).hidden=pi||Ha?1:0);var Ba=de.variableOffsets[En.crossTileID];Ba&&de.markUsedJustification(V,Ba.anchor,En,Ta);var Pi=de.placedOrientations[En.crossTileID];Pi&&(de.markUsedJustification(V,"left",En,Pi),de.markUsedOrientation(V,Pi,En))}if(ya){var zi=zr(ca.icon),Ni=!(vr&&En.verticalPlacedIconSymbolIndex&&Ea);if(En.placedIconSymbolIndex>=0){var _i=Ni?zi:gn;Vr(V.icon,En.numIconVertices,_i),V.icon.placedSymbolArray.get(En.placedIconSymbolIndex).hidden=ca.icon.isHidden()}if(En.verticalPlacedIconSymbolIndex>=0){var ji=Ni?gn:zi;Vr(V.icon,En.numVerticalIconVertices,ji),V.icon.placedSymbolArray.get(En.verticalPlacedIconSymbolIndex).hidden=ca.icon.isHidden()}}if(V.hasIconCollisionBoxData()||V.hasTextCollisionBoxData()){var ii=V.collisionArrays[cn];if(ii){var wi=new e.Point(0,0);if(ii.textBox||ii.verticalTextBox){var _o=!0;if(St){var Oo=de.variableOffsets[qn];Oo?(wi=li(Oo.anchor,Oo.width,Oo.height,Oo.textOffset,Oo.textBoxScale),jt&&wi._rotate(lr?de.transform.angle:-de.transform.angle)):_o=!1}ii.textBox&&rn(V.textCollisionBox.collisionVertexArray,ca.text.placed,!_o||Ea,wi.x,wi.y),ii.verticalTextBox&&rn(V.textCollisionBox.collisionVertexArray,ca.text.placed,!_o||Ha,wi.x,wi.y)}var Ml=Boolean(!Ha&&ii.verticalIconBox);ii.iconBox&&rn(V.iconCollisionBox.collisionVertexArray,ca.icon.placed,Ml,vr?wi.x:0,vr?wi.y:0),ii.verticalIconBox&&rn(V.iconCollisionBox.collisionVertexArray,ca.icon.placed,!Ml,vr?wi.x:0,vr?wi.y:0)}}},Ur=0;Ur<V.symbolInstances.length;Ur++)Gr(Ur);if(V.sortFeatures(this.transform.angle),this.retainedQueryData[V.bucketInstanceId]&&(this.retainedQueryData[V.bucketInstanceId].featureSortOrder=V.featureSortOrder),V.hasTextData()&&V.text.opacityVertexBuffer&&V.text.opacityVertexBuffer.updateData(V.text.opacityVertexArray),V.hasIconData()&&V.icon.opacityVertexBuffer&&V.icon.opacityVertexBuffer.updateData(V.icon.opacityVertexArray),V.hasIconCollisionBoxData()&&V.iconCollisionBox.collisionVertexBuffer&&V.iconCollisionBox.collisionVertexBuffer.updateData(V.iconCollisionBox.collisionVertexArray),V.hasTextCollisionBoxData()&&V.textCollisionBox.collisionVertexBuffer&&V.textCollisionBox.collisionVertexBuffer.updateData(V.textCollisionBox.collisionVertexArray),V.bucketInstanceId in this.collisionCircleArrays){var Kr=this.collisionCircleArrays[V.bucketInstanceId];V.placementInvProjMatrix=Kr.invProjMatrix,V.placementViewportMatrix=Kr.viewportMatrix,V.collisionCircleArray=Kr.circles,delete this.collisionCircleArrays[V.bucketInstanceId]}},hr.prototype.symbolFadeChange=function(V){return this.fadeDuration===0?1:(V-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},hr.prototype.zoomAdjustment=function(V){return Math.max(0,(this.transform.zoom-V)/1.5)},hr.prototype.hasTransitions=function(V){return this.stale||V-this.lastPlacementChangeTime<this.fadeDuration},hr.prototype.stillRecent=function(V,ve){var j=this.zoomAtLastRecencyCheck===ve?1-this.zoomAdjustment(ve):1;return this.zoomAtLastRecencyCheck=ve,this.commitTime+this.fadeDuration*j>V},hr.prototype.setStale=function(){this.stale=!0};function rn(ce,V,ve,j,de){ce.emplaceBack(V?1:0,ve?1:0,j||0,de||0),ce.emplaceBack(V?1:0,ve?1:0,j||0,de||0),ce.emplaceBack(V?1:0,ve?1:0,j||0,de||0),ce.emplaceBack(V?1:0,ve?1:0,j||0,de||0)}var vn=Math.pow(2,25),en=Math.pow(2,24),Tn=Math.pow(2,17),xn=Math.pow(2,16),un=Math.pow(2,9),gr=Math.pow(2,8),yr=Math.pow(2,1);function zr(ce){if(ce.opacity===0&&!ce.placed)return 0;if(ce.opacity===1&&ce.placed)return 4294967295;var V=ce.placed?1:0,ve=Math.floor(ce.opacity*127);return ve*vn+V*en+ve*Tn+V*xn+ve*un+V*gr+ve*yr+V}var gn=0,On=function(V){this._sortAcrossTiles=V.layout.get("symbol-z-order")!=="viewport-y"&&V.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};On.prototype.continuePlacement=function(V,ve,j,de,Me){for(var Ce=this._bucketParts;this._currentTileIndex<V.length;){var Ze=V[this._currentTileIndex];if(ve.getBucketParts(Ce,de,Ze,this._sortAcrossTiles),this._currentTileIndex++,Me())return!0}for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,Ce.sort(function(St,jt){return St.sortKey-jt.sortKey}));this._currentPartIndex<Ce.length;){var ut=Ce[this._currentPartIndex];if(ve.placeLayerBucketPart(ut,this._seenCrossTileIDs,j),this._currentPartIndex++,Me())return!0}return!1};var ta=function(V,ve,j,de,Me,Ce,Ze){this.placement=new hr(V,Me,Ce,Ze),this._currentPlacementIndex=ve.length-1,this._forceFullPlacement=j,this._showCollisionBoxes=de,this._done=!1};ta.prototype.isDone=function(){return this._done},ta.prototype.continuePlacement=function(V,ve,j){for(var de=this,Me=e.browser.now(),Ce=function(){var lr=e.browser.now()-Me;return de._forceFullPlacement?!1:lr>2};this._currentPlacementIndex>=0;){var Ze=V[this._currentPlacementIndex],ut=ve[Ze],St=this.placement.collisionIndex.transform.zoom;if(ut.type==="symbol"&&(!ut.minzoom||ut.minzoom<=St)&&(!ut.maxzoom||ut.maxzoom>St)){this._inProgressLayer||(this._inProgressLayer=new On(ut));var jt=this._inProgressLayer.continuePlacement(j[ut.source],this.placement,this._showCollisionBoxes,ut,Ce);if(jt)return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},ta.prototype.commit=function(V){return this.placement.commit(V),this.placement};var _n=512/e.EXTENT/2,jn=function(V,ve,j){this.tileID=V,this.indexedSymbolInstances={},this.bucketInstanceId=j;for(var de=0;de<ve.length;de++){var Me=ve.get(de),Ce=Me.key;this.indexedSymbolInstances[Ce]||(this.indexedSymbolInstances[Ce]=[]),this.indexedSymbolInstances[Ce].push({crossTileID:Me.crossTileID,coord:this.getScaledCoordinates(Me,V)})}};jn.prototype.getScaledCoordinates=function(V,ve){var j=ve.canonical.z-this.tileID.canonical.z,de=_n/Math.pow(2,j);return{x:Math.floor((ve.canonical.x*e.EXTENT+V.anchorX)*de),y:Math.floor((ve.canonical.y*e.EXTENT+V.anchorY)*de)}},jn.prototype.findMatches=function(V,ve,j){for(var de=this.tileID.canonical.z<ve.canonical.z?1:Math.pow(2,this.tileID.canonical.z-ve.canonical.z),Me=0;Me<V.length;Me++){var Ce=V.get(Me);if(!Ce.crossTileID){var Ze=this.indexedSymbolInstances[Ce.key];if(!!Ze)for(var ut=this.getScaledCoordinates(Ce,ve),St=0,jt=Ze;St<jt.length;St+=1){var lr=jt[St];if(Math.abs(lr.coord.x-ut.x)<=de&&Math.abs(lr.coord.y-ut.y)<=de&&!j[lr.crossTileID]){j[lr.crossTileID]=!0,Ce.crossTileID=lr.crossTileID;break}}}}};var aa=function(){this.maxCrossTileID=0};aa.prototype.generate=function(){return++this.maxCrossTileID};var pa=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};pa.prototype.handleWrapJump=function(V){var ve=Math.round((V-this.lng)/360);if(ve!==0)for(var j in this.indexes){var de=this.indexes[j],Me={};for(var Ce in de){var Ze=de[Ce];Ze.tileID=Ze.tileID.unwrapTo(Ze.tileID.wrap+ve),Me[Ze.tileID.key]=Ze}this.indexes[j]=Me}this.lng=V},pa.prototype.addBucket=function(V,ve,j){if(this.indexes[V.overscaledZ]&&this.indexes[V.overscaledZ][V.key]){if(this.indexes[V.overscaledZ][V.key].bucketInstanceId===ve.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(V.overscaledZ,this.indexes[V.overscaledZ][V.key])}for(var de=0;de<ve.symbolInstances.length;de++){var Me=ve.symbolInstances.get(de);Me.crossTileID=0}this.usedCrossTileIDs[V.overscaledZ]||(this.usedCrossTileIDs[V.overscaledZ]={});var Ce=this.usedCrossTileIDs[V.overscaledZ];for(var Ze in this.indexes){var ut=this.indexes[Ze];if(Number(Ze)>V.overscaledZ)for(var St in ut){var jt=ut[St];jt.tileID.isChildOf(V)&&jt.findMatches(ve.symbolInstances,V,Ce)}else{var lr=V.scaledTo(Number(Ze)),vr=ut[lr.key];vr&&vr.findMatches(ve.symbolInstances,V,Ce)}}for(var Er=0;Er<ve.symbolInstances.length;Er++){var Vr=ve.symbolInstances.get(Er);Vr.crossTileID||(Vr.crossTileID=j.generate(),Ce[Vr.crossTileID]=!0)}return this.indexes[V.overscaledZ]===void 0&&(this.indexes[V.overscaledZ]={}),this.indexes[V.overscaledZ][V.key]=new jn(V,ve.symbolInstances,ve.bucketInstanceId),!0},pa.prototype.removeBucketCrossTileIDs=function(V,ve){for(var j in ve.indexedSymbolInstances)for(var de=0,Me=ve.indexedSymbolInstances[j];de<Me.length;de+=1){var Ce=Me[de];delete this.usedCrossTileIDs[V][Ce.crossTileID]}},pa.prototype.removeStaleBuckets=function(V){var ve=!1;for(var j in this.indexes){var de=this.indexes[j];for(var Me in de)V[de[Me].bucketInstanceId]||(this.removeBucketCrossTileIDs(j,de[Me]),delete de[Me],ve=!0)}return ve};var ma=function(){this.layerIndexes={},this.crossTileIDs=new aa,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};ma.prototype.addLayer=function(V,ve,j){var de=this.layerIndexes[V.id];de===void 0&&(de=this.layerIndexes[V.id]=new pa);var Me=!1,Ce={};de.handleWrapJump(j);for(var Ze=0,ut=ve;Ze<ut.length;Ze+=1){var St=ut[Ze],jt=St.getBucket(V);!jt||V.id!==jt.layerIds[0]||(jt.bucketInstanceId||(jt.bucketInstanceId=++this.maxBucketInstanceId),de.addBucket(St.tileID,jt,this.crossTileIDs)&&(Me=!0),Ce[jt.bucketInstanceId]=!0)}return de.removeStaleBuckets(Ce)&&(Me=!0),Me},ma.prototype.pruneUnusedLayers=function(V){var ve={};V.forEach(function(de){ve[de]=!0});for(var j in this.layerIndexes)ve[j]||delete this.layerIndexes[j]};var sa=function(ce,V){return e.emitValidationErrors(ce,V&&V.filter(function(ve){return ve.identifier!=="source.canvas"}))},Aa=e.pick(nr,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),ho=e.pick(nr,["setCenter","setZoom","setBearing","setPitch"]),Ro=Hr(),jo=function(ce){function V(ve,j){var de=this;j===void 0&&(j={}),ce.call(this),this.map=ve,this.dispatcher=new R(Ht(),this),this.imageManager=new _,this.imageManager.setEventedParent(this),this.glyphManager=new T(ve._requestManager,j.localIdeographFontFamily),this.lineAtlas=new D(256,512),this.crossTileSymbolIndex=new ma,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new e.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",e.getReferrer());var Me=this;this._rtlTextPluginCallback=V.registerForPluginStateChange(function(Ce){var Ze={pluginStatus:Ce.pluginStatus,pluginURL:Ce.pluginURL};Me.dispatcher.broadcast("syncRTLPluginState",Ze,function(ut,St){if(e.triggerPluginCompletionEvent(ut),St){var jt=St.every(function(vr){return vr});if(jt)for(var lr in Me.sourceCaches)Me.sourceCaches[lr].reload()}})}),this.on("data",function(Ce){if(!(Ce.dataType!=="source"||Ce.sourceDataType!=="metadata")){var Ze=de.sourceCaches[Ce.sourceId];if(!!Ze){var ut=Ze.getSource();if(!(!ut||!ut.vectorLayerIds))for(var St in de._layers){var jt=de._layers[St];jt.source===ut.id&&de._validateLayer(jt)}}}})}return ce&&(V.__proto__=ce),V.prototype=Object.create(ce&&ce.prototype),V.prototype.constructor=V,V.prototype.loadURL=function(j,de){var Me=this;de===void 0&&(de={}),this.fire(new e.Event("dataloading",{dataType:"style"}));var Ce=typeof de.validate=="boolean"?de.validate:!e.isMapboxURL(j);j=this.map._requestManager.normalizeStyleURL(j,de.accessToken);var Ze=this.map._requestManager.transformRequest(j,e.ResourceType.Style);this._request=e.getJSON(Ze,function(ut,St){Me._request=null,ut?Me.fire(new e.ErrorEvent(ut)):St&&Me._load(St,Ce)})},V.prototype.loadJSON=function(j,de){var Me=this;de===void 0&&(de={}),this.fire(new e.Event("dataloading",{dataType:"style"})),this._request=e.browser.frame(function(){Me._request=null,Me._load(j,de.validate!==!1)})},V.prototype.loadEmpty=function(){this.fire(new e.Event("dataloading",{dataType:"style"})),this._load(Ro,!1)},V.prototype._load=function(j,de){if(!(de&&sa(this,e.validateStyle(j)))){this._loaded=!0,this.stylesheet=j;for(var Me in j.sources)this.addSource(Me,j.sources[Me],{validate:!1});j.sprite?this._loadSprite(j.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(j.glyphs);var Ce=Mr(this.stylesheet.layers);this._order=Ce.map(function(jt){return jt.id}),this._layers={},this._serializedLayers={};for(var Ze=0,ut=Ce;Ze<ut.length;Ze+=1){var St=ut[Ze];St=e.createStyleLayer(St),St.setEventedParent(this,{layer:{id:St.id}}),this._layers[St.id]=St,this._serializedLayers[St.id]=St.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new I(this.stylesheet.light),this.fire(new e.Event("data",{dataType:"style"})),this.fire(new e.Event("style.load"))}},V.prototype._loadSprite=function(j){var de=this;this._spriteRequest=h(j,this.map._requestManager,function(Me,Ce){if(de._spriteRequest=null,Me)de.fire(new e.ErrorEvent(Me));else if(Ce)for(var Ze in Ce)de.imageManager.addImage(Ze,Ce[Ze]);de.imageManager.setLoaded(!0),de._availableImages=de.imageManager.listImages(),de.dispatcher.broadcast("setImages",de._availableImages),de.fire(new e.Event("data",{dataType:"style"}))})},V.prototype._validateLayer=function(j){var de=this.sourceCaches[j.source];if(!!de){var Me=j.sourceLayer;if(!!Me){var Ce=de.getSource();(Ce.type==="geojson"||Ce.vectorLayerIds&&Ce.vectorLayerIds.indexOf(Me)===-1)&&this.fire(new e.ErrorEvent(new Error('Source layer "'+Me+'" does not exist on source "'+Ce.id+'" as specified by style layer "'+j.id+'"')))}}},V.prototype.loaded=function(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(var j in this.sourceCaches)if(!this.sourceCaches[j].loaded())return!1;return!!this.imageManager.isLoaded()},V.prototype._serializeLayers=function(j){for(var de=[],Me=0,Ce=j;Me<Ce.length;Me+=1){var Ze=Ce[Me],ut=this._layers[Ze];ut.type!=="custom"&&de.push(ut.serialize())}return de},V.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var j in this.sourceCaches)if(this.sourceCaches[j].hasTransition())return!0;for(var de in this._layers)if(this._layers[de].hasTransition())return!0;return!1},V.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},V.prototype.update=function(j){if(!!this._loaded){var de=this._changed;if(this._changed){var Me=Object.keys(this._updatedLayers),Ce=Object.keys(this._removedLayers);(Me.length||Ce.length)&&this._updateWorkerLayers(Me,Ce);for(var Ze in this._updatedSources){var ut=this._updatedSources[Ze];ut==="reload"?this._reloadSource(Ze):ut==="clear"&&this._clearSource(Ze)}this._updateTilesForChangedImages();for(var St in this._updatedPaintProps)this._layers[St].updateTransitions(j);this.light.updateTransitions(j),this._resetUpdates()}for(var jt in this.sourceCaches)this.sourceCaches[jt].used=!1;for(var lr=0,vr=this._order;lr<vr.length;lr+=1){var Er=vr[lr],Vr=this._layers[Er];Vr.recalculate(j,this._availableImages),!Vr.isHidden(j.zoom)&&Vr.source&&(this.sourceCaches[Vr.source].used=!0)}this.light.recalculate(j),this.z=j.zoom,de&&this.fire(new e.Event("data",{dataType:"style"}))}},V.prototype._updateTilesForChangedImages=function(){var j=Object.keys(this._changedImages);if(j.length){for(var de in this.sourceCaches)this.sourceCaches[de].reloadTilesForDependencies(["icons","patterns"],j);this._changedImages={}}},V.prototype._updateWorkerLayers=function(j,de){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(j),removedIds:de})},V.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},V.prototype.setState=function(j){var de=this;if(this._checkLoaded(),sa(this,e.validateStyle(j)))return!1;j=e.clone$1(j),j.layers=Mr(j.layers);var Me=Or(this.serialize(),j).filter(function(Ze){return!(Ze.command in ho)});if(Me.length===0)return!1;var Ce=Me.filter(function(Ze){return!(Ze.command in Aa)});if(Ce.length>0)throw new Error("Unimplemented: "+Ce.map(function(Ze){return Ze.command}).join(", ")+".");return Me.forEach(function(Ze){Ze.command!=="setTransition"&&de[Ze.command].apply(de,Ze.args)}),this.stylesheet=j,!0},V.prototype.addImage=function(j,de){if(this.getImage(j))return this.fire(new e.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(j,de),this._availableImages=this.imageManager.listImages(),this._changedImages[j]=!0,this._changed=!0,this.fire(new e.Event("data",{dataType:"style"}))},V.prototype.updateImage=function(j,de){this.imageManager.updateImage(j,de)},V.prototype.getImage=function(j){return this.imageManager.getImage(j)},V.prototype.removeImage=function(j){if(!this.getImage(j))return this.fire(new e.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(j),this._availableImages=this.imageManager.listImages(),this._changedImages[j]=!0,this._changed=!0,this.fire(new e.Event("data",{dataType:"style"}))},V.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},V.prototype.addSource=function(j,de,Me){var Ce=this;if(Me===void 0&&(Me={}),this._checkLoaded(),this.sourceCaches[j]!==void 0)throw new Error("There is already a source with this ID");if(!de.type)throw new Error("The type property must be defined, but the only the following properties were given: "+Object.keys(de).join(", ")+".");var Ze=["vector","raster","geojson","video","image"],ut=Ze.indexOf(de.type)>=0;if(!(ut&&this._validate(e.validateStyle.source,"sources."+j,de,null,Me))){this.map&&this.map._collectResourceTiming&&(de.collectResourceTiming=!0);var St=this.sourceCaches[j]=new ke(j,de,this.dispatcher);St.style=this,St.setEventedParent(this,function(){return{isSourceLoaded:Ce.loaded(),source:St.serialize(),sourceId:j}}),St.onAdd(this.map),this._changed=!0}},V.prototype.removeSource=function(j){if(this._checkLoaded(),this.sourceCaches[j]===void 0)throw new Error("There is no source with this ID");for(var de in this._layers)if(this._layers[de].source===j)return this.fire(new e.ErrorEvent(new Error('Source "'+j+'" cannot be removed while layer "'+de+'" is using it.')));var Me=this.sourceCaches[j];delete this.sourceCaches[j],delete this._updatedSources[j],Me.fire(new e.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:j})),Me.setEventedParent(null),Me.clearTiles(),Me.onRemove&&Me.onRemove(this.map),this._changed=!0},V.prototype.setGeoJSONSourceData=function(j,de){this._checkLoaded();var Me=this.sourceCaches[j].getSource();Me.setData(de),this._changed=!0},V.prototype.getSource=function(j){return this.sourceCaches[j]&&this.sourceCaches[j].getSource()},V.prototype.addLayer=function(j,de,Me){Me===void 0&&(Me={}),this._checkLoaded();var Ce=j.id;if(this.getLayer(Ce)){this.fire(new e.ErrorEvent(new Error('Layer with id "'+Ce+'" already exists on this map')));return}var Ze;if(j.type==="custom"){if(sa(this,e.validateCustomStyleLayer(j)))return;Ze=e.createStyleLayer(j)}else{if(typeof j.source=="object"&&(this.addSource(Ce,j.source),j=e.clone$1(j),j=e.extend(j,{source:Ce})),this._validate(e.validateStyle.layer,"layers."+Ce,j,{arrayIndex:-1},Me))return;Ze=e.createStyleLayer(j),this._validateLayer(Ze),Ze.setEventedParent(this,{layer:{id:Ce}}),this._serializedLayers[Ze.id]=Ze.serialize()}var ut=de?this._order.indexOf(de):this._order.length;if(de&&ut===-1){this.fire(new e.ErrorEvent(new Error('Layer with id "'+de+'" does not exist on this map.')));return}if(this._order.splice(ut,0,Ce),this._layerOrderChanged=!0,this._layers[Ce]=Ze,this._removedLayers[Ce]&&Ze.source&&Ze.type!=="custom"){var St=this._removedLayers[Ce];delete this._removedLayers[Ce],St.type!==Ze.type?this._updatedSources[Ze.source]="clear":(this._updatedSources[Ze.source]="reload",this.sourceCaches[Ze.source].pause())}this._updateLayer(Ze),Ze.onAdd&&Ze.onAdd(this.map)},V.prototype.moveLayer=function(j,de){this._checkLoaded(),this._changed=!0;var Me=this._layers[j];if(!Me){this.fire(new e.ErrorEvent(new Error("The layer '"+j+"' does not exist in the map's style and cannot be moved.")));return}if(j!==de){var Ce=this._order.indexOf(j);this._order.splice(Ce,1);var Ze=de?this._order.indexOf(de):this._order.length;if(de&&Ze===-1){this.fire(new e.ErrorEvent(new Error('Layer with id "'+de+'" does not exist on this map.')));return}this._order.splice(Ze,0,j),this._layerOrderChanged=!0}},V.prototype.removeLayer=function(j){this._checkLoaded();var de=this._layers[j];if(!de){this.fire(new e.ErrorEvent(new Error("The layer '"+j+"' does not exist in the map's style and cannot be removed.")));return}de.setEventedParent(null);var Me=this._order.indexOf(j);this._order.splice(Me,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[j]=de,delete this._layers[j],delete this._serializedLayers[j],delete this._updatedLayers[j],delete this._updatedPaintProps[j],de.onRemove&&de.onRemove(this.map)},V.prototype.getLayer=function(j){return this._layers[j]},V.prototype.hasLayer=function(j){return j in this._layers},V.prototype.setLayerZoomRange=function(j,de,Me){this._checkLoaded();var Ce=this.getLayer(j);if(!Ce){this.fire(new e.ErrorEvent(new Error("The layer '"+j+"' does not exist in the map's style and cannot have zoom extent.")));return}Ce.minzoom===de&&Ce.maxzoom===Me||(de!=null&&(Ce.minzoom=de),Me!=null&&(Ce.maxzoom=Me),this._updateLayer(Ce))},V.prototype.setFilter=function(j,de,Me){Me===void 0&&(Me={}),this._checkLoaded();var Ce=this.getLayer(j);if(!Ce){this.fire(new e.ErrorEvent(new Error("The layer '"+j+"' does not exist in the map's style and cannot be filtered.")));return}if(!e.deepEqual(Ce.filter,de)){if(de==null){Ce.filter=void 0,this._updateLayer(Ce);return}this._validate(e.validateStyle.filter,"layers."+Ce.id+".filter",de,null,Me)||(Ce.filter=e.clone$1(de),this._updateLayer(Ce))}},V.prototype.getFilter=function(j){return e.clone$1(this.getLayer(j).filter)},V.prototype.setLayoutProperty=function(j,de,Me,Ce){Ce===void 0&&(Ce={}),this._checkLoaded();var Ze=this.getLayer(j);if(!Ze){this.fire(new e.ErrorEvent(new Error("The layer '"+j+"' does not exist in the map's style and cannot be styled.")));return}e.deepEqual(Ze.getLayoutProperty(de),Me)||(Ze.setLayoutProperty(de,Me,Ce),this._updateLayer(Ze))},V.prototype.getLayoutProperty=function(j,de){var Me=this.getLayer(j);if(!Me){this.fire(new e.ErrorEvent(new Error("The layer '"+j+"' does not exist in the map's style.")));return}return Me.getLayoutProperty(de)},V.prototype.setPaintProperty=function(j,de,Me,Ce){Ce===void 0&&(Ce={}),this._checkLoaded();var Ze=this.getLayer(j);if(!Ze){this.fire(new e.ErrorEvent(new Error("The layer '"+j+"' does not exist in the map's style and cannot be styled.")));return}if(!e.deepEqual(Ze.getPaintProperty(de),Me)){var ut=Ze.setPaintProperty(de,Me,Ce);ut&&this._updateLayer(Ze),this._changed=!0,this._updatedPaintProps[j]=!0}},V.prototype.getPaintProperty=function(j,de){return this.getLayer(j).getPaintProperty(de)},V.prototype.setFeatureState=function(j,de){this._checkLoaded();var Me=j.source,Ce=j.sourceLayer,Ze=this.sourceCaches[Me];if(Ze===void 0){this.fire(new e.ErrorEvent(new Error("The source '"+Me+"' does not exist in the map's style.")));return}var ut=Ze.getSource().type;if(ut==="geojson"&&Ce){this.fire(new e.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));return}if(ut==="vector"&&!Ce){this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));return}j.id===void 0&&this.fire(new e.ErrorEvent(new Error("The feature id parameter must be provided."))),Ze.setFeatureState(Ce,j.id,de)},V.prototype.removeFeatureState=function(j,de){this._checkLoaded();var Me=j.source,Ce=this.sourceCaches[Me];if(Ce===void 0){this.fire(new e.ErrorEvent(new Error("The source '"+Me+"' does not exist in the map's style.")));return}var Ze=Ce.getSource().type,ut=Ze==="vector"?j.sourceLayer:void 0;if(Ze==="vector"&&!ut){this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));return}if(de&&typeof j.id!="string"&&typeof j.id!="number"){this.fire(new e.ErrorEvent(new Error("A feature id is requred to remove its specific state property.")));return}Ce.removeFeatureState(ut,j.id,de)},V.prototype.getFeatureState=function(j){this._checkLoaded();var de=j.source,Me=j.sourceLayer,Ce=this.sourceCaches[de];if(Ce===void 0){this.fire(new e.ErrorEvent(new Error("The source '"+de+"' does not exist in the map's style.")));return}var Ze=Ce.getSource().type;if(Ze==="vector"&&!Me){this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));return}return j.id===void 0&&this.fire(new e.ErrorEvent(new Error("The feature id parameter must be provided."))),Ce.getFeatureState(Me,j.id)},V.prototype.getTransition=function(){return e.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},V.prototype.serialize=function(){return e.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:e.mapObject(this.sourceCaches,function(j){return j.serialize()}),layers:this._serializeLayers(this._order)},function(j){return j!==void 0})},V.prototype._updateLayer=function(j){this._updatedLayers[j.id]=!0,j.source&&!this._updatedSources[j.source]&&this.sourceCaches[j.source].getSource().type!=="raster"&&(this._updatedSources[j.source]="reload",this.sourceCaches[j.source].pause()),this._changed=!0},V.prototype._flattenAndSortRenderedFeatures=function(j){for(var de=this,Me=function(Ha){return de._layers[Ha].type==="fill-extrusion"},Ce={},Ze=[],ut=this._order.length-1;ut>=0;ut--){var St=this._order[ut];if(Me(St)){Ce[St]=ut;for(var jt=0,lr=j;jt<lr.length;jt+=1){var vr=lr[jt],Er=vr[St];if(Er)for(var Vr=0,Gr=Er;Vr<Gr.length;Vr+=1){var Ur=Gr[Vr];Ze.push(Ur)}}}}Ze.sort(function(Ha,ni){return ni.intersectionZ-Ha.intersectionZ});for(var Kr=[],cn=this._order.length-1;cn>=0;cn--){var En=this._order[cn];if(Me(En))for(var Fn=Ze.length-1;Fn>=0;Fn--){var Kn=Ze[Fn].feature;if(Ce[Kn.layer.id]<cn)break;Kr.push(Kn),Ze.pop()}else for(var qn=0,Qn=j;qn<Qn.length;qn+=1){var ca=Qn[qn],ba=ca[En];if(ba)for(var ya=0,Ta=ba;ya<Ta.length;ya+=1){var Ea=Ta[ya];Kr.push(Ea.feature)}}}return Kr},V.prototype.queryRenderedFeatures=function(j,de,Me){de&&de.filter&&this._validate(e.validateStyle.filter,"queryRenderedFeatures.filter",de.filter,null,de);var Ce={};if(de&&de.layers){if(!Array.isArray(de.layers))return this.fire(new e.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var Ze=0,ut=de.layers;Ze<ut.length;Ze+=1){var St=ut[Ze],jt=this._layers[St];if(!jt)return this.fire(new e.ErrorEvent(new Error("The layer '"+St+"' does not exist in the map's style and cannot be queried for features."))),[];Ce[jt.source]=!0}}var lr=[];de.availableImages=this._availableImages;for(var vr in this.sourceCaches)de.layers&&!Ce[vr]||lr.push(ne(this.sourceCaches[vr],this._layers,this._serializedLayers,j,de,Me));return this.placement&&lr.push(ae(this._layers,this._serializedLayers,this.sourceCaches,j,de,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(lr)},V.prototype.querySourceFeatures=function(j,de){de&&de.filter&&this._validate(e.validateStyle.filter,"querySourceFeatures.filter",de.filter,null,de);var Me=this.sourceCaches[j];return Me?ie(Me,de):[]},V.prototype.addSourceType=function(j,de,Me){if(V.getSourceType(j))return Me(new Error('A source type called "'+j+'" already exists.'));if(V.setSourceType(j,de),!de.workerSourceURL)return Me(null,null);this.dispatcher.broadcast("loadWorkerSource",{name:j,url:de.workerSourceURL},Me)},V.prototype.getLight=function(){return this.light.getLight()},V.prototype.setLight=function(j,de){de===void 0&&(de={}),this._checkLoaded();var Me=this.light.getLight(),Ce=!1;for(var Ze in j)if(!e.deepEqual(j[Ze],Me[Ze])){Ce=!0;break}if(!!Ce){var ut={now:e.browser.now(),transition:e.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(j,de),this.light.updateTransitions(ut)}},V.prototype._validate=function(j,de,Me,Ce,Ze){return Ze===void 0&&(Ze={}),Ze&&Ze.validate===!1?!1:sa(this,j.call(e.validateStyle,e.extend({key:de,style:this.serialize(),value:Me,styleSpec:e.styleSpec},Ce)))},V.prototype._remove=function(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),e.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(var j in this._layers){var de=this._layers[j];de.setEventedParent(null)}for(var Me in this.sourceCaches)this.sourceCaches[Me].clearTiles(),this.sourceCaches[Me].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},V.prototype._clearSource=function(j){this.sourceCaches[j].clearTiles()},V.prototype._reloadSource=function(j){this.sourceCaches[j].resume(),this.sourceCaches[j].reload()},V.prototype._updateSources=function(j){for(var de in this.sourceCaches)this.sourceCaches[de].update(j)},V.prototype._generateCollisionBoxes=function(){for(var j in this.sourceCaches)this._reloadSource(j)},V.prototype._updatePlacement=function(j,de,Me,Ce,Ze){Ze===void 0&&(Ze=!1);for(var ut=!1,St=!1,jt={},lr=0,vr=this._order;lr<vr.length;lr+=1){var Er=vr[lr],Vr=this._layers[Er];if(Vr.type==="symbol"){if(!jt[Vr.source]){var Gr=this.sourceCaches[Vr.source];jt[Vr.source]=Gr.getRenderableIds(!0).map(function(qn){return Gr.getTileByID(qn)}).sort(function(qn,Qn){return Qn.tileID.overscaledZ-qn.tileID.overscaledZ||(qn.tileID.isLessThan(Qn.tileID)?-1:1)})}var Ur=this.crossTileSymbolIndex.addLayer(Vr,jt[Vr.source],j.center.lng);ut=ut||Ur}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),Ze=Ze||this._layerOrderChanged||Me===0,(Ze||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(e.browser.now(),j.zoom))&&(this.pauseablePlacement=new ta(j,this._order,Ze,de,Me,Ce,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,jt),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(e.browser.now()),St=!0),ut&&this.pauseablePlacement.placement.setStale()),St||ut)for(var Kr=0,cn=this._order;Kr<cn.length;Kr+=1){var En=cn[Kr],Fn=this._layers[En];Fn.type==="symbol"&&this.placement.updateLayerOpacities(Fn,jt[Fn.source])}var Kn=!this.pauseablePlacement.isDone()||this.placement.hasTransitions(e.browser.now());return Kn},V.prototype._releaseSymbolFadeTiles=function(){for(var j in this.sourceCaches)this.sourceCaches[j].releaseSymbolFadeTiles()},V.prototype.getImages=function(j,de,Me){this.imageManager.getImages(de.icons,Me),this._updateTilesForChangedImages();var Ce=this.sourceCaches[de.source];Ce&&Ce.setDependencies(de.tileID.key,de.type,de.icons)},V.prototype.getGlyphs=function(j,de,Me){this.glyphManager.getGlyphs(de.stacks,Me)},V.prototype.getResource=function(j,de,Me){return e.makeRequest(de,Me)},V}(e.Evented);jo.getSourceType=q,jo.setSourceType=$,jo.registerForPluginStateChange=e.registerForPluginStateChange;var rl=e.createLayout([{name:"a_pos",type:"Int16",components:2}]),vl=`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,Gl=`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}`,vi=`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Vs="attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}",Ds=`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Ui="uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}",Ao=`varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,pl=`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`,vs="void main() {gl_FragColor=vec4(1.0);}",Di="attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}",nl=`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Ki=`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`,Fi=`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,no="uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}",Ji="varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}",ts="attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}",Gs="varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}",nu="attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}",Ko="uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}",au="attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}",Rs=`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Mo=`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`,Mu=`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Is=`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`,_s=`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Cl=`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`,Su=`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,ku=`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`,Ys=`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Ll=`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`,ws=`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Yl=`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`,al=`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform float u_maxzoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggeration=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/ pow(2.0,(u_zoom-u_maxzoom)*exaggeration+19.2562-u_zoom);gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Wl="uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}",iu=`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Pl="uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}",Eu=`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Ws=`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`,Xl=`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp float v_lineprogress;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,vec2(v_lineprogress,0.5));gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Dl=`
#define MAX_LINE_DISTANCE 32767.0
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_lineprogress;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_lineprogress=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0/MAX_LINE_DISTANCE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`,ps=`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,dl=`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`,Zl=`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,ou=`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`,su=`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Rl="uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}",Cu=`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,lu=`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}`,Jo=`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,il=`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`,ol=`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,jl=`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`,ds=Ri(vl,Gl),So=Ri(vi,Vs),Il=Ri(Ds,Ui),Ts=Ri(Ao,pl),As=Ri(vs,Di),oo=Ri(nl,Ki),yl=Ri(Fi,no),ml=Ri(Ji,ts),Xs=Ri(Gs,nu),gs=Ri(Ko,au),xl=Ri(Rs,Mo),sl=Ri(Mu,Is),zl=Ri(_s,Cl),bl=Ri(Su,ku),Zs=Ri(Ys,Ll),Lu=Ri(ws,Yl),rs=Ri(al,Wl),Yu=Ri(iu,Pl),Kl=Ri(Eu,Ws),ll=Ri(Xl,Dl),_l=Ri(ps,dl),js=Ri(Zl,ou),wl=Ri(su,Rl),uu=Ri(Cu,lu),fu=Ri(Jo,il),Wu=Ri(ol,jl);function Ri(ce,V){var ve=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,j={};return ce=ce.replace(ve,function(de,Me,Ce,Ze,ut){return j[ut]=!0,Me==="define"?`
#ifndef HAS_UNIFORM_u_`+ut+`
varying `+Ce+" "+Ze+" "+ut+`;
#else
uniform `+Ce+" "+Ze+" u_"+ut+`;
#endif
`:`
#ifdef HAS_UNIFORM_u_`+ut+`
    `+Ce+" "+Ze+" "+ut+" = u_"+ut+`;
#endif
`}),V=V.replace(ve,function(de,Me,Ce,Ze,ut){var St=Ze==="float"?"vec2":"vec4",jt=ut.match(/color/)?"color":St;return j[ut]?Me==="define"?`
#ifndef HAS_UNIFORM_u_`+ut+`
uniform lowp float u_`+ut+`_t;
attribute `+Ce+" "+St+" a_"+ut+`;
varying `+Ce+" "+Ze+" "+ut+`;
#else
uniform `+Ce+" "+Ze+" u_"+ut+`;
#endif
`:jt==="vec4"?`
#ifndef HAS_UNIFORM_u_`+ut+`
    `+ut+" = a_"+ut+`;
#else
    `+Ce+" "+Ze+" "+ut+" = u_"+ut+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+ut+`
    `+ut+" = unpack_mix_"+jt+"(a_"+ut+", u_"+ut+`_t);
#else
    `+Ce+" "+Ze+" "+ut+" = u_"+ut+`;
#endif
`:Me==="define"?`
#ifndef HAS_UNIFORM_u_`+ut+`
uniform lowp float u_`+ut+`_t;
attribute `+Ce+" "+St+" a_"+ut+`;
#else
uniform `+Ce+" "+Ze+" u_"+ut+`;
#endif
`:jt==="vec4"?`
#ifndef HAS_UNIFORM_u_`+ut+`
    `+Ce+" "+Ze+" "+ut+" = a_"+ut+`;
#else
    `+Ce+" "+Ze+" "+ut+" = u_"+ut+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+ut+`
    `+Ce+" "+Ze+" "+ut+" = unpack_mix_"+jt+"(a_"+ut+", u_"+ut+`_t);
#else
    `+Ce+" "+Ze+" "+ut+" = u_"+ut+`;
#endif
`}),{fragmentSource:ce,vertexSource:V}}var ul=Object.freeze({__proto__:null,prelude:ds,background:So,backgroundPattern:Il,circle:Ts,clippingMask:As,heatmap:oo,heatmapTexture:yl,collisionBox:ml,collisionCircle:Xs,debug:gs,fill:xl,fillOutline:sl,fillOutlinePattern:zl,fillPattern:bl,fillExtrusion:Zs,fillExtrusionPattern:Lu,hillshadePrepare:rs,hillshade:Yu,line:Kl,lineGradient:ll,linePattern:_l,lineSDF:js,raster:wl,symbolIcon:uu,symbolSDF:fu,symbolTextAndIcon:Wu}),Ks=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};Ks.prototype.bind=function(V,ve,j,de,Me,Ce,Ze,ut){this.context=V;for(var St=this.boundPaintVertexBuffers.length!==de.length,jt=0;!St&&jt<de.length;jt++)this.boundPaintVertexBuffers[jt]!==de[jt]&&(St=!0);var lr=!this.vao||this.boundProgram!==ve||this.boundLayoutVertexBuffer!==j||St||this.boundIndexBuffer!==Me||this.boundVertexOffset!==Ce||this.boundDynamicVertexBuffer!==Ze||this.boundDynamicVertexBuffer2!==ut;!V.extVertexArrayObject||lr?this.freshBind(ve,j,de,Me,Ce,Ze,ut):(V.bindVertexArrayOES.set(this.vao),Ze&&Ze.bind(),Me&&Me.dynamicDraw&&Me.bind(),ut&&ut.bind())},Ks.prototype.freshBind=function(V,ve,j,de,Me,Ce,Ze){var ut,St=V.numAttributes,jt=this.context,lr=jt.gl;if(jt.extVertexArrayObject)this.vao&&this.destroy(),this.vao=jt.extVertexArrayObject.createVertexArrayOES(),jt.bindVertexArrayOES.set(this.vao),ut=0,this.boundProgram=V,this.boundLayoutVertexBuffer=ve,this.boundPaintVertexBuffers=j,this.boundIndexBuffer=de,this.boundVertexOffset=Me,this.boundDynamicVertexBuffer=Ce,this.boundDynamicVertexBuffer2=Ze;else{ut=jt.currentNumAttributes||0;for(var vr=St;vr<ut;vr++)lr.disableVertexAttribArray(vr)}ve.enableAttributes(lr,V);for(var Er=0,Vr=j;Er<Vr.length;Er+=1){var Gr=Vr[Er];Gr.enableAttributes(lr,V)}Ce&&Ce.enableAttributes(lr,V),Ze&&Ze.enableAttributes(lr,V),ve.bind(),ve.setVertexAttribPointers(lr,V,Me);for(var Ur=0,Kr=j;Ur<Kr.length;Ur+=1){var cn=Kr[Ur];cn.bind(),cn.setVertexAttribPointers(lr,V,Me)}Ce&&(Ce.bind(),Ce.setVertexAttribPointers(lr,V,Me)),de&&de.bind(),Ze&&(Ze.bind(),Ze.setVertexAttribPointers(lr,V,Me)),jt.currentNumAttributes=St},Ks.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var Qo=function(V,ve,j,de,Me){var Ce=V.gl;this.program=Ce.createProgram();var Ze=j?j.defines():[];Me&&Ze.push("#define OVERDRAW_INSPECTOR;");var ut=Ze.concat(ds.fragmentSource,ve.fragmentSource).join(`
`),St=Ze.concat(ds.vertexSource,ve.vertexSource).join(`
`),jt=Ce.createShader(Ce.FRAGMENT_SHADER);if(Ce.isContextLost()){this.failedToCreate=!0;return}Ce.shaderSource(jt,ut),Ce.compileShader(jt),Ce.attachShader(this.program,jt);var lr=Ce.createShader(Ce.VERTEX_SHADER);if(Ce.isContextLost()){this.failedToCreate=!0;return}Ce.shaderSource(lr,St),Ce.compileShader(lr),Ce.attachShader(this.program,lr);for(var vr=j?j.layoutAttributes:[],Er=0;Er<vr.length;Er++)Ce.bindAttribLocation(this.program,Er,vr[Er].name);Ce.linkProgram(this.program),Ce.deleteShader(lr),Ce.deleteShader(jt),this.numAttributes=Ce.getProgramParameter(this.program,Ce.ACTIVE_ATTRIBUTES),this.attributes={};for(var Vr={},Gr=0;Gr<this.numAttributes;Gr++){var Ur=Ce.getActiveAttrib(this.program,Gr);Ur&&(this.attributes[Ur.name]=Ce.getAttribLocation(this.program,Ur.name))}for(var Kr=Ce.getProgramParameter(this.program,Ce.ACTIVE_UNIFORMS),cn=0;cn<Kr;cn++){var En=Ce.getActiveUniform(this.program,cn);En&&(Vr[En.name]=Ce.getUniformLocation(this.program,En.name))}this.fixedUniforms=de(V,Vr),this.binderUniforms=j?j.getUniforms(V,Vr):[]};Qo.prototype.draw=function(V,ve,j,de,Me,Ce,Ze,ut,St,jt,lr,vr,Er,Vr,Gr,Ur){var Kr,cn=V.gl;if(!this.failedToCreate){V.program.set(this.program),V.setDepthMode(j),V.setStencilMode(de),V.setColorMode(Me),V.setCullFace(Ce);for(var En in this.fixedUniforms)this.fixedUniforms[En].set(Ze[En]);Vr&&Vr.setUniforms(V,this.binderUniforms,vr,{zoom:Er});for(var Fn=(Kr={},Kr[cn.LINES]=2,Kr[cn.TRIANGLES]=3,Kr[cn.LINE_STRIP]=1,Kr)[ve],Kn=0,qn=lr.get();Kn<qn.length;Kn+=1){var Qn=qn[Kn],ca=Qn.vaos||(Qn.vaos={}),ba=ca[ut]||(ca[ut]=new Ks);ba.bind(V,this,St,Vr?Vr.getPaintVertexBuffers():[],jt,Qn.vertexOffset,Gr,Ur),cn.drawElements(ve,Qn.primitiveLength*Fn,cn.UNSIGNED_SHORT,Qn.primitiveOffset*Fn*2)}}};function ns(ce,V,ve){var j=1/An(ve,1,V.transform.tileZoom),de=Math.pow(2,ve.tileID.overscaledZ),Me=ve.tileSize*Math.pow(2,V.transform.tileZoom)/de,Ce=Me*(ve.tileID.canonical.x+ve.tileID.wrap*de),Ze=Me*ve.tileID.canonical.y;return{u_image:0,u_texsize:ve.imageAtlasTexture.size,u_scale:[j,ce.fromScale,ce.toScale],u_fade:ce.t,u_pixel_coord_upper:[Ce>>16,Ze>>16],u_pixel_coord_lower:[Ce&65535,Ze&65535]}}function Tl(ce,V,ve,j){var de=ve.imageManager.getPattern(ce.from.toString()),Me=ve.imageManager.getPattern(ce.to.toString()),Ce=ve.imageManager.getPixelSize(),Ze=Ce.width,ut=Ce.height,St=Math.pow(2,j.tileID.overscaledZ),jt=j.tileSize*Math.pow(2,ve.transform.tileZoom)/St,lr=jt*(j.tileID.canonical.x+j.tileID.wrap*St),vr=jt*j.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:de.tl,u_pattern_br_a:de.br,u_pattern_tl_b:Me.tl,u_pattern_br_b:Me.br,u_texsize:[Ze,ut],u_mix:V.t,u_pattern_size_a:de.displaySize,u_pattern_size_b:Me.displaySize,u_scale_a:V.fromScale,u_scale_b:V.toScale,u_tile_units_to_pixels:1/An(j,1,ve.transform.tileZoom),u_pixel_coord_upper:[lr>>16,vr>>16],u_pixel_coord_lower:[lr&65535,vr&65535]}}var so=function(ce,V){return{u_matrix:new e.UniformMatrix4f(ce,V.u_matrix),u_lightpos:new e.Uniform3f(ce,V.u_lightpos),u_lightintensity:new e.Uniform1f(ce,V.u_lightintensity),u_lightcolor:new e.Uniform3f(ce,V.u_lightcolor),u_vertical_gradient:new e.Uniform1f(ce,V.u_vertical_gradient),u_opacity:new e.Uniform1f(ce,V.u_opacity)}},cu=function(ce,V){return{u_matrix:new e.UniformMatrix4f(ce,V.u_matrix),u_lightpos:new e.Uniform3f(ce,V.u_lightpos),u_lightintensity:new e.Uniform1f(ce,V.u_lightintensity),u_lightcolor:new e.Uniform3f(ce,V.u_lightcolor),u_vertical_gradient:new e.Uniform1f(ce,V.u_vertical_gradient),u_height_factor:new e.Uniform1f(ce,V.u_height_factor),u_image:new e.Uniform1i(ce,V.u_image),u_texsize:new e.Uniform2f(ce,V.u_texsize),u_pixel_coord_upper:new e.Uniform2f(ce,V.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(ce,V.u_pixel_coord_lower),u_scale:new e.Uniform3f(ce,V.u_scale),u_fade:new e.Uniform1f(ce,V.u_fade),u_opacity:new e.Uniform1f(ce,V.u_opacity)}},as=function(ce,V,ve,j){var de=V.style.light,Me=de.properties.get("position"),Ce=[Me.x,Me.y,Me.z],Ze=e.create$1();de.properties.get("anchor")==="viewport"&&e.fromRotation(Ze,-V.transform.angle),e.transformMat3(Ce,Ce,Ze);var ut=de.properties.get("color");return{u_matrix:ce,u_lightpos:Ce,u_lightintensity:de.properties.get("intensity"),u_lightcolor:[ut.r,ut.g,ut.b],u_vertical_gradient:+ve,u_opacity:j}},zs=function(ce,V,ve,j,de,Me,Ce){return e.extend(as(ce,V,ve,j),ns(Me,V,Ce),{u_height_factor:-Math.pow(2,de.overscaledZ)/Ce.tileSize/8})},Fs=function(ce,V){return{u_matrix:new e.UniformMatrix4f(ce,V.u_matrix)}},Ms=function(ce,V){return{u_matrix:new e.UniformMatrix4f(ce,V.u_matrix),u_image:new e.Uniform1i(ce,V.u_image),u_texsize:new e.Uniform2f(ce,V.u_texsize),u_pixel_coord_upper:new e.Uniform2f(ce,V.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(ce,V.u_pixel_coord_lower),u_scale:new e.Uniform3f(ce,V.u_scale),u_fade:new e.Uniform1f(ce,V.u_fade)}},is=function(ce,V){return{u_matrix:new e.UniformMatrix4f(ce,V.u_matrix),u_world:new e.Uniform2f(ce,V.u_world)}},Hi=function(ce,V){return{u_matrix:new e.UniformMatrix4f(ce,V.u_matrix),u_world:new e.Uniform2f(ce,V.u_world),u_image:new e.Uniform1i(ce,V.u_image),u_texsize:new e.Uniform2f(ce,V.u_texsize),u_pixel_coord_upper:new e.Uniform2f(ce,V.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(ce,V.u_pixel_coord_lower),u_scale:new e.Uniform3f(ce,V.u_scale),u_fade:new e.Uniform1f(ce,V.u_fade)}},ko=function(ce){return{u_matrix:ce}},os=function(ce,V,ve,j){return e.extend(ko(ce),ns(ve,V,j))},hu=function(ce,V){return{u_matrix:ce,u_world:V}},Fl=function(ce,V,ve,j,de){return e.extend(os(ce,V,ve,j),{u_world:de})},vu=function(ce,V){return{u_camera_to_center_distance:new e.Uniform1f(ce,V.u_camera_to_center_distance),u_scale_with_map:new e.Uniform1i(ce,V.u_scale_with_map),u_pitch_with_map:new e.Uniform1i(ce,V.u_pitch_with_map),u_extrude_scale:new e.Uniform2f(ce,V.u_extrude_scale),u_device_pixel_ratio:new e.Uniform1f(ce,V.u_device_pixel_ratio),u_matrix:new e.UniformMatrix4f(ce,V.u_matrix)}},gt=function(ce,V,ve,j){var de=ce.transform,Me,Ce;if(j.paint.get("circle-pitch-alignment")==="map"){var Ze=An(ve,1,de.zoom);Me=!0,Ce=[Ze,Ze]}else Me=!1,Ce=de.pixelsToGLUnits;return{u_camera_to_center_distance:de.cameraToCenterDistance,u_scale_with_map:+(j.paint.get("circle-pitch-scale")==="map"),u_matrix:ce.translatePosMatrix(V.posMatrix,ve,j.paint.get("circle-translate"),j.paint.get("circle-translate-anchor")),u_pitch_with_map:+Me,u_device_pixel_ratio:e.browser.devicePixelRatio,u_extrude_scale:Ce}},zt=function(ce,V){return{u_matrix:new e.UniformMatrix4f(ce,V.u_matrix),u_camera_to_center_distance:new e.Uniform1f(ce,V.u_camera_to_center_distance),u_pixels_to_tile_units:new e.Uniform1f(ce,V.u_pixels_to_tile_units),u_extrude_scale:new e.Uniform2f(ce,V.u_extrude_scale),u_overscale_factor:new e.Uniform1f(ce,V.u_overscale_factor)}},cr=function(ce,V){return{u_matrix:new e.UniformMatrix4f(ce,V.u_matrix),u_inv_matrix:new e.UniformMatrix4f(ce,V.u_inv_matrix),u_camera_to_center_distance:new e.Uniform1f(ce,V.u_camera_to_center_distance),u_viewport_size:new e.Uniform2f(ce,V.u_viewport_size)}},or=function(ce,V,ve){var j=An(ve,1,V.zoom),de=Math.pow(2,V.zoom-ve.tileID.overscaledZ),Me=ve.tileID.overscaleFactor();return{u_matrix:ce,u_camera_to_center_distance:V.cameraToCenterDistance,u_pixels_to_tile_units:j,u_extrude_scale:[V.pixelsToGLUnits[0]/(j*de),V.pixelsToGLUnits[1]/(j*de)],u_overscale_factor:Me}},Rr=function(ce,V,ve){return{u_matrix:ce,u_inv_matrix:V,u_camera_to_center_distance:ve.cameraToCenterDistance,u_viewport_size:[ve.width,ve.height]}},tn=function(ce,V){return{u_color:new e.UniformColor(ce,V.u_color),u_matrix:new e.UniformMatrix4f(ce,V.u_matrix),u_overlay:new e.Uniform1i(ce,V.u_overlay),u_overlay_scale:new e.Uniform1f(ce,V.u_overlay_scale)}},dn=function(ce,V,ve){return ve===void 0&&(ve=1),{u_matrix:ce,u_color:V,u_overlay:0,u_overlay_scale:ve}},Mn=function(ce,V){return{u_matrix:new e.UniformMatrix4f(ce,V.u_matrix)}},Ln=function(ce){return{u_matrix:ce}},Nn=function(ce,V){return{u_extrude_scale:new e.Uniform1f(ce,V.u_extrude_scale),u_intensity:new e.Uniform1f(ce,V.u_intensity),u_matrix:new e.UniformMatrix4f(ce,V.u_matrix)}},yn=function(ce,V){return{u_matrix:new e.UniformMatrix4f(ce,V.u_matrix),u_world:new e.Uniform2f(ce,V.u_world),u_image:new e.Uniform1i(ce,V.u_image),u_color_ramp:new e.Uniform1i(ce,V.u_color_ramp),u_opacity:new e.Uniform1f(ce,V.u_opacity)}},zn=function(ce,V,ve,j){return{u_matrix:ce,u_extrude_scale:An(V,1,ve),u_intensity:j}},Pn=function(ce,V,ve,j){var de=e.create();e.ortho(de,0,ce.width,ce.height,0,0,1);var Me=ce.context.gl;return{u_matrix:de,u_world:[Me.drawingBufferWidth,Me.drawingBufferHeight],u_image:ve,u_color_ramp:j,u_opacity:V.paint.get("heatmap-opacity")}},Vn=function(ce,V){return{u_matrix:new e.UniformMatrix4f(ce,V.u_matrix),u_image:new e.Uniform1i(ce,V.u_image),u_latrange:new e.Uniform2f(ce,V.u_latrange),u_light:new e.Uniform2f(ce,V.u_light),u_shadow:new e.UniformColor(ce,V.u_shadow),u_highlight:new e.UniformColor(ce,V.u_highlight),u_accent:new e.UniformColor(ce,V.u_accent)}},$n=function(ce,V){return{u_matrix:new e.UniformMatrix4f(ce,V.u_matrix),u_image:new e.Uniform1i(ce,V.u_image),u_dimension:new e.Uniform2f(ce,V.u_dimension),u_zoom:new e.Uniform1f(ce,V.u_zoom),u_maxzoom:new e.Uniform1f(ce,V.u_maxzoom),u_unpack:new e.Uniform4f(ce,V.u_unpack)}},za=function(ce,V,ve){var j=ve.paint.get("hillshade-shadow-color"),de=ve.paint.get("hillshade-highlight-color"),Me=ve.paint.get("hillshade-accent-color"),Ce=ve.paint.get("hillshade-illumination-direction")*(Math.PI/180);ve.paint.get("hillshade-illumination-anchor")==="viewport"&&(Ce-=ce.transform.angle);var Ze=!ce.options.moving;return{u_matrix:ce.transform.calculatePosMatrix(V.tileID.toUnwrapped(),Ze),u_image:0,u_latrange:Fa(ce,V.tileID),u_light:[ve.paint.get("hillshade-exaggeration"),Ce],u_shadow:j,u_highlight:de,u_accent:Me}},ka=function(ce,V,ve){var j=V.stride,de=e.create();return e.ortho(de,0,e.EXTENT,-e.EXTENT,0,0,1),e.translate(de,de,[0,-e.EXTENT,0]),{u_matrix:de,u_image:1,u_dimension:[j,j],u_zoom:ce.overscaledZ,u_maxzoom:ve,u_unpack:V.getUnpackVector()}};function Fa(ce,V){var ve=Math.pow(2,V.canonical.z),j=V.canonical.y;return[new e.MercatorCoordinate(0,j/ve).toLngLat().lat,new e.MercatorCoordinate(0,(j+1)/ve).toLngLat().lat]}var Oa=function(ce,V){return{u_matrix:new e.UniformMatrix4f(ce,V.u_matrix),u_ratio:new e.Uniform1f(ce,V.u_ratio),u_device_pixel_ratio:new e.Uniform1f(ce,V.u_device_pixel_ratio),u_units_to_pixels:new e.Uniform2f(ce,V.u_units_to_pixels)}},Jn=function(ce,V){return{u_matrix:new e.UniformMatrix4f(ce,V.u_matrix),u_ratio:new e.Uniform1f(ce,V.u_ratio),u_device_pixel_ratio:new e.Uniform1f(ce,V.u_device_pixel_ratio),u_units_to_pixels:new e.Uniform2f(ce,V.u_units_to_pixels),u_image:new e.Uniform1i(ce,V.u_image)}},ha=function(ce,V){return{u_matrix:new e.UniformMatrix4f(ce,V.u_matrix),u_texsize:new e.Uniform2f(ce,V.u_texsize),u_ratio:new e.Uniform1f(ce,V.u_ratio),u_device_pixel_ratio:new e.Uniform1f(ce,V.u_device_pixel_ratio),u_image:new e.Uniform1i(ce,V.u_image),u_units_to_pixels:new e.Uniform2f(ce,V.u_units_to_pixels),u_scale:new e.Uniform3f(ce,V.u_scale),u_fade:new e.Uniform1f(ce,V.u_fade)}},Ga=function(ce,V){return{u_matrix:new e.UniformMatrix4f(ce,V.u_matrix),u_ratio:new e.Uniform1f(ce,V.u_ratio),u_device_pixel_ratio:new e.Uniform1f(ce,V.u_device_pixel_ratio),u_units_to_pixels:new e.Uniform2f(ce,V.u_units_to_pixels),u_patternscale_a:new e.Uniform2f(ce,V.u_patternscale_a),u_patternscale_b:new e.Uniform2f(ce,V.u_patternscale_b),u_sdfgamma:new e.Uniform1f(ce,V.u_sdfgamma),u_image:new e.Uniform1i(ce,V.u_image),u_tex_y_a:new e.Uniform1f(ce,V.u_tex_y_a),u_tex_y_b:new e.Uniform1f(ce,V.u_tex_y_b),u_mix:new e.Uniform1f(ce,V.u_mix)}},Qa=function(ce,V,ve){var j=ce.transform;return{u_matrix:oi(ce,V,ve),u_ratio:1/An(V,1,j.zoom),u_device_pixel_ratio:e.browser.devicePixelRatio,u_units_to_pixels:[1/j.pixelsToGLUnits[0],1/j.pixelsToGLUnits[1]]}},di=function(ce,V,ve){return e.extend(Qa(ce,V,ve),{u_image:0})},gi=function(ce,V,ve,j){var de=ce.transform,Me=Ai(V,de);return{u_matrix:oi(ce,V,ve),u_texsize:V.imageAtlasTexture.size,u_ratio:1/An(V,1,de.zoom),u_device_pixel_ratio:e.browser.devicePixelRatio,u_image:0,u_scale:[Me,j.fromScale,j.toScale],u_fade:j.t,u_units_to_pixels:[1/de.pixelsToGLUnits[0],1/de.pixelsToGLUnits[1]]}},mi=function(ce,V,ve,j,de){var Me=ce.transform,Ce=ce.lineAtlas,Ze=Ai(V,Me),ut=ve.layout.get("line-cap")==="round",St=Ce.getDash(j.from,ut),jt=Ce.getDash(j.to,ut),lr=St.width*de.fromScale,vr=jt.width*de.toScale;return e.extend(Qa(ce,V,ve),{u_patternscale_a:[Ze/lr,-St.height/2],u_patternscale_b:[Ze/vr,-jt.height/2],u_sdfgamma:Ce.width/(Math.min(lr,vr)*256*e.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:St.y,u_tex_y_b:jt.y,u_mix:de.t})};function Ai(ce,V){return 1/An(ce,1,V.tileZoom)}function oi(ce,V,ve){return ce.translatePosMatrix(V.tileID.posMatrix,V,ve.paint.get("line-translate"),ve.paint.get("line-translate-anchor"))}var yo=function(ce,V){return{u_matrix:new e.UniformMatrix4f(ce,V.u_matrix),u_tl_parent:new e.Uniform2f(ce,V.u_tl_parent),u_scale_parent:new e.Uniform1f(ce,V.u_scale_parent),u_buffer_scale:new e.Uniform1f(ce,V.u_buffer_scale),u_fade_t:new e.Uniform1f(ce,V.u_fade_t),u_opacity:new e.Uniform1f(ce,V.u_opacity),u_image0:new e.Uniform1i(ce,V.u_image0),u_image1:new e.Uniform1i(ce,V.u_image1),u_brightness_low:new e.Uniform1f(ce,V.u_brightness_low),u_brightness_high:new e.Uniform1f(ce,V.u_brightness_high),u_saturation_factor:new e.Uniform1f(ce,V.u_saturation_factor),u_contrast_factor:new e.Uniform1f(ce,V.u_contrast_factor),u_spin_weights:new e.Uniform3f(ce,V.u_spin_weights)}},qi=function(ce,V,ve,j,de){return{u_matrix:ce,u_tl_parent:V,u_scale_parent:ve,u_buffer_scale:1,u_fade_t:j.mix,u_opacity:j.opacity*de.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:de.paint.get("raster-brightness-min"),u_brightness_high:de.paint.get("raster-brightness-max"),u_saturation_factor:xi(de.paint.get("raster-saturation")),u_contrast_factor:va(de.paint.get("raster-contrast")),u_spin_weights:Ja(de.paint.get("raster-hue-rotate"))}};function Ja(ce){ce*=Math.PI/180;var V=Math.sin(ce),ve=Math.cos(ce);return[(2*ve+1)/3,(-Math.sqrt(3)*V-ve+1)/3,(Math.sqrt(3)*V-ve+1)/3]}function va(ce){return ce>0?1/(1-ce):1+ce}function xi(ce){return ce>0?1-1/(1.001-ce):-ce}var lo=function(ce,V){return{u_is_size_zoom_constant:new e.Uniform1i(ce,V.u_is_size_zoom_constant),u_is_size_feature_constant:new e.Uniform1i(ce,V.u_is_size_feature_constant),u_size_t:new e.Uniform1f(ce,V.u_size_t),u_size:new e.Uniform1f(ce,V.u_size),u_camera_to_center_distance:new e.Uniform1f(ce,V.u_camera_to_center_distance),u_pitch:new e.Uniform1f(ce,V.u_pitch),u_rotate_symbol:new e.Uniform1i(ce,V.u_rotate_symbol),u_aspect_ratio:new e.Uniform1f(ce,V.u_aspect_ratio),u_fade_change:new e.Uniform1f(ce,V.u_fade_change),u_matrix:new e.UniformMatrix4f(ce,V.u_matrix),u_label_plane_matrix:new e.UniformMatrix4f(ce,V.u_label_plane_matrix),u_coord_matrix:new e.UniformMatrix4f(ce,V.u_coord_matrix),u_is_text:new e.Uniform1i(ce,V.u_is_text),u_pitch_with_map:new e.Uniform1i(ce,V.u_pitch_with_map),u_texsize:new e.Uniform2f(ce,V.u_texsize),u_texture:new e.Uniform1i(ce,V.u_texture)}},vo=function(ce,V){return{u_is_size_zoom_constant:new e.Uniform1i(ce,V.u_is_size_zoom_constant),u_is_size_feature_constant:new e.Uniform1i(ce,V.u_is_size_feature_constant),u_size_t:new e.Uniform1f(ce,V.u_size_t),u_size:new e.Uniform1f(ce,V.u_size),u_camera_to_center_distance:new e.Uniform1f(ce,V.u_camera_to_center_distance),u_pitch:new e.Uniform1f(ce,V.u_pitch),u_rotate_symbol:new e.Uniform1i(ce,V.u_rotate_symbol),u_aspect_ratio:new e.Uniform1f(ce,V.u_aspect_ratio),u_fade_change:new e.Uniform1f(ce,V.u_fade_change),u_matrix:new e.UniformMatrix4f(ce,V.u_matrix),u_label_plane_matrix:new e.UniformMatrix4f(ce,V.u_label_plane_matrix),u_coord_matrix:new e.UniformMatrix4f(ce,V.u_coord_matrix),u_is_text:new e.Uniform1i(ce,V.u_is_text),u_pitch_with_map:new e.Uniform1i(ce,V.u_pitch_with_map),u_texsize:new e.Uniform2f(ce,V.u_texsize),u_texture:new e.Uniform1i(ce,V.u_texture),u_gamma_scale:new e.Uniform1f(ce,V.u_gamma_scale),u_device_pixel_ratio:new e.Uniform1f(ce,V.u_device_pixel_ratio),u_is_halo:new e.Uniform1i(ce,V.u_is_halo)}},ss=function(ce,V){return{u_is_size_zoom_constant:new e.Uniform1i(ce,V.u_is_size_zoom_constant),u_is_size_feature_constant:new e.Uniform1i(ce,V.u_is_size_feature_constant),u_size_t:new e.Uniform1f(ce,V.u_size_t),u_size:new e.Uniform1f(ce,V.u_size),u_camera_to_center_distance:new e.Uniform1f(ce,V.u_camera_to_center_distance),u_pitch:new e.Uniform1f(ce,V.u_pitch),u_rotate_symbol:new e.Uniform1i(ce,V.u_rotate_symbol),u_aspect_ratio:new e.Uniform1f(ce,V.u_aspect_ratio),u_fade_change:new e.Uniform1f(ce,V.u_fade_change),u_matrix:new e.UniformMatrix4f(ce,V.u_matrix),u_label_plane_matrix:new e.UniformMatrix4f(ce,V.u_label_plane_matrix),u_coord_matrix:new e.UniformMatrix4f(ce,V.u_coord_matrix),u_is_text:new e.Uniform1i(ce,V.u_is_text),u_pitch_with_map:new e.Uniform1i(ce,V.u_pitch_with_map),u_texsize:new e.Uniform2f(ce,V.u_texsize),u_texsize_icon:new e.Uniform2f(ce,V.u_texsize_icon),u_texture:new e.Uniform1i(ce,V.u_texture),u_texture_icon:new e.Uniform1i(ce,V.u_texture_icon),u_gamma_scale:new e.Uniform1f(ce,V.u_gamma_scale),u_device_pixel_ratio:new e.Uniform1f(ce,V.u_device_pixel_ratio),u_is_halo:new e.Uniform1i(ce,V.u_is_halo)}},Ss=function(ce,V,ve,j,de,Me,Ce,Ze,ut,St){var jt=de.transform;return{u_is_size_zoom_constant:+(ce==="constant"||ce==="source"),u_is_size_feature_constant:+(ce==="constant"||ce==="camera"),u_size_t:V?V.uSizeT:0,u_size:V?V.uSize:0,u_camera_to_center_distance:jt.cameraToCenterDistance,u_pitch:jt.pitch/360*2*Math.PI,u_rotate_symbol:+ve,u_aspect_ratio:jt.width/jt.height,u_fade_change:de.options.fadeDuration?de.symbolFadeChange:1,u_matrix:Me,u_label_plane_matrix:Ce,u_coord_matrix:Ze,u_is_text:+ut,u_pitch_with_map:+j,u_texsize:St,u_texture:0}},Io=function(ce,V,ve,j,de,Me,Ce,Ze,ut,St,jt){var lr=de.transform;return e.extend(Ss(ce,V,ve,j,de,Me,Ce,Ze,ut,St),{u_gamma_scale:j?Math.cos(lr._pitch)*lr.cameraToCenterDistance:1,u_device_pixel_ratio:e.browser.devicePixelRatio,u_is_halo:+jt})},Js=function(ce,V,ve,j,de,Me,Ce,Ze,ut,St){return e.extend(Io(ce,V,ve,j,de,Me,Ce,Ze,!0,ut,!0),{u_texsize_icon:St,u_texture_icon:1})},ys=function(ce,V){return{u_matrix:new e.UniformMatrix4f(ce,V.u_matrix),u_opacity:new e.Uniform1f(ce,V.u_opacity),u_color:new e.UniformColor(ce,V.u_color)}},ls=function(ce,V){return{u_matrix:new e.UniformMatrix4f(ce,V.u_matrix),u_opacity:new e.Uniform1f(ce,V.u_opacity),u_image:new e.Uniform1i(ce,V.u_image),u_pattern_tl_a:new e.Uniform2f(ce,V.u_pattern_tl_a),u_pattern_br_a:new e.Uniform2f(ce,V.u_pattern_br_a),u_pattern_tl_b:new e.Uniform2f(ce,V.u_pattern_tl_b),u_pattern_br_b:new e.Uniform2f(ce,V.u_pattern_br_b),u_texsize:new e.Uniform2f(ce,V.u_texsize),u_mix:new e.Uniform1f(ce,V.u_mix),u_pattern_size_a:new e.Uniform2f(ce,V.u_pattern_size_a),u_pattern_size_b:new e.Uniform2f(ce,V.u_pattern_size_b),u_scale_a:new e.Uniform1f(ce,V.u_scale_a),u_scale_b:new e.Uniform1f(ce,V.u_scale_b),u_pixel_coord_upper:new e.Uniform2f(ce,V.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(ce,V.u_pixel_coord_lower),u_tile_units_to_pixels:new e.Uniform1f(ce,V.u_tile_units_to_pixels)}},mo=function(ce,V,ve){return{u_matrix:ce,u_opacity:V,u_color:ve}},Ol=function(ce,V,ve,j,de,Me){return e.extend(Tl(j,Me,ve,de),{u_matrix:ce,u_opacity:V})},Jl={fillExtrusion:so,fillExtrusionPattern:cu,fill:Fs,fillPattern:Ms,fillOutline:is,fillOutlinePattern:Hi,circle:vu,collisionBox:zt,collisionCircle:cr,debug:tn,clippingMask:Mn,heatmap:Nn,heatmapTexture:yn,hillshade:Vn,hillshadePrepare:$n,line:Oa,lineGradient:Jn,linePattern:ha,lineSDF:Ga,raster:yo,symbolIcon:lo,symbolSDF:vo,symbolTextAndIcon:ss,background:ys,backgroundPattern:ls},us;function pu(ce,V,ve,j,de,Me,Ce){for(var Ze=ce.context,ut=Ze.gl,St=ce.useProgram("collisionBox"),jt=[],lr=0,vr=0,Er=0;Er<j.length;Er++){var Vr=j[Er],Gr=V.getTile(Vr),Ur=Gr.getBucket(ve);if(!!Ur){var Kr=Vr.posMatrix;(de[0]!==0||de[1]!==0)&&(Kr=ce.translatePosMatrix(Vr.posMatrix,Gr,de,Me));var cn=Ce?Ur.textCollisionBox:Ur.iconCollisionBox,En=Ur.collisionCircleArray;if(En.length>0){var Fn=e.create(),Kn=Kr;e.mul(Fn,Ur.placementInvProjMatrix,ce.transform.glCoordMatrix),e.mul(Fn,Fn,Ur.placementViewportMatrix),jt.push({circleArray:En,circleOffset:vr,transform:Kn,invTransform:Fn}),lr+=En.length/4,vr=lr}!cn||St.draw(Ze,ut.LINES,Qr.disabled,Zt.disabled,ce.colorModeForRenderPass(),wt.disabled,or(Kr,ce.transform,Gr),ve.id,cn.layoutVertexBuffer,cn.indexBuffer,cn.segments,null,ce.transform.zoom,null,null,cn.collisionVertexBuffer)}}if(!(!Ce||!jt.length)){var qn=ce.useProgram("collisionCircle"),Qn=new e.StructArrayLayout2f1f2i16;Qn.resize(lr*4),Qn._trim();for(var ca=0,ba=0,ya=jt;ba<ya.length;ba+=1)for(var Ta=ya[ba],Ea=0;Ea<Ta.circleArray.length/4;Ea++){var Ha=Ea*4,ni=Ta.circleArray[Ha+0],Li=Ta.circleArray[Ha+1],ui=Ta.circleArray[Ha+2],pi=Ta.circleArray[Ha+3];Qn.emplace(ca++,ni,Li,ui,pi,0),Qn.emplace(ca++,ni,Li,ui,pi,1),Qn.emplace(ca++,ni,Li,ui,pi,2),Qn.emplace(ca++,ni,Li,ui,pi,3)}(!us||us.length<lr*2)&&(us=Bl(lr));for(var Ba=Ze.createIndexBuffer(us,!0),Pi=Ze.createVertexBuffer(Qn,e.collisionCircleLayout.members,!0),zi=0,Ni=jt;zi<Ni.length;zi+=1){var _i=Ni[zi],ji=Rr(_i.transform,_i.invTransform,ce.transform);qn.draw(Ze,ut.TRIANGLES,Qr.disabled,Zt.disabled,ce.colorModeForRenderPass(),wt.disabled,ji,ve.id,Pi,Ba,e.SegmentVector.simpleSegment(0,_i.circleOffset*2,_i.circleArray.length,_i.circleArray.length/2),null,ce.transform.zoom,null,null,null)}Pi.destroy(),Ba.destroy()}}function Bl(ce){var V=ce*2,ve=new e.StructArrayLayout3ui6;ve.resize(V),ve._trim();for(var j=0;j<V;j++){var de=j*6;ve.uint16[de+0]=j*4+0,ve.uint16[de+1]=j*4+1,ve.uint16[de+2]=j*4+2,ve.uint16[de+3]=j*4+2,ve.uint16[de+4]=j*4+3,ve.uint16[de+5]=j*4+0}return ve}var vf=e.identity(new Float32Array(16));function Pu(ce,V,ve,j,de){if(ce.renderPass==="translucent"){var Me=Zt.disabled,Ce=ce.colorModeForRenderPass(),Ze=ve.layout.get("text-variable-anchor");Ze&&Du(j,ce,ve,V,ve.layout.get("text-rotation-alignment"),ve.layout.get("text-pitch-alignment"),de),ve.paint.get("icon-opacity").constantOr(1)!==0&&Ru(ce,V,ve,j,!1,ve.paint.get("icon-translate"),ve.paint.get("icon-translate-anchor"),ve.layout.get("icon-rotation-alignment"),ve.layout.get("icon-pitch-alignment"),ve.layout.get("icon-keep-upright"),Me,Ce),ve.paint.get("text-opacity").constantOr(1)!==0&&Ru(ce,V,ve,j,!0,ve.paint.get("text-translate"),ve.paint.get("text-translate-anchor"),ve.layout.get("text-rotation-alignment"),ve.layout.get("text-pitch-alignment"),ve.layout.get("text-keep-upright"),Me,Ce),V.map.showCollisionBoxes&&(pu(ce,V,ve,j,ve.paint.get("text-translate"),ve.paint.get("text-translate-anchor"),!0),pu(ce,V,ve,j,ve.paint.get("icon-translate"),ve.paint.get("icon-translate-anchor"),!1))}}function du(ce,V,ve,j,de,Me){var Ce=e.getAnchorAlignment(ce),Ze=Ce.horizontalAlign,ut=Ce.verticalAlign,St=-(Ze-.5)*V,jt=-(ut-.5)*ve,lr=e.evaluateVariableOffset(ce,j);return new e.Point((St/de+lr[0])*Me,(jt/de+lr[1])*Me)}function Du(ce,V,ve,j,de,Me,Ce){for(var Ze=V.transform,ut=de==="map",St=Me==="map",jt=0,lr=ce;jt<lr.length;jt+=1){var vr=lr[jt],Er=j.getTile(vr),Vr=Er.getBucket(ve);if(!(!Vr||!Vr.text||!Vr.text.segments.get().length)){var Gr=Vr.textSizeData,Ur=e.evaluateSizeForZoom(Gr,Ze.zoom),Kr=An(Er,1,V.transform.zoom),cn=Wr(vr.posMatrix,St,ut,V.transform,Kr),En=ve.layout.get("icon-text-fit")!=="none"&&Vr.hasIconData();if(Ur){var Fn=Math.pow(2,Ze.zoom-Er.tileID.overscaledZ);ks(Vr,ut,St,Ce,e.symbolSize,Ze,cn,vr.posMatrix,Fn,Ur,En)}}}}function ks(ce,V,ve,j,de,Me,Ce,Ze,ut,St,jt){var lr=ce.text.placedSymbolArray,vr=ce.text.dynamicLayoutVertexArray,Er=ce.icon.dynamicLayoutVertexArray,Vr={};vr.clear();for(var Gr=0;Gr<lr.length;Gr++){var Ur=lr.get(Gr),Kr=ce.allowVerticalPlacement&&!Ur.placedOrientation,cn=!Ur.hidden&&Ur.crossTileID&&!Kr?j[Ur.crossTileID]:null;if(!cn)Wa(Ur.numGlyphs,vr);else{var En=new e.Point(Ur.anchorX,Ur.anchorY),Fn=ln(En,ve?Ze:Ce),Kn=Bn(Me.cameraToCenterDistance,Fn.signedDistanceFromCamera),qn=de.evaluateSizeForFeature(ce.textSizeData,St,Ur)*Kn/e.ONE_EM;ve&&(qn*=ce.tilePixelRatio/ut);for(var Qn=cn.width,ca=cn.height,ba=cn.anchor,ya=cn.textOffset,Ta=cn.textBoxScale,Ea=du(ba,Qn,ca,ya,Ta,qn),Ha=ve?ln(En.add(Ea),Ce).point:Fn.point.add(V?Ea.rotate(-Me.angle):Ea),ni=ce.allowVerticalPlacement&&Ur.placedOrientation===e.WritingMode.vertical?Math.PI/2:0,Li=0;Li<Ur.numGlyphs;Li++)e.addDynamicAttributes(vr,Ha,ni);jt&&Ur.associatedIconIndex>=0&&(Vr[Ur.associatedIconIndex]={shiftedAnchor:Ha,angle:ni})}}if(jt){Er.clear();for(var ui=ce.icon.placedSymbolArray,pi=0;pi<ui.length;pi++){var Ba=ui.get(pi);if(Ba.hidden)Wa(Ba.numGlyphs,Er);else{var Pi=Vr[pi];if(!Pi)Wa(Ba.numGlyphs,Er);else for(var zi=0;zi<Ba.numGlyphs;zi++)e.addDynamicAttributes(Er,Pi.shiftedAnchor,Pi.angle)}}ce.icon.dynamicLayoutVertexBuffer.updateData(Er)}ce.text.dynamicLayoutVertexBuffer.updateData(vr)}function Xu(ce,V,ve){return ve.iconsInText&&V?"symbolTextAndIcon":ce?"symbolSDF":"symbolIcon"}function Ru(ce,V,ve,j,de,Me,Ce,Ze,ut,St,jt,lr){for(var vr=ce.context,Er=vr.gl,Vr=ce.transform,Gr=Ze==="map",Ur=ut==="map",Kr=Gr&&ve.layout.get("symbol-placement")!=="point",cn=Gr&&!Ur&&!Kr,En=ve.layout.get("symbol-sort-key").constantOr(1)!==void 0,Fn=ce.depthModeForSublayer(0,Qr.ReadOnly),Kn=ve.layout.get("text-variable-anchor"),qn=[],Qn=0,ca=j;Qn<ca.length;Qn+=1){var ba=ca[Qn],ya=V.getTile(ba),Ta=ya.getBucket(ve);if(!!Ta){var Ea=de?Ta.text:Ta.icon;if(!(!Ea||!Ea.segments.get().length)){var Ha=Ea.programConfigurations.get(ve.id),ni=de||Ta.sdfIcons,Li=de?Ta.textSizeData:Ta.iconSizeData,ui=Ur||Vr.pitch!==0,pi=ce.useProgram(Xu(ni,de,Ta),Ha),Ba=e.evaluateSizeForZoom(Li,Vr.zoom),Pi=void 0,zi=[0,0],Ni=void 0,_i=void 0,ji=null,ii=void 0;if(de){if(Ni=ya.glyphAtlasTexture,_i=Er.LINEAR,Pi=ya.glyphAtlasTexture.size,Ta.iconsInText){zi=ya.imageAtlasTexture.size,ji=ya.imageAtlasTexture;var wi=Li.kind==="composite"||Li.kind==="camera";ii=ui||ce.options.rotating||ce.options.zooming||wi?Er.LINEAR:Er.NEAREST}}else{var _o=ve.layout.get("icon-size").constantOr(0)!==1||Ta.iconsNeedLinear;Ni=ya.imageAtlasTexture,_i=ni||ce.options.rotating||ce.options.zooming||_o||ui?Er.LINEAR:Er.NEAREST,Pi=ya.imageAtlasTexture.size}var Oo=An(ya,1,ce.transform.zoom),Ml=Wr(ba.posMatrix,Ur,Gr,ce.transform,Oo),Sl=wn(ba.posMatrix,Ur,Gr,ce.transform,Oo),Ql=Kn&&Ta.hasTextData(),$l=ve.layout.get("icon-text-fit")!=="none"&&Ql&&Ta.hasIconData();Kr&&Wn(Ta,ba.posMatrix,ce,de,Ml,Sl,Ur,St);var bu=ce.translatePosMatrix(ba.posMatrix,ya,Me,Ce),ql=Kr||de&&Kn||$l?vf:Ml,Bs=ce.translatePosMatrix(Sl,ya,Me,Ce,!0),Vu=ni&&ve.paint.get(de?"text-halo-width":"icon-halo-width").constantOr(1)!==0,bs=void 0;ni?Ta.iconsInText?bs=Js(Li.kind,Ba,cn,Ur,ce,bu,ql,Bs,Pi,zi):bs=Io(Li.kind,Ba,cn,Ur,ce,bu,ql,Bs,de,Pi,!0):bs=Ss(Li.kind,Ba,cn,Ur,ce,bu,ql,Bs,de,Pi);var fl={program:pi,buffers:Ea,uniformValues:bs,atlasTexture:Ni,atlasTextureIcon:ji,atlasInterpolation:_i,atlasInterpolationIcon:ii,isSDF:ni,hasHalo:Vu};if(En)for(var eu=Ea.segments.get(),Hl=0,tu=eu;Hl<tu.length;Hl+=1){var Cf=tu[Hl];qn.push({segments:new e.SegmentVector([Cf]),sortKey:Cf.sortKey,state:fl})}else qn.push({segments:Ea.segments,sortKey:0,state:fl})}}}En&&qn.sort(function(Lf,Pf){return Lf.sortKey-Pf.sortKey});for(var Zu=0,cs=qn;Zu<cs.length;Zu+=1){var mf=cs[Zu],Es=mf.state;if(vr.activeTexture.set(Er.TEXTURE0),Es.atlasTexture.bind(Es.atlasInterpolation,Er.CLAMP_TO_EDGE),Es.atlasTextureIcon&&(vr.activeTexture.set(Er.TEXTURE1),Es.atlasTextureIcon&&Es.atlasTextureIcon.bind(Es.atlasInterpolationIcon,Er.CLAMP_TO_EDGE)),Es.isSDF){var xf=Es.uniformValues;Es.hasHalo&&(xf.u_is_halo=1,Iu(Es.buffers,mf.segments,ve,ce,Es.program,Fn,jt,lr,xf)),xf.u_is_halo=0}Iu(Es.buffers,mf.segments,ve,ce,Es.program,Fn,jt,lr,Es.uniformValues)}}function Iu(ce,V,ve,j,de,Me,Ce,Ze,ut){var St=j.context,jt=St.gl;de.draw(St,jt.TRIANGLES,Me,Ce,Ze,wt.disabled,ut,ve.id,ce.layoutVertexBuffer,ce.indexBuffer,V,ve.paint,j.transform.zoom,ce.programConfigurations.get(ve.id),ce.dynamicLayoutVertexBuffer,ce.opacityVertexBuffer)}function zo(ce,V,ve,j){if(ce.renderPass==="translucent"){var de=ve.paint.get("circle-opacity"),Me=ve.paint.get("circle-stroke-width"),Ce=ve.paint.get("circle-stroke-opacity"),Ze=ve.layout.get("circle-sort-key").constantOr(1)!==void 0;if(!(de.constantOr(1)===0&&(Me.constantOr(1)===0||Ce.constantOr(1)===0))){for(var ut=ce.context,St=ut.gl,jt=ce.depthModeForSublayer(0,Qr.ReadOnly),lr=Zt.disabled,vr=ce.colorModeForRenderPass(),Er=[],Vr=0;Vr<j.length;Vr++){var Gr=j[Vr],Ur=V.getTile(Gr),Kr=Ur.getBucket(ve);if(!!Kr){var cn=Kr.programConfigurations.get(ve.id),En=ce.useProgram("circle",cn),Fn=Kr.layoutVertexBuffer,Kn=Kr.indexBuffer,qn=gt(ce,Gr,Ur,ve),Qn={programConfiguration:cn,program:En,layoutVertexBuffer:Fn,indexBuffer:Kn,uniformValues:qn};if(Ze)for(var ca=Kr.segments.get(),ba=0,ya=ca;ba<ya.length;ba+=1){var Ta=ya[ba];Er.push({segments:new e.SegmentVector([Ta]),sortKey:Ta.sortKey,state:Qn})}else Er.push({segments:Kr.segments,sortKey:0,state:Qn})}}Ze&&Er.sort(function(_i,ji){return _i.sortKey-ji.sortKey});for(var Ea=0,Ha=Er;Ea<Ha.length;Ea+=1){var ni=Ha[Ea],Li=ni.state,ui=Li.programConfiguration,pi=Li.program,Ba=Li.layoutVertexBuffer,Pi=Li.indexBuffer,zi=Li.uniformValues,Ni=ni.segments;pi.draw(ut,St.TRIANGLES,jt,lr,vr,wt.disabled,zi,ve.id,Ba,Pi,Ni,ve.paint,ce.transform.zoom,ui)}}}}function zu(ce,V,ve,j){if(ve.paint.get("heatmap-opacity")!==0)if(ce.renderPass==="offscreen"){var de=ce.context,Me=de.gl,Ce=Zt.disabled,Ze=new Ke([Me.ONE,Me.ONE],e.Color.transparent,[!0,!0,!0,!0]);$u(de,ce,ve),de.clear({color:e.Color.transparent});for(var ut=0;ut<j.length;ut++){var St=j[ut];if(!V.hasRenderableParent(St)){var jt=V.getTile(St),lr=jt.getBucket(ve);if(!!lr){var vr=lr.programConfigurations.get(ve.id),Er=ce.useProgram("heatmap",vr),Vr=ce.transform,Gr=Vr.zoom;Er.draw(de,Me.TRIANGLES,Qr.disabled,Ce,Ze,wt.disabled,zn(St.posMatrix,jt,Gr,ve.paint.get("heatmap-intensity")),ve.id,lr.layoutVertexBuffer,lr.indexBuffer,lr.segments,ve.paint,ce.transform.zoom,vr)}}}de.viewport.set([0,0,ce.width,ce.height])}else ce.renderPass==="translucent"&&(ce.context.setColorMode(ce.colorModeForRenderPass()),gu(ce,ve))}function $u(ce,V,ve){var j=ce.gl;ce.activeTexture.set(j.TEXTURE1),ce.viewport.set([0,0,V.width/4,V.height/4]);var de=ve.heatmapFbo;if(de)j.bindTexture(j.TEXTURE_2D,de.colorAttachment.get()),ce.bindFramebuffer.set(de.framebuffer);else{var Me=j.createTexture();j.bindTexture(j.TEXTURE_2D,Me),j.texParameteri(j.TEXTURE_2D,j.TEXTURE_WRAP_S,j.CLAMP_TO_EDGE),j.texParameteri(j.TEXTURE_2D,j.TEXTURE_WRAP_T,j.CLAMP_TO_EDGE),j.texParameteri(j.TEXTURE_2D,j.TEXTURE_MIN_FILTER,j.LINEAR),j.texParameteri(j.TEXTURE_2D,j.TEXTURE_MAG_FILTER,j.LINEAR),de=ve.heatmapFbo=ce.createFramebuffer(V.width/4,V.height/4,!1),ms(ce,V,Me,de)}}function ms(ce,V,ve,j){var de=ce.gl,Me=ce.extRenderToTextureHalfFloat?ce.extTextureHalfFloat.HALF_FLOAT_OES:de.UNSIGNED_BYTE;de.texImage2D(de.TEXTURE_2D,0,de.RGBA,V.width/4,V.height/4,0,de.RGBA,Me,null),j.colorAttachment.set(ve)}function gu(ce,V){var ve=ce.context,j=ve.gl,de=V.heatmapFbo;if(!!de){ve.activeTexture.set(j.TEXTURE0),j.bindTexture(j.TEXTURE_2D,de.colorAttachment.get()),ve.activeTexture.set(j.TEXTURE1);var Me=V.colorRampTexture;Me||(Me=V.colorRampTexture=new e.Texture(ve,V.colorRamp,j.RGBA)),Me.bind(j.LINEAR,j.CLAMP_TO_EDGE),ce.useProgram("heatmapTexture").draw(ve,j.TRIANGLES,Qr.disabled,Zt.disabled,ce.colorModeForRenderPass(),wt.disabled,Pn(ce,V,0,1),V.id,ce.viewportBuffer,ce.quadTriangleIndexBuffer,ce.viewportSegments,V.paint,ce.transform.zoom)}}function yu(ce,V,ve,j){if(ce.renderPass==="translucent"){var de=ve.paint.get("line-opacity"),Me=ve.paint.get("line-width");if(!(de.constantOr(1)===0||Me.constantOr(1)===0)){var Ce=ce.depthModeForSublayer(0,Qr.ReadOnly),Ze=ce.colorModeForRenderPass(),ut=ve.paint.get("line-dasharray"),St=ve.paint.get("line-pattern"),jt=St.constantOr(1),lr=ve.paint.get("line-gradient"),vr=ve.getCrossfadeParameters(),Er=jt?"linePattern":ut?"lineSDF":lr?"lineGradient":"line",Vr=ce.context,Gr=Vr.gl,Ur=!0;if(lr){Vr.activeTexture.set(Gr.TEXTURE0);var Kr=ve.gradientTexture;if(!ve.gradient)return;Kr||(Kr=ve.gradientTexture=new e.Texture(Vr,ve.gradient,Gr.RGBA)),Kr.bind(Gr.LINEAR,Gr.CLAMP_TO_EDGE)}for(var cn=0,En=j;cn<En.length;cn+=1){var Fn=En[cn],Kn=V.getTile(Fn);if(!(jt&&!Kn.patternsLoaded())){var qn=Kn.getBucket(ve);if(!!qn){var Qn=qn.programConfigurations.get(ve.id),ca=ce.context.program.get(),ba=ce.useProgram(Er,Qn),ya=Ur||ba.program!==ca,Ta=St.constantOr(null);if(Ta&&Kn.imageAtlas){var Ea=Kn.imageAtlas,Ha=Ea.patternPositions[Ta.to.toString()],ni=Ea.patternPositions[Ta.from.toString()];Ha&&ni&&Qn.setConstantPatternPositions(Ha,ni)}var Li=jt?gi(ce,Kn,ve,vr):ut?mi(ce,Kn,ve,ut,vr):lr?di(ce,Kn,ve):Qa(ce,Kn,ve);jt?(Vr.activeTexture.set(Gr.TEXTURE0),Kn.imageAtlasTexture.bind(Gr.LINEAR,Gr.CLAMP_TO_EDGE),Qn.updatePaintBuffers(vr)):ut&&(ya||ce.lineAtlas.dirty)&&(Vr.activeTexture.set(Gr.TEXTURE0),ce.lineAtlas.bind(Vr)),ba.draw(Vr,Gr.TRIANGLES,Ce,ce.stencilModeForClipping(Fn),Ze,wt.disabled,Li,ve.id,qn.layoutVertexBuffer,qn.indexBuffer,qn.segments,ve.paint,ce.transform.zoom,Qn),Ur=!1}}}}}}function Fu(ce,V,ve,j){var de=ve.paint.get("fill-color"),Me=ve.paint.get("fill-opacity");if(Me.constantOr(1)!==0){var Ce=ce.colorModeForRenderPass(),Ze=ve.paint.get("fill-pattern"),ut=ce.opaquePassEnabledForLayer()&&!Ze.constantOr(1)&&de.constantOr(e.Color.transparent).a===1&&Me.constantOr(0)===1?"opaque":"translucent";if(ce.renderPass===ut){var St=ce.depthModeForSublayer(1,ce.renderPass==="opaque"?Qr.ReadWrite:Qr.ReadOnly);De(ce,V,ve,j,St,Ce,!1)}if(ce.renderPass==="translucent"&&ve.paint.get("fill-antialias")){var jt=ce.depthModeForSublayer(ve.getPaintProperty("fill-outline-color")?2:0,Qr.ReadOnly);De(ce,V,ve,j,jt,Ce,!0)}}}function De(ce,V,ve,j,de,Me,Ce){var Ze=ce.context.gl,ut=ve.paint.get("fill-pattern"),St=ut&&ut.constantOr(1),jt=ve.getCrossfadeParameters(),lr,vr,Er,Vr,Gr;Ce?(vr=St&&!ve.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",lr=Ze.LINES):(vr=St?"fillPattern":"fill",lr=Ze.TRIANGLES);for(var Ur=0,Kr=j;Ur<Kr.length;Ur+=1){var cn=Kr[Ur],En=V.getTile(cn);if(!(St&&!En.patternsLoaded())){var Fn=En.getBucket(ve);if(!!Fn){var Kn=Fn.programConfigurations.get(ve.id),qn=ce.useProgram(vr,Kn);St&&(ce.context.activeTexture.set(Ze.TEXTURE0),En.imageAtlasTexture.bind(Ze.LINEAR,Ze.CLAMP_TO_EDGE),Kn.updatePaintBuffers(jt));var Qn=ut.constantOr(null);if(Qn&&En.imageAtlas){var ca=En.imageAtlas,ba=ca.patternPositions[Qn.to.toString()],ya=ca.patternPositions[Qn.from.toString()];ba&&ya&&Kn.setConstantPatternPositions(ba,ya)}var Ta=ce.translatePosMatrix(cn.posMatrix,En,ve.paint.get("fill-translate"),ve.paint.get("fill-translate-anchor"));if(!Ce)Vr=Fn.indexBuffer,Gr=Fn.segments,Er=St?os(Ta,ce,jt,En):ko(Ta);else{Vr=Fn.indexBuffer2,Gr=Fn.segments2;var Ea=[Ze.drawingBufferWidth,Ze.drawingBufferHeight];Er=vr==="fillOutlinePattern"&&St?Fl(Ta,ce,jt,En,Ea):hu(Ta,Ea)}qn.draw(ce.context,lr,de,ce.stencilModeForClipping(cn),Me,wt.disabled,Er,ve.id,Fn.layoutVertexBuffer,Vr,Gr,ve.paint,ce.transform.zoom,Kn)}}}}function We(ce,V,ve,j){var de=ve.paint.get("fill-extrusion-opacity");if(de!==0&&ce.renderPass==="translucent"){var Me=new Qr(ce.context.gl.LEQUAL,Qr.ReadWrite,ce.depthRangeFor3D);if(de===1&&!ve.paint.get("fill-extrusion-pattern").constantOr(1)){var Ce=ce.colorModeForRenderPass();et(ce,V,ve,j,Me,Zt.disabled,Ce)}else et(ce,V,ve,j,Me,Zt.disabled,Ke.disabled),et(ce,V,ve,j,Me,ce.stencilModeFor3D(),ce.colorModeForRenderPass())}}function et(ce,V,ve,j,de,Me,Ce){for(var Ze=ce.context,ut=Ze.gl,St=ve.paint.get("fill-extrusion-pattern"),jt=St.constantOr(1),lr=ve.getCrossfadeParameters(),vr=ve.paint.get("fill-extrusion-opacity"),Er=0,Vr=j;Er<Vr.length;Er+=1){var Gr=Vr[Er],Ur=V.getTile(Gr),Kr=Ur.getBucket(ve);if(!!Kr){var cn=Kr.programConfigurations.get(ve.id),En=ce.useProgram(jt?"fillExtrusionPattern":"fillExtrusion",cn);jt&&(ce.context.activeTexture.set(ut.TEXTURE0),Ur.imageAtlasTexture.bind(ut.LINEAR,ut.CLAMP_TO_EDGE),cn.updatePaintBuffers(lr));var Fn=St.constantOr(null);if(Fn&&Ur.imageAtlas){var Kn=Ur.imageAtlas,qn=Kn.patternPositions[Fn.to.toString()],Qn=Kn.patternPositions[Fn.from.toString()];qn&&Qn&&cn.setConstantPatternPositions(qn,Qn)}var ca=ce.translatePosMatrix(Gr.posMatrix,Ur,ve.paint.get("fill-extrusion-translate"),ve.paint.get("fill-extrusion-translate-anchor")),ba=ve.paint.get("fill-extrusion-vertical-gradient"),ya=jt?zs(ca,ce,ba,vr,Gr,lr,Ur):as(ca,ce,ba,vr);En.draw(Ze,Ze.gl.TRIANGLES,de,Me,Ce,wt.backCCW,ya,ve.id,Kr.layoutVertexBuffer,Kr.indexBuffer,Kr.segments,ve.paint,ce.transform.zoom,cn)}}}function ot(ce,V,ve,j){if(!(ce.renderPass!=="offscreen"&&ce.renderPass!=="translucent")){for(var de=ce.context,Me=V.getSource().maxzoom,Ce=ce.depthModeForSublayer(0,Qr.ReadOnly),Ze=ce.colorModeForRenderPass(),ut=ce.renderPass==="translucent"?ce.stencilConfigForOverlap(j):[{},j],St=ut[0],jt=ut[1],lr=0,vr=jt;lr<vr.length;lr+=1){var Er=vr[lr],Vr=V.getTile(Er);Vr.needsHillshadePrepare&&ce.renderPass==="offscreen"?yt(ce,Vr,ve,Me,Ce,Zt.disabled,Ze):ce.renderPass==="translucent"&&bt(ce,Vr,ve,Ce,St[Er.overscaledZ],Ze)}de.viewport.set([0,0,ce.width,ce.height])}}function bt(ce,V,ve,j,de,Me){var Ce=ce.context,Ze=Ce.gl,ut=V.fbo;if(!!ut){var St=ce.useProgram("hillshade");Ce.activeTexture.set(Ze.TEXTURE0),Ze.bindTexture(Ze.TEXTURE_2D,ut.colorAttachment.get());var jt=za(ce,V,ve);St.draw(Ce,Ze.TRIANGLES,j,de,Me,wt.disabled,jt,ve.id,ce.rasterBoundsBuffer,ce.quadTriangleIndexBuffer,ce.rasterBoundsSegments)}}function yt(ce,V,ve,j,de,Me,Ce){var Ze=ce.context,ut=Ze.gl,St=V.dem;if(St&&St.data){var jt=St.dim,lr=St.stride,vr=St.getPixels();if(Ze.activeTexture.set(ut.TEXTURE1),Ze.pixelStoreUnpackPremultiplyAlpha.set(!1),V.demTexture=V.demTexture||ce.getTileTexture(lr),V.demTexture){var Er=V.demTexture;Er.update(vr,{premultiply:!1}),Er.bind(ut.NEAREST,ut.CLAMP_TO_EDGE)}else V.demTexture=new e.Texture(Ze,vr,ut.RGBA,{premultiply:!1}),V.demTexture.bind(ut.NEAREST,ut.CLAMP_TO_EDGE);Ze.activeTexture.set(ut.TEXTURE0);var Vr=V.fbo;if(!Vr){var Gr=new e.Texture(Ze,{width:jt,height:jt,data:null},ut.RGBA);Gr.bind(ut.LINEAR,ut.CLAMP_TO_EDGE),Vr=V.fbo=Ze.createFramebuffer(jt,jt,!0),Vr.colorAttachment.set(Gr.texture)}Ze.bindFramebuffer.set(Vr.framebuffer),Ze.viewport.set([0,0,jt,jt]),ce.useProgram("hillshadePrepare").draw(Ze,ut.TRIANGLES,de,Me,Ce,wt.disabled,ka(V.tileID,St,j),ve.id,ce.rasterBoundsBuffer,ce.quadTriangleIndexBuffer,ce.rasterBoundsSegments),V.needsHillshadePrepare=!1}}function Mt(ce,V,ve,j){if(ce.renderPass==="translucent"&&ve.paint.get("raster-opacity")!==0&&!!j.length)for(var de=ce.context,Me=de.gl,Ce=V.getSource(),Ze=ce.useProgram("raster"),ut=ce.colorModeForRenderPass(),St=Ce instanceof Z?[{},j]:ce.stencilConfigForOverlap(j),jt=St[0],lr=St[1],vr=lr[lr.length-1].overscaledZ,Er=!ce.options.moving,Vr=0,Gr=lr;Vr<Gr.length;Vr+=1){var Ur=Gr[Vr],Kr=ce.depthModeForSublayer(Ur.overscaledZ-vr,ve.paint.get("raster-opacity")===1?Qr.ReadWrite:Qr.ReadOnly,Me.LESS),cn=V.getTile(Ur),En=ce.transform.calculatePosMatrix(Ur.toUnwrapped(),Er);cn.registerFadeDuration(ve.paint.get("raster-fade-duration"));var Fn=V.findLoadedParent(Ur,0),Kn=ur(cn,Fn,V,ve,ce.transform),qn=void 0,Qn=void 0,ca=ve.paint.get("raster-resampling")==="nearest"?Me.NEAREST:Me.LINEAR;de.activeTexture.set(Me.TEXTURE0),cn.texture.bind(ca,Me.CLAMP_TO_EDGE,Me.LINEAR_MIPMAP_NEAREST),de.activeTexture.set(Me.TEXTURE1),Fn?(Fn.texture.bind(ca,Me.CLAMP_TO_EDGE,Me.LINEAR_MIPMAP_NEAREST),qn=Math.pow(2,Fn.tileID.overscaledZ-cn.tileID.overscaledZ),Qn=[cn.tileID.canonical.x*qn%1,cn.tileID.canonical.y*qn%1]):cn.texture.bind(ca,Me.CLAMP_TO_EDGE,Me.LINEAR_MIPMAP_NEAREST);var ba=qi(En,Qn||[0,0],qn||1,Kn,ve);Ce instanceof Z?Ze.draw(de,Me.TRIANGLES,Kr,Zt.disabled,ut,wt.disabled,ba,ve.id,Ce.boundsBuffer,ce.quadTriangleIndexBuffer,Ce.boundsSegments):Ze.draw(de,Me.TRIANGLES,Kr,jt[Ur.overscaledZ],ut,wt.disabled,ba,ve.id,ce.rasterBoundsBuffer,ce.quadTriangleIndexBuffer,ce.rasterBoundsSegments)}}function ur(ce,V,ve,j,de){var Me=j.paint.get("raster-fade-duration");if(Me>0){var Ce=e.browser.now(),Ze=(Ce-ce.timeAdded)/Me,ut=V?(Ce-V.timeAdded)/Me:-1,St=ve.getSource(),jt=de.coveringZoomLevel({tileSize:St.tileSize,roundZoom:St.roundZoom}),lr=!V||Math.abs(V.tileID.overscaledZ-jt)>Math.abs(ce.tileID.overscaledZ-jt),vr=lr&&ce.refreshedUponExpiration?1:e.clamp(lr?Ze:1-ut,0,1);return ce.refreshedUponExpiration&&Ze>=1&&(ce.refreshedUponExpiration=!1),V?{opacity:1,mix:1-vr}:{opacity:vr,mix:0}}else return{opacity:1,mix:0}}function pr(ce,V,ve){var j=ve.paint.get("background-color"),de=ve.paint.get("background-opacity");if(de!==0){var Me=ce.context,Ce=Me.gl,Ze=ce.transform,ut=Ze.tileSize,St=ve.paint.get("background-pattern");if(!ce.isPatternMissing(St)){var jt=!St&&j.a===1&&de===1&&ce.opaquePassEnabledForLayer()?"opaque":"translucent";if(ce.renderPass===jt){var lr=Zt.disabled,vr=ce.depthModeForSublayer(0,jt==="opaque"?Qr.ReadWrite:Qr.ReadOnly),Er=ce.colorModeForRenderPass(),Vr=ce.useProgram(St?"backgroundPattern":"background"),Gr=Ze.coveringTiles({tileSize:ut});St&&(Me.activeTexture.set(Ce.TEXTURE0),ce.imageManager.bind(ce.context));for(var Ur=ve.getCrossfadeParameters(),Kr=0,cn=Gr;Kr<cn.length;Kr+=1){var En=cn[Kr],Fn=ce.transform.calculatePosMatrix(En.toUnwrapped()),Kn=St?Ol(Fn,de,ce,St,{tileID:En,tileSize:ut},Ur):mo(Fn,de,j);Vr.draw(Me,Ce.TRIANGLES,vr,lr,Er,wt.disabled,Kn,ve.id,ce.tileExtentBuffer,ce.quadTriangleIndexBuffer,ce.tileExtentSegments)}}}}}var sr=new e.Color(1,0,0,1),xr=new e.Color(0,1,0,1),Dr=new e.Color(0,0,1,1),Xr=new e.Color(1,0,1,1),qr=new e.Color(0,1,1,1);function bn(ce){var V=ce.transform.padding,ve=3;Yn(ce,ce.transform.height-(V.top||0),ve,sr),Yn(ce,V.bottom||0,ve,xr),da(ce,V.left||0,ve,Dr),da(ce,ce.transform.width-(V.right||0),ve,Xr);var j=ce.transform.centerPoint;Dn(ce,j.x,ce.transform.height-j.y,qr)}function Dn(ce,V,ve,j){var de=20,Me=2;xa(ce,V-Me/2,ve-de/2,Me,de,j),xa(ce,V-de/2,ve-Me/2,de,Me,j)}function Yn(ce,V,ve,j){xa(ce,0,V+ve/2,ce.transform.width,ve,j)}function da(ce,V,ve,j){xa(ce,V-ve/2,0,ve,ce.transform.height,j)}function xa(ce,V,ve,j,de,Me){var Ce=ce.context,Ze=Ce.gl;Ze.enable(Ze.SCISSOR_TEST),Ze.scissor(V*e.browser.devicePixelRatio,ve*e.browser.devicePixelRatio,j*e.browser.devicePixelRatio,de*e.browser.devicePixelRatio),Ce.clear({color:Me}),Ze.disable(Ze.SCISSOR_TEST)}function Ka(ce,V,ve){for(var j=0;j<ve.length;j++)Ya(ce,V,ve[j])}function Ya(ce,V,ve){var j=ce.context,de=j.gl,Me=ve.posMatrix,Ce=ce.useProgram("debug"),Ze=Qr.disabled,ut=Zt.disabled,St=ce.colorModeForRenderPass(),jt="$debug";j.activeTexture.set(de.TEXTURE0),ce.emptyTexture.bind(de.LINEAR,de.CLAMP_TO_EDGE),Ce.draw(j,de.LINE_STRIP,Ze,ut,St,wt.disabled,dn(Me,e.Color.red),jt,ce.debugBuffer,ce.tileBorderIndexBuffer,ce.debugSegments);var lr=V.getTileByID(ve.key).latestRawTileData,vr=lr&&lr.byteLength||0,Er=Math.floor(vr/1024),Vr=V.getTile(ve).tileSize,Gr=512/Math.min(Vr,512)*(ve.overscaledZ/ce.transform.zoom)*.5,Ur=ve.canonical.toString();ve.overscaledZ!==ve.canonical.z&&(Ur+=" => "+ve.overscaledZ);var Kr=Ur+" "+Er+"kb";ei(ce,Kr),Ce.draw(j,de.TRIANGLES,Ze,ut,Ke.alphaBlended,wt.disabled,dn(Me,e.Color.transparent,Gr),jt,ce.debugBuffer,ce.quadTriangleIndexBuffer,ce.debugSegments)}function ei(ce,V){ce.initDebugOverlayCanvas();var ve=ce.debugOverlayCanvas,j=ce.context.gl,de=ce.debugOverlayCanvas.getContext("2d");de.clearRect(0,0,ve.width,ve.height),de.shadowColor="white",de.shadowBlur=2,de.lineWidth=1.5,de.strokeStyle="white",de.textBaseline="top",de.font="bold "+36+"px Open Sans, sans-serif",de.fillText(V,5,5),de.strokeText(V,5,5),ce.debugOverlayTexture.update(ve),ce.debugOverlayTexture.bind(j.LINEAR,j.CLAMP_TO_EDGE)}function hi(ce,V,ve){var j=ce.context,de=ve.implementation;if(ce.renderPass==="offscreen"){var Me=de.prerender;Me&&(ce.setCustomLayerDefaults(),j.setColorMode(ce.colorModeForRenderPass()),Me.call(de,j.gl,ce.transform.customLayerMatrix()),j.setDirty(),ce.setBaseState())}else if(ce.renderPass==="translucent"){ce.setCustomLayerDefaults(),j.setColorMode(ce.colorModeForRenderPass()),j.setStencilMode(Zt.disabled);var Ce=de.renderingMode==="3d"?new Qr(ce.context.gl.LEQUAL,Qr.ReadWrite,ce.depthRangeFor3D):ce.depthModeForSublayer(0,Qr.ReadOnly);j.setDepthMode(Ce),de.render(j.gl,ce.transform.customLayerMatrix()),j.setDirty(),ce.setBaseState(),j.bindFramebuffer.set(null)}}var ao={symbol:Pu,circle:zo,heatmap:zu,line:yu,fill:Fu,"fill-extrusion":We,hillshade:ot,raster:Mt,background:pr,debug:Ka,custom:hi},ri=function(V,ve){this.context=new Pt(V),this.transform=ve,this._tileTextures={},this.setup(),this.numSublayers=ke.maxUnderzooming+ke.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new ma,this.gpuTimers={}};ri.prototype.resize=function(V,ve){if(this.width=V*e.browser.devicePixelRatio,this.height=ve*e.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var j=0,de=this.style._order;j<de.length;j+=1){var Me=de[j];this.style._layers[Me].resize()}},ri.prototype.setup=function(){var V=this.context,ve=new e.StructArrayLayout2i4;ve.emplaceBack(0,0),ve.emplaceBack(e.EXTENT,0),ve.emplaceBack(0,e.EXTENT),ve.emplaceBack(e.EXTENT,e.EXTENT),this.tileExtentBuffer=V.createVertexBuffer(ve,rl.members),this.tileExtentSegments=e.SegmentVector.simpleSegment(0,0,4,2);var j=new e.StructArrayLayout2i4;j.emplaceBack(0,0),j.emplaceBack(e.EXTENT,0),j.emplaceBack(0,e.EXTENT),j.emplaceBack(e.EXTENT,e.EXTENT),this.debugBuffer=V.createVertexBuffer(j,rl.members),this.debugSegments=e.SegmentVector.simpleSegment(0,0,4,5);var de=new e.StructArrayLayout4i8;de.emplaceBack(0,0,0,0),de.emplaceBack(e.EXTENT,0,e.EXTENT,0),de.emplaceBack(0,e.EXTENT,0,e.EXTENT),de.emplaceBack(e.EXTENT,e.EXTENT,e.EXTENT,e.EXTENT),this.rasterBoundsBuffer=V.createVertexBuffer(de,Y.members),this.rasterBoundsSegments=e.SegmentVector.simpleSegment(0,0,4,2);var Me=new e.StructArrayLayout2i4;Me.emplaceBack(0,0),Me.emplaceBack(1,0),Me.emplaceBack(0,1),Me.emplaceBack(1,1),this.viewportBuffer=V.createVertexBuffer(Me,rl.members),this.viewportSegments=e.SegmentVector.simpleSegment(0,0,4,2);var Ce=new e.StructArrayLayout1ui2;Ce.emplaceBack(0),Ce.emplaceBack(1),Ce.emplaceBack(3),Ce.emplaceBack(2),Ce.emplaceBack(0),this.tileBorderIndexBuffer=V.createIndexBuffer(Ce);var Ze=new e.StructArrayLayout3ui6;Ze.emplaceBack(0,1,2),Ze.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=V.createIndexBuffer(Ze),this.emptyTexture=new e.Texture(V,{width:1,height:1,data:new Uint8Array([0,0,0,0])},V.gl.RGBA);var ut=this.context.gl;this.stencilClearMode=new Zt({func:ut.ALWAYS,mask:0},0,255,ut.ZERO,ut.ZERO,ut.ZERO)},ri.prototype.clearStencil=function(){var V=this.context,ve=V.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var j=e.create();e.ortho(j,0,this.width,this.height,0,0,1),e.scale(j,j,[ve.drawingBufferWidth,ve.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(V,ve.TRIANGLES,Qr.disabled,this.stencilClearMode,Ke.disabled,wt.disabled,Ln(j),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},ri.prototype._renderTileClippingMasks=function(V,ve){if(!(this.currentStencilSource===V.source||!V.isTileClipped()||!ve||!ve.length)){this.currentStencilSource=V.source;var j=this.context,de=j.gl;this.nextStencilID+ve.length>256&&this.clearStencil(),j.setColorMode(Ke.disabled),j.setDepthMode(Qr.disabled);var Me=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var Ce=0,Ze=ve;Ce<Ze.length;Ce+=1){var ut=Ze[Ce],St=this._tileClippingMaskIDs[ut.key]=this.nextStencilID++;Me.draw(j,de.TRIANGLES,Qr.disabled,new Zt({func:de.ALWAYS,mask:0},St,255,de.KEEP,de.KEEP,de.REPLACE),Ke.disabled,wt.disabled,Ln(ut.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},ri.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var V=this.nextStencilID++,ve=this.context.gl;return new Zt({func:ve.NOTEQUAL,mask:255},V,255,ve.KEEP,ve.KEEP,ve.REPLACE)},ri.prototype.stencilModeForClipping=function(V){var ve=this.context.gl;return new Zt({func:ve.EQUAL,mask:255},this._tileClippingMaskIDs[V.key],0,ve.KEEP,ve.KEEP,ve.REPLACE)},ri.prototype.stencilConfigForOverlap=function(V){var ve,j=this.context.gl,de=V.sort(function(St,jt){return jt.overscaledZ-St.overscaledZ}),Me=de[de.length-1].overscaledZ,Ce=de[0].overscaledZ-Me+1;if(Ce>1){this.currentStencilSource=void 0,this.nextStencilID+Ce>256&&this.clearStencil();for(var Ze={},ut=0;ut<Ce;ut++)Ze[ut+Me]=new Zt({func:j.GEQUAL,mask:255},ut+this.nextStencilID,255,j.KEEP,j.KEEP,j.REPLACE);return this.nextStencilID+=Ce,[Ze,de]}return[(ve={},ve[Me]=Zt.disabled,ve),de]},ri.prototype.colorModeForRenderPass=function(){var V=this.context.gl;if(this._showOverdrawInspector){var ve=8,j=1/ve;return new Ke([V.CONSTANT_COLOR,V.ONE],new e.Color(j,j,j,0),[!0,!0,!0,!0])}else return this.renderPass==="opaque"?Ke.unblended:Ke.alphaBlended},ri.prototype.depthModeForSublayer=function(V,ve,j){if(!this.opaquePassEnabledForLayer())return Qr.disabled;var de=1-((1+this.currentLayer)*this.numSublayers+V)*this.depthEpsilon;return new Qr(j||this.context.gl.LEQUAL,ve,[de,de])},ri.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},ri.prototype.render=function(V,ve){var j=this;this.style=V,this.options=ve,this.lineAtlas=V.lineAtlas,this.imageManager=V.imageManager,this.glyphManager=V.glyphManager,this.symbolFadeChange=V.placement.symbolFadeChange(e.browser.now()),this.imageManager.beginFrame();var de=this.style._order,Me=this.style.sourceCaches;for(var Ce in Me){var Ze=Me[Ce];Ze.used&&Ze.prepare(this.context)}var ut={},St={},jt={};for(var lr in Me){var vr=Me[lr];ut[lr]=vr.getVisibleCoordinates(),St[lr]=ut[lr].slice().reverse(),jt[lr]=vr.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var Er=0;Er<de.length;Er++){var Vr=de[Er];if(this.style._layers[Vr].is3D()){this.opaquePassCutoff=Er;break}}this.renderPass="offscreen";for(var Gr=0,Ur=de;Gr<Ur.length;Gr+=1){var Kr=Ur[Gr],cn=this.style._layers[Kr];if(!(!cn.hasOffscreenPass()||cn.isHidden(this.transform.zoom))){var En=St[cn.source];cn.type!=="custom"&&!En.length||this.renderLayer(this,Me[cn.source],cn,En)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:ve.showOverdrawInspector?e.Color.black:e.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=ve.showOverdrawInspector,this.depthRangeFor3D=[0,1-(V._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=de.length-1;this.currentLayer>=0;this.currentLayer--){var Fn=this.style._layers[de[this.currentLayer]],Kn=Me[Fn.source],qn=ut[Fn.source];this._renderTileClippingMasks(Fn,qn),this.renderLayer(this,Kn,Fn,qn)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<de.length;this.currentLayer++){var Qn=this.style._layers[de[this.currentLayer]],ca=Me[Qn.source],ba=(Qn.type==="symbol"?jt:St)[Qn.source];this._renderTileClippingMasks(Qn,ut[Qn.source]),this.renderLayer(this,ca,Qn,ba)}if(this.options.showTileBoundaries){var ya,Ta,Ea=e.values(this.style._layers);Ea.forEach(function(Ha){Ha.source&&!Ha.isHidden(j.transform.zoom)&&(Ha.source!==(Ta&&Ta.id)&&(Ta=j.style.sourceCaches[Ha.source]),(!ya||ya.getSource().maxzoom<Ta.getSource().maxzoom)&&(ya=Ta))}),ya&&ao.debug(this,ya,ya.getVisibleCoordinates())}this.options.showPadding&&bn(this),this.context.setDefault()},ri.prototype.renderLayer=function(V,ve,j,de){j.isHidden(this.transform.zoom)||j.type!=="background"&&j.type!=="custom"&&!de.length||(this.id=j.id,this.gpuTimingStart(j),ao[j.type](V,ve,j,de,this.style.placement.variableOffsets),this.gpuTimingEnd())},ri.prototype.gpuTimingStart=function(V){if(!!this.options.gpuTiming){var ve=this.context.extTimerQuery,j=this.gpuTimers[V.id];j||(j=this.gpuTimers[V.id]={calls:0,cpuTime:0,query:ve.createQueryEXT()}),j.calls++,ve.beginQueryEXT(ve.TIME_ELAPSED_EXT,j.query)}},ri.prototype.gpuTimingEnd=function(){if(!!this.options.gpuTiming){var V=this.context.extTimerQuery;V.endQueryEXT(V.TIME_ELAPSED_EXT)}},ri.prototype.collectGpuTimers=function(){var V=this.gpuTimers;return this.gpuTimers={},V},ri.prototype.queryGpuTimers=function(V){var ve={};for(var j in V){var de=V[j],Me=this.context.extTimerQuery,Ce=Me.getQueryObjectEXT(de.query,Me.QUERY_RESULT_EXT)/(1e3*1e3);Me.deleteQueryEXT(de.query),ve[j]=Ce}return ve},ri.prototype.translatePosMatrix=function(V,ve,j,de,Me){if(!j[0]&&!j[1])return V;var Ce=Me?de==="map"?this.transform.angle:0:de==="viewport"?-this.transform.angle:0;if(Ce){var Ze=Math.sin(Ce),ut=Math.cos(Ce);j=[j[0]*ut-j[1]*Ze,j[0]*Ze+j[1]*ut]}var St=[Me?j[0]:An(ve,j[0],this.transform.zoom),Me?j[1]:An(ve,j[1],this.transform.zoom),0],jt=new Float32Array(16);return e.translate(jt,V,St),jt},ri.prototype.saveTileTexture=function(V){var ve=this._tileTextures[V.size[0]];ve?ve.push(V):this._tileTextures[V.size[0]]=[V]},ri.prototype.getTileTexture=function(V){var ve=this._tileTextures[V];return ve&&ve.length>0?ve.pop():null},ri.prototype.isPatternMissing=function(V){if(!V)return!1;if(!V.from||!V.to)return!0;var ve=this.imageManager.getPattern(V.from.toString()),j=this.imageManager.getPattern(V.to.toString());return!ve||!j},ri.prototype.useProgram=function(V,ve){this.cache=this.cache||{};var j=""+V+(ve?ve.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[j]||(this.cache[j]=new Qo(this.context,ul[V],ve,Jl[V],this._showOverdrawInspector)),this.cache[j]},ri.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},ri.prototype.setBaseState=function(){var V=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(V.FUNC_ADD)},ri.prototype.initDebugOverlayCanvas=function(){if(this.debugOverlayCanvas==null){this.debugOverlayCanvas=e.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512;var V=this.context.gl;this.debugOverlayTexture=new e.Texture(this.context,this.debugOverlayCanvas,V.RGBA)}},ri.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var Vi=function(V,ve){this.points=V,this.planes=ve};Vi.fromInvProjectionMatrix=function(V,ve,j){var de=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]],Me=Math.pow(2,j),Ce=de.map(function(St){return e.transformMat4([],St,V)}).map(function(St){return e.scale$1([],St,1/St[3]/ve*Me)}),Ze=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]],ut=Ze.map(function(St){var jt=e.sub([],Ce[St[0]],Ce[St[1]]),lr=e.sub([],Ce[St[2]],Ce[St[1]]),vr=e.normalize([],e.cross([],jt,lr)),Er=-e.dot(vr,Ce[St[1]]);return vr.concat(Er)});return new Vi(Ce,ut)};var uo=function(V,ve){this.min=V,this.max=ve,this.center=e.scale$2([],e.add([],this.min,this.max),.5)};uo.prototype.quadrant=function(V){for(var ve=[V%2===0,V<2],j=e.clone$2(this.min),de=e.clone$2(this.max),Me=0;Me<ve.length;Me++)j[Me]=ve[Me]?this.min[Me]:this.center[Me],de[Me]=ve[Me]?this.center[Me]:this.max[Me];return de[2]=this.max[2],new uo(j,de)},uo.prototype.distanceX=function(V){var ve=Math.max(Math.min(this.max[0],V[0]),this.min[0]);return ve-V[0]},uo.prototype.distanceY=function(V){var ve=Math.max(Math.min(this.max[1],V[1]),this.min[1]);return ve-V[1]},uo.prototype.intersects=function(V){for(var ve=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],j=!0,de=0;de<V.planes.length;de++){for(var Me=V.planes[de],Ce=0,Ze=0;Ze<ve.length;Ze++)Ce+=e.dot$1(Me,ve[Ze])>=0;if(Ce===0)return 0;Ce!==ve.length&&(j=!1)}if(j)return 2;for(var ut=0;ut<3;ut++){for(var St=Number.MAX_VALUE,jt=-Number.MAX_VALUE,lr=0;lr<V.points.length;lr++){var vr=V.points[lr][ut]-this.min[ut];St=Math.min(St,vr),jt=Math.max(jt,vr)}if(jt<0||St>this.max[ut]-this.min[ut])return 0}return 1};var bo=function(V,ve,j,de){if(V===void 0&&(V=0),ve===void 0&&(ve=0),j===void 0&&(j=0),de===void 0&&(de=0),isNaN(V)||V<0||isNaN(ve)||ve<0||isNaN(j)||j<0||isNaN(de)||de<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=V,this.bottom=ve,this.left=j,this.right=de};bo.prototype.interpolate=function(V,ve,j){return ve.top!=null&&V.top!=null&&(this.top=e.number(V.top,ve.top,j)),ve.bottom!=null&&V.bottom!=null&&(this.bottom=e.number(V.bottom,ve.bottom,j)),ve.left!=null&&V.left!=null&&(this.left=e.number(V.left,ve.left,j)),ve.right!=null&&V.right!=null&&(this.right=e.number(V.right,ve.right,j)),this},bo.prototype.getCenter=function(V,ve){var j=e.clamp((this.left+V-this.right)/2,0,V),de=e.clamp((this.top+ve-this.bottom)/2,0,ve);return new e.Point(j,de)},bo.prototype.equals=function(V){return this.top===V.top&&this.bottom===V.bottom&&this.left===V.left&&this.right===V.right},bo.prototype.clone=function(){return new bo(this.top,this.bottom,this.left,this.right)},bo.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var bi=function(V,ve,j,de,Me){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=Me===void 0?!0:Me,this._minZoom=V||0,this._maxZoom=ve||22,this._minPitch=j==null?0:j,this._maxPitch=de==null?60:de,this.setMaxBounds(),this.width=0,this.height=0,this._center=new e.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new bo,this._posMatrixCache={},this._alignedPosMatrixCache={}},Mi={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};bi.prototype.clone=function(){var V=new bi(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return V.tileSize=this.tileSize,V.latRange=this.latRange,V.width=this.width,V.height=this.height,V._center=this._center,V.zoom=this.zoom,V.angle=this.angle,V._fov=this._fov,V._pitch=this._pitch,V._unmodified=this._unmodified,V._edgeInsets=this._edgeInsets.clone(),V._calcMatrices(),V},Mi.minZoom.get=function(){return this._minZoom},Mi.minZoom.set=function(ce){this._minZoom!==ce&&(this._minZoom=ce,this.zoom=Math.max(this.zoom,ce))},Mi.maxZoom.get=function(){return this._maxZoom},Mi.maxZoom.set=function(ce){this._maxZoom!==ce&&(this._maxZoom=ce,this.zoom=Math.min(this.zoom,ce))},Mi.minPitch.get=function(){return this._minPitch},Mi.minPitch.set=function(ce){this._minPitch!==ce&&(this._minPitch=ce,this.pitch=Math.max(this.pitch,ce))},Mi.maxPitch.get=function(){return this._maxPitch},Mi.maxPitch.set=function(ce){this._maxPitch!==ce&&(this._maxPitch=ce,this.pitch=Math.min(this.pitch,ce))},Mi.renderWorldCopies.get=function(){return this._renderWorldCopies},Mi.renderWorldCopies.set=function(ce){ce===void 0?ce=!0:ce===null&&(ce=!1),this._renderWorldCopies=ce},Mi.worldSize.get=function(){return this.tileSize*this.scale},Mi.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},Mi.size.get=function(){return new e.Point(this.width,this.height)},Mi.bearing.get=function(){return-this.angle/Math.PI*180},Mi.bearing.set=function(ce){var V=-e.wrap(ce,-180,180)*Math.PI/180;this.angle!==V&&(this._unmodified=!1,this.angle=V,this._calcMatrices(),this.rotationMatrix=e.create$2(),e.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},Mi.pitch.get=function(){return this._pitch/Math.PI*180},Mi.pitch.set=function(ce){var V=e.clamp(ce,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==V&&(this._unmodified=!1,this._pitch=V,this._calcMatrices())},Mi.fov.get=function(){return this._fov/Math.PI*180},Mi.fov.set=function(ce){ce=Math.max(.01,Math.min(60,ce)),this._fov!==ce&&(this._unmodified=!1,this._fov=ce/180*Math.PI,this._calcMatrices())},Mi.zoom.get=function(){return this._zoom},Mi.zoom.set=function(ce){var V=Math.min(Math.max(ce,this.minZoom),this.maxZoom);this._zoom!==V&&(this._unmodified=!1,this._zoom=V,this.scale=this.zoomScale(V),this.tileZoom=Math.floor(V),this.zoomFraction=V-this.tileZoom,this._constrain(),this._calcMatrices())},Mi.center.get=function(){return this._center},Mi.center.set=function(ce){ce.lat===this._center.lat&&ce.lng===this._center.lng||(this._unmodified=!1,this._center=ce,this._constrain(),this._calcMatrices())},Mi.padding.get=function(){return this._edgeInsets.toJSON()},Mi.padding.set=function(ce){this._edgeInsets.equals(ce)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,ce,1),this._calcMatrices())},Mi.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},bi.prototype.isPaddingEqual=function(V){return this._edgeInsets.equals(V)},bi.prototype.interpolatePadding=function(V,ve,j){this._unmodified=!1,this._edgeInsets.interpolate(V,ve,j),this._constrain(),this._calcMatrices()},bi.prototype.coveringZoomLevel=function(V){var ve=(V.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/V.tileSize));return Math.max(0,ve)},bi.prototype.getVisibleUnwrappedCoordinates=function(V){var ve=[new e.UnwrappedTileID(0,V)];if(this._renderWorldCopies)for(var j=this.pointCoordinate(new e.Point(0,0)),de=this.pointCoordinate(new e.Point(this.width,0)),Me=this.pointCoordinate(new e.Point(this.width,this.height)),Ce=this.pointCoordinate(new e.Point(0,this.height)),Ze=Math.floor(Math.min(j.x,de.x,Me.x,Ce.x)),ut=Math.floor(Math.max(j.x,de.x,Me.x,Ce.x)),St=1,jt=Ze-St;jt<=ut+St;jt++)jt!==0&&ve.push(new e.UnwrappedTileID(jt,V));return ve},bi.prototype.coveringTiles=function(V){var ve=this.coveringZoomLevel(V),j=ve;if(V.minzoom!==void 0&&ve<V.minzoom)return[];V.maxzoom!==void 0&&ve>V.maxzoom&&(ve=V.maxzoom);var de=e.MercatorCoordinate.fromLngLat(this.center),Me=Math.pow(2,ve),Ce=[Me*de.x,Me*de.y,0],Ze=Vi.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,ve),ut=V.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(ut=ve);var St=3,jt=function(Ea){return{aabb:new uo([Ea*Me,0,0],[(Ea+1)*Me,Me,0]),zoom:0,x:0,y:0,wrap:Ea,fullyVisible:!1}},lr=[],vr=[],Er=ve,Vr=V.reparseOverscaled?j:ve;if(this._renderWorldCopies)for(var Gr=1;Gr<=3;Gr++)lr.push(jt(-Gr)),lr.push(jt(Gr));for(lr.push(jt(0));lr.length>0;){var Ur=lr.pop(),Kr=Ur.x,cn=Ur.y,En=Ur.fullyVisible;if(!En){var Fn=Ur.aabb.intersects(Ze);if(Fn===0)continue;En=Fn===2}var Kn=Ur.aabb.distanceX(Ce),qn=Ur.aabb.distanceY(Ce),Qn=Math.max(Math.abs(Kn),Math.abs(qn)),ca=St+(1<<Er-Ur.zoom)-2;if(Ur.zoom===Er||Qn>ca&&Ur.zoom>=ut){vr.push({tileID:new e.OverscaledTileID(Ur.zoom===Er?Vr:Ur.zoom,Ur.wrap,Ur.zoom,Kr,cn),distanceSq:e.sqrLen([Ce[0]-.5-Kr,Ce[1]-.5-cn])});continue}for(var ba=0;ba<4;ba++){var ya=(Kr<<1)+ba%2,Ta=(cn<<1)+(ba>>1);lr.push({aabb:Ur.aabb.quadrant(ba),zoom:Ur.zoom+1,x:ya,y:Ta,wrap:Ur.wrap,fullyVisible:En})}}return vr.sort(function(Ea,Ha){return Ea.distanceSq-Ha.distanceSq}).map(function(Ea){return Ea.tileID})},bi.prototype.resize=function(V,ve){this.width=V,this.height=ve,this.pixelsToGLUnits=[2/V,-2/ve],this._constrain(),this._calcMatrices()},Mi.unmodified.get=function(){return this._unmodified},bi.prototype.zoomScale=function(V){return Math.pow(2,V)},bi.prototype.scaleZoom=function(V){return Math.log(V)/Math.LN2},bi.prototype.project=function(V){var ve=e.clamp(V.lat,-this.maxValidLatitude,this.maxValidLatitude);return new e.Point(e.mercatorXfromLng(V.lng)*this.worldSize,e.mercatorYfromLat(ve)*this.worldSize)},bi.prototype.unproject=function(V){return new e.MercatorCoordinate(V.x/this.worldSize,V.y/this.worldSize).toLngLat()},Mi.point.get=function(){return this.project(this.center)},bi.prototype.setLocationAtPoint=function(V,ve){var j=this.pointCoordinate(ve),de=this.pointCoordinate(this.centerPoint),Me=this.locationCoordinate(V),Ce=new e.MercatorCoordinate(Me.x-(j.x-de.x),Me.y-(j.y-de.y));this.center=this.coordinateLocation(Ce),this._renderWorldCopies&&(this.center=this.center.wrap())},bi.prototype.locationPoint=function(V){return this.coordinatePoint(this.locationCoordinate(V))},bi.prototype.pointLocation=function(V){return this.coordinateLocation(this.pointCoordinate(V))},bi.prototype.locationCoordinate=function(V){return e.MercatorCoordinate.fromLngLat(V)},bi.prototype.coordinateLocation=function(V){return V.toLngLat()},bi.prototype.pointCoordinate=function(V){var ve=0,j=[V.x,V.y,0,1],de=[V.x,V.y,1,1];e.transformMat4(j,j,this.pixelMatrixInverse),e.transformMat4(de,de,this.pixelMatrixInverse);var Me=j[3],Ce=de[3],Ze=j[0]/Me,ut=de[0]/Ce,St=j[1]/Me,jt=de[1]/Ce,lr=j[2]/Me,vr=de[2]/Ce,Er=lr===vr?0:(ve-lr)/(vr-lr);return new e.MercatorCoordinate(e.number(Ze,ut,Er)/this.worldSize,e.number(St,jt,Er)/this.worldSize)},bi.prototype.coordinatePoint=function(V){var ve=[V.x*this.worldSize,V.y*this.worldSize,0,1];return e.transformMat4(ve,ve,this.pixelMatrix),new e.Point(ve[0]/ve[3],ve[1]/ve[3])},bi.prototype.getBounds=function(){return new e.LngLatBounds().extend(this.pointLocation(new e.Point(0,0))).extend(this.pointLocation(new e.Point(this.width,0))).extend(this.pointLocation(new e.Point(this.width,this.height))).extend(this.pointLocation(new e.Point(0,this.height)))},bi.prototype.getMaxBounds=function(){return!this.latRange||this.latRange.length!==2||!this.lngRange||this.lngRange.length!==2?null:new e.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]])},bi.prototype.setMaxBounds=function(V){V?(this.lngRange=[V.getWest(),V.getEast()],this.latRange=[V.getSouth(),V.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},bi.prototype.calculatePosMatrix=function(V,ve){ve===void 0&&(ve=!1);var j=V.key,de=ve?this._alignedPosMatrixCache:this._posMatrixCache;if(de[j])return de[j];var Me=V.canonical,Ce=this.worldSize/this.zoomScale(Me.z),Ze=Me.x+Math.pow(2,Me.z)*V.wrap,ut=e.identity(new Float64Array(16));return e.translate(ut,ut,[Ze*Ce,Me.y*Ce,0]),e.scale(ut,ut,[Ce/e.EXTENT,Ce/e.EXTENT,1]),e.multiply(ut,ve?this.alignedProjMatrix:this.projMatrix,ut),de[j]=new Float32Array(ut),de[j]},bi.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},bi.prototype._constrain=function(){if(!(!this.center||!this.width||!this.height||this._constraining)){this._constraining=!0;var V=-90,ve=90,j=-180,de=180,Me,Ce,Ze,ut,St=this.size,jt=this._unmodified;if(this.latRange){var lr=this.latRange;V=e.mercatorYfromLat(lr[1])*this.worldSize,ve=e.mercatorYfromLat(lr[0])*this.worldSize,Me=ve-V<St.y?St.y/(ve-V):0}if(this.lngRange){var vr=this.lngRange;j=e.mercatorXfromLng(vr[0])*this.worldSize,de=e.mercatorXfromLng(vr[1])*this.worldSize,Ce=de-j<St.x?St.x/(de-j):0}var Er=this.point,Vr=Math.max(Ce||0,Me||0);if(Vr){this.center=this.unproject(new e.Point(Ce?(de+j)/2:Er.x,Me?(ve+V)/2:Er.y)),this.zoom+=this.scaleZoom(Vr),this._unmodified=jt,this._constraining=!1;return}if(this.latRange){var Gr=Er.y,Ur=St.y/2;Gr-Ur<V&&(ut=V+Ur),Gr+Ur>ve&&(ut=ve-Ur)}if(this.lngRange){var Kr=Er.x,cn=St.x/2;Kr-cn<j&&(Ze=j+cn),Kr+cn>de&&(Ze=de-cn)}(Ze!==void 0||ut!==void 0)&&(this.center=this.unproject(new e.Point(Ze!==void 0?Ze:Er.x,ut!==void 0?ut:Er.y))),this._unmodified=jt,this._constraining=!1}},bi.prototype._calcMatrices=function(){if(!!this.height){var V=this._fov/2,ve=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(V)*this.height;var j=Math.PI/2+this._pitch,de=this._fov*(.5+ve.y/this.height),Me=Math.sin(de)*this.cameraToCenterDistance/Math.sin(e.clamp(Math.PI-j-de,.01,Math.PI-.01)),Ce=this.point,Ze=Ce.x,ut=Ce.y,St=Math.cos(Math.PI/2-this._pitch)*Me+this.cameraToCenterDistance,jt=St*1.01,lr=this.height/50,vr=new Float64Array(16);e.perspective(vr,this._fov,this.width/this.height,lr,jt),vr[8]=-ve.x*2/this.width,vr[9]=ve.y*2/this.height,e.scale(vr,vr,[1,-1,1]),e.translate(vr,vr,[0,0,-this.cameraToCenterDistance]),e.rotateX(vr,vr,this._pitch),e.rotateZ(vr,vr,this.angle),e.translate(vr,vr,[-Ze,-ut,0]),this.mercatorMatrix=e.scale([],vr,[this.worldSize,this.worldSize,this.worldSize]),e.scale(vr,vr,[1,1,e.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=vr,this.invProjMatrix=e.invert([],this.projMatrix);var Er=this.width%2/2,Vr=this.height%2/2,Gr=Math.cos(this.angle),Ur=Math.sin(this.angle),Kr=Ze-Math.round(Ze)+Gr*Er+Ur*Vr,cn=ut-Math.round(ut)+Gr*Vr+Ur*Er,En=new Float64Array(vr);if(e.translate(En,En,[Kr>.5?Kr-1:Kr,cn>.5?cn-1:cn,0]),this.alignedProjMatrix=En,vr=e.create(),e.scale(vr,vr,[this.width/2,-this.height/2,1]),e.translate(vr,vr,[1,-1,0]),this.labelPlaneMatrix=vr,vr=e.create(),e.scale(vr,vr,[1,-1,1]),e.translate(vr,vr,[-1,-1,0]),e.scale(vr,vr,[2/this.width,2/this.height,1]),this.glCoordMatrix=vr,this.pixelMatrix=e.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),vr=e.invert(new Float64Array(16),this.pixelMatrix),!vr)throw new Error("failed to invert matrix");this.pixelMatrixInverse=vr,this._posMatrixCache={},this._alignedPosMatrixCache={}}},bi.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var V=this.pointCoordinate(new e.Point(0,0)),ve=[V.x*this.worldSize,V.y*this.worldSize,0,1],j=e.transformMat4(ve,ve,this.pixelMatrix);return j[3]/this.cameraToCenterDistance},bi.prototype.getCameraPoint=function(){var V=this._pitch,ve=Math.tan(V)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new e.Point(0,ve))},bi.prototype.getCameraQueryGeometry=function(V){var ve=this.getCameraPoint();if(V.length===1)return[V[0],ve];for(var j=ve.x,de=ve.y,Me=ve.x,Ce=ve.y,Ze=0,ut=V;Ze<ut.length;Ze+=1){var St=ut[Ze];j=Math.min(j,St.x),de=Math.min(de,St.y),Me=Math.max(Me,St.x),Ce=Math.max(Ce,St.y)}return[new e.Point(j,de),new e.Point(Me,de),new e.Point(Me,Ce),new e.Point(j,Ce),new e.Point(j,de)]},Object.defineProperties(bi.prototype,Mi);function fs(ce,V){var ve=!1,j=null,de=function(){j=null,ve&&(ce(),j=setTimeout(de,V),ve=!1)};return function(){return ve=!0,j||de(),j}}var po=function(V){this._hashName=V&&encodeURIComponent(V),e.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=fs(this._updateHashUnthrottled.bind(this),30*1e3/100)};po.prototype.addTo=function(V){return this._map=V,e.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},po.prototype.remove=function(){return e.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},po.prototype.getHashString=function(V){var ve=this._map.getCenter(),j=Math.round(this._map.getZoom()*100)/100,de=Math.ceil((j*Math.LN2+Math.log(512/360/.5))/Math.LN10),Me=Math.pow(10,de),Ce=Math.round(ve.lng*Me)/Me,Ze=Math.round(ve.lat*Me)/Me,ut=this._map.getBearing(),St=this._map.getPitch(),jt="";if(V?jt+="/"+Ce+"/"+Ze+"/"+j:jt+=j+"/"+Ze+"/"+Ce,(ut||St)&&(jt+="/"+Math.round(ut*10)/10),St&&(jt+="/"+Math.round(St)),this._hashName){var lr=this._hashName,vr=!1,Er=e.window.location.hash.slice(1).split("&").map(function(Vr){var Gr=Vr.split("=")[0];return Gr===lr?(vr=!0,Gr+"="+jt):Vr}).filter(function(Vr){return Vr});return vr||Er.push(lr+"="+jt),"#"+Er.join("&")}return"#"+jt},po.prototype._getCurrentHash=function(){var V=this,ve=e.window.location.hash.replace("#","");if(this._hashName){var j;return ve.split("&").map(function(de){return de.split("=")}).forEach(function(de){de[0]===V._hashName&&(j=de)}),(j&&j[1]||"").split("/")}return ve.split("/")},po.prototype._onHashChange=function(){var V=this._getCurrentHash();if(V.length>=3&&!V.some(function(j){return isNaN(j)})){var ve=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(V[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+V[2],+V[1]],zoom:+V[0],bearing:ve,pitch:+(V[4]||0)}),!0}return!1},po.prototype._updateHashUnthrottled=function(){var V=this.getHashString();try{e.window.history.replaceState(e.window.history.state,"",V)}catch{}};var Lo={linearity:.3,easing:e.bezier(0,0,.3,1)},Vo=e.extend({deceleration:2500,maxSpeed:1400},Lo),fe=e.extend({deceleration:20,maxSpeed:1400},Lo),xe=e.extend({deceleration:1e3,maxSpeed:360},Lo),Ee=e.extend({deceleration:1e3,maxSpeed:90},Lo),Fe=function(V){this._map=V,this.clear()};Fe.prototype.clear=function(){this._inertiaBuffer=[]},Fe.prototype.record=function(V){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:e.browser.now(),settings:V})},Fe.prototype._drainInertiaBuffer=function(){for(var V=this._inertiaBuffer,ve=e.browser.now(),j=160;V.length>0&&ve-V[0].time>j;)V.shift()},Fe.prototype._onMoveEnd=function(V){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var ve={zoom:0,bearing:0,pitch:0,pan:new e.Point(0,0),pinchAround:void 0,around:void 0},j=0,de=this._inertiaBuffer;j<de.length;j+=1){var Me=de[j],Ce=Me.settings;ve.zoom+=Ce.zoomDelta||0,ve.bearing+=Ce.bearingDelta||0,ve.pitch+=Ce.pitchDelta||0,Ce.panDelta&&ve.pan._add(Ce.panDelta),Ce.around&&(ve.around=Ce.around),Ce.pinchAround&&(ve.pinchAround=Ce.pinchAround)}var Ze=this._inertiaBuffer[this._inertiaBuffer.length-1],ut=Ze.time-this._inertiaBuffer[0].time,St={};if(ve.pan.mag()){var jt=je(ve.pan.mag(),ut,e.extend({},Vo,V||{}));St.offset=ve.pan.mult(jt.amount/ve.pan.mag()),St.center=this._map.transform.center,Ie(St,jt)}if(ve.zoom){var lr=je(ve.zoom,ut,fe);St.zoom=this._map.transform.zoom+lr.amount,Ie(St,lr)}if(ve.bearing){var vr=je(ve.bearing,ut,xe);St.bearing=this._map.transform.bearing+e.clamp(vr.amount,-179,179),Ie(St,vr)}if(ve.pitch){var Er=je(ve.pitch,ut,Ee);St.pitch=this._map.transform.pitch+Er.amount,Ie(St,Er)}if(St.zoom||St.bearing){var Vr=ve.pinchAround===void 0?ve.around:ve.pinchAround;St.around=Vr?this._map.unproject(Vr):this._map.getCenter()}return this.clear(),e.extend(St,{noMoveStart:!0})}};function Ie(ce,V){(!ce.duration||ce.duration<V.duration)&&(ce.duration=V.duration,ce.easing=V.easing)}function je(ce,V,ve){var j=ve.maxSpeed,de=ve.linearity,Me=ve.deceleration,Ce=e.clamp(ce*de/(V/1e3),-j,j),Ze=Math.abs(Ce)/(Me*de);return{easing:ve.easing,duration:Ze*1e3,amount:Ce*(Ze/2)}}var xt=function(ce){function V(j,de,Me,Ce){Ce===void 0&&(Ce={});var Ze=n.mousePos(de.getCanvasContainer(),Me),ut=de.unproject(Ze);ce.call(this,j,e.extend({point:Ze,lngLat:ut,originalEvent:Me},Ce)),this._defaultPrevented=!1,this.target=de}ce&&(V.__proto__=ce),V.prototype=Object.create(ce&&ce.prototype),V.prototype.constructor=V;var ve={defaultPrevented:{configurable:!0}};return V.prototype.preventDefault=function(){this._defaultPrevented=!0},ve.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(V.prototype,ve),V}(e.Event),ht=function(ce){function V(j,de,Me){var Ce=j==="touchend"?Me.changedTouches:Me.touches,Ze=n.touchPos(de.getCanvasContainer(),Ce),ut=Ze.map(function(lr){return de.unproject(lr)}),St=Ze.reduce(function(lr,vr,Er,Vr){return lr.add(vr.div(Vr.length))},new e.Point(0,0)),jt=de.unproject(St);ce.call(this,j,{points:Ze,point:St,lngLats:ut,lngLat:jt,originalEvent:Me}),this._defaultPrevented=!1}ce&&(V.__proto__=ce),V.prototype=Object.create(ce&&ce.prototype),V.prototype.constructor=V;var ve={defaultPrevented:{configurable:!0}};return V.prototype.preventDefault=function(){this._defaultPrevented=!0},ve.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(V.prototype,ve),V}(e.Event),Ct=function(ce){function V(j,de,Me){ce.call(this,j,{originalEvent:Me}),this._defaultPrevented=!1}ce&&(V.__proto__=ce),V.prototype=Object.create(ce&&ce.prototype),V.prototype.constructor=V;var ve={defaultPrevented:{configurable:!0}};return V.prototype.preventDefault=function(){this._defaultPrevented=!0},ve.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(V.prototype,ve),V}(e.Event),Xt=function(V,ve){this._map=V,this._clickTolerance=ve.clickTolerance};Xt.prototype.reset=function(){delete this._mousedownPos},Xt.prototype.wheel=function(V){return this._firePreventable(new Ct(V.type,this._map,V))},Xt.prototype.mousedown=function(V,ve){return this._mousedownPos=ve,this._firePreventable(new xt(V.type,this._map,V))},Xt.prototype.mouseup=function(V){this._map.fire(new xt(V.type,this._map,V))},Xt.prototype.click=function(V,ve){this._mousedownPos&&this._mousedownPos.dist(ve)>=this._clickTolerance||this._map.fire(new xt(V.type,this._map,V))},Xt.prototype.dblclick=function(V){return this._firePreventable(new xt(V.type,this._map,V))},Xt.prototype.mouseover=function(V){this._map.fire(new xt(V.type,this._map,V))},Xt.prototype.mouseout=function(V){this._map.fire(new xt(V.type,this._map,V))},Xt.prototype.touchstart=function(V){return this._firePreventable(new ht(V.type,this._map,V))},Xt.prototype.touchmove=function(V){this._map.fire(new ht(V.type,this._map,V))},Xt.prototype.touchend=function(V){this._map.fire(new ht(V.type,this._map,V))},Xt.prototype.touchcancel=function(V){this._map.fire(new ht(V.type,this._map,V))},Xt.prototype._firePreventable=function(V){if(this._map.fire(V),V.defaultPrevented)return{}},Xt.prototype.isEnabled=function(){return!0},Xt.prototype.isActive=function(){return!1},Xt.prototype.enable=function(){},Xt.prototype.disable=function(){};var $t=function(V){this._map=V};$t.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},$t.prototype.mousemove=function(V){this._map.fire(new xt(V.type,this._map,V))},$t.prototype.mousedown=function(){this._delayContextMenu=!0},$t.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new xt("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},$t.prototype.contextmenu=function(V){this._delayContextMenu?this._contextMenuEvent=V:this._map.fire(new xt(V.type,this._map,V)),this._map.listens("contextmenu")&&V.preventDefault()},$t.prototype.isEnabled=function(){return!0},$t.prototype.isActive=function(){return!1},$t.prototype.enable=function(){},$t.prototype.disable=function(){};var er=function(V,ve){this._map=V,this._el=V.getCanvasContainer(),this._container=V.getContainer(),this._clickTolerance=ve.clickTolerance||1};er.prototype.isEnabled=function(){return!!this._enabled},er.prototype.isActive=function(){return!!this._active},er.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},er.prototype.disable=function(){!this.isEnabled()||(this._enabled=!1)},er.prototype.mousedown=function(V,ve){!this.isEnabled()||!(V.shiftKey&&V.button===0)||(n.disableDrag(),this._startPos=this._lastPos=ve,this._active=!0)},er.prototype.mousemoveWindow=function(V,ve){if(!!this._active){var j=ve;if(!(this._lastPos.equals(j)||!this._box&&j.dist(this._startPos)<this._clickTolerance)){var de=this._startPos;this._lastPos=j,this._box||(this._box=n.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",V));var Me=Math.min(de.x,j.x),Ce=Math.max(de.x,j.x),Ze=Math.min(de.y,j.y),ut=Math.max(de.y,j.y);n.setTransform(this._box,"translate("+Me+"px,"+Ze+"px)"),this._box.style.width=Ce-Me+"px",this._box.style.height=ut-Ze+"px"}}},er.prototype.mouseupWindow=function(V,ve){var j=this;if(!!this._active&&V.button===0){var de=this._startPos,Me=ve;if(this.reset(),n.suppressClick(),de.x===Me.x&&de.y===Me.y)this._fireEvent("boxzoomcancel",V);else return this._map.fire(new e.Event("boxzoomend",{originalEvent:V})),{cameraAnimation:function(Ce){return Ce.fitScreenCoordinates(de,Me,j._map.getBearing(),{linear:!0})}}}},er.prototype.keydown=function(V){!this._active||V.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",V))},er.prototype.reset=function(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(n.remove(this._box),this._box=null),n.enableDrag(),delete this._startPos,delete this._lastPos},er.prototype._fireEvent=function(V,ve){return this._map.fire(new e.Event(V,{originalEvent:ve}))};function Ar(ce,V){for(var ve={},j=0;j<ce.length;j++)ve[ce[j].identifier]=V[j];return ve}function Jr(ce){for(var V=new e.Point(0,0),ve=0,j=ce;ve<j.length;ve+=1){var de=j[ve];V._add(de)}return V.div(ce.length)}var sn=500,Lr=500,Br=30,Zr=function(V){this.reset(),this.numTouches=V.numTouches};Zr.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},Zr.prototype.touchstart=function(V,ve,j){(this.centroid||j.length>this.numTouches)&&(this.aborted=!0),!this.aborted&&(this.startTime===void 0&&(this.startTime=V.timeStamp),j.length===this.numTouches&&(this.centroid=Jr(ve),this.touches=Ar(j,ve)))},Zr.prototype.touchmove=function(V,ve,j){if(!(this.aborted||!this.centroid)){var de=Ar(j,ve);for(var Me in this.touches){var Ce=this.touches[Me],Ze=de[Me];(!Ze||Ze.dist(Ce)>Br)&&(this.aborted=!0)}}},Zr.prototype.touchend=function(V,ve,j){if((!this.centroid||V.timeStamp-this.startTime>Lr)&&(this.aborted=!0),j.length===0){var de=!this.aborted&&this.centroid;if(this.reset(),de)return de}};var nn=function(V){this.singleTap=new Zr(V),this.numTaps=V.numTaps,this.reset()};nn.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},nn.prototype.touchstart=function(V,ve,j){this.singleTap.touchstart(V,ve,j)},nn.prototype.touchmove=function(V,ve,j){this.singleTap.touchmove(V,ve,j)},nn.prototype.touchend=function(V,ve,j){var de=this.singleTap.touchend(V,ve,j);if(de){var Me=V.timeStamp-this.lastTime<sn,Ce=!this.lastTap||this.lastTap.dist(de)<Br;if((!Me||!Ce)&&this.reset(),this.count++,this.lastTime=V.timeStamp,this.lastTap=de,this.count===this.numTaps)return this.reset(),de}};var on=function(){this._zoomIn=new nn({numTouches:1,numTaps:2}),this._zoomOut=new nn({numTouches:2,numTaps:1}),this.reset()};on.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},on.prototype.touchstart=function(V,ve,j){this._zoomIn.touchstart(V,ve,j),this._zoomOut.touchstart(V,ve,j)},on.prototype.touchmove=function(V,ve,j){this._zoomIn.touchmove(V,ve,j),this._zoomOut.touchmove(V,ve,j)},on.prototype.touchend=function(V,ve,j){var de=this,Me=this._zoomIn.touchend(V,ve,j),Ce=this._zoomOut.touchend(V,ve,j);if(Me)return this._active=!0,V.preventDefault(),setTimeout(function(){return de.reset()},0),{cameraAnimation:function(Ze){return Ze.easeTo({duration:300,zoom:Ze.getZoom()+1,around:Ze.unproject(Me)},{originalEvent:V})}};if(Ce)return this._active=!0,V.preventDefault(),setTimeout(function(){return de.reset()},0),{cameraAnimation:function(Ze){return Ze.easeTo({duration:300,zoom:Ze.getZoom()-1,around:Ze.unproject(Ce)},{originalEvent:V})}}},on.prototype.touchcancel=function(){this.reset()},on.prototype.enable=function(){this._enabled=!0},on.prototype.disable=function(){this._enabled=!1,this.reset()},on.prototype.isEnabled=function(){return this._enabled},on.prototype.isActive=function(){return this._active};var jr=0,Un=2,ra=function(V){this.reset(),this._clickTolerance=V.clickTolerance||1};ra.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},ra.prototype._correctButton=function(V,ve){return!1},ra.prototype._move=function(V,ve){return{}},ra.prototype.mousedown=function(V,ve){if(!this._lastPoint){var j=n.mouseButton(V);!this._correctButton(V,j)||(this._lastPoint=ve,this._eventButton=j)}},ra.prototype.mousemoveWindow=function(V,ve){var j=this._lastPoint;if(!!j&&(V.preventDefault(),!(!this._moved&&ve.dist(j)<this._clickTolerance)))return this._moved=!0,this._lastPoint=ve,this._move(j,ve)},ra.prototype.mouseupWindow=function(V){var ve=n.mouseButton(V);ve===this._eventButton&&(this._moved&&n.suppressClick(),this.reset())},ra.prototype.enable=function(){this._enabled=!0},ra.prototype.disable=function(){this._enabled=!1,this.reset()},ra.prototype.isEnabled=function(){return this._enabled},ra.prototype.isActive=function(){return this._active};var _a=function(ce){function V(){ce.apply(this,arguments)}return ce&&(V.__proto__=ce),V.prototype=Object.create(ce&&ce.prototype),V.prototype.constructor=V,V.prototype.mousedown=function(j,de){ce.prototype.mousedown.call(this,j,de),this._lastPoint&&(this._active=!0)},V.prototype._correctButton=function(j,de){return de===jr&&!j.ctrlKey},V.prototype._move=function(j,de){return{around:de,panDelta:de.sub(j)}},V}(ra),ia=function(ce){function V(){ce.apply(this,arguments)}return ce&&(V.__proto__=ce),V.prototype=Object.create(ce&&ce.prototype),V.prototype.constructor=V,V.prototype._correctButton=function(j,de){return de===jr&&j.ctrlKey||de===Un},V.prototype._move=function(j,de){var Me=.8,Ce=(de.x-j.x)*Me;if(Ce)return this._active=!0,{bearingDelta:Ce}},V.prototype.contextmenu=function(j){j.preventDefault()},V}(ra),Sa=function(ce){function V(){ce.apply(this,arguments)}return ce&&(V.__proto__=ce),V.prototype=Object.create(ce&&ce.prototype),V.prototype.constructor=V,V.prototype._correctButton=function(j,de){return de===jr&&j.ctrlKey||de===Un},V.prototype._move=function(j,de){var Me=-.5,Ce=(de.y-j.y)*Me;if(Ce)return this._active=!0,{pitchDelta:Ce}},V.prototype.contextmenu=function(j){j.preventDefault()},V}(ra),la=function(V){this._minTouches=1,this._clickTolerance=V.clickTolerance||1,this.reset()};la.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new e.Point(0,0)},la.prototype.touchstart=function(V,ve,j){return this._calculateTransform(V,ve,j)},la.prototype.touchmove=function(V,ve,j){if(!!this._active)return V.preventDefault(),this._calculateTransform(V,ve,j)},la.prototype.touchend=function(V,ve,j){this._calculateTransform(V,ve,j),this._active&&j.length<this._minTouches&&this.reset()},la.prototype.touchcancel=function(){this.reset()},la.prototype._calculateTransform=function(V,ve,j){j.length>0&&(this._active=!0);var de=Ar(j,ve),Me=new e.Point(0,0),Ce=new e.Point(0,0),Ze=0;for(var ut in de){var St=de[ut],jt=this._touches[ut];jt&&(Me._add(St),Ce._add(St.sub(jt)),Ze++,de[ut]=St)}if(this._touches=de,!(Ze<this._minTouches||!Ce.mag())){var lr=Ce.div(Ze);if(this._sum._add(lr),!(this._sum.mag()<this._clickTolerance)){var vr=Me.div(Ze);return{around:vr,panDelta:lr}}}},la.prototype.enable=function(){this._enabled=!0},la.prototype.disable=function(){this._enabled=!1,this.reset()},la.prototype.isEnabled=function(){return this._enabled},la.prototype.isActive=function(){return this._active};var Na=function(){this.reset()};Na.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},Na.prototype._start=function(V){},Na.prototype._move=function(V,ve,j){return{}},Na.prototype.touchstart=function(V,ve,j){this._firstTwoTouches||j.length<2||(this._firstTwoTouches=[j[0].identifier,j[1].identifier],this._start([ve[0],ve[1]]))},Na.prototype.touchmove=function(V,ve,j){if(!!this._firstTwoTouches){V.preventDefault();var de=this._firstTwoTouches,Me=de[0],Ce=de[1],Ze=Pa(j,ve,Me),ut=Pa(j,ve,Ce);if(!(!Ze||!ut)){var St=this._aroundCenter?null:Ze.add(ut).div(2);return this._move([Ze,ut],St,V)}}},Na.prototype.touchend=function(V,ve,j){if(!!this._firstTwoTouches){var de=this._firstTwoTouches,Me=de[0],Ce=de[1],Ze=Pa(j,ve,Me),ut=Pa(j,ve,Ce);Ze&&ut||(this._active&&n.suppressClick(),this.reset())}},Na.prototype.touchcancel=function(){this.reset()},Na.prototype.enable=function(V){this._enabled=!0,this._aroundCenter=!!V&&V.around==="center"},Na.prototype.disable=function(){this._enabled=!1,this.reset()},Na.prototype.isEnabled=function(){return this._enabled},Na.prototype.isActive=function(){return this._active};function Pa(ce,V,ve){for(var j=0;j<ce.length;j++)if(ce[j].identifier===ve)return V[j]}var $a=.1;function yi(ce,V){return Math.log(ce/V)/Math.LN2}var fo=function(ce){function V(){ce.apply(this,arguments)}return ce&&(V.__proto__=ce),V.prototype=Object.create(ce&&ce.prototype),V.prototype.constructor=V,V.prototype.reset=function(){ce.prototype.reset.call(this),delete this._distance,delete this._startDistance},V.prototype._start=function(j){this._startDistance=this._distance=j[0].dist(j[1])},V.prototype._move=function(j,de){var Me=this._distance;if(this._distance=j[0].dist(j[1]),!(!this._active&&Math.abs(yi(this._distance,this._startDistance))<$a))return this._active=!0,{zoomDelta:yi(this._distance,Me),pinchAround:de}},V}(Na),Ii=25;function fa(ce,V){return ce.angleWith(V)*180/Math.PI}var ai=function(ce){function V(){ce.apply(this,arguments)}return ce&&(V.__proto__=ce),V.prototype=Object.create(ce&&ce.prototype),V.prototype.constructor=V,V.prototype.reset=function(){ce.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},V.prototype._start=function(j){this._startVector=this._vector=j[0].sub(j[1]),this._minDiameter=j[0].dist(j[1])},V.prototype._move=function(j,de){var Me=this._vector;if(this._vector=j[0].sub(j[1]),!(!this._active&&this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:fa(this._vector,Me),pinchAround:de}},V.prototype._isBelowThreshold=function(j){this._minDiameter=Math.min(this._minDiameter,j.mag());var de=Math.PI*this._minDiameter,Me=Ii/de*360,Ce=fa(j,this._startVector);return Math.abs(Ce)<Me},V}(Na);function Xa(ce){return Math.abs(ce.y)>Math.abs(ce.x)}var Si=100,si=function(ce){function V(){ce.apply(this,arguments)}return ce&&(V.__proto__=ce),V.prototype=Object.create(ce&&ce.prototype),V.prototype.constructor=V,V.prototype.reset=function(){ce.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},V.prototype._start=function(j){this._lastPoints=j,Xa(j[0].sub(j[1]))&&(this._valid=!1)},V.prototype._move=function(j,de,Me){var Ce=j[0].sub(this._lastPoints[0]),Ze=j[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(Ce,Ze,Me.timeStamp),!!this._valid){this._lastPoints=j,this._active=!0;var ut=(Ce.y+Ze.y)/2,St=-.5;return{pitchDelta:ut*St}}},V.prototype.gestureBeginsVertically=function(j,de,Me){if(this._valid!==void 0)return this._valid;var Ce=2,Ze=j.mag()>=Ce,ut=de.mag()>=Ce;if(!(!Ze&&!ut)){if(!Ze||!ut)return this._firstMove===void 0&&(this._firstMove=Me),Me-this._firstMove<Si?void 0:!1;var St=j.y>0==de.y>0;return Xa(j)&&Xa(de)&&St}},V}(Na),io={panStep:100,bearingStep:15,pitchStep:10},Qi=function(){var V=io;this._panStep=V.panStep,this._bearingStep=V.bearingStep,this._pitchStep=V.pitchStep};Qi.prototype.reset=function(){this._active=!1},Qi.prototype.keydown=function(V){var ve=this;if(!(V.altKey||V.ctrlKey||V.metaKey)){var j=0,de=0,Me=0,Ce=0,Ze=0;switch(V.keyCode){case 61:case 107:case 171:case 187:j=1;break;case 189:case 109:case 173:j=-1;break;case 37:V.shiftKey?de=-1:(V.preventDefault(),Ce=-1);break;case 39:V.shiftKey?de=1:(V.preventDefault(),Ce=1);break;case 38:V.shiftKey?Me=1:(V.preventDefault(),Ze=-1);break;case 40:V.shiftKey?Me=-1:(V.preventDefault(),Ze=1);break;default:return}return{cameraAnimation:function(ut){var St=ut.getZoom();ut.easeTo({duration:300,easeId:"keyboardHandler",easing:go,zoom:j?Math.round(St)+j*(V.shiftKey?2:1):St,bearing:ut.getBearing()+de*ve._bearingStep,pitch:ut.getPitch()+Me*ve._pitchStep,offset:[-Ce*ve._panStep,-Ze*ve._panStep],center:ut.getCenter()},{originalEvent:V})}}}},Qi.prototype.enable=function(){this._enabled=!0},Qi.prototype.disable=function(){this._enabled=!1,this.reset()},Qi.prototype.isEnabled=function(){return this._enabled},Qi.prototype.isActive=function(){return this._active};function go(ce){return ce*(2-ce)}var Go=4.000244140625,Fo=1/100,Yo=1/450,Gi=2,Bi=function(V,ve){this._map=V,this._el=V.getCanvasContainer(),this._handler=ve,this._delta=0,this._defaultZoomRate=Fo,this._wheelZoomRate=Yo,e.bindAll(["_onWheel","_onTimeout","_onScrollFrame","_onScrollFinished"],this)};Bi.prototype.setZoomRate=function(V){this._defaultZoomRate=V},Bi.prototype.setWheelZoomRate=function(V){this._wheelZoomRate=V},Bi.prototype.isEnabled=function(){return!!this._enabled},Bi.prototype.isActive=function(){return!!this._active||this._finishTimeout!==void 0},Bi.prototype.isZooming=function(){return!!this._zooming},Bi.prototype.enable=function(V){this.isEnabled()||(this._enabled=!0,this._aroundCenter=V&&V.around==="center")},Bi.prototype.disable=function(){!this.isEnabled()||(this._enabled=!1)},Bi.prototype.wheel=function(V){if(!!this.isEnabled()){var ve=V.deltaMode===e.window.WheelEvent.DOM_DELTA_LINE?V.deltaY*40:V.deltaY,j=e.browser.now(),de=j-(this._lastWheelEventTime||0);this._lastWheelEventTime=j,ve!==0&&ve%Go===0?this._type="wheel":ve!==0&&Math.abs(ve)<4?this._type="trackpad":de>400?(this._type=null,this._lastValue=ve,this._timeout=setTimeout(this._onTimeout,40,V)):this._type||(this._type=Math.abs(de*ve)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,ve+=this._lastValue)),V.shiftKey&&ve&&(ve=ve/4),this._type&&(this._lastWheelEvent=V,this._delta-=ve,this._active||this._start(V)),V.preventDefault()}},Bi.prototype._onTimeout=function(V){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(V)},Bi.prototype._start=function(V){if(!!this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var ve=n.mousePos(this._el,V);this._around=e.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(ve)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},Bi.prototype.renderFrame=function(){return this._onScrollFrame()},Bi.prototype._onScrollFrame=function(){var V=this;if(!!this._frameId&&(this._frameId=null,!!this.isActive())){var ve=this._map.transform;if(this._delta!==0){var j=this._type==="wheel"&&Math.abs(this._delta)>Go?this._wheelZoomRate:this._defaultZoomRate,de=Gi/(1+Math.exp(-Math.abs(this._delta*j)));this._delta<0&&de!==0&&(de=1/de);var Me=typeof this._targetZoom=="number"?ve.zoomScale(this._targetZoom):ve.scale;this._targetZoom=Math.min(ve.maxZoom,Math.max(ve.minZoom,ve.scaleZoom(Me*de))),this._type==="wheel"&&(this._startZoom=ve.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var Ce=typeof this._targetZoom=="number"?this._targetZoom:ve.zoom,Ze=this._startZoom,ut=this._easing,St=!1,jt;if(this._type==="wheel"&&Ze&&ut){var lr=Math.min((e.browser.now()-this._lastWheelEventTime)/200,1),vr=ut(lr);jt=e.number(Ze,Ce,vr),lr<1?this._frameId||(this._frameId=!0):St=!0}else jt=Ce,St=!0;return this._active=!0,St&&(this._active=!1,this._finishTimeout=setTimeout(function(){V._zooming=!1,V._handler._triggerRenderFrame(),delete V._targetZoom,delete V._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!St,zoomDelta:jt-ve.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},Bi.prototype._smoothOutEasing=function(V){var ve=e.ease;if(this._prevEase){var j=this._prevEase,de=(e.browser.now()-j.start)/j.duration,Me=j.easing(de+.01)-j.easing(de),Ce=.27/Math.sqrt(Me*Me+1e-4)*.01,Ze=Math.sqrt(.27*.27-Ce*Ce);ve=e.bezier(Ce,Ze,.25,1)}return this._prevEase={start:e.browser.now(),duration:V,easing:ve},ve},Bi.prototype.reset=function(){this._active=!1};var Ia=function(V,ve){this._clickZoom=V,this._tapZoom=ve};Ia.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},Ia.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},Ia.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},Ia.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var Za=function(){this.reset()};Za.prototype.reset=function(){this._active=!1},Za.prototype.dblclick=function(V,ve){return V.preventDefault(),{cameraAnimation:function(j){j.easeTo({duration:300,zoom:j.getZoom()+(V.shiftKey?-1:1),around:j.unproject(ve)},{originalEvent:V})}}},Za.prototype.enable=function(){this._enabled=!0},Za.prototype.disable=function(){this._enabled=!1,this.reset()},Za.prototype.isEnabled=function(){return this._enabled},Za.prototype.isActive=function(){return this._active};var xo=function(){this._tap=new nn({numTouches:1,numTaps:1}),this.reset()};xo.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},xo.prototype.touchstart=function(V,ve,j){this._swipePoint||(this._tapTime&&V.timeStamp-this._tapTime>sn&&this.reset(),this._tapTime?j.length>0&&(this._swipePoint=ve[0],this._swipeTouch=j[0].identifier):this._tap.touchstart(V,ve,j))},xo.prototype.touchmove=function(V,ve,j){if(!this._tapTime)this._tap.touchmove(V,ve,j);else if(this._swipePoint){if(j[0].identifier!==this._swipeTouch)return;var de=ve[0],Me=de.y-this._swipePoint.y;return this._swipePoint=de,V.preventDefault(),this._active=!0,{zoomDelta:Me/128}}},xo.prototype.touchend=function(V,ve,j){if(this._tapTime)this._swipePoint&&j.length===0&&this.reset();else{var de=this._tap.touchend(V,ve,j);de&&(this._tapTime=V.timeStamp)}},xo.prototype.touchcancel=function(){this.reset()},xo.prototype.enable=function(){this._enabled=!0},xo.prototype.disable=function(){this._enabled=!1,this.reset()},xo.prototype.isEnabled=function(){return this._enabled},xo.prototype.isActive=function(){return this._active};var eo=function(V,ve,j){this._el=V,this._mousePan=ve,this._touchPan=j};eo.prototype.enable=function(V){this._inertiaOptions=V||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")},eo.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")},eo.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},eo.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var Po=function(V,ve,j){this._pitchWithRotate=V.pitchWithRotate,this._mouseRotate=ve,this._mousePitch=j};Po.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},Po.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},Po.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},Po.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var Xi=function(V,ve,j,de){this._el=V,this._touchZoom=ve,this._touchRotate=j,this._tapDragZoom=de,this._rotationDisabled=!1,this._enabled=!0};Xi.prototype.enable=function(V){this._touchZoom.enable(V),this._rotationDisabled||this._touchRotate.enable(V),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")},Xi.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")},Xi.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},Xi.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},Xi.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},Xi.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var Wo=function(ce){return ce.zoom||ce.drag||ce.pitch||ce.rotate},xs=function(ce){function V(){ce.apply(this,arguments)}return ce&&(V.__proto__=ce),V.prototype=Object.create(ce&&ce.prototype),V.prototype.constructor=V,V}(e.Event);function Nl(ce){return ce.panDelta&&ce.panDelta.mag()||ce.zoomDelta||ce.bearingDelta||ce.pitchDelta}var Zi=function(V,ve){this._map=V,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Fe(V),this._bearingSnap=ve.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(ve),e.bindAll(["handleEvent","handleWindowEvent"],this);var j=this._el;this._listeners=[[j,"touchstart",{passive:!1}],[j,"touchmove",{passive:!1}],[j,"touchend",void 0],[j,"touchcancel",void 0],[j,"mousedown",void 0],[j,"mousemove",void 0],[j,"mouseup",void 0],[e.window.document,"mousemove",{capture:!0}],[e.window.document,"mouseup",void 0],[j,"mouseover",void 0],[j,"mouseout",void 0],[j,"dblclick",void 0],[j,"click",void 0],[j,"keydown",{capture:!1}],[j,"keyup",void 0],[j,"wheel",{passive:!1}],[j,"contextmenu",void 0],[e.window,"blur",void 0]];for(var de=0,Me=this._listeners;de<Me.length;de+=1){var Ce=Me[de],Ze=Ce[0],ut=Ce[1],St=Ce[2];n.addEventListener(Ze,ut,Ze===e.window.document?this.handleWindowEvent:this.handleEvent,St)}};Zi.prototype.destroy=function(){for(var V=0,ve=this._listeners;V<ve.length;V+=1){var j=ve[V],de=j[0],Me=j[1],Ce=j[2];n.removeEventListener(de,Me,de===e.window.document?this.handleWindowEvent:this.handleEvent,Ce)}},Zi.prototype._addDefaultHandlers=function(V){var ve=this._map,j=ve.getCanvasContainer();this._add("mapEvent",new Xt(ve,V));var de=ve.boxZoom=new er(ve,V);this._add("boxZoom",de);var Me=new on,Ce=new Za;ve.doubleClickZoom=new Ia(Ce,Me),this._add("tapZoom",Me),this._add("clickZoom",Ce);var Ze=new xo;this._add("tapDragZoom",Ze);var ut=ve.touchPitch=new si;this._add("touchPitch",ut);var St=new ia(V),jt=new Sa(V);ve.dragRotate=new Po(V,St,jt),this._add("mouseRotate",St,["mousePitch"]),this._add("mousePitch",jt,["mouseRotate"]);var lr=new _a(V),vr=new la(V);ve.dragPan=new eo(j,lr,vr),this._add("mousePan",lr),this._add("touchPan",vr,["touchZoom","touchRotate"]);var Er=new ai,Vr=new fo;ve.touchZoomRotate=new Xi(j,Vr,Er,Ze),this._add("touchRotate",Er,["touchPan","touchZoom"]),this._add("touchZoom",Vr,["touchPan","touchRotate"]);var Gr=ve.scrollZoom=new Bi(ve,this);this._add("scrollZoom",Gr,["mousePan"]);var Ur=ve.keyboard=new Qi;this._add("keyboard",Ur),this._add("blockableMapEvent",new $t(ve));for(var Kr=0,cn=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];Kr<cn.length;Kr+=1){var En=cn[Kr];V.interactive&&V[En]&&ve[En].enable(V[En])}},Zi.prototype._add=function(V,ve,j){this._handlers.push({handlerName:V,handler:ve,allowed:j}),this._handlersById[V]=ve},Zi.prototype.stop=function(){if(!this._updatingCamera){for(var V=0,ve=this._handlers;V<ve.length;V+=1){var j=ve[V],de=j.handler;de.reset()}this._inertia.clear(),this._fireEvents({},{}),this._changes=[]}},Zi.prototype.isActive=function(){for(var V=0,ve=this._handlers;V<ve.length;V+=1){var j=ve[V],de=j.handler;if(de.isActive())return!0}return!1},Zi.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},Zi.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},Zi.prototype.isMoving=function(){return Boolean(Wo(this._eventsInProgress))||this.isZooming()},Zi.prototype._blockedByActive=function(V,ve,j){for(var de in V)if(de!==j&&(!ve||ve.indexOf(de)<0))return!0;return!1},Zi.prototype.handleWindowEvent=function(V){this.handleEvent(V,V.type+"Window")},Zi.prototype._getMapTouches=function(V){for(var ve=[],j=0,de=V;j<de.length;j+=1){var Me=de[j],Ce=Me.target;this._el.contains(Ce)&&ve.push(Me)}return ve},Zi.prototype.handleEvent=function(V,ve){if(V.type==="blur"){this.stop();return}this._updatingCamera=!0;for(var j=V.type==="renderFrame"?void 0:V,de={needsRenderFrame:!1},Me={},Ce={},Ze=V.touches?this._getMapTouches(V.touches):void 0,ut=Ze?n.touchPos(this._el,Ze):n.mousePos(this._el,V),St=0,jt=this._handlers;St<jt.length;St+=1){var lr=jt[St],vr=lr.handlerName,Er=lr.handler,Vr=lr.allowed;if(!!Er.isEnabled()){var Gr=void 0;this._blockedByActive(Ce,Vr,vr)?Er.reset():Er[ve||V.type]&&(Gr=Er[ve||V.type](V,ut,Ze),this.mergeHandlerResult(de,Me,Gr,vr,j),Gr&&Gr.needsRenderFrame&&this._triggerRenderFrame()),(Gr||Er.isActive())&&(Ce[vr]=Er)}}var Ur={};for(var Kr in this._previousActiveHandlers)Ce[Kr]||(Ur[Kr]=j);this._previousActiveHandlers=Ce,(Object.keys(Ur).length||Nl(de))&&(this._changes.push([de,Me,Ur]),this._triggerRenderFrame()),(Object.keys(Ce).length||Nl(de))&&this._map._stop(!0),this._updatingCamera=!1;var cn=de.cameraAnimation;cn&&(this._inertia.clear(),this._fireEvents({},{}),this._changes=[],cn(this._map))},Zi.prototype.mergeHandlerResult=function(V,ve,j,de,Me){if(!!j){e.extend(V,j);var Ce={handlerName:de,originalEvent:j.originalEvent||Me};j.zoomDelta!==void 0&&(ve.zoom=Ce),j.panDelta!==void 0&&(ve.drag=Ce),j.pitchDelta!==void 0&&(ve.pitch=Ce),j.bearingDelta!==void 0&&(ve.rotate=Ce)}},Zi.prototype._applyChanges=function(){for(var V={},ve={},j={},de=0,Me=this._changes;de<Me.length;de+=1){var Ce=Me[de],Ze=Ce[0],ut=Ce[1],St=Ce[2];Ze.panDelta&&(V.panDelta=(V.panDelta||new e.Point(0,0))._add(Ze.panDelta)),Ze.zoomDelta&&(V.zoomDelta=(V.zoomDelta||0)+Ze.zoomDelta),Ze.bearingDelta&&(V.bearingDelta=(V.bearingDelta||0)+Ze.bearingDelta),Ze.pitchDelta&&(V.pitchDelta=(V.pitchDelta||0)+Ze.pitchDelta),Ze.around!==void 0&&(V.around=Ze.around),Ze.pinchAround!==void 0&&(V.pinchAround=Ze.pinchAround),Ze.noInertia&&(V.noInertia=Ze.noInertia),e.extend(ve,ut),e.extend(j,St)}this._updateMapTransform(V,ve,j),this._changes=[]},Zi.prototype._updateMapTransform=function(V,ve,j){var de=this._map,Me=de.transform;if(!Nl(V))return this._fireEvents(ve,j);var Ce=V.panDelta,Ze=V.zoomDelta,ut=V.bearingDelta,St=V.pitchDelta,jt=V.around,lr=V.pinchAround;lr!==void 0&&(jt=lr),de._stop(!0),jt=jt||de.transform.centerPoint;var vr=Me.pointLocation(Ce?jt.sub(Ce):jt);ut&&(Me.bearing+=ut),St&&(Me.pitch+=St),Ze&&(Me.zoom+=Ze),Me.setLocationAtPoint(vr,jt),this._map._update(),V.noInertia||this._inertia.record(V),this._fireEvents(ve,j)},Zi.prototype._fireEvents=function(V,ve){var j=this,de=Wo(this._eventsInProgress),Me=Wo(V),Ce={};for(var Ze in V){var ut=V[Ze],St=ut.originalEvent;this._eventsInProgress[Ze]||(Ce[Ze+"start"]=St),this._eventsInProgress[Ze]=V[Ze]}!de&&Me&&this._fireEvent("movestart",Me.originalEvent);for(var jt in Ce)this._fireEvent(jt,Ce[jt]);V.rotate&&(this._bearingChanged=!0),Me&&this._fireEvent("move",Me.originalEvent);for(var lr in V){var vr=V[lr],Er=vr.originalEvent;this._fireEvent(lr,Er)}var Vr={},Gr;for(var Ur in this._eventsInProgress){var Kr=this._eventsInProgress[Ur],cn=Kr.handlerName,En=Kr.originalEvent;this._handlersById[cn].isActive()||(delete this._eventsInProgress[Ur],Gr=ve[cn]||En,Vr[Ur+"end"]=Gr)}for(var Fn in Vr)this._fireEvent(Fn,Vr[Fn]);var Kn=Wo(this._eventsInProgress);if((de||Me)&&!Kn){this._updatingCamera=!0;var qn=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),Qn=function(ca){return ca!==0&&-j._bearingSnap<ca&&ca<j._bearingSnap};qn?(Qn(qn.bearing||this._map.getBearing())&&(qn.bearing=0),this._map.easeTo(qn,{originalEvent:Gr})):(this._map.fire(new e.Event("moveend",{originalEvent:Gr})),Qn(this._map.getBearing())&&this._map.resetNorth()),this._bearingChanged=!1,this._updatingCamera=!1}},Zi.prototype._fireEvent=function(V,ve){this._map.fire(new e.Event(V,ve?{originalEvent:ve}:{}))},Zi.prototype._triggerRenderFrame=function(){var V=this;this._frameId===void 0&&(this._frameId=this._map._requestRenderFrame(function(ve){delete V._frameId,V.handleEvent(new xs("renderFrame",{timeStamp:ve})),V._applyChanges()}))};var qu=function(ce){function V(ve,j){ce.call(this),this._moving=!1,this._zooming=!1,this.transform=ve,this._bearingSnap=j.bearingSnap,e.bindAll(["_renderFrameCallback"],this)}return ce&&(V.__proto__=ce),V.prototype=Object.create(ce&&ce.prototype),V.prototype.constructor=V,V.prototype.getCenter=function(){return new e.LngLat(this.transform.center.lng,this.transform.center.lat)},V.prototype.setCenter=function(j,de){return this.jumpTo({center:j},de)},V.prototype.panBy=function(j,de,Me){return j=e.Point.convert(j).mult(-1),this.panTo(this.transform.center,e.extend({offset:j},de),Me)},V.prototype.panTo=function(j,de,Me){return this.easeTo(e.extend({center:j},de),Me)},V.prototype.getZoom=function(){return this.transform.zoom},V.prototype.setZoom=function(j,de){return this.jumpTo({zoom:j},de),this},V.prototype.zoomTo=function(j,de,Me){return this.easeTo(e.extend({zoom:j},de),Me)},V.prototype.zoomIn=function(j,de){return this.zoomTo(this.getZoom()+1,j,de),this},V.prototype.zoomOut=function(j,de){return this.zoomTo(this.getZoom()-1,j,de),this},V.prototype.getBearing=function(){return this.transform.bearing},V.prototype.setBearing=function(j,de){return this.jumpTo({bearing:j},de),this},V.prototype.getPadding=function(){return this.transform.padding},V.prototype.setPadding=function(j,de){return this.jumpTo({padding:j},de),this},V.prototype.rotateTo=function(j,de,Me){return this.easeTo(e.extend({bearing:j},de),Me)},V.prototype.resetNorth=function(j,de){return this.rotateTo(0,e.extend({duration:1e3},j),de),this},V.prototype.resetNorthPitch=function(j,de){return this.easeTo(e.extend({bearing:0,pitch:0,duration:1e3},j),de),this},V.prototype.snapToNorth=function(j,de){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(j,de):this},V.prototype.getPitch=function(){return this.transform.pitch},V.prototype.setPitch=function(j,de){return this.jumpTo({pitch:j},de),this},V.prototype.cameraForBounds=function(j,de){return j=e.LngLatBounds.convert(j),this._cameraForBoxAndBearing(j.getNorthWest(),j.getSouthEast(),0,de)},V.prototype._cameraForBoxAndBearing=function(j,de,Me,Ce){var Ze={top:0,bottom:0,right:0,left:0};if(Ce=e.extend({padding:Ze,offset:[0,0],maxZoom:this.transform.maxZoom},Ce),typeof Ce.padding=="number"){var ut=Ce.padding;Ce.padding={top:ut,bottom:ut,right:ut,left:ut}}Ce.padding=e.extend(Ze,Ce.padding);var St=this.transform,jt=St.padding,lr=St.project(e.LngLat.convert(j)),vr=St.project(e.LngLat.convert(de)),Er=lr.rotate(-Me*Math.PI/180),Vr=vr.rotate(-Me*Math.PI/180),Gr=new e.Point(Math.max(Er.x,Vr.x),Math.max(Er.y,Vr.y)),Ur=new e.Point(Math.min(Er.x,Vr.x),Math.min(Er.y,Vr.y)),Kr=Gr.sub(Ur),cn=(St.width-(jt.left+jt.right+Ce.padding.left+Ce.padding.right))/Kr.x,En=(St.height-(jt.top+jt.bottom+Ce.padding.top+Ce.padding.bottom))/Kr.y;if(En<0||cn<0){e.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");return}var Fn=Math.min(St.scaleZoom(St.scale*Math.min(cn,En)),Ce.maxZoom),Kn=e.Point.convert(Ce.offset),qn=(Ce.padding.left-Ce.padding.right)/2,Qn=(Ce.padding.top-Ce.padding.bottom)/2,ca=new e.Point(Kn.x+qn,Kn.y+Qn),ba=ca.mult(St.scale/St.zoomScale(Fn)),ya=St.unproject(lr.add(vr).div(2).sub(ba));return{center:ya,zoom:Fn,bearing:Me}},V.prototype.fitBounds=function(j,de,Me){return this._fitInternal(this.cameraForBounds(j,de),de,Me)},V.prototype.fitScreenCoordinates=function(j,de,Me,Ce,Ze){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(e.Point.convert(j)),this.transform.pointLocation(e.Point.convert(de)),Me,Ce),Ce,Ze)},V.prototype._fitInternal=function(j,de,Me){return j?(de=e.extend(j,de),delete de.padding,de.linear?this.easeTo(de,Me):this.flyTo(de,Me)):this},V.prototype.jumpTo=function(j,de){this.stop();var Me=this.transform,Ce=!1,Ze=!1,ut=!1;return"zoom"in j&&Me.zoom!==+j.zoom&&(Ce=!0,Me.zoom=+j.zoom),j.center!==void 0&&(Me.center=e.LngLat.convert(j.center)),"bearing"in j&&Me.bearing!==+j.bearing&&(Ze=!0,Me.bearing=+j.bearing),"pitch"in j&&Me.pitch!==+j.pitch&&(ut=!0,Me.pitch=+j.pitch),j.padding!=null&&!Me.isPaddingEqual(j.padding)&&(Me.padding=j.padding),this.fire(new e.Event("movestart",de)).fire(new e.Event("move",de)),Ce&&this.fire(new e.Event("zoomstart",de)).fire(new e.Event("zoom",de)).fire(new e.Event("zoomend",de)),Ze&&this.fire(new e.Event("rotatestart",de)).fire(new e.Event("rotate",de)).fire(new e.Event("rotateend",de)),ut&&this.fire(new e.Event("pitchstart",de)).fire(new e.Event("pitch",de)).fire(new e.Event("pitchend",de)),this.fire(new e.Event("moveend",de))},V.prototype.easeTo=function(j,de){var Me=this;this._stop(!1,j.easeId),j=e.extend({offset:[0,0],duration:500,easing:e.ease},j),(j.animate===!1||!j.essential&&e.browser.prefersReducedMotion)&&(j.duration=0);var Ce=this.transform,Ze=this.getZoom(),ut=this.getBearing(),St=this.getPitch(),jt=this.getPadding(),lr="zoom"in j?+j.zoom:Ze,vr="bearing"in j?this._normalizeBearing(j.bearing,ut):ut,Er="pitch"in j?+j.pitch:St,Vr="padding"in j?j.padding:Ce.padding,Gr=e.Point.convert(j.offset),Ur=Ce.centerPoint.add(Gr),Kr=Ce.pointLocation(Ur),cn=e.LngLat.convert(j.center||Kr);this._normalizeCenter(cn);var En=Ce.project(Kr),Fn=Ce.project(cn).sub(En),Kn=Ce.zoomScale(lr-Ze),qn,Qn;j.around&&(qn=e.LngLat.convert(j.around),Qn=Ce.locationPoint(qn));var ca={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||lr!==Ze,this._rotating=this._rotating||ut!==vr,this._pitching=this._pitching||Er!==St,this._padding=!Ce.isPaddingEqual(Vr),this._easeId=j.easeId,this._prepareEase(de,j.noMoveStart,ca),clearTimeout(this._easeEndTimeoutID),this._ease(function(ba){if(Me._zooming&&(Ce.zoom=e.number(Ze,lr,ba)),Me._rotating&&(Ce.bearing=e.number(ut,vr,ba)),Me._pitching&&(Ce.pitch=e.number(St,Er,ba)),Me._padding&&(Ce.interpolatePadding(jt,Vr,ba),Ur=Ce.centerPoint.add(Gr)),qn)Ce.setLocationAtPoint(qn,Qn);else{var ya=Ce.zoomScale(Ce.zoom-Ze),Ta=lr>Ze?Math.min(2,Kn):Math.max(.5,Kn),Ea=Math.pow(Ta,1-ba),Ha=Ce.unproject(En.add(Fn.mult(ba*Ea)).mult(ya));Ce.setLocationAtPoint(Ce.renderWorldCopies?Ha.wrap():Ha,Ur)}Me._fireMoveEvents(de)},function(ba){Me._afterEase(de,ba)},j),this},V.prototype._prepareEase=function(j,de,Me){Me===void 0&&(Me={}),this._moving=!0,!de&&!Me.moving&&this.fire(new e.Event("movestart",j)),this._zooming&&!Me.zooming&&this.fire(new e.Event("zoomstart",j)),this._rotating&&!Me.rotating&&this.fire(new e.Event("rotatestart",j)),this._pitching&&!Me.pitching&&this.fire(new e.Event("pitchstart",j))},V.prototype._fireMoveEvents=function(j){this.fire(new e.Event("move",j)),this._zooming&&this.fire(new e.Event("zoom",j)),this._rotating&&this.fire(new e.Event("rotate",j)),this._pitching&&this.fire(new e.Event("pitch",j))},V.prototype._afterEase=function(j,de){if(!(this._easeId&&de&&this._easeId===de)){delete this._easeId;var Me=this._zooming,Ce=this._rotating,Ze=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,Me&&this.fire(new e.Event("zoomend",j)),Ce&&this.fire(new e.Event("rotateend",j)),Ze&&this.fire(new e.Event("pitchend",j)),this.fire(new e.Event("moveend",j))}},V.prototype.flyTo=function(j,de){var Me=this;if(!j.essential&&e.browser.prefersReducedMotion){var Ce=e.pick(j,["center","zoom","bearing","pitch","around"]);return this.jumpTo(Ce,de)}this.stop(),j=e.extend({offset:[0,0],speed:1.2,curve:1.42,easing:e.ease},j);var Ze=this.transform,ut=this.getZoom(),St=this.getBearing(),jt=this.getPitch(),lr=this.getPadding(),vr="zoom"in j?e.clamp(+j.zoom,Ze.minZoom,Ze.maxZoom):ut,Er="bearing"in j?this._normalizeBearing(j.bearing,St):St,Vr="pitch"in j?+j.pitch:jt,Gr="padding"in j?j.padding:Ze.padding,Ur=Ze.zoomScale(vr-ut),Kr=e.Point.convert(j.offset),cn=Ze.centerPoint.add(Kr),En=Ze.pointLocation(cn),Fn=e.LngLat.convert(j.center||En);this._normalizeCenter(Fn);var Kn=Ze.project(En),qn=Ze.project(Fn).sub(Kn),Qn=j.curve,ca=Math.max(Ze.width,Ze.height),ba=ca/Ur,ya=qn.mag();if("minZoom"in j){var Ta=e.clamp(Math.min(j.minZoom,ut,vr),Ze.minZoom,Ze.maxZoom),Ea=ca/Ze.zoomScale(Ta-ut);Qn=Math.sqrt(Ea/ya*2)}var Ha=Qn*Qn;function ni(ii){var wi=(ba*ba-ca*ca+(ii?-1:1)*Ha*Ha*ya*ya)/(2*(ii?ba:ca)*Ha*ya);return Math.log(Math.sqrt(wi*wi+1)-wi)}function Li(ii){return(Math.exp(ii)-Math.exp(-ii))/2}function ui(ii){return(Math.exp(ii)+Math.exp(-ii))/2}function pi(ii){return Li(ii)/ui(ii)}var Ba=ni(0),Pi=function(ii){return ui(Ba)/ui(Ba+Qn*ii)},zi=function(ii){return ca*((ui(Ba)*pi(Ba+Qn*ii)-Li(Ba))/Ha)/ya},Ni=(ni(1)-Ba)/Qn;if(Math.abs(ya)<1e-6||!isFinite(Ni)){if(Math.abs(ca-ba)<1e-6)return this.easeTo(j,de);var _i=ba<ca?-1:1;Ni=Math.abs(Math.log(ba/ca))/Qn,zi=function(){return 0},Pi=function(ii){return Math.exp(_i*Qn*ii)}}if("duration"in j)j.duration=+j.duration;else{var ji="screenSpeed"in j?+j.screenSpeed/Qn:+j.speed;j.duration=1e3*Ni/ji}return j.maxDuration&&j.duration>j.maxDuration&&(j.duration=0),this._zooming=!0,this._rotating=St!==Er,this._pitching=Vr!==jt,this._padding=!Ze.isPaddingEqual(Gr),this._prepareEase(de,!1),this._ease(function(ii){var wi=ii*Ni,_o=1/Pi(wi);Ze.zoom=ii===1?vr:ut+Ze.scaleZoom(_o),Me._rotating&&(Ze.bearing=e.number(St,Er,ii)),Me._pitching&&(Ze.pitch=e.number(jt,Vr,ii)),Me._padding&&(Ze.interpolatePadding(lr,Gr,ii),cn=Ze.centerPoint.add(Kr));var Oo=ii===1?Fn:Ze.unproject(Kn.add(qn.mult(zi(wi))).mult(_o));Ze.setLocationAtPoint(Ze.renderWorldCopies?Oo.wrap():Oo,cn),Me._fireMoveEvents(de)},function(){return Me._afterEase(de)},j),this},V.prototype.isEasing=function(){return!!this._easeFrameId},V.prototype.stop=function(){return this._stop()},V.prototype._stop=function(j,de){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var Me=this._onEaseEnd;delete this._onEaseEnd,Me.call(this,de)}if(!j){var Ce=this.handlers;Ce&&Ce.stop()}return this},V.prototype._ease=function(j,de,Me){Me.animate===!1||Me.duration===0?(j(1),de()):(this._easeStart=e.browser.now(),this._easeOptions=Me,this._onEaseFrame=j,this._onEaseEnd=de,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},V.prototype._renderFrameCallback=function(){var j=Math.min((e.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(j)),j<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},V.prototype._normalizeBearing=function(j,de){j=e.wrap(j,-180,180);var Me=Math.abs(j-de);return Math.abs(j-360-de)<Me&&(j-=360),Math.abs(j+360-de)<Me&&(j+=360),j},V.prototype._normalizeCenter=function(j){var de=this.transform;if(!(!de.renderWorldCopies||de.lngRange)){var Me=j.lng-de.center.lng;j.lng+=Me>180?-360:Me<-180?360:0}},V}(e.Evented),Al=function(V){V===void 0&&(V={}),this.options=V,e.bindAll(["_updateEditLink","_updateData","_updateCompact"],this)};Al.prototype.getDefaultPosition=function(){return"bottom-right"},Al.prototype.onAdd=function(V){var ve=this.options&&this.options.compact;return this._map=V,this._container=n.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._innerContainer=n.create("div","mapboxgl-ctrl-attrib-inner",this._container),ve&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),ve===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},Al.prototype.onRemove=function(){n.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},Al.prototype._updateEditLink=function(){var V=this._editLink;V||(V=this._editLink=this._container.querySelector(".mapbox-improve-map"));var ve=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||e.config.ACCESS_TOKEN}];if(V){var j=ve.reduce(function(de,Me,Ce){return Me.value&&(de+=Me.key+"="+Me.value+(Ce<ve.length-1?"&":"")),de},"?");V.href=e.config.FEEDBACK_URL+"/"+j+(this._map._hash?this._map._hash.getHashString(!0):""),V.rel="noopener nofollow"}},Al.prototype._updateData=function(V){V&&(V.sourceDataType==="metadata"||V.dataType==="style")&&(this._updateAttributions(),this._updateEditLink())},Al.prototype._updateAttributions=function(){if(!!this._map.style){var V=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?V=V.concat(this.options.customAttribution.map(function(ut){return typeof ut!="string"?"":ut})):typeof this.options.customAttribution=="string"&&V.push(this.options.customAttribution)),this._map.style.stylesheet){var ve=this._map.style.stylesheet;this.styleOwner=ve.owner,this.styleId=ve.id}var j=this._map.style.sourceCaches;for(var de in j){var Me=j[de];if(Me.used){var Ce=Me.getSource();Ce.attribution&&V.indexOf(Ce.attribution)<0&&V.push(Ce.attribution)}}V.sort(function(ut,St){return ut.length-St.length}),V=V.filter(function(ut,St){for(var jt=St+1;jt<V.length;jt++)if(V[jt].indexOf(ut)>=0)return!1;return!0});var Ze=V.join(" | ");Ze!==this._attribHTML&&(this._attribHTML=Ze,V.length?(this._innerContainer.innerHTML=Ze,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},Al.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact")};var Oi=function(){e.bindAll(["_updateLogo"],this),e.bindAll(["_updateCompact"],this)};Oi.prototype.onAdd=function(V){this._map=V,this._container=n.create("div","mapboxgl-ctrl");var ve=n.create("a","mapboxgl-ctrl-logo");return ve.target="_blank",ve.rel="noopener nofollow",ve.href="https://www.mapbox.com/",ve.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),ve.setAttribute("rel","noopener nofollow"),this._container.appendChild(ve),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},Oi.prototype.onRemove=function(){n.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},Oi.prototype.getDefaultPosition=function(){return"bottom-left"},Oi.prototype._updateLogo=function(V){(!V||V.sourceDataType==="metadata")&&(this._container.style.display=this._logoRequired()?"block":"none")},Oi.prototype._logoRequired=function(){if(!!this._map.style){var V=this._map.style.sourceCaches;for(var ve in V){var j=V[ve].getSource();if(j.mapbox_logo)return!0}return!1}},Oi.prototype._updateCompact=function(){var V=this._container.children;if(V.length){var ve=V[0];this._map.getCanvasContainer().offsetWidth<250?ve.classList.add("mapboxgl-compact"):ve.classList.remove("mapboxgl-compact")}};var Do=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};Do.prototype.add=function(V){var ve=++this._id,j=this._queue;return j.push({callback:V,id:ve,cancelled:!1}),ve},Do.prototype.remove=function(V){for(var ve=this._currentlyRunning,j=ve?this._queue.concat(ve):this._queue,de=0,Me=j;de<Me.length;de+=1){var Ce=Me[de];if(Ce.id===V){Ce.cancelled=!0;return}}},Do.prototype.run=function(V){V===void 0&&(V=0);var ve=this._currentlyRunning=this._queue;this._queue=[];for(var j=0,de=ve;j<de.length;j+=1){var Me=de[j];if(!Me.cancelled&&(Me.callback(V),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},Do.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var Jc={"FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},Mf=e.window.HTMLImageElement,pf=e.window.HTMLElement,Ou=e.window.ImageBitmap,ef=-2,Sf=22,Os=0,Bu=60,$f={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:ef,maxZoom:Sf,minPitch:Os,maxPitch:Bu,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},qf=function(ce){function V(j){var de=this;if(j=e.extend({},$f,j),j.minZoom!=null&&j.maxZoom!=null&&j.minZoom>j.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(j.minPitch!=null&&j.maxPitch!=null&&j.minPitch>j.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(j.minPitch!=null&&j.minPitch<Os)throw new Error("minPitch must be greater than or equal to "+Os);if(j.maxPitch!=null&&j.maxPitch>Bu)throw new Error("maxPitch must be less than or equal to "+Bu);var Me=new bi(j.minZoom,j.maxZoom,j.minPitch,j.maxPitch,j.renderWorldCopies);if(ce.call(this,Me,j),this._interactive=j.interactive,this._maxTileCacheSize=j.maxTileCacheSize,this._failIfMajorPerformanceCaveat=j.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=j.preserveDrawingBuffer,this._antialias=j.antialias,this._trackResize=j.trackResize,this._bearingSnap=j.bearingSnap,this._refreshExpiredTiles=j.refreshExpiredTiles,this._fadeDuration=j.fadeDuration,this._crossSourceCollisions=j.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=j.collectResourceTiming,this._renderTaskQueue=new Do,this._controls=[],this._mapId=e.uniqueId(),this._locale=e.extend({},Jc,j.locale),this._requestManager=new e.RequestManager(j.transformRequest,j.accessToken),typeof j.container=="string"){if(this._container=e.window.document.getElementById(j.container),!this._container)throw new Error("Container '"+j.container+"' not found.")}else if(j.container instanceof pf)this._container=j.container;else throw new Error("Invalid type: 'container' must be a String or HTMLElement.");if(j.maxBounds&&this.setMaxBounds(j.maxBounds),e.bindAll(["_onWindowOnline","_onWindowResize","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return de._update(!1)}),this.on("moveend",function(){return de._update(!1)}),this.on("zoom",function(){return de._update(!0)}),typeof e.window<"u"&&(e.window.addEventListener("online",this._onWindowOnline,!1),e.window.addEventListener("resize",this._onWindowResize,!1)),this.handlers=new Zi(this,j);var Ce=typeof j.hash=="string"&&j.hash||void 0;this._hash=j.hash&&new po(Ce).addTo(this),(!this._hash||!this._hash._onHashChange())&&(this.jumpTo({center:j.center,zoom:j.zoom,bearing:j.bearing,pitch:j.pitch}),j.bounds&&(this.resize(),this.fitBounds(j.bounds,e.extend({},j.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=j.localIdeographFontFamily,j.style&&this.setStyle(j.style,{localIdeographFontFamily:j.localIdeographFontFamily}),j.attributionControl&&this.addControl(new Al({customAttribution:j.customAttribution})),this.addControl(new Oi,j.logoPosition),this.on("style.load",function(){de.transform.unmodified&&de.jumpTo(de.style.stylesheet)}),this.on("data",function(Ze){de._update(Ze.dataType==="style"),de.fire(new e.Event(Ze.dataType+"data",Ze))}),this.on("dataloading",function(Ze){de.fire(new e.Event(Ze.dataType+"dataloading",Ze))})}ce&&(V.__proto__=ce),V.prototype=Object.create(ce&&ce.prototype),V.prototype.constructor=V;var ve={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return V.prototype._getMapId=function(){return this._mapId},V.prototype.addControl=function(de,Me){if(Me===void 0&&de.getDefaultPosition&&(Me=de.getDefaultPosition()),Me===void 0&&(Me="top-right"),!de||!de.onAdd)return this.fire(new e.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var Ce=de.onAdd(this);this._controls.push(de);var Ze=this._controlPositions[Me];return Me.indexOf("bottom")!==-1?Ze.insertBefore(Ce,Ze.firstChild):Ze.appendChild(Ce),this},V.prototype.removeControl=function(de){if(!de||!de.onRemove)return this.fire(new e.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var Me=this._controls.indexOf(de);return Me>-1&&this._controls.splice(Me,1),de.onRemove(this),this},V.prototype.resize=function(de){var Me=this._containerDimensions(),Ce=Me[0],Ze=Me[1];this._resizeCanvas(Ce,Ze),this.transform.resize(Ce,Ze),this.painter.resize(Ce,Ze);var ut=!this._moving;return ut&&(this.stop(),this.fire(new e.Event("movestart",de)).fire(new e.Event("move",de))),this.fire(new e.Event("resize",de)),ut&&this.fire(new e.Event("moveend",de)),this},V.prototype.getBounds=function(){return this.transform.getBounds()},V.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},V.prototype.setMaxBounds=function(de){return this.transform.setMaxBounds(e.LngLatBounds.convert(de)),this._update()},V.prototype.setMinZoom=function(de){if(de=de==null?ef:de,de>=ef&&de<=this.transform.maxZoom)return this.transform.minZoom=de,this._update(),this.getZoom()<de&&this.setZoom(de),this;throw new Error("minZoom must be between "+ef+" and the current maxZoom, inclusive")},V.prototype.getMinZoom=function(){return this.transform.minZoom},V.prototype.setMaxZoom=function(de){if(de=de==null?Sf:de,de>=this.transform.minZoom)return this.transform.maxZoom=de,this._update(),this.getZoom()>de&&this.setZoom(de),this;throw new Error("maxZoom must be greater than the current minZoom")},V.prototype.getMaxZoom=function(){return this.transform.maxZoom},V.prototype.setMinPitch=function(de){if(de=de==null?Os:de,de<Os)throw new Error("minPitch must be greater than or equal to "+Os);if(de>=Os&&de<=this.transform.maxPitch)return this.transform.minPitch=de,this._update(),this.getPitch()<de&&this.setPitch(de),this;throw new Error("minPitch must be between "+Os+" and the current maxPitch, inclusive")},V.prototype.getMinPitch=function(){return this.transform.minPitch},V.prototype.setMaxPitch=function(de){if(de=de==null?Bu:de,de>Bu)throw new Error("maxPitch must be less than or equal to "+Bu);if(de>=this.transform.minPitch)return this.transform.maxPitch=de,this._update(),this.getPitch()>de&&this.setPitch(de),this;throw new Error("maxPitch must be greater than the current minPitch")},V.prototype.getMaxPitch=function(){return this.transform.maxPitch},V.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},V.prototype.setRenderWorldCopies=function(de){return this.transform.renderWorldCopies=de,this._update()},V.prototype.project=function(de){return this.transform.locationPoint(e.LngLat.convert(de))},V.prototype.unproject=function(de){return this.transform.pointLocation(e.Point.convert(de))},V.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},V.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},V.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},V.prototype._createDelegatedListener=function(de,Me,Ce){var Ze=this,ut;if(de==="mouseenter"||de==="mouseover"){var St=!1,jt=function(Ur){var Kr=Ze.getLayer(Me)?Ze.queryRenderedFeatures(Ur.point,{layers:[Me]}):[];Kr.length?St||(St=!0,Ce.call(Ze,new xt(de,Ze,Ur.originalEvent,{features:Kr}))):St=!1},lr=function(){St=!1};return{layer:Me,listener:Ce,delegates:{mousemove:jt,mouseout:lr}}}else if(de==="mouseleave"||de==="mouseout"){var vr=!1,Er=function(Ur){var Kr=Ze.getLayer(Me)?Ze.queryRenderedFeatures(Ur.point,{layers:[Me]}):[];Kr.length?vr=!0:vr&&(vr=!1,Ce.call(Ze,new xt(de,Ze,Ur.originalEvent)))},Vr=function(Ur){vr&&(vr=!1,Ce.call(Ze,new xt(de,Ze,Ur.originalEvent)))};return{layer:Me,listener:Ce,delegates:{mousemove:Er,mouseout:Vr}}}else{var Gr=function(Ur){var Kr=Ze.getLayer(Me)?Ze.queryRenderedFeatures(Ur.point,{layers:[Me]}):[];Kr.length&&(Ur.features=Kr,Ce.call(Ze,Ur),delete Ur.features)};return{layer:Me,listener:Ce,delegates:(ut={},ut[de]=Gr,ut)}}},V.prototype.on=function(de,Me,Ce){if(Ce===void 0)return ce.prototype.on.call(this,de,Me);var Ze=this._createDelegatedListener(de,Me,Ce);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[de]=this._delegatedListeners[de]||[],this._delegatedListeners[de].push(Ze);for(var ut in Ze.delegates)this.on(ut,Ze.delegates[ut]);return this},V.prototype.once=function(de,Me,Ce){if(Ce===void 0)return ce.prototype.once.call(this,de,Me);var Ze=this._createDelegatedListener(de,Me,Ce);for(var ut in Ze.delegates)this.once(ut,Ze.delegates[ut]);return this},V.prototype.off=function(de,Me,Ce){var Ze=this;if(Ce===void 0)return ce.prototype.off.call(this,de,Me);var ut=function(St){for(var jt=St[de],lr=0;lr<jt.length;lr++){var vr=jt[lr];if(vr.layer===Me&&vr.listener===Ce){for(var Er in vr.delegates)Ze.off(Er,vr.delegates[Er]);return jt.splice(lr,1),Ze}}};return this._delegatedListeners&&this._delegatedListeners[de]&&ut(this._delegatedListeners),this},V.prototype.queryRenderedFeatures=function(de,Me){if(!this.style)return[];Me===void 0&&de!==void 0&&!(de instanceof e.Point)&&!Array.isArray(de)&&(Me=de,de=void 0),Me=Me||{},de=de||[[0,0],[this.transform.width,this.transform.height]];var Ce;if(de instanceof e.Point||typeof de[0]=="number")Ce=[e.Point.convert(de)];else{var Ze=e.Point.convert(de[0]),ut=e.Point.convert(de[1]);Ce=[Ze,new e.Point(ut.x,Ze.y),ut,new e.Point(Ze.x,ut.y),Ze]}return this.style.queryRenderedFeatures(Ce,Me,this.transform)},V.prototype.querySourceFeatures=function(de,Me){return this.style.querySourceFeatures(de,Me)},V.prototype.setStyle=function(de,Me){return Me=e.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},Me),Me.diff!==!1&&Me.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&de?(this._diffStyle(de,Me),this):(this._localIdeographFontFamily=Me.localIdeographFontFamily,this._updateStyle(de,Me))},V.prototype._getUIString=function(de){var Me=this._locale[de];if(Me==null)throw new Error("Missing UI string '"+de+"'");return Me},V.prototype._updateStyle=function(de,Me){if(this.style&&(this.style.setEventedParent(null),this.style._remove()),de)this.style=new jo(this,Me||{});else return delete this.style,this;return this.style.setEventedParent(this,{style:this.style}),typeof de=="string"?this.style.loadURL(de):this.style.loadJSON(de),this},V.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new jo(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},V.prototype._diffStyle=function(de,Me){var Ce=this;if(typeof de=="string"){var Ze=this._requestManager.normalizeStyleURL(de),ut=this._requestManager.transformRequest(Ze,e.ResourceType.Style);e.getJSON(ut,function(St,jt){St?Ce.fire(new e.ErrorEvent(St)):jt&&Ce._updateDiff(jt,Me)})}else typeof de=="object"&&this._updateDiff(de,Me)},V.prototype._updateDiff=function(de,Me){try{this.style.setState(de)&&this._update(!0)}catch(Ce){e.warnOnce("Unable to perform style diff: "+(Ce.message||Ce.error||Ce)+".  Rebuilding the style from scratch."),this._updateStyle(de,Me)}},V.prototype.getStyle=function(){if(this.style)return this.style.serialize()},V.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():e.warnOnce("There is no style added to the map.")},V.prototype.addSource=function(de,Me){return this._lazyInitEmptyStyle(),this.style.addSource(de,Me),this._update(!0)},V.prototype.isSourceLoaded=function(de){var Me=this.style&&this.style.sourceCaches[de];if(Me===void 0){this.fire(new e.ErrorEvent(new Error("There is no source with ID '"+de+"'")));return}return Me.loaded()},V.prototype.areTilesLoaded=function(){var de=this.style&&this.style.sourceCaches;for(var Me in de){var Ce=de[Me],Ze=Ce._tiles;for(var ut in Ze){var St=Ze[ut];if(!(St.state==="loaded"||St.state==="errored"))return!1}}return!0},V.prototype.addSourceType=function(de,Me,Ce){return this._lazyInitEmptyStyle(),this.style.addSourceType(de,Me,Ce)},V.prototype.removeSource=function(de){return this.style.removeSource(de),this._update(!0)},V.prototype.getSource=function(de){return this.style.getSource(de)},V.prototype.addImage=function(de,Me,Ce){Ce===void 0&&(Ce={});var Ze=Ce.pixelRatio;Ze===void 0&&(Ze=1);var ut=Ce.sdf;ut===void 0&&(ut=!1);var St=Ce.stretchX,jt=Ce.stretchY,lr=Ce.content;this._lazyInitEmptyStyle();var vr=0;if(Me instanceof Mf||Ou&&Me instanceof Ou){var Er=e.browser.getImageData(Me),Vr=Er.width,Gr=Er.height,Ur=Er.data;this.style.addImage(de,{data:new e.RGBAImage({width:Vr,height:Gr},Ur),pixelRatio:Ze,stretchX:St,stretchY:jt,content:lr,sdf:ut,version:vr})}else{if(Me.width===void 0||Me.height===void 0)return this.fire(new e.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var Kr=Me.width,cn=Me.height,En=Me.data,Fn=Me;this.style.addImage(de,{data:new e.RGBAImage({width:Kr,height:cn},new Uint8Array(En)),pixelRatio:Ze,stretchX:St,stretchY:jt,content:lr,sdf:ut,version:vr,userImage:Fn}),Fn.onAdd&&Fn.onAdd(this,de)}},V.prototype.updateImage=function(de,Me){var Ce=this.style.getImage(de);if(!Ce)return this.fire(new e.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var Ze=Me instanceof Mf||Ou&&Me instanceof Ou?e.browser.getImageData(Me):Me,ut=Ze.width,St=Ze.height,jt=Ze.data;if(ut===void 0||St===void 0)return this.fire(new e.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(ut!==Ce.data.width||St!==Ce.data.height)return this.fire(new e.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image")));var lr=!(Me instanceof Mf||Ou&&Me instanceof Ou);Ce.data.replace(jt,lr),this.style.updateImage(de,Ce)},V.prototype.hasImage=function(de){return de?!!this.style.getImage(de):(this.fire(new e.ErrorEvent(new Error("Missing required image id"))),!1)},V.prototype.removeImage=function(de){this.style.removeImage(de)},V.prototype.loadImage=function(de,Me){e.getImage(this._requestManager.transformRequest(de,e.ResourceType.Image),Me)},V.prototype.listImages=function(){return this.style.listImages()},V.prototype.addLayer=function(de,Me){return this._lazyInitEmptyStyle(),this.style.addLayer(de,Me),this._update(!0)},V.prototype.moveLayer=function(de,Me){return this.style.moveLayer(de,Me),this._update(!0)},V.prototype.removeLayer=function(de){return this.style.removeLayer(de),this._update(!0)},V.prototype.getLayer=function(de){return this.style.getLayer(de)},V.prototype.setLayerZoomRange=function(de,Me,Ce){return this.style.setLayerZoomRange(de,Me,Ce),this._update(!0)},V.prototype.setFilter=function(de,Me,Ce){return Ce===void 0&&(Ce={}),this.style.setFilter(de,Me,Ce),this._update(!0)},V.prototype.getFilter=function(de){return this.style.getFilter(de)},V.prototype.setPaintProperty=function(de,Me,Ce,Ze){return Ze===void 0&&(Ze={}),this.style.setPaintProperty(de,Me,Ce,Ze),this._update(!0)},V.prototype.getPaintProperty=function(de,Me){return this.style.getPaintProperty(de,Me)},V.prototype.setLayoutProperty=function(de,Me,Ce,Ze){return Ze===void 0&&(Ze={}),this.style.setLayoutProperty(de,Me,Ce,Ze),this._update(!0)},V.prototype.getLayoutProperty=function(de,Me){return this.style.getLayoutProperty(de,Me)},V.prototype.setLight=function(de,Me){return Me===void 0&&(Me={}),this._lazyInitEmptyStyle(),this.style.setLight(de,Me),this._update(!0)},V.prototype.getLight=function(){return this.style.getLight()},V.prototype.setFeatureState=function(de,Me){return this.style.setFeatureState(de,Me),this._update()},V.prototype.removeFeatureState=function(de,Me){return this.style.removeFeatureState(de,Me),this._update()},V.prototype.getFeatureState=function(de){return this.style.getFeatureState(de)},V.prototype.getContainer=function(){return this._container},V.prototype.getCanvasContainer=function(){return this._canvasContainer},V.prototype.getCanvas=function(){return this._canvas},V.prototype._containerDimensions=function(){var de=0,Me=0;return this._container&&(de=this._container.clientWidth||400,Me=this._container.clientHeight||300),[de,Me]},V.prototype._detectMissingCSS=function(){var de=e.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color");de!=="rgb(250, 128, 114)"&&e.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},V.prototype._setupContainer=function(){var de=this._container;de.classList.add("mapboxgl-map");var Me=this._missingCSSCanary=n.create("div","mapboxgl-canary",de);Me.style.visibility="hidden",this._detectMissingCSS();var Ce=this._canvasContainer=n.create("div","mapboxgl-canvas-container",de);this._interactive&&Ce.classList.add("mapboxgl-interactive"),this._canvas=n.create("canvas","mapboxgl-canvas",Ce),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map");var Ze=this._containerDimensions();this._resizeCanvas(Ze[0],Ze[1]);var ut=this._controlContainer=n.create("div","mapboxgl-control-container",de),St=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(jt){St[jt]=n.create("div","mapboxgl-ctrl-"+jt,ut)})},V.prototype._resizeCanvas=function(de,Me){var Ce=e.browser.devicePixelRatio||1;this._canvas.width=Ce*de,this._canvas.height=Ce*Me,this._canvas.style.width=de+"px",this._canvas.style.height=Me+"px"},V.prototype._setupPainter=function(){var de=e.extend({},a.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),Me=this._canvas.getContext("webgl",de)||this._canvas.getContext("experimental-webgl",de);if(!Me){this.fire(new e.ErrorEvent(new Error("Failed to initialize WebGL")));return}this.painter=new ri(Me,this.transform),e.webpSupported.testSupport(Me)},V.prototype._contextLost=function(de){de.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new e.Event("webglcontextlost",{originalEvent:de}))},V.prototype._contextRestored=function(de){this._setupPainter(),this.resize(),this._update(),this.fire(new e.Event("webglcontextrestored",{originalEvent:de}))},V.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},V.prototype._update=function(de){return this.style?(this._styleDirty=this._styleDirty||de,this._sourcesDirty=!0,this.triggerRepaint(),this):this},V.prototype._requestRenderFrame=function(de){return this._update(),this._renderTaskQueue.add(de)},V.prototype._cancelRenderFrame=function(de){this._renderTaskQueue.remove(de)},V.prototype._render=function(de){var Me=this,Ce,Ze=0,ut=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(Ce=ut.createQueryEXT(),ut.beginQueryEXT(ut.TIME_ELAPSED_EXT,Ce),Ze=e.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(de),!this._removed){var St=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var jt=this.transform.zoom,lr=e.browser.now();this.style.zoomHistory.update(jt,lr);var vr=new e.EvaluationParameters(jt,{now:lr,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),Er=vr.crossFadingFactor();(Er!==1||Er!==this._crossFadingFactor)&&(St=!0,this._crossFadingFactor=Er),this.style.update(vr)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new e.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new e.Event("load"))),this.style&&(this.style.hasTransitions()||St)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var Vr=e.browser.now()-Ze;ut.endQueryEXT(ut.TIME_ELAPSED_EXT,Ce),setTimeout(function(){var Kr=ut.getQueryObjectEXT(Ce,ut.QUERY_RESULT_EXT)/1e6;ut.deleteQueryEXT(Ce),Me.fire(new e.Event("gpu-timing-frame",{cpuTime:Vr,gpuTime:Kr}))},50)}if(this.listens("gpu-timing-layer")){var Gr=this.painter.collectGpuTimers();setTimeout(function(){var Kr=Me.painter.queryGpuTimers(Gr);Me.fire(new e.Event("gpu-timing-layer",{layerTimes:Kr}))},50)}var Ur=this._sourcesDirty||this._styleDirty||this._placementDirty;return Ur||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&(this._fullyLoaded||(this._fullyLoaded=!0),this.fire(new e.Event("idle"))),this}},V.prototype.remove=function(){this._hash&&this._hash.remove();for(var de=0,Me=this._controls;de<Me.length;de+=1){var Ce=Me[de];Ce.onRemove(this)}this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof e.window<"u"&&(e.window.removeEventListener("resize",this._onWindowResize,!1),e.window.removeEventListener("online",this._onWindowOnline,!1));var Ze=this.painter.context.gl.getExtension("WEBGL_lose_context");Ze&&Ze.loseContext(),df(this._canvasContainer),df(this._controlContainer),df(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this._removed=!0,this.fire(new e.Event("remove"))},V.prototype.triggerRepaint=function(){var de=this;this.style&&!this._frame&&(this._frame=e.browser.frame(function(Me){de._frame=null,de._render(Me)}))},V.prototype._onWindowOnline=function(){this._update()},V.prototype._onWindowResize=function(de){this._trackResize&&this.resize({originalEvent:de})._update()},ve.showTileBoundaries.get=function(){return!!this._showTileBoundaries},ve.showTileBoundaries.set=function(j){this._showTileBoundaries!==j&&(this._showTileBoundaries=j,this._update())},ve.showPadding.get=function(){return!!this._showPadding},ve.showPadding.set=function(j){this._showPadding!==j&&(this._showPadding=j,this._update())},ve.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},ve.showCollisionBoxes.set=function(j){this._showCollisionBoxes!==j&&(this._showCollisionBoxes=j,j?this.style._generateCollisionBoxes():this._update())},ve.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},ve.showOverdrawInspector.set=function(j){this._showOverdrawInspector!==j&&(this._showOverdrawInspector=j,this._update())},ve.repaint.get=function(){return!!this._repaint},ve.repaint.set=function(j){this._repaint!==j&&(this._repaint=j,this.triggerRepaint())},ve.vertices.get=function(){return!!this._vertices},ve.vertices.set=function(j){this._vertices=j,this._update()},V.prototype._setCacheLimits=function(de,Me){e.setCacheLimits(de,Me)},ve.version.get=function(){return e.version},Object.defineProperties(V.prototype,ve),V}(qu);function df(ce){ce.parentNode&&ce.parentNode.removeChild(ce)}var kf={showCompass:!0,showZoom:!0,visualizePitch:!1},mu=function(V){var ve=this;this.options=e.extend({},kf,V),this._container=n.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(j){return j.preventDefault()}),this.options.showZoom&&(e.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",function(j){return ve._map.zoomIn({},{originalEvent:j})}),n.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",function(j){return ve._map.zoomOut({},{originalEvent:j})}),n.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(e.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",function(j){ve.options.visualizePitch?ve._map.resetNorthPitch({},{originalEvent:j}):ve._map.resetNorth({},{originalEvent:j})}),this._compassIcon=n.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};mu.prototype._updateZoomButtons=function(){var V=this._map.getZoom();this._zoomInButton.disabled=V===this._map.getMaxZoom(),this._zoomOutButton.disabled=V===this._map.getMinZoom()},mu.prototype._rotateCompassArrow=function(){var V=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=V},mu.prototype.onAdd=function(V){return this._map=V,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Qs(this._map,this._compass,this.options.visualizePitch)),this._container},mu.prototype.onRemove=function(){n.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},mu.prototype._createButton=function(V,ve){var j=n.create("button",V,this._container);return j.type="button",j.addEventListener("click",ve),j},mu.prototype._setButtonTitle=function(V,ve){var j=this._map._getUIString("NavigationControl."+ve);V.title=j,V.setAttribute("aria-label",j)};var Qs=function(V,ve,j){j===void 0&&(j=!1),this._clickTolerance=10,this.element=ve,this.mouseRotate=new ia({clickTolerance:V.dragRotate._mouseRotate._clickTolerance}),this.map=V,j&&(this.mousePitch=new Sa({clickTolerance:V.dragRotate._mousePitch._clickTolerance})),e.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),n.addEventListener(ve,"mousedown",this.mousedown),n.addEventListener(ve,"touchstart",this.touchstart,{passive:!1}),n.addEventListener(ve,"touchmove",this.touchmove),n.addEventListener(ve,"touchend",this.touchend),n.addEventListener(ve,"touchcancel",this.reset)};Qs.prototype.down=function(V,ve){this.mouseRotate.mousedown(V,ve),this.mousePitch&&this.mousePitch.mousedown(V,ve),n.disableDrag()},Qs.prototype.move=function(V,ve){var j=this.map,de=this.mouseRotate.mousemoveWindow(V,ve);if(de&&de.bearingDelta&&j.setBearing(j.getBearing()+de.bearingDelta),this.mousePitch){var Me=this.mousePitch.mousemoveWindow(V,ve);Me&&Me.pitchDelta&&j.setPitch(j.getPitch()+Me.pitchDelta)}},Qs.prototype.off=function(){var V=this.element;n.removeEventListener(V,"mousedown",this.mousedown),n.removeEventListener(V,"touchstart",this.touchstart,{passive:!1}),n.removeEventListener(V,"touchmove",this.touchmove),n.removeEventListener(V,"touchend",this.touchend),n.removeEventListener(V,"touchcancel",this.reset),this.offTemp()},Qs.prototype.offTemp=function(){n.enableDrag(),n.removeEventListener(e.window,"mousemove",this.mousemove),n.removeEventListener(e.window,"mouseup",this.mouseup)},Qs.prototype.mousedown=function(V){this.down(e.extend({},V,{ctrlKey:!0,preventDefault:function(){return V.preventDefault()}}),n.mousePos(this.element,V)),n.addEventListener(e.window,"mousemove",this.mousemove),n.addEventListener(e.window,"mouseup",this.mouseup)},Qs.prototype.mousemove=function(V){this.move(V,n.mousePos(this.element,V))},Qs.prototype.mouseup=function(V){this.mouseRotate.mouseupWindow(V),this.mousePitch&&this.mousePitch.mouseupWindow(V),this.offTemp()},Qs.prototype.touchstart=function(V){V.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=n.touchPos(this.element,V.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return V.preventDefault()}},this._startPos))},Qs.prototype.touchmove=function(V){V.targetTouches.length!==1?this.reset():(this._lastPos=n.touchPos(this.element,V.targetTouches)[0],this.move({preventDefault:function(){return V.preventDefault()}},this._lastPos))},Qs.prototype.touchend=function(V){V.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},Qs.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};function xu(ce,V,ve){if(ce=new e.LngLat(ce.lng,ce.lat),V){var j=new e.LngLat(ce.lng-360,ce.lat),de=new e.LngLat(ce.lng+360,ce.lat),Me=ve.locationPoint(ce).distSqr(V);ve.locationPoint(j).distSqr(V)<Me?ce=j:ve.locationPoint(de).distSqr(V)<Me&&(ce=de)}for(;Math.abs(ce.lng-ve.center.lng)>180;){var Ce=ve.locationPoint(ce);if(Ce.x>=0&&Ce.y>=0&&Ce.x<=ve.width&&Ce.y<=ve.height)break;ce.lng>ve.center.lng?ce.lng-=360:ce.lng+=360}return ce}var gf={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Ef(ce,V,ve){var j=ce.classList;for(var de in gf)j.remove("mapboxgl-"+ve+"-anchor-"+de);j.add("mapboxgl-"+ve+"-anchor-"+V)}var tf=function(ce){function V(ve,j){var de=this;if(ce.call(this),(ve instanceof e.window.HTMLElement||j)&&(ve=e.extend({element:ve},j)),e.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=ve&&ve.anchor||"center",this._color=ve&&ve.color||"#3FB1CE",this._draggable=ve&&ve.draggable||!1,this._state="inactive",this._rotation=ve&&ve.rotation||0,this._rotationAlignment=ve&&ve.rotationAlignment||"auto",this._pitchAlignment=ve&&ve.pitchAlignment&&ve.pitchAlignment!=="auto"?ve.pitchAlignment:this._rotationAlignment,!ve||!ve.element){this._defaultMarker=!0,this._element=n.create("div"),this._element.setAttribute("aria-label","Map marker");var Me=n.createNS("http://www.w3.org/2000/svg","svg");Me.setAttributeNS(null,"display","block"),Me.setAttributeNS(null,"height","41px"),Me.setAttributeNS(null,"width","27px"),Me.setAttributeNS(null,"viewBox","0 0 27 41");var Ce=n.createNS("http://www.w3.org/2000/svg","g");Ce.setAttributeNS(null,"stroke","none"),Ce.setAttributeNS(null,"stroke-width","1"),Ce.setAttributeNS(null,"fill","none"),Ce.setAttributeNS(null,"fill-rule","evenodd");var Ze=n.createNS("http://www.w3.org/2000/svg","g");Ze.setAttributeNS(null,"fill-rule","nonzero");var ut=n.createNS("http://www.w3.org/2000/svg","g");ut.setAttributeNS(null,"transform","translate(3.0, 29.0)"),ut.setAttributeNS(null,"fill","#000000");for(var St=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}],jt=0,lr=St;jt<lr.length;jt+=1){var vr=lr[jt],Er=n.createNS("http://www.w3.org/2000/svg","ellipse");Er.setAttributeNS(null,"opacity","0.04"),Er.setAttributeNS(null,"cx","10.5"),Er.setAttributeNS(null,"cy","5.80029008"),Er.setAttributeNS(null,"rx",vr.rx),Er.setAttributeNS(null,"ry",vr.ry),ut.appendChild(Er)}var Vr=n.createNS("http://www.w3.org/2000/svg","g");Vr.setAttributeNS(null,"fill",this._color);var Gr=n.createNS("http://www.w3.org/2000/svg","path");Gr.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),Vr.appendChild(Gr);var Ur=n.createNS("http://www.w3.org/2000/svg","g");Ur.setAttributeNS(null,"opacity","0.25"),Ur.setAttributeNS(null,"fill","#000000");var Kr=n.createNS("http://www.w3.org/2000/svg","path");Kr.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),Ur.appendChild(Kr);var cn=n.createNS("http://www.w3.org/2000/svg","g");cn.setAttributeNS(null,"transform","translate(6.0, 7.0)"),cn.setAttributeNS(null,"fill","#FFFFFF");var En=n.createNS("http://www.w3.org/2000/svg","g");En.setAttributeNS(null,"transform","translate(8.0, 8.0)");var Fn=n.createNS("http://www.w3.org/2000/svg","circle");Fn.setAttributeNS(null,"fill","#000000"),Fn.setAttributeNS(null,"opacity","0.25"),Fn.setAttributeNS(null,"cx","5.5"),Fn.setAttributeNS(null,"cy","5.5"),Fn.setAttributeNS(null,"r","5.4999962");var Kn=n.createNS("http://www.w3.org/2000/svg","circle");Kn.setAttributeNS(null,"fill","#FFFFFF"),Kn.setAttributeNS(null,"cx","5.5"),Kn.setAttributeNS(null,"cy","5.5"),Kn.setAttributeNS(null,"r","5.4999962"),En.appendChild(Fn),En.appendChild(Kn),Ze.appendChild(ut),Ze.appendChild(Vr),Ze.appendChild(Ur),Ze.appendChild(cn),Ze.appendChild(En),Me.appendChild(Ze),this._element.appendChild(Me),this._offset=e.Point.convert(ve&&ve.offset||[0,-14])}else this._element=ve.element,this._offset=e.Point.convert(ve&&ve.offset||[0,0]);this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",function(qn){qn.preventDefault()}),this._element.addEventListener("mousedown",function(qn){qn.preventDefault()}),this._element.addEventListener("focus",function(){var qn=de._map.getContainer();qn.scrollTop=0,qn.scrollLeft=0}),Ef(this._element,this._anchor,"marker"),this._popup=null}return ce&&(V.__proto__=ce),V.prototype=Object.create(ce&&ce.prototype),V.prototype.constructor=V,V.prototype.addTo=function(j){return this.remove(),this._map=j,j.getCanvasContainer().appendChild(this._element),j.on("move",this._update),j.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},V.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),n.remove(this._element),this._popup&&this._popup.remove(),this},V.prototype.getLngLat=function(){return this._lngLat},V.prototype.setLngLat=function(j){return this._lngLat=e.LngLat.convert(j),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},V.prototype.getElement=function(){return this._element},V.prototype.setPopup=function(j){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),j){if(!("offset"in j.options)){var de=38.1,Me=13.5,Ce=Math.sqrt(Math.pow(Me,2)/2);j.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-de],"bottom-left":[Ce,(de-Me+Ce)*-1],"bottom-right":[-Ce,(de-Me+Ce)*-1],left:[Me,(de-Me)*-1],right:[-Me,(de-Me)*-1]}:this._offset}this._popup=j,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},V.prototype._onKeyPress=function(j){var de=j.code,Me=j.charCode||j.keyCode;(de==="Space"||de==="Enter"||Me===32||Me===13)&&this.togglePopup()},V.prototype._onMapClick=function(j){var de=j.originalEvent.target,Me=this._element;this._popup&&(de===Me||Me.contains(de))&&this.togglePopup()},V.prototype.getPopup=function(){return this._popup},V.prototype.togglePopup=function(){var j=this._popup;if(j)j.isOpen()?j.remove():j.addTo(this._map);else return this;return this},V.prototype._update=function(j){if(!!this._map){this._map.transform.renderWorldCopies&&(this._lngLat=xu(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var de="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?de="rotateZ("+this._rotation+"deg)":this._rotationAlignment==="map"&&(de="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var Me="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?Me="rotateX(0deg)":this._pitchAlignment==="map"&&(Me="rotateX("+this._map.getPitch()+"deg)"),(!j||j.type==="moveend")&&(this._pos=this._pos.round()),n.setTransform(this._element,gf[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+Me+" "+de)}},V.prototype.getOffset=function(){return this._offset},V.prototype.setOffset=function(j){return this._offset=e.Point.convert(j),this._update(),this},V.prototype._onMove=function(j){this._pos=j.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new e.Event("dragstart"))),this.fire(new e.Event("drag"))},V.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new e.Event("dragend")),this._state="inactive"},V.prototype._addDragHandler=function(j){this._element.contains(j.originalEvent.target)&&(j.preventDefault(),this._positionDelta=j.point.sub(this._pos).add(this._offset),this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},V.prototype.setDraggable=function(j){return this._draggable=!!j,this._map&&(j?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},V.prototype.isDraggable=function(){return this._draggable},V.prototype.setRotation=function(j){return this._rotation=j||0,this._update(),this},V.prototype.getRotation=function(){return this._rotation},V.prototype.setRotationAlignment=function(j){return this._rotationAlignment=j||"auto",this._update(),this},V.prototype.getRotationAlignment=function(){return this._rotationAlignment},V.prototype.setPitchAlignment=function(j){return this._pitchAlignment=j&&j!=="auto"?j:this._rotationAlignment,this._update(),this},V.prototype.getPitchAlignment=function(){return this._pitchAlignment},V}(e.Evented),ec={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},Nu;function yf(ce){Nu!==void 0?ce(Nu):e.window.navigator.permissions!==void 0?e.window.navigator.permissions.query({name:"geolocation"}).then(function(V){Nu=V.state!=="denied",ce(Nu)}):(Nu=!!e.window.navigator.geolocation,ce(Nu))}var rf=0,Uu=!1,tc=function(ce){function V(ve){ce.call(this),this.options=e.extend({},ec,ve),e.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return ce&&(V.__proto__=ce),V.prototype=Object.create(ce&&ce.prototype),V.prototype.constructor=V,V.prototype.onAdd=function(j){return this._map=j,this._container=n.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),yf(this._setupUI),this._container},V.prototype.onRemove=function(){this._geolocationWatchID!==void 0&&(e.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),n.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,rf=0,Uu=!1},V.prototype._isOutOfMapMaxBounds=function(j){var de=this._map.getMaxBounds(),Me=j.coords;return de&&(Me.longitude<de.getWest()||Me.longitude>de.getEast()||Me.latitude<de.getSouth()||Me.latitude>de.getNorth())},V.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break}},V.prototype._onSuccess=function(j){if(!!this._map){if(this._isOutOfMapMaxBounds(j)){this._setErrorState(),this.fire(new e.Event("outofmaxbounds",j)),this._updateMarker(),this._finish();return}if(this.options.trackUserLocation)switch(this._lastKnownPosition=j,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(j),(!this.options.trackUserLocation||this._watchState==="ACTIVE_LOCK")&&this._updateCamera(j),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new e.Event("geolocate",j)),this._finish()}},V.prototype._updateCamera=function(j){var de=new e.LngLat(j.coords.longitude,j.coords.latitude),Me=j.coords.accuracy,Ce=this._map.getBearing(),Ze=e.extend({bearing:Ce},this.options.fitBoundsOptions);this._map.fitBounds(de.toBounds(Me),Ze,{geolocateSource:!0})},V.prototype._updateMarker=function(j){if(j){var de=new e.LngLat(j.coords.longitude,j.coords.latitude);this._accuracyCircleMarker.setLngLat(de).addTo(this._map),this._userLocationDotMarker.setLngLat(de).addTo(this._map),this._accuracy=j.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},V.prototype._updateCircleRadius=function(){var j=this._map._container.clientHeight/2,de=this._map.unproject([0,j]),Me=this._map.unproject([1,j]),Ce=de.distanceTo(Me),Ze=Math.ceil(2*this._accuracy/Ce);this._circleElement.style.width=Ze+"px",this._circleElement.style.height=Ze+"px"},V.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},V.prototype._onError=function(j){if(!!this._map){if(this.options.trackUserLocation)if(j.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var de=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=de,this._geolocateButton.setAttribute("aria-label",de),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(j.code===3&&Uu)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new e.Event("error",j)),this._finish()}},V.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},V.prototype._setupUI=function(j){var de=this;if(this._container.addEventListener("contextmenu",function(Ze){return Ze.preventDefault()}),this._geolocateButton=n.create("button","mapboxgl-ctrl-geolocate",this._container),n.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",j===!1){e.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var Me=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=Me,this._geolocateButton.setAttribute("aria-label",Me)}else{var Ce=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=Ce,this._geolocateButton.setAttribute("aria-label",Ce)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=n.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new tf(this._dotElement),this._circleElement=n.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new tf({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(Ze){var ut=Ze.originalEvent&&Ze.originalEvent.type==="resize";!Ze.geolocateSource&&de._watchState==="ACTIVE_LOCK"&&!ut&&(de._watchState="BACKGROUND",de._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),de._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),de.fire(new e.Event("trackuserlocationend")))})},V.prototype.trigger=function(){if(!this._setup)return e.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new e.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":rf--,Uu=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new e.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new e.Event("trackuserlocationstart"));break}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error");break}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),rf++;var j;rf>1?(j={maximumAge:6e5,timeout:0},Uu=!0):(j=this.options.positionOptions,Uu=!1),this._geolocationWatchID=e.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,j)}}else e.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},V.prototype._clearWatch=function(){e.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},V}(e.Evented),_c={maxWidth:100,unit:"metric"},Hu=function(V){this.options=e.extend({},_c,V),e.bindAll(["_onMove","setUnit"],this)};Hu.prototype.getDefaultPosition=function(){return"bottom-left"},Hu.prototype._onMove=function(){rc(this._map,this._container,this.options)},Hu.prototype.onAdd=function(V){return this._map=V,this._container=n.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",V.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},Hu.prototype.onRemove=function(){n.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},Hu.prototype.setUnit=function(V){this.options.unit=V,rc(this._map,this._container,this.options)};function rc(ce,V,ve){var j=ve&&ve.maxWidth||100,de=ce._container.clientHeight/2,Me=ce.unproject([0,de]),Ce=ce.unproject([j,de]),Ze=Me.distanceTo(Ce);if(ve&&ve.unit==="imperial"){var ut=3.2808*Ze;if(ut>5280){var St=ut/5280;nf(V,j,St,ce._getUIString("ScaleControl.Miles"))}else nf(V,j,ut,ce._getUIString("ScaleControl.Feet"))}else if(ve&&ve.unit==="nautical"){var jt=Ze/1852;nf(V,j,jt,ce._getUIString("ScaleControl.NauticalMiles"))}else Ze>=1e3?nf(V,j,Ze/1e3,ce._getUIString("ScaleControl.Kilometers")):nf(V,j,Ze,ce._getUIString("ScaleControl.Meters"))}function nf(ce,V,ve,j){var de=Tc(ve),Me=de/ve;ce.style.width=V*Me+"px",ce.innerHTML=de+"&nbsp;"+j}function wc(ce){var V=Math.pow(10,Math.ceil(-Math.log(ce)/Math.LN10));return Math.round(ce*V)/V}function Tc(ce){var V=Math.pow(10,(""+Math.floor(ce)).length-1),ve=ce/V;return ve=ve>=10?10:ve>=5?5:ve>=3?3:ve>=2?2:ve>=1?1:wc(ve),V*ve}var Ul=function(V){this._fullscreen=!1,V&&V.container&&(V.container instanceof e.window.HTMLElement?this._container=V.container:e.warnOnce("Full screen control 'container' must be a DOM element.")),e.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in e.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in e.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in e.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in e.window.document&&(this._fullscreenchange="MSFullscreenChange")};Ul.prototype.onAdd=function(V){return this._map=V,this._container||(this._container=this._map.getContainer()),this._controlContainer=n.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",e.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},Ul.prototype.onRemove=function(){n.remove(this._controlContainer),this._map=null,e.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},Ul.prototype._checkFullscreenSupport=function(){return!!(e.window.document.fullscreenEnabled||e.window.document.mozFullScreenEnabled||e.window.document.msFullscreenEnabled||e.window.document.webkitFullscreenEnabled)},Ul.prototype._setupUI=function(){var V=this._fullscreenButton=n.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);n.create("span","mapboxgl-ctrl-icon",V).setAttribute("aria-hidden",!0),V.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),e.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},Ul.prototype._updateTitle=function(){var V=this._getTitle();this._fullscreenButton.setAttribute("aria-label",V),this._fullscreenButton.title=V},Ul.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},Ul.prototype._isFullscreen=function(){return this._fullscreen},Ul.prototype._changeIcon=function(){var V=e.window.document.fullscreenElement||e.window.document.mozFullScreenElement||e.window.document.webkitFullscreenElement||e.window.document.msFullscreenElement;V===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},Ul.prototype._onClickFullscreen=function(){this._isFullscreen()?e.window.document.exitFullscreen?e.window.document.exitFullscreen():e.window.document.mozCancelFullScreen?e.window.document.mozCancelFullScreen():e.window.document.msExitFullscreen?e.window.document.msExitFullscreen():e.window.document.webkitCancelFullScreen&&e.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var Ac={closeButton:!0,closeOnClick:!0,className:"",maxWidth:"240px"},Mc=function(ce){function V(ve){ce.call(this),this.options=e.extend(Object.create(Ac),ve),e.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return ce&&(V.__proto__=ce),V.prototype=Object.create(ce&&ce.prototype),V.prototype.constructor=V,V.prototype.addTo=function(j){return this._map&&this.remove(),this._map=j,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new e.Event("open")),this},V.prototype.isOpen=function(){return!!this._map},V.prototype.remove=function(){return this._content&&n.remove(this._content),this._container&&(n.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new e.Event("close")),this},V.prototype.getLngLat=function(){return this._lngLat},V.prototype.setLngLat=function(j){return this._lngLat=e.LngLat.convert(j),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this},V.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this},V.prototype.getElement=function(){return this._container},V.prototype.setText=function(j){return this.setDOMContent(e.window.document.createTextNode(j))},V.prototype.setHTML=function(j){var de=e.window.document.createDocumentFragment(),Me=e.window.document.createElement("body"),Ce;for(Me.innerHTML=j;Ce=Me.firstChild,!!Ce;)de.appendChild(Ce);return this.setDOMContent(de)},V.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},V.prototype.setMaxWidth=function(j){return this.options.maxWidth=j,this._update(),this},V.prototype.setDOMContent=function(j){return this._createContent(),this._content.appendChild(j),this._update(),this},V.prototype.addClassName=function(j){this._container&&this._container.classList.add(j)},V.prototype.removeClassName=function(j){this._container&&this._container.classList.remove(j)},V.prototype.toggleClassName=function(j){if(this._container)return this._container.classList.toggle(j)},V.prototype._createContent=function(){this._content&&n.remove(this._content),this._content=n.create("div","mapboxgl-popup-content",this._container),this.options.closeButton&&(this._closeButton=n.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},V.prototype._onMouseUp=function(j){this._update(j.point)},V.prototype._onMouseMove=function(j){this._update(j.point)},V.prototype._onDrag=function(j){this._update(j.point)},V.prototype._update=function(j){var de=this,Me=this._lngLat||this._trackPointer;if(!(!this._map||!Me||!this._content)&&(this._container||(this._container=n.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=n.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(Er){return de._container.classList.add(Er)}),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=xu(this._lngLat,this._pos,this._map.transform)),!(this._trackPointer&&!j))){var Ce=this._pos=this._trackPointer&&j?j:this._map.project(this._lngLat),Ze=this.options.anchor,ut=nc(this.options.offset);if(!Ze){var St=this._container.offsetWidth,jt=this._container.offsetHeight,lr;Ce.y+ut.bottom.y<jt?lr=["top"]:Ce.y>this._map.transform.height-jt?lr=["bottom"]:lr=[],Ce.x<St/2?lr.push("left"):Ce.x>this._map.transform.width-St/2&&lr.push("right"),lr.length===0?Ze="bottom":Ze=lr.join("-")}var vr=Ce.add(ut[Ze]).round();n.setTransform(this._container,gf[Ze]+" translate("+vr.x+"px,"+vr.y+"px)"),Ef(this._container,Ze,"popup")}},V.prototype._onClose=function(){this.remove()},V}(e.Evented);function nc(ce){if(ce)if(typeof ce=="number"){var V=Math.round(Math.sqrt(.5*Math.pow(ce,2)));return{center:new e.Point(0,0),top:new e.Point(0,ce),"top-left":new e.Point(V,V),"top-right":new e.Point(-V,V),bottom:new e.Point(0,-ce),"bottom-left":new e.Point(V,-V),"bottom-right":new e.Point(-V,-V),left:new e.Point(ce,0),right:new e.Point(-ce,0)}}else if(ce instanceof e.Point||Array.isArray(ce)){var ve=e.Point.convert(ce);return{center:ve,top:ve,"top-left":ve,"top-right":ve,bottom:ve,"bottom-left":ve,"bottom-right":ve,left:ve,right:ve}}else return{center:e.Point.convert(ce.center||[0,0]),top:e.Point.convert(ce.top||[0,0]),"top-left":e.Point.convert(ce["top-left"]||[0,0]),"top-right":e.Point.convert(ce["top-right"]||[0,0]),bottom:e.Point.convert(ce.bottom||[0,0]),"bottom-left":e.Point.convert(ce["bottom-left"]||[0,0]),"bottom-right":e.Point.convert(ce["bottom-right"]||[0,0]),left:e.Point.convert(ce.left||[0,0]),right:e.Point.convert(ce.right||[0,0])};else return nc(new e.Point(0,0))}var Sc={version:e.version,supported:a,setRTLTextPlugin:e.setRTLTextPlugin,getRTLTextPluginStatus:e.getRTLTextPluginStatus,Map:qf,NavigationControl:mu,GeolocateControl:tc,AttributionControl:Al,ScaleControl:Hu,FullscreenControl:Ul,Popup:Mc,Marker:tf,Style:jo,LngLat:e.LngLat,LngLatBounds:e.LngLatBounds,Point:e.Point,MercatorCoordinate:e.MercatorCoordinate,Evented:e.Evented,config:e.config,prewarm:ir,clearPrewarmedResources:kr,get accessToken(){return e.config.ACCESS_TOKEN},set accessToken(ce){e.config.ACCESS_TOKEN=ce},get baseApiUrl(){return e.config.API_URL},set baseApiUrl(ce){e.config.API_URL=ce},get workerCount(){return At.workerCount},set workerCount(ce){At.workerCount=ce},get maxParallelImageRequests(){return e.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(ce){e.config.MAX_PARALLEL_IMAGE_REQUESTS=ce},clearStorage:function(V){e.clearTileCache(V)},workerUrl:""};return Sc}),S})},{}],240:[function(d,ee,te){ee.exports=Math.log2||function(w){return Math.log(w)*Math.LOG2E}},{}],241:[function(d,ee,te){ee.exports=v;var w=d("mouse-event");function v(S,M){M||(M=S,S=window);var e=0,a=0,n=0,r={shift:!1,alt:!1,control:!1,meta:!1},t=!1;function c(A){var b=!1;return"altKey"in A&&(b=b||A.altKey!==r.alt,r.alt=!!A.altKey),"shiftKey"in A&&(b=b||A.shiftKey!==r.shift,r.shift=!!A.shiftKey),"ctrlKey"in A&&(b=b||A.ctrlKey!==r.control,r.control=!!A.ctrlKey),"metaKey"in A&&(b=b||A.metaKey!==r.meta,r.meta=!!A.metaKey),b}function o(A,b){var f=w.x(b),x=w.y(b);"buttons"in b&&(A=b.buttons|0),(A!==e||f!==a||x!==n||c(b))&&(e=A|0,a=f||0,n=x||0,M&&M(e,a,n,r))}function i(A){o(0,A)}function y(){(e||a||n||r.shift||r.alt||r.meta||r.control)&&(a=n=0,e=0,r.shift=r.alt=r.control=r.meta=!1,M&&M(0,0,0,r))}function p(A){c(A)&&M&&M(e,a,n,r)}function g(A){w.buttons(A)===0?o(0,A):o(e,A)}function h(A){o(e|w.buttons(A),A)}function m(A){o(e&~w.buttons(A),A)}function u(){t||(t=!0,S.addEventListener("mousemove",g),S.addEventListener("mousedown",h),S.addEventListener("mouseup",m),S.addEventListener("mouseleave",i),S.addEventListener("mouseenter",i),S.addEventListener("mouseout",i),S.addEventListener("mouseover",i),S.addEventListener("blur",y),S.addEventListener("keyup",p),S.addEventListener("keydown",p),S.addEventListener("keypress",p),S!==window&&(window.addEventListener("blur",y),window.addEventListener("keyup",p),window.addEventListener("keydown",p),window.addEventListener("keypress",p)))}function _(){!t||(t=!1,S.removeEventListener("mousemove",g),S.removeEventListener("mousedown",h),S.removeEventListener("mouseup",m),S.removeEventListener("mouseleave",i),S.removeEventListener("mouseenter",i),S.removeEventListener("mouseout",i),S.removeEventListener("mouseover",i),S.removeEventListener("blur",y),S.removeEventListener("keyup",p),S.removeEventListener("keydown",p),S.removeEventListener("keypress",p),S!==window&&(window.removeEventListener("blur",y),window.removeEventListener("keyup",p),window.removeEventListener("keydown",p),window.removeEventListener("keypress",p)))}u();var s={element:S};return Object.defineProperties(s,{enabled:{get:function(){return t},set:function(A){A?u():_()},enumerable:!0},buttons:{get:function(){return e},enumerable:!0},x:{get:function(){return a},enumerable:!0},y:{get:function(){return n},enumerable:!0},mods:{get:function(){return r},enumerable:!0}}),s}},{"mouse-event":243}],242:[function(d,ee,te){var w={left:0,top:0};ee.exports=v;function v(M,e,a){e=e||M.currentTarget||M.srcElement,Array.isArray(a)||(a=[0,0]);var n=M.clientX||0,r=M.clientY||0,t=S(e);return a[0]=n-t.left,a[1]=r-t.top,a}function S(M){return M===window||M===document||M===document.body?w:M.getBoundingClientRect()}},{}],243:[function(d,ee,te){function w(e){if(typeof e=="object"){if("buttons"in e)return e.buttons;if("which"in e){var a=e.which;if(a===2)return 4;if(a===3)return 2;if(a>0)return 1<<a-1}else if("button"in e){var a=e.button;if(a===1)return 4;if(a===2)return 2;if(a>=0)return 1<<a}}return 0}te.buttons=w;function v(e){return e.target||e.srcElement||window}te.element=v;function S(e){if(typeof e=="object"){if("offsetX"in e)return e.offsetX;var a=v(e),n=a.getBoundingClientRect();return e.clientX-n.left}return 0}te.x=S;function M(e){if(typeof e=="object"){if("offsetY"in e)return e.offsetY;var a=v(e),n=a.getBoundingClientRect();return e.clientY-n.top}return 0}te.y=M},{}],244:[function(d,ee,te){var w=d("to-px");ee.exports=v;function v(S,M,e){typeof S=="function"&&(e=!!M,M=S,S=window);var a=w("ex",S),n=function(r){e&&r.preventDefault();var t=r.deltaX||0,c=r.deltaY||0,o=r.deltaZ||0,i=r.deltaMode,y=1;switch(i){case 1:y=a;break;case 2:y=window.innerHeight;break}if(t*=y,c*=y,o*=y,t||c||o)return M(t,c,o,r)};return S.addEventListener("wheel",n),n}},{"to-px":315}],245:[function(d,ee,te){(function(w,v){(function(){/*! Native Promise Only
    v0.8.1 (c) Kyle Simpson
    MIT License: http://getify.mit-license.org
*/(function(M,e,a){e[M]=e[M]||a(),typeof ee<"u"&&ee.exports&&(ee.exports=e[M])})("Promise",typeof w<"u"?w:this,function(){var M,e,a,n=Object.prototype.toString,r=typeof v<"u"?function(A){return v(A)}:setTimeout;try{Object.defineProperty({},"x",{}),M=function(A,b,f,x){return Object.defineProperty(A,b,{value:f,writable:!0,configurable:x!==!1})}}catch{M=function(b,f,x){return b[f]=x,b}}a=function(){var A,b,f;function x(l,L){this.fn=l,this.self=L,this.next=void 0}return{add:function(L,T){f=new x(L,T),b?b.next=f:A=f,b=f,f=void 0},drain:function(){var L=A;for(A=b=e=void 0;L;)L.fn.call(L.self),L=L.next}}}();function t(s,A){a.add(s,A),e||(e=r(a.drain))}function c(s){var A,b=typeof s;return s!=null&&(b=="object"||b=="function")&&(A=s.then),typeof A=="function"?A:!1}function o(){for(var s=0;s<this.chain.length;s++)i(this,this.state===1?this.chain[s].success:this.chain[s].failure,this.chain[s]);this.chain.length=0}function i(s,A,b){var f,x;try{A===!1?b.reject(s.msg):(A===!0?f=s.msg:f=A.call(void 0,s.msg),f===b.promise?b.reject(TypeError("Promise-chain cycle")):(x=c(f))?x.call(f,b.resolve,b.reject):b.resolve(f))}catch(l){b.reject(l)}}function y(s){var A,b=this;if(!b.triggered){b.triggered=!0,b.def&&(b=b.def);try{(A=c(s))?t(function(){var f=new h(b);try{A.call(s,function(){y.apply(f,arguments)},function(){p.apply(f,arguments)})}catch(x){p.call(f,x)}}):(b.msg=s,b.state=1,b.chain.length>0&&t(o,b))}catch(f){p.call(new h(b),f)}}}function p(s){var A=this;A.triggered||(A.triggered=!0,A.def&&(A=A.def),A.msg=s,A.state=2,A.chain.length>0&&t(o,A))}function g(s,A,b,f){for(var x=0;x<A.length;x++)(function(L){s.resolve(A[L]).then(function(k){b(L,k)},f)})(x)}function h(s){this.def=s,this.triggered=!1}function m(s){this.promise=s,this.state=0,this.triggered=!1,this.chain=[],this.msg=void 0}function u(s){if(typeof s!="function")throw TypeError("Not a function");if(this.__NPO__!==0)throw TypeError("Not a promise");this.__NPO__=1;var A=new m(this);this.then=function(f,x){var l={success:typeof f=="function"?f:!0,failure:typeof x=="function"?x:!1};return l.promise=new this.constructor(function(T,k){if(typeof T!="function"||typeof k!="function")throw TypeError("Not a function");l.resolve=T,l.reject=k}),A.chain.push(l),A.state!==0&&t(o,A),l.promise},this.catch=function(f){return this.then(void 0,f)};try{s.call(void 0,function(f){y.call(A,f)},function(f){p.call(A,f)})}catch(b){p.call(A,b)}}var _=M({},"constructor",u,!1);return u.prototype=_,M(_,"__NPO__",0,!1),M(u,"resolve",function(A){var b=this;return A&&typeof A=="object"&&A.__NPO__===1?A:new b(function(x,l){if(typeof x!="function"||typeof l!="function")throw TypeError("Not a function");x(A)})}),M(u,"reject",function(A){return new this(function(f,x){if(typeof f!="function"||typeof x!="function")throw TypeError("Not a function");x(A)})}),M(u,"all",function(A){var b=this;return n.call(A)!="[object Array]"?b.reject(TypeError("Not an array")):A.length===0?b.resolve([]):new b(function(x,l){if(typeof x!="function"||typeof l!="function")throw TypeError("Not a function");var L=A.length,T=Array(L),k=0;g(b,A,function(z,I){T[z]=I,++k===L&&x(T)},l)})}),M(u,"race",function(A){var b=this;return n.call(A)!="[object Array]"?b.reject(TypeError("Not an array")):new b(function(x,l){if(typeof x!="function"||typeof l!="function")throw TypeError("Not a function");g(b,A,function(T,k){x(k)},l)})}),u})}).call(this)}).call(this,typeof To<"u"?To:typeof self<"u"?self:typeof window<"u"?window:{},d("timers").setImmediate)},{timers:312}],246:[function(d,ee,te){var w=Math.PI,v=r(120);ee.exports=S;function S(t){for(var c,o=[],i=0,y=0,p=0,g=0,h=null,m=null,u=0,_=0,s=0,A=t.length;s<A;s++){var b=t[s],f=b[0];switch(f){case"M":p=b[1],g=b[2];break;case"A":b=a(u,_,b[1],b[2],r(b[3]),b[4],b[5],b[6],b[7]),b.unshift("C"),b.length>7&&(o.push(b.splice(0,7)),b.unshift("C"));break;case"S":var x=u,l=_;(c=="C"||c=="S")&&(x+=x-i,l+=l-y),b=["C",x,l,b[1],b[2],b[3],b[4]];break;case"T":c=="Q"||c=="T"?(h=u*2-h,m=_*2-m):(h=u,m=_),b=e(u,_,h,m,b[1],b[2]);break;case"Q":h=b[1],m=b[2],b=e(u,_,b[1],b[2],b[3],b[4]);break;case"L":b=M(u,_,b[1],b[2]);break;case"H":b=M(u,_,b[1],_);break;case"V":b=M(u,_,u,b[1]);break;case"Z":b=M(u,_,p,g);break}c=f,u=b[b.length-2],_=b[b.length-1],b.length>4?(i=b[b.length-4],y=b[b.length-3]):(i=u,y=_),o.push(b)}return o}function M(t,c,o,i){return["C",t,c,o,i,o,i]}function e(t,c,o,i,y,p){return["C",t/3+2/3*o,c/3+2/3*i,y/3+2/3*o,p/3+2/3*i,y,p]}function a(t,c,o,i,y,p,g,h,m,u){if(u)k=u[0],P=u[1],L=u[2],T=u[3];else{var _=n(t,c,-y);t=_.x,c=_.y,_=n(h,m,-y),h=_.x,m=_.y;var s=(t-h)/2,A=(c-m)/2,b=s*s/(o*o)+A*A/(i*i);b>1&&(b=Math.sqrt(b),o=b*o,i=b*i);var f=o*o,x=i*i,l=(p==g?-1:1)*Math.sqrt(Math.abs((f*x-f*A*A-x*s*s)/(f*A*A+x*s*s)));l==1/0&&(l=1);var L=l*o*A/i+(t+h)/2,T=l*-i*s/o+(c+m)/2,k=Math.asin(((c-T)/i).toFixed(9)),P=Math.asin(((m-T)/i).toFixed(9));k=t<L?w-k:k,P=h<L?w-P:P,k<0&&(k=w*2+k),P<0&&(P=w*2+P),g&&k>P&&(k=k-w*2),!g&&P>k&&(P=P-w*2)}if(Math.abs(P-k)>v){var z=P,I=h,D=m;P=k+v*(g&&P>k?1:-1),h=L+o*Math.cos(P),m=T+i*Math.sin(P);var R=a(h,m,o,i,y,0,g,I,D,[P,z,L,T])}var B=Math.tan((P-k)/4),F=4/3*o*B,H=4/3*i*B,G=[2*t-(t+F*Math.sin(k)),2*c-(c-H*Math.cos(k)),h+F*Math.sin(P),m-H*Math.cos(P),h,m];if(u)return G;R&&(G=G.concat(R));for(var J=0;J<G.length;){var X=n(G[J],G[J+1],y);G[J++]=X.x,G[J++]=X.y}return G}function n(t,c,o){return{x:t*Math.cos(o)-c*Math.sin(o),y:t*Math.sin(o)+c*Math.cos(o)}}function r(t){return t*(w/180)}},{}],247:[function(d,ee,te){var w=Object.getOwnPropertySymbols,v=Object.prototype.hasOwnProperty,S=Object.prototype.propertyIsEnumerable;function M(a){if(a==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(a)}function e(){try{if(!Object.assign)return!1;var a=new String("abc");if(a[5]="de",Object.getOwnPropertyNames(a)[0]==="5")return!1;for(var n={},r=0;r<10;r++)n["_"+String.fromCharCode(r)]=r;var t=Object.getOwnPropertyNames(n).map(function(o){return n[o]});if(t.join("")!=="0123456789")return!1;var c={};return"abcdefghijklmnopqrst".split("").forEach(function(o){c[o]=o}),Object.keys(Object.assign({},c)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}ee.exports=e()?Object.assign:function(a,n){for(var r,t=M(a),c,o=1;o<arguments.length;o++){r=Object(arguments[o]);for(var i in r)v.call(r,i)&&(t[i]=r[i]);if(w){c=w(r);for(var y=0;y<c.length;y++)S.call(r,c[y])&&(t[c[y]]=r[c[y]])}}return t}},{}],248:[function(d,ee,te){function w(M,e){if(typeof M!="string")return[M];var a=[M];typeof e=="string"||Array.isArray(e)?e={brackets:e}:e||(e={});var n=e.brackets?Array.isArray(e.brackets)?e.brackets:[e.brackets]:["{}","[]","()"],r=e.escape||"___",t=!!e.flat;n.forEach(function(i){var y=new RegExp(["\\",i[0],"[^\\",i[0],"\\",i[1],"]*\\",i[1]].join("")),p=[];function g(h,m,u){var _=a.push(h.slice(i[0].length,-i[1].length))-1;return p.push(_),r+_+r}a.forEach(function(h,m){for(var u,_=0;h!=u;)if(u=h,h=h.replace(y,g),_++>1e4)throw Error("References have circular dependency. Please, check them.");a[m]=h}),p=p.reverse(),a=a.map(function(h){return p.forEach(function(m){h=h.replace(new RegExp("(\\"+r+m+"\\"+r+")","g"),i[0]+"$1"+i[1])}),h})});var c=new RegExp("\\"+r+"([0-9]+)\\"+r);function o(i,y,p){for(var g=[],h,m=0;h=c.exec(i);){if(m++>1e4)throw Error("Circular references in parenthesis");g.push(i.slice(0,h.index)),g.push(o(y[h[1]],y)),i=i.slice(h.index+h[0].length)}return g.push(i),g}return t?a:o(a[0],a)}function v(M,e){if(e&&e.flat){var a=e&&e.escape||"___",n=M[0],r;if(!n)return"";for(var t=new RegExp("\\"+a+"([0-9]+)\\"+a),c=0;n!=r;){if(c++>1e4)throw Error("Circular references in "+M);r=n,n=n.replace(t,o)}return n}return M.reduce(function i(y,p){return Array.isArray(p)&&(p=p.reduce(i,"")),y+p},"");function o(i,y){if(M[y]==null)throw Error("Reference "+y+"is undefined");return M[y]}}function S(M,e){return Array.isArray(M)?v(M,e):w(M,e)}S.parse=w,S.stringify=v,ee.exports=S},{}],249:[function(d,ee,te){var w=d("pick-by-alias");ee.exports=v;function v(S){var M;return arguments.length>1&&(S=arguments),typeof S=="string"?S=S.split(/\s/).map(parseFloat):typeof S=="number"&&(S=[S]),S.length&&typeof S[0]=="number"?S.length===1?M={width:S[0],height:S[0],x:0,y:0}:S.length===2?M={width:S[0],height:S[1],x:0,y:0}:M={x:S[0],y:S[1],width:S[2]-S[0]||0,height:S[3]-S[1]||0}:S&&(S=w(S,{left:"x l left Left",top:"y t top Top",width:"w width W Width",height:"h height W Width",bottom:"b bottom Bottom",right:"r right Right"}),M={x:S.left||0,y:S.top||0},S.width==null?S.right?M.width=S.right-M.x:M.width=0:M.width=S.width,S.height==null?S.bottom?M.height=S.bottom-M.y:M.height=0:M.height=S.height),M}},{"pick-by-alias":253}],250:[function(d,ee,te){ee.exports=S;var w={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},v=/([astvzqmhlc])([^astvzqmhlc]*)/ig;function S(a){var n=[];return a.replace(v,function(r,t,c){var o=t.toLowerCase();for(c=e(c),o=="m"&&c.length>2&&(n.push([t].concat(c.splice(0,2))),o="l",t=t=="m"?"l":"L");;){if(c.length==w[o])return c.unshift(t),n.push(c);if(c.length<w[o])throw new Error("malformed path data");n.push([t].concat(c.splice(0,w[o])))}}),n}var M=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/ig;function e(a){var n=a.match(M);return n?n.map(Number):[]}},{}],251:[function(d,ee,te){ee.exports=function(v,S){S||(S=[0,""]),v=String(v);var M=parseFloat(v,10);return S[0]=M,S[1]=v.match(/[\d.\-\+]*\s*(.*)/)[1]||"",S}},{}],252:[function(d,ee,te){(function(w){(function(){(function(){var v,S,M,e,a,n;typeof performance<"u"&&performance!==null&&performance.now?ee.exports=function(){return performance.now()}:typeof w<"u"&&w!==null&&w.hrtime?(ee.exports=function(){return(v()-a)/1e6},S=w.hrtime,v=function(){var r;return r=S(),r[0]*1e9+r[1]},e=v(),n=w.uptime()*1e9,a=e-n):Date.now?(ee.exports=function(){return Date.now()-M},M=Date.now()):(ee.exports=function(){return new Date().getTime()-M},M=new Date().getTime())}).call(this)}).call(this)}).call(this,d("_process"))},{_process:278}],253:[function(d,ee,te){ee.exports=function(M,e,a){var n={},r,t;if(typeof e=="string"&&(e=v(e)),Array.isArray(e)){var c={};for(t=0;t<e.length;t++)c[e[t]]=!0;e=c}for(r in e)e[r]=v(e[r]);var o={};for(r in e){var i=e[r];if(Array.isArray(i))for(t=0;t<i.length;t++){var y=i[t];if(a&&(o[y]=!0),y in M){if(n[r]=M[y],a)for(var p=t;p<i.length;p++)o[i[p]]=!0;break}}else r in M&&(e[r]&&(n[r]=M[r]),a&&(o[r]=!0))}if(a)for(r in M)o[r]||(n[r]=M[r]);return n};var w={};function v(S){return w[S]?w[S]:(typeof S=="string"&&(S=w[S]=S.split(/\s*,\s*|\s+/)),S)}},{}],254:[function(d,ee,te){ee.exports=function(v,S,M,e){var a=v[0],n=v[1],r=!1;M===void 0&&(M=0),e===void 0&&(e=S.length);for(var t=e-M,c=0,o=t-1;c<t;o=c++){var i=S[c+M][0],y=S[c+M][1],p=S[o+M][0],g=S[o+M][1],h=y>n!=g>n&&a<(p-i)*(n-y)/(g-y)+i;h&&(r=!r)}return r}},{}],255:[function(d,ee,te){/*
 * @copyright 2016 Sean Connelly (@voidqk), http://syntheti.cc
 * @license MIT
 * @preserve Project Home: https://github.com/voidqk/polybooljs
 */var w=d("./lib/build-log"),v=d("./lib/epsilon"),S=d("./lib/intersecter"),M=d("./lib/segment-chainer"),e=d("./lib/segment-selector"),a=d("./lib/geojson"),n=!1,r=v(),t;t={buildLog:function(o){return o===!0?n=w():o===!1&&(n=!1),n===!1?!1:n.list},epsilon:function(o){return r.epsilon(o)},segments:function(o){var i=S(!0,r,n);return o.regions.forEach(i.addRegion),{segments:i.calculate(o.inverted),inverted:o.inverted}},combine:function(o,i){var y=S(!1,r,n);return{combined:y.calculate(o.segments,o.inverted,i.segments,i.inverted),inverted1:o.inverted,inverted2:i.inverted}},selectUnion:function(o){return{segments:e.union(o.combined,n),inverted:o.inverted1||o.inverted2}},selectIntersect:function(o){return{segments:e.intersect(o.combined,n),inverted:o.inverted1&&o.inverted2}},selectDifference:function(o){return{segments:e.difference(o.combined,n),inverted:o.inverted1&&!o.inverted2}},selectDifferenceRev:function(o){return{segments:e.differenceRev(o.combined,n),inverted:!o.inverted1&&o.inverted2}},selectXor:function(o){return{segments:e.xor(o.combined,n),inverted:o.inverted1!==o.inverted2}},polygon:function(o){return{regions:M(o.segments,r,n),inverted:o.inverted}},polygonFromGeoJSON:function(o){return a.toPolygon(t,o)},polygonToGeoJSON:function(o){return a.fromPolygon(t,r,o)},union:function(o,i){return c(o,i,t.selectUnion)},intersect:function(o,i){return c(o,i,t.selectIntersect)},difference:function(o,i){return c(o,i,t.selectDifference)},differenceRev:function(o,i){return c(o,i,t.selectDifferenceRev)},xor:function(o,i){return c(o,i,t.selectXor)}};function c(o,i,y){var p=t.segments(o),g=t.segments(i),h=t.combine(p,g),m=y(h);return t.polygon(m)}typeof window=="object"&&(window.PolyBool=t),ee.exports=t},{"./lib/build-log":256,"./lib/epsilon":257,"./lib/geojson":258,"./lib/intersecter":259,"./lib/segment-chainer":261,"./lib/segment-selector":262}],256:[function(d,ee,te){function w(){var v,S=0,M=!1;function e(a,n){return v.list.push({type:a,data:n?JSON.parse(JSON.stringify(n)):void 0}),v}return v={list:[],segmentId:function(){return S++},checkIntersection:function(a,n){return e("check",{seg1:a,seg2:n})},segmentChop:function(a,n){return e("div_seg",{seg:a,pt:n}),e("chop",{seg:a,pt:n})},statusRemove:function(a){return e("pop_seg",{seg:a})},segmentUpdate:function(a){return e("seg_update",{seg:a})},segmentNew:function(a,n){return e("new_seg",{seg:a,primary:n})},segmentRemove:function(a){return e("rem_seg",{seg:a})},tempStatus:function(a,n,r){return e("temp_status",{seg:a,above:n,below:r})},rewind:function(a){return e("rewind",{seg:a})},status:function(a,n,r){return e("status",{seg:a,above:n,below:r})},vert:function(a){return a===M?v:(M=a,e("vert",{x:a}))},log:function(a){return typeof a!="string"&&(a=JSON.stringify(a,!1,"  ")),e("log",{txt:a})},reset:function(){return e("reset")},selected:function(a){return e("selected",{segs:a})},chainStart:function(a){return e("chain_start",{seg:a})},chainRemoveHead:function(a,n){return e("chain_rem_head",{index:a,pt:n})},chainRemoveTail:function(a,n){return e("chain_rem_tail",{index:a,pt:n})},chainNew:function(a,n){return e("chain_new",{pt1:a,pt2:n})},chainMatch:function(a){return e("chain_match",{index:a})},chainClose:function(a){return e("chain_close",{index:a})},chainAddHead:function(a,n){return e("chain_add_head",{index:a,pt:n})},chainAddTail:function(a,n){return e("chain_add_tail",{index:a,pt:n})},chainConnect:function(a,n){return e("chain_con",{index1:a,index2:n})},chainReverse:function(a){return e("chain_rev",{index:a})},chainJoin:function(a,n){return e("chain_join",{index1:a,index2:n})},done:function(){return e("done")}},v}ee.exports=w},{}],257:[function(d,ee,te){function w(v){typeof v!="number"&&(v=1e-10);var S={epsilon:function(M){return typeof M=="number"&&(v=M),v},pointAboveOrOnLine:function(M,e,a){var n=e[0],r=e[1],t=a[0],c=a[1],o=M[0],i=M[1];return(t-n)*(i-r)-(c-r)*(o-n)>=-v},pointBetween:function(M,e,a){var n=M[1]-e[1],r=a[0]-e[0],t=M[0]-e[0],c=a[1]-e[1],o=t*r+n*c;if(o<v)return!1;var i=r*r+c*c;return!(o-i>-v)},pointsSameX:function(M,e){return Math.abs(M[0]-e[0])<v},pointsSameY:function(M,e){return Math.abs(M[1]-e[1])<v},pointsSame:function(M,e){return S.pointsSameX(M,e)&&S.pointsSameY(M,e)},pointsCompare:function(M,e){return S.pointsSameX(M,e)?S.pointsSameY(M,e)?0:M[1]<e[1]?-1:1:M[0]<e[0]?-1:1},pointsCollinear:function(M,e,a){var n=M[0]-e[0],r=M[1]-e[1],t=e[0]-a[0],c=e[1]-a[1];return Math.abs(n*c-t*r)<v},linesIntersect:function(M,e,a,n){var r=e[0]-M[0],t=e[1]-M[1],c=n[0]-a[0],o=n[1]-a[1],i=r*o-t*c;if(Math.abs(i)<v)return!1;var y=M[0]-a[0],p=M[1]-a[1],g=(c*p-o*y)/i,h=(r*p-t*y)/i,m={alongA:0,alongB:0,pt:[M[0]+g*r,M[1]+g*t]};return g<=-v?m.alongA=-2:g<v?m.alongA=-1:g-1<=-v?m.alongA=0:g-1<v?m.alongA=1:m.alongA=2,h<=-v?m.alongB=-2:h<v?m.alongB=-1:h-1<=-v?m.alongB=0:h-1<v?m.alongB=1:m.alongB=2,m},pointInsideRegion:function(M,e){for(var a=M[0],n=M[1],r=e[e.length-1][0],t=e[e.length-1][1],c=!1,o=0;o<e.length;o++){var i=e[o][0],y=e[o][1];y-n>v!=t-n>v&&(r-i)*(n-y)/(t-y)+i-a>v&&(c=!c),r=i,t=y}return c}};return S}ee.exports=w},{}],258:[function(d,ee,te){var w={toPolygon:function(v,S){function M(n){if(n.length<=0)return v.segments({inverted:!1,regions:[]});function r(o){var i=o.slice(0,o.length-1);return v.segments({inverted:!1,regions:[i]})}for(var t=r(n[0]),c=1;c<n.length;c++)t=v.selectDifference(v.combine(t,r(n[c])));return t}if(S.type==="Polygon")return v.polygon(M(S.coordinates));if(S.type==="MultiPolygon"){for(var e=v.segments({inverted:!1,regions:[]}),a=0;a<S.coordinates.length;a++)e=v.selectUnion(v.combine(e,M(S.coordinates[a])));return v.polygon(e)}throw new Error("PolyBool: Cannot convert GeoJSON object to PolyBool polygon")},fromPolygon:function(v,S,M){M=v.polygon(v.segments(M));function e(g,h){return S.pointInsideRegion([(g[0][0]+g[1][0])*.5,(g[0][1]+g[1][1])*.5],h)}function a(g){return{region:g,children:[]}}var n=a(null);function r(g,h){for(var m=0;m<g.children.length;m++){var u=g.children[m];if(e(h,u.region)){r(u,h);return}}for(var _=a(h),m=0;m<g.children.length;m++){var u=g.children[m];e(u.region,h)&&(_.children.push(u),g.children.splice(m,1),m--)}g.children.push(_)}for(var t=0;t<M.regions.length;t++){var c=M.regions[t];c.length<3||r(n,c)}function o(g,h){for(var m=0,u=g[g.length-1][0],_=g[g.length-1][1],s=[],A=0;A<g.length;A++){var b=g[A][0],f=g[A][1];s.push([b,f]),m+=f*u-b*_,u=b,_=f}var x=m<0;return x!==h&&s.reverse(),s.push([s[0][0],s[0][1]]),s}var i=[];function y(g){var h=[o(g.region,!1)];i.push(h);for(var m=0;m<g.children.length;m++)h.push(p(g.children[m]))}function p(g){for(var h=0;h<g.children.length;h++)y(g.children[h]);return o(g.region,!0)}for(var t=0;t<n.children.length;t++)y(n.children[t]);return i.length<=0?{type:"Polygon",coordinates:[]}:i.length==1?{type:"Polygon",coordinates:i[0]}:{type:"MultiPolygon",coordinates:i}}};ee.exports=w},{}],259:[function(d,ee,te){var w=d("./linked-list");function v(S,M,e){function a(m,u){return{id:e?e.segmentId():-1,start:m,end:u,myFill:{above:null,below:null},otherFill:null}}function n(m,u,_){return{id:e?e.segmentId():-1,start:m,end:u,myFill:{above:_.myFill.above,below:_.myFill.below},otherFill:null}}var r=w.create();function t(m,u,_,s,A,b){var f=M.pointsCompare(u,A);return f!==0?f:M.pointsSame(_,b)?0:m!==s?m?1:-1:M.pointAboveOrOnLine(_,s?A:b,s?b:A)?1:-1}function c(m,u){r.insertBefore(m,function(_){var s=t(m.isStart,m.pt,u,_.isStart,_.pt,_.other.pt);return s<0})}function o(m,u){var _=w.node({isStart:!0,pt:m.start,seg:m,primary:u,other:null,status:null});return c(_,m.end),_}function i(m,u,_){var s=w.node({isStart:!1,pt:u.end,seg:u,primary:_,other:m,status:null});m.other=s,c(s,m.pt)}function y(m,u){var _=o(m,u);return i(_,m,u),_}function p(m,u){e&&e.segmentChop(m.seg,u),m.other.remove(),m.seg.end=u,m.other.pt=u,c(m.other,m.pt)}function g(m,u){var _=n(u,m.seg.end,m.seg);return p(m,u),y(_,m.primary)}function h(m,u){var _=w.create();function s(R,B){var F=R.seg.start,H=R.seg.end,G=B.seg.start,J=B.seg.end;return M.pointsCollinear(F,G,J)?M.pointsCollinear(H,G,J)||M.pointAboveOrOnLine(H,G,J)?1:-1:M.pointAboveOrOnLine(F,G,J)?1:-1}function A(R){return _.findTransition(function(B){var F=s(R,B.ev);return F>0})}function b(R,B){var F=R.seg,H=B.seg,G=F.start,J=F.end,X=H.start,Y=H.end;e&&e.checkIntersection(F,H);var Z=M.linesIntersect(G,J,X,Y);if(Z===!1){if(!M.pointsCollinear(G,J,X)||M.pointsSame(G,Y)||M.pointsSame(J,X))return!1;var oe=M.pointsSame(G,X),re=M.pointsSame(J,Y);if(oe&&re)return B;var se=!oe&&M.pointBetween(G,X,Y),N=!re&&M.pointBetween(J,X,Y);if(oe)return N?g(B,J):g(R,Y),B;se&&(re||(N?g(B,J):g(R,Y)),g(B,G))}else Z.alongA===0&&(Z.alongB===-1?g(R,X):Z.alongB===0?g(R,Z.pt):Z.alongB===1&&g(R,Y)),Z.alongB===0&&(Z.alongA===-1?g(B,G):Z.alongA===0?g(B,Z.pt):Z.alongA===1&&g(B,J));return!1}for(var f=[];!r.isEmpty();){var x=r.getHead();if(e&&e.vert(x.pt[0]),x.isStart){let R=function(){if(L){var B=b(x,L);if(B)return B}return T?b(x,T):!1};e&&e.segmentNew(x.seg,x.primary);var l=A(x),L=l.before?l.before.ev:null,T=l.after?l.after.ev:null;e&&e.tempStatus(x.seg,L?L.seg:!1,T?T.seg:!1);var k=R();if(k){if(S){var P;x.seg.myFill.below===null?P=!0:P=x.seg.myFill.above!==x.seg.myFill.below,P&&(k.seg.myFill.above=!k.seg.myFill.above)}else k.seg.otherFill=x.seg.myFill;e&&e.segmentUpdate(k.seg),x.other.remove(),x.remove()}if(r.getHead()!==x){e&&e.rewind(x.seg);continue}if(S){var P;x.seg.myFill.below===null?P=!0:P=x.seg.myFill.above!==x.seg.myFill.below,T?x.seg.myFill.below=T.seg.myFill.above:x.seg.myFill.below=m,P?x.seg.myFill.above=!x.seg.myFill.below:x.seg.myFill.above=x.seg.myFill.below}else if(x.seg.otherFill===null){var z;T?x.primary===T.primary?z=T.seg.otherFill.above:z=T.seg.myFill.above:z=x.primary?u:m,x.seg.otherFill={above:z,below:z}}e&&e.status(x.seg,L?L.seg:!1,T?T.seg:!1),x.other.status=l.insert(w.node({ev:x}))}else{var I=x.status;if(I===null)throw new Error("PolyBool: Zero-length segment detected; your epsilon is probably too small or too large");if(_.exists(I.prev)&&_.exists(I.next)&&b(I.prev.ev,I.next.ev),e&&e.statusRemove(I.ev.seg),I.remove(),!x.primary){var D=x.seg.myFill;x.seg.myFill=x.seg.otherFill,x.seg.otherFill=D}f.push(x.seg)}r.getHead().remove()}return e&&e.done(),f}return S?{addRegion:function(m){for(var u,_=m[m.length-1],s=0;s<m.length;s++){u=_,_=m[s];var A=M.pointsCompare(u,_);A!==0&&y(a(A<0?u:_,A<0?_:u),!0)}},calculate:function(m){return h(m,!1)}}:{calculate:function(m,u,_,s){return m.forEach(function(A){y(n(A.start,A.end,A),!0)}),_.forEach(function(A){y(n(A.start,A.end,A),!1)}),h(u,s)}}}ee.exports=v},{"./linked-list":260}],260:[function(d,ee,te){var w={create:function(){var v={root:{root:!0,next:null},exists:function(S){return!(S===null||S===v.root)},isEmpty:function(){return v.root.next===null},getHead:function(){return v.root.next},insertBefore:function(S,M){for(var e=v.root,a=v.root.next;a!==null;){if(M(a)){S.prev=a.prev,S.next=a,a.prev.next=S,a.prev=S;return}e=a,a=a.next}e.next=S,S.prev=e,S.next=null},findTransition:function(S){for(var M=v.root,e=v.root.next;e!==null&&!S(e);)M=e,e=e.next;return{before:M===v.root?null:M,after:e,insert:function(a){return a.prev=M,a.next=e,M.next=a,e!==null&&(e.prev=a),a}}}};return v},node:function(v){return v.prev=null,v.next=null,v.remove=function(){v.prev.next=v.next,v.next&&(v.next.prev=v.prev),v.prev=null,v.next=null},v}};ee.exports=w},{}],261:[function(d,ee,te){function w(v,S,M){var e=[],a=[];return v.forEach(function(n){var r=n.start,t=n.end;if(S.pointsSame(r,t)){console.warn("PolyBool: Warning: Zero-length segment detected; your epsilon is probably too small or too large");return}M&&M.chainStart(n);var c={index:0,matches_head:!1,matches_pt1:!1},o={index:0,matches_head:!1,matches_pt1:!1},i=c;function y(z,I,D){return i.index=z,i.matches_head=I,i.matches_pt1=D,i===c?(i=o,!1):(i=null,!0)}for(var p=0;p<e.length;p++){var g=e[p],h=g[0];g[1];var m=g[g.length-1];if(g[g.length-2],S.pointsSame(h,r)){if(y(p,!0,!0))break}else if(S.pointsSame(h,t)){if(y(p,!0,!1))break}else if(S.pointsSame(m,r)){if(y(p,!1,!0))break}else if(S.pointsSame(m,t)&&y(p,!1,!1))break}if(i===c){e.push([r,t]),M&&M.chainNew(r,t);return}if(i===o){M&&M.chainMatch(c.index);var u=c.index,_=c.matches_pt1?t:r,s=c.matches_head,g=e[u],A=s?g[0]:g[g.length-1],b=s?g[1]:g[g.length-2],f=s?g[g.length-1]:g[0],x=s?g[g.length-2]:g[1];if(S.pointsCollinear(b,A,_)&&(s?(M&&M.chainRemoveHead(c.index,_),g.shift()):(M&&M.chainRemoveTail(c.index,_),g.pop()),A=b),S.pointsSame(f,_)){e.splice(u,1),S.pointsCollinear(x,f,A)&&(s?(M&&M.chainRemoveTail(c.index,A),g.pop()):(M&&M.chainRemoveHead(c.index,A),g.shift())),M&&M.chainClose(c.index),a.push(g);return}s?(M&&M.chainAddHead(c.index,_),g.unshift(_)):(M&&M.chainAddTail(c.index,_),g.push(_));return}function l(z){M&&M.chainReverse(z),e[z].reverse()}function L(z,I){var D=e[z],R=e[I],B=D[D.length-1],F=D[D.length-2],H=R[0],G=R[1];S.pointsCollinear(F,B,H)&&(M&&M.chainRemoveTail(z,B),D.pop(),B=F),S.pointsCollinear(B,H,G)&&(M&&M.chainRemoveHead(I,H),R.shift()),M&&M.chainJoin(z,I),e[z]=D.concat(R),e.splice(I,1)}var T=c.index,k=o.index;M&&M.chainConnect(T,k);var P=e[T].length<e[k].length;c.matches_head?o.matches_head?P?(l(T),L(T,k)):(l(k),L(k,T)):L(k,T):o.matches_head?L(T,k):P?(l(T),L(k,T)):(l(k),L(T,k))}),a}ee.exports=w},{}],262:[function(d,ee,te){function w(S,M,e){var a=[];return S.forEach(function(n){var r=(n.myFill.above?8:0)+(n.myFill.below?4:0)+(n.otherFill&&n.otherFill.above?2:0)+(n.otherFill&&n.otherFill.below?1:0);M[r]!==0&&a.push({id:e?e.segmentId():-1,start:n.start,end:n.end,myFill:{above:M[r]===1,below:M[r]===2},otherFill:null})}),e&&e.selected(a),a}var v={union:function(S,M){return w(S,[0,2,1,0,2,2,0,0,1,0,1,0,0,0,0,0],M)},intersect:function(S,M){return w(S,[0,0,0,0,0,2,0,2,0,0,1,1,0,2,1,0],M)},difference:function(S,M){return w(S,[0,0,0,0,2,0,2,0,1,1,0,0,0,1,2,0],M)},differenceRev:function(S,M){return w(S,[0,2,1,0,0,0,1,1,0,2,0,2,0,0,0,0],M)},xor:function(S,M){return w(S,[0,2,1,0,2,0,0,1,1,0,0,2,0,1,2,0],M)}};ee.exports=v},{}],263:[function(d,ee,te){var w=d("stream").Transform,v=d("stream-parser");function S(){w.call(this,{readableObjectMode:!0})}S.prototype=Object.create(w.prototype),S.prototype.constructor=S,v(S.prototype),te.ParserStream=S,te.sliceEq=function(e,a,n){for(var r=a,t=0;t<n.length;)if(e[r++]!==n[t++])return!1;return!0},te.str2arr=function(e,a){var n=[],r=0;if(a&&a==="hex")for(;r<e.length;)n.push(parseInt(e.slice(r,r+2),16)),r+=2;else for(;r<e.length;r++)n.push(e.charCodeAt(r)&255);return n},te.readUInt16LE=function(e,a){return e[a]|e[a+1]<<8},te.readUInt16BE=function(e,a){return e[a+1]|e[a]<<8},te.readUInt32LE=function(e,a){return e[a]|e[a+1]<<8|e[a+2]<<16|e[a+3]*16777216},te.readUInt32BE=function(e,a){return e[a+3]|e[a+2]<<8|e[a+1]<<16|e[a]*16777216};function M(e,a,n){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack||"",this.name=this.constructor.name,this.message=e,a&&(this.code=a),n&&(this.statusCode=n)}M.prototype=Object.create(Error.prototype),M.prototype.constructor=M,te.ProbeError=M},{stream:286,"stream-parser":302}],264:[function(d,ee,te){function w(M,e){var a=new Error(M);return a.code=e,a}function v(M){try{return decodeURIComponent(escape(M))}catch{return M}}function S(M,e,a){this.input=M.subarray(e,a),this.start=e;var n=String.fromCharCode.apply(null,this.input.subarray(0,4));if(n!=="II*\0"&&n!=="MM\0*")throw w("invalid TIFF signature","EBADDATA");this.big_endian=n[0]==="M"}S.prototype.each=function(M){this.aborted=!1;var e=this.read_uint32(4);for(this.ifds_to_read=[{id:0,offset:e}];this.ifds_to_read.length>0&&!this.aborted;){var a=this.ifds_to_read.shift();!a.offset||this.scan_ifd(a.id,a.offset,M)}},S.prototype.read_uint16=function(M){var e=this.input;if(M+2>e.length)throw w("unexpected EOF","EBADDATA");return this.big_endian?e[M]*256+e[M+1]:e[M]+e[M+1]*256},S.prototype.read_uint32=function(M){var e=this.input;if(M+4>e.length)throw w("unexpected EOF","EBADDATA");return this.big_endian?e[M]*16777216+e[M+1]*65536+e[M+2]*256+e[M+3]:e[M]+e[M+1]*256+e[M+2]*65536+e[M+3]*16777216},S.prototype.is_subifd_link=function(M,e){return M===0&&e===34665||M===0&&e===34853||M===34665&&e===40965},S.prototype.exif_format_length=function(M){switch(M){case 1:case 2:case 6:case 7:return 1;case 3:case 8:return 2;case 4:case 9:case 11:return 4;case 5:case 10:case 12:return 8;default:return 0}},S.prototype.exif_format_read=function(M,e){var a;switch(M){case 1:case 2:return a=this.input[e],a;case 6:return a=this.input[e],a|(a&128)*33554430;case 3:return a=this.read_uint16(e),a;case 8:return a=this.read_uint16(e),a|(a&32768)*131070;case 4:return a=this.read_uint32(e),a;case 9:return a=this.read_uint32(e),a|0;case 5:case 10:case 11:case 12:return null;case 7:return null;default:return null}},S.prototype.scan_ifd=function(M,e,a){var n=this.read_uint16(e);e+=2;for(var r=0;r<n;r++){var t=this.read_uint16(e),c=this.read_uint16(e+2),o=this.read_uint32(e+4),i=this.exif_format_length(c),y=o*i,p=y<=4?e+8:this.read_uint32(e+8),g=!1;if(p+y>this.input.length)throw w("unexpected EOF","EBADDATA");for(var h=[],m=p,u=0;u<o;u++,m+=i){var _=this.exif_format_read(c,m);if(_===null){h=null;break}h.push(_)}Array.isArray(h)&&c===2&&(h=v(String.fromCharCode.apply(null,h)),h&&h[h.length-1]==="\0"&&(h=h.slice(0,-1))),this.is_subifd_link(M,t)&&Array.isArray(h)&&Number.isInteger(h[0])&&h[0]>0&&(this.ifds_to_read.push({id:t,offset:h[0]}),g=!0);var s={is_big_endian:this.big_endian,ifd:M,tag:t,format:c,count:o,entry_offset:e+this.start,data_length:y,data_offset:p+this.start,value:h,is_subifd_link:g};if(a(s)===!1){this.aborted=!0;return}e+=12}M===0&&this.ifds_to_read.push({id:1,offset:this.read_uint32(e)})},ee.exports.ExifParser=S,ee.exports.get_orientation=function(M){var e=0;try{return new S(M,0,M.length).each(function(a){if(a.ifd===0&&a.tag===274&&Array.isArray(a.value))return e=a.value[0],!1}),e}catch{return-1}}},{}],265:[function(d,ee,te){var w=d("./common").readUInt16BE,v=d("./common").readUInt32BE;function S(o,i){if(o.length<4+i)return null;var y=v(o,i);return o.length<y+i||y<8?null:{boxtype:String.fromCharCode.apply(null,o.slice(i+4,i+8)),data:o.slice(i+8,i+y),end:i+y}}ee.exports.unbox=S;function M(o,i){for(var y=0;;){var p=S(o,y);if(!p)break;switch(p.boxtype){case"ispe":i.sizes.push({width:v(p.data,4),height:v(p.data,8)});break;case"irot":i.transforms.push({type:"irot",value:p.data[0]&3});break;case"imir":i.transforms.push({type:"imir",value:p.data[0]&1});break}y=p.end}}function e(o,i,y){for(var p=0,g=0;g<y;g++)p=p*256+(o[i+g]||0);return p}function a(o,i){for(var y=o[4]>>4&15,p=o[4]&15,g=o[5]>>4&15,h=w(o,6),m=8,u=0;u<h;u++){var _=w(o,m);m+=2;var s=w(o,m);m+=2;var A=e(o,m,g);m+=g;var b=w(o,m);if(m+=2,s===0&&b===1){var f=e(o,m,y),x=e(o,m+y,p);i.item_loc[_]={length:x,offset:f+A}}m+=b*(y+p)}}function n(o,i){for(var y=w(o,4),p=6,g=0;g<y;g++){var h=S(o,p);if(!h)break;if(h.boxtype==="infe"){for(var m=w(h.data,4),u="",_=8;_<h.data.length&&h.data[_];_++)u+=String.fromCharCode(h.data[_]);i.item_inf[u]=m}p=h.end}}function r(o,i){for(var y=0;;){var p=S(o,y);if(!p)break;p.boxtype==="ipco"&&M(p.data,i),y=p.end}}function t(o,i){for(var y=4;;){var p=S(o,y);if(!p)break;p.boxtype==="iprp"&&r(p.data,i),p.boxtype==="iloc"&&a(p.data,i),p.boxtype==="iinf"&&n(p.data,i),y=p.end}}function c(o){var i=o.reduce(function(g,h){return g.width>h.width||g.width===h.width&&g.height>h.height?g:h}),y=o.reduce(function(g,h){return g.height>h.height||g.height===h.height&&g.width>h.width?g:h}),p;return i.width>y.height||i.width===y.height&&i.height>y.width?p=i:p=y,p}ee.exports.readSizeFromMeta=function(o){var i={sizes:[],transforms:[],item_inf:{},item_loc:{}};if(t(o,i),!!i.sizes.length){var y=c(i.sizes),p=1;i.transforms.forEach(function(h){var m={1:6,2:5,3:8,4:7,5:4,6:3,7:2,8:1},u={1:4,2:3,3:2,4:1,5:6,6:5,7:8,8:7};if(h.type==="imir"&&(h.value===0?p=u[p]:(p=u[p],p=m[p],p=m[p])),h.type==="irot")for(var _=0;_<h.value;_++)p=m[p]});var g=null;return i.item_inf.Exif&&(g=i.item_loc[i.item_inf.Exif]),{width:y.width,height:y.height,orientation:i.transforms.length?p:null,variants:i.sizes,exif_location:g}}},ee.exports.getMimeType=function(o){var i=String.fromCharCode.apply(null,o.slice(0,4)),y={};y[i]=!0;for(var p=8;p<o.length;p+=4)y[String.fromCharCode.apply(null,o.slice(p,p+4))]=!0;if(!(!y.mif1&&!y.msf1&&!y.miaf))return i==="avif"||i==="avis"||i==="avio"?{type:"avif",mime:"image/avif"}:i==="heic"||i==="heix"?{type:"heic",mime:"image/heic"}:i==="hevc"||i==="hevx"?{type:"heic",mime:"image/heic-sequence"}:y.avif||y.avis?{type:"avif",mime:"image/avif"}:y.heic||y.heix||y.hevc||y.hevx||y.heis?y.msf1?{type:"heif",mime:"image/heif-sequence"}:{type:"heif",mime:"image/heif"}:{type:"avif",mime:"image/avif"}}},{"./common":263}],266:[function(d,ee,te){var w=d("../common").str2arr,v=d("../common").sliceEq,S=d("../common").readUInt32BE,M=d("../miaf_utils"),e=d("../exif_utils"),a=w("ftyp");ee.exports=function(n){if(!!v(n,4,a)){var r=M.unbox(n,0);if(!!r){var t=M.getMimeType(r.data);if(!!t){for(var c,o=r.end;;){var i=M.unbox(n,o);if(!i)break;if(o=i.end,i.boxtype==="mdat")return;if(i.boxtype==="meta"){c=i.data;break}}if(!!c){var y=M.readSizeFromMeta(c);if(!!y){var p={width:y.width,height:y.height,type:t.type,mime:t.mime,wUnits:"px",hUnits:"px"};if(y.variants.length>1&&(p.variants=y.variants),y.orientation&&(p.orientation=y.orientation),y.exif_location&&y.exif_location.offset+y.exif_location.length<=n.length){var g=S(n,y.exif_location.offset),h=n.slice(y.exif_location.offset+g+4,y.exif_location.offset+y.exif_location.length),m=e.get_orientation(h);m>0&&(p.orientation=m)}return p}}}}}}},{"../common":263,"../exif_utils":264,"../miaf_utils":265}],267:[function(d,ee,te){var w=d("../common").str2arr,v=d("../common").sliceEq,S=d("../common").readUInt16LE,M=w("BM");ee.exports=function(e){if(!(e.length<26)&&!!v(e,0,M))return{width:S(e,18),height:S(e,22),type:"bmp",mime:"image/bmp",wUnits:"px",hUnits:"px"}}},{"../common":263}],268:[function(d,ee,te){var w=d("../common").str2arr,v=d("../common").sliceEq,S=d("../common").readUInt16LE,M=w("GIF87a"),e=w("GIF89a");ee.exports=function(a){if(!(a.length<10)&&!(!v(a,0,M)&&!v(a,0,e)))return{width:S(a,6),height:S(a,8),type:"gif",mime:"image/gif",wUnits:"px",hUnits:"px"}}},{"../common":263}],269:[function(d,ee,te){var w=d("../common").readUInt16LE,v=0,S=1,M=16;ee.exports=function(e){var a=w(e,0),n=w(e,2),r=w(e,4);if(!(a!==v||n!==S||!r)){for(var t=[],c={width:0,height:0},o=0;o<r;o++){var i=e[6+M*o]||256,y=e[6+M*o+1]||256,p={width:i,height:y};t.push(p),(i>c.width||y>c.height)&&(c=p)}return{width:c.width,height:c.height,variants:t,type:"ico",mime:"image/x-icon",wUnits:"px",hUnits:"px"}}}},{"../common":263}],270:[function(d,ee,te){var w=d("../common").readUInt16BE,v=d("../common").str2arr,S=d("../common").sliceEq,M=d("../exif_utils"),e=v("Exif\0\0");ee.exports=function(a){if(!(a.length<2)&&!(a[0]!==255||a[1]!==216||a[2]!==255))for(var n=2;;){for(;;){if(a.length-n<2)return;if(a[n++]===255)break}for(var r=a[n++],t;r===255;)r=a[n++];if(208<=r&&r<=217||r===1)t=0;else if(192<=r&&r<=254){if(a.length-n<2)return;t=w(a,n)-2,n+=2}else return;if(r===217||r===218)return;var c;if(r===225&&t>=10&&S(a,n,e)&&(c=M.get_orientation(a.slice(n+6,n+t))),t>=5&&192<=r&&r<=207&&r!==196&&r!==200&&r!==204){if(a.length-n<t)return;var o={width:w(a,n+3),height:w(a,n+1),type:"jpg",mime:"image/jpeg",wUnits:"px",hUnits:"px"};return c>0&&(o.orientation=c),o}n+=t}}},{"../common":263,"../exif_utils":264}],271:[function(d,ee,te){var w=d("../common").str2arr,v=d("../common").sliceEq,S=d("../common").readUInt32BE,M=w(`\x89PNG\r

`),e=w("IHDR");ee.exports=function(a){if(!(a.length<24)&&!!v(a,0,M)&&!!v(a,12,e))return{width:S(a,16),height:S(a,20),type:"png",mime:"image/png",wUnits:"px",hUnits:"px"}}},{"../common":263}],272:[function(d,ee,te){var w=d("../common").str2arr,v=d("../common").sliceEq,S=d("../common").readUInt32BE,M=w("8BPS\0");ee.exports=function(e){if(!(e.length<6+16)&&!!v(e,0,M))return{width:S(e,6+12),height:S(e,6+8),type:"psd",mime:"image/vnd.adobe.photoshop",wUnits:"px",hUnits:"px"}}},{"../common":263}],273:[function(d,ee,te){function w(i){return i===32||i===9||i===13||i===10}function v(i){return typeof i=="number"&&isFinite(i)&&i>0}function S(i){var y=0,p=i.length;for(i[0]===239&&i[1]===187&&i[2]===191&&(y=3);y<p&&w(i[y]);)y++;return y===p?!1:i[y]===60}var M=/<[-_.:a-zA-Z0-9][^>]*>/,e=/^<([-_.:a-zA-Z0-9]+:)?svg\s/,a=/[^-]\bwidth="([^%]+?)"|[^-]\bwidth='([^%]+?)'/,n=/\bheight="([^%]+?)"|\bheight='([^%]+?)'/,r=/\bview[bB]ox="(.+?)"|\bview[bB]ox='(.+?)'/,t=/in$|mm$|cm$|pt$|pc$|px$|em$|ex$/;function c(i){var y=i.match(a),p=i.match(n),g=i.match(r);return{width:y&&(y[1]||y[2]),height:p&&(p[1]||p[2]),viewbox:g&&(g[1]||g[2])}}function o(i){return t.test(i)?i.match(t)[0]:"px"}ee.exports=function(i){if(!!S(i)){for(var y="",p=0;p<i.length;p++)y+=String.fromCharCode(i[p]);var g=(y.match(M)||[""])[0];if(!!e.test(g)){var h=c(g),m=parseFloat(h.width),u=parseFloat(h.height);if(h.width&&h.height)return!v(m)||!v(u)?void 0:{width:m,height:u,type:"svg",mime:"image/svg+xml",wUnits:o(h.width),hUnits:o(h.height)};var _=(h.viewbox||"").split(" "),s={width:_[2],height:_[3]},A=parseFloat(s.width),b=parseFloat(s.height);if(!(!v(A)||!v(b))&&o(s.width)===o(s.height)){var f=A/b;return h.width?v(m)?{width:m,height:m/f,type:"svg",mime:"image/svg+xml",wUnits:o(h.width),hUnits:o(h.width)}:void 0:h.height?v(u)?{width:u*f,height:u,type:"svg",mime:"image/svg+xml",wUnits:o(h.height),hUnits:o(h.height)}:void 0:{width:A,height:b,type:"svg",mime:"image/svg+xml",wUnits:o(s.width),hUnits:o(s.height)}}}}}},{}],274:[function(d,ee,te){var w=d("../common").str2arr,v=d("../common").sliceEq,S=d("../common").readUInt16LE,M=d("../common").readUInt16BE,e=d("../common").readUInt32LE,a=d("../common").readUInt32BE,n=w("II*\0"),r=w("MM\0*");function t(i,y,p){return p?M(i,y):S(i,y)}function c(i,y,p){return p?a(i,y):e(i,y)}function o(i,y,p){var g=t(i,y+2,p),h=c(i,y+4,p);return h!==1||g!==3&&g!==4?null:g===3?t(i,y+8,p):c(i,y+8,p)}ee.exports=function(i){if(!(i.length<8)&&!(!v(i,0,n)&&!v(i,0,r))){var y=i[0]===77,p=c(i,4,y)-8;if(!(p<0)){var g=p+8;if(!(i.length-g<2)){var h=t(i,g+0,y)*12;if(!(h<=0)&&(g+=2,!(i.length-g<h))){var m,u,_,s;for(m=0;m<h;m+=12)s=t(i,g+m,y),s===256?u=o(i,g+m,y):s===257&&(_=o(i,g+m,y));if(u&&_)return{width:u,height:_,type:"tiff",mime:"image/tiff",wUnits:"px",hUnits:"px"}}}}}}},{"../common":263}],275:[function(d,ee,te){var w=d("../common").str2arr,v=d("../common").sliceEq,S=d("../common").readUInt16LE,M=d("../common").readUInt32LE,e=d("../exif_utils"),a=w("RIFF"),n=w("WEBP");function r(o,i){if(!(o[i+3]!==157||o[i+4]!==1||o[i+5]!==42))return{width:S(o,i+6)&16383,height:S(o,i+8)&16383,type:"webp",mime:"image/webp",wUnits:"px",hUnits:"px"}}function t(o,i){if(o[i]===47){var y=M(o,i+1);return{width:(y&16383)+1,height:(y>>14&16383)+1,type:"webp",mime:"image/webp",wUnits:"px",hUnits:"px"}}}function c(o,i){return{width:(o[i+6]<<16|o[i+5]<<8|o[i+4])+1,height:(o[i+9]<<i|o[i+8]<<8|o[i+7])+1,type:"webp",mime:"image/webp",wUnits:"px",hUnits:"px"}}ee.exports=function(o){if(!(o.length<16)&&!(!v(o,0,a)&&!v(o,8,n))){var i=12,y=null,p=0,g=M(o,4)+8;if(!(g>o.length)){for(;i+8<g;){if(o[i]===0){i++;continue}var h=String.fromCharCode.apply(null,o.slice(i,i+4)),m=M(o,i+4);h==="VP8 "&&m>=10?y=y||r(o,i+8):h==="VP8L"&&m>=9?y=y||t(o,i+8):h==="VP8X"&&m>=10?y=y||c(o,i+8):h==="EXIF"&&(p=e.get_orientation(o.slice(i+8,i+8+m)),i=1/0),i+=8+m}if(!!y)return p>0&&(y.orientation=p),y}}}},{"../common":263,"../exif_utils":264}],276:[function(d,ee,te){ee.exports={avif:d("./parse_sync/avif"),bmp:d("./parse_sync/bmp"),gif:d("./parse_sync/gif"),ico:d("./parse_sync/ico"),jpeg:d("./parse_sync/jpeg"),png:d("./parse_sync/png"),psd:d("./parse_sync/psd"),svg:d("./parse_sync/svg"),tiff:d("./parse_sync/tiff"),webp:d("./parse_sync/webp")}},{"./parse_sync/avif":266,"./parse_sync/bmp":267,"./parse_sync/gif":268,"./parse_sync/ico":269,"./parse_sync/jpeg":270,"./parse_sync/png":271,"./parse_sync/psd":272,"./parse_sync/svg":273,"./parse_sync/tiff":274,"./parse_sync/webp":275}],277:[function(d,ee,te){var w=d("./lib/parsers_sync");function v(S){for(var M=Object.keys(w),e=0;e<M.length;e++){var a=w[M[e]](S);if(a)return a}return null}ee.exports=function(M){return v(M)},ee.exports.parsers=w},{"./lib/parsers_sync":276}],278:[function(d,ee,te){var w=ee.exports={},v,S;function M(){throw new Error("setTimeout has not been defined")}function e(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?v=setTimeout:v=M}catch{v=M}try{typeof clearTimeout=="function"?S=clearTimeout:S=e}catch{S=e}})();function a(h){if(v===setTimeout)return setTimeout(h,0);if((v===M||!v)&&setTimeout)return v=setTimeout,setTimeout(h,0);try{return v(h,0)}catch{try{return v.call(null,h,0)}catch{return v.call(this,h,0)}}}function n(h){if(S===clearTimeout)return clearTimeout(h);if((S===e||!S)&&clearTimeout)return S=clearTimeout,clearTimeout(h);try{return S(h)}catch{try{return S.call(null,h)}catch{return S.call(this,h)}}}var r=[],t=!1,c,o=-1;function i(){!t||!c||(t=!1,c.length?r=c.concat(r):o=-1,r.length&&y())}function y(){if(!t){var h=a(i);t=!0;for(var m=r.length;m;){for(c=r,r=[];++o<m;)c&&c[o].run();o=-1,m=r.length}c=null,t=!1,n(h)}}w.nextTick=function(h){var m=new Array(arguments.length-1);if(arguments.length>1)for(var u=1;u<arguments.length;u++)m[u-1]=arguments[u];r.push(new p(h,m)),r.length===1&&!t&&a(y)};function p(h,m){this.fun=h,this.array=m}p.prototype.run=function(){this.fun.apply(null,this.array)},w.title="browser",w.browser=!0,w.env={},w.argv=[],w.version="",w.versions={};function g(){}w.on=g,w.addListener=g,w.once=g,w.off=g,w.removeListener=g,w.removeAllListeners=g,w.emit=g,w.prependListener=g,w.prependOnceListener=g,w.listeners=function(h){return[]},w.binding=function(h){throw new Error("process.binding is not supported")},w.cwd=function(){return"/"},w.chdir=function(h){throw new Error("process.chdir is not supported")},w.umask=function(){return 0}},{}],279:[function(d,ee,te){(function(w){(function(){for(var v=d("performance-now"),S=typeof window>"u"?w:window,M=["moz","webkit"],e="AnimationFrame",a=S["request"+e],n=S["cancel"+e]||S["cancelRequest"+e],r=0;!a&&r<M.length;r++)a=S[M[r]+"Request"+e],n=S[M[r]+"Cancel"+e]||S[M[r]+"CancelRequest"+e];if(!a||!n){var t=0,c=0,o=[],i=1e3/60;a=function(y){if(o.length===0){var p=v(),g=Math.max(0,i-(p-t));t=g+p,setTimeout(function(){var h=o.slice(0);o.length=0;for(var m=0;m<h.length;m++)if(!h[m].cancelled)try{h[m].callback(t)}catch(u){setTimeout(function(){throw u},0)}},Math.round(g))}return o.push({handle:++c,callback:y,cancelled:!1}),c},n=function(y){for(var p=0;p<o.length;p++)o[p].handle===y&&(o[p].cancelled=!0)}}ee.exports=function(y){return a.call(S,y)},ee.exports.cancel=function(){n.apply(S,arguments)},ee.exports.polyfill=function(y){y||(y=S),y.requestAnimationFrame=a,y.cancelAnimationFrame=n}}).call(this)}).call(this,typeof To<"u"?To:typeof self<"u"?self:typeof window<"u"?window:{})},{"performance-now":252}],280:[function(d,ee,te){var w=d("array-bounds"),v=d("color-normalize"),S=d("update-diff"),M=d("pick-by-alias"),e=d("object-assign"),a=d("flatten-vertex-data"),n=d("to-float32"),r=n.float32,t=n.fract32;ee.exports=o;var c=[[1,0,0,1,0,0],[1,0,0,-1,0,0],[-1,0,0,-1,0,0],[-1,0,0,-1,0,0],[-1,0,0,1,0,0],[1,0,0,1,0,0],[1,0,-1,0,0,1],[1,0,-1,0,0,-1],[1,0,1,0,0,-1],[1,0,1,0,0,-1],[1,0,1,0,0,1],[1,0,-1,0,0,1],[-1,0,-1,0,0,1],[-1,0,-1,0,0,-1],[-1,0,1,0,0,-1],[-1,0,1,0,0,-1],[-1,0,1,0,0,1],[-1,0,-1,0,0,1],[0,1,1,0,0,0],[0,1,-1,0,0,0],[0,-1,-1,0,0,0],[0,-1,-1,0,0,0],[0,1,1,0,0,0],[0,-1,1,0,0,0],[0,1,0,-1,1,0],[0,1,0,-1,-1,0],[0,1,0,1,-1,0],[0,1,0,1,1,0],[0,1,0,-1,1,0],[0,1,0,1,-1,0],[0,-1,0,-1,1,0],[0,-1,0,-1,-1,0],[0,-1,0,1,-1,0],[0,-1,0,1,1,0],[0,-1,0,-1,1,0],[0,-1,0,1,-1,0]];function o(i,y){if(typeof i=="function"?(y||(y={}),y.regl=i):y=i,y.length&&(y.positions=y),i=y.regl,!i.hasExtension("ANGLE_instanced_arrays"))throw Error("regl-error2d: `ANGLE_instanced_arrays` extension should be enabled");var p=i._gl,g,h,m,u,_,s,A={color:"black",capSize:5,lineWidth:1,opacity:1,viewport:null,range:null,offset:0,count:0,bounds:null,positions:[],errors:[]},b=[];return u=i.buffer({usage:"dynamic",type:"uint8",data:new Uint8Array(0)}),h=i.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)}),m=i.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)}),_=i.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)}),s=i.buffer({usage:"static",type:"float",data:c}),L(y),g=i({vert:`
		precision highp float;

		attribute vec2 position, positionFract;
		attribute vec4 error;
		attribute vec4 color;

		attribute vec2 direction, lineOffset, capOffset;

		uniform vec4 viewport;
		uniform float lineWidth, capSize;
		uniform vec2 scale, scaleFract, translate, translateFract;

		varying vec4 fragColor;

		void main() {
			fragColor = color / 255.;

			vec2 pixelOffset = lineWidth * lineOffset + (capSize + lineWidth) * capOffset;

			vec2 dxy = -step(.5, direction.xy) * error.xz + step(direction.xy, vec2(-.5)) * error.yw;

			vec2 position = position + dxy;

			vec2 pos = (position + translate) * scale
				+ (positionFract + translateFract) * scale
				+ (position + translate) * scaleFract
				+ (positionFract + translateFract) * scaleFract;

			pos += pixelOffset / viewport.zw;

			gl_Position = vec4(pos * 2. - 1., 0, 1);
		}
		`,frag:`
		precision highp float;

		varying vec4 fragColor;

		uniform float opacity;

		void main() {
			gl_FragColor = fragColor;
			gl_FragColor.a *= opacity;
		}
		`,uniforms:{range:i.prop("range"),lineWidth:i.prop("lineWidth"),capSize:i.prop("capSize"),opacity:i.prop("opacity"),scale:i.prop("scale"),translate:i.prop("translate"),scaleFract:i.prop("scaleFract"),translateFract:i.prop("translateFract"),viewport:function(k,P){return[P.viewport.x,P.viewport.y,k.viewportWidth,k.viewportHeight]}},attributes:{color:{buffer:u,offset:function(k,P){return P.offset*4},divisor:1},position:{buffer:h,offset:function(k,P){return P.offset*8},divisor:1},positionFract:{buffer:m,offset:function(k,P){return P.offset*8},divisor:1},error:{buffer:_,offset:function(k,P){return P.offset*16},divisor:1},direction:{buffer:s,stride:24,offset:0},lineOffset:{buffer:s,stride:24,offset:8},capOffset:{buffer:s,stride:24,offset:16}},primitive:"triangles",blend:{enable:!0,color:[0,0,0,0],equation:{rgb:"add",alpha:"add"},func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},depth:{enable:!1},scissor:{enable:!0,box:i.prop("viewport")},viewport:i.prop("viewport"),stencil:!1,instances:i.prop("count"),count:c.length}),e(f,{update:L,draw:x,destroy:T,regl:i,gl:p,canvas:p.canvas,groups:b}),f;function f(k){k?L(k):k===null&&T(),x()}function x(k){if(typeof k=="number")return l(k);k&&!Array.isArray(k)&&(k=[k]),i._refresh(),b.forEach(function(P,z){if(!!P){if(k&&(k[z]?P.draw=!0:P.draw=!1),!P.draw){P.draw=!0;return}l(z)}})}function l(k){typeof k=="number"&&(k=b[k]),k!=null&&(!(k&&k.count&&k.color&&k.opacity&&k.positions&&k.positions.length>1)||(k.scaleRatio=[k.scale[0]*k.viewport.width,k.scale[1]*k.viewport.height],g(k),k.after&&k.after(k)))}function L(k){if(!!k){k.length!=null?typeof k[0]=="number"&&(k=[{positions:k}]):Array.isArray(k)||(k=[k]);var P=0,z=0;if(f.groups=b=k.map(function(G,J){var X=b[J];if(G)typeof G=="function"?G={after:G}:typeof G[0]=="number"&&(G={positions:G});else return X;return G=M(G,{color:"color colors fill",capSize:"capSize cap capsize cap-size",lineWidth:"lineWidth line-width width line thickness",opacity:"opacity alpha",range:"range dataBox",viewport:"viewport viewBox",errors:"errors error",positions:"positions position data points"}),X||(b[J]=X={id:J,scale:null,translate:null,scaleFract:null,translateFract:null,draw:!0},G=e({},A,G)),S(X,G,[{lineWidth:function(Y){return+Y*.5},capSize:function(Y){return+Y*.5},opacity:parseFloat,errors:function(Y){return Y=a(Y),z+=Y.length,Y},positions:function(Y,Z){return Y=a(Y,"float64"),Z.count=Math.floor(Y.length/2),Z.bounds=w(Y,2),Z.offset=P,P+=Z.count,Y}},{color:function(Y,Z){var oe=Z.count;if(Y||(Y="transparent"),!Array.isArray(Y)||typeof Y[0]=="number"){var re=Y;Y=Array(oe);for(var se=0;se<oe;se++)Y[se]=re}if(Y.length<oe)throw Error("Not enough colors");for(var N=new Uint8Array(oe*4),U=0;U<oe;U++){var q=v(Y[U],"uint8");N.set(q,U*4)}return N},range:function(Y,Z,oe){var re=Z.bounds;return Y||(Y=re),Z.scale=[1/(Y[2]-Y[0]),1/(Y[3]-Y[1])],Z.translate=[-Y[0],-Y[1]],Z.scaleFract=t(Z.scale),Z.translateFract=t(Z.translate),Y},viewport:function(Y){var Z;return Array.isArray(Y)?Z={x:Y[0],y:Y[1],width:Y[2]-Y[0],height:Y[3]-Y[1]}:Y?(Z={x:Y.x||Y.left||0,y:Y.y||Y.top||0},Y.right?Z.width=Y.right-Z.x:Z.width=Y.w||Y.width||0,Y.bottom?Z.height=Y.bottom-Z.y:Z.height=Y.h||Y.height||0):Z={x:0,y:0,width:p.drawingBufferWidth,height:p.drawingBufferHeight},Z}}]),X}),P||z){var I=b.reduce(function(G,J,X){return G+(J?J.count:0)},0),D=new Float64Array(I*2),R=new Uint8Array(I*4),B=new Float32Array(I*4);b.forEach(function(G,J){if(!!G){var X=G.positions,Y=G.count,Z=G.offset,oe=G.color,re=G.errors;!Y||(R.set(oe,Z*4),B.set(re,Z*4),D.set(X,Z*2))}});var F=r(D);h(F);var H=t(D,F);m(H),u(R),_(B)}}}function T(){h.destroy(),m.destroy(),u.destroy(),_.destroy(),s.destroy()}}},{"array-bounds":71,"color-normalize":89,"flatten-vertex-data":191,"object-assign":247,"pick-by-alias":253,"to-float32":314,"update-diff":330}],281:[function(d,ee,te){var w=d("color-normalize"),v=d("array-bounds"),S=d("object-assign"),M=d("glslify"),e=d("pick-by-alias"),a=d("flatten-vertex-data"),n=d("earcut"),r=d("array-normalize"),t=d("to-float32"),c=t.float32,o=t.fract32,i=d("es6-weak-map"),y=d("parse-rect"),p=d("array-find-index");ee.exports=g;function g(h,m){if(!(this instanceof g))return new g(h,m);if(typeof h=="function"?(m||(m={}),m.regl=h):m=h,m.length&&(m.positions=m),h=m.regl,!h.hasExtension("ANGLE_instanced_arrays"))throw Error("regl-error2d: `ANGLE_instanced_arrays` extension should be enabled");this.gl=h._gl,this.regl=h,this.passes=[],this.shaders=g.shaders.has(h)?g.shaders.get(h):g.shaders.set(h,g.createShaders(h)).get(h),this.update(m)}g.dashMult=2,g.maxPatternLength=256,g.precisionThreshold=3e6,g.maxPoints=1e4,g.maxLines=2048,g.shaders=new i,g.createShaders=function(h){var m=h.buffer({usage:"static",type:"float",data:[0,1,0,0,1,1,1,0]}),u={primitive:"triangle strip",instances:h.prop("count"),count:4,offset:0,uniforms:{miterMode:function(b,f){return f.join==="round"?2:1},miterLimit:h.prop("miterLimit"),scale:h.prop("scale"),scaleFract:h.prop("scaleFract"),translateFract:h.prop("translateFract"),translate:h.prop("translate"),thickness:h.prop("thickness"),dashTexture:h.prop("dashTexture"),opacity:h.prop("opacity"),pixelRatio:h.context("pixelRatio"),id:h.prop("id"),dashLength:h.prop("dashLength"),viewport:function(b,f){return[f.viewport.x,f.viewport.y,b.viewportWidth,b.viewportHeight]},depth:h.prop("depth")},blend:{enable:!0,color:[0,0,0,0],equation:{rgb:"add",alpha:"add"},func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},depth:{enable:function(b,f){return!f.overlay}},stencil:{enable:!1},scissor:{enable:!0,box:h.prop("viewport")},viewport:h.prop("viewport")},_=h(S({vert:M([`precision highp float;
#define GLSLIFY 1

attribute vec2 aCoord, bCoord, aCoordFract, bCoordFract;
attribute vec4 color;
attribute float lineEnd, lineTop;

uniform vec2 scale, scaleFract, translate, translateFract;
uniform float thickness, pixelRatio, id, depth;
uniform vec4 viewport;

varying vec4 fragColor;
varying vec2 tangent;

vec2 project(vec2 position, vec2 positionFract, vec2 scale, vec2 scaleFract, vec2 translate, vec2 translateFract) {
	// the order is important
	return position * scale + translate
       + positionFract * scale + translateFract
       + position * scaleFract
       + positionFract * scaleFract;
}

void main() {
	float lineStart = 1. - lineEnd;
	float lineOffset = lineTop * 2. - 1.;

	vec2 diff = (bCoord + bCoordFract - aCoord - aCoordFract);
	tangent = normalize(diff * scale * viewport.zw);
	vec2 normal = vec2(-tangent.y, tangent.x);

	vec2 position = project(aCoord, aCoordFract, scale, scaleFract, translate, translateFract) * lineStart
		+ project(bCoord, bCoordFract, scale, scaleFract, translate, translateFract) * lineEnd

		+ thickness * normal * .5 * lineOffset / viewport.zw;

	gl_Position = vec4(position * 2.0 - 1.0, depth, 1);

	fragColor = color / 255.;
}
`]),frag:M([`precision highp float;
#define GLSLIFY 1

uniform float dashLength, pixelRatio, thickness, opacity, id;
uniform sampler2D dashTexture;

varying vec4 fragColor;
varying vec2 tangent;

void main() {
	float alpha = 1.;

	float t = fract(dot(tangent, gl_FragCoord.xy) / dashLength) * .5 + .25;
	float dash = texture2D(dashTexture, vec2(t, .5)).r;

	gl_FragColor = fragColor;
	gl_FragColor.a *= alpha * opacity * dash;
}
`]),attributes:{lineEnd:{buffer:m,divisor:0,stride:8,offset:0},lineTop:{buffer:m,divisor:0,stride:8,offset:4},aCoord:{buffer:h.prop("positionBuffer"),stride:8,offset:8,divisor:1},bCoord:{buffer:h.prop("positionBuffer"),stride:8,offset:16,divisor:1},aCoordFract:{buffer:h.prop("positionFractBuffer"),stride:8,offset:8,divisor:1},bCoordFract:{buffer:h.prop("positionFractBuffer"),stride:8,offset:16,divisor:1},color:{buffer:h.prop("colorBuffer"),stride:4,offset:0,divisor:1}}},u)),s;try{s=h(S({cull:{enable:!0,face:"back"},vert:M([`precision highp float;
#define GLSLIFY 1

attribute vec2 aCoord, bCoord, nextCoord, prevCoord;
attribute vec4 aColor, bColor;
attribute float lineEnd, lineTop;

uniform vec2 scale, translate;
uniform float thickness, pixelRatio, id, depth;
uniform vec4 viewport;
uniform float miterLimit, miterMode;

varying vec4 fragColor;
varying vec4 startCutoff, endCutoff;
varying vec2 tangent;
varying vec2 startCoord, endCoord;
varying float enableStartMiter, enableEndMiter;

const float REVERSE_THRESHOLD = -.875;
const float MIN_DIFF = 1e-6;

// TODO: possible optimizations: avoid overcalculating all for vertices and calc just one instead
// TODO: precalculate dot products, normalize things beforehead etc.
// TODO: refactor to rectangular algorithm

float distToLine(vec2 p, vec2 a, vec2 b) {
	vec2 diff = b - a;
	vec2 perp = normalize(vec2(-diff.y, diff.x));
	return dot(p - a, perp);
}

bool isNaN( float val ){
  return ( val < 0.0 || 0.0 < val || val == 0.0 ) ? false : true;
}

void main() {
	vec2 aCoord = aCoord, bCoord = bCoord, prevCoord = prevCoord, nextCoord = nextCoord;

  vec2 adjustedScale;
  adjustedScale.x = (abs(scale.x) < MIN_DIFF) ? MIN_DIFF : scale.x;
  adjustedScale.y = (abs(scale.y) < MIN_DIFF) ? MIN_DIFF : scale.y;

  vec2 scaleRatio = adjustedScale * viewport.zw;
	vec2 normalWidth = thickness / scaleRatio;

	float lineStart = 1. - lineEnd;
	float lineBot = 1. - lineTop;

	fragColor = (lineStart * aColor + lineEnd * bColor) / 255.;

	if (isNaN(aCoord.x) || isNaN(aCoord.y) || isNaN(bCoord.x) || isNaN(bCoord.y)) return;

	if (aCoord == prevCoord) prevCoord = aCoord + normalize(bCoord - aCoord);
	if (bCoord == nextCoord) nextCoord = bCoord - normalize(bCoord - aCoord);

	vec2 prevDiff = aCoord - prevCoord;
	vec2 currDiff = bCoord - aCoord;
	vec2 nextDiff = nextCoord - bCoord;

	vec2 prevTangent = normalize(prevDiff * scaleRatio);
	vec2 currTangent = normalize(currDiff * scaleRatio);
	vec2 nextTangent = normalize(nextDiff * scaleRatio);

	vec2 prevNormal = vec2(-prevTangent.y, prevTangent.x);
	vec2 currNormal = vec2(-currTangent.y, currTangent.x);
	vec2 nextNormal = vec2(-nextTangent.y, nextTangent.x);

	vec2 startJoinDirection = normalize(prevTangent - currTangent);
	vec2 endJoinDirection = normalize(currTangent - nextTangent);

	// collapsed/unidirectional segment cases
	// FIXME: there should be more elegant solution
	vec2 prevTanDiff = abs(prevTangent - currTangent);
	vec2 nextTanDiff = abs(nextTangent - currTangent);
	if (max(prevTanDiff.x, prevTanDiff.y) < MIN_DIFF) {
		startJoinDirection = currNormal;
	}
	if (max(nextTanDiff.x, nextTanDiff.y) < MIN_DIFF) {
		endJoinDirection = currNormal;
	}
	if (aCoord == bCoord) {
		endJoinDirection = startJoinDirection;
		currNormal = prevNormal;
		currTangent = prevTangent;
	}

	tangent = currTangent;

	//calculate join shifts relative to normals
	float startJoinShift = dot(currNormal, startJoinDirection);
	float endJoinShift = dot(currNormal, endJoinDirection);

	float startMiterRatio = abs(1. / startJoinShift);
	float endMiterRatio = abs(1. / endJoinShift);

	vec2 startJoin = startJoinDirection * startMiterRatio;
	vec2 endJoin = endJoinDirection * endMiterRatio;

	vec2 startTopJoin, startBotJoin, endTopJoin, endBotJoin;
	startTopJoin = sign(startJoinShift) * startJoin * .5;
	startBotJoin = -startTopJoin;

	endTopJoin = sign(endJoinShift) * endJoin * .5;
	endBotJoin = -endTopJoin;

	vec2 aTopCoord = aCoord + normalWidth * startTopJoin;
	vec2 bTopCoord = bCoord + normalWidth * endTopJoin;
	vec2 aBotCoord = aCoord + normalWidth * startBotJoin;
	vec2 bBotCoord = bCoord + normalWidth * endBotJoin;

	//miter anti-clipping
	float baClipping = distToLine(bCoord, aCoord, aBotCoord) / dot(normalize(normalWidth * endBotJoin), normalize(normalWidth.yx * vec2(-startBotJoin.y, startBotJoin.x)));
	float abClipping = distToLine(aCoord, bCoord, bTopCoord) / dot(normalize(normalWidth * startBotJoin), normalize(normalWidth.yx * vec2(-endBotJoin.y, endBotJoin.x)));

	//prevent close to reverse direction switch
	bool prevReverse = dot(currTangent, prevTangent) <= REVERSE_THRESHOLD && abs(dot(currTangent, prevNormal)) * min(length(prevDiff), length(currDiff)) <  length(normalWidth * currNormal);
	bool nextReverse = dot(currTangent, nextTangent) <= REVERSE_THRESHOLD && abs(dot(currTangent, nextNormal)) * min(length(nextDiff), length(currDiff)) <  length(normalWidth * currNormal);

	if (prevReverse) {
		//make join rectangular
		vec2 miterShift = normalWidth * startJoinDirection * miterLimit * .5;
		float normalAdjust = 1. - min(miterLimit / startMiterRatio, 1.);
		aBotCoord = aCoord + miterShift - normalAdjust * normalWidth * currNormal * .5;
		aTopCoord = aCoord + miterShift + normalAdjust * normalWidth * currNormal * .5;
	}
	else if (!nextReverse && baClipping > 0. && baClipping < length(normalWidth * endBotJoin)) {
		//handle miter clipping
		bTopCoord -= normalWidth * endTopJoin;
		bTopCoord += normalize(endTopJoin * normalWidth) * baClipping;
	}

	if (nextReverse) {
		//make join rectangular
		vec2 miterShift = normalWidth * endJoinDirection * miterLimit * .5;
		float normalAdjust = 1. - min(miterLimit / endMiterRatio, 1.);
		bBotCoord = bCoord + miterShift - normalAdjust * normalWidth * currNormal * .5;
		bTopCoord = bCoord + miterShift + normalAdjust * normalWidth * currNormal * .5;
	}
	else if (!prevReverse && abClipping > 0. && abClipping < length(normalWidth * startBotJoin)) {
		//handle miter clipping
		aBotCoord -= normalWidth * startBotJoin;
		aBotCoord += normalize(startBotJoin * normalWidth) * abClipping;
	}

	vec2 aTopPosition = (aTopCoord) * adjustedScale + translate;
	vec2 aBotPosition = (aBotCoord) * adjustedScale + translate;

	vec2 bTopPosition = (bTopCoord) * adjustedScale + translate;
	vec2 bBotPosition = (bBotCoord) * adjustedScale + translate;

	//position is normalized 0..1 coord on the screen
	vec2 position = (aTopPosition * lineTop + aBotPosition * lineBot) * lineStart + (bTopPosition * lineTop + bBotPosition * lineBot) * lineEnd;

	startCoord = aCoord * scaleRatio + translate * viewport.zw + viewport.xy;
	endCoord = bCoord * scaleRatio + translate * viewport.zw + viewport.xy;

	gl_Position = vec4(position  * 2.0 - 1.0, depth, 1);

	enableStartMiter = step(dot(currTangent, prevTangent), .5);
	enableEndMiter = step(dot(currTangent, nextTangent), .5);

	//bevel miter cutoffs
	if (miterMode == 1.) {
		if (enableStartMiter == 1.) {
			vec2 startMiterWidth = vec2(startJoinDirection) * thickness * miterLimit * .5;
			startCutoff = vec4(aCoord, aCoord);
			startCutoff.zw += vec2(-startJoinDirection.y, startJoinDirection.x) / scaleRatio;
			startCutoff = startCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;
			startCutoff += viewport.xyxy;
			startCutoff += startMiterWidth.xyxy;
		}

		if (enableEndMiter == 1.) {
			vec2 endMiterWidth = vec2(endJoinDirection) * thickness * miterLimit * .5;
			endCutoff = vec4(bCoord, bCoord);
			endCutoff.zw += vec2(-endJoinDirection.y, endJoinDirection.x)  / scaleRatio;
			endCutoff = endCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;
			endCutoff += viewport.xyxy;
			endCutoff += endMiterWidth.xyxy;
		}
	}

	//round miter cutoffs
	else if (miterMode == 2.) {
		if (enableStartMiter == 1.) {
			vec2 startMiterWidth = vec2(startJoinDirection) * thickness * abs(dot(startJoinDirection, currNormal)) * .5;
			startCutoff = vec4(aCoord, aCoord);
			startCutoff.zw += vec2(-startJoinDirection.y, startJoinDirection.x) / scaleRatio;
			startCutoff = startCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;
			startCutoff += viewport.xyxy;
			startCutoff += startMiterWidth.xyxy;
		}

		if (enableEndMiter == 1.) {
			vec2 endMiterWidth = vec2(endJoinDirection) * thickness * abs(dot(endJoinDirection, currNormal)) * .5;
			endCutoff = vec4(bCoord, bCoord);
			endCutoff.zw += vec2(-endJoinDirection.y, endJoinDirection.x)  / scaleRatio;
			endCutoff = endCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;
			endCutoff += viewport.xyxy;
			endCutoff += endMiterWidth.xyxy;
		}
	}
}
`]),frag:M([`precision highp float;
#define GLSLIFY 1

uniform float dashLength, pixelRatio, thickness, opacity, id, miterMode;
uniform sampler2D dashTexture;

varying vec4 fragColor;
varying vec2 tangent;
varying vec4 startCutoff, endCutoff;
varying vec2 startCoord, endCoord;
varying float enableStartMiter, enableEndMiter;

float distToLine(vec2 p, vec2 a, vec2 b) {
	vec2 diff = b - a;
	vec2 perp = normalize(vec2(-diff.y, diff.x));
	return dot(p - a, perp);
}

void main() {
	float alpha = 1., distToStart, distToEnd;
	float cutoff = thickness * .5;

	//bevel miter
	if (miterMode == 1.) {
		if (enableStartMiter == 1.) {
			distToStart = distToLine(gl_FragCoord.xy, startCutoff.xy, startCutoff.zw);
			if (distToStart < -1.) {
				discard;
				return;
			}
			alpha *= min(max(distToStart + 1., 0.), 1.);
		}

		if (enableEndMiter == 1.) {
			distToEnd = distToLine(gl_FragCoord.xy, endCutoff.xy, endCutoff.zw);
			if (distToEnd < -1.) {
				discard;
				return;
			}
			alpha *= min(max(distToEnd + 1., 0.), 1.);
		}
	}

	// round miter
	else if (miterMode == 2.) {
		if (enableStartMiter == 1.) {
			distToStart = distToLine(gl_FragCoord.xy, startCutoff.xy, startCutoff.zw);
			if (distToStart < 0.) {
				float radius = length(gl_FragCoord.xy - startCoord);

				if(radius > cutoff + .5) {
					discard;
					return;
				}

				alpha -= smoothstep(cutoff - .5, cutoff + .5, radius);
			}
		}

		if (enableEndMiter == 1.) {
			distToEnd = distToLine(gl_FragCoord.xy, endCutoff.xy, endCutoff.zw);
			if (distToEnd < 0.) {
				float radius = length(gl_FragCoord.xy - endCoord);

				if(radius > cutoff + .5) {
					discard;
					return;
				}

				alpha -= smoothstep(cutoff - .5, cutoff + .5, radius);
			}
		}
	}

	float t = fract(dot(tangent, gl_FragCoord.xy) / dashLength) * .5 + .25;
	float dash = texture2D(dashTexture, vec2(t, .5)).r;

	gl_FragColor = fragColor;
	gl_FragColor.a *= alpha * opacity * dash;
}
`]),attributes:{lineEnd:{buffer:m,divisor:0,stride:8,offset:0},lineTop:{buffer:m,divisor:0,stride:8,offset:4},aColor:{buffer:h.prop("colorBuffer"),stride:4,offset:0,divisor:1},bColor:{buffer:h.prop("colorBuffer"),stride:4,offset:4,divisor:1},prevCoord:{buffer:h.prop("positionBuffer"),stride:8,offset:0,divisor:1},aCoord:{buffer:h.prop("positionBuffer"),stride:8,offset:8,divisor:1},bCoord:{buffer:h.prop("positionBuffer"),stride:8,offset:16,divisor:1},nextCoord:{buffer:h.prop("positionBuffer"),stride:8,offset:24,divisor:1}}},u))}catch{s=_}var A=h({primitive:"triangle",elements:function(b,f){return f.triangles},offset:0,vert:M([`precision highp float;
#define GLSLIFY 1

attribute vec2 position, positionFract;

uniform vec4 color;
uniform vec2 scale, scaleFract, translate, translateFract;
uniform float pixelRatio, id;
uniform vec4 viewport;
uniform float opacity;

varying vec4 fragColor;

const float MAX_LINES = 256.;

void main() {
	float depth = (MAX_LINES - 4. - id) / (MAX_LINES);

	vec2 position = position * scale + translate
       + positionFract * scale + translateFract
       + position * scaleFract
       + positionFract * scaleFract;

	gl_Position = vec4(position * 2.0 - 1.0, depth, 1);

	fragColor = color / 255.;
	fragColor.a *= opacity;
}
`]),frag:M([`precision highp float;
#define GLSLIFY 1

varying vec4 fragColor;

void main() {
	gl_FragColor = fragColor;
}
`]),uniforms:{scale:h.prop("scale"),color:h.prop("fill"),scaleFract:h.prop("scaleFract"),translateFract:h.prop("translateFract"),translate:h.prop("translate"),opacity:h.prop("opacity"),pixelRatio:h.context("pixelRatio"),id:h.prop("id"),viewport:function(b,f){return[f.viewport.x,f.viewport.y,b.viewportWidth,b.viewportHeight]}},attributes:{position:{buffer:h.prop("positionBuffer"),stride:8,offset:8},positionFract:{buffer:h.prop("positionFractBuffer"),stride:8,offset:8}},blend:u.blend,depth:{enable:!1},scissor:u.scissor,stencil:u.stencil,viewport:u.viewport});return{fill:A,rect:_,miter:s}},g.defaults={dashes:null,join:"miter",miterLimit:1,thickness:10,cap:"square",color:"black",opacity:1,overlay:!1,viewport:null,range:null,close:!1,fill:null},g.prototype.render=function(){for(var h,m=[],u=arguments.length;u--;)m[u]=arguments[u];m.length&&(h=this).update.apply(h,m),this.draw()},g.prototype.draw=function(){for(var h=this,m=[],u=arguments.length;u--;)m[u]=arguments[u];return(m.length?m:this.passes).forEach(function(_,s){var A;if(_&&Array.isArray(_))return(A=h).draw.apply(A,_);typeof _=="number"&&(_=h.passes[_]),_&&_.count>1&&_.opacity&&(h.regl._refresh(),_.fill&&_.triangles&&_.triangles.length>2&&h.shaders.fill(_),_.thickness&&(_.scale[0]*_.viewport.width>g.precisionThreshold||_.scale[1]*_.viewport.height>g.precisionThreshold||_.join==="rect"||!_.join&&(_.thickness<=2||_.count>=g.maxPoints)?h.shaders.rect(_):h.shaders.miter(_)))}),this},g.prototype.update=function(h){var m=this;if(!!h){h.length!=null?typeof h[0]=="number"&&(h=[{positions:h}]):Array.isArray(h)||(h=[h]);var u=this,_=u.regl,s=u.gl;if(h.forEach(function(l,L){var T=m.passes[L];if(l!==void 0){if(l===null){m.passes[L]=null;return}if(typeof l[0]=="number"&&(l={positions:l}),l=e(l,{positions:"positions points data coords",thickness:"thickness lineWidth lineWidths line-width linewidth width stroke-width strokewidth strokeWidth",join:"lineJoin linejoin join type mode",miterLimit:"miterlimit miterLimit",dashes:"dash dashes dasharray dash-array dashArray",color:"color colour stroke colors colours stroke-color strokeColor",fill:"fill fill-color fillColor",opacity:"alpha opacity",overlay:"overlay crease overlap intersect",close:"closed close closed-path closePath",range:"range dataBox",viewport:"viewport viewBox",hole:"holes hole hollow",splitNull:"splitNull"}),T||(m.passes[L]=T={id:L,scale:null,scaleFract:null,translate:null,translateFract:null,count:0,hole:[],depth:0,dashLength:1,dashTexture:_.texture({channels:1,data:new Uint8Array([255]),width:1,height:1,mag:"linear",min:"linear"}),colorBuffer:_.buffer({usage:"dynamic",type:"uint8",data:new Uint8Array}),positionBuffer:_.buffer({usage:"dynamic",type:"float",data:new Uint8Array}),positionFractBuffer:_.buffer({usage:"dynamic",type:"float",data:new Uint8Array})},l=S({},g.defaults,l)),l.thickness!=null&&(T.thickness=parseFloat(l.thickness)),l.opacity!=null&&(T.opacity=parseFloat(l.opacity)),l.miterLimit!=null&&(T.miterLimit=parseFloat(l.miterLimit)),l.overlay!=null&&(T.overlay=!!l.overlay,L<g.maxLines&&(T.depth=2*(g.maxLines-1-L%g.maxLines)/g.maxLines-1)),l.join!=null&&(T.join=l.join),l.hole!=null&&(T.hole=l.hole),l.fill!=null&&(T.fill=l.fill?w(l.fill,"uint8"):null),l.viewport!=null&&(T.viewport=y(l.viewport)),T.viewport||(T.viewport=y([s.drawingBufferWidth,s.drawingBufferHeight])),l.close!=null&&(T.close=l.close),l.positions===null&&(l.positions=[]),l.positions){var k,P;if(l.positions.x&&l.positions.y){var z=l.positions.x,I=l.positions.y;P=T.count=Math.max(z.length,I.length),k=new Float64Array(P*2);for(var D=0;D<P;D++)k[D*2]=z[D],k[D*2+1]=I[D]}else k=a(l.positions,"float64"),P=T.count=Math.floor(k.length/2);var R=T.bounds=v(k,2);if(T.fill){for(var B=[],F={},H=0,G=0,J=0,X=T.count;G<X;G++){var Y=k[G*2],Z=k[G*2+1];isNaN(Y)||isNaN(Z)||Y==null||Z==null?(Y=k[H*2],Z=k[H*2+1],F[G]=H):H=G,B[J++]=Y,B[J++]=Z}if(l.splitNull){T.count-1 in F||(F[T.count]=T.count-1);var oe=Object.keys(F).map(Number).sort(function(Ue,qe){return Ue-qe}),re=[],se=0,N=T.hole!=null?T.hole[0]:null;if(N!=null){var U=p(oe,function(Ue){return Ue>=N});oe=oe.slice(0,U),oe.push(N)}for(var q=function(Ue){var qe=B.slice(se*2,oe[Ue]*2).concat(N?B.slice(N*2):[]),Ve=(T.hole||[]).map(function(Ne){return Ne-N+(oe[Ue]-se)}),Ae=n(qe,Ve);Ae=Ae.map(function(Ne){return Ne+se+(Ne+se<oe[Ue]?0:N-oe[Ue])}),re.push.apply(re,Ae),se=oe[Ue]+1},$=0;$<oe.length;$++)q($);for(var W=0,K=re.length;W<K;W++)F[re[W]]!=null&&(re[W]=F[re[W]]);T.triangles=re}else{for(var ne=n(B,T.hole||[]),ae=0,ie=ne.length;ae<ie;ae++)F[ne[ae]]!=null&&(ne[ae]=F[ne[ae]]);T.triangles=ne}}var le=new Float64Array(k);r(le,2,R);var ye=new Float64Array(P*2+6);T.close?k[0]===k[P*2-2]&&k[1]===k[P*2-1]?(ye[0]=le[P*2-4],ye[1]=le[P*2-3]):(ye[0]=le[P*2-2],ye[1]=le[P*2-1]):(ye[0]=le[0],ye[1]=le[1]),ye.set(le,2),T.close?k[0]===k[P*2-2]&&k[1]===k[P*2-1]?(ye[P*2+2]=le[2],ye[P*2+3]=le[3],T.count-=1):(ye[P*2+2]=le[0],ye[P*2+3]=le[1],ye[P*2+4]=le[2],ye[P*2+5]=le[3]):(ye[P*2+2]=le[P*2-2],ye[P*2+3]=le[P*2-1],ye[P*2+4]=le[P*2-2],ye[P*2+5]=le[P*2-1]);var ue=c(ye);T.positionBuffer(ue);var pe=o(ye,ue);T.positionFractBuffer(pe)}if(l.range?T.range=l.range:T.range||(T.range=T.bounds),(l.range||l.positions)&&T.count){var ge=T.bounds,Te=ge[2]-ge[0],_e=ge[3]-ge[1],ze=T.range[2]-T.range[0],Oe=T.range[3]-T.range[1];T.scale=[Te/ze,_e/Oe],T.translate=[-T.range[0]/ze+ge[0]/ze||0,-T.range[1]/Oe+ge[1]/Oe||0],T.scaleFract=o(T.scale),T.translateFract=o(T.translate)}if(l.dashes){var Ye=0,be;if(!l.dashes||l.dashes.length<2)Ye=1,be=new Uint8Array([255,255,255,255,255,255,255,255]);else{Ye=0;for(var Pe=0;Pe<l.dashes.length;++Pe)Ye+=l.dashes[Pe];be=new Uint8Array(Ye*g.dashMult);for(var Ge=0,Qe=255,Be=0;Be<2;Be++)for(var Le=0;Le<l.dashes.length;++Le){for(var He=0,vt=l.dashes[Le]*g.dashMult*.5;He<vt;++He)be[Ge++]=Qe;Qe^=255}}T.dashLength=Ye,T.dashTexture({channels:1,data:be,width:be.length,height:1,mag:"linear",min:"linear"},0,0)}if(l.color){var Rt=T.count,rr=l.color;rr||(rr="transparent");var Lt=new Uint8Array(Rt*4+4);if(!Array.isArray(rr)||typeof rr[0]=="number")for(var Ft=w(rr,"uint8"),Gt=0;Gt<Rt+1;Gt++)Lt.set(Ft,Gt*4);else{for(var Dt=0;Dt<Rt;Dt++){var kt=w(rr[Dt],"uint8");Lt.set(kt,Dt*4)}Lt.set(w(rr[0],"uint8"),Rt*4)}T.colorBuffer({usage:"dynamic",type:"uint8",data:Lt})}}}),h.length<this.passes.length){for(var A=h.length;A<this.passes.length;A++){var b=this.passes[A];!b||(b.colorBuffer.destroy(),b.positionBuffer.destroy(),b.dashTexture.destroy())}this.passes.length=h.length}for(var f=[],x=0;x<this.passes.length;x++)this.passes[x]!==null&&f.push(this.passes[x]);return this.passes=f,this}},g.prototype.destroy=function(){return this.passes.forEach(function(h){h.colorBuffer.destroy(),h.positionBuffer.destroy(),h.dashTexture.destroy()}),this.passes.length=0,this}},{"array-bounds":71,"array-find-index":72,"array-normalize":73,"color-normalize":89,earcut:129,"es6-weak-map":183,"flatten-vertex-data":191,glslify:227,"object-assign":247,"parse-rect":249,"pick-by-alias":253,"to-float32":314}],282:[function(d,ee,te){function w(T,k){return M(T)||a(T,k)||n(T,k)||c()}function v(T){return S(T)||e(T)||n(T)||t()}function S(T){if(Array.isArray(T))return r(T)}function M(T){if(Array.isArray(T))return T}function e(T){if(typeof Symbol<"u"&&T[Symbol.iterator]!=null||T["@@iterator"]!=null)return Array.from(T)}function a(T,k){var P=T==null?null:typeof Symbol<"u"&&T[Symbol.iterator]||T["@@iterator"];if(P!=null){var z=[],I=!0,D=!1,R,B;try{for(P=P.call(T);!(I=(R=P.next()).done)&&(z.push(R.value),!(k&&z.length===k));I=!0);}catch(F){D=!0,B=F}finally{try{!I&&P.return!=null&&P.return()}finally{if(D)throw B}}return z}}function n(T,k){if(!!T){if(typeof T=="string")return r(T,k);var P=Object.prototype.toString.call(T).slice(8,-1);if(P==="Object"&&T.constructor&&(P=T.constructor.name),P==="Map"||P==="Set")return Array.from(T);if(P==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(P))return r(T,k)}}function r(T,k){(k==null||k>T.length)&&(k=T.length);for(var P=0,z=new Array(k);P<k;P++)z[P]=T[P];return z}function t(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function c(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o=d("color-normalize"),i=d("array-bounds"),y=d("color-id"),p=d("@plotly/point-cluster"),g=d("object-assign"),h=d("glslify"),m=d("pick-by-alias"),u=d("update-diff"),_=d("flatten-vertex-data"),s=d("is-iexplorer"),A=d("to-float32"),b=d("parse-rect"),f=x;function x(T,k){var P=this;if(!(this instanceof x))return new x(T,k);typeof T=="function"?(k||(k={}),k.regl=T):(k=T,T=null),k&&k.length&&(k.positions=k),T=k.regl;var z=T._gl,I,D=[],R={},B=[],F=[null],H=[null],G=255,J=100;this.tooManyColors=s,I=T.texture({data:new Uint8Array(G*4),width:G,height:1,type:"uint8",format:"rgba",wrapS:"clamp",wrapT:"clamp",mag:"nearest",min:"nearest"}),g(this,{regl:T,gl:z,groups:B,markerCache:H,markerTextures:F,palette:D,paletteIds:R,paletteTexture:I,maxColors:G,maxSize:J,canvas:z.canvas}),this.update(k);var X={uniforms:{constPointSize:!!k.constPointSize,opacity:T.prop("opacity"),paletteSize:function(re,se){return[P.tooManyColors?0:G,I.height]},pixelRatio:T.context("pixelRatio"),scale:T.prop("scale"),scaleFract:T.prop("scaleFract"),translate:T.prop("translate"),translateFract:T.prop("translateFract"),markerTexture:T.prop("markerTexture"),paletteTexture:I},attributes:{x:function(re,se){return se.xAttr||{buffer:se.positionBuffer,stride:8,offset:0}},y:function(re,se){return se.yAttr||{buffer:se.positionBuffer,stride:8,offset:4}},xFract:function(re,se){return se.xAttr?{constant:[0,0]}:{buffer:se.positionFractBuffer,stride:8,offset:0}},yFract:function(re,se){return se.yAttr?{constant:[0,0]}:{buffer:se.positionFractBuffer,stride:8,offset:4}},size:function(re,se){return se.size.length?{buffer:se.sizeBuffer,stride:2,offset:0}:{constant:[Math.round(se.size*255/P.maxSize)]}},borderSize:function(re,se){return se.borderSize.length?{buffer:se.sizeBuffer,stride:2,offset:1}:{constant:[Math.round(se.borderSize*255/P.maxSize)]}},colorId:function(re,se){return se.color.length?{buffer:se.colorBuffer,stride:P.tooManyColors?8:4,offset:0}:{constant:P.tooManyColors?D.slice(se.color*4,se.color*4+4):[se.color]}},borderColorId:function(re,se){return se.borderColor.length?{buffer:se.colorBuffer,stride:P.tooManyColors?8:4,offset:P.tooManyColors?4:2}:{constant:P.tooManyColors?D.slice(se.borderColor*4,se.borderColor*4+4):[se.borderColor]}},isActive:function(re,se){return se.activation===!0?{constant:[1]}:se.activation?se.activation:{constant:[0]}}},blend:{enable:!0,color:[0,0,0,1],func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},scissor:{enable:!0,box:T.prop("viewport")},viewport:T.prop("viewport"),stencil:{enable:!1},depth:{enable:!1},elements:T.prop("elements"),count:T.prop("count"),offset:T.prop("offset"),primitive:"points"},Y=g({},X);Y.frag=h([`precision highp float;
#define GLSLIFY 1

uniform float opacity;
uniform sampler2D markerTexture;

varying vec4 fragColor, fragBorderColor;
varying float fragWidth, fragBorderColorLevel, fragColorLevel;

float smoothStep(float x, float y) {
  return 1.0 / (1.0 + exp(50.0*(x - y)));
}

void main() {
  float dist = texture2D(markerTexture, gl_PointCoord).r, delta = fragWidth;

  // max-distance alpha
  if (dist < 0.003) discard;

  // null-border case
  if (fragBorderColorLevel == fragColorLevel || fragBorderColor.a == 0.) {
    float colorAmt = smoothstep(.5 - delta, .5 + delta, dist);
    gl_FragColor = vec4(fragColor.rgb, colorAmt * fragColor.a * opacity);
  }
  else {
    float borderColorAmt = smoothstep(fragBorderColorLevel - delta, fragBorderColorLevel + delta, dist);
    float colorAmt = smoothstep(fragColorLevel - delta, fragColorLevel + delta, dist);

    vec4 color = fragBorderColor;
    color.a *= borderColorAmt;
    color = mix(color, fragColor, colorAmt);
    color.a *= opacity;

    gl_FragColor = color;
  }

}
`]),Y.vert=h([`precision highp float;
#define GLSLIFY 1

attribute float x, y, xFract, yFract;
attribute float size, borderSize;
attribute vec4 colorId, borderColorId;
attribute float isActive;

uniform bool constPointSize;
uniform float pixelRatio;
uniform vec2 scale, scaleFract, translate, translateFract, paletteSize;
uniform sampler2D paletteTexture;

const float maxSize = 100.;
const float borderLevel = .5;

varying vec4 fragColor, fragBorderColor;
varying float fragPointSize, fragBorderRadius, fragWidth, fragBorderColorLevel, fragColorLevel;

float pointSizeScale = (constPointSize) ? 2. : pixelRatio;

bool isDirect = (paletteSize.x < 1.);

vec4 getColor(vec4 id) {
  return isDirect ? id / 255. : texture2D(paletteTexture,
    vec2(
      (id.x + .5) / paletteSize.x,
      (id.y + .5) / paletteSize.y
    )
  );
}

void main() {
  // ignore inactive points
  if (isActive == 0.) return;

  vec2 position = vec2(x, y);
  vec2 positionFract = vec2(xFract, yFract);

  vec4 color = getColor(colorId);
  vec4 borderColor = getColor(borderColorId);

  float size = size * maxSize / 255.;
  float borderSize = borderSize * maxSize / 255.;

  gl_PointSize = 2. * size * pointSizeScale;
  fragPointSize = size * pixelRatio;

  vec2 pos = (position + translate) * scale
      + (positionFract + translateFract) * scale
      + (position + translate) * scaleFract
      + (positionFract + translateFract) * scaleFract;

  gl_Position = vec4(pos * 2. - 1., 0., 1.);

  fragColor = color;
  fragBorderColor = borderColor;
  fragWidth = 1. / gl_PointSize;

  fragBorderColorLevel = clamp(borderLevel - borderLevel * borderSize / size, 0., 1.);
  fragColorLevel = clamp(borderLevel + (1. - borderLevel) * borderSize / size, 0., 1.);
}`]),this.drawMarker=T(Y);var Z=g({},X);Z.frag=h([`precision highp float;
#define GLSLIFY 1

varying vec4 fragColor, fragBorderColor;
varying float fragBorderRadius, fragWidth;

uniform float opacity;

float smoothStep(float edge0, float edge1, float x) {
	float t;
	t = clamp((x - edge0) / (edge1 - edge0), 0.0, 1.0);
	return t * t * (3.0 - 2.0 * t);
}

void main() {
	float radius, alpha = 1.0, delta = fragWidth;

	radius = length(2.0 * gl_PointCoord.xy - 1.0);

	if (radius > 1.0 + delta) {
		discard;
	}

	alpha -= smoothstep(1.0 - delta, 1.0 + delta, radius);

	float borderRadius = fragBorderRadius;
	float ratio = smoothstep(borderRadius - delta, borderRadius + delta, radius);
	vec4 color = mix(fragColor, fragBorderColor, ratio);
	color.a *= alpha * opacity;
	gl_FragColor = color;
}
`]),Z.vert=h([`precision highp float;
#define GLSLIFY 1

attribute float x, y, xFract, yFract;
attribute float size, borderSize;
attribute vec4 colorId, borderColorId;
attribute float isActive;

uniform bool constPointSize;
uniform float pixelRatio;
uniform vec2 paletteSize, scale, scaleFract, translate, translateFract;
uniform sampler2D paletteTexture;

const float maxSize = 100.;

varying vec4 fragColor, fragBorderColor;
varying float fragBorderRadius, fragWidth;

float pointSizeScale = (constPointSize) ? 2. : pixelRatio;

bool isDirect = (paletteSize.x < 1.);

vec4 getColor(vec4 id) {
  return isDirect ? id / 255. : texture2D(paletteTexture,
    vec2(
      (id.x + .5) / paletteSize.x,
      (id.y + .5) / paletteSize.y
    )
  );
}

void main() {
  // ignore inactive points
  if (isActive == 0.) return;

  vec2 position = vec2(x, y);
  vec2 positionFract = vec2(xFract, yFract);

  vec4 color = getColor(colorId);
  vec4 borderColor = getColor(borderColorId);

  float size = size * maxSize / 255.;
  float borderSize = borderSize * maxSize / 255.;

  gl_PointSize = (size + borderSize) * pointSizeScale;

  vec2 pos = (position + translate) * scale
      + (positionFract + translateFract) * scale
      + (position + translate) * scaleFract
      + (positionFract + translateFract) * scaleFract;

  gl_Position = vec4(pos * 2. - 1., 0., 1.);

  fragBorderRadius = 1. - 2. * borderSize / (size + borderSize);
  fragColor = color;
  fragBorderColor = borderColor.a == 0. || borderSize == 0. ? vec4(color.rgb, 0.) : borderColor;
  fragWidth = 1. / gl_PointSize;
}
`]),s&&(Z.frag=Z.frag.replace("smoothstep","smoothStep"),Y.frag=Y.frag.replace("smoothstep","smoothStep")),this.drawCircle=T(Z)}x.defaults={color:"black",borderColor:"transparent",borderSize:0,size:12,opacity:1,marker:void 0,viewport:null,range:null,pixelSize:null,count:0,offset:0,bounds:null,positions:[],snap:1e4},x.prototype.render=function(){return arguments.length&&this.update.apply(this,arguments),this.draw(),this},x.prototype.draw=function(){for(var T=this,k=arguments.length,P=new Array(k),z=0;z<k;z++)P[z]=arguments[z];var I=this.groups;if(P.length===1&&Array.isArray(P[0])&&(P[0][0]===null||Array.isArray(P[0][0]))&&(P=P[0]),this.regl._refresh(),P.length)for(var D=0;D<P.length;D++)this.drawItem(D,P[D]);else I.forEach(function(R,B){T.drawItem(B)});return this},x.prototype.drawItem=function(T,k){var P=this.groups,z=P[T];if(typeof k=="number"&&(T=k,z=P[k],k=null),!!(z&&z.count&&z.opacity)){z.activation[0]&&this.drawCircle(this.getMarkerDrawOptions(0,z,k));for(var I=[],D=1;D<z.activation.length;D++)!z.activation[D]||z.activation[D]!==!0&&!z.activation[D].data.length||I.push.apply(I,v(this.getMarkerDrawOptions(D,z,k)));I.length&&this.drawMarker(I)}},x.prototype.getMarkerDrawOptions=function(T,k,P){var z=k.range,I=k.tree,D=k.viewport,R=k.activation,B=k.selectionBuffer,F=k.count;if(this.regl,!I)return P?[g({},k,{markerTexture:this.markerTextures[T],activation:R[T],count:P.length,elements:P,offset:0})]:[g({},k,{markerTexture:this.markerTextures[T],activation:R[T],offset:0})];var H=[],G=I.range(z,{lod:!0,px:[(z[2]-z[0])/D.width,(z[3]-z[1])/D.height]});if(P){for(var J=R[T],X=J.data,Y=new Uint8Array(F),Z=0;Z<P.length;Z++){var oe=P[Z];Y[oe]=X?X[oe]:1}B.subdata(Y)}for(var re=G.length;re--;){var se=w(G[re],2),N=se[0],U=se[1];H.push(g({},k,{markerTexture:this.markerTextures[T],activation:P?B:R[T],offset:N,count:U-N}))}return H},x.prototype.update=function(){for(var T=this,k=arguments.length,P=new Array(k),z=0;z<k;z++)P[z]=arguments[z];if(!!P.length){P.length===1&&Array.isArray(P[0])&&(P=P[0]);var I=this.groups,D=this.gl,R=this.regl,B=this.maxSize,F=this.maxColors,H=this.palette;this.groups=I=P.map(function(G,J){var X=I[J];if(G===void 0)return X;G===null?G={positions:null}:typeof G=="function"?G={ondraw:G}:typeof G[0]=="number"&&(G={positions:G}),G=m(G,{positions:"positions data points",snap:"snap cluster lod tree",size:"sizes size radius",borderSize:"borderSizes borderSize border-size bordersize borderWidth borderWidths border-width borderwidth stroke-width strokeWidth strokewidth outline",color:"colors color fill fill-color fillColor",borderColor:"borderColors borderColor stroke stroke-color strokeColor",marker:"markers marker shape",range:"range dataBox databox",viewport:"viewport viewPort viewBox viewbox",opacity:"opacity alpha transparency",bounds:"bound bounds boundaries limits",tooManyColors:"tooManyColors palette paletteMode optimizePalette enablePalette"}),G.positions===null&&(G.positions=[]),G.tooManyColors!=null&&(T.tooManyColors=G.tooManyColors),X||(I[J]=X={id:J,scale:null,translate:null,scaleFract:null,translateFract:null,activation:[],selectionBuffer:R.buffer({data:new Uint8Array(0),usage:"stream",type:"uint8"}),sizeBuffer:R.buffer({data:new Uint8Array(0),usage:"dynamic",type:"uint8"}),colorBuffer:R.buffer({data:new Uint8Array(0),usage:"dynamic",type:"uint8"}),positionBuffer:R.buffer({data:new Uint8Array(0),usage:"dynamic",type:"float"}),positionFractBuffer:R.buffer({data:new Uint8Array(0),usage:"dynamic",type:"float"})},G=g({},x.defaults,G)),G.positions&&!("marker"in G)&&(G.marker=X.marker,delete X.marker),G.marker&&!("positions"in G)&&(G.positions=X.positions,delete X.positions);var Y=0,Z=0;if(u(X,G,[{snap:!0,size:function(_e,ze){return _e==null&&(_e=x.defaults.size),Y+=_e&&_e.length?1:0,_e},borderSize:function(_e,ze){return _e==null&&(_e=x.defaults.borderSize),Y+=_e&&_e.length?1:0,_e},opacity:parseFloat,color:function(_e,ze){return _e==null&&(_e=x.defaults.color),_e=T.updateColor(_e),Z++,_e},borderColor:function(_e,ze){return _e==null&&(_e=x.defaults.borderColor),_e=T.updateColor(_e),Z++,_e},bounds:function(_e,ze,Oe){return"range"in Oe||(Oe.range=null),_e},positions:function(_e,ze,Oe){var Ye=ze.snap,be=ze.positionBuffer,Pe=ze.positionFractBuffer,Ge=ze.selectionBuffer;if(_e.x||_e.y)return _e.x.length?ze.xAttr={buffer:R.buffer(_e.x),offset:0,stride:4,count:_e.x.length}:ze.xAttr={buffer:_e.x.buffer,offset:_e.x.offset*4||0,stride:(_e.x.stride||1)*4,count:_e.x.count},_e.y.length?ze.yAttr={buffer:R.buffer(_e.y),offset:0,stride:4,count:_e.y.length}:ze.yAttr={buffer:_e.y.buffer,offset:_e.y.offset*4||0,stride:(_e.y.stride||1)*4,count:_e.y.count},ze.count=Math.max(ze.xAttr.count,ze.yAttr.count),_e;_e=_(_e,"float64");var Qe=ze.count=Math.floor(_e.length/2),Be=ze.bounds=Qe?i(_e,2):null;if(!Oe.range&&!ze.range&&(delete ze.range,Oe.range=Be),!Oe.marker&&!ze.marker&&(delete ze.marker,Oe.marker=null),Ye&&(Ye===!0||Qe>Ye)?ze.tree=p(_e,{bounds:Be}):Ye&&Ye.length&&(ze.tree=Ye),ze.tree){var Le={primitive:"points",usage:"static",data:ze.tree,type:"uint32"};ze.elements?ze.elements(Le):ze.elements=R.elements(Le)}var He=A.float32(_e);be({data:He,usage:"dynamic"});var vt=A.fract32(_e,He);return Pe({data:vt,usage:"dynamic"}),Ge({data:new Uint8Array(Qe),type:"uint8",usage:"stream"}),_e}},{marker:function(_e,ze,Oe){var Ye=ze.activation;if(Ye.forEach(function(vt){return vt&&vt.destroy&&vt.destroy()}),Ye.length=0,!_e||typeof _e[0]=="number"){var be=T.addMarker(_e);Ye[be]=!0}else{for(var Pe=[],Ge=0,Qe=Math.min(_e.length,ze.count);Ge<Qe;Ge++){var Be=T.addMarker(_e[Ge]);Pe[Be]||(Pe[Be]=new Uint8Array(ze.count)),Pe[Be][Ge]=1}for(var Le=0;Le<Pe.length;Le++)if(!!Pe[Le]){var He={data:Pe[Le],type:"uint8",usage:"static"};Ye[Le]?Ye[Le](He):Ye[Le]=R.buffer(He),Ye[Le].data=Pe[Le]}}return _e},range:function(_e,ze,Oe){var Ye=ze.bounds;if(!!Ye)return _e||(_e=Ye),ze.scale=[1/(_e[2]-_e[0]),1/(_e[3]-_e[1])],ze.translate=[-_e[0],-_e[1]],ze.scaleFract=A.fract(ze.scale),ze.translateFract=A.fract(ze.translate),_e},viewport:function(_e){var ze=b(_e||[D.drawingBufferWidth,D.drawingBufferHeight]);return ze}}]),Y){var oe=X,re=oe.count,se=oe.size,N=oe.borderSize,U=oe.sizeBuffer,q=new Uint8Array(re*2);if(se.length||N.length)for(var $=0;$<re;$++)q[$*2]=Math.round((se[$]==null?se:se[$])*255/B),q[$*2+1]=Math.round((N[$]==null?N:N[$])*255/B);U({data:q,usage:"dynamic"})}if(Z){var W=X,K=W.count,ne=W.color,ae=W.borderColor,ie=W.colorBuffer,le;if(T.tooManyColors){if(ne.length||ae.length){le=new Uint8Array(K*8);for(var ye=0;ye<K;ye++){var ue=ne[ye];le[ye*8]=H[ue*4],le[ye*8+1]=H[ue*4+1],le[ye*8+2]=H[ue*4+2],le[ye*8+3]=H[ue*4+3];var pe=ae[ye];le[ye*8+4]=H[pe*4],le[ye*8+5]=H[pe*4+1],le[ye*8+6]=H[pe*4+2],le[ye*8+7]=H[pe*4+3]}}}else if(ne.length||ae.length){le=new Uint8Array(K*4+2);for(var ge=0;ge<K;ge++)ne[ge]!=null&&(le[ge*4]=ne[ge]%F,le[ge*4+1]=Math.floor(ne[ge]/F)),ae[ge]!=null&&(le[ge*4+2]=ae[ge]%F,le[ge*4+3]=Math.floor(ae[ge]/F))}ie({data:le||new Uint8Array(0),type:"uint8",usage:"dynamic"})}return X})}},x.prototype.addMarker=function(T){var k=this.markerTextures,P=this.regl,z=this.markerCache,I=T==null?0:z.indexOf(T);if(I>=0)return I;var D;if(T instanceof Uint8Array||T instanceof Uint8ClampedArray)D=T;else{D=new Uint8Array(T.length);for(var R=0,B=T.length;R<B;R++)D[R]=T[R]*255}var F=Math.floor(Math.sqrt(D.length));return I=k.length,z.push(T),k.push(P.texture({channels:1,data:D,radius:F,mag:"linear",min:"linear"})),I},x.prototype.updateColor=function(T){var k=this.paletteIds,P=this.palette,z=this.maxColors;Array.isArray(T)||(T=[T]);var I=[];if(typeof T[0]=="number"){var D=[];if(Array.isArray(T))for(var R=0;R<T.length;R+=4)D.push(T.slice(R,R+4));else for(var B=0;B<T.length;B+=4)D.push(T.subarray(B,B+4));T=D}for(var F=0;F<T.length;F++){var H=T[F];H=o(H,"uint8");var G=y(H,!1);if(k[G]==null){var J=P.length;k[G]=Math.floor(J/4),P[J]=H[0],P[J+1]=H[1],P[J+2]=H[2],P[J+3]=H[3]}I[F]=k[G]}return!this.tooManyColors&&P.length>z*4&&(this.tooManyColors=!0),this.updatePalette(P),I.length===1?I[0]:I},x.prototype.updatePalette=function(T){if(!this.tooManyColors){var k=this.maxColors,P=this.paletteTexture,z=Math.ceil(T.length*.25/k);if(z>1){T=T.slice();for(var I=T.length*.25%k;I<z*k;I++)T.push(0,0,0,0)}P.height<z&&P.resize(k,z),P.subimage({width:Math.min(T.length*.25,k),height:z,data:T},0,0)}},x.prototype.destroy=function(){return this.groups.forEach(function(T){T.sizeBuffer.destroy(),T.positionBuffer.destroy(),T.positionFractBuffer.destroy(),T.colorBuffer.destroy(),T.activation.forEach(function(k){return k&&k.destroy&&k.destroy()}),T.selectionBuffer.destroy(),T.elements&&T.elements.destroy()}),this.groups.length=0,this.paletteTexture.destroy(),this.markerTextures.forEach(function(T){return T&&T.destroy&&T.destroy()}),this};var l=d("object-assign"),L=function(k,P){var z=new f(k,P),I=z.render.bind(z);return l(I,{render:I,update:z.update.bind(z),draw:z.draw.bind(z),destroy:z.destroy.bind(z),regl:z.regl,gl:z.gl,canvas:z.gl.canvas,groups:z.groups,markers:z.markerCache,palette:z.palette}),I};ee.exports=L},{"@plotly/point-cluster":59,"array-bounds":71,"color-id":87,"color-normalize":89,"flatten-vertex-data":191,glslify:227,"is-iexplorer":233,"object-assign":247,"parse-rect":249,"pick-by-alias":253,"to-float32":314,"update-diff":330}],283:[function(d,ee,te){var w=d("regl-scatter2d"),v=d("pick-by-alias"),S=d("array-bounds"),M=d("raf"),e=d("array-range"),a=d("parse-rect"),n=d("flatten-vertex-data");ee.exports=r;function r(i,y){if(!(this instanceof r))return new r(i);this.traces=[],this.passes={},this.regl=i,this.scatter=w(i),this.canvas=this.scatter.canvas}r.prototype.render=function(){for(var i=this,y,p=[],g=arguments.length;g--;)p[g]=arguments[g];return p.length&&(y=this).update.apply(y,p),this.regl.attributes.preserveDrawingBuffer?this.draw():(this.dirty?this.planned==null&&(this.planned=M(function(){i.draw(),i.dirty=!0,i.planned=null})):(this.draw(),this.dirty=!0,M(function(){i.dirty=!1})),this)},r.prototype.update=function(){for(var i,y=[],p=arguments.length;p--;)y[p]=arguments[p];if(!!y.length){for(var g=0;g<y.length;g++)this.updateItem(g,y[g]);this.traces=this.traces.filter(Boolean);for(var h=[],m=0,u=0;u<this.traces.length;u++){for(var _=this.traces[u],s=this.traces[u].passes,A=0;A<s.length;A++)h.push(this.passes[s[A]]);_.passOffset=m,m+=_.passes.length}return(i=this.scatter).update.apply(i,h),this}},r.prototype.updateItem=function(i,y){var p=this,g=p.regl;if(y===null)return this.traces[i]=null,this;if(!y)return this;var h=v(y,{data:"data items columns rows values dimensions samples x",snap:"snap cluster",size:"sizes size radius",color:"colors color fill fill-color fillColor",opacity:"opacity alpha transparency opaque",borderSize:"borderSizes borderSize border-size bordersize borderWidth borderWidths border-width borderwidth stroke-width strokeWidth strokewidth outline",borderColor:"borderColors borderColor bordercolor stroke stroke-color strokeColor",marker:"markers marker shape",range:"range ranges databox dataBox",viewport:"viewport viewBox viewbox",domain:"domain domains area areas",padding:"pad padding paddings pads margin margins",transpose:"transpose transposed",diagonal:"diagonal diag showDiagonal",upper:"upper up top upperhalf upperHalf showupperhalf showUpper showUpperHalf",lower:"lower low bottom lowerhalf lowerHalf showlowerhalf showLowerHalf showLower"}),m=this.traces[i]||(this.traces[i]={id:i,buffer:g.buffer({usage:"dynamic",type:"float",data:new Uint8Array}),color:"black",marker:null,size:12,borderColor:"transparent",borderSize:1,viewport:a([g._gl.drawingBufferWidth,g._gl.drawingBufferHeight]),padding:[0,0,0,0],opacity:1,diagonal:!0,upper:!0,lower:!0});if(h.color!=null&&(m.color=h.color),h.size!=null&&(m.size=h.size),h.marker!=null&&(m.marker=h.marker),h.borderColor!=null&&(m.borderColor=h.borderColor),h.borderSize!=null&&(m.borderSize=h.borderSize),h.opacity!=null&&(m.opacity=h.opacity),h.viewport&&(m.viewport=a(h.viewport)),h.diagonal!=null&&(m.diagonal=h.diagonal),h.upper!=null&&(m.upper=h.upper),h.lower!=null&&(m.lower=h.lower),h.data){m.buffer(n(h.data)),m.columns=h.data.length,m.count=h.data[0].length,m.bounds=[];for(var u=0;u<m.columns;u++)m.bounds[u]=S(h.data[u],1)}var _;h.range&&(m.range=h.range,_=m.range&&typeof m.range[0]!="number"),h.domain&&(m.domain=h.domain);var s=!1;h.padding!=null&&(Array.isArray(h.padding)&&h.padding.length===m.columns&&typeof h.padding[h.padding.length-1]=="number"?(m.padding=h.padding.map(o),s=!0):m.padding=o(h.padding));var A=m.columns,b=m.count,f=m.viewport.width,x=m.viewport.height,l=m.viewport.x,L=m.viewport.y,T=f/A,k=x/A;m.passes=[];for(var P=0;P<A;P++)for(var z=0;z<A;z++)if(!(!m.diagonal&&z===P)&&!(!m.upper&&P>z)&&!(!m.lower&&P<z)){var I=t(m.id,P,z),D=this.passes[I]||(this.passes[I]={});if(h.data&&(h.transpose?D.positions={x:{buffer:m.buffer,offset:z,count:b,stride:A},y:{buffer:m.buffer,offset:P,count:b,stride:A}}:D.positions={x:{buffer:m.buffer,offset:z*b,count:b},y:{buffer:m.buffer,offset:P*b,count:b}},D.bounds=c(m.bounds,P,z)),h.domain||h.viewport||h.data){var R=s?c(m.padding,P,z):m.padding;if(m.domain){var B=c(m.domain,P,z),F=B[0],H=B[1],G=B[2],J=B[3];D.viewport=[l+F*f+R[0],L+H*x+R[1],l+G*f-R[2],L+J*x-R[3]]}else D.viewport=[l+z*T+T*R[0],L+P*k+k*R[1],l+(z+1)*T-T*R[2],L+(P+1)*k-k*R[3]]}h.color&&(D.color=m.color),h.size&&(D.size=m.size),h.marker&&(D.marker=m.marker),h.borderSize&&(D.borderSize=m.borderSize),h.borderColor&&(D.borderColor=m.borderColor),h.opacity&&(D.opacity=m.opacity),h.range&&(D.range=_?c(m.range,P,z):m.range||D.bounds),m.passes.push(I)}return this},r.prototype.draw=function(){for(var i,y=[],p=arguments.length;p--;)y[p]=arguments[p];if(!y.length)this.scatter.draw();else{for(var g=[],h=0;h<y.length;h++)if(typeof y[h]=="number"){var m=this.traces[y[h]],u=m.passes,_=m.passOffset;g.push.apply(g,e(_,_+u.length))}else if(y[h].length){var s=y[h],A=this.traces[h],b=A.passes,f=A.passOffset;b=b.map(function(x,l){g[f+l]=s})}(i=this.scatter).draw.apply(i,g)}return this},r.prototype.destroy=function(){return this.traces.forEach(function(i){i.buffer&&i.buffer.destroy&&i.buffer.destroy()}),this.traces=null,this.passes=null,this.scatter.destroy(),this};function t(i,y,p){var g=i.id!=null?i.id:i,h=y,m=p,u=g<<16|(h&255)<<8|m&255;return u}function c(i,y,p){var g,h,m,u,_=i[y],s=i[p];return _.length>2?(_[0],_[2],g=_[1],h=_[3]):_.length?(g=_[0],h=_[1]):(_.x,g=_.y,_.x+_.width,h=_.y+_.height),s.length>2?(m=s[0],u=s[2],s[1],s[3]):s.length?(m=s[0],u=s[1]):(m=s.x,s.y,u=s.x+s.width,s.y+s.height),[m,g,u,h]}function o(i){if(typeof i=="number")return[i,i,i,i];if(i.length===2)return[i[0],i[1],i[0],i[1]];var y=a(i);return[y.x,y.y,y.x+y.width,y.y+y.height]}},{"array-bounds":71,"array-range":74,"flatten-vertex-data":191,"parse-rect":249,"pick-by-alias":253,raf:279,"regl-scatter2d":282}],284:[function(d,ee,te){(function(w,v){typeof te=="object"&&typeof ee<"u"?ee.exports=v():w.createREGL=v()})(this,function(){function w(at,Jt){this.id=ye++,this.type=at,this.data=Jt}function v(at){if(at.length===0)return[];var Jt=at.charAt(0),Zt=at.charAt(at.length-1);if(1<at.length&&Jt===Zt&&(Jt==='"'||Jt==="'"))return['"'+at.substr(1,at.length-2).replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];if(Jt=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(at))return v(at.substr(0,Jt.index)).concat(v(Jt[1])).concat(v(at.substr(Jt.index+Jt[0].length)));if(Jt=at.split("."),Jt.length===1)return['"'+at.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];for(at=[],Zt=0;Zt<Jt.length;++Zt)at=at.concat(v(Jt[Zt]));return at}function S(at){return"["+v(at).join("][")+"]"}function M(at,Jt){if(typeof at=="function")return new w(0,at);if(typeof at=="number"||typeof at=="boolean")return new w(5,at);if(Array.isArray(at))return new w(6,at.map(function(Zt,Ut){return M(Zt)}));if(at instanceof w)return at}function e(){var at={"":0},Jt=[""];return{id:function(Zt){var Ut=at[Zt];return Ut||(Ut=at[Zt]=Jt.length,Jt.push(Zt),Ut)},str:function(Zt){return Jt[Zt]}}}function a(at,Jt,Zt){function Ut(){var Ke=window.innerWidth,st=window.innerHeight;at!==document.body&&(st=_r.getBoundingClientRect(),Ke=st.right-st.left,st=st.bottom-st.top),_r.width=Zt*Ke,_r.height=Zt*st}var _r=document.createElement("canvas");le(_r.style,{border:0,margin:0,padding:0,top:0,left:0,width:"100%",height:"100%"}),at.appendChild(_r),at===document.body&&(_r.style.position="absolute",le(at.style,{margin:0,padding:0}));var rt;return at!==document.body&&typeof ResizeObserver=="function"?(rt=new ResizeObserver(function(){setTimeout(Ut)}),rt.observe(at)):window.addEventListener("resize",Ut,!1),Ut(),{canvas:_r,onDestroy:function(){rt?rt.disconnect():window.removeEventListener("resize",Ut),at.removeChild(_r)}}}function n(at,Jt){function Zt(Ut){try{return at.getContext(Ut,Jt)}catch{return null}}return Zt("webgl")||Zt("experimental-webgl")||Zt("webgl-experimental")}function r(at){return typeof at=="string"?at.split():at}function t(at){return typeof at=="string"?document.querySelector(at):at}function c(at){var Jt=at||{},Zt,Ut,_r,rt;at={};var Ke=[],st=[],lt=typeof window>"u"?1:window.devicePixelRatio,wt=!1,Pt={},ke=function(nt){},Se=function(){};if(typeof Jt=="string"?Zt=document.querySelector(Jt):typeof Jt=="object"&&(typeof Jt.nodeName=="string"&&typeof Jt.appendChild=="function"&&typeof Jt.getBoundingClientRect=="function"?Zt=Jt:typeof Jt.drawArrays=="function"||typeof Jt.drawElements=="function"?(rt=Jt,_r=rt.canvas):("gl"in Jt?rt=Jt.gl:"canvas"in Jt?_r=t(Jt.canvas):"container"in Jt&&(Ut=t(Jt.container)),"attributes"in Jt&&(at=Jt.attributes),"extensions"in Jt&&(Ke=r(Jt.extensions)),"optionalExtensions"in Jt&&(st=r(Jt.optionalExtensions)),"onDone"in Jt&&(ke=Jt.onDone),"profile"in Jt&&(wt=!!Jt.profile),"pixelRatio"in Jt&&(lt=+Jt.pixelRatio),"cachedCode"in Jt&&(Pt=Jt.cachedCode))),Zt&&(Zt.nodeName.toLowerCase()==="canvas"?_r=Zt:Ut=Zt),!rt){if(!_r){if(Zt=a(Ut||document.body,ke,lt),!Zt)return null;_r=Zt.canvas,Se=Zt.onDestroy}at.premultipliedAlpha===void 0&&(at.premultipliedAlpha=!0),rt=n(_r,at)}return rt?{gl:rt,canvas:_r,container:Ut,extensions:Ke,optionalExtensions:st,pixelRatio:lt,profile:wt,cachedCode:Pt,onDone:ke,onDestroy:Se}:(Se(),ke("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function o(at,Jt){function Zt(Ke){Ke=Ke.toLowerCase();var st;try{st=Ut[Ke]=at.getExtension(Ke)}catch{}return!!st}for(var Ut={},_r=0;_r<Jt.extensions.length;++_r){var rt=Jt.extensions[_r];if(!Zt(rt))return Jt.onDestroy(),Jt.onDone('"'+rt+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return Jt.optionalExtensions.forEach(Zt),{extensions:Ut,restore:function(){Object.keys(Ut).forEach(function(Ke){if(Ut[Ke]&&!Zt(Ke))throw Error("(regl): error restoring extension "+Ke)})}}}function i(at,Jt){for(var Zt=Array(at),Ut=0;Ut<at;++Ut)Zt[Ut]=Jt(Ut);return Zt}function y(at){var Jt,Zt;return Jt=(65535<at)<<4,at>>>=Jt,Zt=(255<at)<<3,at>>>=Zt,Jt|=Zt,Zt=(15<at)<<2,at>>>=Zt,Jt|=Zt,Zt=(3<at)<<1,Jt|Zt|at>>>Zt>>1}function p(){function at(Ut){e:{for(var _r=16;268435456>=_r;_r*=16)if(Ut<=_r){Ut=_r;break e}Ut=0}return _r=Zt[y(Ut)>>2],0<_r.length?_r.pop():new ArrayBuffer(Ut)}function Jt(Ut){Zt[y(Ut.byteLength)>>2].push(Ut)}var Zt=i(8,function(){return[]});return{alloc:at,free:Jt,allocType:function(Ut,_r){var rt=null;switch(Ut){case 5120:rt=new Int8Array(at(_r),0,_r);break;case 5121:rt=new Uint8Array(at(_r),0,_r);break;case 5122:rt=new Int16Array(at(2*_r),0,_r);break;case 5123:rt=new Uint16Array(at(2*_r),0,_r);break;case 5124:rt=new Int32Array(at(4*_r),0,_r);break;case 5125:rt=new Uint32Array(at(4*_r),0,_r);break;case 5126:rt=new Float32Array(at(4*_r),0,_r);break;default:return null}return rt.length!==_r?rt.subarray(0,_r):rt},freeType:function(Ut){Jt(Ut.buffer)}}}function g(at){return!!at&&typeof at=="object"&&Array.isArray(at.shape)&&Array.isArray(at.stride)&&typeof at.offset=="number"&&at.shape.length===at.stride.length&&(Array.isArray(at.data)||ze(at.data))}function h(at,Jt,Zt,Ut,_r,rt){for(var Ke=0;Ke<Jt;++Ke)for(var st=at[Ke],lt=0;lt<Zt;++lt)for(var wt=st[lt],Pt=0;Pt<Ut;++Pt)_r[rt++]=wt[Pt]}function m(at,Jt,Zt,Ut,_r){for(var rt=1,Ke=Zt+1;Ke<Jt.length;++Ke)rt*=Jt[Ke];var st=Jt[Zt];if(Jt.length-Zt===4){var lt=Jt[Zt+1],wt=Jt[Zt+2];for(Jt=Jt[Zt+3],Ke=0;Ke<st;++Ke)h(at[Ke],lt,wt,Jt,Ut,_r),_r+=rt}else for(Ke=0;Ke<st;++Ke)m(at[Ke],Jt,Zt+1,Ut,_r),_r+=rt}function u(at){return be[Object.prototype.toString.call(at)]|0}function _(at,Jt){for(var Zt=0;Zt<Jt.length;++Zt)at[Zt]=Jt[Zt]}function s(at,Jt,Zt,Ut,_r,rt,Ke){for(var st=0,lt=0;lt<Zt;++lt)for(var wt=0;wt<Ut;++wt)at[st++]=Jt[_r*lt+rt*wt+Ke]}function A(at,Jt,Zt,Ut){function _r(ke){this.id=lt++,this.buffer=at.createBuffer(),this.type=ke,this.usage=35044,this.byteLength=0,this.dimension=1,this.dtype=5121,this.persistentData=null,Zt.profile&&(this.stats={size:0})}function rt(ke,Se,nt){ke.byteLength=Se.byteLength,at.bufferData(ke.type,Se,nt)}function Ke(ke,Se,nt,it,ct,At){if(ke.usage=nt,Array.isArray(Se)){if(ke.dtype=it||5126,0<Se.length)if(Array.isArray(Se[0])){ct=Be(Se);for(var dt=it=1;dt<ct.length;++dt)it*=ct[dt];ke.dimension=it,Se=Qe(Se,ct,ke.dtype),rt(ke,Se,nt),At?ke.persistentData=Se:Te.freeType(Se)}else typeof Se[0]=="number"?(ke.dimension=ct,ct=Te.allocType(ke.dtype,Se.length),_(ct,Se),rt(ke,ct,nt),At?ke.persistentData=ct:Te.freeType(ct)):ze(Se[0])&&(ke.dimension=Se[0].length,ke.dtype=it||u(Se[0])||5126,Se=Qe(Se,[Se.length,Se[0].length],ke.dtype),rt(ke,Se,nt),At?ke.persistentData=Se:Te.freeType(Se))}else if(ze(Se))ke.dtype=it||u(Se),ke.dimension=ct,rt(ke,Se,nt),At&&(ke.persistentData=new Uint8Array(new Uint8Array(Se.buffer)));else if(g(Se)){ct=Se.shape;var Tt=Se.stride,dt=Se.offset,Ht=0,ir=0,kr=0,br=0;ct.length===1?(Ht=ct[0],ir=1,kr=Tt[0],br=0):ct.length===2&&(Ht=ct[0],ir=ct[1],kr=Tt[0],br=Tt[1]),ke.dtype=it||u(Se.data)||5126,ke.dimension=ir,ct=Te.allocType(ke.dtype,Ht*ir),s(ct,Se.data,Ht,ir,kr,br,dt),rt(ke,ct,nt),At?ke.persistentData=ct:Te.freeType(ct)}else Se instanceof ArrayBuffer&&(ke.dtype=5121,ke.dimension=ct,rt(ke,Se,nt),At&&(ke.persistentData=new Uint8Array(new Uint8Array(Se))))}function st(ke){Jt.bufferCount--,Ut(ke),at.deleteBuffer(ke.buffer),ke.buffer=null,delete wt[ke.id]}var lt=0,wt={};_r.prototype.bind=function(){at.bindBuffer(this.type,this.buffer)},_r.prototype.destroy=function(){st(this)};var Pt=[];return Zt.profile&&(Jt.getTotalBufferSize=function(){var ke=0;return Object.keys(wt).forEach(function(Se){ke+=wt[Se].stats.size}),ke}),{create:function(ke,Se,nt,it){function ct(dt){var Tt=35044,Ht=null,ir=0,kr=0,br=1;return Array.isArray(dt)||ze(dt)||g(dt)||dt instanceof ArrayBuffer?Ht=dt:typeof dt=="number"?ir=dt|0:dt&&("data"in dt&&(Ht=dt.data),"usage"in dt&&(Tt=Ge[dt.usage]),"type"in dt&&(kr=Pe[dt.type]),"dimension"in dt&&(br=dt.dimension|0),"length"in dt&&(ir=dt.length|0)),At.bind(),Ht?Ke(At,Ht,Tt,kr,br,it):(ir&&at.bufferData(At.type,ir,Tt),At.dtype=kr||5121,At.usage=Tt,At.dimension=br,At.byteLength=ir),Zt.profile&&(At.stats.size=At.byteLength*Le[At.dtype]),ct}Jt.bufferCount++;var At=new _r(Se);return wt[At.id]=At,nt||ct(ke),ct._reglType="buffer",ct._buffer=At,ct.subdata=function(dt,Tt){var Ht=(Tt||0)|0,ir;if(At.bind(),ze(dt)||dt instanceof ArrayBuffer)at.bufferSubData(At.type,Ht,dt);else if(Array.isArray(dt)){if(0<dt.length)if(typeof dt[0]=="number"){var kr=Te.allocType(At.dtype,dt.length);_(kr,dt),at.bufferSubData(At.type,Ht,kr),Te.freeType(kr)}else(Array.isArray(dt[0])||ze(dt[0]))&&(ir=Be(dt),kr=Qe(dt,ir,At.dtype),at.bufferSubData(At.type,Ht,kr),Te.freeType(kr))}else if(g(dt)){ir=dt.shape;var br=dt.stride,Mr=kr=0,Hr=0,nr=0;ir.length===1?(kr=ir[0],Mr=1,Hr=br[0],nr=0):ir.length===2&&(kr=ir[0],Mr=ir[1],Hr=br[0],nr=br[1]),ir=Array.isArray(dt.data)?At.dtype:u(dt.data),ir=Te.allocType(ir,kr*Mr),s(ir,dt.data,kr,Mr,Hr,nr,dt.offset),at.bufferSubData(At.type,Ht,ir),Te.freeType(ir)}return ct},Zt.profile&&(ct.stats=At.stats),ct.destroy=function(){st(At)},ct},createStream:function(ke,Se){var nt=Pt.pop();return nt||(nt=new _r(ke)),nt.bind(),Ke(nt,Se,35040,0,1,!1),nt},destroyStream:function(ke){Pt.push(ke)},clear:function(){Oe(wt).forEach(st),Pt.forEach(st)},getBuffer:function(ke){return ke&&ke._buffer instanceof _r?ke._buffer:null},restore:function(){Oe(wt).forEach(function(ke){ke.buffer=at.createBuffer(),at.bindBuffer(ke.type,ke.buffer),at.bufferData(ke.type,ke.persistentData||ke.byteLength,ke.usage)})},_initBuffer:Ke}}function b(at,Jt,Zt,Ut){function _r(ke){this.id=lt++,st[this.id]=this,this.buffer=ke,this.primType=4,this.type=this.vertCount=0}function rt(ke,Se,nt,it,ct,At,dt){ke.buffer.bind();var Tt;if(Se?((Tt=dt)||ze(Se)&&(!g(Se)||ze(Se.data))||(Tt=Jt.oes_element_index_uint?5125:5123),Zt._initBuffer(ke.buffer,Se,nt,Tt,3)):(at.bufferData(34963,At,nt),ke.buffer.dtype=Tt||5121,ke.buffer.usage=nt,ke.buffer.dimension=3,ke.buffer.byteLength=At),Tt=dt,!dt){switch(ke.buffer.dtype){case 5121:case 5120:Tt=5121;break;case 5123:case 5122:Tt=5123;break;case 5125:case 5124:Tt=5125}ke.buffer.dtype=Tt}ke.type=Tt,Se=ct,0>Se&&(Se=ke.buffer.byteLength,Tt===5123?Se>>=1:Tt===5125&&(Se>>=2)),ke.vertCount=Se,Se=it,0>it&&(Se=4,it=ke.buffer.dimension,it===1&&(Se=0),it===2&&(Se=1),it===3&&(Se=4)),ke.primType=Se}function Ke(ke){Ut.elementsCount--,delete st[ke.id],ke.buffer.destroy(),ke.buffer=null}var st={},lt=0,wt={uint8:5121,uint16:5123};Jt.oes_element_index_uint&&(wt.uint32=5125),_r.prototype.bind=function(){this.buffer.bind()};var Pt=[];return{create:function(ke,Se){function nt(At){if(At)if(typeof At=="number")it(At),ct.primType=4,ct.vertCount=At|0,ct.type=5121;else{var dt=null,Tt=35044,Ht=-1,ir=-1,kr=0,br=0;Array.isArray(At)||ze(At)||g(At)?dt=At:("data"in At&&(dt=At.data),"usage"in At&&(Tt=Ge[At.usage]),"primitive"in At&&(Ht=He[At.primitive]),"count"in At&&(ir=At.count|0),"type"in At&&(br=wt[At.type]),"length"in At?kr=At.length|0:(kr=ir,br===5123||br===5122?kr*=2:(br===5125||br===5124)&&(kr*=4))),rt(ct,dt,Tt,Ht,ir,kr,br)}else it(),ct.primType=4,ct.vertCount=0,ct.type=5121;return nt}var it=Zt.create(null,34963,!0),ct=new _r(it._buffer);return Ut.elementsCount++,nt(ke),nt._reglType="elements",nt._elements=ct,nt.subdata=function(At,dt){return it.subdata(At,dt),nt},nt.destroy=function(){Ke(ct)},nt},createStream:function(ke){var Se=Pt.pop();return Se||(Se=new _r(Zt.create(null,34963,!0,!1)._buffer)),rt(Se,ke,35040,-1,-1,0,0),Se},destroyStream:function(ke){Pt.push(ke)},getElements:function(ke){return typeof ke=="function"&&ke._elements instanceof _r?ke._elements:null},clear:function(){Oe(st).forEach(Ke)}}}function f(at){for(var Jt=Te.allocType(5123,at.length),Zt=0;Zt<at.length;++Zt)if(isNaN(at[Zt]))Jt[Zt]=65535;else if(at[Zt]===1/0)Jt[Zt]=31744;else if(at[Zt]===-1/0)Jt[Zt]=64512;else{vt[0]=at[Zt];var rt=Rt[0],Ut=rt>>>31<<15,_r=(rt<<1>>>24)-127,rt=rt>>13&1023;Jt[Zt]=-24>_r?Ut:-14>_r?Ut+(rt+1024>>-14-_r):15<_r?Ut+31744:Ut+(_r+15<<10)+rt}return Jt}function x(at){return Array.isArray(at)||ze(at)}function l(at){return"[object "+at+"]"}function L(at){return Array.isArray(at)&&(at.length===0||typeof at[0]=="number")}function T(at){return!!(Array.isArray(at)&&at.length!==0&&x(at[0]))}function k(at){return Object.prototype.toString.call(at)}function P(at){if(!at)return!1;var Jt=k(at);return 0<=Ae.indexOf(Jt)?!0:L(at)||T(at)||g(at)}function z(at,Jt){at.type===36193?(at.data=f(Jt),Te.freeType(Jt)):at.data=Jt}function I(at,Jt,Zt,Ut,_r,rt){if(at=typeof Xe[at]<"u"?Xe[at]:Ft[at]*Ne[Jt],rt&&(at*=6),_r){for(Ut=0;1<=Zt;)Ut+=at*Zt*Zt,Zt/=2;return Ut}return at*Zt*Ut}function D(at,Jt,Zt,Ut,_r,rt,Ke){function st(){this.format=this.internalformat=6408,this.type=5121,this.flipY=this.premultiplyAlpha=this.compressed=!1,this.unpackAlignment=1,this.colorSpace=37444,this.channels=this.height=this.width=0}function lt(wr,pn){wr.internalformat=pn.internalformat,wr.format=pn.format,wr.type=pn.type,wr.compressed=pn.compressed,wr.premultiplyAlpha=pn.premultiplyAlpha,wr.flipY=pn.flipY,wr.unpackAlignment=pn.unpackAlignment,wr.colorSpace=pn.colorSpace,wr.width=pn.width,wr.height=pn.height,wr.channels=pn.channels}function wt(wr,pn){if(typeof pn=="object"&&pn){"premultiplyAlpha"in pn&&(wr.premultiplyAlpha=pn.premultiplyAlpha),"flipY"in pn&&(wr.flipY=pn.flipY),"alignment"in pn&&(wr.unpackAlignment=pn.alignment),"colorSpace"in pn&&(wr.colorSpace=ar[pn.colorSpace]),"type"in pn&&(wr.type=Cr[pn.type]);var fn=wr.width,An=wr.height,Zn=wr.channels,ua=!1;"shape"in pn?(fn=pn.shape[0],An=pn.shape[1],pn.shape.length===3&&(Zn=pn.shape[2],ua=!0)):("radius"in pn&&(fn=An=pn.radius),"width"in pn&&(fn=pn.width),"height"in pn&&(An=pn.height),"channels"in pn&&(Zn=pn.channels,ua=!0)),wr.width=fn|0,wr.height=An|0,wr.channels=Zn|0,fn=!1,"format"in pn&&(fn=pn.format,An=wr.internalformat=Or[fn],wr.format=Hn[An],fn in Cr&&!("type"in pn)&&(wr.type=Cr[fn]),fn in Ir&&(wr.compressed=!0),fn=!0),!ua&&fn?wr.channels=Ft[wr.format]:ua&&!fn&&wr.channels!==Lt[wr.format]&&(wr.format=wr.internalformat=Lt[wr.channels])}}function Pt(wr){at.pixelStorei(37440,wr.flipY),at.pixelStorei(37441,wr.premultiplyAlpha),at.pixelStorei(37443,wr.colorSpace),at.pixelStorei(3317,wr.unpackAlignment)}function ke(){st.call(this),this.yOffset=this.xOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function Se(wr,pn){var fn=null;if(P(pn)?fn=pn:pn&&(wt(wr,pn),"x"in pn&&(wr.xOffset=pn.x|0),"y"in pn&&(wr.yOffset=pn.y|0),P(pn.data)&&(fn=pn.data)),pn.copy){var An=_r.viewportWidth,Zn=_r.viewportHeight;wr.width=wr.width||An-wr.xOffset,wr.height=wr.height||Zn-wr.yOffset,wr.needsCopy=!0}else if(!fn)wr.width=wr.width||1,wr.height=wr.height||1,wr.channels=wr.channels||4;else if(ze(fn))wr.channels=wr.channels||4,wr.data=fn,"type"in pn||wr.type!==5121||(wr.type=be[Object.prototype.toString.call(fn)]|0);else if(L(fn)){switch(wr.channels=wr.channels||4,An=fn,Zn=An.length,wr.type){case 5121:case 5123:case 5125:case 5126:Zn=Te.allocType(wr.type,Zn),Zn.set(An),wr.data=Zn;break;case 36193:wr.data=f(An)}wr.alignment=1,wr.needsFree=!0}else if(g(fn)){An=fn.data,Array.isArray(An)||wr.type!==5121||(wr.type=be[Object.prototype.toString.call(An)]|0);var Zn=fn.shape,ua=fn.stride,ea,Rn,Xn,Ua;Zn.length===3?(Xn=Zn[2],Ua=ua[2]):Ua=Xn=1,ea=Zn[0],Rn=Zn[1],Zn=ua[0],ua=ua[1],wr.alignment=1,wr.width=ea,wr.height=Rn,wr.channels=Xn,wr.format=wr.internalformat=Lt[Xn],wr.needsFree=!0,ea=Ua,fn=fn.offset,Xn=wr.width,Ua=wr.height,Rn=wr.channels;for(var li=Te.allocType(wr.type===36193?5126:wr.type,Xn*Ua*Rn),Bt=0,hr=0;hr<Ua;++hr)for(var rn=0;rn<Xn;++rn)for(var vn=0;vn<Rn;++vn)li[Bt++]=An[Zn*rn+ua*hr+ea*vn+fn];z(wr,li)}else if(k(fn)===Gt||k(fn)===Dt||k(fn)===kt)k(fn)===Gt||k(fn)===Dt?wr.element=fn:wr.element=fn.canvas,wr.width=wr.element.width,wr.height=wr.element.height,wr.channels=4;else if(k(fn)===Ue)wr.element=fn,wr.width=fn.width,wr.height=fn.height,wr.channels=4;else if(k(fn)===qe)wr.element=fn,wr.width=fn.naturalWidth,wr.height=fn.naturalHeight,wr.channels=4;else if(k(fn)===Ve)wr.element=fn,wr.width=fn.videoWidth,wr.height=fn.videoHeight,wr.channels=4;else if(T(fn)){for(An=wr.width||fn[0].length,Zn=wr.height||fn.length,ua=wr.channels,ua=x(fn[0][0])?ua||fn[0][0].length:ua||1,ea=Ye.shape(fn),Xn=1,Ua=0;Ua<ea.length;++Ua)Xn*=ea[Ua];Xn=Te.allocType(wr.type===36193?5126:wr.type,Xn),Ye.flatten(fn,ea,"",Xn),z(wr,Xn),wr.alignment=1,wr.width=An,wr.height=Zn,wr.channels=ua,wr.format=wr.internalformat=Lt[ua],wr.needsFree=!0}}function nt(wr,pn,fn,An,Zn){var ua=wr.element,ea=wr.data,Rn=wr.internalformat,Xn=wr.format,Ua=wr.type,li=wr.width,Bt=wr.height;Pt(wr),ua?at.texSubImage2D(pn,Zn,fn,An,Xn,Ua,ua):wr.compressed?at.compressedTexSubImage2D(pn,Zn,fn,An,Rn,li,Bt,ea):wr.needsCopy?(Ut(),at.copyTexSubImage2D(pn,Zn,fn,An,wr.xOffset,wr.yOffset,li,Bt)):at.texSubImage2D(pn,Zn,fn,An,li,Bt,Xn,Ua,ea)}function it(){return ga.pop()||new ke}function ct(wr){wr.needsFree&&Te.freeType(wr.data),ke.call(wr),ga.push(wr)}function At(){st.call(this),this.genMipmaps=!1,this.mipmapHint=4352,this.mipmask=0,this.images=Array(16)}function dt(wr,pn,fn){var An=wr.images[0]=it();wr.mipmask=1,An.width=wr.width=pn,An.height=wr.height=fn,An.channels=wr.channels=4}function Tt(wr,pn){var fn=null;if(P(pn))fn=wr.images[0]=it(),lt(fn,wr),Se(fn,pn),wr.mipmask=1;else if(wt(wr,pn),Array.isArray(pn.mipmap))for(var An=pn.mipmap,Zn=0;Zn<An.length;++Zn)fn=wr.images[Zn]=it(),lt(fn,wr),fn.width>>=Zn,fn.height>>=Zn,Se(fn,An[Zn]),wr.mipmask|=1<<Zn;else fn=wr.images[0]=it(),lt(fn,wr),Se(fn,pn),wr.mipmask=1;lt(wr,wr.images[0])}function Ht(wr,pn){for(var fn=wr.images,An=0;An<fn.length&&fn[An];++An){var Zn=fn[An],ua=pn,ea=An,Rn=Zn.element,Xn=Zn.data,Ua=Zn.internalformat,li=Zn.format,Bt=Zn.type,hr=Zn.width,rn=Zn.height;Pt(Zn),Rn?at.texImage2D(ua,ea,li,li,Bt,Rn):Zn.compressed?at.compressedTexImage2D(ua,ea,Ua,hr,rn,0,Xn):Zn.needsCopy?(Ut(),at.copyTexImage2D(ua,ea,li,Zn.xOffset,Zn.yOffset,hr,rn,0)):at.texImage2D(ua,ea,li,hr,rn,0,li,Bt,Xn||null)}}function ir(){var wr=La.pop()||new At;st.call(wr);for(var pn=wr.mipmask=0;16>pn;++pn)wr.images[pn]=null;return wr}function kr(wr){for(var pn=wr.images,fn=0;fn<pn.length;++fn)pn[fn]&&ct(pn[fn]),pn[fn]=null;La.push(wr)}function br(){this.magFilter=this.minFilter=9728,this.wrapT=this.wrapS=33071,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=4352}function Mr(wr,pn){"min"in pn&&(wr.minFilter=Vt[pn.min],0<=rr.indexOf(wr.minFilter)&&!("faces"in pn)&&(wr.genMipmaps=!0)),"mag"in pn&&(wr.magFilter=Et[pn.mag]);var fn=wr.wrapS,An=wr.wrapT;if("wrap"in pn){var Zn=pn.wrap;typeof Zn=="string"?fn=An=tt[Zn]:Array.isArray(Zn)&&(fn=tt[Zn[0]],An=tt[Zn[1]])}else"wrapS"in pn&&(fn=tt[pn.wrapS]),"wrapT"in pn&&(An=tt[pn.wrapT]);if(wr.wrapS=fn,wr.wrapT=An,"anisotropic"in pn&&(wr.anisotropic=pn.anisotropic),"mipmap"in pn){switch(fn=!1,typeof pn.mipmap){case"string":wr.mipmapHint=Sr[pn.mipmap],fn=wr.genMipmaps=!0;break;case"boolean":fn=wr.genMipmaps=pn.mipmap;break;case"object":wr.genMipmaps=!1,fn=!0}!fn||"min"in pn||(wr.minFilter=9984)}}function Hr(wr,pn){at.texParameteri(pn,10241,wr.minFilter),at.texParameteri(pn,10240,wr.magFilter),at.texParameteri(pn,10242,wr.wrapS),at.texParameteri(pn,10243,wr.wrapT),Jt.ext_texture_filter_anisotropic&&at.texParameteri(pn,34046,wr.anisotropic),wr.genMipmaps&&(at.hint(33170,wr.mipmapHint),at.generateMipmap(pn))}function nr(wr){st.call(this),this.mipmask=0,this.internalformat=6408,this.id=ci++,this.refCount=1,this.target=wr,this.texture=at.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new br,Ke.profile&&(this.stats={size:0})}function mr(wr){at.activeTexture(33984),at.bindTexture(wr.target,wr.texture)}function Pr(){var wr=Wa[0];wr?at.bindTexture(wr.target,wr.texture):at.bindTexture(3553,null)}function Nr(wr){var pn=wr.texture,fn=wr.unit,An=wr.target;0<=fn&&(at.activeTexture(33984+fn),at.bindTexture(An,null),Wa[fn]=null),at.deleteTexture(pn),wr.texture=null,wr.params=null,wr.pixels=null,wr.refCount=0,delete Va[wr.id],rt.textureCount--}var Sr={"don't care":4352,"dont care":4352,nice:4354,fast:4353},tt={repeat:10497,clamp:33071,mirror:33648},Et={nearest:9728,linear:9729},Vt=le({mipmap:9987,"nearest mipmap nearest":9984,"linear mipmap nearest":9985,"nearest mipmap linear":9986,"linear mipmap linear":9987},Et),ar={none:0,browser:37444},Cr={uint8:5121,rgba4:32819,rgb565:33635,"rgb5 a1":32820},Or={alpha:6406,luminance:6409,"luminance alpha":6410,rgb:6407,rgba:6408,rgba4:32854,"rgb5 a1":32855,rgb565:36194},Ir={};Jt.ext_srgb&&(Or.srgb=35904,Or.srgba=35906),Jt.oes_texture_float&&(Cr.float32=Cr.float=5126),Jt.oes_texture_half_float&&(Cr.float16=Cr["half float"]=36193),Jt.webgl_depth_texture&&(le(Or,{depth:6402,"depth stencil":34041}),le(Cr,{uint16:5123,uint32:5125,"depth stencil":34042})),Jt.webgl_compressed_texture_s3tc&&le(Ir,{"rgb s3tc dxt1":33776,"rgba s3tc dxt1":33777,"rgba s3tc dxt3":33778,"rgba s3tc dxt5":33779}),Jt.webgl_compressed_texture_atc&&le(Ir,{"rgb atc":35986,"rgba atc explicit alpha":35987,"rgba atc interpolated alpha":34798}),Jt.webgl_compressed_texture_pvrtc&&le(Ir,{"rgb pvrtc 4bppv1":35840,"rgb pvrtc 2bppv1":35841,"rgba pvrtc 4bppv1":35842,"rgba pvrtc 2bppv1":35843}),Jt.webgl_compressed_texture_etc1&&(Ir["rgb etc1"]=36196);var Tr=Array.prototype.slice.call(at.getParameter(34467));Object.keys(Ir).forEach(function(wr){var pn=Ir[wr];0<=Tr.indexOf(pn)&&(Or[wr]=pn)});var Wr=Object.keys(Or);Zt.textureFormats=Wr;var wn=[];Object.keys(Or).forEach(function(wr){wn[Or[wr]]=wr});var ln=[];Object.keys(Cr).forEach(function(wr){ln[Cr[wr]]=wr});var Bn=[];Object.keys(Et).forEach(function(wr){Bn[Et[wr]]=wr});var Cn=[];Object.keys(Vt).forEach(function(wr){Cn[Vt[wr]]=wr});var Wn=[];Object.keys(tt).forEach(function(wr){Wn[tt[wr]]=wr});var Hn=Wr.reduce(function(wr,pn){var fn=Or[pn];return fn===6409||fn===6406||fn===6409||fn===6410||fn===6402||fn===34041||Jt.ext_srgb&&(fn===35904||fn===35906)?wr[fn]=fn:fn===32855||0<=pn.indexOf("rgba")?wr[fn]=6408:wr[fn]=6407,wr},{}),ga=[],La=[],ci=0,Va={},ja=Zt.maxTextureUnits,Wa=Array(ja).map(function(){return null});return le(nr.prototype,{bind:function(){this.bindCount+=1;var wr=this.unit;if(0>wr){for(var pn=0;pn<ja;++pn){var fn=Wa[pn];if(fn){if(0<fn.bindCount)continue;fn.unit=-1}Wa[pn]=this,wr=pn;break}Ke.profile&&rt.maxTextureUnits<wr+1&&(rt.maxTextureUnits=wr+1),this.unit=wr,at.activeTexture(33984+wr),at.bindTexture(this.target,this.texture)}return wr},unbind:function(){--this.bindCount},decRef:function(){0>=--this.refCount&&Nr(this)}}),Ke.profile&&(rt.getTotalTextureSize=function(){var wr=0;return Object.keys(Va).forEach(function(pn){wr+=Va[pn].stats.size}),wr}),{create2D:function(wr,pn){function fn(Zn,ua){var ea=An.texInfo;br.call(ea);var Rn=ir();return typeof Zn=="number"?typeof ua=="number"?dt(Rn,Zn|0,ua|0):dt(Rn,Zn|0,Zn|0):Zn?(Mr(ea,Zn),Tt(Rn,Zn)):dt(Rn,1,1),ea.genMipmaps&&(Rn.mipmask=(Rn.width<<1)-1),An.mipmask=Rn.mipmask,lt(An,Rn),An.internalformat=Rn.internalformat,fn.width=Rn.width,fn.height=Rn.height,mr(An),Ht(Rn,3553),Hr(ea,3553),Pr(),kr(Rn),Ke.profile&&(An.stats.size=I(An.internalformat,An.type,Rn.width,Rn.height,ea.genMipmaps,!1)),fn.format=wn[An.internalformat],fn.type=ln[An.type],fn.mag=Bn[ea.magFilter],fn.min=Cn[ea.minFilter],fn.wrapS=Wn[ea.wrapS],fn.wrapT=Wn[ea.wrapT],fn}var An=new nr(3553);return Va[An.id]=An,rt.textureCount++,fn(wr,pn),fn.subimage=function(Zn,ua,ea,Rn){ua|=0,ea|=0,Rn|=0;var Xn=it();return lt(Xn,An),Xn.width=0,Xn.height=0,Se(Xn,Zn),Xn.width=Xn.width||(An.width>>Rn)-ua,Xn.height=Xn.height||(An.height>>Rn)-ea,mr(An),nt(Xn,3553,ua,ea,Rn),Pr(),ct(Xn),fn},fn.resize=function(Zn,ua){var ea=Zn|0,Rn=ua|0||ea;if(ea===An.width&&Rn===An.height)return fn;fn.width=An.width=ea,fn.height=An.height=Rn,mr(An);for(var Xn=0;An.mipmask>>Xn;++Xn){var Ua=ea>>Xn,li=Rn>>Xn;if(!Ua||!li)break;at.texImage2D(3553,Xn,An.format,Ua,li,0,An.format,An.type,null)}return Pr(),Ke.profile&&(An.stats.size=I(An.internalformat,An.type,ea,Rn,!1,!1)),fn},fn._reglType="texture2d",fn._texture=An,Ke.profile&&(fn.stats=An.stats),fn.destroy=function(){An.decRef()},fn},createCube:function(wr,pn,fn,An,Zn,ua){function ea(Ua,li,Bt,hr,rn,vn){var en,Tn=Rn.texInfo;for(br.call(Tn),en=0;6>en;++en)Xn[en]=ir();if(typeof Ua=="number"||!Ua)for(Ua=Ua|0||1,en=0;6>en;++en)dt(Xn[en],Ua,Ua);else if(typeof Ua=="object")if(li)Tt(Xn[0],Ua),Tt(Xn[1],li),Tt(Xn[2],Bt),Tt(Xn[3],hr),Tt(Xn[4],rn),Tt(Xn[5],vn);else if(Mr(Tn,Ua),wt(Rn,Ua),"faces"in Ua)for(Ua=Ua.faces,en=0;6>en;++en)lt(Xn[en],Rn),Tt(Xn[en],Ua[en]);else for(en=0;6>en;++en)Tt(Xn[en],Ua);for(lt(Rn,Xn[0]),Rn.mipmask=Tn.genMipmaps?(Xn[0].width<<1)-1:Xn[0].mipmask,Rn.internalformat=Xn[0].internalformat,ea.width=Xn[0].width,ea.height=Xn[0].height,mr(Rn),en=0;6>en;++en)Ht(Xn[en],34069+en);for(Hr(Tn,34067),Pr(),Ke.profile&&(Rn.stats.size=I(Rn.internalformat,Rn.type,ea.width,ea.height,Tn.genMipmaps,!0)),ea.format=wn[Rn.internalformat],ea.type=ln[Rn.type],ea.mag=Bn[Tn.magFilter],ea.min=Cn[Tn.minFilter],ea.wrapS=Wn[Tn.wrapS],ea.wrapT=Wn[Tn.wrapT],en=0;6>en;++en)kr(Xn[en]);return ea}var Rn=new nr(34067);Va[Rn.id]=Rn,rt.cubeCount++;var Xn=Array(6);return ea(wr,pn,fn,An,Zn,ua),ea.subimage=function(Ua,li,Bt,hr,rn){Bt|=0,hr|=0,rn|=0;var vn=it();return lt(vn,Rn),vn.width=0,vn.height=0,Se(vn,li),vn.width=vn.width||(Rn.width>>rn)-Bt,vn.height=vn.height||(Rn.height>>rn)-hr,mr(Rn),nt(vn,34069+Ua,Bt,hr,rn),Pr(),ct(vn),ea},ea.resize=function(Ua){if(Ua|=0,Ua!==Rn.width){ea.width=Rn.width=Ua,ea.height=Rn.height=Ua,mr(Rn);for(var li=0;6>li;++li)for(var Bt=0;Rn.mipmask>>Bt;++Bt)at.texImage2D(34069+li,Bt,Rn.format,Ua>>Bt,Ua>>Bt,0,Rn.format,Rn.type,null);return Pr(),Ke.profile&&(Rn.stats.size=I(Rn.internalformat,Rn.type,ea.width,ea.height,!1,!0)),ea}},ea._reglType="textureCube",ea._texture=Rn,Ke.profile&&(ea.stats=Rn.stats),ea.destroy=function(){Rn.decRef()},ea},clear:function(){for(var wr=0;wr<ja;++wr)at.activeTexture(33984+wr),at.bindTexture(3553,null),Wa[wr]=null;Oe(Va).forEach(Nr),rt.cubeCount=0,rt.textureCount=0},getTexture:function(wr){return null},restore:function(){for(var wr=0;wr<ja;++wr){var pn=Wa[wr];pn&&(pn.bindCount=0,pn.unit=-1,Wa[wr]=null)}Oe(Va).forEach(function(fn){fn.texture=at.createTexture(),at.bindTexture(fn.target,fn.texture);for(var An=0;32>An;++An)if((fn.mipmask&1<<An)!==0)if(fn.target===3553)at.texImage2D(3553,An,fn.internalformat,fn.width>>An,fn.height>>An,0,fn.internalformat,fn.type,null);else for(var Zn=0;6>Zn;++Zn)at.texImage2D(34069+Zn,An,fn.internalformat,fn.width>>An,fn.height>>An,0,fn.internalformat,fn.type,null);Hr(fn.texInfo,fn.target)})},refresh:function(){for(var wr=0;wr<ja;++wr){var pn=Wa[wr];pn&&(pn.bindCount=0,pn.unit=-1,Wa[wr]=null),at.activeTexture(33984+wr),at.bindTexture(3553,null),at.bindTexture(34067,null)}}}}function R(at,Jt,Zt,Ut,_r,rt){function Ke(nr,mr,Pr){this.target=nr,this.texture=mr,this.renderbuffer=Pr;var Nr=nr=0;mr?(nr=mr.width,Nr=mr.height):Pr&&(nr=Pr.width,Nr=Pr.height),this.width=nr,this.height=Nr}function st(nr){nr&&(nr.texture&&nr.texture._texture.decRef(),nr.renderbuffer&&nr.renderbuffer._renderbuffer.decRef())}function lt(nr,mr,Pr){nr&&(nr.texture?nr.texture._texture.refCount+=1:nr.renderbuffer._renderbuffer.refCount+=1)}function wt(nr,mr){mr&&(mr.texture?at.framebufferTexture2D(36160,nr,mr.target,mr.texture._texture.texture,0):at.framebufferRenderbuffer(36160,nr,36161,mr.renderbuffer._renderbuffer.renderbuffer))}function Pt(nr){var mr=3553,Pr=null,Nr=null,Sr=nr;return typeof nr=="object"&&(Sr=nr.data,"target"in nr&&(mr=nr.target|0)),nr=Sr._reglType,nr==="texture2d"||nr==="textureCube"?Pr=Sr:nr==="renderbuffer"&&(Nr=Sr,mr=36161),new Ke(mr,Pr,Nr)}function ke(nr,mr,Pr,Nr,Sr){return Pr?(nr=Ut.create2D({width:nr,height:mr,format:Nr,type:Sr}),nr._texture.refCount=0,new Ke(3553,nr,null)):(nr=_r.create({width:nr,height:mr,format:Nr}),nr._renderbuffer.refCount=0,new Ke(36161,null,nr))}function Se(nr){return nr&&(nr.texture||nr.renderbuffer)}function nt(nr,mr,Pr){nr&&(nr.texture?nr.texture.resize(mr,Pr):nr.renderbuffer&&nr.renderbuffer.resize(mr,Pr),nr.width=mr,nr.height=Pr)}function it(){this.id=Mr++,Hr[this.id]=this,this.framebuffer=at.createFramebuffer(),this.height=this.width=0,this.colorAttachments=[],this.depthStencilAttachment=this.stencilAttachment=this.depthAttachment=null}function ct(nr){nr.colorAttachments.forEach(st),st(nr.depthAttachment),st(nr.stencilAttachment),st(nr.depthStencilAttachment)}function At(nr){at.deleteFramebuffer(nr.framebuffer),nr.framebuffer=null,rt.framebufferCount--,delete Hr[nr.id]}function dt(nr){var mr;at.bindFramebuffer(36160,nr.framebuffer);var Pr=nr.colorAttachments;for(mr=0;mr<Pr.length;++mr)wt(36064+mr,Pr[mr]);for(mr=Pr.length;mr<Zt.maxColorAttachments;++mr)at.framebufferTexture2D(36160,36064+mr,3553,null,0);at.framebufferTexture2D(36160,33306,3553,null,0),at.framebufferTexture2D(36160,36096,3553,null,0),at.framebufferTexture2D(36160,36128,3553,null,0),wt(36096,nr.depthAttachment),wt(36128,nr.stencilAttachment),wt(33306,nr.depthStencilAttachment),at.checkFramebufferStatus(36160),at.isContextLost(),at.bindFramebuffer(36160,Ht.next?Ht.next.framebuffer:null),Ht.cur=Ht.next,at.getError()}function Tt(nr,mr){function Pr(Sr,tt){var Et,Vt=0,ar=0,Cr=!0,Or=!0;Et=null;var Ir=!0,Tr="rgba",Wr="uint8",wn=1,ln=null,Bn=null,Cn=null,Wn=!1;typeof Sr=="number"?(Vt=Sr|0,ar=tt|0||Vt):Sr?("shape"in Sr?(ar=Sr.shape,Vt=ar[0],ar=ar[1]):("radius"in Sr&&(Vt=ar=Sr.radius),"width"in Sr&&(Vt=Sr.width),"height"in Sr&&(ar=Sr.height)),("color"in Sr||"colors"in Sr)&&(Et=Sr.color||Sr.colors),Et||("colorCount"in Sr&&(wn=Sr.colorCount|0),"colorTexture"in Sr&&(Ir=!!Sr.colorTexture,Tr="rgba4"),"colorType"in Sr&&(Wr=Sr.colorType,!Ir)&&(Wr==="half float"||Wr==="float16"?Tr="rgba16f":(Wr==="float"||Wr==="float32")&&(Tr="rgba32f")),"colorFormat"in Sr&&(Tr=Sr.colorFormat,0<=ir.indexOf(Tr)?Ir=!0:0<=kr.indexOf(Tr)&&(Ir=!1))),("depthTexture"in Sr||"depthStencilTexture"in Sr)&&(Wn=!(!Sr.depthTexture&&!Sr.depthStencilTexture)),"depth"in Sr&&(typeof Sr.depth=="boolean"?Cr=Sr.depth:(ln=Sr.depth,Or=!1)),"stencil"in Sr&&(typeof Sr.stencil=="boolean"?Or=Sr.stencil:(Bn=Sr.stencil,Cr=!1)),"depthStencil"in Sr&&(typeof Sr.depthStencil=="boolean"?Cr=Or=Sr.depthStencil:(Cn=Sr.depthStencil,Or=Cr=!1))):Vt=ar=1;var Hn=null,ga=null,La=null,ci=null;if(Array.isArray(Et))Hn=Et.map(Pt);else if(Et)Hn=[Pt(Et)];else for(Hn=Array(wn),Et=0;Et<wn;++Et)Hn[Et]=ke(Vt,ar,Ir,Tr,Wr);for(Vt=Vt||Hn[0].width,ar=ar||Hn[0].height,ln?ga=Pt(ln):Cr&&!Or&&(ga=ke(Vt,ar,Wn,"depth","uint32")),Bn?La=Pt(Bn):Or&&!Cr&&(La=ke(Vt,ar,!1,"stencil","uint8")),Cn?ci=Pt(Cn):!ln&&!Bn&&Or&&Cr&&(ci=ke(Vt,ar,Wn,"depth stencil","depth stencil")),Cr=null,Et=0;Et<Hn.length;++Et)lt(Hn[Et]),Hn[Et]&&Hn[Et].texture&&(Or=mt[Hn[Et].texture._texture.format]*Ot[Hn[Et].texture._texture.type],Cr===null&&(Cr=Or));return lt(ga),lt(La),lt(ci),ct(Nr),Nr.width=Vt,Nr.height=ar,Nr.colorAttachments=Hn,Nr.depthAttachment=ga,Nr.stencilAttachment=La,Nr.depthStencilAttachment=ci,Pr.color=Hn.map(Se),Pr.depth=Se(ga),Pr.stencil=Se(La),Pr.depthStencil=Se(ci),Pr.width=Nr.width,Pr.height=Nr.height,dt(Nr),Pr}var Nr=new it;return rt.framebufferCount++,Pr(nr,mr),le(Pr,{resize:function(Sr,tt){var Et=Math.max(Sr|0,1),Vt=Math.max(tt|0||Et,1);if(Et===Nr.width&&Vt===Nr.height)return Pr;for(var ar=Nr.colorAttachments,Cr=0;Cr<ar.length;++Cr)nt(ar[Cr],Et,Vt);return nt(Nr.depthAttachment,Et,Vt),nt(Nr.stencilAttachment,Et,Vt),nt(Nr.depthStencilAttachment,Et,Vt),Nr.width=Pr.width=Et,Nr.height=Pr.height=Vt,dt(Nr),Pr},_reglType:"framebuffer",_framebuffer:Nr,destroy:function(){At(Nr),ct(Nr)},use:function(Sr){Ht.setFBO({framebuffer:Pr},Sr)}})}var Ht={cur:null,next:null,dirty:!1,setFBO:null},ir=["rgba"],kr=["rgba4","rgb565","rgb5 a1"];Jt.ext_srgb&&kr.push("srgba"),Jt.ext_color_buffer_half_float&&kr.push("rgba16f","rgb16f"),Jt.webgl_color_buffer_float&&kr.push("rgba32f");var br=["uint8"];Jt.oes_texture_half_float&&br.push("half float","float16"),Jt.oes_texture_float&&br.push("float","float32");var Mr=0,Hr={};return le(Ht,{getFramebuffer:function(nr){return typeof nr=="function"&&nr._reglType==="framebuffer"&&(nr=nr._framebuffer,nr instanceof it)?nr:null},create:Tt,createCube:function(nr){function mr(Nr){var Sr,tt={color:null},Et=0,Vt=null;Sr="rgba";var ar="uint8",Cr=1;if(typeof Nr=="number"?Et=Nr|0:Nr?("shape"in Nr?Et=Nr.shape[0]:("radius"in Nr&&(Et=Nr.radius|0),"width"in Nr?Et=Nr.width|0:"height"in Nr&&(Et=Nr.height|0)),("color"in Nr||"colors"in Nr)&&(Vt=Nr.color||Nr.colors),Vt||("colorCount"in Nr&&(Cr=Nr.colorCount|0),"colorType"in Nr&&(ar=Nr.colorType),"colorFormat"in Nr&&(Sr=Nr.colorFormat)),"depth"in Nr&&(tt.depth=Nr.depth),"stencil"in Nr&&(tt.stencil=Nr.stencil),"depthStencil"in Nr&&(tt.depthStencil=Nr.depthStencil)):Et=1,Vt)if(Array.isArray(Vt))for(Nr=[],Sr=0;Sr<Vt.length;++Sr)Nr[Sr]=Vt[Sr];else Nr=[Vt];else for(Nr=Array(Cr),Vt={radius:Et,format:Sr,type:ar},Sr=0;Sr<Cr;++Sr)Nr[Sr]=Ut.createCube(Vt);for(tt.color=Array(Nr.length),Sr=0;Sr<Nr.length;++Sr)Cr=Nr[Sr],Et=Et||Cr.width,tt.color[Sr]={target:34069,data:Nr[Sr]};for(Sr=0;6>Sr;++Sr){for(Cr=0;Cr<Nr.length;++Cr)tt.color[Cr].target=34069+Sr;0<Sr&&(tt.depth=Pr[0].depth,tt.stencil=Pr[0].stencil,tt.depthStencil=Pr[0].depthStencil),Pr[Sr]?Pr[Sr](tt):Pr[Sr]=Tt(tt)}return le(mr,{width:Et,height:Et,color:Nr})}var Pr=Array(6);return mr(nr),le(mr,{faces:Pr,resize:function(Nr){var Sr=Nr|0;if(Sr===mr.width)return mr;var tt=mr.color;for(Nr=0;Nr<tt.length;++Nr)tt[Nr].resize(Sr);for(Nr=0;6>Nr;++Nr)Pr[Nr].resize(Sr);return mr.width=mr.height=Sr,mr},_reglType:"framebufferCube",destroy:function(){Pr.forEach(function(Nr){Nr.destroy()})}})},clear:function(){Oe(Hr).forEach(At)},restore:function(){Ht.cur=null,Ht.next=null,Ht.dirty=!0,Oe(Hr).forEach(function(nr){nr.framebuffer=at.createFramebuffer(),dt(nr)})}})}function B(){this.w=this.z=this.y=this.x=this.state=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=5126,this.divisor=this.stride=this.offset=0}function F(at,Jt,Zt,Ut,_r,rt,Ke){function st(dt){if(dt!==At.currentVAO){var Tt=Jt.oes_vertex_array_object;dt?Tt.bindVertexArrayOES(dt.vao):Tt.bindVertexArrayOES(null),At.currentVAO=dt}}function lt(dt){if(dt!==At.currentVAO){if(dt)dt.bindAttrs();else{for(var Tt=Jt.angle_instanced_arrays,Ht=0;Ht<nt.length;++Ht){var ir=nt[Ht];ir.buffer?(at.enableVertexAttribArray(Ht),ir.buffer.bind(),at.vertexAttribPointer(Ht,ir.size,ir.type,ir.normalized,ir.stride,ir.offfset),Tt&&ir.divisor&&Tt.vertexAttribDivisorANGLE(Ht,ir.divisor)):(at.disableVertexAttribArray(Ht),at.vertexAttrib4f(Ht,ir.x,ir.y,ir.z,ir.w))}Ke.elements?at.bindBuffer(34963,Ke.elements.buffer.buffer):at.bindBuffer(34963,null)}At.currentVAO=dt}}function wt(){Oe(ct).forEach(function(dt){dt.destroy()})}function Pt(){this.id=++it,this.attributes=[],this.elements=null,this.ownsElements=!1,this.offset=this.count=0,this.instances=-1,this.primitive=4;var dt=Jt.oes_vertex_array_object;this.vao=dt?dt.createVertexArrayOES():null,ct[this.id]=this,this.buffers=[]}function ke(){Jt.oes_vertex_array_object&&Oe(ct).forEach(function(dt){dt.refresh()})}var Se=Zt.maxAttributes,nt=Array(Se);for(Zt=0;Zt<Se;++Zt)nt[Zt]=new B;var it=0,ct={},At={Record:B,scope:{},state:nt,currentVAO:null,targetVAO:null,restore:Jt.oes_vertex_array_object?ke:function(){},createVAO:function(dt){function Tt(ir){var kr;Array.isArray(ir)?(kr=ir,Ht.elements&&Ht.ownsElements&&Ht.elements.destroy(),Ht.elements=null,Ht.ownsElements=!1,Ht.offset=0,Ht.count=0,Ht.instances=-1,Ht.primitive=4):(ir.elements?(kr=ir.elements,Ht.ownsElements?(typeof kr=="function"&&kr._reglType==="elements"?Ht.elements.destroy():Ht.elements(kr),Ht.ownsElements=!1):rt.getElements(ir.elements)?(Ht.elements=ir.elements,Ht.ownsElements=!1):(Ht.elements=rt.create(ir.elements),Ht.ownsElements=!0)):(Ht.elements=null,Ht.ownsElements=!1),kr=ir.attributes,Ht.offset=0,Ht.count=-1,Ht.instances=-1,Ht.primitive=4,Ht.elements&&(Ht.count=Ht.elements._elements.vertCount,Ht.primitive=Ht.elements._elements.primType),"offset"in ir&&(Ht.offset=ir.offset|0),"count"in ir&&(Ht.count=ir.count|0),"instances"in ir&&(Ht.instances=ir.instances|0),"primitive"in ir&&(Ht.primitive=He[ir.primitive])),ir={};var br=Ht.attributes;br.length=kr.length;for(var Mr=0;Mr<kr.length;++Mr){var Hr=kr[Mr],nr=br[Mr]=new B,mr=Hr.data||Hr;if(Array.isArray(mr)||ze(mr)||g(mr)){var Pr;Ht.buffers[Mr]&&(Pr=Ht.buffers[Mr],ze(mr)&&Pr._buffer.byteLength>=mr.byteLength?Pr.subdata(mr):(Pr.destroy(),Ht.buffers[Mr]=null)),Ht.buffers[Mr]||(Pr=Ht.buffers[Mr]=_r.create(Hr,34962,!1,!0)),nr.buffer=_r.getBuffer(Pr),nr.size=nr.buffer.dimension|0,nr.normalized=!1,nr.type=nr.buffer.dtype,nr.offset=0,nr.stride=0,nr.divisor=0,nr.state=1,ir[Mr]=1}else _r.getBuffer(Hr)?(nr.buffer=_r.getBuffer(Hr),nr.size=nr.buffer.dimension|0,nr.normalized=!1,nr.type=nr.buffer.dtype,nr.offset=0,nr.stride=0,nr.divisor=0,nr.state=1):_r.getBuffer(Hr.buffer)?(nr.buffer=_r.getBuffer(Hr.buffer),nr.size=(+Hr.size||nr.buffer.dimension)|0,nr.normalized=!!Hr.normalized||!1,nr.type="type"in Hr?Pe[Hr.type]:nr.buffer.dtype,nr.offset=(Hr.offset||0)|0,nr.stride=(Hr.stride||0)|0,nr.divisor=(Hr.divisor||0)|0,nr.state=1):"x"in Hr&&(nr.x=+Hr.x||0,nr.y=+Hr.y||0,nr.z=+Hr.z||0,nr.w=+Hr.w||0,nr.state=2)}for(Pr=0;Pr<Ht.buffers.length;++Pr)!ir[Pr]&&Ht.buffers[Pr]&&(Ht.buffers[Pr].destroy(),Ht.buffers[Pr]=null);return Ht.refresh(),Tt}var Ht=new Pt;return Ut.vaoCount+=1,Tt.destroy=function(){for(var ir=0;ir<Ht.buffers.length;++ir)Ht.buffers[ir]&&Ht.buffers[ir].destroy();Ht.buffers.length=0,Ht.ownsElements&&(Ht.elements.destroy(),Ht.elements=null,Ht.ownsElements=!1),Ht.destroy()},Tt._vao=Ht,Tt._reglType="vao",Tt(dt)},getVAO:function(dt){return typeof dt=="function"&&dt._vao?dt._vao:null},destroyBuffer:function(dt){for(var Tt=0;Tt<nt.length;++Tt){var Ht=nt[Tt];Ht.buffer===dt&&(at.disableVertexAttribArray(Tt),Ht.buffer=null)}},setVAO:Jt.oes_vertex_array_object?st:lt,clear:Jt.oes_vertex_array_object?wt:function(){}};return Pt.prototype.bindAttrs=function(){for(var dt=Jt.angle_instanced_arrays,Tt=this.attributes,Ht=0;Ht<Tt.length;++Ht){var ir=Tt[Ht];ir.buffer?(at.enableVertexAttribArray(Ht),at.bindBuffer(34962,ir.buffer.buffer),at.vertexAttribPointer(Ht,ir.size,ir.type,ir.normalized,ir.stride,ir.offset),dt&&ir.divisor&&dt.vertexAttribDivisorANGLE(Ht,ir.divisor)):(at.disableVertexAttribArray(Ht),at.vertexAttrib4f(Ht,ir.x,ir.y,ir.z,ir.w))}for(dt=Tt.length;dt<Se;++dt)at.disableVertexAttribArray(dt);(dt=rt.getElements(this.elements))?at.bindBuffer(34963,dt.buffer.buffer):at.bindBuffer(34963,null)},Pt.prototype.refresh=function(){var dt=Jt.oes_vertex_array_object;dt&&(dt.bindVertexArrayOES(this.vao),this.bindAttrs(),At.currentVAO=null,dt.bindVertexArrayOES(null))},Pt.prototype.destroy=function(){if(this.vao){var dt=Jt.oes_vertex_array_object;this===At.currentVAO&&(At.currentVAO=null,dt.bindVertexArrayOES(null)),dt.deleteVertexArrayOES(this.vao),this.vao=null}this.ownsElements&&(this.elements.destroy(),this.elements=null,this.ownsElements=!1),ct[this.id]&&(delete ct[this.id],--Ut.vaoCount)},At}function H(at,Jt,Zt,Ut){function _r(it,ct,At,dt){this.name=it,this.id=ct,this.location=At,this.info=dt}function rt(it,ct){for(var At=0;At<it.length;++At)if(it[At].id===ct.id){it[At].location=ct.location;return}it.push(ct)}function Ke(it,ct,At){At=it===35632?wt:Pt;var dt=At[ct];if(!dt){var Tt=Jt.str(ct),dt=at.createShader(it);at.shaderSource(dt,Tt),at.compileShader(dt),At[ct]=dt}return dt}function st(it,ct){this.id=nt++,this.fragId=it,this.vertId=ct,this.program=null,this.uniforms=[],this.attributes=[],this.refCount=1,Ut.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function lt(it,ct,At){var dt;dt=Ke(35632,it.fragId);var Tt=Ke(35633,it.vertId);if(ct=it.program=at.createProgram(),at.attachShader(ct,dt),at.attachShader(ct,Tt),At)for(dt=0;dt<At.length;++dt)Tt=At[dt],at.bindAttribLocation(ct,Tt[0],Tt[1]);at.linkProgram(ct),Tt=at.getProgramParameter(ct,35718),Ut.profile&&(it.stats.uniformsCount=Tt);var Ht=it.uniforms;for(dt=0;dt<Tt;++dt)if(At=at.getActiveUniform(ct,dt))if(1<At.size)for(var ir=0;ir<At.size;++ir){var kr=At.name.replace("[0]","["+ir+"]");rt(Ht,new _r(kr,Jt.id(kr),at.getUniformLocation(ct,kr),At))}else rt(Ht,new _r(At.name,Jt.id(At.name),at.getUniformLocation(ct,At.name),At));for(Tt=at.getProgramParameter(ct,35721),Ut.profile&&(it.stats.attributesCount=Tt),it=it.attributes,dt=0;dt<Tt;++dt)(At=at.getActiveAttrib(ct,dt))&&rt(it,new _r(At.name,Jt.id(At.name),at.getAttribLocation(ct,At.name),At))}var wt={},Pt={},ke={},Se=[],nt=0;return Ut.profile&&(Zt.getMaxUniformsCount=function(){var it=0;return Se.forEach(function(ct){ct.stats.uniformsCount>it&&(it=ct.stats.uniformsCount)}),it},Zt.getMaxAttributesCount=function(){var it=0;return Se.forEach(function(ct){ct.stats.attributesCount>it&&(it=ct.stats.attributesCount)}),it}),{clear:function(){var it=at.deleteShader.bind(at);Oe(wt).forEach(it),wt={},Oe(Pt).forEach(it),Pt={},Se.forEach(function(ct){at.deleteProgram(ct.program)}),Se.length=0,ke={},Zt.shaderCount=0},program:function(it,ct,At,dt){var Tt=ke[ct];Tt||(Tt=ke[ct]={});var Ht=Tt[it];if(Ht&&(Ht.refCount++,!dt))return Ht;var ir=new st(ct,it);return Zt.shaderCount++,lt(ir,At,dt),Ht||(Tt[it]=ir),Se.push(ir),le(ir,{destroy:function(){if(ir.refCount--,0>=ir.refCount){at.deleteProgram(ir.program);var kr=Se.indexOf(ir);Se.splice(kr,1),Zt.shaderCount--}0>=Tt[ir.vertId].refCount&&(at.deleteShader(Pt[ir.vertId]),delete Pt[ir.vertId],delete ke[ir.fragId][ir.vertId]),Object.keys(ke[ir.fragId]).length||(at.deleteShader(wt[ir.fragId]),delete wt[ir.fragId],delete ke[ir.fragId])}})},restore:function(){wt={},Pt={};for(var it=0;it<Se.length;++it)lt(Se[it],null,Se[it].attributes.map(function(ct){return[ct.location,ct.name]}))},shader:Ke,frag:-1,vert:-1}}function G(at,Jt,Zt,Ut,_r,rt,Ke){function st(wt){var Pt;Pt=Jt.next===null?5121:Jt.next.colorAttachments[0].texture._texture.type;var ke=0,Se=0,nt=Ut.framebufferWidth,it=Ut.framebufferHeight,ct=null;return ze(wt)?ct=wt:wt&&(ke=wt.x|0,Se=wt.y|0,nt=(wt.width||Ut.framebufferWidth-ke)|0,it=(wt.height||Ut.framebufferHeight-Se)|0,ct=wt.data||null),Zt(),wt=nt*it*4,ct||(Pt===5121?ct=new Uint8Array(wt):Pt===5126&&(ct=ct||new Float32Array(wt))),at.pixelStorei(3333,4),at.readPixels(ke,Se,nt,it,6408,Pt,ct),ct}function lt(wt){var Pt;return Jt.setFBO({framebuffer:wt.framebuffer},function(){Pt=st(wt)}),Pt}return function(wt){return wt&&"framebuffer"in wt?lt(wt):st(wt)}}function J(at){for(var Jt=Array(at.length>>2),Ut=0;Ut<Jt.length;Ut++)Jt[Ut]=0;for(Ut=0;Ut<8*at.length;Ut+=8)Jt[Ut>>5]|=(at.charCodeAt(Ut/8)&255)<<24-Ut%32;var Zt=8*at.length;at=[1779033703,-1150833019,1013904242,-1521486534,1359893119,-1694144372,528734635,1541459225];var Ut=Array(64),_r,rt,Ke,st,lt,wt,Pt,ke,Se,nt,it;for(Jt[Zt>>5]|=128<<24-Zt%32,Jt[(Zt+64>>9<<4)+15]=Zt,ke=0;ke<Jt.length;ke+=16){for(Zt=at[0],_r=at[1],rt=at[2],Ke=at[3],st=at[4],lt=at[5],wt=at[6],Pt=at[7],Se=0;64>Se;Se++){if(16>Se)Ut[Se]=Jt[Se+ke];else{nt=Se,it=Ut[Se-2],it=Z(it,17)^Z(it,19)^it>>>10,it=oe(it,Ut[Se-7]);var ct;ct=Ut[Se-15],ct=Z(ct,7)^Z(ct,18)^ct>>>3,Ut[nt]=oe(oe(it,ct),Ut[Se-16])}nt=st,nt=Z(nt,6)^Z(nt,11)^Z(nt,25),nt=oe(oe(oe(oe(Pt,nt),st&lt^~st&wt),Kt[Se]),Ut[Se]),Pt=Zt,Pt=Z(Pt,2)^Z(Pt,13)^Z(Pt,22),it=oe(Pt,Zt&_r^Zt&rt^_r&rt),Pt=wt,wt=lt,lt=st,st=oe(Ke,nt),Ke=rt,rt=_r,_r=Zt,Zt=oe(nt,it)}at[0]=oe(Zt,at[0]),at[1]=oe(_r,at[1]),at[2]=oe(rt,at[2]),at[3]=oe(Ke,at[3]),at[4]=oe(st,at[4]),at[5]=oe(lt,at[5]),at[6]=oe(wt,at[6]),at[7]=oe(Pt,at[7])}for(Jt="",Ut=0;Ut<32*at.length;Ut+=8)Jt+=String.fromCharCode(at[Ut>>5]>>>24-Ut%32&255);return Jt}function X(at){for(var Jt="",Zt,Ut=0;Ut<at.length;Ut++)Zt=at.charCodeAt(Ut),Jt+="0123456789abcdef".charAt(Zt>>>4&15)+"0123456789abcdef".charAt(Zt&15);return Jt}function Y(at){for(var Jt="",Zt=-1,Ut,_r;++Zt<at.length;)Ut=at.charCodeAt(Zt),_r=Zt+1<at.length?at.charCodeAt(Zt+1):0,55296<=Ut&&56319>=Ut&&56320<=_r&&57343>=_r&&(Ut=65536+((Ut&1023)<<10)+(_r&1023),Zt++),127>=Ut?Jt+=String.fromCharCode(Ut):2047>=Ut?Jt+=String.fromCharCode(192|Ut>>>6&31,128|Ut&63):65535>=Ut?Jt+=String.fromCharCode(224|Ut>>>12&15,128|Ut>>>6&63,128|Ut&63):2097151>=Ut&&(Jt+=String.fromCharCode(240|Ut>>>18&7,128|Ut>>>12&63,128|Ut>>>6&63,128|Ut&63));return Jt}function Z(at,Jt){return at>>>Jt|at<<32-Jt}function oe(at,Jt){var Zt=(at&65535)+(Jt&65535);return(at>>16)+(Jt>>16)+(Zt>>16)<<16|Zt&65535}function re(at){return Array.prototype.slice.call(at)}function se(at){return re(at).join("")}function N(at){function Jt(){var Pt=[],ke=[];return le(function(){Pt.push.apply(Pt,re(arguments))},{def:function(){var Se="v"+_r++;return ke.push(Se),0<arguments.length&&(Pt.push(Se,"="),Pt.push.apply(Pt,re(arguments)),Pt.push(";")),Se},toString:function(){return se([0<ke.length?"var "+ke.join(",")+";":"",se(Pt)])}})}function Zt(){function Pt(ct,At){Se(ct,At,"=",ke.def(ct,At),";")}var ke=Jt(),Se=Jt(),nt=ke.toString,it=Se.toString;return le(function(){ke.apply(ke,re(arguments))},{def:ke.def,entry:ke,exit:Se,save:Pt,set:function(ct,At,dt){Pt(ct,At),ke(ct,At,"=",dt,";")},toString:function(){return nt()+it()}})}var Ut=at&&at.cache,_r=0,rt=[],Ke=[],st=[],lt=Jt(),wt={};return{global:lt,link:function(Pt,ke){var Se=ke&&ke.stable;if(!Se){for(var nt=0;nt<Ke.length;++nt)if(Ke[nt]===Pt&&!st[nt])return rt[nt]}return nt="g"+_r++,rt.push(nt),Ke.push(Pt),st.push(Se),nt},block:Jt,proc:function(Pt,ke){function Se(){var At="a"+nt.length;return nt.push(At),At}var nt=[];ke=ke||0;for(var it=0;it<ke;++it)Se();var it=Zt(),ct=it.toString;return wt[Pt]=le(it,{arg:Se,toString:function(){return se(["function(",nt.join(),"){",ct(),"}"])}})},scope:Zt,cond:function(){var Pt=se(arguments),ke=Zt(),Se=Zt(),nt=ke.toString,it=Se.toString;return le(ke,{then:function(){return ke.apply(ke,re(arguments)),this},else:function(){return Se.apply(Se,re(arguments)),this},toString:function(){var ct=it();return ct&&(ct="else{"+ct+"}"),se(["if(",Pt,"){",nt(),"}",ct])}})},compile:function(){var Pt=['"use strict";',lt,"return {"];Object.keys(wt).forEach(function(nt){Pt.push('"',nt,'":',wt[nt].toString(),",")}),Pt.push("}");var ke=se(Pt).replace(/;/g,`;
`).replace(/}/g,`}
`).replace(/{/g,`{
`),Se;return Ut&&(Se=X(J(Y(ke))),Ut[Se])?Ut[Se].apply(null,Ke):(ke=Function.apply(null,rt.concat(ke)),Ut&&(Ut[Se]=ke),ke.apply(null,Ke))}}}function U(at){return Array.isArray(at)||ze(at)||g(at)}function q(at){return at.sort(function(Jt,Zt){return Jt==="viewport"?-1:Zt==="viewport"?1:Jt<Zt?-1:1})}function $(at,Jt,Zt,Ut){this.thisDep=at,this.contextDep=Jt,this.propDep=Zt,this.append=Ut}function W(at){return at&&!(at.thisDep||at.contextDep||at.propDep)}function K(at){return new $(!1,!1,!1,at)}function ne(at,Jt){var Zt=at.type;if(Zt===0)return Zt=at.data.length,new $(!0,1<=Zt,2<=Zt,Jt);if(Zt===4)return Zt=at.data,new $(Zt.thisDep,Zt.contextDep,Zt.propDep,Jt);if(Zt===5)return new $(!1,!1,!1,Jt);if(Zt===6){for(var Ut=Zt=!1,_r=!1,rt=0;rt<at.data.length;++rt){var Ke=at.data[rt];Ke.type===1?_r=!0:Ke.type===2?Ut=!0:Ke.type===3?Zt=!0:Ke.type===0?(Zt=!0,Ke=Ke.data,1<=Ke&&(Ut=!0),2<=Ke&&(_r=!0)):Ke.type===4&&(Zt=Zt||Ke.data.thisDep,Ut=Ut||Ke.data.contextDep,_r=_r||Ke.data.propDep)}return new $(Zt,Ut,_r,Jt)}return new $(Zt===3,Zt===2,Zt===1,Jt)}function ae(at,Jt,Zt,Ut,_r,rt,Ke,st,lt,wt,Pt,ke,Se,nt,it,ct){function At(Bt){return Bt.replace(".","_")}function dt(Bt,hr,rn){var vn=At(Bt);ua.push(Bt),Zn[vn]=An[vn]=!!rn,ea[vn]=hr}function Tt(Bt,hr,rn){var vn=At(Bt);ua.push(Bt),Array.isArray(rn)?(An[vn]=rn.slice(),Zn[vn]=rn.slice()):An[vn]=Zn[vn]=rn,Rn[vn]=hr}function Ht(){var Bt=N({cache:it}),hr=Bt.link,rn=Bt.global;Bt.id=li++,Bt.batchId="0";var vn=hr(Xn),en=Bt.shared={props:"a0"};Object.keys(Xn).forEach(function(yr){en[yr]=rn.def(vn,".",yr)});var Tn=Bt.next={},xn=Bt.current={};Object.keys(Rn).forEach(function(yr){Array.isArray(An[yr])&&(Tn[yr]=rn.def(en.next,".",yr),xn[yr]=rn.def(en.current,".",yr))});var un=Bt.constants={};Object.keys(Ua).forEach(function(yr){un[yr]=rn.def(JSON.stringify(Ua[yr]))}),Bt.invoke=function(yr,zr){switch(zr.type){case 0:var gn=["this",en.context,en.props,Bt.batchId];return yr.def(hr(zr.data),".call(",gn.slice(0,Math.max(zr.data.length+1,4)),")");case 1:return yr.def(en.props,zr.data);case 2:return yr.def(en.context,zr.data);case 3:return yr.def("this",zr.data);case 4:return zr.data.append(Bt,yr),zr.data.ref;case 5:return zr.data.toString();case 6:return zr.data.map(function(On){return Bt.invoke(yr,On)})}},Bt.attribCache={};var gr={};return Bt.scopeAttrib=function(yr){if(yr=Jt.id(yr),yr in gr)return gr[yr];var zr=wt.scope[yr];return zr||(zr=wt.scope[yr]=new ja),gr[yr]=hr(zr)},Bt}function ir(Bt){var hr=Bt.static;Bt=Bt.dynamic;var rn;if("profile"in hr){var vn=!!hr.profile;rn=K(function(Tn,xn){return vn}),rn.enable=vn}else if("profile"in Bt){var en=Bt.profile;rn=ne(en,function(Tn,xn){return Tn.invoke(xn,en)})}return rn}function kr(Bt,hr){var rn=Bt.static,vn=Bt.dynamic;if("framebuffer"in rn){var en=rn.framebuffer;return en?(en=st.getFramebuffer(en),K(function(xn,un){var gr=xn.link(en),yr=xn.shared;return un.set(yr.framebuffer,".next",gr),yr=yr.context,un.set(yr,".framebufferWidth",gr+".width"),un.set(yr,".framebufferHeight",gr+".height"),gr})):K(function(xn,un){var gr=xn.shared;return un.set(gr.framebuffer,".next","null"),gr=gr.context,un.set(gr,".framebufferWidth",gr+".drawingBufferWidth"),un.set(gr,".framebufferHeight",gr+".drawingBufferHeight"),"null"})}if("framebuffer"in vn){var Tn=vn.framebuffer;return ne(Tn,function(xn,un){var zr=xn.invoke(un,Tn),gr=xn.shared,yr=gr.framebuffer,zr=un.def(yr,".getFramebuffer(",zr,")");return un.set(yr,".next",zr),gr=gr.context,un.set(gr,".framebufferWidth",zr+"?"+zr+".width:"+gr+".drawingBufferWidth"),un.set(gr,".framebufferHeight",zr+"?"+zr+".height:"+gr+".drawingBufferHeight"),zr})}return null}function br(Bt,hr,rn){function vn(un){if(un in en){var gr=en[un];un=!0;var yr=gr.x|0,zr=gr.y|0,gn,On;return"width"in gr?gn=gr.width|0:un=!1,"height"in gr?On=gr.height|0:un=!1,new $(!un&&hr&&hr.thisDep,!un&&hr&&hr.contextDep,!un&&hr&&hr.propDep,function(_n,jn){var aa=_n.shared.context,pa=gn;"width"in gr||(pa=jn.def(aa,".","framebufferWidth","-",yr));var ma=On;return"height"in gr||(ma=jn.def(aa,".","framebufferHeight","-",zr)),[yr,zr,pa,ma]})}if(un in Tn){var ta=Tn[un];return un=ne(ta,function(_n,jn){var Aa=_n.invoke(jn,ta),aa=_n.shared.context,pa=jn.def(Aa,".x|0"),ma=jn.def(Aa,".y|0"),sa=jn.def('"width" in ',Aa,"?",Aa,".width|0:","(",aa,".","framebufferWidth","-",pa,")"),Aa=jn.def('"height" in ',Aa,"?",Aa,".height|0:","(",aa,".","framebufferHeight","-",ma,")");return[pa,ma,sa,Aa]}),hr&&(un.thisDep=un.thisDep||hr.thisDep,un.contextDep=un.contextDep||hr.contextDep,un.propDep=un.propDep||hr.propDep),un}return hr?new $(hr.thisDep,hr.contextDep,hr.propDep,function(_n,jn){var aa=_n.shared.context;return[0,0,jn.def(aa,".","framebufferWidth"),jn.def(aa,".","framebufferHeight")]}):null}var en=Bt.static,Tn=Bt.dynamic;if(Bt=vn("viewport")){var xn=Bt;Bt=new $(Bt.thisDep,Bt.contextDep,Bt.propDep,function(un,gr){var yr=xn.append(un,gr),zr=un.shared.context;return gr.set(zr,".viewportWidth",yr[2]),gr.set(zr,".viewportHeight",yr[3]),yr})}return{viewport:Bt,scissor_box:vn("scissor.box")}}function Mr(Bt,hr){var rn=Bt.static;if(typeof rn.frag=="string"&&typeof rn.vert=="string"){if(0<Object.keys(hr.dynamic).length)return null;var rn=hr.static,vn=Object.keys(rn);if(0<vn.length&&typeof rn[vn[0]]=="number"){for(var en=[],Tn=0;Tn<vn.length;++Tn)en.push([rn[vn[Tn]]|0,vn[Tn]]);return en}}return null}function Hr(Bt,hr,rn){function vn(yr){if(yr in en){var zr=Jt.id(en[yr]);return yr=K(function(){return zr}),yr.id=zr,yr}if(yr in Tn){var gn=Tn[yr];return ne(gn,function(On,ta){var _n=On.invoke(ta,gn);return ta.def(On.shared.strings,".id(",_n,")")})}return null}var en=Bt.static,Tn=Bt.dynamic,xn=vn("frag"),un=vn("vert"),gr=null;return W(xn)&&W(un)?(gr=Pt.program(un.id,xn.id,null,rn),Bt=K(function(yr,zr){return yr.link(gr)})):Bt=new $(xn&&xn.thisDep||un&&un.thisDep,xn&&xn.contextDep||un&&un.contextDep,xn&&xn.propDep||un&&un.propDep,function(yr,zr){var gn=yr.shared.shader,On;On=xn?xn.append(yr,zr):zr.def(gn,".","frag");var ta;return ta=un?un.append(yr,zr):zr.def(gn,".","vert"),zr.def(gn+".program("+ta+","+On+")")}),{frag:xn,vert:un,progVar:Bt,program:gr}}function nr(Bt,hr){function rn(_n,jn){if(_n in vn){var aa=vn[_n]|0;return jn?Tn.offset=aa:Tn.instances=aa,K(function(ma,sa){return jn&&(ma.OFFSET=aa),aa})}if(_n in en){var pa=en[_n];return ne(pa,function(ma,sa){var Aa=ma.invoke(sa,pa);return jn&&(ma.OFFSET=Aa),Aa})}if(jn){if(gr)return K(function(ma,sa){return ma.OFFSET=0});if(xn)return new $(un.thisDep,un.contextDep,un.propDep,function(ma,sa){return sa.def(ma.shared.vao+".currentVAO?"+ma.shared.vao+".currentVAO.offset:0")})}else if(xn)return new $(un.thisDep,un.contextDep,un.propDep,function(ma,sa){return sa.def(ma.shared.vao+".currentVAO?"+ma.shared.vao+".currentVAO.instances:-1")});return null}var vn=Bt.static,en=Bt.dynamic,Tn={},xn=!1,un=function(){if("vao"in vn){var _n=vn.vao;return _n!==null&&wt.getVAO(_n)===null&&(_n=wt.createVAO(_n)),xn=!0,Tn.vao=_n,K(function(aa){var pa=wt.getVAO(_n);return pa?aa.link(pa):"null"})}if("vao"in en){xn=!0;var jn=en.vao;return ne(jn,function(aa,pa){var ma=aa.invoke(pa,jn);return pa.def(aa.shared.vao+".getVAO("+ma+")")})}return null}(),gr=!1,yr=function(){if("elements"in vn){var _n=vn.elements;if(Tn.elements=_n,U(_n)){var jn=Tn.elements=rt.create(_n,!0),_n=rt.getElements(jn);gr=!0}else _n&&(_n=rt.getElements(_n),gr=!0);return jn=K(function(pa,ma){if(_n){var sa=pa.link(_n);return pa.ELEMENTS=sa}return pa.ELEMENTS=null}),jn.value=_n,jn}if("elements"in en){gr=!0;var aa=en.elements;return ne(aa,function(pa,ma){var sa=pa.shared,ho=sa.isBufferArgs,sa=sa.elements,Ro=pa.invoke(ma,aa),Aa=ma.def("null"),ho=ma.def(ho,"(",Ro,")"),Ro=pa.cond(ho).then(Aa,"=",sa,".createStream(",Ro,");").else(Aa,"=",sa,".getElements(",Ro,");");return ma.entry(Ro),ma.exit(pa.cond(ho).then(sa,".destroyStream(",Aa,");")),pa.ELEMENTS=Aa})}return xn?new $(un.thisDep,un.contextDep,un.propDep,function(pa,ma){return ma.def(pa.shared.vao+".currentVAO?"+pa.shared.elements+".getElements("+pa.shared.vao+".currentVAO.elements):null")}):null}(),zr=rn("offset",!0),gn=function(){if("primitive"in vn){var _n=vn.primitive;return Tn.primitive=_n,K(function(aa,pa){return He[_n]})}if("primitive"in en){var jn=en.primitive;return ne(jn,function(aa,pa){var ma=aa.constants.primTypes,sa=aa.invoke(pa,jn);return pa.def(ma,"[",sa,"]")})}return gr?W(yr)?yr.value?K(function(aa,pa){return pa.def(aa.ELEMENTS,".primType")}):K(function(){return 4}):new $(yr.thisDep,yr.contextDep,yr.propDep,function(aa,pa){var ma=aa.ELEMENTS;return pa.def(ma,"?",ma,".primType:",4)}):xn?new $(un.thisDep,un.contextDep,un.propDep,function(aa,pa){return pa.def(aa.shared.vao+".currentVAO?"+aa.shared.vao+".currentVAO.primitive:4")}):null}(),On=function(){if("count"in vn){var _n=vn.count|0;return Tn.count=_n,K(function(){return _n})}if("count"in en){var jn=en.count;return ne(jn,function(aa,pa){return aa.invoke(pa,jn)})}return gr?W(yr)?yr?zr?new $(zr.thisDep,zr.contextDep,zr.propDep,function(aa,pa){return pa.def(aa.ELEMENTS,".vertCount-",aa.OFFSET)}):K(function(aa,pa){return pa.def(aa.ELEMENTS,".vertCount")}):K(function(){return-1}):new $(yr.thisDep||zr.thisDep,yr.contextDep||zr.contextDep,yr.propDep||zr.propDep,function(aa,pa){var ma=aa.ELEMENTS;return aa.OFFSET?pa.def(ma,"?",ma,".vertCount-",aa.OFFSET,":-1"):pa.def(ma,"?",ma,".vertCount:-1")}):xn?new $(un.thisDep,un.contextDep,un.propDep,function(aa,pa){return pa.def(aa.shared.vao,".currentVAO?",aa.shared.vao,".currentVAO.count:-1")}):null}(),ta=rn("instances",!1);return{elements:yr,primitive:gn,count:On,instances:ta,offset:zr,vao:un,vaoActive:xn,elementsActive:gr,static:Tn}}function mr(Bt,hr){var rn=Bt.static,vn=Bt.dynamic,en={};return ua.forEach(function(Tn){function xn(gr,yr){if(Tn in rn){var zr=gr(rn[Tn]);en[un]=K(function(){return zr})}else if(Tn in vn){var gn=vn[Tn];en[un]=ne(gn,function(On,ta){return yr(On,ta,On.invoke(ta,gn))})}}var un=At(Tn);switch(Tn){case"cull.enable":case"blend.enable":case"dither":case"stencil.enable":case"depth.enable":case"scissor.enable":case"polygonOffset.enable":case"sample.alpha":case"sample.enable":case"depth.mask":return xn(function(gr){return gr},function(gr,yr,zr){return zr});case"depth.func":return xn(function(gr){return Yt[gr]},function(gr,yr,zr){return yr.def(gr.constants.compareFuncs,"[",zr,"]")});case"depth.range":return xn(function(gr){return gr},function(gr,yr,zr){return gr=yr.def("+",zr,"[0]"),yr=yr.def("+",zr,"[1]"),[gr,yr]});case"blend.func":return xn(function(gr){return[qt["srcRGB"in gr?gr.srcRGB:gr.src],qt["dstRGB"in gr?gr.dstRGB:gr.dst],qt["srcAlpha"in gr?gr.srcAlpha:gr.src],qt["dstAlpha"in gr?gr.dstAlpha:gr.dst]]},function(gr,yr,zr){function gn(jn,aa){return yr.def('"',jn,aa,'" in ',zr,"?",zr,".",jn,aa,":",zr,".",jn)}gr=gr.constants.blendFuncs;var On=gn("src","RGB"),_n=gn("dst","RGB"),On=yr.def(gr,"[",On,"]"),ta=yr.def(gr,"[",gn("src","Alpha"),"]"),_n=yr.def(gr,"[",_n,"]");return gr=yr.def(gr,"[",gn("dst","Alpha"),"]"),[On,_n,ta,gr]});case"blend.equation":return xn(function(gr){if(typeof gr=="string")return[Wa[gr],Wa[gr]];if(typeof gr=="object")return[Wa[gr.rgb],Wa[gr.alpha]]},function(gr,yr,zr){var gn=gr.constants.blendEquations,On=yr.def(),ta=yr.def();return gr=gr.cond("typeof ",zr,'==="string"'),gr.then(On,"=",ta,"=",gn,"[",zr,"];"),gr.else(On,"=",gn,"[",zr,".rgb];",ta,"=",gn,"[",zr,".alpha];"),yr(gr),[On,ta]});case"blend.color":return xn(function(gr){return i(4,function(yr){return+gr[yr]})},function(gr,yr,zr){return i(4,function(gn){return yr.def("+",zr,"[",gn,"]")})});case"stencil.mask":return xn(function(gr){return gr|0},function(gr,yr,zr){return yr.def(zr,"|0")});case"stencil.func":return xn(function(gr){return[Yt[gr.cmp||"keep"],gr.ref||0,"mask"in gr?gr.mask:-1]},function(gr,yr,zr){gr=yr.def('"cmp" in ',zr,"?",gr.constants.compareFuncs,"[",zr,".cmp]",":",7680);var gn=yr.def(zr,".ref|0");return yr=yr.def('"mask" in ',zr,"?",zr,".mask|0:-1"),[gr,gn,yr]});case"stencil.opFront":case"stencil.opBack":return xn(function(gr){return[Tn==="stencil.opBack"?1029:1028,fr[gr.fail||"keep"],fr[gr.zfail||"keep"],fr[gr.zpass||"keep"]]},function(gr,yr,zr){function gn(ta){return yr.def('"',ta,'" in ',zr,"?",On,"[",zr,".",ta,"]:",7680)}var On=gr.constants.stencilOps;return[Tn==="stencil.opBack"?1029:1028,gn("fail"),gn("zfail"),gn("zpass")]});case"polygonOffset.offset":return xn(function(gr){return[gr.factor|0,gr.units|0]},function(gr,yr,zr){return gr=yr.def(zr,".factor|0"),yr=yr.def(zr,".units|0"),[gr,yr]});case"cull.face":return xn(function(gr){var yr=0;return gr==="front"?yr=1028:gr==="back"&&(yr=1029),yr},function(gr,yr,zr){return yr.def(zr,'==="front"?',1028,":",1029)});case"lineWidth":return xn(function(gr){return gr},function(gr,yr,zr){return zr});case"frontFace":return xn(function(gr){return Yr[gr]},function(gr,yr,zr){return yr.def(zr+'==="cw"?2304:2305')});case"colorMask":return xn(function(gr){return gr.map(function(yr){return!!yr})},function(gr,yr,zr){return i(4,function(gn){return"!!"+zr+"["+gn+"]"})});case"sample.coverage":return xn(function(gr){return["value"in gr?gr.value:1,!!gr.invert]},function(gr,yr,zr){return gr=yr.def('"value" in ',zr,"?+",zr,".value:1"),yr=yr.def("!!",zr,".invert"),[gr,yr]})}}),en}function Pr(Bt,hr){var rn=Bt.static,vn=Bt.dynamic,en={};return Object.keys(rn).forEach(function(Tn){var xn=rn[Tn],un;if(typeof xn=="number"||typeof xn=="boolean")un=K(function(){return xn});else if(typeof xn=="function"){var gr=xn._reglType;gr==="texture2d"||gr==="textureCube"?un=K(function(yr){return yr.link(xn)}):(gr==="framebuffer"||gr==="framebufferCube")&&(un=K(function(yr){return yr.link(xn.color[0])}))}else x(xn)&&(un=K(function(yr){return yr.global.def("[",i(xn.length,function(zr){return xn[zr]}),"]")}));un.value=xn,en[Tn]=un}),Object.keys(vn).forEach(function(Tn){var xn=vn[Tn];en[Tn]=ne(xn,function(un,gr){return un.invoke(gr,xn)})}),en}function Nr(Bt,hr){var rn=Bt.static,vn=Bt.dynamic,en={};return Object.keys(rn).forEach(function(Tn){var xn=rn[Tn],un=Jt.id(Tn),gr=new ja;if(U(xn))gr.state=1,gr.buffer=_r.getBuffer(_r.create(xn,34962,!1,!0)),gr.type=0;else{var yr=_r.getBuffer(xn);if(yr)gr.state=1,gr.buffer=yr,gr.type=0;else if("constant"in xn){var zr=xn.constant;gr.buffer="null",gr.state=2,typeof zr=="number"?gr.x=zr:Nt.forEach(function(aa,pa){pa<zr.length&&(gr[aa]=zr[pa])})}else{var yr=U(xn.buffer)?_r.getBuffer(_r.create(xn.buffer,34962,!1,!0)):_r.getBuffer(xn.buffer),gn=xn.offset|0,On=xn.stride|0,ta=xn.size|0,_n=!!xn.normalized,jn=0;"type"in xn&&(jn=Pe[xn.type]),xn=xn.divisor|0,gr.buffer=yr,gr.state=1,gr.size=ta,gr.normalized=_n,gr.type=jn||yr.dtype,gr.offset=gn,gr.stride=On,gr.divisor=xn}}en[Tn]=K(function(aa,pa){var ma=aa.attribCache;if(un in ma)return ma[un];var sa={isStream:!1};return Object.keys(gr).forEach(function(Aa){sa[Aa]=gr[Aa]}),gr.buffer&&(sa.buffer=aa.link(gr.buffer),sa.type=sa.type||sa.buffer+".dtype"),ma[un]=sa})}),Object.keys(vn).forEach(function(Tn){var xn=vn[Tn];en[Tn]=ne(xn,function(un,gr){function yr(ma){gr(_n[ma],"=",zr,".",ma,"|0;")}var zr=un.invoke(gr,xn),ta=un.shared,gn=un.constants,On=ta.isBufferArgs,ta=ta.buffer,_n={isStream:gr.def(!1)},jn=new ja;jn.state=1,Object.keys(jn).forEach(function(ma){_n[ma]=gr.def(""+jn[ma])});var aa=_n.buffer,pa=_n.type;return gr("if(",On,"(",zr,")){",_n.isStream,"=true;",aa,"=",ta,".createStream(",34962,",",zr,");",pa,"=",aa,".dtype;","}else{",aa,"=",ta,".getBuffer(",zr,");","if(",aa,"){",pa,"=",aa,".dtype;",'}else if("constant" in ',zr,"){",_n.state,"=",2,";","if(typeof "+zr+'.constant === "number"){',_n[Nt[0]],"=",zr,".constant;",Nt.slice(1).map(function(ma){return _n[ma]}).join("="),"=0;","}else{",Nt.map(function(ma,sa){return _n[ma]+"="+zr+".constant.length>"+sa+"?"+zr+".constant["+sa+"]:0;"}).join(""),"}}else{","if(",On,"(",zr,".buffer)){",aa,"=",ta,".createStream(",34962,",",zr,".buffer);","}else{",aa,"=",ta,".getBuffer(",zr,".buffer);","}",pa,'="type" in ',zr,"?",gn.glTypes,"[",zr,".type]:",aa,".dtype;",_n.normalized,"=!!",zr,".normalized;"),yr("size"),yr("offset"),yr("stride"),yr("divisor"),gr("}}"),gr.exit("if(",_n.isStream,"){",ta,".destroyStream(",aa,");","}"),_n})}),en}function Sr(Bt){var hr=Bt.static,rn=Bt.dynamic,vn={};return Object.keys(hr).forEach(function(en){var Tn=hr[en];vn[en]=K(function(xn,un){return typeof Tn=="number"||typeof Tn=="boolean"?""+Tn:xn.link(Tn)})}),Object.keys(rn).forEach(function(en){var Tn=rn[en];vn[en]=ne(Tn,function(xn,un){return xn.invoke(un,Tn)})}),vn}function tt(Bt,hr,rn,vn,en){function Tn(jn){var aa=un[jn];aa&&(yr[jn]=aa)}var xn=Mr(Bt,hr),On=kr(Bt),un=br(Bt,On),gr=nr(Bt),yr=mr(Bt),zr=Hr(Bt,en,xn);Tn("viewport"),Tn(At("scissor.box"));var gn=0<Object.keys(yr).length,On={framebuffer:On,draw:gr,shader:zr,state:yr,dirty:gn,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}};if(On.profile=ir(Bt),On.uniforms=Pr(rn),On.drawVAO=On.scopeVAO=gr.vao,!On.drawVAO&&zr.program&&!xn&&Zt.angle_instanced_arrays&&gr.static.elements){var ta=!0;if(Bt=zr.program.attributes.map(function(jn){return jn=hr.static[jn],ta=ta&&!!jn,jn}),ta&&0<Bt.length){var _n=wt.getVAO(wt.createVAO({attributes:Bt,elements:gr.static.elements}));On.drawVAO=new $(null,null,null,function(jn,aa){return jn.link(_n)}),On.useVAO=!0}}return xn?On.useVAO=!0:On.attributes=Nr(hr),On.context=Sr(vn),On}function Et(Bt,hr,rn){var vn=Bt.shared.context,en=Bt.scope();Object.keys(rn).forEach(function(Tn){hr.save(vn,"."+Tn);var xn=rn[Tn].append(Bt,hr);Array.isArray(xn)?en(vn,".",Tn,"=[",xn.join(),"];"):en(vn,".",Tn,"=",xn,";")}),hr(en)}function Vt(Bt,hr,rn,vn){var un=Bt.shared,en=un.gl,Tn=un.framebuffer,xn;pn&&(xn=hr.def(un.extensions,".webgl_draw_buffers"));var gr=Bt.constants,un=gr.drawBuffer,gr=gr.backBuffer;Bt=rn?rn.append(Bt,hr):hr.def(Tn,".next"),vn||hr("if(",Bt,"!==",Tn,".cur){"),hr("if(",Bt,"){",en,".bindFramebuffer(",36160,",",Bt,".framebuffer);"),pn&&hr(xn,".drawBuffersWEBGL(",un,"[",Bt,".colorAttachments.length]);"),hr("}else{",en,".bindFramebuffer(",36160,",null);"),pn&&hr(xn,".drawBuffersWEBGL(",gr,");"),hr("}",Tn,".cur=",Bt,";"),vn||hr("}")}function ar(Bt,hr,rn){var vn=Bt.shared,en=vn.gl,Tn=Bt.current,xn=Bt.next,un=vn.current,gr=vn.next,yr=Bt.cond(un,".dirty");ua.forEach(function(zr){if(zr=At(zr),!(zr in rn.state)){var gn,On;if(zr in xn){gn=xn[zr],On=Tn[zr];var ta=i(An[zr].length,function(_n){return yr.def(gn,"[",_n,"]")});yr(Bt.cond(ta.map(function(_n,jn){return _n+"!=="+On+"["+jn+"]"}).join("||")).then(en,".",Rn[zr],"(",ta,");",ta.map(function(_n,jn){return On+"["+jn+"]="+_n}).join(";"),";"))}else gn=yr.def(gr,".",zr),ta=Bt.cond(gn,"!==",un,".",zr),yr(ta),zr in ea?ta(Bt.cond(gn).then(en,".enable(",ea[zr],");").else(en,".disable(",ea[zr],");"),un,".",zr,"=",gn,";"):ta(en,".",Rn[zr],"(",gn,");",un,".",zr,"=",gn,";")}}),Object.keys(rn.state).length===0&&yr(un,".dirty=false;"),hr(yr)}function Cr(Bt,hr,rn,vn){var en=Bt.shared,Tn=Bt.current,xn=en.current,un=en.gl,gr;q(Object.keys(rn)).forEach(function(yr){var zr=rn[yr];if(!vn||vn(zr)){var gn=zr.append(Bt,hr);if(ea[yr]){var On=ea[yr];W(zr)?(gr=Bt.link(gn,{stable:!0}),hr(Bt.cond(gr).then(un,".enable(",On,");").else(un,".disable(",On,");")),hr(xn,".",yr,"=",gr,";")):(hr(Bt.cond(gn).then(un,".enable(",On,");").else(un,".disable(",On,");")),hr(xn,".",yr,"=",gn,";"))}else if(x(gn)){var ta=Tn[yr];hr(un,".",Rn[yr],"(",gn,");",gn.map(function(_n,jn){return ta+"["+jn+"]="+_n}).join(";"),";")}else W(zr)?(gr=Bt.link(gn,{stable:!0}),hr(un,".",Rn[yr],"(",gr,");",xn,".",yr,"=",gr,";")):hr(un,".",Rn[yr],"(",gn,");",xn,".",yr,"=",gn,";")}})}function Or(Bt,hr){wr&&(Bt.instancing=hr.def(Bt.shared.extensions,".angle_instanced_arrays"))}function Ir(Bt,hr,rn,vn,en){function Tn(){return typeof performance>"u"?"Date.now()":"performance.now()"}function xn(jn){ta=hr.def(),jn(ta,"=",Tn(),";"),typeof en=="string"?jn(zr,".count+=",en,";"):jn(zr,".count++;"),nt&&(vn?(_n=hr.def(),jn(_n,"=",On,".getNumPendingQueries();")):jn(On,".beginQuery(",zr,");"))}function un(jn){jn(zr,".cpuTime+=",Tn(),"-",ta,";"),nt&&(vn?jn(On,".pushScopeStats(",_n,",",On,".getNumPendingQueries(),",zr,");"):jn(On,".endQuery();"))}function gr(jn){var aa=hr.def(gn,".profile");hr(gn,".profile=",jn,";"),hr.exit(gn,".profile=",aa,";")}var yr=Bt.shared,zr=Bt.stats,gn=yr.current,On=yr.timer;rn=rn.profile;var ta,_n;if(rn){if(W(rn)){rn.enable?(xn(hr),un(hr.exit),gr("true")):gr("false");return}rn=rn.append(Bt,hr),gr(rn)}else rn=hr.def(gn,".profile");yr=Bt.block(),xn(yr),hr("if(",rn,"){",yr,"}"),Bt=Bt.block(),un(Bt),hr.exit("if(",rn,"){",Bt,"}")}function Tr(Bt,hr,rn,vn,en){function Tn(gr){switch(gr){case 35664:case 35667:case 35671:return 2;case 35665:case 35668:case 35672:return 3;case 35666:case 35669:case 35673:return 4;default:return 1}}function xn(gr,yr,zr){function gn(){hr("if(!",jn,".buffer){",ta,".enableVertexAttribArray(",_n,");}");var sa=zr.type,Aa;Aa=zr.size?hr.def(zr.size,"||",yr):yr,hr("if(",jn,".type!==",sa,"||",jn,".size!==",Aa,"||",ma.map(function(ho){return jn+"."+ho+"!=="+zr[ho]}).join("||"),"){",ta,".bindBuffer(",34962,",",aa,".buffer);",ta,".vertexAttribPointer(",[_n,Aa,sa,zr.normalized,zr.stride,zr.offset],");",jn,".type=",sa,";",jn,".size=",Aa,";",ma.map(function(ho){return jn+"."+ho+"="+zr[ho]+";"}).join(""),"}"),wr&&(sa=zr.divisor,hr("if(",jn,".divisor!==",sa,"){",Bt.instancing,".vertexAttribDivisorANGLE(",[_n,sa],");",jn,".divisor=",sa,";}"))}function On(){hr("if(",jn,".buffer){",ta,".disableVertexAttribArray(",_n,");",jn,".buffer=null;","}if(",Nt.map(function(sa,Aa){return jn+"."+sa+"!=="+pa[Aa]}).join("||"),"){",ta,".vertexAttrib4f(",_n,",",pa,");",Nt.map(function(sa,Aa){return jn+"."+sa+"="+pa[Aa]+";"}).join(""),"}")}var ta=un.gl,_n=hr.def(gr,".location"),jn=hr.def(un.attributes,"[",_n,"]");gr=zr.state;var aa=zr.buffer,pa=[zr.x,zr.y,zr.z,zr.w],ma=["buffer","normalized","offset","stride"];gr===1?gn():gr===2?On():(hr("if(",gr,"===",1,"){"),gn(),hr("}else{"),On(),hr("}"))}var un=Bt.shared;vn.forEach(function(gr){var yr=gr.name,zr=rn.attributes[yr],gn;if(zr){if(!en(zr))return;gn=zr.append(Bt,hr)}else{if(!en(hn))return;var On=Bt.scopeAttrib(yr);gn={},Object.keys(new ja).forEach(function(ta){gn[ta]=hr.def(On,".",ta)})}xn(Bt.link(gr),Tn(gr.info.type),gn)})}function Wr(Bt,hr,rn,vn,en,Tn){for(var xn=Bt.shared,un=xn.gl,gr,yr=0;yr<vn.length;++yr){var ta=vn[yr],zr=ta.name,gn=ta.info.type,On=rn.uniforms[zr],ta=Bt.link(ta)+".location",_n;if(On){if(!en(On))continue;if(W(On)){if(zr=On.value,gn===35678||gn===35680)gn=Bt.link(zr._texture||zr.color[0]._texture),hr(un,".uniform1i(",ta,",",gn+".bind());"),hr.exit(gn,".unbind();");else if(gn===35674||gn===35675||gn===35676)zr=Bt.global.def("new Float32Array(["+Array.prototype.slice.call(zr)+"])"),On=2,gn===35675?On=3:gn===35676&&(On=4),hr(un,".uniformMatrix",On,"fv(",ta,",false,",zr,");");else{switch(gn){case 5126:gr="1f";break;case 35664:gr="2f";break;case 35665:gr="3f";break;case 35666:gr="4f";break;case 35670:gr="1i";break;case 5124:gr="1i";break;case 35671:gr="2i";break;case 35667:gr="2i";break;case 35672:gr="3i";break;case 35668:gr="3i";break;case 35673:gr="4i";break;case 35669:gr="4i"}hr(un,".uniform",gr,"(",ta,",",x(zr)?Array.prototype.slice.call(zr):zr,");")}continue}else _n=On.append(Bt,hr)}else{if(!en(hn))continue;_n=hr.def(xn.uniforms,"[",Jt.id(zr),"]")}switch(gn===35678?hr("if(",_n,"&&",_n,'._reglType==="framebuffer"){',_n,"=",_n,".color[0];","}"):gn===35680&&hr("if(",_n,"&&",_n,'._reglType==="framebufferCube"){',_n,"=",_n,".color[0];","}"),zr=1,gn){case 35678:case 35680:gn=hr.def(_n,"._texture"),hr(un,".uniform1i(",ta,",",gn,".bind());"),hr.exit(gn,".unbind();");continue;case 5124:case 35670:gr="1i";break;case 35667:case 35671:gr="2i",zr=2;break;case 35668:case 35672:gr="3i",zr=3;break;case 35669:case 35673:gr="4i",zr=4;break;case 5126:gr="1f";break;case 35664:gr="2f",zr=2;break;case 35665:gr="3f",zr=3;break;case 35666:gr="4f",zr=4;break;case 35674:gr="Matrix2fv";break;case 35675:gr="Matrix3fv";break;case 35676:gr="Matrix4fv"}if(gr.charAt(0)==="M"){hr(un,".uniform",gr,"(",ta,",");var ta=Math.pow(gn-35674+2,2),jn=Bt.global.def("new Float32Array(",ta,")");Array.isArray(_n)?hr("false,(",i(ta,function(ma){return jn+"["+ma+"]="+_n[ma]}),",",jn,")"):hr("false,(Array.isArray(",_n,")||",_n," instanceof Float32Array)?",_n,":(",i(ta,function(ma){return jn+"["+ma+"]="+_n+"["+ma+"]"}),",",jn,")"),hr(");")}else{if(1<zr){for(var gn=[],aa=[],On=0;On<zr;++On)Array.isArray(_n)?aa.push(_n[On]):aa.push(hr.def(_n+"["+On+"]")),Tn&&gn.push(hr.def());Tn&&hr("if(!",Bt.batchId,"||",gn.map(function(pa,ma){return pa+"!=="+aa[ma]}).join("||"),"){",gn.map(function(pa,ma){return pa+"="+aa[ma]+";"}).join("")),hr(un,".uniform",gr,"(",ta,",",aa.join(","),");")}else Tn&&(gn=hr.def(),hr("if(!",Bt.batchId,"||",gn,"!==",_n,"){",gn,"=",_n,";")),hr(un,".uniform",gr,"(",ta,",",_n,");");Tn&&hr("}")}}}function wn(Bt,hr,rn,vn){function en(sa){var Aa=zr[sa];return Aa?Aa.contextDep&&vn.contextDynamic||Aa.propDep?Aa.append(Bt,rn):Aa.append(Bt,hr):hr.def(yr,".",sa)}function Tn(){function sa(){rn(aa,".drawElementsInstancedANGLE(",[On,_n,pa,ta+"<<(("+pa+"-5121)>>1)",jn],");")}function Aa(){rn(aa,".drawArraysInstancedANGLE(",[On,ta,_n,jn],");")}gn&&gn!=="null"?ma?sa():(rn("if(",gn,"){"),sa(),rn("}else{"),Aa(),rn("}")):Aa()}function xn(){function sa(){rn(gr+".drawElements("+[On,_n,pa,ta+"<<(("+pa+"-5121)>>1)"]+");")}function Aa(){rn(gr+".drawArrays("+[On,ta,_n]+");")}gn&&gn!=="null"?ma?sa():(rn("if(",gn,"){"),sa(),rn("}else{"),Aa(),rn("}")):Aa()}var un=Bt.shared,gr=un.gl,yr=un.draw,zr=vn.draw,gn=function(){var sa=zr.elements,Aa=hr;return sa?((sa.contextDep&&vn.contextDynamic||sa.propDep)&&(Aa=rn),sa=sa.append(Bt,Aa),zr.elementsActive&&Aa("if("+sa+")"+gr+".bindBuffer(34963,"+sa+".buffer.buffer);")):(sa=Aa.def(),Aa(sa,"=",yr,".","elements",";","if(",sa,"){",gr,".bindBuffer(",34963,",",sa,".buffer.buffer);}","else if(",un.vao,".currentVAO){",sa,"=",Bt.shared.elements+".getElements("+un.vao,".currentVAO.elements);",fn?"":"if("+sa+")"+gr+".bindBuffer(34963,"+sa+".buffer.buffer);","}")),sa}(),On=en("primitive"),ta=en("offset"),_n=function(){var sa=zr.count,Aa=hr;return sa?((sa.contextDep&&vn.contextDynamic||sa.propDep)&&(Aa=rn),sa=sa.append(Bt,Aa)):sa=Aa.def(yr,".","count"),sa}();if(typeof _n=="number"){if(_n===0)return}else rn("if(",_n,"){"),rn.exit("}");var jn,aa;wr&&(jn=en("instances"),aa=Bt.instancing);var pa=gn+".type",ma=zr.elements&&W(zr.elements)&&!zr.vaoActive;wr&&(typeof jn!="number"||0<=jn)?typeof jn=="string"?(rn("if(",jn,">0){"),Tn(),rn("}else if(",jn,"<0){"),xn(),rn("}")):Tn():xn()}function ln(Bt,hr,rn,vn,en){return hr=Ht(),en=hr.proc("body",en),wr&&(hr.instancing=en.def(hr.shared.extensions,".angle_instanced_arrays")),Bt(hr,en,rn,vn),hr.compile().body}function Bn(Bt,hr,rn,vn){Or(Bt,hr),rn.useVAO?rn.drawVAO?hr(Bt.shared.vao,".setVAO(",rn.drawVAO.append(Bt,hr),");"):hr(Bt.shared.vao,".setVAO(",Bt.shared.vao,".targetVAO);"):(hr(Bt.shared.vao,".setVAO(null);"),Tr(Bt,hr,rn,vn.attributes,function(){return!0})),Wr(Bt,hr,rn,vn.uniforms,function(){return!0},!1),wn(Bt,hr,hr,rn)}function Cn(Bt,hr){var rn=Bt.proc("draw",1);Or(Bt,rn),Et(Bt,rn,hr.context),Vt(Bt,rn,hr.framebuffer),ar(Bt,rn,hr),Cr(Bt,rn,hr.state),Ir(Bt,rn,hr,!1,!0);var vn=hr.shader.progVar.append(Bt,rn);if(rn(Bt.shared.gl,".useProgram(",vn,".program);"),hr.shader.program)Bn(Bt,rn,hr,hr.shader.program);else{rn(Bt.shared.vao,".setVAO(null);");var en=Bt.global.def("{}"),Tn=rn.def(vn,".id"),xn=rn.def(en,"[",Tn,"]");rn(Bt.cond(xn).then(xn,".call(this,a0);").else(xn,"=",en,"[",Tn,"]=",Bt.link(function(un){return ln(Bn,Bt,hr,un,1)}),"(",vn,");",xn,".call(this,a0);"))}0<Object.keys(hr.state).length&&rn(Bt.shared.current,".dirty=true;"),Bt.shared.vao&&rn(Bt.shared.vao,".setVAO(null);")}function Wn(Bt,hr,rn,vn){function en(){return!0}Bt.batchId="a1",Or(Bt,hr),Tr(Bt,hr,rn,vn.attributes,en),Wr(Bt,hr,rn,vn.uniforms,en,!1),wn(Bt,hr,hr,rn)}function Hn(Bt,hr,rn,vn){function en(gn){return gn.contextDep&&xn||gn.propDep}function Tn(gn){return!en(gn)}Or(Bt,hr);var xn=rn.contextDep,un=hr.def(),gr=hr.def();Bt.shared.props=gr,Bt.batchId=un;var yr=Bt.scope(),zr=Bt.scope();hr(yr.entry,"for(",un,"=0;",un,"<","a1",";++",un,"){",gr,"=","a0","[",un,"];",zr,"}",yr.exit),rn.needsContext&&Et(Bt,zr,rn.context),rn.needsFramebuffer&&Vt(Bt,zr,rn.framebuffer),Cr(Bt,zr,rn.state,en),rn.profile&&en(rn.profile)&&Ir(Bt,zr,rn,!1,!0),vn?(rn.useVAO?rn.drawVAO?en(rn.drawVAO)?zr(Bt.shared.vao,".setVAO(",rn.drawVAO.append(Bt,zr),");"):yr(Bt.shared.vao,".setVAO(",rn.drawVAO.append(Bt,yr),");"):yr(Bt.shared.vao,".setVAO(",Bt.shared.vao,".targetVAO);"):(yr(Bt.shared.vao,".setVAO(null);"),Tr(Bt,yr,rn,vn.attributes,Tn),Tr(Bt,zr,rn,vn.attributes,en)),Wr(Bt,yr,rn,vn.uniforms,Tn,!1),Wr(Bt,zr,rn,vn.uniforms,en,!0),wn(Bt,yr,zr,rn)):(hr=Bt.global.def("{}"),vn=rn.shader.progVar.append(Bt,zr),gr=zr.def(vn,".id"),yr=zr.def(hr,"[",gr,"]"),zr(Bt.shared.gl,".useProgram(",vn,".program);","if(!",yr,"){",yr,"=",hr,"[",gr,"]=",Bt.link(function(gn){return ln(Wn,Bt,rn,gn,2)}),"(",vn,");}",yr,".call(this,a0[",un,"],",un,");"))}function ga(Bt,hr){function rn(yr){return yr.contextDep&&en||yr.propDep}var vn=Bt.proc("batch",2);Bt.batchId="0",Or(Bt,vn);var en=!1,Tn=!0;Object.keys(hr.context).forEach(function(yr){en=en||hr.context[yr].propDep}),en||(Et(Bt,vn,hr.context),Tn=!1);var xn=hr.framebuffer,un=!1;if(xn?(xn.propDep?en=un=!0:xn.contextDep&&en&&(un=!0),un||Vt(Bt,vn,xn)):Vt(Bt,vn,null),hr.state.viewport&&hr.state.viewport.propDep&&(en=!0),ar(Bt,vn,hr),Cr(Bt,vn,hr.state,function(yr){return!rn(yr)}),hr.profile&&rn(hr.profile)||Ir(Bt,vn,hr,!1,"a1"),hr.contextDep=en,hr.needsContext=Tn,hr.needsFramebuffer=un,Tn=hr.shader.progVar,Tn.contextDep&&en||Tn.propDep)Hn(Bt,vn,hr,null);else if(Tn=Tn.append(Bt,vn),vn(Bt.shared.gl,".useProgram(",Tn,".program);"),hr.shader.program)Hn(Bt,vn,hr,hr.shader.program);else{vn(Bt.shared.vao,".setVAO(null);");var xn=Bt.global.def("{}"),un=vn.def(Tn,".id"),gr=vn.def(xn,"[",un,"]");vn(Bt.cond(gr).then(gr,".call(this,a0,a1);").else(gr,"=",xn,"[",un,"]=",Bt.link(function(gn){return ln(Hn,Bt,hr,gn,2)}),"(",Tn,");",gr,".call(this,a0,a1);"))}0<Object.keys(hr.state).length&&vn(Bt.shared.current,".dirty=true;"),Bt.shared.vao&&vn(Bt.shared.vao,".setVAO(null);")}function La(Bt,hr){function rn(un){var gr=hr.shader[un];gr&&(gr=gr.append(Bt,vn),isNaN(gr)?vn.set(en.shader,"."+un,gr):vn.set(en.shader,"."+un,Bt.link(gr,{stable:!0})))}var vn=Bt.proc("scope",3);Bt.batchId="a2";var en=Bt.shared,Tn=en.current;if(Et(Bt,vn,hr.context),hr.framebuffer&&hr.framebuffer.append(Bt,vn),q(Object.keys(hr.state)).forEach(function(un){var gr=hr.state[un],yr=gr.append(Bt,vn);x(yr)?yr.forEach(function(zr,gn){isNaN(zr)?vn.set(Bt.next[un],"["+gn+"]",zr):vn.set(Bt.next[un],"["+gn+"]",Bt.link(zr,{stable:!0}))}):W(gr)?vn.set(en.next,"."+un,Bt.link(yr,{stable:!0})):vn.set(en.next,"."+un,yr)}),Ir(Bt,vn,hr,!0,!0),["elements","offset","count","instances","primitive"].forEach(function(un){var gr=hr.draw[un];gr&&(gr=gr.append(Bt,vn),isNaN(gr)?vn.set(en.draw,"."+un,gr):vn.set(en.draw,"."+un,Bt.link(gr),{stable:!0}))}),Object.keys(hr.uniforms).forEach(function(un){var gr=hr.uniforms[un].append(Bt,vn);Array.isArray(gr)&&(gr="["+gr.map(function(yr){return isNaN(yr)?yr:Bt.link(yr,{stable:!0})})+"]"),vn.set(en.uniforms,"["+Bt.link(Jt.id(un),{stable:!0})+"]",gr)}),Object.keys(hr.attributes).forEach(function(un){var gr=hr.attributes[un].append(Bt,vn),yr=Bt.scopeAttrib(un);Object.keys(new ja).forEach(function(zr){vn.set(yr,"."+zr,gr[zr])})}),hr.scopeVAO){var xn=hr.scopeVAO.append(Bt,vn);isNaN(xn)?vn.set(en.vao,".targetVAO",xn):vn.set(en.vao,".targetVAO",Bt.link(xn,{stable:!0}))}rn("vert"),rn("frag"),0<Object.keys(hr.state).length&&(vn(Tn,".dirty=true;"),vn.exit(Tn,".dirty=true;")),vn("a1(",Bt.shared.context,",a0,",Bt.batchId,");")}function ci(Bt){if(typeof Bt=="object"&&!x(Bt)){for(var hr=Object.keys(Bt),rn=0;rn<hr.length;++rn)if(ue.isDynamic(Bt[hr[rn]]))return!0;return!1}}function Va(Bt,hr,rn){function vn(gn,On){xn.forEach(function(ta){var _n=en[ta];ue.isDynamic(_n)&&(_n=gn.invoke(On,_n),On(zr,".",ta,"=",_n,";"))})}var en=hr.static[rn];if(en&&ci(en)){var Tn=Bt.global,xn=Object.keys(en),un=!1,gr=!1,yr=!1,zr=Bt.global.def("{}");xn.forEach(function(gn){var On=en[gn];if(ue.isDynamic(On))typeof On=="function"&&(On=en[gn]=ue.unbox(On)),gn=ne(On,null),un=un||gn.thisDep,yr=yr||gn.propDep,gr=gr||gn.contextDep;else{switch(Tn(zr,".",gn,"="),typeof On){case"number":Tn(On);break;case"string":Tn('"',On,'"');break;case"object":Array.isArray(On)&&Tn("[",On.join(),"]");break;default:Tn(Bt.link(On))}Tn(";")}}),hr.dynamic[rn]=new ue.DynamicVariable(4,{thisDep:un,contextDep:gr,propDep:yr,ref:zr,append:vn}),delete hr.static[rn]}}var ja=wt.Record,Wa={add:32774,subtract:32778,"reverse subtract":32779};Zt.ext_blend_minmax&&(Wa.min=32775,Wa.max=32776);var wr=Zt.angle_instanced_arrays,pn=Zt.webgl_draw_buffers,fn=Zt.oes_vertex_array_object,An={dirty:!0,profile:ct.profile},Zn={},ua=[],ea={},Rn={};dt("dither",3024),dt("blend.enable",3042),Tt("blend.color","blendColor",[0,0,0,0]),Tt("blend.equation","blendEquationSeparate",[32774,32774]),Tt("blend.func","blendFuncSeparate",[1,0,1,0]),dt("depth.enable",2929,!0),Tt("depth.func","depthFunc",513),Tt("depth.range","depthRange",[0,1]),Tt("depth.mask","depthMask",!0),Tt("colorMask","colorMask",[!0,!0,!0,!0]),dt("cull.enable",2884),Tt("cull.face","cullFace",1029),Tt("frontFace","frontFace",2305),Tt("lineWidth","lineWidth",1),dt("polygonOffset.enable",32823),Tt("polygonOffset.offset","polygonOffset",[0,0]),dt("sample.alpha",32926),dt("sample.enable",32928),Tt("sample.coverage","sampleCoverage",[1,!1]),dt("stencil.enable",2960),Tt("stencil.mask","stencilMask",-1),Tt("stencil.func","stencilFunc",[519,0,-1]),Tt("stencil.opFront","stencilOpSeparate",[1028,7680,7680,7680]),Tt("stencil.opBack","stencilOpSeparate",[1029,7680,7680,7680]),dt("scissor.enable",3089),Tt("scissor.box","scissor",[0,0,at.drawingBufferWidth,at.drawingBufferHeight]),Tt("viewport","viewport",[0,0,at.drawingBufferWidth,at.drawingBufferHeight]);var Xn={gl:at,context:Se,strings:Jt,next:Zn,current:An,draw:ke,elements:rt,buffer:_r,shader:Pt,attributes:wt.state,vao:wt,uniforms:lt,framebuffer:st,extensions:Zt,timer:nt,isBufferArgs:U},Ua={primTypes:He,compareFuncs:Yt,blendFuncs:qt,blendEquations:Wa,stencilOps:fr,glTypes:Pe,orientationType:Yr};pn&&(Ua.backBuffer=[1029],Ua.drawBuffer=i(Ut.maxDrawbuffers,function(Bt){return Bt===0?[0]:i(Bt,function(hr){return 36064+hr})}));var li=0;return{next:Zn,current:An,procs:function(){var Bt=Ht(),hr=Bt.proc("poll"),rn=Bt.proc("refresh"),vn=Bt.block();hr(vn),rn(vn);var gr=Bt.shared,en=gr.gl,Tn=gr.next,xn=gr.current;vn(xn,".dirty=false;"),Vt(Bt,hr),Vt(Bt,rn,null,!0);var un;wr&&(un=Bt.link(wr)),Zt.oes_vertex_array_object&&rn(Bt.link(Zt.oes_vertex_array_object),".bindVertexArrayOES(null);");var gr=rn.def(gr.attributes),yr=rn.def(0),zr=Bt.cond(yr,".buffer");zr.then(en,".enableVertexAttribArray(i);",en,".bindBuffer(",34962,",",yr,".buffer.buffer);",en,".vertexAttribPointer(i,",yr,".size,",yr,".type,",yr,".normalized,",yr,".stride,",yr,".offset);").else(en,".disableVertexAttribArray(i);",en,".vertexAttrib4f(i,",yr,".x,",yr,".y,",yr,".z,",yr,".w);",yr,".buffer=null;");var gn=Bt.link(Ut.maxAttributes,{stable:!0});return rn("for(var i=0;i<",gn,";++i){",yr,"=",gr,"[i];",zr,"}"),wr&&rn("for(var i=0;i<",gn,";++i){",un,".vertexAttribDivisorANGLE(i,",gr,"[i].divisor);","}"),rn(Bt.shared.vao,".currentVAO=null;",Bt.shared.vao,".setVAO(",Bt.shared.vao,".targetVAO);"),Object.keys(ea).forEach(function(On){var ta=ea[On],_n=vn.def(Tn,".",On),jn=Bt.block();jn("if(",_n,"){",en,".enable(",ta,")}else{",en,".disable(",ta,")}",xn,".",On,"=",_n,";"),rn(jn),hr("if(",_n,"!==",xn,".",On,"){",jn,"}")}),Object.keys(Rn).forEach(function(On){var ta=Rn[On],_n=An[On],jn,aa,pa=Bt.block();pa(en,".",ta,"("),x(_n)?(ta=_n.length,jn=Bt.global.def(Tn,".",On),aa=Bt.global.def(xn,".",On),pa(i(ta,function(ma){return jn+"["+ma+"]"}),");",i(ta,function(ma){return aa+"["+ma+"]="+jn+"["+ma+"];"}).join("")),hr("if(",i(ta,function(ma){return jn+"["+ma+"]!=="+aa+"["+ma+"]"}).join("||"),"){",pa,"}")):(jn=vn.def(Tn,".",On),aa=vn.def(xn,".",On),pa(jn,");",xn,".",On,"=",jn,";"),hr("if(",jn,"!==",aa,"){",pa,"}")),rn(pa)}),Bt.compile()}(),compile:function(Bt,hr,rn,vn,en){var Tn=Ht();Tn.stats=Tn.link(en),Object.keys(hr.static).forEach(function(un){Va(Tn,hr,un)}),Wt.forEach(function(un){Va(Tn,Bt,un)});var xn=tt(Bt,hr,rn,vn,Tn);return xn.shader.program&&(xn.shader.program.attributes.sort(function(un,gr){return un.name<gr.name?-1:1}),xn.shader.program.uniforms.sort(function(un,gr){return un.name<gr.name?-1:1})),Cn(Tn,xn),La(Tn,xn),ga(Tn,xn),le(Tn.compile(),{destroy:function(){xn.shader.program.destroy()}})}}}function ie(at,Jt){for(var Zt=0;Zt<at.length;++Zt)if(at[Zt]===Jt)return Zt;return-1}var le=function(at,Jt){for(var Zt=Object.keys(Jt),Ut=0;Ut<Zt.length;++Ut)at[Zt[Ut]]=Jt[Zt[Ut]];return at},ye=0,ue={DynamicVariable:w,define:function(at,Jt){return new w(at,S(Jt+""))},isDynamic:function(at){return typeof at=="function"&&!at._reglType||at instanceof w},unbox:M,accessor:S},pe={next:typeof requestAnimationFrame=="function"?function(at){return requestAnimationFrame(at)}:function(at){return setTimeout(at,16)},cancel:typeof cancelAnimationFrame=="function"?function(at){return cancelAnimationFrame(at)}:clearTimeout},ge=typeof performance<"u"&&performance.now?function(){return performance.now()}:function(){return+new Date},Te=p();Te.zero=p();var _e=function(at,Jt){var Zt=1;Jt.ext_texture_filter_anisotropic&&(Zt=at.getParameter(34047));var Ut=1,_r=1;Jt.webgl_draw_buffers&&(Ut=at.getParameter(34852),_r=at.getParameter(36063));var rt=!!Jt.oes_texture_float;if(rt){rt=at.createTexture(),at.bindTexture(3553,rt),at.texImage2D(3553,0,6408,1,1,0,6408,5126,null);var Ke=at.createFramebuffer();if(at.bindFramebuffer(36160,Ke),at.framebufferTexture2D(36160,36064,3553,rt,0),at.bindTexture(3553,null),at.checkFramebufferStatus(36160)!==36053)rt=!1;else{at.viewport(0,0,1,1),at.clearColor(1,0,0,1),at.clear(16384);var st=Te.allocType(5126,4);at.readPixels(0,0,1,1,6408,5126,st),at.getError()?rt=!1:(at.deleteFramebuffer(Ke),at.deleteTexture(rt),rt=st[0]===1),Te.freeType(st)}}return st=!0,typeof navigator<"u"&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent))||(st=at.createTexture(),Ke=Te.allocType(5121,36),at.activeTexture(33984),at.bindTexture(34067,st),at.texImage2D(34069,0,6408,3,3,0,6408,5121,Ke),Te.freeType(Ke),at.bindTexture(34067,null),at.deleteTexture(st),st=!at.getError()),{colorBits:[at.getParameter(3410),at.getParameter(3411),at.getParameter(3412),at.getParameter(3413)],depthBits:at.getParameter(3414),stencilBits:at.getParameter(3415),subpixelBits:at.getParameter(3408),extensions:Object.keys(Jt).filter(function(lt){return!!Jt[lt]}),maxAnisotropic:Zt,maxDrawbuffers:Ut,maxColorAttachments:_r,pointSizeDims:at.getParameter(33901),lineWidthDims:at.getParameter(33902),maxViewportDims:at.getParameter(3386),maxCombinedTextureUnits:at.getParameter(35661),maxCubeMapSize:at.getParameter(34076),maxRenderbufferSize:at.getParameter(34024),maxTextureUnits:at.getParameter(34930),maxTextureSize:at.getParameter(3379),maxAttributes:at.getParameter(34921),maxVertexUniforms:at.getParameter(36347),maxVertexTextureUnits:at.getParameter(35660),maxVaryingVectors:at.getParameter(36348),maxFragmentUniforms:at.getParameter(36349),glsl:at.getParameter(35724),renderer:at.getParameter(7937),vendor:at.getParameter(7936),version:at.getParameter(7938),readFloat:rt,npotTextureCube:st}},ze=function(at){return at instanceof Uint8Array||at instanceof Uint16Array||at instanceof Uint32Array||at instanceof Int8Array||at instanceof Int16Array||at instanceof Int32Array||at instanceof Float32Array||at instanceof Float64Array||at instanceof Uint8ClampedArray},Oe=function(at){return Object.keys(at).map(function(Jt){return at[Jt]})},Ye={shape:function(at){for(var Jt=[];at.length;at=at[0])Jt.push(at.length);return Jt},flatten:function(at,Jt,Zt,Ut){var _r=1;if(Jt.length)for(var rt=0;rt<Jt.length;++rt)_r*=Jt[rt];else _r=0;switch(Zt=Ut||Te.allocType(Zt,_r),Jt.length){case 0:break;case 1:for(Ut=Jt[0],Jt=0;Jt<Ut;++Jt)Zt[Jt]=at[Jt];break;case 2:for(Ut=Jt[0],Jt=Jt[1],rt=_r=0;rt<Ut;++rt)for(var Ke=at[rt],st=0;st<Jt;++st)Zt[_r++]=Ke[st];break;case 3:h(at,Jt[0],Jt[1],Jt[2],Zt,0);break;default:m(at,Jt,0,Zt,0)}return Zt}},be={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},Pe={int8:5120,int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,float:5126,float32:5126},Ge={dynamic:35048,stream:35040,static:35044},Qe=Ye.flatten,Be=Ye.shape,Le=[];Le[5120]=1,Le[5122]=2,Le[5124]=4,Le[5121]=1,Le[5123]=2,Le[5125]=4,Le[5126]=4;var He={points:0,point:0,lines:1,line:1,triangles:4,triangle:4,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},vt=new Float32Array(1),Rt=new Uint32Array(vt.buffer),rr=[9984,9986,9985,9987],Lt=[0,6409,6410,6407,6408],Ft={};Ft[6409]=Ft[6406]=Ft[6402]=1,Ft[34041]=Ft[6410]=2,Ft[6407]=Ft[35904]=3,Ft[6408]=Ft[35906]=4;var Gt=l("HTMLCanvasElement"),Dt=l("OffscreenCanvas"),kt=l("CanvasRenderingContext2D"),Ue=l("ImageBitmap"),qe=l("HTMLImageElement"),Ve=l("HTMLVideoElement"),Ae=Object.keys(be).concat([Gt,Dt,kt,Ue,qe,Ve]),Ne=[];Ne[5121]=1,Ne[5126]=4,Ne[36193]=2,Ne[5123]=2,Ne[5125]=4;var Xe=[];Xe[32854]=2,Xe[32855]=2,Xe[36194]=2,Xe[34041]=4,Xe[33776]=.5,Xe[33777]=.5,Xe[33778]=1,Xe[33779]=1,Xe[35986]=.5,Xe[35987]=1,Xe[34798]=1,Xe[35840]=.5,Xe[35841]=.25,Xe[35842]=.5,Xe[35843]=.25,Xe[36196]=.5;var Je=[];Je[32854]=2,Je[32855]=2,Je[36194]=2,Je[33189]=2,Je[36168]=1,Je[34041]=4,Je[35907]=4,Je[34836]=16,Je[34842]=8,Je[34843]=6;var _t=function(at,Jt,Zt,Ut,_r){function rt(ke){this.id=wt++,this.refCount=1,this.renderbuffer=ke,this.format=32854,this.height=this.width=0,_r.profile&&(this.stats={size:0})}function Ke(ke){var Se=ke.renderbuffer;at.bindRenderbuffer(36161,null),at.deleteRenderbuffer(Se),ke.renderbuffer=null,ke.refCount=0,delete Pt[ke.id],Ut.renderbufferCount--}var st={rgba4:32854,rgb565:36194,"rgb5 a1":32855,depth:33189,stencil:36168,"depth stencil":34041};Jt.ext_srgb&&(st.srgba=35907),Jt.ext_color_buffer_half_float&&(st.rgba16f=34842,st.rgb16f=34843),Jt.webgl_color_buffer_float&&(st.rgba32f=34836);var lt=[];Object.keys(st).forEach(function(ke){lt[st[ke]]=ke});var wt=0,Pt={};return rt.prototype.decRef=function(){0>=--this.refCount&&Ke(this)},_r.profile&&(Ut.getTotalRenderbufferSize=function(){var ke=0;return Object.keys(Pt).forEach(function(Se){ke+=Pt[Se].stats.size}),ke}),{create:function(ke,Se){function nt(ct,At){var dt=0,Tt=0,Ht=32854;if(typeof ct=="object"&&ct?("shape"in ct?(Tt=ct.shape,dt=Tt[0]|0,Tt=Tt[1]|0):("radius"in ct&&(dt=Tt=ct.radius|0),"width"in ct&&(dt=ct.width|0),"height"in ct&&(Tt=ct.height|0)),"format"in ct&&(Ht=st[ct.format])):typeof ct=="number"?(dt=ct|0,Tt=typeof At=="number"?At|0:dt):ct||(dt=Tt=1),dt!==it.width||Tt!==it.height||Ht!==it.format)return nt.width=it.width=dt,nt.height=it.height=Tt,it.format=Ht,at.bindRenderbuffer(36161,it.renderbuffer),at.renderbufferStorage(36161,Ht,dt,Tt),_r.profile&&(it.stats.size=Je[it.format]*it.width*it.height),nt.format=lt[it.format],nt}var it=new rt(at.createRenderbuffer());return Pt[it.id]=it,Ut.renderbufferCount++,nt(ke,Se),nt.resize=function(ct,At){var dt=ct|0,Tt=At|0||dt;return dt===it.width&&Tt===it.height||(nt.width=it.width=dt,nt.height=it.height=Tt,at.bindRenderbuffer(36161,it.renderbuffer),at.renderbufferStorage(36161,it.format,dt,Tt),_r.profile&&(it.stats.size=Je[it.format]*it.width*it.height)),nt},nt._reglType="renderbuffer",nt._renderbuffer=it,_r.profile&&(nt.stats=it.stats),nt.destroy=function(){it.decRef()},nt},clear:function(){Oe(Pt).forEach(Ke)},restore:function(){Oe(Pt).forEach(function(ke){ke.renderbuffer=at.createRenderbuffer(),at.bindRenderbuffer(36161,ke.renderbuffer),at.renderbufferStorage(36161,ke.format,ke.width,ke.height)}),at.bindRenderbuffer(36161,null)}}},mt=[];mt[6408]=4,mt[6407]=3;var Ot=[];Ot[5121]=1,Ot[5126]=4,Ot[36193]=2;var Kt=[1116352408,1899447441,-1245643825,-373957723,961987163,1508970993,-1841331548,-1424204075,-670586216,310598401,607225278,1426881987,1925078388,-2132889090,-1680079193,-1046744716,-459576895,-272742522,264347078,604807628,770255983,1249150122,1555081692,1996064986,-1740746414,-1473132947,-1341970488,-1084653625,-958395405,-710438585,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,-2117940946,-1838011259,-1564481375,-1474664885,-1035236496,-949202525,-778901479,-694614492,-200395387,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,-2067236844,-1933114872,-1866530822,-1538233109,-1090935817,-965641998],Nt=["x","y","z","w"],Wt="blend.func blend.equation stencil.func stencil.opFront stencil.opBack sample.coverage viewport scissor.box polygonOffset.offset".split(" "),qt={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},Yt={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},fr={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},Yr={cw:2304,ccw:2305},hn=new $(!1,!1,!1,function(){}),Qr=function(at,Jt){function Zt(){this.endQueryIndex=this.startQueryIndex=-1,this.sum=0,this.stats=null}function Ut(Pt,ke,Se){var nt=Ke.pop()||new Zt;nt.startQueryIndex=Pt,nt.endQueryIndex=ke,nt.sum=0,nt.stats=Se,st.push(nt)}if(!Jt.ext_disjoint_timer_query)return null;var _r=[],rt=[],Ke=[],st=[],lt=[],wt=[];return{beginQuery:function(Pt){var ke=_r.pop()||Jt.ext_disjoint_timer_query.createQueryEXT();Jt.ext_disjoint_timer_query.beginQueryEXT(35007,ke),rt.push(ke),Ut(rt.length-1,rt.length,Pt)},endQuery:function(){Jt.ext_disjoint_timer_query.endQueryEXT(35007)},pushScopeStats:Ut,update:function(){var Pt,ke;if(Pt=rt.length,Pt!==0){wt.length=Math.max(wt.length,Pt+1),lt.length=Math.max(lt.length,Pt+1),lt[0]=0;var Se=wt[0]=0;for(ke=Pt=0;ke<rt.length;++ke){var nt=rt[ke];Jt.ext_disjoint_timer_query.getQueryObjectEXT(nt,34919)?(Se+=Jt.ext_disjoint_timer_query.getQueryObjectEXT(nt,34918),_r.push(nt)):rt[Pt++]=nt,lt[ke+1]=Se,wt[ke+1]=Pt}for(rt.length=Pt,ke=Pt=0;ke<st.length;++ke){var Se=st[ke],it=Se.startQueryIndex,nt=Se.endQueryIndex;Se.sum+=lt[nt]-lt[it],it=wt[it],nt=wt[nt],nt===it?(Se.stats.gpuTime+=Se.sum/1e6,Ke.push(Se)):(Se.startQueryIndex=it,Se.endQueryIndex=nt,st[Pt++]=Se)}st.length=Pt}},getNumPendingQueries:function(){return rt.length},clear:function(){_r.push.apply(_r,rt);for(var Pt=0;Pt<_r.length;Pt++)Jt.ext_disjoint_timer_query.deleteQueryEXT(_r[Pt]);rt.length=0,_r.length=0},restore:function(){rt.length=0,_r.length=0}}};return function(at){function Jt(){if(Ir.length===0)Ht&&Ht.update(),ln=null;else{ln=pe.next(Jt),Pt();for(var Cn=Ir.length-1;0<=Cn;--Cn){var Wn=Ir[Cn];Wn&&Wn(br,null,0)}nt.flush(),Ht&&Ht.update()}}function Zt(){!ln&&0<Ir.length&&(ln=pe.next(Jt))}function Ut(){ln&&(pe.cancel(Jt),ln=null)}function _r(Cn){Cn.preventDefault(),Ut(),Tr.forEach(function(Wn){Wn()})}function rt(Cn){nt.getError(),ct.restore(),Nr.restore(),nr.restore(),Sr.restore(),tt.restore(),Et.restore(),Pr.restore(),Ht&&Ht.restore(),Vt.procs.refresh(),Zt(),Wr.forEach(function(Wn){Wn()})}function Ke(Cn){function Wn(An,Zn){var ua={},ea={};return Object.keys(An).forEach(function(Rn){var Xn=An[Rn];if(ue.isDynamic(Xn))ea[Rn]=ue.unbox(Xn,Rn);else{if(Zn&&Array.isArray(Xn)){for(var Ua=0;Ua<Xn.length;++Ua)if(ue.isDynamic(Xn[Ua])){ea[Rn]=ue.unbox(Xn,Rn);return}}ua[Rn]=Xn}}),{dynamic:ea,static:ua}}function Hn(An){for(;fn.length<An;)fn.push(null);return fn}var ga=Wn(Cn.context||{},!0),La=Wn(Cn.uniforms||{},!0),ci=Wn(Cn.attributes||{},!1);Cn=Wn(function(An){function Zn(ea){if(ea in ua){var Rn=ua[ea];delete ua[ea],Object.keys(Rn).forEach(function(Xn){ua[ea+"."+Xn]=Rn[Xn]})}}var ua=le({},An);return delete ua.uniforms,delete ua.attributes,delete ua.context,delete ua.vao,"stencil"in ua&&ua.stencil.op&&(ua.stencil.opBack=ua.stencil.opFront=ua.stencil.op,delete ua.stencil.op),Zn("blend"),Zn("depth"),Zn("cull"),Zn("stencil"),Zn("polygonOffset"),Zn("scissor"),Zn("sample"),"vao"in An&&(ua.vao=An.vao),ua}(Cn),!1);var Va={gpuTime:0,cpuTime:0,count:0},ja=Vt.compile(Cn,ci,La,ga,Va),Wa=ja.draw,wr=ja.batch,pn=ja.scope,fn=[];return le(function(An,Zn){var ua;if(typeof An=="function")return pn.call(this,null,An,0);if(typeof Zn=="function")if(typeof An=="number")for(ua=0;ua<An;++ua)pn.call(this,null,Zn,ua);else if(Array.isArray(An))for(ua=0;ua<An.length;++ua)pn.call(this,An[ua],Zn,ua);else return pn.call(this,An,Zn,0);else if(typeof An=="number"){if(0<An)return wr.call(this,Hn(An|0),An|0)}else if(Array.isArray(An)){if(An.length)return wr.call(this,An,An.length)}else return Wa.call(this,An)},{stats:Va,destroy:function(){ja.destroy()}})}function st(Cn,Wn){var Hn=0;Vt.procs.poll();var ga=Wn.color;ga&&(nt.clearColor(+ga[0]||0,+ga[1]||0,+ga[2]||0,+ga[3]||0),Hn|=16384),"depth"in Wn&&(nt.clearDepth(+Wn.depth),Hn|=256),"stencil"in Wn&&(nt.clearStencil(Wn.stencil|0),Hn|=1024),nt.clear(Hn)}function lt(Cn){return Ir.push(Cn),Zt(),{cancel:function(){function Wn(){var ga=ie(Ir,Wn);Ir[ga]=Ir[Ir.length-1],--Ir.length,0>=Ir.length&&Ut()}var Hn=ie(Ir,Cn);Ir[Hn]=Wn}}}function wt(){var Cn=Cr.viewport,Wn=Cr.scissor_box;Cn[0]=Cn[1]=Wn[0]=Wn[1]=0,br.viewportWidth=br.framebufferWidth=br.drawingBufferWidth=Cn[2]=Wn[2]=nt.drawingBufferWidth,br.viewportHeight=br.framebufferHeight=br.drawingBufferHeight=Cn[3]=Wn[3]=nt.drawingBufferHeight}function Pt(){br.tick+=1,br.time=Se(),wt(),Vt.procs.poll()}function ke(){Sr.refresh(),wt(),Vt.procs.refresh(),Ht&&Ht.update()}function Se(){return(ge()-ir)/1e3}if(at=c(at),!at)return null;var nt=at.gl,it=nt.getContextAttributes();nt.isContextLost();var ct=o(nt,at);if(!ct)return null;var ar=e(),At={vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0},dt=at.cachedCode||{},Tt=ct.extensions,Ht=Qr(nt,Tt),ir=ge(),Mr=nt.drawingBufferWidth,kr=nt.drawingBufferHeight,br={tick:0,time:0,viewportWidth:Mr,viewportHeight:kr,framebufferWidth:Mr,framebufferHeight:kr,drawingBufferWidth:Mr,drawingBufferHeight:kr,pixelRatio:at.pixelRatio},Mr={elements:null,primitive:4,count:-1,offset:0,instances:-1},Hr=_e(nt,Tt),nr=A(nt,At,at,function(Cn){return Pr.destroyBuffer(Cn)}),mr=b(nt,Tt,nr,At),Pr=F(nt,Tt,Hr,At,nr,mr,Mr),Nr=H(nt,ar,At,at),Sr=D(nt,Tt,Hr,function(){Vt.procs.poll()},br,At,at),tt=_t(nt,Tt,Hr,At,at),Et=R(nt,Tt,Hr,Sr,tt,At),Vt=ae(nt,ar,Tt,Hr,nr,mr,Sr,Et,{},Pr,Nr,Mr,br,Ht,dt,at),ar=G(nt,Et,Vt.procs.poll,br),Cr=Vt.next,Or=nt.canvas,Ir=[],Tr=[],Wr=[],wn=[at.onDestroy],ln=null;Or&&(Or.addEventListener("webglcontextlost",_r,!1),Or.addEventListener("webglcontextrestored",rt,!1));var Bn=Et.setFBO=Ke({framebuffer:ue.define.call(null,1,"framebuffer")});return ke(),it=le(Ke,{clear:function(Cn){if("framebuffer"in Cn)if(Cn.framebuffer&&Cn.framebuffer_reglType==="framebufferCube")for(var Wn=0;6>Wn;++Wn)Bn(le({framebuffer:Cn.framebuffer.faces[Wn]},Cn),st);else Bn(Cn,st);else st(null,Cn)},prop:ue.define.bind(null,1),context:ue.define.bind(null,2),this:ue.define.bind(null,3),draw:Ke({}),buffer:function(Cn){return nr.create(Cn,34962,!1,!1)},elements:function(Cn){return mr.create(Cn,!1)},texture:Sr.create2D,cube:Sr.createCube,renderbuffer:tt.create,framebuffer:Et.create,framebufferCube:Et.createCube,vao:Pr.createVAO,attributes:it,frame:lt,on:function(Cn,Wn){var Hn;switch(Cn){case"frame":return lt(Wn);case"lost":Hn=Tr;break;case"restore":Hn=Wr;break;case"destroy":Hn=wn}return Hn.push(Wn),{cancel:function(){for(var ga=0;ga<Hn.length;++ga)if(Hn[ga]===Wn){Hn[ga]=Hn[Hn.length-1],Hn.pop();break}}}},limits:Hr,hasExtension:function(Cn){return 0<=Hr.extensions.indexOf(Cn.toLowerCase())},read:ar,destroy:function(){Ir.length=0,Ut(),Or&&(Or.removeEventListener("webglcontextlost",_r),Or.removeEventListener("webglcontextrestored",rt)),Nr.clear(),Et.clear(),tt.clear(),Pr.clear(),Sr.clear(),mr.clear(),nr.clear(),Ht&&Ht.clear(),wn.forEach(function(Cn){Cn()})},_gl:nt,_refresh:ke,poll:function(){Pt(),Ht&&Ht.update()},now:Se,stats:At,getCachedCode:function(){return dt},preloadCachedCode:function(Cn){Object.entries(Cn).forEach(function(Wn){dt[Wn[0]]=Wn[1]})}}),at.onDone(null,it),it}})},{}],285:[function(d,ee,te){var w=d("buffer"),v=w.Buffer;function S(e,a){for(var n in e)a[n]=e[n]}v.from&&v.alloc&&v.allocUnsafe&&v.allocUnsafeSlow?ee.exports=w:(S(w,te),te.Buffer=M);function M(e,a,n){return v(e,a,n)}M.prototype=Object.create(v.prototype),S(v,M),M.from=function(e,a,n){if(typeof e=="number")throw new TypeError("Argument must not be a number");return v(e,a,n)},M.alloc=function(e,a,n){if(typeof e!="number")throw new TypeError("Argument must be a number");var r=v(e);return a!==void 0?typeof n=="string"?r.fill(a,n):r.fill(a):r.fill(0),r},M.allocUnsafe=function(e){if(typeof e!="number")throw new TypeError("Argument must be a number");return v(e)},M.allocUnsafeSlow=function(e){if(typeof e!="number")throw new TypeError("Argument must be a number");return w.SlowBuffer(e)}},{buffer:85}],286:[function(d,ee,te){ee.exports=S;var w=d("events").EventEmitter,v=d("inherits");v(S,w),S.Readable=d("readable-stream/lib/_stream_readable.js"),S.Writable=d("readable-stream/lib/_stream_writable.js"),S.Duplex=d("readable-stream/lib/_stream_duplex.js"),S.Transform=d("readable-stream/lib/_stream_transform.js"),S.PassThrough=d("readable-stream/lib/_stream_passthrough.js"),S.finished=d("readable-stream/lib/internal/streams/end-of-stream.js"),S.pipeline=d("readable-stream/lib/internal/streams/pipeline.js"),S.Stream=S;function S(){w.call(this)}S.prototype.pipe=function(M,e){var a=this;function n(p){M.writable&&M.write(p)===!1&&a.pause&&a.pause()}a.on("data",n);function r(){a.readable&&a.resume&&a.resume()}M.on("drain",r),!M._isStdio&&(!e||e.end!==!1)&&(a.on("end",c),a.on("close",o));var t=!1;function c(){t||(t=!0,M.end())}function o(){t||(t=!0,typeof M.destroy=="function"&&M.destroy())}function i(p){if(y(),w.listenerCount(this,"error")===0)throw p}a.on("error",i),M.on("error",i);function y(){a.removeListener("data",n),M.removeListener("drain",r),a.removeListener("end",c),a.removeListener("close",o),a.removeListener("error",i),M.removeListener("error",i),a.removeListener("end",y),a.removeListener("close",y),M.removeListener("close",y)}return a.on("end",y),a.on("close",y),M.on("close",y),M.emit("pipe",a),M}},{events:84,inherits:231,"readable-stream/lib/_stream_duplex.js":288,"readable-stream/lib/_stream_passthrough.js":289,"readable-stream/lib/_stream_readable.js":290,"readable-stream/lib/_stream_transform.js":291,"readable-stream/lib/_stream_writable.js":292,"readable-stream/lib/internal/streams/end-of-stream.js":296,"readable-stream/lib/internal/streams/pipeline.js":298}],287:[function(d,ee,te){function w(r,t){r.prototype=Object.create(t.prototype),r.prototype.constructor=r,r.__proto__=t}var v={};function S(r,t,c){c||(c=Error);function o(y,p,g){return typeof t=="string"?t:t(y,p,g)}var i=function(y){w(p,y);function p(g,h,m){return y.call(this,o(g,h,m))||this}return p}(c);i.prototype.name=c.name,i.prototype.code=r,v[r]=i}function M(r,t){if(Array.isArray(r)){var c=r.length;return r=r.map(function(o){return String(o)}),c>2?"one of ".concat(t," ").concat(r.slice(0,c-1).join(", "),", or ")+r[c-1]:c===2?"one of ".concat(t," ").concat(r[0]," or ").concat(r[1]):"of ".concat(t," ").concat(r[0])}else return"of ".concat(t," ").concat(String(r))}function e(r,t,c){return r.substr(!c||c<0?0:+c,t.length)===t}function a(r,t,c){return(c===void 0||c>r.length)&&(c=r.length),r.substring(c-t.length,c)===t}function n(r,t,c){return typeof c!="number"&&(c=0),c+t.length>r.length?!1:r.indexOf(t,c)!==-1}S("ERR_INVALID_OPT_VALUE",function(r,t){return'The value "'+t+'" is invalid for option "'+r+'"'},TypeError),S("ERR_INVALID_ARG_TYPE",function(r,t,c){var o;typeof t=="string"&&e(t,"not ")?(o="must not be",t=t.replace(/^not /,"")):o="must be";var i;if(a(r," argument"))i="The ".concat(r," ").concat(o," ").concat(M(t,"type"));else{var y=n(r,".")?"property":"argument";i='The "'.concat(r,'" ').concat(y," ").concat(o," ").concat(M(t,"type"))}return i+=". Received type ".concat(typeof c),i},TypeError),S("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),S("ERR_METHOD_NOT_IMPLEMENTED",function(r){return"The "+r+" method is not implemented"}),S("ERR_STREAM_PREMATURE_CLOSE","Premature close"),S("ERR_STREAM_DESTROYED",function(r){return"Cannot call "+r+" after a stream was destroyed"}),S("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),S("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),S("ERR_STREAM_WRITE_AFTER_END","write after end"),S("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),S("ERR_UNKNOWN_ENCODING",function(r){return"Unknown encoding: "+r},TypeError),S("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),ee.exports.codes=v},{}],288:[function(d,ee,te){(function(w){(function(){var v=Object.keys||function(o){var i=[];for(var y in o)i.push(y);return i};ee.exports=r;var S=d("./_stream_readable"),M=d("./_stream_writable");d("inherits")(r,S);for(var e=v(M.prototype),a=0;a<e.length;a++){var n=e[a];r.prototype[n]||(r.prototype[n]=M.prototype[n])}function r(o){if(!(this instanceof r))return new r(o);S.call(this,o),M.call(this,o),this.allowHalfOpen=!0,o&&(o.readable===!1&&(this.readable=!1),o.writable===!1&&(this.writable=!1),o.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",t)))}Object.defineProperty(r.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(r.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(r.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function t(){this._writableState.ended||w.nextTick(c,this)}function c(o){o.end()}Object.defineProperty(r.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(i){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=i,this._writableState.destroyed=i)}})}).call(this)}).call(this,d("_process"))},{"./_stream_readable":290,"./_stream_writable":292,_process:278,inherits:231}],289:[function(d,ee,te){ee.exports=v;var w=d("./_stream_transform");d("inherits")(v,w);function v(S){if(!(this instanceof v))return new v(S);w.call(this,S)}v.prototype._transform=function(S,M,e){e(null,S)}},{"./_stream_transform":291,inherits:231}],290:[function(d,ee,te){(function(w,v){(function(){ee.exports=k;var S;k.ReadableState=T,d("events").EventEmitter;var M=function(ne,ae){return ne.listeners(ae).length},e=d("./internal/streams/stream"),a=d("buffer").Buffer,n=v.Uint8Array||function(){};function r(K){return a.from(K)}function t(K){return a.isBuffer(K)||K instanceof n}var c=d("util"),o;c&&c.debuglog?o=c.debuglog("stream"):o=function(){};var i=d("./internal/streams/buffer_list"),y=d("./internal/streams/destroy"),p=d("./internal/streams/state"),g=p.getHighWaterMark,h=d("../errors").codes,m=h.ERR_INVALID_ARG_TYPE,u=h.ERR_STREAM_PUSH_AFTER_EOF,_=h.ERR_METHOD_NOT_IMPLEMENTED,s=h.ERR_STREAM_UNSHIFT_AFTER_END_EVENT,A,b,f;d("inherits")(k,e);var x=y.errorOrDestroy,l=["error","close","destroy","pause","resume"];function L(K,ne,ae){if(typeof K.prependListener=="function")return K.prependListener(ne,ae);!K._events||!K._events[ne]?K.on(ne,ae):Array.isArray(K._events[ne])?K._events[ne].unshift(ae):K._events[ne]=[ae,K._events[ne]]}function T(K,ne,ae){S=S||d("./_stream_duplex"),K=K||{},typeof ae!="boolean"&&(ae=ne instanceof S),this.objectMode=!!K.objectMode,ae&&(this.objectMode=this.objectMode||!!K.readableObjectMode),this.highWaterMark=g(this,K,"readableHighWaterMark",ae),this.buffer=new i,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=K.emitClose!==!1,this.autoDestroy=!!K.autoDestroy,this.destroyed=!1,this.defaultEncoding=K.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,K.encoding&&(A||(A=d("string_decoder/").StringDecoder),this.decoder=new A(K.encoding),this.encoding=K.encoding)}function k(K){if(S=S||d("./_stream_duplex"),!(this instanceof k))return new k(K);var ne=this instanceof S;this._readableState=new T(K,this,ne),this.readable=!0,K&&(typeof K.read=="function"&&(this._read=K.read),typeof K.destroy=="function"&&(this._destroy=K.destroy)),e.call(this)}Object.defineProperty(k.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(ne){!this._readableState||(this._readableState.destroyed=ne)}}),k.prototype.destroy=y.destroy,k.prototype._undestroy=y.undestroy,k.prototype._destroy=function(K,ne){ne(K)},k.prototype.push=function(K,ne){var ae=this._readableState,ie;return ae.objectMode?ie=!0:typeof K=="string"&&(ne=ne||ae.defaultEncoding,ne!==ae.encoding&&(K=a.from(K,ne),ne=""),ie=!0),P(this,K,ne,!1,ie)},k.prototype.unshift=function(K){return P(this,K,null,!0,!1)};function P(K,ne,ae,ie,le){o("readableAddChunk",ne);var ye=K._readableState;if(ne===null)ye.reading=!1,F(K,ye);else{var ue;if(le||(ue=I(ye,ne)),ue)x(K,ue);else if(ye.objectMode||ne&&ne.length>0)if(typeof ne!="string"&&!ye.objectMode&&Object.getPrototypeOf(ne)!==a.prototype&&(ne=r(ne)),ie)ye.endEmitted?x(K,new s):z(K,ye,ne,!0);else if(ye.ended)x(K,new u);else{if(ye.destroyed)return!1;ye.reading=!1,ye.decoder&&!ae?(ne=ye.decoder.write(ne),ye.objectMode||ne.length!==0?z(K,ye,ne,!1):J(K,ye)):z(K,ye,ne,!1)}else ie||(ye.reading=!1,J(K,ye))}return!ye.ended&&(ye.length<ye.highWaterMark||ye.length===0)}function z(K,ne,ae,ie){ne.flowing&&ne.length===0&&!ne.sync?(ne.awaitDrain=0,K.emit("data",ae)):(ne.length+=ne.objectMode?1:ae.length,ie?ne.buffer.unshift(ae):ne.buffer.push(ae),ne.needReadable&&H(K)),J(K,ne)}function I(K,ne){var ae;return!t(ne)&&typeof ne!="string"&&ne!==void 0&&!K.objectMode&&(ae=new m("chunk",["string","Buffer","Uint8Array"],ne)),ae}k.prototype.isPaused=function(){return this._readableState.flowing===!1},k.prototype.setEncoding=function(K){A||(A=d("string_decoder/").StringDecoder);var ne=new A(K);this._readableState.decoder=ne,this._readableState.encoding=this._readableState.decoder.encoding;for(var ae=this._readableState.buffer.head,ie="";ae!==null;)ie+=ne.write(ae.data),ae=ae.next;return this._readableState.buffer.clear(),ie!==""&&this._readableState.buffer.push(ie),this._readableState.length=ie.length,this};var D=1073741824;function R(K){return K>=D?K=D:(K--,K|=K>>>1,K|=K>>>2,K|=K>>>4,K|=K>>>8,K|=K>>>16,K++),K}function B(K,ne){return K<=0||ne.length===0&&ne.ended?0:ne.objectMode?1:K!==K?ne.flowing&&ne.length?ne.buffer.head.data.length:ne.length:(K>ne.highWaterMark&&(ne.highWaterMark=R(K)),K<=ne.length?K:ne.ended?ne.length:(ne.needReadable=!0,0))}k.prototype.read=function(K){o("read",K),K=parseInt(K,10);var ne=this._readableState,ae=K;if(K!==0&&(ne.emittedReadable=!1),K===0&&ne.needReadable&&((ne.highWaterMark!==0?ne.length>=ne.highWaterMark:ne.length>0)||ne.ended))return o("read: emitReadable",ne.length,ne.ended),ne.length===0&&ne.ended?q(this):H(this),null;if(K=B(K,ne),K===0&&ne.ended)return ne.length===0&&q(this),null;var ie=ne.needReadable;o("need readable",ie),(ne.length===0||ne.length-K<ne.highWaterMark)&&(ie=!0,o("length less than watermark",ie)),ne.ended||ne.reading?(ie=!1,o("reading or ended",ie)):ie&&(o("do read"),ne.reading=!0,ne.sync=!0,ne.length===0&&(ne.needReadable=!0),this._read(ne.highWaterMark),ne.sync=!1,ne.reading||(K=B(ae,ne)));var le;return K>0?le=U(K,ne):le=null,le===null?(ne.needReadable=ne.length<=ne.highWaterMark,K=0):(ne.length-=K,ne.awaitDrain=0),ne.length===0&&(ne.ended||(ne.needReadable=!0),ae!==K&&ne.ended&&q(this)),le!==null&&this.emit("data",le),le};function F(K,ne){if(o("onEofChunk"),!ne.ended){if(ne.decoder){var ae=ne.decoder.end();ae&&ae.length&&(ne.buffer.push(ae),ne.length+=ne.objectMode?1:ae.length)}ne.ended=!0,ne.sync?H(K):(ne.needReadable=!1,ne.emittedReadable||(ne.emittedReadable=!0,G(K)))}}function H(K){var ne=K._readableState;o("emitReadable",ne.needReadable,ne.emittedReadable),ne.needReadable=!1,ne.emittedReadable||(o("emitReadable",ne.flowing),ne.emittedReadable=!0,w.nextTick(G,K))}function G(K){var ne=K._readableState;o("emitReadable_",ne.destroyed,ne.length,ne.ended),!ne.destroyed&&(ne.length||ne.ended)&&(K.emit("readable"),ne.emittedReadable=!1),ne.needReadable=!ne.flowing&&!ne.ended&&ne.length<=ne.highWaterMark,N(K)}function J(K,ne){ne.readingMore||(ne.readingMore=!0,w.nextTick(X,K,ne))}function X(K,ne){for(;!ne.reading&&!ne.ended&&(ne.length<ne.highWaterMark||ne.flowing&&ne.length===0);){var ae=ne.length;if(o("maybeReadMore read 0"),K.read(0),ae===ne.length)break}ne.readingMore=!1}k.prototype._read=function(K){x(this,new _("_read()"))},k.prototype.pipe=function(K,ne){var ae=this,ie=this._readableState;switch(ie.pipesCount){case 0:ie.pipes=K;break;case 1:ie.pipes=[ie.pipes,K];break;default:ie.pipes.push(K);break}ie.pipesCount+=1,o("pipe count=%d opts=%j",ie.pipesCount,ne);var le=(!ne||ne.end!==!1)&&K!==w.stdout&&K!==w.stderr,ye=le?pe:Pe;ie.endEmitted?w.nextTick(ye):ae.once("end",ye),K.on("unpipe",ue);function ue(Ge,Qe){o("onunpipe"),Ge===ae&&Qe&&Qe.hasUnpiped===!1&&(Qe.hasUnpiped=!0,_e())}function pe(){o("onend"),K.end()}var ge=Y(ae);K.on("drain",ge);var Te=!1;function _e(){o("cleanup"),K.removeListener("close",Ye),K.removeListener("finish",be),K.removeListener("drain",ge),K.removeListener("error",Oe),K.removeListener("unpipe",ue),ae.removeListener("end",pe),ae.removeListener("end",Pe),ae.removeListener("data",ze),Te=!0,ie.awaitDrain&&(!K._writableState||K._writableState.needDrain)&&ge()}ae.on("data",ze);function ze(Ge){o("ondata");var Qe=K.write(Ge);o("dest.write",Qe),Qe===!1&&((ie.pipesCount===1&&ie.pipes===K||ie.pipesCount>1&&W(ie.pipes,K)!==-1)&&!Te&&(o("false write response, pause",ie.awaitDrain),ie.awaitDrain++),ae.pause())}function Oe(Ge){o("onerror",Ge),Pe(),K.removeListener("error",Oe),M(K,"error")===0&&x(K,Ge)}L(K,"error",Oe);function Ye(){K.removeListener("finish",be),Pe()}K.once("close",Ye);function be(){o("onfinish"),K.removeListener("close",Ye),Pe()}K.once("finish",be);function Pe(){o("unpipe"),ae.unpipe(K)}return K.emit("pipe",ae),ie.flowing||(o("pipe resume"),ae.resume()),K};function Y(K){return function(){var ae=K._readableState;o("pipeOnDrain",ae.awaitDrain),ae.awaitDrain&&ae.awaitDrain--,ae.awaitDrain===0&&M(K,"data")&&(ae.flowing=!0,N(K))}}k.prototype.unpipe=function(K){var ne=this._readableState,ae={hasUnpiped:!1};if(ne.pipesCount===0)return this;if(ne.pipesCount===1)return K&&K!==ne.pipes?this:(K||(K=ne.pipes),ne.pipes=null,ne.pipesCount=0,ne.flowing=!1,K&&K.emit("unpipe",this,ae),this);if(!K){var ie=ne.pipes,le=ne.pipesCount;ne.pipes=null,ne.pipesCount=0,ne.flowing=!1;for(var ye=0;ye<le;ye++)ie[ye].emit("unpipe",this,{hasUnpiped:!1});return this}var ue=W(ne.pipes,K);return ue===-1?this:(ne.pipes.splice(ue,1),ne.pipesCount-=1,ne.pipesCount===1&&(ne.pipes=ne.pipes[0]),K.emit("unpipe",this,ae),this)},k.prototype.on=function(K,ne){var ae=e.prototype.on.call(this,K,ne),ie=this._readableState;return K==="data"?(ie.readableListening=this.listenerCount("readable")>0,ie.flowing!==!1&&this.resume()):K==="readable"&&!ie.endEmitted&&!ie.readableListening&&(ie.readableListening=ie.needReadable=!0,ie.flowing=!1,ie.emittedReadable=!1,o("on readable",ie.length,ie.reading),ie.length?H(this):ie.reading||w.nextTick(oe,this)),ae},k.prototype.addListener=k.prototype.on,k.prototype.removeListener=function(K,ne){var ae=e.prototype.removeListener.call(this,K,ne);return K==="readable"&&w.nextTick(Z,this),ae},k.prototype.removeAllListeners=function(K){var ne=e.prototype.removeAllListeners.apply(this,arguments);return(K==="readable"||K===void 0)&&w.nextTick(Z,this),ne};function Z(K){var ne=K._readableState;ne.readableListening=K.listenerCount("readable")>0,ne.resumeScheduled&&!ne.paused?ne.flowing=!0:K.listenerCount("data")>0&&K.resume()}function oe(K){o("readable nexttick read 0"),K.read(0)}k.prototype.resume=function(){var K=this._readableState;return K.flowing||(o("resume"),K.flowing=!K.readableListening,re(this,K)),K.paused=!1,this};function re(K,ne){ne.resumeScheduled||(ne.resumeScheduled=!0,w.nextTick(se,K,ne))}function se(K,ne){o("resume",ne.reading),ne.reading||K.read(0),ne.resumeScheduled=!1,K.emit("resume"),N(K),ne.flowing&&!ne.reading&&K.read(0)}k.prototype.pause=function(){return o("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(o("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this};function N(K){var ne=K._readableState;for(o("flow",ne.flowing);ne.flowing&&K.read()!==null;);}k.prototype.wrap=function(K){var ne=this,ae=this._readableState,ie=!1;K.on("end",function(){if(o("wrapped end"),ae.decoder&&!ae.ended){var ue=ae.decoder.end();ue&&ue.length&&ne.push(ue)}ne.push(null)}),K.on("data",function(ue){if(o("wrapped data"),ae.decoder&&(ue=ae.decoder.write(ue)),!(ae.objectMode&&ue==null)&&!(!ae.objectMode&&(!ue||!ue.length))){var pe=ne.push(ue);pe||(ie=!0,K.pause())}});for(var le in K)this[le]===void 0&&typeof K[le]=="function"&&(this[le]=function(pe){return function(){return K[pe].apply(K,arguments)}}(le));for(var ye=0;ye<l.length;ye++)K.on(l[ye],this.emit.bind(this,l[ye]));return this._read=function(ue){o("wrapped _read",ue),ie&&(ie=!1,K.resume())},this},typeof Symbol=="function"&&(k.prototype[Symbol.asyncIterator]=function(){return b===void 0&&(b=d("./internal/streams/async_iterator")),b(this)}),Object.defineProperty(k.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(k.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(k.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(ne){this._readableState&&(this._readableState.flowing=ne)}}),k._fromList=U,Object.defineProperty(k.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}});function U(K,ne){if(ne.length===0)return null;var ae;return ne.objectMode?ae=ne.buffer.shift():!K||K>=ne.length?(ne.decoder?ae=ne.buffer.join(""):ne.buffer.length===1?ae=ne.buffer.first():ae=ne.buffer.concat(ne.length),ne.buffer.clear()):ae=ne.buffer.consume(K,ne.decoder),ae}function q(K){var ne=K._readableState;o("endReadable",ne.endEmitted),ne.endEmitted||(ne.ended=!0,w.nextTick($,ne,K))}function $(K,ne){if(o("endReadableNT",K.endEmitted,K.length),!K.endEmitted&&K.length===0&&(K.endEmitted=!0,ne.readable=!1,ne.emit("end"),K.autoDestroy)){var ae=ne._writableState;(!ae||ae.autoDestroy&&ae.finished)&&ne.destroy()}}typeof Symbol=="function"&&(k.from=function(K,ne){return f===void 0&&(f=d("./internal/streams/from")),f(k,K,ne)});function W(K,ne){for(var ae=0,ie=K.length;ae<ie;ae++)if(K[ae]===ne)return ae;return-1}}).call(this)}).call(this,d("_process"),typeof To<"u"?To:typeof self<"u"?self:typeof window<"u"?window:{})},{"../errors":287,"./_stream_duplex":288,"./internal/streams/async_iterator":293,"./internal/streams/buffer_list":294,"./internal/streams/destroy":295,"./internal/streams/from":297,"./internal/streams/state":299,"./internal/streams/stream":300,_process:278,buffer:85,events:84,inherits:231,"string_decoder/":301,util:83}],291:[function(d,ee,te){ee.exports=r;var w=d("../errors").codes,v=w.ERR_METHOD_NOT_IMPLEMENTED,S=w.ERR_MULTIPLE_CALLBACK,M=w.ERR_TRANSFORM_ALREADY_TRANSFORMING,e=w.ERR_TRANSFORM_WITH_LENGTH_0,a=d("./_stream_duplex");d("inherits")(r,a);function n(o,i){var y=this._transformState;y.transforming=!1;var p=y.writecb;if(p===null)return this.emit("error",new S);y.writechunk=null,y.writecb=null,i!=null&&this.push(i),p(o);var g=this._readableState;g.reading=!1,(g.needReadable||g.length<g.highWaterMark)&&this._read(g.highWaterMark)}function r(o){if(!(this instanceof r))return new r(o);a.call(this,o),this._transformState={afterTransform:n.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,o&&(typeof o.transform=="function"&&(this._transform=o.transform),typeof o.flush=="function"&&(this._flush=o.flush)),this.on("prefinish",t)}function t(){var o=this;typeof this._flush=="function"&&!this._readableState.destroyed?this._flush(function(i,y){c(o,i,y)}):c(this,null,null)}r.prototype.push=function(o,i){return this._transformState.needTransform=!1,a.prototype.push.call(this,o,i)},r.prototype._transform=function(o,i,y){y(new v("_transform()"))},r.prototype._write=function(o,i,y){var p=this._transformState;if(p.writecb=y,p.writechunk=o,p.writeencoding=i,!p.transforming){var g=this._readableState;(p.needTransform||g.needReadable||g.length<g.highWaterMark)&&this._read(g.highWaterMark)}},r.prototype._read=function(o){var i=this._transformState;i.writechunk!==null&&!i.transforming?(i.transforming=!0,this._transform(i.writechunk,i.writeencoding,i.afterTransform)):i.needTransform=!0},r.prototype._destroy=function(o,i){a.prototype._destroy.call(this,o,function(y){i(y)})};function c(o,i,y){if(i)return o.emit("error",i);if(y!=null&&o.push(y),o._writableState.length)throw new e;if(o._transformState.transforming)throw new M;return o.push(null)}},{"../errors":287,"./_stream_duplex":288,inherits:231}],292:[function(d,ee,te){(function(w,v){(function(){ee.exports=T;function S(N){var U=this;this.next=null,this.entry=null,this.finish=function(){se(U,N)}}var M;T.WritableState=l;var e={deprecate:d("util-deprecate")},a=d("./internal/streams/stream"),n=d("buffer").Buffer,r=v.Uint8Array||function(){};function t(N){return n.from(N)}function c(N){return n.isBuffer(N)||N instanceof r}var o=d("./internal/streams/destroy"),i=d("./internal/streams/state"),y=i.getHighWaterMark,p=d("../errors").codes,g=p.ERR_INVALID_ARG_TYPE,h=p.ERR_METHOD_NOT_IMPLEMENTED,m=p.ERR_MULTIPLE_CALLBACK,u=p.ERR_STREAM_CANNOT_PIPE,_=p.ERR_STREAM_DESTROYED,s=p.ERR_STREAM_NULL_VALUES,A=p.ERR_STREAM_WRITE_AFTER_END,b=p.ERR_UNKNOWN_ENCODING,f=o.errorOrDestroy;d("inherits")(T,a);function x(){}function l(N,U,q){M=M||d("./_stream_duplex"),N=N||{},typeof q!="boolean"&&(q=U instanceof M),this.objectMode=!!N.objectMode,q&&(this.objectMode=this.objectMode||!!N.writableObjectMode),this.highWaterMark=y(this,N,"writableHighWaterMark",q),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var $=N.decodeStrings===!1;this.decodeStrings=!$,this.defaultEncoding=N.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(W){F(U,W)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=N.emitClose!==!1,this.autoDestroy=!!N.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new S(this)}l.prototype.getBuffer=function(){for(var U=this.bufferedRequest,q=[];U;)q.push(U),U=U.next;return q},function(){try{Object.defineProperty(l.prototype,"buffer",{get:e.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}();var L;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(L=Function.prototype[Symbol.hasInstance],Object.defineProperty(T,Symbol.hasInstance,{value:function(U){return L.call(this,U)?!0:this!==T?!1:U&&U._writableState instanceof l}})):L=function(U){return U instanceof this};function T(N){M=M||d("./_stream_duplex");var U=this instanceof M;if(!U&&!L.call(T,this))return new T(N);this._writableState=new l(N,this,U),this.writable=!0,N&&(typeof N.write=="function"&&(this._write=N.write),typeof N.writev=="function"&&(this._writev=N.writev),typeof N.destroy=="function"&&(this._destroy=N.destroy),typeof N.final=="function"&&(this._final=N.final)),a.call(this)}T.prototype.pipe=function(){f(this,new u)};function k(N,U){var q=new A;f(N,q),w.nextTick(U,q)}function P(N,U,q,$){var W;return q===null?W=new s:typeof q!="string"&&!U.objectMode&&(W=new g("chunk",["string","Buffer"],q)),W?(f(N,W),w.nextTick($,W),!1):!0}T.prototype.write=function(N,U,q){var $=this._writableState,W=!1,K=!$.objectMode&&c(N);return K&&!n.isBuffer(N)&&(N=t(N)),typeof U=="function"&&(q=U,U=null),K?U="buffer":U||(U=$.defaultEncoding),typeof q!="function"&&(q=x),$.ending?k(this,q):(K||P(this,$,N,q))&&($.pendingcb++,W=I(this,$,K,N,U,q)),W},T.prototype.cork=function(){this._writableState.corked++},T.prototype.uncork=function(){var N=this._writableState;N.corked&&(N.corked--,!N.writing&&!N.corked&&!N.bufferProcessing&&N.bufferedRequest&&J(this,N))},T.prototype.setDefaultEncoding=function(U){if(typeof U=="string"&&(U=U.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((U+"").toLowerCase())>-1))throw new b(U);return this._writableState.defaultEncoding=U,this},Object.defineProperty(T.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});function z(N,U,q){return!N.objectMode&&N.decodeStrings!==!1&&typeof U=="string"&&(U=n.from(U,q)),U}Object.defineProperty(T.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function I(N,U,q,$,W,K){if(!q){var ne=z(U,$,W);$!==ne&&(q=!0,W="buffer",$=ne)}var ae=U.objectMode?1:$.length;U.length+=ae;var ie=U.length<U.highWaterMark;if(ie||(U.needDrain=!0),U.writing||U.corked){var le=U.lastBufferedRequest;U.lastBufferedRequest={chunk:$,encoding:W,isBuf:q,callback:K,next:null},le?le.next=U.lastBufferedRequest:U.bufferedRequest=U.lastBufferedRequest,U.bufferedRequestCount+=1}else D(N,U,!1,ae,$,W,K);return ie}function D(N,U,q,$,W,K,ne){U.writelen=$,U.writecb=ne,U.writing=!0,U.sync=!0,U.destroyed?U.onwrite(new _("write")):q?N._writev(W,U.onwrite):N._write(W,K,U.onwrite),U.sync=!1}function R(N,U,q,$,W){--U.pendingcb,q?(w.nextTick(W,$),w.nextTick(oe,N,U),N._writableState.errorEmitted=!0,f(N,$)):(W($),N._writableState.errorEmitted=!0,f(N,$),oe(N,U))}function B(N){N.writing=!1,N.writecb=null,N.length-=N.writelen,N.writelen=0}function F(N,U){var q=N._writableState,$=q.sync,W=q.writecb;if(typeof W!="function")throw new m;if(B(q),U)R(N,q,$,U,W);else{var K=X(q)||N.destroyed;!K&&!q.corked&&!q.bufferProcessing&&q.bufferedRequest&&J(N,q),$?w.nextTick(H,N,q,K,W):H(N,q,K,W)}}function H(N,U,q,$){q||G(N,U),U.pendingcb--,$(),oe(N,U)}function G(N,U){U.length===0&&U.needDrain&&(U.needDrain=!1,N.emit("drain"))}function J(N,U){U.bufferProcessing=!0;var q=U.bufferedRequest;if(N._writev&&q&&q.next){var $=U.bufferedRequestCount,W=new Array($),K=U.corkedRequestsFree;K.entry=q;for(var ne=0,ae=!0;q;)W[ne]=q,q.isBuf||(ae=!1),q=q.next,ne+=1;W.allBuffers=ae,D(N,U,!0,U.length,W,"",K.finish),U.pendingcb++,U.lastBufferedRequest=null,K.next?(U.corkedRequestsFree=K.next,K.next=null):U.corkedRequestsFree=new S(U),U.bufferedRequestCount=0}else{for(;q;){var ie=q.chunk,le=q.encoding,ye=q.callback,ue=U.objectMode?1:ie.length;if(D(N,U,!1,ue,ie,le,ye),q=q.next,U.bufferedRequestCount--,U.writing)break}q===null&&(U.lastBufferedRequest=null)}U.bufferedRequest=q,U.bufferProcessing=!1}T.prototype._write=function(N,U,q){q(new h("_write()"))},T.prototype._writev=null,T.prototype.end=function(N,U,q){var $=this._writableState;return typeof N=="function"?(q=N,N=null,U=null):typeof U=="function"&&(q=U,U=null),N!=null&&this.write(N,U),$.corked&&($.corked=1,this.uncork()),$.ending||re(this,$,q),this},Object.defineProperty(T.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function X(N){return N.ending&&N.length===0&&N.bufferedRequest===null&&!N.finished&&!N.writing}function Y(N,U){N._final(function(q){U.pendingcb--,q&&f(N,q),U.prefinished=!0,N.emit("prefinish"),oe(N,U)})}function Z(N,U){!U.prefinished&&!U.finalCalled&&(typeof N._final=="function"&&!U.destroyed?(U.pendingcb++,U.finalCalled=!0,w.nextTick(Y,N,U)):(U.prefinished=!0,N.emit("prefinish")))}function oe(N,U){var q=X(U);if(q&&(Z(N,U),U.pendingcb===0&&(U.finished=!0,N.emit("finish"),U.autoDestroy))){var $=N._readableState;(!$||$.autoDestroy&&$.endEmitted)&&N.destroy()}return q}function re(N,U,q){U.ending=!0,oe(N,U),q&&(U.finished?w.nextTick(q):N.once("finish",q)),U.ended=!0,N.writable=!1}function se(N,U,q){var $=N.entry;for(N.entry=null;$;){var W=$.callback;U.pendingcb--,W(q),$=$.next}U.corkedRequestsFree.next=N}Object.defineProperty(T.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(U){!this._writableState||(this._writableState.destroyed=U)}}),T.prototype.destroy=o.destroy,T.prototype._undestroy=o.undestroy,T.prototype._destroy=function(N,U){U(N)}}).call(this)}).call(this,d("_process"),typeof To<"u"?To:typeof self<"u"?self:typeof window<"u"?window:{})},{"../errors":287,"./_stream_duplex":288,"./internal/streams/destroy":295,"./internal/streams/state":299,"./internal/streams/stream":300,_process:278,buffer:85,inherits:231,"util-deprecate":331}],293:[function(d,ee,te){(function(w){(function(){var v;function S(_,s,A){return s in _?Object.defineProperty(_,s,{value:A,enumerable:!0,configurable:!0,writable:!0}):_[s]=A,_}var M=d("./end-of-stream"),e=Symbol("lastResolve"),a=Symbol("lastReject"),n=Symbol("error"),r=Symbol("ended"),t=Symbol("lastPromise"),c=Symbol("handlePromise"),o=Symbol("stream");function i(_,s){return{value:_,done:s}}function y(_){var s=_[e];if(s!==null){var A=_[o].read();A!==null&&(_[t]=null,_[e]=null,_[a]=null,s(i(A,!1)))}}function p(_){w.nextTick(y,_)}function g(_,s){return function(A,b){_.then(function(){if(s[r]){A(i(void 0,!0));return}s[c](A,b)},b)}}var h=Object.getPrototypeOf(function(){}),m=Object.setPrototypeOf((v={get stream(){return this[o]},next:function(){var s=this,A=this[n];if(A!==null)return Promise.reject(A);if(this[r])return Promise.resolve(i(void 0,!0));if(this[o].destroyed)return new Promise(function(l,L){w.nextTick(function(){s[n]?L(s[n]):l(i(void 0,!0))})});var b=this[t],f;if(b)f=new Promise(g(b,this));else{var x=this[o].read();if(x!==null)return Promise.resolve(i(x,!1));f=new Promise(this[c])}return this[t]=f,f}},S(v,Symbol.asyncIterator,function(){return this}),S(v,"return",function(){var s=this;return new Promise(function(A,b){s[o].destroy(null,function(f){if(f){b(f);return}A(i(void 0,!0))})})}),v),h),u=function(s){var A,b=Object.create(m,(A={},S(A,o,{value:s,writable:!0}),S(A,e,{value:null,writable:!0}),S(A,a,{value:null,writable:!0}),S(A,n,{value:null,writable:!0}),S(A,r,{value:s._readableState.endEmitted,writable:!0}),S(A,c,{value:function(x,l){var L=b[o].read();L?(b[t]=null,b[e]=null,b[a]=null,x(i(L,!1))):(b[e]=x,b[a]=l)},writable:!0}),A));return b[t]=null,M(s,function(f){if(f&&f.code!=="ERR_STREAM_PREMATURE_CLOSE"){var x=b[a];x!==null&&(b[t]=null,b[e]=null,b[a]=null,x(f)),b[n]=f;return}var l=b[e];l!==null&&(b[t]=null,b[e]=null,b[a]=null,l(i(void 0,!0))),b[r]=!0}),s.on("readable",p.bind(null,b)),b};ee.exports=u}).call(this)}).call(this,d("_process"))},{"./end-of-stream":296,_process:278}],294:[function(d,ee,te){function w(y,p){var g=Object.keys(y);if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(y);p&&(h=h.filter(function(m){return Object.getOwnPropertyDescriptor(y,m).enumerable})),g.push.apply(g,h)}return g}function v(y){for(var p=1;p<arguments.length;p++){var g=arguments[p]!=null?arguments[p]:{};p%2?w(Object(g),!0).forEach(function(h){S(y,h,g[h])}):Object.getOwnPropertyDescriptors?Object.defineProperties(y,Object.getOwnPropertyDescriptors(g)):w(Object(g)).forEach(function(h){Object.defineProperty(y,h,Object.getOwnPropertyDescriptor(g,h))})}return y}function S(y,p,g){return p in y?Object.defineProperty(y,p,{value:g,enumerable:!0,configurable:!0,writable:!0}):y[p]=g,y}function M(y,p){if(!(y instanceof p))throw new TypeError("Cannot call a class as a function")}function e(y,p){for(var g=0;g<p.length;g++){var h=p[g];h.enumerable=h.enumerable||!1,h.configurable=!0,"value"in h&&(h.writable=!0),Object.defineProperty(y,h.key,h)}}function a(y,p,g){return p&&e(y.prototype,p),g&&e(y,g),y}var n=d("buffer"),r=n.Buffer,t=d("util"),c=t.inspect,o=c&&c.custom||"inspect";function i(y,p,g){r.prototype.copy.call(y,p,g)}ee.exports=function(){function y(){M(this,y),this.head=null,this.tail=null,this.length=0}return a(y,[{key:"push",value:function(g){var h={data:g,next:null};this.length>0?this.tail.next=h:this.head=h,this.tail=h,++this.length}},{key:"unshift",value:function(g){var h={data:g,next:this.head};this.length===0&&(this.tail=h),this.head=h,++this.length}},{key:"shift",value:function(){if(this.length!==0){var g=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,g}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(g){if(this.length===0)return"";for(var h=this.head,m=""+h.data;h=h.next;)m+=g+h.data;return m}},{key:"concat",value:function(g){if(this.length===0)return r.alloc(0);for(var h=r.allocUnsafe(g>>>0),m=this.head,u=0;m;)i(m.data,h,u),u+=m.data.length,m=m.next;return h}},{key:"consume",value:function(g,h){var m;return g<this.head.data.length?(m=this.head.data.slice(0,g),this.head.data=this.head.data.slice(g)):g===this.head.data.length?m=this.shift():m=h?this._getString(g):this._getBuffer(g),m}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(g){var h=this.head,m=1,u=h.data;for(g-=u.length;h=h.next;){var _=h.data,s=g>_.length?_.length:g;if(s===_.length?u+=_:u+=_.slice(0,g),g-=s,g===0){s===_.length?(++m,h.next?this.head=h.next:this.head=this.tail=null):(this.head=h,h.data=_.slice(s));break}++m}return this.length-=m,u}},{key:"_getBuffer",value:function(g){var h=r.allocUnsafe(g),m=this.head,u=1;for(m.data.copy(h),g-=m.data.length;m=m.next;){var _=m.data,s=g>_.length?_.length:g;if(_.copy(h,h.length-g,0,s),g-=s,g===0){s===_.length?(++u,m.next?this.head=m.next:this.head=this.tail=null):(this.head=m,m.data=_.slice(s));break}++u}return this.length-=u,h}},{key:o,value:function(g,h){return c(this,v({},h,{depth:0,customInspect:!1}))}}]),y}()},{buffer:85,util:83}],295:[function(d,ee,te){(function(w){(function(){function v(r,t){var c=this,o=this._readableState&&this._readableState.destroyed,i=this._writableState&&this._writableState.destroyed;return o||i?(t?t(r):r&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,w.nextTick(a,this,r)):w.nextTick(a,this,r)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(r||null,function(y){!t&&y?c._writableState?c._writableState.errorEmitted?w.nextTick(M,c):(c._writableState.errorEmitted=!0,w.nextTick(S,c,y)):w.nextTick(S,c,y):t?(w.nextTick(M,c),t(y)):w.nextTick(M,c)}),this)}function S(r,t){a(r,t),M(r)}function M(r){r._writableState&&!r._writableState.emitClose||r._readableState&&!r._readableState.emitClose||r.emit("close")}function e(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function a(r,t){r.emit("error",t)}function n(r,t){var c=r._readableState,o=r._writableState;c&&c.autoDestroy||o&&o.autoDestroy?r.destroy(t):r.emit("error",t)}ee.exports={destroy:v,undestroy:e,errorOrDestroy:n}}).call(this)}).call(this,d("_process"))},{_process:278}],296:[function(d,ee,te){var w=d("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;function v(a){var n=!1;return function(){if(!n){n=!0;for(var r=arguments.length,t=new Array(r),c=0;c<r;c++)t[c]=arguments[c];a.apply(this,t)}}}function S(){}function M(a){return a.setHeader&&typeof a.abort=="function"}function e(a,n,r){if(typeof n=="function")return e(a,null,n);n||(n={}),r=v(r||S);var t=n.readable||n.readable!==!1&&a.readable,c=n.writable||n.writable!==!1&&a.writable,o=function(){a.writable||y()},i=a._writableState&&a._writableState.finished,y=function(){c=!1,i=!0,t||r.call(a)},p=a._readableState&&a._readableState.endEmitted,g=function(){t=!1,p=!0,c||r.call(a)},h=function(s){r.call(a,s)},m=function(){var s;if(t&&!p)return(!a._readableState||!a._readableState.ended)&&(s=new w),r.call(a,s);if(c&&!i)return(!a._writableState||!a._writableState.ended)&&(s=new w),r.call(a,s)},u=function(){a.req.on("finish",y)};return M(a)?(a.on("complete",y),a.on("abort",m),a.req?u():a.on("request",u)):c&&!a._writableState&&(a.on("end",o),a.on("close",o)),a.on("end",g),a.on("finish",y),n.error!==!1&&a.on("error",h),a.on("close",m),function(){a.removeListener("complete",y),a.removeListener("abort",m),a.removeListener("request",u),a.req&&a.req.removeListener("finish",y),a.removeListener("end",o),a.removeListener("close",o),a.removeListener("finish",y),a.removeListener("end",g),a.removeListener("error",h),a.removeListener("close",m)}}ee.exports=e},{"../../../errors":287}],297:[function(d,ee,te){ee.exports=function(){throw new Error("Readable.from is not available in the browser")}},{}],298:[function(d,ee,te){var w;function v(y){var p=!1;return function(){p||(p=!0,y.apply(void 0,arguments))}}var S=d("../../../errors").codes,M=S.ERR_MISSING_ARGS,e=S.ERR_STREAM_DESTROYED;function a(y){if(y)throw y}function n(y){return y.setHeader&&typeof y.abort=="function"}function r(y,p,g,h){h=v(h);var m=!1;y.on("close",function(){m=!0}),w===void 0&&(w=d("./end-of-stream")),w(y,{readable:p,writable:g},function(_){if(_)return h(_);m=!0,h()});var u=!1;return function(_){if(!m&&!u){if(u=!0,n(y))return y.abort();if(typeof y.destroy=="function")return y.destroy();h(_||new e("pipe"))}}}function t(y){y()}function c(y,p){return y.pipe(p)}function o(y){return!y.length||typeof y[y.length-1]!="function"?a:y.pop()}function i(){for(var y=arguments.length,p=new Array(y),g=0;g<y;g++)p[g]=arguments[g];var h=o(p);if(Array.isArray(p[0])&&(p=p[0]),p.length<2)throw new M("streams");var m,u=p.map(function(_,s){var A=s<p.length-1,b=s>0;return r(_,A,b,function(f){m||(m=f),f&&u.forEach(t),!A&&(u.forEach(t),h(m))})});return p.reduce(c)}ee.exports=i},{"../../../errors":287,"./end-of-stream":296}],299:[function(d,ee,te){var w=d("../../../errors").codes.ERR_INVALID_OPT_VALUE;function v(M,e,a){return M.highWaterMark!=null?M.highWaterMark:e?M[a]:null}function S(M,e,a,n){var r=v(e,n,a);if(r!=null){if(!(isFinite(r)&&Math.floor(r)===r)||r<0){var t=n?a:"highWaterMark";throw new w(t,r)}return Math.floor(r)}return M.objectMode?16:16*1024}ee.exports={getHighWaterMark:S}},{"../../../errors":287}],300:[function(d,ee,te){ee.exports=d("events").EventEmitter},{events:84}],301:[function(d,ee,te){var w=d("safe-buffer").Buffer,v=w.isEncoding||function(u){switch(u=""+u,u&&u.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function S(u){if(!u)return"utf8";for(var _;;)switch(u){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return u;default:if(_)return;u=(""+u).toLowerCase(),_=!0}}function M(u){var _=S(u);if(typeof _!="string"&&(w.isEncoding===v||!v(u)))throw new Error("Unknown encoding: "+u);return _||u}te.StringDecoder=e;function e(u){this.encoding=M(u);var _;switch(this.encoding){case"utf16le":this.text=i,this.end=y,_=4;break;case"utf8":this.fillLast=t,_=4;break;case"base64":this.text=p,this.end=g,_=3;break;default:this.write=h,this.end=m;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=w.allocUnsafe(_)}e.prototype.write=function(u){if(u.length===0)return"";var _,s;if(this.lastNeed){if(_=this.fillLast(u),_===void 0)return"";s=this.lastNeed,this.lastNeed=0}else s=0;return s<u.length?_?_+this.text(u,s):this.text(u,s):_||""},e.prototype.end=o,e.prototype.text=c,e.prototype.fillLast=function(u){if(this.lastNeed<=u.length)return u.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);u.copy(this.lastChar,this.lastTotal-this.lastNeed,0,u.length),this.lastNeed-=u.length};function a(u){return u<=127?0:u>>5===6?2:u>>4===14?3:u>>3===30?4:u>>6===2?-1:-2}function n(u,_,s){var A=_.length-1;if(A<s)return 0;var b=a(_[A]);return b>=0?(b>0&&(u.lastNeed=b-1),b):--A<s||b===-2?0:(b=a(_[A]),b>=0?(b>0&&(u.lastNeed=b-2),b):--A<s||b===-2?0:(b=a(_[A]),b>=0?(b>0&&(b===2?b=0:u.lastNeed=b-3),b):0))}function r(u,_,s){if((_[0]&192)!==128)return u.lastNeed=0,"\uFFFD";if(u.lastNeed>1&&_.length>1){if((_[1]&192)!==128)return u.lastNeed=1,"\uFFFD";if(u.lastNeed>2&&_.length>2&&(_[2]&192)!==128)return u.lastNeed=2,"\uFFFD"}}function t(u){var _=this.lastTotal-this.lastNeed,s=r(this,u);if(s!==void 0)return s;if(this.lastNeed<=u.length)return u.copy(this.lastChar,_,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);u.copy(this.lastChar,_,0,u.length),this.lastNeed-=u.length}function c(u,_){var s=n(this,u,_);if(!this.lastNeed)return u.toString("utf8",_);this.lastTotal=s;var A=u.length-(s-this.lastNeed);return u.copy(this.lastChar,0,A),u.toString("utf8",_,A)}function o(u){var _=u&&u.length?this.write(u):"";return this.lastNeed?_+"\uFFFD":_}function i(u,_){if((u.length-_)%2===0){var s=u.toString("utf16le",_);if(s){var A=s.charCodeAt(s.length-1);if(A>=55296&&A<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=u[u.length-2],this.lastChar[1]=u[u.length-1],s.slice(0,-1)}return s}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=u[u.length-1],u.toString("utf16le",_,u.length-1)}function y(u){var _=u&&u.length?this.write(u):"";if(this.lastNeed){var s=this.lastTotal-this.lastNeed;return _+this.lastChar.toString("utf16le",0,s)}return _}function p(u,_){var s=(u.length-_)%3;return s===0?u.toString("base64",_):(this.lastNeed=3-s,this.lastTotal=3,s===1?this.lastChar[0]=u[u.length-1]:(this.lastChar[0]=u[u.length-2],this.lastChar[1]=u[u.length-1]),u.toString("base64",_,u.length-s))}function g(u){var _=u&&u.length?this.write(u):"";return this.lastNeed?_+this.lastChar.toString("base64",0,3-this.lastNeed):_}function h(u){return u.toString(this.encoding)}function m(u){return u&&u.length?this.write(u):""}},{"safe-buffer":285}],302:[function(d,ee,te){(function(w,v){(function(){var S=d("assert"),M=d("debug")("stream-parser");ee.exports=t;var e=-1,a=0,n=1,r=2;function t(s){var A=s&&typeof s._transform=="function",b=s&&typeof s._write=="function";if(!A&&!b)throw new Error("must pass a Writable or Transform stream in");M("extending Parser into stream"),s._bytes=o,s._skipBytes=i,A&&(s._passthrough=y),A?s._transform=g:s._write=p}function c(s){M("initializing parser stream"),s._parserBytesLeft=0,s._parserBuffers=[],s._parserBuffered=0,s._parserState=e,s._parserCallback=null,typeof s.push=="function"&&(s._parserOutput=s.push.bind(s)),s._parserInit=!0}function o(s,A){S(!this._parserCallback,'there is already a "callback" set!'),S(isFinite(s)&&s>0,'can only buffer a finite number of bytes > 0, got "'+s+'"'),this._parserInit||c(this),M("buffering %o bytes",s),this._parserBytesLeft=s,this._parserCallback=A,this._parserState=a}function i(s,A){S(!this._parserCallback,'there is already a "callback" set!'),S(s>0,'can only skip > 0 bytes, got "'+s+'"'),this._parserInit||c(this),M("skipping %o bytes",s),this._parserBytesLeft=s,this._parserCallback=A,this._parserState=n}function y(s,A){S(!this._parserCallback,'There is already a "callback" set!'),S(s>0,'can only pass through > 0 bytes, got "'+s+'"'),this._parserInit||c(this),M("passing through %o bytes",s),this._parserBytesLeft=s,this._parserCallback=A,this._parserState=r}function p(s,A,b){this._parserInit||c(this),M("write(%o bytes)",s.length),typeof A=="function"&&(b=A),u(this,s,null,b)}function g(s,A,b){this._parserInit||c(this),M("transform(%o bytes)",s.length),typeof A!="function"&&(A=this._parserOutput),u(this,s,A,b)}function h(s,A,b,f){return s._parserBytesLeft<=0?f(new Error("got data but not currently parsing anything")):A.length<=s._parserBytesLeft?function(){return m(s,A,b,f)}:function(){var x=A.slice(0,s._parserBytesLeft);return m(s,x,b,function(l){if(l)return f(l);if(A.length>x.length)return function(){return h(s,A.slice(x.length),b,f)}})}}function m(s,A,b,f){if(s._parserBytesLeft-=A.length,M("%o bytes left for stream piece",s._parserBytesLeft),s._parserState===a?(s._parserBuffers.push(A),s._parserBuffered+=A.length):s._parserState===r&&b(A),s._parserBytesLeft===0){var x=s._parserCallback;if(x&&s._parserState===a&&s._parserBuffers.length>1&&(A=v.concat(s._parserBuffers,s._parserBuffered)),s._parserState!==a&&(A=null),s._parserCallback=null,s._parserBuffered=0,s._parserState=e,s._parserBuffers.splice(0),x){var l=[];A&&l.push(A),b&&l.push(b);var L=x.length>l.length;L&&l.push(_(f));var T=x.apply(s,l);if(!L||f===T)return f}}else return f}var u=_(h);function _(s){return function(){for(var A=s.apply(this,arguments);typeof A=="function";)A=A();return A}}}).call(this)}).call(this,d("_process"),d("buffer").Buffer)},{_process:278,assert:75,buffer:85,debug:303}],303:[function(d,ee,te){(function(w){(function(){te=ee.exports=d("./debug"),te.log=M,te.formatArgs=S,te.save=e,te.load=a,te.useColors=v,te.storage=typeof chrome<"u"&&typeof chrome.storage<"u"?chrome.storage.local:n(),te.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"];function v(){return typeof window<"u"&&window.process&&window.process.type==="renderer"?!0:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}te.formatters.j=function(r){try{return JSON.stringify(r)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}};function S(r){var t=this.useColors;if(r[0]=(t?"%c":"")+this.namespace+(t?" %c":" ")+r[0]+(t?"%c ":" ")+"+"+te.humanize(this.diff),!!t){var c="color: "+this.color;r.splice(1,0,c,"color: inherit");var o=0,i=0;r[0].replace(/%[a-zA-Z%]/g,function(y){y!=="%%"&&(o++,y==="%c"&&(i=o))}),r.splice(i,0,c)}}function M(){return typeof console=="object"&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function e(r){try{r==null?te.storage.removeItem("debug"):te.storage.debug=r}catch{}}function a(){var r;try{r=te.storage.debug}catch{}return!r&&typeof w<"u"&&"env"in w&&(r=w.env.DEBUG),r}te.enable(a());function n(){try{return window.localStorage}catch{}}}).call(this)}).call(this,d("_process"))},{"./debug":304,_process:278}],304:[function(d,ee,te){te=ee.exports=S.debug=S.default=S,te.coerce=n,te.disable=e,te.enable=M,te.enabled=a,te.humanize=d("ms"),te.names=[],te.skips=[],te.formatters={};var w;function v(r){var t=0,c;for(c in r)t=(t<<5)-t+r.charCodeAt(c),t|=0;return te.colors[Math.abs(t)%te.colors.length]}function S(r){function t(){if(!!t.enabled){var c=t,o=+new Date,i=o-(w||o);c.diff=i,c.prev=w,c.curr=o,w=o;for(var y=new Array(arguments.length),p=0;p<y.length;p++)y[p]=arguments[p];y[0]=te.coerce(y[0]),typeof y[0]!="string"&&y.unshift("%O");var g=0;y[0]=y[0].replace(/%([a-zA-Z%])/g,function(m,u){if(m==="%%")return m;g++;var _=te.formatters[u];if(typeof _=="function"){var s=y[g];m=_.call(c,s),y.splice(g,1),g--}return m}),te.formatArgs.call(c,y);var h=t.log||te.log||console.log.bind(console);h.apply(c,y)}}return t.namespace=r,t.enabled=te.enabled(r),t.useColors=te.useColors(),t.color=v(r),typeof te.init=="function"&&te.init(t),t}function M(r){te.save(r),te.names=[],te.skips=[];for(var t=(typeof r=="string"?r:"").split(/[\s,]+/),c=t.length,o=0;o<c;o++)!t[o]||(r=t[o].replace(/\*/g,".*?"),r[0]==="-"?te.skips.push(new RegExp("^"+r.substr(1)+"$")):te.names.push(new RegExp("^"+r+"$")))}function e(){te.enable("")}function a(r){var t,c;for(t=0,c=te.skips.length;t<c;t++)if(te.skips[t].test(r))return!1;for(t=0,c=te.names.length;t<c;t++)if(te.names[t].test(r))return!0;return!1}function n(r){return r instanceof Error?r.stack||r.message:r}},{ms:305}],305:[function(d,ee,te){var w=1e3,v=w*60,S=v*60,M=S*24,e=M*365.25;ee.exports=function(c,o){o=o||{};var i=typeof c;if(i==="string"&&c.length>0)return a(c);if(i==="number"&&isNaN(c)===!1)return o.long?r(c):n(c);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(c))};function a(c){if(c=String(c),!(c.length>100)){var o=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(c);if(!!o){var i=parseFloat(o[1]),y=(o[2]||"ms").toLowerCase();switch(y){case"years":case"year":case"yrs":case"yr":case"y":return i*e;case"days":case"day":case"d":return i*M;case"hours":case"hour":case"hrs":case"hr":case"h":return i*S;case"minutes":case"minute":case"mins":case"min":case"m":return i*v;case"seconds":case"second":case"secs":case"sec":case"s":return i*w;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return i;default:return}}}}function n(c){return c>=M?Math.round(c/M)+"d":c>=S?Math.round(c/S)+"h":c>=v?Math.round(c/v)+"m":c>=w?Math.round(c/w)+"s":c+"ms"}function r(c){return t(c,M,"day")||t(c,S,"hour")||t(c,v,"minute")||t(c,w,"second")||c+" ms"}function t(c,o,i){if(!(c<o))return c<o*1.5?Math.floor(c/o)+" "+i:Math.ceil(c/o)+" "+i+"s"}},{}],306:[function(d,ee,te){var w=d("parenthesis");ee.exports=function(S,M,e){if(S==null)throw Error("First argument should be a string");if(M==null)throw Error("Separator should be a string or a RegExp");e?(typeof e=="string"||Array.isArray(e))&&(e={ignore:e}):e={},e.escape==null&&(e.escape=!0),e.ignore==null?e.ignore=["[]","()","{}","<>",'""',"''","``","\u201C\u201D","\xAB\xBB"]:(typeof e.ignore=="string"&&(e.ignore=[e.ignore]),e.ignore=e.ignore.map(function(y){return y.length===1&&(y=y+y),y}));var a=w.parse(S,{flat:!0,brackets:e.ignore}),n=a[0],r=n.split(M);if(e.escape){for(var t=[],c=0;c<r.length;c++){var o=r[c],i=r[c+1];o[o.length-1]==="\\"&&o[o.length-2]!=="\\"?(t.push(o+M+i),c++):t.push(o)}r=t}for(var c=0;c<r.length;c++)a[0]=r[c],r[c]=w.stringify(a,{flat:!0});return r}},{parenthesis:248}],307:[function(d,ee,te){ee.exports=w;function w(v){for(var S=v.length,M=new Array(S),e=new Array(S),a=new Array(S),n=new Array(S),r=new Array(S),t=new Array(S),c=0;c<S;++c)M[c]=-1,e[c]=0,a[c]=!1,n[c]=0,r[c]=-1,t[c]=[];var o=0,i=[],y=[];function p(u){var _=[u],s=[u];for(M[u]=e[u]=o,a[u]=!0,o+=1;s.length>0;){u=s[s.length-1];var A=v[u];if(n[u]<A.length){for(var b=n[u];b<A.length;++b){var f=A[b];if(M[f]<0){M[f]=e[f]=o,a[f]=!0,o+=1,_.push(f),s.push(f);break}else a[f]&&(e[u]=Math.min(e[u],e[f])|0);r[f]>=0&&t[u].push(r[f])}n[u]=b}else{if(e[u]===M[u]){for(var x=[],l=[],L=0,b=_.length-1;b>=0;--b){var T=_[b];if(a[T]=!1,x.push(T),l.push(t[T]),L+=t[T].length,r[T]=i.length,T===u){_.length=b;break}}i.push(x);for(var k=new Array(L),b=0;b<l.length;b++)for(var P=0;P<l[b].length;P++)k[--L]=l[b][P];y.push(k)}s.pop()}}}for(var c=0;c<S;++c)M[c]<0&&p(c);for(var g,c=0;c<y.length;c++){var h=y[c];if(h.length!==0){h.sort(function(_,s){return _-s}),g=[h[0]];for(var m=1;m<h.length;m++)h[m]!==h[m-1]&&g.push(h[m]);y[c]=g}}return{components:i,adjacencyList:y}}},{}],308:[function(d,ee,te){Object.defineProperty(te,"__esModule",{value:!0});var w=function(){function r(t,c){var o=[],i=!0,y=!1,p=void 0;try{for(var g=t[Symbol.iterator](),h;!(i=(h=g.next()).done)&&(o.push(h.value),!(c&&o.length===c));i=!0);}catch(m){y=!0,p=m}finally{try{!i&&g.return&&g.return()}finally{if(y)throw p}}return o}return function(t,c){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return r(t,c);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),v=Math.PI*2,S=function(t,c,o,i,y,p,g){var h=t.x,m=t.y;h*=c,m*=o;var u=i*h-y*m,_=y*h+i*m;return{x:u+p,y:_+g}},M=function(t,c){var o=c===1.5707963267948966?.551915024494:c===-1.5707963267948966?-.551915024494:1.3333333333333333*Math.tan(c/4),i=Math.cos(t),y=Math.sin(t),p=Math.cos(t+c),g=Math.sin(t+c);return[{x:i-y*o,y:y+i*o},{x:p+g*o,y:g-p*o},{x:p,y:g}]},e=function(t,c,o,i){var y=t*i-c*o<0?-1:1,p=t*o+c*i;return p>1&&(p=1),p<-1&&(p=-1),y*Math.acos(p)},a=function(t,c,o,i,y,p,g,h,m,u,_,s){var A=Math.pow(y,2),b=Math.pow(p,2),f=Math.pow(_,2),x=Math.pow(s,2),l=A*b-A*x-b*f;l<0&&(l=0),l/=A*x+b*f,l=Math.sqrt(l)*(g===h?-1:1);var L=l*y/p*s,T=l*-p/y*_,k=u*L-m*T+(t+o)/2,P=m*L+u*T+(c+i)/2,z=(_-L)/y,I=(s-T)/p,D=(-_-L)/y,R=(-s-T)/p,B=e(1,0,z,I),F=e(z,I,D,R);return h===0&&F>0&&(F-=v),h===1&&F<0&&(F+=v),[k,P,B,F]},n=function(t){var c=t.px,o=t.py,i=t.cx,y=t.cy,p=t.rx,g=t.ry,h=t.xAxisRotation,m=h===void 0?0:h,u=t.largeArcFlag,_=u===void 0?0:u,s=t.sweepFlag,A=s===void 0?0:s,b=[];if(p===0||g===0)return[];var f=Math.sin(m*v/360),x=Math.cos(m*v/360),l=x*(c-i)/2+f*(o-y)/2,L=-f*(c-i)/2+x*(o-y)/2;if(l===0&&L===0)return[];p=Math.abs(p),g=Math.abs(g);var T=Math.pow(l,2)/Math.pow(p,2)+Math.pow(L,2)/Math.pow(g,2);T>1&&(p*=Math.sqrt(T),g*=Math.sqrt(T));var k=a(c,o,i,y,p,g,_,A,f,x,l,L),P=w(k,4),z=P[0],I=P[1],D=P[2],R=P[3],B=Math.abs(R)/(v/4);Math.abs(1-B)<1e-7&&(B=1);var F=Math.max(Math.ceil(B),1);R/=F;for(var H=0;H<F;H++)b.push(M(D,R)),D+=R;return b.map(function(G){var J=S(G[0],p,g,x,f,z,I),X=J.x,Y=J.y,Z=S(G[1],p,g,x,f,z,I),oe=Z.x,re=Z.y,se=S(G[2],p,g,x,f,z,I),N=se.x,U=se.y;return{x1:X,y1:Y,x2:oe,y2:re,x:N,y:U}})};te.default=n,ee.exports=te.default},{}],309:[function(d,ee,te){var w=d("parse-svg-path"),v=d("abs-svg-path"),S=d("normalize-svg-path"),M=d("is-svg-path"),e=d("assert");ee.exports=a;function a(n){if(Array.isArray(n)&&n.length===1&&typeof n[0]=="string"&&(n=n[0]),typeof n=="string"&&(e(M(n),"String is not an SVG path."),n=w(n)),e(Array.isArray(n),"Argument should be a string or an array of path segments."),n=v(n),n=S(n),!n.length)return[0,0,0,0];for(var r=[1/0,1/0,-1/0,-1/0],t=0,c=n.length;t<c;t++)for(var o=n[t].slice(1),i=0;i<o.length;i+=2)o[i+0]<r[0]&&(r[0]=o[i+0]),o[i+1]<r[1]&&(r[1]=o[i+1]),o[i+0]>r[2]&&(r[2]=o[i+0]),o[i+1]>r[3]&&(r[3]=o[i+1]);return r}},{"abs-svg-path":70,assert:75,"is-svg-path":238,"normalize-svg-path":310,"parse-svg-path":250}],310:[function(d,ee,te){ee.exports=v;var w=d("svg-arc-to-cubic-bezier");function v(e){for(var a,n=[],r=0,t=0,c=0,o=0,i=null,y=null,p=0,g=0,h=0,m=e.length;h<m;h++){var u=e[h],_=u[0];switch(_){case"M":c=u[1],o=u[2];break;case"A":var s=w({px:p,py:g,cx:u[6],cy:u[7],rx:u[1],ry:u[2],xAxisRotation:u[3],largeArcFlag:u[4],sweepFlag:u[5]});if(!s.length)continue;for(var A=0,b;A<s.length;A++)b=s[A],u=["C",b.x1,b.y1,b.x2,b.y2,b.x,b.y],A<s.length-1&&n.push(u);break;case"S":var f=p,x=g;(a=="C"||a=="S")&&(f+=f-r,x+=x-t),u=["C",f,x,u[1],u[2],u[3],u[4]];break;case"T":a=="Q"||a=="T"?(i=p*2-i,y=g*2-y):(i=p,y=g),u=M(p,g,i,y,u[1],u[2]);break;case"Q":i=u[1],y=u[2],u=M(p,g,u[1],u[2],u[3],u[4]);break;case"L":u=S(p,g,u[1],u[2]);break;case"H":u=S(p,g,u[1],g);break;case"V":u=S(p,g,p,u[1]);break;case"Z":u=S(p,g,c,o);break}a=_,p=u[u.length-2],g=u[u.length-1],u.length>4?(r=u[u.length-4],t=u[u.length-3]):(r=p,t=g),n.push(u)}return n}function S(e,a,n,r){return["C",e,a,n,r,n,r]}function M(e,a,n,r,t,c){return["C",e/3+2/3*n,a/3+2/3*r,t/3+2/3*n,c/3+2/3*r,t,c]}},{"svg-arc-to-cubic-bezier":308}],311:[function(d,ee,te){var w=d("svg-path-bounds"),v=d("parse-svg-path"),S=d("draw-svg-path"),M=d("is-svg-path"),e=d("bitmap-sdf"),a=document.createElement("canvas"),n=a.getContext("2d");ee.exports=r;function r(o,i){if(!M(o))throw Error("Argument should be valid svg path string");i||(i={});var y,p;i.shape?(y=i.shape[0],p=i.shape[1]):(y=a.width=i.w||i.width||200,p=a.height=i.h||i.height||200);var g=Math.min(y,p),h=i.stroke||0,m=i.viewbox||i.viewBox||w(o),u=[y/(m[2]-m[0]),p/(m[3]-m[1])],_=Math.min(u[0]||0,u[1]||0)/2;if(n.fillStyle="black",n.fillRect(0,0,y,p),n.fillStyle="white",h&&(typeof h!="number"&&(h=1),h>0?n.strokeStyle="white":n.strokeStyle="black",n.lineWidth=Math.abs(h)),n.translate(y*.5,p*.5),n.scale(_,_),c()){var s=new Path2D(o);n.fill(s),h&&n.stroke(s)}else{var A=v(o);S(n,A),n.fill(),h&&n.stroke()}n.setTransform(1,0,0,1,0,0);var b=e(n,{cutoff:i.cutoff!=null?i.cutoff:.5,radius:i.radius!=null?i.radius:g*.5});return b}var t;function c(){if(t!=null)return t;var o=document.createElement("canvas").getContext("2d");if(o.canvas.width=o.canvas.height=1,!window.Path2D)return t=!1;var i=new Path2D("M0,0h1v1h-1v-1Z");o.fillStyle="black",o.fill(i);var y=o.getImageData(0,0,1,1);return t=y&&y.data&&y.data[3]===255}},{"bitmap-sdf":82,"draw-svg-path":126,"is-svg-path":238,"parse-svg-path":250,"svg-path-bounds":309}],312:[function(d,ee,te){(function(w,v){(function(){var S=d("process/browser.js").nextTick,M=Function.prototype.apply,e=Array.prototype.slice,a={},n=0;te.setTimeout=function(){return new r(M.call(setTimeout,window,arguments),clearTimeout)},te.setInterval=function(){return new r(M.call(setInterval,window,arguments),clearInterval)},te.clearTimeout=te.clearInterval=function(t){t.close()};function r(t,c){this._id=t,this._clearFn=c}r.prototype.unref=r.prototype.ref=function(){},r.prototype.close=function(){this._clearFn.call(window,this._id)},te.enroll=function(t,c){clearTimeout(t._idleTimeoutId),t._idleTimeout=c},te.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},te._unrefActive=te.active=function(t){clearTimeout(t._idleTimeoutId);var c=t._idleTimeout;c>=0&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},c))},te.setImmediate=typeof w=="function"?w:function(t){var c=n++,o=arguments.length<2?!1:e.call(arguments,1);return a[c]=!0,S(function(){a[c]&&(o?t.apply(null,o):t.call(null),te.clearImmediate(c))}),c},te.clearImmediate=typeof v=="function"?v:function(t){delete a[t]}}).call(this)}).call(this,d("timers").setImmediate,d("timers").clearImmediate)},{"process/browser.js":278,timers:312}],313:[function(d,ee,te){(function(w){var v=/^\s+/,S=/\s+$/,M=0,e=w.round,a=w.min,n=w.max,r=w.random;function t(W,K){if(W=W||"",K=K||{},W instanceof t)return W;if(!(this instanceof t))return new t(W,K);var ne=c(W);this._originalInput=W,this._r=ne.r,this._g=ne.g,this._b=ne.b,this._a=ne.a,this._roundA=e(100*this._a)/100,this._format=K.format||ne.format,this._gradientType=K.gradientType,this._r<1&&(this._r=e(this._r)),this._g<1&&(this._g=e(this._g)),this._b<1&&(this._b=e(this._b)),this._ok=ne.ok,this._tc_id=M++}t.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var W=this.toRgb();return(W.r*299+W.g*587+W.b*114)/1e3},getLuminance:function(){var W=this.toRgb(),K,ne,ae,ie,le,ye;return K=W.r/255,ne=W.g/255,ae=W.b/255,K<=.03928?ie=K/12.92:ie=w.pow((K+.055)/1.055,2.4),ne<=.03928?le=ne/12.92:le=w.pow((ne+.055)/1.055,2.4),ae<=.03928?ye=ae/12.92:ye=w.pow((ae+.055)/1.055,2.4),.2126*ie+.7152*le+.0722*ye},setAlpha:function(W){return this._a=F(W),this._roundA=e(100*this._a)/100,this},toHsv:function(){var W=p(this._r,this._g,this._b);return{h:W.h*360,s:W.s,v:W.v,a:this._a}},toHsvString:function(){var W=p(this._r,this._g,this._b),K=e(W.h*360),ne=e(W.s*100),ae=e(W.v*100);return this._a==1?"hsv("+K+", "+ne+"%, "+ae+"%)":"hsva("+K+", "+ne+"%, "+ae+"%, "+this._roundA+")"},toHsl:function(){var W=i(this._r,this._g,this._b);return{h:W.h*360,s:W.s,l:W.l,a:this._a}},toHslString:function(){var W=i(this._r,this._g,this._b),K=e(W.h*360),ne=e(W.s*100),ae=e(W.l*100);return this._a==1?"hsl("+K+", "+ne+"%, "+ae+"%)":"hsla("+K+", "+ne+"%, "+ae+"%, "+this._roundA+")"},toHex:function(W){return h(this._r,this._g,this._b,W)},toHexString:function(W){return"#"+this.toHex(W)},toHex8:function(W){return m(this._r,this._g,this._b,this._a,W)},toHex8String:function(W){return"#"+this.toHex8(W)},toRgb:function(){return{r:e(this._r),g:e(this._g),b:e(this._b),a:this._a}},toRgbString:function(){return this._a==1?"rgb("+e(this._r)+", "+e(this._g)+", "+e(this._b)+")":"rgba("+e(this._r)+", "+e(this._g)+", "+e(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:e(H(this._r,255)*100)+"%",g:e(H(this._g,255)*100)+"%",b:e(H(this._b,255)*100)+"%",a:this._a}},toPercentageRgbString:function(){return this._a==1?"rgb("+e(H(this._r,255)*100)+"%, "+e(H(this._g,255)*100)+"%, "+e(H(this._b,255)*100)+"%)":"rgba("+e(H(this._r,255)*100)+"%, "+e(H(this._g,255)*100)+"%, "+e(H(this._b,255)*100)+"%, "+this._roundA+")"},toName:function(){return this._a===0?"transparent":this._a<1?!1:R[h(this._r,this._g,this._b,!0)]||!1},toFilter:function(W){var K="#"+u(this._r,this._g,this._b,this._a),ne=K,ae=this._gradientType?"GradientType = 1, ":"";if(W){var ie=t(W);ne="#"+u(ie._r,ie._g,ie._b,ie._a)}return"progid:DXImageTransform.Microsoft.gradient("+ae+"startColorstr="+K+",endColorstr="+ne+")"},toString:function(W){var K=!!W;W=W||this._format;var ne=!1,ae=this._a<1&&this._a>=0,ie=!K&&ae&&(W==="hex"||W==="hex6"||W==="hex3"||W==="hex4"||W==="hex8"||W==="name");return ie?W==="name"&&this._a===0?this.toName():this.toRgbString():(W==="rgb"&&(ne=this.toRgbString()),W==="prgb"&&(ne=this.toPercentageRgbString()),(W==="hex"||W==="hex6")&&(ne=this.toHexString()),W==="hex3"&&(ne=this.toHexString(!0)),W==="hex4"&&(ne=this.toHex8String(!0)),W==="hex8"&&(ne=this.toHex8String()),W==="name"&&(ne=this.toName()),W==="hsl"&&(ne=this.toHslString()),W==="hsv"&&(ne=this.toHsvString()),ne||this.toHexString())},clone:function(){return t(this.toString())},_applyModification:function(W,K){var ne=W.apply(null,[this].concat([].slice.call(K)));return this._r=ne._r,this._g=ne._g,this._b=ne._b,this.setAlpha(ne._a),this},lighten:function(){return this._applyModification(b,arguments)},brighten:function(){return this._applyModification(f,arguments)},darken:function(){return this._applyModification(x,arguments)},desaturate:function(){return this._applyModification(_,arguments)},saturate:function(){return this._applyModification(s,arguments)},greyscale:function(){return this._applyModification(A,arguments)},spin:function(){return this._applyModification(l,arguments)},_applyCombination:function(W,K){return W.apply(null,[this].concat([].slice.call(K)))},analogous:function(){return this._applyCombination(z,arguments)},complement:function(){return this._applyCombination(L,arguments)},monochromatic:function(){return this._applyCombination(I,arguments)},splitcomplement:function(){return this._applyCombination(P,arguments)},triad:function(){return this._applyCombination(T,arguments)},tetrad:function(){return this._applyCombination(k,arguments)}},t.fromRatio=function(W,K){if(typeof W=="object"){var ne={};for(var ae in W)W.hasOwnProperty(ae)&&(ae==="a"?ne[ae]=W[ae]:ne[ae]=oe(W[ae]));W=ne}return t(W,K)};function c(W){var K={r:0,g:0,b:0},ne=1,ae=null,ie=null,le=null,ye=!1,ue=!1;return typeof W=="string"&&(W=q(W)),typeof W=="object"&&(U(W.r)&&U(W.g)&&U(W.b)?(K=o(W.r,W.g,W.b),ye=!0,ue=String(W.r).substr(-1)==="%"?"prgb":"rgb"):U(W.h)&&U(W.s)&&U(W.v)?(ae=oe(W.s),ie=oe(W.v),K=g(W.h,ae,ie),ye=!0,ue="hsv"):U(W.h)&&U(W.s)&&U(W.l)&&(ae=oe(W.s),le=oe(W.l),K=y(W.h,ae,le),ye=!0,ue="hsl"),W.hasOwnProperty("a")&&(ne=W.a)),ne=F(ne),{ok:ye,format:W.format||ue,r:a(255,n(K.r,0)),g:a(255,n(K.g,0)),b:a(255,n(K.b,0)),a:ne}}function o(W,K,ne){return{r:H(W,255)*255,g:H(K,255)*255,b:H(ne,255)*255}}function i(W,K,ne){W=H(W,255),K=H(K,255),ne=H(ne,255);var ae=n(W,K,ne),ie=a(W,K,ne),le,ye,ue=(ae+ie)/2;if(ae==ie)le=ye=0;else{var pe=ae-ie;switch(ye=ue>.5?pe/(2-ae-ie):pe/(ae+ie),ae){case W:le=(K-ne)/pe+(K<ne?6:0);break;case K:le=(ne-W)/pe+2;break;case ne:le=(W-K)/pe+4;break}le/=6}return{h:le,s:ye,l:ue}}function y(W,K,ne){var ae,ie,le;W=H(W,360),K=H(K,100),ne=H(ne,100);function ye(ge,Te,_e){return _e<0&&(_e+=1),_e>1&&(_e-=1),_e<1/6?ge+(Te-ge)*6*_e:_e<1/2?Te:_e<2/3?ge+(Te-ge)*(2/3-_e)*6:ge}if(K===0)ae=ie=le=ne;else{var ue=ne<.5?ne*(1+K):ne+K-ne*K,pe=2*ne-ue;ae=ye(pe,ue,W+1/3),ie=ye(pe,ue,W),le=ye(pe,ue,W-1/3)}return{r:ae*255,g:ie*255,b:le*255}}function p(W,K,ne){W=H(W,255),K=H(K,255),ne=H(ne,255);var ae=n(W,K,ne),ie=a(W,K,ne),le,ye,ue=ae,pe=ae-ie;if(ye=ae===0?0:pe/ae,ae==ie)le=0;else{switch(ae){case W:le=(K-ne)/pe+(K<ne?6:0);break;case K:le=(ne-W)/pe+2;break;case ne:le=(W-K)/pe+4;break}le/=6}return{h:le,s:ye,v:ue}}function g(W,K,ne){W=H(W,360)*6,K=H(K,100),ne=H(ne,100);var ae=w.floor(W),ie=W-ae,le=ne*(1-K),ye=ne*(1-ie*K),ue=ne*(1-(1-ie)*K),pe=ae%6,ge=[ne,ye,le,le,ue,ne][pe],Te=[ue,ne,ne,ye,le,le][pe],_e=[le,le,ue,ne,ne,ye][pe];return{r:ge*255,g:Te*255,b:_e*255}}function h(W,K,ne,ae){var ie=[Z(e(W).toString(16)),Z(e(K).toString(16)),Z(e(ne).toString(16))];return ae&&ie[0].charAt(0)==ie[0].charAt(1)&&ie[1].charAt(0)==ie[1].charAt(1)&&ie[2].charAt(0)==ie[2].charAt(1)?ie[0].charAt(0)+ie[1].charAt(0)+ie[2].charAt(0):ie.join("")}function m(W,K,ne,ae,ie){var le=[Z(e(W).toString(16)),Z(e(K).toString(16)),Z(e(ne).toString(16)),Z(re(ae))];return ie&&le[0].charAt(0)==le[0].charAt(1)&&le[1].charAt(0)==le[1].charAt(1)&&le[2].charAt(0)==le[2].charAt(1)&&le[3].charAt(0)==le[3].charAt(1)?le[0].charAt(0)+le[1].charAt(0)+le[2].charAt(0)+le[3].charAt(0):le.join("")}function u(W,K,ne,ae){var ie=[Z(re(ae)),Z(e(W).toString(16)),Z(e(K).toString(16)),Z(e(ne).toString(16))];return ie.join("")}t.equals=function(W,K){return!W||!K?!1:t(W).toRgbString()==t(K).toRgbString()},t.random=function(){return t.fromRatio({r:r(),g:r(),b:r()})};function _(W,K){K=K===0?0:K||10;var ne=t(W).toHsl();return ne.s-=K/100,ne.s=G(ne.s),t(ne)}function s(W,K){K=K===0?0:K||10;var ne=t(W).toHsl();return ne.s+=K/100,ne.s=G(ne.s),t(ne)}function A(W){return t(W).desaturate(100)}function b(W,K){K=K===0?0:K||10;var ne=t(W).toHsl();return ne.l+=K/100,ne.l=G(ne.l),t(ne)}function f(W,K){K=K===0?0:K||10;var ne=t(W).toRgb();return ne.r=n(0,a(255,ne.r-e(255*-(K/100)))),ne.g=n(0,a(255,ne.g-e(255*-(K/100)))),ne.b=n(0,a(255,ne.b-e(255*-(K/100)))),t(ne)}function x(W,K){K=K===0?0:K||10;var ne=t(W).toHsl();return ne.l-=K/100,ne.l=G(ne.l),t(ne)}function l(W,K){var ne=t(W).toHsl(),ae=(ne.h+K)%360;return ne.h=ae<0?360+ae:ae,t(ne)}function L(W){var K=t(W).toHsl();return K.h=(K.h+180)%360,t(K)}function T(W){var K=t(W).toHsl(),ne=K.h;return[t(W),t({h:(ne+120)%360,s:K.s,l:K.l}),t({h:(ne+240)%360,s:K.s,l:K.l})]}function k(W){var K=t(W).toHsl(),ne=K.h;return[t(W),t({h:(ne+90)%360,s:K.s,l:K.l}),t({h:(ne+180)%360,s:K.s,l:K.l}),t({h:(ne+270)%360,s:K.s,l:K.l})]}function P(W){var K=t(W).toHsl(),ne=K.h;return[t(W),t({h:(ne+72)%360,s:K.s,l:K.l}),t({h:(ne+216)%360,s:K.s,l:K.l})]}function z(W,K,ne){K=K||6,ne=ne||30;var ae=t(W).toHsl(),ie=360/ne,le=[t(W)];for(ae.h=(ae.h-(ie*K>>1)+720)%360;--K;)ae.h=(ae.h+ie)%360,le.push(t(ae));return le}function I(W,K){K=K||6;for(var ne=t(W).toHsv(),ae=ne.h,ie=ne.s,le=ne.v,ye=[],ue=1/K;K--;)ye.push(t({h:ae,s:ie,v:le})),le=(le+ue)%1;return ye}t.mix=function(W,K,ne){ne=ne===0?0:ne||50;var ae=t(W).toRgb(),ie=t(K).toRgb(),le=ne/100,ye={r:(ie.r-ae.r)*le+ae.r,g:(ie.g-ae.g)*le+ae.g,b:(ie.b-ae.b)*le+ae.b,a:(ie.a-ae.a)*le+ae.a};return t(ye)},t.readability=function(W,K){var ne=t(W),ae=t(K);return(w.max(ne.getLuminance(),ae.getLuminance())+.05)/(w.min(ne.getLuminance(),ae.getLuminance())+.05)},t.isReadable=function(W,K,ne){var ae=t.readability(W,K),ie,le;switch(le=!1,ie=$(ne),ie.level+ie.size){case"AAsmall":case"AAAlarge":le=ae>=4.5;break;case"AAlarge":le=ae>=3;break;case"AAAsmall":le=ae>=7;break}return le},t.mostReadable=function(W,K,ne){var ae=null,ie=0,le,ye,ue,pe;ne=ne||{},ye=ne.includeFallbackColors,ue=ne.level,pe=ne.size;for(var ge=0;ge<K.length;ge++)le=t.readability(W,K[ge]),le>ie&&(ie=le,ae=t(K[ge]));return t.isReadable(W,ae,{level:ue,size:pe})||!ye?ae:(ne.includeFallbackColors=!1,t.mostReadable(W,["#fff","#000"],ne))};var D=t.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},R=t.hexNames=B(D);function B(W){var K={};for(var ne in W)W.hasOwnProperty(ne)&&(K[W[ne]]=ne);return K}function F(W){return W=parseFloat(W),(isNaN(W)||W<0||W>1)&&(W=1),W}function H(W,K){X(W)&&(W="100%");var ne=Y(W);return W=a(K,n(0,parseFloat(W))),ne&&(W=parseInt(W*K,10)/100),w.abs(W-K)<1e-6?1:W%K/parseFloat(K)}function G(W){return a(1,n(0,W))}function J(W){return parseInt(W,16)}function X(W){return typeof W=="string"&&W.indexOf(".")!=-1&&parseFloat(W)===1}function Y(W){return typeof W=="string"&&W.indexOf("%")!=-1}function Z(W){return W.length==1?"0"+W:""+W}function oe(W){return W<=1&&(W=W*100+"%"),W}function re(W){return w.round(parseFloat(W)*255).toString(16)}function se(W){return J(W)/255}var N=function(){var W="[-\\+]?\\d+%?",K="[-\\+]?\\d*\\.\\d+%?",ne="(?:"+K+")|(?:"+W+")",ae="[\\s|\\(]+("+ne+")[,|\\s]+("+ne+")[,|\\s]+("+ne+")\\s*\\)?",ie="[\\s|\\(]+("+ne+")[,|\\s]+("+ne+")[,|\\s]+("+ne+")[,|\\s]+("+ne+")\\s*\\)?";return{CSS_UNIT:new RegExp(ne),rgb:new RegExp("rgb"+ae),rgba:new RegExp("rgba"+ie),hsl:new RegExp("hsl"+ae),hsla:new RegExp("hsla"+ie),hsv:new RegExp("hsv"+ae),hsva:new RegExp("hsva"+ie),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();function U(W){return!!N.CSS_UNIT.exec(W)}function q(W){W=W.replace(v,"").replace(S,"").toLowerCase();var K=!1;if(D[W])W=D[W],K=!0;else if(W=="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var ne;return(ne=N.rgb.exec(W))?{r:ne[1],g:ne[2],b:ne[3]}:(ne=N.rgba.exec(W))?{r:ne[1],g:ne[2],b:ne[3],a:ne[4]}:(ne=N.hsl.exec(W))?{h:ne[1],s:ne[2],l:ne[3]}:(ne=N.hsla.exec(W))?{h:ne[1],s:ne[2],l:ne[3],a:ne[4]}:(ne=N.hsv.exec(W))?{h:ne[1],s:ne[2],v:ne[3]}:(ne=N.hsva.exec(W))?{h:ne[1],s:ne[2],v:ne[3],a:ne[4]}:(ne=N.hex8.exec(W))?{r:J(ne[1]),g:J(ne[2]),b:J(ne[3]),a:se(ne[4]),format:K?"name":"hex8"}:(ne=N.hex6.exec(W))?{r:J(ne[1]),g:J(ne[2]),b:J(ne[3]),format:K?"name":"hex"}:(ne=N.hex4.exec(W))?{r:J(ne[1]+""+ne[1]),g:J(ne[2]+""+ne[2]),b:J(ne[3]+""+ne[3]),a:se(ne[4]+""+ne[4]),format:K?"name":"hex8"}:(ne=N.hex3.exec(W))?{r:J(ne[1]+""+ne[1]),g:J(ne[2]+""+ne[2]),b:J(ne[3]+""+ne[3]),format:K?"name":"hex"}:!1}function $(W){var K,ne;return W=W||{level:"AA",size:"small"},K=(W.level||"AA").toUpperCase(),ne=(W.size||"small").toLowerCase(),K!=="AA"&&K!=="AAA"&&(K="AA"),ne!=="small"&&ne!=="large"&&(ne="small"),{level:K,size:ne}}typeof ee<"u"&&ee.exports?ee.exports=t:window.tinycolor=t})(Math)},{}],314:[function(d,ee,te){ee.exports=S,ee.exports.float32=ee.exports.float=S,ee.exports.fract32=ee.exports.fract=v;var w=new Float32Array(1);function v(M,e){if(M.length){if(M instanceof Float32Array)return new Float32Array(M.length);e instanceof Float32Array||(e=S(M));for(var a=0,n=e.length;a<n;a++)e[a]=M[a]-e[a];return e}return S(M-S(M))}function S(M){return M.length?M instanceof Float32Array?M:new Float32Array(M):(w[0]=M,w[0])}},{}],315:[function(d,ee,te){var w=d("parse-unit");ee.exports=e;var v=96;function S(a,n){var r=w(getComputedStyle(a).getPropertyValue(n));return r[0]*e(r[1],a)}function M(a,n){var r=document.createElement("div");r.style["font-size"]="128"+a,n.appendChild(r);var t=S(r,"font-size")/128;return n.removeChild(r),t}function e(a,n){switch(n=n||document.body,a=(a||"px").trim().toLowerCase(),(n===window||n===document)&&(n=document.body),a){case"%":return n.clientHeight/100;case"ch":case"ex":return M(a,n);case"em":return S(n,"font-size");case"rem":return S(document.body,"font-size");case"vw":return window.innerWidth/100;case"vh":return window.innerHeight/100;case"vmin":return Math.min(window.innerWidth,window.innerHeight)/100;case"vmax":return Math.max(window.innerWidth,window.innerHeight)/100;case"in":return v;case"cm":return v/2.54;case"mm":return v/25.4;case"pt":return v/72;case"pc":return v/6}return 1}},{"parse-unit":251}],316:[function(d,ee,te){(function(w,v){typeof te=="object"&&typeof ee<"u"?v(te):(w=w||self,v(w.topojson=w.topojson||{}))})(this,function(w){function v(s){return s}function S(s){if(s==null)return v;var A,b,f=s.scale[0],x=s.scale[1],l=s.translate[0],L=s.translate[1];return function(T,k){k||(A=b=0);var P=2,z=T.length,I=new Array(z);for(I[0]=(A+=T[0])*f+l,I[1]=(b+=T[1])*x+L;P<z;)I[P]=T[P],++P;return I}}function M(s){var A=S(s.transform),b,f=1/0,x=f,l=-f,L=-f;function T(P){P=A(P),P[0]<f&&(f=P[0]),P[0]>l&&(l=P[0]),P[1]<x&&(x=P[1]),P[1]>L&&(L=P[1])}function k(P){switch(P.type){case"GeometryCollection":P.geometries.forEach(k);break;case"Point":T(P.coordinates);break;case"MultiPoint":P.coordinates.forEach(T);break}}s.arcs.forEach(function(P){for(var z=-1,I=P.length,D;++z<I;)D=A(P[z],z),D[0]<f&&(f=D[0]),D[0]>l&&(l=D[0]),D[1]<x&&(x=D[1]),D[1]>L&&(L=D[1])});for(b in s.objects)k(s.objects[b]);return[f,x,l,L]}function e(s,A){for(var b,f=s.length,x=f-A;x<--f;)b=s[x],s[x++]=s[f],s[f]=b}function a(s,A){return typeof A=="string"&&(A=s.objects[A]),A.type==="GeometryCollection"?{type:"FeatureCollection",features:A.geometries.map(function(b){return n(s,b)})}:n(s,A)}function n(s,A){var b=A.id,f=A.bbox,x=A.properties==null?{}:A.properties,l=r(s,A);return b==null&&f==null?{type:"Feature",properties:x,geometry:l}:f==null?{type:"Feature",id:b,properties:x,geometry:l}:{type:"Feature",id:b,bbox:f,properties:x,geometry:l}}function r(s,A){var b=S(s.transform),f=s.arcs;function x(z,I){I.length&&I.pop();for(var D=f[z<0?~z:z],R=0,B=D.length;R<B;++R)I.push(b(D[R],R));z<0&&e(I,B)}function l(z){return b(z)}function L(z){for(var I=[],D=0,R=z.length;D<R;++D)x(z[D],I);return I.length<2&&I.push(I[0]),I}function T(z){for(var I=L(z);I.length<4;)I.push(I[0]);return I}function k(z){return z.map(T)}function P(z){var I=z.type,D;switch(I){case"GeometryCollection":return{type:I,geometries:z.geometries.map(P)};case"Point":D=l(z.coordinates);break;case"MultiPoint":D=z.coordinates.map(l);break;case"LineString":D=L(z.arcs);break;case"MultiLineString":D=z.arcs.map(L);break;case"Polygon":D=k(z.arcs);break;case"MultiPolygon":D=z.arcs.map(k);break;default:return null}return{type:I,coordinates:D}}return P(A)}function t(s,A){var b={},f={},x={},l=[],L=-1;A.forEach(function(P,z){var I=s.arcs[P<0?~P:P],D;I.length<3&&!I[1][0]&&!I[1][1]&&(D=A[++L],A[L]=P,A[z]=D)}),A.forEach(function(P){var z=T(P),I=z[0],D=z[1],R,B;if(R=x[I])if(delete x[R.end],R.push(P),R.end=D,B=f[D]){delete f[B.start];var F=B===R?R:R.concat(B);f[F.start=R.start]=x[F.end=B.end]=F}else f[R.start]=x[R.end]=R;else if(R=f[D])if(delete f[R.start],R.unshift(P),R.start=I,B=x[I]){delete x[B.end];var H=B===R?R:B.concat(R);f[H.start=B.start]=x[H.end=R.end]=H}else f[R.start]=x[R.end]=R;else R=[P],f[R.start=I]=x[R.end=D]=R});function T(P){var z=s.arcs[P<0?~P:P],I=z[0],D;return s.transform?(D=[0,0],z.forEach(function(R){D[0]+=R[0],D[1]+=R[1]})):D=z[z.length-1],P<0?[D,I]:[I,D]}function k(P,z){for(var I in P){var D=P[I];delete z[D.start],delete D.start,delete D.end,D.forEach(function(R){b[R<0?~R:R]=1}),l.push(D)}}return k(x,f),k(f,x),A.forEach(function(P){b[P<0?~P:P]||l.push([P])}),l}function c(s){return r(s,o.apply(this,arguments))}function o(s,A,b){var f,x,l;if(arguments.length>1)f=i(s,A,b);else for(x=0,f=new Array(l=s.arcs.length);x<l;++x)f[x]=x;return{type:"MultiLineString",arcs:t(s,f)}}function i(s,A,b){var f=[],x=[],l;function L(I){var D=I<0?~I:I;(x[D]||(x[D]=[])).push({i:I,g:l})}function T(I){I.forEach(L)}function k(I){I.forEach(T)}function P(I){I.forEach(k)}function z(I){switch(l=I,I.type){case"GeometryCollection":I.geometries.forEach(z);break;case"LineString":T(I.arcs);break;case"MultiLineString":case"Polygon":k(I.arcs);break;case"MultiPolygon":P(I.arcs);break}}return z(A),x.forEach(b==null?function(I){f.push(I[0].i)}:function(I){b(I[0].g,I[I.length-1].g)&&f.push(I[0].i)}),f}function y(s){for(var A=-1,b=s.length,f,x=s[b-1],l=0;++A<b;)f=x,x=s[A],l+=f[0]*x[1]-f[1]*x[0];return Math.abs(l)}function p(s){return r(s,g.apply(this,arguments))}function g(s,A){var b={},f=[],x=[];A.forEach(l);function l(k){switch(k.type){case"GeometryCollection":k.geometries.forEach(l);break;case"Polygon":L(k.arcs);break;case"MultiPolygon":k.arcs.forEach(L);break}}function L(k){k.forEach(function(P){P.forEach(function(z){(b[z=z<0?~z:z]||(b[z]=[])).push(k)})}),f.push(k)}function T(k){return y(r(s,{type:"Polygon",arcs:[k]}).coordinates[0])}return f.forEach(function(k){if(!k._){var P=[],z=[k];for(k._=1,x.push(P);k=z.pop();)P.push(k),k.forEach(function(I){I.forEach(function(D){b[D<0?~D:D].forEach(function(R){R._||(R._=1,z.push(R))})})})}}),f.forEach(function(k){delete k._}),{type:"MultiPolygon",arcs:x.map(function(k){var P=[],z;if(k.forEach(function(F){F.forEach(function(H){H.forEach(function(G){b[G<0?~G:G].length<2&&P.push(G)})})}),P=t(s,P),(z=P.length)>1)for(var I=1,D=T(P[0]),R,B;I<z;++I)(R=T(P[I]))>D&&(B=P[0],P[0]=P[I],P[I]=B,D=R);return P}).filter(function(k){return k.length>0})}}function h(s,A){for(var b=0,f=s.length;b<f;){var x=b+f>>>1;s[x]<A?b=x+1:f=x}return b}function m(s){var A={},b=s.map(function(){return[]});function f(F,H){F.forEach(function(G){G<0&&(G=~G);var J=A[G];J?J.push(H):A[G]=[H]})}function x(F,H){F.forEach(function(G){f(G,H)})}function l(F,H){F.type==="GeometryCollection"?F.geometries.forEach(function(G){l(G,H)}):F.type in L&&L[F.type](F.arcs,H)}var L={LineString:f,MultiLineString:x,Polygon:x,MultiPolygon:function(F,H){F.forEach(function(G){x(G,H)})}};s.forEach(l);for(var T in A)for(var k=A[T],P=k.length,z=0;z<P;++z)for(var I=z+1;I<P;++I){var D=k[z],R=k[I],B;(B=b[D])[T=h(B,R)]!==R&&B.splice(T,0,R),(B=b[R])[T=h(B,D)]!==D&&B.splice(T,0,D)}return b}function u(s){if(s==null)return v;var A,b,f=s.scale[0],x=s.scale[1],l=s.translate[0],L=s.translate[1];return function(T,k){k||(A=b=0);var P=2,z=T.length,I=new Array(z),D=Math.round((T[0]-l)/f),R=Math.round((T[1]-L)/x);for(I[0]=D-A,A=D,I[1]=R-b,b=R;P<z;)I[P]=T[P],++P;return I}}function _(s,A){if(s.transform)throw new Error("already quantized");if(!A||!A.scale){if(!((L=Math.floor(A))>=2))throw new Error("n must be \u22652");k=s.bbox||M(s);var b=k[0],f=k[1],x=k[2],l=k[3],L;A={scale:[x-b?(x-b)/(L-1):1,l-f?(l-f)/(L-1):1],translate:[b,f]}}else k=s.bbox;var T=u(A),k,P,z=s.objects,I={};function D(F){return T(F)}function R(F){var H;switch(F.type){case"GeometryCollection":H={type:"GeometryCollection",geometries:F.geometries.map(R)};break;case"Point":H={type:"Point",coordinates:D(F.coordinates)};break;case"MultiPoint":H={type:"MultiPoint",coordinates:F.coordinates.map(D)};break;default:return F}return F.id!=null&&(H.id=F.id),F.bbox!=null&&(H.bbox=F.bbox),F.properties!=null&&(H.properties=F.properties),H}function B(F){var H=0,G=1,J=F.length,X,Y=new Array(J);for(Y[0]=T(F[0],0);++H<J;)((X=T(F[H],H))[0]||X[1])&&(Y[G++]=X);return G===1&&(Y[G++]=[0,0]),Y.length=G,Y}for(P in z)I[P]=R(z[P]);return{type:"Topology",bbox:k,transform:A,objects:I,arcs:s.arcs.map(B)}}w.bbox=M,w.feature=a,w.merge=p,w.mergeArcs=g,w.mesh=c,w.meshArcs=o,w.neighbors=m,w.quantize=_,w.transform=S,w.untransform=u,Object.defineProperty(w,"__esModule",{value:!0})})},{}],317:[function(d,ee,te){var w=d("../prototype/is");ee.exports=function(v){if(typeof v!="function"||!hasOwnProperty.call(v,"length"))return!1;try{if(typeof v.length!="number"||typeof v.call!="function"||typeof v.apply!="function")return!1}catch{return!1}return!w(v)}},{"../prototype/is":324}],318:[function(d,ee,te){var w=d("../value/is"),v=d("../object/is"),S=d("../string/coerce"),M=d("./to-short-string"),e=function(a,n){return a.replace("%v",M(n))};ee.exports=function(a,n,r){if(!v(r))throw new TypeError(e(n,a));if(!w(a)){if("default"in r)return r.default;if(r.isOptional)return null}var t=S(r.errorMessage);throw w(t)||(t=n),new TypeError(e(t,a))}},{"../object/is":321,"../string/coerce":325,"../value/is":327,"./to-short-string":320}],319:[function(d,ee,te){ee.exports=function(w){try{return w.toString()}catch{try{return String(w)}catch{return null}}}},{}],320:[function(d,ee,te){var w=d("./safe-to-string"),v=/[\n\r\u2028\u2029]/g;ee.exports=function(S){var M=w(S);return M===null?"<Non-coercible to string value>":(M.length>100&&(M=M.slice(0,99)+"\u2026"),M=M.replace(v,function(e){switch(e){case`
`:return"\\n";case"\r":return"\\r";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:throw new Error("Unexpected character")}}),M)}},{"./safe-to-string":319}],321:[function(d,ee,te){var w=d("../value/is"),v={object:!0,function:!0,undefined:!0};ee.exports=function(S){return w(S)?hasOwnProperty.call(v,typeof S):!1}},{"../value/is":327}],322:[function(d,ee,te){var w=d("../lib/resolve-exception"),v=d("./is");ee.exports=function(S){return v(S)?S:w(S,"%v is not a plain function",arguments[1])}},{"../lib/resolve-exception":318,"./is":323}],323:[function(d,ee,te){var w=d("../function/is"),v=/^\s*class[\s{/}]/,S=Function.prototype.toString;ee.exports=function(M){return!(!w(M)||v.test(S.call(M)))}},{"../function/is":317}],324:[function(d,ee,te){var w=d("../object/is");ee.exports=function(v){if(!w(v))return!1;try{return v.constructor?v.constructor.prototype===v:!1}catch{return!1}}},{"../object/is":321}],325:[function(d,ee,te){var w=d("../value/is"),v=d("../object/is"),S=Object.prototype.toString;ee.exports=function(M){if(!w(M))return null;if(v(M)){var e=M.toString;if(typeof e!="function"||e===S)return null}try{return""+M}catch{return null}}},{"../object/is":321,"../value/is":327}],326:[function(d,ee,te){var w=d("../lib/resolve-exception"),v=d("./is");ee.exports=function(S){return v(S)?S:w(S,"Cannot use %v",arguments[1])}},{"../lib/resolve-exception":318,"./is":327}],327:[function(d,ee,te){var w=void 0;ee.exports=function(v){return v!==w&&v!==null}},{}],328:[function(d,ee,te){(function(w){(function(){var v=d("bit-twiddle"),S=d("dup"),M=d("buffer").Buffer;w.__TYPEDARRAY_POOL||(w.__TYPEDARRAY_POOL={UINT8:S([32,0]),UINT16:S([32,0]),UINT32:S([32,0]),BIGUINT64:S([32,0]),INT8:S([32,0]),INT16:S([32,0]),INT32:S([32,0]),BIGINT64:S([32,0]),FLOAT:S([32,0]),DOUBLE:S([32,0]),DATA:S([32,0]),UINT8C:S([32,0]),BUFFER:S([32,0])});var e=typeof Uint8ClampedArray<"u",a=typeof BigUint64Array<"u",n=typeof BigInt64Array<"u",r=w.__TYPEDARRAY_POOL;r.UINT8C||(r.UINT8C=S([32,0])),r.BIGUINT64||(r.BIGUINT64=S([32,0])),r.BIGINT64||(r.BIGINT64=S([32,0])),r.BUFFER||(r.BUFFER=S([32,0]));var t=r.DATA,c=r.BUFFER;te.free=function(k){if(M.isBuffer(k))c[v.log2(k.length)].push(k);else{if(Object.prototype.toString.call(k)!=="[object ArrayBuffer]"&&(k=k.buffer),!k)return;var P=k.length||k.byteLength,z=v.log2(P)|0;t[z].push(k)}};function o(T){if(!!T){var k=T.length||T.byteLength,P=v.log2(k);t[P].push(T)}}function i(T){o(T.buffer)}te.freeUint8=te.freeUint16=te.freeUint32=te.freeBigUint64=te.freeInt8=te.freeInt16=te.freeInt32=te.freeBigInt64=te.freeFloat32=te.freeFloat=te.freeFloat64=te.freeDouble=te.freeUint8Clamped=te.freeDataView=i,te.freeArrayBuffer=o,te.freeBuffer=function(k){c[v.log2(k.length)].push(k)},te.malloc=function(k,P){if(P===void 0||P==="arraybuffer")return y(k);switch(P){case"uint8":return p(k);case"uint16":return g(k);case"uint32":return h(k);case"int8":return m(k);case"int16":return u(k);case"int32":return _(k);case"float":case"float32":return s(k);case"double":case"float64":return A(k);case"uint8_clamped":return b(k);case"bigint64":return x(k);case"biguint64":return f(k);case"buffer":return L(k);case"data":case"dataview":return l(k);default:return null}return null};function y(k){var k=v.nextPow2(k),P=v.log2(k),z=t[P];return z.length>0?z.pop():new ArrayBuffer(k)}te.mallocArrayBuffer=y;function p(T){return new Uint8Array(y(T),0,T)}te.mallocUint8=p;function g(T){return new Uint16Array(y(2*T),0,T)}te.mallocUint16=g;function h(T){return new Uint32Array(y(4*T),0,T)}te.mallocUint32=h;function m(T){return new Int8Array(y(T),0,T)}te.mallocInt8=m;function u(T){return new Int16Array(y(2*T),0,T)}te.mallocInt16=u;function _(T){return new Int32Array(y(4*T),0,T)}te.mallocInt32=_;function s(T){return new Float32Array(y(4*T),0,T)}te.mallocFloat32=te.mallocFloat=s;function A(T){return new Float64Array(y(8*T),0,T)}te.mallocFloat64=te.mallocDouble=A;function b(T){return e?new Uint8ClampedArray(y(T),0,T):p(T)}te.mallocUint8Clamped=b;function f(T){return a?new BigUint64Array(y(8*T),0,T):null}te.mallocBigUint64=f;function x(T){return n?new BigInt64Array(y(8*T),0,T):null}te.mallocBigInt64=x;function l(T){return new DataView(y(T),0,T)}te.mallocDataView=l;function L(T){T=v.nextPow2(T);var k=v.log2(T),P=c[k];return P.length>0?P.pop():new M(T)}te.mallocBuffer=L,te.clearCache=function(){for(var k=0;k<32;++k)r.UINT8[k].length=0,r.UINT16[k].length=0,r.UINT32[k].length=0,r.INT8[k].length=0,r.INT16[k].length=0,r.INT32[k].length=0,r.FLOAT[k].length=0,r.DOUBLE[k].length=0,r.BIGUINT64[k].length=0,r.BIGINT64[k].length=0,r.UINT8C[k].length=0,t[k].length=0,c[k].length=0}}).call(this)}).call(this,typeof To<"u"?To:typeof self<"u"?self:typeof window<"u"?window:{})},{"bit-twiddle":81,buffer:85,dup:128}],329:[function(d,ee,te){var w=/[\'\"]/;ee.exports=function(S){return S?(w.test(S.charAt(0))&&(S=S.substr(1)),w.test(S.charAt(S.length-1))&&(S=S.substr(0,S.length-1)),S):""}},{}],330:[function(d,ee,te){ee.exports=function(v,S,M){Array.isArray(M)||(M=[].slice.call(arguments,2));for(var e=0,a=M.length;e<a;e++){var n=M[e];for(var r in n)if(!(S[r]!==void 0&&!Array.isArray(S[r])&&v[r]===S[r])&&r in S){var t;if(n[r]===!0)t=S[r];else{if(n[r]===!1)continue;if(typeof n[r]=="function"&&(t=n[r](S[r],v,S),t===void 0))continue}v[r]=t}}return v}},{}],331:[function(d,ee,te){(function(w){(function(){ee.exports=v;function v(M,e){if(S("noDeprecation"))return M;var a=!1;function n(){if(!a){if(S("throwDeprecation"))throw new Error(e);S("traceDeprecation")?console.trace(e):console.warn(e),a=!0}return M.apply(this,arguments)}return n}function S(M){try{if(!w.localStorage)return!1}catch{return!1}var e=w.localStorage[M];return e==null?!1:String(e).toLowerCase()==="true"}}).call(this)}).call(this,typeof To<"u"?To:typeof self<"u"?self:typeof window<"u"?window:{})},{}],332:[function(d,ee,te){var w=d("get-canvas-context");ee.exports=function(S){return w("webgl",S)}},{"get-canvas-context":194}],333:[function(d,ee,te){var w=d("../main"),v=d("object-assign"),S=w.instance();function M(y){this.local=this.regionalOptions[y||""]||this.regionalOptions[""]}M.prototype=new w.baseCalendar,v(M.prototype,{name:"Chinese",jdEpoch:17214255e-1,hasYearZero:!1,minMonth:0,firstMonth:0,minDay:1,regionalOptions:{"":{name:"Chinese",epochs:["BEC","EC"],monthNumbers:function(y,p){if(typeof y=="string"){var g=y.match(a);return g?g[0]:""}var h=this._validateYear(y),m=y.month(),u=""+this.toChineseMonth(h,m);return p&&u.length<2&&(u="0"+u),this.isIntercalaryMonth(h,m)&&(u+="i"),u},monthNames:function(y){if(typeof y=="string"){var p=y.match(n);return p?p[0]:""}var g=this._validateYear(y),h=y.month(),m=this.toChineseMonth(g,h),u=["\u4E00\u6708","\u4E8C\u6708","\u4E09\u6708","\u56DB\u6708","\u4E94\u6708","\u516D\u6708","\u4E03\u6708","\u516B\u6708","\u4E5D\u6708","\u5341\u6708","\u5341\u4E00\u6708","\u5341\u4E8C\u6708"][m-1];return this.isIntercalaryMonth(g,h)&&(u="\u95F0"+u),u},monthNamesShort:function(y){if(typeof y=="string"){var p=y.match(r);return p?p[0]:""}var g=this._validateYear(y),h=y.month(),m=this.toChineseMonth(g,h),u=["\u4E00","\u4E8C","\u4E09","\u56DB","\u4E94","\u516D","\u4E03","\u516B","\u4E5D","\u5341","\u5341\u4E00","\u5341\u4E8C"][m-1];return this.isIntercalaryMonth(g,h)&&(u="\u95F0"+u),u},parseMonth:function(y,p){y=this._validateYear(y);var g=parseInt(p),h;if(isNaN(g))p[0]==="\u95F0"&&(h=!0,p=p.substring(1)),p[p.length-1]==="\u6708"&&(p=p.substring(0,p.length-1)),g=1+["\u4E00","\u4E8C","\u4E09","\u56DB","\u4E94","\u516D","\u4E03","\u516B","\u4E5D","\u5341","\u5341\u4E00","\u5341\u4E8C"].indexOf(p);else{var m=p[p.length-1];h=m==="i"||m==="I"}var u=this.toMonthIndex(y,g,h);return u},dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:1,isRTL:!1}},_validateYear:function(y,p){if(y.year&&(y=y.year()),typeof y!="number"||y<1888||y>2111)throw p.replace(/\{0\}/,this.local.name);return y},toMonthIndex:function(y,p,g){var h=this.intercalaryMonth(y),m=g&&p!==h;if(m||p<1||p>12)throw w.local.invalidMonth.replace(/\{0\}/,this.local.name);var u;return h?!g&&p<=h?u=p-1:u=p:u=p-1,u},toChineseMonth:function(y,p){y.year&&(y=y.year(),p=y.month());var g=this.intercalaryMonth(y),h=g?12:11;if(p<0||p>h)throw w.local.invalidMonth.replace(/\{0\}/,this.local.name);var m;return g?p<g?m=p+1:m=p:m=p+1,m},intercalaryMonth:function(y){y=this._validateYear(y);var p=t[y-t[0]],g=p>>13;return g},isIntercalaryMonth:function(y,p){y.year&&(y=y.year(),p=y.month());var g=this.intercalaryMonth(y);return!!g&&g===p},leapYear:function(y){return this.intercalaryMonth(y)!==0},weekOfYear:function(y,p,g){var h=this._validateYear(y,w.local.invalidyear),m=c[h-c[0]],u=m>>9&4095,_=m>>5&15,s=m&31,A;A=S.newDate(u,_,s),A.add(4-(A.dayOfWeek()||7),"d");var b=this.toJD(y,p,g)-A.toJD();return 1+Math.floor(b/7)},monthsInYear:function(y){return this.leapYear(y)?13:12},daysInMonth:function(y,p){y.year&&(p=y.month(),y=y.year()),y=this._validateYear(y);var g=t[y-t[0]],h=g>>13,m=h?12:11;if(p>m)throw w.local.invalidMonth.replace(/\{0\}/,this.local.name);var u=g&1<<12-p?30:29;return u},weekDay:function(y,p,g){return(this.dayOfWeek(y,p,g)||7)<6},toJD:function(y,p,g){var h=this._validate(y,u,g,w.local.invalidDate);y=this._validateYear(h.year()),p=h.month(),g=h.day();var m=this.isIntercalaryMonth(y,p),u=this.toChineseMonth(y,p),_=i(y,u,g,m);return S.toJD(_.year,_.month,_.day)},fromJD:function(y){var p=S.fromJD(y),g=o(p.year(),p.month(),p.day()),h=this.toMonthIndex(g.year,g.month,g.isIntercalary);return this.newDate(g.year,h,g.day)},fromString:function(y){var p=y.match(e),g=this._validateYear(+p[1]),h=+p[2],m=!!p[3],u=this.toMonthIndex(g,h,m),_=+p[4];return this.newDate(g,u,_)},add:function(y,p,g){var h=y.year(),m=y.month(),u=this.isIntercalaryMonth(h,m),_=this.toChineseMonth(h,m),s=Object.getPrototypeOf(M.prototype).add.call(this,y,p,g);if(g==="y"){var A=s.year(),b=s.month(),f=this.isIntercalaryMonth(A,_),x=u&&f?this.toMonthIndex(A,_,!0):this.toMonthIndex(A,_,!1);x!==b&&s.month(x)}return s}});var e=/^\s*(-?\d\d\d\d|\d\d)[-/](\d?\d)([iI]?)[-/](\d?\d)/m,a=/^\d?\d[iI]?/m,n=/^??[]?/m,r=/^??[]?/m;w.calendars.chinese=M;var t=[1887,5780,5802,19157,2742,50359,1198,2646,46378,7466,3412,30122,5482,67949,2396,5294,43597,6732,6954,36181,2772,4954,18781,2396,54427,5274,6730,47781,5800,6868,21210,4790,59703,2350,5270,46667,3402,3496,38325,1388,4782,18735,2350,52374,6804,7498,44457,2906,1388,29294,4700,63789,6442,6804,56138,5802,2772,38235,1210,4698,22827,5418,63125,3476,5802,43701,2484,5302,27223,2646,70954,7466,3412,54698,5482,2412,38062,5294,2636,32038,6954,60245,2772,4826,43357,2394,5274,39501,6730,72357,5800,5844,53978,4790,2358,38039,5270,87627,3402,3496,54708,5484,4782,43311,2350,3222,27978,7498,68965,2904,5484,45677,4700,6444,39573,6804,6986,19285,2772,62811,1210,4698,47403,5418,5780,38570,5546,76469,2420,5302,51799,2646,5414,36501,3412,5546,18869,2412,54446,5276,6732,48422,6822,2900,28010,4826,92509,2394,5274,55883,6730,6820,47956,5812,2778,18779,2358,62615,5270,5450,46757,3492,5556,27318,4718,67887,2350,3222,52554,7498,3428,38252,5468,4700,31022,6444,64149,6804,6986,43861,2772,5338,35421,2650,70955,5418,5780,54954,5546,2740,38074,5302,2646,29991,3366,61011,3412,5546,43445,2412,5294,35406,6732,72998,6820,6996,52586,2778,2396,38045,5274,6698,23333,6820,64338,5812,2746,43355,2358,5270,39499,5450,79525,3492,5548],c=[1887,966732,967231,967733,968265,968766,969297,969798,970298,970829,971330,971830,972362,972863,973395,973896,974397,974928,975428,975929,976461,976962,977462,977994,978494,979026,979526,980026,980558,981059,981559,982091,982593,983124,983624,984124,984656,985157,985656,986189,986690,987191,987722,988222,988753,989254,989754,990286,990788,991288,991819,992319,992851,993352,993851,994383,994885,995385,995917,996418,996918,997450,997949,998481,998982,999483,1000014,1000515,1001016,1001548,1002047,1002578,1003080,1003580,1004111,1004613,1005113,1005645,1006146,1006645,1007177,1007678,1008209,1008710,1009211,1009743,1010243,1010743,1011275,1011775,1012306,1012807,1013308,1013840,1014341,1014841,1015373,1015874,1016404,1016905,1017405,1017937,1018438,1018939,1019471,1019972,1020471,1021002,1021503,1022035,1022535,1023036,1023568,1024069,1024568,1025100,1025601,1026102,1026633,1027133,1027666,1028167,1028666,1029198,1029699,1030199,1030730,1031231,1031763,1032264,1032764,1033296,1033797,1034297,1034828,1035329,1035830,1036362,1036861,1037393,1037894,1038394,1038925,1039427,1039927,1040459,1040959,1041491,1041992,1042492,1043023,1043524,1044024,1044556,1045057,1045558,1046090,1046590,1047121,1047622,1048122,1048654,1049154,1049655,1050187,1050689,1051219,1051720,1052220,1052751,1053252,1053752,1054284,1054786,1055285,1055817,1056317,1056849,1057349,1057850,1058382,1058883,1059383,1059915,1060415,1060947,1061447,1061947,1062479,1062981,1063480,1064012,1064514,1065014,1065545,1066045,1066577,1067078,1067578,1068110,1068611,1069112,1069642,1070142,1070674,1071175,1071675,1072207,1072709,1073209,1073740,1074241,1074741,1075273,1075773,1076305,1076807,1077308,1077839,1078340,1078840,1079372,1079871,1080403,1080904];function o(y,p,g,h){var m,u;if(typeof y=="object")m=y,u=p||{};else{var _=typeof y=="number"&&y>=1888&&y<=2111;if(!_)throw new Error("Solar year outside range 1888-2111");var s=typeof p=="number"&&p>=1&&p<=12;if(!s)throw new Error("Solar month outside range 1 - 12");var A=typeof g=="number"&&g>=1&&g<=31;if(!A)throw new Error("Solar day outside range 1 - 31");m={year:y,month:p,day:g},u=h||{}}var b=c[m.year-c[0]],f=m.year<<9|m.month<<5|m.day;u.year=f>=b?m.year:m.year-1,b=c[u.year-c[0]];var x=b>>9&4095,l=b>>5&15,L=b&31,T,k=new Date(x,l-1,L),P=new Date(m.year,m.month-1,m.day);T=Math.round((P-k)/(24*3600*1e3));var z=t[u.year-t[0]],I;for(I=0;I<13;I++){var D=z&1<<12-I?30:29;if(T<D)break;T-=D}var R=z>>13;return!R||I<R?(u.isIntercalary=!1,u.month=1+I):I===R?(u.isIntercalary=!0,u.month=I):(u.isIntercalary=!1,u.month=I),u.day=1+T,u}function i(y,p,g,h,m){var u,_;if(typeof y=="object")_=y,u=p||{};else{var s=typeof y=="number"&&y>=1888&&y<=2111;if(!s)throw new Error("Lunar year outside range 1888-2111");var A=typeof p=="number"&&p>=1&&p<=12;if(!A)throw new Error("Lunar month outside range 1 - 12");var b=typeof g=="number"&&g>=1&&g<=30;if(!b)throw new Error("Lunar day outside range 1 - 30");var f;typeof h=="object"?(f=!1,u=h):(f=!!h,u=m||{}),_={year:y,month:p,day:g,isIntercalary:f}}var x;x=_.day-1;var l=t[_.year-t[0]],L=l>>13,T;L&&(_.month>L||_.isIntercalary)?T=_.month:T=_.month-1;for(var k=0;k<T;k++){var P=l&1<<12-k?30:29;x+=P}var z=c[_.year-c[0]],I=z>>9&4095,D=z>>5&15,R=z&31,B=new Date(I,D-1,R+x);return u.year=B.getFullYear(),u.month=1+B.getMonth(),u.day=B.getDate(),u}},{"../main":347,"object-assign":247}],334:[function(d,ee,te){var w=d("../main"),v=d("object-assign");function S(M){this.local=this.regionalOptions[M||""]||this.regionalOptions[""]}S.prototype=new w.baseCalendar,v(S.prototype,{name:"Coptic",jdEpoch:18250295e-1,daysPerMonth:[30,30,30,30,30,30,30,30,30,30,30,30,5],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Coptic",epochs:["BAM","AM"],monthNames:["Thout","Paopi","Hathor","Koiak","Tobi","Meshir","Paremhat","Paremoude","Pashons","Paoni","Epip","Mesori","Pi Kogi Enavot"],monthNamesShort:["Tho","Pao","Hath","Koi","Tob","Mesh","Pat","Pad","Pash","Pao","Epi","Meso","PiK"],dayNames:["Tkyriaka","Pesnau","Pshoment","Peftoou","Ptiou","Psoou","Psabbaton"],dayNamesShort:["Tky","Pes","Psh","Pef","Pti","Pso","Psa"],dayNamesMin:["Tk","Pes","Psh","Pef","Pt","Pso","Psa"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(a){var e=this._validate(a,this.minMonth,this.minDay,w.local.invalidYear),a=e.year()+(e.year()<0?1:0);return a%4===3||a%4===-1},monthsInYear:function(M){return this._validate(M,this.minMonth,this.minDay,w.local.invalidYear||w.regionalOptions[""].invalidYear),13},weekOfYear:function(M,e,a){var n=this.newDate(M,e,a);return n.add(-n.dayOfWeek(),"d"),Math.floor((n.dayOfYear()-1)/7)+1},daysInMonth:function(M,e){var a=this._validate(M,e,this.minDay,w.local.invalidMonth);return this.daysPerMonth[a.month()-1]+(a.month()===13&&this.leapYear(a.year())?1:0)},weekDay:function(M,e,a){return(this.dayOfWeek(M,e,a)||7)<6},toJD:function(M,e,a){var n=this._validate(M,e,a,w.local.invalidDate);return M=n.year(),M<0&&M++,n.day()+(n.month()-1)*30+(M-1)*365+Math.floor(M/4)+this.jdEpoch-1},fromJD:function(M){var e=Math.floor(M)+.5-this.jdEpoch,a=Math.floor((e-Math.floor((e+366)/1461))/365)+1;a<=0&&a--,e=Math.floor(M)+.5-this.newDate(a,1,1).toJD();var n=Math.floor(e/30)+1,r=e-(n-1)*30+1;return this.newDate(a,n,r)}}),w.calendars.coptic=S},{"../main":347,"object-assign":247}],335:[function(d,ee,te){var w=d("../main"),v=d("object-assign");function S(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}S.prototype=new w.baseCalendar,v(S.prototype,{name:"Discworld",jdEpoch:17214255e-1,daysPerMonth:[16,32,32,32,32,32,32,32,32,32,32,32,32],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Discworld",epochs:["BUC","UC"],monthNames:["Ick","Offle","February","March","April","May","June","Grune","August","Spune","Sektober","Ember","December"],monthNamesShort:["Ick","Off","Feb","Mar","Apr","May","Jun","Gru","Aug","Spu","Sek","Emb","Dec"],dayNames:["Sunday","Octeday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Oct","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Oc","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:2,isRTL:!1}},leapYear:function(e){return this._validate(e,this.minMonth,this.minDay,w.local.invalidYear),!1},monthsInYear:function(e){return this._validate(e,this.minMonth,this.minDay,w.local.invalidYear),13},daysInYear:function(e){return this._validate(e,this.minMonth,this.minDay,w.local.invalidYear),400},weekOfYear:function(e,a,n){var r=this.newDate(e,a,n);return r.add(-r.dayOfWeek(),"d"),Math.floor((r.dayOfYear()-1)/8)+1},daysInMonth:function(e,a){var n=this._validate(e,a,this.minDay,w.local.invalidMonth);return this.daysPerMonth[n.month()-1]},daysInWeek:function(){return 8},dayOfWeek:function(e,a,n){var r=this._validate(e,a,n,w.local.invalidDate);return(r.day()+1)%8},weekDay:function(e,a,n){var r=this.dayOfWeek(e,a,n);return r>=2&&r<=6},extraInfo:function(e,a,n){var r=this._validate(e,a,n,w.local.invalidDate);return{century:M[Math.floor((r.year()-1)/100)+1]||""}},toJD:function(e,a,n){var r=this._validate(e,a,n,w.local.invalidDate);return e=r.year()+(r.year()<0?1:0),a=r.month(),n=r.day(),n+(a>1?16:0)+(a>2?(a-2)*32:0)+(e-1)*400+this.jdEpoch-1},fromJD:function(e){e=Math.floor(e+.5)-Math.floor(this.jdEpoch)-1;var a=Math.floor(e/400)+1;e-=(a-1)*400,e+=e>15?16:0;var n=Math.floor(e/32)+1,r=e-(n-1)*32+1;return this.newDate(a<=0?a-1:a,n,r)}});var M={20:"Fruitbat",21:"Anchovy"};w.calendars.discworld=S},{"../main":347,"object-assign":247}],336:[function(d,ee,te){var w=d("../main"),v=d("object-assign");function S(M){this.local=this.regionalOptions[M||""]||this.regionalOptions[""]}S.prototype=new w.baseCalendar,v(S.prototype,{name:"Ethiopian",jdEpoch:17242205e-1,daysPerMonth:[30,30,30,30,30,30,30,30,30,30,30,30,5],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Ethiopian",epochs:["BEE","EE"],monthNames:["Meskerem","Tikemet","Hidar","Tahesas","Tir","Yekatit","Megabit","Miazia","Genbot","Sene","Hamle","Nehase","Pagume"],monthNamesShort:["Mes","Tik","Hid","Tah","Tir","Yek","Meg","Mia","Gen","Sen","Ham","Neh","Pag"],dayNames:["Ehud","Segno","Maksegno","Irob","Hamus","Arb","Kidame"],dayNamesShort:["Ehu","Seg","Mak","Iro","Ham","Arb","Kid"],dayNamesMin:["Eh","Se","Ma","Ir","Ha","Ar","Ki"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(a){var e=this._validate(a,this.minMonth,this.minDay,w.local.invalidYear),a=e.year()+(e.year()<0?1:0);return a%4===3||a%4===-1},monthsInYear:function(M){return this._validate(M,this.minMonth,this.minDay,w.local.invalidYear||w.regionalOptions[""].invalidYear),13},weekOfYear:function(M,e,a){var n=this.newDate(M,e,a);return n.add(-n.dayOfWeek(),"d"),Math.floor((n.dayOfYear()-1)/7)+1},daysInMonth:function(M,e){var a=this._validate(M,e,this.minDay,w.local.invalidMonth);return this.daysPerMonth[a.month()-1]+(a.month()===13&&this.leapYear(a.year())?1:0)},weekDay:function(M,e,a){return(this.dayOfWeek(M,e,a)||7)<6},toJD:function(M,e,a){var n=this._validate(M,e,a,w.local.invalidDate);return M=n.year(),M<0&&M++,n.day()+(n.month()-1)*30+(M-1)*365+Math.floor(M/4)+this.jdEpoch-1},fromJD:function(M){var e=Math.floor(M)+.5-this.jdEpoch,a=Math.floor((e-Math.floor((e+366)/1461))/365)+1;a<=0&&a--,e=Math.floor(M)+.5-this.newDate(a,1,1).toJD();var n=Math.floor(e/30)+1,r=e-(n-1)*30+1;return this.newDate(a,n,r)}}),w.calendars.ethiopian=S},{"../main":347,"object-assign":247}],337:[function(d,ee,te){var w=d("../main"),v=d("object-assign");function S(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}S.prototype=new w.baseCalendar,v(S.prototype,{name:"Hebrew",jdEpoch:347995.5,daysPerMonth:[30,29,30,29,30,29,30,29,30,29,30,29,29],hasYearZero:!1,minMonth:1,firstMonth:7,minDay:1,regionalOptions:{"":{name:"Hebrew",epochs:["BAM","AM"],monthNames:["Nisan","Iyar","Sivan","Tammuz","Av","Elul","Tishrei","Cheshvan","Kislev","Tevet","Shevat","Adar","Adar II"],monthNamesShort:["Nis","Iya","Siv","Tam","Av","Elu","Tis","Che","Kis","Tev","She","Ada","Ad2"],dayNames:["Yom Rishon","Yom Sheni","Yom Shlishi","Yom Revi'i","Yom Chamishi","Yom Shishi","Yom Shabbat"],dayNamesShort:["Ris","She","Shl","Rev","Cha","Shi","Sha"],dayNamesMin:["Ri","She","Shl","Re","Ch","Shi","Sha"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(e){var a=this._validate(e,this.minMonth,this.minDay,w.local.invalidYear);return this._leapYear(a.year())},_leapYear:function(e){return e=e<0?e+1:e,M(e*7+1,19)<7},monthsInYear:function(e){return this._validate(e,this.minMonth,this.minDay,w.local.invalidYear),this._leapYear(e.year?e.year():e)?13:12},weekOfYear:function(e,a,n){var r=this.newDate(e,a,n);return r.add(-r.dayOfWeek(),"d"),Math.floor((r.dayOfYear()-1)/7)+1},daysInYear:function(e){var a=this._validate(e,this.minMonth,this.minDay,w.local.invalidYear);return e=a.year(),this.toJD(e===-1?1:e+1,7,1)-this.toJD(e,7,1)},daysInMonth:function(e,a){return e.year&&(a=e.month(),e=e.year()),this._validate(e,a,this.minDay,w.local.invalidMonth),a===12&&this.leapYear(e)||a===8&&M(this.daysInYear(e),10)===5?30:a===9&&M(this.daysInYear(e),10)===3?29:this.daysPerMonth[a-1]},weekDay:function(e,a,n){return this.dayOfWeek(e,a,n)!==6},extraInfo:function(e,a,n){var r=this._validate(e,a,n,w.local.invalidDate);return{yearType:(this.leapYear(r)?"embolismic":"common")+" "+["deficient","regular","complete"][this.daysInYear(r)%10-3]}},toJD:function(e,a,n){var r=this._validate(e,a,n,w.local.invalidDate);e=r.year(),a=r.month(),n=r.day();var t=e<=0?e+1:e,c=this.jdEpoch+this._delay1(t)+this._delay2(t)+n+1;if(a<7){for(var o=7;o<=this.monthsInYear(e);o++)c+=this.daysInMonth(e,o);for(var o=1;o<a;o++)c+=this.daysInMonth(e,o)}else for(var o=7;o<a;o++)c+=this.daysInMonth(e,o);return c},_delay1:function(e){var a=Math.floor((235*e-234)/19),n=12084+13753*a,r=a*29+Math.floor(n/25920);return M(3*(r+1),7)<3&&r++,r},_delay2:function(e){var a=this._delay1(e-1),n=this._delay1(e),r=this._delay1(e+1);return r-n===356?2:n-a===382?1:0},fromJD:function(e){e=Math.floor(e)+.5;for(var a=Math.floor((e-this.jdEpoch)*98496/35975351)-1;e>=this.toJD(a===-1?1:a+1,7,1);)a++;for(var n=e<this.toJD(a,1,1)?7:1;e>this.toJD(a,n,this.daysInMonth(a,n));)n++;var r=e-this.toJD(a,n,1)+1;return this.newDate(a,n,r)}});function M(e,a){return e-a*Math.floor(e/a)}w.calendars.hebrew=S},{"../main":347,"object-assign":247}],338:[function(d,ee,te){var w=d("../main"),v=d("object-assign");function S(M){this.local=this.regionalOptions[M||""]||this.regionalOptions[""]}S.prototype=new w.baseCalendar,v(S.prototype,{name:"Islamic",jdEpoch:19484395e-1,daysPerMonth:[30,29,30,29,30,29,30,29,30,29,30,29],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Islamic",epochs:["BH","AH"],monthNames:["Muharram","Safar","Rabi' al-awwal","Rabi' al-thani","Jumada al-awwal","Jumada al-thani","Rajab","Sha'aban","Ramadan","Shawwal","Dhu al-Qi'dah","Dhu al-Hijjah"],monthNamesShort:["Muh","Saf","Rab1","Rab2","Jum1","Jum2","Raj","Sha'","Ram","Shaw","DhuQ","DhuH"],dayNames:["Yawm al-ahad","Yawm al-ithnayn","Yawm ath-thulaathaa'","Yawm al-arbi'aa'","Yawm al-kham\u012Bs","Yawm al-jum'a","Yawm as-sabt"],dayNamesShort:["Aha","Ith","Thu","Arb","Kha","Jum","Sab"],dayNamesMin:["Ah","It","Th","Ar","Kh","Ju","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:6,isRTL:!1}},leapYear:function(M){var e=this._validate(M,this.minMonth,this.minDay,w.local.invalidYear);return(e.year()*11+14)%30<11},weekOfYear:function(M,e,a){var n=this.newDate(M,e,a);return n.add(-n.dayOfWeek(),"d"),Math.floor((n.dayOfYear()-1)/7)+1},daysInYear:function(M){return this.leapYear(M)?355:354},daysInMonth:function(M,e){var a=this._validate(M,e,this.minDay,w.local.invalidMonth);return this.daysPerMonth[a.month()-1]+(a.month()===12&&this.leapYear(a.year())?1:0)},weekDay:function(M,e,a){return this.dayOfWeek(M,e,a)!==5},toJD:function(M,e,a){var n=this._validate(M,e,a,w.local.invalidDate);return M=n.year(),e=n.month(),a=n.day(),M=M<=0?M+1:M,a+Math.ceil(29.5*(e-1))+(M-1)*354+Math.floor((3+11*M)/30)+this.jdEpoch-1},fromJD:function(M){M=Math.floor(M)+.5;var e=Math.floor((30*(M-this.jdEpoch)+10646)/10631);e=e<=0?e-1:e;var a=Math.min(12,Math.ceil((M-29-this.toJD(e,1,1))/29.5)+1),n=M-this.toJD(e,a,1)+1;return this.newDate(e,a,n)}}),w.calendars.islamic=S},{"../main":347,"object-assign":247}],339:[function(d,ee,te){var w=d("../main"),v=d("object-assign");function S(M){this.local=this.regionalOptions[M||""]||this.regionalOptions[""]}S.prototype=new w.baseCalendar,v(S.prototype,{name:"Julian",jdEpoch:17214235e-1,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Julian",epochs:["BC","AD"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"mm/dd/yyyy",firstDay:0,isRTL:!1}},leapYear:function(a){var e=this._validate(a,this.minMonth,this.minDay,w.local.invalidYear),a=e.year()<0?e.year()+1:e.year();return a%4===0},weekOfYear:function(M,e,a){var n=this.newDate(M,e,a);return n.add(4-(n.dayOfWeek()||7),"d"),Math.floor((n.dayOfYear()-1)/7)+1},daysInMonth:function(M,e){var a=this._validate(M,e,this.minDay,w.local.invalidMonth);return this.daysPerMonth[a.month()-1]+(a.month()===2&&this.leapYear(a.year())?1:0)},weekDay:function(M,e,a){return(this.dayOfWeek(M,e,a)||7)<6},toJD:function(M,e,a){var n=this._validate(M,e,a,w.local.invalidDate);return M=n.year(),e=n.month(),a=n.day(),M<0&&M++,e<=2&&(M--,e+=12),Math.floor(365.25*(M+4716))+Math.floor(30.6001*(e+1))+a-1524.5},fromJD:function(M){var e=Math.floor(M+.5),a=e+1524,n=Math.floor((a-122.1)/365.25),r=Math.floor(365.25*n),t=Math.floor((a-r)/30.6001),c=t-Math.floor(t<14?1:13),o=n-Math.floor(c>2?4716:4715),i=a-r-Math.floor(30.6001*t);return o<=0&&o--,this.newDate(o,c,i)}}),w.calendars.julian=S},{"../main":347,"object-assign":247}],340:[function(d,ee,te){var w=d("../main"),v=d("object-assign");function S(a){this.local=this.regionalOptions[a||""]||this.regionalOptions[""]}S.prototype=new w.baseCalendar,v(S.prototype,{name:"Mayan",jdEpoch:584282.5,hasYearZero:!0,minMonth:0,firstMonth:0,minDay:0,regionalOptions:{"":{name:"Mayan",epochs:["",""],monthNames:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17"],monthNamesShort:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17"],dayNames:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19"],dayNamesShort:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19"],dayNamesMin:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19"],digits:null,dateFormat:"YYYY.m.d",firstDay:0,isRTL:!1,haabMonths:["Pop","Uo","Zip","Zotz","Tzec","Xul","Yaxkin","Mol","Chen","Yax","Zac","Ceh","Mac","Kankin","Muan","Pax","Kayab","Cumku","Uayeb"],tzolkinMonths:["Imix","Ik","Akbal","Kan","Chicchan","Cimi","Manik","Lamat","Muluc","Oc","Chuen","Eb","Ben","Ix","Men","Cib","Caban","Etznab","Cauac","Ahau"]}},leapYear:function(a){return this._validate(a,this.minMonth,this.minDay,w.local.invalidYear),!1},formatYear:function(a){var n=this._validate(a,this.minMonth,this.minDay,w.local.invalidYear);a=n.year();var r=Math.floor(a/400);a=a%400,a+=a<0?400:0;var t=Math.floor(a/20);return r+"."+t+"."+a%20},forYear:function(a){if(a=a.split("."),a.length<3)throw"Invalid Mayan year";for(var n=0,r=0;r<a.length;r++){var t=parseInt(a[r],10);if(Math.abs(t)>19||r>0&&t<0)throw"Invalid Mayan year";n=n*20+t}return n},monthsInYear:function(a){return this._validate(a,this.minMonth,this.minDay,w.local.invalidYear),18},weekOfYear:function(a,n,r){return this._validate(a,n,r,w.local.invalidDate),0},daysInYear:function(a){return this._validate(a,this.minMonth,this.minDay,w.local.invalidYear),360},daysInMonth:function(a,n){return this._validate(a,n,this.minDay,w.local.invalidMonth),20},daysInWeek:function(){return 5},dayOfWeek:function(a,n,r){var t=this._validate(a,n,r,w.local.invalidDate);return t.day()},weekDay:function(a,n,r){return this._validate(a,n,r,w.local.invalidDate),!0},extraInfo:function(a,n,r){var t=this._validate(a,n,r,w.local.invalidDate),c=t.toJD(),o=this._toHaab(c),i=this._toTzolkin(c);return{haabMonthName:this.local.haabMonths[o[0]-1],haabMonth:o[0],haabDay:o[1],tzolkinDayName:this.local.tzolkinMonths[i[0]-1],tzolkinDay:i[0],tzolkinTrecena:i[1]}},_toHaab:function(a){a-=this.jdEpoch;var n=M(a+8+(18-1)*20,365);return[Math.floor(n/20)+1,M(n,20)]},_toTzolkin:function(a){return a-=this.jdEpoch,[e(a+20,20),e(a+4,13)]},toJD:function(a,n,r){var t=this._validate(a,n,r,w.local.invalidDate);return t.day()+t.month()*20+t.year()*360+this.jdEpoch},fromJD:function(a){a=Math.floor(a)+.5-this.jdEpoch;var n=Math.floor(a/360);a=a%360,a+=a<0?360:0;var r=Math.floor(a/20),t=a%20;return this.newDate(n,r,t)}});function M(a,n){return a-n*Math.floor(a/n)}function e(a,n){return M(a-1,n)+1}w.calendars.mayan=S},{"../main":347,"object-assign":247}],341:[function(d,ee,te){var w=d("../main"),v=d("object-assign");function S(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}S.prototype=new w.baseCalendar;var M=w.instance("gregorian");v(S.prototype,{name:"Nanakshahi",jdEpoch:22576735e-1,daysPerMonth:[31,31,31,31,31,30,30,30,30,30,30,30],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Nanakshahi",epochs:["BN","AN"],monthNames:["Chet","Vaisakh","Jeth","Harh","Sawan","Bhadon","Assu","Katak","Maghar","Poh","Magh","Phagun"],monthNamesShort:["Che","Vai","Jet","Har","Saw","Bha","Ass","Kat","Mgr","Poh","Mgh","Pha"],dayNames:["Somvaar","Mangalvar","Budhvaar","Veervaar","Shukarvaar","Sanicharvaar","Etvaar"],dayNamesShort:["Som","Mangal","Budh","Veer","Shukar","Sanichar","Et"],dayNamesMin:["So","Ma","Bu","Ve","Sh","Sa","Et"],digits:null,dateFormat:"dd-mm-yyyy",firstDay:0,isRTL:!1}},leapYear:function(e){var a=this._validate(e,this.minMonth,this.minDay,w.local.invalidYear||w.regionalOptions[""].invalidYear);return M.leapYear(a.year()+(a.year()<1?1:0)+1469)},weekOfYear:function(e,a,n){var r=this.newDate(e,a,n);return r.add(1-(r.dayOfWeek()||7),"d"),Math.floor((r.dayOfYear()-1)/7)+1},daysInMonth:function(e,a){var n=this._validate(e,a,this.minDay,w.local.invalidMonth);return this.daysPerMonth[n.month()-1]+(n.month()===12&&this.leapYear(n.year())?1:0)},weekDay:function(e,a,n){return(this.dayOfWeek(e,a,n)||7)<6},toJD:function(t,a,n){var r=this._validate(t,a,n,w.local.invalidMonth),t=r.year();t<0&&t++;for(var c=r.day(),o=1;o<r.month();o++)c+=this.daysPerMonth[o-1];return c+M.toJD(t+1468,3,13)},fromJD:function(e){e=Math.floor(e+.5);for(var a=Math.floor((e-(this.jdEpoch-1))/366);e>=this.toJD(a+1,1,1);)a++;for(var n=e-Math.floor(this.toJD(a,1,1)+.5)+1,r=1;n>this.daysInMonth(a,r);)n-=this.daysInMonth(a,r),r++;return this.newDate(a,r,n)}}),w.calendars.nanakshahi=S},{"../main":347,"object-assign":247}],342:[function(d,ee,te){var w=d("../main"),v=d("object-assign");function S(M){this.local=this.regionalOptions[M||""]||this.regionalOptions[""]}S.prototype=new w.baseCalendar,v(S.prototype,{name:"Nepali",jdEpoch:17007095e-1,daysPerMonth:[31,31,32,32,31,30,30,29,30,29,30,30],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,daysPerYear:365,regionalOptions:{"":{name:"Nepali",epochs:["BBS","ABS"],monthNames:["Baisakh","Jestha","Ashadh","Shrawan","Bhadra","Ashwin","Kartik","Mangsir","Paush","Mangh","Falgun","Chaitra"],monthNamesShort:["Bai","Je","As","Shra","Bha","Ash","Kar","Mang","Pau","Ma","Fal","Chai"],dayNames:["Aaitabaar","Sombaar","Manglbaar","Budhabaar","Bihibaar","Shukrabaar","Shanibaar"],dayNamesShort:["Aaita","Som","Mangl","Budha","Bihi","Shukra","Shani"],dayNamesMin:["Aai","So","Man","Bu","Bi","Shu","Sha"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:1,isRTL:!1}},leapYear:function(M){return this.daysInYear(M)!==this.daysPerYear},weekOfYear:function(M,e,a){var n=this.newDate(M,e,a);return n.add(-n.dayOfWeek(),"d"),Math.floor((n.dayOfYear()-1)/7)+1},daysInYear:function(M){var e=this._validate(M,this.minMonth,this.minDay,w.local.invalidYear);if(M=e.year(),typeof this.NEPALI_CALENDAR_DATA[M]>"u")return this.daysPerYear;for(var a=0,n=this.minMonth;n<=12;n++)a+=this.NEPALI_CALENDAR_DATA[M][n];return a},daysInMonth:function(M,e){return M.year&&(e=M.month(),M=M.year()),this._validate(M,e,this.minDay,w.local.invalidMonth),typeof this.NEPALI_CALENDAR_DATA[M]>"u"?this.daysPerMonth[e-1]:this.NEPALI_CALENDAR_DATA[M][e]},weekDay:function(M,e,a){return this.dayOfWeek(M,e,a)!==6},toJD:function(M,e,a){var n=this._validate(M,e,a,w.local.invalidDate);M=n.year(),e=n.month(),a=n.day();var r=w.instance(),t=0,c=e,o=M;this._createMissingCalendarData(M);var i=M-(c>9||c===9&&a>=this.NEPALI_CALENDAR_DATA[o][0]?56:57);for(e!==9&&(t=a,c--);c!==9;)c<=0&&(c=12,o--),t+=this.NEPALI_CALENDAR_DATA[o][c],c--;return e===9?(t+=a-this.NEPALI_CALENDAR_DATA[o][0],t<0&&(t+=r.daysInYear(i))):t+=this.NEPALI_CALENDAR_DATA[o][9]-this.NEPALI_CALENDAR_DATA[o][0],r.newDate(i,1,1).add(t,"d").toJD()},fromJD:function(M){var e=w.instance(),a=e.fromJD(M),n=a.year(),r=a.dayOfYear(),t=n+56;this._createMissingCalendarData(t);for(var c=9,o=this.NEPALI_CALENDAR_DATA[t][0],i=this.NEPALI_CALENDAR_DATA[t][c]-o+1;r>i;)c++,c>12&&(c=1,t++),i+=this.NEPALI_CALENDAR_DATA[t][c];var y=this.NEPALI_CALENDAR_DATA[t][c]-(i-r);return this.newDate(t,c,y)},_createMissingCalendarData:function(M){var e=this.daysPerMonth.slice(0);e.unshift(17);for(var a=M-1;a<M+2;a++)typeof this.NEPALI_CALENDAR_DATA[a]>"u"&&(this.NEPALI_CALENDAR_DATA[a]=e)},NEPALI_CALENDAR_DATA:{1970:[18,31,31,32,31,31,31,30,29,30,29,30,30],1971:[18,31,31,32,31,32,30,30,29,30,29,30,30],1972:[17,31,32,31,32,31,30,30,30,29,29,30,30],1973:[19,30,32,31,32,31,30,30,30,29,30,29,31],1974:[19,31,31,32,30,31,31,30,29,30,29,30,30],1975:[18,31,31,32,32,30,31,30,29,30,29,30,30],1976:[17,31,32,31,32,31,30,30,30,29,29,30,31],1977:[18,31,32,31,32,31,31,29,30,29,30,29,31],1978:[18,31,31,32,31,31,31,30,29,30,29,30,30],1979:[18,31,31,32,32,31,30,30,29,30,29,30,30],1980:[17,31,32,31,32,31,30,30,30,29,29,30,31],1981:[18,31,31,31,32,31,31,29,30,30,29,30,30],1982:[18,31,31,32,31,31,31,30,29,30,29,30,30],1983:[18,31,31,32,32,31,30,30,29,30,29,30,30],1984:[17,31,32,31,32,31,30,30,30,29,29,30,31],1985:[18,31,31,31,32,31,31,29,30,30,29,30,30],1986:[18,31,31,32,31,31,31,30,29,30,29,30,30],1987:[18,31,32,31,32,31,30,30,29,30,29,30,30],1988:[17,31,32,31,32,31,30,30,30,29,29,30,31],1989:[18,31,31,31,32,31,31,30,29,30,29,30,30],1990:[18,31,31,32,31,31,31,30,29,30,29,30,30],1991:[18,31,32,31,32,31,30,30,29,30,29,30,30],1992:[17,31,32,31,32,31,30,30,30,29,30,29,31],1993:[18,31,31,31,32,31,31,30,29,30,29,30,30],1994:[18,31,31,32,31,31,31,30,29,30,29,30,30],1995:[17,31,32,31,32,31,30,30,30,29,29,30,30],1996:[17,31,32,31,32,31,30,30,30,29,30,29,31],1997:[18,31,31,32,31,31,31,30,29,30,29,30,30],1998:[18,31,31,32,31,31,31,30,29,30,29,30,30],1999:[17,31,32,31,32,31,30,30,30,29,29,30,31],2e3:[17,30,32,31,32,31,30,30,30,29,30,29,31],2001:[18,31,31,32,31,31,31,30,29,30,29,30,30],2002:[18,31,31,32,32,31,30,30,29,30,29,30,30],2003:[17,31,32,31,32,31,30,30,30,29,29,30,31],2004:[17,30,32,31,32,31,30,30,30,29,30,29,31],2005:[18,31,31,32,31,31,31,30,29,30,29,30,30],2006:[18,31,31,32,32,31,30,30,29,30,29,30,30],2007:[17,31,32,31,32,31,30,30,30,29,29,30,31],2008:[17,31,31,31,32,31,31,29,30,30,29,29,31],2009:[18,31,31,32,31,31,31,30,29,30,29,30,30],2010:[18,31,31,32,32,31,30,30,29,30,29,30,30],2011:[17,31,32,31,32,31,30,30,30,29,29,30,31],2012:[17,31,31,31,32,31,31,29,30,30,29,30,30],2013:[18,31,31,32,31,31,31,30,29,30,29,30,30],2014:[18,31,31,32,32,31,30,30,29,30,29,30,30],2015:[17,31,32,31,32,31,30,30,30,29,29,30,31],2016:[17,31,31,31,32,31,31,29,30,30,29,30,30],2017:[18,31,31,32,31,31,31,30,29,30,29,30,30],2018:[18,31,32,31,32,31,30,30,29,30,29,30,30],2019:[17,31,32,31,32,31,30,30,30,29,30,29,31],2020:[17,31,31,31,32,31,31,30,29,30,29,30,30],2021:[18,31,31,32,31,31,31,30,29,30,29,30,30],2022:[17,31,32,31,32,31,30,30,30,29,29,30,30],2023:[17,31,32,31,32,31,30,30,30,29,30,29,31],2024:[17,31,31,31,32,31,31,30,29,30,29,30,30],2025:[18,31,31,32,31,31,31,30,29,30,29,30,30],2026:[17,31,32,31,32,31,30,30,30,29,29,30,31],2027:[17,30,32,31,32,31,30,30,30,29,30,29,31],2028:[17,31,31,32,31,31,31,30,29,30,29,30,30],2029:[18,31,31,32,31,32,30,30,29,30,29,30,30],2030:[17,31,32,31,32,31,30,30,30,30,30,30,31],2031:[17,31,32,31,32,31,31,31,31,31,31,31,31],2032:[17,32,32,32,32,32,32,32,32,32,32,32,32],2033:[18,31,31,32,32,31,30,30,29,30,29,30,30],2034:[17,31,32,31,32,31,30,30,30,29,29,30,31],2035:[17,30,32,31,32,31,31,29,30,30,29,29,31],2036:[17,31,31,32,31,31,31,30,29,30,29,30,30],2037:[18,31,31,32,32,31,30,30,29,30,29,30,30],2038:[17,31,32,31,32,31,30,30,30,29,29,30,31],2039:[17,31,31,31,32,31,31,29,30,30,29,30,30],2040:[17,31,31,32,31,31,31,30,29,30,29,30,30],2041:[18,31,31,32,32,31,30,30,29,30,29,30,30],2042:[17,31,32,31,32,31,30,30,30,29,29,30,31],2043:[17,31,31,31,32,31,31,29,30,30,29,30,30],2044:[17,31,31,32,31,31,31,30,29,30,29,30,30],2045:[18,31,32,31,32,31,30,30,29,30,29,30,30],2046:[17,31,32,31,32,31,30,30,30,29,29,30,31],2047:[17,31,31,31,32,31,31,30,29,30,29,30,30],2048:[17,31,31,32,31,31,31,30,29,30,29,30,30],2049:[17,31,32,31,32,31,30,30,30,29,29,30,30],2050:[17,31,32,31,32,31,30,30,30,29,30,29,31],2051:[17,31,31,31,32,31,31,30,29,30,29,30,30],2052:[17,31,31,32,31,31,31,30,29,30,29,30,30],2053:[17,31,32,31,32,31,30,30,30,29,29,30,30],2054:[17,31,32,31,32,31,30,30,30,29,30,29,31],2055:[17,31,31,32,31,31,31,30,29,30,30,29,30],2056:[17,31,31,32,31,32,30,30,29,30,29,30,30],2057:[17,31,32,31,32,31,30,30,30,29,29,30,31],2058:[17,30,32,31,32,31,30,30,30,29,30,29,31],2059:[17,31,31,32,31,31,31,30,29,30,29,30,30],2060:[17,31,31,32,32,31,30,30,29,30,29,30,30],2061:[17,31,32,31,32,31,30,30,30,29,29,30,31],2062:[17,30,32,31,32,31,31,29,30,29,30,29,31],2063:[17,31,31,32,31,31,31,30,29,30,29,30,30],2064:[17,31,31,32,32,31,30,30,29,30,29,30,30],2065:[17,31,32,31,32,31,30,30,30,29,29,30,31],2066:[17,31,31,31,32,31,31,29,30,30,29,29,31],2067:[17,31,31,32,31,31,31,30,29,30,29,30,30],2068:[17,31,31,32,32,31,30,30,29,30,29,30,30],2069:[17,31,32,31,32,31,30,30,30,29,29,30,31],2070:[17,31,31,31,32,31,31,29,30,30,29,30,30],2071:[17,31,31,32,31,31,31,30,29,30,29,30,30],2072:[17,31,32,31,32,31,30,30,29,30,29,30,30],2073:[17,31,32,31,32,31,30,30,30,29,29,30,31],2074:[17,31,31,31,32,31,31,30,29,30,29,30,30],2075:[17,31,31,32,31,31,31,30,29,30,29,30,30],2076:[16,31,32,31,32,31,30,30,30,29,29,30,30],2077:[17,31,32,31,32,31,30,30,30,29,30,29,31],2078:[17,31,31,31,32,31,31,30,29,30,29,30,30],2079:[17,31,31,32,31,31,31,30,29,30,29,30,30],2080:[16,31,32,31,32,31,30,30,30,29,29,30,30],2081:[17,31,31,32,32,31,30,30,30,29,30,30,30],2082:[17,31,32,31,32,31,30,30,30,29,30,30,30],2083:[17,31,31,32,31,31,30,30,30,29,30,30,30],2084:[17,31,31,32,31,31,30,30,30,29,30,30,30],2085:[17,31,32,31,32,31,31,30,30,29,30,30,30],2086:[17,31,32,31,32,31,30,30,30,29,30,30,30],2087:[16,31,31,32,31,31,31,30,30,29,30,30,30],2088:[16,30,31,32,32,30,31,30,30,29,30,30,30],2089:[17,31,32,31,32,31,30,30,30,29,30,30,30],2090:[17,31,32,31,32,31,30,30,30,29,30,30,30],2091:[16,31,31,32,31,31,31,30,30,29,30,30,30],2092:[16,31,31,32,32,31,30,30,30,29,30,30,30],2093:[17,31,32,31,32,31,30,30,30,29,30,30,30],2094:[17,31,31,32,31,31,30,30,30,29,30,30,30],2095:[17,31,31,32,31,31,31,30,29,30,30,30,30],2096:[17,30,31,32,32,31,30,30,29,30,29,30,30],2097:[17,31,32,31,32,31,30,30,30,29,30,30,30],2098:[17,31,31,32,31,31,31,29,30,29,30,30,31],2099:[17,31,31,32,31,31,31,30,29,29,30,30,30],2100:[17,31,32,31,32,30,31,30,29,30,29,30,30]}}),w.calendars.nepali=S},{"../main":347,"object-assign":247}],343:[function(d,ee,te){var w=d("../main"),v=d("object-assign");function S(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}S.prototype=new w.baseCalendar,v(S.prototype,{name:"Persian",jdEpoch:19483205e-1,daysPerMonth:[31,31,31,31,31,31,30,30,30,30,30,29],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Persian",epochs:["BP","AP"],monthNames:["Farvardin","Ordibehesht","Khordad","Tir","Mordad","Shahrivar","Mehr","Aban","Azar","Day","Bahman","Esfand"],monthNamesShort:["Far","Ord","Kho","Tir","Mor","Sha","Meh","Aba","Aza","Day","Bah","Esf"],dayNames:["Yekshambe","Doshambe","Seshambe","Ch\xE6harshambe","Panjshambe","Jom'e","Shambe"],dayNamesShort:["Yek","Do","Se","Ch\xE6","Panj","Jom","Sha"],dayNamesMin:["Ye","Do","Se","Ch","Pa","Jo","Sh"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:6,isRTL:!1}},leapYear:function(e){var a=this._validate(e,this.minMonth,this.minDay,w.local.invalidYear);return((a.year()-(a.year()>0?474:473))%2820+474+38)*682%2816<682},weekOfYear:function(e,a,n){var r=this.newDate(e,a,n);return r.add(-((r.dayOfWeek()+1)%7),"d"),Math.floor((r.dayOfYear()-1)/7)+1},daysInMonth:function(e,a){var n=this._validate(e,a,this.minDay,w.local.invalidMonth);return this.daysPerMonth[n.month()-1]+(n.month()===12&&this.leapYear(n.year())?1:0)},weekDay:function(e,a,n){return this.dayOfWeek(e,a,n)!==5},toJD:function(e,a,n){var r=this._validate(e,a,n,w.local.invalidDate);e=r.year(),a=r.month(),n=r.day();var t=e-(e>=0?474:473),c=474+M(t,2820);return n+(a<=7?(a-1)*31:(a-1)*30+6)+Math.floor((c*682-110)/2816)+(c-1)*365+Math.floor(t/2820)*1029983+this.jdEpoch-1},fromJD:function(e){e=Math.floor(e)+.5;var a=e-this.toJD(475,1,1),n=Math.floor(a/1029983),r=M(a,1029983),t=2820;if(r!==1029982){var c=Math.floor(r/366),o=M(r,366);t=Math.floor((2134*c+2816*o+2815)/1028522)+c+1}var i=t+2820*n+474;i=i<=0?i-1:i;var y=e-this.toJD(i,1,1)+1,p=y<=186?Math.ceil(y/31):Math.ceil((y-6)/30),g=e-this.toJD(i,p,1)+1;return this.newDate(i,p,g)}});function M(e,a){return e-a*Math.floor(e/a)}w.calendars.persian=S,w.calendars.jalali=S},{"../main":347,"object-assign":247}],344:[function(d,ee,te){var w=d("../main"),v=d("object-assign"),S=w.instance();function M(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}M.prototype=new w.baseCalendar,v(M.prototype,{name:"Taiwan",jdEpoch:24194025e-1,yearsOffset:1911,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Taiwan",epochs:["BROC","ROC"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:1,isRTL:!1}},leapYear:function(n){var a=this._validate(n,this.minMonth,this.minDay,w.local.invalidYear),n=this._t2gYear(a.year());return S.leapYear(n)},weekOfYear:function(t,a,n){var r=this._validate(t,this.minMonth,this.minDay,w.local.invalidYear),t=this._t2gYear(r.year());return S.weekOfYear(t,r.month(),r.day())},daysInMonth:function(e,a){var n=this._validate(e,a,this.minDay,w.local.invalidMonth);return this.daysPerMonth[n.month()-1]+(n.month()===2&&this.leapYear(n.year())?1:0)},weekDay:function(e,a,n){return(this.dayOfWeek(e,a,n)||7)<6},toJD:function(t,a,n){var r=this._validate(t,a,n,w.local.invalidDate),t=this._t2gYear(r.year());return S.toJD(t,r.month(),r.day())},fromJD:function(e){var a=S.fromJD(e),n=this._g2tYear(a.year());return this.newDate(n,a.month(),a.day())},_t2gYear:function(e){return e+this.yearsOffset+(e>=-this.yearsOffset&&e<=-1?1:0)},_g2tYear:function(e){return e-this.yearsOffset-(e>=1&&e<=this.yearsOffset?1:0)}}),w.calendars.taiwan=M},{"../main":347,"object-assign":247}],345:[function(d,ee,te){var w=d("../main"),v=d("object-assign"),S=w.instance();function M(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}M.prototype=new w.baseCalendar,v(M.prototype,{name:"Thai",jdEpoch:15230985e-1,yearsOffset:543,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Thai",epochs:["BBE","BE"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(n){var a=this._validate(n,this.minMonth,this.minDay,w.local.invalidYear),n=this._t2gYear(a.year());return S.leapYear(n)},weekOfYear:function(t,a,n){var r=this._validate(t,this.minMonth,this.minDay,w.local.invalidYear),t=this._t2gYear(r.year());return S.weekOfYear(t,r.month(),r.day())},daysInMonth:function(e,a){var n=this._validate(e,a,this.minDay,w.local.invalidMonth);return this.daysPerMonth[n.month()-1]+(n.month()===2&&this.leapYear(n.year())?1:0)},weekDay:function(e,a,n){return(this.dayOfWeek(e,a,n)||7)<6},toJD:function(t,a,n){var r=this._validate(t,a,n,w.local.invalidDate),t=this._t2gYear(r.year());return S.toJD(t,r.month(),r.day())},fromJD:function(e){var a=S.fromJD(e),n=this._g2tYear(a.year());return this.newDate(n,a.month(),a.day())},_t2gYear:function(e){return e-this.yearsOffset-(e>=1&&e<=this.yearsOffset?1:0)},_g2tYear:function(e){return e+this.yearsOffset+(e>=-this.yearsOffset&&e<=-1?1:0)}}),w.calendars.thai=M},{"../main":347,"object-assign":247}],346:[function(d,ee,te){var w=d("../main"),v=d("object-assign");function S(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}S.prototype=new w.baseCalendar,v(S.prototype,{name:"UmmAlQura",hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Umm al-Qura",epochs:["BH","AH"],monthNames:["Al-Muharram","Safar","Rabi' al-awwal","Rabi' Al-Thani","Jumada Al-Awwal","Jumada Al-Thani","Rajab","Sha'aban","Ramadan","Shawwal","Dhu al-Qi'dah","Dhu al-Hijjah"],monthNamesShort:["Muh","Saf","Rab1","Rab2","Jum1","Jum2","Raj","Sha'","Ram","Shaw","DhuQ","DhuH"],dayNames:["Yawm al-Ahad","Yawm al-Ithnain","Yawm al-Thal\u0101th\u0101\u2019","Yawm al-Arba\u2018\u0101\u2019","Yawm al-Kham\u012Bs","Yawm al-Jum\u2018a","Yawm al-Sabt"],dayNamesMin:["Ah","Ith","Th","Ar","Kh","Ju","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:6,isRTL:!0}},leapYear:function(e){var a=this._validate(e,this.minMonth,this.minDay,w.local.invalidYear);return this.daysInYear(a.year())===355},weekOfYear:function(e,a,n){var r=this.newDate(e,a,n);return r.add(-r.dayOfWeek(),"d"),Math.floor((r.dayOfYear()-1)/7)+1},daysInYear:function(e){for(var a=0,n=1;n<=12;n++)a+=this.daysInMonth(e,n);return a},daysInMonth:function(e,a){for(var n=this._validate(e,a,this.minDay,w.local.invalidMonth),r=n.toJD()-24e5+.5,t=0,c=0;c<M.length;c++){if(M[c]>r)return M[t]-M[t-1];t++}return 30},weekDay:function(e,a,n){return this.dayOfWeek(e,a,n)!==5},toJD:function(e,a,n){var r=this._validate(e,a,n,w.local.invalidDate),t=12*(r.year()-1)+r.month()-15292,c=r.day()+M[t-1]-1;return c+24e5-.5},fromJD:function(e){for(var a=e-24e5+.5,n=0,r=0;r<M.length&&!(M[r]>a);r++)n++;var t=n+15292,c=Math.floor((t-1)/12),o=c+1,i=t-12*c,y=a-M[n-1]+1;return this.newDate(o,i,y)},isValid:function(e,a,n){var r=w.baseCalendar.prototype.isValid.apply(this,arguments);return r&&(e=e.year!=null?e.year:e,r=e>=1276&&e<=1500),r},_validate:function(e,a,n,r){var t=w.baseCalendar.prototype._validate.apply(this,arguments);if(t.year<1276||t.year>1500)throw r.replace(/\{0\}/,this.local.name);return t}}),w.calendars.ummalqura=S;var M=[20,50,79,109,138,168,197,227,256,286,315,345,374,404,433,463,492,522,551,581,611,641,670,700,729,759,788,818,847,877,906,936,965,995,1024,1054,1083,1113,1142,1172,1201,1231,1260,1290,1320,1350,1379,1409,1438,1468,1497,1527,1556,1586,1615,1645,1674,1704,1733,1763,1792,1822,1851,1881,1910,1940,1969,1999,2028,2058,2087,2117,2146,2176,2205,2235,2264,2294,2323,2353,2383,2413,2442,2472,2501,2531,2560,2590,2619,2649,2678,2708,2737,2767,2796,2826,2855,2885,2914,2944,2973,3003,3032,3062,3091,3121,3150,3180,3209,3239,3268,3298,3327,3357,3386,3416,3446,3476,3505,3535,3564,3594,3623,3653,3682,3712,3741,3771,3800,3830,3859,3889,3918,3948,3977,4007,4036,4066,4095,4125,4155,4185,4214,4244,4273,4303,4332,4362,4391,4421,4450,4480,4509,4539,4568,4598,4627,4657,4686,4716,4745,4775,4804,4834,4863,4893,4922,4952,4981,5011,5040,5070,5099,5129,5158,5188,5218,5248,5277,5307,5336,5366,5395,5425,5454,5484,5513,5543,5572,5602,5631,5661,5690,5720,5749,5779,5808,5838,5867,5897,5926,5956,5985,6015,6044,6074,6103,6133,6162,6192,6221,6251,6281,6311,6340,6370,6399,6429,6458,6488,6517,6547,6576,6606,6635,6665,6694,6724,6753,6783,6812,6842,6871,6901,6930,6960,6989,7019,7048,7078,7107,7137,7166,7196,7225,7255,7284,7314,7344,7374,7403,7433,7462,7492,7521,7551,7580,7610,7639,7669,7698,7728,7757,7787,7816,7846,7875,7905,7934,7964,7993,8023,8053,8083,8112,8142,8171,8201,8230,8260,8289,8319,8348,8378,8407,8437,8466,8496,8525,8555,8584,8614,8643,8673,8702,8732,8761,8791,8821,8850,8880,8909,8938,8968,8997,9027,9056,9086,9115,9145,9175,9205,9234,9264,9293,9322,9352,9381,9410,9440,9470,9499,9529,9559,9589,9618,9648,9677,9706,9736,9765,9794,9824,9853,9883,9913,9943,9972,10002,10032,10061,10090,10120,10149,10178,10208,10237,10267,10297,10326,10356,10386,10415,10445,10474,10504,10533,10562,10592,10621,10651,10680,10710,10740,10770,10799,10829,10858,10888,10917,10947,10976,11005,11035,11064,11094,11124,11153,11183,11213,11242,11272,11301,11331,11360,11389,11419,11448,11478,11507,11537,11567,11596,11626,11655,11685,11715,11744,11774,11803,11832,11862,11891,11921,11950,11980,12010,12039,12069,12099,12128,12158,12187,12216,12246,12275,12304,12334,12364,12393,12423,12453,12483,12512,12542,12571,12600,12630,12659,12688,12718,12747,12777,12807,12837,12866,12896,12926,12955,12984,13014,13043,13072,13102,13131,13161,13191,13220,13250,13280,13310,13339,13368,13398,13427,13456,13486,13515,13545,13574,13604,13634,13664,13693,13723,13752,13782,13811,13840,13870,13899,13929,13958,13988,14018,14047,14077,14107,14136,14166,14195,14224,14254,14283,14313,14342,14372,14401,14431,14461,14490,14520,14550,14579,14609,14638,14667,14697,14726,14756,14785,14815,14844,14874,14904,14933,14963,14993,15021,15051,15081,15110,15140,15169,15199,15228,15258,15287,15317,15347,15377,15406,15436,15465,15494,15524,15553,15582,15612,15641,15671,15701,15731,15760,15790,15820,15849,15878,15908,15937,15966,15996,16025,16055,16085,16114,16144,16174,16204,16233,16262,16292,16321,16350,16380,16409,16439,16468,16498,16528,16558,16587,16617,16646,16676,16705,16734,16764,16793,16823,16852,16882,16912,16941,16971,17001,17030,17060,17089,17118,17148,17177,17207,17236,17266,17295,17325,17355,17384,17414,17444,17473,17502,17532,17561,17591,17620,17650,17679,17709,17738,17768,17798,17827,17857,17886,17916,17945,17975,18004,18034,18063,18093,18122,18152,18181,18211,18241,18270,18300,18330,18359,18388,18418,18447,18476,18506,18535,18565,18595,18625,18654,18684,18714,18743,18772,18802,18831,18860,18890,18919,18949,18979,19008,19038,19068,19098,19127,19156,19186,19215,19244,19274,19303,19333,19362,19392,19422,19452,19481,19511,19540,19570,19599,19628,19658,19687,19717,19746,19776,19806,19836,19865,19895,19924,19954,19983,20012,20042,20071,20101,20130,20160,20190,20219,20249,20279,20308,20338,20367,20396,20426,20455,20485,20514,20544,20573,20603,20633,20662,20692,20721,20751,20780,20810,20839,20869,20898,20928,20957,20987,21016,21046,21076,21105,21135,21164,21194,21223,21253,21282,21312,21341,21371,21400,21430,21459,21489,21519,21548,21578,21607,21637,21666,21696,21725,21754,21784,21813,21843,21873,21902,21932,21962,21991,22021,22050,22080,22109,22138,22168,22197,22227,22256,22286,22316,22346,22375,22405,22434,22464,22493,22522,22552,22581,22611,22640,22670,22700,22730,22759,22789,22818,22848,22877,22906,22936,22965,22994,23024,23054,23083,23113,23143,23173,23202,23232,23261,23290,23320,23349,23379,23408,23438,23467,23497,23527,23556,23586,23616,23645,23674,23704,23733,23763,23792,23822,23851,23881,23910,23940,23970,23999,24029,24058,24088,24117,24147,24176,24206,24235,24265,24294,24324,24353,24383,24413,24442,24472,24501,24531,24560,24590,24619,24648,24678,24707,24737,24767,24796,24826,24856,24885,24915,24944,24974,25003,25032,25062,25091,25121,25150,25180,25210,25240,25269,25299,25328,25358,25387,25416,25446,25475,25505,25534,25564,25594,25624,25653,25683,25712,25742,25771,25800,25830,25859,25888,25918,25948,25977,26007,26037,26067,26096,26126,26155,26184,26214,26243,26272,26302,26332,26361,26391,26421,26451,26480,26510,26539,26568,26598,26627,26656,26686,26715,26745,26775,26805,26834,26864,26893,26923,26952,26982,27011,27041,27070,27099,27129,27159,27188,27218,27248,27277,27307,27336,27366,27395,27425,27454,27484,27513,27542,27572,27602,27631,27661,27691,27720,27750,27779,27809,27838,27868,27897,27926,27956,27985,28015,28045,28074,28104,28134,28163,28193,28222,28252,28281,28310,28340,28369,28399,28428,28458,28488,28517,28547,28577,28607,28636,28665,28695,28724,28754,28783,28813,28843,28872,28901,28931,28960,28990,29019,29049,29078,29108,29137,29167,29196,29226,29255,29285,29315,29345,29375,29404,29434,29463,29492,29522,29551,29580,29610,29640,29669,29699,29729,29759,29788,29818,29847,29876,29906,29935,29964,29994,30023,30053,30082,30112,30141,30171,30200,30230,30259,30289,30318,30348,30378,30408,30437,30467,30496,30526,30555,30585,30614,30644,30673,30703,30732,30762,30791,30821,30850,30880,30909,30939,30968,30998,31027,31057,31086,31116,31145,31175,31204,31234,31263,31293,31322,31352,31381,31411,31441,31471,31500,31530,31559,31589,31618,31648,31676,31706,31736,31766,31795,31825,31854,31884,31913,31943,31972,32002,32031,32061,32090,32120,32150,32180,32209,32239,32268,32298,32327,32357,32386,32416,32445,32475,32504,32534,32563,32593,32622,32652,32681,32711,32740,32770,32799,32829,32858,32888,32917,32947,32976,33006,33035,33065,33094,33124,33153,33183,33213,33243,33272,33302,33331,33361,33390,33420,33450,33479,33509,33539,33568,33598,33627,33657,33686,33716,33745,33775,33804,33834,33863,33893,33922,33952,33981,34011,34040,34069,34099,34128,34158,34187,34217,34247,34277,34306,34336,34365,34395,34424,34454,34483,34512,34542,34571,34601,34631,34660,34690,34719,34749,34778,34808,34837,34867,34896,34926,34955,34985,35015,35044,35074,35103,35133,35162,35192,35222,35251,35280,35310,35340,35370,35399,35429,35458,35488,35517,35547,35576,35605,35635,35665,35694,35723,35753,35782,35811,35841,35871,35901,35930,35960,35989,36019,36048,36078,36107,36136,36166,36195,36225,36254,36284,36314,36343,36373,36403,36433,36462,36492,36521,36551,36580,36610,36639,36669,36698,36728,36757,36786,36816,36845,36875,36904,36934,36963,36993,37022,37052,37081,37111,37141,37170,37200,37229,37259,37288,37318,37347,37377,37406,37436,37465,37495,37524,37554,37584,37613,37643,37672,37701,37731,37760,37790,37819,37849,37878,37908,37938,37967,37997,38027,38056,38085,38115,38144,38174,38203,38233,38262,38292,38322,38351,38381,38410,38440,38469,38499,38528,38558,38587,38617,38646,38676,38705,38735,38764,38794,38823,38853,38882,38912,38941,38971,39001,39030,39059,39089,39118,39148,39178,39208,39237,39267,39297,39326,39355,39385,39414,39444,39473,39503,39532,39562,39592,39621,39650,39680,39709,39739,39768,39798,39827,39857,39886,39916,39946,39975,40005,40035,40064,40094,40123,40153,40182,40212,40241,40271,40300,40330,40359,40389,40418,40448,40477,40507,40536,40566,40595,40625,40655,40685,40714,40744,40773,40803,40832,40862,40892,40921,40951,40980,41009,41039,41068,41098,41127,41157,41186,41216,41245,41275,41304,41334,41364,41393,41422,41452,41481,41511,41540,41570,41599,41629,41658,41688,41718,41748,41777,41807,41836,41865,41894,41924,41953,41983,42012,42042,42072,42102,42131,42161,42190,42220,42249,42279,42308,42337,42367,42397,42426,42456,42485,42515,42545,42574,42604,42633,42662,42692,42721,42751,42780,42810,42839,42869,42899,42929,42958,42988,43017,43046,43076,43105,43135,43164,43194,43223,43253,43283,43312,43342,43371,43401,43430,43460,43489,43519,43548,43578,43607,43637,43666,43696,43726,43755,43785,43814,43844,43873,43903,43932,43962,43991,44021,44050,44080,44109,44139,44169,44198,44228,44258,44287,44317,44346,44375,44405,44434,44464,44493,44523,44553,44582,44612,44641,44671,44700,44730,44759,44788,44818,44847,44877,44906,44936,44966,44996,45025,45055,45084,45114,45143,45172,45202,45231,45261,45290,45320,45350,45380,45409,45439,45468,45498,45527,45556,45586,45615,45644,45674,45704,45733,45763,45793,45823,45852,45882,45911,45940,45970,45999,46028,46058,46088,46117,46147,46177,46206,46236,46265,46295,46324,46354,46383,46413,46442,46472,46501,46531,46560,46590,46620,46649,46679,46708,46738,46767,46797,46826,46856,46885,46915,46944,46974,47003,47033,47063,47092,47122,47151,47181,47210,47240,47269,47298,47328,47357,47387,47417,47446,47476,47506,47535,47565,47594,47624,47653,47682,47712,47741,47771,47800,47830,47860,47890,47919,47949,47978,48008,48037,48066,48096,48125,48155,48184,48214,48244,48273,48303,48333,48362,48392,48421,48450,48480,48509,48538,48568,48598,48627,48657,48687,48717,48746,48776,48805,48834,48864,48893,48922,48952,48982,49011,49041,49071,49100,49130,49160,49189,49218,49248,49277,49306,49336,49365,49395,49425,49455,49484,49514,49543,49573,49602,49632,49661,49690,49720,49749,49779,49809,49838,49868,49898,49927,49957,49986,50016,50045,50075,50104,50133,50163,50192,50222,50252,50281,50311,50340,50370,50400,50429,50459,50488,50518,50547,50576,50606,50635,50665,50694,50724,50754,50784,50813,50843,50872,50902,50931,50960,50990,51019,51049,51078,51108,51138,51167,51197,51227,51256,51286,51315,51345,51374,51403,51433,51462,51492,51522,51552,51582,51611,51641,51670,51699,51729,51758,51787,51816,51846,51876,51906,51936,51965,51995,52025,52054,52083,52113,52142,52171,52200,52230,52260,52290,52319,52349,52379,52408,52438,52467,52497,52526,52555,52585,52614,52644,52673,52703,52733,52762,52792,52822,52851,52881,52910,52939,52969,52998,53028,53057,53087,53116,53146,53176,53205,53235,53264,53294,53324,53353,53383,53412,53441,53471,53500,53530,53559,53589,53619,53648,53678,53708,53737,53767,53796,53825,53855,53884,53913,53943,53973,54003,54032,54062,54092,54121,54151,54180,54209,54239,54268,54297,54327,54357,54387,54416,54446,54476,54505,54535,54564,54593,54623,54652,54681,54711,54741,54770,54800,54830,54859,54889,54919,54948,54977,55007,55036,55066,55095,55125,55154,55184,55213,55243,55273,55302,55332,55361,55391,55420,55450,55479,55508,55538,55567,55597,55627,55657,55686,55716,55745,55775,55804,55834,55863,55892,55922,55951,55981,56011,56040,56070,56100,56129,56159,56188,56218,56247,56276,56306,56335,56365,56394,56424,56454,56483,56513,56543,56572,56601,56631,56660,56690,56719,56749,56778,56808,56837,56867,56897,56926,56956,56985,57015,57044,57074,57103,57133,57162,57192,57221,57251,57280,57310,57340,57369,57399,57429,57458,57487,57517,57546,57576,57605,57634,57664,57694,57723,57753,57783,57813,57842,57871,57901,57930,57959,57989,58018,58048,58077,58107,58137,58167,58196,58226,58255,58285,58314,58343,58373,58402,58432,58461,58491,58521,58551,58580,58610,58639,58669,58698,58727,58757,58786,58816,58845,58875,58905,58934,58964,58994,59023,59053,59082,59111,59141,59170,59200,59229,59259,59288,59318,59348,59377,59407,59436,59466,59495,59525,59554,59584,59613,59643,59672,59702,59731,59761,59791,59820,59850,59879,59909,59939,59968,59997,60027,60056,60086,60115,60145,60174,60204,60234,60264,60293,60323,60352,60381,60411,60440,60469,60499,60528,60558,60588,60618,60648,60677,60707,60736,60765,60795,60824,60853,60883,60912,60942,60972,61002,61031,61061,61090,61120,61149,61179,61208,61237,61267,61296,61326,61356,61385,61415,61445,61474,61504,61533,61563,61592,61621,61651,61680,61710,61739,61769,61799,61828,61858,61888,61917,61947,61976,62006,62035,62064,62094,62123,62153,62182,62212,62242,62271,62301,62331,62360,62390,62419,62448,62478,62507,62537,62566,62596,62625,62655,62685,62715,62744,62774,62803,62832,62862,62891,62921,62950,62980,63009,63039,63069,63099,63128,63157,63187,63216,63246,63275,63305,63334,63363,63393,63423,63453,63482,63512,63541,63571,63600,63630,63659,63689,63718,63747,63777,63807,63836,63866,63895,63925,63955,63984,64014,64043,64073,64102,64131,64161,64190,64220,64249,64279,64309,64339,64368,64398,64427,64457,64486,64515,64545,64574,64603,64633,64663,64692,64722,64752,64782,64811,64841,64870,64899,64929,64958,64987,65017,65047,65076,65106,65136,65166,65195,65225,65254,65283,65313,65342,65371,65401,65431,65460,65490,65520,65549,65579,65608,65638,65667,65697,65726,65755,65785,65815,65844,65874,65903,65933,65963,65992,66022,66051,66081,66110,66140,66169,66199,66228,66258,66287,66317,66346,66376,66405,66435,66465,66494,66524,66553,66583,66612,66641,66671,66700,66730,66760,66789,66819,66849,66878,66908,66937,66967,66996,67025,67055,67084,67114,67143,67173,67203,67233,67262,67292,67321,67351,67380,67409,67439,67468,67497,67527,67557,67587,67617,67646,67676,67705,67735,67764,67793,67823,67852,67882,67911,67941,67971,68e3,68030,68060,68089,68119,68148,68177,68207,68236,68266,68295,68325,68354,68384,68414,68443,68473,68502,68532,68561,68591,68620,68650,68679,68708,68738,68768,68797,68827,68857,68886,68916,68946,68975,69004,69034,69063,69092,69122,69152,69181,69211,69240,69270,69300,69330,69359,69388,69418,69447,69476,69506,69535,69565,69595,69624,69654,69684,69713,69743,69772,69802,69831,69861,69890,69919,69949,69978,70008,70038,70067,70097,70126,70156,70186,70215,70245,70274,70303,70333,70362,70392,70421,70451,70481,70510,70540,70570,70599,70629,70658,70687,70717,70746,70776,70805,70835,70864,70894,70924,70954,70983,71013,71042,71071,71101,71130,71159,71189,71218,71248,71278,71308,71337,71367,71397,71426,71455,71485,71514,71543,71573,71602,71632,71662,71691,71721,71751,71781,71810,71839,71869,71898,71927,71957,71986,72016,72046,72075,72105,72135,72164,72194,72223,72253,72282,72311,72341,72370,72400,72429,72459,72489,72518,72548,72577,72607,72637,72666,72695,72725,72754,72784,72813,72843,72872,72902,72931,72961,72991,73020,73050,73080,73109,73139,73168,73197,73227,73256,73286,73315,73345,73375,73404,73434,73464,73493,73523,73552,73581,73611,73640,73669,73699,73729,73758,73788,73818,73848,73877,73907,73936,73965,73995,74024,74053,74083,74113,74142,74172,74202,74231,74261,74291,74320,74349,74379,74408,74437,74467,74497,74526,74556,74586,74615,74645,74675,74704,74733,74763,74792,74822,74851,74881,74910,74940,74969,74999,75029,75058,75088,75117,75147,75176,75206,75235,75264,75294,75323,75353,75383,75412,75442,75472,75501,75531,75560,75590,75619,75648,75678,75707,75737,75766,75796,75826,75856,75885,75915,75944,75974,76003,76032,76062,76091,76121,76150,76180,76210,76239,76269,76299,76328,76358,76387,76416,76446,76475,76505,76534,76564,76593,76623,76653,76682,76712,76741,76771,76801,76830,76859,76889,76918,76948,76977,77007,77036,77066,77096,77125,77155,77185,77214,77243,77273,77302,77332,77361,77390,77420,77450,77479,77509,77539,77569,77598,77627,77657,77686,77715,77745,77774,77804,77833,77863,77893,77923,77952,77982,78011,78041,78070,78099,78129,78158,78188,78217,78247,78277,78307,78336,78366,78395,78425,78454,78483,78513,78542,78572,78601,78631,78661,78690,78720,78750,78779,78808,78838,78867,78897,78926,78956,78985,79015,79044,79074,79104,79133,79163,79192,79222,79251,79281,79310,79340,79369,79399,79428,79458,79487,79517,79546,79576,79606,79635,79665,79695,79724,79753,79783,79812,79841,79871,79900,79930,79960,79990]},{"../main":347,"object-assign":247}],347:[function(d,ee,te){var w=d("object-assign");function v(){this.regionalOptions=[],this.regionalOptions[""]={invalidCalendar:"Calendar {0} not found",invalidDate:"Invalid {0} date",invalidMonth:"Invalid {0} month",invalidYear:"Invalid {0} year",differentCalendars:"Cannot mix {0} and {1} dates"},this.local=this.regionalOptions[""],this.calendars={},this._localCals={}}w(v.prototype,{instance:function(r,t){r=(r||"gregorian").toLowerCase(),t=t||"";var c=this._localCals[r+"-"+t];if(!c&&this.calendars[r]&&(c=new this.calendars[r](t),this._localCals[r+"-"+t]=c),!c)throw(this.local.invalidCalendar||this.regionalOptions[""].invalidCalendar).replace(/\{0\}/,r);return c},newDate:function(r,t,c,o,i){return o=(r!=null&&r.year?r.calendar():typeof o=="string"?this.instance(o,i):o)||this.instance(),o.newDate(r,t,c)},substituteDigits:function(r){return function(t){return(t+"").replace(/[0-9]/g,function(c){return r[c]})}},substituteChineseDigits:function(r,t){return function(c){for(var o="",i=0;c>0;){var y=c%10;o=(y===0?"":r[y]+t[i])+o,i++,c=Math.floor(c/10)}return o.indexOf(r[1]+t[1])===0&&(o=o.substr(1)),o||r[0]}}});function S(r,t,c,o){if(this._calendar=r,this._year=t,this._month=c,this._day=o,this._calendar._validateLevel===0&&!this._calendar.isValid(this._year,this._month,this._day))throw(n.local.invalidDate||n.regionalOptions[""].invalidDate).replace(/\{0\}/,this._calendar.local.name)}function M(r,t){return r=""+r,"000000".substring(0,t-r.length)+r}w(S.prototype,{newDate:function(r,t,c){return this._calendar.newDate(r==null?this:r,t,c)},year:function(r){return arguments.length===0?this._year:this.set(r,"y")},month:function(r){return arguments.length===0?this._month:this.set(r,"m")},day:function(r){return arguments.length===0?this._day:this.set(r,"d")},date:function(r,t,c){if(!this._calendar.isValid(r,t,c))throw(n.local.invalidDate||n.regionalOptions[""].invalidDate).replace(/\{0\}/,this._calendar.local.name);return this._year=r,this._month=t,this._day=c,this},leapYear:function(){return this._calendar.leapYear(this)},epoch:function(){return this._calendar.epoch(this)},formatYear:function(){return this._calendar.formatYear(this)},monthOfYear:function(){return this._calendar.monthOfYear(this)},weekOfYear:function(){return this._calendar.weekOfYear(this)},daysInYear:function(){return this._calendar.daysInYear(this)},dayOfYear:function(){return this._calendar.dayOfYear(this)},daysInMonth:function(){return this._calendar.daysInMonth(this)},dayOfWeek:function(){return this._calendar.dayOfWeek(this)},weekDay:function(){return this._calendar.weekDay(this)},extraInfo:function(){return this._calendar.extraInfo(this)},add:function(r,t){return this._calendar.add(this,r,t)},set:function(r,t){return this._calendar.set(this,r,t)},compareTo:function(r){if(this._calendar.name!==r._calendar.name)throw(n.local.differentCalendars||n.regionalOptions[""].differentCalendars).replace(/\{0\}/,this._calendar.local.name).replace(/\{1\}/,r._calendar.local.name);var t=this._year!==r._year?this._year-r._year:this._month!==r._month?this.monthOfYear()-r.monthOfYear():this._day-r._day;return t===0?0:t<0?-1:1},calendar:function(){return this._calendar},toJD:function(){return this._calendar.toJD(this)},fromJD:function(r){return this._calendar.fromJD(r)},toJSDate:function(){return this._calendar.toJSDate(this)},fromJSDate:function(r){return this._calendar.fromJSDate(r)},toString:function(){return(this.year()<0?"-":"")+M(Math.abs(this.year()),4)+"-"+M(this.month(),2)+"-"+M(this.day(),2)}});function e(){this.shortYearCutoff="+10"}w(e.prototype,{_validateLevel:0,newDate:function(r,t,c){return r==null?this.today():(r.year&&(this._validate(r,t,c,n.local.invalidDate||n.regionalOptions[""].invalidDate),c=r.day(),t=r.month(),r=r.year()),new S(this,r,t,c))},today:function(){return this.fromJSDate(new Date)},epoch:function(r){var t=this._validate(r,this.minMonth,this.minDay,n.local.invalidYear||n.regionalOptions[""].invalidYear);return t.year()<0?this.local.epochs[0]:this.local.epochs[1]},formatYear:function(r){var t=this._validate(r,this.minMonth,this.minDay,n.local.invalidYear||n.regionalOptions[""].invalidYear);return(t.year()<0?"-":"")+M(Math.abs(t.year()),4)},monthsInYear:function(r){return this._validate(r,this.minMonth,this.minDay,n.local.invalidYear||n.regionalOptions[""].invalidYear),12},monthOfYear:function(r,t){var c=this._validate(r,t,this.minDay,n.local.invalidMonth||n.regionalOptions[""].invalidMonth);return(c.month()+this.monthsInYear(c)-this.firstMonth)%this.monthsInYear(c)+this.minMonth},fromMonthOfYear:function(r,t){var c=(t+this.firstMonth-2*this.minMonth)%this.monthsInYear(r)+this.minMonth;return this._validate(r,c,this.minDay,n.local.invalidMonth||n.regionalOptions[""].invalidMonth),c},daysInYear:function(r){var t=this._validate(r,this.minMonth,this.minDay,n.local.invalidYear||n.regionalOptions[""].invalidYear);return this.leapYear(t)?366:365},dayOfYear:function(r,t,c){var o=this._validate(r,t,c,n.local.invalidDate||n.regionalOptions[""].invalidDate);return o.toJD()-this.newDate(o.year(),this.fromMonthOfYear(o.year(),this.minMonth),this.minDay).toJD()+1},daysInWeek:function(){return 7},dayOfWeek:function(r,t,c){var o=this._validate(r,t,c,n.local.invalidDate||n.regionalOptions[""].invalidDate);return(Math.floor(this.toJD(o))+2)%this.daysInWeek()},extraInfo:function(r,t,c){return this._validate(r,t,c,n.local.invalidDate||n.regionalOptions[""].invalidDate),{}},add:function(r,t,c){return this._validate(r,this.minMonth,this.minDay,n.local.invalidDate||n.regionalOptions[""].invalidDate),this._correctAdd(r,this._add(r,t,c),t,c)},_add:function(r,t,c){if(this._validateLevel++,c==="d"||c==="w"){var o=r.toJD()+t*(c==="w"?this.daysInWeek():1),i=r.calendar().fromJD(o);return this._validateLevel--,[i.year(),i.month(),i.day()]}try{var y=r.year()+(c==="y"?t:0),p=r.monthOfYear()+(c==="m"?t:0),i=r.day(),g=function(u){for(;p<u.minMonth;)y--,p+=u.monthsInYear(y);for(var _=u.monthsInYear(y);p>_-1+u.minMonth;)y++,p-=_,_=u.monthsInYear(y)};c==="y"?(r.month()!==this.fromMonthOfYear(y,p)&&(p=this.newDate(y,r.month(),this.minDay).monthOfYear()),p=Math.min(p,this.monthsInYear(y)),i=Math.min(i,this.daysInMonth(y,this.fromMonthOfYear(y,p)))):c==="m"&&(g(this),i=Math.min(i,this.daysInMonth(y,this.fromMonthOfYear(y,p))));var h=[y,this.fromMonthOfYear(y,p),i];return this._validateLevel--,h}catch(m){throw this._validateLevel--,m}},_correctAdd:function(r,t,c,o){if(!this.hasYearZero&&(o==="y"||o==="m")&&(t[0]===0||r.year()>0!=t[0]>0)){var i={y:[1,1,"y"],m:[1,this.monthsInYear(-1),"m"],w:[this.daysInWeek(),this.daysInYear(-1),"d"],d:[1,this.daysInYear(-1),"d"]}[o],y=c<0?-1:1;t=this._add(r,c*i[0]+y*i[1],i[2])}return r.date(t[0],t[1],t[2])},set:function(r,t,c){this._validate(r,this.minMonth,this.minDay,n.local.invalidDate||n.regionalOptions[""].invalidDate);var o=c==="y"?t:r.year(),i=c==="m"?t:r.month(),y=c==="d"?t:r.day();return(c==="y"||c==="m")&&(y=Math.min(y,this.daysInMonth(o,i))),r.date(o,i,y)},isValid:function(r,t,c){this._validateLevel++;var o=this.hasYearZero||r!==0;if(o){var i=this.newDate(r,t,this.minDay);o=t>=this.minMonth&&t-this.minMonth<this.monthsInYear(i)&&c>=this.minDay&&c-this.minDay<this.daysInMonth(i)}return this._validateLevel--,o},toJSDate:function(r,t,c){var o=this._validate(r,t,c,n.local.invalidDate||n.regionalOptions[""].invalidDate);return n.instance().fromJD(this.toJD(o)).toJSDate()},fromJSDate:function(r){return this.fromJD(n.instance().fromJSDate(r).toJD())},_validate:function(r,t,c,o){if(r.year){if(this._validateLevel===0&&this.name!==r.calendar().name)throw(n.local.differentCalendars||n.regionalOptions[""].differentCalendars).replace(/\{0\}/,this.local.name).replace(/\{1\}/,r.calendar().local.name);return r}try{if(this._validateLevel++,this._validateLevel===1&&!this.isValid(r,t,c))throw o.replace(/\{0\}/,this.local.name);var i=this.newDate(r,t,c);return this._validateLevel--,i}catch(y){throw this._validateLevel--,y}}});function a(r){this.local=this.regionalOptions[r]||this.regionalOptions[""]}a.prototype=new e,w(a.prototype,{name:"Gregorian",jdEpoch:17214255e-1,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Gregorian",epochs:["BCE","CE"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"mm/dd/yyyy",firstDay:0,isRTL:!1}},leapYear:function(c){var t=this._validate(c,this.minMonth,this.minDay,n.local.invalidYear||n.regionalOptions[""].invalidYear),c=t.year()+(t.year()<0?1:0);return c%4===0&&(c%100!==0||c%400===0)},weekOfYear:function(r,t,c){var o=this.newDate(r,t,c);return o.add(4-(o.dayOfWeek()||7),"d"),Math.floor((o.dayOfYear()-1)/7)+1},daysInMonth:function(r,t){var c=this._validate(r,t,this.minDay,n.local.invalidMonth||n.regionalOptions[""].invalidMonth);return this.daysPerMonth[c.month()-1]+(c.month()===2&&this.leapYear(c.year())?1:0)},weekDay:function(r,t,c){return(this.dayOfWeek(r,t,c)||7)<6},toJD:function(r,t,c){var o=this._validate(r,t,c,n.local.invalidDate||n.regionalOptions[""].invalidDate);r=o.year(),t=o.month(),c=o.day(),r<0&&r++,t<3&&(t+=12,r--);var i=Math.floor(r/100),y=2-i+Math.floor(i/4);return Math.floor(365.25*(r+4716))+Math.floor(30.6001*(t+1))+c+y-1524.5},fromJD:function(r){var t=Math.floor(r+.5),c=Math.floor((t-186721625e-2)/36524.25);c=t+1+c-Math.floor(c/4);var o=c+1524,i=Math.floor((o-122.1)/365.25),y=Math.floor(365.25*i),p=Math.floor((o-y)/30.6001),g=o-y-Math.floor(p*30.6001),h=p-(p>13.5?13:1),m=i-(h>2.5?4716:4715);return m<=0&&m--,this.newDate(m,h,g)},toJSDate:function(r,t,c){var o=this._validate(r,t,c,n.local.invalidDate||n.regionalOptions[""].invalidDate),i=new Date(o.year(),o.month()-1,o.day());return i.setHours(0),i.setMinutes(0),i.setSeconds(0),i.setMilliseconds(0),i.setHours(i.getHours()>12?i.getHours()+2:0),i},fromJSDate:function(r){return this.newDate(r.getFullYear(),r.getMonth()+1,r.getDate())}});var n=ee.exports=new v;n.cdate=S,n.baseCalendar=e,n.calendars.gregorian=a},{"object-assign":247}],348:[function(d,ee,te){var w=d("object-assign"),v=d("./main");w(v.regionalOptions[""],{invalidArguments:"Invalid arguments",invalidFormat:"Cannot format a date from another calendar",missingNumberAt:"Missing number at position {0}",unknownNameAt:"Unknown name at position {0}",unexpectedLiteralAt:"Unexpected literal at position {0}",unexpectedText:"Additional text found at end"}),v.local=v.regionalOptions[""],w(v.cdate.prototype,{formatDate:function(S,M){return typeof S!="string"&&(M=S,S=""),this._calendar.formatDate(S||"",this,M)}}),w(v.baseCalendar.prototype,{UNIX_EPOCH:v.instance().newDate(1970,1,1).toJD(),SECS_PER_DAY:24*60*60,TICKS_EPOCH:v.instance().jdEpoch,TICKS_PER_DAY:24*60*60*1e7,ATOM:"yyyy-mm-dd",COOKIE:"D, dd M yyyy",FULL:"DD, MM d, yyyy",ISO_8601:"yyyy-mm-dd",JULIAN:"J",RFC_822:"D, d M yy",RFC_850:"DD, dd-M-yy",RFC_1036:"D, d M yy",RFC_1123:"D, d M yyyy",RFC_2822:"D, d M yyyy",RSS:"D, d M yy",TICKS:"!",TIMESTAMP:"@",W3C:"yyyy-mm-dd",formatDate:function(S,M,e){if(typeof S!="string"&&(e=M,M=S,S=""),!M)return"";if(M.calendar()!==this)throw v.local.invalidFormat||v.regionalOptions[""].invalidFormat;S=S||this.local.dateFormat,e=e||{};var a=e.dayNamesShort||this.local.dayNamesShort,n=e.dayNames||this.local.dayNames,r=e.monthNumbers||this.local.monthNumbers,t=e.monthNamesShort||this.local.monthNamesShort,c=e.monthNames||this.local.monthNames;e.calculateWeek||this.local.calculateWeek;for(var o=function(b,f){for(var x=1;A+x<S.length&&S.charAt(A+x)===b;)x++;return A+=x-1,Math.floor(x/(f||1))>1},i=function(b,f,x,l){var L=""+f;if(o(b,l))for(;L.length<x;)L="0"+L;return L},y=function(b,f,x,l){return o(b)?l[f]:x[f]},p=this,g=function(b){return typeof r=="function"?r.call(p,b,o("m")):u(i("m",b.month(),2))},h=function(b,f){return f?typeof c=="function"?c.call(p,b):c[b.month()-p.minMonth]:typeof t=="function"?t.call(p,b):t[b.month()-p.minMonth]},m=this.local.digits,u=function(b){return e.localNumbers&&m?m(b):b},_="",s=!1,A=0;A<S.length;A++)if(s)S.charAt(A)==="'"&&!o("'")?s=!1:_+=S.charAt(A);else switch(S.charAt(A)){case"d":_+=u(i("d",M.day(),2));break;case"D":_+=y("D",M.dayOfWeek(),a,n);break;case"o":_+=i("o",M.dayOfYear(),3);break;case"w":_+=i("w",M.weekOfYear(),2);break;case"m":_+=g(M);break;case"M":_+=h(M,o("M"));break;case"y":_+=o("y",2)?M.year():(M.year()%100<10?"0":"")+M.year()%100;break;case"Y":o("Y",2),_+=M.formatYear();break;case"J":_+=M.toJD();break;case"@":_+=(M.toJD()-this.UNIX_EPOCH)*this.SECS_PER_DAY;break;case"!":_+=(M.toJD()-this.TICKS_EPOCH)*this.TICKS_PER_DAY;break;case"'":o("'")?_+="'":s=!0;break;default:_+=S.charAt(A)}return _},parseDate:function(S,M,e){if(M==null)throw v.local.invalidArguments||v.regionalOptions[""].invalidArguments;if(M=typeof M=="object"?M.toString():M+"",M==="")return null;S=S||this.local.dateFormat,e=e||{};var a=e.shortYearCutoff||this.shortYearCutoff;a=typeof a!="string"?a:this.today().year()%100+parseInt(a,10);for(var n=e.dayNamesShort||this.local.dayNamesShort,r=e.dayNames||this.local.dayNames,t=e.parseMonth||this.local.parseMonth,c=e.monthNumbers||this.local.monthNumbers,o=e.monthNamesShort||this.local.monthNamesShort,i=e.monthNames||this.local.monthNames,y=-1,p=-1,g=-1,h=-1,m=-1,u=!1,_=!1,s=function(I,D){for(var R=1;k+R<S.length&&S.charAt(k+R)===I;)R++;return k+=R-1,Math.floor(R/(D||1))>1},A=function(I,D){var R=s(I,D),B=[2,3,R?4:2,R?4:2,10,11,20]["oyYJ@!".indexOf(I)+1],F=new RegExp("^-?\\d{1,"+B+"}"),H=M.substring(T).match(F);if(!H)throw(v.local.missingNumberAt||v.regionalOptions[""].missingNumberAt).replace(/\{0\}/,T);return T+=H[0].length,parseInt(H[0],10)},b=this,f=function(){if(typeof c=="function"){s("m");var I=c.call(b,M.substring(T));return T+=I.length,I}return A("m")},x=function(I,D,R,B){for(var F=s(I,B)?R:D,H=0;H<F.length;H++)if(M.substr(T,F[H].length).toLowerCase()===F[H].toLowerCase())return T+=F[H].length,H+b.minMonth;throw(v.local.unknownNameAt||v.regionalOptions[""].unknownNameAt).replace(/\{0\}/,T)},l=function(){if(typeof i=="function"){var I=s("M")?i.call(b,M.substring(T)):o.call(b,M.substring(T));return T+=I.length,I}return x("M",o,i)},L=function(){if(M.charAt(T)!==S.charAt(k))throw(v.local.unexpectedLiteralAt||v.regionalOptions[""].unexpectedLiteralAt).replace(/\{0\}/,T);T++},T=0,k=0;k<S.length;k++)if(_)S.charAt(k)==="'"&&!s("'")?_=!1:L();else switch(S.charAt(k)){case"d":h=A("d");break;case"D":x("D",n,r);break;case"o":m=A("o");break;case"w":A("w");break;case"m":g=f();break;case"M":g=l();break;case"y":var P=k;u=!s("y",2),k=P,p=A("y",2);break;case"Y":p=A("Y",2);break;case"J":y=A("J")+.5,M.charAt(T)==="."&&(T++,A("J"));break;case"@":y=A("@")/this.SECS_PER_DAY+this.UNIX_EPOCH;break;case"!":y=A("!")/this.TICKS_PER_DAY+this.TICKS_EPOCH;break;case"*":T=M.length;break;case"'":s("'")?L():_=!0;break;default:L()}if(T<M.length)throw v.local.unexpectedText||v.regionalOptions[""].unexpectedText;if(p===-1?p=this.today().year():p<100&&u&&(p+=a===-1?1900:this.today().year()-this.today().year()%100-(p<=a?0:100)),typeof g=="string"&&(g=t.call(this,p,g)),m>-1){g=1,h=m;for(var z=this.daysInMonth(p,g);h>z;z=this.daysInMonth(p,g))g++,h-=z}return y>-1?this.fromJD(y):this.newDate(p,g,h)},determineDate:function(S,M,e,a,n){e&&typeof e!="object"&&(n=a,a=e,e=null),typeof a!="string"&&(n=a,a="");var r=this,t=function(c){try{return r.parseDate(a,c,n)}catch{}c=c.toLowerCase();for(var o=(c.match(/^c/)&&e?e.newDate():null)||r.today(),i=/([+-]?[0-9]+)\s*(d|w|m|y)?/g,y=i.exec(c);y;)o.add(parseInt(y[1],10),y[2]||"d"),y=i.exec(c);return o};return M=M?M.newDate():null,S=S==null?M:typeof S=="string"?t(S):typeof S=="number"?isNaN(S)||S===1/0||S===-1/0?M:r.today().add(S,"d"):r.newDate(S),S}})},{"./main":347,"object-assign":247}],349:[function(d,ee,te){ee.exports=[{path:"",backoff:0},{path:"M-2.4,-3V3L0.6,0Z",backoff:.6},{path:"M-3.7,-2.5V2.5L1.3,0Z",backoff:1.3},{path:"M-4.45,-3L-1.65,-0.2V0.2L-4.45,3L1.55,0Z",backoff:1.55},{path:"M-2.2,-2.2L-0.2,-0.2V0.2L-2.2,2.2L-1.4,3L1.6,0L-1.4,-3Z",backoff:1.6},{path:"M-4.4,-2.1L-0.6,-0.2V0.2L-4.4,2.1L-4,3L2,0L-4,-3Z",backoff:2},{path:"M2,0A2,2 0 1,1 0,-2A2,2 0 0,1 2,0Z",backoff:0,noRotate:!0},{path:"M2,2V-2H-2V2Z",backoff:0,noRotate:!0}]},{}],350:[function(d,ee,te){var w=d("./arrow_paths"),v=d("../../plots/font_attributes"),S=d("../../plots/cartesian/constants"),M=d("../../plot_api/plot_template").templatedArray;d("../../constants/axis_placeable_objects"),ee.exports=M("annotation",{visible:{valType:"boolean",dflt:!0,editType:"calc+arraydraw"},text:{valType:"string",editType:"calc+arraydraw"},textangle:{valType:"angle",dflt:0,editType:"calc+arraydraw"},font:v({editType:"calc+arraydraw",colorEditType:"arraydraw"}),width:{valType:"number",min:1,dflt:null,editType:"calc+arraydraw"},height:{valType:"number",min:1,dflt:null,editType:"calc+arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"arraydraw"},align:{valType:"enumerated",values:["left","center","right"],dflt:"center",editType:"arraydraw"},valign:{valType:"enumerated",values:["top","middle","bottom"],dflt:"middle",editType:"arraydraw"},bgcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"arraydraw"},bordercolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"arraydraw"},borderpad:{valType:"number",min:0,dflt:1,editType:"calc+arraydraw"},borderwidth:{valType:"number",min:0,dflt:1,editType:"calc+arraydraw"},showarrow:{valType:"boolean",dflt:!0,editType:"calc+arraydraw"},arrowcolor:{valType:"color",editType:"arraydraw"},arrowhead:{valType:"integer",min:0,max:w.length,dflt:1,editType:"arraydraw"},startarrowhead:{valType:"integer",min:0,max:w.length,dflt:1,editType:"arraydraw"},arrowside:{valType:"flaglist",flags:["end","start"],extras:["none"],dflt:"end",editType:"arraydraw"},arrowsize:{valType:"number",min:.3,dflt:1,editType:"calc+arraydraw"},startarrowsize:{valType:"number",min:.3,dflt:1,editType:"calc+arraydraw"},arrowwidth:{valType:"number",min:.1,editType:"calc+arraydraw"},standoff:{valType:"number",min:0,dflt:0,editType:"calc+arraydraw"},startstandoff:{valType:"number",min:0,dflt:0,editType:"calc+arraydraw"},ax:{valType:"any",editType:"calc+arraydraw"},ay:{valType:"any",editType:"calc+arraydraw"},axref:{valType:"enumerated",dflt:"pixel",values:["pixel",S.idRegex.x.toString()],editType:"calc"},ayref:{valType:"enumerated",dflt:"pixel",values:["pixel",S.idRegex.y.toString()],editType:"calc"},xref:{valType:"enumerated",values:["paper",S.idRegex.x.toString()],editType:"calc"},x:{valType:"any",editType:"calc+arraydraw"},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"auto",editType:"calc+arraydraw"},xshift:{valType:"number",dflt:0,editType:"calc+arraydraw"},yref:{valType:"enumerated",values:["paper",S.idRegex.y.toString()],editType:"calc"},y:{valType:"any",editType:"calc+arraydraw"},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"auto",editType:"calc+arraydraw"},yshift:{valType:"number",dflt:0,editType:"calc+arraydraw"},clicktoshow:{valType:"enumerated",values:[!1,"onoff","onout"],dflt:!1,editType:"arraydraw"},xclick:{valType:"any",editType:"arraydraw"},yclick:{valType:"any",editType:"arraydraw"},hovertext:{valType:"string",editType:"arraydraw"},hoverlabel:{bgcolor:{valType:"color",editType:"arraydraw"},bordercolor:{valType:"color",editType:"arraydraw"},font:v({editType:"arraydraw"}),editType:"arraydraw"},captureevents:{valType:"boolean",editType:"arraydraw"},editType:"calc",_deprecated:{ref:{valType:"string",editType:"calc"}}})},{"../../constants/axis_placeable_objects":484,"../../plot_api/plot_template":555,"../../plots/cartesian/constants":573,"../../plots/font_attributes":594,"./arrow_paths":349}],351:[function(d,ee,te){var w=d("../../lib"),v=d("../../plots/cartesian/axes"),S=d("./draw").draw;ee.exports=function(n){var r=n._fullLayout,t=w.filterVisible(r.annotations);if(t.length&&n._fullData.length)return w.syncOrAsync([S,M],n)};function M(a){var n=a._fullLayout;w.filterVisible(n.annotations).forEach(function(r){var t=v.getFromId(a,r.xref),c=v.getFromId(a,r.yref),o=v.getRefType(r.xref),i=v.getRefType(r.yref);r._extremes={},o==="range"&&e(r,t),i==="range"&&e(r,c)})}function e(a,n){var r=n._id,t=r.charAt(0),c=a[t],o=a["a"+t],i=a[t+"ref"],y=a["a"+t+"ref"],p=a["_"+t+"padplus"],g=a["_"+t+"padminus"],h={x:1,y:-1}[t]*a[t+"shift"],m=3*a.arrowsize*a.arrowwidth||0,u=m+h,_=m-h,s=3*a.startarrowsize*a.arrowwidth||0,A=s+h,b=s-h,f;if(y===i){var x=v.findExtremes(n,[n.r2c(c)],{ppadplus:u,ppadminus:_}),l=v.findExtremes(n,[n.r2c(o)],{ppadplus:Math.max(p,A),ppadminus:Math.max(g,b)});f={min:[x.min[0],l.min[0]],max:[x.max[0],l.max[0]]}}else A=o?A+o:A,b=o?b-o:b,f=v.findExtremes(n,[n.r2c(c)],{ppadplus:Math.max(p,u,A),ppadminus:Math.max(g,_,b)});a._extremes[r]=f}},{"../../lib":515,"../../plots/cartesian/axes":566,"./draw":356}],352:[function(d,ee,te){var w=d("../../lib"),v=d("../../registry"),S=d("../../plot_api/plot_template").arrayEditor;ee.exports={hasClickToShow:M,onClick:e};function M(r,t){var c=a(r,t);return c.on.length>0||c.explicitOff.length>0}function e(r,t){var c=a(r,t),o=c.on,i=c.off.concat(c.explicitOff),y={},p=r._fullLayout.annotations,g,h;if(!!(o.length||i.length)){for(g=0;g<o.length;g++)h=S(r.layout,"annotations",p[o[g]]),h.modifyItem("visible",!0),w.extendFlat(y,h.getUpdateObj());for(g=0;g<i.length;g++)h=S(r.layout,"annotations",p[i[g]]),h.modifyItem("visible",!1),w.extendFlat(y,h.getUpdateObj());return v.call("update",r,{},y)}}function a(r,t){var c=r._fullLayout.annotations,o=[],i=[],y=[],p=(t||[]).length,g,h,m,u,_,s,A,b;for(g=0;g<c.length;g++)if(m=c[g],u=m.clicktoshow,u){for(h=0;h<p;h++)if(_=t[h],s=_.xaxis,A=_.yaxis,s._id===m.xref&&A._id===m.yref&&s.d2r(_.x)===n(m._xclick,s)&&A.d2r(_.y)===n(m._yclick,A)){m.visible?u==="onout"?b=i:b=y:b=o,b.push(g);break}h===p&&m.visible&&u==="onout"&&i.push(g)}return{on:o,off:i,explicitOff:y}}function n(r,t){return t.type==="log"?t.l2r(r):t.d2r(r)}},{"../../lib":515,"../../plot_api/plot_template":555,"../../registry":647}],353:[function(d,ee,te){var w=d("../../lib"),v=d("../color");ee.exports=function(M,e,a,n){n("opacity");var r=n("bgcolor"),t=n("bordercolor"),c=v.opacity(t);n("borderpad");var o=n("borderwidth"),i=n("showarrow");n("text",i?" ":a._dfltTitle.annotation),n("textangle"),w.coerceFont(n,"font",a.font),n("width"),n("align");var y=n("height");if(y&&n("valign"),i){var p=n("arrowside"),g,h;p.indexOf("end")!==-1&&(g=n("arrowhead"),h=n("arrowsize")),p.indexOf("start")!==-1&&(n("startarrowhead",g),n("startarrowsize",h)),n("arrowcolor",c?e.bordercolor:v.defaultLine),n("arrowwidth",(c&&o||1)*2),n("standoff"),n("startstandoff")}var m=n("hovertext"),u=a.hoverlabel||{};if(m){var _=n("hoverlabel.bgcolor",u.bgcolor||(v.opacity(r)?v.rgb(r):v.defaultLine)),s=n("hoverlabel.bordercolor",u.bordercolor||v.contrast(_));w.coerceFont(n,"hoverlabel.font",{family:u.font.family,size:u.font.size,color:u.font.color||s})}n("captureevents",!!m)}},{"../../lib":515,"../color":367}],354:[function(d,ee,te){var w=d("fast-isnumeric"),v=d("../../lib/to_log_range");ee.exports=function(M,e,a,n){e=e||{};var r=a==="log"&&e.type==="linear",t=a==="linear"&&e.type==="log";if(!(r||t))return;var c=M._fullLayout.annotations,o=e._id.charAt(0),i,y;function p(h){var m=i[h],u=null;r?u=v(m,e.range):u=Math.pow(10,m),w(u)||(u=null),n(y+h,u)}for(var g=0;g<c.length;g++)i=c[g],y="annotations["+g+"].",i[o+"ref"]===e._id&&p(o),i["a"+o+"ref"]===e._id&&p("a"+o)}},{"../../lib/to_log_range":543,"fast-isnumeric":190}],355:[function(d,ee,te){var w=d("../../lib"),v=d("../../plots/cartesian/axes"),S=d("../../plots/array_container_defaults"),M=d("./common_defaults"),e=d("./attributes");ee.exports=function(r,t){S(r,t,{name:"annotations",handleItemDefaults:a})};function a(n,r,t){function c(L,T){return w.coerce(n,r,e,L,T)}var o=c("visible"),i=c("clicktoshow");if(!!(o||i)){M(n,r,t,c);for(var y=r.showarrow,p=["x","y"],g=[-10,-30],h={_fullLayout:t},m=0;m<2;m++){var u=p[m],_=v.coerceRef(n,r,h,u,"","paper");if(_!=="paper"){var s=v.getFromId(h,_);s._annIndices.push(r._index)}if(v.coercePosition(r,h,c,_,u,.5),y){var A="a"+u,b=v.coerceRef(n,r,h,A,"pixel",["pixel","paper"]);b!=="pixel"&&b!==_&&(b=r[A]="pixel");var f=b==="pixel"?g[m]:.4;v.coercePosition(r,h,c,b,A,f)}c(u+"anchor"),c(u+"shift")}if(w.noneOrAll(n,r,["x","y"]),y&&w.noneOrAll(n,r,["ax","ay"]),i){var x=c("xclick"),l=c("yclick");r._xclick=x===void 0?r.x:v.cleanPosition(x,h,r.xref),r._yclick=l===void 0?r.y:v.cleanPosition(l,h,r.yref)}}}},{"../../lib":515,"../../plots/array_container_defaults":561,"../../plots/cartesian/axes":566,"./attributes":350,"./common_defaults":353}],356:[function(d,ee,te){var w=d("@plotly/d3"),v=d("../../registry"),S=d("../../plots/plots"),M=d("../../lib"),e=M.strTranslate,a=d("../../plots/cartesian/axes"),n=d("../color"),r=d("../drawing"),t=d("../fx"),c=d("../../lib/svg_text_utils"),o=d("../../lib/setcursor"),i=d("../dragelement"),y=d("../../plot_api/plot_template").arrayEditor,p=d("./draw_arrow_head");ee.exports={draw:g,drawOne:h,drawRaw:u};function g(_){var s=_._fullLayout;s._infolayer.selectAll(".annotation").remove();for(var A=0;A<s.annotations.length;A++)s.annotations[A].visible&&h(_,A);return S.previousPromises(_)}function h(_,s){var A=_._fullLayout,b=A.annotations[s]||{},f=a.getFromId(_,b.xref),x=a.getFromId(_,b.yref);f&&f.setScale(),x&&x.setScale(),u(_,b,s,!1,f,x)}function m(_,s,A,b,f){var x=f[A],l=f[A+"ref"],L=A.indexOf("y")!==-1,T=a.getRefType(l)==="domain",k=L?b.h:b.w;return _?T?x+(L?-s:s)/_._length:_.p2r(_.r2p(x)+s):x+(L?-s:s)/k}function u(_,s,A,b,f,x){var l=_._fullLayout,L=_._fullLayout._size,T=_._context.edits,k,P;b?(k="annotation-"+b,P=b+".annotations"):(k="annotation",P="annotations");var z=y(_.layout,P,s),I=z.modifyBase,D=z.modifyItem,R=z.getUpdateObj;l._infolayer.selectAll("."+k+'[data-index="'+A+'"]').remove();var B="clip"+l._uid+"_ann"+A;if(!s._input||s.visible===!1){w.selectAll("#"+B).remove();return}var F={x:{},y:{}},H=+s.textangle||0,G=l._infolayer.append("g").classed(k,!0).attr("data-index",String(A)).style("opacity",s.opacity),J=G.append("g").classed("annotation-text-g",!0),X=T[s.showarrow?"annotationTail":"annotationPosition"],Y=s.captureevents||T.annotationText||X;function Z(le){var ye={index:A,annotation:s._input,fullAnnotation:s,event:le};return b&&(ye.subplotId=b),ye}var oe=J.append("g").style("pointer-events",Y?"all":null).call(o,"pointer").on("click",function(){_._dragging=!1,_.emit("plotly_clickannotation",Z(w.event))});s.hovertext&&oe.on("mouseover",function(){var le=s.hoverlabel,ye=le.font,ue=this.getBoundingClientRect(),pe=_.getBoundingClientRect();t.loneHover({x0:ue.left-pe.left,x1:ue.right-pe.left,y:(ue.top+ue.bottom)/2-pe.top,text:s.hovertext,color:le.bgcolor,borderColor:le.bordercolor,fontFamily:ye.family,fontSize:ye.size,fontColor:ye.color},{container:l._hoverlayer.node(),outerContainer:l._paper.node(),gd:_})}).on("mouseout",function(){t.loneUnhover(l._hoverlayer.node())});var re=s.borderwidth,se=s.borderpad,N=re+se,U=oe.append("rect").attr("class","bg").style("stroke-width",re+"px").call(n.stroke,s.bordercolor).call(n.fill,s.bgcolor),q=s.width||s.height,$=l._topclips.selectAll("#"+B).data(q?[0]:[]);$.enter().append("clipPath").classed("annclip",!0).attr("id",B).append("rect"),$.exit().remove();var W=s.font,K=l._meta?M.templateString(s.text,l._meta):s.text,ne=oe.append("text").classed("annotation-text",!0).text(K);function ae(le){return le.call(r.font,W).attr({"text-anchor":{left:"start",right:"end"}[s.align]||"middle"}),c.convertToTspans(le,_,ie),le}function ie(){var le=ne.selectAll("a");if(le.size()===1&&le.text()===ne.text()){var ye=oe.insert("a",":first-child").attr({"xlink:xlink:href":le.attr("xlink:href"),"xlink:xlink:show":le.attr("xlink:show")}).style({cursor:"pointer"});ye.node().appendChild(U.node())}var ue=oe.select(".annotation-text-math-group"),pe=!ue.empty(),ge=r.bBox((pe?ue:ne).node()),Te=ge.width,_e=ge.height,ze=s.width||Te,Oe=s.height||_e,Ye=Math.round(ze+2*N),be=Math.round(Oe+2*N);function Pe(Jt,Zt){return Zt==="auto"&&(Jt<1/3?Zt="left":Jt>2/3?Zt="right":Zt="center"),{center:0,middle:0,left:.5,bottom:-.5,right:-.5,top:.5}[Zt]}for(var Ge=!1,Qe=["x","y"],Be=0;Be<Qe.length;Be++){var Le=Qe[Be],He=s[Le+"ref"]||Le,vt=s["a"+Le+"ref"],Rt={x:f,y:x}[Le],rr=(H+(Le==="x"?0:-90))*Math.PI/180,Lt=Ye*Math.cos(rr),Ft=be*Math.sin(rr),Gt=Math.abs(Lt)+Math.abs(Ft),Dt=s[Le+"anchor"],kt=s[Le+"shift"]*(Le==="x"?1:-1),Ue=F[Le],qe,Ve,Ae,Ne,Xe,Je=a.getRefType(He);if(Rt&&Je!=="domain"){var _t=Rt.r2fraction(s[Le]);(_t<0||_t>1)&&(vt===He?(_t=Rt.r2fraction(s["a"+Le]),(_t<0||_t>1)&&(Ge=!0)):Ge=!0),qe=Rt._offset+Rt.r2p(s[Le]),Ne=.5}else{var mt=Je==="domain";Le==="x"?(Ae=s[Le],qe=mt?Rt._offset+Rt._length*Ae:qe=L.l+L.w*Ae):(Ae=1-s[Le],qe=mt?Rt._offset+Rt._length*Ae:qe=L.t+L.h*Ae),Ne=s.showarrow?.5:Ae}if(s.showarrow){Ue.head=qe;var Ot=s["a"+Le];if(Xe=Lt*Pe(.5,s.xanchor)-Ft*Pe(.5,s.yanchor),vt===He){var Kt=a.getRefType(vt);Kt==="domain"?(Le==="y"&&(Ot=1-Ot),Ue.tail=Rt._offset+Rt._length*Ot):Kt==="paper"?Le==="y"?(Ot=1-Ot,Ue.tail=L.t+L.h*Ot):Ue.tail=L.l+L.w*Ot:Ue.tail=Rt._offset+Rt.r2p(Ot),Ve=Xe}else Ue.tail=qe+Ot,Ve=Xe+Ot;Ue.text=Ue.tail+Xe;var Nt=l[Le==="x"?"width":"height"];if(He==="paper"&&(Ue.head=M.constrain(Ue.head,1,Nt-1)),vt==="pixel"){var Wt=-Math.max(Ue.tail-3,Ue.text),qt=Math.min(Ue.tail+3,Ue.text)-Nt;Wt>0?(Ue.tail+=Wt,Ue.text+=Wt):qt>0&&(Ue.tail-=qt,Ue.text-=qt)}Ue.tail+=kt,Ue.head+=kt}else Xe=Gt*Pe(Ne,Dt),Ve=Xe,Ue.text=qe+Xe;Ue.text+=kt,Xe+=kt,Ve+=kt,s["_"+Le+"padplus"]=Gt/2+Ve,s["_"+Le+"padminus"]=Gt/2-Ve,s["_"+Le+"size"]=Gt,s["_"+Le+"shift"]=Xe}if(Ge){oe.remove();return}var Yt=0,fr=0;if(s.align!=="left"&&(Yt=(ze-Te)*(s.align==="center"?.5:1)),s.valign!=="top"&&(fr=(Oe-_e)*(s.valign==="middle"?.5:1)),pe)ue.select("svg").attr({x:N+Yt-1,y:N+fr}).call(r.setClipUrl,q?B:null,_);else{var Yr=N+fr-ge.top,hn=N+Yt-ge.left;ne.call(c.positionText,hn,Yr).call(r.setClipUrl,q?B:null,_)}$.select("rect").call(r.setRect,N,N,ze,Oe),U.call(r.setRect,re/2,re/2,Ye-re,be-re),oe.call(r.setTranslate,Math.round(F.x.text-Ye/2),Math.round(F.y.text-be/2)),J.attr({transform:"rotate("+H+","+F.x.text+","+F.y.text+")"});var Qr=function(Jt,Zt){G.selectAll(".annotation-arrow-g").remove();var Ut=F.x.head,_r=F.y.head,rt=F.x.tail+Jt,Ke=F.y.tail+Zt,st=F.x.text+Jt,lt=F.y.text+Zt,wt=M.rotationXYMatrix(H,st,lt),Pt=M.apply2DTransform(wt),ke=M.apply2DTransform2(wt),Se=+U.attr("width"),nt=+U.attr("height"),it=st-.5*Se,ct=it+Se,At=lt-.5*nt,dt=At+nt,Tt=[[it,At,it,dt],[it,dt,ct,dt],[ct,dt,ct,At],[ct,At,it,At]].map(ke);if(!Tt.reduce(function(tt,Et){return tt^!!M.segmentsIntersect(Ut,_r,Ut+1e6,_r+1e6,Et[0],Et[1],Et[2],Et[3])},!1)){Tt.forEach(function(tt){var Et=M.segmentsIntersect(rt,Ke,Ut,_r,tt[0],tt[1],tt[2],tt[3]);Et&&(rt=Et.x,Ke=Et.y)});var Ht=s.arrowwidth,ir=s.arrowcolor,kr=s.arrowside,br=G.append("g").style({opacity:n.opacity(ir)}).classed("annotation-arrow-g",!0),Mr=br.append("path").attr("d","M"+rt+","+Ke+"L"+Ut+","+_r).style("stroke-width",Ht+"px").call(n.stroke,n.rgb(ir));if(p(Mr,kr,s),T.annotationPosition&&Mr.node().parentNode&&!b){var Hr=Ut,nr=_r;if(s.standoff){var mr=Math.sqrt(Math.pow(Ut-rt,2)+Math.pow(_r-Ke,2));Hr+=s.standoff*(rt-Ut)/mr,nr+=s.standoff*(Ke-_r)/mr}var Pr=br.append("path").classed("annotation-arrow",!0).classed("anndrag",!0).classed("cursor-move",!0).attr({d:"M3,3H-3V-3H3ZM0,0L"+(rt-Hr)+","+(Ke-nr),transform:e(Hr,nr)}).style("stroke-width",Ht+6+"px").call(n.stroke,"rgba(0,0,0,0)").call(n.fill,"rgba(0,0,0,0)"),Nr,Sr;i.init({element:Pr.node(),gd:_,prepFn:function(){var tt=r.getTranslate(oe);Nr=tt.x,Sr=tt.y,f&&f.autorange&&I(f._name+".autorange",!0),x&&x.autorange&&I(x._name+".autorange",!0)},moveFn:function(tt,Et){var Vt=Pt(Nr,Sr),ar=Vt[0]+tt,Cr=Vt[1]+Et;oe.call(r.setTranslate,ar,Cr),D("x",m(f,tt,"x",L,s)),D("y",m(x,Et,"y",L,s)),s.axref===s.xref&&D("ax",m(f,tt,"ax",L,s)),s.ayref===s.yref&&D("ay",m(x,Et,"ay",L,s)),br.attr("transform",e(tt,Et)),J.attr({transform:"rotate("+H+","+ar+","+Cr+")"})},doneFn:function(){v.call("_guiRelayout",_,R());var tt=document.querySelector(".js-notes-box-panel");tt&&tt.redraw(tt.selectedObj)}})}}};if(s.showarrow&&Qr(0,0),X){var at;i.init({element:oe.node(),gd:_,prepFn:function(){at=J.attr("transform")},moveFn:function(Jt,Zt){var Ut="pointer";if(s.showarrow)s.axref===s.xref?D("ax",m(f,Jt,"ax",L,s)):D("ax",s.ax+Jt),s.ayref===s.yref?D("ay",m(x,Zt,"ay",L.w,s)):D("ay",s.ay+Zt),Qr(Jt,Zt);else{if(b)return;var _r,rt;if(f)_r=m(f,Jt,"x",L,s);else{var Ke=s._xsize/L.w,st=s.x+(s._xshift-s.xshift)/L.w-Ke/2;_r=i.align(st+Jt/L.w,Ke,0,1,s.xanchor)}if(x)rt=m(x,Zt,"y",L,s);else{var lt=s._ysize/L.h,wt=s.y-(s._yshift+s.yshift)/L.h-lt/2;rt=i.align(wt-Zt/L.h,lt,0,1,s.yanchor)}D("x",_r),D("y",rt),(!f||!x)&&(Ut=i.getCursor(f?.5:_r,x?.5:rt,s.xanchor,s.yanchor))}J.attr({transform:e(Jt,Zt)+at}),o(oe,Ut)},clickFn:function(Jt,Zt){s.captureevents&&_.emit("plotly_clickannotation",Z(Zt))},doneFn:function(){o(oe),v.call("_guiRelayout",_,R());var Jt=document.querySelector(".js-notes-box-panel");Jt&&Jt.redraw(Jt.selectedObj)}})}}T.annotationText?ne.call(c.makeEditable,{delegate:oe,gd:_}).call(ae).on("edit",function(le){s.text=le,this.call(ae),D("text",le),f&&f.autorange&&I(f._name+".autorange",!0),x&&x.autorange&&I(x._name+".autorange",!0),v.call("_guiRelayout",_,R())}):ne.call(ae)}},{"../../lib":515,"../../lib/setcursor":536,"../../lib/svg_text_utils":541,"../../plot_api/plot_template":555,"../../plots/cartesian/axes":566,"../../plots/plots":628,"../../registry":647,"../color":367,"../dragelement":386,"../drawing":389,"../fx":407,"./draw_arrow_head":357,"@plotly/d3":58}],357:[function(d,ee,te){var w=d("@plotly/d3"),v=d("../color"),S=d("./arrow_paths"),M=d("../../lib"),e=M.strScale,a=M.strRotate,n=M.strTranslate;ee.exports=function(t,c,o){var i=t.node(),y=S[o.arrowhead||0],p=S[o.startarrowhead||0],g=(o.arrowwidth||1)*(o.arrowsize||1),h=(o.arrowwidth||1)*(o.startarrowsize||1),m=c.indexOf("start")>=0,u=c.indexOf("end")>=0,_=y.backoff*g+o.standoff,s=p.backoff*h+o.startstandoff,A,b,f,x;if(i.nodeName==="line"){A={x:+t.attr("x1"),y:+t.attr("y1")},b={x:+t.attr("x2"),y:+t.attr("y2")};var l=A.x-b.x,L=A.y-b.y;if(f=Math.atan2(L,l),x=f+Math.PI,_&&s&&_+s>Math.sqrt(l*l+L*L)){J();return}if(_){if(_*_>l*l+L*L){J();return}var T=_*Math.cos(f),k=_*Math.sin(f);b.x+=T,b.y+=k,t.attr({x2:b.x,y2:b.y})}if(s){if(s*s>l*l+L*L){J();return}var P=s*Math.cos(f),z=s*Math.sin(f);A.x-=P,A.y-=z,t.attr({x1:A.x,y1:A.y})}}else if(i.nodeName==="path"){var I=i.getTotalLength(),D="";if(I<_+s){J();return}var R=i.getPointAtLength(0),B=i.getPointAtLength(.1);f=Math.atan2(R.y-B.y,R.x-B.x),A=i.getPointAtLength(Math.min(s,I)),D="0px,"+s+"px,";var F=i.getPointAtLength(I),H=i.getPointAtLength(I-.1);x=Math.atan2(F.y-H.y,F.x-H.x),b=i.getPointAtLength(Math.max(0,I-_));var G=D?s+_:_;D+=I-G+"px,"+I+"px",t.style("stroke-dasharray",D)}function J(){t.style("stroke-dasharray","0px,100px")}function X(Y,Z,oe,re){!Y.path||(Y.noRotate&&(oe=0),w.select(i.parentNode).append("path").attr({class:t.attr("class"),d:Y.path,transform:n(Z.x,Z.y)+a(oe*180/Math.PI)+e(re)}).style({fill:v.rgb(o.arrowcolor),"stroke-width":0}))}m&&X(p,A,f,h),u&&X(y,b,x,g)}},{"../../lib":515,"../color":367,"./arrow_paths":349,"@plotly/d3":58}],358:[function(d,ee,te){var w=d("./draw"),v=d("./click");ee.exports={moduleType:"component",name:"annotations",layoutAttributes:d("./attributes"),supplyLayoutDefaults:d("./defaults"),includeBasePlot:d("../../plots/cartesian/include_components")("annotations"),calcAutorange:d("./calc_autorange"),draw:w.draw,drawOne:w.drawOne,drawRaw:w.drawRaw,hasClickToShow:v.hasClickToShow,onClick:v.onClick,convertCoords:d("./convert_coords")}},{"../../plots/cartesian/include_components":577,"./attributes":350,"./calc_autorange":351,"./click":352,"./convert_coords":354,"./defaults":355,"./draw":356}],359:[function(d,ee,te){var w=d("../annotations/attributes"),v=d("../../plot_api/edit_types").overrideAll,S=d("../../plot_api/plot_template").templatedArray;ee.exports=v(S("annotation",{visible:w.visible,x:{valType:"any"},y:{valType:"any"},z:{valType:"any"},ax:{valType:"number"},ay:{valType:"number"},xanchor:w.xanchor,xshift:w.xshift,yanchor:w.yanchor,yshift:w.yshift,text:w.text,textangle:w.textangle,font:w.font,width:w.width,height:w.height,opacity:w.opacity,align:w.align,valign:w.valign,bgcolor:w.bgcolor,bordercolor:w.bordercolor,borderpad:w.borderpad,borderwidth:w.borderwidth,showarrow:w.showarrow,arrowcolor:w.arrowcolor,arrowhead:w.arrowhead,startarrowhead:w.startarrowhead,arrowside:w.arrowside,arrowsize:w.arrowsize,startarrowsize:w.startarrowsize,arrowwidth:w.arrowwidth,standoff:w.standoff,startstandoff:w.startstandoff,hovertext:w.hovertext,hoverlabel:w.hoverlabel,captureevents:w.captureevents}),"calc","from-root")},{"../../plot_api/edit_types":548,"../../plot_api/plot_template":555,"../annotations/attributes":350}],360:[function(d,ee,te){var w=d("../../lib"),v=d("../../plots/cartesian/axes");ee.exports=function(e){for(var a=e.fullSceneLayout,n=a.annotations,r=0;r<n.length;r++)S(n[r],e);e.fullLayout._infolayer.selectAll(".annotation-"+e.id).remove()};function S(M,e){var a=e.fullSceneLayout,n=a.domain,r=e.fullLayout._size,t={pdata:null,type:"linear",autorange:!1,range:[-1/0,1/0]};M._xa={},w.extendFlat(M._xa,t),v.setConvert(M._xa),M._xa._offset=r.l+n.x[0]*r.w,M._xa.l2p=function(){return .5*(1+M._pdata[0]/M._pdata[3])*r.w*(n.x[1]-n.x[0])},M._ya={},w.extendFlat(M._ya,t),v.setConvert(M._ya),M._ya._offset=r.t+(1-n.y[1])*r.h,M._ya.l2p=function(){return .5*(1-M._pdata[1]/M._pdata[3])*r.h*(n.y[1]-n.y[0])}}},{"../../lib":515,"../../plots/cartesian/axes":566}],361:[function(d,ee,te){var w=d("../../lib"),v=d("../../plots/cartesian/axes"),S=d("../../plots/array_container_defaults"),M=d("../annotations/common_defaults"),e=d("./attributes");ee.exports=function(r,t,c){S(r,t,{name:"annotations",handleItemDefaults:a,fullLayout:c.fullLayout})};function a(n,r,t,c){function o(p,g){return w.coerce(n,r,e,p,g)}function i(p){var g=p+"axis",h={_fullLayout:{}};return h._fullLayout[g]=t[g],v.coercePosition(r,h,o,p,p,.5)}var y=o("visible");!y||(M(n,r,c.fullLayout,o),i("x"),i("y"),i("z"),w.noneOrAll(n,r,["x","y","z"]),r.xref="x",r.yref="y",r.zref="z",o("xanchor"),o("yanchor"),o("xshift"),o("yshift"),r.showarrow&&(r.axref="pixel",r.ayref="pixel",o("ax",-10),o("ay",-30),w.noneOrAll(n,r,["ax","ay"])))}},{"../../lib":515,"../../plots/array_container_defaults":561,"../../plots/cartesian/axes":566,"../annotations/common_defaults":353,"./attributes":359}],362:[function(d,ee,te){var w=d("../annotations/draw").drawRaw,v=d("../../plots/gl3d/project"),S=["x","y","z"];ee.exports=function(e){for(var a=e.fullSceneLayout,n=e.dataScale,r=a.annotations,t=0;t<r.length;t++){for(var c=r[t],o=!1,i=0;i<3;i++){var y=S[i],p=c[y],g=a[y+"axis"],h=g.r2fraction(p);if(h<0||h>1){o=!0;break}}o?e.fullLayout._infolayer.select(".annotation-"+e.id+'[data-index="'+t+'"]').remove():(c._pdata=v(e.glplot.cameraParams,[a.xaxis.r2l(c.x)*n[0],a.yaxis.r2l(c.y)*n[1],a.zaxis.r2l(c.z)*n[2]]),w(e.graphDiv,c,t,e.id,c._xa,c._ya))}}},{"../../plots/gl3d/project":616,"../annotations/draw":356}],363:[function(d,ee,te){var w=d("../../registry"),v=d("../../lib");ee.exports={moduleType:"component",name:"annotations3d",schema:{subplots:{scene:{annotations:d("./attributes")}}},layoutAttributes:d("./attributes"),handleDefaults:d("./defaults"),includeBasePlot:S,convert:d("./convert"),draw:d("./draw")};function S(M,e){var a=w.subplotsRegistry.gl3d;if(!!a)for(var n=a.attrRegex,r=Object.keys(M),t=0;t<r.length;t++){var c=r[t];n.test(c)&&(M[c].annotations||[]).length&&(v.pushUnique(e._basePlotModules,a),v.pushUnique(e._subplots.gl3d,c))}}},{"../../lib":515,"../../registry":647,"./attributes":359,"./convert":360,"./defaults":361,"./draw":362}],364:[function(d,ee,te){ee.exports=d("world-calendars/dist/main"),d("world-calendars/dist/plus"),d("world-calendars/dist/calendars/chinese"),d("world-calendars/dist/calendars/coptic"),d("world-calendars/dist/calendars/discworld"),d("world-calendars/dist/calendars/ethiopian"),d("world-calendars/dist/calendars/hebrew"),d("world-calendars/dist/calendars/islamic"),d("world-calendars/dist/calendars/julian"),d("world-calendars/dist/calendars/mayan"),d("world-calendars/dist/calendars/nanakshahi"),d("world-calendars/dist/calendars/nepali"),d("world-calendars/dist/calendars/persian"),d("world-calendars/dist/calendars/taiwan"),d("world-calendars/dist/calendars/thai"),d("world-calendars/dist/calendars/ummalqura")},{"world-calendars/dist/calendars/chinese":333,"world-calendars/dist/calendars/coptic":334,"world-calendars/dist/calendars/discworld":335,"world-calendars/dist/calendars/ethiopian":336,"world-calendars/dist/calendars/hebrew":337,"world-calendars/dist/calendars/islamic":338,"world-calendars/dist/calendars/julian":339,"world-calendars/dist/calendars/mayan":340,"world-calendars/dist/calendars/nanakshahi":341,"world-calendars/dist/calendars/nepali":342,"world-calendars/dist/calendars/persian":343,"world-calendars/dist/calendars/taiwan":344,"world-calendars/dist/calendars/thai":345,"world-calendars/dist/calendars/ummalqura":346,"world-calendars/dist/main":347,"world-calendars/dist/plus":348}],365:[function(d,ee,te){var w=d("./calendars"),v=d("../../lib"),S=d("../../constants/numerical"),M=S.EPOCHJD,e=S.ONEDAY,a={valType:"enumerated",values:v.sortObjectKeys(w.calendars),editType:"calc",dflt:"gregorian"},n=function(f,x,l,L){var T={};return T[l]=a,v.coerce(f,x,T,l,L)},r=function(f,x,l,L){for(var T=0;T<l.length;T++)n(f,x,l[T]+"calendar",L.calendar)},t={chinese:"2000-01-01",coptic:"2000-01-01",discworld:"2000-01-01",ethiopian:"2000-01-01",hebrew:"5000-01-01",islamic:"1000-01-01",julian:"2000-01-01",mayan:"5000-01-01",nanakshahi:"1000-01-01",nepali:"2000-01-01",persian:"1000-01-01",jalali:"1000-01-01",taiwan:"1000-01-01",thai:"2000-01-01",ummalqura:"1400-01-01"},c={chinese:"2000-01-02",coptic:"2000-01-03",discworld:"2000-01-03",ethiopian:"2000-01-05",hebrew:"5000-01-01",islamic:"1000-01-02",julian:"2000-01-03",mayan:"5000-01-01",nanakshahi:"1000-01-05",nepali:"2000-01-05",persian:"1000-01-01",jalali:"1000-01-01",taiwan:"1000-01-04",thai:"2000-01-04",ummalqura:"1400-01-06"},o={chinese:["2000-01-01","2001-01-01"],coptic:["1700-01-01","1701-01-01"],discworld:["1800-01-01","1801-01-01"],ethiopian:["2000-01-01","2001-01-01"],hebrew:["5700-01-01","5701-01-01"],islamic:["1400-01-01","1401-01-01"],julian:["2000-01-01","2001-01-01"],mayan:["5200-01-01","5201-01-01"],nanakshahi:["0500-01-01","0501-01-01"],nepali:["2000-01-01","2001-01-01"],persian:["1400-01-01","1401-01-01"],jalali:["1400-01-01","1401-01-01"],taiwan:["0100-01-01","0101-01-01"],thai:["2500-01-01","2501-01-01"],ummalqura:["1400-01-01","1401-01-01"]},i="##",y={d:{0:"dd","-":"d"},e:{0:"d","-":"d"},a:{0:"D","-":"D"},A:{0:"DD","-":"DD"},j:{0:"oo","-":"o"},W:{0:"ww","-":"w"},m:{0:"mm","-":"m"},b:{0:"M","-":"M"},B:{0:"MM","-":"MM"},y:{0:"yy","-":"yy"},Y:{0:"yyyy","-":"yyyy"},U:i,w:i,c:{0:"D M d %X yyyy","-":"D M d %X yyyy"},x:{0:"mm/dd/yyyy","-":"mm/dd/yyyy"}};function p(f,x,l){for(var L=Math.floor((x+.05)/e)+M,T=h(l).fromJD(L),k=0,P,z,I,D,R;(k=f.indexOf("%",k))!==-1;)P=f.charAt(k+1),P==="0"||P==="-"||P==="_"?(I=3,z=f.charAt(k+2),P==="_"&&(P="-")):(z=P,P="0",I=2),D=y[z],D?(D===i?R=i:R=T.formatDate(D[P]),f=f.substr(0,k)+R+f.substr(k+I),k+=R.length):k+=I;return f}var g={};function h(f){var x=g[f];return x||(x=g[f]=w.instance(f),x)}function m(f){return v.extendFlat({},a,{description:f})}function u(f){return"Sets the calendar system to use with `"+f+"` date data."}var _={xcalendar:m(u("x"))},s=v.extendFlat({},_,{ycalendar:m(u("y"))}),A=v.extendFlat({},s,{zcalendar:m(u("z"))}),b=m(["Sets the calendar system to use for `range` and `tick0`","if this is a date axis. This does not set the calendar for","interpreting data on this axis, that's specified in the trace","or via the global `layout.calendar`"].join(" "));ee.exports={moduleType:"component",name:"calendars",schema:{traces:{scatter:s,bar:s,box:s,heatmap:s,contour:s,histogram:s,histogram2d:s,histogram2dcontour:s,scatter3d:A,surface:A,mesh3d:A,scattergl:s,ohlc:_,candlestick:_},layout:{calendar:m(["Sets the default calendar system to use for interpreting and","displaying dates throughout the plot."].join(" "))},subplots:{xaxis:{calendar:b},yaxis:{calendar:b},scene:{xaxis:{calendar:b},yaxis:{calendar:b},zaxis:{calendar:b}},polar:{radialaxis:{calendar:b}}},transforms:{filter:{valuecalendar:m(["WARNING: All transforms are deprecated and may be removed from the API in next major version.","Sets the calendar system to use for `value`, if it is a date."].join(" ")),targetcalendar:m(["WARNING: All transforms are deprecated and may be removed from the API in next major version.","Sets the calendar system to use for `target`, if it is an","array of dates. If `target` is a string (eg *x*) we use the","corresponding trace attribute (eg `xcalendar`) if it exists,","even if `targetcalendar` is provided."].join(" "))}}},layoutAttributes:a,handleDefaults:n,handleTraceDefaults:r,CANONICAL_SUNDAY:c,CANONICAL_TICK:t,DFLTRANGE:o,getCal:h,worldCalFmt:p}},{"../../constants/numerical":491,"../../lib":515,"./calendars":364}],366:[function(d,ee,te){te.defaults=["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"],te.defaultLine="#444",te.lightLine="#eee",te.background="#fff",te.borderLine="#BEC8D9",te.lightFraction=100*(14-4)/(15-4)},{}],367:[function(d,ee,te){var w=d("tinycolor2"),v=d("fast-isnumeric"),S=d("../../lib/array").isTypedArray,M=ee.exports={},e=d("./attributes");M.defaults=e.defaults;var a=M.defaultLine=e.defaultLine;M.lightLine=e.lightLine;var n=M.background=e.background;M.tinyRGB=function(t){var c=t.toRgb();return"rgb("+Math.round(c.r)+", "+Math.round(c.g)+", "+Math.round(c.b)+")"},M.rgb=function(t){return M.tinyRGB(w(t))},M.opacity=function(t){return t?w(t).getAlpha():0},M.addOpacity=function(t,c){var o=w(t).toRgb();return"rgba("+Math.round(o.r)+", "+Math.round(o.g)+", "+Math.round(o.b)+", "+c+")"},M.combine=function(t,c){var o=w(t).toRgb();if(o.a===1)return w(t).toRgbString();var i=w(c||n).toRgb(),y=i.a===1?i:{r:255*(1-i.a)+i.r*i.a,g:255*(1-i.a)+i.g*i.a,b:255*(1-i.a)+i.b*i.a},p={r:y.r*(1-o.a)+o.r*o.a,g:y.g*(1-o.a)+o.g*o.a,b:y.b*(1-o.a)+o.b*o.a};return w(p).toRgbString()},M.contrast=function(t,c,o){var i=w(t);i.getAlpha()!==1&&(i=w(M.combine(t,n)));var y=i.isDark()?c?i.lighten(c):n:o?i.darken(o):a;return y.toString()},M.stroke=function(t,c){var o=w(c);t.style({stroke:M.tinyRGB(o),"stroke-opacity":o.getAlpha()})},M.fill=function(t,c){var o=w(c);t.style({fill:M.tinyRGB(o),"fill-opacity":o.getAlpha()})},M.clean=function(t){if(!(!t||typeof t!="object")){var c=Object.keys(t),o,i,y,p;for(o=0;o<c.length;o++)if(y=c[o],p=t[y],y.substr(y.length-5)==="color")if(Array.isArray(p))for(i=0;i<p.length;i++)p[i]=r(p[i]);else t[y]=r(p);else if(y.substr(y.length-10)==="colorscale"&&Array.isArray(p))for(i=0;i<p.length;i++)Array.isArray(p[i])&&(p[i][1]=r(p[i][1]));else if(Array.isArray(p)){var g=p[0];if(!Array.isArray(g)&&g&&typeof g=="object")for(i=0;i<p.length;i++)M.clean(p[i])}else p&&typeof p=="object"&&!S(p)&&M.clean(p)}};function r(t){if(v(t)||typeof t!="string")return t;var c=t.trim();if(c.substr(0,3)!=="rgb")return t;var o=c.match(/^rgba?\s*\(([^()]*)\)$/);if(!o)return t;var i=o[1].trim().split(/\s*[\s,]\s*/),y=c.charAt(3)==="a"&&i.length===4;if(!y&&i.length!==3)return t;for(var p=0;p<i.length;p++){if(!i[p].length||(i[p]=Number(i[p]),!(i[p]>=0)))return t;if(p===3)i[p]>1&&(i[p]=1);else if(i[p]>=1)return t}var g=Math.round(i[0]*255)+", "+Math.round(i[1]*255)+", "+Math.round(i[2]*255);return y?"rgba("+g+", "+i[3]+")":"rgb("+g+")"}},{"../../lib/array":497,"./attributes":366,"fast-isnumeric":190,tinycolor2:313}],368:[function(d,ee,te){var w=d("../../plots/cartesian/layout_attributes"),v=d("../../plots/font_attributes"),S=d("../../lib/extend").extendFlat,M=d("../../plot_api/edit_types").overrideAll;ee.exports=M({orientation:{valType:"enumerated",values:["h","v"],dflt:"v"},thicknessmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"pixels"},thickness:{valType:"number",min:0,dflt:30},lenmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"fraction"},len:{valType:"number",min:0,dflt:1},x:{valType:"number",min:-2,max:3},xanchor:{valType:"enumerated",values:["left","center","right"]},xpad:{valType:"number",min:0,dflt:10},y:{valType:"number",min:-2,max:3},yanchor:{valType:"enumerated",values:["top","middle","bottom"]},ypad:{valType:"number",min:0,dflt:10},outlinecolor:w.linecolor,outlinewidth:w.linewidth,bordercolor:w.linecolor,borderwidth:{valType:"number",min:0,dflt:0},bgcolor:{valType:"color",dflt:"rgba(0,0,0,0)"},tickmode:w.tickmode,nticks:w.nticks,tick0:w.tick0,dtick:w.dtick,tickvals:w.tickvals,ticktext:w.ticktext,ticks:S({},w.ticks,{dflt:""}),ticklabeloverflow:S({},w.ticklabeloverflow,{}),ticklabelposition:{valType:"enumerated",values:["outside","inside","outside top","inside top","outside left","inside left","outside right","inside right","outside bottom","inside bottom"],dflt:"outside"},ticklen:w.ticklen,tickwidth:w.tickwidth,tickcolor:w.tickcolor,ticklabelstep:w.ticklabelstep,showticklabels:w.showticklabels,tickfont:v({}),tickangle:w.tickangle,tickformat:w.tickformat,tickformatstops:w.tickformatstops,tickprefix:w.tickprefix,showtickprefix:w.showtickprefix,ticksuffix:w.ticksuffix,showticksuffix:w.showticksuffix,separatethousands:w.separatethousands,exponentformat:w.exponentformat,minexponent:w.minexponent,showexponent:w.showexponent,title:{text:{valType:"string"},font:v({}),side:{valType:"enumerated",values:["right","top","bottom"]}},_deprecated:{title:{valType:"string"},titlefont:v({}),titleside:{valType:"enumerated",values:["right","top","bottom"],dflt:"top"}}},"colorbars","from-root")},{"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plots/cartesian/layout_attributes":579,"../../plots/font_attributes":594}],369:[function(d,ee,te){ee.exports={cn:{colorbar:"colorbar",cbbg:"cbbg",cbfill:"cbfill",cbfills:"cbfills",cbline:"cbline",cblines:"cblines",cbaxis:"cbaxis",cbtitleunshift:"cbtitleunshift",cbtitle:"cbtitle",cboutline:"cboutline",crisp:"crisp",jsPlaceholder:"js-placeholder"}}},{}],370:[function(d,ee,te){var w=d("../../lib"),v=d("../../plot_api/plot_template"),S=d("../../plots/cartesian/tick_value_defaults"),M=d("../../plots/cartesian/tick_mark_defaults"),e=d("../../plots/cartesian/tick_label_defaults"),a=d("../../plots/cartesian/prefix_suffix_defaults"),n=d("./attributes");ee.exports=function(t,c,o){var i=v.newContainer(c,"colorbar"),y=t.colorbar||{};function p(T,k){return w.coerce(y,i,n,T,k)}var g=o.margin||{t:0,b:0,l:0,r:0},h=o.width-g.l-g.r,m=o.height-g.t-g.b,u=p("orientation"),_=u==="v",s=p("thicknessmode");p("thickness",s==="fraction"?30/(_?h:m):30);var A=p("lenmode");p("len",A==="fraction"?1:_?m:h),p("x",_?1.02:.5),p("xanchor",_?"left":"center"),p("xpad"),p("y",_?.5:1.02),p("yanchor",_?"middle":"bottom"),p("ypad"),w.noneOrAll(y,i,["x","y"]),p("outlinecolor"),p("outlinewidth"),p("bordercolor"),p("borderwidth"),p("bgcolor");var b=w.coerce(y,i,{ticklabelposition:{valType:"enumerated",dflt:"outside",values:_?["outside","inside","outside top","inside top","outside bottom","inside bottom"]:["outside","inside","outside left","inside left","outside right","inside right"]}},"ticklabelposition");p("ticklabeloverflow",b.indexOf("inside")!==-1?"hide past domain":"hide past div"),S(y,i,p,"linear");var f=o.font,x={outerTicks:!1,font:f};b.indexOf("inside")!==-1&&(x.bgColor="black"),a(y,i,p,"linear",x),e(y,i,p,"linear",x),M(y,i,p,"linear",x),p("title.text",o._dfltTitle.colorbar);var l=i.tickfont,L=w.extendFlat({},l,{color:f.color,size:w.bigFont(l.size)});w.coerceFont(p,"title.font",L),p("title.side",_?"top":"right")}},{"../../lib":515,"../../plot_api/plot_template":555,"../../plots/cartesian/prefix_suffix_defaults":583,"../../plots/cartesian/tick_label_defaults":587,"../../plots/cartesian/tick_mark_defaults":588,"../../plots/cartesian/tick_value_defaults":589,"./attributes":368}],371:[function(d,ee,te){var w=d("@plotly/d3"),v=d("tinycolor2"),S=d("../../plots/plots"),M=d("../../registry"),e=d("../../plots/cartesian/axes"),a=d("../dragelement"),n=d("../../lib"),r=n.strTranslate,t=d("../../lib/extend").extendFlat,c=d("../../lib/setcursor"),o=d("../drawing"),i=d("../color"),y=d("../titles"),p=d("../../lib/svg_text_utils"),g=d("../colorscale/helpers").flipScale,h=d("../../plots/cartesian/axis_defaults"),m=d("../../plots/cartesian/position_defaults"),u=d("../../plots/cartesian/layout_attributes"),_=d("../../constants/alignment"),s=_.LINE_SPACING,A=_.FROM_TL,b=_.FROM_BR,f=d("./constants").cn;function x(z){var I=z._fullLayout,D=I._infolayer.selectAll("g."+f.colorbar).data(l(z),function(R){return R._id});D.enter().append("g").attr("class",function(R){return R._id}).classed(f.colorbar,!0),D.each(function(R){var B=w.select(this);n.ensureSingle(B,"rect",f.cbbg),n.ensureSingle(B,"g",f.cbfills),n.ensureSingle(B,"g",f.cblines),n.ensureSingle(B,"g",f.cbaxis,function(H){H.classed(f.crisp,!0)}),n.ensureSingle(B,"g",f.cbtitleunshift,function(H){H.append("g").classed(f.cbtitle,!0)}),n.ensureSingle(B,"rect",f.cboutline);var F=L(B,R,z);F&&F.then&&(z._promises||[]).push(F),z._context.edits.colorbarPosition&&T(B,R,z)}),D.exit().each(function(R){S.autoMargin(z,R._id)}).remove(),D.order()}function l(z){var I=z._fullLayout,D=z.calcdata,R=[],B,F,H,G;function J(W){return t(W,{_fillcolor:null,_line:{color:null,width:null,dash:null},_levels:{start:null,end:null,size:null},_filllevels:null,_fillgradient:null,_zrange:null})}function X(){typeof G.calc=="function"?G.calc(z,H,B):(B._fillgradient=F.reversescale?g(F.colorscale):F.colorscale,B._zrange=[F[G.min],F[G.max]])}for(var Y=0;Y<D.length;Y++){var Z=D[Y];H=Z[0].trace;var oe=H._module.colorbar;if(H.visible===!0&&oe)for(var re=Array.isArray(oe),se=re?oe:[oe],N=0;N<se.length;N++){G=se[N];var U=G.container;F=U?H[U]:H,F&&F.showscale&&(B=J(F.colorbar),B._id="cb"+H.uid+(re&&U?"-"+U:""),B._traceIndex=H.index,B._propPrefix=(U?U+".":"")+"colorbar.",B._meta=H._meta,X(),R.push(B))}}for(var q in I._colorAxes)if(F=I[q],F.showscale){var $=I._colorAxes[q];B=J(F.colorbar),B._id="cb"+q,B._propPrefix=q+".colorbar.",B._meta=I._meta,G={min:"cmin",max:"cmax"},$[0]!=="heatmap"&&(H=$[1],G.calc=H._module.colorbar.calc),X(),R.push(B)}return R}function L(z,I,D){var R=I.orientation==="v",B=I.len,F=I.lenmode,H=I.thickness,G=I.thicknessmode,J=I.outlinewidth,X=I.borderwidth,Y=I.bgcolor,Z=I.xanchor,oe=I.yanchor,re=I.xpad,se=I.ypad,N=I.x,U=R?I.y:1-I.y,q=D._fullLayout,$=q._size,W=I._fillcolor,K=I._line,ne=I.title,ae=ne.side,ie=I._zrange||w.extent((typeof W=="function"?W:K.color).domain()),le=typeof K.color=="function"?K.color:function(){return K.color},ye=typeof W=="function"?W:function(){return W},ue=I._levels,pe=k(D,I,ie),ge=pe.fill,Te=pe.line,_e=Math.round(H*(G==="fraction"?R?$.w:$.h:1)),ze=_e/(R?$.w:$.h),Oe=Math.round(B*(F==="fraction"?R?$.h:$.w:1)),Ye=Oe/(R?$.h:$.w),be=Math.round(R?N*$.w+re:U*$.h+se),Pe={center:.5,right:1}[Z]||0,Ge={top:1,middle:.5}[oe]||0,Qe=R?N-Pe*ze:U-Ge*ze,Be=R?U-Ge*Ye:N-Pe*Ye,Le=Math.round(R?$.h*(1-Be):$.w*Be);I._lenFrac=Ye,I._thickFrac=ze,I._uFrac=Qe,I._vFrac=Be;var He=I._axis=P(D,I,ie);He.position=ze+(R?N+re/$.w:U+se/$.h);var vt=["top","bottom"].indexOf(ae)!==-1;if(R&&vt&&(He.title.side=ae,He.titlex=N+re/$.w,He.titley=Be+(ne.side==="top"?Ye-se/$.h:se/$.h)),!R&&!vt&&(He.title.side=ae,He.titley=U+se/$.h,He.titlex=Be+re/$.w),K.color&&I.tickmode==="auto"){He.tickmode="linear",He.tick0=ue.start;var Rt=ue.size,rr=n.constrain(Oe/50,4,15)+1,Lt=(ie[1]-ie[0])/((I.nticks||rr)*Rt);if(Lt>1){var Ft=Math.pow(10,Math.floor(Math.log(Lt)/Math.LN10));Rt*=Ft*n.roundUp(Lt/Ft,[2,5,10]),(Math.abs(ue.start)/ue.size+1e-6)%1<2e-6&&(He.tick0=0)}He.dtick=Rt}He.domain=R?[Be+se/$.h,Be+Ye-se/$.h]:[Be+re/$.w,Be+Ye-re/$.w],He.setScale(),z.attr("transform",r(Math.round($.l),Math.round($.t)));var Gt=z.select("."+f.cbtitleunshift).attr("transform",r(-Math.round($.l),-Math.round($.t))),Dt=He.ticklabelposition,kt=He.title.font.size,Ue=z.select("."+f.cbaxis),qe,Ve=0,Ae=0;function Ne(Ot,Kt){var Nt={propContainer:He,propName:I._propPrefix+"title",traceIndex:I._traceIndex,_meta:I._meta,placeholder:q._dfltTitle.colorbar,containerGroup:z.select("."+f.cbtitle)},Wt=Ot.charAt(0)==="h"?Ot.substr(1):"h"+Ot;z.selectAll("."+Wt+",."+Wt+"-math-group").remove(),y.draw(D,Ot,t(Nt,Kt||{}))}function Xe(){if(R&&vt||!R&&!vt){var Ot,Kt;ae==="top"&&(Ot=re+$.l+$.w*N,Kt=se+$.t+$.h*(1-Be-Ye)+3+kt*.75),ae==="bottom"&&(Ot=re+$.l+$.w*N,Kt=se+$.t+$.h*(1-Be)-3-kt*.25),ae==="right"&&(Kt=se+$.t+$.h*U+3+kt*.75,Ot=re+$.l+$.w*Be),Ne(He._id+"title",{attributes:{x:Ot,y:Kt,"text-anchor":R?"start":"middle"}})}}function Je(){if(R&&!vt||!R&&vt){var Ot=He.position||0,Kt=He._offset+He._length/2,Nt,Wt;if(ae==="right")Wt=Kt,Nt=$.l+$.w*Ot+10+kt*(He.showticklabels?1:.5);else if(Nt=Kt,ae==="bottom"&&(Wt=$.t+$.h*Ot+10+(Dt.indexOf("inside")===-1?He.tickfont.size:0)+(He.ticks!=="intside"&&I.ticklen||0)),ae==="top"){var qt=ne.text.split("<br>").length;Wt=$.t+$.h*Ot+10-_e-s*kt*qt}Ne((R?"h":"v")+He._id+"title",{avoid:{selection:w.select(D).selectAll("g."+He._id+"tick"),side:ae,offsetTop:R?0:$.t,offsetLeft:R?$.l:0,maxShift:R?q.width:q.height},attributes:{x:Nt,y:Wt,"text-anchor":"middle"},transform:{rotate:R?-90:0,offset:0}})}}function _t(){if(!R&&!vt||R&&vt){var Ot=z.select("."+f.cbtitle),Kt=Ot.select("text"),Nt=[-J/2,J/2],Wt=Ot.select(".h"+He._id+"title-math-group").node(),qt=15.6;Kt.node()&&(qt=parseInt(Kt.node().style.fontSize,10)*s);var Yt;if(Wt?(Yt=o.bBox(Wt),Ae=Yt.width,Ve=Yt.height,Ve>qt&&(Nt[1]-=(Ve-qt)/2)):Kt.node()&&!Kt.classed(f.jsPlaceholder)&&(Yt=o.bBox(Kt.node()),Ae=Yt.width,Ve=Yt.height),R){if(Ve){if(Ve+=5,ae==="top")He.domain[1]-=Ve/$.h,Nt[1]*=-1;else{He.domain[0]+=Ve/$.h;var fr=p.lineCount(Kt);Nt[1]+=(1-fr)*qt}Ot.attr("transform",r(Nt[0],Nt[1])),He.setScale()}}else Ae&&(ae==="right"&&(He.domain[0]+=(Ae+kt/2)/$.w),Ot.attr("transform",r(Nt[0],Nt[1])),He.setScale())}z.selectAll("."+f.cbfills+",."+f.cblines).attr("transform",R?r(0,Math.round($.h*(1-He.domain[1]))):r(Math.round($.w*He.domain[0]),0)),Ue.attr("transform",R?r(0,Math.round(-$.t)):r(Math.round(-$.l),0));var Yr=z.select("."+f.cbfills).selectAll("rect."+f.cbfill).attr("style","").data(ge);Yr.enter().append("rect").classed(f.cbfill,!0).style("stroke","none"),Yr.exit().remove();var hn=ie.map(He.c2p).map(Math.round).sort(function(Ut,_r){return Ut-_r});Yr.each(function(Ut,_r){var rt=[_r===0?ie[0]:(ge[_r]+ge[_r-1])/2,_r===ge.length-1?ie[1]:(ge[_r]+ge[_r+1])/2].map(He.c2p).map(Math.round);R&&(rt[1]=n.constrain(rt[1]+(rt[1]>rt[0])?1:-1,hn[0],hn[1]));var Ke=w.select(this).attr(R?"x":"y",be).attr(R?"y":"x",w.min(rt)).attr(R?"width":"height",Math.max(_e,2)).attr(R?"height":"width",Math.max(w.max(rt)-w.min(rt),2));if(I._fillgradient)o.gradient(Ke,D,I._id,R?"vertical":"horizontalreversed",I._fillgradient,"fill");else{var st=ye(Ut).replace("e-","");Ke.attr("fill",v(st).toHexString())}});var Qr=z.select("."+f.cblines).selectAll("path."+f.cbline).data(K.color&&K.width?Te:[]);Qr.enter().append("path").classed(f.cbline,!0),Qr.exit().remove(),Qr.each(function(Ut){var _r=be,rt=Math.round(He.c2p(Ut))+K.width/2%1;w.select(this).attr("d","M"+(R?_r+","+rt:rt+","+_r)+(R?"h":"v")+_e).call(o.lineGroupStyle,K.width,le(Ut),K.dash)}),Ue.selectAll("g."+He._id+"tick,path").remove();var at=be+_e+(J||0)/2-(I.ticks==="outside"?1:0),Jt=e.calcTicks(He),Zt=e.getTickSigns(He)[2];return e.drawTicks(D,He,{vals:He.ticks==="inside"?e.clipEnds(He,Jt):Jt,layer:Ue,path:e.makeTickPath(He,at,Zt),transFn:e.makeTransTickFn(He)}),e.drawLabels(D,He,{vals:Jt,layer:Ue,transFn:e.makeTransTickLabelFn(He),labelFns:e.makeLabelFns(He,at)})}function mt(){var Ot,Kt=_e+J/2;Dt.indexOf("inside")===-1&&(Ot=o.bBox(Ue.node()),Kt+=R?Ot.width:Ot.height),qe=Gt.select("text");var Nt=0,Wt=R&&ae==="top",qt=!R&&ae==="right",Yt=0;if(qe.node()&&!qe.classed(f.jsPlaceholder)){var fr,Yr=Gt.select(".h"+He._id+"title-math-group").node();Yr&&(R&&vt||!R&&!vt)?(Ot=o.bBox(Yr),Nt=Ot.width,fr=Ot.height):(Ot=o.bBox(Gt.node()),Nt=Ot.right-$.l-(R?be:Le),fr=Ot.bottom-$.t-(R?Le:be),!R&&ae==="top"&&(Kt+=Ot.height,Yt=Ot.height)),qt&&(qe.attr("transform",r(Nt/2+kt/2,0)),Nt*=2),Kt=Math.max(Kt,R?Nt:fr)}var hn=(R?re:se)*2+Kt+X+J/2,Qr=0;!R&&ne.text&&oe==="bottom"&&U<=0&&(Qr=hn/2,hn+=Qr,Yt+=Qr),q._hColorbarMoveTitle=Qr,q._hColorbarMoveCBTitle=Yt;var at=X+J;z.select("."+f.cbbg).attr("x",(R?be:Le)-at/2-(R?re:0)).attr("y",(R?Le:be)-(R?Oe:se+Yt-Qr)).attr(R?"width":"height",Math.max(hn-Qr,2)).attr(R?"height":"width",Math.max(Oe+at,2)).call(i.fill,Y).call(i.stroke,I.bordercolor).style("stroke-width",X);var Jt=qt?Math.max(Nt-10,0):0;if(z.selectAll("."+f.cboutline).attr("x",(R?be:Le+re)+Jt).attr("y",(R?Le+se-Oe:be)+(Wt?Ve:0)).attr(R?"width":"height",Math.max(_e,2)).attr(R?"height":"width",Math.max(Oe-(R?2*se+Ve:2*re+Jt),2)).call(i.stroke,I.outlinecolor).style({fill:"none","stroke-width":J}),z.attr("transform",r($.l-(R?Pe*hn:0),$.t-(R?0:(1-Ge)*hn-Yt))),!R&&(X||v(Y).getAlpha()&&!v.equals(q.paper_bgcolor,Y))){var Zt=Ue.selectAll("text"),Ut=Zt[0].length,_r=z.select("."+f.cbbg).node(),rt=o.bBox(_r),Ke=o.getTranslate(z),st=2;Zt.each(function(it,ct){var At=0,dt=Ut-1;if(ct===At||ct===dt){var Tt=o.bBox(this),Ht=o.getTranslate(this),ir;if(ct===dt){var kr=Tt.right+Ht.x,br=rt.right+Ke.x+Le-X-st+N;ir=br-kr,ir>0&&(ir=0)}else if(ct===At){var Mr=Tt.left+Ht.x,Hr=rt.left+Ke.x+Le+X+st;ir=Hr-Mr,ir<0&&(ir=0)}ir&&(Ut<3?this.setAttribute("transform","translate("+ir+",0) "+this.getAttribute("transform")):this.setAttribute("visibility","hidden"))}})}var lt={},wt=A[Z],Pt=b[Z],ke=A[oe],Se=b[oe],nt=hn-_e;R?(F==="pixels"?(lt.y=U,lt.t=Oe*ke,lt.b=Oe*Se):(lt.t=lt.b=0,lt.yt=U+B*ke,lt.yb=U-B*Se),G==="pixels"?(lt.x=N,lt.l=hn*wt,lt.r=hn*Pt):(lt.l=nt*wt,lt.r=nt*Pt,lt.xl=N-H*wt,lt.xr=N+H*Pt)):(F==="pixels"?(lt.x=N,lt.l=Oe*wt,lt.r=Oe*Pt):(lt.l=lt.r=0,lt.xl=N+B*wt,lt.xr=N-B*Pt),G==="pixels"?(lt.y=1-U,lt.t=hn*ke,lt.b=hn*Se):(lt.t=nt*ke,lt.b=nt*Se,lt.yt=U-H*ke,lt.yb=U+H*Se)),S.autoMargin(D,I._id,lt)}return n.syncOrAsync([S.previousPromises,Xe,_t,Je,S.previousPromises,mt],D)}function T(z,I,D){var R=I.orientation==="v",B=D._fullLayout,F=B._size,H,G,J;a.init({element:z.node(),gd:D,prepFn:function(){H=z.attr("transform"),c(z)},moveFn:function(X,Y){z.attr("transform",H+r(X,Y)),G=a.align((R?I._uFrac:I._vFrac)+X/F.w,R?I._thickFrac:I._lenFrac,0,1,I.xanchor),J=a.align((R?I._vFrac:1-I._uFrac)-Y/F.h,R?I._lenFrac:I._thickFrac,0,1,I.yanchor);var Z=a.getCursor(G,J,I.xanchor,I.yanchor);c(z,Z)},doneFn:function(){if(c(z),G!==void 0&&J!==void 0){var X={};X[I._propPrefix+"x"]=G,X[I._propPrefix+"y"]=J,I._traceIndex!==void 0?M.call("_guiRestyle",D,X,I._traceIndex):M.call("_guiRelayout",D,X)}}})}function k(z,I,D){var R=I._levels,B=[],F=[],H,G,J=R.end+R.size/100,X=R.size,Y=1.001*D[0]-.001*D[1],Z=1.001*D[1]-.001*D[0];for(G=0;G<1e5&&(H=R.start+G*X,!(X>0?H>=J:H<=J));G++)H>Y&&H<Z&&B.push(H);if(I._fillgradient)F=[0];else if(typeof I._fillcolor=="function"){var oe=I._filllevels;if(oe)for(J=oe.end+oe.size/100,X=oe.size,G=0;G<1e5&&(H=oe.start+G*X,!(X>0?H>=J:H<=J));G++)H>D[0]&&H<D[1]&&F.push(H);else F=B.map(function(re){return re-R.size/2}),F.push(F[F.length-1]+R.size)}else I._fillcolor&&typeof I._fillcolor=="string"&&(F=[0]);return R.size<0&&(B.reverse(),F.reverse()),{line:B,fill:F}}function P(z,I,D){var R=z._fullLayout,B=I.orientation==="v",F={type:"linear",range:D,tickmode:I.tickmode,nticks:I.nticks,tick0:I.tick0,dtick:I.dtick,tickvals:I.tickvals,ticktext:I.ticktext,ticks:I.ticks,ticklen:I.ticklen,tickwidth:I.tickwidth,tickcolor:I.tickcolor,showticklabels:I.showticklabels,ticklabelposition:I.ticklabelposition,ticklabeloverflow:I.ticklabeloverflow,ticklabelstep:I.ticklabelstep,tickfont:I.tickfont,tickangle:I.tickangle,tickformat:I.tickformat,exponentformat:I.exponentformat,minexponent:I.minexponent,separatethousands:I.separatethousands,showexponent:I.showexponent,showtickprefix:I.showtickprefix,tickprefix:I.tickprefix,showticksuffix:I.showticksuffix,ticksuffix:I.ticksuffix,title:I.title,showline:!0,anchor:"free",side:B?"right":"bottom",position:1},H=B?"y":"x",G={type:"linear",_id:H+I._id},J={letter:H,font:R.font,noHover:!0,noTickson:!0,noTicklabelmode:!0,calendar:R.calendar};function X(Y,Z){return n.coerce(F,G,u,Y,Z)}return h(F,G,X,J,R),m(F,G,X,J),G}ee.exports={draw:x}},{"../../constants/alignment":483,"../../lib":515,"../../lib/extend":505,"../../lib/setcursor":536,"../../lib/svg_text_utils":541,"../../plots/cartesian/axes":566,"../../plots/cartesian/axis_defaults":568,"../../plots/cartesian/layout_attributes":579,"../../plots/cartesian/position_defaults":582,"../../plots/plots":628,"../../registry":647,"../color":367,"../colorscale/helpers":378,"../dragelement":386,"../drawing":389,"../titles":476,"./constants":369,"@plotly/d3":58,tinycolor2:313}],372:[function(d,ee,te){var w=d("../../lib");ee.exports=function(S){return w.isPlainObject(S.colorbar)}},{"../../lib":515}],373:[function(d,ee,te){ee.exports={moduleType:"component",name:"colorbar",attributes:d("./attributes"),supplyDefaults:d("./defaults"),draw:d("./draw").draw,hasColorbar:d("./has_colorbar")}},{"./attributes":368,"./defaults":370,"./draw":371,"./has_colorbar":372}],374:[function(d,ee,te){var w=d("../colorbar/attributes"),v=d("../../lib/regex").counter,S=d("../../lib/sort_object_keys"),M=d("./scales.js").scales;S(M),ee.exports=function(a,n){a=a||"",n=n||{};var r=n.cLetter||"c";"onlyIfNumerical"in n?n.onlyIfNumerical:Boolean(a);var t="noScale"in n?n.noScale:a==="marker.line",c="showScaleDflt"in n?n.showScaleDflt:r==="z",o=typeof n.colorscaleDflt=="string"?M[n.colorscaleDflt]:null,i=n.editTypeOverride||"",y;"colorAttr"in n?(y=n.colorAttr,n.colorAttr):y={z:"z",c:"color"}[r];var p=r+"auto",g=r+"min",h=r+"max",m=r+"mid",u={};u[g]=u[h]=void 0;var _={};_[p]=!1;var s={};return y==="color"&&(s.color={valType:"color",arrayOk:!0,editType:i||"style"},n.anim&&(s.color.anim=!0)),s[p]={valType:"boolean",dflt:!0,editType:"calc",impliedEdits:u},s[g]={valType:"number",dflt:null,editType:i||"plot",impliedEdits:_},s[h]={valType:"number",dflt:null,editType:i||"plot",impliedEdits:_},s[m]={valType:"number",dflt:null,editType:"calc",impliedEdits:u},s.colorscale={valType:"colorscale",editType:"calc",dflt:o,impliedEdits:{autocolorscale:!1}},s.autocolorscale={valType:"boolean",dflt:n.autoColorDflt!==!1,editType:"calc",impliedEdits:{colorscale:void 0}},s.reversescale={valType:"boolean",dflt:!1,editType:"plot"},t||(s.showscale={valType:"boolean",dflt:c,editType:"calc"},s.colorbar=w),n.noColorAxis||(s.coloraxis={valType:"subplotid",regex:v("coloraxis"),dflt:null,editType:"calc"}),s}},{"../../lib/regex":532,"../../lib/sort_object_keys":538,"../colorbar/attributes":368,"./scales.js":382}],375:[function(d,ee,te){var w=d("fast-isnumeric"),v=d("../../lib"),S=d("./helpers").extractOpts;ee.exports=function(e,a,n){var r=e._fullLayout,t=n.vals,c=n.containerStr,o=c?v.nestedProperty(a,c).get():a,i=S(o),y=i.auto!==!1,p=i.min,g=i.max,h=i.mid,m=function(){return v.aggNums(Math.min,null,t)},u=function(){return v.aggNums(Math.max,null,t)};if(p===void 0?p=m():y&&(o._colorAx&&w(p)?p=Math.min(p,m()):p=m()),g===void 0?g=u():y&&(o._colorAx&&w(g)?g=Math.max(g,u()):g=u()),y&&h!==void 0&&(g-h>h-p?p=h-(g-h):g-h<h-p&&(g=h+(h-p))),p===g&&(p-=.5,g+=.5),i._sync("min",p),i._sync("max",g),i.autocolorscale){var _;p*g<0?_=r.colorscale.diverging:p>=0?_=r.colorscale.sequential:_=r.colorscale.sequentialminus,i._sync("colorscale",_)}}},{"../../lib":515,"./helpers":378,"fast-isnumeric":190}],376:[function(d,ee,te){var w=d("../../lib"),v=d("./helpers").hasColorscale,S=d("./helpers").extractOpts;ee.exports=function(e,a){function n(p,g){var h=p["_"+g];h!==void 0&&(p[g]=h)}function r(p,g){var h=g.container?w.nestedProperty(p,g.container).get():p;if(h)if(h.coloraxis)h._colorAx=a[h.coloraxis];else{var m=S(h),u=m.auto;(u||m.min===void 0)&&n(h,g.min),(u||m.max===void 0)&&n(h,g.max),m.autocolorscale&&n(h,"colorscale")}}for(var t=0;t<e.length;t++){var c=e[t],o=c._module.colorbar;if(o)if(Array.isArray(o))for(var i=0;i<o.length;i++)r(c,o[i]);else r(c,o);v(c,"marker.line")&&r(c,{container:"marker.line",min:"cmin",max:"cmax"})}for(var y in a._colorAxes)r(a[y],{min:"cmin",max:"cmax"})}},{"../../lib":515,"./helpers":378}],377:[function(d,ee,te){var w=d("fast-isnumeric"),v=d("../../lib"),S=d("../colorbar/has_colorbar"),M=d("../colorbar/defaults"),e=d("./scales").isValid,a=d("../../registry").traceIs;function n(r,t){var c=t.slice(0,t.length-1);return t?v.nestedProperty(r,c).get()||{}:r}ee.exports=function r(t,c,o,i,y){var p=y.prefix,g=y.cLetter,h="_module"in c,m=n(t,p),u=n(c,p),_=n(c._template||{},p)||{},s=function(){return delete t.coloraxis,delete c.coloraxis,r(t,c,o,i,y)};if(h){var A=o._colorAxes||{},b=i(p+"coloraxis");if(b){var f=a(c,"contour")&&v.nestedProperty(c,"contours.coloring").get()||"heatmap",x=A[b];x?(x[2].push(s),x[0]!==f&&(x[0]=!1,v.warn(["Ignoring coloraxis:",b,"setting","as it is linked to incompatible colorscales."].join(" ")))):A[b]=[f,c,[s]];return}}var l=m[g+"min"],L=m[g+"max"],T=w(l)&&w(L)&&l<L,k=i(p+g+"auto",!T);k?i(p+g+"mid"):(i(p+g+"min"),i(p+g+"max"));var P=m.colorscale,z=_.colorscale,I;if(P!==void 0&&(I=!e(P)),z!==void 0&&(I=!e(z)),i(p+"autocolorscale",I),i(p+"colorscale"),i(p+"reversescale"),p!=="marker.line."){var D;p&&h&&(D=S(m));var R=i(p+"showscale",D);R&&(p&&_&&(u._template=_),M(m,u,o))}}},{"../../lib":515,"../../registry":647,"../colorbar/defaults":370,"../colorbar/has_colorbar":372,"./scales":382,"fast-isnumeric":190}],378:[function(d,ee,te){var w=d("@plotly/d3"),v=d("tinycolor2"),S=d("fast-isnumeric"),M=d("../../lib"),e=d("../color"),a=d("./scales").isValid;function n(h,m,u){var _=m?M.nestedProperty(h,m).get()||{}:h,s=_[u||"color"],A=!1;if(M.isArrayOrTypedArray(s)){for(var b=0;b<s.length;b++)if(S(s[b])){A=!0;break}}return M.isPlainObject(_)&&(A||_.showscale===!0||S(_.cmin)&&S(_.cmax)||a(_.colorscale)||M.isPlainObject(_.colorbar))}var r=["showscale","autocolorscale","colorscale","reversescale","colorbar"],t=["min","max","mid","auto"];function c(h){var m=h._colorAx,u=m||h,_={},s,A,b;for(A=0;A<r.length;A++)b=r[A],_[b]=u[b];if(m)for(s="c",A=0;A<t.length;A++)b=t[A],_[b]=u["c"+b];else{var f;for(A=0;A<t.length;A++){if(b=t[A],f="c"+b,f in u){_[b]=u[f];continue}f="z"+b,f in u&&(_[b]=u[f])}s=f.charAt(0)}return _._sync=function(x,l){var L=t.indexOf(x)!==-1?s+x:x;u[L]=u["_"+L]=l},_}function o(h){for(var m=c(h),u=m.min,_=m.max,s=m.reversescale?i(m.colorscale):m.colorscale,A=s.length,b=new Array(A),f=new Array(A),x=0;x<A;x++){var l=s[x];b[x]=u+l[0]*(_-u),f[x]=l[1]}return{domain:b,range:f}}function i(h){for(var m=h.length,u=new Array(m),_=m-1,s=0;_>=0;_--,s++){var A=h[_];u[s]=[1-A[0],A[1]]}return u}function y(h,m){m=m||{};for(var u=h.domain,_=h.range,s=_.length,A=new Array(s),b=0;b<s;b++){var f=v(_[b]).toRgb();A[b]=[f.r,f.g,f.b,f.a]}var x=w.scale.linear().domain(u).range(A).clamp(!0),l=m.noNumericCheck,L=m.returnArray,T;return l&&L?T=x:l?T=function(k){return g(x(k))}:L?T=function(k){return S(k)?x(k):v(k).isValid()?k:e.defaultLine}:T=function(k){return S(k)?g(x(k)):v(k).isValid()?k:e.defaultLine},T.domain=x.domain,T.range=function(){return _},T}function p(h,m){return y(o(h),m)}function g(h){var m={r:h[0],g:h[1],b:h[2],a:h[3]};return v(m).toRgbString()}ee.exports={hasColorscale:n,extractOpts:c,extractScale:o,flipScale:i,makeColorScaleFunc:y,makeColorScaleFuncFromTrace:p}},{"../../lib":515,"../color":367,"./scales":382,"@plotly/d3":58,"fast-isnumeric":190,tinycolor2:313}],379:[function(d,ee,te){var w=d("./scales"),v=d("./helpers");ee.exports={moduleType:"component",name:"colorscale",attributes:d("./attributes"),layoutAttributes:d("./layout_attributes"),supplyLayoutDefaults:d("./layout_defaults"),handleDefaults:d("./defaults"),crossTraceDefaults:d("./cross_trace_defaults"),calc:d("./calc"),scales:w.scales,defaultScale:w.defaultScale,getScale:w.get,isValidScale:w.isValid,hasColorscale:v.hasColorscale,extractOpts:v.extractOpts,extractScale:v.extractScale,flipScale:v.flipScale,makeColorScaleFunc:v.makeColorScaleFunc,makeColorScaleFuncFromTrace:v.makeColorScaleFuncFromTrace}},{"./attributes":374,"./calc":375,"./cross_trace_defaults":376,"./defaults":377,"./helpers":378,"./layout_attributes":380,"./layout_defaults":381,"./scales":382}],380:[function(d,ee,te){var w=d("../../lib/extend").extendFlat,v=d("./attributes"),S=d("./scales").scales;ee.exports={editType:"calc",colorscale:{editType:"calc",sequential:{valType:"colorscale",dflt:S.Reds,editType:"calc"},sequentialminus:{valType:"colorscale",dflt:S.Blues,editType:"calc"},diverging:{valType:"colorscale",dflt:S.RdBu,editType:"calc"}},coloraxis:w({_isSubplotObj:!0,editType:"calc"},v("",{colorAttr:"corresponding trace color array(s)",noColorAxis:!0,showScaleDflt:!0}))}},{"../../lib/extend":505,"./attributes":374,"./scales":382}],381:[function(d,ee,te){var w=d("../../lib"),v=d("../../plot_api/plot_template"),S=d("./layout_attributes"),M=d("./defaults");ee.exports=function(a,n){function r(h,m){return w.coerce(a,n,S,h,m)}r("colorscale.sequential"),r("colorscale.sequentialminus"),r("colorscale.diverging");var t=n._colorAxes,c,o;function i(h,m){return w.coerce(c,o,S.coloraxis,h,m)}for(var y in t){var p=t[y];if(p[0])c=a[y]||{},o=v.newContainer(n,y,"coloraxis"),o._name=y,M(c,o,n,i,{prefix:"",cLetter:"c"});else{for(var g=0;g<p[2].length;g++)p[2][g]();delete n._colorAxes[y]}}}},{"../../lib":515,"../../plot_api/plot_template":555,"./defaults":377,"./layout_attributes":380}],382:[function(d,ee,te){var w=d("tinycolor2"),v={Greys:[[0,"rgb(0,0,0)"],[1,"rgb(255,255,255)"]],YlGnBu:[[0,"rgb(8,29,88)"],[.125,"rgb(37,52,148)"],[.25,"rgb(34,94,168)"],[.375,"rgb(29,145,192)"],[.5,"rgb(65,182,196)"],[.625,"rgb(127,205,187)"],[.75,"rgb(199,233,180)"],[.875,"rgb(237,248,217)"],[1,"rgb(255,255,217)"]],Greens:[[0,"rgb(0,68,27)"],[.125,"rgb(0,109,44)"],[.25,"rgb(35,139,69)"],[.375,"rgb(65,171,93)"],[.5,"rgb(116,196,118)"],[.625,"rgb(161,217,155)"],[.75,"rgb(199,233,192)"],[.875,"rgb(229,245,224)"],[1,"rgb(247,252,245)"]],YlOrRd:[[0,"rgb(128,0,38)"],[.125,"rgb(189,0,38)"],[.25,"rgb(227,26,28)"],[.375,"rgb(252,78,42)"],[.5,"rgb(253,141,60)"],[.625,"rgb(254,178,76)"],[.75,"rgb(254,217,118)"],[.875,"rgb(255,237,160)"],[1,"rgb(255,255,204)"]],Bluered:[[0,"rgb(0,0,255)"],[1,"rgb(255,0,0)"]],RdBu:[[0,"rgb(5,10,172)"],[.35,"rgb(106,137,247)"],[.5,"rgb(190,190,190)"],[.6,"rgb(220,170,132)"],[.7,"rgb(230,145,90)"],[1,"rgb(178,10,28)"]],Reds:[[0,"rgb(220,220,220)"],[.2,"rgb(245,195,157)"],[.4,"rgb(245,160,105)"],[1,"rgb(178,10,28)"]],Blues:[[0,"rgb(5,10,172)"],[.35,"rgb(40,60,190)"],[.5,"rgb(70,100,245)"],[.6,"rgb(90,120,245)"],[.7,"rgb(106,137,247)"],[1,"rgb(220,220,220)"]],Picnic:[[0,"rgb(0,0,255)"],[.1,"rgb(51,153,255)"],[.2,"rgb(102,204,255)"],[.3,"rgb(153,204,255)"],[.4,"rgb(204,204,255)"],[.5,"rgb(255,255,255)"],[.6,"rgb(255,204,255)"],[.7,"rgb(255,153,255)"],[.8,"rgb(255,102,204)"],[.9,"rgb(255,102,102)"],[1,"rgb(255,0,0)"]],Rainbow:[[0,"rgb(150,0,90)"],[.125,"rgb(0,0,200)"],[.25,"rgb(0,25,255)"],[.375,"rgb(0,152,255)"],[.5,"rgb(44,255,150)"],[.625,"rgb(151,255,0)"],[.75,"rgb(255,234,0)"],[.875,"rgb(255,111,0)"],[1,"rgb(255,0,0)"]],Portland:[[0,"rgb(12,51,131)"],[.25,"rgb(10,136,186)"],[.5,"rgb(242,211,56)"],[.75,"rgb(242,143,56)"],[1,"rgb(217,30,30)"]],Jet:[[0,"rgb(0,0,131)"],[.125,"rgb(0,60,170)"],[.375,"rgb(5,255,255)"],[.625,"rgb(255,255,0)"],[.875,"rgb(250,0,0)"],[1,"rgb(128,0,0)"]],Hot:[[0,"rgb(0,0,0)"],[.3,"rgb(230,0,0)"],[.6,"rgb(255,210,0)"],[1,"rgb(255,255,255)"]],Blackbody:[[0,"rgb(0,0,0)"],[.2,"rgb(230,0,0)"],[.4,"rgb(230,210,0)"],[.7,"rgb(255,255,255)"],[1,"rgb(160,200,255)"]],Earth:[[0,"rgb(0,0,130)"],[.1,"rgb(0,180,180)"],[.2,"rgb(40,210,40)"],[.4,"rgb(230,230,50)"],[.6,"rgb(120,70,20)"],[1,"rgb(255,255,255)"]],Electric:[[0,"rgb(0,0,0)"],[.15,"rgb(30,0,100)"],[.4,"rgb(120,0,100)"],[.6,"rgb(160,90,0)"],[.8,"rgb(230,200,0)"],[1,"rgb(255,250,220)"]],Viridis:[[0,"#440154"],[.06274509803921569,"#48186a"],[.12549019607843137,"#472d7b"],[.18823529411764706,"#424086"],[.25098039215686274,"#3b528b"],[.3137254901960784,"#33638d"],[.3764705882352941,"#2c728e"],[.4392156862745098,"#26828e"],[.5019607843137255,"#21918c"],[.5647058823529412,"#1fa088"],[.6274509803921569,"#28ae80"],[.6901960784313725,"#3fbc73"],[.7529411764705882,"#5ec962"],[.8156862745098039,"#84d44b"],[.8784313725490196,"#addc30"],[.9411764705882353,"#d8e219"],[1,"#fde725"]],Cividis:[[0,"rgb(0,32,76)"],[.058824,"rgb(0,42,102)"],[.117647,"rgb(0,52,110)"],[.176471,"rgb(39,63,108)"],[.235294,"rgb(60,74,107)"],[.294118,"rgb(76,85,107)"],[.352941,"rgb(91,95,109)"],[.411765,"rgb(104,106,112)"],[.470588,"rgb(117,117,117)"],[.529412,"rgb(131,129,120)"],[.588235,"rgb(146,140,120)"],[.647059,"rgb(161,152,118)"],[.705882,"rgb(176,165,114)"],[.764706,"rgb(192,177,109)"],[.823529,"rgb(209,191,102)"],[.882353,"rgb(225,204,92)"],[.941176,"rgb(243,219,79)"],[1,"rgb(255,233,69)"]]},S=v.RdBu;function M(n,r){if(r||(r=S),!n)return r;function t(){try{n=v[n]||JSON.parse(n)}catch{n=r}}return typeof n=="string"&&(t(),typeof n=="string"&&t()),e(n)?n:r}function e(n){var r=0;if(!Array.isArray(n)||n.length<2||!n[0]||!n[n.length-1]||+n[0][0]!=0||+n[n.length-1][0]!=1)return!1;for(var t=0;t<n.length;t++){var c=n[t];if(c.length!==2||+c[0]<r||!w(c[1]).isValid())return!1;r=+c[0]}return!0}function a(n){return v[n]!==void 0?!0:e(n)}ee.exports={scales:v,defaultScale:S,get:M,isValid:a}},{tinycolor2:313}],383:[function(d,ee,te){ee.exports=function(v,S,M,e,a){var n=(v-M)/(e-M),r=n+S/(e-M),t=(n+r)/2;return a==="left"||a==="bottom"?n:a==="center"||a==="middle"?t:a==="right"||a==="top"?r:n<2/3-t?n:r>4/3-t?r:t}},{}],384:[function(d,ee,te){var w=d("../../lib"),v=[["sw-resize","s-resize","se-resize"],["w-resize","move","e-resize"],["nw-resize","n-resize","ne-resize"]];ee.exports=function(M,e,a,n){return a==="left"?M=0:a==="center"?M=1:a==="right"?M=2:M=w.constrain(Math.floor(M*3),0,2),n==="bottom"?e=0:n==="middle"?e=1:n==="top"?e=2:e=w.constrain(Math.floor(e*3),0,2),v[e][M]}},{"../../lib":515}],385:[function(d,ee,te){te.selectMode=function(w){return w==="lasso"||w==="select"},te.drawMode=function(w){return w==="drawclosedpath"||w==="drawopenpath"||w==="drawline"||w==="drawrect"||w==="drawcircle"},te.openMode=function(w){return w==="drawline"||w==="drawopenpath"},te.rectMode=function(w){return w==="select"||w==="drawline"||w==="drawrect"||w==="drawcircle"},te.freeMode=function(w){return w==="lasso"||w==="drawclosedpath"||w==="drawopenpath"},te.selectingOrDrawing=function(w){return te.freeMode(w)||te.rectMode(w)}},{}],386:[function(d,ee,te){var w=d("mouse-event-offset"),v=d("has-hover"),S=d("has-passive-events"),M=d("../../lib").removeElement,e=d("../../plots/cartesian/constants"),a=ee.exports={};a.align=d("./align"),a.getCursor=d("./cursor");var n=d("./unhover");a.unhover=n.wrapped,a.unhoverRaw=n.raw,a.init=function(o){var i=o.gd,y=1,p=i._context.doubleClickDelay,g=o.element,h,m,u,_,s,A,b,f;i._mouseDownTime||(i._mouseDownTime=0),g.style.pointerEvents="all",g.onmousedown=L,S?(g._ontouchstart&&g.removeEventListener("touchstart",g._ontouchstart),g._ontouchstart=L,g.addEventListener("touchstart",L,{passive:!1})):g.ontouchstart=L;function x(P,z,I){return Math.abs(P)<I&&(P=0),Math.abs(z)<I&&(z=0),[P,z]}var l=o.clampFn||x;function L(P){i._dragged=!1,i._dragging=!0;var z=t(P);h=z[0],m=z[1],b=P.target,A=P,f=P.buttons===2||P.ctrlKey,typeof P.clientX>"u"&&typeof P.clientY>"u"&&(P.clientX=h,P.clientY=m),u=new Date().getTime(),u-i._mouseDownTime<p?y+=1:(y=1,i._mouseDownTime=u),o.prepFn&&o.prepFn(P,h,m),v&&!f?(s=r(),s.style.cursor=window.getComputedStyle(g).cursor):v||(s=document,_=window.getComputedStyle(document.documentElement).cursor,document.documentElement.style.cursor=window.getComputedStyle(g).cursor),document.addEventListener("mouseup",k),document.addEventListener("touchend",k),o.dragmode!==!1&&(P.preventDefault(),document.addEventListener("mousemove",T),document.addEventListener("touchmove",T,{passive:!1}))}function T(P){P.preventDefault();var z=t(P),I=o.minDrag||e.MINDRAG,D=l(z[0]-h,z[1]-m,I),R=D[0],B=D[1];(R||B)&&(i._dragged=!0,a.unhover(i,P)),i._dragged&&o.moveFn&&!f&&(i._dragdata={element:g,dx:R,dy:B},o.moveFn(R,B))}function k(P){if(delete i._dragdata,o.dragmode!==!1&&(P.preventDefault(),document.removeEventListener("mousemove",T),document.removeEventListener("touchmove",T)),document.removeEventListener("mouseup",k),document.removeEventListener("touchend",k),v?M(s):_&&(s.documentElement.style.cursor=_,_=null),!i._dragging){i._dragged=!1;return}if(i._dragging=!1,new Date().getTime()-i._mouseDownTime>p&&(y=Math.max(y-1,1)),i._dragged)o.doneFn&&o.doneFn();else if(o.clickFn&&o.clickFn(y,A),!f){var z;try{z=new MouseEvent("click",P)}catch{var I=t(P);z=document.createEvent("MouseEvents"),z.initMouseEvent("click",P.bubbles,P.cancelable,P.view,P.detail,P.screenX,P.screenY,I[0],I[1],P.ctrlKey,P.altKey,P.shiftKey,P.metaKey,P.button,P.relatedTarget)}b.dispatchEvent(z)}i._dragging=!1,i._dragged=!1}};function r(){var c=document.createElement("div");c.className="dragcover";var o=c.style;return o.position="fixed",o.left=0,o.right=0,o.top=0,o.bottom=0,o.zIndex=999999999,o.background="none",document.body.appendChild(c),c}a.coverSlip=r;function t(c){return w(c.changedTouches?c.changedTouches[0]:c,document.body)}},{"../../lib":515,"../../plots/cartesian/constants":573,"./align":383,"./cursor":384,"./unhover":387,"has-hover":228,"has-passive-events":229,"mouse-event-offset":242}],387:[function(d,ee,te){var w=d("../../lib/events"),v=d("../../lib/throttle"),S=d("../../lib/dom").getGraphDiv,M=d("../fx/constants"),e=ee.exports={};e.wrapped=function(a,n,r){a=S(a),a._fullLayout&&v.clear(a._fullLayout._uid+M.HOVERID),e.raw(a,n,r)},e.raw=function(n,r){var t=n._fullLayout,c=n._hoverdata;r||(r={}),!(r.target&&!n._dragged&&w.triggerHandler(n,"plotly_beforehover",r)===!1)&&(t._hoverlayer.selectAll("g").remove(),t._hoverlayer.selectAll("line").remove(),t._hoverlayer.selectAll("circle").remove(),n._hoverdata=void 0,r.target&&c&&n.emit("plotly_unhover",{event:r,points:c}))}},{"../../lib/dom":503,"../../lib/events":504,"../../lib/throttle":542,"../fx/constants":401}],388:[function(d,ee,te){te.dash={valType:"string",values:["solid","dot","dash","longdash","dashdot","longdashdot"],dflt:"solid",editType:"style"},te.pattern={shape:{valType:"enumerated",values:["","/","\\","x","-","|","+","."],dflt:"",arrayOk:!0,editType:"style"},fillmode:{valType:"enumerated",values:["replace","overlay"],dflt:"replace",editType:"style"},bgcolor:{valType:"color",arrayOk:!0,editType:"style"},fgcolor:{valType:"color",arrayOk:!0,editType:"style"},fgopacity:{valType:"number",editType:"style",min:0,max:1},size:{valType:"number",min:0,dflt:8,arrayOk:!0,editType:"style"},solidity:{valType:"number",min:0,max:1,dflt:.3,arrayOk:!0,editType:"style"},editType:"style"}},{}],389:[function(d,ee,te){var w=d("@plotly/d3"),v=d("../../lib"),S=v.numberFormat,M=d("fast-isnumeric"),e=d("tinycolor2"),a=d("../../registry"),n=d("../color"),r=d("../colorscale"),t=v.strTranslate,c=d("../../lib/svg_text_utils"),o=d("../../constants/xmlns_namespaces"),i=d("../../constants/alignment"),y=i.LINE_SPACING,p=d("../../constants/interactions").DESELECTDIM,g=d("../../traces/scatter/subtypes"),h=d("../../traces/scatter/make_bubble_size_func"),m=d("../../components/fx/helpers").appendArrayPointValue,u=ee.exports={};u.font=function(Z,oe,re,se){v.isPlainObject(oe)&&(se=oe.color,re=oe.size,oe=oe.family),oe&&Z.style("font-family",oe),re+1&&Z.style("font-size",re+"px"),se&&Z.call(n.fill,se)},u.setPosition=function(Z,oe,re){Z.attr("x",oe).attr("y",re)},u.setSize=function(Z,oe,re){Z.attr("width",oe).attr("height",re)},u.setRect=function(Z,oe,re,se,N){Z.call(u.setPosition,oe,re).call(u.setSize,se,N)},u.translatePoint=function(Z,oe,re,se){var N=re.c2p(Z.x),U=se.c2p(Z.y);if(M(N)&&M(U)&&oe.node())oe.node().nodeName==="text"?oe.attr("x",N).attr("y",U):oe.attr("transform",t(N,U));else return!1;return!0},u.translatePoints=function(Z,oe,re){Z.each(function(se){var N=w.select(this);u.translatePoint(se,N,oe,re)})},u.hideOutsideRangePoint=function(Z,oe,re,se,N,U){oe.attr("display",re.isPtWithinRange(Z,N)&&se.isPtWithinRange(Z,U)?null:"none")},u.hideOutsideRangePoints=function(Z,oe){if(!!oe._hasClipOnAxisFalse){var re=oe.xaxis,se=oe.yaxis;Z.each(function(N){var U=N[0].trace,q=U.xcalendar,$=U.ycalendar,W=a.traceIs(U,"bar-like")?".bartext":".point,.textpoint";Z.selectAll(W).each(function(K){u.hideOutsideRangePoint(K,w.select(this),re,se,q,$)})})}},u.crispRound=function(Z,oe,re){return!oe||!M(oe)?re||0:Z._context.staticPlot?oe:oe<1?1:Math.round(oe)},u.singleLineStyle=function(Z,oe,re,se,N){oe.style("fill","none");var U=(((Z||[])[0]||{}).trace||{}).line||{},q=re||U.width||0,$=N||U.dash||"";n.stroke(oe,se||U.color),u.dashLine(oe,$,q)},u.lineGroupStyle=function(Z,oe,re,se){Z.style("fill","none").each(function(N){var U=(((N||[])[0]||{}).trace||{}).line||{},q=oe||U.width||0,$=se||U.dash||"";w.select(this).call(n.stroke,re||U.color).call(u.dashLine,$,q)})},u.dashLine=function(Z,oe,re){re=+re||0,oe=u.dashStyle(oe,re),Z.style({"stroke-dasharray":oe,"stroke-width":re+"px"})},u.dashStyle=function(Z,oe){oe=+oe||1;var re=Math.max(oe,3);return Z==="solid"?Z="":Z==="dot"?Z=re+"px,"+re+"px":Z==="dash"?Z=3*re+"px,"+3*re+"px":Z==="longdash"?Z=5*re+"px,"+5*re+"px":Z==="dashdot"?Z=3*re+"px,"+re+"px,"+re+"px,"+re+"px":Z==="longdashdot"&&(Z=5*re+"px,"+2*re+"px,"+re+"px,"+2*re+"px"),Z};function _(Z,oe,re){var se=oe.fillpattern,N=se&&u.getPatternAttr(se.shape,0,"");if(N){var U=u.getPatternAttr(se.bgcolor,0,null),q=u.getPatternAttr(se.fgcolor,0,null),$=se.fgopacity,W=u.getPatternAttr(se.size,0,8),K=u.getPatternAttr(se.solidity,0,.3),ne=oe.uid;u.pattern(Z,"point",re,ne,N,W,K,void 0,se.fillmode,U,q,$)}else oe.fillcolor&&Z.call(n.fill,oe.fillcolor)}u.singleFillStyle=function(Z,oe){var re=w.select(Z.node()),se=re.data(),N=((se[0]||[])[0]||{}).trace||{};_(Z,N,oe)},u.fillGroupStyle=function(Z,oe){Z.style("stroke-width",0).each(function(re){var se=w.select(this);re[0].trace&&_(se,re[0].trace,oe)})};var s=d("./symbol_defs");u.symbolNames=[],u.symbolFuncs=[],u.symbolNeedLines={},u.symbolNoDot={},u.symbolNoFill={},u.symbolList=[],Object.keys(s).forEach(function(Z){var oe=s[Z],re=oe.n;u.symbolList.push(re,String(re),Z,re+100,String(re+100),Z+"-open"),u.symbolNames[re]=Z,u.symbolFuncs[re]=oe.f,oe.needLine&&(u.symbolNeedLines[re]=!0),oe.noDot?u.symbolNoDot[re]=!0:u.symbolList.push(re+200,String(re+200),Z+"-dot",re+300,String(re+300),Z+"-open-dot"),oe.noFill&&(u.symbolNoFill[re]=!0)});var A=u.symbolNames.length,b="M0,0.5L0.5,0L0,-0.5L-0.5,0Z";u.symbolNumber=function(Z){if(M(Z))Z=+Z;else if(typeof Z=="string"){var oe=0;Z.indexOf("-open")>0&&(oe=100,Z=Z.replace("-open","")),Z.indexOf("-dot")>0&&(oe+=200,Z=Z.replace("-dot","")),Z=u.symbolNames.indexOf(Z),Z>=0&&(Z+=oe)}return Z%100>=A||Z>=400?0:Math.floor(Math.max(Z,0))};function f(Z,oe){var re=Z%100;return u.symbolFuncs[re](oe)+(Z>=200?b:"")}var x={x1:1,x2:0,y1:0,y2:0},l={x1:0,x2:0,y1:1,y2:0},L=S("~f"),T={radial:{node:"radialGradient"},radialreversed:{node:"radialGradient",reversed:!0},horizontal:{node:"linearGradient",attrs:x},horizontalreversed:{node:"linearGradient",attrs:x,reversed:!0},vertical:{node:"linearGradient",attrs:l},verticalreversed:{node:"linearGradient",attrs:l,reversed:!0}};u.gradient=function(Z,oe,re,se,N,U){for(var q=N.length,$=T[se],W=new Array(q),K=0;K<q;K++)$.reversed?W[q-1-K]=[L((1-N[K][0])*100),N[K][1]]:W[K]=[L(N[K][0]*100),N[K][1]];var ne=oe._fullLayout,ae="g"+ne._uid+"-"+re,ie=ne._defs.select(".gradients").selectAll("#"+ae).data([se+W.join(";")],v.identity);ie.exit().remove(),ie.enter().append($.node).each(function(){var le=w.select(this);$.attrs&&le.attr($.attrs),le.attr("id",ae);var ye=le.selectAll("stop").data(W);ye.exit().remove(),ye.enter().append("stop"),ye.each(function(ue){var pe=e(ue[1]);w.select(this).attr({offset:ue[0]+"%","stop-color":n.tinyRGB(pe),"stop-opacity":pe.getAlpha()})})}),Z.style(U,J(ae,oe)).style(U+"-opacity",null),Z.classed("gradient_filled",!0)},u.pattern=function(Z,oe,re,se,N,U,q,$,W,K,ne,ae){var ie=oe==="legend";$&&(W==="overlay"?(K=$,ne=n.contrast(K)):(K=void 0,ne=$));var le=re._fullLayout,ye="p"+le._uid+"-"+se,ue,pe,ge=function(Ge,Qe,Be,Le,He){return Le+(He-Le)*(Ge-Qe)/(Be-Qe)},Te,_e,ze,Oe,Ye={};switch(N){case"/":ue=U*Math.sqrt(2),pe=U*Math.sqrt(2),Te="M-"+ue/4+","+pe/4+"l"+ue/2+",-"+pe/2+"M0,"+pe+"L"+ue+",0M"+ue/4*3+","+pe/4*5+"l"+ue/2+",-"+pe/2,_e=q*U,Oe="path",Ye={d:Te,opacity:ae,stroke:ne,"stroke-width":_e+"px"};break;case"\\":ue=U*Math.sqrt(2),pe=U*Math.sqrt(2),Te="M"+ue/4*3+",-"+pe/4+"l"+ue/2+","+pe/2+"M0,0L"+ue+","+pe+"M-"+ue/4+","+pe/4*3+"l"+ue/2+","+pe/2,_e=q*U,Oe="path",Ye={d:Te,opacity:ae,stroke:ne,"stroke-width":_e+"px"};break;case"x":ue=U*Math.sqrt(2),pe=U*Math.sqrt(2),Te="M-"+ue/4+","+pe/4+"l"+ue/2+",-"+pe/2+"M0,"+pe+"L"+ue+",0M"+ue/4*3+","+pe/4*5+"l"+ue/2+",-"+pe/2+"M"+ue/4*3+",-"+pe/4+"l"+ue/2+","+pe/2+"M0,0L"+ue+","+pe+"M-"+ue/4+","+pe/4*3+"l"+ue/2+","+pe/2,_e=U-U*Math.sqrt(1-q),Oe="path",Ye={d:Te,opacity:ae,stroke:ne,"stroke-width":_e+"px"};break;case"|":ue=U,pe=U,Oe="path",Te="M"+ue/2+",0L"+ue/2+","+pe,_e=q*U,Oe="path",Ye={d:Te,opacity:ae,stroke:ne,"stroke-width":_e+"px"};break;case"-":ue=U,pe=U,Oe="path",Te="M0,"+pe/2+"L"+ue+","+pe/2,_e=q*U,Oe="path",Ye={d:Te,opacity:ae,stroke:ne,"stroke-width":_e+"px"};break;case"+":ue=U,pe=U,Oe="path",Te="M"+ue/2+",0L"+ue/2+","+pe+"M0,"+pe/2+"L"+ue+","+pe/2,_e=U-U*Math.sqrt(1-q),Oe="path",Ye={d:Te,opacity:ae,stroke:ne,"stroke-width":_e+"px"};break;case".":ue=U,pe=U,q<Math.PI/4?ze=Math.sqrt(q*U*U/Math.PI):ze=ge(q,Math.PI/4,1,U/2,U/Math.sqrt(2)),Oe="circle",Ye={cx:ue/2,cy:pe/2,r:ze,opacity:ae,fill:ne};break}var be=[N||"noSh",K||"noBg",ne||"noFg",U,q].join(";"),Pe=le._defs.select(".patterns").selectAll("#"+ye).data([be],v.identity);Pe.exit().remove(),Pe.enter().append("pattern").each(function(){var Ge=w.select(this);if(Ge.attr({id:ye,width:ue+"px",height:pe+"px",patternUnits:"userSpaceOnUse",patternTransform:ie?"scale(0.8)":""}),K){var Qe=Ge.selectAll("rect").data([0]);Qe.exit().remove(),Qe.enter().append("rect").attr({width:ue+"px",height:pe+"px",fill:K})}var Be=Ge.selectAll(Oe).data([0]);Be.exit().remove(),Be.enter().append(Oe).attr(Ye)}),Z.style("fill",J(ye,re)).style("fill-opacity",null),Z.classed("pattern_filled",!0)},u.initGradients=function(Z){var oe=Z._fullLayout,re=v.ensureSingle(oe._defs,"g","gradients");re.selectAll("linearGradient,radialGradient").remove(),w.select(Z).selectAll(".gradient_filled").classed("gradient_filled",!1)},u.initPatterns=function(Z){var oe=Z._fullLayout,re=v.ensureSingle(oe._defs,"g","patterns");re.selectAll("pattern").remove(),w.select(Z).selectAll(".pattern_filled").classed("pattern_filled",!1)},u.getPatternAttr=function(Z,oe,re){return Z&&v.isArrayOrTypedArray(Z)?oe<Z.length?Z[oe]:re:Z},u.pointStyle=function(Z,oe,re){if(!!Z.size()){var se=u.makePointStyleFns(oe);Z.each(function(N){u.singlePointStyle(N,w.select(this),oe,se,re)})}},u.singlePointStyle=function(Z,oe,re,se,N){var U=re.marker,q=U.line;if(oe.style("opacity",se.selectedOpacityFn?se.selectedOpacityFn(Z):Z.mo===void 0?U.opacity:Z.mo),se.ms2mrc){var $;Z.ms==="various"||U.size==="various"?$=3:$=se.ms2mrc(Z.ms),Z.mrc=$,se.selectedSizeFn&&($=Z.mrc=se.selectedSizeFn(Z));var W=u.symbolNumber(Z.mx||U.symbol)||0;Z.om=W%200>=100,oe.attr("d",f(W,$))}var K=!1,ne,ae,ie;if(Z.so)ie=q.outlierwidth,ae=q.outliercolor,ne=U.outliercolor;else{var le=(q||{}).width;ie=(Z.mlw+1||le+1||(Z.trace?(Z.trace.marker.line||{}).width:0)+1)-1||0,"mlc"in Z?ae=Z.mlcc=se.lineScale(Z.mlc):v.isArrayOrTypedArray(q.color)?ae=n.defaultLine:ae=q.color,v.isArrayOrTypedArray(U.color)&&(ne=n.defaultLine,K=!0),"mc"in Z?ne=Z.mcc=se.markerScale(Z.mc):ne=U.color||"rgba(0,0,0,0)",se.selectedColorFn&&(ne=se.selectedColorFn(Z))}if(Z.om)oe.call(n.stroke,ne).style({"stroke-width":(ie||1)+"px",fill:"none"});else{oe.style("stroke-width",(Z.isBlank?0:ie)+"px");var ye=U.gradient,ue=Z.mgt;ue?K=!0:ue=ye&&ye.type,v.isArrayOrTypedArray(ue)&&(ue=ue[0],T[ue]||(ue=0));var pe=U.pattern,ge=pe&&u.getPatternAttr(pe.shape,Z.i,"");if(ue&&ue!=="none"){var Te=Z.mgc;Te?K=!0:Te=ye.color;var _e=re.uid;K&&(_e+="-"+Z.i),u.gradient(oe,N,_e,ue,[[0,Te],[1,ne]],"fill")}else if(ge){var ze=u.getPatternAttr(pe.bgcolor,Z.i,null),Oe=u.getPatternAttr(pe.fgcolor,Z.i,null),Ye=pe.fgopacity,be=u.getPatternAttr(pe.size,Z.i,8),Pe=u.getPatternAttr(pe.solidity,Z.i,.3),Ge=Z.mcc||v.isArrayOrTypedArray(pe.shape)||v.isArrayOrTypedArray(pe.bgcolor)||v.isArrayOrTypedArray(pe.size)||v.isArrayOrTypedArray(pe.solidity),Qe=re.uid;Ge&&(Qe+="-"+Z.i),u.pattern(oe,"point",N,Qe,ge,be,Pe,Z.mcc,pe.fillmode,ze,Oe,Ye)}else n.fill(oe,ne);ie&&n.stroke(oe,ae)}},u.makePointStyleFns=function(Z){var oe={},re=Z.marker;return oe.markerScale=u.tryColorscale(re,""),oe.lineScale=u.tryColorscale(re,"line"),a.traceIs(Z,"symbols")&&(oe.ms2mrc=g.isBubble(Z)?h(Z):function(){return(re.size||6)/2}),Z.selectedpoints&&v.extendFlat(oe,u.makeSelectedPointStyleFns(Z)),oe},u.makeSelectedPointStyleFns=function(Z){var oe={},re=Z.selected||{},se=Z.unselected||{},N=Z.marker||{},U=re.marker||{},q=se.marker||{},$=N.opacity,W=U.opacity,K=q.opacity,ne=W!==void 0,ae=K!==void 0;(v.isArrayOrTypedArray($)||ne||ae)&&(oe.selectedOpacityFn=function(ze){var Oe=ze.mo===void 0?N.opacity:ze.mo;return ze.selected?ne?W:Oe:ae?K:p*Oe});var ie=N.color,le=U.color,ye=q.color;(le||ye)&&(oe.selectedColorFn=function(ze){var Oe=ze.mcc||ie;return ze.selected?le||Oe:ye||Oe});var ue=N.size,pe=U.size,ge=q.size,Te=pe!==void 0,_e=ge!==void 0;return a.traceIs(Z,"symbols")&&(Te||_e)&&(oe.selectedSizeFn=function(ze){var Oe=ze.mrc||ue/2;return ze.selected?Te?pe/2:Oe:_e?ge/2:Oe}),oe},u.makeSelectedTextStyleFns=function(Z){var oe={},re=Z.selected||{},se=Z.unselected||{},N=Z.textfont||{},U=re.textfont||{},q=se.textfont||{},$=N.color,W=U.color,K=q.color;return oe.selectedTextColorFn=function(ne){var ae=ne.tc||$;return ne.selected?W||ae:K||(W?ae:n.addOpacity(ae,p))},oe},u.selectedPointStyle=function(Z,oe){if(!(!Z.size()||!oe.selectedpoints)){var re=u.makeSelectedPointStyleFns(oe),se=oe.marker||{},N=[];re.selectedOpacityFn&&N.push(function(U,q){U.style("opacity",re.selectedOpacityFn(q))}),re.selectedColorFn&&N.push(function(U,q){n.fill(U,re.selectedColorFn(q))}),re.selectedSizeFn&&N.push(function(U,q){var $=q.mx||se.symbol||0,W=re.selectedSizeFn(q);U.attr("d",f(u.symbolNumber($),W)),q.mrc2=W}),N.length&&Z.each(function(U){for(var q=w.select(this),$=0;$<N.length;$++)N[$](q,U)})}},u.tryColorscale=function(Z,oe){var re=oe?v.nestedProperty(Z,oe).get():Z;if(re){var se=re.color;if((re.colorscale||re._colorAx)&&v.isArrayOrTypedArray(se))return r.makeColorScaleFuncFromTrace(re)}return v.identity};var k={start:1,end:-1,middle:0,bottom:1,top:-1};function P(Z,oe,re,se,N){var U=w.select(Z.node().parentNode),q=oe.indexOf("top")!==-1?"top":oe.indexOf("bottom")!==-1?"bottom":"middle",$=oe.indexOf("left")!==-1?"end":oe.indexOf("right")!==-1?"start":"middle",W=se?se/.8+1:0,K=(c.lineCount(Z)-1)*y+1,ne=k[$]*W,ae=re*.75+k[q]*W+(k[q]-1)*K*re/2;Z.attr("text-anchor",$),N||U.attr("transform",t(ne,ae))}function z(Z,oe){var re=Z.ts||oe.textfont.size;return M(re)&&re>0?re:0}u.textPointStyle=function(Z,oe,re){if(!!Z.size()){var se;if(oe.selectedpoints){var N=u.makeSelectedTextStyleFns(oe);se=N.selectedTextColorFn}var U=oe.texttemplate,q=re._fullLayout;Z.each(function($){var W=w.select(this),K=U?v.extractOption($,oe,"txt","texttemplate"):v.extractOption($,oe,"tx","text");if(!K&&K!==0){W.remove();return}if(U){var ne=oe._module.formatLabels,ae=ne?ne($,oe,q):{},ie={};m(ie,oe,$.i);var le=oe._meta||{};K=v.texttemplateString(K,ae,q._d3locale,ie,$,le)}var ye=$.tp||oe.textposition,ue=z($,oe),pe=se?se($):$.tc||oe.textfont.color;W.call(u.font,$.tf||oe.textfont.family,ue,pe).text(K).call(c.convertToTspans,re).call(P,ye,ue,$.mrc)})}},u.selectedTextStyle=function(Z,oe){if(!(!Z.size()||!oe.selectedpoints)){var re=u.makeSelectedTextStyleFns(oe);Z.each(function(se){var N=w.select(this),U=re.selectedTextColorFn(se),q=se.tp||oe.textposition,$=z(se,oe);n.fill(N,U);var W=a.traceIs(oe,"bar-like");P(N,q,$,se.mrc2||se.mrc,W)})}};var I=.5;u.smoothopen=function(Z,oe){if(Z.length<3)return"M"+Z.join("L");var re="M"+Z[0],se=[],N;for(N=1;N<Z.length-1;N++)se.push(D(Z[N-1],Z[N],Z[N+1],oe));for(re+="Q"+se[0][0]+" "+Z[1],N=2;N<Z.length-1;N++)re+="C"+se[N-2][1]+" "+se[N-1][0]+" "+Z[N];return re+="Q"+se[Z.length-3][1]+" "+Z[Z.length-1],re},u.smoothclosed=function(Z,oe){if(Z.length<3)return"M"+Z.join("L")+"Z";var re="M"+Z[0],se=Z.length-1,N=[D(Z[se],Z[0],Z[1],oe)],U;for(U=1;U<se;U++)N.push(D(Z[U-1],Z[U],Z[U+1],oe));for(N.push(D(Z[se-1],Z[se],Z[0],oe)),U=1;U<=se;U++)re+="C"+N[U-1][1]+" "+N[U][0]+" "+Z[U];return re+="C"+N[se][1]+" "+N[0][0]+" "+Z[0]+"Z",re};function D(Z,oe,re,se){var N=Z[0]-oe[0],U=Z[1]-oe[1],q=re[0]-oe[0],$=re[1]-oe[1],W=Math.pow(N*N+U*U,I/2),K=Math.pow(q*q+$*$,I/2),ne=(K*K*N-W*W*q)*se,ae=(K*K*U-W*W*$)*se,ie=3*K*(W+K),le=3*W*(W+K);return[[w.round(oe[0]+(ie&&ne/ie),2),w.round(oe[1]+(ie&&ae/ie),2)],[w.round(oe[0]-(le&&ne/le),2),w.round(oe[1]-(le&&ae/le),2)]]}var R={hv:function(Z,oe){return"H"+w.round(oe[0],2)+"V"+w.round(oe[1],2)},vh:function(Z,oe){return"V"+w.round(oe[1],2)+"H"+w.round(oe[0],2)},hvh:function(Z,oe){return"H"+w.round((Z[0]+oe[0])/2,2)+"V"+w.round(oe[1],2)+"H"+w.round(oe[0],2)},vhv:function(Z,oe){return"V"+w.round((Z[1]+oe[1])/2,2)+"H"+w.round(oe[0],2)+"V"+w.round(oe[1],2)}},B=function(Z,oe){return"L"+w.round(oe[0],2)+","+w.round(oe[1],2)};u.steps=function(Z){var oe=R[Z]||B;return function(re){for(var se="M"+w.round(re[0][0],2)+","+w.round(re[0][1],2),N=1;N<re.length;N++)se+=oe(re[N-1],re[N]);return se}},u.makeTester=function(){var Z=v.ensureSingleById(w.select("body"),"svg","js-plotly-tester",function(re){re.attr(o.svgAttrs).style({position:"absolute",left:"-10000px",top:"-10000px",width:"9000px",height:"9000px","z-index":"1"})}),oe=v.ensureSingle(Z,"path","js-reference-point",function(re){re.attr("d","M0,0H1V1H0Z").style({"stroke-width":0,fill:"black"})});u.tester=Z,u.testref=oe},u.savedBBoxes={};var F=0,H=1e4;u.bBox=function(Z,oe,re){re||(re=G(Z));var se;if(re){if(se=u.savedBBoxes[re],se)return v.extendFlat({},se)}else if(Z.childNodes.length===1){var N=Z.childNodes[0];if(re=G(N),re){var U=+N.getAttribute("x")||0,q=+N.getAttribute("y")||0,$=N.getAttribute("transform");if(!$){var W=u.bBox(N,!1,re);return U&&(W.left+=U,W.right+=U),q&&(W.top+=q,W.bottom+=q),W}if(re+="~"+U+"~"+q+"~"+$,se=u.savedBBoxes[re],se)return v.extendFlat({},se)}}var K,ne;oe?K=Z:(ne=u.tester.node(),K=Z.cloneNode(!0),ne.appendChild(K)),w.select(K).attr("transform",null).call(c.positionText,0,0);var ae=K.getBoundingClientRect(),ie=u.testref.node().getBoundingClientRect();oe||ne.removeChild(K);var le={height:ae.height,width:ae.width,left:ae.left-ie.left,top:ae.top-ie.top,right:ae.right-ie.left,bottom:ae.bottom-ie.top};return F>=H&&(u.savedBBoxes={},F=0),re&&(u.savedBBoxes[re]=le),F++,v.extendFlat({},le)};function G(Z){var oe=Z.getAttribute("data-unformatted");if(oe!==null)return oe+Z.getAttribute("data-math")+Z.getAttribute("text-anchor")+Z.getAttribute("style")}u.setClipUrl=function(Z,oe,re){Z.attr("clip-path",J(oe,re))};function J(Z,oe){if(!Z)return null;var re=oe._context,se=re._exportedPlot?"":re._baseUrl||"";return se?"url('"+se+"#"+Z+"')":"url(#"+Z+")"}u.getTranslate=function(Z){var oe=/.*\btranslate\((-?\d*\.?\d*)[^-\d]*(-?\d*\.?\d*)[^\d].*/,re=Z.attr?"attr":"getAttribute",se=Z[re]("transform")||"",N=se.replace(oe,function(U,q,$){return[q,$].join(" ")}).split(" ");return{x:+N[0]||0,y:+N[1]||0}},u.setTranslate=function(Z,oe,re){var se=/(\btranslate\(.*?\);?)/,N=Z.attr?"attr":"getAttribute",U=Z.attr?"attr":"setAttribute",q=Z[N]("transform")||"";return oe=oe||0,re=re||0,q=q.replace(se,"").trim(),q+=t(oe,re),q=q.trim(),Z[U]("transform",q),q},u.getScale=function(Z){var oe=/.*\bscale\((\d*\.?\d*)[^\d]*(\d*\.?\d*)[^\d].*/,re=Z.attr?"attr":"getAttribute",se=Z[re]("transform")||"",N=se.replace(oe,function(U,q,$){return[q,$].join(" ")}).split(" ");return{x:+N[0]||1,y:+N[1]||1}},u.setScale=function(Z,oe,re){var se=/(\bscale\(.*?\);?)/,N=Z.attr?"attr":"getAttribute",U=Z.attr?"attr":"setAttribute",q=Z[N]("transform")||"";return oe=oe||1,re=re||1,q=q.replace(se,"").trim(),q+="scale("+oe+","+re+")",q=q.trim(),Z[U]("transform",q),q};var X=/\s*sc.*/;u.setPointGroupScale=function(Z,oe,re){if(oe=oe||1,re=re||1,!!Z){var se=oe===1&&re===1?"":"scale("+oe+","+re+")";Z.each(function(){var N=(this.getAttribute("transform")||"").replace(X,"");N+=se,N=N.trim(),this.setAttribute("transform",N)})}};var Y=/translate\([^)]*\)\s*$/;u.setTextPointsScale=function(Z,oe,re){!Z||Z.each(function(){var se,N=w.select(this),U=N.select("text");if(!!U.node()){var q=parseFloat(U.attr("x")||0),$=parseFloat(U.attr("y")||0),W=(N.attr("transform")||"").match(Y);oe===1&&re===1?se=[]:se=[t(q,$),"scale("+oe+","+re+")",t(-q,-$)],W&&se.push(W),N.attr("transform",se.join(""))}})}},{"../../components/fx/helpers":403,"../../constants/alignment":483,"../../constants/interactions":490,"../../constants/xmlns_namespaces":492,"../../lib":515,"../../lib/svg_text_utils":541,"../../registry":647,"../../traces/scatter/make_bubble_size_func":953,"../../traces/scatter/subtypes":961,"../color":367,"../colorscale":379,"./symbol_defs":390,"@plotly/d3":58,"fast-isnumeric":190,tinycolor2:313}],390:[function(d,ee,te){var w=d("@plotly/d3");ee.exports={circle:{n:0,f:function(v){var S=w.round(v,2);return"M"+S+",0A"+S+","+S+" 0 1,1 0,-"+S+"A"+S+","+S+" 0 0,1 "+S+",0Z"}},square:{n:1,f:function(v){var S=w.round(v,2);return"M"+S+","+S+"H-"+S+"V-"+S+"H"+S+"Z"}},diamond:{n:2,f:function(v){var S=w.round(v*1.3,2);return"M"+S+",0L0,"+S+"L-"+S+",0L0,-"+S+"Z"}},cross:{n:3,f:function(v){var S=w.round(v*.4,2),M=w.round(v*1.2,2);return"M"+M+","+S+"H"+S+"V"+M+"H-"+S+"V"+S+"H-"+M+"V-"+S+"H-"+S+"V-"+M+"H"+S+"V-"+S+"H"+M+"Z"}},x:{n:4,f:function(v){var S=w.round(v*.8/Math.sqrt(2),2),M="l"+S+","+S,e="l"+S+",-"+S,a="l-"+S+",-"+S,n="l-"+S+","+S;return"M0,"+S+M+e+a+e+a+n+a+n+M+n+M+"Z"}},"triangle-up":{n:5,f:function(v){var S=w.round(v*2/Math.sqrt(3),2),M=w.round(v/2,2),e=w.round(v,2);return"M-"+S+","+M+"H"+S+"L0,-"+e+"Z"}},"triangle-down":{n:6,f:function(v){var S=w.round(v*2/Math.sqrt(3),2),M=w.round(v/2,2),e=w.round(v,2);return"M-"+S+",-"+M+"H"+S+"L0,"+e+"Z"}},"triangle-left":{n:7,f:function(v){var S=w.round(v*2/Math.sqrt(3),2),M=w.round(v/2,2),e=w.round(v,2);return"M"+M+",-"+S+"V"+S+"L-"+e+",0Z"}},"triangle-right":{n:8,f:function(v){var S=w.round(v*2/Math.sqrt(3),2),M=w.round(v/2,2),e=w.round(v,2);return"M-"+M+",-"+S+"V"+S+"L"+e+",0Z"}},"triangle-ne":{n:9,f:function(v){var S=w.round(v*.6,2),M=w.round(v*1.2,2);return"M-"+M+",-"+S+"H"+S+"V"+M+"Z"}},"triangle-se":{n:10,f:function(v){var S=w.round(v*.6,2),M=w.round(v*1.2,2);return"M"+S+",-"+M+"V"+S+"H-"+M+"Z"}},"triangle-sw":{n:11,f:function(v){var S=w.round(v*.6,2),M=w.round(v*1.2,2);return"M"+M+","+S+"H-"+S+"V-"+M+"Z"}},"triangle-nw":{n:12,f:function(v){var S=w.round(v*.6,2),M=w.round(v*1.2,2);return"M-"+S+","+M+"V-"+S+"H"+M+"Z"}},pentagon:{n:13,f:function(v){var S=w.round(v*.951,2),M=w.round(v*.588,2),e=w.round(-v,2),a=w.round(v*-.309,2),n=w.round(v*.809,2);return"M"+S+","+a+"L"+M+","+n+"H-"+M+"L-"+S+","+a+"L0,"+e+"Z"}},hexagon:{n:14,f:function(v){var S=w.round(v,2),M=w.round(v/2,2),e=w.round(v*Math.sqrt(3)/2,2);return"M"+e+",-"+M+"V"+M+"L0,"+S+"L-"+e+","+M+"V-"+M+"L0,-"+S+"Z"}},hexagon2:{n:15,f:function(v){var S=w.round(v,2),M=w.round(v/2,2),e=w.round(v*Math.sqrt(3)/2,2);return"M-"+M+","+e+"H"+M+"L"+S+",0L"+M+",-"+e+"H-"+M+"L-"+S+",0Z"}},octagon:{n:16,f:function(v){var S=w.round(v*.924,2),M=w.round(v*.383,2);return"M-"+M+",-"+S+"H"+M+"L"+S+",-"+M+"V"+M+"L"+M+","+S+"H-"+M+"L-"+S+","+M+"V-"+M+"Z"}},star:{n:17,f:function(v){var S=v*1.4,M=w.round(S*.225,2),e=w.round(S*.951,2),a=w.round(S*.363,2),n=w.round(S*.588,2),r=w.round(-S,2),t=w.round(S*-.309,2),c=w.round(S*.118,2),o=w.round(S*.809,2),i=w.round(S*.382,2);return"M"+M+","+t+"H"+e+"L"+a+","+c+"L"+n+","+o+"L0,"+i+"L-"+n+","+o+"L-"+a+","+c+"L-"+e+","+t+"H-"+M+"L0,"+r+"Z"}},hexagram:{n:18,f:function(v){var S=w.round(v*.66,2),M=w.round(v*.38,2),e=w.round(v*.76,2);return"M-"+e+",0l-"+M+",-"+S+"h"+e+"l"+M+",-"+S+"l"+M+","+S+"h"+e+"l-"+M+","+S+"l"+M+","+S+"h-"+e+"l-"+M+","+S+"l-"+M+",-"+S+"h-"+e+"Z"}},"star-triangle-up":{n:19,f:function(v){var S=w.round(v*Math.sqrt(3)*.8,2),M=w.round(v*.8,2),e=w.round(v*1.6,2),a=w.round(v*4,2),n="A "+a+","+a+" 0 0 1 ";return"M-"+S+","+M+n+S+","+M+n+"0,-"+e+n+"-"+S+","+M+"Z"}},"star-triangle-down":{n:20,f:function(v){var S=w.round(v*Math.sqrt(3)*.8,2),M=w.round(v*.8,2),e=w.round(v*1.6,2),a=w.round(v*4,2),n="A "+a+","+a+" 0 0 1 ";return"M"+S+",-"+M+n+"-"+S+",-"+M+n+"0,"+e+n+S+",-"+M+"Z"}},"star-square":{n:21,f:function(v){var S=w.round(v*1.1,2),M=w.round(v*2,2),e="A "+M+","+M+" 0 0 1 ";return"M-"+S+",-"+S+e+"-"+S+","+S+e+S+","+S+e+S+",-"+S+e+"-"+S+",-"+S+"Z"}},"star-diamond":{n:22,f:function(v){var S=w.round(v*1.4,2),M=w.round(v*1.9,2),e="A "+M+","+M+" 0 0 1 ";return"M-"+S+",0"+e+"0,"+S+e+S+",0"+e+"0,-"+S+e+"-"+S+",0Z"}},"diamond-tall":{n:23,f:function(v){var S=w.round(v*.7,2),M=w.round(v*1.4,2);return"M0,"+M+"L"+S+",0L0,-"+M+"L-"+S+",0Z"}},"diamond-wide":{n:24,f:function(v){var S=w.round(v*1.4,2),M=w.round(v*.7,2);return"M0,"+M+"L"+S+",0L0,-"+M+"L-"+S+",0Z"}},hourglass:{n:25,f:function(v){var S=w.round(v,2);return"M"+S+","+S+"H-"+S+"L"+S+",-"+S+"H-"+S+"Z"},noDot:!0},bowtie:{n:26,f:function(v){var S=w.round(v,2);return"M"+S+","+S+"V-"+S+"L-"+S+","+S+"V-"+S+"Z"},noDot:!0},"circle-cross":{n:27,f:function(v){var S=w.round(v,2);return"M0,"+S+"V-"+S+"M"+S+",0H-"+S+"M"+S+",0A"+S+","+S+" 0 1,1 0,-"+S+"A"+S+","+S+" 0 0,1 "+S+",0Z"},needLine:!0,noDot:!0},"circle-x":{n:28,f:function(v){var S=w.round(v,2),M=w.round(v/Math.sqrt(2),2);return"M"+M+","+M+"L-"+M+",-"+M+"M"+M+",-"+M+"L-"+M+","+M+"M"+S+",0A"+S+","+S+" 0 1,1 0,-"+S+"A"+S+","+S+" 0 0,1 "+S+",0Z"},needLine:!0,noDot:!0},"square-cross":{n:29,f:function(v){var S=w.round(v,2);return"M0,"+S+"V-"+S+"M"+S+",0H-"+S+"M"+S+","+S+"H-"+S+"V-"+S+"H"+S+"Z"},needLine:!0,noDot:!0},"square-x":{n:30,f:function(v){var S=w.round(v,2);return"M"+S+","+S+"L-"+S+",-"+S+"M"+S+",-"+S+"L-"+S+","+S+"M"+S+","+S+"H-"+S+"V-"+S+"H"+S+"Z"},needLine:!0,noDot:!0},"diamond-cross":{n:31,f:function(v){var S=w.round(v*1.3,2);return"M"+S+",0L0,"+S+"L-"+S+",0L0,-"+S+"ZM0,-"+S+"V"+S+"M-"+S+",0H"+S},needLine:!0,noDot:!0},"diamond-x":{n:32,f:function(v){var S=w.round(v*1.3,2),M=w.round(v*.65,2);return"M"+S+",0L0,"+S+"L-"+S+",0L0,-"+S+"ZM-"+M+",-"+M+"L"+M+","+M+"M-"+M+","+M+"L"+M+",-"+M},needLine:!0,noDot:!0},"cross-thin":{n:33,f:function(v){var S=w.round(v*1.4,2);return"M0,"+S+"V-"+S+"M"+S+",0H-"+S},needLine:!0,noDot:!0,noFill:!0},"x-thin":{n:34,f:function(v){var S=w.round(v,2);return"M"+S+","+S+"L-"+S+",-"+S+"M"+S+",-"+S+"L-"+S+","+S},needLine:!0,noDot:!0,noFill:!0},asterisk:{n:35,f:function(v){var S=w.round(v*1.2,2),M=w.round(v*.85,2);return"M0,"+S+"V-"+S+"M"+S+",0H-"+S+"M"+M+","+M+"L-"+M+",-"+M+"M"+M+",-"+M+"L-"+M+","+M},needLine:!0,noDot:!0,noFill:!0},hash:{n:36,f:function(v){var S=w.round(v/2,2),M=w.round(v,2);return"M"+S+","+M+"V-"+M+"m-"+M+",0V"+M+"M"+M+","+S+"H-"+M+"m0,-"+M+"H"+M},needLine:!0,noFill:!0},"y-up":{n:37,f:function(v){var S=w.round(v*1.2,2),M=w.round(v*1.6,2),e=w.round(v*.8,2);return"M-"+S+","+e+"L0,0M"+S+","+e+"L0,0M0,-"+M+"L0,0"},needLine:!0,noDot:!0,noFill:!0},"y-down":{n:38,f:function(v){var S=w.round(v*1.2,2),M=w.round(v*1.6,2),e=w.round(v*.8,2);return"M-"+S+",-"+e+"L0,0M"+S+",-"+e+"L0,0M0,"+M+"L0,0"},needLine:!0,noDot:!0,noFill:!0},"y-left":{n:39,f:function(v){var S=w.round(v*1.2,2),M=w.round(v*1.6,2),e=w.round(v*.8,2);return"M"+e+","+S+"L0,0M"+e+",-"+S+"L0,0M-"+M+",0L0,0"},needLine:!0,noDot:!0,noFill:!0},"y-right":{n:40,f:function(v){var S=w.round(v*1.2,2),M=w.round(v*1.6,2),e=w.round(v*.8,2);return"M-"+e+","+S+"L0,0M-"+e+",-"+S+"L0,0M"+M+",0L0,0"},needLine:!0,noDot:!0,noFill:!0},"line-ew":{n:41,f:function(v){var S=w.round(v*1.4,2);return"M"+S+",0H-"+S},needLine:!0,noDot:!0,noFill:!0},"line-ns":{n:42,f:function(v){var S=w.round(v*1.4,2);return"M0,"+S+"V-"+S},needLine:!0,noDot:!0,noFill:!0},"line-ne":{n:43,f:function(v){var S=w.round(v,2);return"M"+S+",-"+S+"L-"+S+","+S},needLine:!0,noDot:!0,noFill:!0},"line-nw":{n:44,f:function(v){var S=w.round(v,2);return"M"+S+","+S+"L-"+S+",-"+S},needLine:!0,noDot:!0,noFill:!0},"arrow-up":{n:45,f:function(v){var S=w.round(v,2),M=w.round(v*2,2);return"M0,0L-"+S+","+M+"H"+S+"Z"},noDot:!0},"arrow-down":{n:46,f:function(v){var S=w.round(v,2),M=w.round(v*2,2);return"M0,0L-"+S+",-"+M+"H"+S+"Z"},noDot:!0},"arrow-left":{n:47,f:function(v){var S=w.round(v*2,2),M=w.round(v,2);return"M0,0L"+S+",-"+M+"V"+M+"Z"},noDot:!0},"arrow-right":{n:48,f:function(v){var S=w.round(v*2,2),M=w.round(v,2);return"M0,0L-"+S+",-"+M+"V"+M+"Z"},noDot:!0},"arrow-bar-up":{n:49,f:function(v){var S=w.round(v,2),M=w.round(v*2,2);return"M-"+S+",0H"+S+"M0,0L-"+S+","+M+"H"+S+"Z"},needLine:!0,noDot:!0},"arrow-bar-down":{n:50,f:function(v){var S=w.round(v,2),M=w.round(v*2,2);return"M-"+S+",0H"+S+"M0,0L-"+S+",-"+M+"H"+S+"Z"},needLine:!0,noDot:!0},"arrow-bar-left":{n:51,f:function(v){var S=w.round(v*2,2),M=w.round(v,2);return"M0,-"+M+"V"+M+"M0,0L"+S+",-"+M+"V"+M+"Z"},needLine:!0,noDot:!0},"arrow-bar-right":{n:52,f:function(v){var S=w.round(v*2,2),M=w.round(v,2);return"M0,-"+M+"V"+M+"M0,0L-"+S+",-"+M+"V"+M+"Z"},needLine:!0,noDot:!0}}},{"@plotly/d3":58}],391:[function(d,ee,te){ee.exports={visible:{valType:"boolean",editType:"calc"},type:{valType:"enumerated",values:["percent","constant","sqrt","data"],editType:"calc"},symmetric:{valType:"boolean",editType:"calc"},array:{valType:"data_array",editType:"calc"},arrayminus:{valType:"data_array",editType:"calc"},value:{valType:"number",min:0,dflt:10,editType:"calc"},valueminus:{valType:"number",min:0,dflt:10,editType:"calc"},traceref:{valType:"integer",min:0,dflt:0,editType:"style"},tracerefminus:{valType:"integer",min:0,dflt:0,editType:"style"},copy_ystyle:{valType:"boolean",editType:"plot"},copy_zstyle:{valType:"boolean",editType:"style"},color:{valType:"color",editType:"style"},thickness:{valType:"number",min:0,dflt:2,editType:"style"},width:{valType:"number",min:0,editType:"plot"},editType:"calc",_deprecated:{opacity:{valType:"number",editType:"style"}}}},{}],392:[function(d,ee,te){var w=d("fast-isnumeric"),v=d("../../registry"),S=d("../../plots/cartesian/axes"),M=d("../../lib"),e=d("./compute_error");ee.exports=function(r){for(var t=r.calcdata,c=0;c<t.length;c++){var o=t[c],i=o[0].trace;if(i.visible===!0&&v.traceIs(i,"errorBarsOK")){var y=S.getFromId(r,i.xaxis),p=S.getFromId(r,i.yaxis);a(o,i,y,"x"),a(o,i,p,"y")}}};function a(n,r,t,c){var o=r["error_"+c]||{},i=o.visible&&["linear","log"].indexOf(t.type)!==-1,y=[];if(!!i){for(var p=e(o),g=0;g<n.length;g++){var h=n[g],m=h.i;if(m===void 0)m=g;else if(m===null)continue;var u=h[c];if(!!w(t.c2l(u))){var _=p(u,m);if(w(_[0])&&w(_[1])){var s=h[c+"s"]=u-_[0],A=h[c+"h"]=u+_[1];y.push(s,A)}}}var b=t._id,f=r._extremes[b],x=S.findExtremes(t,y,M.extendFlat({tozero:f.opts.tozero},{padded:!0}));f.min=f.min.concat(x.min),f.max=f.max.concat(x.max)}}},{"../../lib":515,"../../plots/cartesian/axes":566,"../../registry":647,"./compute_error":393,"fast-isnumeric":190}],393:[function(d,ee,te){ee.exports=function(S){var M=S.type,e=S.symmetric;if(M==="data"){var a=S.array||[];if(e)return function(o,i){var y=+a[i];return[y,y]};var n=S.arrayminus||[];return function(o,i){var y=+a[i],p=+n[i];return!isNaN(y)||!isNaN(p)?[p||0,y||0]:[NaN,NaN]}}else{var r=w(M,S.value),t=w(M,S.valueminus);return e||S.valueminus===void 0?function(o){var i=r(o);return[i,i]}:function(o){return[t(o),r(o)]}}};function w(v,S){if(v==="percent")return function(M){return Math.abs(M*S/100)};if(v==="constant")return function(){return Math.abs(S)};if(v==="sqrt")return function(M){return Math.sqrt(Math.abs(M))}}},{}],394:[function(d,ee,te){var w=d("fast-isnumeric"),v=d("../../registry"),S=d("../../lib"),M=d("../../plot_api/plot_template"),e=d("./attributes");ee.exports=function(a,n,r,t){var c="error_"+t.axis,o=M.newContainer(n,c),i=a[c]||{};function y(s,A){return S.coerce(i,o,e,s,A)}var p=i.array!==void 0||i.value!==void 0||i.type==="sqrt",g=y("visible",p);if(g!==!1){var h=y("type","array"in i?"data":"percent"),m=!0;h!=="sqrt"&&(m=y("symmetric",!((h==="data"?"arrayminus":"valueminus")in i))),h==="data"?(y("array"),y("traceref"),m||(y("arrayminus"),y("tracerefminus"))):(h==="percent"||h==="constant")&&(y("value"),m||y("valueminus"));var u="copy_"+t.inherit+"style";if(t.inherit){var _=n["error_"+t.inherit];(_||{}).visible&&y(u,!(i.color||w(i.thickness)||w(i.width)))}(!t.inherit||!o[u])&&(y("color",r),y("thickness"),y("width",v.traceIs(n,"gl3d")?0:4))}}},{"../../lib":515,"../../plot_api/plot_template":555,"../../registry":647,"./attributes":391,"fast-isnumeric":190}],395:[function(d,ee,te){var w=d("../../lib"),v=d("../../plot_api/edit_types").overrideAll,S=d("./attributes"),M={error_x:w.extendFlat({},S),error_y:w.extendFlat({},S)};delete M.error_x.copy_zstyle,delete M.error_y.copy_zstyle,delete M.error_y.copy_ystyle;var e={error_x:w.extendFlat({},S),error_y:w.extendFlat({},S),error_z:w.extendFlat({},S)};delete e.error_x.copy_ystyle,delete e.error_y.copy_ystyle,delete e.error_z.copy_ystyle,delete e.error_z.copy_zstyle,ee.exports={moduleType:"component",name:"errorbars",schema:{traces:{scatter:M,bar:M,histogram:M,scatter3d:v(e,"calc","nested"),scattergl:v(M,"calc","nested")}},supplyDefaults:d("./defaults"),calc:d("./calc"),makeComputeError:d("./compute_error"),plot:d("./plot"),style:d("./style"),hoverInfo:a};function a(n,r,t){(r.error_y||{}).visible&&(t.yerr=n.yh-n.y,r.error_y.symmetric||(t.yerrneg=n.y-n.ys)),(r.error_x||{}).visible&&(t.xerr=n.xh-n.x,r.error_x.symmetric||(t.xerrneg=n.x-n.xs))}},{"../../lib":515,"../../plot_api/edit_types":548,"./attributes":391,"./calc":392,"./compute_error":393,"./defaults":394,"./plot":396,"./style":397}],396:[function(d,ee,te){var w=d("@plotly/d3"),v=d("fast-isnumeric"),S=d("../drawing"),M=d("../../traces/scatter/subtypes");ee.exports=function(n,r,t,c){var o,i=t.xaxis,y=t.yaxis,p=c&&c.duration>0;r.each(function(g){var h=g[0].trace,m=h.error_x||{},u=h.error_y||{},_;h.ids&&(_=function(f){return f.id});var s=M.hasMarkers(h)&&h.marker.maxdisplayed>0;!u.visible&&!m.visible&&(g=[]);var A=w.select(this).selectAll("g.errorbar").data(g,_);if(A.exit().remove(),!!g.length){m.visible||A.selectAll("path.xerror").remove(),u.visible||A.selectAll("path.yerror").remove(),A.style("opacity",1);var b=A.enter().append("g").classed("errorbar",!0);p&&b.style("opacity",0).transition().duration(c.duration).style("opacity",1),S.setClipUrl(A,t.layerClipId,n),A.each(function(f){var x=w.select(this),l=e(f,i,y);if(!(s&&!f.vis)){var L,T=x.select("path.yerror");if(u.visible&&v(l.x)&&v(l.yh)&&v(l.ys)){var k=u.width;L="M"+(l.x-k)+","+l.yh+"h"+2*k+"m-"+k+",0V"+l.ys,l.noYS||(L+="m-"+k+",0h"+2*k),o=!T.size(),o?T=x.append("path").style("vector-effect","non-scaling-stroke").classed("yerror",!0):p&&(T=T.transition().duration(c.duration).ease(c.easing)),T.attr("d",L)}else T.remove();var P=x.select("path.xerror");if(m.visible&&v(l.y)&&v(l.xh)&&v(l.xs)){var z=(m.copy_ystyle?u:m).width;L="M"+l.xh+","+(l.y-z)+"v"+2*z+"m0,-"+z+"H"+l.xs,l.noXS||(L+="m0,-"+z+"v"+2*z),o=!P.size(),o?P=x.append("path").style("vector-effect","non-scaling-stroke").classed("xerror",!0):p&&(P=P.transition().duration(c.duration).ease(c.easing)),P.attr("d",L)}else P.remove()}})}})};function e(a,n,r){var t={x:n.c2p(a.x),y:r.c2p(a.y)};return a.yh!==void 0&&(t.yh=r.c2p(a.yh),t.ys=r.c2p(a.ys),v(t.ys)||(t.noYS=!0,t.ys=r.c2p(a.ys,!0))),a.xh!==void 0&&(t.xh=n.c2p(a.xh),t.xs=n.c2p(a.xs),v(t.xs)||(t.noXS=!0,t.xs=n.c2p(a.xs,!0))),t}},{"../../traces/scatter/subtypes":961,"../drawing":389,"@plotly/d3":58,"fast-isnumeric":190}],397:[function(d,ee,te){var w=d("@plotly/d3"),v=d("../color");ee.exports=function(M){M.each(function(e){var a=e[0].trace,n=a.error_y||{},r=a.error_x||{},t=w.select(this);t.selectAll("path.yerror").style("stroke-width",n.thickness+"px").call(v.stroke,n.color),r.copy_ystyle&&(r=n),t.selectAll("path.xerror").style("stroke-width",r.thickness+"px").call(v.stroke,r.color)})}},{"../color":367,"@plotly/d3":58}],398:[function(d,ee,te){var w=d("../../plots/font_attributes"),v=d("./layout_attributes").hoverlabel,S=d("../../lib/extend").extendFlat;ee.exports={hoverlabel:{bgcolor:S({},v.bgcolor,{arrayOk:!0}),bordercolor:S({},v.bordercolor,{arrayOk:!0}),font:w({arrayOk:!0,editType:"none"}),align:S({},v.align,{arrayOk:!0}),namelength:S({},v.namelength,{arrayOk:!0}),editType:"none"}}},{"../../lib/extend":505,"../../plots/font_attributes":594,"./layout_attributes":408}],399:[function(d,ee,te){var w=d("../../lib"),v=d("../../registry");ee.exports=function(e){var a=e.calcdata,n=e._fullLayout;function r(y){return function(p){return w.coerceHoverinfo({hoverinfo:p},{_module:y._module},n)}}for(var t=0;t<a.length;t++){var c=a[t],o=c[0].trace;if(!v.traceIs(o,"pie-like")){var i=v.traceIs(o,"2dMap")?S:w.fillArray;i(o.hoverinfo,c,"hi",r(o)),o.hovertemplate&&i(o.hovertemplate,c,"ht"),o.hoverlabel&&(i(o.hoverlabel.bgcolor,c,"hbg"),i(o.hoverlabel.bordercolor,c,"hbc"),i(o.hoverlabel.font.size,c,"hts"),i(o.hoverlabel.font.color,c,"htc"),i(o.hoverlabel.font.family,c,"htf"),i(o.hoverlabel.namelength,c,"hnl"),i(o.hoverlabel.align,c,"hta"))}}};function S(M,e,a,n){n=n||w.identity,Array.isArray(M)&&(e[0][a]=n(M))}},{"../../lib":515,"../../registry":647}],400:[function(d,ee,te){var w=d("../../registry"),v=d("./hover").hover;ee.exports=function(M,e,a){var n=w.getComponentMethod("annotations","onClick")(M,M._hoverdata);a!==void 0&&v(M,e,a,!0);function r(){M.emit("plotly_click",{points:M._hoverdata,event:e})}M._hoverdata&&e&&e.target&&(n&&n.then?n.then(r):r(),e.stopImmediatePropagation&&e.stopImmediatePropagation())}},{"../../registry":647,"./hover":404}],401:[function(d,ee,te){ee.exports={YANGLE:60,HOVERARROWSIZE:6,HOVERTEXTPAD:3,HOVERFONTSIZE:13,HOVERFONT:"Arial, sans-serif",HOVERMINTIME:50,HOVERID:"-hover"}},{}],402:[function(d,ee,te){var w=d("../../lib"),v=d("./attributes"),S=d("./hoverlabel_defaults");ee.exports=function(e,a,n,r){function t(o,i){return w.coerce(e,a,v,o,i)}var c=w.extendFlat({},r.hoverlabel);a.hovertemplate&&(c.namelength=-1),S(e,a,t,c)}},{"../../lib":515,"./attributes":398,"./hoverlabel_defaults":405}],403:[function(d,ee,te){var w=d("../../lib");te.getSubplot=function(n){return n.subplot||n.xaxis+n.yaxis||n.geo},te.isTraceInSubplots=function(n,r){if(n.type==="splom"){for(var t=n.xaxes||[],c=n.yaxes||[],o=0;o<t.length;o++)for(var i=0;i<c.length;i++)if(r.indexOf(t[o]+c[i])!==-1)return!0;return!1}return r.indexOf(te.getSubplot(n))!==-1},te.flat=function(n,r){for(var t=new Array(n.length),c=0;c<n.length;c++)t[c]=r;return t},te.p2c=function(n,r){for(var t=new Array(n.length),c=0;c<n.length;c++)t[c]=n[c].p2c(r);return t},te.getDistanceFunction=function(n,r,t,c){return n==="closest"?c||te.quadrature(r,t):n.charAt(0)==="x"?r:t},te.getClosest=function(n,r,t){if(t.index!==!1)t.index>=0&&t.index<n.length?t.distance=0:t.index=!1;else for(var c=0;c<n.length;c++){var o=r(n[c]);o<=t.distance&&(t.index=c,t.distance=o)}return t},te.inbox=function(n,r,t){return n*r<0||n===0?t:1/0},te.quadrature=function(n,r){return function(t){var c=n(t),o=r(t);return Math.sqrt(c*c+o*o)}},te.makeEventData=function(n,r,t){var c="index"in n?n.index:n.pointNumber,o={data:r._input,fullData:r,curveNumber:r.index,pointNumber:c};if(r._indexToPoints){var i=r._indexToPoints[c];i.length===1?o.pointIndex=i[0]:o.pointIndices=i}else o.pointIndex=c;return r._module.eventData?o=r._module.eventData(o,n,r,t,c):("xVal"in n?o.x=n.xVal:"x"in n&&(o.x=n.x),"yVal"in n?o.y=n.yVal:"y"in n&&(o.y=n.y),n.xa&&(o.xaxis=n.xa),n.ya&&(o.yaxis=n.ya),n.zLabelVal!==void 0&&(o.z=n.zLabelVal)),te.appendArrayPointValue(o,r,c),o},te.appendArrayPointValue=function(n,r,t){var c=r._arrayAttrs;if(!!c)for(var o=0;o<c.length;o++){var i=c[o],y=S(i);if(n[y]===void 0){var p=w.nestedProperty(r,i).get(),g=M(p,t);g!==void 0&&(n[y]=g)}}},te.appendArrayMultiPointValues=function(n,r,t){var c=r._arrayAttrs;if(!!c)for(var o=0;o<c.length;o++){var i=c[o],y=S(i);if(n[y]===void 0){for(var p=w.nestedProperty(r,i).get(),g=new Array(t.length),h=0;h<t.length;h++)g[h]=M(p,t[h]);n[y]=g}}};var v={ids:"id",locations:"location",labels:"label",values:"value","marker.colors":"color",parents:"parent"};function S(n){return v[n]||n}function M(n,r){if(Array.isArray(r)){if(Array.isArray(n)&&Array.isArray(n[r[0]]))return n[r[0]][r[1]]}else return n[r]}var e={x:!0,y:!0},a={"x unified":!0,"y unified":!0};te.isUnifiedHover=function(n){return typeof n!="string"?!1:!!a[n]},te.isXYhover=function(n){return typeof n!="string"?!1:!!e[n]}},{"../../lib":515}],404:[function(d,ee,te){var w=d("@plotly/d3"),v=d("fast-isnumeric"),S=d("tinycolor2"),M=d("../../lib"),e=M.strTranslate,a=M.strRotate,n=d("../../lib/events"),r=d("../../lib/svg_text_utils"),t=d("../../lib/override_cursor"),c=d("../drawing"),o=d("../color"),i=d("../dragelement"),y=d("../../plots/cartesian/axes"),p=d("../../registry"),g=d("./helpers"),h=d("./constants"),m=d("../legend/defaults"),u=d("../legend/draw"),_=h.YANGLE,s=Math.PI*_/180,A=1/Math.sin(s),b=Math.cos(s),f=Math.sin(s),x=h.HOVERARROWSIZE,l=h.HOVERTEXTPAD,L={box:!0,ohlc:!0,violin:!0,candlestick:!0},T={scatter:!0,scattergl:!0,splom:!0};te.hover=function(U,q,$,W){U=M.getGraphDiv(U);var K=q.target;M.throttle(U._fullLayout._uid+h.HOVERID,h.HOVERMINTIME,function(){k(U,q,$,W,K)})},te.loneHover=function(U,q){var $=!0;Array.isArray(U)||($=!1,U=[U]);var W=q.gd,K=oe(W),ne=re(W),ae=U.map(function(_e){var ze=_e._x0||_e.x0||_e.x||0,Oe=_e._x1||_e.x1||_e.x||0,Ye=_e._y0||_e.y0||_e.y||0,be=_e._y1||_e.y1||_e.y||0,Pe=_e.eventData;if(Pe){var Ge=Math.min(ze,Oe),Qe=Math.max(ze,Oe),Be=Math.min(Ye,be),Le=Math.max(Ye,be),He=_e.trace;if(p.traceIs(He,"gl3d")){var vt=W._fullLayout[He.scene]._scene.container,Rt=vt.offsetLeft,rr=vt.offsetTop;Ge+=Rt,Qe+=Rt,Be+=rr,Le+=rr}Pe.bbox={x0:Ge+ne,x1:Qe+ne,y0:Be+K,y1:Le+K},q.inOut_bbox&&q.inOut_bbox.push(Pe.bbox)}else Pe=!1;return{color:_e.color||o.defaultLine,x0:_e.x0||_e.x||0,x1:_e.x1||_e.x||0,y0:_e.y0||_e.y||0,y1:_e.y1||_e.y||0,xLabel:_e.xLabel,yLabel:_e.yLabel,zLabel:_e.zLabel,text:_e.text,name:_e.name,idealAlign:_e.idealAlign,borderColor:_e.borderColor,fontFamily:_e.fontFamily,fontSize:_e.fontSize,fontColor:_e.fontColor,nameLength:_e.nameLength,textAlign:_e.textAlign,trace:_e.trace||{index:0,hoverinfo:""},xa:{_offset:0},ya:{_offset:0},index:0,hovertemplate:_e.hovertemplate||!1,hovertemplateLabels:_e.hovertemplateLabels||!1,eventData:Pe}}),ie=!1,le=I(ae,{gd:W,hovermode:"closest",rotateLabels:ie,bgColor:q.bgColor||o.background,container:w.select(q.container),outerContainer:q.outerContainer||q.container}),ye=5,ue=0,pe=0;le.sort(function(_e,ze){return _e.y0-ze.y0}).each(function(_e,ze){var Oe=_e.y0-_e.by/2;Oe-ye<ue?_e.offset=ue-Oe+ye:_e.offset=0,ue=Oe+_e.by+_e.offset,ze===q.anchorIndex&&(pe=_e.offset)}).each(function(_e){_e.offset-=pe});var ge=W._fullLayout._invScaleX,Te=W._fullLayout._invScaleY;return B(le,ie,ge,Te),$?le:le.node()};function k(N,U,q,$,W){q||(q="xy");var K=Array.isArray(q)?q:[q],ne=N._fullLayout,ae=ne._plots||[],ie=ae[q],le=ne._has("cartesian");if(ie){var ye=ie.overlays.map(function(ar){return ar.id});K=K.concat(ye)}for(var ue=K.length,pe=new Array(ue),ge=new Array(ue),Te=!1,_e=0;_e<ue;_e++){var ze=K[_e];if(ae[ze])Te=!0,pe[_e]=ae[ze].xaxis,ge[_e]=ae[ze].yaxis;else if(ne[ze]&&ne[ze]._subplot){var Oe=ne[ze]._subplot;pe[_e]=Oe.xaxis,ge[_e]=Oe.yaxis}else{M.warn("Unrecognized subplot: "+ze);return}}var Ye=U.hovermode||ne.hovermode;if(Ye&&!Te&&(Ye="closest"),["x","y","closest","x unified","y unified"].indexOf(Ye)===-1||!N.calcdata||N.querySelector(".zoombox")||N._dragging)return i.unhoverRaw(N,U);var be=ne.hoverdistance;be===-1&&(be=1/0);var Pe=ne.spikedistance;Pe===-1&&(Pe=1/0);var Ge=[],Qe=[],Be,Le,He,vt,Rt,rr,Lt,Ft,Gt,Dt,kt,Ue,qe,Ve={hLinePoint:null,vLinePoint:null},Ae=!1;if(Array.isArray(U))for(Ye="array",He=0;He<U.length;He++)Rt=N.calcdata[U[He].curveNumber||0],Rt&&(rr=Rt[0].trace,Rt[0].trace.hoverinfo!=="skip"&&(Qe.push(Rt),rr.orientation==="h"&&(Ae=!0)));else{for(vt=0;vt<N.calcdata.length;vt++)Rt=N.calcdata[vt],rr=Rt[0].trace,rr.hoverinfo!=="skip"&&g.isTraceInSubplots(rr,K)&&(Qe.push(Rt),rr.orientation==="h"&&(Ae=!0));var Ne=!W,Xe,Je;if(Ne)"xpx"in U?Xe=U.xpx:Xe=pe[0]._length/2,"ypx"in U?Je=U.ypx:Je=ge[0]._length/2;else{if(n.triggerHandler(N,"plotly_beforehover",U)===!1)return;var _t=W.getBoundingClientRect();Xe=U.clientX-_t.left,Je=U.clientY-_t.top,ne._calcInverseTransform(N);var mt=M.apply3DTransform(ne._invTransform)(Xe,Je);if(Xe=mt[0],Je=mt[1],Xe<0||Xe>pe[0]._length||Je<0||Je>ge[0]._length)return i.unhoverRaw(N,U)}if(U.pointerX=Xe+pe[0]._offset,U.pointerY=Je+ge[0]._offset,"xval"in U?Be=g.flat(K,U.xval):Be=g.p2c(pe,Xe),"yval"in U?Le=g.flat(K,U.yval):Le=g.p2c(ge,Je),!v(Be[0])||!v(Le[0]))return M.warn("Fx.hover failed",U,N),i.unhoverRaw(N,U)}var Ot=1/0;function Kt(ar,Cr){for(vt=0;vt<Qe.length;vt++)if(Rt=Qe[vt],!(!Rt||!Rt[0]||!Rt[0].trace)&&(rr=Rt[0].trace,!(rr.visible!==!0||rr._length===0)&&["carpet","contourcarpet"].indexOf(rr._module.name)===-1)){if(rr.type==="splom"?(Ft=0,Lt=K[Ft]):(Lt=g.getSubplot(rr),Ft=K.indexOf(Lt)),Gt=Ye,g.isUnifiedHover(Gt)&&(Gt=Gt.charAt(0)),Ue={cd:Rt,trace:rr,xa:pe[Ft],ya:ge[Ft],maxHoverDistance:be,maxSpikeDistance:Pe,index:!1,distance:Math.min(Ot,be),spikeDistance:1/0,xSpike:void 0,ySpike:void 0,color:o.defaultLine,name:rr.name,x0:void 0,x1:void 0,y0:void 0,y1:void 0,xLabelVal:void 0,yLabelVal:void 0,zLabelVal:void 0,text:void 0},ne[Lt]&&(Ue.subplot=ne[Lt]._subplot),ne._splomScenes&&ne._splomScenes[rr.uid]&&(Ue.scene=ne._splomScenes[rr.uid]),qe=Ge.length,Gt==="array"){var Or=U[vt];"pointNumber"in Or?(Ue.index=Or.pointNumber,Gt="closest"):(Gt="","xval"in Or&&(Dt=Or.xval,Gt="x"),"yval"in Or&&(kt=Or.yval,Gt=Gt?"closest":"y"))}else ar!==void 0&&Cr!==void 0?(Dt=ar,kt=Cr):(Dt=Be[Ft],kt=Le[Ft]);if(be!==0)if(rr._module&&rr._module.hoverPoints){var Ir=rr._module.hoverPoints(Ue,Dt,kt,Gt,{finiteRange:!0,hoverLayer:ne._hoverlayer});if(Ir)for(var Tr,Wr=0;Wr<Ir.length;Wr++)Tr=Ir[Wr],v(Tr.x0)&&v(Tr.y0)&&Ge.push(F(Tr,Ye))}else M.log("Unrecognized trace type in hover:",rr);if(Ye==="closest"&&Ge.length>qe&&(Ge.splice(0,qe),Ot=Ge[0].distance),le&&Pe!==0&&Ge.length===0){Ue.distance=Pe,Ue.index=!1;var wn=rr._module.hoverPoints(Ue,Dt,kt,"closest",{hoverLayer:ne._hoverlayer});if(wn&&(wn=wn.filter(function(ga){return ga.spikeDistance<=Pe})),wn&&wn.length){var ln,Bn=wn.filter(function(ga){return ga.xa.showspikes&&ga.xa.spikesnap!=="hovered data"});if(Bn.length){var Cn=Bn[0];v(Cn.x0)&&v(Cn.y0)&&(ln=Wt(Cn),(!Ve.vLinePoint||Ve.vLinePoint.spikeDistance>ln.spikeDistance)&&(Ve.vLinePoint=ln))}var Wn=wn.filter(function(ga){return ga.ya.showspikes&&ga.ya.spikesnap!=="hovered data"});if(Wn.length){var Hn=Wn[0];v(Hn.x0)&&v(Hn.y0)&&(ln=Wt(Hn),(!Ve.hLinePoint||Ve.hLinePoint.spikeDistance>ln.spikeDistance)&&(Ve.hLinePoint=ln))}}}}}Kt();function Nt(ar,Cr,Or){for(var Ir=null,Tr=1/0,Wr,wn=0;wn<ar.length;wn++)Wr=ar[wn].spikeDistance,Or&&wn===0&&(Wr=-1/0),Wr<=Tr&&Wr<=Cr&&(Ir=ar[wn],Tr=Wr);return Ir}function Wt(ar){return ar?{xa:ar.xa,ya:ar.ya,x:ar.xSpike!==void 0?ar.xSpike:(ar.x0+ar.x1)/2,y:ar.ySpike!==void 0?ar.ySpike:(ar.y0+ar.y1)/2,distance:ar.distance,spikeDistance:ar.spikeDistance,curveNumber:ar.trace.index,color:ar.color,pointNumber:ar.index}:null}var qt={fullLayout:ne,container:ne._hoverlayer,event:U},Yt=N._spikepoints,fr={vLinePoint:Ve.vLinePoint,hLinePoint:Ve.hLinePoint};N._spikepoints=fr;var Yr=function(){Ge.sort(function(ar,Cr){return ar.distance-Cr.distance}),Ge=Y(Ge,Ye)};Yr();var hn=Ye.charAt(0),Qr=(hn==="x"||hn==="y")&&Ge[0]&&T[Ge[0].trace.type];if(le&&Pe!==0&&Ge.length!==0){var at=Ge.filter(function(ar){return ar.ya.showspikes}),Jt=Nt(at,Pe,Qr);Ve.hLinePoint=Wt(Jt);var Zt=Ge.filter(function(ar){return ar.xa.showspikes}),Ut=Nt(Zt,Pe,Qr);Ve.vLinePoint=Wt(Ut)}if(Ge.length===0){var _r=i.unhoverRaw(N,U);return le&&(Ve.hLinePoint!==null||Ve.vLinePoint!==null)&&J(Yt)&&H(N,Ve,qt),_r}if(le&&J(Yt)&&H(N,Ve,qt),g.isXYhover(Gt)&&Ge[0].length!==0&&Ge[0].trace.type!=="splom"){var rt=Ge[0];L[rt.trace.type]?Ge=Ge.filter(function(ar){return ar.trace.index===rt.trace.index}):Ge=[rt];var Ke=Ge.length,st=Z("x",rt,ne),lt=Z("y",rt,ne);Kt(st,lt);var wt=[],Pt={},ke=0,Se=function(ar){var Cr=L[ar.trace.type]?P(ar):ar.trace.index;if(!Pt[Cr])ke++,Pt[Cr]=ke,wt.push(ar);else{var Or=Pt[Cr]-1,Ir=wt[Or];Or>0&&Math.abs(ar.distance)<Math.abs(Ir.distance)&&(wt[Or]=ar)}},nt;for(nt=0;nt<Ke;nt++)Se(Ge[nt]);for(nt=Ge.length-1;nt>Ke-1;nt--)Se(Ge[nt]);Ge=wt,Yr()}var it=N._hoverdata,ct=[],At=oe(N),dt=re(N);for(He=0;He<Ge.length;He++){var Tt=Ge[He],Ht=g.makeEventData(Tt,Tt.trace,Tt.cd);if(Tt.hovertemplate!==!1){var ir=!1;Tt.cd[Tt.index]&&Tt.cd[Tt.index].ht&&(ir=Tt.cd[Tt.index].ht),Tt.hovertemplate=ir||Tt.trace.hovertemplate||!1}if(Tt.xa&&Tt.ya){var kr=Tt.x0+Tt.xa._offset,br=Tt.x1+Tt.xa._offset,Mr=Tt.y0+Tt.ya._offset,Hr=Tt.y1+Tt.ya._offset,nr=Math.min(kr,br),mr=Math.max(kr,br),Pr=Math.min(Mr,Hr),Nr=Math.max(Mr,Hr);Ht.bbox={x0:nr+dt,x1:mr+dt,y0:Pr+At,y1:Nr+At}}Tt.eventData=[Ht],ct.push(Ht)}N._hoverdata=ct;var Sr=Ye==="y"&&(Qe.length>1||Ge.length>1)||Ye==="closest"&&Ae&&Ge.length>1,tt=o.combine(ne.plot_bgcolor||o.background,ne.paper_bgcolor),Et=I(Ge,{gd:N,hovermode:Ye,rotateLabels:Sr,bgColor:tt,container:ne._hoverlayer,outerContainer:ne._paper.node(),commonLabelOpts:ne.hoverlabel,hoverdistance:ne.hoverdistance});if(g.isUnifiedHover(Ye)||(R(Et,Sr?"xa":"ya",ne),B(Et,Sr,ne._invScaleX,ne._invScaleY)),W&&W.tagName){var Vt=p.getComponentMethod("annotations","hasClickToShow")(N,ct);t(w.select(W),Vt?"pointer":"")}!W||$||!G(N,U,it)||(it&&N.emit("plotly_unhover",{event:U,points:it}),N.emit("plotly_hover",{event:U,points:N._hoverdata,xaxes:pe,yaxes:ge,xvals:Be,yvals:Le}))}function P(N){return[N.trace.index,N.index,N.x0,N.y0,N.name,N.attr,N.xa?N.xa._id:"",N.ya?N.ya._id:""].join(",")}var z=/<extra>([\s\S]*)<\/extra>/;function I(N,U){var q=U.gd,$=q._fullLayout,W=U.hovermode,K=U.rotateLabels,ne=U.bgColor,ae=U.container,ie=U.outerContainer,le=U.commonLabelOpts||{};if(N.length===0)return[[]];var ye=U.fontFamily||h.HOVERFONT,ue=U.fontSize||h.HOVERFONTSIZE,pe=N[0],ge=pe.xa,Te=pe.ya,_e=W.charAt(0),ze=pe[_e+"Label"],Oe=se(q,ie),Ye=Oe.top,be=Oe.width,Pe=Oe.height,Ge=ze!==void 0&&pe.distance<=U.hoverdistance&&(W==="x"||W==="y");if(Ge){var Qe=!0,Be,Le;for(Be=0;Be<N.length;Be++)if(Qe&&N[Be].zLabel===void 0&&(Qe=!1),Le=N[Be].hoverinfo||N[Be].trace.hoverinfo,Le){var He=Array.isArray(Le)?Le:Le.split("+");if(He.indexOf("all")===-1&&He.indexOf(W)===-1){Ge=!1;break}}Qe&&(Ge=!1)}var vt=ae.selectAll("g.axistext").data(Ge?[0]:[]);if(vt.enter().append("g").classed("axistext",!0),vt.exit().remove(),vt.each(function(){var Ut=w.select(this),_r=M.ensureSingle(Ut,"path","",function(Hr){Hr.style({"stroke-width":"1px"})}),rt=M.ensureSingle(Ut,"text","",function(Hr){Hr.attr("data-notex",1)}),Ke=le.bgcolor||o.defaultLine,st=le.bordercolor||o.contrast(Ke),lt=o.contrast(Ke),wt={family:le.font.family||ye,size:le.font.size||ue,color:le.font.color||lt};_r.style({fill:Ke,stroke:st}),rt.text(ze).call(c.font,wt).call(r.positionText,0,0).call(r.convertToTspans,q),Ut.attr("transform","");var Pt=se(q,rt.node()),ke,Se;if(W==="x"){var nt=ge.side==="top"?"-":"";rt.attr("text-anchor","middle").call(r.positionText,0,ge.side==="top"?Ye-Pt.bottom-x-l:Ye-Pt.top+x+l),ke=ge._offset+(pe.x0+pe.x1)/2,Se=Te._offset+(ge.side==="top"?0:Te._length);var it=Pt.width/2+l;ke<it?(ke=it,_r.attr("d","M-"+(it-x)+",0L-"+(it-x*2)+","+nt+x+"H"+(l+Pt.width/2)+"v"+nt+(l*2+Pt.height)+"H-"+it+"V"+nt+x+"Z")):ke>$.width-it?(ke=$.width-it,_r.attr("d","M"+(it-x)+",0L"+it+","+nt+x+"v"+nt+(l*2+Pt.height)+"H-"+it+"V"+nt+x+"H"+(it-x*2)+"Z")):_r.attr("d","M0,0L"+x+","+nt+x+"H"+(l+Pt.width/2)+"v"+nt+(l*2+Pt.height)+"H-"+(l+Pt.width/2)+"V"+nt+x+"H-"+x+"Z")}else{var ct,At,dt;Te.side==="right"?(ct="start",At=1,dt="",ke=ge._offset+ge._length):(ct="end",At=-1,dt="-",ke=ge._offset),Se=Te._offset+(pe.y0+pe.y1)/2,rt.attr("text-anchor",ct),_r.attr("d","M0,0L"+dt+x+","+x+"V"+(l+Pt.height/2)+"h"+dt+(l*2+Pt.width)+"V-"+(l+Pt.height/2)+"H"+dt+x+"V-"+x+"Z");var Tt=Pt.height/2,Ht=Ye-Pt.top-Tt,ir="clip"+$._uid+"commonlabel"+Te._id,kr;if(ke<Pt.width+2*l+x){kr="M-"+(x+l)+"-"+Tt+"h-"+(Pt.width-l)+"V"+Tt+"h"+(Pt.width-l)+"Z";var br=Pt.width-ke+l;r.positionText(rt,br,Ht),ct==="end"&&rt.selectAll("tspan").each(function(){var Hr=w.select(this),nr=c.tester.append("text").text(Hr.text()).call(c.font,wt),mr=se(q,nr.node());Math.round(mr.width)<Math.round(Pt.width)&&Hr.attr("x",br-mr.width),nr.remove()})}else r.positionText(rt,At*(l+x),Ht),kr=null;var Mr=$._topclips.selectAll("#"+ir).data(kr?[0]:[]);Mr.enter().append("clipPath").attr("id",ir).append("path"),Mr.exit().remove(),Mr.select("path").attr("d",kr),c.setClipUrl(rt,kr?ir:null,q)}Ut.attr("transform",e(ke,Se))}),g.isUnifiedHover(W)){ae.selectAll("g.hovertext").remove();var Rt=N.filter(function(Ut){return Ut.hoverinfo!=="none"});if(Rt.length===0)return;var rr=$.hoverlabel,Lt=rr.font,Ft={showlegend:!0,legend:{title:{text:ze,font:Lt},font:Lt,bgcolor:rr.bgcolor,bordercolor:rr.bordercolor,borderwidth:1,tracegroupgap:7,traceorder:$.legend?$.legend.traceorder:void 0,orientation:"v"}},Gt={font:Lt};m(Ft,Gt,q._fullData);var Dt=Gt.legend;Dt.entries=[];for(var kt=0;kt<Rt.length;kt++){var Ue=Rt[kt];if(Ue.hoverinfo!=="none"){var qe=D(Ue,!0,W,$,ze),Ve=qe[0],Ae=qe[1];Ue.name=Ae,Ae!==""?Ue.text=Ae+" : "+Ve:Ue.text=Ve;var Ne=Ue.cd[Ue.index];Ne&&(Ne.mc&&(Ue.mc=Ne.mc),Ne.mcc&&(Ue.mc=Ne.mcc),Ne.mlc&&(Ue.mlc=Ne.mlc),Ne.mlcc&&(Ue.mlc=Ne.mlcc),Ne.mlw&&(Ue.mlw=Ne.mlw),Ne.mrc&&(Ue.mrc=Ne.mrc),Ne.dir&&(Ue.dir=Ne.dir)),Ue._distinct=!0,Dt.entries.push([Ue])}}Dt.entries.sort(function(Ut,_r){return Ut[0].trace.index-_r[0].trace.index}),Dt.layer=ae,Dt._inHover=!0,Dt._groupTitleFont=rr.grouptitlefont,u(q,Dt);var Xe=ae.select("g.legend"),Je=se(q,Xe.node()),_t=Je.width+2*l,mt=Je.height+2*l,Ot=Rt[0],Kt=(Ot.x0+Ot.x1)/2,Nt=(Ot.y0+Ot.y1)/2,Wt=!(p.traceIs(Ot.trace,"bar-like")||p.traceIs(Ot.trace,"box-violin")),qt,Yt;_e==="y"?Wt?(Yt=Nt-l,qt=Nt+l):(Yt=Math.min.apply(null,Rt.map(function(Ut){return Math.min(Ut.y0,Ut.y1)})),qt=Math.max.apply(null,Rt.map(function(Ut){return Math.max(Ut.y0,Ut.y1)}))):Yt=qt=M.mean(Rt.map(function(Ut){return(Ut.y0+Ut.y1)/2}))-mt/2;var fr,Yr;_e==="x"?Wt?(fr=Kt+l,Yr=Kt-l):(fr=Math.max.apply(null,Rt.map(function(Ut){return Math.max(Ut.x0,Ut.x1)})),Yr=Math.min.apply(null,Rt.map(function(Ut){return Math.min(Ut.x0,Ut.x1)}))):fr=Yr=M.mean(Rt.map(function(Ut){return(Ut.x0+Ut.x1)/2}))-_t/2;var hn=ge._offset,Qr=Te._offset;qt+=Qr,fr+=hn,Yr+=hn-_t,Yt+=Qr-mt;var at,Jt;return fr+_t<be&&fr>=0?at=fr:Yr+_t<be&&Yr>=0?at=Yr:hn+_t<be?at=hn:fr-Kt<Kt-Yr+_t?at=be-_t:at=0,at+=l,qt+mt<Pe&&qt>=0?Jt=qt:Yt+mt<Pe&&Yt>=0?Jt=Yt:Qr+mt<Pe?Jt=Qr:qt-Nt<Nt-Yt+mt?Jt=Pe-mt:Jt=0,Jt+=l,Xe.attr("transform",e(at-1,Jt-1)),Xe}var Zt=ae.selectAll("g.hovertext").data(N,function(Ut){return P(Ut)});return Zt.enter().append("g").classed("hovertext",!0).each(function(){var Ut=w.select(this);Ut.append("rect").call(o.fill,o.addOpacity(ne,.8)),Ut.append("text").classed("name",!0),Ut.append("path").style("stroke-width","1px"),Ut.append("text").classed("nums",!0).call(c.font,ye,ue)}),Zt.exit().remove(),Zt.each(function(Ut){var _r=w.select(this).attr("transform",""),rt=Ut.color;Array.isArray(rt)&&(rt=rt[Ut.eventData[0].pointNumber]);var Ke=Ut.bgcolor||rt,st=o.combine(o.opacity(Ke)?Ke:o.defaultLine,ne),lt=o.combine(o.opacity(rt)?rt:o.defaultLine,ne),wt=Ut.borderColor||o.contrast(st),Pt=D(Ut,Ge,W,$,ze,_r),ke=Pt[0],Se=Pt[1],nt=_r.select("text.nums").call(c.font,Ut.fontFamily||ye,Ut.fontSize||ue,Ut.fontColor||wt).text(ke).attr("data-notex",1).call(r.positionText,0,0).call(r.convertToTspans,q),it=_r.select("text.name"),ct=0,At=0;if(Se&&Se!==ke){it.call(c.font,Ut.fontFamily||ye,Ut.fontSize||ue,lt).text(Se).attr("data-notex",1).call(r.positionText,0,0).call(r.convertToTspans,q);var dt=se(q,it.node());ct=dt.width+2*l,At=dt.height+2*l}else it.remove(),_r.select("rect").remove();_r.select("path").style({fill:st,stroke:wt});var Tt=Ut.xa._offset+(Ut.x0+Ut.x1)/2,Ht=Ut.ya._offset+(Ut.y0+Ut.y1)/2,ir=Math.abs(Ut.x1-Ut.x0),kr=Math.abs(Ut.y1-Ut.y0),br=se(q,nt.node()),Mr=br.width/$._invScaleX,Hr=br.height/$._invScaleY;Ut.ty0=(Ye-br.top)/$._invScaleY,Ut.bx=Mr+2*l,Ut.by=Math.max(Hr+2*l,At),Ut.anchor="start",Ut.txwidth=Mr,Ut.tx2width=ct,Ut.offset=0;var nr=(Mr+x+l+ct)*$._invScaleX,mr,Pr;if(K)Ut.pos=Tt,mr=Ht+kr/2+nr<=Pe,Pr=Ht-kr/2-nr>=0,(Ut.idealAlign==="top"||!mr)&&Pr?(Ht-=kr/2,Ut.anchor="end"):mr?(Ht+=kr/2,Ut.anchor="start"):Ut.anchor="middle";else if(Ut.pos=Ht,mr=Tt+ir/2+nr<=be,Pr=Tt-ir/2-nr>=0,(Ut.idealAlign==="left"||!mr)&&Pr)Tt-=ir/2,Ut.anchor="end";else if(mr)Tt+=ir/2,Ut.anchor="start";else{Ut.anchor="middle";var Nr=nr/2,Sr=Tt+Nr-be,tt=Tt-Nr;Sr>0&&(Tt-=Sr),tt<0&&(Tt+=-tt)}nt.attr("text-anchor",Ut.anchor),ct&&it.attr("text-anchor",Ut.anchor),_r.attr("transform",e(Tt,Ht)+(K?a(_):""))}),Zt}function D(N,U,q,$,W,K){var ne="",ae="";N.nameOverride!==void 0&&(N.name=N.nameOverride),N.name&&(N.trace._meta&&(N.name=M.templateString(N.name,N.trace._meta)),ne=X(N.name,N.nameLength));var ie=q.charAt(0),le=ie==="x"?"y":"x";N.zLabel!==void 0?(N.xLabel!==void 0&&(ae+="x: "+N.xLabel+"<br>"),N.yLabel!==void 0&&(ae+="y: "+N.yLabel+"<br>"),N.trace.type!=="choropleth"&&N.trace.type!=="choroplethmapbox"&&(ae+=(ae?"z: ":"")+N.zLabel)):U&&N[ie+"Label"]===W?ae=N[le+"Label"]||"":N.xLabel===void 0?N.yLabel!==void 0&&N.trace.type!=="scattercarpet"&&(ae=N.yLabel):N.yLabel===void 0?ae=N.xLabel:ae="("+N.xLabel+", "+N.yLabel+")",(N.text||N.text===0)&&!Array.isArray(N.text)&&(ae+=(ae?"<br>":"")+N.text),N.extraText!==void 0&&(ae+=(ae?"<br>":"")+N.extraText),K&&ae===""&&!N.hovertemplate&&(ne===""&&K.remove(),ae=ne);var ye=N.hovertemplate||!1;if(ye){var ue=N.hovertemplateLabels||N;N[ie+"Label"]!==W&&(ue[ie+"other"]=ue[ie+"Val"],ue[ie+"otherLabel"]=ue[ie+"Label"]),ae=M.hovertemplateString(ye,ue,$._d3locale,N.eventData[0]||{},N.trace._meta),ae=ae.replace(z,function(pe,ge){return ne=X(ge,N.nameLength),""})}return[ae,ne]}function R(N,U,q){var $=0,W=1,K=N.size(),ne=new Array(K),ae=0;N.each(function(Be){var Le=Be[U],He=Le._id.charAt(0)==="x",vt=Le.range;ae===0&&vt&&vt[0]>vt[1]!==He&&(W=-1),ne[ae++]=[{datum:Be,traceIndex:Be.trace.index,dp:0,pos:Be.pos,posref:Be.posref,size:Be.by*(He?A:1)/2,pmin:0,pmax:He?q.width:q.height}]}),ne.sort(function(Be,Le){return Be[0].posref-Le[0].posref||W*(Le[0].traceIndex-Be[0].traceIndex)});var ie,le,ye,ue,pe,ge,Te;function _e(Be){var Le=Be[0],He=Be[Be.length-1];if(le=Le.pmin-Le.pos-Le.dp+Le.size,ye=He.pos+He.dp+He.size-Le.pmax,le>.01){for(pe=Be.length-1;pe>=0;pe--)Be[pe].dp+=le;ie=!1}if(!(ye<.01)){if(le<-.01){for(pe=Be.length-1;pe>=0;pe--)Be[pe].dp-=ye;ie=!1}if(!!ie){var vt=0;for(ue=0;ue<Be.length;ue++)ge=Be[ue],ge.pos+ge.dp+ge.size>Le.pmax&&vt++;for(ue=Be.length-1;ue>=0&&!(vt<=0);ue--)ge=Be[ue],ge.pos>Le.pmax-1&&(ge.del=!0,vt--);for(ue=0;ue<Be.length&&!(vt<=0);ue++)if(ge=Be[ue],ge.pos<Le.pmin+1)for(ge.del=!0,vt--,ye=ge.size*2,pe=Be.length-1;pe>=0;pe--)Be[pe].dp-=ye;for(ue=Be.length-1;ue>=0&&!(vt<=0);ue--)ge=Be[ue],ge.pos+ge.dp+ge.size>Le.pmax&&(ge.del=!0,vt--)}}}for(;!ie&&$<=K;){for($++,ie=!0,ue=0;ue<ne.length-1;){var ze=ne[ue],Oe=ne[ue+1],Ye=ze[ze.length-1],be=Oe[0];if(le=Ye.pos+Ye.dp+Ye.size-be.pos-be.dp+be.size,le>.01&&Ye.pmin===be.pmin&&Ye.pmax===be.pmax){for(pe=Oe.length-1;pe>=0;pe--)Oe[pe].dp+=le;for(ze.push.apply(ze,Oe),ne.splice(ue+1,1),Te=0,pe=ze.length-1;pe>=0;pe--)Te+=ze[pe].dp;for(ye=Te/ze.length,pe=ze.length-1;pe>=0;pe--)ze[pe].dp-=ye;ie=!1}else ue++}ne.forEach(_e)}for(ue=ne.length-1;ue>=0;ue--){var Pe=ne[ue];for(pe=Pe.length-1;pe>=0;pe--){var Ge=Pe[pe],Qe=Ge.datum;Qe.offset=Ge.dp,Qe.del=Ge.del}}}function B(N,U,q,$){var W=function(ne){return ne*q},K=function(ne){return ne*$};N.each(function(ne){var ae=w.select(this);if(ne.del)return ae.remove();var ie=ae.select("text.nums"),le=ne.anchor,ye=le==="end"?-1:1,ue={start:1,end:-1,middle:0}[le],pe=ue*(x+l),ge=pe+ue*(ne.txwidth+l),Te=0,_e=ne.offset,ze=le==="middle";ze&&(pe-=ne.tx2width/2,ge+=ne.txwidth/2+l),U&&(_e*=-f,Te=ne.offset*b),ae.select("path").attr("d",ze?"M-"+W(ne.bx/2+ne.tx2width/2)+","+K(_e-ne.by/2)+"h"+W(ne.bx)+"v"+K(ne.by)+"h-"+W(ne.bx)+"Z":"M0,0L"+W(ye*x+Te)+","+K(x+_e)+"v"+K(ne.by/2-x)+"h"+W(ye*ne.bx)+"v-"+K(ne.by)+"H"+W(ye*x+Te)+"V"+K(_e-x)+"Z");var Oe=Te+pe,Ye=_e+ne.ty0-ne.by/2+l,be=ne.textAlign||"auto";be!=="auto"&&(be==="left"&&le!=="start"?(ie.attr("text-anchor","start"),Oe=ze?-ne.bx/2-ne.tx2width/2+l:-ne.bx-l):be==="right"&&le!=="end"&&(ie.attr("text-anchor","end"),Oe=ze?ne.bx/2-ne.tx2width/2-l:ne.bx+l)),ie.call(r.positionText,W(Oe),K(Ye)),ne.tx2width&&(ae.select("text.name").call(r.positionText,W(ge+ue*l+Te),K(_e+ne.ty0-ne.by/2+l)),ae.select("rect").call(c.setRect,W(ge+(ue-1)*ne.tx2width/2+Te),K(_e-ne.by/2-1),W(ne.tx2width),K(ne.by+2)))})}function F(N,U){var q=N.index,$=N.trace||{},W=N.cd[0],K=N.cd[q]||{};function ne(pe){return pe||v(pe)&&pe===0}var ae=Array.isArray(q)?function(pe,ge){var Te=M.castOption(W,q,pe);return ne(Te)?Te:M.extractOption({},$,"",ge)}:function(pe,ge){return M.extractOption(K,$,pe,ge)};function ie(pe,ge,Te){var _e=ae(ge,Te);ne(_e)&&(N[pe]=_e)}if(ie("hoverinfo","hi","hoverinfo"),ie("bgcolor","hbg","hoverlabel.bgcolor"),ie("borderColor","hbc","hoverlabel.bordercolor"),ie("fontFamily","htf","hoverlabel.font.family"),ie("fontSize","hts","hoverlabel.font.size"),ie("fontColor","htc","hoverlabel.font.color"),ie("nameLength","hnl","hoverlabel.namelength"),ie("textAlign","hta","hoverlabel.align"),N.posref=U==="y"||U==="closest"&&$.orientation==="h"?N.xa._offset+(N.x0+N.x1)/2:N.ya._offset+(N.y0+N.y1)/2,N.x0=M.constrain(N.x0,0,N.xa._length),N.x1=M.constrain(N.x1,0,N.xa._length),N.y0=M.constrain(N.y0,0,N.ya._length),N.y1=M.constrain(N.y1,0,N.ya._length),N.xLabelVal!==void 0&&(N.xLabel="xLabel"in N?N.xLabel:y.hoverLabelText(N.xa,N.xLabelVal,$.xhoverformat),N.xVal=N.xa.c2d(N.xLabelVal)),N.yLabelVal!==void 0&&(N.yLabel="yLabel"in N?N.yLabel:y.hoverLabelText(N.ya,N.yLabelVal,$.yhoverformat),N.yVal=N.ya.c2d(N.yLabelVal)),N.zLabelVal!==void 0&&N.zLabel===void 0&&(N.zLabel=String(N.zLabelVal)),!isNaN(N.xerr)&&!(N.xa.type==="log"&&N.xerr<=0)){var le=y.tickText(N.xa,N.xa.c2l(N.xerr),"hover").text;N.xerrneg!==void 0?N.xLabel+=" +"+le+" / -"+y.tickText(N.xa,N.xa.c2l(N.xerrneg),"hover").text:N.xLabel+=" \xB1 "+le,U==="x"&&(N.distance+=1)}if(!isNaN(N.yerr)&&!(N.ya.type==="log"&&N.yerr<=0)){var ye=y.tickText(N.ya,N.ya.c2l(N.yerr),"hover").text;N.yerrneg!==void 0?N.yLabel+=" +"+ye+" / -"+y.tickText(N.ya,N.ya.c2l(N.yerrneg),"hover").text:N.yLabel+=" \xB1 "+ye,U==="y"&&(N.distance+=1)}var ue=N.hoverinfo||N.trace.hoverinfo;return ue&&ue!=="all"&&(ue=Array.isArray(ue)?ue:ue.split("+"),ue.indexOf("x")===-1&&(N.xLabel=void 0),ue.indexOf("y")===-1&&(N.yLabel=void 0),ue.indexOf("z")===-1&&(N.zLabel=void 0),ue.indexOf("text")===-1&&(N.text=void 0),ue.indexOf("name")===-1&&(N.name=void 0)),N}function H(N,U,q){var $=q.container,W=q.fullLayout,K=W._size,ne=q.event,ae=!!U.hLinePoint,ie=!!U.vLinePoint,le,ye;if($.selectAll(".spikeline").remove(),!!(ie||ae)){var ue=o.combine(W.plot_bgcolor,W.paper_bgcolor);if(ae){var pe=U.hLinePoint,ge,Te;le=pe&&pe.xa,ye=pe&&pe.ya;var _e=ye.spikesnap;_e==="cursor"?(ge=ne.pointerX,Te=ne.pointerY):(ge=le._offset+pe.x,Te=ye._offset+pe.y);var ze=S.readability(pe.color,ue)<1.5?o.contrast(ue):pe.color,Oe=ye.spikemode,Ye=ye.spikethickness,be=ye.spikecolor||ze,Pe=y.getPxPosition(N,ye),Ge,Qe;if(Oe.indexOf("toaxis")!==-1||Oe.indexOf("across")!==-1){if(Oe.indexOf("toaxis")!==-1&&(Ge=Pe,Qe=ge),Oe.indexOf("across")!==-1){var Be=ye._counterDomainMin,Le=ye._counterDomainMax;ye.anchor==="free"&&(Be=Math.min(Be,ye.position),Le=Math.max(Le,ye.position)),Ge=K.l+Be*K.w,Qe=K.l+Le*K.w}$.insert("line",":first-child").attr({x1:Ge,x2:Qe,y1:Te,y2:Te,"stroke-width":Ye,stroke:be,"stroke-dasharray":c.dashStyle(ye.spikedash,Ye)}).classed("spikeline",!0).classed("crisp",!0),$.insert("line",":first-child").attr({x1:Ge,x2:Qe,y1:Te,y2:Te,"stroke-width":Ye+2,stroke:ue}).classed("spikeline",!0).classed("crisp",!0)}Oe.indexOf("marker")!==-1&&$.insert("circle",":first-child").attr({cx:Pe+(ye.side!=="right"?Ye:-Ye),cy:Te,r:Ye,fill:be}).classed("spikeline",!0)}if(ie){var He=U.vLinePoint,vt,Rt;le=He&&He.xa,ye=He&&He.ya;var rr=le.spikesnap;rr==="cursor"?(vt=ne.pointerX,Rt=ne.pointerY):(vt=le._offset+He.x,Rt=ye._offset+He.y);var Lt=S.readability(He.color,ue)<1.5?o.contrast(ue):He.color,Ft=le.spikemode,Gt=le.spikethickness,Dt=le.spikecolor||Lt,kt=y.getPxPosition(N,le),Ue,qe;if(Ft.indexOf("toaxis")!==-1||Ft.indexOf("across")!==-1){if(Ft.indexOf("toaxis")!==-1&&(Ue=kt,qe=Rt),Ft.indexOf("across")!==-1){var Ve=le._counterDomainMin,Ae=le._counterDomainMax;le.anchor==="free"&&(Ve=Math.min(Ve,le.position),Ae=Math.max(Ae,le.position)),Ue=K.t+(1-Ae)*K.h,qe=K.t+(1-Ve)*K.h}$.insert("line",":first-child").attr({x1:vt,x2:vt,y1:Ue,y2:qe,"stroke-width":Gt,stroke:Dt,"stroke-dasharray":c.dashStyle(le.spikedash,Gt)}).classed("spikeline",!0).classed("crisp",!0),$.insert("line",":first-child").attr({x1:vt,x2:vt,y1:Ue,y2:qe,"stroke-width":Gt+2,stroke:ue}).classed("spikeline",!0).classed("crisp",!0)}Ft.indexOf("marker")!==-1&&$.insert("circle",":first-child").attr({cx:vt,cy:kt-(le.side!=="top"?Gt:-Gt),r:Gt,fill:Dt}).classed("spikeline",!0)}}}function G(N,U,q){if(!q||q.length!==N._hoverdata.length)return!0;for(var $=q.length-1;$>=0;$--){var W=q[$],K=N._hoverdata[$];if(W.curveNumber!==K.curveNumber||String(W.pointNumber)!==String(K.pointNumber)||String(W.pointNumbers)!==String(K.pointNumbers))return!0}return!1}function J(N,U){return!U||U.vLinePoint!==N._spikepoints.vLinePoint||U.hLinePoint!==N._spikepoints.hLinePoint}function X(N,U){return r.plainText(N||"",{len:U,allowedTags:["br","sub","sup","b","i","em"]})}function Y(N,U){for(var q=U.charAt(0),$=[],W=[],K=[],ne=0;ne<N.length;ne++){var ae=N[ne];p.traceIs(ae.trace,"bar-like")||p.traceIs(ae.trace,"box-violin")?K.push(ae):ae.trace[q+"period"]?W.push(ae):$.push(ae)}return $.concat(W).concat(K)}function Z(N,U,q){var $=U[N+"a"],W=U[N+"Val"],K=U.cd[0];if($.type==="category")W=$._categoriesMap[W];else if($.type==="date"){var ne=U.trace[N+"periodalignment"];if(ne){var ae=U.cd[U.index],ie=ae[N+"Start"];ie===void 0&&(ie=ae[N]);var le=ae[N+"End"];le===void 0&&(le=ae[N]);var ye=le-ie;ne==="end"?W+=ye:ne==="middle"&&(W+=ye/2)}W=$.d2c(W)}return K&&K.t&&K.t.posLetter===$._id&&(q.boxmode==="group"||q.violinmode==="group")&&(W+=K.t.dPos),W}function oe(N){return N.offsetTop+N.clientTop}function re(N){return N.offsetLeft+N.clientLeft}function se(N,U){var q=N._fullLayout,$=U.getBoundingClientRect(),W=$.x,K=$.y,ne=W+$.width,ae=K+$.height,ie=M.apply3DTransform(q._invTransform)(W,K),le=M.apply3DTransform(q._invTransform)(ne,ae),ye=ie[0],ue=ie[1],pe=le[0],ge=le[1];return{x:ye,y:ue,width:pe-ye,height:ge-ue,top:Math.min(ue,ge),left:Math.min(ye,pe),right:Math.max(ye,pe),bottom:Math.max(ue,ge)}}},{"../../lib":515,"../../lib/events":504,"../../lib/override_cursor":526,"../../lib/svg_text_utils":541,"../../plots/cartesian/axes":566,"../../registry":647,"../color":367,"../dragelement":386,"../drawing":389,"../legend/defaults":419,"../legend/draw":420,"./constants":401,"./helpers":403,"@plotly/d3":58,"fast-isnumeric":190,tinycolor2:313}],405:[function(d,ee,te){var w=d("../../lib"),v=d("../color"),S=d("./helpers").isUnifiedHover;ee.exports=function(e,a,n,r){r=r||{};var t=a.legend;function c(o){r.font[o]||(r.font[o]=t?a.legend.font[o]:a.font[o])}a&&S(a.hovermode)&&(r.font||(r.font={}),c("size"),c("family"),c("color"),t?(r.bgcolor||(r.bgcolor=v.combine(a.legend.bgcolor,a.paper_bgcolor)),r.bordercolor||(r.bordercolor=a.legend.bordercolor)):r.bgcolor||(r.bgcolor=a.paper_bgcolor)),n("hoverlabel.bgcolor",r.bgcolor),n("hoverlabel.bordercolor",r.bordercolor),n("hoverlabel.namelength",r.namelength),w.coerceFont(n,"hoverlabel.font",r.font),n("hoverlabel.align",r.align)}},{"../../lib":515,"../color":367,"./helpers":403}],406:[function(d,ee,te){var w=d("../../lib"),v=d("./layout_attributes");ee.exports=function(M,e){function a(n,r){return e[n]!==void 0?e[n]:w.coerce(M,e,v,n,r)}return a("clickmode"),a("hovermode")}},{"../../lib":515,"./layout_attributes":408}],407:[function(d,ee,te){var w=d("@plotly/d3"),v=d("../../lib"),S=d("../dragelement"),M=d("./helpers"),e=d("./layout_attributes"),a=d("./hover");ee.exports={moduleType:"component",name:"fx",constants:d("./constants"),schema:{layout:e},attributes:d("./attributes"),layoutAttributes:e,supplyLayoutGlobalDefaults:d("./layout_global_defaults"),supplyDefaults:d("./defaults"),supplyLayoutDefaults:d("./layout_defaults"),calc:d("./calc"),getDistanceFunction:M.getDistanceFunction,getClosest:M.getClosest,inbox:M.inbox,quadrature:M.quadrature,appendArrayPointValue:M.appendArrayPointValue,castHoverOption:r,castHoverinfo:t,hover:a.hover,unhover:S.unhover,loneHover:a.loneHover,loneUnhover:n,click:d("./click")};function n(c){var o=v.isD3Selection(c)?c:w.select(c);o.selectAll("g.hovertext").remove(),o.selectAll(".spikeline").remove()}function r(c,o,i){return v.castOption(c,o,"hoverlabel."+i)}function t(c,o,i){function y(p){return v.coerceHoverinfo({hoverinfo:p},{_module:c._module},o)}return v.castOption(c,i,"hoverinfo",y)}},{"../../lib":515,"../dragelement":386,"./attributes":398,"./calc":399,"./click":400,"./constants":401,"./defaults":402,"./helpers":403,"./hover":404,"./layout_attributes":408,"./layout_defaults":409,"./layout_global_defaults":410,"@plotly/d3":58}],408:[function(d,ee,te){var w=d("./constants"),v=d("../../plots/font_attributes"),S=v({editType:"none"});S.family.dflt=w.HOVERFONT,S.size.dflt=w.HOVERFONTSIZE,ee.exports={clickmode:{valType:"flaglist",flags:["event","select"],dflt:"event",editType:"plot",extras:["none"]},dragmode:{valType:"enumerated",values:["zoom","pan","select","lasso","drawclosedpath","drawopenpath","drawline","drawrect","drawcircle","orbit","turntable",!1],dflt:"zoom",editType:"modebar"},hovermode:{valType:"enumerated",values:["x","y","closest",!1,"x unified","y unified"],dflt:"closest",editType:"modebar"},hoverdistance:{valType:"integer",min:-1,dflt:20,editType:"none"},spikedistance:{valType:"integer",min:-1,dflt:-1,editType:"none"},hoverlabel:{bgcolor:{valType:"color",editType:"none"},bordercolor:{valType:"color",editType:"none"},font:S,grouptitlefont:v({editType:"none"}),align:{valType:"enumerated",values:["left","right","auto"],dflt:"auto",editType:"none"},namelength:{valType:"integer",min:-1,dflt:15,editType:"none"},editType:"none"},selectdirection:{valType:"enumerated",values:["h","v","d","any"],dflt:"any",editType:"none"}}},{"../../plots/font_attributes":594,"./constants":401}],409:[function(d,ee,te){var w=d("../../lib"),v=d("./layout_attributes"),S=d("./hovermode_defaults"),M=d("./hoverlabel_defaults");ee.exports=function(a,n){function r(p,g){return w.coerce(a,n,v,p,g)}var t=S(a,n);t&&(r("hoverdistance"),r("spikedistance"));var c=r("dragmode");c==="select"&&r("selectdirection");var o=n._has("mapbox"),i=n._has("geo"),y=n._basePlotModules.length;n.dragmode==="zoom"&&((o||i)&&y===1||o&&i&&y===2)&&(n.dragmode="pan"),M(a,n,r),w.coerceFont(r,"hoverlabel.grouptitlefont",n.hoverlabel.font)}},{"../../lib":515,"./hoverlabel_defaults":405,"./hovermode_defaults":406,"./layout_attributes":408}],410:[function(d,ee,te){var w=d("../../lib"),v=d("./hoverlabel_defaults"),S=d("./layout_attributes");ee.exports=function(e,a){function n(r,t){return w.coerce(e,a,S,r,t)}v(e,a,n)}},{"../../lib":515,"./hoverlabel_defaults":405,"./layout_attributes":408}],411:[function(d,ee,te){var w=d("../../lib"),v=d("../../lib/regex").counter,S=d("../../plots/domain").attributes,M=d("../../plots/cartesian/constants").idRegex,e=d("../../plot_api/plot_template"),a={rows:{valType:"integer",min:1,editType:"plot"},roworder:{valType:"enumerated",values:["top to bottom","bottom to top"],dflt:"top to bottom",editType:"plot"},columns:{valType:"integer",min:1,editType:"plot"},subplots:{valType:"info_array",freeLength:!0,dimensions:2,items:{valType:"enumerated",values:[v("xy").toString(),""],editType:"plot"},editType:"plot"},xaxes:{valType:"info_array",freeLength:!0,items:{valType:"enumerated",values:[M.x.toString(),""],editType:"plot"},editType:"plot"},yaxes:{valType:"info_array",freeLength:!0,items:{valType:"enumerated",values:[M.y.toString(),""],editType:"plot"},editType:"plot"},pattern:{valType:"enumerated",values:["independent","coupled"],dflt:"coupled",editType:"plot"},xgap:{valType:"number",min:0,max:1,editType:"plot"},ygap:{valType:"number",min:0,max:1,editType:"plot"},domain:S({name:"grid",editType:"plot",noGridCell:!0},{}),xside:{valType:"enumerated",values:["bottom","bottom plot","top plot","top"],dflt:"bottom plot",editType:"plot"},yside:{valType:"enumerated",values:["left","left plot","right plot","right"],dflt:"left plot",editType:"plot"},editType:"plot"};function n(i,y,p){var g=y[p+"axes"],h=Object.keys((i._splomAxes||{})[p]||{});if(Array.isArray(g))return g;if(h.length)return h}function r(i,y){var p=i.grid||{},g=n(y,p,"x"),h=n(y,p,"y");if(!i.grid&&!g&&!h)return;var m=Array.isArray(p.subplots)&&Array.isArray(p.subplots[0]),u=Array.isArray(g),_=Array.isArray(h),s=u&&g!==p.xaxes&&_&&h!==p.yaxes,A,b;m?(A=p.subplots.length,b=p.subplots[0].length):(_&&(A=h.length),u&&(b=g.length));var f=e.newContainer(y,"grid");function x(B,F){return w.coerce(p,f,a,B,F)}var l=x("rows",A),L=x("columns",b);if(!(l*L>1)){delete y.grid;return}if(!m&&!u&&!_){var T=x("pattern")==="independent";T&&(m=!0)}f._hasSubplotGrid=m;var k=x("roworder"),P=k==="top to bottom",z=m?.2:.1,I=m?.3:.1,D,R;s&&y._splomGridDflt&&(D=y._splomGridDflt.xside,R=y._splomGridDflt.yside),f._domains={x:t("x",x,z,D,L),y:t("y",x,I,R,l,P)}}function t(i,y,p,g,h,m){var u=y(i+"gap",p),_=y("domain."+i);y(i+"side",g);for(var s=new Array(h),A=_[0],b=(_[1]-A)/(h-u),f=b*(1-u),x=0;x<h;x++){var l=A+b*x;s[m?h-1-x:x]=[l,l+f]}return s}function c(i,y){var p=y.grid;if(!(!p||!p._domains)){var g=i.grid||{},h=y._subplots,m=p._hasSubplotGrid,u=p.rows,_=p.columns,s=p.pattern==="independent",A,b,f,x,l,L,T,k=p._axisMap={};if(m){var P=g.subplots||[];L=p.subplots=new Array(u);var z=1;for(A=0;A<u;A++){var I=L[A]=new Array(_),D=P[A]||[];for(b=0;b<_;b++)if(s?(l=z===1?"xy":"x"+z+"y"+z,z++):l=D[b],I[b]="",h.cartesian.indexOf(l)!==-1){if(T=l.indexOf("y"),f=l.slice(0,T),x=l.slice(T),k[f]!==void 0&&k[f]!==b||k[x]!==void 0&&k[x]!==A)continue;I[b]=l,k[f]=b,k[x]=A}}}else{var R=n(y,g,"x"),B=n(y,g,"y");p.xaxes=o(R,h.xaxis,_,k,"x"),p.yaxes=o(B,h.yaxis,u,k,"y")}var F=p._anchors={},H=p.roworder==="top to bottom";for(var G in k){var J=G.charAt(0),X=p[J+"side"],Y,Z,oe;if(X.length<8)F[G]="free";else if(J==="x"){if(X.charAt(0)==="t"===H?(Y=0,Z=1,oe=u):(Y=u-1,Z=-1,oe=-1),m){var re=k[G];for(A=Y;A!==oe;A+=Z)if(l=L[A][re],!!l&&(T=l.indexOf("y"),l.slice(0,T)===G)){F[G]=l.slice(T);break}}else for(A=Y;A!==oe;A+=Z)if(x=p.yaxes[A],h.cartesian.indexOf(G+x)!==-1){F[G]=x;break}}else if(X.charAt(0)==="l"?(Y=0,Z=1,oe=_):(Y=_-1,Z=-1,oe=-1),m){var se=k[G];for(A=Y;A!==oe;A+=Z)if(l=L[se][A],!!l&&(T=l.indexOf("y"),l.slice(T)===G)){F[G]=l.slice(0,T);break}}else for(A=Y;A!==oe;A+=Z)if(f=p.xaxes[A],h.cartesian.indexOf(f+G)!==-1){F[G]=f;break}}}}function o(i,y,p,g,h){var m=new Array(p),u;function _(s,A){y.indexOf(A)!==-1&&g[A]===void 0?(m[s]=A,g[A]=s):m[s]=""}if(Array.isArray(i))for(u=0;u<p;u++)_(u,i[u]);else for(_(0,h),u=1;u<p;u++)_(u,h+(u+1));return m}ee.exports={moduleType:"component",name:"grid",schema:{layout:{grid:a}},layoutAttributes:a,sizeDefaults:r,contentDefaults:c}},{"../../lib":515,"../../lib/regex":532,"../../plot_api/plot_template":555,"../../plots/cartesian/constants":573,"../../plots/domain":593}],412:[function(d,ee,te){var w=d("../../plots/cartesian/constants"),v=d("../../plot_api/plot_template").templatedArray;d("../../constants/axis_placeable_objects"),ee.exports=v("image",{visible:{valType:"boolean",dflt:!0,editType:"arraydraw"},source:{valType:"string",editType:"arraydraw"},layer:{valType:"enumerated",values:["below","above"],dflt:"above",editType:"arraydraw"},sizex:{valType:"number",dflt:0,editType:"arraydraw"},sizey:{valType:"number",dflt:0,editType:"arraydraw"},sizing:{valType:"enumerated",values:["fill","contain","stretch"],dflt:"contain",editType:"arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"arraydraw"},x:{valType:"any",dflt:0,editType:"arraydraw"},y:{valType:"any",dflt:0,editType:"arraydraw"},xanchor:{valType:"enumerated",values:["left","center","right"],dflt:"left",editType:"arraydraw"},yanchor:{valType:"enumerated",values:["top","middle","bottom"],dflt:"top",editType:"arraydraw"},xref:{valType:"enumerated",values:["paper",w.idRegex.x.toString()],dflt:"paper",editType:"arraydraw"},yref:{valType:"enumerated",values:["paper",w.idRegex.y.toString()],dflt:"paper",editType:"arraydraw"},editType:"arraydraw"})},{"../../constants/axis_placeable_objects":484,"../../plot_api/plot_template":555,"../../plots/cartesian/constants":573}],413:[function(d,ee,te){var w=d("fast-isnumeric"),v=d("../../lib/to_log_range");ee.exports=function(M,e,a,n){e=e||{};var r=a==="log"&&e.type==="linear",t=a==="linear"&&e.type==="log";if(!!(r||t)){for(var c=M._fullLayout.images,o=e._id.charAt(0),i,y,p=0;p<c.length;p++)if(i=c[p],y="images["+p+"].",i[o+"ref"]===e._id){var g=i[o],h=i["size"+o],m=null,u=null;if(r){m=v(g,e.range);var _=h/Math.pow(10,m)/2;u=2*Math.log(_+Math.sqrt(1+_*_))/Math.LN10}else m=Math.pow(10,g),u=m*(Math.pow(10,h/2)-Math.pow(10,-h/2));w(m)?w(u)||(u=null):(m=null,u=null),n(y+o,m),n(y+"size"+o,u)}}}},{"../../lib/to_log_range":543,"fast-isnumeric":190}],414:[function(d,ee,te){var w=d("../../lib"),v=d("../../plots/cartesian/axes"),S=d("../../plots/array_container_defaults"),M=d("./attributes"),e="images";ee.exports=function(r,t){var c={name:e,handleItemDefaults:a};S(r,t,c)};function a(n,r,t){function c(_,s){return w.coerce(n,r,M,_,s)}var o=c("source"),i=c("visible",!!o);if(!i)return r;c("layer"),c("xanchor"),c("yanchor"),c("sizex"),c("sizey"),c("sizing"),c("opacity");for(var y={_fullLayout:t},p=["x","y"],g=0;g<2;g++){var h=p[g],m=v.coerceRef(n,r,y,h,"paper",void 0);if(m!=="paper"){var u=v.getFromId(y,m);u._imgIndices.push(r._index)}v.coercePosition(r,y,c,m,h,0)}return r}},{"../../lib":515,"../../plots/array_container_defaults":561,"../../plots/cartesian/axes":566,"./attributes":412}],415:[function(d,ee,te){var w=d("@plotly/d3"),v=d("../drawing"),S=d("../../plots/cartesian/axes"),M=d("../../plots/cartesian/axis_ids"),e=d("../../constants/xmlns_namespaces");ee.exports=function(n){var r=n._fullLayout,t=[],c={},o=[],i,y;for(y=0;y<r.images.length;y++){var p=r.images[y];if(p.visible)if(p.layer==="below"&&p.xref!=="paper"&&p.yref!=="paper"){i=M.ref2id(p.xref)+M.ref2id(p.yref);var g=r._plots[i];if(!g){o.push(p);continue}g.mainplot&&(i=g.mainplot.id),c[i]||(c[i]=[]),c[i].push(p)}else p.layer==="above"?t.push(p):o.push(p)}var h={x:{left:{sizing:"xMin",offset:0},center:{sizing:"xMid",offset:-1/2},right:{sizing:"xMax",offset:-1}},y:{top:{sizing:"YMin",offset:0},middle:{sizing:"YMid",offset:-1/2},bottom:{sizing:"YMax",offset:-1}}};function m(x){var l=w.select(this);if(this._imgSrc!==x.source)if(l.attr("xmlns",e.svg),x.source&&x.source.slice(0,5)==="data:")l.attr("xlink:href",x.source),this._imgSrc=x.source;else{var L=new Promise(function(T){var k=new Image;this.img=k,k.setAttribute("crossOrigin","anonymous"),k.onerror=P,k.onload=function(){var z=document.createElement("canvas");z.width=this.width,z.height=this.height;var I=z.getContext("2d",{willReadFrequently:!0});I.drawImage(this,0,0);var D=z.toDataURL("image/png");l.attr("xlink:href",D),T()},l.on("error",P),k.src=x.source,this._imgSrc=x.source;function P(){l.remove(),T()}}.bind(this));n._promises.push(L)}}function u(x){var l=w.select(this),L=S.getFromId(n,x.xref),T=S.getFromId(n,x.yref),k=S.getRefType(x.xref)==="domain",P=S.getRefType(x.yref)==="domain",z=r._size,I,D;L!==void 0?I=typeof x.xref=="string"&&k?L._length*x.sizex:Math.abs(L.l2p(x.sizex)-L.l2p(0)):I=x.sizex*z.w,T!==void 0?D=typeof x.yref=="string"&&P?T._length*x.sizey:Math.abs(T.l2p(x.sizey)-T.l2p(0)):D=x.sizey*z.h;var R=I*h.x[x.xanchor].offset,B=D*h.y[x.yanchor].offset,F=h.x[x.xanchor].sizing+h.y[x.yanchor].sizing,H,G;switch(L!==void 0?H=typeof x.xref=="string"&&k?L._length*x.x+L._offset:L.r2p(x.x)+L._offset:H=x.x*z.w+z.l,H+=R,T!==void 0?G=typeof x.yref=="string"&&P?T._length*(1-x.y)+T._offset:T.r2p(x.y)+T._offset:G=z.h-x.y*z.h+z.t,G+=B,x.sizing){case"fill":F+=" slice";break;case"stretch":F="none";break}l.attr({x:H,y:G,width:I,height:D,preserveAspectRatio:F,opacity:x.opacity});var J=L&&S.getRefType(x.xref)!=="domain"?L._id:"",X=T&&S.getRefType(x.yref)!=="domain"?T._id:"",Y=J+X;v.setClipUrl(l,Y?"clip"+r._uid+Y:null,n)}var _=r._imageLowerLayer.selectAll("image").data(o),s=r._imageUpperLayer.selectAll("image").data(t);_.enter().append("image"),s.enter().append("image"),_.exit().remove(),s.exit().remove(),_.each(function(x){m.bind(this)(x),u.bind(this)(x)}),s.each(function(x){m.bind(this)(x),u.bind(this)(x)});var A=Object.keys(r._plots);for(y=0;y<A.length;y++){i=A[y];var b=r._plots[i];if(!!b.imagelayer){var f=b.imagelayer.selectAll("image").data(c[i]||[]);f.enter().append("image"),f.exit().remove(),f.each(function(x){m.bind(this)(x),u.bind(this)(x)})}}}},{"../../constants/xmlns_namespaces":492,"../../plots/cartesian/axes":566,"../../plots/cartesian/axis_ids":570,"../drawing":389,"@plotly/d3":58}],416:[function(d,ee,te){ee.exports={moduleType:"component",name:"images",layoutAttributes:d("./attributes"),supplyLayoutDefaults:d("./defaults"),includeBasePlot:d("../../plots/cartesian/include_components")("images"),draw:d("./draw"),convertCoords:d("./convert_coords")}},{"../../plots/cartesian/include_components":577,"./attributes":412,"./convert_coords":413,"./defaults":414,"./draw":415}],417:[function(d,ee,te){var w=d("../../plots/font_attributes"),v=d("../color/attributes");ee.exports={bgcolor:{valType:"color",editType:"legend"},bordercolor:{valType:"color",dflt:v.defaultLine,editType:"legend"},borderwidth:{valType:"number",min:0,dflt:0,editType:"legend"},font:w({editType:"legend"}),grouptitlefont:w({editType:"legend"}),orientation:{valType:"enumerated",values:["v","h"],dflt:"v",editType:"legend"},traceorder:{valType:"flaglist",flags:["reversed","grouped"],extras:["normal"],editType:"legend"},tracegroupgap:{valType:"number",min:0,dflt:10,editType:"legend"},itemsizing:{valType:"enumerated",values:["trace","constant"],dflt:"trace",editType:"legend"},itemwidth:{valType:"number",min:30,dflt:30,editType:"legend"},itemclick:{valType:"enumerated",values:["toggle","toggleothers",!1],dflt:"toggle",editType:"legend"},itemdoubleclick:{valType:"enumerated",values:["toggle","toggleothers",!1],dflt:"toggleothers",editType:"legend"},groupclick:{valType:"enumerated",values:["toggleitem","togglegroup"],dflt:"togglegroup",editType:"legend"},x:{valType:"number",min:-2,max:3,editType:"legend"},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"left",editType:"legend"},y:{valType:"number",min:-2,max:3,editType:"legend"},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],editType:"legend"},uirevision:{valType:"any",editType:"none"},valign:{valType:"enumerated",values:["top","middle","bottom"],dflt:"middle",editType:"legend"},title:{text:{valType:"string",dflt:"",editType:"legend"},font:w({editType:"legend"}),side:{valType:"enumerated",values:["top","left","top left"],editType:"legend"},editType:"legend"},editType:"legend"}},{"../../plots/font_attributes":594,"../color/attributes":366}],418:[function(d,ee,te){ee.exports={scrollBarWidth:6,scrollBarMinHeight:20,scrollBarColor:"#808BA4",scrollBarMargin:4,scrollBarEnterAttrs:{rx:20,ry:3,width:0,height:0},titlePad:2,itemGap:5}},{}],419:[function(d,ee,te){var w=d("../../registry"),v=d("../../lib"),S=d("../../plot_api/plot_template"),M=d("../../plots/attributes"),e=d("./attributes"),a=d("../../plots/layout_attributes"),n=d("./helpers");ee.exports=function(t,c,o){var i=t.legend||{},y=S.newContainer(c,"legend");function p(D,R){return v.coerce(i,y,e,D,R)}for(var g,h=function(D,R){var B=g._input,F=g;return v.coerce(B,F,M,D,R)},m=c.font||{},u=v.coerceFont(p,"grouptitlefont",v.extendFlat({},m,{size:Math.round(m.size*1.1)})),_=0,s=!1,A="normal",b=0;b<o.length;b++)g=o[b],g.visible&&((g.showlegend||g._dfltShowLegend&&!(g._module&&g._module.attributes&&g._module.attributes.showlegend&&g._module.attributes.showlegend.dflt===!1))&&(_++,g.showlegend&&(s=!0,(w.traceIs(g,"pie-like")||g._input.showlegend===!0)&&_++),v.coerceFont(h,"legendgrouptitle.font",u)),(w.traceIs(g,"bar")&&c.barmode==="stack"||["tonextx","tonexty"].indexOf(g.fill)!==-1)&&(A=n.isGrouped({traceorder:A})?"grouped+reversed":"reversed"),g.legendgroup!==void 0&&g.legendgroup!==""&&(A=n.isReversed({traceorder:A})?"reversed+grouped":"grouped"));var f=v.coerce(t,c,a,"showlegend",s&&_>1);if(f===!1&&(c.legend=void 0),!(f===!1&&!i.uirevision)&&(p("uirevision",c.uirevision),f!==!1)){p("bgcolor",c.paper_bgcolor),p("bordercolor"),p("borderwidth");var x=v.coerceFont(p,"font",c.font),l=p("orientation"),L=l==="h",T,k,P;L?(T=0,w.getComponentMethod("rangeslider","isVisible")(t.xaxis)?(k=1.1,P="bottom"):(k=-.1,P="top")):(T=1.02,k=1,P="auto"),p("traceorder",A),n.isGrouped(c.legend)&&p("tracegroupgap"),p("itemsizing"),p("itemwidth"),p("itemclick"),p("itemdoubleclick"),p("groupclick"),p("x",T),p("xanchor"),p("y",k),p("yanchor",P),p("valign"),v.noneOrAll(i,y,["x","y"]);var z=p("title.text");if(z){p("title.side",L?"left":"top");var I=v.extendFlat({},x,{size:v.bigFont(x.size)});v.coerceFont(p,"title.font",I)}}}},{"../../lib":515,"../../plot_api/plot_template":555,"../../plots/attributes":562,"../../plots/layout_attributes":619,"../../registry":647,"./attributes":417,"./helpers":423}],420:[function(d,ee,te){var w=d("@plotly/d3"),v=d("../../lib"),S=d("../../plots/plots"),M=d("../../registry"),e=d("../../lib/events"),a=d("../dragelement"),n=d("../drawing"),r=d("../color"),t=d("../../lib/svg_text_utils"),c=d("./handle_click"),o=d("./constants"),i=d("../../constants/alignment"),y=i.LINE_SPACING,p=i.FROM_TL,g=i.FROM_BR,h=d("./get_legend_data"),m=d("./style"),u=d("./helpers"),_=1;ee.exports=function(R,B){return B||(B=R._fullLayout.legend||{}),s(R,B)};function s(D,R){var B=D._fullLayout,F="legend"+B._uid,H,G=R._inHover;if(G?(H=R.layer,F+="-hover"):H=B._infolayer,!!H){D._legendMouseDownTime||(D._legendMouseDownTime=0);var J;if(G){if(!R.entries)return;J=h(R.entries,R)}else{if(!D.calcdata)return;J=B.showlegend&&h(D.calcdata,R)}var X=B.hiddenlabels||[];if(!G&&(!B.showlegend||!J.length))return H.selectAll(".legend").remove(),B._topdefs.select("#"+F).remove(),S.autoMargin(D,"legend");var Y=v.ensureSingle(H,"g","legend",function(W){G||W.attr("pointer-events","all")}),Z=v.ensureSingleById(B._topdefs,"clipPath",F,function(W){W.append("rect")}),oe=v.ensureSingle(Y,"rect","bg",function(W){W.attr("shape-rendering","crispEdges")});oe.call(r.stroke,R.bordercolor).call(r.fill,R.bgcolor).style("stroke-width",R.borderwidth+"px");var re=v.ensureSingle(Y,"g","scrollbox"),se=R.title;if(R._titleWidth=0,R._titleHeight=0,se.text){var N=v.ensureSingle(re,"text","legendtitletext");N.attr("text-anchor","start").call(n.font,se.font).text(se.text),l(N,re,D,R,_)}else re.selectAll(".legendtitletext").remove();var U=v.ensureSingle(Y,"rect","scrollbar",function(W){W.attr(o.scrollBarEnterAttrs).call(r.fill,o.scrollBarColor)}),q=re.selectAll("g.groups").data(J);q.enter().append("g").attr("class","groups"),q.exit().remove();var $=q.selectAll("g.traces").data(v.identity);$.enter().append("g").attr("class","traces"),$.exit().remove(),$.style("opacity",function(W){var K=W[0].trace;return M.traceIs(K,"pie-like")?X.indexOf(W[0].label)!==-1?.5:1:K.visible==="legendonly"?.5:1}).each(function(){w.select(this).call(b,D,R)}).call(m,D,R).each(function(){G||w.select(this).call(x,D)}),v.syncOrAsync([S.previousPromises,function(){return k(D,q,$,R)},function(){var W=B._size,K=R.borderwidth;if(!G){var ne=P(D);if(ne)return;var ae=W.l+W.w*R.x-p[z(R)]*R._width,ie=W.t+W.h*(1-R.y)-p[I(R)]*R._effHeight;if(B.margin.autoexpand){var le=ae,ye=ie;ae=v.constrain(ae,0,B.width-R._width),ie=v.constrain(ie,0,B.height-R._effHeight),ae!==le&&v.log("Constrain legend.x to make legend fit inside graph"),ie!==ye&&v.log("Constrain legend.y to make legend fit inside graph")}n.setTranslate(Y,ae,ie)}if(U.on(".drag",null),Y.on("wheel",null),G||R._height<=R._maxHeight||D._context.staticPlot){var ue=R._effHeight;G&&(ue=R._height),oe.attr({width:R._width-K,height:ue-K,x:K/2,y:K/2}),n.setTranslate(re,0,0),Z.select("rect").attr({width:R._width-2*K,height:ue-2*K,x:K,y:K}),n.setClipUrl(re,F,D),n.setRect(U,0,0,0,0),delete R._scrollY}else{var pe=Math.max(o.scrollBarMinHeight,R._effHeight*R._effHeight/R._height),ge=R._effHeight-pe-2*o.scrollBarMargin,Te=R._height-R._effHeight,_e=ge/Te,ze=Math.min(R._scrollY||0,Te);oe.attr({width:R._width-2*K+o.scrollBarWidth+o.scrollBarMargin,height:R._effHeight-K,x:K/2,y:K/2}),Z.select("rect").attr({width:R._width-2*K+o.scrollBarWidth+o.scrollBarMargin,height:R._effHeight-2*K,x:K,y:K+ze}),n.setClipUrl(re,F,D),Le(ze,pe,_e),Y.on("wheel",function(){ze=v.constrain(R._scrollY+w.event.deltaY/ge*Te,0,Te),Le(ze,pe,_e),ze!==0&&ze!==Te&&w.event.preventDefault()});var Oe,Ye,be,Pe=function(Lt,Ft,Gt){var Dt=(Gt-Ft)/_e+Lt;return v.constrain(Dt,0,Te)},Ge=function(Lt,Ft,Gt){var Dt=(Ft-Gt)/_e+Lt;return v.constrain(Dt,0,Te)},Qe=w.behavior.drag().on("dragstart",function(){var Lt=w.event.sourceEvent;Lt.type==="touchstart"?Oe=Lt.changedTouches[0].clientY:Oe=Lt.clientY,be=ze}).on("drag",function(){var Lt=w.event.sourceEvent;Lt.buttons===2||Lt.ctrlKey||(Lt.type==="touchmove"?Ye=Lt.changedTouches[0].clientY:Ye=Lt.clientY,ze=Pe(be,Oe,Ye),Le(ze,pe,_e))});U.call(Qe);var Be=w.behavior.drag().on("dragstart",function(){var Lt=w.event.sourceEvent;Lt.type==="touchstart"&&(Oe=Lt.changedTouches[0].clientY,be=ze)}).on("drag",function(){var Lt=w.event.sourceEvent;Lt.type==="touchmove"&&(Ye=Lt.changedTouches[0].clientY,ze=Ge(be,Oe,Ye),Le(ze,pe,_e))});re.call(Be)}function Le(Lt,Ft,Gt){R._scrollY=D._fullLayout.legend._scrollY=Lt,n.setTranslate(re,0,-Lt),n.setRect(U,R._width,o.scrollBarMargin+Lt*Gt,o.scrollBarWidth,Ft),Z.select("rect").attr("y",K+Lt)}if(D._context.edits.legendPosition){var He,vt,Rt,rr;Y.classed("cursor-move",!0),a.init({element:Y.node(),gd:D,prepFn:function(){var Lt=n.getTranslate(Y);Rt=Lt.x,rr=Lt.y},moveFn:function(Lt,Ft){var Gt=Rt+Lt,Dt=rr+Ft;n.setTranslate(Y,Gt,Dt),He=a.align(Gt,0,W.l,W.l+W.w,R.xanchor),vt=a.align(Dt,0,W.t+W.h,W.t,R.yanchor)},doneFn:function(){He!==void 0&&vt!==void 0&&M.call("_guiRelayout",D,{"legend.x":He,"legend.y":vt})},clickFn:function(Lt,Ft){var Gt=H.selectAll("g.traces").filter(function(){var Dt=this.getBoundingClientRect();return Ft.clientX>=Dt.left&&Ft.clientX<=Dt.right&&Ft.clientY>=Dt.top&&Ft.clientY<=Dt.bottom});Gt.size()>0&&A(D,Y,Gt,Lt,Ft)}})}}],D)}}function A(D,R,B,F,H){var G=B.data()[0][0].trace,J={event:H,node:B.node(),curveNumber:G.index,expandedIndex:G._expandedIndex,data:D.data,layout:D.layout,frames:D._transitionData._frames,config:D._context,fullData:D._fullData,fullLayout:D._fullLayout};G._group&&(J.group=G._group),M.traceIs(G,"pie-like")&&(J.label=B.datum()[0].label);var X=e.triggerHandler(D,"plotly_legendclick",J);if(X!==!1){if(F===1)R._clickTimeout=setTimeout(function(){!D._fullLayout||c(B,D,F)},D._context.doubleClickDelay);else if(F===2){R._clickTimeout&&clearTimeout(R._clickTimeout),D._legendMouseDownTime=0;var Y=e.triggerHandler(D,"plotly_legenddoubleclick",J);Y!==!1&&c(B,D,F)}}}function b(D,R,B){var F=D.data()[0][0],H=F.trace,G=M.traceIs(H,"pie-like"),J=!B._inHover&&R._context.edits.legendText&&!G,X=B._maxNameLength,Y,Z;F.groupTitle?(Y=F.groupTitle.text,Z=F.groupTitle.font):(Z=B.font,B.entries?Y=F.text:(Y=G?F.label:H.name,H._meta&&(Y=v.templateString(Y,H._meta))));var oe=v.ensureSingle(D,"text","legendtext");oe.attr("text-anchor","start").call(n.font,Z).text(J?f(Y,X):Y);var re=B.itemwidth+o.itemGap*2;t.positionText(oe,re,0),J?oe.call(t.makeEditable,{gd:R,text:Y}).call(l,D,R,B).on("edit",function(se){this.text(f(se,X)).call(l,D,R,B);var N=F.trace._fullInput||{},U={};if(M.hasTransform(N,"groupby")){var q=M.getTransformIndices(N,"groupby"),$=q[q.length-1],W=v.keyedContainer(N,"transforms["+$+"].styles","target","value.name");W.set(F.trace._group,se),U=W.constructUpdate()}else U.name=se;return M.call("_guiRestyle",R,U,H.index)}):l(oe,D,R,B)}function f(D,R){var B=Math.max(4,R);if(D&&D.trim().length>=B/2)return D;D=D||"";for(var F=B-D.length;F>0;F--)D+=" ";return D}function x(D,R){var B=R._context.doubleClickDelay,F,H=1,G=v.ensureSingle(D,"rect","legendtoggle",function(J){R._context.staticPlot||J.style("cursor","pointer").attr("pointer-events","all"),J.call(r.fill,"rgba(0,0,0,0)")});R._context.staticPlot||(G.on("mousedown",function(){F=new Date().getTime(),F-R._legendMouseDownTime<B?H+=1:(H=1,R._legendMouseDownTime=F)}),G.on("mouseup",function(){if(!(R._dragged||R._editing)){var J=R._fullLayout.legend;new Date().getTime()-R._legendMouseDownTime>B&&(H=Math.max(H-1,1)),A(R,J,D,H,w.event)}}))}function l(D,R,B,F,H){F._inHover&&D.attr("data-notex",!0),t.convertToTspans(D,B,function(){L(R,B,F,H)})}function L(D,R,B,F){var H=D.data()[0][0];if(!B._inHover&&H&&!H.trace.showlegend){D.remove();return}var G=D.select("g[class*=math-group]"),J=G.node();B||(B=R._fullLayout.legend);var X=B.borderwidth,Y;F===_?Y=B.title.font:H.groupTitle?Y=H.groupTitle.font:Y=B.font;var Z=Y.size*y,oe,re;if(J){var se=n.bBox(J);oe=se.height,re=se.width,F===_?n.setTranslate(G,X,X+oe*.75):n.setTranslate(G,0,oe*.25)}else{var N=D.select(F===_?".legendtitletext":".legendtext"),U=t.lineCount(N),q=N.node();if(oe=Z*U,re=q?n.bBox(q).width:0,F===_)B.title.side==="left"&&(re+=o.itemGap*2),t.positionText(N,X+o.titlePad,X+Z);else{var $=o.itemGap*2+B.itemwidth;H.groupTitle&&($=o.itemGap,re-=B.itemwidth),t.positionText(N,$,-Z*((U-1)/2-.3))}}F===_?(B._titleWidth=re,B._titleHeight=oe):(H.lineHeight=Z,H.height=Math.max(oe,16)+3,H.width=re)}function T(D){var R=0,B=0,F=D.title.side;return F&&(F.indexOf("left")!==-1&&(R=D._titleWidth),F.indexOf("top")!==-1&&(B=D._titleHeight)),[R,B]}function k(D,R,B,F){var H=D._fullLayout;F||(F=H.legend);var G=H._size,J=u.isVertical(F),X=u.isGrouped(F),Y=F.borderwidth,Z=2*Y,oe=o.itemGap,re=F.itemwidth+oe*2,se=2*(Y+oe),N=I(F),U=F.y<0||F.y===0&&N==="top",q=F.y>1||F.y===1&&N==="bottom",$=F.tracegroupgap;F._maxHeight=Math.max(U||q?H.height/2:G.h,30);var W=0;F._width=0,F._height=0;var K=T(F);if(J)B.each(function(He){var vt=He[0].height;n.setTranslate(this,Y+K[0],Y+K[1]+F._height+vt/2+oe),F._height+=vt,F._width=Math.max(F._width,He[0].width)}),W=re+F._width,F._width+=oe+re+Z,F._height+=se,X&&(R.each(function(He,vt){n.setTranslate(this,0,vt*F.tracegroupgap)}),F._height+=(F._lgroupsLength-1)*F.tracegroupgap);else{var ne=z(F),ae=F.x<0||F.x===0&&ne==="right",ie=F.x>1||F.x===1&&ne==="left",le=q||U,ye=H.width/2;F._maxWidth=Math.max(ae?le&&ne==="left"?G.l+G.w:ye:ie?le&&ne==="right"?G.r+G.w:ye:G.w,2*re);var ue=0,pe=0;B.each(function(He){var vt=He[0].width+re;ue=Math.max(ue,vt),pe+=vt}),W=null;var ge=0;if(X){var Te=0,_e=0,ze=0;R.each(function(){var He=0,vt=0;w.select(this).selectAll("g.traces").each(function(rr){var Lt=rr[0].width,Ft=rr[0].height;n.setTranslate(this,K[0],K[1]+Y+oe+Ft/2+vt),vt+=Ft,He=Math.max(He,re+Lt)});var Rt=He+oe;_e>0&&Rt+Y+_e>F._maxWidth?(ge=Math.max(ge,_e),_e=0,ze+=Te+$,Te=vt):Te=Math.max(Te,vt),n.setTranslate(this,_e,ze),_e+=Rt}),F._width=Math.max(ge,_e)+Y,F._height=ze+Te+se}else{var Oe=B.size(),Ye=pe+Z+(Oe-1)*oe<F._maxWidth,be=0,Pe=0,Ge=0,Qe=0;B.each(function(He){var vt=He[0].height,Rt=re+He[0].width,rr=(Ye?Rt:ue)+oe;rr+Y+Pe-oe>=F._maxWidth&&(ge=Math.max(ge,Qe),Pe=0,Ge+=be,F._height+=be,be=0),n.setTranslate(this,K[0]+Y+Pe,K[1]+Y+Ge+vt/2+oe),Qe=Pe+Rt+oe,Pe+=rr,be=Math.max(be,vt)}),Ye?(F._width=Pe+Z,F._height=be+se):(F._width=Math.max(ge,Qe)+Z,F._height+=be+se)}}F._width=Math.ceil(Math.max(F._width+K[0],F._titleWidth+2*(Y+o.titlePad))),F._height=Math.ceil(Math.max(F._height+K[1],F._titleHeight+2*(Y+o.itemGap))),F._effHeight=Math.min(F._height,F._maxHeight);var Be=D._context.edits,Le=Be.legendText||Be.legendPosition;B.each(function(He){var vt=w.select(this).select(".legendtoggle"),Rt=He[0].height,rr=Le?re:W||re+He[0].width;J||(rr+=oe/2),n.setRect(vt,0,-Rt/2,rr,Rt)})}function P(D){var R=D._fullLayout,B=R.legend,F=z(B),H=I(B);return S.autoMargin(D,"legend",{x:B.x,y:B.y,l:B._width*p[F],r:B._width*g[F],b:B._effHeight*g[H],t:B._effHeight*p[H]})}function z(D){return v.isRightAnchor(D)?"right":v.isCenterAnchor(D)?"center":"left"}function I(D){return v.isBottomAnchor(D)?"bottom":v.isMiddleAnchor(D)?"middle":"top"}},{"../../constants/alignment":483,"../../lib":515,"../../lib/events":504,"../../lib/svg_text_utils":541,"../../plots/plots":628,"../../registry":647,"../color":367,"../dragelement":386,"../drawing":389,"./constants":418,"./get_legend_data":421,"./handle_click":422,"./helpers":423,"./style":425,"@plotly/d3":58}],421:[function(d,ee,te){var w=d("../../registry"),v=d("./helpers");ee.exports=function(M,e){var a=e._inHover,n=v.isGrouped(e),r=v.isReversed(e),t={},c=[],o=!1,i={},y=0,p=0,g,h;function m(B,F){if(B===""||!v.isGrouped(e)){var H="~~i"+y;c.push(H),t[H]=[F],y++}else c.indexOf(B)===-1?(c.push(B),o=!0,t[B]=[F]):t[B].push(F)}for(g=0;g<M.length;g++){var u=M[g],_=u[0],s=_.trace,A=s.legendgroup;if(!(!a&&(!s.visible||!s.showlegend)))if(w.traceIs(s,"pie-like"))for(i[A]||(i[A]={}),h=0;h<u.length;h++){var b=u[h].label;i[A][b]||(m(A,{label:b,color:u[h].color,i:u[h].i,trace:s,pts:u[h].pts}),i[A][b]=!0,p=Math.max(p,(b||"").length))}else m(A,_),p=Math.max(p,(s.name||"").length)}if(!c.length)return[];var f=!o||!n,x=[];for(g=0;g<c.length;g++){var l=t[c[g]];f?x.push(l[0]):x.push(l)}for(f&&(x=[x]),g=0;g<x.length;g++){var L=1/0;for(h=0;h<x[g].length;h++){var T=x[g][h].trace.legendrank;L>T&&(L=T)}x[g][0]._groupMinRank=L,x[g][0]._preGroupSort=g}var k=function(B,F){return B[0]._groupMinRank-F[0]._groupMinRank||B[0]._preGroupSort-F[0]._preGroupSort},P=function(B,F){return B.trace.legendrank-F.trace.legendrank||B._preSort-F._preSort};for(x.forEach(function(B,F){B[0]._preGroupSort=F}),x.sort(k),g=0;g<x.length;g++){x[g].forEach(function(B,F){B._preSort=F}),x[g].sort(P);var z=x[g][0].trace,I=null;for(h=0;h<x[g].length;h++){var D=x[g][h].trace.legendgrouptitle;if(D&&D.text){I=D,a&&(D.font=e._groupTitleFont);break}}if(r&&x[g].reverse(),I){var R=!1;for(h=0;h<x[g].length;h++)if(w.traceIs(x[g][h].trace,"pie-like")){R=!0;break}x[g].unshift({i:-1,groupTitle:I,noClick:R,trace:{showlegend:z.showlegend,legendgroup:z.legendgroup,visible:e.groupclick==="toggleitem"?!0:z.visible}})}for(h=0;h<x[g].length;h++)x[g][h]=[x[g][h]]}return e._lgroupsLength=x.length,e._maxNameLength=p,x}},{"../../registry":647,"./helpers":423}],422:[function(d,ee,te){var w=d("../../lib"),v=d("../../registry"),S=!0;ee.exports=function(e,a,n){var r=a._fullLayout;if(a._dragged||a._editing)return;var t=r.legend.itemclick,c=r.legend.itemdoubleclick,o=r.legend.groupclick;n===1&&t==="toggle"&&c==="toggleothers"&&S&&a.data&&a._context.showTips&&w.notifier(w._(a,"Double-click on legend to isolate one trace"),"long"),S=!1;var i;if(n===1?i=t:n===2&&(i=c),!i)return;var y=o==="togglegroup",p=r.hiddenlabels?r.hiddenlabels.slice():[],g=e.data()[0][0];if(g.groupTitle&&g.noClick)return;var h=a._fullData,m=g.trace,u=m.legendgroup,_,s,A,b,f,x,l={},L=[],T=[],k=[];function P(se,N,U){var q=L.indexOf(se),$=l[N];return $||($=l[N]=[]),L.indexOf(se)===-1&&(L.push(se),q=L.length-1),$[q]=U,q}function z(se,N){if(!(g.groupTitle&&!y)){var U=se._fullInput;if(v.hasTransform(U,"groupby")){var q=T[U.index];if(!q){var $=v.getTransformIndices(U,"groupby"),W=$[$.length-1];q=w.keyedContainer(U,"transforms["+W+"].styles","target","value.visible"),T[U.index]=q}var K=q.get(se._group);K===void 0&&(K=!0),K!==!1&&q.set(se._group,N),k[U.index]=P(U.index,"visible",U.visible!==!1)}else{var ne=U.visible===!1?!1:N;P(U.index,"visible",ne)}}}if(v.traceIs(m,"pie-like")){var I=g.label,D=p.indexOf(I);i==="toggle"?D===-1?p.push(I):p.splice(D,1):i==="toggleothers"&&(p=[],a.calcdata[0].forEach(function(se){I!==se.label&&p.push(se.label)}),a._fullLayout.hiddenlabels&&a._fullLayout.hiddenlabels.length===p.length&&D===-1&&(p=[])),v.call("_guiRelayout",a,"hiddenlabels",p)}else{var R=u&&u.length,B=[],F;if(R)for(_=0;_<h.length;_++)F=h[_],!!F.visible&&F.legendgroup===u&&B.push(_);if(i==="toggle"){var H;switch(m.visible){case!0:H="legendonly";break;case!1:H=!1;break;case"legendonly":H=!0;break}if(R)if(y)for(_=0;_<h.length;_++)h[_].visible!==!1&&h[_].legendgroup===u&&z(h[_],H);else z(m,H);else z(m,H)}else if(i==="toggleothers"){var G,J,X,Y,Z=!0;for(_=0;_<h.length;_++)if(G=h[_]===m,X=h[_].showlegend!==!0,!(G||X)&&(J=R&&h[_].legendgroup===u,!J&&h[_].visible===!0&&!v.traceIs(h[_],"notLegendIsolatable"))){Z=!1;break}for(_=0;_<h.length;_++)if(h[_].visible!==!1&&!v.traceIs(h[_],"notLegendIsolatable"))switch(m.visible){case"legendonly":z(h[_],!0);break;case!0:Y=Z?!0:"legendonly",G=h[_]===m,X=h[_].showlegend!==!0&&!h[_].legendgroup,J=G||R&&h[_].legendgroup===u,z(h[_],J||X?!0:Y);break}}for(_=0;_<T.length;_++)if(A=T[_],!!A){var oe=A.constructUpdate(),re=Object.keys(oe);for(s=0;s<re.length;s++)b=re[s],x=l[b]=l[b]||[],x[k[_]]=oe[b]}for(f=Object.keys(l),_=0;_<f.length;_++)for(b=f[_],s=0;s<L.length;s++)l[b].hasOwnProperty(s)||(l[b][s]=void 0);v.call("_guiRestyle",a,l,L)}}},{"../../lib":515,"../../registry":647}],423:[function(d,ee,te){te.isGrouped=function(v){return(v.traceorder||"").indexOf("grouped")!==-1},te.isVertical=function(v){return v.orientation!=="h"},te.isReversed=function(v){return(v.traceorder||"").indexOf("reversed")!==-1}},{}],424:[function(d,ee,te){ee.exports={moduleType:"component",name:"legend",layoutAttributes:d("./attributes"),supplyLayoutDefaults:d("./defaults"),draw:d("./draw"),style:d("./style")}},{"./attributes":417,"./defaults":419,"./draw":420,"./style":425}],425:[function(d,ee,te){var w=d("@plotly/d3"),v=d("../../registry"),S=d("../../lib"),M=S.strTranslate,e=d("../drawing"),a=d("../color"),n=d("../colorscale/helpers").extractOpts,r=d("../../traces/scatter/subtypes"),t=d("../../traces/pie/style_one"),c=d("../../traces/pie/helpers").castOption,o=d("./constants"),i=12,y=5,p=2,g=10,h=5;ee.exports=function(A,b,f){var x=b._fullLayout;f||(f=x.legend);var l=f.itemsizing==="constant",L=f.itemwidth,T=(L+o.itemGap*2)/2,k=M(T,0),P=function(re,se,N,U){var q;if(re+1)q=re;else if(se&&se.width>0)q=se.width;else return 0;return l?U:Math.min(q,N)};A.each(function(re){var se=w.select(this),N=S.ensureSingle(se,"g","layers");N.style("opacity",re[0].trace.opacity);var U=f.valign,q=re[0].lineHeight,$=re[0].height;if(U==="middle"||!q||!$)N.attr("transform",null);else{var W={top:1,bottom:-1}[U],K=W*(.5*(q-$+3));N.attr("transform",M(0,K))}var ne=N.selectAll("g.legendfill").data([re]);ne.enter().append("g").classed("legendfill",!0);var ae=N.selectAll("g.legendlines").data([re]);ae.enter().append("g").classed("legendlines",!0);var ie=N.selectAll("g.legendsymbols").data([re]);ie.enter().append("g").classed("legendsymbols",!0),ie.selectAll("g.legendpoints").data([re]).enter().append("g").classed("legendpoints",!0)}).each(oe).each(D).each(B).each(R).each(H).each(Y).each(X).each(z).each(I).each(G).each(J);function z(re){var se=u(re),N=se.showFill,U=se.showLine,q=se.showGradientLine,$=se.showGradientFill,W=se.anyFill,K=se.anyLine,ne=re[0],ae=ne.trace,ie,le,ye=n(ae),ue=ye.colorscale,pe=ye.reversescale,ge=function(Pe){if(Pe.size())if(N)e.fillGroupStyle(Pe,b);else{var Ge="legendfill-"+ae.uid;e.gradient(Pe,b,Ge,m(pe),ue,"fill")}},Te=function(Pe){if(Pe.size()){var Ge="legendline-"+ae.uid;e.lineGroupStyle(Pe),e.gradient(Pe,b,Ge,m(pe),ue,"stroke")}},_e=r.hasMarkers(ae)||!W?"M5,0":K?"M5,-2":"M5,-3",ze=w.select(this),Oe=ze.select(".legendfill").selectAll("path").data(N||$?[re]:[]);if(Oe.enter().append("path").classed("js-fill",!0),Oe.exit().remove(),Oe.attr("d",_e+"h"+L+"v6h-"+L+"z").call(ge),U||q){var Ye=P(void 0,ae.line,g,y);le=S.minExtend(ae,{line:{width:Ye}}),ie=[S.minExtend(ne,{trace:le})]}var be=ze.select(".legendlines").selectAll("path").data(U||q?[ie]:[]);be.enter().append("path").classed("js-line",!0),be.exit().remove(),be.attr("d",_e+(q?"l"+L+",0.0001":"h"+L)).call(U?e.lineGroupStyle:Te)}function I(re){var se=u(re),N=se.anyFill,U=se.anyLine,q=se.showLine,$=se.showMarker,W=re[0],K=W.trace,ne=!$&&!U&&!N&&r.hasText(K),ae,ie;function le(Oe,Ye,be,Pe){var Ge=S.nestedProperty(K,Oe).get(),Qe=S.isArrayOrTypedArray(Ge)&&Ye?Ye(Ge):Ge;if(l&&Qe&&Pe!==void 0&&(Qe=Pe),be){if(Qe<be[0])return be[0];if(Qe>be[1])return be[1]}return Qe}function ye(Oe){return W._distinct&&W.index&&Oe[W.index]?Oe[W.index]:Oe[0]}if($||ne||q){var ue={},pe={};if($){ue.mc=le("marker.color",ye),ue.mx=le("marker.symbol",ye),ue.mo=le("marker.opacity",S.mean,[.2,1]),ue.mlc=le("marker.line.color",ye),ue.mlw=le("marker.line.width",S.mean,[0,5],p),pe.marker={sizeref:1,sizemin:1,sizemode:"diameter"};var ge=le("marker.size",S.mean,[2,16],i);ue.ms=ge,pe.marker.size=ge}q&&(pe.line={width:le("line.width",ye,[0,10],y)}),ne&&(ue.tx="Aa",ue.tp=le("textposition",ye),ue.ts=10,ue.tc=le("textfont.color",ye),ue.tf=le("textfont.family",ye)),ae=[S.minExtend(W,ue)],ie=S.minExtend(K,pe),ie.selectedpoints=null,ie.texttemplate=null}var Te=w.select(this).select("g.legendpoints"),_e=Te.selectAll("path.scatterpts").data($?ae:[]);_e.enter().insert("path",":first-child").classed("scatterpts",!0).attr("transform",k),_e.exit().remove(),_e.call(e.pointStyle,ie,b),$&&(ae[0].mrc=3);var ze=Te.selectAll("g.pointtext").data(ne?ae:[]);ze.enter().append("g").classed("pointtext",!0).append("text").attr("transform",k),ze.exit().remove(),ze.selectAll("text").call(e.textPointStyle,ie,b)}function D(re){var se=re[0].trace,N=se.type==="waterfall";if(re[0]._distinct&&N){var U=re[0].trace[re[0].dir].marker;return re[0].mc=U.color,re[0].mlw=U.line.width,re[0].mlc=U.line.color,F(re,this,"waterfall")}var q=[];se.visible&&N&&(q=re[0].hasTotals?[["increasing","M-6,-6V6H0Z"],["totals","M6,6H0L-6,-6H-0Z"],["decreasing","M6,6V-6H0Z"]]:[["increasing","M-6,-6V6H6Z"],["decreasing","M6,6V-6H-6Z"]]);var $=w.select(this).select("g.legendpoints").selectAll("path.legendwaterfall").data(q);$.enter().append("path").classed("legendwaterfall",!0).attr("transform",k).style("stroke-miterlimit",1),$.exit().remove(),$.each(function(W){var K=w.select(this),ne=se[W[0]].marker,ae=P(void 0,ne.line,h,p);K.attr("d",W[1]).style("stroke-width",ae+"px").call(a.fill,ne.color),ae&&K.call(a.stroke,ne.line.color)})}function R(re){F(re,this)}function B(re){F(re,this,"funnel")}function F(re,se,N){var U=re[0].trace,q=U.marker||{},$=q.line||{},W=N?U.visible&&U.type===N:v.traceIs(U,"bar"),K=w.select(se).select("g.legendpoints").selectAll("path.legend"+N).data(W?[re]:[]);K.enter().append("path").classed("legend"+N,!0).attr("d","M6,6H-6V-6H6Z").attr("transform",k),K.exit().remove(),K.each(function(ne){var ae=w.select(this),ie=ne[0],le=P(ie.mlw,q.line,h,p);ae.style("stroke-width",le+"px");var ye=ie.mcc;if(!f._inHover&&"mc"in ie){var ue=n(q),pe=ue.mid;pe===void 0&&(pe=(ue.max+ue.min)/2),ye=e.tryColorscale(q,"")(pe)}var ge=ye||ie.mc||q.color,Te=q.pattern,_e=Te&&e.getPatternAttr(Te.shape,0,"");if(_e){var ze=e.getPatternAttr(Te.bgcolor,0,null),Oe=e.getPatternAttr(Te.fgcolor,0,null),Ye=Te.fgopacity,be=_(Te.size,8,10),Pe=_(Te.solidity,.5,1),Ge="legend-"+U.uid;ae.call(e.pattern,"legend",b,Ge,_e,be,Pe,ye,Te.fillmode,ze,Oe,Ye)}else ae.call(a.fill,ge);le&&a.stroke(ae,ie.mlc||$.color)})}function H(re){var se=re[0].trace,N=w.select(this).select("g.legendpoints").selectAll("path.legendbox").data(se.visible&&v.traceIs(se,"box-violin")?[re]:[]);N.enter().append("path").classed("legendbox",!0).attr("d","M6,6H-6V-6H6Z").attr("transform",k),N.exit().remove(),N.each(function(){var U=w.select(this);if((se.boxpoints==="all"||se.points==="all")&&a.opacity(se.fillcolor)===0&&a.opacity((se.line||{}).color)===0){var q=S.minExtend(se,{marker:{size:l?i:S.constrain(se.marker.size,2,16),sizeref:1,sizemin:1,sizemode:"diameter"}});N.call(e.pointStyle,q,b)}else{var $=P(void 0,se.line,h,p);U.style("stroke-width",$+"px").call(a.fill,se.fillcolor),$&&a.stroke(U,se.line.color)}})}function G(re){var se=re[0].trace,N=w.select(this).select("g.legendpoints").selectAll("path.legendcandle").data(se.visible&&se.type==="candlestick"?[re,re]:[]);N.enter().append("path").classed("legendcandle",!0).attr("d",function(U,q){return q?"M-15,0H-8M-8,6V-6H8Z":"M15,0H8M8,-6V6H-8Z"}).attr("transform",k).style("stroke-miterlimit",1),N.exit().remove(),N.each(function(U,q){var $=w.select(this),W=se[q?"increasing":"decreasing"],K=P(void 0,W.line,h,p);$.style("stroke-width",K+"px").call(a.fill,W.fillcolor),K&&a.stroke($,W.line.color)})}function J(re){var se=re[0].trace,N=w.select(this).select("g.legendpoints").selectAll("path.legendohlc").data(se.visible&&se.type==="ohlc"?[re,re]:[]);N.enter().append("path").classed("legendohlc",!0).attr("d",function(U,q){return q?"M-15,0H0M-8,-6V0":"M15,0H0M8,6V0"}).attr("transform",k).style("stroke-miterlimit",1),N.exit().remove(),N.each(function(U,q){var $=w.select(this),W=se[q?"increasing":"decreasing"],K=P(void 0,W.line,h,p);$.style("fill","none").call(e.dashLine,W.line.dash,K),K&&a.stroke($,W.line.color)})}function X(re){Z(re,this,"pie")}function Y(re){Z(re,this,"funnelarea")}function Z(re,se,N){var U=re[0],q=U.trace,$=N?q.visible&&q.type===N:v.traceIs(q,N),W=w.select(se).select("g.legendpoints").selectAll("path.legend"+N).data($?[re]:[]);if(W.enter().append("path").classed("legend"+N,!0).attr("d","M6,6H-6V-6H6Z").attr("transform",k),W.exit().remove(),W.size()){var K=(q.marker||{}).line,ne=P(c(K.width,U.pts),K,h,p),ae=S.minExtend(q,{marker:{line:{width:ne}}});ae.marker.line.color=K.color;var ie=S.minExtend(U,{trace:ae});t(W,ie,ae)}}function oe(re){var se=re[0].trace,N,U=[];if(se.visible)switch(se.type){case"histogram2d":case"heatmap":U=[["M-15,-2V4H15V-2Z"]],N=!0;break;case"choropleth":case"choroplethmapbox":U=[["M-6,-6V6H6V-6Z"]],N=!0;break;case"densitymapbox":U=[["M-6,0 a6,6 0 1,0 12,0 a 6,6 0 1,0 -12,0"]],N="radial";break;case"cone":U=[["M-6,2 A2,2 0 0,0 -6,6 V6L6,4Z"],["M-6,-6 A2,2 0 0,0 -6,-2 L6,-4Z"],["M-6,-2 A2,2 0 0,0 -6,2 L6,0Z"]],N=!1;break;case"streamtube":U=[["M-6,2 A2,2 0 0,0 -6,6 H6 A2,2 0 0,1 6,2 Z"],["M-6,-6 A2,2 0 0,0 -6,-2 H6 A2,2 0 0,1 6,-6 Z"],["M-6,-2 A2,2 0 0,0 -6,2 H6 A2,2 0 0,1 6,-2 Z"]],N=!1;break;case"surface":U=[["M-6,-6 A2,3 0 0,0 -6,0 H6 A2,3 0 0,1 6,-6 Z"],["M-6,1 A2,3 0 0,1 -6,6 H6 A2,3 0 0,0 6,0 Z"]],N=!0;break;case"mesh3d":U=[["M-6,6H0L-6,-6Z"],["M6,6H0L6,-6Z"],["M-6,-6H6L0,6Z"]],N=!1;break;case"volume":U=[["M-6,6H0L-6,-6Z"],["M6,6H0L6,-6Z"],["M-6,-6H6L0,6Z"]],N=!0;break;case"isosurface":U=[["M-6,6H0L-6,-6Z"],["M6,6H0L6,-6Z"],["M-6,-6 A12,24 0 0,0 6,-6 L0,6Z"]],N=!1;break}var q=w.select(this).select("g.legendpoints").selectAll("path.legend3dandfriends").data(U);q.enter().append("path").classed("legend3dandfriends",!0).attr("transform",k).style("stroke-miterlimit",1),q.exit().remove(),q.each(function($,W){var K=w.select(this),ne=n(se),ae=ne.colorscale,ie=ne.reversescale,le=function(ge){if(ge.size()){var Te="legendfill-"+se.uid;e.gradient(ge,b,Te,m(ie,N==="radial"),ae,"fill")}},ye;if(ae){if(!N){var pe=ae.length;ye=W===0?ae[ie?pe-1:0][1]:W===1?ae[ie?0:pe-1][1]:ae[Math.floor((pe-1)/2)][1]}}else{var ue=se.vertexcolor||se.facecolor||se.color;ye=S.isArrayOrTypedArray(ue)?ue[W]||ue[0]:ue}K.attr("d",$[0]),ye?K.call(a.fill,ye):K.call(le)})}};function m(s,A){var b=A?"radial":"horizontal";return b+(s?"":"reversed")}function u(s){var A=s[0].trace,b=A.contours,f=r.hasLines(A),x=r.hasMarkers(A),l=A.visible&&A.fill&&A.fill!=="none",L=!1,T=!1;if(b){var k=b.coloring;k==="lines"?L=!0:f=k==="none"||k==="heatmap"||b.showlines,b.type==="constraint"?l=b._operation!=="=":(k==="fill"||k==="heatmap")&&(T=!0)}return{showMarker:x,showLine:f,showFill:l,showGradientLine:L,showGradientFill:T,anyLine:f||L,anyFill:l||T}}function _(s,A,b){return s&&S.isArrayOrTypedArray(s)?A:s>b?b:s}},{"../../lib":515,"../../registry":647,"../../traces/pie/helpers":915,"../../traces/pie/style_one":921,"../../traces/scatter/subtypes":961,"../color":367,"../colorscale/helpers":378,"../drawing":389,"./constants":418,"@plotly/d3":58}],426:[function(d,ee,te){d("./constants"),ee.exports={editType:"modebar",orientation:{valType:"enumerated",values:["v","h"],dflt:"h",editType:"modebar"},bgcolor:{valType:"color",editType:"modebar"},color:{valType:"color",editType:"modebar"},activecolor:{valType:"color",editType:"modebar"},uirevision:{valType:"any",editType:"none"},add:{valType:"string",arrayOk:!0,dflt:"",editType:"modebar"},remove:{valType:"string",arrayOk:!0,dflt:"",editType:"modebar"}}},{"./constants":428}],427:[function(d,ee,te){var w=d("../../registry"),v=d("../../plots/plots"),S=d("../../plots/cartesian/axis_ids"),M=d("../../fonts/ploticon"),e=d("../shapes/draw").eraseActiveShape,a=d("../../lib"),n=a._,r=ee.exports={};r.toImage={name:"toImage",title:function(s){var A=s._context.toImageButtonOptions||{},b=A.format||"png";return b==="png"?n(s,"Download plot as a png"):n(s,"Download plot")},icon:M.camera,click:function(s){var A=s._context.toImageButtonOptions,b={format:A.format||"png"};a.notifier(n(s,"Taking snapshot - this may take a few seconds"),"long"),b.format!=="svg"&&a.isIE()&&(a.notifier(n(s,"IE only supports svg.  Changing format to svg."),"long"),b.format="svg"),["filename","width","height","scale"].forEach(function(f){f in A&&(b[f]=A[f])}),w.call("downloadImage",s,b).then(function(f){a.notifier(n(s,"Snapshot succeeded")+" - "+f,"long")}).catch(function(){a.notifier(n(s,"Sorry, there was a problem downloading your snapshot!"),"long")})}},r.sendDataToCloud={name:"sendDataToCloud",title:function(s){return n(s,"Edit in Chart Studio")},icon:M.disk,click:function(s){v.sendDataToCloud(s)}},r.editInChartStudio={name:"editInChartStudio",title:function(s){return n(s,"Edit in Chart Studio")},icon:M.pencil,click:function(s){v.sendDataToCloud(s)}},r.zoom2d={name:"zoom2d",_cat:"zoom",title:function(s){return n(s,"Zoom")},attr:"dragmode",val:"zoom",icon:M.zoombox,click:t},r.pan2d={name:"pan2d",_cat:"pan",title:function(s){return n(s,"Pan")},attr:"dragmode",val:"pan",icon:M.pan,click:t},r.select2d={name:"select2d",_cat:"select",title:function(s){return n(s,"Box Select")},attr:"dragmode",val:"select",icon:M.selectbox,click:t},r.lasso2d={name:"lasso2d",_cat:"lasso",title:function(s){return n(s,"Lasso Select")},attr:"dragmode",val:"lasso",icon:M.lasso,click:t},r.drawclosedpath={name:"drawclosedpath",title:function(s){return n(s,"Draw closed freeform")},attr:"dragmode",val:"drawclosedpath",icon:M.drawclosedpath,click:t},r.drawopenpath={name:"drawopenpath",title:function(s){return n(s,"Draw open freeform")},attr:"dragmode",val:"drawopenpath",icon:M.drawopenpath,click:t},r.drawline={name:"drawline",title:function(s){return n(s,"Draw line")},attr:"dragmode",val:"drawline",icon:M.drawline,click:t},r.drawrect={name:"drawrect",title:function(s){return n(s,"Draw rectangle")},attr:"dragmode",val:"drawrect",icon:M.drawrect,click:t},r.drawcircle={name:"drawcircle",title:function(s){return n(s,"Draw circle")},attr:"dragmode",val:"drawcircle",icon:M.drawcircle,click:t},r.eraseshape={name:"eraseshape",title:function(s){return n(s,"Erase active shape")},icon:M.eraseshape,click:e},r.zoomIn2d={name:"zoomIn2d",_cat:"zoomin",title:function(s){return n(s,"Zoom in")},attr:"zoom",val:"in",icon:M.zoom_plus,click:t},r.zoomOut2d={name:"zoomOut2d",_cat:"zoomout",title:function(s){return n(s,"Zoom out")},attr:"zoom",val:"out",icon:M.zoom_minus,click:t},r.autoScale2d={name:"autoScale2d",_cat:"autoscale",title:function(s){return n(s,"Autoscale")},attr:"zoom",val:"auto",icon:M.autoscale,click:t},r.resetScale2d={name:"resetScale2d",_cat:"resetscale",title:function(s){return n(s,"Reset axes")},attr:"zoom",val:"reset",icon:M.home,click:t},r.hoverClosestCartesian={name:"hoverClosestCartesian",_cat:"hoverclosest",title:function(s){return n(s,"Show closest data on hover")},attr:"hovermode",val:"closest",icon:M.tooltip_basic,gravity:"ne",click:t},r.hoverCompareCartesian={name:"hoverCompareCartesian",_cat:"hoverCompare",title:function(s){return n(s,"Compare data on hover")},attr:"hovermode",val:function(s){return s._fullLayout._isHoriz?"y":"x"},icon:M.tooltip_compare,gravity:"ne",click:t};function t(s,A){var b=A.currentTarget,f=b.getAttribute("data-attr"),x=b.getAttribute("data-val")||!0,l=s._fullLayout,L={},T=S.list(s,null,!0),k=l._cartesianSpikesEnabled,P,z;if(f==="zoom"){var I=x==="in"?.5:2,D=(1+I)/2,R=(1-I)/2,B;for(z=0;z<T.length;z++)if(P=T[z],!P.fixedrange)if(B=P._name,x==="auto")L[B+".autorange"]=!0;else if(x==="reset"){if(P._rangeInitial===void 0)L[B+".autorange"]=!0;else{var F=P._rangeInitial.slice();L[B+".range[0]"]=F[0],L[B+".range[1]"]=F[1]}P._showSpikeInitial!==void 0&&(L[B+".showspikes"]=P._showSpikeInitial,k==="on"&&!P._showSpikeInitial&&(k="off"))}else{var H=[P.r2l(P.range[0]),P.r2l(P.range[1])],G=[D*H[0]+R*H[1],D*H[1]+R*H[0]];L[B+".range[0]"]=P.l2r(G[0]),L[B+".range[1]"]=P.l2r(G[1])}}else f==="hovermode"&&(x==="x"||x==="y")&&(x=l._isHoriz?"y":"x",b.setAttribute("data-val",x)),L[f]=x;l._cartesianSpikesEnabled=k,w.call("_guiRelayout",s,L)}r.zoom3d={name:"zoom3d",_cat:"zoom",title:function(s){return n(s,"Zoom")},attr:"scene.dragmode",val:"zoom",icon:M.zoombox,click:c},r.pan3d={name:"pan3d",_cat:"pan",title:function(s){return n(s,"Pan")},attr:"scene.dragmode",val:"pan",icon:M.pan,click:c},r.orbitRotation={name:"orbitRotation",title:function(s){return n(s,"Orbital rotation")},attr:"scene.dragmode",val:"orbit",icon:M["3d_rotate"],click:c},r.tableRotation={name:"tableRotation",title:function(s){return n(s,"Turntable rotation")},attr:"scene.dragmode",val:"turntable",icon:M["z-axis"],click:c};function c(s,A){for(var b=A.currentTarget,f=b.getAttribute("data-attr"),x=b.getAttribute("data-val")||!0,l=s._fullLayout._subplots.gl3d||[],L={},T=f.split("."),k=0;k<l.length;k++)L[l[k]+"."+T[1]]=x;var P=x==="pan"?x:"zoom";L.dragmode=P,w.call("_guiRelayout",s,L)}r.resetCameraDefault3d={name:"resetCameraDefault3d",_cat:"resetCameraDefault",title:function(s){return n(s,"Reset camera to default")},attr:"resetDefault",icon:M.home,click:o},r.resetCameraLastSave3d={name:"resetCameraLastSave3d",_cat:"resetCameraLastSave",title:function(s){return n(s,"Reset camera to last save")},attr:"resetLastSave",icon:M.movie,click:o};function o(s,A){for(var b=A.currentTarget,f=b.getAttribute("data-attr"),x=f==="resetLastSave",l=f==="resetDefault",L=s._fullLayout,T=L._subplots.gl3d||[],k={},P=0;P<T.length;P++){var z=T[P],I=z+".camera",D=z+".aspectratio",R=z+".aspectmode",B=L[z]._scene,F;x?(k[I+".up"]=B.viewInitial.up,k[I+".eye"]=B.viewInitial.eye,k[I+".center"]=B.viewInitial.center,F=!0):l&&(k[I+".up"]=null,k[I+".eye"]=null,k[I+".center"]=null,F=!0),F&&(k[D+".x"]=B.viewInitial.aspectratio.x,k[D+".y"]=B.viewInitial.aspectratio.y,k[D+".z"]=B.viewInitial.aspectratio.z,k[R]=B.viewInitial.aspectmode)}w.call("_guiRelayout",s,k)}r.hoverClosest3d={name:"hoverClosest3d",_cat:"hoverclosest",title:function(s){return n(s,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:M.tooltip_basic,gravity:"ne",click:y};function i(s,A){var b=A.currentTarget,f=b._previousVal,x=s._fullLayout,l=x._subplots.gl3d||[],L=["xaxis","yaxis","zaxis"],T={},k={};if(f)k=f,b._previousVal=null;else{for(var P=0;P<l.length;P++){var z=l[P],I=x[z],D=z+".hovermode";T[D]=I.hovermode,k[D]=!1;for(var R=0;R<3;R++){var B=L[R],F=z+"."+B+".showspikes";k[F]=!1,T[F]=I[B].showspikes}}b._previousVal=T}return k}function y(s,A){var b=i(s,A);w.call("_guiRelayout",s,b)}r.zoomInGeo={name:"zoomInGeo",_cat:"zoomin",title:function(s){return n(s,"Zoom in")},attr:"zoom",val:"in",icon:M.zoom_plus,click:p},r.zoomOutGeo={name:"zoomOutGeo",_cat:"zoomout",title:function(s){return n(s,"Zoom out")},attr:"zoom",val:"out",icon:M.zoom_minus,click:p},r.resetGeo={name:"resetGeo",_cat:"reset",title:function(s){return n(s,"Reset")},attr:"reset",val:null,icon:M.autoscale,click:p},r.hoverClosestGeo={name:"hoverClosestGeo",_cat:"hoverclosest",title:function(s){return n(s,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:M.tooltip_basic,gravity:"ne",click:h};function p(s,A){for(var b=A.currentTarget,f=b.getAttribute("data-attr"),x=b.getAttribute("data-val")||!0,l=s._fullLayout,L=l._subplots.geo||[],T=0;T<L.length;T++){var k=L[T],P=l[k];if(f==="zoom"){var z=P.projection.scale,I=x==="in"?2*z:.5*z;w.call("_guiRelayout",s,k+".projection.scale",I)}}f==="reset"&&_(s,"geo")}r.hoverClosestGl2d={name:"hoverClosestGl2d",_cat:"hoverclosest",title:function(s){return n(s,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:M.tooltip_basic,gravity:"ne",click:h},r.hoverClosestPie={name:"hoverClosestPie",_cat:"hoverclosest",title:function(s){return n(s,"Toggle show closest data on hover")},attr:"hovermode",val:"closest",icon:M.tooltip_basic,gravity:"ne",click:h};function g(s){var A=s._fullLayout;return A.hovermode?!1:A._has("cartesian")?A._isHoriz?"y":"x":"closest"}function h(s){var A=g(s);w.call("_guiRelayout",s,"hovermode",A)}r.resetViewSankey={name:"resetSankeyGroup",title:function(s){return n(s,"Reset view")},icon:M.home,click:function(s){for(var A={"node.groups":[],"node.x":[],"node.y":[]},b=0;b<s._fullData.length;b++){var f=s._fullData[b]._viewInitial;A["node.groups"].push(f.node.groups.slice()),A["node.x"].push(f.node.x.slice()),A["node.y"].push(f.node.y.slice())}w.call("restyle",s,A)}},r.toggleHover={name:"toggleHover",title:function(s){return n(s,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:M.tooltip_basic,gravity:"ne",click:function(s,A){var b=i(s,A);b.hovermode=g(s),w.call("_guiRelayout",s,b)}},r.resetViews={name:"resetViews",title:function(s){return n(s,"Reset views")},icon:M.home,click:function(s,A){var b=A.currentTarget;b.setAttribute("data-attr","zoom"),b.setAttribute("data-val","reset"),t(s,A),b.setAttribute("data-attr","resetLastSave"),o(s,A),_(s,"geo"),_(s,"mapbox")}},r.toggleSpikelines={name:"toggleSpikelines",title:function(s){return n(s,"Toggle Spike Lines")},icon:M.spikeline,attr:"_cartesianSpikesEnabled",val:"on",click:function(s){var A=s._fullLayout,b=A._cartesianSpikesEnabled;A._cartesianSpikesEnabled=b==="on"?"off":"on",w.call("_guiRelayout",s,m(s))}};function m(s){for(var A=s._fullLayout,b=A._cartesianSpikesEnabled==="on",f=S.list(s,null,!0),x={},l=0;l<f.length;l++){var L=f[l];x[L._name+".showspikes"]=b?!0:L._showSpikeInitial}return x}r.resetViewMapbox={name:"resetViewMapbox",_cat:"resetView",title:function(s){return n(s,"Reset view")},attr:"reset",icon:M.home,click:function(s){_(s,"mapbox")}},r.zoomInMapbox={name:"zoomInMapbox",_cat:"zoomin",title:function(s){return n(s,"Zoom in")},attr:"zoom",val:"in",icon:M.zoom_plus,click:u},r.zoomOutMapbox={name:"zoomOutMapbox",_cat:"zoomout",title:function(s){return n(s,"Zoom out")},attr:"zoom",val:"out",icon:M.zoom_minus,click:u};function u(s,A){for(var b=A.currentTarget,f=b.getAttribute("data-val"),x=s._fullLayout,l=x._subplots.mapbox||[],L=1.05,T={},k=0;k<l.length;k++){var P=l[k],z=x[P].zoom,I=f==="in"?L*z:z/L;T[P+".zoom"]=I}w.call("_guiRelayout",s,T)}function _(s,A){for(var b=s._fullLayout,f=b._subplots[A]||[],x={},l=0;l<f.length;l++)for(var L=f[l],T=b[L]._subplot,k=T.viewInitial,P=Object.keys(k),z=0;z<P.length;z++){var I=P[z];x[L+"."+I]=k[I]}w.call("_guiRelayout",s,x)}},{"../../fonts/ploticon":494,"../../lib":515,"../../plots/cartesian/axis_ids":570,"../../plots/plots":628,"../../registry":647,"../shapes/draw":462}],428:[function(d,ee,te){var w=d("./buttons"),v=Object.keys(w),S=["drawline","drawopenpath","drawclosedpath","drawcircle","drawrect","eraseshape"],M=["v1hovermode","hoverclosest","hovercompare","togglehover","togglespikelines"].concat(S),e=[],a=function(n){if(M.indexOf(n._cat||n.name)===-1){var r=n.name,t=(n._cat||n.name).toLowerCase();e.indexOf(r)===-1&&e.push(r),e.indexOf(t)===-1&&e.push(t)}};v.forEach(function(n){a(w[n])}),e.sort(),ee.exports={DRAW_MODES:S,backButtons:M,foreButtons:e}},{"./buttons":427}],429:[function(d,ee,te){var w=d("../../lib"),v=d("../color"),S=d("../../plot_api/plot_template"),M=d("./attributes");ee.exports=function(a,n){var r=a.modebar||{},t=S.newContainer(n,"modebar");function c(i,y){return w.coerce(r,t,M,i,y)}c("orientation"),c("bgcolor",v.addOpacity(n.paper_bgcolor,.5));var o=v.contrast(v.rgb(n.modebar.bgcolor));c("color",v.addOpacity(o,.3)),c("activecolor",v.addOpacity(o,.7)),c("uirevision",n.uirevision),c("add"),c("remove")}},{"../../lib":515,"../../plot_api/plot_template":555,"../color":367,"./attributes":426}],430:[function(d,ee,te){ee.exports={moduleType:"component",name:"modebar",layoutAttributes:d("./attributes"),supplyLayoutDefaults:d("./defaults"),manage:d("./manage")}},{"./attributes":426,"./defaults":429,"./manage":431}],431:[function(d,ee,te){var w=d("../../plots/cartesian/axis_ids"),v=d("../../traces/scatter/subtypes"),S=d("../../registry"),M=d("../fx/helpers").isUnifiedHover,e=d("./modebar"),a=d("./buttons"),n=d("./constants").DRAW_MODES,r=d("../../lib").extendDeep;ee.exports=function(h){var m=h._fullLayout,u=h._context,_=m._modeBar;if(!u.displayModeBar&&!u.watermark){_&&(_.destroy(),delete m._modeBar);return}if(!Array.isArray(u.modeBarButtonsToRemove))throw new Error(["*modeBarButtonsToRemove* configuration options","must be an array."].join(" "));if(!Array.isArray(u.modeBarButtonsToAdd))throw new Error(["*modeBarButtonsToAdd* configuration options","must be an array."].join(" "));var s=u.modeBarButtons,A;Array.isArray(s)&&s.length?A=p(s):!u.displayModeBar&&u.watermark?A=[]:A=t(h),_?_.update(h,A):m._modeBar=e(h,A)};function t(g){var h=g._fullLayout,m=g._fullData,u=g._context;function _(W,K){if(typeof K=="string"){if(K.toLowerCase()===W.toLowerCase())return!0}else{var ne=K.name,ae=K._cat||K.name;if(ne===W||ae===W.toLowerCase())return!0}return!1}var s=h.modebar.add;typeof s=="string"&&(s=[s]);var A=h.modebar.remove;typeof A=="string"&&(A=[A]);var b=u.modeBarButtonsToAdd.concat(s.filter(function(W){for(var K=0;K<u.modeBarButtonsToRemove.length;K++)if(_(W,u.modeBarButtonsToRemove[K]))return!1;return!0})),f=u.modeBarButtonsToRemove.concat(A.filter(function(W){for(var K=0;K<u.modeBarButtonsToAdd.length;K++)if(_(W,u.modeBarButtonsToAdd[K]))return!1;return!0})),x=h._has("cartesian"),l=h._has("gl3d"),L=h._has("geo"),T=h._has("pie"),k=h._has("funnelarea"),P=h._has("gl2d"),z=h._has("ternary"),I=h._has("mapbox"),D=h._has("polar"),R=h._has("smith"),B=h._has("sankey"),F=c(h),H=M(h.hovermode),G=[];function J(W){if(!!W.length){for(var K=[],ne=0;ne<W.length;ne++){for(var ae=W[ne],ie=a[ae],le=ie.name.toLowerCase(),ye=(ie._cat||ie.name).toLowerCase(),ue=!1,pe=0;pe<f.length;pe++){var ge=f[pe].toLowerCase();if(ge===le||ge===ye){ue=!0;break}}ue||K.push(a[ae])}G.push(K)}}var X=["toImage"];u.showEditInChartStudio?X.push("editInChartStudio"):u.showSendToCloud&&X.push("sendDataToCloud"),J(X);var Y=[],Z=[],oe=[],re=[];(x||P||T||k||z)+L+l+I+D+R>1?(Z=["toggleHover"],oe=["resetViews"]):L?(Y=["zoomInGeo","zoomOutGeo"],Z=["hoverClosestGeo"],oe=["resetGeo"]):l?(Z=["hoverClosest3d"],oe=["resetCameraDefault3d","resetCameraLastSave3d"]):I?(Y=["zoomInMapbox","zoomOutMapbox"],Z=["toggleHover"],oe=["resetViewMapbox"]):P?Z=["hoverClosestGl2d"]:T?Z=["hoverClosestPie"]:B?(Z=["hoverClosestCartesian","hoverCompareCartesian"],oe=["resetViewSankey"]):Z=["toggleHover"],x&&(Z=["toggleSpikelines","hoverClosestCartesian","hoverCompareCartesian"]),(i(m)||H)&&(Z=[]),(x||P)&&!F&&(Y=["zoomIn2d","zoomOut2d","autoScale2d"],oe[0]!=="resetViews"&&(oe=["resetScale2d"])),l?re=["zoom3d","pan3d","orbitRotation","tableRotation"]:(x||P)&&!F||z?re=["zoom2d","pan2d"]:I||L?re=["pan2d"]:D&&(re=["zoom2d"]),o(m)&&re.push("select2d","lasso2d");var se=[],N=function(W){se.indexOf(W)===-1&&Z.indexOf(W)!==-1&&se.push(W)};if(Array.isArray(b)){for(var U=[],q=0;q<b.length;q++){var $=b[q];typeof $=="string"?($=$.toLowerCase(),n.indexOf($)!==-1?(h._has("mapbox")||h._has("cartesian"))&&re.push($):$==="togglespikelines"?N("toggleSpikelines"):$==="togglehover"?N("toggleHover"):$==="hovercompare"?N("hoverCompareCartesian"):$==="hoverclosest"?(N("hoverClosestCartesian"),N("hoverClosestGeo"),N("hoverClosest3d"),N("hoverClosestGl2d"),N("hoverClosestPie")):$==="v1hovermode"&&(N("toggleHover"),N("hoverClosestCartesian"),N("hoverCompareCartesian"),N("hoverClosestGeo"),N("hoverClosest3d"),N("hoverClosestGl2d"),N("hoverClosestPie"))):U.push($)}b=U}return J(re),J(Y.concat(oe)),J(se),y(G,b)}function c(g){for(var h=w.list({_fullLayout:g},null,!0),m=0;m<h.length;m++)if(!h[m].fixedrange)return!1;return!0}function o(g){for(var h=!1,m=0;m<g.length&&!h;m++){var u=g[m];!u._module||!u._module.selectPoints||(S.traceIs(u,"scatter-like")?(v.hasMarkers(u)||v.hasText(u))&&(h=!0):S.traceIs(u,"box-violin")?(u.boxpoints==="all"||u.points==="all")&&(h=!0):h=!0)}return h}function i(g){for(var h=0;h<g.length;h++)if(!S.traceIs(g[h],"noHover"))return!1;return!0}function y(g,h){if(h.length)if(Array.isArray(h[0]))for(var m=0;m<h.length;m++)g.push(h[m]);else g.push(h);return g}function p(g){for(var h=r([],g),m=0;m<h.length;m++)for(var u=h[m],_=0;_<u.length;_++){var s=u[_];if(typeof s=="string")if(a[s]!==void 0)h[m][_]=a[s];else throw new Error(["*modeBarButtons* configuration options","invalid button name"].join(" "))}return h}},{"../../lib":515,"../../plots/cartesian/axis_ids":570,"../../registry":647,"../../traces/scatter/subtypes":961,"../fx/helpers":403,"./buttons":427,"./constants":428,"./modebar":432}],432:[function(d,ee,te){var w=d("@plotly/d3"),v=d("fast-isnumeric"),S=d("../../lib"),M=d("../../fonts/ploticon"),e=d("../../version").version,a=new DOMParser;function n(o){this.container=o.container,this.element=document.createElement("div"),this.update(o.graphInfo,o.buttons),this.container.appendChild(this.element)}var r=n.prototype;r.update=function(o,i){this.graphInfo=o;var y=this.graphInfo._context,p=this.graphInfo._fullLayout,g="modebar-"+p._uid;this.element.setAttribute("id",g),this._uid=g,this.element.className="modebar",y.displayModeBar==="hover"&&(this.element.className+=" modebar--hover ease-bg"),p.modebar.orientation==="v"&&(this.element.className+=" vertical",i=i.reverse());var h=p.modebar,m=y.displayModeBar==="hover"?".js-plotly-plot .plotly:hover ":"";S.deleteRelatedStyleRule(g),S.addRelatedStyleRule(g,m+"#"+g+" .modebar-group","background-color: "+h.bgcolor),S.addRelatedStyleRule(g,"#"+g+" .modebar-btn .icon path","fill: "+h.color),S.addRelatedStyleRule(g,"#"+g+" .modebar-btn:hover .icon path","fill: "+h.activecolor),S.addRelatedStyleRule(g,"#"+g+" .modebar-btn.active .icon path","fill: "+h.activecolor);var u=!this.hasButtons(i),_=this.hasLogo!==y.displaylogo,s=this.locale!==y.locale;if(this.locale=y.locale,(u||_||s)&&(this.removeAllButtons(),this.updateButtons(i),y.watermark||y.displaylogo)){var A=this.getLogo();y.watermark&&(A.className=A.className+" watermark"),p.modebar.orientation==="v"?this.element.insertBefore(A,this.element.childNodes[0]):this.element.appendChild(A),this.hasLogo=!0}this.updateActiveButton()},r.updateButtons=function(o){var i=this;this.buttons=o,this.buttonElements=[],this.buttonsNames=[],this.buttons.forEach(function(y){var p=i.createGroup();y.forEach(function(g){var h=g.name;if(!h)throw new Error("must provide button 'name' in button config");if(i.buttonsNames.indexOf(h)!==-1)throw new Error("button name '"+h+"' is taken");i.buttonsNames.push(h);var m=i.createButton(g);i.buttonElements.push(m),p.appendChild(m)}),i.element.appendChild(p)})},r.createGroup=function(){var o=document.createElement("div");return o.className="modebar-group",o},r.createButton=function(o){var i=this,y=document.createElement("a");y.setAttribute("rel","tooltip"),y.className="modebar-btn";var p=o.title;p===void 0?p=o.name:typeof p=="function"&&(p=p(this.graphInfo)),(p||p===0)&&y.setAttribute("data-title",p),o.attr!==void 0&&y.setAttribute("data-attr",o.attr);var g=o.val;g!==void 0&&(typeof g=="function"&&(g=g(this.graphInfo)),y.setAttribute("data-val",g));var h=o.click;if(typeof h!="function")throw new Error("must provide button 'click' function in button config");y.addEventListener("click",function(u){o.click(i.graphInfo,u),i.updateActiveButton(u.currentTarget)}),y.setAttribute("data-toggle",o.toggle||!1),o.toggle&&w.select(y).classed("active",!0);var m=o.icon;return typeof m=="function"?y.appendChild(m()):y.appendChild(this.createIcon(m||M.question)),y.setAttribute("data-gravity",o.gravity||"n"),y},r.createIcon=function(o){var i=v(o.height)?Number(o.height):o.ascent-o.descent,y="http://www.w3.org/2000/svg",p;if(o.path){p=document.createElementNS(y,"svg"),p.setAttribute("viewBox",[0,0,o.width,i].join(" ")),p.setAttribute("class","icon");var g=document.createElementNS(y,"path");g.setAttribute("d",o.path),o.transform?g.setAttribute("transform",o.transform):o.ascent!==void 0&&g.setAttribute("transform","matrix(1 0 0 -1 0 "+o.ascent+")"),p.appendChild(g)}if(o.svg){var h=a.parseFromString(o.svg,"application/xml");p=h.childNodes[0]}return p.setAttribute("height","1em"),p.setAttribute("width","1em"),p},r.updateActiveButton=function(o){var i=this.graphInfo._fullLayout,y=o!==void 0?o.getAttribute("data-attr"):null;this.buttonElements.forEach(function(p){var g=p.getAttribute("data-val")||!0,h=p.getAttribute("data-attr"),m=p.getAttribute("data-toggle")==="true",u=w.select(p);if(m)h===y&&u.classed("active",!u.classed("active"));else{var _=h===null?h:S.nestedProperty(i,h).get();u.classed("active",_===g)}})},r.hasButtons=function(o){var i=this.buttons;if(!i||o.length!==i.length)return!1;for(var y=0;y<o.length;++y){if(o[y].length!==i[y].length)return!1;for(var p=0;p<o[y].length;p++)if(o[y][p].name!==i[y][p].name)return!1}return!0};function t(o){return o+" (v"+e+")"}r.getLogo=function(){var o=this.createGroup(),i=document.createElement("a");return i.href="https://plotly.com/",i.target="_blank",i.setAttribute("data-title",t(S._(this.graphInfo,"Produced with Plotly.js"))),i.className="modebar-btn plotlyjsicon modebar-btn--logo",i.appendChild(this.createIcon(M.newplotlylogo)),o.appendChild(i),o},r.removeAllButtons=function(){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);this.hasLogo=!1},r.destroy=function(){S.removeElement(this.container.querySelector(".modebar")),S.deleteRelatedStyleRule(this._uid)};function c(o,i){var y=o._fullLayout,p=new n({graphInfo:o,container:y._modebardiv.node(),buttons:i});return y._privateplot&&w.select(p.element).append("span").classed("badge-private float--left",!0).text("PRIVATE"),p}ee.exports=c},{"../../fonts/ploticon":494,"../../lib":515,"../../version":1132,"@plotly/d3":58,"fast-isnumeric":190}],433:[function(d,ee,te){var w=d("../../plots/font_attributes"),v=d("../color/attributes"),S=d("../../plot_api/plot_template").templatedArray,M=S("button",{visible:{valType:"boolean",dflt:!0,editType:"plot"},step:{valType:"enumerated",values:["month","year","day","hour","minute","second","all"],dflt:"month",editType:"plot"},stepmode:{valType:"enumerated",values:["backward","todate"],dflt:"backward",editType:"plot"},count:{valType:"number",min:0,dflt:1,editType:"plot"},label:{valType:"string",editType:"plot"},editType:"plot"});ee.exports={visible:{valType:"boolean",editType:"plot"},buttons:M,x:{valType:"number",min:-2,max:3,editType:"plot"},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"left",editType:"plot"},y:{valType:"number",min:-2,max:3,editType:"plot"},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"bottom",editType:"plot"},font:w({editType:"plot"}),bgcolor:{valType:"color",dflt:v.lightLine,editType:"plot"},activecolor:{valType:"color",editType:"plot"},bordercolor:{valType:"color",dflt:v.defaultLine,editType:"plot"},borderwidth:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"plot"}},{"../../plot_api/plot_template":555,"../../plots/font_attributes":594,"../color/attributes":366}],434:[function(d,ee,te){ee.exports={yPad:.02,minButtonWidth:30,rx:3,ry:3,lightAmount:25,darkAmount:10}},{}],435:[function(d,ee,te){var w=d("../../lib"),v=d("../color"),S=d("../../plot_api/plot_template"),M=d("../../plots/array_container_defaults"),e=d("./attributes"),a=d("./constants");ee.exports=function(c,o,i,y,p){var g=c.rangeselector||{},h=S.newContainer(o,"rangeselector");function m(b,f){return w.coerce(g,h,e,b,f)}var u=M(g,h,{name:"buttons",handleItemDefaults:n,calendar:p}),_=m("visible",u.length>0);if(_){var s=r(o,i,y);m("x",s[0]),m("y",s[1]),w.noneOrAll(c,o,["x","y"]),m("xanchor"),m("yanchor"),w.coerceFont(m,"font",i.font);var A=m("bgcolor");m("activecolor",v.contrast(A,a.lightAmount,a.darkAmount)),m("bordercolor"),m("borderwidth")}};function n(t,c,o,i){var y=i.calendar;function p(m,u){return w.coerce(t,c,e.buttons,m,u)}var g=p("visible");if(g){var h=p("step");h!=="all"&&(y&&y!=="gregorian"&&(h==="month"||h==="year")?c.stepmode="backward":p("stepmode"),p("count")),p("label")}}function r(t,c,o){for(var i=o.filter(function(h){return c[h].anchor===t._id}),y=0,p=0;p<i.length;p++){var g=c[i[p]].domain;g&&(y=Math.max(g[1],y))}return[t.domain[0],y+a.yPad]}},{"../../lib":515,"../../plot_api/plot_template":555,"../../plots/array_container_defaults":561,"../color":367,"./attributes":433,"./constants":434}],436:[function(d,ee,te){var w=d("@plotly/d3"),v=d("../../registry"),S=d("../../plots/plots"),M=d("../color"),e=d("../drawing"),a=d("../../lib"),n=a.strTranslate,r=d("../../lib/svg_text_utils"),t=d("../../plots/cartesian/axis_ids"),c=d("../../constants/alignment"),o=c.LINE_SPACING,i=c.FROM_TL,y=c.FROM_BR,p=d("./constants"),g=d("./get_update_object");ee.exports=function(l){var L=l._fullLayout,T=L._infolayer.selectAll(".rangeselector").data(h(l),m);T.enter().append("g").classed("rangeselector",!0),T.exit().remove(),T.style({cursor:"pointer","pointer-events":"all"}),T.each(function(k){var P=w.select(this),z=k,I=z.rangeselector,D=P.selectAll("g.button").data(a.filterVisible(I.buttons));D.enter().append("g").classed("button",!0),D.exit().remove(),D.each(function(R){var B=w.select(this),F=g(z,R);R._isActive=u(z,R,F),B.call(_,I,R),B.call(A,I,R,l),B.on("click",function(){l._dragged||v.call("_guiRelayout",l,F)}),B.on("mouseover",function(){R._isHovered=!0,B.call(_,I,R)}),B.on("mouseout",function(){R._isHovered=!1,B.call(_,I,R)})}),f(l,D,I,z._name,P)})};function h(x){for(var l=t.list(x,"x",!0),L=[],T=0;T<l.length;T++){var k=l[T];k.rangeselector&&k.rangeselector.visible&&L.push(k)}return L}function m(x){return x._id}function u(x,l,L){if(l.step==="all")return x.autorange===!0;var T=Object.keys(L);return x.range[0]===L[T[0]]&&x.range[1]===L[T[1]]}function _(x,l,L){var T=a.ensureSingle(x,"rect","selector-rect",function(k){k.attr("shape-rendering","crispEdges")});T.attr({rx:p.rx,ry:p.ry}),T.call(M.stroke,l.bordercolor).call(M.fill,s(l,L)).style("stroke-width",l.borderwidth+"px")}function s(x,l){return l._isActive||l._isHovered?x.activecolor:x.bgcolor}function A(x,l,L,T){function k(z){r.convertToTspans(z,T)}var P=a.ensureSingle(x,"text","selector-text",function(z){z.attr("text-anchor","middle")});P.call(e.font,l.font).text(b(L,T._fullLayout._meta)).call(k)}function b(x,l){return x.label?l?a.templateString(x.label,l):x.label:x.step==="all"?"all":x.count+x.step.charAt(0)}function f(x,l,L,T,k){var P=0,z=0,I=L.borderwidth;l.each(function(){var G=w.select(this),J=G.select(".selector-text"),X=L.font.size*o,Y=Math.max(X*r.lineCount(J),16)+3;z=Math.max(z,Y)}),l.each(function(){var G=w.select(this),J=G.select(".selector-rect"),X=G.select(".selector-text"),Y=X.node()&&e.bBox(X.node()).width,Z=L.font.size*o,oe=r.lineCount(X),re=Math.max(Y+10,p.minButtonWidth);G.attr("transform",n(I+P,I)),J.attr({x:0,y:0,width:re,height:z}),r.positionText(X,re/2,z/2-(oe-1)*Z/2+3),P+=re+5});var D=x._fullLayout._size,R=D.l+D.w*L.x,B=D.t+D.h*(1-L.y),F="left";a.isRightAnchor(L)&&(R-=P,F="right"),a.isCenterAnchor(L)&&(R-=P/2,F="center");var H="top";a.isBottomAnchor(L)&&(B-=z,H="bottom"),a.isMiddleAnchor(L)&&(B-=z/2,H="middle"),P=Math.ceil(P),z=Math.ceil(z),R=Math.round(R),B=Math.round(B),S.autoMargin(x,T+"-range-selector",{x:L.x,y:L.y,l:P*i[F],r:P*y[F],b:z*y[H],t:z*i[H]}),k.attr("transform",n(R,B))}},{"../../constants/alignment":483,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/cartesian/axis_ids":570,"../../plots/plots":628,"../../registry":647,"../color":367,"../drawing":389,"./constants":434,"./get_update_object":437,"@plotly/d3":58}],437:[function(d,ee,te){var w=d("d3-time"),v=d("../../lib").titleCase;ee.exports=function(e,a){var n=e._name,r={};if(a.step==="all")r[n+".autorange"]=!0;else{var t=S(e,a);r[n+".range[0]"]=t[0],r[n+".range[1]"]=t[1]}return r};function S(M,e){var a=M.range,n=new Date(M.r2l(a[1])),r=e.step,t=w["utc"+v(r)],c=e.count,o;switch(e.stepmode){case"backward":o=M.l2r(+t.offset(n,-c));break;case"todate":var i=t.offset(n,-c);o=M.l2r(+t.ceil(i));break}var y=a[1];return[o,y]}},{"../../lib":515,"d3-time":122}],438:[function(d,ee,te){ee.exports={moduleType:"component",name:"rangeselector",schema:{subplots:{xaxis:{rangeselector:d("./attributes")}}},layoutAttributes:d("./attributes"),handleDefaults:d("./defaults"),draw:d("./draw")}},{"./attributes":433,"./defaults":435,"./draw":436}],439:[function(d,ee,te){var w=d("../color/attributes");ee.exports={bgcolor:{valType:"color",dflt:w.background,editType:"plot"},bordercolor:{valType:"color",dflt:w.defaultLine,editType:"plot"},borderwidth:{valType:"integer",dflt:0,min:0,editType:"plot"},autorange:{valType:"boolean",dflt:!0,editType:"calc",impliedEdits:{"range[0]":void 0,"range[1]":void 0}},range:{valType:"info_array",items:[{valType:"any",editType:"calc",impliedEdits:{"^autorange":!1}},{valType:"any",editType:"calc",impliedEdits:{"^autorange":!1}}],editType:"calc",impliedEdits:{autorange:!1}},thickness:{valType:"number",dflt:.15,min:0,max:1,editType:"plot"},visible:{valType:"boolean",dflt:!0,editType:"calc"},editType:"calc"}},{"../color/attributes":366}],440:[function(d,ee,te){var w=d("../../plots/cartesian/axis_ids").list,v=d("../../plots/cartesian/autorange").getAutoRange,S=d("./constants");ee.exports=function(e){for(var a=w(e,"x",!0),n=0;n<a.length;n++){var r=a[n],t=r[S.name];t&&t.visible&&t.autorange&&(t._input.autorange=!0,t._input.range=t.range=v(e,r))}}},{"../../plots/cartesian/autorange":565,"../../plots/cartesian/axis_ids":570,"./constants":441}],441:[function(d,ee,te){ee.exports={name:"rangeslider",containerClassName:"rangeslider-container",bgClassName:"rangeslider-bg",rangePlotClassName:"rangeslider-rangeplot",maskMinClassName:"rangeslider-mask-min",maskMaxClassName:"rangeslider-mask-max",slideBoxClassName:"rangeslider-slidebox",grabberMinClassName:"rangeslider-grabber-min",grabAreaMinClassName:"rangeslider-grabarea-min",handleMinClassName:"rangeslider-handle-min",grabberMaxClassName:"rangeslider-grabber-max",grabAreaMaxClassName:"rangeslider-grabarea-max",handleMaxClassName:"rangeslider-handle-max",maskMinOppAxisClassName:"rangeslider-mask-min-opp-axis",maskMaxOppAxisClassName:"rangeslider-mask-max-opp-axis",maskColor:"rgba(0,0,0,0.4)",maskOppAxisColor:"rgba(0,0,0,0.2)",slideBoxFill:"transparent",slideBoxCursor:"ew-resize",grabAreaFill:"transparent",grabAreaCursor:"col-resize",grabAreaWidth:10,handleWidth:4,handleRadius:1,handleStrokeWidth:1,extraPad:15}},{}],442:[function(d,ee,te){var w=d("../../lib"),v=d("../../plot_api/plot_template"),S=d("../../plots/cartesian/axis_ids"),M=d("./attributes"),e=d("./oppaxis_attributes");ee.exports=function(n,r,t){var c=n[t],o=r[t];if(!(c.rangeslider||r._requestRangeslider[o._id]))return;w.isPlainObject(c.rangeslider)||(c.rangeslider={});var i=c.rangeslider,y=v.newContainer(o,"rangeslider");function p(T,k){return w.coerce(i,y,M,T,k)}var g,h;function m(T,k){return w.coerce(g,h,e,T,k)}var u=p("visible");if(!!u){p("bgcolor",r.plot_bgcolor),p("bordercolor"),p("borderwidth"),p("thickness"),p("autorange",!o.isValidRange(i.range)),p("range");var _=r._subplots;if(_)for(var s=_.cartesian.filter(function(T){return T.substr(0,T.indexOf("y"))===S.name2id(t)}).map(function(T){return T.substr(T.indexOf("y"),T.length)}),A=w.simpleMap(s,S.id2name),b=0;b<A.length;b++){var f=A[b];g=i[f]||{},h=v.newContainer(y,f,"yaxis");var x=r[f],l;g.range&&x.isValidRange(g.range)&&(l="fixed");var L=m("rangemode",l);L!=="match"&&m("range",x.range.slice())}y._input=i}}},{"../../lib":515,"../../plot_api/plot_template":555,"../../plots/cartesian/axis_ids":570,"./attributes":439,"./oppaxis_attributes":446}],443:[function(d,ee,te){var w=d("@plotly/d3"),v=d("../../registry"),S=d("../../plots/plots"),M=d("../../lib"),e=M.strTranslate,a=d("../drawing"),n=d("../color"),r=d("../titles"),t=d("../../plots/cartesian"),c=d("../../plots/cartesian/axis_ids"),o=d("../dragelement"),i=d("../../lib/setcursor"),y=d("./constants");ee.exports=function(x){for(var l=x._fullLayout,L=l._rangeSliderData,T=0;T<L.length;T++){var k=L[T][y.name];k._clipId=k._id+"-"+l._uid}function P(I){return I._name}var z=l._infolayer.selectAll("g."+y.containerClassName).data(L,P);z.exit().each(function(I){var D=I[y.name];l._topdefs.select("#"+D._clipId).remove()}).remove(),L.length!==0&&(z.enter().append("g").classed(y.containerClassName,!0).attr("pointer-events","all"),z.each(function(I){var D=w.select(this),R=I[y.name],B=l[c.id2name(I.anchor)],F=R[c.id2name(I.anchor)];if(R.range){var H=M.simpleMap(R.range,I.r2l),G=M.simpleMap(I.range,I.r2l),J;G[0]<G[1]?J=[Math.min(H[0],G[0]),Math.max(H[1],G[1])]:J=[Math.max(H[0],G[0]),Math.min(H[1],G[1])],R.range=R._input.range=M.simpleMap(J,I.l2r)}I.cleanRange("rangeslider.range");var X=l._size,Y=I.domain;R._width=X.w*(Y[1]-Y[0]);var Z=Math.round(X.l+X.w*Y[0]),oe=Math.round(X.t+X.h*(1-I._counterDomainMin)+(I.side==="bottom"?I._depth:0)+R._offsetShift+y.extraPad);D.attr("transform",e(Z,oe)),R._rl=M.simpleMap(R.range,I.r2l);var re=R._rl[0],se=R._rl[1],N=se-re;if(R.p2d=function(ye){return ye/R._width*N+re},R.d2p=function(ye){return(ye-re)/N*R._width},I.rangebreaks){var U=I.locateBreaks(re,se);if(U.length){var q,$,W=0;for(q=0;q<U.length;q++)$=U[q],W+=$.max-$.min;var K=R._width/(se-re-W),ne=[-K*re];for(q=0;q<U.length;q++)$=U[q],ne.push(ne[ne.length-1]-K*($.max-$.min));for(R.d2p=function(ye){for(var ue=ne[0],pe=0;pe<U.length;pe++){var ge=U[pe];if(ye>=ge.max)ue=ne[pe+1];else if(ye<ge.min)break}return ue+K*ye},q=0;q<U.length;q++)$=U[q],$.pmin=R.d2p($.min),$.pmax=R.d2p($.max);R.p2d=function(ye){for(var ue=ne[0],pe=0;pe<U.length;pe++){var ge=U[pe];if(ye>=ge.pmax)ue=ne[pe+1];else if(ye<ge.pmin)break}return(ye-ue)/K}}}if(F.rangemode!=="match"){var ae=B.r2l(F.range[0]),ie=B.r2l(F.range[1]),le=ie-ae;R.d2pOppAxis=function(ye){return(ye-ae)/le*R._height}}D.call(m,x,I,R).call(u,x,I,R).call(_,x,I,R).call(A,x,I,R,F).call(b,x,I,R).call(f,x,I,R),p(D,x,I,R),h(D,x,I,R,B,F),I.side==="bottom"&&r.draw(x,I._id+"title",{propContainer:I,propName:I._name+".title",placeholder:l._dfltTitle.x,attributes:{x:I._offset+I._length/2,y:oe+R._height+R._offsetShift+10+1.5*I.title.font.size,"text-anchor":"middle"}})}))};function p(x,l,L,T){if(l._context.staticPlot)return;var k=x.select("rect."+y.slideBoxClassName).node(),P=x.select("rect."+y.grabAreaMinClassName).node(),z=x.select("rect."+y.grabAreaMaxClassName).node();function I(){var D=w.event,R=D.target,B=D.clientX||D.touches[0].clientX,F=B-x.node().getBoundingClientRect().left,H=T.d2p(L._rl[0]),G=T.d2p(L._rl[1]),J=o.coverSlip();this.addEventListener("touchmove",X),this.addEventListener("touchend",Y),J.addEventListener("mousemove",X),J.addEventListener("mouseup",Y);function X(Z){var oe=Z.clientX||Z.touches[0].clientX,re=+oe-B,se,N,U;switch(R){case k:U="ew-resize",se=H+re,N=G+re;break;case P:U="col-resize",se=H+re,N=G;break;case z:U="col-resize",se=H,N=G+re;break;default:U="ew-resize",se=F,N=F+re;break}if(N<se){var q=N;N=se,se=q}T._pixelMin=se,T._pixelMax=N,i(w.select(J),U),g(x,l,L,T)}function Y(){J.removeEventListener("mousemove",X),J.removeEventListener("mouseup",Y),this.removeEventListener("touchmove",X),this.removeEventListener("touchend",Y),M.removeElement(J)}}x.on("mousedown",I),x.on("touchstart",I)}function g(x,l,L,T){function k(I){return L.l2r(M.constrain(I,T._rl[0],T._rl[1]))}var P=k(T.p2d(T._pixelMin)),z=k(T.p2d(T._pixelMax));window.requestAnimationFrame(function(){v.call("_guiRelayout",l,L._name+".range",[P,z])})}function h(x,l,L,T,k,P){var z=y.handleWidth/2;function I(Z){return M.constrain(Z,0,T._width)}function D(Z){return M.constrain(Z,0,T._height)}function R(Z){return M.constrain(Z,-z,T._width+z)}var B=I(T.d2p(L._rl[0])),F=I(T.d2p(L._rl[1]));if(x.select("rect."+y.slideBoxClassName).attr("x",B).attr("width",F-B),x.select("rect."+y.maskMinClassName).attr("width",B),x.select("rect."+y.maskMaxClassName).attr("x",F).attr("width",T._width-F),P.rangemode!=="match"){var H=T._height-D(T.d2pOppAxis(k._rl[1])),G=T._height-D(T.d2pOppAxis(k._rl[0]));x.select("rect."+y.maskMinOppAxisClassName).attr("x",B).attr("height",H).attr("width",F-B),x.select("rect."+y.maskMaxOppAxisClassName).attr("x",B).attr("y",G).attr("height",T._height-G).attr("width",F-B),x.select("rect."+y.slideBoxClassName).attr("y",H).attr("height",G-H)}var J=.5,X=Math.round(R(B-z))-J,Y=Math.round(R(F-z))+J;x.select("g."+y.grabberMinClassName).attr("transform",e(X,J)),x.select("g."+y.grabberMaxClassName).attr("transform",e(Y,J))}function m(x,l,L,T){var k=M.ensureSingle(x,"rect",y.bgClassName,function(D){D.attr({x:0,y:0,"shape-rendering":"crispEdges"})}),P=T.borderwidth%2===0?T.borderwidth:T.borderwidth-1,z=-T._offsetShift,I=a.crispRound(l,T.borderwidth);k.attr({width:T._width+P,height:T._height+P,transform:e(z,z),fill:T.bgcolor,stroke:T.bordercolor,"stroke-width":I})}function u(x,l,L,T){var k=l._fullLayout,P=M.ensureSingleById(k._topdefs,"clipPath",T._clipId,function(z){z.append("rect").attr({x:0,y:0})});P.select("rect").attr({width:T._width,height:T._height})}function _(x,l,L,T){var k=l.calcdata,P=x.selectAll("g."+y.rangePlotClassName).data(L._subplotsWith,M.identity);P.enter().append("g").attr("class",function(I){return y.rangePlotClassName+" "+I}).call(a.setClipUrl,T._clipId,l),P.order(),P.exit().remove();var z;P.each(function(I,D){var R=w.select(this),B=D===0,F=c.getFromId(l,I,"y"),H=F._name,G=T[H],J={data:[],layout:{xaxis:{type:L.type,domain:[0,1],range:T.range.slice(),calendar:L.calendar},width:T._width,height:T._height,margin:{t:0,b:0,l:0,r:0}},_context:l._context};L.rangebreaks&&(J.layout.xaxis.rangebreaks=L.rangebreaks),J.layout[H]={type:F.type,domain:[0,1],range:G.rangemode!=="match"?G.range.slice():F.range.slice(),calendar:F.calendar},F.rangebreaks&&(J.layout[H].rangebreaks=F.rangebreaks),S.supplyDefaults(J);var X=J._fullLayout.xaxis,Y=J._fullLayout[H];X.clearCalc(),X.setScale(),Y.clearCalc(),Y.setScale();var Z={id:I,plotgroup:R,xaxis:X,yaxis:Y,isRangePlot:!0};B?z=Z:(Z.mainplot="xy",Z.mainplotinfo=z),t.rangePlot(l,Z,s(k,I))})}function s(x,l){for(var L=[],T=0;T<x.length;T++){var k=x[T],P=k[0].trace;P.xaxis+P.yaxis===l&&L.push(k)}return L}function A(x,l,L,T,k){var P=M.ensureSingle(x,"rect",y.maskMinClassName,function(R){R.attr({x:0,y:0,"shape-rendering":"crispEdges"})});P.attr("height",T._height).call(n.fill,y.maskColor);var z=M.ensureSingle(x,"rect",y.maskMaxClassName,function(R){R.attr({y:0,"shape-rendering":"crispEdges"})});if(z.attr("height",T._height).call(n.fill,y.maskColor),k.rangemode!=="match"){var I=M.ensureSingle(x,"rect",y.maskMinOppAxisClassName,function(R){R.attr({y:0,"shape-rendering":"crispEdges"})});I.attr("width",T._width).call(n.fill,y.maskOppAxisColor);var D=M.ensureSingle(x,"rect",y.maskMaxOppAxisClassName,function(R){R.attr({y:0,"shape-rendering":"crispEdges"})});D.attr("width",T._width).style("border-top",y.maskOppBorder).call(n.fill,y.maskOppAxisColor)}}function b(x,l,L,T){if(!l._context.staticPlot){var k=M.ensureSingle(x,"rect",y.slideBoxClassName,function(P){P.attr({y:0,cursor:y.slideBoxCursor,"shape-rendering":"crispEdges"})});k.attr({height:T._height,fill:y.slideBoxFill})}}function f(x,l,L,T){var k=M.ensureSingle(x,"g",y.grabberMinClassName),P=M.ensureSingle(x,"g",y.grabberMaxClassName),z={x:0,width:y.handleWidth,rx:y.handleRadius,fill:n.background,stroke:n.defaultLine,"stroke-width":y.handleStrokeWidth,"shape-rendering":"crispEdges"},I={y:Math.round(T._height/4),height:Math.round(T._height/2)},D=M.ensureSingle(k,"rect",y.handleMinClassName,function(G){G.attr(z)});D.attr(I);var R=M.ensureSingle(P,"rect",y.handleMaxClassName,function(G){G.attr(z)});R.attr(I);var B={width:y.grabAreaWidth,x:0,y:0,fill:y.grabAreaFill,cursor:l._context.staticPlot?void 0:y.grabAreaCursor},F=M.ensureSingle(k,"rect",y.grabAreaMinClassName,function(G){G.attr(B)});F.attr("height",T._height);var H=M.ensureSingle(P,"rect",y.grabAreaMaxClassName,function(G){G.attr(B)});H.attr("height",T._height)}},{"../../lib":515,"../../lib/setcursor":536,"../../plots/cartesian":578,"../../plots/cartesian/axis_ids":570,"../../plots/plots":628,"../../registry":647,"../color":367,"../dragelement":386,"../drawing":389,"../titles":476,"./constants":441,"@plotly/d3":58}],444:[function(d,ee,te){var w=d("../../plots/cartesian/axis_ids"),v=d("../../lib/svg_text_utils"),S=d("./constants"),M=d("../../constants/alignment").LINE_SPACING,e=S.name;function a(n){var r=n&&n[e];return r&&r.visible}te.isVisible=a,te.makeData=function(n){var r=w.list({_fullLayout:n},"x",!0),t=n.margin,c=[];if(!n._has("gl2d"))for(var o=0;o<r.length;o++){var i=r[o];if(a(i)){c.push(i);var y=i[e];y._id=e+i._id,y._height=(n.height-t.b-t.t)*y.thickness,y._offsetShift=Math.floor(y.borderwidth/2)}}n._rangeSliderData=c},te.autoMarginOpts=function(n,r){var t=n._fullLayout,c=r[e],o=r._id.charAt(0),i=0,y=0;if(r.side==="bottom"&&(i=r._depth,r.title.text!==t._dfltTitle[o])){y=1.5*r.title.font.size+10+c._offsetShift;var p=(r.title.text.match(v.BR_TAG_ALL)||[]).length;y+=p*r.title.font.size*M}return{x:0,y:r._counterDomainMin,l:0,r:0,t:0,b:c._height+i+Math.max(t.margin.b,y),pad:S.extraPad+c._offsetShift*2}}},{"../../constants/alignment":483,"../../lib/svg_text_utils":541,"../../plots/cartesian/axis_ids":570,"./constants":441}],445:[function(d,ee,te){var w=d("../../lib"),v=d("./attributes"),S=d("./oppaxis_attributes"),M=d("./helpers");ee.exports={moduleType:"component",name:"rangeslider",schema:{subplots:{xaxis:{rangeslider:w.extendFlat({},v,{yaxis:S})}}},layoutAttributes:d("./attributes"),handleDefaults:d("./defaults"),calcAutorange:d("./calc_autorange"),draw:d("./draw"),isVisible:M.isVisible,makeData:M.makeData,autoMarginOpts:M.autoMarginOpts}},{"../../lib":515,"./attributes":439,"./calc_autorange":440,"./defaults":442,"./draw":443,"./helpers":444,"./oppaxis_attributes":446}],446:[function(d,ee,te){ee.exports={_isSubplotObj:!0,rangemode:{valType:"enumerated",values:["auto","fixed","match"],dflt:"match",editType:"calc"},range:{valType:"info_array",items:[{valType:"any",editType:"plot"},{valType:"any",editType:"plot"}],editType:"plot"},editType:"calc"}},{}],447:[function(d,ee,te){var w=d("../annotations/attributes"),v=d("../../traces/scatter/attributes").line,S=d("../drawing/attributes").dash,M=d("../../lib/extend").extendFlat,e=d("../../plot_api/edit_types").overrideAll,a=d("../../plot_api/plot_template").templatedArray;d("../../constants/axis_placeable_objects"),ee.exports=e(a("selection",{type:{valType:"enumerated",values:["rect","path"]},xref:M({},w.xref,{}),yref:M({},w.yref,{}),x0:{valType:"any"},x1:{valType:"any"},y0:{valType:"any"},y1:{valType:"any"},path:{valType:"string",editType:"arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:.7,editType:"arraydraw"},line:{color:v.color,width:M({},v.width,{min:1,dflt:1}),dash:M({},S,{dflt:"dot"})}}),"arraydraw","from-root")},{"../../constants/axis_placeable_objects":484,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plot_api/plot_template":555,"../../traces/scatter/attributes":936,"../annotations/attributes":350,"../drawing/attributes":388}],448:[function(d,ee,te){ee.exports={BENDPX:1.5,MINSELECT:12,SELECTDELAY:100,SELECTID:"-select"}},{}],449:[function(d,ee,te){var w=d("../../lib"),v=d("../../plots/cartesian/axes"),S=d("../../plots/array_container_defaults"),M=d("./attributes"),e=d("../shapes/helpers");ee.exports=function(r,t){S(r,t,{name:"selections",handleItemDefaults:a});for(var c=t.selections,o=0;o<c.length;o++){var i=c[o];!i||i.path===void 0&&(i.x0===void 0||i.x1===void 0||i.y0===void 0||i.y1===void 0)&&(t.selections[o]=null)}};function a(n,r,t){function c(P,z){return w.coerce(n,r,M,P,z)}var o=c("path"),i=o?"path":"rect",y=c("type",i),p=y!=="path";p&&delete r.path,c("opacity"),c("line.color"),c("line.width"),c("line.dash");for(var g=["x","y"],h=0;h<2;h++){var m=g[h],u={_fullLayout:t},_,s,A,b=v.coerceRef(n,r,u,m);if(_=v.getFromId(u,b),_._selectionIndices.push(r._index),A=e.rangeToShapePosition(_),s=e.shapePositionToRange(_),p){var f=m+"0",x=m+"1",l=n[f],L=n[x];n[f]=s(n[f],!0),n[x]=s(n[x],!0),v.coercePosition(r,u,c,b,f),v.coercePosition(r,u,c,b,x);var T=r[f],k=r[x];T!==void 0&&k!==void 0&&(r[f]=A(T),r[x]=A(k),n[f]=l,n[x]=L)}}p&&w.noneOrAll(n,r,["x0","x1","y0","y1"])}},{"../../lib":515,"../../plots/array_container_defaults":561,"../../plots/cartesian/axes":566,"../shapes/helpers":469,"./attributes":447}],450:[function(d,ee,te){var w=d("../shapes/draw_newshape/helpers").readPaths,v=d("../shapes/display_outlines"),S=d("../shapes/handle_outline").clearOutlineControllers,M=d("../color"),e=d("../drawing"),a=d("../../plot_api/plot_template").arrayEditor,n=d("../shapes/helpers"),r=n.getPathString;ee.exports={draw:t,drawOne:c,activateLastSelection:y};function t(g){var h=g._fullLayout;S(g),h._selectionLayer.selectAll("path").remove();for(var m in h._plots){var u=h._plots[m].selectionLayer;u&&u.selectAll("path").remove()}for(var _=0;_<h.selections.length;_++)c(g,_)}function c(g,h){g._fullLayout._paperdiv.selectAll('.selectionlayer [data-index="'+h+'"]').remove();var m=n.makeSelectionsOptionsAndPlotinfo(g,h),u=m.options,_=m.plotinfo;if(!u._input)return;s(g._fullLayout._selectionLayer);function s(A){var b=r(g,u),f={"data-index":h,"fill-rule":"evenodd",d:b},x=u.opacity,l="rgba(0,0,0,0)",L=u.line.color||M.contrast(g._fullLayout.plot_bgcolor),T=u.line.width,k=u.line.dash;T||(T=5,k="solid");var P=g._fullLayout._activeSelectionIndex===h;P&&(l=g._fullLayout.activeselection.fillcolor,x=g._fullLayout.activeselection.opacity);for(var z=[],I=1;I>=0;I--){var D=A.append("path").attr(f).style("opacity",I?.1:x).call(M.stroke,L).call(M.fill,l).call(e.dashLine,I?"solid":k,I?4+T:T);if(o(D,g,u),P){var R=a(g.layout,"selections",u);D.style({cursor:"move"});var B={element:D.node(),plotinfo:_,gd:g,editHelpers:R,isActiveSelection:!0},F=w(b,g);v(F,D,B)}else D.style("pointer-events",I?"all":"none");z[I]=D}var H=z[0],G=z[1];G.node().addEventListener("click",function(){return i(g,H)})}}function o(g,h,m){var u=m.xref+m.yref;e.setClipUrl(g,"clip"+h._fullLayout._uid+u,h)}function i(g,h){var m=h.node(),u=+m.getAttribute("data-index");if(u>=0){if(u===g._fullLayout._activeSelectionIndex){p(g);return}g._fullLayout._activeSelectionIndex=u,g._fullLayout._deactivateSelection=p,t(g)}}function y(g){var h=g._fullLayout.selections.length-1;g._fullLayout._activeSelectionIndex=h,g._fullLayout._deactivateSelection=p,t(g)}function p(g){var h=g._fullLayout._activeSelectionIndex;h>=0&&(S(g),delete g._fullLayout._activeSelectionIndex,t(g))}},{"../../plot_api/plot_template":555,"../color":367,"../drawing":389,"../shapes/display_outlines":461,"../shapes/draw_newshape/helpers":466,"../shapes/handle_outline":468,"../shapes/helpers":469}],451:[function(d,ee,te){var w=d("../../drawing/attributes").dash,v=d("../../../lib/extend").extendFlat;ee.exports={newselection:{mode:{valType:"enumerated",values:["immediate","gradual"],dflt:"immediate",editType:"none"},line:{color:{valType:"color",editType:"none"},width:{valType:"number",min:1,dflt:1,editType:"none"},dash:v({},w,{dflt:"dot",editType:"none"}),editType:"none"},editType:"none"},activeselection:{fillcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"none"},opacity:{valType:"number",min:0,max:1,dflt:.5,editType:"none"},editType:"none"}}},{"../../../lib/extend":505,"../../drawing/attributes":388}],452:[function(d,ee,te){ee.exports=function(v,S,M){M("newselection.mode");var e=M("newselection.line.width");e&&(M("newselection.line.color"),M("newselection.line.dash")),M("activeselection.fillcolor"),M("activeselection.opacity")}},{}],453:[function(d,ee,te){var w=d("../../dragelement/helpers"),v=w.selectMode,S=d("../../shapes/handle_outline"),M=S.clearOutline,e=d("../../shapes/draw_newshape/helpers"),a=e.readPaths,n=e.writePaths,r=e.fixDatesForPaths;ee.exports=function(c,o){if(!!c.length){var i=c[0][0];if(!!i){var y=i.getAttribute("d"),p=o.gd,g=p._fullLayout.newselection,h=o.plotinfo,m=h.xaxis,u=h.yaxis,_=o.isActiveSelection,s=o.dragmode,A=(p.layout||{}).selections||[];if(!v(s)&&_!==void 0){var b=p._fullLayout._activeSelectionIndex;if(b<A.length)switch(p._fullLayout.selections[b].type){case"rect":s="select";break;case"path":s="lasso";break}}var f=a(y,p,h,_),x={xref:m._id,yref:u._id,opacity:g.opacity,line:{color:g.line.color,width:g.line.width,dash:g.line.dash}},l;f.length===1&&(l=f[0]),l&&l.length===5&&s==="select"?(x.type="rect",x.x0=l[0][1],x.y0=l[0][2],x.x1=l[2][1],x.y1=l[2][2]):(x.type="path",m&&u&&r(f,m,u),x.path=n(f),l=null),M(p);for(var L=o.editHelpers,T=(L||{}).modifyItem,k=[],P=0;P<A.length;P++){var z=p._fullLayout.selections[P];if(!z){k[P]=z;continue}if(k[P]=z._input,_!==void 0&&P===p._fullLayout._activeSelectionIndex){var I=x;switch(z.type){case"rect":T("x0",I.x0),T("x1",I.x1),T("y0",I.y0),T("y1",I.y1);break;case"path":T("path",I.path);break}}}return _===void 0?(k.push(x),k):L?L.getUpdateObj():{}}}}},{"../../dragelement/helpers":385,"../../shapes/draw_newshape/helpers":466,"../../shapes/handle_outline":468}],454:[function(d,ee,te){var w=d("../../lib").strTranslate;function v(a,n){switch(a.type){case"log":return a.p2d(n);case"date":return a.p2r(n,0,a.calendar);default:return a.p2r(n)}}function S(a,n){switch(a.type){case"log":return a.d2p(n);case"date":return a.r2p(n,0,a.calendar);default:return a.r2p(n)}}function M(a){var n=a._id.charAt(0)==="y"?1:0;return function(r){return v(a,r[n])}}function e(a){return w(a.xaxis._offset,a.yaxis._offset)}ee.exports={p2r:v,r2p:S,axValue:M,getTransform:e}},{"../../lib":515}],455:[function(d,ee,te){var w=d("./draw"),v=d("./select");ee.exports={moduleType:"component",name:"selections",layoutAttributes:d("./attributes"),supplyLayoutDefaults:d("./defaults"),supplyDrawNewSelectionDefaults:d("./draw_newselection/defaults"),includeBasePlot:d("../../plots/cartesian/include_components")("selections"),draw:w.draw,drawOne:w.drawOne,reselect:v.reselect,prepSelect:v.prepSelect,clearOutline:v.clearOutline,clearSelectionsCache:v.clearSelectionsCache,selectOnClick:v.selectOnClick}},{"../../plots/cartesian/include_components":577,"./attributes":447,"./defaults":449,"./draw":450,"./draw_newselection/defaults":452,"./select":456}],456:[function(d,ee,te){var w=d("polybooljs"),v=d("point-in-polygon/nested"),S=d("../../registry"),M=d("../drawing").dashStyle,e=d("../color"),a=d("../fx"),n=d("../fx/helpers").makeEventData,r=d("../dragelement/helpers"),t=r.freeMode,c=r.rectMode,o=r.drawMode,i=r.openMode,y=r.selectMode,p=d("../shapes/helpers"),g=d("../shapes/constants"),h=d("../shapes/display_outlines"),m=d("../shapes/handle_outline").clearOutline,u=d("../shapes/draw_newshape/helpers"),_=u.handleEllipse,s=u.readPaths,A=d("../shapes/draw_newshape/newshapes"),b=d("./draw_newselection/newselections"),f=d("./draw").activateLastSelection,x=d("../../lib"),l=x.sorterAsc,L=d("../../lib/polygon"),T=d("../../lib/throttle"),k=d("../../plots/cartesian/axis_ids").getFromId,P=d("../../lib/clear_gl_canvases"),z=d("../../plot_api/subroutines").redrawReglTraces,I=d("./constants"),D=I.MINSELECT,R=L.filter,B=L.tester,F=d("./helpers"),H=F.p2r,G=F.axValue,J=F.getTransform;function X(Ue){return Ue.subplot!==void 0}function Y(Ue,qe,Ve,Ae,Ne){var Xe=!X(Ae),Je=t(Ne),_t=c(Ne),mt=i(Ne),Ot=o(Ne),Kt=y(Ne),Nt=Ne==="drawline",Wt=Ne==="drawcircle",qt=Nt||Wt,Yt=Ae.gd,fr=Yt._fullLayout,Yr=Kt&&fr.newselection.mode==="immediate"&&Xe,hn=fr._zoomlayer,Qr=Ae.element.getBoundingClientRect(),at=Ae.plotinfo,Jt=J(at),Zt=qe-Qr.left,Ut=Ve-Qr.top;fr._calcInverseTransform(Yt);var _r=x.apply3DTransform(fr._invTransform)(Zt,Ut);Zt=_r[0],Ut=_r[1];var rt=fr._invScaleX,Ke=fr._invScaleY,st=Zt,lt=Ut,wt="M"+Zt+","+Ut,Pt=Ae.xaxes[0],ke=Ae.yaxes[0],Se=Pt._length,nt=ke._length,it=Ue.altKey&&!(o(Ne)&&mt),ct,At,dt,Tt,Ht,ir,kr;U(Ue,Yt,Ae),Je&&(ct=R([[Zt,Ut]],I.BENDPX));var br=hn.selectAll("path.select-outline-"+at.id).data([1]),Mr=Ot?fr.newshape:fr.newselection;br.enter().append("path").attr("class","select-outline select-outline-"+at.id).style({opacity:Ot?Mr.opacity/2:1,fill:Ot&&!mt?Mr.fillcolor:"none",stroke:Mr.line.color||(Xe?e.contrast(Yt._fullLayout.plot_bgcolor):"#7f7f7f"),"stroke-dasharray":M(Mr.line.dash,Mr.line.width),"stroke-width":Mr.line.width+"px","shape-rendering":"crispEdges"}).attr("fill-rule","evenodd").classed("cursor-move",!!Ot).attr("transform",Jt).attr("d",wt+"Z");var Hr=hn.append("path").attr("class","zoombox-corners").style({fill:e.background,stroke:e.defaultLine,"stroke-width":1}).attr("transform",Jt).attr("d","M0,0Z"),nr=fr._uid+I.SELECTID,mr=[],Pr=ne(Yt,Ae.xaxes,Ae.yaxes,Ae.subplot);Yr&&!Ue.shiftKey&&(Ae._clearSubplotSelections=function(){if(!!Xe){var Sr=Pt._id,tt=ke._id;Qe(Yt,Sr,tt,Pr);for(var Et=(Yt.layout||{}).selections||[],Vt=[],ar=!1,Cr=0;Cr<Et.length;Cr++){var Or=fr.selections[Cr];Or.xref!==Sr||Or.yref!==tt?Vt.push(Et[Cr]):ar=!0}ar&&(Yt._fullLayout._noEmitSelectedAtStart=!0,S.call("_guiRelayout",Yt,{selections:Vt}))}});var Nr=Ft(Ae);Ae.moveFn=function(Sr,tt){Ae._clearSubplotSelections&&(Ae._clearSubplotSelections(),Ae._clearSubplotSelections=void 0),st=Math.max(0,Math.min(Se,rt*Sr+Zt)),lt=Math.max(0,Math.min(nt,Ke*tt+Ut));var Et=Math.abs(st-Zt),Vt=Math.abs(lt-Ut);if(_t){var ar,Cr,Or;if(Kt){var Ir=fr.selectdirection;switch(Ir==="any"?Vt<Math.min(Et*.6,D)?ar="h":Et<Math.min(Vt*.6,D)?ar="v":ar="d":ar=Ir,ar){case"h":Cr=Wt?nt/2:0,Or=nt;break;case"v":Cr=Wt?Se/2:0,Or=Se;break}}if(Ot)switch(fr.newshape.drawdirection){case"vertical":ar="h",Cr=Wt?nt/2:0,Or=nt;break;case"horizontal":ar="v",Cr=Wt?Se/2:0,Or=Se;break;case"ortho":Et<Vt?(ar="h",Cr=Ut,Or=lt):(ar="v",Cr=Zt,Or=st);break;default:ar="d"}ar==="h"?(Tt=qt?_(Wt,[st,Cr],[st,Or]):[[Zt,Cr],[Zt,Or],[st,Or],[st,Cr]],Tt.xmin=qt?st:Math.min(Zt,st),Tt.xmax=qt?st:Math.max(Zt,st),Tt.ymin=Math.min(Cr,Or),Tt.ymax=Math.max(Cr,Or),Hr.attr("d","M"+Tt.xmin+","+(Ut-D)+"h-4v"+2*D+"h4ZM"+(Tt.xmax-1)+","+(Ut-D)+"h4v"+2*D+"h-4Z")):ar==="v"?(Tt=qt?_(Wt,[Cr,lt],[Or,lt]):[[Cr,Ut],[Cr,lt],[Or,lt],[Or,Ut]],Tt.xmin=Math.min(Cr,Or),Tt.xmax=Math.max(Cr,Or),Tt.ymin=qt?lt:Math.min(Ut,lt),Tt.ymax=qt?lt:Math.max(Ut,lt),Hr.attr("d","M"+(Zt-D)+","+Tt.ymin+"v-4h"+2*D+"v4ZM"+(Zt-D)+","+(Tt.ymax-1)+"v4h"+2*D+"v-4Z")):ar==="d"&&(Tt=qt?_(Wt,[Zt,Ut],[st,lt]):[[Zt,Ut],[Zt,lt],[st,lt],[st,Ut]],Tt.xmin=Math.min(Zt,st),Tt.xmax=Math.max(Zt,st),Tt.ymin=Math.min(Ut,lt),Tt.ymax=Math.max(Ut,lt),Hr.attr("d","M0,0Z"))}else Je&&(ct.addPt([st,lt]),Tt=ct.filtered);if(Ae.selectionDefs&&Ae.selectionDefs.length?(dt=_e(Ae.mergedPolygons,Tt,it),Tt.subtract=it,At=N(Ae.selectionDefs.concat([Tt]))):(dt=[Tt],At=B(Tt)),h(Oe(dt,mt),br,Ae),Kt){var Tr=be(Yt,!1),Wr=Tr.eventData?Tr.eventData.points.slice():[];Tr=be(Yt,!1,At,Pr,Ae),At=Tr.selectionTesters,kr=Tr.eventData;var wn;ct?wn=ct.filtered:wn=Rt(dt),T.throttle(nr,I.SELECTDELAY,function(){mr=Ye(At,Pr);for(var ln=mr.slice(),Bn=0;Bn<Wr.length;Bn++){for(var Cn=Wr[Bn],Wn=!1,Hn=0;Hn<ln.length;Hn++)if(ln[Hn].curveNumber===Cn.curveNumber&&ln[Hn].pointNumber===Cn.pointNumber){Wn=!0;break}Wn||ln.push(Cn)}ln.length&&(kr||(kr={}),kr.points=ln),Nr(kr,wn),Gt(Yt,kr)})}},Ae.clickFn=function(Sr,tt){if(Hr.remove(),Yt._fullLayout._activeShapeIndex>=0){Yt._fullLayout._deactivateShape(Yt);return}if(!Ot){var Et=fr.clickmode;T.done(nr).then(function(){if(T.clear(nr),Sr===2){for(br.remove(),Ht=0;Ht<Pr.length;Ht++)ir=Pr[Ht],ir._module.selectPoints(ir,!1);if(ge(Yt,Pr),W(Ae),kt(Yt),Pr.length){var Vt=Pr[0].xaxis,ar=Pr[0].yaxis;if(Vt&&ar){for(var Cr=[],Or=Yt._fullLayout.selections,Ir=0;Ir<Or.length;Ir++){var Tr=Or[Ir];!Tr||(Tr.xref!==Vt._id||Tr.yref!==ar._id)&&Cr.push(Tr)}Cr.length<Or.length&&(Yt._fullLayout._noEmitSelectedAtStart=!0,S.call("_guiRelayout",Yt,{selections:Cr}))}}}else Et.indexOf("select")>-1&&Z(tt,Yt,Ae.xaxes,Ae.yaxes,Ae.subplot,Ae,br),Et==="event"&&Dt(Yt,void 0);a.click(Yt,tt)}).catch(x.error)}},Ae.doneFn=function(){Hr.remove(),T.done(nr).then(function(){T.clear(nr),!Yr&&Tt&&Ae.selectionDefs&&(Tt.subtract=it,Ae.selectionDefs.push(Tt),Ae.mergedPolygons.length=0,[].push.apply(Ae.mergedPolygons,dt)),(Yr||Ot)&&W(Ae,Yr),Ae.doneFnCompleted&&Ae.doneFnCompleted(mr),Kt&&Dt(Yt,kr)}).catch(x.error)}}function Z(Ue,qe,Ve,Ae,Ne,Xe,Je){var _t=qe._hoverdata,mt=qe._fullLayout,Ot=mt.clickmode,Kt=Ot.indexOf("event")>-1,Nt=[],Wt,qt,Yt,fr,Yr,hn,Qr,at,Jt,Zt;if(ie(_t)){U(Ue,qe,Xe),Wt=ne(qe,Ve,Ae,Ne);var Ut=le(_t,Wt),_r=Ut.pointNumbers.length>0;if(_r?ue(Wt,Ut):pe(Wt)&&(Qr=ye(Ut))){for(Je&&Je.remove(),Zt=0;Zt<Wt.length;Zt++)qt=Wt[Zt],qt._module.selectPoints(qt,!1);ge(qe,Wt),W(Xe),Kt&&kt(qe)}else{at=Ue.shiftKey&&(Qr!==void 0?Qr:ye(Ut)),Yt=oe(Ut.pointNumber,Ut.searchInfo,at);var rt=Xe.selectionDefs.concat([Yt]);for(fr=N(rt),Zt=0;Zt<Wt.length;Zt++)if(Yr=Wt[Zt]._module.selectPoints(Wt[Zt],fr),hn=ze(Yr,Wt[Zt]),Nt.length)for(var Ke=0;Ke<hn.length;Ke++)Nt.push(hn[Ke]);else Nt=hn;if(Jt={points:Nt},ge(qe,Wt,Jt),Yt&&Xe&&Xe.selectionDefs.push(Yt),Je){var st=Xe.mergedPolygons,lt=i(Xe.dragmode);h(Oe(st,lt),Je,Xe)}Kt&&Dt(qe,Jt)}}}function oe(Ue,qe,Ve){return{pointNumber:Ue,searchInfo:qe,subtract:!!Ve}}function re(Ue){return"pointNumber"in Ue&&"searchInfo"in Ue}function se(Ue){return{xmin:0,xmax:0,ymin:0,ymax:0,pts:[],contains:function(qe,Ve,Ae,Ne){var Xe=Ue.searchInfo.cd[0].trace._expandedIndex,Je=Ne.cd[0].trace._expandedIndex;return Je===Xe&&Ae===Ue.pointNumber},isRect:!1,degenerate:!1,subtract:!!Ue.subtract}}function N(Ue){if(!Ue.length)return;for(var qe=[],Ve=re(Ue[0])?0:Ue[0][0][0],Ae=Ve,Ne=re(Ue[0])?0:Ue[0][0][1],Xe=Ne,Je=0;Je<Ue.length;Je++)if(re(Ue[Je]))qe.push(se(Ue[Je]));else{var _t=B(Ue[Je]);_t.subtract=!!Ue[Je].subtract,qe.push(_t),Ve=Math.min(Ve,_t.xmin),Ae=Math.max(Ae,_t.xmax),Ne=Math.min(Ne,_t.ymin),Xe=Math.max(Xe,_t.ymax)}function mt(Ot,Kt,Nt,Wt){for(var qt=!1,Yt=0;Yt<qe.length;Yt++)qe[Yt].contains(Ot,Kt,Nt,Wt)&&(qt=!qe[Yt].subtract);return qt}return{xmin:Ve,xmax:Ae,ymin:Ne,ymax:Xe,pts:[],contains:mt,isRect:!1,degenerate:!1}}function U(Ue,qe,Ve){var Ae=qe._fullLayout,Ne=Ve.plotinfo,Xe=Ve.dragmode,Je=Ae._lastSelectedSubplot&&Ae._lastSelectedSubplot===Ne.id,_t=(Ue.shiftKey||Ue.altKey)&&!(o(Xe)&&i(Xe));Je&&_t&&Ne.selection&&Ne.selection.selectionDefs&&!Ve.selectionDefs?(Ve.selectionDefs=Ne.selection.selectionDefs,Ve.mergedPolygons=Ne.selection.mergedPolygons):(!_t||!Ne.selection)&&W(Ve),Je||(m(qe),Ae._lastSelectedSubplot=Ne.id)}function q(Ue){return Ue._fullLayout._activeShapeIndex>=0}function $(Ue){return Ue._fullLayout._activeSelectionIndex>=0}function W(Ue,qe){var Ve=Ue.dragmode,Ae=Ue.plotinfo,Ne=Ue.gd;q(Ne)&&Ne._fullLayout._deactivateShape(Ne),$(Ne)&&Ne._fullLayout._deactivateSelection(Ne);var Xe=Ne._fullLayout,Je=Xe._zoomlayer,_t=o(Ve),mt=y(Ve);if(_t||mt){var Ot=Je.selectAll(".select-outline-"+Ae.id);if(Ot&&Ne._fullLayout._outlining){var Kt;_t&&(Kt=A(Ot,Ue)),Kt&&S.call("_guiRelayout",Ne,{shapes:Kt});var Nt;mt&&!X(Ue)&&(Nt=b(Ot,Ue)),Nt&&(Ne._fullLayout._noEmitSelectedAtStart=!0,S.call("_guiRelayout",Ne,{selections:Nt}).then(function(){qe&&f(Ne)})),Ne._fullLayout._outlining=!1}}Ae.selection={},Ae.selection.selectionDefs=Ue.selectionDefs=[],Ae.selection.mergedPolygons=Ue.mergedPolygons=[]}function K(Ue){return Ue._id}function ne(Ue,qe,Ve,Ae){if(!Ue.calcdata)return[];var Ne=[],Xe=qe.map(K),Je=Ve.map(K),_t,mt,Ot;for(Ot=0;Ot<Ue.calcdata.length;Ot++)if(_t=Ue.calcdata[Ot],mt=_t[0].trace,!(mt.visible!==!0||!mt._module||!mt._module.selectPoints))if(X({subplot:Ae})&&(mt.subplot===Ae||mt.geo===Ae))Ne.push(ae(mt._module,_t,qe[0],Ve[0]));else if(mt.type==="splom"){if(mt._xaxes[Xe[0]]&&mt._yaxes[Je[0]]){var Kt=ae(mt._module,_t,qe[0],Ve[0]);Kt.scene=Ue._fullLayout._splomScenes[mt.uid],Ne.push(Kt)}}else if(mt.type==="sankey"){var Nt=ae(mt._module,_t,qe[0],Ve[0]);Ne.push(Nt)}else{if(Xe.indexOf(mt.xaxis)===-1||Je.indexOf(mt.yaxis)===-1)continue;Ne.push(ae(mt._module,_t,k(Ue,mt.xaxis),k(Ue,mt.yaxis)))}return Ne}function ae(Ue,qe,Ve,Ae){return{_module:Ue,cd:qe,xaxis:Ve,yaxis:Ae}}function ie(Ue){return Ue&&Array.isArray(Ue)&&Ue[0].hoverOnBox!==!0}function le(Ue,qe){var Ve=Ue[0],Ae=-1,Ne=[],Xe,Je;for(Je=0;Je<qe.length;Je++)if(Xe=qe[Je],Ve.fullData._expandedIndex===Xe.cd[0].trace._expandedIndex){if(Ve.hoverOnBox===!0)break;Ve.pointNumber!==void 0?Ae=Ve.pointNumber:Ve.binNumber!==void 0&&(Ae=Ve.binNumber,Ne=Ve.pointNumbers);break}return{pointNumber:Ae,pointNumbers:Ne,searchInfo:Xe}}function ye(Ue){var qe=Ue.searchInfo.cd[0].trace,Ve=Ue.pointNumber,Ae=Ue.pointNumbers,Ne=Ae.length>0,Xe=Ne?Ae[0]:Ve;return qe.selectedpoints?qe.selectedpoints.indexOf(Xe)>-1:!1}function ue(Ue,qe){var Ve=[],Ae,Ne,Xe,Je;for(Je=0;Je<Ue.length;Je++)Ae=Ue[Je],Ae.cd[0].trace.selectedpoints&&Ae.cd[0].trace.selectedpoints.length>0&&Ve.push(Ae);if(Ve.length===1&&(Xe=Ve[0]===qe.searchInfo,Xe&&(Ne=qe.searchInfo.cd[0].trace,Ne.selectedpoints.length===qe.pointNumbers.length))){for(Je=0;Je<qe.pointNumbers.length;Je++)if(Ne.selectedpoints.indexOf(qe.pointNumbers[Je])<0)return!1;return!0}return!1}function pe(Ue){var qe=0,Ve,Ae,Ne;for(Ne=0;Ne<Ue.length;Ne++)if(Ve=Ue[Ne],Ae=Ve.cd[0].trace,Ae.selectedpoints&&(Ae.selectedpoints.length>1||(qe+=Ae.selectedpoints.length,qe>1)))return!1;return qe===1}function ge(Ue,qe,Ve){var Ae;for(Ae=0;Ae<qe.length;Ae++){var Ne=qe[Ae].cd[0].trace._fullInput,Xe=Ue._fullLayout._tracePreGUI[Ne.uid]||{};Xe.selectedpoints===void 0&&(Xe.selectedpoints=Ne._input.selectedpoints||null)}var Je;if(Ve){var _t=Ve.points||[];for(Ae=0;Ae<qe.length;Ae++)Je=qe[Ae].cd[0].trace,Je._input.selectedpoints=Je._fullInput.selectedpoints=[],Je._fullInput!==Je&&(Je.selectedpoints=[]);for(var mt=0;mt<_t.length;mt++){var Ot=_t[mt],Kt=Ot.data,Nt=Ot.fullData,Wt=Ot.pointIndex,qt=Ot.pointIndices;qt?([].push.apply(Kt.selectedpoints,qt),Je._fullInput!==Je&&[].push.apply(Nt.selectedpoints,qt)):(Kt.selectedpoints.push(Wt),Je._fullInput!==Je&&Nt.selectedpoints.push(Wt))}}else for(Ae=0;Ae<qe.length;Ae++)Je=qe[Ae].cd[0].trace,delete Je.selectedpoints,delete Je._input.selectedpoints,Je._fullInput!==Je&&delete Je._fullInput.selectedpoints;Te(Ue,qe)}function Te(Ue,qe){for(var Ve=!1,Ae=0;Ae<qe.length;Ae++){var Ne=qe[Ae],Xe=Ne.cd;S.traceIs(Xe[0].trace,"regl")&&(Ve=!0);var Je=Ne._module,_t=Je.styleOnSelect||Je.style;_t&&(_t(Ue,Xe,Xe[0].node3),Xe[0].nodeRangePlot3&&_t(Ue,Xe,Xe[0].nodeRangePlot3))}Ve&&(P(Ue),z(Ue))}function _e(Ue,qe,Ve){for(var Ae=Ve?w.difference:w.union,Ne=Ae({regions:Ue},{regions:[qe]}),Xe=Ne.regions.reverse(),Je=0;Je<Xe.length;Je++){var _t=Xe[Je];_t.subtract=He(_t,Xe.slice(0,Je))}return Xe}function ze(Ue,qe){if(Array.isArray(Ue))for(var Ve=qe.cd,Ae=qe.cd[0].trace,Ne=0;Ne<Ue.length;Ne++)Ue[Ne]=n(Ue[Ne],Ae,Ve);return Ue}function Oe(Ue,qe){for(var Ve=[],Ae=0;Ae<Ue.length;Ae++){Ve[Ae]=[];for(var Ne=0;Ne<Ue[Ae].length;Ne++){Ve[Ae][Ne]=[],Ve[Ae][Ne][0]=Ne?"L":"M";for(var Xe=0;Xe<Ue[Ae][Ne].length;Xe++)Ve[Ae][Ne].push(Ue[Ae][Ne][Xe])}qe||Ve[Ae].push(["Z",Ve[Ae][0][1],Ve[Ae][0][2]])}return Ve}function Ye(Ue,qe){for(var Ve=[],Ae,Ne,Xe=0;Xe<qe.length;Xe++){var Je=qe[Xe];Ne=Je._module.selectPoints(Je,Ue),Ae=ze(Ne,Je),Ve=Ve.concat(Ae)}return Ve}function be(Ue,qe,Ve,Ae,Ne){var Xe=!!Ae,Je,_t,mt;Ne&&(Je=Ne.plotinfo,_t=Ne.xaxes[0]._id,mt=Ne.yaxes[0]._id);var Ot=[],Kt=[],Nt=Le(Ue),Wt=Ue._fullLayout;if(Je){var qt=Wt._zoomlayer,Yt=Wt.dragmode,fr=o(Yt),Yr=y(Yt);if(fr||Yr){var hn=k(Ue,_t,"x"),Qr=k(Ue,mt,"y");if(hn&&Qr){var at=qt.selectAll(".select-outline-"+Je.id);if(at&&Ue._fullLayout._outlining&&at.length){for(var Jt=at[0][0],Zt=Jt.getAttribute("d"),Ut=s(Zt,Ue,Je),_r=[],rt=0;rt<Ut.length;rt++){for(var Ke=Ut[rt],st=[],lt=0;lt<Ke.length;lt++)st.push([vt(hn,Ke[lt][1]),vt(Qr,Ke[lt][2])]);st.xref=_t,st.yref=mt,st.subtract=He(st,_r),_r.push(st)}Nt=Nt.concat(_r)}}}}var wt=_t&&mt?[_t+mt]:Wt._subplots.cartesian;Pe(Ue);for(var Pt={},ke=0;ke<wt.length;ke++){var Se=wt[ke],nt=Se.indexOf("y"),it=Se.slice(0,nt),ct=Se.slice(nt),At=_t&&mt?Ve:void 0;if(At=Be(Nt,it,ct,At),At){var dt=Ae;if(!Xe){var Tt=k(Ue,it,"x"),Ht=k(Ue,ct,"y");dt=ne(Ue,[Tt],[Ht],Se);for(var ir=0;ir<dt.length;ir++){var kr=dt[ir],br=kr.cd[0],Mr=br.trace;if(kr._module.name==="scattergl"&&!br.t.xpx){var Hr=Mr.x,nr=Mr.y,mr=Mr._length;br.t.xpx=[],br.t.ypx=[];for(var Pr=0;Pr<mr;Pr++)br.t.xpx[Pr]=Tt.c2p(Hr[Pr]),br.t.ypx[Pr]=Ht.c2p(nr[Pr])}kr._module.name==="splom"&&(Pt[Mr.uid]||(Pt[Mr.uid]=!0))}}var Nr=Ye(At,dt);Ot=Ot.concat(Nr),Kt=Kt.concat(dt)}}var Sr={points:Ot};ge(Ue,Kt,Sr);var tt=Wt.clickmode,Et=tt.indexOf("event")>-1&&qe;if(!Je&&qe){var Vt=Le(Ue,!0);if(Vt.length){var ar=Vt[0].xref,Cr=Vt[0].yref;if(ar&&Cr){var Or=Rt(Vt),Ir=Lt([k(Ue,ar,"x"),k(Ue,Cr,"y")]);Ir(Sr,Or)}}Ue._fullLayout._noEmitSelectedAtStart?Ue._fullLayout._noEmitSelectedAtStart=!1:Et&&Dt(Ue,Sr),Wt._reselect=!1}if(!Je&&Wt._deselect){var Tr=Wt._deselect;_t=Tr.xref,mt=Tr.yref,Ge(_t,mt,Kt)||Qe(Ue,_t,mt,Ae),Et&&(Sr.points.length?Dt(Ue,Sr):kt(Ue)),Wt._deselect=!1}return{eventData:Sr,selectionTesters:Ve}}function Pe(Ue){var qe=Ue.calcdata;if(!!qe)for(var Ve=0;Ve<qe.length;Ve++){var Ae=qe[Ve][0],Ne=Ae.trace,Xe=Ue._fullLayout._splomScenes;if(Xe){var Je=Xe[Ne.uid];Je&&(Je.selectBatch=[])}}}function Ge(Ue,qe,Ve){for(var Ae=0;Ae<Ve.length;Ae++){var Ne=Ve[Ae];if(Ne.xaxis&&Ne.xaxis._id===Ue&&Ne.yaxis&&Ne.yaxis._id===qe)return!0}return!1}function Qe(Ue,qe,Ve,Ae){Ae=ne(Ue,[k(Ue,qe,"x")],[k(Ue,Ve,"y")],qe+Ve);for(var Ne=0;Ne<Ae.length;Ne++){var Xe=Ae[Ne];Xe._module.selectPoints(Xe,!1)}ge(Ue,Ae)}function Be(Ue,qe,Ve,Ae){for(var Ne,Xe=0;Xe<Ue.length;Xe++){var Je=Ue[Xe];if(!(qe!==Je.xref||Ve!==Je.yref))if(Ne){var _t=!!Je.subtract;Ne=_e(Ne,Je,_t),Ae=N(Ne)}else Ne=[Je],Ae=B(Je)}return Ae}function Le(Ue,qe){for(var Ve=[],Ae=Ue._fullLayout,Ne=Ae.selections,Xe=Ne.length,Je=0;Je<Xe;Je++)if(!(qe&&Je!==Ae._activeSelectionIndex)){var _t=Ne[Je];if(!!_t){var mt=_t.xref,Ot=_t.yref,Kt=k(Ue,mt,"x"),Nt=k(Ue,Ot,"y"),Wt,qt,Yt,fr,Yr;if(_t.type==="rect"){Yr=[];var hn=vt(Kt,_t.x0),Qr=vt(Kt,_t.x1),at=vt(Nt,_t.y0),Jt=vt(Nt,_t.y1);Yr=[[hn,at],[hn,Jt],[Qr,Jt],[Qr,at]],Wt=Math.min(hn,Qr),qt=Math.max(hn,Qr),Yt=Math.min(at,Jt),fr=Math.max(at,Jt),Yr.xmin=Wt,Yr.xmax=qt,Yr.ymin=Yt,Yr.ymax=fr,Yr.xref=mt,Yr.yref=Ot,Yr.subtract=!1,Yr.isRect=!0,Ve.push(Yr)}else if(_t.type==="path")for(var Zt=_t.path.split("Z"),Ut=[],_r=0;_r<Zt.length;_r++){var rt=Zt[_r];if(!!rt){rt+="Z";var Ke=p.extractPathCoords(rt,g.paramIsX,"raw"),st=p.extractPathCoords(rt,g.paramIsY,"raw");Wt=1/0,qt=-1/0,Yt=1/0,fr=-1/0,Yr=[];for(var lt=0;lt<Ke.length;lt++){var wt=vt(Kt,Ke[lt]),Pt=vt(Nt,st[lt]);Yr.push([wt,Pt]),Wt=Math.min(wt,Wt),qt=Math.max(wt,qt),Yt=Math.min(Pt,Yt),fr=Math.max(Pt,fr)}Yr.xmin=Wt,Yr.xmax=qt,Yr.ymin=Yt,Yr.ymax=fr,Yr.xref=mt,Yr.yref=Ot,Yr.subtract=He(Yr,Ut),Ut.push(Yr),Ve.push(Yr)}}}}return Ve}function He(Ue,qe){for(var Ve=!1,Ae=0;Ae<qe.length;Ae++)for(var Ne=qe[Ae],Xe=0;Xe<Ue.length;Xe++)if(v(Ue[Xe],Ne)){Ve=!Ve;break}return Ve}function vt(Ue,qe){return Ue.type==="date"&&(qe=qe.replace("_"," ")),Ue.type==="log"?Ue.c2p(qe):Ue.r2p(qe,null,Ue.calendar)}function Rt(Ue){for(var qe=Ue.length,Ve=[],Ae=0;Ae<qe;Ae++){var Ne=Ue[Ae];Ve=Ve.concat(Ne),Ve=Ve.concat([Ne[0]])}return rr(Ve)}function rr(Ue){return Ue.isRect=Ue.length===5&&Ue[0][0]===Ue[4][0]&&Ue[0][1]===Ue[4][1]&&Ue[0][0]===Ue[1][0]&&Ue[2][0]===Ue[3][0]&&Ue[0][1]===Ue[3][1]&&Ue[1][1]===Ue[2][1]||Ue[0][1]===Ue[1][1]&&Ue[2][1]===Ue[3][1]&&Ue[0][0]===Ue[3][0]&&Ue[1][0]===Ue[2][0],Ue.isRect&&(Ue.xmin=Math.min(Ue[0][0],Ue[2][0]),Ue.xmax=Math.max(Ue[0][0],Ue[2][0]),Ue.ymin=Math.min(Ue[0][1],Ue[2][1]),Ue.ymax=Math.max(Ue[0][1],Ue[2][1])),Ue}function Lt(Ue){return function(qe,Ve){for(var Ae,Ne,Xe=0;Xe<Ue.length;Xe++){var Je=Ue[Xe],_t=Je._id,mt=_t.charAt(0);if(Ve.isRect){Ae||(Ae={});var Ot=Ve[mt+"min"],Kt=Ve[mt+"max"];Ot!==void 0&&Kt!==void 0&&(Ae[_t]=[H(Je,Ot),H(Je,Kt)].sort(l))}else Ne||(Ne={}),Ne[_t]=Ve.map(G(Je))}Ae&&(qe.range=Ae),Ne&&(qe.lassoPoints=Ne)}}function Ft(Ue){var qe=Ue.plotinfo;return qe.fillRangeItems||Lt(Ue.xaxes.concat(Ue.yaxes))}function Gt(Ue,qe){Ue.emit("plotly_selecting",qe)}function Dt(Ue,qe){qe&&(qe.selections=(Ue.layout||{}).selections||[]),Ue.emit("plotly_selected",qe)}function kt(Ue){Ue.emit("plotly_deselect",null)}ee.exports={reselect:be,prepSelect:Y,clearOutline:m,clearSelectionsCache:W,selectOnClick:Z}},{"../../lib":515,"../../lib/clear_gl_canvases":499,"../../lib/polygon":527,"../../lib/throttle":542,"../../plot_api/subroutines":556,"../../plots/cartesian/axis_ids":570,"../../registry":647,"../color":367,"../dragelement/helpers":385,"../drawing":389,"../fx":407,"../fx/helpers":403,"../shapes/constants":459,"../shapes/display_outlines":461,"../shapes/draw_newshape/helpers":466,"../shapes/draw_newshape/newshapes":467,"../shapes/handle_outline":468,"../shapes/helpers":469,"./constants":448,"./draw":450,"./draw_newselection/newselections":453,"./helpers":454,"point-in-polygon/nested":254,polybooljs:255}],457:[function(d,ee,te){var w=d("../annotations/attributes"),v=d("../../traces/scatter/attributes").line,S=d("../drawing/attributes").dash,M=d("../../lib/extend").extendFlat,e=d("../../plot_api/plot_template").templatedArray;d("../../constants/axis_placeable_objects"),ee.exports=e("shape",{visible:{valType:"boolean",dflt:!0,editType:"calc+arraydraw"},type:{valType:"enumerated",values:["circle","rect","path","line"],editType:"calc+arraydraw"},layer:{valType:"enumerated",values:["below","above"],dflt:"above",editType:"arraydraw"},xref:M({},w.xref,{}),xsizemode:{valType:"enumerated",values:["scaled","pixel"],dflt:"scaled",editType:"calc+arraydraw"},xanchor:{valType:"any",editType:"calc+arraydraw"},x0:{valType:"any",editType:"calc+arraydraw"},x1:{valType:"any",editType:"calc+arraydraw"},yref:M({},w.yref,{}),ysizemode:{valType:"enumerated",values:["scaled","pixel"],dflt:"scaled",editType:"calc+arraydraw"},yanchor:{valType:"any",editType:"calc+arraydraw"},y0:{valType:"any",editType:"calc+arraydraw"},y1:{valType:"any",editType:"calc+arraydraw"},path:{valType:"string",editType:"calc+arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"arraydraw"},line:{color:M({},v.color,{editType:"arraydraw"}),width:M({},v.width,{editType:"calc+arraydraw"}),dash:M({},S,{editType:"arraydraw"}),editType:"calc+arraydraw"},fillcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"arraydraw"},fillrule:{valType:"enumerated",values:["evenodd","nonzero"],dflt:"evenodd",editType:"arraydraw"},editable:{valType:"boolean",dflt:!1,editType:"calc+arraydraw"},editType:"arraydraw"})},{"../../constants/axis_placeable_objects":484,"../../lib/extend":505,"../../plot_api/plot_template":555,"../../traces/scatter/attributes":936,"../annotations/attributes":350,"../drawing/attributes":388}],458:[function(d,ee,te){var w=d("../../lib"),v=d("../../plots/cartesian/axes"),S=d("./constants"),M=d("./helpers");ee.exports=function(c){var o=c._fullLayout,i=w.filterVisible(o.shapes);if(!(!i.length||!c._fullData.length))for(var y=0;y<i.length;y++){var p=i[y];p._extremes={};var g,h,m=v.getRefType(p.xref),u=v.getRefType(p.yref);if(p.xref!=="paper"&&m!=="domain"){var _=p.xsizemode==="pixel"?p.xanchor:p.x0,s=p.xsizemode==="pixel"?p.xanchor:p.x1;g=v.getFromId(c,p.xref),h=r(g,_,s,p.path,S.paramIsX),h&&(p._extremes[g._id]=v.findExtremes(g,h,e(p)))}if(p.yref!=="paper"&&u!=="domain"){var A=p.ysizemode==="pixel"?p.yanchor:p.y0,b=p.ysizemode==="pixel"?p.yanchor:p.y1;g=v.getFromId(c,p.yref),h=r(g,A,b,p.path,S.paramIsY),h&&(p._extremes[g._id]=v.findExtremes(g,h,a(p)))}}};function e(t){return n(t.line.width,t.xsizemode,t.x0,t.x1,t.path,!1)}function a(t){return n(t.line.width,t.ysizemode,t.y0,t.y1,t.path,!0)}function n(t,c,o,i,y,p){var g=t/2,h=p;if(c==="pixel"){var m=y?M.extractPathCoords(y,p?S.paramIsY:S.paramIsX):[o,i],u=w.aggNums(Math.max,null,m),_=w.aggNums(Math.min,null,m),s=_<0?Math.abs(_)+g:g,A=u>0?u+g:g;return{ppad:g,ppadplus:h?s:A,ppadminus:h?A:s}}else return{ppad:g}}function r(t,c,o,i,y){var p=t.type==="category"||t.type==="multicategory"?t.r2c:t.d2c;if(c!==void 0)return[p(c),p(o)];if(!!i){var g=1/0,h=-1/0,m=i.match(S.segmentRE),u,_,s,A,b;for(t.type==="date"&&(p=M.decodeDate(p)),u=0;u<m.length;u++)_=m[u],s=y[_.charAt(0)].drawn,s!==void 0&&(A=m[u].substr(1).match(S.paramRE),!(!A||A.length<s)&&(b=p(A[s]),b<g&&(g=b),b>h&&(h=b)));if(h>=g)return[g,h]}}},{"../../lib":515,"../../plots/cartesian/axes":566,"./constants":459,"./helpers":469}],459:[function(d,ee,te){ee.exports={segmentRE:/[MLHVQCTSZ][^MLHVQCTSZ]*/g,paramRE:/[^\s,]+/g,paramIsX:{M:{0:!0,drawn:0},L:{0:!0,drawn:0},H:{0:!0,drawn:0},V:{},Q:{0:!0,2:!0,drawn:2},C:{0:!0,2:!0,4:!0,drawn:4},T:{0:!0,drawn:0},S:{0:!0,2:!0,drawn:2},Z:{}},paramIsY:{M:{1:!0,drawn:1},L:{1:!0,drawn:1},H:{},V:{0:!0,drawn:0},Q:{1:!0,3:!0,drawn:3},C:{1:!0,3:!0,5:!0,drawn:5},T:{1:!0,drawn:1},S:{1:!0,3:!0,drawn:5},Z:{}},numParams:{M:2,L:2,H:1,V:1,Q:4,C:6,T:2,S:4,Z:0}}},{}],460:[function(d,ee,te){var w=d("../../lib"),v=d("../../plots/cartesian/axes"),S=d("../../plots/array_container_defaults"),M=d("./attributes"),e=d("./helpers");ee.exports=function(r,t){S(r,t,{name:"shapes",handleItemDefaults:a})};function a(n,r,t){function c(G,J){return w.coerce(n,r,M,G,J)}var o=c("visible");if(!!o){var i=c("path"),y=i?"path":"rect",p=c("type",y),g=p!=="path";g&&delete r.path,c("editable"),c("layer"),c("opacity"),c("fillcolor"),c("fillrule");var h=c("line.width");h&&(c("line.color"),c("line.dash"));for(var m=c("xsizemode"),u=c("ysizemode"),_=["x","y"],s=0;s<2;s++){var A=_[s],b=A+"anchor",f=A==="x"?m:u,x={_fullLayout:t},l,L,T,k=v.coerceRef(n,r,x,A,void 0,"paper"),P=v.getRefType(k);if(P==="range"?(l=v.getFromId(x,k),l._shapeIndices.push(r._index),T=e.rangeToShapePosition(l),L=e.shapePositionToRange(l)):L=T=w.identity,g){var z=.25,I=.75,D=A+"0",R=A+"1",B=n[D],F=n[R];n[D]=L(n[D],!0),n[R]=L(n[R],!0),f==="pixel"?(c(D,0),c(R,10)):(v.coercePosition(r,x,c,k,D,z),v.coercePosition(r,x,c,k,R,I)),r[D]=T(r[D]),r[R]=T(r[R]),n[D]=B,n[R]=F}if(f==="pixel"){var H=n[b];n[b]=L(n[b],!0),v.coercePosition(r,x,c,k,b,.25),r[b]=T(r[b]),n[b]=H}}g&&w.noneOrAll(n,r,["x0","x1","y0","y1"])}}},{"../../lib":515,"../../plots/array_container_defaults":561,"../../plots/cartesian/axes":566,"./attributes":457,"./helpers":469}],461:[function(d,ee,te){var w=d("../../lib"),v=w.strTranslate,S=d("../dragelement"),M=d("../dragelement/helpers"),e=M.drawMode,a=M.selectMode,n=d("../../registry"),r=d("../color"),t=d("./draw_newshape/constants"),c=t.i000,o=t.i090,i=t.i180,y=t.i270,p=d("./handle_outline"),g=p.clearOutlineControllers,h=d("./draw_newshape/helpers"),m=h.pointsOnRectangle,u=h.pointsOnEllipse,_=h.writePaths,s=d("./draw_newshape/newshapes"),A=d("../selections/draw_newselection/newselections");ee.exports=function l(L,T,k,P){P||(P=0);var z=k.gd;function I(){l(L,T,k,P++),u(L[0])&&D({redrawing:!0})}function D(ue){var pe={};k.isActiveShape!==void 0&&(k.isActiveShape=!1,pe=s(T,k)),k.isActiveSelection!==void 0&&(k.isActiveSelection=!1,pe=A(T,k),z._fullLayout._reselect=!0),Object.keys(pe).length&&n.call((ue||{}).redrawing?"relayout":"_guiRelayout",z,pe)}var R=z._fullLayout,B=R._zoomlayer,F=k.dragmode,H=e(F),G=a(F);(H||G)&&(z._fullLayout._outlining=!0),g(z),T.attr("d",_(L));var J,X,Y,Z,oe;if(!P&&(k.isActiveShape||k.isActiveSelection)){oe=b([],L);var re=B.append("g").attr("class","outline-controllers");W(re),ye()}function se(ue){Y=+ue.srcElement.getAttribute("data-i"),Z=+ue.srcElement.getAttribute("data-j"),J[Y][Z].moveFn=N}function N(ue,pe){if(!!L.length){var ge=oe[Y][Z][1],Te=oe[Y][Z][2],_e=L[Y],ze=_e.length;if(m(_e)){var Oe=ue,Ye=pe;if(k.isActiveSelection){var be=f(_e,Z);be[1]===_e[Z][1]?Ye=0:Oe=0}for(var Pe=0;Pe<ze;Pe++)if(Pe!==Z){var Ge=_e[Pe];Ge[1]===_e[Z][1]&&(Ge[1]=ge+Oe),Ge[2]===_e[Z][2]&&(Ge[2]=Te+Ye)}if(_e[Z][1]=ge+Oe,_e[Z][2]=Te+Ye,!m(_e))for(var Qe=0;Qe<ze;Qe++)for(var Be=0;Be<_e[Qe].length;Be++)_e[Qe][Be]=oe[Y][Qe][Be]}else _e[Z][1]=ge+ue,_e[Z][2]=Te+pe;I()}}function U(){D()}function q(){if(!!L.length&&!!L[Y]&&!!L[Y].length){for(var ue=[],pe=0;pe<L[Y].length;pe++)pe!==Z&&ue.push(L[Y][pe]);ue.length>1&&!(ue.length===2&&ue[1][0]==="Z")&&(Z===0&&(ue[0][0]="M"),L[Y]=ue,I(),D())}}function $(ue,pe){if(ue===2){Y=+pe.srcElement.getAttribute("data-i"),Z=+pe.srcElement.getAttribute("data-j");var ge=L[Y];!m(ge)&&!u(ge)&&q()}}function W(ue){J=[];for(var pe=0;pe<L.length;pe++){var ge=L[pe],Te=m(ge),_e=!Te&&u(ge);J[pe]=[];for(var ze=ge.length,Oe=0;Oe<ze;Oe++)if(ge[Oe][0]!=="Z"&&!(_e&&Oe!==c&&Oe!==o&&Oe!==i&&Oe!==y)){var Ye=Te&&k.isActiveSelection,be;Ye&&(be=f(ge,Oe));var Pe=ge[Oe][1],Ge=ge[Oe][2],Qe=ue.append(Ye?"rect":"circle").attr("data-i",pe).attr("data-j",Oe).style({fill:r.background,stroke:r.defaultLine,"stroke-width":1,"shape-rendering":"crispEdges"});if(Ye){var Be=be[1]-Pe,Le=be[2]-Ge,He=Le?5:Math.max(Math.min(25,Math.abs(Be)-5),5),vt=Be?5:Math.max(Math.min(25,Math.abs(Le)-5),5);Qe.classed(Le?"cursor-ew-resize":"cursor-ns-resize",!0).attr("width",He).attr("height",vt).attr("x",Pe-He/2).attr("y",Ge-vt/2).attr("transform",v(Be/2,Le/2))}else Qe.classed("cursor-grab",!0).attr("r",5).attr("cx",Pe).attr("cy",Ge);J[pe][Oe]={element:Qe.node(),gd:z,prepFn:se,doneFn:U,clickFn:$},S.init(J[pe][Oe])}}}function K(ue,pe){if(!!L.length)for(var ge=0;ge<L.length;ge++)for(var Te=0;Te<L[ge].length;Te++)for(var _e=0;_e+2<L[ge][Te].length;_e+=2)L[ge][Te][_e+1]=oe[ge][Te][_e+1]+ue,L[ge][Te][_e+2]=oe[ge][Te][_e+2]+pe}function ne(ue,pe){K(ue,pe),I()}function ae(ue){Y=+ue.srcElement.getAttribute("data-i"),Y||(Y=0),X[Y].moveFn=ne}function ie(){D()}function le(ue){ue===2&&x(z)}function ye(){if(X=[],!!L.length){var ue=0;X[ue]={element:T[0][0],gd:z,prepFn:ae,doneFn:ie,clickFn:le},S.init(X[ue])}}};function b(l,L){for(var T=0;T<L.length;T++){var k=L[T];l[T]=[];for(var P=0;P<k.length;P++){l[T][P]=[];for(var z=0;z<k[P].length;z++)l[T][P][z]=k[P][z]}}return l}function f(l,L){var T=l[L][1],k=l[L][2],P=l.length,z,I,D;return z=(L+1)%P,I=l[z][1],D=l[z][2],I===T&&D===k&&(z=(L+2)%P,I=l[z][1],D=l[z][2]),[z,I,D]}function x(l){if(!!a(l._fullLayout.dragmode)){g(l);var L=l._fullLayout._activeSelectionIndex,T=(l.layout||{}).selections||[];if(L<T.length){for(var k=[],P=0;P<T.length;P++)P!==L&&k.push(T[P]);delete l._fullLayout._activeSelectionIndex;var z=l._fullLayout.selections[L];l._fullLayout._deselect={xref:z.xref,yref:z.yref},n.call("_guiRelayout",l,{selections:k})}}}},{"../../lib":515,"../../registry":647,"../color":367,"../dragelement":386,"../dragelement/helpers":385,"../selections/draw_newselection/newselections":453,"./draw_newshape/constants":464,"./draw_newshape/helpers":466,"./draw_newshape/newshapes":467,"./handle_outline":468}],462:[function(d,ee,te){var w=d("../../registry"),v=d("../../lib"),S=d("../../plots/cartesian/axes"),M=d("./draw_newshape/helpers").readPaths,e=d("./display_outlines"),a=d("./handle_outline").clearOutlineControllers,n=d("../color"),r=d("../drawing"),t=d("../../plot_api/plot_template").arrayEditor,c=d("../dragelement"),o=d("../../lib/setcursor"),i=d("./constants"),y=d("./helpers"),p=y.getPathString;ee.exports={draw:g,drawOne:u,eraseActiveShape:x};function g(l){var L=l._fullLayout;L._shapeUpperLayer.selectAll("path").remove(),L._shapeLowerLayer.selectAll("path").remove();for(var T in L._plots){var k=L._plots[T].shapelayer;k&&k.selectAll("path").remove()}for(var P=0;P<L.shapes.length;P++)L.shapes[P].visible&&u(l,P)}function h(l){return!!l._fullLayout._outlining}function m(l){return!l._context.edits.shapePosition}function u(l,L){l._fullLayout._paperdiv.selectAll('.shapelayer [data-index="'+L+'"]').remove();var T=y.makeShapesOptionsAndPlotinfo(l,L),k=T.options,P=T.plotinfo;if(!k._input||k.visible===!1)return;if(k.layer!=="below")I(l._fullLayout._shapeUpperLayer);else if(k.xref==="paper"||k.yref==="paper")I(l._fullLayout._shapeLowerLayer);else if(P._hadPlotinfo){var z=P.mainplotinfo||P;I(z.shapelayer)}else I(l._fullLayout._shapeLowerLayer);function I(D){var R=p(l,k),B={"data-index":L,"fill-rule":k.fillrule,d:R},F=k.opacity,H=k.fillcolor,G=k.line.width?k.line.color:"rgba(0,0,0,0)",J=k.line.width,X=k.line.dash;!J&&k.editable===!0&&(J=5,X="solid");var Y=R[R.length-1]!=="Z",Z=m(l)&&k.editable&&l._fullLayout._activeShapeIndex===L;Z&&(H=Y?"rgba(0,0,0,0)":l._fullLayout.activeshape.fillcolor,F=l._fullLayout.activeshape.opacity);var oe=D.append("path").attr(B).style("opacity",F).call(n.stroke,G).call(n.fill,H).call(r.dashLine,X,J);_(oe,l,k);var re;if((Z||l._context.edits.shapePosition)&&(re=t(l.layout,"shapes",k)),Z){oe.style({cursor:"move"});var se={element:oe.node(),plotinfo:P,gd:l,editHelpers:re,isActiveShape:!0},N=M(R,l);e(N,oe,se)}else l._context.edits.shapePosition?s(l,oe,k,L,D,re):k.editable===!0&&oe.style("pointer-events",Y||n.opacity(H)*F<=.5?"stroke":"all");oe.node().addEventListener("click",function(){return b(l,oe)})}}function _(l,L,T){var k=(T.xref+T.yref).replace(/paper/g,"").replace(/[xyz][1-9]* *domain/g,"");r.setClipUrl(l,k?"clip"+L._fullLayout._uid+k:null,L)}function s(l,L,T,k,P,z){var I=10,D=10,R=T.xsizemode==="pixel",B=T.ysizemode==="pixel",F=T.type==="line",H=T.type==="path",G=z.modifyItem,J,X,Y,Z,oe,re,se,N,U,q,$,W,K,ne,ae,ie=S.getFromId(l,T.xref),le=S.getRefType(T.xref),ye=S.getFromId(l,T.yref),ue=S.getRefType(T.yref),pe=y.getDataToPixel(l,ie,!1,le),ge=y.getDataToPixel(l,ye,!0,ue),Te=y.getPixelToData(l,ie,!1,le),_e=y.getPixelToData(l,ye,!0,ue),ze=be(),Oe={element:ze.node(),gd:l,prepFn:Qe,doneFn:Be,clickFn:Le},Ye;c.init(Oe),ze.node().onmousemove=Ge;function be(){return F?Pe():L}function Pe(){var Ft=10,Gt=Math.max(T.line.width,Ft),Dt=P.append("g").attr("data-index",k);Dt.append("path").attr("d",L.attr("d")).style({cursor:"move","stroke-width":Gt,"stroke-opacity":"0"});var kt={"fill-opacity":"0"},Ue=Math.max(Gt/2,Ft);return Dt.append("circle").attr({"data-line-point":"start-point",cx:R?pe(T.xanchor)+T.x0:pe(T.x0),cy:B?ge(T.yanchor)-T.y0:ge(T.y0),r:Ue}).style(kt).classed("cursor-grab",!0),Dt.append("circle").attr({"data-line-point":"end-point",cx:R?pe(T.xanchor)+T.x1:pe(T.x1),cy:B?ge(T.yanchor)-T.y1:ge(T.y1),r:Ue}).style(kt).classed("cursor-grab",!0),Dt}function Ge(Ft){if(h(l)){Ye=null;return}if(F)Ft.target.tagName==="path"?Ye="move":Ye=Ft.target.attributes["data-line-point"].value==="start-point"?"resize-over-start-point":"resize-over-end-point";else{var Gt=Oe.element.getBoundingClientRect(),Dt=Gt.right-Gt.left,kt=Gt.bottom-Gt.top,Ue=Ft.clientX-Gt.left,qe=Ft.clientY-Gt.top,Ve=!H&&Dt>I&&kt>D&&!Ft.shiftKey?c.getCursor(Ue/Dt,1-qe/kt):"move";o(L,Ve),Ye=Ve.split("-")[0]}}function Qe(Ft){h(l)||(R&&(oe=pe(T.xanchor)),B&&(re=ge(T.yanchor)),T.type==="path"?ae=T.path:(J=R?T.x0:pe(T.x0),X=B?T.y0:ge(T.y0),Y=R?T.x1:pe(T.x1),Z=B?T.y1:ge(T.y1)),J<Y?(U=J,K="x0",q=Y,ne="x1"):(U=Y,K="x1",q=J,ne="x0"),!B&&X<Z||B&&X>Z?(se=X,$="y0",N=Z,W="y1"):(se=Z,$="y1",N=X,W="y0"),Ge(Ft),Rt(P,T),Lt(L,T,l),Oe.moveFn=Ye==="move"?He:vt,Oe.altKey=Ft.altKey)}function Be(){h(l)||(o(L),rr(P),_(L,l,T),w.call("_guiRelayout",l,z.getUpdateObj()))}function Le(){h(l)||rr(P)}function He(Ft,Gt){if(T.type==="path"){var Dt=function(qe){return qe},kt=Dt,Ue=Dt;R?G("xanchor",T.xanchor=Te(oe+Ft)):(kt=function(Ve){return Te(pe(Ve)+Ft)},ie&&ie.type==="date"&&(kt=y.encodeDate(kt))),B?G("yanchor",T.yanchor=_e(re+Gt)):(Ue=function(Ve){return _e(ge(Ve)+Gt)},ye&&ye.type==="date"&&(Ue=y.encodeDate(Ue))),G("path",T.path=A(ae,kt,Ue))}else R?G("xanchor",T.xanchor=Te(oe+Ft)):(G("x0",T.x0=Te(J+Ft)),G("x1",T.x1=Te(Y+Ft))),B?G("yanchor",T.yanchor=_e(re+Gt)):(G("y0",T.y0=_e(X+Gt)),G("y1",T.y1=_e(Z+Gt)));L.attr("d",p(l,T)),Rt(P,T)}function vt(Ft,Gt){if(H){var Dt=function(Yt){return Yt},kt=Dt,Ue=Dt;R?G("xanchor",T.xanchor=Te(oe+Ft)):(kt=function(fr){return Te(pe(fr)+Ft)},ie&&ie.type==="date"&&(kt=y.encodeDate(kt))),B?G("yanchor",T.yanchor=_e(re+Gt)):(Ue=function(fr){return _e(ge(fr)+Gt)},ye&&ye.type==="date"&&(Ue=y.encodeDate(Ue))),G("path",T.path=A(ae,kt,Ue))}else if(F){if(Ye==="resize-over-start-point"){var qe=J+Ft,Ve=B?X-Gt:X+Gt;G("x0",T.x0=R?qe:Te(qe)),G("y0",T.y0=B?Ve:_e(Ve))}else if(Ye==="resize-over-end-point"){var Ae=Y+Ft,Ne=B?Z-Gt:Z+Gt;G("x1",T.x1=R?Ae:Te(Ae)),G("y1",T.y1=B?Ne:_e(Ne))}}else{var Xe=function(Yt){return Ye.indexOf(Yt)!==-1},Je=Xe("n"),_t=Xe("s"),mt=Xe("w"),Ot=Xe("e"),Kt=Je?se+Gt:se,Nt=_t?N+Gt:N,Wt=mt?U+Ft:U,qt=Ot?q+Ft:q;B&&(Je&&(Kt=se-Gt),_t&&(Nt=N-Gt)),(!B&&Nt-Kt>D||B&&Kt-Nt>D)&&(G($,T[$]=B?Kt:_e(Kt)),G(W,T[W]=B?Nt:_e(Nt))),qt-Wt>I&&(G(K,T[K]=R?Wt:Te(Wt)),G(ne,T[ne]=R?qt:Te(qt)))}L.attr("d",p(l,T)),Rt(P,T)}function Rt(Ft,Gt){(R||B)&&Dt();function Dt(){var kt=Gt.type!=="path",Ue=Ft.selectAll(".visual-cue").data([0]),qe=1;Ue.enter().append("path").attr({fill:"#fff","fill-rule":"evenodd",stroke:"#000","stroke-width":qe}).classed("visual-cue",!0);var Ve=pe(R?Gt.xanchor:v.midRange(kt?[Gt.x0,Gt.x1]:y.extractPathCoords(Gt.path,i.paramIsX))),Ae=ge(B?Gt.yanchor:v.midRange(kt?[Gt.y0,Gt.y1]:y.extractPathCoords(Gt.path,i.paramIsY)));if(Ve=y.roundPositionForSharpStrokeRendering(Ve,qe),Ae=y.roundPositionForSharpStrokeRendering(Ae,qe),R&&B){var Ne="M"+(Ve-1-qe)+","+(Ae-1-qe)+"h-8v2h8 v8h2v-8 h8v-2h-8 v-8h-2 Z";Ue.attr("d",Ne)}else if(R){var Xe="M"+(Ve-1-qe)+","+(Ae-9-qe)+"v18 h2 v-18 Z";Ue.attr("d",Xe)}else{var Je="M"+(Ve-9-qe)+","+(Ae-1-qe)+"h18 v2 h-18 Z";Ue.attr("d",Je)}}}function rr(Ft){Ft.selectAll(".visual-cue").remove()}function Lt(Ft,Gt,Dt){var kt=Gt.xref,Ue=Gt.yref,qe=S.getFromId(Dt,kt),Ve=S.getFromId(Dt,Ue),Ae="";kt!=="paper"&&!qe.autorange&&(Ae+=kt),Ue!=="paper"&&!Ve.autorange&&(Ae+=Ue),r.setClipUrl(Ft,Ae?"clip"+Dt._fullLayout._uid+Ae:null,Dt)}}function A(l,L,T){return l.replace(i.segmentRE,function(k){var P=0,z=k.charAt(0),I=i.paramIsX[z],D=i.paramIsY[z],R=i.numParams[z],B=k.substr(1).replace(i.paramRE,function(F){return P>=R||(I[P]?F=L(F):D[P]&&(F=T(F)),P++),F});return z+B})}function b(l,L){if(!!m(l)){var T=L.node(),k=+T.getAttribute("data-index");if(k>=0){if(k===l._fullLayout._activeShapeIndex){f(l);return}l._fullLayout._activeShapeIndex=k,l._fullLayout._deactivateShape=f,g(l)}}}function f(l){if(!!m(l)){var L=l._fullLayout._activeShapeIndex;L>=0&&(a(l),delete l._fullLayout._activeShapeIndex,g(l))}}function x(l){if(!!m(l)){a(l);var L=l._fullLayout._activeShapeIndex,T=(l.layout||{}).shapes||[];if(L<T.length){for(var k=[],P=0;P<T.length;P++)P!==L&&k.push(T[P]);delete l._fullLayout._activeShapeIndex,w.call("_guiRelayout",l,{shapes:k})}}}},{"../../lib":515,"../../lib/setcursor":536,"../../plot_api/plot_template":555,"../../plots/cartesian/axes":566,"../../registry":647,"../color":367,"../dragelement":386,"../drawing":389,"./constants":459,"./display_outlines":461,"./draw_newshape/helpers":466,"./handle_outline":468,"./helpers":469}],463:[function(d,ee,te){var w=d("../../drawing/attributes").dash,v=d("../../../lib/extend").extendFlat;ee.exports={newshape:{line:{color:{valType:"color",editType:"none"},width:{valType:"number",min:0,dflt:4,editType:"none"},dash:v({},w,{dflt:"solid",editType:"none"}),editType:"none"},fillcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"none"},fillrule:{valType:"enumerated",values:["evenodd","nonzero"],dflt:"evenodd",editType:"none"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"none"},layer:{valType:"enumerated",values:["below","above"],dflt:"above",editType:"none"},drawdirection:{valType:"enumerated",values:["ortho","horizontal","vertical","diagonal"],dflt:"diagonal",editType:"none"},editType:"none"},activeshape:{fillcolor:{valType:"color",dflt:"rgb(255,0,255)",editType:"none"},opacity:{valType:"number",min:0,max:1,dflt:.5,editType:"none"},editType:"none"}}},{"../../../lib/extend":505,"../../drawing/attributes":388}],464:[function(d,ee,te){var w=32;ee.exports={CIRCLE_SIDES:w,i000:0,i090:w/4,i180:w/2,i270:w/4*3,cos45:Math.cos(Math.PI/4),sin45:Math.sin(Math.PI/4),SQRT2:Math.sqrt(2)}},{}],465:[function(d,ee,te){var w=d("../../color");ee.exports=function(S,M,e){e("newshape.drawdirection"),e("newshape.layer"),e("newshape.fillcolor"),e("newshape.fillrule"),e("newshape.opacity");var a=e("newshape.line.width");if(a){var n=(S||{}).plot_bgcolor||"#FFF";e("newshape.line.color",w.contrast(n)),e("newshape.line.dash")}e("activeshape.fillcolor"),e("activeshape.opacity")}},{"../../color":367}],466:[function(d,ee,te){var w=d("parse-svg-path"),v=d("./constants"),S=v.CIRCLE_SIDES,M=v.SQRT2,e=d("../../selections/helpers"),a=e.p2r,n=e.r2p,r=[0,3,4,5,6,1,2],t=[0,3,4,1,2];te.writePaths=function(i){var y=i.length;if(!y)return"M0,0Z";for(var p="",g=0;g<y;g++)for(var h=i[g].length,m=0;m<h;m++){var u=i[g][m][0];if(u==="Z")p+="Z";else for(var _=i[g][m].length,s=0;s<_;s++){var A=s;u==="Q"||u==="S"?A=t[s]:u==="C"&&(A=r[s]),p+=i[g][m][A],s>0&&s<_-1&&(p+=",")}}return p},te.readPaths=function(i,y,p,g){var h=w(i),m=[],u=-1,_=function(){u++,m[u]=[]},s,A=0,b=0,f,x,l=function(){f=A,x=b};l();for(var L=0;L<h.length;L++){var T=[],k,P,z,I,D=h[L][0],R=D;switch(D){case"M":_(),A=+h[L][1],b=+h[L][2],T.push([R,A,b]),l();break;case"Q":case"S":k=+h[L][1],z=+h[L][2],A=+h[L][3],b=+h[L][4],T.push([R,A,b,k,z]);break;case"C":k=+h[L][1],z=+h[L][2],P=+h[L][3],I=+h[L][4],A=+h[L][5],b=+h[L][6],T.push([R,A,b,k,z,P,I]);break;case"T":case"L":A=+h[L][1],b=+h[L][2],T.push([R,A,b]);break;case"H":R="L",A=+h[L][1],T.push([R,A,b]);break;case"V":R="L",b=+h[L][1],T.push([R,A,b]);break;case"A":R="L";var B=+h[L][1],F=+h[L][2];+h[L][4]||(B=-B,F=-F);var H=A-B,G=b;for(s=1;s<=S/2;s++){var J=2*Math.PI*s/S;T.push([R,H+B*Math.cos(J),G+F*Math.sin(J)])}break;case"Z":(A!==f||b!==x)&&(A=f,b=x,T.push([R,A,b]));break}for(var X=(p||{}).domain,Y=y._fullLayout._size,Z=p&&p.xsizemode==="pixel",oe=p&&p.ysizemode==="pixel",re=g===!1,se=0;se<T.length;se++){for(s=0;s+2<7;s+=2){var N=T[se][s+1],U=T[se][s+2];N===void 0||U===void 0||(A=N,b=U,p&&(p.xaxis&&p.xaxis.p2r?(re&&(N-=p.xaxis._offset),Z?N=n(p.xaxis,p.xanchor)+N:N=a(p.xaxis,N)):(re&&(N-=Y.l),X?N=X.x[0]+N/Y.w:N=N/Y.w),p.yaxis&&p.yaxis.p2r?(re&&(U-=p.yaxis._offset),oe?U=n(p.yaxis,p.yanchor)-U:U=a(p.yaxis,U)):(re&&(U-=Y.t),X?U=X.y[1]-U/Y.h:U=1-U/Y.h)),T[se][s+1]=N,T[se][s+2]=U)}m[u].push(T[se].slice())}}return m};function c(i,y){return Math.abs(i-y)<=1e-6}function o(i,y){var p=y[1]-i[1],g=y[2]-i[2];return Math.sqrt(p*p+g*g)}te.pointsOnRectangle=function(i){var y=i.length;if(y!==5)return!1;for(var p=1;p<3;p++){var g=i[0][p]-i[1][p],h=i[3][p]-i[2][p];if(!c(g,h))return!1;var m=i[0][p]-i[3][p],u=i[1][p]-i[2][p];if(!c(m,u))return!1}return!c(i[0][1],i[1][1])&&!c(i[0][1],i[3][1])?!1:!!(o(i[0],i[1])*o(i[0],i[3]))},te.pointsOnEllipse=function(i){var y=i.length;if(y!==S+1)return!1;y=S;for(var p=0;p<y;p++){var g=(y*2-p)%y,h=(y/2+g)%y,m=(y/2+p)%y;if(!c(o(i[p],i[m]),o(i[g],i[h])))return!1}return!0},te.handleEllipse=function(i,y,p){if(!i)return[y,p];var g=te.ellipseOver({x0:y[0],y0:y[1],x1:p[0],y1:p[1]}),h=(g.x1+g.x0)/2,m=(g.y1+g.y0)/2,u=(g.x1-g.x0)/2,_=(g.y1-g.y0)/2;u||(u=_=_/M),_||(_=u=u/M);for(var s=[],A=0;A<S;A++){var b=A*2*Math.PI/S;s.push([h+u*Math.cos(b),m+_*Math.sin(b)])}return s},te.ellipseOver=function(i){var y=i.x0,p=i.y0,g=i.x1,h=i.y1,m=g-y,u=h-p;y-=m,p-=u;var _=(y+g)/2,s=(p+h)/2,A=M;return m*=A,u*=A,{x0:_-m,y0:s-u,x1:_+m,y1:s+u}},te.fixDatesForPaths=function(i,y,p){var g=y.type==="date",h=p.type==="date";if(!g&&!h)return i;for(var m=0;m<i.length;m++)for(var u=0;u<i[m].length;u++)for(var _=0;_+2<i[m][u].length;_+=2)g&&(i[m][u][_+1]=i[m][u][_+1].replace(" ","_")),h&&(i[m][u][_+2]=i[m][u][_+2].replace(" ","_"));return i}},{"../../selections/helpers":454,"./constants":464,"parse-svg-path":250}],467:[function(d,ee,te){var w=d("../../dragelement/helpers"),v=w.drawMode,S=w.openMode,M=d("./constants"),e=M.i000,a=M.i090,n=M.i180,r=M.i270,t=M.cos45,c=M.sin45,o=d("../../selections/helpers"),i=o.p2r,y=o.r2p,p=d(".././handle_outline"),g=p.clearOutline,h=d("./helpers"),m=h.readPaths,u=h.writePaths,_=h.ellipseOver,s=h.fixDatesForPaths;ee.exports=function(b,f){if(!!b.length){var x=b[0][0];if(!!x){var l=x.getAttribute("d"),L=f.gd,T=L._fullLayout.newshape,k=f.plotinfo,P=k.xaxis,z=k.yaxis,I=!!k.domain||!k.xaxis,D=!!k.domain||!k.yaxis,R=f.isActiveShape,B=f.dragmode,F=(L.layout||{}).shapes||[];if(!v(B)&&R!==void 0){var H=L._fullLayout._activeShapeIndex;if(H<F.length)switch(L._fullLayout.shapes[H].type){case"rect":B="drawrect";break;case"circle":B="drawcircle";break;case"line":B="drawline";break;case"path":var G=F[H].path||"";G[G.length-1]==="Z"?B="drawclosedpath":B="drawopenpath";break}}var J=S(B),X=m(l,L,k,R),Y={editable:!0,xref:I?"paper":P._id,yref:D?"paper":z._id,layer:T.layer,opacity:T.opacity,line:{color:T.line.color,width:T.line.width,dash:T.line.dash}};J||(Y.fillcolor=T.fillcolor,Y.fillrule=T.fillrule);var Z;if(X.length===1&&(Z=X[0]),Z&&Z.length===5&&B==="drawrect")Y.type="rect",Y.x0=Z[0][1],Y.y0=Z[0][2],Y.x1=Z[2][1],Y.y1=Z[2][2];else if(Z&&B==="drawline")Y.type="line",Y.x0=Z[0][1],Y.y0=Z[0][2],Y.x1=Z[1][1],Y.y1=Z[1][2];else if(Z&&B==="drawcircle"){Y.type="circle";var oe=Z[e][1],re=Z[a][1],se=Z[n][1],N=Z[r][1],U=Z[e][2],q=Z[a][2],$=Z[n][2],W=Z[r][2],K=k.xaxis&&(k.xaxis.type==="date"||k.xaxis.type==="log"),ne=k.yaxis&&(k.yaxis.type==="date"||k.yaxis.type==="log");K&&(oe=y(k.xaxis,oe),re=y(k.xaxis,re),se=y(k.xaxis,se),N=y(k.xaxis,N)),ne&&(U=y(k.yaxis,U),q=y(k.yaxis,q),$=y(k.yaxis,$),W=y(k.yaxis,W));var ae=(re+N)/2,ie=(U+$)/2,le=(N-re+se-oe)/2,ye=(W-q+$-U)/2,ue=_({x0:ae,y0:ie,x1:ae+le*t,y1:ie+ye*c});K&&(ue.x0=i(k.xaxis,ue.x0),ue.x1=i(k.xaxis,ue.x1)),ne&&(ue.y0=i(k.yaxis,ue.y0),ue.y1=i(k.yaxis,ue.y1)),Y.x0=ue.x0,Y.y0=ue.y0,Y.x1=ue.x1,Y.y1=ue.y1}else Y.type="path",P&&z&&s(X,P,z),Y.path=u(X),Z=null;g(L);for(var pe=f.editHelpers,ge=(pe||{}).modifyItem,Te=[],_e=0;_e<F.length;_e++){var ze=L._fullLayout.shapes[_e];if(Te[_e]=ze._input,R!==void 0&&_e===L._fullLayout._activeShapeIndex){var Oe=Y;switch(ze.type){case"line":case"rect":case"circle":ge("x0",Oe.x0),ge("x1",Oe.x1),ge("y0",Oe.y0),ge("y1",Oe.y1);break;case"path":ge("path",Oe.path);break}}}return R===void 0?(Te.push(Y),Te):pe?pe.getUpdateObj():{}}}}},{"../../dragelement/helpers":385,"../../selections/helpers":454,".././handle_outline":468,"./constants":464,"./helpers":466}],468:[function(d,ee,te){function w(S){var M=S._fullLayout._zoomlayer;M&&M.selectAll(".outline-controllers").remove()}function v(S){var M=S._fullLayout._zoomlayer;M&&M.selectAll(".select-outline").remove(),S._fullLayout._outlining=!1}ee.exports={clearOutlineControllers:w,clearOutline:v}},{}],469:[function(d,ee,te){var w=d("./constants"),v=d("../../lib"),S=d("../../plots/cartesian/axes");te.rangeToShapePosition=function(e){return e.type==="log"?e.r2d:function(a){return a}},te.shapePositionToRange=function(e){return e.type==="log"?e.d2r:function(a){return a}},te.decodeDate=function(e){return function(a){return a.replace&&(a=a.replace("_"," ")),e(a)}},te.encodeDate=function(e){return function(a){return e(a).replace(" ","_")}},te.extractPathCoords=function(e,a,n){var r=[],t=e.match(w.segmentRE);return t.forEach(function(c){var o=a[c.charAt(0)].drawn;if(o!==void 0){var i=c.substr(1).match(w.paramRE);if(!(!i||i.length<o)){var y=i[o],p=n?y:v.cleanNumber(y);r.push(p)}}}),r},te.getDataToPixel=function(e,a,n,r){var t=e._fullLayout._size,c;if(a)if(r==="domain")c=function(i){return a._length*(n?1-i:i)+a._offset};else{var o=te.shapePositionToRange(a);c=function(i){return a._offset+a.r2p(o(i,!0))},a.type==="date"&&(c=te.decodeDate(c))}else n?c=function(i){return t.t+t.h*(1-i)}:c=function(i){return t.l+t.w*i};return c},te.getPixelToData=function(e,a,n,r){var t=e._fullLayout._size,c;if(a)if(r==="domain")c=function(i){var y=(i-a._offset)/a._length;return n?1-y:y};else{var o=te.rangeToShapePosition(a);c=function(i){return o(a.p2r(i-a._offset))}}else n?c=function(i){return 1-(i-t.t)/t.h}:c=function(i){return(i-t.l)/t.w};return c},te.roundPositionForSharpStrokeRendering=function(e,a){var n=Math.round(a%2)===1,r=Math.round(e);return n?r+.5:r},te.makeShapesOptionsAndPlotinfo=function(e,a){var n=e._fullLayout.shapes[a]||{},r=e._fullLayout._plots[n.xref+n.yref],t=!!r;return t?r._hadPlotinfo=!0:(r={},n.xref&&n.xref!=="paper"&&(r.xaxis=e._fullLayout[n.xref+"axis"]),n.yref&&n.yref!=="paper"&&(r.yaxis=e._fullLayout[n.yref+"axis"])),r.xsizemode=n.xsizemode,r.ysizemode=n.ysizemode,r.xanchor=n.xanchor,r.yanchor=n.yanchor,{options:n,plotinfo:r}},te.makeSelectionsOptionsAndPlotinfo=function(e,a){var n=e._fullLayout.selections[a]||{},r=e._fullLayout._plots[n.xref+n.yref],t=!!r;return t?r._hadPlotinfo=!0:(r={},n.xref&&(r.xaxis=e._fullLayout[n.xref+"axis"]),n.yref&&(r.yaxis=e._fullLayout[n.yref+"axis"])),{options:n,plotinfo:r}},te.getPathString=function(e,a){var n=a.type,r=S.getRefType(a.xref),t=S.getRefType(a.yref),c=S.getFromId(e,a.xref),o=S.getFromId(e,a.yref),i=e._fullLayout._size,y,p,g,h,m,u,_,s;if(c?r==="domain"?p=function(z){return c._offset+c._length*z}:(y=te.shapePositionToRange(c),p=function(z){return c._offset+c.r2p(y(z,!0))}):p=function(z){return i.l+i.w*z},o?t==="domain"?h=function(z){return o._offset+o._length*(1-z)}:(g=te.shapePositionToRange(o),h=function(z){return o._offset+o.r2p(g(z,!0))}):h=function(z){return i.t+i.h*(1-z)},n==="path")return c&&c.type==="date"&&(p=te.decodeDate(p)),o&&o.type==="date"&&(h=te.decodeDate(h)),M(a,p,h);if(a.xsizemode==="pixel"){var A=p(a.xanchor);m=A+a.x0,u=A+a.x1}else m=p(a.x0),u=p(a.x1);if(a.ysizemode==="pixel"){var b=h(a.yanchor);_=b-a.y0,s=b-a.y1}else _=h(a.y0),s=h(a.y1);if(n==="line")return"M"+m+","+_+"L"+u+","+s;if(n==="rect")return"M"+m+","+_+"H"+u+"V"+s+"H"+m+"Z";var f=(m+u)/2,x=(_+s)/2,l=Math.abs(f-m),L=Math.abs(x-_),T="A"+l+","+L,k=f+l+","+x,P=f+","+(x-L);return"M"+k+T+" 0 1,1 "+P+T+" 0 0,1 "+k+"Z"};function M(e,a,n){var r=e.path,t=e.xsizemode,c=e.ysizemode,o=e.xanchor,i=e.yanchor;return r.replace(w.segmentRE,function(y){var p=0,g=y.charAt(0),h=w.paramIsX[g],m=w.paramIsY[g],u=w.numParams[g],_=y.substr(1).replace(w.paramRE,function(s){return h[p]?t==="pixel"?s=a(o)+Number(s):s=a(s):m[p]&&(c==="pixel"?s=n(i)-Number(s):s=n(s)),p++,p>u&&(s="X"),s});return p>u&&(_=_.replace(/[\s,]*X.*/,""),v.log("Ignoring extra params in segment "+y)),g+_})}},{"../../lib":515,"../../plots/cartesian/axes":566,"./constants":459}],470:[function(d,ee,te){var w=d("./draw");ee.exports={moduleType:"component",name:"shapes",layoutAttributes:d("./attributes"),supplyLayoutDefaults:d("./defaults"),supplyDrawNewShapeDefaults:d("./draw_newshape/defaults"),includeBasePlot:d("../../plots/cartesian/include_components")("shapes"),calcAutorange:d("./calc_autorange"),draw:w.draw,drawOne:w.drawOne}},{"../../plots/cartesian/include_components":577,"./attributes":457,"./calc_autorange":458,"./defaults":460,"./draw":462,"./draw_newshape/defaults":465}],471:[function(d,ee,te){var w=d("../../plots/font_attributes"),v=d("../../plots/pad_attributes"),S=d("../../lib/extend").extendDeepAll,M=d("../../plot_api/edit_types").overrideAll,e=d("../../plots/animation_attributes"),a=d("../../plot_api/plot_template").templatedArray,n=d("./constants"),r=a("step",{visible:{valType:"boolean",dflt:!0},method:{valType:"enumerated",values:["restyle","relayout","animate","update","skip"],dflt:"restyle"},args:{valType:"info_array",freeLength:!0,items:[{valType:"any"},{valType:"any"},{valType:"any"}]},label:{valType:"string"},value:{valType:"string"},execute:{valType:"boolean",dflt:!0}});ee.exports=M(a("slider",{visible:{valType:"boolean",dflt:!0},active:{valType:"number",min:0,dflt:0},steps:r,lenmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"fraction"},len:{valType:"number",min:0,dflt:1},x:{valType:"number",min:-2,max:3,dflt:0},pad:S(v({editType:"arraydraw"}),{},{t:{dflt:20}}),xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"left"},y:{valType:"number",min:-2,max:3,dflt:0},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"top"},transition:{duration:{valType:"number",min:0,dflt:150},easing:{valType:"enumerated",values:e.transition.easing.values,dflt:"cubic-in-out"}},currentvalue:{visible:{valType:"boolean",dflt:!0},xanchor:{valType:"enumerated",values:["left","center","right"],dflt:"left"},offset:{valType:"number",dflt:10},prefix:{valType:"string"},suffix:{valType:"string"},font:w({})},font:w({}),activebgcolor:{valType:"color",dflt:n.gripBgActiveColor},bgcolor:{valType:"color",dflt:n.railBgColor},bordercolor:{valType:"color",dflt:n.railBorderColor},borderwidth:{valType:"number",min:0,dflt:n.railBorderWidth},ticklen:{valType:"number",min:0,dflt:n.tickLength},tickcolor:{valType:"color",dflt:n.tickColor},tickwidth:{valType:"number",min:0,dflt:1},minorticklen:{valType:"number",min:0,dflt:n.minorTickLength}}),"arraydraw","from-root")},{"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plot_api/plot_template":555,"../../plots/animation_attributes":560,"../../plots/font_attributes":594,"../../plots/pad_attributes":627,"./constants":472}],472:[function(d,ee,te){ee.exports={name:"sliders",containerClassName:"slider-container",groupClassName:"slider-group",inputAreaClass:"slider-input-area",railRectClass:"slider-rail-rect",railTouchRectClass:"slider-rail-touch-rect",gripRectClass:"slider-grip-rect",tickRectClass:"slider-tick-rect",inputProxyClass:"slider-input-proxy",labelsClass:"slider-labels",labelGroupClass:"slider-label-group",labelClass:"slider-label",currentValueClass:"slider-current-value",railHeight:5,menuIndexAttrName:"slider-active-index",autoMarginIdRoot:"slider-",minWidth:30,minHeight:30,textPadX:40,arrowOffsetX:4,railRadius:2,railWidth:5,railBorder:4,railBorderWidth:1,railBorderColor:"#bec8d9",railBgColor:"#f8fafc",railInset:8,stepInset:10,gripRadius:10,gripWidth:20,gripHeight:20,gripBorder:20,gripBorderWidth:1,gripBorderColor:"#bec8d9",gripBgColor:"#f6f8fa",gripBgActiveColor:"#dbdde0",labelPadding:8,labelOffset:0,tickWidth:1,tickColor:"#333",tickOffset:25,tickLength:7,minorTickOffset:25,minorTickColor:"#333",minorTickLength:4,currentValuePadding:8,currentValueInset:0}},{}],473:[function(d,ee,te){var w=d("../../lib"),v=d("../../plots/array_container_defaults"),S=d("./attributes"),M=d("./constants"),e=M.name,a=S.steps;ee.exports=function(c,o){v(c,o,{name:e,handleItemDefaults:n})};function n(t,c,o){function i(s,A){return w.coerce(t,c,S,s,A)}for(var y=v(t,c,{name:"steps",handleItemDefaults:r}),p=0,g=0;g<y.length;g++)y[g].visible&&p++;var h;if(p<2?h=c.visible=!1:h=i("visible"),!!h){c._stepCount=p;var m=c._visibleSteps=w.filterVisible(y),u=i("active");(y[u]||{}).visible||(c.active=m[0]._index),i("x"),i("y"),w.noneOrAll(t,c,["x","y"]),i("xanchor"),i("yanchor"),i("len"),i("lenmode"),i("pad.t"),i("pad.r"),i("pad.b"),i("pad.l"),w.coerceFont(i,"font",o.font);var _=i("currentvalue.visible");_&&(i("currentvalue.xanchor"),i("currentvalue.prefix"),i("currentvalue.suffix"),i("currentvalue.offset"),w.coerceFont(i,"currentvalue.font",c.font)),i("transition.duration"),i("transition.easing"),i("bgcolor"),i("activebgcolor"),i("bordercolor"),i("borderwidth"),i("ticklen"),i("tickwidth"),i("tickcolor"),i("minorticklen")}}function r(t,c){function o(p,g){return w.coerce(t,c,a,p,g)}var i;if(t.method!=="skip"&&!Array.isArray(t.args)?i=c.visible=!1:i=o("visible"),i){o("method"),o("args");var y=o("label","step-"+c._index);o("value",y),o("execute")}}},{"../../lib":515,"../../plots/array_container_defaults":561,"./attributes":471,"./constants":472}],474:[function(d,ee,te){var w=d("@plotly/d3"),v=d("../../plots/plots"),S=d("../color"),M=d("../drawing"),e=d("../../lib"),a=e.strTranslate,n=d("../../lib/svg_text_utils"),r=d("../../plot_api/plot_template").arrayEditor,t=d("./constants"),c=d("../../constants/alignment"),o=c.LINE_SPACING,i=c.FROM_TL,y=c.FROM_BR;ee.exports=function(B){var F=B._fullLayout,H=g(F,B),G=F._infolayer.selectAll("g."+t.containerClassName).data(H.length>0?[0]:[]);G.enter().append("g").classed(t.containerClassName,!0).style("cursor","ew-resize");function J(oe){oe._commandObserver&&(oe._commandObserver.remove(),delete oe._commandObserver),v.autoMargin(B,p(oe))}if(G.exit().each(function(){w.select(this).selectAll("g."+t.groupClassName).each(J)}).remove(),H.length!==0){var X=G.selectAll("g."+t.groupClassName).data(H,h);X.enter().append("g").classed(t.groupClassName,!0),X.exit().each(J).remove();for(var Y=0;Y<H.length;Y++){var Z=H[Y];m(B,Z)}X.each(function(oe){var re=w.select(this);T(oe),v.manageCommandObserver(B,oe,oe._visibleSteps,function(se){var N=re.data()[0];N.active!==se.index&&(N._dragging||x(B,re,N,se.index,!1,!0))}),u(B,w.select(this),oe)})}};function p(R){return t.autoMarginIdRoot+R._index}function g(R,B){for(var F=R[t.name],H=[],G=0;G<F.length;G++){var J=F[G];!J.visible||(J._gd=B,H.push(J))}return H}function h(R){return R._index}function m(R,B){var F=M.tester.selectAll("g."+t.labelGroupClass).data(B._visibleSteps);F.enter().append("g").classed(t.labelGroupClass,!0);var H=0,G=0;F.each(function(q){var $=w.select(this),W=A($,{step:q},B),K=W.node();if(K){var ne=M.bBox(K);G=Math.max(G,ne.height),H=Math.max(H,ne.width)}}),F.remove();var J=B._dims={};J.inputAreaWidth=Math.max(t.railWidth,t.gripHeight);var X=R._fullLayout._size;J.lx=X.l+X.w*B.x,J.ly=X.t+X.h*(1-B.y),B.lenmode==="fraction"?J.outerLength=Math.round(X.w*B.len):J.outerLength=B.len,J.inputAreaStart=0,J.inputAreaLength=Math.round(J.outerLength-B.pad.l-B.pad.r);var Y=J.inputAreaLength-2*t.stepInset,Z=Y/(B._stepCount-1),oe=H+t.labelPadding;if(J.labelStride=Math.max(1,Math.ceil(oe/Z)),J.labelHeight=G,J.currentValueMaxWidth=0,J.currentValueHeight=0,J.currentValueTotalHeight=0,J.currentValueMaxLines=1,B.currentvalue.visible){var re=M.tester.append("g");F.each(function(q){var $=_(re,B,q.label),W=$.node()&&M.bBox($.node())||{width:0,height:0},K=n.lineCount($);J.currentValueMaxWidth=Math.max(J.currentValueMaxWidth,Math.ceil(W.width)),J.currentValueHeight=Math.max(J.currentValueHeight,Math.ceil(W.height)),J.currentValueMaxLines=Math.max(J.currentValueMaxLines,K)}),J.currentValueTotalHeight=J.currentValueHeight+B.currentvalue.offset,re.remove()}J.height=J.currentValueTotalHeight+t.tickOffset+B.ticklen+t.labelOffset+J.labelHeight+B.pad.t+B.pad.b;var se="left";e.isRightAnchor(B)&&(J.lx-=J.outerLength,se="right"),e.isCenterAnchor(B)&&(J.lx-=J.outerLength/2,se="center");var N="top";e.isBottomAnchor(B)&&(J.ly-=J.height,N="bottom"),e.isMiddleAnchor(B)&&(J.ly-=J.height/2,N="middle"),J.outerLength=Math.ceil(J.outerLength),J.height=Math.ceil(J.height),J.lx=Math.round(J.lx),J.ly=Math.round(J.ly);var U={y:B.y,b:J.height*y[N],t:J.height*i[N]};B.lenmode==="fraction"?(U.l=0,U.xl=B.x-B.len*i[se],U.r=0,U.xr=B.x+B.len*y[se]):(U.x=B.x,U.l=J.outerLength*i[se],U.r=J.outerLength*y[se]),v.autoMargin(R,p(B),U)}function u(R,B,F){(F.steps[F.active]||{}).visible||(F.active=F._visibleSteps[0]._index),B.call(_,F).call(D,F).call(b,F).call(L,F).call(I,R,F).call(s,R,F);var H=F._dims;M.setTranslate(B,H.lx+F.pad.l,H.ly+F.pad.t),B.call(k,F,!1),B.call(_,F)}function _(R,B,F){if(!!B.currentvalue.visible){var H=B._dims,G,J;switch(B.currentvalue.xanchor){case"right":G=H.inputAreaLength-t.currentValueInset-H.currentValueMaxWidth,J="left";break;case"center":G=H.inputAreaLength*.5,J="middle";break;default:G=t.currentValueInset,J="left"}var X=e.ensureSingle(R,"text",t.labelClass,function(N){N.attr({"text-anchor":J,"data-notex":1})}),Y=B.currentvalue.prefix?B.currentvalue.prefix:"";if(typeof F=="string")Y+=F;else{var Z=B.steps[B.active].label,oe=B._gd._fullLayout._meta;oe&&(Z=e.templateString(Z,oe)),Y+=Z}B.currentvalue.suffix&&(Y+=B.currentvalue.suffix),X.call(M.font,B.currentvalue.font).text(Y).call(n.convertToTspans,B._gd);var re=n.lineCount(X),se=(H.currentValueMaxLines+1-re)*B.currentvalue.font.size*o;return n.positionText(X,G,se),X}}function s(R,B,F){var H=e.ensureSingle(R,"rect",t.gripRectClass,function(G){G.call(l,B,R,F).style("pointer-events","all")});H.attr({width:t.gripWidth,height:t.gripHeight,rx:t.gripRadius,ry:t.gripRadius}).call(S.stroke,F.bordercolor).call(S.fill,F.bgcolor).style("stroke-width",F.borderwidth+"px")}function A(R,B,F){var H=e.ensureSingle(R,"text",t.labelClass,function(X){X.attr({"text-anchor":"middle","data-notex":1})}),G=B.step.label,J=F._gd._fullLayout._meta;return J&&(G=e.templateString(G,J)),H.call(M.font,F.font).text(G).call(n.convertToTspans,F._gd),H}function b(R,B){var F=e.ensureSingle(R,"g",t.labelsClass),H=B._dims,G=F.selectAll("g."+t.labelGroupClass).data(H.labelSteps);G.enter().append("g").classed(t.labelGroupClass,!0),G.exit().remove(),G.each(function(J){var X=w.select(this);X.call(A,J,B),M.setTranslate(X,P(B,J.fraction),t.tickOffset+B.ticklen+B.font.size*o+t.labelOffset+H.currentValueTotalHeight)})}function f(R,B,F,H,G){var J=Math.round(H*(F._stepCount-1)),X=F._visibleSteps[J]._index;X!==F.active&&x(R,B,F,X,!0,G)}function x(R,B,F,H,G,J){var X=F.active;F.active=H,r(R.layout,t.name,F).applyUpdate("active",H);var Y=F.steps[F.active];B.call(k,F,J),B.call(_,F),R.emit("plotly_sliderchange",{slider:F,step:F.steps[F.active],interaction:G,previousActive:X}),Y&&Y.method&&G&&(B._nextMethod?(B._nextMethod.step=Y,B._nextMethod.doCallback=G,B._nextMethod.doTransition=J):(B._nextMethod={step:Y,doCallback:G,doTransition:J},B._nextMethodRaf=window.requestAnimationFrame(function(){var Z=B._nextMethod.step;!Z.method||(Z.execute&&v.executeAPICommand(R,Z.method,Z.args),B._nextMethod=null,B._nextMethodRaf=null)})))}function l(R,B,F){var H=F.node(),G=w.select(B);function J(){return F.data()[0]}function X(){var Y=J();B.emit("plotly_sliderstart",{slider:Y});var Z=F.select("."+t.gripRectClass);w.event.stopPropagation(),w.event.preventDefault(),Z.call(S.fill,Y.activebgcolor);var oe=z(Y,w.mouse(H)[0]);f(B,F,Y,oe,!0),Y._dragging=!0;function re(){var N=J(),U=z(N,w.mouse(H)[0]);f(B,F,N,U,!1)}G.on("mousemove",re),G.on("touchmove",re);function se(){var N=J();N._dragging=!1,Z.call(S.fill,N.bgcolor),G.on("mouseup",null),G.on("mousemove",null),G.on("touchend",null),G.on("touchmove",null),B.emit("plotly_sliderend",{slider:N,step:N.steps[N.active]})}G.on("mouseup",se),G.on("touchend",se)}R.on("mousedown",X),R.on("touchstart",X)}function L(R,B){var F=R.selectAll("rect."+t.tickRectClass).data(B._visibleSteps),H=B._dims;F.enter().append("rect").classed(t.tickRectClass,!0),F.exit().remove(),F.attr({width:B.tickwidth+"px","shape-rendering":"crispEdges"}),F.each(function(G,J){var X=J%H.labelStride===0,Y=w.select(this);Y.attr({height:X?B.ticklen:B.minorticklen}).call(S.fill,B.tickcolor),M.setTranslate(Y,P(B,J/(B._stepCount-1))-.5*B.tickwidth,(X?t.tickOffset:t.minorTickOffset)+H.currentValueTotalHeight)})}function T(R){var B=R._dims;B.labelSteps=[];for(var F=R._stepCount,H=0;H<F;H+=B.labelStride)B.labelSteps.push({fraction:H/(F-1),step:R._visibleSteps[H]})}function k(R,B,F){for(var H=R.select("rect."+t.gripRectClass),G=0,J=0;J<B._stepCount;J++)if(B._visibleSteps[J]._index===B.active){G=J;break}var X=P(B,G/(B._stepCount-1));if(!B._invokingCommand){var Y=H;F&&B.transition.duration>0&&(Y=Y.transition().duration(B.transition.duration).ease(B.transition.easing)),Y.attr("transform",a(X-t.gripWidth*.5,B._dims.currentValueTotalHeight))}}function P(R,B){var F=R._dims;return F.inputAreaStart+t.stepInset+(F.inputAreaLength-2*t.stepInset)*Math.min(1,Math.max(0,B))}function z(R,B){var F=R._dims;return Math.min(1,Math.max(0,(B-t.stepInset-F.inputAreaStart)/(F.inputAreaLength-2*t.stepInset-2*F.inputAreaStart)))}function I(R,B,F){var H=F._dims,G=e.ensureSingle(R,"rect",t.railTouchRectClass,function(J){J.call(l,B,R,F).style("pointer-events","all")});G.attr({width:H.inputAreaLength,height:Math.max(H.inputAreaWidth,t.tickOffset+F.ticklen+H.labelHeight)}).call(S.fill,F.bgcolor).attr("opacity",0),M.setTranslate(G,0,H.currentValueTotalHeight)}function D(R,B){var F=B._dims,H=F.inputAreaLength-t.railInset*2,G=e.ensureSingle(R,"rect",t.railRectClass);G.attr({width:H,height:t.railWidth,rx:t.railRadius,ry:t.railRadius,"shape-rendering":"crispEdges"}).call(S.stroke,B.bordercolor).call(S.fill,B.bgcolor).style("stroke-width",B.borderwidth+"px"),M.setTranslate(G,t.railInset,(F.inputAreaWidth-t.railWidth)*.5+F.currentValueTotalHeight)}},{"../../constants/alignment":483,"../../lib":515,"../../lib/svg_text_utils":541,"../../plot_api/plot_template":555,"../../plots/plots":628,"../color":367,"../drawing":389,"./constants":472,"@plotly/d3":58}],475:[function(d,ee,te){var w=d("./constants");ee.exports={moduleType:"component",name:w.name,layoutAttributes:d("./attributes"),supplyLayoutDefaults:d("./defaults"),draw:d("./draw")}},{"./attributes":471,"./constants":472,"./defaults":473,"./draw":474}],476:[function(d,ee,te){var w=d("@plotly/d3"),v=d("fast-isnumeric"),S=d("../../plots/plots"),M=d("../../registry"),e=d("../../lib"),a=e.strTranslate,n=d("../drawing"),r=d("../color"),t=d("../../lib/svg_text_utils"),c=d("../../constants/interactions"),o=d("../../constants/alignment").OPPOSITE_SIDE,i=/ [XY][0-9]* /;function y(p,g,h){var m=h.propContainer,u=h.propName,_=h.placeholder,s=h.traceIndex,A=h.avoid||{},b=h.attributes,f=h.transform,x=h.containerGroup,l=p._fullLayout,L=1,T=!1,k=m.title,P=(k&&k.text?k.text:"").trim(),z=k&&k.font?k.font:{},I=z.family,D=z.size,R=z.color,B;u==="title.text"?B="titleText":u.indexOf("axis")!==-1?B="axisTitleText":u.indexOf("colorbar"!==-1)&&(B="colorbarTitleText");var F=p._context.edits[B];P===""?L=0:P.replace(i," % ")===_.replace(i," % ")&&(L=.2,T=!0,F||(P="")),h._meta?P=e.templateString(P,h._meta):l._meta&&(P=e.templateString(P,l._meta));var H=P||F,G;x||(x=e.ensureSingle(l._infolayer,"g","g-"+g),G=l._hColorbarMoveTitle);var J=x.selectAll("text").data(H?[0]:[]);if(J.enter().append("text"),J.text(P).attr("class",g),J.exit().remove(),!H)return x;function X(re){e.syncOrAsync([Y,Z],re)}function Y(re){var se;return!f&&G&&(f={}),f?(se="",f.rotate&&(se+="rotate("+[f.rotate,b.x,b.y]+")"),(f.offset||G)&&(se+=a(0,(f.offset||0)-(G||0)))):se=null,re.attr("transform",se),re.style({"font-family":I,"font-size":w.round(D,2)+"px",fill:r.rgb(R),opacity:L*r.opacity(R),"font-weight":S.fontWeight}).attr(b).call(t.convertToTspans,p),S.previousPromises(p)}function Z(re){var se=w.select(re.node().parentNode);if(A&&A.selection&&A.side&&P){se.attr("transform",null);var N=o[A.side],U=A.side==="left"||A.side==="top"?-1:1,q=v(A.pad)?A.pad:2,$=n.bBox(se.node()),W={left:0,top:0,right:l.width,bottom:l.height},K=A.maxShift||U*(W[A.side]-$[A.side]),ne=0;if(K<0)ne=K;else{var ae=A.offsetLeft||0,ie=A.offsetTop||0;$.left-=ae,$.right-=ae,$.top-=ie,$.bottom-=ie,A.selection.each(function(){var ye=n.bBox(this);e.bBoxIntersect($,ye,q)&&(ne=Math.max(ne,U*(ye[A.side]-$[N])+q))}),ne=Math.min(K,ne)}if(ne>0||K<0){var le={left:[-ne,0],right:[ne,0],top:[0,-ne],bottom:[0,ne]}[A.side];se.attr("transform",a(le[0],le[1]))}}}J.call(X);function oe(){L=0,T=!0,J.text(_).on("mouseover.opacity",function(){w.select(this).transition().duration(c.SHOW_PLACEHOLDER).style("opacity",1)}).on("mouseout.opacity",function(){w.select(this).transition().duration(c.HIDE_PLACEHOLDER).style("opacity",0)})}return F&&(P?J.on(".opacity",null):oe(),J.call(t.makeEditable,{gd:p}).on("edit",function(re){s!==void 0?M.call("_guiRestyle",p,u,re,s):M.call("_guiRelayout",p,u,re)}).on("cancel",function(){this.text(this.attr("data-unformatted")).call(X)}).on("input",function(re){this.text(re||" ").call(t.positionText,b.x,b.y)})),J.classed("js-placeholder",T),x}ee.exports={draw:y}},{"../../constants/alignment":483,"../../constants/interactions":490,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/plots":628,"../../registry":647,"../color":367,"../drawing":389,"@plotly/d3":58,"fast-isnumeric":190}],477:[function(d,ee,te){var w=d("../../plots/font_attributes"),v=d("../color/attributes"),S=d("../../lib/extend").extendFlat,M=d("../../plot_api/edit_types").overrideAll,e=d("../../plots/pad_attributes"),a=d("../../plot_api/plot_template").templatedArray,n=a("button",{visible:{valType:"boolean"},method:{valType:"enumerated",values:["restyle","relayout","animate","update","skip"],dflt:"restyle"},args:{valType:"info_array",freeLength:!0,items:[{valType:"any"},{valType:"any"},{valType:"any"}]},args2:{valType:"info_array",freeLength:!0,items:[{valType:"any"},{valType:"any"},{valType:"any"}]},label:{valType:"string",dflt:""},execute:{valType:"boolean",dflt:!0}});ee.exports=M(a("updatemenu",{_arrayAttrRegexps:[/^updatemenus\[(0|[1-9][0-9]+)\]\.buttons/],visible:{valType:"boolean"},type:{valType:"enumerated",values:["dropdown","buttons"],dflt:"dropdown"},direction:{valType:"enumerated",values:["left","right","up","down"],dflt:"down"},active:{valType:"integer",min:-1,dflt:0},showactive:{valType:"boolean",dflt:!0},buttons:n,x:{valType:"number",min:-2,max:3,dflt:-.05},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"right"},y:{valType:"number",min:-2,max:3,dflt:1},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"top"},pad:S(e({editType:"arraydraw"}),{}),font:w({}),bgcolor:{valType:"color"},bordercolor:{valType:"color",dflt:v.borderLine},borderwidth:{valType:"number",min:0,dflt:1,editType:"arraydraw"}}),"arraydraw","from-root")},{"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plot_api/plot_template":555,"../../plots/font_attributes":594,"../../plots/pad_attributes":627,"../color/attributes":366}],478:[function(d,ee,te){ee.exports={name:"updatemenus",containerClassName:"updatemenu-container",headerGroupClassName:"updatemenu-header-group",headerClassName:"updatemenu-header",headerArrowClassName:"updatemenu-header-arrow",dropdownButtonGroupClassName:"updatemenu-dropdown-button-group",dropdownButtonClassName:"updatemenu-dropdown-button",buttonClassName:"updatemenu-button",itemRectClassName:"updatemenu-item-rect",itemTextClassName:"updatemenu-item-text",menuIndexAttrName:"updatemenu-active-index",autoMarginIdRoot:"updatemenu-",blankHeaderOpts:{label:"  "},minWidth:30,minHeight:30,textPadX:24,arrowPadX:16,rx:2,ry:2,textOffsetX:12,textOffsetY:3,arrowOffsetX:4,gapButtonHeader:5,gapButton:2,activeColor:"#F4FAFF",hoverColor:"#F4FAFF",arrowSymbol:{left:"\u25C4",right:"\u25BA",up:"\u25B2",down:"\u25BC"}}},{}],479:[function(d,ee,te){var w=d("../../lib"),v=d("../../plots/array_container_defaults"),S=d("./attributes"),M=d("./constants"),e=M.name,a=S.buttons;ee.exports=function(c,o){var i={name:e,handleItemDefaults:n};v(c,o,i)};function n(t,c,o){function i(g,h){return w.coerce(t,c,S,g,h)}var y=v(t,c,{name:"buttons",handleItemDefaults:r}),p=i("visible",y.length>0);!p||(i("active"),i("direction"),i("type"),i("showactive"),i("x"),i("y"),w.noneOrAll(t,c,["x","y"]),i("xanchor"),i("yanchor"),i("pad.t"),i("pad.r"),i("pad.b"),i("pad.l"),w.coerceFont(i,"font",o.font),i("bgcolor",o.paper_bgcolor),i("bordercolor"),i("borderwidth"))}function r(t,c){function o(y,p){return w.coerce(t,c,a,y,p)}var i=o("visible",t.method==="skip"||Array.isArray(t.args));i&&(o("method"),o("args"),o("args2"),o("label"),o("execute"))}},{"../../lib":515,"../../plots/array_container_defaults":561,"./attributes":477,"./constants":478}],480:[function(d,ee,te){var w=d("@plotly/d3"),v=d("../../plots/plots"),S=d("../color"),M=d("../drawing"),e=d("../../lib"),a=d("../../lib/svg_text_utils"),n=d("../../plot_api/plot_template").arrayEditor,r=d("../../constants/alignment").LINE_SPACING,t=d("./constants"),c=d("./scrollbox");ee.exports=function(z){var I=z._fullLayout,D=e.filterVisible(I[t.name]);function R(Z){v.autoMargin(z,L(Z))}var B=I._menulayer.selectAll("g."+t.containerClassName).data(D.length>0?[0]:[]);if(B.enter().append("g").classed(t.containerClassName,!0).style("cursor","pointer"),B.exit().each(function(){w.select(this).selectAll("g."+t.headerGroupClassName).each(R)}).remove(),D.length!==0){var F=B.selectAll("g."+t.headerGroupClassName).data(D,o);F.enter().append("g").classed(t.headerGroupClassName,!0);for(var H=e.ensureSingle(B,"g",t.dropdownButtonGroupClassName,function(Z){Z.style("pointer-events","all")}),G=0;G<D.length;G++){var J=D[G];l(z,J)}var X="updatemenus"+I._uid,Y=new c(z,H,X);F.enter().size()&&(H.node().parentNode.appendChild(H.node()),H.call(k)),F.exit().each(function(Z){H.call(k),R(Z)}).remove(),F.each(function(Z){var oe=w.select(this),re=Z.type==="dropdown"?H:null;v.manageCommandObserver(z,Z,Z.buttons,function(se){p(z,Z,Z.buttons[se.index],oe,re,Y,se.index,!0)}),Z.type==="dropdown"?(g(z,oe,H,Y,Z),y(H,Z)&&h(z,oe,H,Y,Z)):h(z,oe,null,null,Z)})}};function o(P){return P._index}function i(P){return+P.attr(t.menuIndexAttrName)==-1}function y(P,z){return+P.attr(t.menuIndexAttrName)===z._index}function p(P,z,I,D,R,B,F,H){z.active=F,n(P.layout,t.name,z).applyUpdate("active",F),z.type==="buttons"?h(P,D,null,null,z):z.type==="dropdown"&&(R.attr(t.menuIndexAttrName,"-1"),g(P,D,R,B,z),H||h(P,D,R,B,z))}function g(P,z,I,D,R){var B=e.ensureSingle(z,"g",t.headerClassName,function(Z){Z.style("pointer-events","all")}),F=R._dims,H=R.active,G=R.buttons[H]||t.blankHeaderOpts,J={y:R.pad.t,yPad:0,x:R.pad.l,xPad:0,index:0},X={width:F.headerWidth,height:F.headerHeight};B.call(_,R,G,P).call(T,R,J,X);var Y=e.ensureSingle(z,"text",t.headerArrowClassName,function(Z){Z.attr("text-anchor","end").call(M.font,R.font).text(t.arrowSymbol[R.direction])});Y.attr({x:F.headerWidth-t.arrowOffsetX+R.pad.l,y:F.headerHeight/2+t.textOffsetY+R.pad.t}),B.on("click",function(){I.call(k,String(y(I,R)?-1:R._index)),h(P,z,I,D,R)}),B.on("mouseover",function(){B.call(f)}),B.on("mouseout",function(){B.call(x,R)}),M.setTranslate(z,F.lx,F.ly)}function h(P,z,I,D,R){I||(I=z,I.attr("pointer-events","all"));var B=!i(I)||R.type==="buttons"?R.buttons:[],F=R.type==="dropdown"?t.dropdownButtonClassName:t.buttonClassName,H=I.selectAll("g."+F).data(e.filterVisible(B)),G=H.enter().append("g").classed(F,!0),J=H.exit();R.type==="dropdown"?(G.attr("opacity","0").transition().attr("opacity","1"),J.transition().attr("opacity","0").remove()):J.remove();var X=0,Y=0,Z=R._dims,oe=["up","down"].indexOf(R.direction)!==-1;R.type==="dropdown"&&(oe?Y=Z.headerHeight+t.gapButtonHeader:X=Z.headerWidth+t.gapButtonHeader),R.type==="dropdown"&&R.direction==="up"&&(Y=-t.gapButtonHeader+t.gapButton-Z.openHeight),R.type==="dropdown"&&R.direction==="left"&&(X=-t.gapButtonHeader+t.gapButton-Z.openWidth);var re={x:Z.lx+X+R.pad.l,y:Z.ly+Y+R.pad.t,yPad:t.gapButton,xPad:t.gapButton,index:0},se={l:re.x+R.borderwidth,t:re.y+R.borderwidth};H.each(function(N,U){var q=w.select(this);q.call(_,R,N,P).call(T,R,re),q.on("click",function(){w.event.defaultPrevented||(N.execute&&(N.args2&&R.active===U?(p(P,R,N,z,I,D,-1),v.executeAPICommand(P,N.method,N.args2)):(p(P,R,N,z,I,D,U),v.executeAPICommand(P,N.method,N.args))),P.emit("plotly_buttonclicked",{menu:R,button:N,active:R.active}))}),q.on("mouseover",function(){q.call(f)}),q.on("mouseout",function(){q.call(x,R),H.call(b,R)})}),H.call(b,R),oe?(se.w=Math.max(Z.openWidth,Z.headerWidth),se.h=re.y-se.t):(se.w=re.x-se.l,se.h=Math.max(Z.openHeight,Z.headerHeight)),se.direction=R.direction,D&&(H.size()?m(P,z,I,D,R,se):u(D))}function m(P,z,I,D,R,B){var F=R.direction,H=F==="up"||F==="down",G=R._dims,J=R.active,X,Y,Z;if(H)for(Y=0,Z=0;Z<J;Z++)Y+=G.heights[Z]+t.gapButton;else for(X=0,Z=0;Z<J;Z++)X+=G.widths[Z]+t.gapButton;D.enable(B,X,Y),D.hbar&&D.hbar.attr("opacity","0").transition().attr("opacity","1"),D.vbar&&D.vbar.attr("opacity","0").transition().attr("opacity","1")}function u(P){var z=!!P.hbar,I=!!P.vbar;z&&P.hbar.transition().attr("opacity","0").each("end",function(){z=!1,I||P.disable()}),I&&P.vbar.transition().attr("opacity","0").each("end",function(){I=!1,z||P.disable()})}function _(P,z,I,D){P.call(s,z).call(A,z,I,D)}function s(P,z){var I=e.ensureSingle(P,"rect",t.itemRectClassName,function(D){D.attr({rx:t.rx,ry:t.ry,"shape-rendering":"crispEdges"})});I.call(S.stroke,z.bordercolor).call(S.fill,z.bgcolor).style("stroke-width",z.borderwidth+"px")}function A(P,z,I,D){var R=e.ensureSingle(P,"text",t.itemTextClassName,function(H){H.attr({"text-anchor":"start","data-notex":1})}),B=I.label,F=D._fullLayout._meta;F&&(B=e.templateString(B,F)),R.call(M.font,z.font).text(B).call(a.convertToTspans,D)}function b(P,z){var I=z.active;P.each(function(D,R){var B=w.select(this);R===I&&z.showactive&&B.select("rect."+t.itemRectClassName).call(S.fill,t.activeColor)})}function f(P){P.select("rect."+t.itemRectClassName).call(S.fill,t.hoverColor)}function x(P,z){P.select("rect."+t.itemRectClassName).call(S.fill,z.bgcolor)}function l(P,z){var I=z._dims={width1:0,height1:0,heights:[],widths:[],totalWidth:0,totalHeight:0,openWidth:0,openHeight:0,lx:0,ly:0},D=M.tester.selectAll("g."+t.dropdownButtonClassName).data(e.filterVisible(z.buttons));D.enter().append("g").classed(t.dropdownButtonClassName,!0);var R=["up","down"].indexOf(z.direction)!==-1;D.each(function(X,Y){var Z=w.select(this);Z.call(_,z,X,P);var oe=Z.select("."+t.itemTextClassName),re=oe.node()&&M.bBox(oe.node()).width,se=Math.max(re+t.textPadX,t.minWidth),N=z.font.size*r,U=a.lineCount(oe),q=Math.max(N*U,t.minHeight)+t.textOffsetY;q=Math.ceil(q),se=Math.ceil(se),I.widths[Y]=se,I.heights[Y]=q,I.height1=Math.max(I.height1,q),I.width1=Math.max(I.width1,se),R?(I.totalWidth=Math.max(I.totalWidth,se),I.openWidth=I.totalWidth,I.totalHeight+=q+t.gapButton,I.openHeight+=q+t.gapButton):(I.totalWidth+=se+t.gapButton,I.openWidth+=se+t.gapButton,I.totalHeight=Math.max(I.totalHeight,q),I.openHeight=I.totalHeight)}),R?I.totalHeight-=t.gapButton:I.totalWidth-=t.gapButton,I.headerWidth=I.width1+t.arrowPadX,I.headerHeight=I.height1,z.type==="dropdown"&&(R?(I.width1+=t.arrowPadX,I.totalHeight=I.height1):I.totalWidth=I.width1,I.totalWidth+=t.arrowPadX),D.remove();var B=I.totalWidth+z.pad.l+z.pad.r,F=I.totalHeight+z.pad.t+z.pad.b,H=P._fullLayout._size;I.lx=H.l+H.w*z.x,I.ly=H.t+H.h*(1-z.y);var G="left";e.isRightAnchor(z)&&(I.lx-=B,G="right"),e.isCenterAnchor(z)&&(I.lx-=B/2,G="center");var J="top";e.isBottomAnchor(z)&&(I.ly-=F,J="bottom"),e.isMiddleAnchor(z)&&(I.ly-=F/2,J="middle"),I.totalWidth=Math.ceil(I.totalWidth),I.totalHeight=Math.ceil(I.totalHeight),I.lx=Math.round(I.lx),I.ly=Math.round(I.ly),v.autoMargin(P,L(z),{x:z.x,y:z.y,l:B*({right:1,center:.5}[G]||0),r:B*({left:1,center:.5}[G]||0),b:F*({top:1,middle:.5}[J]||0),t:F*({bottom:1,middle:.5}[J]||0)})}function L(P){return t.autoMarginIdRoot+P._index}function T(P,z,I,D){D=D||{};var R=P.select("."+t.itemRectClassName),B=P.select("."+t.itemTextClassName),F=z.borderwidth,H=I.index,G=z._dims;M.setTranslate(P,F+I.x,F+I.y);var J=["up","down"].indexOf(z.direction)!==-1,X=D.height||(J?G.heights[H]:G.height1);R.attr({x:0,y:0,width:D.width||(J?G.width1:G.widths[H]),height:X});var Y=z.font.size*r,Z=a.lineCount(B),oe=(Z-1)*Y/2;a.positionText(B,t.textOffsetX,X/2-oe+t.textOffsetY),J?I.y+=G.heights[H]+I.yPad:I.x+=G.widths[H]+I.xPad,I.index++}function k(P,z){P.attr(t.menuIndexAttrName,z||"-1").selectAll("g."+t.dropdownButtonClassName).remove()}},{"../../constants/alignment":483,"../../lib":515,"../../lib/svg_text_utils":541,"../../plot_api/plot_template":555,"../../plots/plots":628,"../color":367,"../drawing":389,"./constants":478,"./scrollbox":482,"@plotly/d3":58}],481:[function(d,ee,te){arguments[4][475][0].apply(te,arguments)},{"./attributes":477,"./constants":478,"./defaults":479,"./draw":480,dup:475}],482:[function(d,ee,te){ee.exports=e;var w=d("@plotly/d3"),v=d("../color"),S=d("../drawing"),M=d("../../lib");function e(a,n,r){this.gd=a,this.container=n,this.id=r,this.position=null,this.translateX=null,this.translateY=null,this.hbar=null,this.vbar=null,this.bg=this.container.selectAll("rect.scrollbox-bg").data([0]),this.bg.exit().on(".drag",null).on("wheel",null).remove(),this.bg.enter().append("rect").classed("scrollbox-bg",!0).style("pointer-events","all").attr({opacity:0,x:0,y:0,width:0,height:0})}e.barWidth=2,e.barLength=20,e.barRadius=2,e.barPad=1,e.barColor="#808BA4",e.prototype.enable=function(n,r,t){var c=this.gd._fullLayout,o=c.width,i=c.height;this.position=n;var y=this.position.l,p=this.position.w,g=this.position.t,h=this.position.h,m=this.position.direction,u=m==="down",_=m==="left",s=m==="right",A=m==="up",b=p,f=h,x,l,L,T;!u&&!_&&!s&&!A&&(this.position.direction="down",u=!0);var k=u||A;k?(x=y,l=x+b,u?(L=g,T=Math.min(L+f,i),f=T-L):(T=g+f,L=Math.max(T-f,0),f=T-L)):(L=g,T=L+f,_?(l=y+b,x=Math.max(l-b,0),b=l-x):(x=y,l=Math.min(x+b,o),b=l-x)),this._box={l:x,t:L,w:b,h:f};var P=p>b,z=e.barLength+2*e.barPad,I=e.barWidth+2*e.barPad,D=y,R=g+h;R+I>i&&(R=i-I);var B=this.container.selectAll("rect.scrollbar-horizontal").data(P?[0]:[]);B.exit().on(".drag",null).remove(),B.enter().append("rect").classed("scrollbar-horizontal",!0).call(v.fill,e.barColor),P?(this.hbar=B.attr({rx:e.barRadius,ry:e.barRadius,x:D,y:R,width:z,height:I}),this._hbarXMin=D+z/2,this._hbarTranslateMax=b-z):(delete this.hbar,delete this._hbarXMin,delete this._hbarTranslateMax);var F=h>f,H=e.barWidth+2*e.barPad,G=e.barLength+2*e.barPad,J=y+p,X=g;J+H>o&&(J=o-H);var Y=this.container.selectAll("rect.scrollbar-vertical").data(F?[0]:[]);Y.exit().on(".drag",null).remove(),Y.enter().append("rect").classed("scrollbar-vertical",!0).call(v.fill,e.barColor),F?(this.vbar=Y.attr({rx:e.barRadius,ry:e.barRadius,x:J,y:X,width:H,height:G}),this._vbarYMin=X+G/2,this._vbarTranslateMax=f-G):(delete this.vbar,delete this._vbarYMin,delete this._vbarTranslateMax);var Z=this.id,oe=x-.5,re=F?l+H+.5:l+.5,se=L-.5,N=P?T+I+.5:T+.5,U=c._topdefs.selectAll("#"+Z).data(P||F?[0]:[]);if(U.exit().remove(),U.enter().append("clipPath").attr("id",Z).append("rect"),P||F?(this._clipRect=U.select("rect").attr({x:Math.floor(oe),y:Math.floor(se),width:Math.ceil(re)-Math.floor(oe),height:Math.ceil(N)-Math.floor(se)}),this.container.call(S.setClipUrl,Z,this.gd),this.bg.attr({x:y,y:g,width:p,height:h})):(this.bg.attr({width:0,height:0}),this.container.on("wheel",null).on(".drag",null).call(S.setClipUrl,null),delete this._clipRect),P||F){var q=w.behavior.drag().on("dragstart",function(){w.event.sourceEvent.preventDefault()}).on("drag",this._onBoxDrag.bind(this));this.container.on("wheel",null).on("wheel",this._onBoxWheel.bind(this)).on(".drag",null).call(q);var $=w.behavior.drag().on("dragstart",function(){w.event.sourceEvent.preventDefault(),w.event.sourceEvent.stopPropagation()}).on("drag",this._onBarDrag.bind(this));P&&this.hbar.on(".drag",null).call($),F&&this.vbar.on(".drag",null).call($)}this.setTranslate(r,t)},e.prototype.disable=function(){(this.hbar||this.vbar)&&(this.bg.attr({width:0,height:0}),this.container.on("wheel",null).on(".drag",null).call(S.setClipUrl,null),delete this._clipRect),this.hbar&&(this.hbar.on(".drag",null),this.hbar.remove(),delete this.hbar,delete this._hbarXMin,delete this._hbarTranslateMax),this.vbar&&(this.vbar.on(".drag",null),this.vbar.remove(),delete this.vbar,delete this._vbarYMin,delete this._vbarTranslateMax)},e.prototype._onBoxDrag=function(){var n=this.translateX,r=this.translateY;this.hbar&&(n-=w.event.dx),this.vbar&&(r-=w.event.dy),this.setTranslate(n,r)},e.prototype._onBoxWheel=function(){var n=this.translateX,r=this.translateY;this.hbar&&(n+=w.event.deltaY),this.vbar&&(r+=w.event.deltaY),this.setTranslate(n,r)},e.prototype._onBarDrag=function(){var n=this.translateX,r=this.translateY;if(this.hbar){var t=n+this._hbarXMin,c=t+this._hbarTranslateMax,o=M.constrain(w.event.x,t,c),i=(o-t)/(c-t),y=this.position.w-this._box.w;n=i*y}if(this.vbar){var p=r+this._vbarYMin,g=p+this._vbarTranslateMax,h=M.constrain(w.event.y,p,g),m=(h-p)/(g-p),u=this.position.h-this._box.h;r=m*u}this.setTranslate(n,r)},e.prototype.setTranslate=function(n,r){var t=this.position.w-this._box.w,c=this.position.h-this._box.h;if(n=M.constrain(n||0,0,t),r=M.constrain(r||0,0,c),this.translateX=n,this.translateY=r,this.container.call(S.setTranslate,this._box.l-this.position.l-n,this._box.t-this.position.t-r),this._clipRect&&this._clipRect.attr({x:Math.floor(this.position.l+n-.5),y:Math.floor(this.position.t+r-.5)}),this.hbar){var o=n/t;this.hbar.call(S.setTranslate,n+o*this._hbarTranslateMax,r)}if(this.vbar){var i=r/c;this.vbar.call(S.setTranslate,n,r+i*this._vbarTranslateMax)}}},{"../../lib":515,"../color":367,"../drawing":389,"@plotly/d3":58}],483:[function(d,ee,te){ee.exports={FROM_BL:{left:0,center:.5,right:1,bottom:0,middle:.5,top:1},FROM_TL:{left:0,center:.5,right:1,bottom:1,middle:.5,top:0},FROM_BR:{left:1,center:.5,right:0,bottom:0,middle:.5,top:1},LINE_SPACING:1.3,CAP_SHIFT:.7,MID_SHIFT:.35,OPPOSITE_SIDE:{left:"right",right:"left",top:"bottom",bottom:"top"}}},{}],484:[function(d,ee,te){ee.exports={axisRefDescription:function(w,v,S){return["If set to a",w,"axis id (e.g. *"+w+"* or","*"+w+"2*), the `"+w+"` position refers to a",w,"coordinate. If set to *paper*, the `"+w+"`","position refers to the distance from the",v,"of the plotting","area in normalized coordinates where *0* (*1*) corresponds to the",v,"("+S+"). If set to a",w,"axis ID followed by","*domain* (separated by a space), the position behaves like for","*paper*, but refers to the distance in fractions of the domain","length from the",v,"of the domain of that axis: e.g.,","*"+w+"2 domain* refers to the domain of the second",w," axis and a",w,"position of 0.5 refers to the","point between the",v,"and the",S,"of the domain of the","second",w,"axis."].join(" ")}}},{}],485:[function(d,ee,te){ee.exports={INCREASING:{COLOR:"#3D9970",SYMBOL:"\u25B2"},DECREASING:{COLOR:"#FF4136",SYMBOL:"\u25BC"}}},{}],486:[function(d,ee,te){ee.exports={FORMAT_LINK:"https://github.com/d3/d3-format/tree/v1.4.5#d3-format",DATE_FORMAT_LINK:"https://github.com/d3/d3-time-format/tree/v2.2.3#locale_format"}},{}],487:[function(d,ee,te){ee.exports={COMPARISON_OPS:["=","!=","<",">=",">","<="],COMPARISON_OPS2:["=","<",">=",">","<="],INTERVAL_OPS:["[]","()","[)","(]","][",")(","](",")["],SET_OPS:["{}","}{"],CONSTRAINT_REDUCTION:{"=":"=","<":"<","<=":"<",">":">",">=":">","[]":"[]","()":"[]","[)":"[]","(]":"[]","][":"][",")(":"][","](":"][",")[":"]["}}},{}],488:[function(d,ee,te){ee.exports={solid:[[],0],dot:[[.5,1],200],dash:[[.5,1],50],longdash:[[.5,1],10],dashdot:[[.5,.625,.875,1],50],longdashdot:[[.5,.7,.8,1],10]}},{}],489:[function(d,ee,te){ee.exports={circle:"\u25CF","circle-open":"\u25CB",square:"\u25A0","square-open":"\u25A1",diamond:"\u25C6","diamond-open":"\u25C7",cross:"+",x:"\u274C"}},{}],490:[function(d,ee,te){ee.exports={SHOW_PLACEHOLDER:100,HIDE_PLACEHOLDER:1e3,DESELECTDIM:.2}},{}],491:[function(d,ee,te){ee.exports={BADNUM:void 0,FP_SAFE:Number.MAX_VALUE*1e-4,ONEMAXYEAR:316224e5,ONEAVGYEAR:315576e5,ONEMINYEAR:31536e6,ONEMAXQUARTER:79488e5,ONEAVGQUARTER:78894e5,ONEMINQUARTER:76896e5,ONEMAXMONTH:26784e5,ONEAVGMONTH:26298e5,ONEMINMONTH:24192e5,ONEWEEK:6048e5,ONEDAY:864e5,ONEHOUR:36e5,ONEMIN:6e4,ONESEC:1e3,EPOCHJD:24405875e-1,ALMOST_EQUAL:1-1e-6,LOG_CLIP:10,MINUS_SIGN:"\u2212"}},{}],492:[function(d,ee,te){te.xmlns="http://www.w3.org/2000/xmlns/",te.svg="http://www.w3.org/2000/svg",te.xlink="http://www.w3.org/1999/xlink",te.svgAttrs={xmlns:te.svg,"xmlns:xlink":te.xlink}},{}],493:[function(d,ee,te){te.version=d("./version").version,d("native-promise-only"),d("../build/plotcss");for(var w=d("./registry"),v=te.register=w.register,S=d("./plot_api"),M=Object.keys(S),e=0;e<M.length;e++){var a=M[e];a.charAt(0)!=="_"&&(te[a]=S[a]),v({moduleType:"apiMethod",name:a,fn:S[a]})}v(d("./traces/scatter")),v([d("./components/legend"),d("./components/fx"),d("./components/annotations"),d("./components/annotations3d"),d("./components/selections"),d("./components/shapes"),d("./components/images"),d("./components/updatemenus"),d("./components/sliders"),d("./components/rangeslider"),d("./components/rangeselector"),d("./components/grid"),d("./components/errorbars"),d("./components/colorscale"),d("./components/colorbar"),d("./components/modebar")]),v([d("./locale-en"),d("./locale-en-us")]),window.PlotlyLocales&&Array.isArray(window.PlotlyLocales)&&(v(window.PlotlyLocales),delete window.PlotlyLocales),te.Icons=d("./fonts/ploticon");var n=d("./components/fx"),r=d("./plots/plots");te.Plots={resize:r.resize,graphJson:r.graphJson,sendDataToCloud:r.sendDataToCloud},te.Fx={hover:n.hover,unhover:n.unhover,loneHover:n.loneHover,loneUnhover:n.loneUnhover},te.Snapshot=d("./snapshot"),te.PlotSchema=d("./plot_api/plot_schema")},{"../build/plotcss":1,"./components/annotations":358,"./components/annotations3d":363,"./components/colorbar":373,"./components/colorscale":379,"./components/errorbars":395,"./components/fx":407,"./components/grid":411,"./components/images":416,"./components/legend":424,"./components/modebar":430,"./components/rangeselector":438,"./components/rangeslider":445,"./components/selections":455,"./components/shapes":470,"./components/sliders":475,"./components/updatemenus":481,"./fonts/ploticon":494,"./locale-en":546,"./locale-en-us":545,"./plot_api":550,"./plot_api/plot_schema":554,"./plots/plots":628,"./registry":647,"./snapshot":652,"./traces/scatter":948,"./version":1132,"native-promise-only":245}],494:[function(d,ee,te){ee.exports={undo:{width:857.1,height:1e3,path:"m857 350q0-87-34-166t-91-137-137-92-166-34q-96 0-183 41t-147 114q-4 6-4 13t5 11l76 77q6 5 14 5 9-1 13-7 41-53 100-82t126-29q58 0 110 23t92 61 61 91 22 111-22 111-61 91-92 61-110 23q-55 0-105-20t-90-57l77-77q17-16 8-38-10-23-33-23h-250q-15 0-25 11t-11 25v250q0 24 22 33 22 10 39-8l72-72q60 57 137 88t159 31q87 0 166-34t137-92 91-137 34-166z",transform:"matrix(1 0 0 -1 0 850)"},home:{width:928.6,height:1e3,path:"m786 296v-267q0-15-11-26t-25-10h-214v214h-143v-214h-214q-15 0-25 10t-11 26v267q0 1 0 2t0 2l321 264 321-264q1-1 1-4z m124 39l-34-41q-5-5-12-6h-2q-7 0-12 3l-386 322-386-322q-7-4-13-4-7 2-12 7l-35 41q-4 5-3 13t6 12l401 334q18 15 42 15t43-15l136-114v109q0 8 5 13t13 5h107q8 0 13-5t5-13v-227l122-102q5-5 6-12t-4-13z",transform:"matrix(1 0 0 -1 0 850)"},"camera-retro":{width:1e3,height:1e3,path:"m518 386q0 8-5 13t-13 5q-37 0-63-27t-26-63q0-8 5-13t13-5 12 5 5 13q0 23 16 38t38 16q8 0 13 5t5 13z m125-73q0-59-42-101t-101-42-101 42-42 101 42 101 101 42 101-42 42-101z m-572-320h858v71h-858v-71z m643 320q0 89-62 152t-152 62-151-62-63-152 63-151 151-63 152 63 62 151z m-571 358h214v72h-214v-72z m-72-107h858v143h-462l-36-71h-360v-72z m929 143v-714q0-30-21-51t-50-21h-858q-29 0-50 21t-21 51v714q0 30 21 51t50 21h858q29 0 50-21t21-51z",transform:"matrix(1 0 0 -1 0 850)"},zoombox:{width:1e3,height:1e3,path:"m1000-25l-250 251c40 63 63 138 63 218 0 224-182 406-407 406-224 0-406-182-406-406s183-406 407-406c80 0 155 22 218 62l250-250 125 125z m-812 250l0 438 437 0 0-438-437 0z m62 375l313 0 0-312-313 0 0 312z",transform:"matrix(1 0 0 -1 0 850)"},pan:{width:1e3,height:1e3,path:"m1000 350l-187 188 0-125-250 0 0 250 125 0-188 187-187-187 125 0 0-250-250 0 0 125-188-188 186-187 0 125 252 0 0-250-125 0 187-188 188 188-125 0 0 250 250 0 0-126 187 188z",transform:"matrix(1 0 0 -1 0 850)"},zoom_plus:{width:875,height:1e3,path:"m1 787l0-875 875 0 0 875-875 0z m687-500l-187 0 0-187-125 0 0 187-188 0 0 125 188 0 0 187 125 0 0-187 187 0 0-125z",transform:"matrix(1 0 0 -1 0 850)"},zoom_minus:{width:875,height:1e3,path:"m0 788l0-876 875 0 0 876-875 0z m688-500l-500 0 0 125 500 0 0-125z",transform:"matrix(1 0 0 -1 0 850)"},autoscale:{width:1e3,height:1e3,path:"m250 850l-187 0-63 0 0-62 0-188 63 0 0 188 187 0 0 62z m688 0l-188 0 0-62 188 0 0-188 62 0 0 188 0 62-62 0z m-875-938l0 188-63 0 0-188 0-62 63 0 187 0 0 62-187 0z m875 188l0-188-188 0 0-62 188 0 62 0 0 62 0 188-62 0z m-125 188l-1 0-93-94-156 156 156 156 92-93 2 0 0 250-250 0 0-2 93-92-156-156-156 156 94 92 0 2-250 0 0-250 0 0 93 93 157-156-157-156-93 94 0 0 0-250 250 0 0 0-94 93 156 157 156-157-93-93 0 0 250 0 0 250z",transform:"matrix(1 0 0 -1 0 850)"},tooltip_basic:{width:1500,height:1e3,path:"m375 725l0 0-375-375 375-374 0-1 1125 0 0 750-1125 0z",transform:"matrix(1 0 0 -1 0 850)"},tooltip_compare:{width:1125,height:1e3,path:"m187 786l0 2-187-188 188-187 0 0 937 0 0 373-938 0z m0-499l0 1-187-188 188-188 0 0 937 0 0 376-938-1z",transform:"matrix(1 0 0 -1 0 850)"},plotlylogo:{width:1542,height:1e3,path:"m0-10h182v-140h-182v140z m228 146h183v-286h-183v286z m225 714h182v-1000h-182v1000z m225-285h182v-715h-182v715z m225 142h183v-857h-183v857z m231-428h182v-429h-182v429z m225-291h183v-138h-183v138z",transform:"matrix(1 0 0 -1 0 850)"},"z-axis":{width:1e3,height:1e3,path:"m833 5l-17 108v41l-130-65 130-66c0 0 0 38 0 39 0-1 36-14 39-25 4-15-6-22-16-30-15-12-39-16-56-20-90-22-187-23-279-23-261 0-341 34-353 59 3 60 228 110 228 110-140-8-351-35-351-116 0-120 293-142 474-142 155 0 477 22 477 142 0 50-74 79-163 96z m-374 94c-58-5-99-21-99-40 0-24 65-43 144-43 79 0 143 19 143 43 0 19-42 34-98 40v216h87l-132 135-133-135h88v-216z m167 515h-136v1c16 16 31 34 46 52l84 109v54h-230v-71h124v-1c-16-17-28-32-44-51l-89-114v-51h245v72z",transform:"matrix(1 0 0 -1 0 850)"},"3d_rotate":{width:1e3,height:1e3,path:"m922 660c-5 4-9 7-14 11-359 263-580-31-580-31l-102 28 58-400c0 1 1 1 2 2 118 108 351 249 351 249s-62 27-100 42c88 83 222 183 347 122 16-8 30-17 44-27-2 1-4 2-6 4z m36-329c0 0 64 229-88 296-62 27-124 14-175-11 157-78 225-208 249-266 8-19 11-31 11-31 2 5 6 15 11 32-5-13-8-20-8-20z m-775-239c70-31 117-50 198-32-121 80-199 346-199 346l-96-15-58-12c0 0 55-226 155-287z m603 133l-317-139c0 0 4-4 19-14 7-5 24-15 24-15s-177-147-389 4c235-287 536-112 536-112l31-22 100 299-4-1z m-298-153c6-4 14-9 24-15 0 0-17 10-24 15z",transform:"matrix(1 0 0 -1 0 850)"},camera:{width:1e3,height:1e3,path:"m500 450c-83 0-150-67-150-150 0-83 67-150 150-150 83 0 150 67 150 150 0 83-67 150-150 150z m400 150h-120c-16 0-34 13-39 29l-31 93c-6 15-23 28-40 28h-340c-16 0-34-13-39-28l-31-94c-6-15-23-28-40-28h-120c-55 0-100-45-100-100v-450c0-55 45-100 100-100h800c55 0 100 45 100 100v450c0 55-45 100-100 100z m-400-550c-138 0-250 112-250 250 0 138 112 250 250 250 138 0 250-112 250-250 0-138-112-250-250-250z m365 380c-19 0-35 16-35 35 0 19 16 35 35 35 19 0 35-16 35-35 0-19-16-35-35-35z",transform:"matrix(1 0 0 -1 0 850)"},movie:{width:1e3,height:1e3,path:"m938 413l-188-125c0 37-17 71-44 94 64 38 107 107 107 187 0 121-98 219-219 219-121 0-219-98-219-219 0-61 25-117 66-156h-115c30 33 49 76 49 125 0 103-84 187-187 187s-188-84-188-187c0-57 26-107 65-141-38-22-65-62-65-109v-250c0-70 56-126 125-126h500c69 0 125 56 125 126l188-126c34 0 62 28 62 63v375c0 35-28 63-62 63z m-750 0c-69 0-125 56-125 125s56 125 125 125 125-56 125-125-56-125-125-125z m406-1c-87 0-157 70-157 157 0 86 70 156 157 156s156-70 156-156-70-157-156-157z",transform:"matrix(1 0 0 -1 0 850)"},question:{width:857.1,height:1e3,path:"m500 82v107q0 8-5 13t-13 5h-107q-8 0-13-5t-5-13v-107q0-8 5-13t13-5h107q8 0 13 5t5 13z m143 375q0 49-31 91t-77 65-95 23q-136 0-207-119-9-14 4-24l74-55q4-4 10-4 9 0 14 7 30 38 48 51 19 14 48 14 27 0 48-15t21-33q0-21-11-34t-38-25q-35-16-65-48t-29-70v-20q0-8 5-13t13-5h107q8 0 13 5t5 13q0 10 12 27t30 28q18 10 28 16t25 19 25 27 16 34 7 45z m214-107q0-117-57-215t-156-156-215-58-216 58-155 156-58 215 58 215 155 156 216 58 215-58 156-156 57-215z",transform:"matrix(1 0 0 -1 0 850)"},disk:{width:857.1,height:1e3,path:"m214-7h429v214h-429v-214z m500 0h72v500q0 8-6 21t-11 20l-157 156q-5 6-19 12t-22 5v-232q0-22-15-38t-38-16h-322q-22 0-37 16t-16 38v232h-72v-714h72v232q0 22 16 38t37 16h465q22 0 38-16t15-38v-232z m-214 518v178q0 8-5 13t-13 5h-107q-7 0-13-5t-5-13v-178q0-8 5-13t13-5h107q7 0 13 5t5 13z m357-18v-518q0-22-15-38t-38-16h-750q-23 0-38 16t-16 38v750q0 22 16 38t38 16h517q23 0 50-12t42-26l156-157q16-15 27-42t11-49z",transform:"matrix(1 0 0 -1 0 850)"},drawopenpath:{width:70,height:70,path:"M33.21,85.65a7.31,7.31,0,0,1-2.59-.48c-8.16-3.11-9.27-19.8-9.88-41.3-.1-3.58-.19-6.68-.35-9-.15-2.1-.67-3.48-1.43-3.79-2.13-.88-7.91,2.32-12,5.86L3,32.38c1.87-1.64,11.55-9.66,18.27-6.9,2.13.87,4.75,3.14,5.17,9,.17,2.43.26,5.59.36,9.25a224.17,224.17,0,0,0,1.5,23.4c1.54,10.76,4,12.22,4.48,12.4.84.32,2.79-.46,5.76-3.59L43,80.07C41.53,81.57,37.68,85.64,33.21,85.65ZM74.81,69a11.34,11.34,0,0,0,6.09-6.72L87.26,44.5,74.72,32,56.9,38.35c-2.37.86-5.57,3.42-6.61,6L38.65,72.14l8.42,8.43ZM55,46.27a7.91,7.91,0,0,1,3.64-3.17l14.8-5.3,8,8L76.11,60.6l-.06.19a6.37,6.37,0,0,1-3,3.43L48.25,74.59,44.62,71Zm16.57,7.82A6.9,6.9,0,1,0,64.64,61,6.91,6.91,0,0,0,71.54,54.09Zm-4.05,0a2.85,2.85,0,1,1-2.85-2.85A2.86,2.86,0,0,1,67.49,54.09Zm-4.13,5.22L60.5,56.45,44.26,72.7l2.86,2.86ZM97.83,35.67,84.14,22l-8.57,8.57L89.26,44.24Zm-13.69-8,8,8-2.85,2.85-8-8Z",transform:"matrix(1 0 0 1 -15 -15)"},drawclosedpath:{width:90,height:90,path:"M88.41,21.12a26.56,26.56,0,0,0-36.18,0l-2.07,2-2.07-2a26.57,26.57,0,0,0-36.18,0,23.74,23.74,0,0,0,0,34.8L48,90.12a3.22,3.22,0,0,0,4.42,0l36-34.21a23.73,23.73,0,0,0,0-34.79ZM84,51.24,50.16,83.35,16.35,51.25a17.28,17.28,0,0,1,0-25.47,20,20,0,0,1,27.3,0l4.29,4.07a3.23,3.23,0,0,0,4.44,0l4.29-4.07a20,20,0,0,1,27.3,0,17.27,17.27,0,0,1,0,25.46ZM66.76,47.68h-33v6.91h33ZM53.35,35H46.44V68h6.91Z",transform:"matrix(1 0 0 1 -5 -5)"},lasso:{width:1031,height:1e3,path:"m1018 538c-36 207-290 336-568 286-277-48-473-256-436-463 10-57 36-108 76-151-13-66 11-137 68-183 34-28 75-41 114-42l-55-70 0 0c-2-1-3-2-4-3-10-14-8-34 5-45 14-11 34-8 45 4 1 1 2 3 2 5l0 0 113 140c16 11 31 24 45 40 4 3 6 7 8 11 48-3 100 0 151 9 278 48 473 255 436 462z m-624-379c-80 14-149 48-197 96 42 42 109 47 156 9 33-26 47-66 41-105z m-187-74c-19 16-33 37-39 60 50-32 109-55 174-68-42-25-95-24-135 8z m360 75c-34-7-69-9-102-8 8 62-16 128-68 170-73 59-175 54-244-5-9 20-16 40-20 61-28 159 121 317 333 354s407-60 434-217c28-159-121-318-333-355z",transform:"matrix(1 0 0 -1 0 850)"},selectbox:{width:1e3,height:1e3,path:"m0 850l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z m285 0l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z m-857-286l0-143 143 0 0 143-143 0z m857 0l0-143 143 0 0 143-143 0z m-857-285l0-143 143 0 0 143-143 0z m857 0l0-143 143 0 0 143-143 0z m-857-286l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z m285 0l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z",transform:"matrix(1 0 0 -1 0 850)"},drawline:{width:70,height:70,path:"M60.64,62.3a11.29,11.29,0,0,0,6.09-6.72l6.35-17.72L60.54,25.31l-17.82,6.4c-2.36.86-5.57,3.41-6.6,6L24.48,65.5l8.42,8.42ZM40.79,39.63a7.89,7.89,0,0,1,3.65-3.17l14.79-5.31,8,8L61.94,54l-.06.19a6.44,6.44,0,0,1-3,3.43L34.07,68l-3.62-3.63Zm16.57,7.81a6.9,6.9,0,1,0-6.89,6.9A6.9,6.9,0,0,0,57.36,47.44Zm-4,0a2.86,2.86,0,1,1-2.85-2.85A2.86,2.86,0,0,1,53.32,47.44Zm-4.13,5.22L46.33,49.8,30.08,66.05l2.86,2.86ZM83.65,29,70,15.34,61.4,23.9,75.09,37.59ZM70,21.06l8,8-2.84,2.85-8-8ZM87,80.49H10.67V87H87Z",transform:"matrix(1 0 0 1 -15 -15)"},drawrect:{width:80,height:80,path:"M78,22V79H21V22H78m9-9H12V88H87V13ZM68,46.22H31V54H68ZM53,32H45.22V69H53Z",transform:"matrix(1 0 0 1 -10 -10)"},drawcircle:{width:80,height:80,path:"M50,84.72C26.84,84.72,8,69.28,8,50.3S26.84,15.87,50,15.87,92,31.31,92,50.3,73.16,84.72,50,84.72Zm0-60.59c-18.6,0-33.74,11.74-33.74,26.17S31.4,76.46,50,76.46,83.74,64.72,83.74,50.3,68.6,24.13,50,24.13Zm17.15,22h-34v7.11h34Zm-13.8-13H46.24v34h7.11Z",transform:"matrix(1 0 0 1 -10 -10)"},eraseshape:{width:80,height:80,path:"M82.77,78H31.85L6,49.57,31.85,21.14H82.77a8.72,8.72,0,0,1,8.65,8.77V69.24A8.72,8.72,0,0,1,82.77,78ZM35.46,69.84H82.77a.57.57,0,0,0,.49-.6V29.91a.57.57,0,0,0-.49-.61H35.46L17,49.57Zm32.68-34.7-24,24,5,5,24-24Zm-19,.53-5,5,24,24,5-5Z",transform:"matrix(1 0 0 1 -10 -10)"},spikeline:{width:1e3,height:1e3,path:"M512 409c0-57-46-104-103-104-57 0-104 47-104 104 0 57 47 103 104 103 57 0 103-46 103-103z m-327-39l92 0 0 92-92 0z m-185 0l92 0 0 92-92 0z m370-186l92 0 0 93-92 0z m0-184l92 0 0 92-92 0z",transform:"matrix(1.5 0 0 -1.5 0 850)"},pencil:{width:1792,height:1792,path:"M491 1536l91-91-235-235-91 91v107h128v128h107zm523-928q0-22-22-22-10 0-17 7l-542 542q-7 7-7 17 0 22 22 22 10 0 17-7l542-542q7-7 7-17zm-54-192l416 416-832 832h-416v-416zm683 96q0 53-37 90l-166 166-416-416 166-165q36-38 90-38 53 0 91 38l235 234q37 39 37 91z",transform:"matrix(1 0 0 1 0 1)"},newplotlylogo:{name:"newplotlylogo",svg:["<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 132 132'>","<defs>"," <style>","  .cls-0{fill:#000;}","  .cls-1{fill:#FFF;}","  .cls-2{fill:#F26;}","  .cls-3{fill:#D69;}","  .cls-4{fill:#BAC;}","  .cls-5{fill:#9EF;}"," </style>","</defs>"," <title>plotly-logomark</title>"," <g id='symbol'>","  <rect class='cls-0' x='0' y='0' width='132' height='132' rx='18' ry='18'/>","  <circle class='cls-5' cx='102' cy='30' r='6'/>","  <circle class='cls-4' cx='78' cy='30' r='6'/>","  <circle class='cls-4' cx='78' cy='54' r='6'/>","  <circle class='cls-3' cx='54' cy='30' r='6'/>","  <circle class='cls-2' cx='30' cy='30' r='6'/>","  <circle class='cls-2' cx='30' cy='54' r='6'/>","  <path class='cls-1' d='M30,72a6,6,0,0,0-6,6v24a6,6,0,0,0,12,0V78A6,6,0,0,0,30,72Z'/>","  <path class='cls-1' d='M78,72a6,6,0,0,0-6,6v24a6,6,0,0,0,12,0V78A6,6,0,0,0,78,72Z'/>","  <path class='cls-1' d='M54,48a6,6,0,0,0-6,6v48a6,6,0,0,0,12,0V54A6,6,0,0,0,54,48Z'/>","  <path class='cls-1' d='M102,48a6,6,0,0,0-6,6v48a6,6,0,0,0,12,0V54A6,6,0,0,0,102,48Z'/>"," </g>","</svg>"].join("")}}},{}],495:[function(d,ee,te){te.isLeftAnchor=function(v){return v.xanchor==="left"||v.xanchor==="auto"&&v.x<=1/3},te.isCenterAnchor=function(v){return v.xanchor==="center"||v.xanchor==="auto"&&v.x>1/3&&v.x<2/3},te.isRightAnchor=function(v){return v.xanchor==="right"||v.xanchor==="auto"&&v.x>=2/3},te.isTopAnchor=function(v){return v.yanchor==="top"||v.yanchor==="auto"&&v.y>=2/3},te.isMiddleAnchor=function(v){return v.yanchor==="middle"||v.yanchor==="auto"&&v.y>1/3&&v.y<2/3},te.isBottomAnchor=function(v){return v.yanchor==="bottom"||v.yanchor==="auto"&&v.y<=1/3}},{}],496:[function(d,ee,te){var w=d("./mod"),v=w.mod,S=w.modHalf,M=Math.PI,e=2*M;function a(m){return m/180*M}function n(m){return m/M*180}function r(m){return Math.abs(m[1]-m[0])>e-1e-14}function t(m,u){return S(u-m,e)}function c(m,u){return Math.abs(t(m,u))}function o(m,u){if(r(u))return!0;var _,s;u[0]<u[1]?(_=u[0],s=u[1]):(_=u[1],s=u[0]),_=v(_,e),s=v(s,e),_>s&&(s+=e);var A=v(m,e),b=A+e;return A>=_&&A<=s||b>=_&&b<=s}function i(m,u,_,s){if(!o(u,s))return!1;var A,b;return _[0]<_[1]?(A=_[0],b=_[1]):(A=_[1],b=_[0]),m>=A&&m<=b}function y(m,u,_,s,A,b,f){A=A||0,b=b||0;var x=r([_,s]),l,L,T,k,P;x?(l=0,L=M,T=e):_<s?(l=_,T=s):(l=s,T=_),m<u?(k=m,P=u):(k=u,P=m);function z(B,F){return[B*Math.cos(F)+A,b-B*Math.sin(F)]}var I=Math.abs(T-l)<=M?0:1;function D(B,F,H){return"A"+[B,B]+" "+[0,I,H]+" "+z(B,F)}var R;return x?k===null?R="M"+z(P,l)+D(P,L,0)+D(P,T,0)+"Z":R="M"+z(k,l)+D(k,L,0)+D(k,T,0)+"ZM"+z(P,l)+D(P,L,1)+D(P,T,1)+"Z":k===null?(R="M"+z(P,l)+D(P,T,0),f&&(R+="L0,0Z")):R="M"+z(k,l)+"L"+z(P,l)+D(P,T,0)+"L"+z(k,T)+D(k,l,1)+"Z",R}function p(m,u,_,s,A){return y(null,m,u,_,s,A,0)}function g(m,u,_,s,A){return y(null,m,u,_,s,A,1)}function h(m,u,_,s,A,b){return y(m,u,_,s,A,b,1)}ee.exports={deg2rad:a,rad2deg:n,angleDelta:t,angleDist:c,isFullCircle:r,isAngleInsideSector:o,isPtInsideSector:i,pathArc:p,pathSector:g,pathAnnulus:h}},{"./mod":522}],497:[function(d,ee,te){var w=Array.isArray,v=ArrayBuffer,S=DataView;function M(r){return v.isView(r)&&!(r instanceof S)}te.isTypedArray=M;function e(r){return w(r)||M(r)}te.isArrayOrTypedArray=e;function a(r){return!e(r[0])}te.isArray1D=a,te.ensureArray=function(r,t){return w(r)||(r=[]),r.length=t,r},te.concat=function(){var r=[],t=!0,c=0,o,i,y,p,g,h,m,u;for(y=0;y<arguments.length;y++)p=arguments[y],h=p.length,h&&(i?r.push(p):(i=p,g=h),w(p)?o=!1:(t=!1,c?o!==p.constructor&&(o=!1):o=p.constructor),c+=h);if(!c)return[];if(!r.length)return i;if(t)return i.concat.apply(i,r);if(o){for(m=new o(c),m.set(i),y=0;y<r.length;y++)p=r[y],m.set(p,g),g+=p.length;return m}for(m=new Array(c),u=0;u<i.length;u++)m[u]=i[u];for(y=0;y<r.length;y++){for(p=r[y],u=0;u<p.length;u++)m[g+u]=p[u];g+=u}return m},te.maxRowLength=function(r){return n(r,Math.max,0)},te.minRowLength=function(r){return n(r,Math.min,1/0)};function n(r,t,c){if(e(r))if(e(r[0])){for(var o=c,i=0;i<r.length;i++)o=t(o,r[i].length);return o}else return r.length;return 0}},{}],498:[function(d,ee,te){var w=d("fast-isnumeric"),v=d("../constants/numerical").BADNUM,S=/^['"%,$#\s']+|[, ]|['"%,$#\s']+$/g;ee.exports=function(e){return typeof e=="string"&&(e=e.replace(S,"")),w(e)?Number(e):v}},{"../constants/numerical":491,"fast-isnumeric":190}],499:[function(d,ee,te){ee.exports=function(v){var S=v._fullLayout;S._glcanvas&&S._glcanvas.size()&&S._glcanvas.each(function(M){M.regl&&M.regl.clear({color:!0,depth:!0})})}},{}],500:[function(d,ee,te){ee.exports=function(v){v._responsiveChartHandler&&(window.removeEventListener("resize",v._responsiveChartHandler),delete v._responsiveChartHandler)}},{}],501:[function(d,ee,te){var w=d("fast-isnumeric"),v=d("tinycolor2"),S=d("../plots/attributes"),M=d("../components/colorscale/scales"),e=d("../components/color"),a=d("../constants/interactions").DESELECTDIM,n=d("./nested_property"),r=d("./regex").counter,t=d("./mod").modHalf,c=d("./array").isArrayOrTypedArray;te.valObjectMeta={data_array:{coerceFunction:function(i,y,p){c(i)?y.set(i):p!==void 0&&y.set(p)}},enumerated:{coerceFunction:function(i,y,p,g){g.coerceNumber&&(i=+i),g.values.indexOf(i)===-1?y.set(p):y.set(i)},validateFunction:function(i,y){y.coerceNumber&&(i=+i);for(var p=y.values,g=0;g<p.length;g++){var h=String(p[g]);if(h.charAt(0)==="/"&&h.charAt(h.length-1)==="/"){var m=new RegExp(h.substr(1,h.length-2));if(m.test(i))return!0}else if(i===p[g])return!0}return!1}},boolean:{coerceFunction:function(i,y,p){i===!0||i===!1?y.set(i):y.set(p)}},number:{coerceFunction:function(i,y,p,g){!w(i)||g.min!==void 0&&i<g.min||g.max!==void 0&&i>g.max?y.set(p):y.set(+i)}},integer:{coerceFunction:function(i,y,p,g){i%1||!w(i)||g.min!==void 0&&i<g.min||g.max!==void 0&&i>g.max?y.set(p):y.set(+i)}},string:{coerceFunction:function(i,y,p,g){if(typeof i!="string"){var h=typeof i=="number";g.strict===!0||!h?y.set(p):y.set(String(i))}else g.noBlank&&!i?y.set(p):y.set(i)}},color:{coerceFunction:function(i,y,p){v(i).isValid()?y.set(i):y.set(p)}},colorlist:{coerceFunction:function(i,y,p){function g(h){return v(h).isValid()}!Array.isArray(i)||!i.length?y.set(p):i.every(g)?y.set(i):y.set(p)}},colorscale:{coerceFunction:function(i,y,p){y.set(M.get(i,p))}},angle:{coerceFunction:function(i,y,p){i==="auto"?y.set("auto"):w(i)?y.set(t(+i,360)):y.set(p)}},subplotid:{coerceFunction:function(i,y,p,g){var h=g.regex||r(p);if(typeof i=="string"&&h.test(i)){y.set(i);return}y.set(p)},validateFunction:function(i,y){var p=y.dflt;return i===p?!0:typeof i!="string"?!1:!!r(p).test(i)}},flaglist:{coerceFunction:function(i,y,p,g){if((g.extras||[]).indexOf(i)!==-1){y.set(i);return}if(typeof i!="string"){y.set(p);return}for(var h=i.split("+"),m=0;m<h.length;){var u=h[m];g.flags.indexOf(u)===-1||h.indexOf(u)<m?h.splice(m,1):m++}h.length?y.set(h.join("+")):y.set(p)}},any:{coerceFunction:function(i,y,p){i===void 0?y.set(p):y.set(i)}},info_array:{coerceFunction:function(i,y,p,g){function h(z,I,D){var R,B={set:function(F){R=F}};return D===void 0&&(D=I.dflt),te.valObjectMeta[I.valType].coerceFunction(z,B,D,I),R}var m=g.dimensions===2||g.dimensions==="1-2"&&Array.isArray(i)&&Array.isArray(i[0]);if(!Array.isArray(i)){y.set(p);return}var u=g.items,_=[],s=Array.isArray(u),A=s&&m&&Array.isArray(u[0]),b=m&&s&&!A,f=s&&!b?u.length:i.length,x,l,L,T,k,P;if(p=Array.isArray(p)?p:[],m)for(x=0;x<f;x++)for(_[x]=[],L=Array.isArray(i[x])?i[x]:[],b?k=u.length:s?k=u[x].length:k=L.length,l=0;l<k;l++)b?T=u[l]:s?T=u[x][l]:T=u,P=h(L[l],T,(p[x]||[])[l]),P!==void 0&&(_[x][l]=P);else for(x=0;x<f;x++)P=h(i[x],s?u[x]:u,p[x]),P!==void 0&&(_[x]=P);y.set(_)},validateFunction:function(i,y){if(!Array.isArray(i))return!1;var p=y.items,g=Array.isArray(p),h=y.dimensions===2;if(!y.freeLength&&i.length!==p.length)return!1;for(var m=0;m<i.length;m++)if(h){if(!Array.isArray(i[m])||!y.freeLength&&i[m].length!==p[m].length)return!1;for(var u=0;u<i[m].length;u++)if(!o(i[m][u],g?p[m][u]:p))return!1}else if(!o(i[m],g?p[m]:p))return!1;return!0}}},te.coerce=function(i,y,p,g,h){var m=n(p,g).get(),u=n(i,g),_=n(y,g),s=u.get(),A=y._template;if(s===void 0&&A&&(s=n(A,g).get(),A=0),h===void 0&&(h=m.dflt),m.arrayOk&&c(s))return _.set(s),s;var b=te.valObjectMeta[m.valType].coerceFunction;b(s,_,h,m);var f=_.get();return A&&f===h&&!o(s,m)&&(s=n(A,g).get(),b(s,_,h,m),f=_.get()),f},te.coerce2=function(i,y,p,g,h){var m=n(i,g),u=te.coerce(i,y,p,g,h),_=m.get();return _!=null?u:!1},te.coerceFont=function(i,y,p){var g={};return p=p||{},g.family=i(y+".family",p.family),g.size=i(y+".size",p.size),g.color=i(y+".color",p.color),g},te.coercePattern=function(i,y,p,g){var h=i(y+".shape");if(h){i(y+".solidity"),i(y+".size");var m=i(y+".fillmode"),u=m==="overlay";if(!g){var _=i(y+".bgcolor",u?p:void 0);i(y+".fgcolor",u?e.contrast(_):p)}i(y+".fgopacity",u?.5:1)}},te.coerceHoverinfo=function(i,y,p){var g=y._module.attributes,h=g.hoverinfo?g:S,m=h.hoverinfo,u;if(p._dataLength===1){var _=m.dflt==="all"?m.flags.slice():m.dflt.split("+");_.splice(_.indexOf("name"),1),u=_.join("+")}return te.coerce(i,y,h,"hoverinfo",u)},te.coerceSelectionMarkerOpacity=function(i,y){if(!!i.marker){var p=i.marker.opacity;if(p!==void 0){var g,h;!c(p)&&!i.selected&&!i.unselected&&(g=p,h=a*p),y("selected.marker.opacity",g),y("unselected.marker.opacity",h)}}};function o(i,y){var p=te.valObjectMeta[y.valType];if(y.arrayOk&&c(i))return!0;if(p.validateFunction)return p.validateFunction(i,y);var g={},h=g,m={set:function(u){h=u}};return p.coerceFunction(i,m,g,y),h!==g}te.validate=o},{"../components/color":367,"../components/colorscale/scales":382,"../constants/interactions":490,"../plots/attributes":562,"./array":497,"./mod":522,"./nested_property":523,"./regex":532,"fast-isnumeric":190,tinycolor2:313}],502:[function(d,ee,te){var w=d("d3-time-format").timeFormat,v=d("fast-isnumeric"),S=d("./loggers"),M=d("./mod").mod,e=d("../constants/numerical"),a=e.BADNUM,n=e.ONEDAY,r=e.ONEHOUR,t=e.ONEMIN,c=e.ONESEC,o=e.EPOCHJD,i=d("../registry"),y=d("d3-time-format").utcFormat,p=/^\s*(-?\d\d\d\d|\d\d)(-(\d?\d)(-(\d?\d)([ Tt]([01]?\d|2[0-3])(:([0-5]\d)(:([0-5]\d(\.\d+)?))?(Z|z|[+\-]\d\d(:?\d\d)?)?)?)?)?)?\s*$/m,g=/^\s*(-?\d\d\d\d|\d\d)(-(\d?\di?)(-(\d?\d)([ Tt]([01]?\d|2[0-3])(:([0-5]\d)(:([0-5]\d(\.\d+)?))?(Z|z|[+\-]\d\d(:?\d\d)?)?)?)?)?)?\s*$/m,h=new Date().getFullYear()-70;function m(R){return R&&i.componentsRegistry.calendars&&typeof R=="string"&&R!=="gregorian"}te.dateTick0=function(R,B){var F=u(R,!!B);if(B<2)return F;var H=te.dateTime2ms(F,R);return H+=n*(B-1),te.ms2DateTime(H,0,R)};function u(R,B){return m(R)?B?i.getComponentMethod("calendars","CANONICAL_SUNDAY")[R]:i.getComponentMethod("calendars","CANONICAL_TICK")[R]:B?"2000-01-02":"2000-01-01"}te.dfltRange=function(R){return m(R)?i.getComponentMethod("calendars","DFLTRANGE")[R]:["2000-01-01","2001-01-01"]},te.isJSDate=function(R){return typeof R=="object"&&R!==null&&typeof R.getTime=="function"};var _,s;te.dateTime2ms=function(R,B){if(te.isJSDate(R)){var F=R.getTimezoneOffset()*t,H=(R.getUTCMinutes()-R.getMinutes())*t+(R.getUTCSeconds()-R.getSeconds())*c+(R.getUTCMilliseconds()-R.getMilliseconds());if(H){var G=3*t;F=F-G/2+M(H-F+G/2,G)}return R=Number(R)-F,R>=_&&R<=s?R:a}if(typeof R!="string"&&typeof R!="number")return a;R=String(R);var J=m(B),X=R.charAt(0);J&&(X==="G"||X==="g")&&(R=R.substr(1),B="");var Y=J&&B.substr(0,7)==="chinese",Z=R.match(Y?g:p);if(!Z)return a;var oe=Z[1],re=Z[3]||"1",se=Number(Z[5]||1),N=Number(Z[7]||0),U=Number(Z[9]||0),q=Number(Z[11]||0);if(J){if(oe.length===2)return a;oe=Number(oe);var $;try{var W=i.getComponentMethod("calendars","getCal")(B);if(Y){var K=re.charAt(re.length-1)==="i";re=parseInt(re,10),$=W.newDate(oe,W.toMonthIndex(oe,re,K),se)}else $=W.newDate(oe,Number(re),se)}catch{return a}return $?($.toJD()-o)*n+N*r+U*t+q*c:a}oe.length===2?oe=(Number(oe)+2e3-h)%100+h:oe=Number(oe),re-=1;var ne=new Date(Date.UTC(2e3,re,se,N,U));return ne.setUTCFullYear(oe),ne.getUTCMonth()!==re||ne.getUTCDate()!==se?a:ne.getTime()+q*c},_=te.MIN_MS=te.dateTime2ms("-9999"),s=te.MAX_MS=te.dateTime2ms("9999-12-31 23:59:59.9999"),te.isDateTime=function(R,B){return te.dateTime2ms(R,B)!==a};function A(R,B){return String(R+Math.pow(10,B)).substr(1)}var b=90*n,f=3*r,x=5*t;te.ms2DateTime=function(R,B,F){if(typeof R!="number"||!(R>=_&&R<=s))return a;B||(B=0);var H=Math.floor(M(R+.05,1)*10),G=Math.round(R-H/10),J,X,Y,Z,oe,re;if(m(F)){var se=Math.floor(G/n)+o,N=Math.floor(M(R,n));try{J=i.getComponentMethod("calendars","getCal")(F).fromJD(se).formatDate("yyyy-mm-dd")}catch{J=y("G%Y-%m-%d")(new Date(G))}if(J.charAt(0)==="-")for(;J.length<11;)J="-0"+J.substr(1);else for(;J.length<10;)J="0"+J;X=B<b?Math.floor(N/r):0,Y=B<b?Math.floor(N%r/t):0,Z=B<f?Math.floor(N%t/c):0,oe=B<x?N%c*10+H:0}else re=new Date(G),J=y("%Y-%m-%d")(re),X=B<b?re.getUTCHours():0,Y=B<b?re.getUTCMinutes():0,Z=B<f?re.getUTCSeconds():0,oe=B<x?re.getUTCMilliseconds()*10+H:0;return l(J,X,Y,Z,oe)},te.ms2DateTimeLocal=function(R){if(!(R>=_+n&&R<=s-n))return a;var B=Math.floor(M(R+.05,1)*10),F=new Date(Math.round(R-B/10)),H=w("%Y-%m-%d")(F),G=F.getHours(),J=F.getMinutes(),X=F.getSeconds(),Y=F.getUTCMilliseconds()*10+B;return l(H,G,J,X,Y)};function l(R,B,F,H,G){if((B||F||H||G)&&(R+=" "+A(B,2)+":"+A(F,2),(H||G)&&(R+=":"+A(H,2),G))){for(var J=4;G%10===0;)J-=1,G/=10;R+="."+A(G,J)}return R}te.cleanDate=function(R,B,F){if(R===a)return B;if(te.isJSDate(R)||typeof R=="number"&&isFinite(R)){if(m(F))return S.error("JS Dates and milliseconds are incompatible with world calendars",R),B;if(R=te.ms2DateTimeLocal(+R),!R&&B!==void 0)return B}else if(!te.isDateTime(R,F))return S.error("unrecognized date",R),B;return R};var L=/%\d?f/g,T=/%h/g,k={1:"1",2:"1",3:"2",4:"2"};function P(R,B,F,H){R=R.replace(L,function(J){var X=Math.min(+J.charAt(1)||6,6),Y=(B/1e3%1+2).toFixed(X).substr(2).replace(/0+$/,"")||"0";return Y});var G=new Date(Math.floor(B+.05));if(R=R.replace(T,function(){return k[F("%q")(G)]}),m(H))try{R=i.getComponentMethod("calendars","worldCalFmt")(R,B,H)}catch{return"Invalid"}return F(R)(G)}var z=[59,59.9,59.99,59.999,59.9999];function I(R,B){var F=M(R+.05,n),H=A(Math.floor(F/r),2)+":"+A(M(Math.floor(F/t),60),2);if(B!=="M"){v(B)||(B=0);var G=Math.min(M(R/c,60),z[B]),J=(100+G).toFixed(B).substr(1);B>0&&(J=J.replace(/0+$/,"").replace(/[\.]$/,"")),H+=":"+J}return H}te.formatDate=function(R,B,F,H,G,J){if(G=m(G)&&G,!B)if(F==="y")B=J.year;else if(F==="m")B=J.month;else if(F==="d")B=J.dayMonth+`
`+J.year;else return I(R,F)+`
`+P(J.dayMonthYear,R,H,G);return P(B,R,H,G)};var D=3*n;te.incrementMonth=function(R,B,F){F=m(F)&&F;var H=M(R,n);if(R=Math.round(R-H),F)try{var G=Math.round(R/n)+o,J=i.getComponentMethod("calendars","getCal")(F),X=J.fromJD(G);return B%12?J.add(X,B,"m"):J.add(X,B/12,"y"),(X.toJD()-o)*n+H}catch{S.error("invalid ms "+R+" in calendar "+F)}var Y=new Date(R+D);return Y.setUTCMonth(Y.getUTCMonth()+B)+H-D},te.findExactDates=function(R,B){for(var F=0,H=0,G=0,J=0,X,Y,Z=m(B)&&i.getComponentMethod("calendars","getCal")(B),oe=0;oe<R.length;oe++){if(Y=R[oe],!v(Y)){J++;continue}if(!(Y%n))if(Z)try{X=Z.fromJD(Y/n+o),X.day()===1?X.month()===1?F++:H++:G++}catch{}else X=new Date(Y),X.getUTCDate()===1?X.getUTCMonth()===0?F++:H++:G++}H+=F,G+=H;var re=R.length-J;return{exactYears:F/re,exactMonths:H/re,exactDays:G/re}}},{"../constants/numerical":491,"../registry":647,"./loggers":519,"./mod":522,"d3-time-format":120,"fast-isnumeric":190}],503:[function(d,ee,te){var w=d("@plotly/d3"),v=d("./loggers"),S=d("./matrix"),M=d("gl-mat4");function e(h){var m;if(typeof h=="string"){if(m=document.getElementById(h),m===null)throw new Error("No DOM element with id '"+h+"' exists on the page.");return m}else if(h==null)throw new Error("DOM element provided is null or undefined");return h}function a(h){var m=w.select(h);return m.node()instanceof HTMLElement&&m.size()&&m.classed("js-plotly-plot")}function n(h){var m=h&&h.parentNode;m&&m.removeChild(h)}function r(h,m){t("global",h,m)}function t(h,m,u){var _="plotly.js-style-"+h,s=document.getElementById(_);s||(s=document.createElement("style"),s.setAttribute("id",_),s.appendChild(document.createTextNode("")),document.head.appendChild(s));var A=s.sheet;A.insertRule?A.insertRule(m+"{"+u+"}",0):A.addRule?A.addRule(m,u,0):v.warn("addStyleRule failed")}function c(h){var m="plotly.js-style-"+h,u=document.getElementById(m);u&&n(u)}function o(h){var m=y(h),u=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return m.forEach(function(_){var s=i(_);if(s){var A=S.convertCssMatrix(s);u=M.multiply(u,u,A)}}),u}function i(h){var m=window.getComputedStyle(h,null),u=m.getPropertyValue("-webkit-transform")||m.getPropertyValue("-moz-transform")||m.getPropertyValue("-ms-transform")||m.getPropertyValue("-o-transform")||m.getPropertyValue("transform");return u==="none"?null:u.replace("matrix","").replace("3d","").slice(1,-1).split(",").map(function(_){return+_})}function y(h){for(var m=[];p(h);)m.push(h),h=h.parentNode;return m}function p(h){return h&&(h instanceof Element||h instanceof HTMLElement)}function g(h,m){return h&&m&&h.x===m.x&&h.y===m.y&&h.top===m.top&&h.left===m.left&&h.right===m.right&&h.bottom===m.bottom}ee.exports={getGraphDiv:e,isPlotDiv:a,removeElement:n,addStyleRule:r,addRelatedStyleRule:t,deleteRelatedStyleRule:c,getFullTransformMatrix:o,getElementTransformMatrix:i,getElementAndAncestors:y,equalDomRects:g}},{"./loggers":519,"./matrix":521,"@plotly/d3":58,"gl-mat4":210}],504:[function(d,ee,te){var w=d("events").EventEmitter,v={init:function(S){if(S._ev instanceof w)return S;var M=new w,e=new w;return S._ev=M,S._internalEv=e,S.on=M.on.bind(M),S.once=M.once.bind(M),S.removeListener=M.removeListener.bind(M),S.removeAllListeners=M.removeAllListeners.bind(M),S._internalOn=e.on.bind(e),S._internalOnce=e.once.bind(e),S._removeInternalListener=e.removeListener.bind(e),S._removeAllInternalListeners=e.removeAllListeners.bind(e),S.emit=function(a,n){typeof jQuery<"u"&&jQuery(S).trigger(a,n),M.emit(a,n),e.emit(a,n)},S},triggerHandler:function(S,M,e){var a,n;typeof jQuery<"u"&&(a=jQuery(S).triggerHandler(M,e));var r=S._ev;if(!r)return a;var t=r._events[M];if(!t)return a;function c(i){if(i.listener){if(r.removeListener(M,i.listener),!i.fired)return i.fired=!0,i.listener.apply(r,[e])}else return i.apply(r,[e])}t=Array.isArray(t)?t:[t];var o;for(o=0;o<t.length-1;o++)c(t[o]);return n=c(t[o]),a!==void 0?a:n},purge:function(S){return delete S._ev,delete S.on,delete S.once,delete S.removeListener,delete S.removeAllListeners,delete S.emit,delete S._ev,delete S._internalEv,delete S._internalOn,delete S._internalOnce,delete S._removeInternalListener,delete S._removeAllInternalListeners,S}};ee.exports=v},{events:84}],505:[function(d,ee,te){var w=d("./is_plain_object.js"),v=Array.isArray;function S(e,a){var n,r;for(n=0;n<e.length;n++){if(r=e[n],r!==null&&typeof r=="object")return!1;r!==void 0&&(a[n]=r)}return!0}te.extendFlat=function(){return M(arguments,!1,!1,!1)},te.extendDeep=function(){return M(arguments,!0,!1,!1)},te.extendDeepAll=function(){return M(arguments,!0,!0,!1)},te.extendDeepNoArrays=function(){return M(arguments,!0,!1,!0)};function M(e,a,n,r){var t=e[0],c=e.length,o,i,y,p,g,h,m;if(c===2&&v(t)&&v(e[1])&&t.length===0){if(m=S(e[1],t),m)return t;t.splice(0,t.length)}for(var u=1;u<c;u++){o=e[u];for(i in o)y=t[i],p=o[i],r&&v(p)?t[i]=p:a&&p&&(w(p)||(g=v(p)))?(g?(g=!1,h=y&&v(y)?y:[]):h=y&&w(y)?y:{},t[i]=M([h,p],a,n,r)):(typeof p<"u"||n)&&(t[i]=p)}return t}},{"./is_plain_object.js":516}],506:[function(d,ee,te){ee.exports=function(v){for(var S={},M=[],e=0,a=0;a<v.length;a++){var n=v[a];S[n]!==1&&(S[n]=1,M[e++]=n)}return M}},{}],507:[function(d,ee,te){ee.exports=function(e){for(var a=S(e)?v:w,n=[],r=0;r<e.length;r++){var t=e[r];a(t)&&n.push(t)}return n};function w(M){return M.visible===!0}function v(M){var e=M[0].trace;return e.visible===!0&&e._length!==0}function S(M){return Array.isArray(M)&&Array.isArray(M[0])&&M[0][0]&&M[0][0].trace}},{}],508:[function(d,ee,te){var w=d("@plotly/d3"),v=d("country-regex"),S=d("@turf/area"),M=d("@turf/centroid"),e=d("@turf/bbox"),a=d("./identity"),n=d("./loggers"),r=d("./is_plain_object"),t=d("./nested_property"),c=d("./polygon"),o=Object.keys(v),i={"ISO-3":a,"USA-states":a,"country names":y};function y(A){for(var b=0;b<o.length;b++){var f=o[b],x=new RegExp(v[f]);if(x.test(A.trim().toLowerCase()))return f}return n.log("Unrecognized country name: "+A+"."),!1}function p(A,b,f){if(!b||typeof b!="string")return!1;var x=i[A](b),l,L,T;if(x){if(A==="USA-states")for(l=[],T=0;T<f.length;T++)L=f[T],L.properties&&L.properties.gu&&L.properties.gu==="USA"&&l.push(L);else l=f;for(T=0;T<l.length;T++)if(L=l[T],L.id===x)return L;n.log(["Location with id",x,"does not have a matching topojson feature at this resolution."].join(" "))}return!1}function g(A){var b=A.geometry,f=b.coordinates,x=A.id,l=[],L,T,k,P;function z(I){for(var D=0;D<I.length-1;D++)if(I[D][0]>0&&I[D+1][0]<0)return D;return null}switch(x==="RUS"||x==="FJI"?L=function(I){var D;if(z(I)===null)D=I;else for(D=new Array(I.length),P=0;P<I.length;P++)D[P]=[I[P][0]<0?I[P][0]+360:I[P][0],I[P][1]];l.push(c.tester(D))}:x==="ATA"?L=function(I){var D=z(I);if(D===null)return l.push(c.tester(I));var R=new Array(I.length+1),B=0;for(P=0;P<I.length;P++)P>D?R[B++]=[I[P][0]+360,I[P][1]]:P===D?(R[B++]=I[P],R[B++]=[I[P][0],-90]):R[B++]=I[P];var F=c.tester(R);F.pts.pop(),l.push(F)}:L=function(I){l.push(c.tester(I))},b.type){case"MultiPolygon":for(T=0;T<f.length;T++)for(k=0;k<f[T].length;k++)L(f[T][k]);break;case"Polygon":for(T=0;T<f.length;T++)L(f[T]);break}return l}function h(A){var b=A.geojson,f=window.PlotlyGeoAssets||{},x=typeof b=="string"?f[b]:b;return r(x)?x:(n.error("Oops ... something went wrong when fetching "+b),!1)}function m(A){var b=A[0].trace,f=h(b);if(!f)return!1;var x={},l=[],L;for(L=0;L<b._length;L++){var T=A[L];(T.loc||T.loc===0)&&(x[T.loc]=T)}function k(I){var D=t(I,b.featureidkey||"id").get(),R=x[D];if(R){var B=I.geometry;if(B.type==="Polygon"||B.type==="MultiPolygon"){var F={type:"Feature",id:D,geometry:B,properties:{}};F.properties.ct=u(F),R.fIn=I,R.fOut=F,l.push(F)}else n.log(["Location",R.loc,"does not have a valid GeoJSON geometry.","Traces with locationmode *geojson-id* only support","*Polygon* and *MultiPolygon* geometries."].join(" "))}delete x[D]}switch(f.type){case"FeatureCollection":var P=f.features;for(L=0;L<P.length;L++)k(P[L]);break;case"Feature":k(f);break;default:return n.warn(["Invalid GeoJSON type",(f.type||"none")+".","Traces with locationmode *geojson-id* only support","*FeatureCollection* and *Feature* types."].join(" ")),!1}for(var z in x)n.log(["Location *"+z+"*","does not have a matching feature with id-key","*"+b.featureidkey+"*."].join(" "));return l}function u(A){var b=A.geometry,f;if(b.type==="MultiPolygon")for(var x=b.coordinates,l=0,L=0;L<x.length;L++){var T={type:"Polygon",coordinates:x[L]},k=S.default(T);k>l&&(l=k,f=T)}else f=b;return M.default(f).geometry.coordinates}function _(A){var b=window.PlotlyGeoAssets||{},f=[];function x(P){return new Promise(function(z,I){w.json(P,function(D,R){if(D){delete b[P];var B=D.status===404?'GeoJSON at URL "'+P+'" does not exist.':"Unexpected error while fetching from "+P;return I(new Error(B))}return b[P]=R,z(R)})})}function l(P){return new Promise(function(z,I){var D=0,R=setInterval(function(){if(b[P]&&b[P]!=="pending")return clearInterval(R),z(b[P]);if(D>100)return clearInterval(R),I("Unexpected error while fetching from "+P);D++},50)})}for(var L=0;L<A.length;L++){var T=A[L][0].trace,k=T.geojson;typeof k=="string"&&(b[k]?b[k]==="pending"&&f.push(l(k)):(b[k]="pending",f.push(x(k))))}return f}function s(A){return e.default(A)}ee.exports={locationToFeature:p,feature2polygons:g,getTraceGeojson:h,extractTraceFeature:m,fetchTraceGeoData:_,computeBbox:s}},{"./identity":513,"./is_plain_object":516,"./loggers":519,"./nested_property":523,"./polygon":527,"@plotly/d3":58,"@turf/area":61,"@turf/bbox":64,"@turf/centroid":67,"country-regex":94}],509:[function(d,ee,te){var w=d("../constants/numerical").BADNUM;te.calcTraceToLineCoords=function(v){for(var S=v[0].trace,M=S.connectgaps,e=[],a=[],n=0;n<v.length;n++){var r=v[n],t=r.lonlat;t[0]!==w?a.push(t):!M&&a.length>0&&(e.push(a),a=[])}return a.length>0&&e.push(a),e},te.makeLine=function(v){return v.length===1?{type:"LineString",coordinates:v[0]}:{type:"MultiLineString",coordinates:v}},te.makePolygon=function(v){if(v.length===1)return{type:"Polygon",coordinates:v};for(var S=new Array(v.length),M=0;M<v.length;M++)S[M]=[v[M]];return{type:"MultiPolygon",coordinates:S}},te.makeBlank=function(){return{type:"Point",coordinates:[]}}},{"../constants/numerical":491}],510:[function(d,ee,te){var w=d("./mod").mod;te.segmentsIntersect=v;function v(n,r,t,c,o,i,y,p){var g=t-n,h=o-n,m=y-o,u=c-r,_=i-r,s=p-i,A=g*s-m*u;if(A===0)return null;var b=(h*s-m*_)/A,f=(h*u-g*_)/A;return f<0||f>1||b<0||b>1?null:{x:n+g*b,y:r+u*b}}te.segmentDistance=function(r,t,c,o,i,y,p,g){if(v(r,t,c,o,i,y,p,g))return 0;var h=c-r,m=o-t,u=p-i,_=g-y,s=h*h+m*m,A=u*u+_*_,b=Math.min(S(h,m,s,i-r,y-t),S(h,m,s,p-r,g-t),S(u,_,A,r-i,t-y),S(u,_,A,c-i,o-y));return Math.sqrt(b)};function S(n,r,t,c,o){var i=c*n+o*r;if(i<0)return c*c+o*o;if(i>t){var y=c-n,p=o-r;return y*y+p*p}else{var g=c*r-o*n;return g*g/t}}var M,e,a;te.getTextLocation=function(r,t,c,o){if((r!==e||o!==a)&&(M={},e=r,a=o),M[c])return M[c];var i=r.getPointAtLength(w(c-o/2,t)),y=r.getPointAtLength(w(c+o/2,t)),p=Math.atan((y.y-i.y)/(y.x-i.x)),g=r.getPointAtLength(w(c,t)),h=(g.x*4+i.x+y.x)/6,m=(g.y*4+i.y+y.y)/6,u={x:h,y:m,theta:p};return M[c]=u,u},te.clearLocationCache=function(){e=null},te.getVisibleSegment=function(r,t,c){var o=t.left,i=t.right,y=t.top,p=t.bottom,g=0,h=r.getTotalLength(),m=h,u,_;function s(b){var f=r.getPointAtLength(b);b===0?u=f:b===h&&(_=f);var x=f.x<o?o-f.x:f.x>i?f.x-i:0,l=f.y<y?y-f.y:f.y>p?f.y-p:0;return Math.sqrt(x*x+l*l)}for(var A=s(g);A;){if(g+=A+c,g>m)return;A=s(g)}for(A=s(m);A;){if(m-=A+c,g>m)return;A=s(m)}return{min:g,max:m,len:m-g,total:h,isClosed:g===0&&m===h&&Math.abs(u.x-_.x)<.1&&Math.abs(u.y-_.y)<.1}},te.findPointOnPath=function(r,t,c,o){o=o||{};for(var i=o.pathLength||r.getTotalLength(),y=o.tolerance||.001,p=o.iterationLimit||30,g=r.getPointAtLength(0)[c]>r.getPointAtLength(i)[c]?-1:1,h=0,m=0,u=i,_,s,A;h<p;){if(_=(m+u)/2,s=r.getPointAtLength(_),A=s[c]-t,Math.abs(A)<y)return s;g*A>0?u=_:m=_,h++}return s}},{"./mod":522}],511:[function(d,ee,te){var w=d("fast-isnumeric"),v=d("tinycolor2"),S=d("color-normalize"),M=d("../components/colorscale"),e=d("../components/color/attributes").defaultLine,a=d("./array").isArrayOrTypedArray,n=S(e),r=1;function t(p,g){var h=p;return h[3]*=g,h}function c(p){if(w(p))return n;var g=S(p);return g.length?g:n}function o(p){return w(p)?p:r}function i(p,g,h){var m=p.color,u=a(m),_=a(g),s=M.extractOpts(p),A=[],b,f,x,l,L;if(s.colorscale!==void 0?b=M.makeColorScaleFuncFromTrace(p):b=c,u?f=function(k,P){return k[P]===void 0?n:S(b(k[P]))}:f=c,_?x=function(k,P){return k[P]===void 0?r:o(k[P])}:x=o,u||_)for(var T=0;T<h;T++)l=f(m,T),L=x(g,T),A[T]=t(l,L);else A=t(S(m),g);return A}function y(p){var g=M.extractOpts(p),h=g.colorscale;return g.reversescale&&(h=M.flipScale(g.colorscale)),h.map(function(m){var u=m[0],_=v(m[1]),s=_.toRgb();return{index:u,rgb:[s.r,s.g,s.b,s.a]}})}ee.exports={formatColor:i,parseColorScale:y}},{"../components/color/attributes":366,"../components/colorscale":379,"./array":497,"color-normalize":89,"fast-isnumeric":190,tinycolor2:313}],512:[function(d,ee,te){var w=d("./identity");function v(S){return[S]}ee.exports={keyFun:function(S){return S.key},repeat:v,descend:w,wrap:v,unwrap:function(S){return S[0]}}},{"./identity":513}],513:[function(d,ee,te){ee.exports=function(v){return v}},{}],514:[function(d,ee,te){ee.exports=function(v,S){if(!S)return v;var M=1/Math.abs(S),e=M>1?(M*v+M*S)/M:v+S,a=String(e).length;if(a>16){var n=String(S).length,r=String(v).length;if(a>=r+n){var t=parseFloat(e).toPrecision(12);t.indexOf("e+")===-1&&(e=+t)}}return e}},{}],515:[function(d,ee,te){var w=d("@plotly/d3"),v=d("d3-time-format").utcFormat,S=d("d3-format").format,M=d("fast-isnumeric"),e=d("../constants/numerical"),a=e.FP_SAFE,n=-a,r=e.BADNUM,t=ee.exports={};t.adjustFormat=function(re){return!re||/^\d[.]\df/.test(re)||/[.]\d%/.test(re)?re:re==="0.f"?"~f":/^\d%/.test(re)?"~%":/^\ds/.test(re)?"~s":!/^[~,.0$]/.test(re)&&/[&fps]/.test(re)?"~"+re:re};var c={};t.warnBadFormat=function(oe){var re=String(oe);c[re]||(c[re]=1,t.warn('encountered bad format: "'+re+'"'))},t.noFormat=function(oe){return String(oe)},t.numberFormat=function(oe){var re;try{re=S(t.adjustFormat(oe))}catch{return t.warnBadFormat(oe),t.noFormat}return re},t.nestedProperty=d("./nested_property"),t.keyedContainer=d("./keyed_container"),t.relativeAttr=d("./relative_attr"),t.isPlainObject=d("./is_plain_object"),t.toLogRange=d("./to_log_range"),t.relinkPrivateKeys=d("./relink_private");var o=d("./array");t.isTypedArray=o.isTypedArray,t.isArrayOrTypedArray=o.isArrayOrTypedArray,t.isArray1D=o.isArray1D,t.ensureArray=o.ensureArray,t.concat=o.concat,t.maxRowLength=o.maxRowLength,t.minRowLength=o.minRowLength;var i=d("./mod");t.mod=i.mod,t.modHalf=i.modHalf;var y=d("./coerce");t.valObjectMeta=y.valObjectMeta,t.coerce=y.coerce,t.coerce2=y.coerce2,t.coerceFont=y.coerceFont,t.coercePattern=y.coercePattern,t.coerceHoverinfo=y.coerceHoverinfo,t.coerceSelectionMarkerOpacity=y.coerceSelectionMarkerOpacity,t.validate=y.validate;var p=d("./dates");t.dateTime2ms=p.dateTime2ms,t.isDateTime=p.isDateTime,t.ms2DateTime=p.ms2DateTime,t.ms2DateTimeLocal=p.ms2DateTimeLocal,t.cleanDate=p.cleanDate,t.isJSDate=p.isJSDate,t.formatDate=p.formatDate,t.incrementMonth=p.incrementMonth,t.dateTick0=p.dateTick0,t.dfltRange=p.dfltRange,t.findExactDates=p.findExactDates,t.MIN_MS=p.MIN_MS,t.MAX_MS=p.MAX_MS;var g=d("./search");t.findBin=g.findBin,t.sorterAsc=g.sorterAsc,t.sorterDes=g.sorterDes,t.distinctVals=g.distinctVals,t.roundUp=g.roundUp,t.sort=g.sort,t.findIndexOfMin=g.findIndexOfMin,t.sortObjectKeys=d("./sort_object_keys");var h=d("./stats");t.aggNums=h.aggNums,t.len=h.len,t.mean=h.mean,t.median=h.median,t.midRange=h.midRange,t.variance=h.variance,t.stdev=h.stdev,t.interp=h.interp;var m=d("./matrix");t.init2dArray=m.init2dArray,t.transposeRagged=m.transposeRagged,t.dot=m.dot,t.translationMatrix=m.translationMatrix,t.rotationMatrix=m.rotationMatrix,t.rotationXYMatrix=m.rotationXYMatrix,t.apply3DTransform=m.apply3DTransform,t.apply2DTransform=m.apply2DTransform,t.apply2DTransform2=m.apply2DTransform2,t.convertCssMatrix=m.convertCssMatrix,t.inverseTransformMatrix=m.inverseTransformMatrix;var u=d("./angles");t.deg2rad=u.deg2rad,t.rad2deg=u.rad2deg,t.angleDelta=u.angleDelta,t.angleDist=u.angleDist,t.isFullCircle=u.isFullCircle,t.isAngleInsideSector=u.isAngleInsideSector,t.isPtInsideSector=u.isPtInsideSector,t.pathArc=u.pathArc,t.pathSector=u.pathSector,t.pathAnnulus=u.pathAnnulus;var _=d("./anchor_utils");t.isLeftAnchor=_.isLeftAnchor,t.isCenterAnchor=_.isCenterAnchor,t.isRightAnchor=_.isRightAnchor,t.isTopAnchor=_.isTopAnchor,t.isMiddleAnchor=_.isMiddleAnchor,t.isBottomAnchor=_.isBottomAnchor;var s=d("./geometry2d");t.segmentsIntersect=s.segmentsIntersect,t.segmentDistance=s.segmentDistance,t.getTextLocation=s.getTextLocation,t.clearLocationCache=s.clearLocationCache,t.getVisibleSegment=s.getVisibleSegment,t.findPointOnPath=s.findPointOnPath;var A=d("./extend");t.extendFlat=A.extendFlat,t.extendDeep=A.extendDeep,t.extendDeepAll=A.extendDeepAll,t.extendDeepNoArrays=A.extendDeepNoArrays;var b=d("./loggers");t.log=b.log,t.warn=b.warn,t.error=b.error;var f=d("./regex");t.counterRegex=f.counter;var x=d("./throttle");t.throttle=x.throttle,t.throttleDone=x.done,t.clearThrottle=x.clear;var l=d("./dom");t.getGraphDiv=l.getGraphDiv,t.isPlotDiv=l.isPlotDiv,t.removeElement=l.removeElement,t.addStyleRule=l.addStyleRule,t.addRelatedStyleRule=l.addRelatedStyleRule,t.deleteRelatedStyleRule=l.deleteRelatedStyleRule,t.getFullTransformMatrix=l.getFullTransformMatrix,t.getElementTransformMatrix=l.getElementTransformMatrix,t.getElementAndAncestors=l.getElementAndAncestors,t.equalDomRects=l.equalDomRects,t.clearResponsive=d("./clear_responsive"),t.preserveDrawingBuffer=d("./preserve_drawing_buffer"),t.makeTraceGroups=d("./make_trace_groups"),t._=d("./localize"),t.notifier=d("./notifier"),t.filterUnique=d("./filter_unique"),t.filterVisible=d("./filter_visible"),t.pushUnique=d("./push_unique"),t.increment=d("./increment"),t.cleanNumber=d("./clean_number"),t.ensureNumber=function(re){return M(re)?(re=Number(re),re>a||re<n?r:re):r},t.isIndex=function(oe,re){return re!==void 0&&oe>=re?!1:M(oe)&&oe>=0&&oe%1===0},t.noop=d("./noop"),t.identity=d("./identity"),t.repeat=function(oe,re){for(var se=new Array(re),N=0;N<re;N++)se[N]=oe;return se},t.swapAttrs=function(oe,re,se,N){se||(se="x"),N||(N="y");for(var U=0;U<re.length;U++){var q=re[U],$=t.nestedProperty(oe,q.replace("?",se)),W=t.nestedProperty(oe,q.replace("?",N)),K=$.get();$.set(W.get()),W.set(K)}},t.raiseToTop=function(re){re.parentNode.appendChild(re)},t.cancelTransition=function(oe){return oe.transition().duration(0)},t.constrain=function(oe,re,se){return re>se?Math.max(se,Math.min(re,oe)):Math.max(re,Math.min(se,oe))},t.bBoxIntersect=function(oe,re,se){return se=se||0,oe.left<=re.right+se&&re.left<=oe.right+se&&oe.top<=re.bottom+se&&re.top<=oe.bottom+se},t.simpleMap=function(oe,re,se,N,U){for(var q=oe.length,$=new Array(q),W=0;W<q;W++)$[W]=re(oe[W],se,N,U);return $},t.randstr=function oe(re,se,N,U){if(N||(N=16),se===void 0&&(se=24),se<=0)return"0";var q=Math.log(Math.pow(2,se))/Math.log(N),$="",W,K,ne;for(W=2;q===1/0;W*=2)q=Math.log(Math.pow(2,se/W))/Math.log(N)*W;var ae=q-Math.floor(q);for(W=0;W<Math.floor(q);W++)ne=Math.floor(Math.random()*N).toString(N),$=ne+$;ae&&(K=Math.pow(N,ae),ne=Math.floor(Math.random()*K).toString(N),$=ne+$);var ie=parseInt($,N);return re&&re[$]||ie!==1/0&&ie>=Math.pow(2,se)?U>10?(t.warn("randstr failed uniqueness"),$):oe(re,se,N,(U||0)+1):$},t.OptionControl=function(oe,re){oe||(oe={}),re||(re="opt");var se={};return se.optionList=[],se._newoption=function(N){N[re]=oe,se[N.name]=N,se.optionList.push(N)},se["_"+re]=oe,se},t.smooth=function(oe,re){if(re=Math.round(re)||0,re<2)return oe;var se=oe.length,N=2*se,U=2*re-1,q=new Array(U),$=new Array(se),W,K,ne,ae;for(W=0;W<U;W++)q[W]=(1-Math.cos(Math.PI*(W+1)/re))/(2*re);for(W=0;W<se;W++){for(ae=0,K=0;K<U;K++)ne=W+K+1-re,ne<-se?ne-=N*Math.round(ne/N):ne>=N&&(ne-=N*Math.floor(ne/N)),ne<0?ne=-1-ne:ne>=se&&(ne=N-1-ne),ae+=oe[ne]*q[K];$[W]=ae}return $},t.syncOrAsync=function(oe,re,se){var N,U;function q(){return t.syncOrAsync(oe,re,se)}for(;oe.length;)if(U=oe.splice(0,1)[0],N=U(re),N&&N.then)return N.then(q);return se&&se(re)},t.stripTrailingSlash=function(oe){return oe.substr(-1)==="/"?oe.substr(0,oe.length-1):oe},t.noneOrAll=function(oe,re,se){if(!!oe){var N=!1,U=!0,q,$;for(q=0;q<se.length;q++)$=oe[se[q]],$!=null?N=!0:U=!1;if(N&&!U)for(q=0;q<se.length;q++)oe[se[q]]=re[se[q]]}},t.mergeArray=function(oe,re,se,N){var U=typeof N=="function";if(t.isArrayOrTypedArray(oe))for(var q=Math.min(oe.length,re.length),$=0;$<q;$++){var W=oe[$];re[$][se]=U?N(W):W}},t.mergeArrayCastPositive=function(oe,re,se){return t.mergeArray(oe,re,se,function(N){var U=+N;return isFinite(U)&&U>0?U:0})},t.fillArray=function(oe,re,se,N){if(N=N||t.identity,t.isArrayOrTypedArray(oe))for(var U=0;U<re.length;U++)re[U][se]=N(oe[U])},t.castOption=function(oe,re,se,N){N=N||t.identity;var U=t.nestedProperty(oe,se).get();return t.isArrayOrTypedArray(U)?Array.isArray(re)&&t.isArrayOrTypedArray(U[re[0]])?N(U[re[0]][re[1]]):N(U[re]):U},t.extractOption=function(oe,re,se,N){if(se in oe)return oe[se];var U=t.nestedProperty(re,N).get();if(!Array.isArray(U))return U};function L(oe){var re={};for(var se in oe)for(var N=oe[se],U=0;U<N.length;U++)re[N[U]]=+se;return re}t.tagSelected=function(oe,re,se){var N=re.selectedpoints,U=re._indexToPoints,q;U&&(q=L(U));function $(ie){return ie!==void 0&&ie<oe.length}for(var W=0;W<N.length;W++){var K=N[W];if(t.isIndex(K)||t.isArrayOrTypedArray(K)&&t.isIndex(K[0])&&t.isIndex(K[1])){var ne=q?q[K]:K,ae=se?se[ne]:ne;$(ae)&&(oe[ae].selected=1)}}},t.selIndices2selPoints=function(oe){var re=oe.selectedpoints,se=oe._indexToPoints;if(se){for(var N=L(se),U=[],q=0;q<re.length;q++){var $=re[q];if(t.isIndex($)){var W=N[$];t.isIndex(W)&&U.push(W)}}return U}else return re},t.getTargetArray=function(oe,re){var se=re.target;if(typeof se=="string"&&se){var N=t.nestedProperty(oe,se).get();return Array.isArray(N)?N:!1}else if(Array.isArray(se))return se;return!1},t.minExtend=function(oe,re){var se={};typeof re!="object"&&(re={});var N=3,U=Object.keys(oe),q,$,W;for(q=0;q<U.length;q++)$=U[q],W=oe[$],!($.charAt(0)==="_"||typeof W=="function")&&($==="module"?se[$]=W:Array.isArray(W)?$==="colorscale"?se[$]=W.slice():se[$]=W.slice(0,N):t.isTypedArray(W)?se[$]=W.subarray(0,N):W&&typeof W=="object"?se[$]=t.minExtend(oe[$],re[$]):se[$]=W);for(U=Object.keys(re),q=0;q<U.length;q++)$=U[q],W=re[$],(typeof W!="object"||!($ in se)||typeof se[$]!="object")&&(se[$]=W);return se},t.titleCase=function(oe){return oe.charAt(0).toUpperCase()+oe.substr(1)},t.containsAny=function(oe,re){for(var se=0;se<re.length;se++)if(oe.indexOf(re[se])!==-1)return!0;return!1},t.isIE=function(){return typeof window.navigator.msSaveBlob<"u"};var T=/Version\/[\d\.]+.*Safari/;t.isSafari=function(){return T.test(window.navigator.userAgent)};var k=/iPad|iPhone|iPod/;t.isIOS=function(){return k.test(window.navigator.userAgent)};var P=/Firefox\/(\d+)\.\d+/;t.getFirefoxVersion=function(){var oe=P.exec(window.navigator.userAgent);if(oe&&oe.length===2){var re=parseInt(oe[1]);if(!isNaN(re))return re}return null},t.isD3Selection=function(oe){return oe instanceof w.selection},t.ensureSingle=function(oe,re,se,N){var U=oe.select(re+(se?"."+se:""));if(U.size())return U;var q=oe.append(re);return se&&q.classed(se,!0),N&&q.call(N),q},t.ensureSingleById=function(oe,re,se,N){var U=oe.select(re+"#"+se);if(U.size())return U;var q=oe.append(re).attr("id",se);return N&&q.call(N),q},t.objectFromPath=function(oe,re){for(var se=oe.split("."),N,U=N={},q=0;q<se.length;q++){var $=se[q],W=null,K=se[q].match(/(.*)\[([0-9]+)\]/);K?($=K[1],W=K[2],N=N[$]=[],q===se.length-1?N[W]=re:N[W]={},N=N[W]):(q===se.length-1?N[$]=re:N[$]={},N=N[$])}return U};var z=/^([^\[\.]+)\.(.+)?/,I=/^([^\.]+)\[([0-9]+)\](\.)?(.+)?/;t.expandObjectPaths=function(oe){var re,se,N,U,q,$,W;if(typeof oe=="object"&&!Array.isArray(oe))for(se in oe)oe.hasOwnProperty(se)&&((re=se.match(z))?(U=oe[se],N=re[1],delete oe[se],oe[N]=t.extendDeepNoArrays(oe[N]||{},t.objectFromPath(se,t.expandObjectPaths(U))[N])):(re=se.match(I))?(U=oe[se],N=re[1],q=parseInt(re[2]),delete oe[se],oe[N]=oe[N]||[],re[3]==="."?(W=re[4],$=oe[N][q]=oe[N][q]||{},t.extendDeepNoArrays($,t.objectFromPath(W,t.expandObjectPaths(U)))):oe[N][q]=t.expandObjectPaths(U)):oe[se]=t.expandObjectPaths(oe[se]));return oe},t.numSeparate=function(oe,re,se){if(se||(se=!1),typeof re!="string"||re.length===0)throw new Error("Separator string required for formatting!");typeof oe=="number"&&(oe=String(oe));var N=/(\d+)(\d{3})/,U=re.charAt(0),q=re.charAt(1),$=oe.split("."),W=$[0],K=$.length>1?U+$[1]:"";if(q&&($.length>1||W.length>4||se))for(;N.test(W);)W=W.replace(N,"$1"+q+"$2");return W+K},t.TEMPLATE_STRING_REGEX=/%{([^\s%{}:]*)([:|\|][^}]*)?}/g;var D=/^\w*$/;t.templateString=function(oe,re){var se={};return oe.replace(t.TEMPLATE_STRING_REGEX,function(N,U){var q;return D.test(U)?q=re[U]:(se[U]=se[U]||t.nestedProperty(re,U).get,q=se[U]()),t.isValidTextValue(q)?q:""})};var R={max:10,count:0,name:"hovertemplate"};t.hovertemplateString=function(){return H.apply(R,arguments)};var B={max:10,count:0,name:"texttemplate"};t.texttemplateString=function(){return H.apply(B,arguments)};var F=/^[:|\|]/;function H(oe,re,se){var N=this,U=arguments;re||(re={});var q={};return oe.replace(t.TEMPLATE_STRING_REGEX,function($,W,K){var ne=W==="xother"||W==="yother",ae=W==="_xother"||W==="_yother",ie=W==="_xother_"||W==="_yother_",le=W==="xother_"||W==="yother_",ye=ne||ae||le||ie,ue=W;(ae||ie)&&(ue=ue.substring(1)),(le||ie)&&(ue=ue.substring(0,ue.length-1));var pe;if(ye){if(pe=re[ue],pe===void 0)return""}else{var ge,Te;for(Te=3;Te<U.length;Te++)if(ge=U[Te],!!ge){if(ge.hasOwnProperty(ue)){pe=ge[ue];break}if(D.test(ue)||(pe=t.nestedProperty(ge,ue).get(),pe=q[ue]||t.nestedProperty(ge,ue).get(),pe&&(q[ue]=pe)),pe!==void 0)break}}if(pe===void 0&&N)return N.count<N.max&&(t.warn("Variable '"+ue+"' in "+N.name+" could not be found!"),pe=$),N.count===N.max&&t.warn("Too many "+N.name+" warnings - additional warnings will be suppressed"),N.count++,$;if(K){var _e;if(K[0]===":"&&(_e=se?se.numberFormat:t.numberFormat,pe=_e(K.replace(F,""))(pe)),K[0]==="|"){_e=se?se.timeFormat:v;var ze=t.dateTime2ms(pe);pe=t.formatDate(ze,K.replace(F,""),!1,_e)}}else{var Oe=ue+"Label";re.hasOwnProperty(Oe)&&(pe=re[Oe])}return ye&&(pe="("+pe+")",(ae||ie)&&(pe=" "+pe),(le||ie)&&(pe=pe+" ")),pe})}var G=48,J=57;t.subplotSort=function(oe,re){for(var se=Math.min(oe.length,re.length)+1,N=0,U=0,q=0;q<se;q++){var $=oe.charCodeAt(q)||0,W=re.charCodeAt(q)||0,K=$>=G&&$<=J,ne=W>=G&&W<=J;if(K&&(N=10*N+$-G),ne&&(U=10*U+W-G),!K||!ne){if(N!==U)return N-U;if($!==W)return $-W}}return U-N};var X=2e9;t.seedPseudoRandom=function(){X=2e9},t.pseudoRandom=function(){var oe=X;return X=(69069*X+1)%4294967296,Math.abs(X-oe)<429496729?t.pseudoRandom():X/4294967296},t.fillText=function(oe,re,se){var N=Array.isArray(se)?function($){se.push($)}:function($){se.text=$},U=t.extractOption(oe,re,"htx","hovertext");if(t.isValidTextValue(U))return N(U);var q=t.extractOption(oe,re,"tx","text");if(t.isValidTextValue(q))return N(q)},t.isValidTextValue=function(oe){return oe||oe===0},t.formatPercent=function(oe,re){re=re||0;for(var se=(Math.round(100*oe*Math.pow(10,re))*Math.pow(.1,re)).toFixed(re)+"%",N=0;N<re;N++)se.indexOf(".")!==-1&&(se=se.replace("0%","%"),se=se.replace(".%","%"));return se},t.isHidden=function(oe){var re=window.getComputedStyle(oe).display;return!re||re==="none"},t.strTranslate=function(oe,re){return oe||re?"translate("+oe+","+re+")":""},t.strRotate=function(oe){return oe?"rotate("+oe+")":""},t.strScale=function(oe){return oe!==1?"scale("+oe+")":""},t.getTextTransform=function(oe){var re=oe.noCenter,se=oe.textX,N=oe.textY,U=oe.targetX,q=oe.targetY,$=oe.anchorX||0,W=oe.anchorY||0,K=oe.rotate,ne=oe.scale;return ne?ne>1&&(ne=1):ne=0,t.strTranslate(U-ne*(se+$),q-ne*(N+W))+t.strScale(ne)+(K?"rotate("+K+(re?"":" "+se+" "+N)+")":"")},t.ensureUniformFontSize=function(oe,re){var se=t.extendFlat({},re);return se.size=Math.max(re.size,oe._fullLayout.uniformtext.minsize||0),se},t.join2=function(oe,re,se){var N=oe.length;return N>1?oe.slice(0,-1).join(re)+se+oe[N-1]:oe.join(re)},t.bigFont=function(oe){return Math.round(1.2*oe)};var Y=t.getFirefoxVersion(),Z=Y!==null&&Y<86;t.getPositionFromD3Event=function(){return Z?[w.event.layerX,w.event.layerY]:[w.event.offsetX,w.event.offsetY]}},{"../constants/numerical":491,"./anchor_utils":495,"./angles":496,"./array":497,"./clean_number":498,"./clear_responsive":500,"./coerce":501,"./dates":502,"./dom":503,"./extend":505,"./filter_unique":506,"./filter_visible":507,"./geometry2d":510,"./identity":513,"./increment":514,"./is_plain_object":516,"./keyed_container":517,"./localize":518,"./loggers":519,"./make_trace_groups":520,"./matrix":521,"./mod":522,"./nested_property":523,"./noop":524,"./notifier":525,"./preserve_drawing_buffer":529,"./push_unique":530,"./regex":532,"./relative_attr":533,"./relink_private":534,"./search":535,"./sort_object_keys":538,"./stats":539,"./throttle":542,"./to_log_range":543,"@plotly/d3":58,"d3-format":112,"d3-time-format":120,"fast-isnumeric":190}],516:[function(d,ee,te){ee.exports=function(v){return window&&window.process&&window.process.versions?Object.prototype.toString.call(v)==="[object Object]":Object.prototype.toString.call(v)==="[object Object]"&&Object.getPrototypeOf(v).hasOwnProperty("hasOwnProperty")}},{}],517:[function(d,ee,te){var w=d("./nested_property"),v=/^\w*$/,S=0,M=1,e=2,a=3,n=4;ee.exports=function(t,c,o,i){o=o||"name",i=i||"value";var y,p,g,h={};c&&c.length?(g=w(t,c),p=g.get()):p=t,c=c||"";var m={};if(p)for(y=0;y<p.length;y++)m[p[y][o]]=y;var u=v.test(i),_={set:function(s,A){var b=A===null?n:S;if(!p){if(!g||b===n)return;p=[],g.set(p)}var f=m[s];if(f===void 0){if(b===n)return;b=b|a,f=p.length,m[s]=f}else A!==(u?p[f][i]:w(p[f],i).get())&&(b=b|e);var x=p[f]=p[f]||{};return x[o]=s,u?x[i]=A:w(x,i).set(A),A!==null&&(b=b&~n),h[f]=h[f]|b,_},get:function(s){if(!!p){var A=m[s];if(A!==void 0)return u?p[A][i]:w(p[A],i).get()}},rename:function(s,A){var b=m[s];return b===void 0||(h[b]=h[b]|M,m[A]=b,delete m[s],p[b][o]=A),_},remove:function(s){var A=m[s];if(A===void 0)return _;var b=p[A];if(Object.keys(b).length>2)return h[A]=h[A]|e,_.set(s,null);if(u){for(y=A;y<p.length;y++)h[y]=h[y]|a;for(y=A;y<p.length;y++)m[p[y][o]]--;p.splice(A,1),delete m[s]}else w(b,i).set(null),h[A]=h[A]|e|n;return _},constructUpdate:function(){for(var s,A,b={},f=Object.keys(h),x=0;x<f.length;x++)A=f[x],s=c+"["+A+"]",p[A]?(h[A]&M&&(b[s+"."+o]=p[A][o]),h[A]&e&&(u?b[s+"."+i]=h[A]&n?null:p[A][i]:b[s+"."+i]=h[A]&n?null:w(p[A],i).get())):b[s]=null;return b}};return _}},{"./nested_property":523}],518:[function(d,ee,te){var w=d("../registry");ee.exports=function(S,M){for(var e=S._context.locale,a=0;a<2;a++){for(var n=S._context.locales,r=0;r<2;r++){var t=(n[e]||{}).dictionary;if(t){var c=t[M];if(c)return c}n=w.localeRegistry}var o=e.split("-")[0];if(o===e)break;e=o}return M}},{"../registry":647}],519:[function(d,ee,te){var w=d("../plot_api/plot_config").dfltConfig,v=d("./notifier"),S=ee.exports={};S.log=function(){var M;if(w.logging>1){var e=["LOG:"];for(M=0;M<arguments.length;M++)e.push(arguments[M]);console.trace.apply(console,e)}if(w.notifyOnLogging>1){var a=[];for(M=0;M<arguments.length;M++)a.push(arguments[M]);v(a.join("<br>"),"long")}},S.warn=function(){var M;if(w.logging>0){var e=["WARN:"];for(M=0;M<arguments.length;M++)e.push(arguments[M]);console.trace.apply(console,e)}if(w.notifyOnLogging>0){var a=[];for(M=0;M<arguments.length;M++)a.push(arguments[M]);v(a.join("<br>"),"stick")}},S.error=function(){var M;if(w.logging>0){var e=["ERROR:"];for(M=0;M<arguments.length;M++)e.push(arguments[M]);console.error.apply(console,e)}if(w.notifyOnLogging>0){var a=[];for(M=0;M<arguments.length;M++)a.push(arguments[M]);v(a.join("<br>"),"stick")}}},{"../plot_api/plot_config":553,"./notifier":525}],520:[function(d,ee,te){var w=d("@plotly/d3");ee.exports=function(S,M,e){var a=S.selectAll("g."+e.replace(/\s/g,".")).data(M,function(r){return r[0].trace.uid});a.exit().remove(),a.enter().append("g").attr("class",e),a.order();var n=S.classed("rangeplot")?"nodeRangePlot3":"node3";return a.each(function(r){r[0][n]=w.select(this)}),a}},{"@plotly/d3":58}],521:[function(d,ee,te){var w=d("gl-mat4");te.init2dArray=function(v,S){for(var M=new Array(v),e=0;e<v;e++)M[e]=new Array(S);return M},te.transposeRagged=function(v){var S=0,M=v.length,e,a;for(e=0;e<M;e++)S=Math.max(S,v[e].length);var n=new Array(S);for(e=0;e<S;e++)for(n[e]=new Array(M),a=0;a<M;a++)n[e][a]=v[a][e];return n},te.dot=function(v,S){if(!(v.length&&S.length)||v.length!==S.length)return null;var M=v.length,e,a;if(v[0].length)for(e=new Array(M),a=0;a<M;a++)e[a]=te.dot(v[a],S);else if(S[0].length){var n=te.transposeRagged(S);for(e=new Array(n.length),a=0;a<n.length;a++)e[a]=te.dot(v,n[a])}else for(e=0,a=0;a<M;a++)e+=v[a]*S[a];return e},te.translationMatrix=function(v,S){return[[1,0,v],[0,1,S],[0,0,1]]},te.rotationMatrix=function(v){var S=v*Math.PI/180;return[[Math.cos(S),-Math.sin(S),0],[Math.sin(S),Math.cos(S),0],[0,0,1]]},te.rotationXYMatrix=function(v,S,M){return te.dot(te.dot(te.translationMatrix(S,M),te.rotationMatrix(v)),te.translationMatrix(-S,-M))},te.apply3DTransform=function(v){return function(){var S=arguments,M=arguments.length===1?S[0]:[S[0],S[1],S[2]||0];return te.dot(v,[M[0],M[1],M[2],1]).slice(0,3)}},te.apply2DTransform=function(v){return function(){var S=arguments;S.length===3&&(S=S[0]);var M=arguments.length===1?S[0]:[S[0],S[1]];return te.dot(v,[M[0],M[1],1]).slice(0,2)}},te.apply2DTransform2=function(v){var S=te.apply2DTransform(v);return function(M){return S(M.slice(0,2)).concat(S(M.slice(2,4)))}},te.convertCssMatrix=function(v){if(v){var S=v.length;if(S===16)return v;if(S===6)return[v[0],v[1],0,0,v[2],v[3],0,0,0,0,1,0,v[4],v[5],0,1]}return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},te.inverseTransformMatrix=function(v){var S=[];return w.invert(S,v),[[S[0],S[1],S[2],S[3]],[S[4],S[5],S[6],S[7]],[S[8],S[9],S[10],S[11]],[S[12],S[13],S[14],S[15]]]}},{"gl-mat4":210}],522:[function(d,ee,te){function w(S,M){var e=S%M;return e<0?e+M:e}function v(S,M){return Math.abs(S)>M/2?S-Math.round(S/M)*M:S}ee.exports={mod:w,modHalf:v}},{}],523:[function(d,ee,te){var w=d("fast-isnumeric"),v=d("./array").isArrayOrTypedArray;ee.exports=function(i,y){if(w(y))y=String(y);else if(typeof y!="string"||y.substr(y.length-4)==="[-1]")throw"bad property string";for(var p=0,g=y.split("."),h,m,u;p<g.length;){if(h=String(g[p]).match(/^([^\[\]]*)((\[\-?[0-9]*\])+)$/),h){if(h[1])g[p]=h[1];else if(p===0)g.splice(0,1);else throw"bad property string";for(m=h[2].substr(1,h[2].length-2).split("]["),u=0;u<m.length;u++)p++,g.splice(p,0,Number(m[u]))}p++}return typeof i!="object"?c(i,y,g):{set:a(i,g,y),get:S(i,g),astr:y,parts:g,obj:i}};function S(o,i){return function(){var y=o,p,g,h,m,u;for(m=0;m<i.length-1;m++){if(p=i[m],p===-1){for(g=!0,h=[],u=0;u<y.length;u++)h[u]=S(y[u],i.slice(m+1))(),h[u]!==h[0]&&(g=!1);return g?h[0]:h}if(typeof p=="number"&&!v(y)||(y=y[p],typeof y!="object"||y===null))return}if(!(typeof y!="object"||y===null)&&(h=y[i[m]],h!==null))return h}}var M=/(^|\.)args\[/;function e(o,i){return o===void 0||o===null&&!i.match(M)}function a(o,i,y){return function(p){var g=o,h="",m=e(p,y),u,_;for(_=0;_<i.length-1;_++){if(u=i[_],typeof u=="number"&&!v(g))throw"array index but container is not an array";if(u===-1){if(m=!r(g,i.slice(_+1),p,y),m)break;return}if(!t(g,u,i[_+1],m))break;if(g=g[u],typeof g!="object"||g===null)throw"container is not an object";h=n(h,u)}if(m){if(_===i.length-1&&(delete g[i[_]],Array.isArray(g)&&+i[_]===g.length-1))for(;g.length&&g[g.length-1]===void 0;)g.pop()}else g[i[_]]=p}}function n(o,i){var y=i;return w(i)?y="["+i+"]":o&&(y="."+i),o+y}function r(o,i,y,p){var g=v(y),h=!0,m=y,u=p.replace("-1",0),_=g?!1:e(y,u),s=i[0],A;for(A=0;A<o.length;A++)u=p.replace("-1",A),g&&(m=y[A%y.length],_=e(m,u)),_&&(h=!1),t(o,A,s,_)&&a(o[A],i,p.replace("-1",A))(m);return h}function t(o,i,y,p){if(o[i]===void 0){if(p)return!1;typeof y=="number"?o[i]=[]:o[i]={}}return!0}function c(o,i,y){return{set:function(){throw"bad container"},get:function(){},astr:i,parts:y,obj:o}}},{"./array":497,"fast-isnumeric":190}],524:[function(d,ee,te){ee.exports=function(){}},{}],525:[function(d,ee,te){var w=d("@plotly/d3"),v=d("fast-isnumeric"),S=[];ee.exports=function(M,e){if(S.indexOf(M)!==-1)return;S.push(M);var a=1e3;v(e)?a=e:e==="long"&&(a=3e3);var n=w.select("body").selectAll(".plotly-notifier").data([0]);n.enter().append("div").classed("plotly-notifier",!0);var r=n.selectAll(".notifier-note").data(S);function t(c){c.duration(700).style("opacity",0).each("end",function(o){var i=S.indexOf(o);i!==-1&&S.splice(i,1),w.select(this).remove()})}r.enter().append("div").classed("notifier-note",!0).style("opacity",0).each(function(c){var o=w.select(this);o.append("button").classed("notifier-close",!0).html("&times;").on("click",function(){o.transition().call(t)});for(var i=o.append("p"),y=c.split(/<br\s*\/?>/g),p=0;p<y.length;p++)p&&i.append("br"),i.append("span").text(y[p]);e==="stick"?o.transition().duration(350).style("opacity",1):o.transition().duration(700).style("opacity",1).transition().delay(a).call(t)})}},{"@plotly/d3":58,"fast-isnumeric":190}],526:[function(d,ee,te){var w=d("./setcursor"),v="data-savedcursor",S="!!";ee.exports=function(e,a){var n=e.attr(v);if(a){if(!n){for(var r=(e.attr("class")||"").split(" "),t=0;t<r.length;t++){var c=r[t];c.indexOf("cursor-")===0&&e.attr(v,c.substr(7)).classed(c,!1)}e.attr(v)||e.attr(v,S)}w(e,a)}else n&&(e.attr(v,null),n===S?w(e):w(e,n))}},{"./setcursor":536}],527:[function(d,ee,te){var w=d("./matrix").dot,v=d("../constants/numerical").BADNUM,S=ee.exports={};S.tester=function(e){var a=e.slice(),n=a[0][0],r=n,t=a[0][1],c=t,o;for((a[a.length-1][0]!==a[0][0]||a[a.length-1][1]!==a[0][1])&&a.push(a[0]),o=1;o<a.length;o++)n=Math.min(n,a[o][0]),r=Math.max(r,a[o][0]),t=Math.min(t,a[o][1]),c=Math.max(c,a[o][1]);var i=!1,y;a.length===5&&(a[0][0]===a[1][0]?a[2][0]===a[3][0]&&a[0][1]===a[3][1]&&a[1][1]===a[2][1]&&(i=!0,y=function(u){return u[0]===a[0][0]}):a[0][1]===a[1][1]&&a[2][1]===a[3][1]&&a[0][0]===a[3][0]&&a[1][0]===a[2][0]&&(i=!0,y=function(u){return u[1]===a[0][1]}));function p(u,_){var s=u[0],A=u[1];return!(s===v||s<n||s>r||A===v||A<t||A>c||_&&y(u))}function g(u,_){var s=u[0],A=u[1];if(s===v||s<n||s>r||A===v||A<t||A>c)return!1;var b=a.length,f=a[0][0],x=a[0][1],l=0,L,T,k,P,z;for(L=1;L<b;L++)if(T=f,k=x,f=a[L][0],x=a[L][1],P=Math.min(T,f),!(s<P||s>Math.max(T,f)||A>Math.max(k,x)))if(A<Math.min(k,x))s!==P&&l++;else{if(f===T?z=A:z=k+(s-T)*(x-k)/(f-T),A===z)return!(L===1&&_);A<=z&&s!==P&&l++}return l%2===1}var h=!0,m=a[0];for(o=1;o<a.length;o++)if(m[0]!==a[o][0]||m[1]!==a[o][1]){h=!1;break}return{xmin:n,xmax:r,ymin:t,ymax:c,pts:a,contains:i?p:g,isRect:i,degenerate:h}},S.isSegmentBent=function(e,a,n,r){var t=e[a],c=[e[n][0]-t[0],e[n][1]-t[1]],o=w(c,c),i=Math.sqrt(o),y=[-c[1]/i,c[0]/i],p,g,h;for(p=a+1;p<n;p++)if(g=[e[p][0]-t[0],e[p][1]-t[1]],h=w(g,c),h<0||h>o||Math.abs(w(g,y))>r)return!0;return!1},S.filter=function(e,a){var n=[e[0]],r=0,t=0;function c(i){e.push(i);var y=n.length,p=r;n.splice(t+1);for(var g=p+1;g<e.length;g++)(g===e.length-1||S.isSegmentBent(e,p,g+1,a))&&(n.push(e[g]),n.length<y-2&&(r=g,t=n.length-1),p=g)}if(e.length>1){var o=e.pop();c(o)}return{addPt:c,raw:e,filtered:n}}},{"../constants/numerical":491,"./matrix":521}],528:[function(d,ee,te){(function(w){(function(){var v=d("./show_no_webgl_msg"),S=d("regl");ee.exports=function(e,a,n){var r=e._fullLayout,t=!0;return r._glcanvas.each(function(c){if(c.regl){c.regl.preloadCachedCode(n);return}if(!(c.pick&&!r._has("parcoords"))){try{c.regl=S({canvas:this,attributes:{antialias:!c.pick,preserveDrawingBuffer:!0},pixelRatio:e._context.plotGlPixelRatio||w.devicePixelRatio,extensions:a||[],cachedCode:n||{}})}catch{t=!1}c.regl||(t=!1),t&&this.addEventListener("webglcontextlost",function(o){e&&e.emit&&e.emit("plotly_webglcontextlost",{event:o,layer:c.key})},!1)}}),t||v({container:r._glcontainer.node()}),t}}).call(this)}).call(this,typeof To<"u"?To:typeof self<"u"?self:typeof window<"u"?window:{})},{"./show_no_webgl_msg":537,regl:284}],529:[function(d,ee,te){var w=d("fast-isnumeric"),v=d("is-mobile");ee.exports=function(e){var a;if(e&&e.hasOwnProperty("userAgent")?a=e.userAgent:a=S(),typeof a!="string")return!0;var n=v({ua:{headers:{"user-agent":a}},tablet:!0,featureDetect:!1});if(!n)for(var r=a.split(" "),t=1;t<r.length;t++){var c=r[t];if(c.indexOf("Safari")!==-1)for(var o=t-1;o>-1;o--){var i=r[o];if(i.substr(0,8)==="Version/"){var y=i.substr(8).split(".")[0];if(w(y)&&(y=+y),y>=13)return!0}}}return n};function S(){var M;return typeof navigator<"u"&&(M=navigator.userAgent),M&&M.headers&&typeof M.headers["user-agent"]=="string"&&(M=M.headers["user-agent"]),M}},{"fast-isnumeric":190,"is-mobile":234}],530:[function(d,ee,te){ee.exports=function(v,S){if(S instanceof RegExp){for(var M=S.toString(),e=0;e<v.length;e++)if(v[e]instanceof RegExp&&v[e].toString()===M)return v;v.push(S)}else(S||S===0)&&v.indexOf(S)===-1&&v.push(S);return v}},{}],531:[function(d,ee,te){var w=d("../lib"),v=d("../plot_api/plot_config").dfltConfig;function S(e,a){for(var n=[],r,t=0;t<a.length;t++)r=a[t],r===e?n[t]=r:typeof r=="object"?n[t]=Array.isArray(r)?w.extendDeep([],r):w.extendDeepAll({},r):n[t]=r;return n}var M={};M.add=function(e,a,n,r,t){var c,o;if(e.undoQueue=e.undoQueue||{index:0,queue:[],sequence:!1},o=e.undoQueue.index,e.autoplay){e.undoQueue.inSequence||(e.autoplay=!1);return}!e.undoQueue.sequence||e.undoQueue.beginSequence?(c={undo:{calls:[],args:[]},redo:{calls:[],args:[]}},e.undoQueue.queue.splice(o,e.undoQueue.queue.length-o,c),e.undoQueue.index+=1):c=e.undoQueue.queue[o-1],e.undoQueue.beginSequence=!1,c&&(c.undo.calls.unshift(a),c.undo.args.unshift(n),c.redo.calls.push(r),c.redo.args.push(t)),e.undoQueue.queue.length>v.queueLength&&(e.undoQueue.queue.shift(),e.undoQueue.index--)},M.startSequence=function(e){e.undoQueue=e.undoQueue||{index:0,queue:[],sequence:!1},e.undoQueue.sequence=!0,e.undoQueue.beginSequence=!0},M.stopSequence=function(e){e.undoQueue=e.undoQueue||{index:0,queue:[],sequence:!1},e.undoQueue.sequence=!1,e.undoQueue.beginSequence=!1},M.undo=function(a){var n,r;if(!(a.undoQueue===void 0||isNaN(a.undoQueue.index)||a.undoQueue.index<=0)){for(a.undoQueue.index--,n=a.undoQueue.queue[a.undoQueue.index],a.undoQueue.inSequence=!0,r=0;r<n.undo.calls.length;r++)M.plotDo(a,n.undo.calls[r],n.undo.args[r]);a.undoQueue.inSequence=!1,a.autoplay=!1}},M.redo=function(a){var n,r;if(!(a.undoQueue===void 0||isNaN(a.undoQueue.index)||a.undoQueue.index>=a.undoQueue.queue.length)){for(n=a.undoQueue.queue[a.undoQueue.index],a.undoQueue.inSequence=!0,r=0;r<n.redo.calls.length;r++)M.plotDo(a,n.redo.calls[r],n.redo.args[r]);a.undoQueue.inSequence=!1,a.autoplay=!1,a.undoQueue.index++}},M.plotDo=function(e,a,n){e.autoplay=!0,n=S(e,n),a.apply(null,n)},ee.exports=M},{"../lib":515,"../plot_api/plot_config":553}],532:[function(d,ee,te){te.counter=function(w,v,S,M){var e=(v||"")+(S?"":"$"),a=M===!1?"":"^";return w==="xy"?new RegExp(a+"x([2-9]|[1-9][0-9]+)?y([2-9]|[1-9][0-9]+)?"+e):new RegExp(a+w+"([2-9]|[1-9][0-9]+)?"+e)}},{}],533:[function(d,ee,te){var w=/^(.*)(\.[^\.\[\]]+|\[\d\])$/,v=/^[^\.\[\]]+$/;ee.exports=function(S,M){for(;M;){var e=S.match(w);if(e)S=e[1];else if(S.match(v))S="";else throw new Error("bad relativeAttr call:"+[S,M]);if(M.charAt(0)==="^")M=M.slice(1);else break}return S&&M.charAt(0)!=="["?S+"."+M:S+M}},{}],534:[function(d,ee,te){var w=d("./array").isArrayOrTypedArray,v=d("./is_plain_object");ee.exports=function S(M,e){for(var a in e){var n=e[a],r=M[a];if(r!==n)if(a.charAt(0)==="_"||typeof n=="function"){if(a in M)continue;M[a]=n}else if(w(n)&&w(r)&&v(n[0])){if(a==="customdata"||a==="ids")continue;for(var t=Math.min(n.length,r.length),c=0;c<t;c++)r[c]!==n[c]&&v(n[c])&&v(r[c])&&S(r[c],n[c])}else v(n)&&v(r)&&(S(r,n),Object.keys(r).length||delete M[a])}}},{"./array":497,"./is_plain_object":516}],535:[function(d,ee,te){var w=d("fast-isnumeric"),v=d("./loggers"),S=d("./identity"),M=d("../constants/numerical").BADNUM,e=1e-9;te.findBin=function(c,o,i){if(w(o.start))return i?Math.ceil((c-o.start)/o.size-e)-1:Math.floor((c-o.start)/o.size+e);var y=0,p=o.length,g=0,h=p>1?(o[p-1]-o[0])/(p-1):1,m,u;for(h>=0?u=i?a:n:u=i?t:r,c+=h*e*(i?-1:1)*(h>=0?1:-1);y<p&&g++<100;)m=Math.floor((y+p)/2),u(o[m],c)?y=m+1:p=m;return g>90&&v.log("Long binary search..."),y-1};function a(c,o){return c<o}function n(c,o){return c<=o}function r(c,o){return c>o}function t(c,o){return c>=o}te.sorterAsc=function(c,o){return c-o},te.sorterDes=function(c,o){return o-c},te.distinctVals=function(c){var o=c.slice();o.sort(te.sorterAsc);var i;for(i=o.length-1;i>-1&&o[i]===M;i--);for(var y=o[i]-o[0]||1,p=y/(i||1)/1e4,g=[],h,m=0;m<=i;m++){var u=o[m],_=u-h;h===void 0?(g.push(u),h=u):_>p&&(y=Math.min(y,_),g.push(u),h=u)}return{vals:g,minDiff:y}},te.roundUp=function(c,o,i){for(var y=0,p=o.length-1,g,h=0,m=i?0:1,u=i?1:0,_=i?Math.ceil:Math.floor;y<p&&h++<100;)g=_((y+p)/2),o[g]<=c?y=g+m:p=g-u;return o[y]},te.sort=function(c,o){for(var i=0,y=0,p=1;p<c.length;p++){var g=o(c[p],c[p-1]);if(g<0?i=1:g>0&&(y=1),i&&y)return c.sort(o)}return y?c:c.reverse()},te.findIndexOfMin=function(c,o){o=o||S;for(var i=1/0,y,p=0;p<c.length;p++){var g=o(c[p]);g<i&&(i=g,y=p)}return y}},{"../constants/numerical":491,"./identity":513,"./loggers":519,"fast-isnumeric":190}],536:[function(d,ee,te){ee.exports=function(v,S){(v.attr("class")||"").split(" ").forEach(function(M){M.indexOf("cursor-")===0&&v.classed(M,!1)}),S&&v.classed("cursor-"+S,!0)}},{}],537:[function(d,ee,te){var w=d("../components/color"),v=function(){};ee.exports=function(M){for(var e in M)typeof M[e]=="function"&&(M[e]=v);M.destroy=function(){M.container.parentNode.removeChild(M.container)};var a=document.createElement("div");a.className="no-webgl",a.style.cursor="pointer",a.style.fontSize="24px",a.style.color=w.defaults[0],a.style.position="absolute",a.style.left=a.style.top="0px",a.style.width=a.style.height="100%",a.style["background-color"]=w.lightLine,a.style["z-index"]=30;var n=document.createElement("p");return n.textContent="WebGL is not supported by your browser - visit https://get.webgl.org for more info",n.style.position="relative",n.style.top="50%",n.style.left="50%",n.style.height="30%",n.style.width="50%",n.style.margin="-15% 0 0 -25%",a.appendChild(n),M.container.appendChild(a),M.container.style.background="#FFFFFF",M.container.onclick=function(){window.open("https://get.webgl.org")},!1}},{"../components/color":367}],538:[function(d,ee,te){ee.exports=function(v){return Object.keys(v).sort()}},{}],539:[function(d,ee,te){var w=d("fast-isnumeric"),v=d("./array").isArrayOrTypedArray;te.aggNums=function(S,M,e,a){var n,r;if((!a||a>e.length)&&(a=e.length),w(M)||(M=!1),v(e[0])){for(r=new Array(a),n=0;n<a;n++)r[n]=te.aggNums(S,M,e[n]);e=r}for(n=0;n<a;n++)w(M)?w(e[n])&&(M=S(+M,+e[n])):M=e[n];return M},te.len=function(S){return te.aggNums(function(M){return M+1},0,S)},te.mean=function(S,M){return M||(M=te.len(S)),te.aggNums(function(e,a){return e+a},0,S)/M},te.midRange=function(S){if(!(S===void 0||S.length===0))return(te.aggNums(Math.max,null,S)+te.aggNums(Math.min,null,S))/2},te.variance=function(S,M,e){return M||(M=te.len(S)),w(e)||(e=te.mean(S,M)),te.aggNums(function(a,n){return a+Math.pow(n-e,2)},0,S)/M},te.stdev=function(S,M,e){return Math.sqrt(te.variance(S,M,e))},te.median=function(S){var M=S.slice().sort();return te.interp(M,.5)},te.interp=function(S,M){if(!w(M))throw"n should be a finite number";if(M=M*S.length-.5,M<0)return S[0];if(M>S.length-1)return S[S.length-1];var e=M%1;return e*S[Math.ceil(M)]+(1-e)*S[Math.floor(M)]}},{"./array":497,"fast-isnumeric":190}],540:[function(d,ee,te){var w=d("color-normalize");function v(S){return S?w(S):[0,0,0,1]}ee.exports=v},{"color-normalize":89}],541:[function(d,ee,te){var w=d("@plotly/d3"),v=d("../lib"),S=v.strTranslate,M=d("../constants/xmlns_namespaces"),e=d("../constants/alignment").LINE_SPACING,a=/([^$]*)([$]+[^$]*[$]+)([^$]*)/;te.convertToTspans=function(F,H,G){var J=F.text(),X=!F.attr("data-notex")&&H&&H._context.typesetMath&&typeof MathJax<"u"&&J.match(a),Y=w.select(F.node().parentNode);if(Y.empty())return;var Z=F.attr("class")?F.attr("class").split(" ")[0]:"text";Z+="-math",Y.selectAll("svg."+Z).remove(),Y.selectAll("g."+Z+"-group").remove(),F.style("display",null).attr({"data-unformatted":J,"data-math":"N"});function oe(){Y.empty()||(Z=F.attr("class")+"-math",Y.select("svg."+Z).remove()),F.text("").style("white-space","pre");var re=I(F.node(),J);re&&F.style("pointer-events","all"),te.positionText(F),G&&G.call(F)}return X?(H&&H._promises||[]).push(new Promise(function(re){F.style("display","none");var se=parseInt(F.node().style.fontSize,10),N={fontSize:se};o(X[2],N,function(U,q,$){Y.selectAll("svg."+Z).remove(),Y.selectAll("g."+Z+"-group").remove();var W=U&&U.select("svg");if(!W||!W.node()){oe(),re();return}var K=Y.append("g").classed(Z+"-group",!0).attr({"pointer-events":"none","data-unformatted":J,"data-math":"Y"});K.node().appendChild(W.node()),q&&q.node()&&W.node().insertBefore(q.node().cloneNode(!0),W.node().firstChild);var ne=$.width,ae=$.height;W.attr({class:Z,height:ae,preserveAspectRatio:"xMinYMin meet"}).style({overflow:"visible","pointer-events":"none"});var ie=F.node().style.fill||"black",le=W.select("g");le.attr({fill:ie,stroke:ie});var ye=le.node().getBoundingClientRect(),ue=ye.width,pe=ye.height;(ue>ne||pe>ae)&&(W.style("overflow","hidden"),ye=W.node().getBoundingClientRect(),ue=ye.width,pe=ye.height);var ge=+F.attr("x"),Te=+F.attr("y"),_e=se||F.node().getBoundingClientRect().height,ze=-_e/4;if(Z[0]==="y")K.attr({transform:"rotate("+[-90,ge,Te]+")"+S(-ue/2,ze-pe/2)});else if(Z[0]==="l")Te=ze-pe/2;else if(Z[0]==="a"&&Z.indexOf("atitle")!==0)ge=0,Te=ze;else{var Oe=F.attr("text-anchor");ge=ge-ue*(Oe==="middle"?.5:Oe==="end"?1:0),Te=Te+ze-pe/2}W.attr({x:ge,y:Te}),G&&G.call(F,K),re(K)})})):oe(),F};var n=/(<|&lt;|&#60;)/g,r=/(>|&gt;|&#62;)/g;function t(F){return F.replace(n,"\\lt ").replace(r,"\\gt ")}var c=[["$","$"],["\\(","\\)"]];function o(F,H,G){var J=parseInt((MathJax.version||"").split(".")[0]);if(J!==2&&J!==3){v.warn("No MathJax version:",MathJax.version);return}var X,Y,Z,oe,re=function(){return Y=v.extendDeepAll({},MathJax.Hub.config),Z=MathJax.Hub.processSectionDelay,MathJax.Hub.processSectionDelay!==void 0&&(MathJax.Hub.processSectionDelay=0),MathJax.Hub.Config({messageStyle:"none",tex2jax:{inlineMath:c},displayAlign:"left"})},se=function(){Y=v.extendDeepAll({},MathJax.config),MathJax.config.tex||(MathJax.config.tex={}),MathJax.config.tex.inlineMath=c},N=function(){if(X=MathJax.Hub.config.menuSettings.renderer,X!=="SVG")return MathJax.Hub.setRenderer("SVG")},U=function(){X=MathJax.config.startup.output,X!=="svg"&&(MathJax.config.startup.output="svg")},q=function(){var ie="math-output-"+v.randstr({},64);oe=w.select("body").append("div").attr({id:ie}).style({visibility:"hidden",position:"absolute","font-size":H.fontSize+"px"}).text(t(F));var le=oe.node();return J===2?MathJax.Hub.Typeset(le):MathJax.typeset([le])},$=function(){var ie=oe.select(J===2?".MathJax_SVG":".MathJax"),le=!ie.empty()&&oe.select("svg").node();if(!le)v.log("There was an error in the tex syntax.",F),G();else{var ye=le.getBoundingClientRect(),ue;J===2?ue=w.select("body").select("#MathJax_SVG_glyphs"):ue=ie.select("defs"),G(ie,ue,ye)}oe.remove()},W=function(){if(X!=="SVG")return MathJax.Hub.setRenderer(X)},K=function(){X!=="svg"&&(MathJax.config.startup.output=X)},ne=function(){return Z!==void 0&&(MathJax.Hub.processSectionDelay=Z),MathJax.Hub.Config(Y)},ae=function(){MathJax.config=Y};J===2?MathJax.Hub.Queue(re,N,q,$,W,ne):J===3&&(se(),U(),MathJax.startup.defaultReady(),MathJax.startup.promise.then(function(){q(),$(),K(),ae()}))}var i={sup:"font-size:70%",sub:"font-size:70%",b:"font-weight:bold",i:"font-style:italic",a:"cursor:pointer",span:"",em:"font-style:italic;font-weight:bold"},y={sub:"0.3em",sup:"-0.6em"},p={sub:"-0.21em",sup:"0.42em"},g="\u200B",h=["http:","https:","mailto:","",void 0,":"],m=te.NEWLINES=/(\r\n?|\n)/g,u=/(<[^<>]*>)/,_=/<(\/?)([^ >]*)(\s+(.*))?>/i,s=/<br(\s+.*)?>/i;te.BR_TAG_ALL=/<br(\s+.*)?>/gi;var A=/(^|[\s"'])style\s*=\s*("([^"]*);?"|'([^']*);?')/i,b=/(^|[\s"'])href\s*=\s*("([^"]*)"|'([^']*)')/i,f=/(^|[\s"'])target\s*=\s*("([^"\s]*)"|'([^'\s]*)')/i,x=/(^|[\s"'])popup\s*=\s*("([\w=,]*)"|'([\w=,]*)')/i;function l(F,H){if(!F)return null;var G=F.match(H),J=G&&(G[3]||G[4]);return J&&P(J)}var L=/(^|;)\s*color:/;te.plainText=function(F,H){H=H||{};for(var G=H.len!==void 0&&H.len!==-1?H.len:1/0,J=H.allowedTags!==void 0?H.allowedTags:["br"],X="...",Y=X.length,Z=F.split(u),oe=[],re="",se=0,N=0;N<Z.length;N++){var U=Z[N],q=U.match(_),$=q&&q[2].toLowerCase();if($)J.indexOf($)!==-1&&(oe.push(U),re=$);else{var W=U.length;if(se+W<G)oe.push(U),se+=W;else if(se<G){var K=G-se;re&&(re!=="br"||K<=Y||W<=Y)&&oe.pop(),G>Y?oe.push(U.substr(0,K-Y)+X):oe.push(U.substr(0,K));break}re=""}}return oe.join("")};var T={mu:"\u03BC",amp:"&",lt:"<",gt:">",nbsp:"\xA0",times:"\xD7",plusmn:"\xB1",deg:"\xB0"},k=/&(#\d+|#x[\da-fA-F]+|[a-z]+);/g;function P(F){return F.replace(k,function(H,G){var J;return G.charAt(0)==="#"?J=z(G.charAt(1)==="x"?parseInt(G.substr(2),16):parseInt(G.substr(1),10)):J=T[G],J||H})}te.convertEntities=P;function z(F){if(!(F>1114111)){var H=String.fromCodePoint;if(H)return H(F);var G=String.fromCharCode;return F<=65535?G(F):G((F>>10)+55232,F%1024+56320)}}function I(F,H){H=H.replace(m," ");var G=!1,J=[],X,Y=-1;function Z(){Y++;var pe=document.createElementNS(M.svg,"tspan");w.select(pe).attr({class:"line",dy:Y*e+"em"}),F.appendChild(pe),X=pe;var ge=J;if(J=[{node:pe}],ge.length>1)for(var Te=1;Te<ge.length;Te++)oe(ge[Te])}function oe(pe){var ge=pe.type,Te={},_e;if(ge==="a"){_e="a";var ze=pe.target,Oe=pe.href,Ye=pe.popup;Oe&&(Te={"xlink:xlink:show":ze==="_blank"||ze.charAt(0)!=="_"?"new":"replace",target:ze,"xlink:xlink:href":Oe},Ye&&(Te.onclick='window.open(this.href.baseVal,this.target.baseVal,"'+Ye+'");return false;'))}else _e="tspan";pe.style&&(Te.style=pe.style);var be=document.createElementNS(M.svg,_e);if(ge==="sup"||ge==="sub"){re(X,g),X.appendChild(be);var Pe=document.createElementNS(M.svg,"tspan");re(Pe,g),w.select(Pe).attr("dy",p[ge]),Te.dy=y[ge],X.appendChild(be),X.appendChild(Pe)}else X.appendChild(be);w.select(be).attr(Te),X=pe.node=be,J.push(pe)}function re(pe,ge){pe.appendChild(document.createTextNode(ge))}function se(pe){if(J.length===1){v.log("Ignoring unexpected end tag </"+pe+">.",H);return}var ge=J.pop();pe!==ge.type&&v.log("Start tag <"+ge.type+"> doesnt match end tag <"+pe+">. Pretending it did match.",H),X=J[J.length-1].node}var N=s.test(H);N?Z():(X=F,J=[{node:F}]);for(var U=H.split(u),q=0;q<U.length;q++){var $=U[q],W=$.match(_),K=W&&W[2].toLowerCase(),ne=i[K];if(K==="br")Z();else if(ne===void 0)re(X,P($));else if(W[1])se(K);else{var ae=W[4],ie={type:K},le=l(ae,A);if(le?(le=le.replace(L,"$1 fill:"),ne&&(le+=";"+ne)):ne&&(le=ne),le&&(ie.style=le),K==="a"){G=!0;var ye=l(ae,b);if(ye){var ue=D(ye);ue&&(ie.href=ue,ie.target=l(ae,f)||"_blank",ie.popup=l(ae,x))}}oe(ie)}}return G}function D(F){var H=encodeURI(decodeURI(F)),G=document.createElement("a"),J=document.createElement("a");G.href=F,J.href=H;var X=G.protocol,Y=J.protocol;return h.indexOf(X)!==-1&&h.indexOf(Y)!==-1?H:""}te.sanitizeHTML=function(H){H=H.replace(m," ");for(var G=document.createElement("p"),J=G,X=[],Y=H.split(u),Z=0;Z<Y.length;Z++){var oe=Y[Z],re=oe.match(_),se=re&&re[2].toLowerCase();if(se in i)if(re[1])X.length&&(J=X.pop());else{var N=re[4],U=l(N,A),q=U?{style:U}:{};if(se==="a"){var $=l(N,b);if($){var W=D($);if(W){q.href=W;var K=l(N,f);K&&(q.target=K)}}}var ne=document.createElement(se);J.appendChild(ne),w.select(ne).attr(q),J=ne,X.push(ne)}else J.appendChild(document.createTextNode(P(oe)))}var ae="innerHTML";return G[ae]},te.lineCount=function(H){return H.selectAll("tspan.line").size()||1},te.positionText=function(H,G,J){return H.each(function(){var X=w.select(this);function Y(re,se){return se===void 0?(se=X.attr(re),se===null&&(X.attr(re,0),se=0)):X.attr(re,se),se}var Z=Y("x",G),oe=Y("y",J);this.nodeName==="text"&&X.selectAll("tspan.line").attr({x:Z,y:oe})})};function R(F,H,G){var J=G.horizontalAlign,X=G.verticalAlign||"top",Y=F.node().getBoundingClientRect(),Z=H.node().getBoundingClientRect(),oe,re,se;return X==="bottom"?re=function(){return Y.bottom-oe.height}:X==="middle"?re=function(){return Y.top+(Y.height-oe.height)/2}:re=function(){return Y.top},J==="right"?se=function(){return Y.right-oe.width}:J==="center"?se=function(){return Y.left+(Y.width-oe.width)/2}:se=function(){return Y.left},function(){oe=this.node().getBoundingClientRect();var N=se()-Z.left,U=re()-Z.top,q=G.gd||{};if(G.gd){q._fullLayout._calcInverseTransform(q);var $=v.apply3DTransform(q._fullLayout._invTransform)(N,U);N=$[0],U=$[1]}return this.style({top:U+"px",left:N+"px","z-index":1e3}),this}}var B="1px ";te.makeTextShadow=function(F){var H=B,G=B,J=B;return H+G+J+F+", -"+H+"-"+G+J+F+", "+H+"-"+G+J+F+", -"+H+G+J+F},te.makeEditable=function(F,H){var G=H.gd,J=H.delegate,X=w.dispatch("edit","input","cancel"),Y=J||F;if(F.style({"pointer-events":J?"none":"all"}),F.size()!==1)throw new Error("boo");function Z(){re(),F.style({opacity:0});var se=Y.attr("class"),N;se?N="."+se.split(" ")[0]+"-math-group":N="[class*=-math-group]",N&&w.select(F.node().parentNode).select(N).style({opacity:0})}function oe(se){var N=se.node(),U=document.createRange();U.selectNodeContents(N);var q=window.getSelection();q.removeAllRanges(),q.addRange(U),N.focus()}function re(){var se=w.select(G),N=se.select(".svg-container"),U=N.append("div"),q=F.node().style,$=parseFloat(q.fontSize||12),W=H.text;W===void 0&&(W=F.attr("data-unformatted")),U.classed("plugin-editable editable",!0).style({position:"absolute","font-family":q.fontFamily||"Arial","font-size":$,color:H.fill||q.fill||"black",opacity:1,"background-color":H.background||"transparent",outline:"#ffffff33 1px solid",margin:[-$/8+1,0,0,-1].join("px ")+"px",padding:"0","box-sizing":"border-box"}).attr({contenteditable:!0}).text(W).call(R(F,N,H)).on("blur",function(){G._editing=!1,F.text(this.textContent).style({opacity:1});var K=w.select(this).attr("class"),ne;K?ne="."+K.split(" ")[0]+"-math-group":ne="[class*=-math-group]",ne&&w.select(F.node().parentNode).select(ne).style({opacity:0});var ae=this.textContent;w.select(this).transition().duration(0).remove(),w.select(document).on("mouseup",null),X.edit.call(F,ae)}).on("focus",function(){var K=this;G._editing=!0,w.select(document).on("mouseup",function(){if(w.event.target===K)return!1;document.activeElement===U.node()&&U.node().blur()})}).on("keyup",function(){w.event.which===27?(G._editing=!1,F.style({opacity:1}),w.select(this).style({opacity:0}).on("blur",function(){return!1}).transition().remove(),X.cancel.call(F,this.textContent)):(X.input.call(F,this.textContent),w.select(this).call(R(F,N,H)))}).on("keydown",function(){w.event.which===13&&this.blur()}).call(oe)}return H.immediate?Z():Y.on("click",Z),w.rebind(F,X,"on")}},{"../constants/alignment":483,"../constants/xmlns_namespaces":492,"../lib":515,"@plotly/d3":58}],542:[function(d,ee,te){var w={};te.throttle=function(M,e,a){var n=w[M],r=Date.now();if(!n){for(var t in w)w[t].ts<r-6e4&&delete w[t];n=w[M]={ts:0,timer:null}}v(n);function c(){a(),n.ts=Date.now(),n.onDone&&(n.onDone(),n.onDone=null)}if(r>n.ts+e){c();return}n.timer=setTimeout(function(){c(),n.timer=null},e)},te.done=function(S){var M=w[S];return!M||!M.timer?Promise.resolve():new Promise(function(e){var a=M.onDone;M.onDone=function(){a&&a(),e(),M.onDone=null}})},te.clear=function(S){if(S)v(w[S]),delete w[S];else for(var M in w)te.clear(M)};function v(S){S&&S.timer!==null&&(clearTimeout(S.timer),S.timer=null)}},{}],543:[function(d,ee,te){var w=d("fast-isnumeric");ee.exports=function(S,M){if(S>0)return Math.log(S)/Math.LN10;var e=Math.log(Math.min(M[0],M[1]))/Math.LN10;return w(e)||(e=Math.log(Math.max(M[0],M[1]))/Math.LN10-6),e}},{"fast-isnumeric":190}],544:[function(d,ee,te){var w=ee.exports={},v=d("../plots/geo/constants").locationmodeToLayer,S=d("topojson-client").feature;w.getTopojsonName=function(M){return[M.scope.replace(/ /g,"-"),"_",M.resolution.toString(),"m"].join("")},w.getTopojsonPath=function(M,e){return M+e+".json"},w.getTopojsonFeatures=function(M,e){var a=v[M.locationmode],n=e.objects[a];return S(e,n).features}},{"../plots/geo/constants":596,"topojson-client":316}],545:[function(d,ee,te){ee.exports={moduleType:"locale",name:"en-US",dictionary:{"Click to enter Colorscale title":"Click to enter Colorscale title"},format:{date:"%m/%d/%Y"}}},{}],546:[function(d,ee,te){ee.exports={moduleType:"locale",name:"en",dictionary:{"Click to enter Colorscale title":"Click to enter Colourscale title"},format:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],periods:["AM","PM"],dateTime:"%a %b %e %X %Y",date:"%d/%m/%Y",time:"%H:%M:%S",decimal:".",thousands:",",grouping:[3],currency:["$",""],year:"%Y",month:"%b %Y",dayMonth:"%b %-d",dayMonthYear:"%b %-d, %Y"}}},{}],547:[function(d,ee,te){var w=d("../registry");ee.exports=function(S){for(var M=w.layoutArrayContainers,e=w.layoutArrayRegexes,a=S.split("[")[0],n,r,t=0;t<e.length;t++)if(r=S.match(e[t]),r&&r.index===0){n=r[0];break}if(n||(n=M[M.indexOf(a)]),!n)return!1;var c=S.substr(n.length);return c?(r=c.match(/^\[(0|[1-9][0-9]*)\](\.(.+))?$/),r?{array:n,index:Number(r[1]),property:r[3]||""}:!1):{array:n,index:"",property:""}}},{"../registry":647}],548:[function(d,ee,te){var w=d("../lib"),v=w.extendFlat,S=w.isPlainObject,M={valType:"flaglist",extras:["none"],flags:["calc","clearAxisTypes","plot","style","markerSize","colorbars"]},e={valType:"flaglist",extras:["none"],flags:["calc","plot","legend","ticks","axrange","layoutstyle","modebar","camera","arraydraw","colorbars"]},a=M.flags.slice().concat(["fullReplot"]),n=e.flags.slice().concat("layoutReplot");ee.exports={traces:M,layout:e,traceFlags:function(){return r(a)},layoutFlags:function(){return r(n)},update:function(o,i){var y=i.editType;if(y&&y!=="none")for(var p=y.split("+"),g=0;g<p.length;g++)o[p[g]]=!0},overrideAll:t};function r(o){for(var i={},y=0;y<o.length;y++)i[o[y]]=!1;return i}function t(o,i,y){var p=v({},o);for(var g in p){var h=p[g];S(h)&&(p[g]=c(h,i,y,g))}return y==="from-root"&&(p.editType=i),p}function c(o,i,y,p){if(o.valType){var g=v({},o);if(g.editType=i,Array.isArray(o.items)){g.items=new Array(o.items.length);for(var h=0;h<o.items.length;h++)g.items[h]=c(o.items[h],i)}return g}else return t(o,i,p.charAt(0)==="_"?"nested":"from-root")}},{"../lib":515}],549:[function(d,ee,te){var w=d("fast-isnumeric"),v=d("gl-mat4/fromQuat"),S=d("../registry"),M=d("../lib"),e=d("../plots/plots"),a=d("../plots/cartesian/axis_ids"),n=d("../components/color"),r=a.cleanId,t=a.getFromTrace,c=S.traceIs;te.clearPromiseQueue=function(s){Array.isArray(s._promises)&&s._promises.length>0&&M.log("Clearing previous rejected promises from queue."),s._promises=[]},te.cleanLayout=function(s){var A,b;s||(s={}),s.xaxis1&&(s.xaxis||(s.xaxis=s.xaxis1),delete s.xaxis1),s.yaxis1&&(s.yaxis||(s.yaxis=s.yaxis1),delete s.yaxis1),s.scene1&&(s.scene||(s.scene=s.scene1),delete s.scene1);var f=(e.subplotsRegistry.cartesian||{}).attrRegex,x=(e.subplotsRegistry.polar||{}).attrRegex,l=(e.subplotsRegistry.ternary||{}).attrRegex,L=(e.subplotsRegistry.gl3d||{}).attrRegex,T=Object.keys(s);for(A=0;A<T.length;A++){var k=T[A];if(f&&f.test(k)){var P=s[k];P.anchor&&P.anchor!=="free"&&(P.anchor=r(P.anchor)),P.overlaying&&(P.overlaying=r(P.overlaying)),P.type||(P.isdate?P.type="date":P.islog?P.type="log":P.isdate===!1&&P.islog===!1&&(P.type="linear")),(P.autorange==="withzero"||P.autorange==="tozero")&&(P.autorange=!0,P.rangemode="tozero"),delete P.islog,delete P.isdate,delete P.categories,h(P,"domain")&&delete P.domain,P.autotick!==void 0&&(P.tickmode===void 0&&(P.tickmode=P.autotick?"auto":"linear"),delete P.autotick),i(P)}else if(x&&x.test(k)){var z=s[k];i(z.radialaxis)}else if(l&&l.test(k)){var I=s[k];i(I.aaxis),i(I.baxis),i(I.caxis)}else if(L&&L.test(k)){var D=s[k],R=D.cameraposition;if(Array.isArray(R)&&R[0].length===4){var B=R[0],F=R[1],H=R[2],G=v([],B),J=[];for(b=0;b<3;++b)J[b]=F[b]+H*G[2+4*b];D.camera={eye:{x:J[0],y:J[1],z:J[2]},center:{x:F[0],y:F[1],z:F[2]},up:{x:0,y:0,z:1}},delete D.cameraposition}i(D.xaxis),i(D.yaxis),i(D.zaxis)}}var X=Array.isArray(s.annotations)?s.annotations.length:0;for(A=0;A<X;A++){var Y=s.annotations[A];!M.isPlainObject(Y)||(Y.ref&&(Y.ref==="paper"?(Y.xref="paper",Y.yref="paper"):Y.ref==="data"&&(Y.xref="x",Y.yref="y"),delete Y.ref),o(Y,"xref"),o(Y,"yref"))}var Z=Array.isArray(s.shapes)?s.shapes.length:0;for(A=0;A<Z;A++){var oe=s.shapes[A];!M.isPlainObject(oe)||(o(oe,"xref"),o(oe,"yref"))}var re=Array.isArray(s.images)?s.images.length:0;for(A=0;A<re;A++){var se=s.images[A];!M.isPlainObject(se)||(o(se,"xref"),o(se,"yref"))}var N=s.legend;return N&&(N.x>3?(N.x=1.02,N.xanchor="left"):N.x<-2&&(N.x=-.02,N.xanchor="right"),N.y>3?(N.y=1.02,N.yanchor="bottom"):N.y<-2&&(N.y=-.02,N.yanchor="top")),i(s),s.dragmode==="rotate"&&(s.dragmode="orbit"),n.clean(s),s.template&&s.template.layout&&te.cleanLayout(s.template.layout),s};function o(s,A){var b=s[A],f=A.charAt(0);b&&b!=="paper"&&(s[A]=r(b,f,!0))}function i(s){s&&((typeof s.title=="string"||typeof s.title=="number")&&(s.title={text:s.title}),A("titlefont","font"),A("titleposition","position"),A("titleside","side"),A("titleoffset","offset"));function A(b,f){var x=s[b],l=s.title&&s.title[f];x&&!l&&(s.title||(s.title={}),s.title[f]=s[b],delete s[b])}}te.cleanData=function(s){for(var A=0;A<s.length;A++){var b=s[A],f;if(b.type==="histogramy"&&"xbins"in b&&!("ybins"in b)&&(b.ybins=b.xbins,delete b.xbins),b.error_y&&"opacity"in b.error_y){var x=n.defaults,l=b.error_y.color||(c(b,"bar")?n.defaultLine:x[A%x.length]);b.error_y.color=n.addOpacity(n.rgb(l),n.opacity(l)*b.error_y.opacity),delete b.error_y.opacity}if("bardir"in b&&(b.bardir==="h"&&(c(b,"bar")||b.type.substr(0,9)==="histogram")&&(b.orientation="h",te.swapXYData(b)),delete b.bardir),b.type==="histogramy"&&te.swapXYData(b),(b.type==="histogramx"||b.type==="histogramy")&&(b.type="histogram"),"scl"in b&&!("colorscale"in b)&&(b.colorscale=b.scl,delete b.scl),"reversescl"in b&&!("reversescale"in b)&&(b.reversescale=b.reversescl,delete b.reversescl),b.xaxis&&(b.xaxis=r(b.xaxis,"x")),b.yaxis&&(b.yaxis=r(b.yaxis,"y")),c(b,"gl3d")&&b.scene&&(b.scene=e.subplotsRegistry.gl3d.cleanId(b.scene)),!c(b,"pie-like")&&!c(b,"bar-like"))if(Array.isArray(b.textposition))for(f=0;f<b.textposition.length;f++)b.textposition[f]=g(b.textposition[f]);else b.textposition&&(b.textposition=g(b.textposition));var L=S.getModule(b);if(L&&L.colorbar){var T=L.colorbar.container,k=T?b[T]:b;k&&k.colorscale&&(k.colorscale==="YIGnBu"&&(k.colorscale="YlGnBu"),k.colorscale==="YIOrRd"&&(k.colorscale="YlOrRd"))}if(b.type==="surface"&&M.isPlainObject(b.contours)){var P=["x","y","z"];for(f=0;f<P.length;f++){var z=b.contours[P[f]];!M.isPlainObject(z)||(z.highlightColor&&(z.highlightcolor=z.highlightColor,delete z.highlightColor),z.highlightWidth&&(z.highlightwidth=z.highlightWidth,delete z.highlightWidth))}}if(b.type==="candlestick"||b.type==="ohlc"){var I=(b.increasing||{}).showlegend!==!1,D=(b.decreasing||{}).showlegend!==!1,R=y(b.increasing),B=y(b.decreasing);if(R!==!1&&B!==!1){var F=p(R,B,I,D);F&&(b.name=F)}else(R||B)&&!b.name&&(b.name=R||B)}if(Array.isArray(b.transforms)){var H=b.transforms;for(f=0;f<H.length;f++){var G=H[f];if(!!M.isPlainObject(G))switch(G.type){case"filter":G.filtersrc&&(G.target=G.filtersrc,delete G.filtersrc),G.calendar&&(G.valuecalendar||(G.valuecalendar=G.calendar),delete G.calendar);break;case"groupby":if(G.styles=G.styles||G.style,G.styles&&!Array.isArray(G.styles)){var J=G.styles,X=Object.keys(J);G.styles=[];for(var Y=0;Y<X.length;Y++)G.styles.push({target:X[Y],value:J[X[Y]]})}break}}}h(b,"line")&&delete b.line,"marker"in b&&(h(b.marker,"line")&&delete b.marker.line,h(b,"marker")&&delete b.marker),n.clean(b),b.autobinx&&(delete b.autobinx,delete b.xbins),b.autobiny&&(delete b.autobiny,delete b.ybins),i(b),b.colorbar&&i(b.colorbar),b.marker&&b.marker.colorbar&&i(b.marker.colorbar),b.line&&b.line.colorbar&&i(b.line.colorbar),b.aaxis&&i(b.aaxis),b.baxis&&i(b.baxis)}};function y(s){if(!M.isPlainObject(s))return!1;var A=s.name;return delete s.name,delete s.showlegend,(typeof A=="string"||typeof A=="number")&&String(A)}function p(s,A,b,f){if(b&&!f)return s;if(f&&!b||!s.trim())return A;if(!A.trim())return s;var x=Math.min(s.length,A.length),l;for(l=0;l<x&&s.charAt(l)===A.charAt(l);l++);var L=s.substr(0,l);return L.trim()}function g(s){var A="middle",b="center";return typeof s=="string"&&(s.indexOf("top")!==-1?A="top":s.indexOf("bottom")!==-1&&(A="bottom"),s.indexOf("left")!==-1?b="left":s.indexOf("right")!==-1&&(b="right")),A+" "+b}function h(s,A){return A in s&&typeof s[A]=="object"&&Object.keys(s[A]).length===0}te.swapXYData=function(s){var A;if(M.swapAttrs(s,["?","?0","d?","?bins","nbins?","autobin?","?src","error_?"]),Array.isArray(s.z)&&Array.isArray(s.z[0])&&(s.transpose?delete s.transpose:s.transpose=!0),s.error_x&&s.error_y){var b=s.error_y,f="copy_ystyle"in b?b.copy_ystyle:!(b.color||b.thickness||b.width);M.swapAttrs(s,["error_?.copy_ystyle"]),f&&M.swapAttrs(s,["error_?.color","error_?.thickness","error_?.width"])}if(typeof s.hoverinfo=="string"){var x=s.hoverinfo.split("+");for(A=0;A<x.length;A++)x[A]==="x"?x[A]="y":x[A]==="y"&&(x[A]="x");s.hoverinfo=x.join("+")}},te.coerceTraceIndices=function(s,A){if(w(A))return[A];if(!Array.isArray(A)||!A.length)return s.data.map(function(x,l){return l});if(Array.isArray(A)){for(var b=[],f=0;f<A.length;f++)M.isIndex(A[f],s.data.length)?b.push(A[f]):M.warn("trace index (",A[f],") is not a number or is out of bounds");return b}return A},te.manageArrayContainers=function(s,A,b){var f=s.obj,x=s.parts,l=x.length,L=x[l-1],T=w(L);if(T&&A===null){var k=x.slice(0,l-1).join("."),P=M.nestedProperty(f,k).get();P.splice(L,1)}else T&&s.get()===void 0&&s.get()===void 0&&(b[s.astr]=null),s.set(A)};var m=/(\.[^\[\]\.]+|\[[^\[\]\.]+\])$/;function u(s){var A=s.search(m);if(A>0)return s.substr(0,A)}te.hasParent=function(s,A){for(var b=u(A);b;){if(b in s)return!0;b=u(b)}return!1};var _=["x","y","z"];te.clearAxisTypes=function(s,A,b){for(var f=0;f<A.length;f++)for(var x=s._fullData[f],l=0;l<3;l++){var L=t(s,x,_[l]);if(L&&L.type!=="log"){var T=L._name,k=L._id.substr(1);if(k.substr(0,5)==="scene"){if(b[k]!==void 0)continue;T=k+"."+T}var P=T+".type";b[T]===void 0&&b[P]===void 0&&M.nestedProperty(s.layout,P).set(null)}}}},{"../components/color":367,"../lib":515,"../plots/cartesian/axis_ids":570,"../plots/plots":628,"../registry":647,"fast-isnumeric":190,"gl-mat4/fromQuat":200}],550:[function(d,ee,te){var w=d("./plot_api");te._doPlot=w._doPlot,te.newPlot=w.newPlot,te.restyle=w.restyle,te.relayout=w.relayout,te.redraw=w.redraw,te.update=w.update,te._guiRestyle=w._guiRestyle,te._guiRelayout=w._guiRelayout,te._guiUpdate=w._guiUpdate,te._storeDirectGUIEdit=w._storeDirectGUIEdit,te.react=w.react,te.extendTraces=w.extendTraces,te.prependTraces=w.prependTraces,te.addTraces=w.addTraces,te.deleteTraces=w.deleteTraces,te.moveTraces=w.moveTraces,te.purge=w.purge,te.addFrames=w.addFrames,te.deleteFrames=w.deleteFrames,te.animate=w.animate,te.setPlotConfig=w.setPlotConfig,te.toImage=d("./to_image"),te.validate=d("./validate"),te.downloadImage=d("../snapshot/download");var v=d("./template_api");te.makeTemplate=v.makeTemplate,te.validateTemplate=v.validateTemplate},{"../snapshot/download":649,"./plot_api":552,"./template_api":557,"./to_image":558,"./validate":559}],551:[function(d,ee,te){var w=d("../lib/is_plain_object"),v=d("../lib/noop"),S=d("../lib/loggers"),M=d("../lib/search").sorterAsc,e=d("../registry");te.containerArrayMatch=d("./container_array_match");var a=te.isAddVal=function(t){return t==="add"||w(t)},n=te.isRemoveVal=function(t){return t===null||t==="remove"};te.applyContainerArrayChanges=function(t,c,o,i,y){var p=c.astr,g=e.getComponentMethod(p,"supplyLayoutDefaults"),h=e.getComponentMethod(p,"draw"),m=e.getComponentMethod(p,"drawOne"),u=i.replot||i.recalc||g===v||h===v,_=t.layout,s=t._fullLayout;if(o[""]){Object.keys(o).length>1&&S.warn("Full array edits are incompatible with other edits",p);var A=o[""][""];if(n(A))c.set(null);else if(Array.isArray(A))c.set(A);else return S.warn("Unrecognized full array edit value",p,A),!0;return u?!1:(g(_,s),h(t),!0)}var b=Object.keys(o).map(Number).sort(M),f=c.get(),x=f||[],l=y(s,p).get(),L=[],T=-1,k=x.length,P,z,I,D,R,B,F,H;for(P=0;P<b.length;P++){if(I=b[P],D=o[I],R=Object.keys(D),B=D[""],F=a(B),I<0||I>x.length-(F?0:1)){S.warn("index out of range",p,I);continue}if(B!==void 0)R.length>1&&S.warn("Insertion & removal are incompatible with edits to the same index.",p,I),n(B)?L.push(I):F?(B==="add"&&(B={}),x.splice(I,0,B),l&&l.splice(I,0,{})):S.warn("Unrecognized full object edit value",p,I,B),T===-1&&(T=I);else for(z=0;z<R.length;z++)H=p+"["+I+"].",y(x[I],R[z],H).set(D[R[z]])}for(P=L.length-1;P>=0;P--)x.splice(L[P],1),l&&l.splice(L[P],1);if(x.length?f||c.set(x):c.set(null),u)return!1;if(g(_,s),m!==v){var G;if(T===-1)G=b;else{for(k=Math.max(x.length,k),G=[],P=0;P<b.length&&(I=b[P],!(I>=T));P++)G.push(I);for(P=T;P<k;P++)G.push(P)}for(P=0;P<G.length;P++)m(t,G[P])}else h(t);return!0}},{"../lib/is_plain_object":516,"../lib/loggers":519,"../lib/noop":524,"../lib/search":535,"../registry":647,"./container_array_match":547}],552:[function(d,ee,te){var w=d("@plotly/d3"),v=d("fast-isnumeric"),S=d("has-hover"),M=d("../lib"),e=M.nestedProperty,a=d("../lib/events"),n=d("../lib/queue"),r=d("../registry"),t=d("./plot_schema"),c=d("../plots/plots"),o=d("../plots/cartesian/axes"),i=d("../components/drawing"),y=d("../components/color"),p=d("../plots/cartesian/graph_interact").initInteractions,g=d("../constants/xmlns_namespaces"),h=d("../components/selections").clearOutline,m=d("./plot_config").dfltConfig,u=d("./manage_arrays"),_=d("./helpers"),s=d("./subroutines"),A=d("./edit_types"),b=d("../plots/cartesian/constants").AX_NAME_PATTERN,f=0,x=5;function l(Ae,Ne,Xe,Je){var _t;if(Ae=M.getGraphDiv(Ae),a.init(Ae),M.isPlainObject(Ne)){var mt=Ne;Ne=mt.data,Xe=mt.layout,Je=mt.config,_t=mt.frames}var Ot=a.triggerHandler(Ae,"plotly_beforeplot",[Ne,Xe,Je]);if(Ot===!1)return Promise.reject();!Ne&&!Xe&&!M.isPlotDiv(Ae)&&M.warn("Calling _doPlot as if redrawing but this container doesn't yet have a plot.",Ae);function Kt(){if(_t)return te.addFrames(Ae,_t)}z(Ae,Je),Xe||(Xe={}),w.select(Ae).classed("js-plotly-plot",!0),i.makeTester(),Array.isArray(Ae._promises)||(Ae._promises=[]);var Nt=(Ae.data||[]).length===0&&Array.isArray(Ne);Array.isArray(Ne)&&(_.cleanData(Ne),Nt?Ae.data=Ne:Ae.data.push.apply(Ae.data,Ne),Ae.empty=!1),(!Ae.layout||Nt)&&(Ae.layout=_.cleanLayout(Xe)),c.supplyDefaults(Ae);var Wt=Ae._fullLayout,qt=Wt._has("cartesian");Wt._replotting=!0,(Nt||Wt._shouldCreateBgLayer)&&(Ve(Ae),Wt._shouldCreateBgLayer&&delete Wt._shouldCreateBgLayer),i.initGradients(Ae),i.initPatterns(Ae),Nt&&o.saveShowSpikeInitial(Ae);var Yt=!Ae.calcdata||Ae.calcdata.length!==(Ae._fullData||[]).length;Yt&&c.doCalcdata(Ae);for(var fr=0;fr<Ae.calcdata.length;fr++)Ae.calcdata[fr][0].trace=Ae._fullData[fr];Ae._context.responsive?Ae._responsiveChartHandler||(Ae._responsiveChartHandler=function(){M.isHidden(Ae)||c.resize(Ae)},window.addEventListener("resize",Ae._responsiveChartHandler)):M.clearResponsive(Ae);var Yr=M.extendFlat({},Wt._size),hn=0;function Qr(){for(var lt=Wt._basePlotModules,wt=0;wt<lt.length;wt++)lt[wt].drawFramework&&lt[wt].drawFramework(Ae);!Wt._glcanvas&&Wt._has("gl")&&(Wt._glcanvas=Wt._glcontainer.selectAll(".gl-canvas").data([{key:"contextLayer",context:!0,pick:!1},{key:"focusLayer",context:!1,pick:!1},{key:"pickLayer",context:!1,pick:!0}],function(nt){return nt.key}),Wt._glcanvas.enter().append("canvas").attr("class",function(nt){return"gl-canvas gl-canvas-"+nt.key.replace("Layer","")}).style({position:"absolute",top:0,left:0,overflow:"visible","pointer-events":"none"}));var Pt=Ae._context.plotGlPixelRatio;if(Wt._glcanvas){Wt._glcanvas.attr("width",Wt.width*Pt).attr("height",Wt.height*Pt).style("width",Wt.width+"px").style("height",Wt.height+"px");var ke=Wt._glcanvas.data()[0].regl;if(ke&&(Math.floor(Wt.width*Pt)!==ke._gl.drawingBufferWidth||Math.floor(Wt.height*Pt)!==ke._gl.drawingBufferHeight)){var Se="WebGL context buffer and canvas dimensions do not match due to browser/WebGL bug.";if(hn)M.error(Se);else return M.log(Se+" Clearing graph and plotting again."),c.cleanPlot([],{},Ae._fullData,Wt),c.supplyDefaults(Ae),Wt=Ae._fullLayout,c.doCalcdata(Ae),hn++,Qr()}}return Wt.modebar.orientation==="h"?Wt._modebardiv.style("height",null).style("width","100%"):Wt._modebardiv.style("width",null).style("height",Wt.height+"px"),c.previousPromises(Ae)}function at(){if(c.clearAutoMarginIds(Ae),s.drawMarginPushers(Ae),o.allowAutoMargin(Ae),Wt._has("pie"))for(var lt=Ae._fullData,wt=0;wt<lt.length;wt++){var Pt=lt[wt];Pt.type==="pie"&&Pt.automargin&&c.allowAutoMargin(Ae,"pie."+Pt.uid+".automargin")}return c.doAutoMargin(Ae),c.previousPromises(Ae)}function Jt(){if(!!c.didMarginChange(Yr,Wt._size))return M.syncOrAsync([at,s.layoutStyles],Ae)}function Zt(){if(!Yt){Ut();return}return M.syncOrAsync([r.getComponentMethod("shapes","calcAutorange"),r.getComponentMethod("annotations","calcAutorange"),Ut],Ae)}function Ut(){Ae._transitioning||(s.doAutoRangeAndConstraints(Ae),Nt&&o.saveRangeInitial(Ae),r.getComponentMethod("rangeslider","calcAutorange")(Ae))}function _r(){return o.draw(Ae,Nt?"":"redraw")}var rt=[c.previousPromises,Kt,Qr,at,Jt];qt&&rt.push(Zt),rt.push(s.layoutStyles),qt&&rt.push(_r,function(wt){wt._fullLayout._insideTickLabelsAutorange&&ie(wt,wt._fullLayout._insideTickLabelsAutorange).then(function(){wt._fullLayout._insideTickLabelsAutorange=void 0})}),rt.push(s.drawData,s.finalDraw,p,c.addLinks,c.rehover,c.redrag,c.reselect,c.doAutoMargin,Ke,c.previousPromises);function Ke(lt){lt._fullLayout._insideTickLabelsAutorange&&Nt&&o.saveRangeInitial(lt,!0)}var st=M.syncOrAsync(rt,Ae);return(!st||!st.then)&&(st=Promise.resolve()),st.then(function(){return L(Ae),Ae})}function L(Ae){var Ne=Ae._fullLayout;Ne._redrawFromAutoMarginCount?Ne._redrawFromAutoMarginCount--:Ae.emit("plotly_afterplot")}function T(Ae){return M.extendFlat(m,Ae)}function k(Ae,Ne){try{Ae._fullLayout._paper.style("background",Ne)}catch(Xe){M.error(Xe)}}function P(Ae,Ne){var Xe=y.combine(Ne,"white");k(Ae,Xe)}function z(Ae,Ne){if(!Ae._context){Ae._context=M.extendDeep({},m);var Xe=w.select("base");Ae._context._baseUrl=Xe.size()&&Xe.attr("href")?window.location.href.split("#")[0]:""}var Je=Ae._context,_t,mt,Ot;if(Ne){for(mt=Object.keys(Ne),_t=0;_t<mt.length;_t++)Ot=mt[_t],!(Ot==="editable"||Ot==="edits")&&Ot in Je&&(Ot==="setBackground"&&Ne[Ot]==="opaque"?Je[Ot]=P:Je[Ot]=Ne[Ot]);Ne.plot3dPixelRatio&&!Je.plotGlPixelRatio&&(Je.plotGlPixelRatio=Je.plot3dPixelRatio);var Kt=Ne.editable;if(Kt!==void 0)for(Je.editable=Kt,mt=Object.keys(Je.edits),_t=0;_t<mt.length;_t++)Je.edits[mt[_t]]=Kt;if(Ne.edits)for(mt=Object.keys(Ne.edits),_t=0;_t<mt.length;_t++)Ot=mt[_t],Ot in Je.edits&&(Je.edits[Ot]=Ne.edits[Ot]);Je._exportedPlot=Ne._exportedPlot}Je.staticPlot&&(Je.editable=!1,Je.edits={},Je.autosizable=!1,Je.scrollZoom=!1,Je.doubleClick=!1,Je.showTips=!1,Je.showLink=!1,Je.displayModeBar=!1),Je.displayModeBar==="hover"&&!S&&(Je.displayModeBar=!0),(Je.setBackground==="transparent"||typeof Je.setBackground!="function")&&(Je.setBackground=k),Je._hasZeroHeight=Je._hasZeroHeight||Ae.clientHeight===0,Je._hasZeroWidth=Je._hasZeroWidth||Ae.clientWidth===0;var Nt=Je.scrollZoom,Wt=Je._scrollZoom={};if(Nt===!0)Wt.cartesian=1,Wt.gl3d=1,Wt.geo=1,Wt.mapbox=1;else if(typeof Nt=="string"){var qt=Nt.split("+");for(_t=0;_t<qt.length;_t++)Wt[qt[_t]]=1}else Nt!==!1&&(Wt.gl3d=1,Wt.geo=1,Wt.mapbox=1)}function I(Ae){if(Ae=M.getGraphDiv(Ae),!M.isPlotDiv(Ae))throw new Error("This element is not a Plotly plot: "+Ae);return _.cleanData(Ae.data),_.cleanLayout(Ae.layout),Ae.calcdata=void 0,te._doPlot(Ae).then(function(){return Ae.emit("plotly_redraw"),Ae})}function D(Ae,Ne,Xe,Je){return Ae=M.getGraphDiv(Ae),c.cleanPlot([],{},Ae._fullData||[],Ae._fullLayout||{}),c.purge(Ae),te._doPlot(Ae,Ne,Xe,Je)}function R(Ae,Ne){var Xe=Ne+1,Je=[],_t,mt;for(_t=0;_t<Ae.length;_t++)mt=Ae[_t],mt<0?Je.push(Xe+mt):Je.push(mt);return Je}function B(Ae,Ne,Xe){var Je,_t;for(Je=0;Je<Ne.length;Je++){if(_t=Ne[Je],_t!==parseInt(_t,10))throw new Error("all values in "+Xe+" must be integers");if(_t>=Ae.data.length||_t<-Ae.data.length)throw new Error(Xe+" must be valid indices for gd.data.");if(Ne.indexOf(_t,Je+1)>-1||_t>=0&&Ne.indexOf(-Ae.data.length+_t)>-1||_t<0&&Ne.indexOf(Ae.data.length+_t)>-1)throw new Error("each index in "+Xe+" must be unique.")}}function F(Ae,Ne,Xe){if(!Array.isArray(Ae.data))throw new Error("gd.data must be an array.");if(typeof Ne>"u")throw new Error("currentIndices is a required argument.");if(Array.isArray(Ne)||(Ne=[Ne]),B(Ae,Ne,"currentIndices"),typeof Xe<"u"&&!Array.isArray(Xe)&&(Xe=[Xe]),typeof Xe<"u"&&B(Ae,Xe,"newIndices"),typeof Xe<"u"&&Ne.length!==Xe.length)throw new Error("current and new indices must be of equal length.")}function H(Ae,Ne,Xe){var Je,_t;if(!Array.isArray(Ae.data))throw new Error("gd.data must be an array.");if(typeof Ne>"u")throw new Error("traces must be defined.");for(Array.isArray(Ne)||(Ne=[Ne]),Je=0;Je<Ne.length;Je++)if(_t=Ne[Je],typeof _t!="object"||Array.isArray(_t)||_t===null)throw new Error("all values in traces array must be non-array objects");if(typeof Xe<"u"&&!Array.isArray(Xe)&&(Xe=[Xe]),typeof Xe<"u"&&Xe.length!==Ne.length)throw new Error("if indices is specified, traces.length must equal indices.length")}function G(Ae,Ne,Xe,Je){var _t=M.isPlainObject(Je);if(!Array.isArray(Ae.data))throw new Error("gd.data must be an array");if(!M.isPlainObject(Ne))throw new Error("update must be a key:value object");if(typeof Xe>"u")throw new Error("indices must be an integer or array of integers");B(Ae,Xe,"indices");for(var mt in Ne){if(!Array.isArray(Ne[mt])||Ne[mt].length!==Xe.length)throw new Error("attribute "+mt+" must be an array of length equal to indices array length");if(_t&&(!(mt in Je)||!Array.isArray(Je[mt])||Je[mt].length!==Ne[mt].length))throw new Error("when maxPoints is set as a key:value object it must contain a 1:1 corrispondence with the keys and number of traces in the update object")}}function J(Ae,Ne,Xe,Je){var _t=M.isPlainObject(Je),mt=[],Ot,Kt,Nt,Wt,qt;Array.isArray(Xe)||(Xe=[Xe]),Xe=R(Xe,Ae.data.length-1);for(var Yt in Ne)for(var fr=0;fr<Xe.length;fr++){if(Ot=Ae.data[Xe[fr]],Nt=e(Ot,Yt),Kt=Nt.get(),Wt=Ne[Yt][fr],!M.isArrayOrTypedArray(Wt))throw new Error("attribute: "+Yt+" index: "+fr+" must be an array");if(!M.isArrayOrTypedArray(Kt))throw new Error("cannot extend missing or non-array attribute: "+Yt);if(Kt.constructor!==Wt.constructor)throw new Error("cannot extend array with an array of a different type: "+Yt);qt=_t?Je[Yt][fr]:Je,v(qt)||(qt=-1),mt.push({prop:Nt,target:Kt,insert:Wt,maxp:Math.floor(qt)})}return mt}function X(Ae,Ne,Xe,Je,_t){G(Ae,Ne,Xe,Je);for(var mt=J(Ae,Ne,Xe,Je),Ot={},Kt={},Nt=0;Nt<mt.length;Nt++){var Wt=mt[Nt].prop,qt=mt[Nt].maxp,Yt=_t(mt[Nt].target,mt[Nt].insert,qt);Wt.set(Yt[0]),Array.isArray(Ot[Wt.astr])||(Ot[Wt.astr]=[]),Ot[Wt.astr].push(Yt[1]),Array.isArray(Kt[Wt.astr])||(Kt[Wt.astr]=[]),Kt[Wt.astr].push(mt[Nt].target.length)}return{update:Ot,maxPoints:Kt}}function Y(Ae,Ne){var Xe=new Ae.constructor(Ae.length+Ne.length);return Xe.set(Ae),Xe.set(Ne,Ae.length),Xe}function Z(Ae,Ne,Xe,Je){Ae=M.getGraphDiv(Ae);function _t(Nt,Wt,qt){var Yt,fr;if(M.isTypedArray(Nt))if(qt<0){var Yr=new Nt.constructor(0),hn=Y(Nt,Wt);qt<0?(Yt=hn,fr=Yr):(Yt=Yr,fr=hn)}else if(Yt=new Nt.constructor(qt),fr=new Nt.constructor(Nt.length+Wt.length-qt),qt===Wt.length)Yt.set(Wt),fr.set(Nt);else if(qt<Wt.length){var Qr=Wt.length-qt;Yt.set(Wt.subarray(Qr)),fr.set(Nt),fr.set(Wt.subarray(0,Qr),Nt.length)}else{var at=qt-Wt.length,Jt=Nt.length-at;Yt.set(Nt.subarray(Jt)),Yt.set(Wt,at),fr.set(Nt.subarray(0,Jt))}else Yt=Nt.concat(Wt),fr=qt>=0&&qt<Yt.length?Yt.splice(0,Yt.length-qt):[];return[Yt,fr]}var mt=X(Ae,Ne,Xe,Je,_t),Ot=te.redraw(Ae),Kt=[Ae,mt.update,Xe,mt.maxPoints];return n.add(Ae,te.prependTraces,Kt,Z,arguments),Ot}function oe(Ae,Ne,Xe,Je){Ae=M.getGraphDiv(Ae);function _t(Nt,Wt,qt){var Yt,fr;if(M.isTypedArray(Nt))if(qt<=0){var Yr=new Nt.constructor(0),hn=Y(Wt,Nt);qt<0?(Yt=hn,fr=Yr):(Yt=Yr,fr=hn)}else if(Yt=new Nt.constructor(qt),fr=new Nt.constructor(Nt.length+Wt.length-qt),qt===Wt.length)Yt.set(Wt),fr.set(Nt);else if(qt<Wt.length){var Qr=Wt.length-qt;Yt.set(Wt.subarray(0,Qr)),fr.set(Wt.subarray(Qr)),fr.set(Nt,Qr)}else{var at=qt-Wt.length;Yt.set(Wt),Yt.set(Nt.subarray(0,at),Wt.length),fr.set(Nt.subarray(at))}else Yt=Wt.concat(Nt),fr=qt>=0&&qt<Yt.length?Yt.splice(qt,Yt.length):[];return[Yt,fr]}var mt=X(Ae,Ne,Xe,Je,_t),Ot=te.redraw(Ae),Kt=[Ae,mt.update,Xe,mt.maxPoints];return n.add(Ae,te.extendTraces,Kt,oe,arguments),Ot}function re(Ae,Ne,Xe){Ae=M.getGraphDiv(Ae);var Je=[],_t=te.deleteTraces,mt=re,Ot=[Ae,Je],Kt=[Ae,Ne],Nt,Wt;for(H(Ae,Ne,Xe),Array.isArray(Ne)||(Ne=[Ne]),Ne=Ne.map(function(qt){return M.extendFlat({},qt)}),_.cleanData(Ne),Nt=0;Nt<Ne.length;Nt++)Ae.data.push(Ne[Nt]);for(Nt=0;Nt<Ne.length;Nt++)Je.push(-Ne.length+Nt);if(typeof Xe>"u")return Wt=te.redraw(Ae),n.add(Ae,_t,Ot,mt,Kt),Wt;Array.isArray(Xe)||(Xe=[Xe]);try{F(Ae,Je,Xe)}catch(qt){throw Ae.data.splice(Ae.data.length-Ne.length,Ne.length),qt}return n.startSequence(Ae),n.add(Ae,_t,Ot,mt,Kt),Wt=te.moveTraces(Ae,Je,Xe),n.stopSequence(Ae),Wt}function se(Ae,Ne){Ae=M.getGraphDiv(Ae);var Xe=[],Je=te.addTraces,_t=se,mt=[Ae,Xe,Ne],Ot=[Ae,Ne],Kt,Nt;if(typeof Ne>"u")throw new Error("indices must be an integer or array of integers.");for(Array.isArray(Ne)||(Ne=[Ne]),B(Ae,Ne,"indices"),Ne=R(Ne,Ae.data.length-1),Ne.sort(M.sorterDes),Kt=0;Kt<Ne.length;Kt+=1)Nt=Ae.data.splice(Ne[Kt],1)[0],Xe.push(Nt);var Wt=te.redraw(Ae);return n.add(Ae,Je,mt,_t,Ot),Wt}function N(Ae,Ne,Xe){Ae=M.getGraphDiv(Ae);var Je=[],_t=[],mt=N,Ot=N,Kt=[Ae,Xe,Ne],Nt=[Ae,Ne,Xe],Wt;if(F(Ae,Ne,Xe),Ne=Array.isArray(Ne)?Ne:[Ne],typeof Xe>"u")for(Xe=[],Wt=0;Wt<Ne.length;Wt++)Xe.push(-Ne.length+Wt);for(Xe=Array.isArray(Xe)?Xe:[Xe],Ne=R(Ne,Ae.data.length-1),Xe=R(Xe,Ae.data.length-1),Wt=0;Wt<Ae.data.length;Wt++)Ne.indexOf(Wt)===-1&&Je.push(Ae.data[Wt]);for(Wt=0;Wt<Ne.length;Wt++)_t.push({newIndex:Xe[Wt],trace:Ae.data[Ne[Wt]]});for(_t.sort(function(Yt,fr){return Yt.newIndex-fr.newIndex}),Wt=0;Wt<_t.length;Wt+=1)Je.splice(_t[Wt].newIndex,0,_t[Wt].trace);Ae.data=Je;var qt=te.redraw(Ae);return n.add(Ae,mt,Kt,Ot,Nt),qt}function U(Ae,Ne,Xe,Je){Ae=M.getGraphDiv(Ae),_.clearPromiseQueue(Ae);var _t={};if(typeof Ne=="string")_t[Ne]=Xe;else if(M.isPlainObject(Ne))_t=M.extendFlat({},Ne),Je===void 0&&(Je=Xe);else return M.warn("Restyle fail.",Ne,Xe,Je),Promise.reject();Object.keys(_t).length&&(Ae.changed=!0);var mt=_.coerceTraceIndices(Ae,Je),Ot=ne(Ae,_t,mt),Kt=Ot.flags;Kt.calc&&(Ae.calcdata=void 0),Kt.clearAxisTypes&&_.clearAxisTypes(Ae,mt,{});var Nt=[];Kt.fullReplot?Nt.push(te._doPlot):(Nt.push(c.previousPromises),c.supplyDefaults(Ae),Kt.markerSize&&(c.doCalcdata(Ae),ye(Nt)),Kt.style&&Nt.push(s.doTraceStyle),Kt.colorbars&&Nt.push(s.doColorBars),Nt.push(L)),Nt.push(c.rehover,c.redrag,c.reselect),n.add(Ae,U,[Ae,Ot.undoit,Ot.traces],U,[Ae,Ot.redoit,Ot.traces]);var Wt=M.syncOrAsync(Nt,Ae);return(!Wt||!Wt.then)&&(Wt=Promise.resolve()),Wt.then(function(){return Ae.emit("plotly_restyle",Ot.eventData),Ae})}function q(Ae){return Ae===void 0?null:Ae}function $(Ae,Ne){return Ne?function(Xe,Je,_t){var mt=e(Xe,Je),Ot=mt.set;return mt.set=function(Kt){var Nt=(_t||"")+Je;W(Nt,mt.get(),Kt,Ae),Ot(Kt)},mt}:e}function W(Ae,Ne,Xe,Je){if(Array.isArray(Ne)||Array.isArray(Xe))for(var _t=Array.isArray(Ne)?Ne:[],mt=Array.isArray(Xe)?Xe:[],Ot=Math.max(_t.length,mt.length),Kt=0;Kt<Ot;Kt++)W(Ae+"["+Kt+"]",_t[Kt],mt[Kt],Je);else if(M.isPlainObject(Ne)||M.isPlainObject(Xe)){var Nt=M.isPlainObject(Ne)?Ne:{},Wt=M.isPlainObject(Xe)?Xe:{},qt=M.extendFlat({},Nt,Wt);for(var Yt in qt)W(Ae+"."+Yt,Nt[Yt],Wt[Yt],Je)}else Je[Ae]===void 0&&(Je[Ae]=q(Ne))}function K(Ae,Ne,Xe){for(var Je in Xe){var _t=e(Ae,Je);W(Je,_t.get(),Xe[Je],Ne)}}function ne(Ae,Ne,Xe){var Je=Ae._fullLayout,_t=Ae._fullData,mt=Ae.data,Ot=Je._guiEditing,Kt=$(Je._preGUI,Ot),Nt=M.extendDeepAll({},Ne),Wt;ae(Ne);var qt=A.traceFlags(),Yt={},fr={},Yr;function hn(){return Xe.map(function(){})}function Qr(Vt){var ar=o.id2name(Vt);Yr.indexOf(ar)===-1&&Yr.push(ar)}function at(Vt){return"LAYOUT"+Vt+".autorange"}function Jt(Vt){return"LAYOUT"+Vt+".range"}function Zt(Vt){for(var ar=Vt;ar<_t.length;ar++)if(_t[ar]._input===mt[Vt])return _t[ar]}function Ut(Vt,ar,Cr){if(Array.isArray(Vt)){Vt.forEach(function(Wr){Ut(Wr,ar,Cr)});return}if(!(Vt in Ne||_.hasParent(Ne,Vt))){var Or;if(Vt.substr(0,6)==="LAYOUT")Or=Kt(Ae.layout,Vt.replace("LAYOUT",""));else{var Ir=Xe[Cr],Tr=Je._tracePreGUI[Zt(Ir)._fullInput.uid];Or=$(Tr,Ot)(mt[Ir],Vt)}Vt in fr||(fr[Vt]=hn()),fr[Vt][Cr]===void 0&&(fr[Vt][Cr]=q(Or.get())),ar!==void 0&&Or.set(ar)}}function _r(Vt){return function(ar){return _t[ar][Vt]}}function rt(Vt){return function(ar,Cr){return ar===!1?_t[Xe[Cr]][Vt]:null}}for(var Ke in Ne){if(_.hasParent(Ne,Ke))throw new Error("cannot set "+Ke+" and a parent attribute simultaneously");var st=Ne[Ke],lt,wt,Pt,ke,Se,nt;if((Ke==="autobinx"||Ke==="autobiny")&&(Ke=Ke.charAt(Ke.length-1)+"bins",Array.isArray(st)?st=st.map(rt(Ke)):st===!1?st=Xe.map(_r(Ke)):st=null),Yt[Ke]=st,Ke.substr(0,6)==="LAYOUT"){Pt=Kt(Ae.layout,Ke.replace("LAYOUT","")),fr[Ke]=[q(Pt.get())],Pt.set(Array.isArray(st)?st[0]:st),qt.calc=!0;continue}for(fr[Ke]=hn(),Wt=0;Wt<Xe.length;Wt++){lt=mt[Xe[Wt]],wt=Zt(Xe[Wt]);var it=Je._tracePreGUI[wt._fullInput.uid];if(Pt=$(it,Ot)(lt,Ke),ke=Pt.get(),Se=Array.isArray(st)?st[Wt%st.length]:st,Se!==void 0){var ct=Pt.parts[Pt.parts.length-1],At=Ke.substr(0,Ke.length-ct.length-1),dt=At?At+".":"",Tt=At?e(wt,At).get():wt;if(nt=t.getTraceValObject(wt,Pt.parts),nt&&nt.impliedEdits&&Se!==null)for(var Ht in nt.impliedEdits)Ut(M.relativeAttr(Ke,Ht),nt.impliedEdits[Ht],Wt);else if((ct==="thicknessmode"||ct==="lenmode")&&ke!==Se&&(Se==="fraction"||Se==="pixels")&&Tt){var ir=Je._size,kr=Tt.orient,br=kr==="top"||kr==="bottom";if(ct==="thicknessmode"){var Mr=br?ir.h:ir.w;Ut(dt+"thickness",Tt.thickness*(Se==="fraction"?1/Mr:Mr),Wt)}else{var Hr=br?ir.w:ir.h;Ut(dt+"len",Tt.len*(Se==="fraction"?1/Hr:Hr),Wt)}}else if(Ke==="type"&&(Se==="pie"!=(ke==="pie")||Se==="funnelarea"!=(ke==="funnelarea"))){var nr="x",mr="y";(Se==="bar"||ke==="bar")&&lt.orientation==="h"&&(nr="y",mr="x"),M.swapAttrs(lt,["?","?src"],"labels",nr),M.swapAttrs(lt,["d?","?0"],"label",nr),M.swapAttrs(lt,["?","?src"],"values",mr),ke==="pie"||ke==="funnelarea"?(e(lt,"marker.color").set(e(lt,"marker.colors").get()),Je._pielayer.selectAll("g.trace").remove()):r.traceIs(lt,"cartesian")&&e(lt,"marker.colors").set(e(lt,"marker.color").get())}fr[Ke][Wt]=q(ke);var Pr=["swapxy","swapxyaxes","orientation","orientationaxes"];if(Pr.indexOf(Ke)!==-1){if(Ke==="orientation"){Pt.set(Se);var Nr=lt.x&&!lt.y?"h":"v";if((Pt.get()||Nr)===wt.orientation)continue}else Ke==="orientationaxes"&&(lt.orientation={v:"h",h:"v"}[wt.orientation]);_.swapXYData(lt),qt.calc=qt.clearAxisTypes=!0}else c.dataArrayContainers.indexOf(Pt.parts[0])!==-1?(_.manageArrayContainers(Pt,Se,fr),qt.calc=!0):(nt?nt.arrayOk&&!r.traceIs(wt,"regl")&&(M.isArrayOrTypedArray(Se)||M.isArrayOrTypedArray(ke))?qt.calc=!0:A.update(qt,nt):qt.calc=!0,Pt.set(Se))}}if(["swapxyaxes","orientationaxes"].indexOf(Ke)!==-1&&o.swap(Ae,Xe),Ke==="orientationaxes"){var Sr=e(Ae.layout,"hovermode"),tt=Sr.get();tt==="x"?Sr.set("y"):tt==="y"?Sr.set("x"):tt==="x unified"?Sr.set("y unified"):tt==="y unified"&&Sr.set("x unified")}if(["orientation","type"].indexOf(Ke)!==-1){for(Yr=[],Wt=0;Wt<Xe.length;Wt++){var Et=mt[Xe[Wt]];r.traceIs(Et,"cartesian")&&(Qr(Et.xaxis||"x"),Qr(Et.yaxis||"y"))}Ut(Yr.map(at),!0,0),Ut(Yr.map(Jt),[0,1],0)}}return(qt.calc||qt.plot)&&(qt.fullReplot=!0),{flags:qt,undoit:fr,redoit:Yt,traces:Xe,eventData:M.extendDeepNoArrays([],[Nt,Xe])}}function ae(Ae){var Ne=M.counterRegex("axis",".title",!1,!1),Xe=/colorbar\.title$/,Je=Object.keys(Ae),_t,mt,Ot;for(_t=0;_t<Je.length;_t++)mt=Je[_t],Ot=Ae[mt],(mt==="title"||Ne.test(mt)||Xe.test(mt))&&(typeof Ot=="string"||typeof Ot=="number")?Kt(mt,mt.replace("title","title.text")):mt.indexOf("titlefont")>-1&&mt.indexOf("grouptitlefont")===-1?Kt(mt,mt.replace("titlefont","title.font")):mt.indexOf("titleposition")>-1?Kt(mt,mt.replace("titleposition","title.position")):mt.indexOf("titleside")>-1?Kt(mt,mt.replace("titleside","title.side")):mt.indexOf("titleoffset")>-1&&Kt(mt,mt.replace("titleoffset","title.offset"));function Kt(Nt,Wt){Ae[Wt]=Ae[Nt],delete Ae[Nt]}}function ie(Ae,Ne,Xe){Ae=M.getGraphDiv(Ae),_.clearPromiseQueue(Ae);var Je={};if(typeof Ne=="string")Je[Ne]=Xe;else if(M.isPlainObject(Ne))Je=M.extendFlat({},Ne);else return M.warn("Relayout fail.",Ne,Xe),Promise.reject();Object.keys(Je).length&&(Ae.changed=!0);var _t=Te(Ae,Je),mt=_t.flags;mt.calc&&(Ae.calcdata=void 0);var Ot=[c.previousPromises];mt.layoutReplot?Ot.push(s.layoutReplot):Object.keys(Je).length&&(le(Ae,mt,_t)||c.supplyDefaults(Ae),mt.legend&&Ot.push(s.doLegend),mt.layoutstyle&&Ot.push(s.layoutStyles),mt.axrange&&ye(Ot,_t.rangesAltered),mt.ticks&&Ot.push(s.doTicksRelayout),mt.modebar&&Ot.push(s.doModeBar),mt.camera&&Ot.push(s.doCamera),mt.colorbars&&Ot.push(s.doColorBars),Ot.push(L)),Ot.push(c.rehover,c.redrag,c.reselect),n.add(Ae,ie,[Ae,_t.undoit],ie,[Ae,_t.redoit]);var Kt=M.syncOrAsync(Ot,Ae);return(!Kt||!Kt.then)&&(Kt=Promise.resolve(Ae)),Kt.then(function(){return Ae.emit("plotly_relayout",_t.eventData),Ae})}function le(Ae,Ne,Xe){var Je=Ae._fullLayout;if(!Ne.axrange)return!1;for(var _t in Ne)if(_t!=="axrange"&&Ne[_t])return!1;for(var mt in Xe.rangesAltered){var Ot=o.id2name(mt),Kt=Ae.layout[Ot],Nt=Je[Ot];if(Nt.autorange=Kt.autorange,Kt.range&&(Nt.range=Kt.range.slice()),Nt.cleanRange(),Nt._matchGroup){for(var Wt in Nt._matchGroup)if(Wt!==mt){var qt=Je[o.id2name(Wt)];qt.autorange=Nt.autorange,qt.range=Nt.range.slice(),qt._input.range=Nt.range.slice()}}}return!0}function ye(Ae,Ne){var Xe=Ne?function(Je){var _t=[],mt=!0;for(var Ot in Ne){var Kt=o.getFromId(Je,Ot);if(_t.push(Ot),(Kt.ticklabelposition||"").indexOf("inside")!==-1&&Kt._anchorAxis&&_t.push(Kt._anchorAxis._id),Kt._matchGroup)for(var Nt in Kt._matchGroup)Ne[Nt]||_t.push(Nt);Kt.automargin&&(mt=!1)}return o.draw(Je,_t,{skipTitle:mt})}:function(Je){return o.draw(Je,"redraw")};Ae.push(h,s.doAutoRangeAndConstraints,Xe,s.drawData,s.finalDraw)}var ue=/^[xyz]axis[0-9]*\.range(\[[0|1]\])?$/,pe=/^[xyz]axis[0-9]*\.autorange$/,ge=/^[xyz]axis[0-9]*\.domain(\[[0|1]\])?$/;function Te(Ae,Ne){var Xe=Ae.layout,Je=Ae._fullLayout,_t=Je._guiEditing,mt=$(Je._preGUI,_t),Ot=Object.keys(Ne),Kt=o.list(Ae),Nt=M.extendDeepAll({},Ne),Wt={},qt,Yt,fr;for(ae(Ne),Ot=Object.keys(Ne),Yt=0;Yt<Ot.length;Yt++)if(Ot[Yt].indexOf("allaxes")===0){for(fr=0;fr<Kt.length;fr++){var Yr=Kt[fr]._id.substr(1),hn=Yr.indexOf("scene")!==-1?Yr+".":"",Qr=Ot[Yt].replace("allaxes",hn+Kt[fr]._name);Ne[Qr]||(Ne[Qr]=Ne[Ot[Yt]])}delete Ne[Ot[Yt]]}var at=A.layoutFlags(),Jt={},Zt={};function Ut(Ir,Tr){if(Array.isArray(Ir)){Ir.forEach(function(wn){Ut(wn,Tr)});return}if(!(Ir in Ne||_.hasParent(Ne,Ir))){var Wr=mt(Xe,Ir);Ir in Zt||(Zt[Ir]=q(Wr.get())),Tr!==void 0&&Wr.set(Tr)}}var _r={},rt;function Ke(Ir){var Tr=o.name2id(Ir.split(".")[0]);return _r[Tr]=1,Tr}for(var st in Ne){if(_.hasParent(Ne,st))throw new Error("cannot set "+st+" and a parent attribute simultaneously");for(var lt=mt(Xe,st),wt=Ne[st],Pt=lt.parts.length,ke=Pt-1;ke>0&&typeof lt.parts[ke]!="string";)ke--;var Se=lt.parts[ke],nt=lt.parts[ke-1]+"."+Se,it=lt.parts.slice(0,ke).join("."),ct=e(Ae.layout,it).get(),At=e(Je,it).get(),dt=lt.get();if(wt!==void 0){Jt[st]=wt,Zt[st]=Se==="reverse"?wt:q(dt);var Tt=t.getLayoutValObject(Je,lt.parts);if(Tt&&Tt.impliedEdits&&wt!==null)for(var Ht in Tt.impliedEdits)Ut(M.relativeAttr(st,Ht),Tt.impliedEdits[Ht]);if(["width","height"].indexOf(st)!==-1)if(wt){Ut("autosize",null);var ir=st==="height"?"width":"height";Ut(ir,Je[ir])}else Je[st]=Ae._initialAutoSize[st];else if(st==="autosize")Ut("width",wt?null:Je.width),Ut("height",wt?null:Je.height);else if(nt.match(ue))Ke(nt),e(Je,it+"._inputRange").set(null);else if(nt.match(pe)){Ke(nt),e(Je,it+"._inputRange").set(null);var kr=e(Je,it).get();kr._inputDomain&&(kr._input.domain=kr._inputDomain.slice())}else nt.match(ge)&&e(Je,it+"._inputDomain").set(null);if(Se==="type"){rt=ct;var br=At.type==="linear"&&wt==="log",Mr=At.type==="log"&&wt==="linear";if(br||Mr){if(!rt||!rt.range)Ut(it+".autorange",!0);else if(At.autorange)br&&(rt.range=rt.range[1]>rt.range[0]?[1,2]:[2,1]);else{var Hr=rt.range[0],nr=rt.range[1];br?(Hr<=0&&nr<=0&&Ut(it+".autorange",!0),Hr<=0?Hr=nr/1e6:nr<=0&&(nr=Hr/1e6),Ut(it+".range[0]",Math.log(Hr)/Math.LN10),Ut(it+".range[1]",Math.log(nr)/Math.LN10)):(Ut(it+".range[0]",Math.pow(10,Hr)),Ut(it+".range[1]",Math.pow(10,nr)))}Array.isArray(Je._subplots.polar)&&Je._subplots.polar.length&&Je[lt.parts[0]]&&lt.parts[1]==="radialaxis"&&delete Je[lt.parts[0]]._subplot.viewInitial["radialaxis.range"],r.getComponentMethod("annotations","convertCoords")(Ae,At,wt,Ut),r.getComponentMethod("images","convertCoords")(Ae,At,wt,Ut)}else Ut(it+".autorange",!0),Ut(it+".range",null);e(Je,it+"._inputRange").set(null)}else if(Se.match(b)){var mr=e(Je,st).get(),Pr=(wt||{}).type;(!Pr||Pr==="-")&&(Pr="linear"),r.getComponentMethod("annotations","convertCoords")(Ae,mr,Pr,Ut),r.getComponentMethod("images","convertCoords")(Ae,mr,Pr,Ut)}var Nr=u.containerArrayMatch(st);if(Nr){qt=Nr.array,Yt=Nr.index;var Sr=Nr.property,tt=Tt||{editType:"calc"};Yt!==""&&Sr===""&&(u.isAddVal(wt)?Zt[st]=null:u.isRemoveVal(wt)?Zt[st]=(e(Xe,qt).get()||[])[Yt]:M.warn("unrecognized full object value",Ne)),A.update(at,tt),Wt[qt]||(Wt[qt]={});var Et=Wt[qt][Yt];Et||(Et=Wt[qt][Yt]={}),Et[Sr]=wt,delete Ne[st]}else Se==="reverse"?(ct.range?ct.range.reverse():(Ut(it+".autorange",!0),ct.range=[1,0]),At.autorange?at.calc=!0:at.plot=!0):(st==="dragmode"&&(wt===!1&&dt!==!1||wt!==!1&&dt===!1)||Je._has("scatter-like")&&Je._has("regl")&&st==="dragmode"&&(wt==="lasso"||wt==="select")&&!(dt==="lasso"||dt==="select")||Je._has("gl2d")?at.plot=!0:Tt?A.update(at,Tt):at.calc=!0,lt.set(wt))}}for(qt in Wt){var Vt=u.applyContainerArrayChanges(Ae,mt(Xe,qt),Wt[qt],at,mt);Vt||(at.plot=!0)}for(var ar in _r){rt=o.getFromId(Ae,ar);var Cr=rt&&rt._constraintGroup;if(Cr){at.calc=!0;for(var Or in Cr)_r[Or]||(o.getFromId(Ae,Or)._constraintShrinkable=!0)}}return(_e(Ae)||Ne.height||Ne.width)&&(at.plot=!0),(at.plot||at.calc)&&(at.layoutReplot=!0),{flags:at,rangesAltered:_r,undoit:Zt,redoit:Jt,eventData:Nt}}function _e(Ae){var Ne=Ae._fullLayout,Xe=Ne.width,Je=Ne.height;return Ae.layout.autosize&&c.plotAutoSize(Ae,Ae.layout,Ne),Ne.width!==Xe||Ne.height!==Je}function ze(Ae,Ne,Xe,Je){Ae=M.getGraphDiv(Ae),_.clearPromiseQueue(Ae),M.isPlainObject(Ne)||(Ne={}),M.isPlainObject(Xe)||(Xe={}),Object.keys(Ne).length&&(Ae.changed=!0),Object.keys(Xe).length&&(Ae.changed=!0);var _t=_.coerceTraceIndices(Ae,Je),mt=ne(Ae,M.extendFlat({},Ne),_t),Ot=mt.flags,Kt=Te(Ae,M.extendFlat({},Xe)),Nt=Kt.flags;(Ot.calc||Nt.calc)&&(Ae.calcdata=void 0),Ot.clearAxisTypes&&_.clearAxisTypes(Ae,_t,Xe);var Wt=[];Nt.layoutReplot?Wt.push(s.layoutReplot):Ot.fullReplot?Wt.push(te._doPlot):(Wt.push(c.previousPromises),le(Ae,Nt,Kt)||c.supplyDefaults(Ae),Ot.style&&Wt.push(s.doTraceStyle),(Ot.colorbars||Nt.colorbars)&&Wt.push(s.doColorBars),Nt.legend&&Wt.push(s.doLegend),Nt.layoutstyle&&Wt.push(s.layoutStyles),Nt.axrange&&ye(Wt,Kt.rangesAltered),Nt.ticks&&Wt.push(s.doTicksRelayout),Nt.modebar&&Wt.push(s.doModeBar),Nt.camera&&Wt.push(s.doCamera),Wt.push(L)),Wt.push(c.rehover,c.redrag,c.reselect),n.add(Ae,ze,[Ae,mt.undoit,Kt.undoit,mt.traces],ze,[Ae,mt.redoit,Kt.redoit,mt.traces]);var qt=M.syncOrAsync(Wt,Ae);return(!qt||!qt.then)&&(qt=Promise.resolve(Ae)),qt.then(function(){return Ae.emit("plotly_update",{data:mt.eventData,layout:Kt.eventData}),Ae})}function Oe(Ae){return function(Xe){Xe._fullLayout._guiEditing=!0;var Je=Ae.apply(null,arguments);return Xe._fullLayout._guiEditing=!1,Je}}var Ye=[{pattern:/^hiddenlabels/,attr:"legend.uirevision"},{pattern:/^((x|y)axis\d*)\.((auto)?range|title\.text)/},{pattern:/axis\d*\.showspikes$/,attr:"modebar.uirevision"},{pattern:/(hover|drag)mode$/,attr:"modebar.uirevision"},{pattern:/^(scene\d*)\.camera/},{pattern:/^(geo\d*)\.(projection|center|fitbounds)/},{pattern:/^(ternary\d*\.[abc]axis)\.(min|title\.text)$/},{pattern:/^(polar\d*\.radialaxis)\.((auto)?range|angle|title\.text)/},{pattern:/^(polar\d*\.angularaxis)\.rotation/},{pattern:/^(mapbox\d*)\.(center|zoom|bearing|pitch)/},{pattern:/^legend\.(x|y)$/,attr:"editrevision"},{pattern:/^(shapes|annotations)/,attr:"editrevision"},{pattern:/^title\.text$/,attr:"editrevision"}],be=[{pattern:/^selectedpoints$/,attr:"selectionrevision"},{pattern:/(^|value\.)visible$/,attr:"legend.uirevision"},{pattern:/^dimensions\[\d+\]\.constraintrange/},{pattern:/^node\.(x|y|groups)/},{pattern:/^level$/},{pattern:/(^|value\.)name$/},{pattern:/colorbar\.title\.text$/},{pattern:/colorbar\.(x|y)$/,attr:"editrevision"}];function Pe(Ae,Ne){for(var Xe=0;Xe<Ne.length;Xe++){var Je=Ne[Xe],_t=Ae.match(Je.pattern);if(_t){var mt=_t[1]||"";return{head:mt,tail:Ae.substr(mt.length+1),attr:Je.attr}}}}function Ge(Ae,Ne){var Xe=e(Ne,Ae).get();if(Xe!==void 0)return Xe;var Je=Ae.split(".");for(Je.pop();Je.length>1;)if(Je.pop(),Xe=e(Ne,Je.join(".")+".uirevision").get(),Xe!==void 0)return Xe;return Ne.uirevision}function Qe(Ae,Ne){for(var Xe=0;Xe<Ne.length;Xe++)if(Ne[Xe]._fullInput.uid===Ae)return Xe;return-1}function Be(Ae,Ne,Xe){for(var Je=0;Je<Ne.length;Je++)if(Ne[Je].uid===Ae)return Je;return!Ne[Xe]||Ne[Xe].uid?-1:Xe}function Le(Ae,Ne){var Xe=M.isPlainObject(Ae),Je=Array.isArray(Ae);return Xe||Je?(Xe&&M.isPlainObject(Ne)||Je&&Array.isArray(Ne))&&JSON.stringify(Ae)===JSON.stringify(Ne):Ae===Ne}function He(Ae,Ne,Xe,Je){var _t=Je._preGUI,mt,Ot,Kt,Nt,Wt,qt,Yt,fr,Yr,hn,Qr=[],at={},Jt={};for(mt in _t){if(Wt=Pe(mt,Ye),Wt){if(Yr=Wt.head,hn=Wt.tail,Ot=Wt.attr||Yr+".uirevision",Kt=e(Je,Ot).get(),Nt=Kt&&Ge(Ot,Ne),Nt&&Nt===Kt){if(qt=_t[mt],qt===null&&(qt=void 0),Yt=e(Ne,mt),fr=Yt.get(),Le(fr,qt)){fr===void 0&&hn==="autorange"&&Qr.push(Yr),Yt.set(q(e(Je,mt).get()));continue}else if(hn==="autorange"||hn.substr(0,6)==="range["){var Zt=_t[Yr+".range[0]"],Ut=_t[Yr+".range[1]"],_r=_t[Yr+".autorange"];if(_r||_r===null&&Zt===null&&Ut===null){if(!(Yr in at)){var rt=e(Ne,Yr).get();at[Yr]=rt&&(rt.autorange||rt.autorange!==!1&&(!rt.range||rt.range.length!==2))}if(at[Yr]){Yt.set(q(e(Je,mt).get()));continue}}}}}else M.warn("unrecognized GUI edit: "+mt);delete _t[mt],Wt&&Wt.tail.substr(0,6)==="range["&&(Jt[Wt.head]=1)}for(var Ke=0;Ke<Qr.length;Ke++){var st=Qr[Ke];if(Jt[st]){var lt=e(Ne,st).get();lt&&delete lt.autorange}}var wt=Je._tracePreGUI;for(var Pt in wt){var ke=wt[Pt],Se=null,nt;for(mt in ke){if(!Se){var it=Qe(Pt,Xe);if(it<0){delete wt[Pt];break}var ct=Xe[it];nt=ct._fullInput;var At=Be(Pt,Ae,nt.index);if(At<0){delete wt[Pt];break}Se=Ae[At]}if(Wt=Pe(mt,be),Wt){if(Wt.attr?(Kt=e(Je,Wt.attr).get(),Nt=Kt&&Ge(Wt.attr,Ne)):(Kt=nt.uirevision,Nt=Se.uirevision,Nt===void 0&&(Nt=Ne.uirevision)),Nt&&Nt===Kt&&(qt=ke[mt],qt===null&&(qt=void 0),Yt=e(Se,mt),fr=Yt.get(),Le(fr,qt))){Yt.set(q(e(nt,mt).get()));continue}}else M.warn("unrecognized GUI edit: "+mt+" in trace uid "+Pt);delete ke[mt]}}}function vt(Ae,Ne,Xe,Je){var _t,mt;function Ot(){return te.addFrames(Ae,_t)}Ae=M.getGraphDiv(Ae),_.clearPromiseQueue(Ae);var Kt=Ae._fullData,Nt=Ae._fullLayout;if(!M.isPlotDiv(Ae)||!Kt||!Nt)mt=te.newPlot(Ae,Ne,Xe,Je);else{if(M.isPlainObject(Ne)){var Wt=Ne;Ne=Wt.data,Xe=Wt.layout,Je=Wt.config,_t=Wt.frames}var qt=!1;if(Je){var Yt=M.extendDeep({},Ae._context);Ae._context=void 0,z(Ae,Je),qt=Ft(Yt,Ae._context)}Ae.data=Ne||[],_.cleanData(Ae.data),Ae.layout=Xe||{},_.cleanLayout(Ae.layout),He(Ae.data,Ae.layout,Kt,Nt),c.supplyDefaults(Ae,{skipUpdateCalc:!0});var fr=Ae._fullData,Yr=Ae._fullLayout,hn=Yr.datarevision===void 0,Qr=Yr.transition,at=rr(Ae,Nt,Yr,hn,Qr),Jt=at.newDataRevision,Zt=Rt(Ae,Kt,fr,hn,Qr,Jt);if(_e(Ae)&&(at.layoutReplot=!0),Zt.calc||at.calc){Ae.calcdata=void 0;for(var Ut=Object.getOwnPropertyNames(Yr),_r=0;_r<Ut.length;_r++){var rt=Ut[_r],Ke=rt.substring(0,5);if(Ke==="xaxis"||Ke==="yaxis"){var st=Yr[rt]._emptyCategories;st&&st()}}}else c.supplyDefaultsUpdateCalc(Ae.calcdata,fr);var lt=[];if(_t&&(Ae._transitionData={},c.createTransitionData(Ae),lt.push(Ot)),Yr.transition&&!qt&&(Zt.anim||at.anim))at.ticks&&lt.push(s.doTicksRelayout),c.doCalcdata(Ae),s.doAutoRangeAndConstraints(Ae),lt.push(function(){return c.transitionFromReact(Ae,Zt,at,Nt)});else if(Zt.fullReplot||at.layoutReplot||qt)Ae._fullLayout._skipDefaults=!0,lt.push(te._doPlot);else{for(var wt in at.arrays){var Pt=at.arrays[wt];if(Pt.length){var ke=r.getComponentMethod(wt,"drawOne");if(ke!==M.noop)for(var Se=0;Se<Pt.length;Se++)ke(Ae,Pt[Se]);else{var nt=r.getComponentMethod(wt,"draw");if(nt===M.noop)throw new Error("cannot draw components: "+wt);nt(Ae)}}}lt.push(c.previousPromises),Zt.style&&lt.push(s.doTraceStyle),(Zt.colorbars||at.colorbars)&&lt.push(s.doColorBars),at.legend&&lt.push(s.doLegend),at.layoutstyle&&lt.push(s.layoutStyles),at.axrange&&ye(lt),at.ticks&&lt.push(s.doTicksRelayout),at.modebar&&lt.push(s.doModeBar),at.camera&&lt.push(s.doCamera),lt.push(L)}lt.push(c.rehover,c.redrag,c.reselect),mt=M.syncOrAsync(lt,Ae),(!mt||!mt.then)&&(mt=Promise.resolve(Ae))}return mt.then(function(){return Ae.emit("plotly_react",{data:Ne,layout:Xe}),Ae})}function Rt(Ae,Ne,Xe,Je,_t,mt){var Ot=Ne.length===Xe.length;if(!_t&&!Ot)return{fullReplot:!0,calc:!0};var Kt=A.traceFlags();Kt.arrays={},Kt.nChanges=0,Kt.nChangesAnim=0;var Nt,Wt;function qt(Yr){var hn=t.getTraceValObject(Wt,Yr);return!Wt._module.animatable&&hn.anim&&(hn.anim=!1),hn}var Yt={getValObject:qt,flags:Kt,immutable:Je,transition:_t,newDataRevision:mt,gd:Ae},fr={};for(Nt=0;Nt<Ne.length;Nt++)if(Xe[Nt]){if(Wt=Xe[Nt]._fullInput,c.hasMakesDataTransform(Wt)&&(Wt=Xe[Nt]),fr[Wt.uid])continue;fr[Wt.uid]=1,Lt(Ne[Nt]._fullInput,Wt,[],Yt)}return(Kt.calc||Kt.plot)&&(Kt.fullReplot=!0),_t&&Kt.nChanges&&Kt.nChangesAnim&&(Kt.anim=Kt.nChanges===Kt.nChangesAnim&&Ot?"all":"some"),Kt}function rr(Ae,Ne,Xe,Je,_t){var mt=A.layoutFlags();mt.arrays={},mt.rangesAltered={},mt.nChanges=0,mt.nChangesAnim=0;function Ot(Nt){return t.getLayoutValObject(Xe,Nt)}var Kt={getValObject:Ot,flags:mt,immutable:Je,transition:_t,gd:Ae};return Lt(Ne,Xe,[],Kt),(mt.plot||mt.calc)&&(mt.layoutReplot=!0),_t&&mt.nChanges&&mt.nChangesAnim&&(mt.anim=mt.nChanges===mt.nChangesAnim?"all":"some"),mt}function Lt(Ae,Ne,Xe,Je){var _t,mt,Ot,Kt=Je.getValObject,Nt=Je.flags,Wt=Je.immutable,qt=Je.inArray,Yt=Je.arrayIndex;function fr(){var it=_t.editType;if(qt&&it.indexOf("arraydraw")!==-1){M.pushUnique(Nt.arrays[qt],Yt);return}A.update(Nt,_t),it!=="none"&&Nt.nChanges++,Je.transition&&_t.anim&&Nt.nChangesAnim++,(ue.test(Ot)||pe.test(Ot))&&(Nt.rangesAltered[Xe[0]]=1),ge.test(Ot)&&e(Ne,"_inputDomain").set(null),mt==="datarevision"&&(Nt.newDataRevision=1)}function Yr(it){return it.valType==="data_array"||it.arrayOk}for(mt in Ae){if(Nt.calc&&!Je.transition)return;var hn=Ae[mt],Qr=Ne[mt],at=Xe.concat(mt);if(Ot=at.join("."),!(mt.charAt(0)==="_"||typeof hn=="function"||hn===Qr)){if((mt==="tick0"||mt==="dtick")&&Xe[0]!=="geo"){var Jt=Ne.tickmode;if(Jt==="auto"||Jt==="array"||!Jt)continue}if(!(mt==="range"&&Ne.autorange)&&!((mt==="zmin"||mt==="zmax")&&Ne.type==="contourcarpet")&&(_t=Kt(at),!!_t&&!(_t._compareAsJSON&&JSON.stringify(hn)===JSON.stringify(Qr)))){var Zt=_t.valType,Ut,_r=Yr(_t),rt=Array.isArray(hn),Ke=Array.isArray(Qr);if(rt&&Ke){var st="_input_"+mt,lt=Ae[st],wt=Ne[st];if(Array.isArray(lt)&&lt===wt)continue}if(Qr===void 0)_r&&rt?Nt.calc=!0:fr();else if(_t._isLinkedToArray){var Pt=[],ke=!1;qt||(Nt.arrays[mt]=Pt);var Se=Math.min(hn.length,Qr.length),nt=Math.max(hn.length,Qr.length);if(Se!==nt)if(_t.editType==="arraydraw")ke=!0;else{fr();continue}for(Ut=0;Ut<Se;Ut++)Lt(hn[Ut],Qr[Ut],at.concat(Ut),M.extendFlat({inArray:mt,arrayIndex:Ut},Je));if(ke)for(Ut=Se;Ut<nt;Ut++)Pt.push(Ut)}else!Zt&&M.isPlainObject(hn)?Lt(hn,Qr,at,Je):_r?rt&&Ke?(Wt&&(Nt.calc=!0),(Wt||Je.newDataRevision)&&fr()):rt!==Ke?Nt.calc=!0:fr():rt&&Ke?(hn.length!==Qr.length||String(hn)!==String(Qr))&&fr():fr()}}}for(mt in Ne)if(!(mt in Ae||mt.charAt(0)==="_"||typeof Ne[mt]=="function"))if(_t=Kt(Xe.concat(mt)),Yr(_t)&&Array.isArray(Ne[mt])){Nt.calc=!0;return}else fr()}function Ft(Ae,Ne){var Xe;for(Xe in Ae)if(Xe.charAt(0)!=="_"){var Je=Ae[Xe],_t=Ne[Xe];if(Je!==_t)if(M.isPlainObject(Je)&&M.isPlainObject(_t)){if(Ft(Je,_t))return!0}else if(Array.isArray(Je)&&Array.isArray(_t)){if(Je.length!==_t.length)return!0;for(var mt=0;mt<Je.length;mt++)if(Je[mt]!==_t[mt])if(M.isPlainObject(Je[mt])&&M.isPlainObject(_t[mt])){if(Ft(Je[mt],_t[mt]))return!0}else return!0}else return!0}}function Gt(Ae,Ne,Xe){if(Ae=M.getGraphDiv(Ae),!M.isPlotDiv(Ae))throw new Error("This element is not a Plotly plot: "+Ae+". It's likely that you've failed to create a plot before animating it. For more details, see https://plotly.com/javascript/animations/");var Je=Ae._transitionData;Je._frameQueue||(Je._frameQueue=[]),Xe=c.supplyAnimationDefaults(Xe);var _t=Xe.transition,mt=Xe.frame;Je._frameWaitingCnt===void 0&&(Je._frameWaitingCnt=0);function Ot(Wt){return Array.isArray(_t)?Wt>=_t.length?_t[0]:_t[Wt]:_t}function Kt(Wt){return Array.isArray(mt)?Wt>=mt.length?mt[0]:mt[Wt]:mt}function Nt(Wt,qt){var Yt=0;return function(){if(Wt&&++Yt===qt)return Wt()}}return new Promise(function(Wt,qt){function Yt(){if(Je._frameQueue.length!==0){for(;Je._frameQueue.length;){var Se=Je._frameQueue.pop();Se.onInterrupt&&Se.onInterrupt()}Ae.emit("plotly_animationinterrupted",[])}}function fr(Se){if(Se.length!==0){for(var nt=0;nt<Se.length;nt++){var it;Se[nt].type==="byname"?it=c.computeFrame(Ae,Se[nt].name):it=Se[nt].data;var ct=Kt(nt),At=Ot(nt);At.duration=Math.min(At.duration,ct.duration);var dt={frame:it,name:Se[nt].name,frameOpts:ct,transitionOpts:At};nt===Se.length-1&&(dt.onComplete=Nt(Wt,2),dt.onInterrupt=qt),Je._frameQueue.push(dt)}Xe.mode==="immediate"&&(Je._lastFrameAt=-1/0),Je._animationRaf||Qr()}}function Yr(){Ae.emit("plotly_animated"),window.cancelAnimationFrame(Je._animationRaf),Je._animationRaf=null}function hn(){Je._currentFrame&&Je._currentFrame.onComplete&&Je._currentFrame.onComplete();var Se=Je._currentFrame=Je._frameQueue.shift();if(Se){var nt=Se.name?Se.name.toString():null;Ae._fullLayout._currentFrame=nt,Je._lastFrameAt=Date.now(),Je._timeToNext=Se.frameOpts.duration,c.transition(Ae,Se.frame.data,Se.frame.layout,_.coerceTraceIndices(Ae,Se.frame.traces),Se.frameOpts,Se.transitionOpts).then(function(){Se.onComplete&&Se.onComplete()}),Ae.emit("plotly_animatingframe",{name:nt,frame:Se.frame,animation:{frame:Se.frameOpts,transition:Se.transitionOpts}})}else Yr()}function Qr(){Ae.emit("plotly_animating"),Je._lastFrameAt=-1/0,Je._timeToNext=0,Je._runningTransitions=0,Je._currentFrame=null;var Se=function(){Je._animationRaf=window.requestAnimationFrame(Se),Date.now()-Je._lastFrameAt>Je._timeToNext&&hn()};Se()}var at=0;function Jt(Se){return Array.isArray(_t)?at>=_t.length?Se.transitionOpts=_t[at]:Se.transitionOpts=_t[0]:Se.transitionOpts=_t,at++,Se}var Zt,Ut,_r=[],rt=Ne==null,Ke=Array.isArray(Ne),st=!rt&&!Ke&&M.isPlainObject(Ne);if(st)_r.push({type:"object",data:Jt(M.extendFlat({},Ne))});else if(rt||["string","number"].indexOf(typeof Ne)!==-1)for(Zt=0;Zt<Je._frames.length;Zt++)Ut=Je._frames[Zt],!!Ut&&(rt||String(Ut.group)===String(Ne))&&_r.push({type:"byname",name:String(Ut.name),data:Jt({name:Ut.name})});else if(Ke)for(Zt=0;Zt<Ne.length;Zt++){var lt=Ne[Zt];["number","string"].indexOf(typeof lt)!==-1?(lt=String(lt),_r.push({type:"byname",name:lt,data:Jt({name:lt})})):M.isPlainObject(lt)&&_r.push({type:"object",data:Jt(M.extendFlat({},lt))})}for(Zt=0;Zt<_r.length;Zt++)if(Ut=_r[Zt],Ut.type==="byname"&&!Je._frameHash[Ut.data.name]){M.warn('animate failure: frame not found: "'+Ut.data.name+'"'),qt();return}["next","immediate"].indexOf(Xe.mode)!==-1&&Yt(),Xe.direction==="reverse"&&_r.reverse();var wt=Ae._fullLayout._currentFrame;if(wt&&Xe.fromcurrent){var Pt=-1;for(Zt=0;Zt<_r.length;Zt++)if(Ut=_r[Zt],Ut.type==="byname"&&Ut.name===wt){Pt=Zt;break}if(Pt>0&&Pt<_r.length-1){var ke=[];for(Zt=0;Zt<_r.length;Zt++)Ut=_r[Zt],(_r[Zt].type!=="byname"||Zt>Pt)&&ke.push(Ut);_r=ke}}_r.length>0?fr(_r):(Ae.emit("plotly_animated"),Wt())})}function Dt(Ae,Ne,Xe){if(Ae=M.getGraphDiv(Ae),Ne==null)return Promise.resolve();if(!M.isPlotDiv(Ae))throw new Error("This element is not a Plotly plot: "+Ae+". It's likely that you've failed to create a plot before adding frames. For more details, see https://plotly.com/javascript/animations/");var Je,_t,mt,Ot,Kt=Ae._transitionData._frames,Nt=Ae._transitionData._frameHash;if(!Array.isArray(Ne))throw new Error("addFrames failure: frameList must be an Array of frame definitions"+Ne);var Wt=Kt.length+Ne.length*2,qt=[],Yt={};for(Je=Ne.length-1;Je>=0;Je--)if(!!M.isPlainObject(Ne[Je])){var fr=Ne[Je].name,Yr=(Nt[fr]||Yt[fr]||{}).name,hn=Ne[Je].name,Qr=Nt[Yr]||Yt[Yr];Yr&&hn&&typeof hn=="number"&&Qr&&f<x&&(f++,M.warn('addFrames: overwriting frame "'+(Nt[Yr]||Yt[Yr]).name+'" with a frame whose name of type "number" also equates to "'+Yr+'". This is valid but may potentially lead to unexpected behavior since all plotly.js frame names are stored internally as strings.'),f===x&&M.warn("addFrames: This API call has yielded too many of these warnings. For the rest of this call, further warnings about numeric frame names will be suppressed.")),Yt[fr]={name:fr},qt.push({frame:c.supplyFrameDefaults(Ne[Je]),index:Xe&&Xe[Je]!==void 0&&Xe[Je]!==null?Xe[Je]:Wt+Je})}qt.sort(function(st,lt){return st.index>lt.index?-1:st.index<lt.index?1:0});var at=[],Jt=[],Zt=Kt.length;for(Je=qt.length-1;Je>=0;Je--){if(_t=qt[Je].frame,typeof _t.name=="number"&&M.warn("Warning: addFrames accepts frames with numeric names, but the numbers areimplicitly cast to strings"),!_t.name)for(;Nt[_t.name="frame "+Ae._transitionData._counter++];);if(Nt[_t.name]){for(mt=0;mt<Kt.length&&(Kt[mt]||{}).name!==_t.name;mt++);at.push({type:"replace",index:mt,value:_t}),Jt.unshift({type:"replace",index:mt,value:Kt[mt]})}else Ot=Math.max(0,Math.min(qt[Je].index,Zt)),at.push({type:"insert",index:Ot,value:_t}),Jt.unshift({type:"delete",index:Ot}),Zt++}var Ut=c.modifyFrames,_r=c.modifyFrames,rt=[Ae,Jt],Ke=[Ae,at];return n&&n.add(Ae,Ut,rt,_r,Ke),c.modifyFrames(Ae,at)}function kt(Ae,Ne){if(Ae=M.getGraphDiv(Ae),!M.isPlotDiv(Ae))throw new Error("This element is not a Plotly plot: "+Ae);var Xe,Je,_t=Ae._transitionData._frames,mt=[],Ot=[];if(!Ne)for(Ne=[],Xe=0;Xe<_t.length;Xe++)Ne.push(Xe);for(Ne=Ne.slice(),Ne.sort(),Xe=Ne.length-1;Xe>=0;Xe--)Je=Ne[Xe],mt.push({type:"delete",index:Je}),Ot.unshift({type:"insert",index:Je,value:_t[Je]});var Kt=c.modifyFrames,Nt=c.modifyFrames,Wt=[Ae,Ot],qt=[Ae,mt];return n&&n.add(Ae,Kt,Wt,Nt,qt),c.modifyFrames(Ae,mt)}function Ue(Ae){Ae=M.getGraphDiv(Ae);var Ne=Ae._fullLayout||{},Xe=Ae._fullData||[];return c.cleanPlot([],{},Xe,Ne),c.purge(Ae),a.purge(Ae),Ne._container&&Ne._container.remove(),delete Ae._context,Ae}function qe(Ae){var Ne=Ae._fullLayout,Xe=Ae.getBoundingClientRect();if(!M.equalDomRects(Xe,Ne._lastBBox)){var Je=Ne._invTransform=M.inverseTransformMatrix(M.getFullTransformMatrix(Ae));Ne._invScaleX=Math.sqrt(Je[0][0]*Je[0][0]+Je[0][1]*Je[0][1]+Je[0][2]*Je[0][2]),Ne._invScaleY=Math.sqrt(Je[1][0]*Je[1][0]+Je[1][1]*Je[1][1]+Je[1][2]*Je[1][2]),Ne._lastBBox=Xe}}function Ve(Ae){var Ne=w.select(Ae),Xe=Ae._fullLayout;if(Xe._calcInverseTransform=qe,Xe._calcInverseTransform(Ae),Xe._container=Ne.selectAll(".plot-container").data([0]),Xe._container.enter().insert("div",":first-child").classed("plot-container",!0).classed("plotly",!0),Xe._paperdiv=Xe._container.selectAll(".svg-container").data([0]),Xe._paperdiv.enter().append("div").classed("user-select-none",!0).classed("svg-container",!0).style("position","relative"),Xe._glcontainer=Xe._paperdiv.selectAll(".gl-container").data([{}]),Xe._glcontainer.enter().append("div").classed("gl-container",!0),Xe._paperdiv.selectAll(".main-svg").remove(),Xe._paperdiv.select(".modebar-container").remove(),Xe._paper=Xe._paperdiv.insert("svg",":first-child").classed("main-svg",!0),Xe._toppaper=Xe._paperdiv.append("svg").classed("main-svg",!0),Xe._modebardiv=Xe._paperdiv.append("div"),delete Xe._modeBar,Xe._hoverpaper=Xe._paperdiv.append("svg").classed("main-svg",!0),!Xe._uid){var Je={};w.selectAll("defs").each(function(){this.id&&(Je[this.id.split("-")[1]]=1)}),Xe._uid=M.randstr(Je)}Xe._paperdiv.selectAll(".main-svg").attr(g.svgAttrs),Xe._defs=Xe._paper.append("defs").attr("id","defs-"+Xe._uid),Xe._clips=Xe._defs.append("g").classed("clips",!0),Xe._topdefs=Xe._toppaper.append("defs").attr("id","topdefs-"+Xe._uid),Xe._topclips=Xe._topdefs.append("g").classed("clips",!0),Xe._bgLayer=Xe._paper.append("g").classed("bglayer",!0),Xe._draggers=Xe._paper.append("g").classed("draglayer",!0);var _t=Xe._paper.append("g").classed("layer-below",!0);Xe._imageLowerLayer=_t.append("g").classed("imagelayer",!0),Xe._shapeLowerLayer=_t.append("g").classed("shapelayer",!0),Xe._cartesianlayer=Xe._paper.append("g").classed("cartesianlayer",!0),Xe._polarlayer=Xe._paper.append("g").classed("polarlayer",!0),Xe._smithlayer=Xe._paper.append("g").classed("smithlayer",!0),Xe._ternarylayer=Xe._paper.append("g").classed("ternarylayer",!0),Xe._geolayer=Xe._paper.append("g").classed("geolayer",!0),Xe._funnelarealayer=Xe._paper.append("g").classed("funnelarealayer",!0),Xe._pielayer=Xe._paper.append("g").classed("pielayer",!0),Xe._iciclelayer=Xe._paper.append("g").classed("iciclelayer",!0),Xe._treemaplayer=Xe._paper.append("g").classed("treemaplayer",!0),Xe._sunburstlayer=Xe._paper.append("g").classed("sunburstlayer",!0),Xe._indicatorlayer=Xe._toppaper.append("g").classed("indicatorlayer",!0),Xe._glimages=Xe._paper.append("g").classed("glimages",!0);var mt=Xe._toppaper.append("g").classed("layer-above",!0);Xe._imageUpperLayer=mt.append("g").classed("imagelayer",!0),Xe._shapeUpperLayer=mt.append("g").classed("shapelayer",!0),Xe._selectionLayer=Xe._toppaper.append("g").classed("selectionlayer",!0),Xe._infolayer=Xe._toppaper.append("g").classed("infolayer",!0),Xe._menulayer=Xe._toppaper.append("g").classed("menulayer",!0),Xe._zoomlayer=Xe._toppaper.append("g").classed("zoomlayer",!0),Xe._hoverlayer=Xe._hoverpaper.append("g").classed("hoverlayer",!0),Xe._modebardiv.classed("modebar-container",!0).style("position","absolute").style("top","0px").style("right","0px"),Ae.emit("plotly_framework")}te.animate=Gt,te.addFrames=Dt,te.deleteFrames=kt,te.addTraces=re,te.deleteTraces=se,te.extendTraces=Z,te.moveTraces=N,te.prependTraces=oe,te.newPlot=D,te._doPlot=l,te.purge=Ue,te.react=vt,te.redraw=I,te.relayout=ie,te.restyle=U,te.setPlotConfig=T,te.update=ze,te._guiRelayout=Oe(ie),te._guiRestyle=Oe(U),te._guiUpdate=Oe(ze),te._storeDirectGUIEdit=K},{"../components/color":367,"../components/drawing":389,"../components/selections":455,"../constants/xmlns_namespaces":492,"../lib":515,"../lib/events":504,"../lib/queue":531,"../plots/cartesian/axes":566,"../plots/cartesian/constants":573,"../plots/cartesian/graph_interact":576,"../plots/plots":628,"../registry":647,"./edit_types":548,"./helpers":549,"./manage_arrays":551,"./plot_config":553,"./plot_schema":554,"./subroutines":556,"@plotly/d3":58,"fast-isnumeric":190,"has-hover":228}],553:[function(d,ee,te){var w={staticPlot:{valType:"boolean",dflt:!1},typesetMath:{valType:"boolean",dflt:!0},plotlyServerURL:{valType:"string",dflt:""},editable:{valType:"boolean",dflt:!1},edits:{annotationPosition:{valType:"boolean",dflt:!1},annotationTail:{valType:"boolean",dflt:!1},annotationText:{valType:"boolean",dflt:!1},axisTitleText:{valType:"boolean",dflt:!1},colorbarPosition:{valType:"boolean",dflt:!1},colorbarTitleText:{valType:"boolean",dflt:!1},legendPosition:{valType:"boolean",dflt:!1},legendText:{valType:"boolean",dflt:!1},shapePosition:{valType:"boolean",dflt:!1},titleText:{valType:"boolean",dflt:!1}},autosizable:{valType:"boolean",dflt:!1},responsive:{valType:"boolean",dflt:!1},fillFrame:{valType:"boolean",dflt:!1},frameMargins:{valType:"number",dflt:0,min:0,max:.5},scrollZoom:{valType:"flaglist",flags:["cartesian","gl3d","geo","mapbox"],extras:[!0,!1],dflt:"gl3d+geo+mapbox"},doubleClick:{valType:"enumerated",values:[!1,"reset","autosize","reset+autosize"],dflt:"reset+autosize"},doubleClickDelay:{valType:"number",dflt:300,min:0},showAxisDragHandles:{valType:"boolean",dflt:!0},showAxisRangeEntryBoxes:{valType:"boolean",dflt:!0},showTips:{valType:"boolean",dflt:!0},showLink:{valType:"boolean",dflt:!1},linkText:{valType:"string",dflt:"Edit chart",noBlank:!0},sendData:{valType:"boolean",dflt:!0},showSources:{valType:"any",dflt:!1},displayModeBar:{valType:"enumerated",values:["hover",!0,!1],dflt:"hover"},showSendToCloud:{valType:"boolean",dflt:!1},showEditInChartStudio:{valType:"boolean",dflt:!1},modeBarButtonsToRemove:{valType:"any",dflt:[]},modeBarButtonsToAdd:{valType:"any",dflt:[]},modeBarButtons:{valType:"any",dflt:!1},toImageButtonOptions:{valType:"any",dflt:{}},displaylogo:{valType:"boolean",dflt:!0},watermark:{valType:"boolean",dflt:!1},plotGlPixelRatio:{valType:"number",dflt:2,min:1,max:4},setBackground:{valType:"any",dflt:"transparent"},topojsonURL:{valType:"string",noBlank:!0,dflt:"https://cdn.plot.ly/"},mapboxAccessToken:{valType:"string",dflt:null},logging:{valType:"integer",min:0,max:2,dflt:1},notifyOnLogging:{valType:"integer",min:0,max:2,dflt:0},queueLength:{valType:"integer",min:0,dflt:0},globalTransforms:{valType:"any",dflt:[]},locale:{valType:"string",dflt:"en-US"},locales:{valType:"any",dflt:{}}},v={};function S(M,e){for(var a in M){var n=M[a];n.valType?e[a]=n.dflt:(e[a]||(e[a]={}),S(n,e[a]))}}S(w,v),ee.exports={configAttributes:w,dfltConfig:v}},{}],554:[function(d,ee,te){var w=d("../registry"),v=d("../lib"),S=d("../plots/attributes"),M=d("../plots/layout_attributes"),e=d("../plots/frame_attributes"),a=d("../plots/animation_attributes"),n=d("./plot_config").configAttributes,r=d("./edit_types"),t=v.extendDeepAll,c=v.isPlainObject,o=v.isArrayOrTypedArray,i=v.nestedProperty,y=v.valObjectMeta,p="_isSubplotObj",g="_isLinkedToArray",h="_arrayAttrRegexps",m="_deprecated",u=[p,g,h,m];te.IS_SUBPLOT_OBJ=p,te.IS_LINKED_TO_ARRAY=g,te.DEPRECATED=m,te.UNDERSCORE_ATTRS=u,te.get=function(){var D={};w.allTypes.forEach(function(B){D[B]=b(B)});var R={};return Object.keys(w.transformsRegistry).forEach(function(B){R[B]=x(B)}),{defs:{valObjects:y,metaKeys:u.concat(["description","role","editType","impliedEdits"]),editType:{traces:r.traces,layout:r.layout},impliedEdits:{}},traces:D,layout:f(),transforms:R,frames:l(),animation:L(a),config:L(n)}},te.crawl=function(D,R,B,F){var H=B||0;F=F||"",Object.keys(D).forEach(function(G){var J=D[G];if(u.indexOf(G)===-1){var X=(F?F+".":"")+G;R(J,G,D,H,X),!te.isValObject(J)&&c(J)&&G!=="impliedEdits"&&te.crawl(J,R,H+1,X)}})},te.isValObject=function(D){return D&&D.valType!==void 0},te.findArrayAttributes=function(D){var R=[],B=[],F=[],H,G;function J(se,N,U,q){B=B.slice(0,q).concat([N]),F=F.slice(0,q).concat([se&&se._isLinkedToArray]);var $=se&&(se.valType==="data_array"||se.arrayOk===!0)&&!(B[q-1]==="colorbar"&&(N==="ticktext"||N==="tickvals"));!$||X(H,0,"")}function X(se,N,U){var q=se[B[N]],$=U+B[N];if(N===B.length-1)o(q)&&R.push(G+$);else if(F[N]){if(Array.isArray(q))for(var W=0;W<q.length;W++)c(q[W])&&X(q[W],N+1,$+"["+W+"].")}else c(q)&&X(q,N+1,$+".")}H=D,G="",te.crawl(S,J),D._module&&D._module.attributes&&te.crawl(D._module.attributes,J);var Y=D.transforms;if(Y)for(var Z=0;Z<Y.length;Z++){var oe=Y[Z],re=oe._module;re&&(G="transforms["+Z+"].",H=oe,te.crawl(re.attributes,J))}return R},te.getTraceValObject=function(D,R){var B=R[0],F=1,H,G;if(B==="transforms"){if(R.length===1)return S.transforms;var J=D.transforms;if(!Array.isArray(J)||!J.length)return!1;var X=R[1];if(!A(X)||X>=J.length)return!1;H=(w.transformsRegistry[J[X].type]||{}).attributes,G=H&&H[R[2]],F=3}else{var Y=D._module;if(Y||(Y=(w.modules[D.type||S.type.dflt]||{})._module),!Y)return!1;if(H=Y.attributes,G=H&&H[B],!G){var Z=Y.basePlotModule;Z&&Z.attributes&&(G=Z.attributes[B])}G||(G=S[B])}return s(G,R,F)},te.getLayoutValObject=function(D,R){var B=_(D,R[0]);return s(B,R,1)};function _(D,R){var B,F,H,G,J=D._basePlotModules;if(J){var X;for(B=0;B<J.length;B++){if(H=J[B],H.attrRegex&&H.attrRegex.test(R)){if(H.layoutAttrOverrides)return H.layoutAttrOverrides;!X&&H.layoutAttributes&&(X=H.layoutAttributes)}var Y=H.baseLayoutAttrOverrides;if(Y&&R in Y)return Y[R]}if(X)return X}var Z=D._modules;if(Z){for(B=0;B<Z.length;B++)if(G=Z[B].layoutAttributes,G&&R in G)return G[R]}for(F in w.componentsRegistry){if(H=w.componentsRegistry[F],H.name==="colorscale"&&R.indexOf("coloraxis")===0)return H.layoutAttributes[R];if(!H.schema&&R===H.name)return H.layoutAttributes}return R in M?M[R]:!1}function s(D,R,B){if(!D)return!1;if(D._isLinkedToArray){if(A(R[B]))B++;else if(B<R.length)return!1}for(;B<R.length;B++){var F=D[R[B]];if(c(F))D=F;else break;if(B===R.length-1)break;if(D._isLinkedToArray){if(B++,!A(R[B]))return!1}else if(D.valType==="info_array"){B++;var H=R[B];if(!A(H))return!1;var G=D.items;if(Array.isArray(G)){if(H>=G.length)return!1;if(D.dimensions===2){if(B++,R.length===B)return D;var J=R[B];if(!A(J))return!1;D=G[H][J]}else D=G[H]}else D=G}}return D}function A(D){return D===Math.round(D)&&D>=0}function b(D){var R,B;R=w.modules[D]._module,B=R.basePlotModule;var F={};F.type=null;var H=t({},S),G=t({},R.attributes);te.crawl(G,function(Y,Z,oe,re,se){i(H,se).set(void 0),Y===void 0&&i(G,se).set(void 0)}),t(F,H),w.traceIs(D,"noOpacity")&&delete F.opacity,w.traceIs(D,"showLegend")||(delete F.showlegend,delete F.legendgroup),w.traceIs(D,"noHover")&&(delete F.hoverinfo,delete F.hoverlabel),R.selectPoints||delete F.selectedpoints,t(F,G),B.attributes&&t(F,B.attributes),F.type=D;var J={meta:R.meta||{},categories:R.categories||{},animatable:Boolean(R.animatable),type:D,attributes:L(F)};if(R.layoutAttributes){var X={};t(X,R.layoutAttributes),J.layoutAttributes=L(X)}return R.animatable||te.crawl(J,function(Y){te.isValObject(Y)&&"anim"in Y&&delete Y.anim}),J}function f(){var D={},R,B;t(D,M);for(R in w.subplotsRegistry)if(B=w.subplotsRegistry[R],!!B.layoutAttributes)if(Array.isArray(B.attr))for(var F=0;F<B.attr.length;F++)z(D,B,B.attr[F]);else{var H=B.attr==="subplot"?B.name:B.attr;z(D,B,H)}for(R in w.componentsRegistry){B=w.componentsRegistry[R];var G=B.schema;if(G&&(G.subplots||G.layout)){var J=G.subplots;if(J&&J.xaxis&&!J.yaxis)for(var X in J.xaxis)delete D.yaxis[X]}else B.name==="colorscale"?t(D,B.layoutAttributes):B.layoutAttributes&&I(D,B.layoutAttributes,B.name)}return{layoutAttributes:L(D)}}function x(D){var R=w.transformsRegistry[D],B=t({},R.attributes);return Object.keys(w.componentsRegistry).forEach(function(F){var H=w.componentsRegistry[F];H.schema&&H.schema.transforms&&H.schema.transforms[D]&&Object.keys(H.schema.transforms[D]).forEach(function(G){I(B,H.schema.transforms[D][G],G)})}),{attributes:L(B)}}function l(){var D={frames:t({},e)};return L(D),D.frames}function L(D){return T(D),k(D),P(D),D}function T(D){function R(F){return{valType:"string",editType:"none"}}function B(F,H,G){te.isValObject(F)?(F.arrayOk===!0||F.valType==="data_array")&&(G[H+"src"]=R()):c(F)&&(F.role="object")}te.crawl(D,B)}function k(D){function R(B,F,H){if(!!B){var G=B[g];!G||(delete B[g],H[F]={items:{}},H[F].items[G]=B,H[F].role="object")}}te.crawl(D,R)}function P(D){function R(B){for(var F in B)if(c(B[F]))R(B[F]);else if(Array.isArray(B[F]))for(var H=0;H<B[F].length;H++)R(B[F][H]);else B[F]instanceof RegExp&&(B[F]=B[F].toString())}R(D)}function z(D,R,B){var F=i(D,B),H=t({},R.layoutAttributes);H[p]=!0,F.set(H)}function I(D,R,B){var F=i(D,B);F.set(t(F.get()||{},R))}},{"../lib":515,"../plots/animation_attributes":560,"../plots/attributes":562,"../plots/frame_attributes":595,"../plots/layout_attributes":619,"../registry":647,"./edit_types":548,"./plot_config":553}],555:[function(d,ee,te){var w=d("../lib"),v=d("../plots/attributes"),S="templateitemname",M={name:{valType:"string",editType:"none"}};M[S]={valType:"string",editType:"calc"},te.templatedArray=function(n,r){return r._isLinkedToArray=n,r.name=M.name,r[S]=M[S],r},te.traceTemplater=function(n){var r={},t,c;for(t in n)c=n[t],Array.isArray(c)&&c.length&&(r[t]=0);function o(i){t=w.coerce(i,{},v,"type");var y={type:t,_template:null};if(t in r){c=n[t];var p=r[t]%c.length;r[t]++,y._template=c[p]}return y}return{newTrace:o}},te.newContainer=function(n,r,t){var c=n._template,o=c&&(c[r]||t&&c[t]);w.isPlainObject(o)||(o=null);var i=n[r]={_template:o};return i},te.arrayTemplater=function(n,r,t){var c=n._template,o=c&&c[a(r)],i=c&&c[r];(!Array.isArray(i)||!i.length)&&(i=[]);var y={};function p(h){var m={name:h.name,_input:h},u=m[S]=h[S];if(!e(u))return m._template=o,m;for(var _=0;_<i.length;_++){var s=i[_];if(s.name===u)return y[u]=1,m._template=s,m}return m[t]=h[t]||!1,m._template=!1,m}function g(){for(var h=[],m=0;m<i.length;m++){var u=i[m],_=u.name;if(e(_)&&!y[_]){var s={_template:u,name:_,_input:{_templateitemname:_}};s[S]=u[S],h.push(s),y[_]=1}}return h}return{newItem:p,defaultItems:g}};function e(n){return n&&typeof n=="string"}function a(n){var r=n.length-1;return n.charAt(r)!=="s"&&w.warn("bad argument to arrayDefaultKey: "+n),n.substr(0,n.length-1)+"defaults"}te.arrayDefaultKey=a,te.arrayEditor=function(n,r,t){var c=(w.nestedProperty(n,r).get()||[]).length,o=t._index,i=o>=c&&(t._input||{})._templateitemname;i&&(o=c);var y=r+"["+o+"]",p;function g(){p={},i&&(p[y]={},p[y][S]=i)}g();function h(s,A){p[s]=A}function m(s,A){i?w.nestedProperty(p[y],s).set(A):p[y+"."+s]=A}function u(){var s=p;return g(),s}function _(s,A){s&&m(s,A);var b=u();for(var f in b)w.nestedProperty(n,f).set(b[f])}return{modifyBase:h,modifyItem:m,getUpdateObj:u,applyUpdate:_}}},{"../lib":515,"../plots/attributes":562}],556:[function(d,ee,te){var w=d("@plotly/d3"),v=d("../registry"),S=d("../plots/plots"),M=d("../lib"),e=d("../lib/clear_gl_canvases"),a=d("../components/color"),n=d("../components/drawing"),r=d("../components/titles"),t=d("../components/modebar"),c=d("../plots/cartesian/axes"),o=d("../constants/alignment"),i=d("../plots/cartesian/constraints"),y=i.enforce,p=i.clean,g=d("../plots/cartesian/autorange").doAutoRange,h="start",m="middle",u="end";te.layoutStyles=function(k){return M.syncOrAsync([S.doAutoMargin,s],k)};function _(k,P,z){for(var I=0;I<z.length;I++){var D=z[I][0],R=z[I][1];if(!(D[0]>=k[1]||D[1]<=k[0])&&R[0]<P[1]&&R[1]>P[0])return!0}return!1}function s(k){var P=k._fullLayout,z=P._size,I=z.p,D=c.list(k,"",!0),R,B,F,H,G,J;if(P._paperdiv.style({width:k._context.responsive&&P.autosize&&!k._context._hasZeroWidth&&!k.layout.width?"100%":P.width+"px",height:k._context.responsive&&P.autosize&&!k._context._hasZeroHeight&&!k.layout.height?"100%":P.height+"px"}).selectAll(".main-svg").call(n.setSize,P.width,P.height),k._context.setBackground(k,P.paper_bgcolor),te.drawMainTitle(k),t.manage(k),!P._has("cartesian"))return S.previousPromises(k);function X(Ft,Gt,Dt){var kt=Ft._lw/2;if(Ft._id.charAt(0)==="x"){if(Gt){if(Dt==="top")return Gt._offset-I-kt}else return z.t+z.h*(1-(Ft.position||0))+kt%1;return Gt._offset+Gt._length+I+kt}if(Gt){if(Dt==="right")return Gt._offset+Gt._length+I+kt}else return z.l+z.w*(Ft.position||0)+kt%1;return Gt._offset-I-kt}for(R=0;R<D.length;R++){H=D[R];var Y=H._anchorAxis;H._linepositions={},H._lw=n.crispRound(k,H.linewidth,1),H._mainLinePosition=X(H,Y,H.side),H._mainMirrorPosition=H.mirror&&Y?X(H,Y,o.OPPOSITE_SIDE[H.side]):null}var Z=[],oe=[],re=[],se=a.opacity(P.paper_bgcolor)===1&&a.opacity(P.plot_bgcolor)===1&&P.paper_bgcolor===P.plot_bgcolor;for(B in P._plots)if(F=P._plots[B],F.mainplot)F.bg&&F.bg.remove(),F.bg=void 0;else{var N=F.xaxis.domain,U=F.yaxis.domain,q=F.plotgroup;if(_(N,U,re)){var $=q.node(),W=F.bg=M.ensureSingle(q,"rect","bg");$.insertBefore(W.node(),$.childNodes[0]),oe.push(B)}else q.select("rect.bg").remove(),re.push([N,U]),se||(Z.push(B),oe.push(B))}var K=P._bgLayer.selectAll(".bg").data(Z);for(K.enter().append("rect").classed("bg",!0),K.exit().remove(),K.each(function(Ft){P._plots[Ft].bg=w.select(this)}),R=0;R<oe.length;R++)F=P._plots[oe[R]],G=F.xaxis,J=F.yaxis,F.bg&&G._offset!==void 0&&J._offset!==void 0&&F.bg.call(n.setRect,G._offset-I,J._offset-I,G._length+2*I,J._length+2*I).call(a.fill,P.plot_bgcolor).style("stroke-width",0);if(!P._hasOnlyLargeSploms)for(B in P._plots){F=P._plots[B],G=F.xaxis,J=F.yaxis;var ne=F.clipId="clip"+P._uid+B+"plot",ae=M.ensureSingleById(P._clips,"clipPath",ne,function(Ft){Ft.classed("plotclip",!0).append("rect")});F.clipRect=ae.select("rect").attr({width:G._length,height:J._length}),n.setTranslate(F.plot,G._offset,J._offset);var ie,le;F._hasClipOnAxisFalse?(ie=null,le=ne):(ie=ne,le=null),n.setClipUrl(F.plot,ie,k),F.layerClipId=le}var ye,ue,pe,ge,Te,_e,ze,Oe,Ye,be,Pe,Ge,Qe;function Be(Ft){return"M"+ye+","+Ft+"H"+ue}function Le(Ft){return"M"+G._offset+","+Ft+"h"+G._length}function He(Ft){return"M"+Ft+","+Oe+"V"+ze}function vt(Ft){return"M"+Ft+","+J._offset+"v"+J._length}function Rt(Ft,Gt,Dt){if(!Ft.showline||B!==Ft._mainSubplot)return"";if(!Ft._anchorAxis)return Dt(Ft._mainLinePosition);var kt=Gt(Ft._mainLinePosition);return Ft.mirror&&(kt+=Gt(Ft._mainMirrorPosition)),kt}for(B in P._plots){F=P._plots[B],G=F.xaxis,J=F.yaxis;var rr="M0,0";A(G,B)&&(Te=f(G,"left",J,D),ye=G._offset-(Te?I+Te:0),_e=f(G,"right",J,D),ue=G._offset+G._length+(_e?I+_e:0),pe=X(G,J,"bottom"),ge=X(G,J,"top"),Qe=!G._anchorAxis||B!==G._mainSubplot,Qe&&(G.mirror==="allticks"||G.mirror==="all")&&(G._linepositions[B]=[pe,ge]),rr=Rt(G,Be,Le),Qe&&G.showline&&(G.mirror==="all"||G.mirror==="allticks")&&(rr+=Be(pe)+Be(ge)),F.xlines.style("stroke-width",G._lw+"px").call(a.stroke,G.showline?G.linecolor:"rgba(0,0,0,0)")),F.xlines.attr("d",rr);var Lt="M0,0";A(J,B)&&(Pe=f(J,"bottom",G,D),ze=J._offset+J._length+(Pe?I:0),Ge=f(J,"top",G,D),Oe=J._offset-(Ge?I:0),Ye=X(J,G,"left"),be=X(J,G,"right"),Qe=!J._anchorAxis||B!==J._mainSubplot,Qe&&(J.mirror==="allticks"||J.mirror==="all")&&(J._linepositions[B]=[Ye,be]),Lt=Rt(J,He,vt),Qe&&J.showline&&(J.mirror==="all"||J.mirror==="allticks")&&(Lt+=He(Ye)+He(be)),F.ylines.style("stroke-width",J._lw+"px").call(a.stroke,J.showline?J.linecolor:"rgba(0,0,0,0)")),F.ylines.attr("d",Lt)}return c.makeClipPaths(k),S.previousPromises(k)}function A(k,P){return(k.ticks||k.showline)&&(P===k._mainSubplot||k.mirror==="all"||k.mirror==="allticks")}function b(k,P,z){if(!z.showline||!z._lw)return!1;if(z.mirror==="all"||z.mirror==="allticks")return!0;var I=z._anchorAxis;if(!I)return!1;var D=o.FROM_BL[P];return z.side===P?I.domain[D]===k.domain[D]:z.mirror&&I.domain[1-D]===k.domain[1-D]}function f(k,P,z,I){if(b(k,P,z))return z._lw;for(var D=0;D<I.length;D++){var R=I[D];if(R._mainAxis===z._mainAxis&&b(k,P,R))return R._lw}return 0}te.drawMainTitle=function(k){var P=k._fullLayout,z=L(P),I=T(P);r.draw(k,"gtitle",{propContainer:P,propName:"title.text",placeholder:P._dfltTitle.plot,attributes:{x:x(P,z),y:l(P,I),"text-anchor":z,dy:I}})};function x(k,P){var z=k.title,I=k._size,D=0;switch(P===h?D=z.pad.l:P===u&&(D=-z.pad.r),z.xref){case"paper":return I.l+I.w*z.x+D;case"container":default:return k.width*z.x+D}}function l(k,P){var z=k.title,I=k._size,D=0;if(P==="0em"||!P?D=-z.pad.b:P===o.CAP_SHIFT+"em"&&(D=z.pad.t),z.y==="auto")return I.t/2;switch(z.yref){case"paper":return I.t+I.h-I.h*z.y+D;case"container":default:return k.height-k.height*z.y+D}}function L(k){var P=k.title,z=m;return M.isRightAnchor(P)?z=u:M.isLeftAnchor(P)&&(z=h),z}function T(k){var P=k.title,z="0em";return M.isTopAnchor(P)?z=o.CAP_SHIFT+"em":M.isMiddleAnchor(P)&&(z=o.MID_SHIFT+"em"),z}te.doTraceStyle=function(k){var P=k.calcdata,z=[],I;for(I=0;I<P.length;I++){var D=P[I],R=D[0]||{},B=R.trace||{},F=B._module||{},H=F.arraysToCalcdata;H&&H(D,B);var G=F.editStyle;G&&z.push({fn:G,cd0:R})}if(z.length){for(I=0;I<z.length;I++){var J=z[I];J.fn(k,J.cd0)}e(k),te.redrawReglTraces(k)}return S.style(k),v.getComponentMethod("legend","draw")(k),S.previousPromises(k)},te.doColorBars=function(k){return v.getComponentMethod("colorbar","draw")(k),S.previousPromises(k)},te.layoutReplot=function(k){var P=k.layout;return k.layout=void 0,v.call("_doPlot",k,"",P)},te.doLegend=function(k){return v.getComponentMethod("legend","draw")(k),S.previousPromises(k)},te.doTicksRelayout=function(k){return c.draw(k,"redraw"),k._fullLayout._hasOnlyLargeSploms&&(v.subplotsRegistry.splom.updateGrid(k),e(k),te.redrawReglTraces(k)),te.drawMainTitle(k),S.previousPromises(k)},te.doModeBar=function(k){var P=k._fullLayout;t.manage(k);for(var z=0;z<P._basePlotModules.length;z++){var I=P._basePlotModules[z].updateFx;I&&I(k)}return S.previousPromises(k)},te.doCamera=function(k){for(var P=k._fullLayout,z=P._subplots.gl3d,I=0;I<z.length;I++){var D=P[z[I]],R=D._scene;R.setViewport(D)}},te.drawData=function(k){var P=k._fullLayout;e(k);for(var z=P._basePlotModules,I=0;I<z.length;I++)z[I].plot(k);return te.redrawReglTraces(k),S.style(k),v.getComponentMethod("selections","draw")(k),v.getComponentMethod("shapes","draw")(k),v.getComponentMethod("annotations","draw")(k),v.getComponentMethod("images","draw")(k),P._replotting=!1,S.previousPromises(k)},te.redrawReglTraces=function(k){var P=k._fullLayout;if(P._has("regl")){var z=k._fullData,I=[],D=[],R,B;for(P._hasOnlyLargeSploms&&P._splomGrid.draw(),R=0;R<z.length;R++){var F=z[R];F.visible===!0&&F._length!==0&&(F.type==="splom"?P._splomScenes[F.uid].draw():F.type==="scattergl"?M.pushUnique(I,F.xaxis+F.yaxis):F.type==="scatterpolargl"&&M.pushUnique(D,F.subplot))}for(R=0;R<I.length;R++)B=P._plots[I[R]],B._scene&&B._scene.draw();for(R=0;R<D.length;R++)B=P[D[R]]._subplot,B._scene&&B._scene.draw()}},te.doAutoRangeAndConstraints=function(k){for(var P=c.list(k,"",!0),z,I={},D=0;D<P.length;D++)if(z=P[D],!I[z._id]){I[z._id]=1,p(k,z),g(k,z);var R=z._matchGroup;if(R)for(var B in R){var F=c.getFromId(k,B);g(k,F,z.range),I[B]=1}}y(k)},te.finalDraw=function(k){v.getComponentMethod("rangeslider","draw")(k),v.getComponentMethod("rangeselector","draw")(k)},te.drawMarginPushers=function(k){v.getComponentMethod("legend","draw")(k),v.getComponentMethod("rangeselector","draw")(k),v.getComponentMethod("sliders","draw")(k),v.getComponentMethod("updatemenus","draw")(k),v.getComponentMethod("colorbar","draw")(k)}},{"../components/color":367,"../components/drawing":389,"../components/modebar":430,"../components/titles":476,"../constants/alignment":483,"../lib":515,"../lib/clear_gl_canvases":499,"../plots/cartesian/autorange":565,"../plots/cartesian/axes":566,"../plots/cartesian/constraints":574,"../plots/plots":628,"../registry":647,"@plotly/d3":58}],557:[function(d,ee,te){var w=d("../lib"),v=w.isPlainObject,S=d("./plot_schema"),M=d("../plots/plots"),e=d("../plots/attributes"),a=d("./plot_template"),n=d("./plot_config").dfltConfig;te.makeTemplate=function(h){h=w.isPlainObject(h)?h:w.getGraphDiv(h),h=w.extendDeep({_context:n},{data:h.data,layout:h.layout}),M.supplyDefaults(h);var m=h.data||[],u=h.layout||{};u._basePlotModules=h._fullLayout._basePlotModules,u._modules=h._fullLayout._modules;var _={data:{},layout:{}};m.forEach(function(P){var z={};c(P,z,i.bind(null,P));var I=w.coerce(P,{},e,"type"),D=_.data[I];D||(D=_.data[I]=[]),D.push(z)}),c(u,_.layout,o.bind(null,u)),delete _.layout.template;var s=u.template;if(v(s)){var A=s.layout,b,f,x,l,L,T;v(A)&&r(A,_.layout);var k=s.data;if(v(k)){for(f in _.data)if(x=k[f],Array.isArray(x)){for(L=_.data[f],T=L.length,l=x.length,b=0;b<T;b++)r(x[b%l],L[b]);for(b=T;b<l;b++)L.push(w.extendDeep({},x[b]))}for(f in k)f in _.data||(_.data[f]=w.extendDeep([],k[f]))}}return _};function r(h,m){h=w.extendDeep({},h);var u=Object.keys(h).sort(),_,s;function A(L,T,k){if(v(T)&&v(L))r(L,T);else if(Array.isArray(T)&&Array.isArray(L)){var P=a.arrayTemplater({_template:h},k);for(s=0;s<T.length;s++){var z=T[s],I=P.newItem(z)._template;I&&r(I,z)}var D=P.defaultItems();for(s=0;s<D.length;s++)T.push(D[s]._template);for(s=0;s<T.length;s++)delete T[s].templateitemname}}for(_=0;_<u.length;_++){var b=u[_],f=h[b];if(b in m?A(f,m[b],b):m[b]=f,t(b)===b)for(var x in m){var l=t(x);x!==l&&l===b&&!(x in h)&&A(f,m[x],b)}}}function t(h){return h.replace(/[0-9]+$/,"")}function c(h,m,u,_,s){var A=s&&u(s);for(var b in h){var f=h[b],x=y(h,b,_),l=y(h,b,s),L=u(l);if(!L){var T=t(b);T!==b&&(l=y(h,T,s),L=u(l))}if(!(A&&A===L)&&!(!L||L._noTemplating||L.valType==="data_array"||L.arrayOk&&Array.isArray(f)))if(!L.valType&&v(f))c(f,m,u,x,l);else if(L._isLinkedToArray&&Array.isArray(f))for(var k=!1,P=0,z={},I=0;I<f.length;I++){var D=f[I];if(v(D)){var R=D.name;if(R)z[R]||(c(D,m,u,y(f,P,x),y(f,P,l)),P++,z[R]=1);else if(!k){var B=a.arrayDefaultKey(b),F=y(h,B,_),H=y(f,P,x);c(D,m,u,H,y(f,P,l));var G=w.nestedProperty(m,H),J=w.nestedProperty(m,F);J.set(G.get()),G.set(null),k=!0}}}else{var X=w.nestedProperty(m,x);X.set(f)}}}function o(h,m){return S.getLayoutValObject(h,w.nestedProperty({},m).parts)}function i(h,m){return S.getTraceValObject(h,w.nestedProperty({},m).parts)}function y(h,m,u){var _;return u?Array.isArray(h)?_=u+"["+m+"]":_=u+"."+m:_=m,_}te.validateTemplate=function(h,m){var u=w.extendDeep({},{_context:n,data:h.data,layout:h.layout}),_=u.layout||{};v(m)||(m=_.template||{});var s=m.layout,A=m.data,b=[];u.layout=_,u.layout.template=m,M.supplyDefaults(u);var f=u._fullLayout,x=u._fullData,l={};function L(F,H){for(var G in F)if(G.charAt(0)!=="_"&&v(F[G])){var J=t(G),X=[],Y;for(Y=0;Y<H.length;Y++)X.push(y(F,G,H[Y])),J!==G&&X.push(y(F,J,H[Y]));for(Y=0;Y<X.length;Y++)l[X[Y]]=1;L(F[G],X)}}function T(F,H){for(var G in F)if(G.indexOf("defaults")===-1&&v(F[G])){var J=y(F,G,H);l[J]?T(F[G],J):b.push({code:"unused",path:J})}}if(v(s)?(L(f,["layout"]),T(s,"layout")):b.push({code:"layout"}),!v(A))b.push({code:"data"});else{for(var k={},P,z=0;z<x.length;z++){var I=x[z];P=I.type,k[P]=(k[P]||0)+1,I._fullInput._template||b.push({code:"missing",index:I._fullInput.index,traceType:P})}for(P in A){var D=A[P].length,R=k[P]||0;D>R?b.push({code:"unused",traceType:P,templateCount:D,dataCount:R}):R>D&&b.push({code:"reused",traceType:P,templateCount:D,dataCount:R})}}function B(F,H){for(var G in F)if(G.charAt(0)!=="_"){var J=F[G],X=y(F,G,H);v(J)?(Array.isArray(F)&&J._template===!1&&J.templateitemname&&b.push({code:"missing",path:X,templateitemname:J.templateitemname}),B(J,X)):Array.isArray(J)&&p(J)&&B(J,X)}}if(B({data:x,layout:f},""),b.length)return b.map(g)};function p(h){for(var m=0;m<h.length;m++)if(v(h[m]))return!0}function g(h){var m;switch(h.code){case"data":m="The template has no key data.";break;case"layout":m="The template has no key layout.";break;case"missing":h.path?m="There are no templates for item "+h.path+" with name "+h.templateitemname:m="There are no templates for trace "+h.index+", of type "+h.traceType+".";break;case"unused":h.path?m="The template item at "+h.path+" was not used in constructing the plot.":h.dataCount?m="Some of the templates of type "+h.traceType+" were not used. The template has "+h.templateCount+" traces, the data only has "+h.dataCount+" of this type.":m="The template has "+h.templateCount+" traces of type "+h.traceType+" but there are none in the data.";break;case"reused":m="Some of the templates of type "+h.traceType+" were used more than once. The template has "+h.templateCount+" traces, the data has "+h.dataCount+" of this type.";break}return h.msg=m,h}},{"../lib":515,"../plots/attributes":562,"../plots/plots":628,"./plot_config":553,"./plot_schema":554,"./plot_template":555}],558:[function(d,ee,te){var w=d("fast-isnumeric"),v=d("./plot_api"),S=d("../plots/plots"),M=d("../lib"),e=d("../snapshot/helpers"),a=d("../snapshot/tosvg"),n=d("../snapshot/svgtoimg"),r=d("../version").version,t={format:{valType:"enumerated",values:["png","jpeg","webp","svg","full-json"],dflt:"png"},width:{valType:"number",min:1},height:{valType:"number",min:1},scale:{valType:"number",min:0,dflt:1},setBackground:{valType:"any",dflt:!1},imageDataOnly:{valType:"boolean",dflt:!1}};function c(o,i){i=i||{};var y,p,g,h;M.isPlainObject(o)?(y=o.data||[],p=o.layout||{},g=o.config||{},h={}):(o=M.getGraphDiv(o),y=M.extendDeep([],o.data),p=M.extendDeep({},o.layout),g=o._context,h=o._fullLayout||{});function m(R){return!(R in i)||M.validate(i[R],t[R])}if(!m("width")&&i.width!==null||!m("height")&&i.height!==null)throw new Error("Height and width should be pixel values.");if(!m("format"))throw new Error("Export format is not "+M.join2(t.format.values,", "," or ")+".");var u={};function _(R,B){return M.coerce(i,u,t,R,B)}var s=_("format"),A=_("width"),b=_("height"),f=_("scale"),x=_("setBackground"),l=_("imageDataOnly"),L=document.createElement("div");L.style.position="absolute",L.style.left="-5000px",document.body.appendChild(L);var T=M.extendFlat({},p);A?T.width=A:i.width===null&&w(h.width)&&(T.width=h.width),b?T.height=b:i.height===null&&w(h.height)&&(T.height=h.height);var k=M.extendFlat({},g,{_exportedPlot:!0,staticPlot:!0,setBackground:x}),P=e.getRedrawFunc(L);function z(){return new Promise(function(R){setTimeout(R,e.getDelay(L._fullLayout))})}function I(){return new Promise(function(R,B){var F=a(L,s,f),H=L._fullLayout.width,G=L._fullLayout.height;function J(){v.purge(L),document.body.removeChild(L)}if(s==="full-json"){var X=S.graphJson(L,!1,"keepdata","object",!0,!0);return X.version=r,X=JSON.stringify(X),J(),R(l?X:e.encodeJSON(X))}if(J(),s==="svg")return R(l?F:e.encodeSVG(F));var Y=document.createElement("canvas");Y.id=M.randstr(),n({format:s,width:H,height:G,scale:f,canvas:Y,svg:F,promise:!0}).then(R).catch(B)})}function D(R){return l?R.replace(e.IMAGE_URL_PREFIX,""):R}return new Promise(function(R,B){v.newPlot(L,y,T,k).then(P).then(z).then(I).then(function(F){R(D(F))}).catch(function(F){B(F)})})}ee.exports=c},{"../lib":515,"../plots/plots":628,"../snapshot/helpers":651,"../snapshot/svgtoimg":653,"../snapshot/tosvg":655,"../version":1132,"./plot_api":552,"fast-isnumeric":190}],559:[function(d,ee,te){var w=d("../lib"),v=d("../plots/plots"),S=d("./plot_schema"),M=d("./plot_config").dfltConfig,e=w.isPlainObject,a=Array.isArray,n=w.isArrayOrTypedArray;ee.exports=function(_,s){_===void 0&&(_=[]),s===void 0&&(s={});var A=S.get(),b=[],f={_context:w.extendFlat({},M)},x,l;a(_)?(f.data=w.extendDeep([],_),x=_):(f.data=[],x=[],b.push(i("array","data"))),e(s)?(f.layout=w.extendDeep({},s),l=s):(f.layout={},l={},arguments.length>1&&b.push(i("object","layout"))),v.supplyDefaults(f);for(var L=f._fullData,T=x.length,k=0;k<T;k++){var P=x[k],z=["data",k];if(!e(P)){b.push(i("object",z));continue}var I=L[k],D=I.type,R=A.traces[D].attributes;R.type={valType:"enumerated",values:[D]},I.visible===!1&&P.visible!==!1&&b.push(i("invisible",z)),r(P,I,R,b,z);var B=P.transforms,F=I.transforms;if(B){a(B)||b.push(i("array",z,["transforms"])),z.push("transforms");for(var H=0;H<B.length;H++){var G=["transforms",H],J=B[H].type;if(!e(B[H])){b.push(i("object",z,G));continue}var X=A.transforms[J]?A.transforms[J].attributes:{};X.type={valType:"enumerated",values:Object.keys(A.transforms)},r(B[H],F[H],X,b,z,G)}}}var Y=f._fullLayout,Z=t(A,L);return r(l,Y,Z,b,"layout"),b.length===0?void 0:b};function r(u,_,s,A,b,f){f=f||[];for(var x=Object.keys(u),l=0;l<x.length;l++){var L=x[l];if(L!=="transforms"){var T=f.slice();T.push(L);var k=u[L],P=_[L],z=p(s,L),I=(z||{}).valType,D=I==="info_array",R=I==="colorscale",B=(z||{}).items;if(!y(s,L))A.push(i("schema",b,T));else if(e(k)&&e(P)&&I!=="any")r(k,P,z,A,b,T);else if(D&&a(k)){k.length>P.length&&A.push(i("unused",b,T.concat(P.length)));var F=P.length,H=Array.isArray(B);H&&(F=Math.min(F,B.length));var G,J,X,Y,Z;if(z.dimensions===2)for(J=0;J<F;J++)if(a(k[J])){k[J].length>P[J].length&&A.push(i("unused",b,T.concat(J,P[J].length)));var oe=P[J].length;for(G=0;G<(H?Math.min(oe,B[J].length):oe);G++)X=H?B[J][G]:B,Y=k[J][G],Z=P[J][G],w.validate(Y,X)?Z!==Y&&Z!==+Y&&A.push(i("dynamic",b,T.concat(J,G),Y,Z)):A.push(i("value",b,T.concat(J,G),Y))}else A.push(i("array",b,T.concat(J),k[J]));else for(J=0;J<F;J++)X=H?B[J]:B,Y=k[J],Z=P[J],w.validate(Y,X)?Z!==Y&&Z!==+Y&&A.push(i("dynamic",b,T.concat(J),Y,Z)):A.push(i("value",b,T.concat(J),Y))}else if(z.items&&!D&&a(k)){var re=B[Object.keys(B)[0]],se=[],N,U;for(N=0;N<P.length;N++){var q=P[N]._index||N;if(U=T.slice(),U.push(q),e(k[q])&&e(P[N])){se.push(q);var $=k[q],W=P[N];e($)&&$.visible!==!1&&W.visible===!1?A.push(i("invisible",b,U)):r($,W,re,A,b,U)}}for(N=0;N<k.length;N++)U=T.slice(),U.push(N),e(k[N])?se.indexOf(N)===-1&&A.push(i("unused",b,U)):A.push(i("object",b,U,k[N]))}else!e(k)&&e(P)?A.push(i("object",b,T,k)):!n(k)&&n(P)&&!D&&!R?A.push(i("array",b,T,k)):L in _?w.validate(k,z)?z.valType==="enumerated"&&(z.coerceNumber&&k!==+P||k!==P)&&A.push(i("dynamic",b,T,k,P)):A.push(i("value",b,T,k)):A.push(i("unused",b,T,k))}}return A}function t(u,_){for(var s=u.layout.layoutAttributes,A=0;A<_.length;A++){var b=_[A],f=u.traces[b.type],x=f.layoutAttributes;x&&(b.subplot?w.extendFlat(s[f.attributes.subplot.dflt],x):w.extendFlat(s,x))}return s}var c={object:function(u,_){var s;return u==="layout"&&_===""?s="The layout argument":u[0]==="data"&&_===""?s="Trace "+u[1]+" in the data argument":s=o(u)+"key "+_,s+" must be linked to an object container"},array:function(u,_){var s;return u==="data"?s="The data argument":s=o(u)+"key "+_,s+" must be linked to an array container"},schema:function(u,_){return o(u)+"key "+_+" is not part of the schema"},unused:function(u,_,s){var A=e(s)?"container":"key";return o(u)+A+" "+_+" did not get coerced"},dynamic:function(u,_,s,A){return[o(u)+"key",_,"(set to '"+s+"')","got reset to","'"+A+"'","during defaults."].join(" ")},invisible:function(u,_){return(_?o(u)+"item "+_:"Trace "+u[1])+" got defaulted to be not visible"},value:function(u,_,s){return[o(u)+"key "+_,"is set to an invalid value ("+s+")"].join(" ")}};function o(u){return a(u)?"In data trace "+u[1]+", ":"In "+u+", "}function i(u,_,s,A,b){s=s||"";var f,x;a(_)?(f=_[0],x=_[1]):(f=_,x=null);var l=m(s),L=c[u](_,l,A,b);return w.log(L),{code:u,container:f,trace:x,path:s,astr:l,msg:L}}function y(u,_){var s=h(_),A=s.keyMinusId,b=s.id;return A in u&&u[A]._isSubplotObj&&b?!0:_ in u}function p(u,_){if(_ in u)return u[_];var s=h(_);return u[s.keyMinusId]}var g=w.counterRegex("([a-z]+)");function h(u){var _=u.match(g);return{keyMinusId:_&&_[1],id:_&&_[2]}}function m(u){if(!a(u))return String(u);for(var _="",s=0;s<u.length;s++){var A=u[s];typeof A=="number"?_=_.substr(0,_.length-1)+"["+A+"]":_+=A,s<u.length-1&&(_+=".")}return _}},{"../lib":515,"../plots/plots":628,"./plot_config":553,"./plot_schema":554}],560:[function(d,ee,te){ee.exports={mode:{valType:"enumerated",dflt:"afterall",values:["immediate","next","afterall"]},direction:{valType:"enumerated",values:["forward","reverse"],dflt:"forward"},fromcurrent:{valType:"boolean",dflt:!1},frame:{duration:{valType:"number",min:0,dflt:500},redraw:{valType:"boolean",dflt:!0}},transition:{duration:{valType:"number",min:0,dflt:500,editType:"none"},easing:{valType:"enumerated",dflt:"cubic-in-out",values:["linear","quad","cubic","sin","exp","circle","elastic","back","bounce","linear-in","quad-in","cubic-in","sin-in","exp-in","circle-in","elastic-in","back-in","bounce-in","linear-out","quad-out","cubic-out","sin-out","exp-out","circle-out","elastic-out","back-out","bounce-out","linear-in-out","quad-in-out","cubic-in-out","sin-in-out","exp-in-out","circle-in-out","elastic-in-out","back-in-out","bounce-in-out"],editType:"none"},ordering:{valType:"enumerated",values:["layout first","traces first"],dflt:"layout first",editType:"none"}}}},{}],561:[function(d,ee,te){var w=d("../lib"),v=d("../plot_api/plot_template");ee.exports=function(M,e,a){var n=a.name,r=a.inclusionAttr||"visible",t=e[n],c=w.isArrayOrTypedArray(M[n])?M[n]:[],o=e[n]=[],i=v.arrayTemplater(e,n,r),y,p;for(y=0;y<c.length;y++){var g=c[y];w.isPlainObject(g)?p=i.newItem(g):(p=i.newItem({}),p[r]=!1),p._index=y,p[r]!==!1&&a.handleItemDefaults(g,p,e,a),o.push(p)}var h=i.defaultItems();for(y=0;y<h.length;y++)p=h[y],p._index=o.length,a.handleItemDefaults({},p,e,a,{}),o.push(p);if(w.isArrayOrTypedArray(t)){var m=Math.min(t.length,o.length);for(y=0;y<m;y++)w.relinkPrivateKeys(o[y],t[y])}return o}},{"../lib":515,"../plot_api/plot_template":555}],562:[function(d,ee,te){var w=d("./font_attributes"),v=d("../components/fx/attributes");ee.exports={type:{valType:"enumerated",values:[],dflt:"scatter",editType:"calc+clearAxisTypes",_noTemplating:!0},visible:{valType:"enumerated",values:[!0,!1,"legendonly"],dflt:!0,editType:"calc"},showlegend:{valType:"boolean",dflt:!0,editType:"style"},legendgroup:{valType:"string",dflt:"",editType:"style"},legendgrouptitle:{text:{valType:"string",dflt:"",editType:"style"},font:w({editType:"style"}),editType:"style"},legendrank:{valType:"number",dflt:1e3,editType:"style"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"style"},name:{valType:"string",editType:"style"},uid:{valType:"string",editType:"plot",anim:!0},ids:{valType:"data_array",editType:"calc",anim:!0},customdata:{valType:"data_array",editType:"calc"},meta:{valType:"any",arrayOk:!0,editType:"plot"},selectedpoints:{valType:"any",editType:"calc"},hoverinfo:{valType:"flaglist",flags:["x","y","z","text","name"],extras:["all","none","skip"],arrayOk:!0,dflt:"all",editType:"none"},hoverlabel:v.hoverlabel,stream:{token:{valType:"string",noBlank:!0,strict:!0,editType:"calc"},maxpoints:{valType:"number",min:0,max:1e4,dflt:500,editType:"calc"},editType:"calc"},transforms:{_isLinkedToArray:"transform",editType:"calc"},uirevision:{valType:"any",editType:"none"}}},{"../components/fx/attributes":398,"./font_attributes":594}],563:[function(d,ee,te){var w=d("fast-isnumeric"),v=d("../../lib"),S=v.dateTime2ms,M=v.incrementMonth,e=d("../../constants/numerical"),a=e.ONEAVGMONTH;ee.exports=function(r,t,c,o){if(t.type!=="date")return{vals:o};var i=r[c+"periodalignment"];if(!i)return{vals:o};var y=r[c+"period"],p;if(w(y)){if(y=+y,y<=0)return{vals:o}}else if(typeof y=="string"&&y.charAt(0)==="M"){var g=+y.substring(1);if(g>0&&Math.round(g)===g)p=g;else return{vals:o}}for(var h=t.calendar,m=i==="start",u=i==="end",_=r[c+"period0"],s=S(_,h)||0,A=[],b=[],f=[],x=o.length,l=0;l<x;l++){var L=o[l],T,k,P;if(p){for(T=Math.round((L-s)/(p*a)),P=M(s,p*T,h);P>L;)P=M(P,-p,h);for(;P<=L;)P=M(P,p,h);k=M(P,-p,h)}else{for(T=Math.round((L-s)/y),P=s+T*y;P>L;)P-=y;for(;P<=L;)P+=y;k=P-y}A[l]=m?k:u?P:(k+P)/2,b[l]=k,f[l]=P}return{vals:A,starts:b,ends:f}}},{"../../constants/numerical":491,"../../lib":515,"fast-isnumeric":190}],564:[function(d,ee,te){ee.exports={xaxis:{valType:"subplotid",dflt:"x",editType:"calc+clearAxisTypes"},yaxis:{valType:"subplotid",dflt:"y",editType:"calc+clearAxisTypes"}}},{}],565:[function(d,ee,te){var w=d("@plotly/d3"),v=d("fast-isnumeric"),S=d("../../lib"),M=d("../../constants/numerical").FP_SAFE,e=d("../../registry"),a=d("../../components/drawing"),n=d("./axis_ids"),r=n.getFromId,t=n.isLinked;ee.exports={getAutoRange:c,makePadFn:i,doAutoRange:h,findExtremes:m,concatExtremes:g};function c(x,l){var L,T,k=[],P=x._fullLayout,z=i(P,l,0),I=i(P,l,1),D=g(x,l),R=D.min,B=D.max;if(R.length===0||B.length===0)return S.simpleMap(l.range,l.r2l);var F=R[0].val,H=B[0].val;for(L=1;L<R.length&&F===H;L++)F=Math.min(F,R[L].val);for(L=1;L<B.length&&F===H;L++)H=Math.max(H,B[L].val);var G=!1;if(l.range){var J=S.simpleMap(l.range,l.r2l);G=J[1]<J[0]}l.autorange==="reversed"&&(G=!0,l.autorange=!0);var X=l.rangemode,Y=X==="tozero",Z=X==="nonnegative",oe=l._length,re=oe/10,se=0,N,U,q,$,W,K;for(L=0;L<R.length;L++)for(N=R[L],T=0;T<B.length;T++)U=B[T],K=U.val-N.val-o(l,N.val,U.val),K>0&&(W=oe-z(N)-I(U),W>re?K/W>se&&(q=N,$=U,se=K/W):K/oe>se&&(q={val:N.val,nopad:1},$={val:U.val,nopad:1},se=K/oe));function ne(ue,pe){return Math.max(ue,I(pe))}if(F===H){var ae=F-1,ie=F+1;if(Y)if(F===0)k=[0,1];else{var le=(F>0?B:R).reduce(ne,0),ye=F/(1-Math.min(.5,le/oe));k=F>0?[0,ye]:[ye,0]}else Z?k=[Math.max(0,ae),Math.max(1,ie)]:k=[ae,ie]}else Y?(q.val>=0&&(q={val:0,nopad:1}),$.val<=0&&($={val:0,nopad:1})):Z&&(q.val-se*z(q)<0&&(q={val:0,nopad:1}),$.val<=0&&($={val:1,nopad:1})),se=($.val-q.val-o(l,N.val,U.val))/(oe-z(q)-I($)),k=[q.val-se*z(q),$.val+se*I($)];return G&&k.reverse(),S.simpleMap(k,l.l2r||Number)}function o(x,l,L){var T=0;if(x.rangebreaks)for(var k=x.locateBreaks(l,L),P=0;P<k.length;P++){var z=k[P];T+=z.max-z.min}return T}function i(x,l,L){var T=.05*l._length,k=l._anchorAxis||{};if((l.ticklabelposition||"").indexOf("inside")!==-1||(k.ticklabelposition||"").indexOf("inside")!==-1){var P=l.autorange==="reversed";if(!P){var z=S.simpleMap(l.range,l.r2l);P=z[1]<z[0]}P&&(L=!L)}var I=0;return t(x,l._id)||(I=p(x,l,L)),T=Math.max(I,T),l.constrain==="domain"&&l._inputDomain&&(T*=(l._inputDomain[1]-l._inputDomain[0])/(l.domain[1]-l.domain[0])),function(R){return R.nopad?0:R.pad+(R.extrapad?T:I)}}var y=3;function p(x,l,L){var T=0,k=l._id.charAt(0)==="x";for(var P in x._plots){var z=x._plots[P];if(!(l._id!==z.xaxis._id&&l._id!==z.yaxis._id)){var I=(k?z.yaxis:z.xaxis)||{};if((I.ticklabelposition||"").indexOf("inside")!==-1&&(!L&&(I.side==="left"||I.side==="bottom")||L&&(I.side==="top"||I.side==="right"))){if(I._vals){var D=S.deg2rad(I._tickAngles[I._id+"tick"]||0),R=Math.abs(Math.cos(D)),B=Math.abs(Math.sin(D));if(!I._vals[0].bb){var F=I._id+"tick",H=I._selections[F];H.each(function(oe){var re=w.select(this),se=re.select(".text-math-group");se.empty()&&(oe.bb=a.bBox(re.node()))})}for(var G=0;G<I._vals.length;G++){var J=I._vals[G],X=J.bb;if(X){var Y=2*y+X.width,Z=2*y+X.height;T=Math.max(T,k?Math.max(Y*R,Z*B):Math.max(Z*R,Y*B))}}}I.ticks==="inside"&&I.ticklabelposition==="inside"&&(T+=I.ticklen||0)}}}return T}function g(x,l,L){var T=l._id,k=x._fullData,P=x._fullLayout,z=[],I=[],D,R,B;function F(Y,Z){for(D=0;D<Z.length;D++){var oe=Y[Z[D]],re=(oe._extremes||{})[T];if(oe.visible===!0&&re){for(R=0;R<re.min.length;R++)B=re.min[R],u(z,B.val,B.pad,{extrapad:B.extrapad});for(R=0;R<re.max.length;R++)B=re.max[R],_(I,B.val,B.pad,{extrapad:B.extrapad})}}}if(F(k,l._traceIndices),F(P.annotations||[],l._annIndices||[]),F(P.shapes||[],l._shapeIndices||[]),l._matchGroup&&!L){for(var H in l._matchGroup)if(H!==l._id){var G=r(x,H),J=g(x,G,!0),X=l._length/G._length;for(R=0;R<J.min.length;R++)B=J.min[R],u(z,B.val,B.pad*X,{extrapad:B.extrapad});for(R=0;R<J.max.length;R++)B=J.max[R],_(I,B.val,B.pad*X,{extrapad:B.extrapad})}}return{min:z,max:I}}function h(x,l,L){if(l.setScale(),l.autorange){l.range=L?L.slice():c(x,l),l._r=l.range.slice(),l._rl=S.simpleMap(l._r,l.r2l);var T=l._input,k={};k[l._attr+".range"]=l.range,k[l._attr+".autorange"]=l.autorange,e.call("_storeDirectGUIEdit",x.layout,x._fullLayout._preGUI,k),T.range=l.range.slice(),T.autorange=l.autorange}var P=l._anchorAxis;if(P&&P.rangeslider){var z=P.rangeslider[l._name];z&&z.rangemode==="auto"&&(z.range=c(x,l)),P._input.rangeslider[l._name]=S.extendFlat({},z)}}function m(x,l,L){L||(L={}),x._m||x.setScale();var T=[],k=[],P=l.length,z=L.padded||!1,I=L.tozero&&(x.type==="linear"||x.type==="-"),D=x.type==="log",R=!1,B=L.vpadLinearized||!1,F,H,G,J,X,Y,Z,oe,re;function se(ae){if(Array.isArray(ae))return R=!0,function(le){return Math.max(Number(ae[le]||0),0)};var ie=Math.max(Number(ae||0),0);return function(){return ie}}var N=se((x._m>0?L.ppadplus:L.ppadminus)||L.ppad||0),U=se((x._m>0?L.ppadminus:L.ppadplus)||L.ppad||0),q=se(L.vpadplus||L.vpad),$=se(L.vpadminus||L.vpad);if(!R){if(oe=1/0,re=-1/0,D)for(F=0;F<P;F++)H=l[F],H<oe&&H>0&&(oe=H),H>re&&H<M&&(re=H);else for(F=0;F<P;F++)H=l[F],H<oe&&H>-M&&(oe=H),H>re&&H<M&&(re=H);l=[oe,re],P=2}var W={tozero:I,extrapad:z};function K(ae){G=l[ae],v(G)&&(Y=N(ae),Z=U(ae),B?(J=x.c2l(G)-$(ae),X=x.c2l(G)+q(ae)):(oe=G-$(ae),re=G+q(ae),D&&oe<re/10&&(oe=re/10),J=x.c2l(oe),X=x.c2l(re)),I&&(J=Math.min(0,J),X=Math.max(0,X)),A(J)&&u(T,J,Z,W),A(X)&&_(k,X,Y,W))}var ne=Math.min(6,P);for(F=0;F<ne;F++)K(F);for(F=P-1;F>=ne;F--)K(F);return{min:T,max:k,opts:L}}function u(x,l,L,T){s(x,l,L,T,b)}function _(x,l,L,T){s(x,l,L,T,f)}function s(x,l,L,T,k){for(var P=T.tozero,z=T.extrapad,I=!0,D=0;D<x.length&&I;D++){var R=x[D];if(k(R.val,l)&&R.pad>=L&&(R.extrapad||!z)){I=!1;break}else k(l,R.val)&&R.pad<=L&&(z||!R.extrapad)&&(x.splice(D,1),D--)}if(I){var B=P&&l===0;x.push({val:l,pad:B?0:L,extrapad:B?!1:z})}}function A(x){return v(x)&&Math.abs(x)<M}function b(x,l){return x<=l}function f(x,l){return x>=l}},{"../../components/drawing":389,"../../constants/numerical":491,"../../lib":515,"../../registry":647,"./axis_ids":570,"@plotly/d3":58,"fast-isnumeric":190}],566:[function(d,ee,te){var w=d("@plotly/d3"),v=d("fast-isnumeric"),S=d("../../plots/plots"),M=d("../../registry"),e=d("../../lib"),a=e.strTranslate,n=d("../../lib/svg_text_utils"),r=d("../../components/titles"),t=d("../../components/color"),c=d("../../components/drawing"),o=d("./layout_attributes"),i=d("./clean_ticks"),y=d("../../constants/numerical"),p=y.ONEMAXYEAR,g=y.ONEAVGYEAR,h=y.ONEMINYEAR,m=y.ONEMAXQUARTER,u=y.ONEAVGQUARTER,_=y.ONEMINQUARTER,s=y.ONEMAXMONTH,A=y.ONEAVGMONTH,b=y.ONEMINMONTH,f=y.ONEWEEK,x=y.ONEDAY,l=x/2,L=y.ONEHOUR,T=y.ONEMIN,k=y.ONESEC,P=y.MINUS_SIGN,z=y.BADNUM,I={K:"zeroline"},D={K:"gridline",L:"path"},R={K:"minor-gridline",L:"path"},B={K:"tick",L:"path"},F={K:"tick",L:"text"},H={width:["x","r","l","xl","xr"],height:["y","t","b","yt","yb"],right:["r","xr"],left:["l","xl"],top:["t","yt"],bottom:["b","yb"]},G=d("../../constants/alignment"),J=G.MID_SHIFT,X=G.CAP_SHIFT,Y=G.LINE_SPACING,Z=G.OPPOSITE_SIDE,oe=3,re=ee.exports={};re.setConvert=d("./set_convert");var se=d("./axis_autotype"),N=d("./axis_ids"),U=N.idSort,q=N.isLinked;re.id2name=N.id2name,re.name2id=N.name2id,re.cleanId=N.cleanId,re.list=N.list,re.listIds=N.listIds,re.getFromId=N.getFromId,re.getFromTrace=N.getFromTrace;var $=d("./autorange");re.getAutoRange=$.getAutoRange,re.findExtremes=$.findExtremes;var W=1e-4;function K(ke){var Se=(ke[1]-ke[0])*W;return[ke[0]-Se,ke[1]+Se]}re.coerceRef=function(ke,Se,nt,it,ct,At){var dt=it.charAt(it.length-1),Tt=nt._fullLayout._subplots[dt+"axis"],Ht=it+"ref",ir={};return ct||(ct=Tt[0]||(typeof At=="string"?At:At[0])),At||(At=ct),Tt=Tt.concat(Tt.map(function(kr){return kr+" domain"})),ir[Ht]={valType:"enumerated",values:Tt.concat(At?typeof At=="string"?[At]:At:[]),dflt:ct},e.coerce(ke,Se,ir,Ht)},re.getRefType=function(ke){return ke===void 0?ke:ke==="paper"?"paper":ke==="pixel"?"pixel":/( domain)$/.test(ke)?"domain":"range"},re.coercePosition=function(ke,Se,nt,it,ct,At){var dt,Tt,Ht=re.getRefType(it);if(Ht!=="range")dt=e.ensureNumber,Tt=nt(ct,At);else{var ir=re.getFromId(Se,it);At=ir.fraction2r(At),Tt=nt(ct,At),dt=ir.cleanPos}ke[ct]=dt(Tt)},re.cleanPosition=function(ke,Se,nt){var it=nt==="paper"||nt==="pixel"?e.ensureNumber:re.getFromId(Se,nt).cleanPos;return it(ke)},re.redrawComponents=function(ke,Se){Se=Se||re.listIds(ke);var nt=ke._fullLayout;function it(ct,At,dt,Tt){for(var Ht=M.getComponentMethod(ct,At),ir={},kr=0;kr<Se.length;kr++)for(var br=nt[re.id2name(Se[kr])],Mr=br[dt],Hr=0;Hr<Mr.length;Hr++){var nr=Mr[Hr];if(!ir[nr]&&(Ht(ke,nr),ir[nr]=1,Tt))return}}it("annotations","drawOne","_annIndices"),it("shapes","drawOne","_shapeIndices"),it("images","draw","_imgIndices",!0),it("selections","drawOne","_selectionIndices")};var ne=re.getDataConversions=function(ke,Se,nt,it){var ct,At=nt==="x"||nt==="y"||nt==="z"?nt:it;if(Array.isArray(At)){if(ct={type:se(it,void 0,{autotypenumbers:ke._fullLayout.autotypenumbers}),_categories:[]},re.setConvert(ct),ct.type==="category")for(var dt=0;dt<it.length;dt++)ct.d2c(it[dt])}else ct=re.getFromTrace(ke,Se,At);return ct?{d2c:ct.d2c,c2d:ct.c2d}:At==="ids"?{d2c:ie,c2d:ie}:{d2c:ae,c2d:ae}};function ae(ke){return+ke}function ie(ke){return String(ke)}re.getDataToCoordFunc=function(ke,Se,nt,it){return ne(ke,Se,nt,it).d2c},re.counterLetter=function(ke){var Se=ke.charAt(0);if(Se==="x")return"y";if(Se==="y")return"x"},re.minDtick=function(ke,Se,nt,it){["log","category","multicategory"].indexOf(ke.type)!==-1||!it?ke._minDtick=0:ke._minDtick===void 0?(ke._minDtick=Se,ke._forceTick0=nt):ke._minDtick&&((ke._minDtick/Se+1e-6)%1<2e-6&&((nt-ke._forceTick0)/Se%1+1.000001)%1<2e-6?(ke._minDtick=Se,ke._forceTick0=nt):((Se/ke._minDtick+1e-6)%1>2e-6||((nt-ke._forceTick0)/ke._minDtick%1+1.000001)%1>2e-6)&&(ke._minDtick=0))},re.saveRangeInitial=function(ke,Se){for(var nt=re.list(ke,"",!0),it=!1,ct=0;ct<nt.length;ct++){var At=nt[ct],dt=At._rangeInitial===void 0,Tt=dt||!(At.range[0]===At._rangeInitial[0]&&At.range[1]===At._rangeInitial[1]);(dt&&At.autorange===!1||Se&&Tt)&&(At._rangeInitial=At.range.slice(),it=!0)}return it},re.saveShowSpikeInitial=function(ke,Se){for(var nt=re.list(ke,"",!0),it=!1,ct="on",At=0;At<nt.length;At++){var dt=nt[At],Tt=dt._showSpikeInitial===void 0,Ht=Tt||dt.showspikes!==dt._showspikes;(Tt||Se&&Ht)&&(dt._showSpikeInitial=dt.showspikes,it=!0),ct==="on"&&!dt.showspikes&&(ct="off")}return ke._fullLayout._cartesianSpikesEnabled=ct,it},re.autoBin=function(ke,Se,nt,it,ct,At){var dt=e.aggNums(Math.min,null,ke),Tt=e.aggNums(Math.max,null,ke);if(Se.type==="category"||Se.type==="multicategory")return{start:dt-.5,end:Tt+.5,size:Math.max(1,Math.round(At)||1),_dataSpan:Tt-dt};ct||(ct=Se.calendar);var Ht;if(Se.type==="log"?Ht={type:"linear",range:[dt,Tt]}:Ht={type:Se.type,range:e.simpleMap([dt,Tt],Se.c2r,0,ct),calendar:ct},re.setConvert(Ht),At=At&&i.dtick(At,Ht.type),At)Ht.dtick=At,Ht.tick0=i.tick0(void 0,Ht.type,ct);else{var ir;if(nt)ir=(Tt-dt)/nt;else{var kr=e.distinctVals(ke),br=Math.pow(10,Math.floor(Math.log(kr.minDiff)/Math.LN10)),Mr=br*e.roundUp(kr.minDiff/br,[.9,1.9,4.9,9.9],!0);ir=Math.max(Mr,2*e.stdev(ke)/Math.pow(ke.length,it?.25:.4)),v(ir)||(ir=1)}re.autoTicks(Ht,ir)}var Hr=Ht.dtick,nr=re.tickIncrement(re.tickFirst(Ht),Hr,"reverse",ct),mr,Pr;if(typeof Hr=="number")nr=le(nr,ke,Ht,dt,Tt),Pr=1+Math.floor((Tt-nr)/Hr),mr=nr+Pr*Hr;else for(Ht.dtick.charAt(0)==="M"&&(nr=ye(nr,ke,Hr,dt,ct)),mr=nr,Pr=0;mr<=Tt;)mr=re.tickIncrement(mr,Hr,!1,ct),Pr++;return{start:Se.c2r(nr,0,ct),end:Se.c2r(mr,0,ct),size:Hr,_dataSpan:Tt-dt}};function le(ke,Se,nt,it,ct){var At=0,dt=0,Tt=0,Ht=0;function ir(Hr){return(1+(Hr-ke)*100/nt.dtick)%100<2}for(var kr=0;kr<Se.length;kr++)Se[kr]%1===0?Tt++:v(Se[kr])||Ht++,ir(Se[kr])&&At++,ir(Se[kr]+nt.dtick/2)&&dt++;var br=Se.length-Ht;if(Tt===br&&nt.type!=="date")nt.dtick<1?ke=it-.5*nt.dtick:(ke-=.5,ke+nt.dtick<it&&(ke+=nt.dtick));else if(dt<br*.1&&(At>br*.3||ir(it)||ir(ct))){var Mr=nt.dtick/2;ke+=ke+Mr<it?Mr:-Mr}return ke}function ye(ke,Se,nt,it,ct){var At=e.findExactDates(Se,ct),dt=.8;if(At.exactDays>dt){var Tt=Number(nt.substr(1));At.exactYears>dt&&Tt%12===0?ke=re.tickIncrement(ke,"M6","reverse")+x*1.5:At.exactMonths>dt?ke=re.tickIncrement(ke,"M1","reverse")+x*15.5:ke-=l;var Ht=re.tickIncrement(ke,nt);if(Ht<=it)return Ht}return ke}re.prepMinorTicks=function(ke,Se,nt){if(!Se.minor.dtick){delete ke.dtick;var it=Se.dtick&&v(Se._tmin),ct;if(it){var At=re.tickIncrement(Se._tmin,Se.dtick,!0);ct=[Se._tmin,At*.99+Se._tmin*.01]}else{var dt=e.simpleMap(Se.range,Se.r2l);ct=[dt[0],.8*dt[0]+.2*dt[1]]}if(ke.range=e.simpleMap(ct,Se.l2r),ke._isMinor=!0,re.prepTicks(ke,nt),it){var Tt=v(Se.dtick),Ht=v(ke.dtick),ir=Tt?Se.dtick:+Se.dtick.substring(1),kr=Ht?ke.dtick:+ke.dtick.substring(1);Tt&&Ht?ue(ir,kr)?ir===2*f&&kr===2*x&&(ke.dtick=f):ir===2*f&&kr===3*x?ke.dtick=f:ir===f&&!(Se._input.minor||{}).nticks?ke.dtick=x:pe(ir/kr,2.5)?ke.dtick=ir/2:ke.dtick=ir:String(Se.dtick).charAt(0)==="M"?Ht?ke.dtick="M1":ue(ir,kr)?ir>=12&&kr===2&&(ke.dtick="M3"):ke.dtick=Se.dtick:String(ke.dtick).charAt(0)==="L"?String(Se.dtick).charAt(0)==="L"?ue(ir,kr)||(ke.dtick=pe(ir/kr,2.5)?Se.dtick/2:Se.dtick):ke.dtick="D1":ke.dtick==="D2"&&+Se.dtick>1&&(ke.dtick=1)}ke.range=Se.range}Se.minor._tick0Init===void 0&&(ke.tick0=Se.tick0)};function ue(ke,Se){return Math.abs((ke/Se+.5)%1-.5)<.001}function pe(ke,Se){return Math.abs(ke/Se-1)<.001}re.prepTicks=function(ke,Se){var nt=e.simpleMap(ke.range,ke.r2l,void 0,void 0,Se);if(ke.tickmode==="auto"||!ke.dtick){var it=ke.nticks,ct;it||(ke.type==="category"||ke.type==="multicategory"?(ct=ke.tickfont?e.bigFont(ke.tickfont.size||12):15,it=ke._length/ct):(ct=ke._id.charAt(0)==="y"?40:80,it=e.constrain(ke._length/ct,4,9)+1),ke._name==="radialaxis"&&(it*=2)),ke.minor&&ke.minor.tickmode!=="array"||ke.tickmode==="array"&&(it*=100),ke._roughDTick=Math.abs(nt[1]-nt[0])/it,re.autoTicks(ke,ke._roughDTick),ke._minDtick>0&&ke.dtick<ke._minDtick*2&&(ke.dtick=ke._minDtick,ke.tick0=ke.l2r(ke._forceTick0))}ke.ticklabelmode==="period"&&Te(ke),ke.tick0||(ke.tick0=ke.type==="date"?"2000-01-01":0),ke.type==="date"&&ke.dtick<.1&&(ke.dtick=.1),He(ke)};function ge(ke){return+ke.substring(1)}function Te(ke){var Se;function nt(){return!(v(ke.dtick)||ke.dtick.charAt(0)!=="M")}var it=nt(),ct=re.getTickFormat(ke);if(ct){var At=ke._dtickInit!==ke.dtick;/%[fLQsSMX]/.test(ct)||(/%[HI]/.test(ct)?(Se=L,At&&!it&&ke.dtick<L&&(ke.dtick=L)):/%p/.test(ct)?(Se=l,At&&!it&&ke.dtick<l&&(ke.dtick=l)):/%[Aadejuwx]/.test(ct)?(Se=x,At&&!it&&ke.dtick<x&&(ke.dtick=x)):/%[UVW]/.test(ct)?(Se=f,At&&!it&&ke.dtick<f&&(ke.dtick=f)):/%[Bbm]/.test(ct)?(Se=A,At&&(it?ge(ke.dtick)<1:ke.dtick<b)&&(ke.dtick="M1")):/%[q]/.test(ct)?(Se=u,At&&(it?ge(ke.dtick)<3:ke.dtick<_)&&(ke.dtick="M3")):/%[Yy]/.test(ct)&&(Se=g,At&&(it?ge(ke.dtick)<12:ke.dtick<h)&&(ke.dtick="M12")))}it=nt(),it&&ke.tick0===ke._dowTick0&&(ke.tick0=ke._rawTick0),ke._definedDelta=Se}function _e(ke,Se,nt){for(var it=0;it<ke.length;it++){var ct=ke[it].value,At=it,dt=it+1;it<ke.length-1?(At=it,dt=it+1):it>0?(At=it-1,dt=it):(At=it,dt=it);var Tt=ke[At].value,Ht=ke[dt].value,ir=Math.abs(Ht-Tt),kr=nt||ir,br=0;kr>=h?ir>=h&&ir<=p?br=ir:br=g:nt===u&&kr>=_?ir>=_&&ir<=m?br=ir:br=u:kr>=b?ir>=b&&ir<=s?br=ir:br=A:nt===f&&kr>=f?br=f:kr>=x?br=x:nt===l&&kr>=l?br=l:nt===L&&kr>=L&&(br=L);var Mr;br>=ir&&(br=ir,Mr=!0);var Hr=ct+br;if(Se.rangebreaks&&br>0){for(var nr=84,mr=0,Pr=0;Pr<nr;Pr++){var Nr=(Pr+.5)/nr;Se.maskBreaks(ct*(1-Nr)+Nr*Hr)!==z&&mr++}br*=mr/nr,br||(ke[it].drop=!0),Mr&&ir>f&&(br=ir)}(br>0||it===0)&&(ke[it].periodX=ct+br/2)}}re.calcTicks=function(Se,nt){for(var it=Se.type,ct=Se.calendar,At=Se.ticklabelstep,dt=Se.ticklabelmode==="period",Tt=e.simpleMap(Se.range,Se.r2l,void 0,void 0,nt),Ht=Tt[1]<Tt[0],ir=Math.min(Tt[0],Tt[1]),kr=Math.max(Tt[0],Tt[1]),br=Math.max(1e3,Se._length||0),Mr=[],Hr=[],nr=[],mr=[],Pr=Se.minor&&(Se.minor.ticks||Se.minor.showgrid),Nr=1;Nr>=(Pr?0:1);Nr--){var Sr=!Nr;Nr?(Se._dtickInit=Se.dtick,Se._tick0Init=Se.tick0):(Se.minor._dtickInit=Se.minor.dtick,Se.minor._tick0Init=Se.minor.tick0);var tt=Nr?Se:e.extendFlat({},Se,Se.minor);if(Sr?re.prepMinorTicks(tt,Se,nt):re.prepTicks(tt,nt),tt.tickmode==="array"){Nr?(nr=[],Mr=ze(Se)):(mr=[],Hr=ze(Se));continue}var Et=K(Tt),Vt=Et[0],ar=Et[1],Cr=v(tt.dtick),Or=it==="log"&&!(Cr||tt.dtick.charAt(0)==="L"),Ir=re.tickFirst(tt,nt);if(Nr){if(Se._tmin=Ir,Ir<Vt!==Ht)break;(it==="category"||it==="multicategory")&&(ar=Ht?Math.max(-.5,ar):Math.min(Se._categories.length-.5,ar))}var Tr=null,Wr=Ir,wn;if(Nr){var ln;Cr?ln=Se.dtick:it==="date"?typeof Se.dtick=="string"&&Se.dtick.charAt(0)==="M"&&(ln=A*Se.dtick.substring(1)):ln=Se._roughDTick,wn=Math.round((Se.r2l(Wr)-Se.r2l(Se.tick0))/ln)-1}var Bn=tt.dtick;for(tt.rangebreaks&&tt._tick0Init!==tt.tick0&&(Wr=lt(Wr,Se),Ht||(Wr=re.tickIncrement(Wr,Bn,!Ht,ct))),Nr&&dt&&(Wr=re.tickIncrement(Wr,Bn,!Ht,ct),wn--);Ht?Wr>=ar:Wr<=ar;Wr=re.tickIncrement(Wr,Bn,Ht,ct)){if(Nr&&wn++,tt.rangebreaks&&!Ht){if(Wr<Vt)continue;if(tt.maskBreaks(Wr)===z&&lt(Wr,tt)>=kr)break}if(nr.length>br||Wr===Tr)break;Tr=Wr;var Cn={value:Wr};Nr?(Or&&Wr!==(Wr|0)&&(Cn.simpleLabel=!0),At>1&&wn%At&&(Cn.skipLabel=!0),nr.push(Cn)):(Cn.minor=!0,mr.push(Cn))}}if(Pr){var Wn=Se.minor.ticks==="inside"&&Se.ticks==="outside"||Se.minor.ticks==="outside"&&Se.ticks==="inside";if(!Wn){for(var Hn=nr.map(function(Bt){return Bt.value}),ga=[],La=0;La<mr.length;La++){var ci=mr[La],Va=ci.value;if(Hn.indexOf(Va)===-1){for(var ja=!1,Wa=0;!ja&&Wa<nr.length;Wa++)1e7+nr[Wa].value===1e7+Va&&(ja=!0);ja||ga.push(ci)}}mr=ga}}dt&&_e(nr,Se,Se._definedDelta);var wr;if(Se.rangebreaks){var pn=Se._id.charAt(0)==="y",fn=1;Se.tickmode==="auto"&&(fn=Se.tickfont?Se.tickfont.size:12);var An=NaN;for(wr=nr.length-1;wr>-1;wr--){if(nr[wr].drop){nr.splice(wr,1);continue}nr[wr].value=lt(nr[wr].value,Se);var Zn=Se.c2p(nr[wr].value);(pn?An>Zn-fn:An<Zn+fn)?nr.splice(Ht?wr+1:wr,1):An=Zn}}st(Se)&&Math.abs(Tt[1]-Tt[0])===360&&nr.pop(),Se._tmax=(nr[nr.length-1]||{}).value,Se._prevDateHead="",Se._inCalcTicks=!0;var ua,ea=function(Bt){Bt.text="",Se._prevDateHead=ua};nr=nr.concat(mr);var Rn,Xn;for(wr=0;wr<nr.length;wr++){var Ua=nr[wr].minor,li=nr[wr].value;Ua?Hr.push({x:li,minor:!0}):(ua=Se._prevDateHead,Rn=re.tickText(Se,li,!1,nr[wr].simpleLabel),Xn=nr[wr].periodX,Xn!==void 0&&(Rn.periodX=Xn,(Xn>kr||Xn<ir)&&(Xn>kr&&(Rn.periodX=kr),Xn<ir&&(Rn.periodX=ir),ea(Rn))),nr[wr].skipLabel&&ea(Rn),Mr.push(Rn))}return Mr=Mr.concat(Hr),Se._inCalcTicks=!1,dt&&Mr.length&&(Mr[0].noTick=!0),Mr};function ze(ke){var Se=e.simpleMap(ke.range,ke.r2l),nt=K(Se),it=Math.min(nt[0],nt[1]),ct=Math.max(nt[0],nt[1]),At=ke.type==="category"?ke.d2l_noadd:ke.d2l;ke.type==="log"&&String(ke.dtick).charAt(0)!=="L"&&(ke.dtick="L"+Math.pow(10,Math.floor(Math.min(ke.range[0],ke.range[1]))-1));for(var dt=[],Tt=0;Tt<=1;Tt++)if(!(Tt&&!ke.minor)){var Ht=Tt?ke.minor.tickvals:ke.tickvals,ir=Tt?[]:ke.ticktext;if(!!Ht){Array.isArray(ir)||(ir=[]);for(var kr=0;kr<Ht.length;kr++){var br=At(Ht[kr]);if(br>it&&br<ct){var Mr=ir[kr]===void 0?re.tickText(ke,br):vt(ke,br,String(ir[kr]));Tt&&(Mr.minor=!0,Mr.text=""),dt.push(Mr)}}}}return ke.rangebreaks&&(dt=dt.filter(function(Hr){return ke.maskBreaks(Hr.x)!==z})),dt}var Oe=[2,5,10],Ye=[1,2,3,6,12],be=[1,2,5,10,15,30],Pe=[1,2,3,7,14],Ge=[-.046,0,.301,.477,.602,.699,.778,.845,.903,.954,1],Qe=[-.301,0,.301,.699,1],Be=[15,30,45,90,180];function Le(ke,Se,nt){return Se*e.roundUp(ke/Se,nt)}re.autoTicks=function(ke,Se,nt){var it;function ct(br){return Math.pow(br,Math.floor(Math.log(Se)/Math.LN10))}if(ke.type==="date"){ke.tick0=e.dateTick0(ke.calendar,0);var At=2*Se;if(At>g)Se/=g,it=ct(10),ke.dtick="M"+12*Le(Se,it,Oe);else if(At>A)Se/=A,ke.dtick="M"+Le(Se,1,Ye);else if(At>x){if(ke.dtick=Le(Se,x,ke._hasDayOfWeekBreaks?[1,2,7,14]:Pe),!nt){var dt=re.getTickFormat(ke),Tt=ke.ticklabelmode==="period";Tt&&(ke._rawTick0=ke.tick0),/%[uVW]/.test(dt)?ke.tick0=e.dateTick0(ke.calendar,2):ke.tick0=e.dateTick0(ke.calendar,1),Tt&&(ke._dowTick0=ke.tick0)}}else At>L?ke.dtick=Le(Se,L,Ye):At>T?ke.dtick=Le(Se,T,be):At>k?ke.dtick=Le(Se,k,be):(it=ct(10),ke.dtick=Le(Se,it,Oe))}else if(ke.type==="log"){ke.tick0=0;var Ht=e.simpleMap(ke.range,ke.r2l);if(ke._isMinor&&(Se*=1.5),Se>.7)ke.dtick=Math.ceil(Se);else if(Math.abs(Ht[1]-Ht[0])<1){var ir=1.5*Math.abs((Ht[1]-Ht[0])/Se);Se=Math.abs(Math.pow(10,Ht[1])-Math.pow(10,Ht[0]))/ir,it=ct(10),ke.dtick="L"+Le(Se,it,Oe)}else ke.dtick=Se>.3?"D2":"D1"}else ke.type==="category"||ke.type==="multicategory"?(ke.tick0=0,ke.dtick=Math.ceil(Math.max(Se,1))):st(ke)?(ke.tick0=0,it=1,ke.dtick=Le(Se,it,Be)):(ke.tick0=0,it=ct(10),ke.dtick=Le(Se,it,Oe));if(ke.dtick===0&&(ke.dtick=1),!v(ke.dtick)&&typeof ke.dtick!="string"){var kr=ke.dtick;throw ke.dtick=1,"ax.dtick error: "+String(kr)}};function He(ke){var Se=ke.dtick;if(ke._tickexponent=0,!v(Se)&&typeof Se!="string"&&(Se=1),(ke.type==="category"||ke.type==="multicategory")&&(ke._tickround=null),ke.type==="date"){var nt=ke.r2l(ke.tick0),it=ke.l2r(nt).replace(/(^-|i)/g,""),ct=it.length;if(String(Se).charAt(0)==="M")ct>10||it.substr(5)!=="01-01"?ke._tickround="d":ke._tickround=+Se.substr(1)%12===0?"y":"m";else if(Se>=x&&ct<=10||Se>=x*15)ke._tickround="d";else if(Se>=T&&ct<=16||Se>=L)ke._tickround="M";else if(Se>=k&&ct<=19||Se>=T)ke._tickround="S";else{var At=ke.l2r(nt+Se).replace(/^-/,"").length;ke._tickround=Math.max(ct,At)-20,ke._tickround<0&&(ke._tickround=4)}}else if(v(Se)||Se.charAt(0)==="L"){var dt=ke.range.map(ke.r2d||Number);v(Se)||(Se=Number(Se.substr(1))),ke._tickround=2-Math.floor(Math.log(Se)/Math.LN10+.01);var Tt=Math.max(Math.abs(dt[0]),Math.abs(dt[1])),Ht=Math.floor(Math.log(Tt)/Math.LN10+.01),ir=ke.minexponent===void 0?3:ke.minexponent;Math.abs(Ht)>ir&&(qe(ke.exponentformat)&&!Ve(Ht)?ke._tickexponent=3*Math.round((Ht-1)/3):ke._tickexponent=Ht)}else ke._tickround=null}re.tickIncrement=function(ke,Se,nt,it){var ct=nt?-1:1;if(v(Se))return e.increment(ke,ct*Se);var At=Se.charAt(0),dt=ct*Number(Se.substr(1));if(At==="M")return e.incrementMonth(ke,dt,it);if(At==="L")return Math.log(Math.pow(10,ke)+dt)/Math.LN10;if(At==="D"){var Tt=Se==="D2"?Qe:Ge,Ht=ke+ct*.01,ir=e.roundUp(e.mod(Ht,1),Tt,nt);return Math.floor(Ht)+Math.log(w.round(Math.pow(10,ir),1))/Math.LN10}throw"unrecognized dtick "+String(Se)},re.tickFirst=function(ke,Se){var nt=ke.r2l||Number,it=e.simpleMap(ke.range,nt,void 0,void 0,Se),ct=it[1]<it[0],At=ct?Math.floor:Math.ceil,dt=K(it)[0],Tt=ke.dtick,Ht=nt(ke.tick0);if(v(Tt)){var ir=At((dt-Ht)/Tt)*Tt+Ht;return(ke.type==="category"||ke.type==="multicategory")&&(ir=e.constrain(ir,0,ke._categories.length-1)),ir}var kr=Tt.charAt(0),br=Number(Tt.substr(1));if(kr==="M"){for(var Mr=0,Hr=Ht,nr,mr,Pr;Mr<10;){if(nr=re.tickIncrement(Hr,Tt,ct,ke.calendar),(nr-dt)*(Hr-dt)<=0)return ct?Math.min(Hr,nr):Math.max(Hr,nr);mr=(dt-(Hr+nr)/2)/(nr-Hr),Pr=kr+(Math.abs(Math.round(mr))||1)*br,Hr=re.tickIncrement(Hr,Pr,mr<0?!ct:ct,ke.calendar),Mr++}return e.error("tickFirst did not converge",ke),Hr}else{if(kr==="L")return Math.log(At((Math.pow(10,dt)-Ht)/br)*br+Ht)/Math.LN10;if(kr==="D"){var Nr=Tt==="D2"?Qe:Ge,Sr=e.roundUp(e.mod(dt,1),Nr,ct);return Math.floor(dt)+Math.log(w.round(Math.pow(10,Sr),1))/Math.LN10}else throw"unrecognized dtick "+String(Tt)}},re.tickText=function(ke,Se,nt,it){var ct=vt(ke,Se),At=ke.tickmode==="array",dt=nt||At,Tt=ke.type,Ht=Tt==="category"?ke.d2l_noadd:ke.d2l,ir;if(At&&Array.isArray(ke.ticktext)){var kr=e.simpleMap(ke.range,ke.r2l),br=(Math.abs(kr[1]-kr[0])-(ke._lBreaks||0))/1e4;for(ir=0;ir<ke.ticktext.length&&!(Math.abs(Se-Ht(ke.tickvals[ir]))<br);ir++);if(ir<ke.ticktext.length)return ct.text=String(ke.ticktext[ir]),ct}function Mr(mr){if(mr===void 0)return!0;if(nt)return mr==="none";var Pr={first:ke._tmin,last:ke._tmax}[mr];return mr!=="all"&&Se!==Pr}var Hr=nt?"never":ke.exponentformat!=="none"&&Mr(ke.showexponent)?"hide":"";if(Tt==="date"?Rt(ke,ct,nt,dt):Tt==="log"?rr(ke,ct,nt,dt,Hr):Tt==="category"?Lt(ke,ct):Tt==="multicategory"?Ft(ke,ct,nt):st(ke)?Dt(ke,ct,nt,dt,Hr):Gt(ke,ct,nt,dt,Hr),it||(ke.tickprefix&&!Mr(ke.showtickprefix)&&(ct.text=ke.tickprefix+ct.text),ke.ticksuffix&&!Mr(ke.showticksuffix)&&(ct.text+=ke.ticksuffix)),ke.tickson==="boundaries"||ke.showdividers){var nr=function(mr){var Pr=ke.l2p(mr);return Pr>=0&&Pr<=ke._length?mr:null};ct.xbnd=[nr(ct.x-.5),nr(ct.x+ke.dtick-.5)]}return ct},re.hoverLabelText=function(ke,Se,nt){nt&&(ke=e.extendFlat({},ke,{hoverformat:nt}));var it=Array.isArray(Se)?Se[0]:Se,ct=Array.isArray(Se)?Se[1]:void 0;if(ct!==void 0&&ct!==it)return re.hoverLabelText(ke,it,nt)+" - "+re.hoverLabelText(ke,ct,nt);var At=ke.type==="log"&&it<=0,dt=re.tickText(ke,ke.c2l(At?-it:it),"hover").text;return At?it===0?"0":P+dt:dt};function vt(ke,Se,nt){var it=ke.tickfont||{};return{x:Se,dx:0,dy:0,text:nt||"",fontSize:it.size,font:it.family,fontColor:it.color}}function Rt(ke,Se,nt,it){var ct=ke._tickround,At=nt&&ke.hoverformat||re.getTickFormat(ke);it&&(v(ct)?ct=4:ct={y:"m",m:"d",d:"M",M:"S",S:4}[ct]);var dt=e.formatDate(Se.x,At,ct,ke._dateFormat,ke.calendar,ke._extraFormat),Tt,Ht=dt.indexOf(`
`);if(Ht!==-1&&(Tt=dt.substr(Ht+1),dt=dt.substr(0,Ht)),it&&(dt==="00:00:00"||dt==="00:00"?(dt=Tt,Tt=""):dt.length===8&&(dt=dt.replace(/:00$/,""))),Tt)if(nt)ct==="d"?dt+=", "+Tt:dt=Tt+(dt?", "+dt:"");else if(!ke._inCalcTicks||ke._prevDateHead!==Tt)ke._prevDateHead=Tt,dt+="<br>"+Tt;else{var ir=wt(ke),kr=ke._trueSide||ke.side;(!ir&&kr==="top"||ir&&kr==="bottom")&&(dt+="<br> ")}Se.text=dt}function rr(ke,Se,nt,it,ct){var At=ke.dtick,dt=Se.x,Tt=ke.tickformat,Ht=typeof At=="string"&&At.charAt(0);if(ct==="never"&&(ct=""),it&&Ht!=="L"&&(At="L3",Ht="L"),Tt||Ht==="L")Se.text=Ae(Math.pow(10,dt),ke,ct,it);else if(v(At)||Ht==="D"&&e.mod(dt+.01,1)<.1){var ir=Math.round(dt),kr=Math.abs(ir),br=ke.exponentformat;br==="power"||qe(br)&&Ve(ir)?(ir===0?Se.text=1:ir===1?Se.text="10":Se.text="10<sup>"+(ir>1?"":P)+kr+"</sup>",Se.fontSize*=1.25):(br==="e"||br==="E")&&kr>2?Se.text="1"+br+(ir>0?"+":P)+kr:(Se.text=Ae(Math.pow(10,dt),ke,"","fakehover"),At==="D1"&&ke._id.charAt(0)==="y"&&(Se.dy-=Se.fontSize/6))}else if(Ht==="D")Se.text=String(Math.round(Math.pow(10,e.mod(dt,1)))),Se.fontSize*=.75;else throw"unrecognized dtick "+String(At);if(ke.dtick==="D1"){var Mr=String(Se.text).charAt(0);(Mr==="0"||Mr==="1")&&(ke._id.charAt(0)==="y"?Se.dx-=Se.fontSize/4:(Se.dy+=Se.fontSize/2,Se.dx+=(ke.range[1]>ke.range[0]?1:-1)*Se.fontSize*(dt<0?.5:.25)))}}function Lt(ke,Se){var nt=ke._categories[Math.round(Se.x)];nt===void 0&&(nt=""),Se.text=String(nt)}function Ft(ke,Se,nt){var it=Math.round(Se.x),ct=ke._categories[it]||[],At=ct[1]===void 0?"":String(ct[1]),dt=ct[0]===void 0?"":String(ct[0]);nt?Se.text=dt+" - "+At:(Se.text=At,Se.text2=dt)}function Gt(ke,Se,nt,it,ct){ct==="never"?ct="":ke.showexponent==="all"&&Math.abs(Se.x/ke.dtick)<1e-6&&(ct="hide"),Se.text=Ae(Se.x,ke,ct,it)}function Dt(ke,Se,nt,it,ct){if(ke.thetaunit==="radians"&&!nt){var At=Se.x/180;if(At===0)Se.text="0";else{var dt=kt(At);if(dt[1]>=100)Se.text=Ae(e.deg2rad(Se.x),ke,ct,it);else{var Tt=Se.x<0;dt[1]===1?dt[0]===1?Se.text="\u03C0":Se.text=dt[0]+"\u03C0":Se.text=["<sup>",dt[0],"</sup>","\u2044","<sub>",dt[1],"</sub>","\u03C0"].join(""),Tt&&(Se.text=P+Se.text)}}}else Se.text=Ae(Se.x,ke,ct,it)}function kt(ke){function Se(Tt,Ht){return Math.abs(Tt-Ht)<=1e-6}function nt(Tt,Ht){return Se(Ht,0)?Tt:nt(Ht,Tt%Ht)}function it(Tt){for(var Ht=1;!Se(Math.round(Tt*Ht)/Ht,Tt);)Ht*=10;return Ht}var ct=it(ke),At=ke*ct,dt=Math.abs(nt(At,ct));return[Math.round(At/dt),Math.round(ct/dt)]}var Ue=["f","p","n","\u03BC","m","","k","M","G","T"];function qe(ke){return ke==="SI"||ke==="B"}function Ve(ke){return ke>14||ke<-15}function Ae(ke,Se,nt,it){var ct=ke<0,At=Se._tickround,dt=nt||Se.exponentformat||"B",Tt=Se._tickexponent,Ht=re.getTickFormat(Se),ir=Se.separatethousands;if(it){var kr={exponentformat:dt,minexponent:Se.minexponent,dtick:Se.showexponent==="none"?Se.dtick:v(ke)&&Math.abs(ke)||1,range:Se.showexponent==="none"?Se.range.map(Se.r2d):[0,ke||1]};He(kr),At=(Number(kr._tickround)||0)+4,Tt=kr._tickexponent,Se.hoverformat&&(Ht=Se.hoverformat)}if(Ht)return Se._numFormat(Ht)(ke).replace(/-/g,P);var br=Math.pow(10,-At)/2;if(dt==="none"&&(Tt=0),ke=Math.abs(ke),ke<br)ke="0",ct=!1;else{if(ke+=br,Tt&&(ke*=Math.pow(10,-Tt),At+=Tt),At===0)ke=String(Math.floor(ke));else if(At<0){ke=String(Math.round(ke)),ke=ke.substr(0,ke.length+At);for(var Mr=At;Mr<0;Mr++)ke+="0"}else{ke=String(ke);var Hr=ke.indexOf(".")+1;Hr&&(ke=ke.substr(0,Hr+At).replace(/\.?0+$/,""))}ke=e.numSeparate(ke,Se._separators,ir)}if(Tt&&dt!=="hide"){qe(dt)&&Ve(Tt)&&(dt="power");var nr;Tt<0?nr=P+-Tt:dt!=="power"?nr="+"+Tt:nr=String(Tt),dt==="e"||dt==="E"?ke+=dt+nr:dt==="power"?ke+="\xD710<sup>"+nr+"</sup>":dt==="B"&&Tt===9?ke+="B":qe(dt)&&(ke+=Ue[Tt/3+5])}return ct?P+ke:ke}re.getTickFormat=function(ke){var Se;function nt(Ht){return typeof Ht!="string"?Ht:Number(Ht.replace("M",""))*A}function it(Ht,ir){var kr=["L","D"];if(typeof Ht==typeof ir){if(typeof Ht=="number")return Ht-ir;var br=kr.indexOf(Ht.charAt(0)),Mr=kr.indexOf(ir.charAt(0));return br===Mr?Number(Ht.replace(/(L|D)/g,""))-Number(ir.replace(/(L|D)/g,"")):br-Mr}else return typeof Ht=="number"?1:-1}function ct(Ht,ir,kr){var br=kr||function(nr){return nr},Mr=ir[0],Hr=ir[1];return(!Mr&&typeof Mr!="number"||br(Mr)<=br(Ht))&&(!Hr&&typeof Hr!="number"||br(Hr)>=br(Ht))}function At(Ht,ir){var kr=ir[0]===null,br=ir[1]===null,Mr=it(Ht,ir[0])>=0,Hr=it(Ht,ir[1])<=0;return(kr||Mr)&&(br||Hr)}var dt,Tt;if(ke.tickformatstops&&ke.tickformatstops.length>0)switch(ke.type){case"date":case"linear":{for(Se=0;Se<ke.tickformatstops.length;Se++)if(Tt=ke.tickformatstops[Se],Tt.enabled&&ct(ke.dtick,Tt.dtickrange,nt)){dt=Tt;break}break}case"log":{for(Se=0;Se<ke.tickformatstops.length;Se++)if(Tt=ke.tickformatstops[Se],Tt.enabled&&At(ke.dtick,Tt.dtickrange)){dt=Tt;break}break}}return dt?dt.value:ke.tickformat},re.getSubplots=function(ke,Se){var nt=ke._fullLayout._subplots,it=nt.cartesian.concat(nt.gl2d||[]),ct=Se?re.findSubplotsWithAxis(it,Se):it;return ct.sort(function(At,dt){var Tt=At.substr(1).split("y"),Ht=dt.substr(1).split("y");return Tt[0]===Ht[0]?+Tt[1]-+Ht[1]:+Tt[0]-+Ht[0]}),ct},re.findSubplotsWithAxis=function(ke,Se){for(var nt=new RegExp(Se._id.charAt(0)==="x"?"^"+Se._id+"y":Se._id+"$"),it=[],ct=0;ct<ke.length;ct++){var At=ke[ct];nt.test(At)&&it.push(At)}return it},re.makeClipPaths=function(ke){var Se=ke._fullLayout;if(!Se._hasOnlyLargeSploms){var nt={_offset:0,_length:Se.width,_id:""},it={_offset:0,_length:Se.height,_id:""},ct=re.list(ke,"x",!0),At=re.list(ke,"y",!0),dt=[],Tt,Ht;for(Tt=0;Tt<ct.length;Tt++)for(dt.push({x:ct[Tt],y:it}),Ht=0;Ht<At.length;Ht++)Tt===0&&dt.push({x:nt,y:At[Ht]}),dt.push({x:ct[Tt],y:At[Ht]});var ir=Se._clips.selectAll(".axesclip").data(dt,function(kr){return kr.x._id+kr.y._id});ir.enter().append("clipPath").classed("axesclip",!0).attr("id",function(kr){return"clip"+Se._uid+kr.x._id+kr.y._id}).append("rect"),ir.exit().remove(),ir.each(function(kr){w.select(this).select("rect").attr({x:kr.x._offset||0,y:kr.y._offset||0,width:kr.x._length||1,height:kr.y._length||1})})}},re.draw=function(ke,Se,nt){var it=ke._fullLayout;Se==="redraw"&&it._paper.selectAll("g.subplot").each(function(At){var dt=At[0],Tt=it._plots[dt];if(Tt){var Ht=Tt.xaxis,ir=Tt.yaxis;Tt.xaxislayer.selectAll("."+Ht._id+"tick").remove(),Tt.yaxislayer.selectAll("."+ir._id+"tick").remove(),Tt.xaxislayer.selectAll("."+Ht._id+"tick2").remove(),Tt.yaxislayer.selectAll("."+ir._id+"tick2").remove(),Tt.xaxislayer.selectAll("."+Ht._id+"divider").remove(),Tt.yaxislayer.selectAll("."+ir._id+"divider").remove(),Tt.minorGridlayer&&Tt.minorGridlayer.selectAll("path").remove(),Tt.gridlayer&&Tt.gridlayer.selectAll("path").remove(),Tt.zerolinelayer&&Tt.zerolinelayer.selectAll("path").remove(),it._infolayer.select(".g-"+Ht._id+"title").remove(),it._infolayer.select(".g-"+ir._id+"title").remove()}});var ct=!Se||Se==="redraw"?re.listIds(ke):Se;return e.syncOrAsync(ct.map(function(At){return function(){if(!!At){var dt=re.getFromId(ke,At),Tt=re.drawOne(ke,dt,nt);return dt._r=dt.range.slice(),dt._rl=e.simpleMap(dt._r,dt.r2l),Tt}}}))},re.drawOne=function(ke,Se,nt){nt=nt||{};var it,ct,At;Se.setScale();var dt=ke._fullLayout,Tt=Se._id,Ht=Tt.charAt(0),ir=re.counterLetter(Tt),kr=dt._plots[Se._mainSubplot];if(!kr)return;var br=kr[Ht+"axislayer"],Mr=Se._mainLinePosition,Hr=Se._mainMirrorPosition,nr=Se._vals=re.calcTicks(Se),mr=[Se.mirror,Mr,Hr].join("_");for(it=0;it<nr.length;it++)nr[it].axInfo=mr;Se._selections={},Se._tickAngles&&(Se._prevTickAngles=Se._tickAngles),Se._tickAngles={},Se._depth=null;var Pr={};function Nr(Bt){var hr=Tt+(Bt||"tick");return Pr[hr]||(Pr[hr]=mt(Se,hr)),Pr[hr]}if(!!Se.visible){var Sr=re.makeTransTickFn(Se),tt=re.makeTransTickLabelFn(Se),Et,Vt,ar=Se.ticks==="inside",Cr=Se.ticks==="outside";if(Se.tickson==="boundaries"){var Or=Xe(Se,nr);Vt=re.clipEnds(Se,Or),Et=ar?Vt:Or}else Vt=re.clipEnds(Se,nr),Et=ar&&Se.ticklabelmode!=="period"?Vt:nr;var Ir=Se._gridVals=Vt,Tr=_t(Se,nr);if(!dt._hasOnlyLargeSploms){var Wr=Se._subplotsWith,wn={};for(it=0;it<Wr.length;it++){ct=Wr[it],At=dt._plots[ct];var ln=At[ir+"axis"],Bn=ln._mainAxis._id;if(!wn[Bn]){wn[Bn]=1;var Cn=Ht==="x"?"M0,"+ln._offset+"v"+ln._length:"M"+ln._offset+",0h"+ln._length;re.drawGrid(ke,Se,{vals:Ir,counterAxis:ln,layer:At.gridlayer.select("."+Tt),minorLayer:At.minorGridlayer.select("."+Tt),path:Cn,transFn:Sr}),re.drawZeroLine(ke,Se,{counterAxis:ln,layer:At.zerolinelayer,path:Cn,transFn:Sr})}}}var Wn,Hn=re.getTickSigns(Se),ga=re.getTickSigns(Se,"minor");if(Se.ticks||Se.minor&&Se.minor.ticks){var La=re.makeTickPath(Se,Mr,Hn[2]),ci=re.makeTickPath(Se,Mr,ga[2],{minor:!0}),Va,ja,Wa,wr;if(Se._anchorAxis&&Se.mirror&&Se.mirror!==!0?(Va=re.makeTickPath(Se,Hr,Hn[3]),ja=re.makeTickPath(Se,Hr,ga[3],{minor:!0}),Wa=La+Va,wr=ci+ja):(Va="",ja="",Wa=La,wr=ci),Se.showdividers&&Cr&&Se.tickson==="boundaries"){var pn={};for(it=0;it<Tr.length;it++)pn[Tr[it].x]=1;Wn=function(Bt){return pn[Bt.x]?Va:Wa}}else Wn=function(Bt){return Bt.minor?wr:Wa}}if(re.drawTicks(ke,Se,{vals:Et,layer:br,path:Wn,transFn:Sr}),Se.mirror==="allticks"){var fn=Object.keys(Se._linepositions||{});for(it=0;it<fn.length;it++){ct=fn[it],At=dt._plots[ct];var An=Se._linepositions[ct]||[],Zn=An[0],ua=An[1],ea=An[2],Rn=re.makeTickPath(Se,Zn,ea?Hn[0]:ga[0],{minor:ea})+re.makeTickPath(Se,ua,ea?Hn[1]:ga[1],{minor:ea});re.drawTicks(ke,Se,{vals:Et,layer:At[Ht+"axislayer"],path:Rn,transFn:Sr})}}var Xn=[];if(Xn.push(function(){return re.drawLabels(ke,Se,{vals:nr,layer:br,plotinfo:At,transFn:tt,labelFns:re.makeLabelFns(Se,Mr)})}),Se.type==="multicategory"){var Ua={x:2,y:10}[Ht];Xn.push(function(){var Bt={x:"height",y:"width"}[Ht],hr=Nr()[Bt]+Ua+(Se._tickAngles[Tt+"tick"]?Se.tickfont.size*Y:0);return re.drawLabels(ke,Se,{vals:Je(Se,nr),layer:br,cls:Tt+"tick2",repositionOnUpdate:!0,secondary:!0,transFn:Sr,labelFns:re.makeLabelFns(Se,Mr+hr*Hn[4])})}),Xn.push(function(){return Se._depth=Hn[4]*(Nr("tick2")[Se.side]-Mr),Wt(ke,Se,{vals:Tr,layer:br,path:re.makeTickPath(Se,Mr,Hn[4],{len:Se._depth}),transFn:Sr})})}else Se.title.hasOwnProperty("standoff")&&Xn.push(function(){Se._depth=Hn[4]*(Nr()[Se.side]-Mr)});var li=M.getComponentMethod("rangeslider","isVisible")(Se);return Xn.push(function(){var Bt=Se.side.charAt(0),hr=Z[Se.side].charAt(0),rn=re.getPxPosition(ke,Se),vn=Cr?Se.ticklen:0,en,Tn,xn,un;if((Se.automargin||li)&&(Se.type==="multicategory"?en=Nr("tick2"):(en=Nr(),Ht==="x"&&Bt==="b"&&(Se._depth=Math.max(en.width>0?en.bottom-rn:0,vn)))),Se.automargin){Tn={x:0,y:0,r:0,l:0,t:0,b:0};var gr=[0,1];if(Ht==="x"){if(Bt==="b"?Tn[Bt]=Se._depth:(Tn[Bt]=Se._depth=Math.max(en.width>0?rn-en.top:0,vn),gr.reverse()),en.width>0){var yr=en.right-(Se._offset+Se._length);yr>0&&(Tn.xr=1,Tn.r=yr);var zr=Se._offset-en.left;zr>0&&(Tn.xl=0,Tn.l=zr)}}else if(Bt==="l"?Tn[Bt]=Se._depth=Math.max(en.height>0?rn-en.left:0,vn):(Tn[Bt]=Se._depth=Math.max(en.height>0?en.right-rn:0,vn),gr.reverse()),en.height>0){var gn=en.bottom-(Se._offset+Se._length);gn>0&&(Tn.yb=0,Tn.b=gn);var On=Se._offset-en.top;On>0&&(Tn.yt=1,Tn.t=On)}Tn[ir]=Se.anchor==="free"?Se.position:Se._anchorAxis.domain[gr[0]],Se.title.text!==dt._dfltTitle[Ht]&&(Tn[Bt]+=qt(Se)+(Se.title.standoff||0)),Se.mirror&&Se.anchor!=="free"&&(xn={x:0,y:0,r:0,l:0,t:0,b:0},xn[hr]=Se.linewidth,Se.mirror&&Se.mirror!==!0&&(xn[hr]+=vn),Se.mirror===!0||Se.mirror==="ticks"?xn[ir]=Se._anchorAxis.domain[gr[1]]:(Se.mirror==="all"||Se.mirror==="allticks")&&(xn[ir]=[Se._counterDomainMin,Se._counterDomainMax][gr[1]]))}li&&(un=M.getComponentMethod("rangeslider","autoMarginOpts")(ke,Se)),typeof Se.automargin=="string"&&(Ne(Tn,Se.automargin),Ne(xn,Se.automargin)),S.autoMargin(ke,at(Se),Tn),S.autoMargin(ke,Jt(Se),xn),S.autoMargin(ke,Zt(Se),un)}),!nt.skipTitle&&!(li&&Se.side==="bottom")&&Xn.push(function(){return Yt(ke,Se)}),e.syncOrAsync(Xn)}};function Ne(ke,Se){if(!!ke){var nt=Object.keys(H).reduce(function(it,ct){return Se.indexOf(ct)!==-1&&H[ct].forEach(function(At){it[At]=1}),it},{});Object.keys(ke).forEach(function(it){nt[it]||(it.length===1?ke[it]=0:delete ke[it])})}}function Xe(ke,Se){var nt=[],it,ct=function(At,dt){var Tt=At.xbnd[dt];Tt!==null&&nt.push(e.extendFlat({},At,{x:Tt}))};if(Se.length){for(it=0;it<Se.length;it++)ct(Se[it],0);ct(Se[it-1],1)}return nt}function Je(ke,Se){for(var nt=[],it={},ct=0;ct<Se.length;ct++){var At=Se[ct];it[At.text2]?it[At.text2].push(At.x):it[At.text2]=[At.x]}for(var dt in it)nt.push(vt(ke,e.interp(it[dt],.5),dt));return nt}function _t(ke,Se){var nt=[],it,ct,At=Se.length&&Se[Se.length-1].x<Se[0].x,dt=function(Ht,ir){var kr=Ht.xbnd[ir];kr!==null&&nt.push(e.extendFlat({},Ht,{x:kr}))};if(ke.showdividers&&Se.length){for(it=0;it<Se.length;it++){var Tt=Se[it];Tt.text2!==ct&&dt(Tt,At?1:0),ct=Tt.text2}dt(Se[it-1],At?0:1)}return nt}function mt(ke,Se){var nt,it,ct,At;return ke._selections[Se].size()?(nt=1/0,it=-1/0,ct=1/0,At=-1/0,ke._selections[Se].each(function(){var dt=Qr(this),Tt=c.bBox(dt.node().parentNode);nt=Math.min(nt,Tt.top),it=Math.max(it,Tt.bottom),ct=Math.min(ct,Tt.left),At=Math.max(At,Tt.right)})):(nt=0,it=0,ct=0,At=0),{top:nt,bottom:it,left:ct,right:At,height:it-nt,width:At-ct}}re.getTickSigns=function(ke,Se){var nt=ke._id.charAt(0),it={x:"top",y:"right"}[nt],ct=ke.side===it?1:-1,At=[-1,1,ct,-ct],dt=Se?(ke.minor||{}).ticks:ke.ticks;return dt!=="inside"==(nt==="x")&&(At=At.map(function(Tt){return-Tt})),ke.side&&At.push({l:-1,t:-1,r:1,b:1}[ke.side.charAt(0)]),At},re.makeTransTickFn=function(ke){return ke._id.charAt(0)==="x"?function(Se){return a(ke._offset+ke.l2p(Se.x),0)}:function(Se){return a(0,ke._offset+ke.l2p(Se.x))}},re.makeTransTickLabelFn=function(ke){var Se=Kt(ke),nt=Se[0],it=Se[1];return ke._id.charAt(0)==="x"?function(ct){return a(nt+ke._offset+ke.l2p(Ot(ct)),it)}:function(ct){return a(it,nt+ke._offset+ke.l2p(Ot(ct)))}};function Ot(ke){return ke.periodX!==void 0?ke.periodX:ke.x}function Kt(ke){var Se=ke.ticklabelposition||"",nt=function(Hr){return Se.indexOf(Hr)!==-1},it=nt("top"),ct=nt("left"),At=nt("right"),dt=nt("bottom"),Tt=nt("inside"),Ht=dt||ct||it||At;if(!Ht&&!Tt)return[0,0];var ir=ke.side,kr=Ht?(ke.tickwidth||0)/2:0,br=oe,Mr=ke.tickfont?ke.tickfont.size:12;return(dt||it)&&(kr+=Mr*X,br+=(ke.linewidth||0)/2),(ct||At)&&(kr+=(ke.linewidth||0)/2,br+=oe),Tt&&ir==="top"&&(br-=Mr*(1-X)),(ct||it)&&(kr=-kr),(ir==="bottom"||ir==="right")&&(br=-br),[Ht?kr:0,Tt?br:0]}re.makeTickPath=function(ke,Se,nt,it){it||(it={});var ct=it.minor;if(ct&&!ke.minor)return"";var At=it.len!==void 0?it.len:ct?ke.minor.ticklen:ke.ticklen,dt=ke._id.charAt(0),Tt=(ke.linewidth||1)/2;return dt==="x"?"M0,"+(Se+Tt*nt)+"v"+At*nt:"M"+(Se+Tt*nt)+",0h"+At*nt},re.makeLabelFns=function(ke,Se,nt){var it=ke.ticklabelposition||"",ct=function(wn){return it.indexOf(wn)!==-1},At=ct("top"),dt=ct("left"),Tt=ct("right"),Ht=ct("bottom"),ir=Ht||dt||At||Tt,kr=ct("inside"),br=it==="inside"&&ke.ticks==="inside"||!kr&&ke.ticks==="outside"&&ke.tickson!=="boundaries",Mr=0,Hr=0,nr=br?ke.ticklen:0;if(kr?nr*=-1:ir&&(nr=0),br&&(Mr+=nr,nt)){var mr=e.deg2rad(nt);Mr=nr*Math.cos(mr)+1,Hr=nr*Math.sin(mr)}ke.showticklabels&&(br||ke.showline)&&(Mr+=.2*ke.tickfont.size),Mr+=(ke.linewidth||1)/2*(kr?-1:1);var Pr={labelStandoff:Mr,labelShift:Hr},Nr,Sr,tt,Et,Vt=0,ar=ke.side,Cr=ke._id.charAt(0),Or=ke.tickangle,Ir;if(Cr==="x")Ir=!kr&&ar==="bottom"||kr&&ar==="top",Et=Ir?1:-1,kr&&(Et*=-1),Nr=Hr*Et,Sr=Se+Mr*Et,tt=Ir?1:-.2,Math.abs(Or)===90&&(kr?tt+=J:Or===-90&&ar==="bottom"?tt=X:Or===90&&ar==="top"?tt=J:tt=.5,Vt=J/2*(Or/90)),Pr.xFn=function(wn){return wn.dx+Nr+Vt*wn.fontSize},Pr.yFn=function(wn){return wn.dy+Sr+wn.fontSize*tt},Pr.anchorFn=function(wn,ln){if(ir){if(dt)return"end";if(Tt)return"start"}return!v(ln)||ln===0||ln===180?"middle":ln*Et<0!==kr?"end":"start"},Pr.heightFn=function(wn,ln,Bn){return ln<-60||ln>60?-.5*Bn:ke.side==="top"!==kr?-Bn:0};else if(Cr==="y"){if(Ir=!kr&&ar==="left"||kr&&ar==="right",Et=Ir?1:-1,kr&&(Et*=-1),Nr=Mr,Sr=Hr*Et,tt=0,!kr&&Math.abs(Or)===90&&(Or===-90&&ar==="left"||Or===90&&ar==="right"?tt=X:tt=.5),kr){var Tr=v(Or)?+Or:0;if(Tr!==0){var Wr=e.deg2rad(Tr);Vt=Math.abs(Math.sin(Wr))*X*Et,tt=0}}Pr.xFn=function(wn){return wn.dx+Se-(Nr+wn.fontSize*tt)*Et+Vt*wn.fontSize},Pr.yFn=function(wn){return wn.dy+Sr+wn.fontSize*J},Pr.anchorFn=function(wn,ln){return v(ln)&&Math.abs(ln)===90?"middle":Ir?"end":"start"},Pr.heightFn=function(wn,ln,Bn){return ke.side==="right"&&(ln*=-1),ln<-30?-Bn:ln<30?-.5*Bn:0}}return Pr};function Nt(ke){return[ke.text,ke.x,ke.axInfo,ke.font,ke.fontSize,ke.fontColor].join("_")}re.drawTicks=function(ke,Se,nt){nt=nt||{};var it=Se._id+"tick",ct=[].concat(Se.minor&&Se.minor.ticks?nt.vals.filter(function(dt){return dt.minor&&!dt.noTick}):[]).concat(Se.ticks?nt.vals.filter(function(dt){return!dt.minor&&!dt.noTick}):[]),At=nt.layer.selectAll("path."+it).data(ct,Nt);At.exit().remove(),At.enter().append("path").classed(it,1).classed("ticks",1).classed("crisp",nt.crisp!==!1).each(function(dt){return t.stroke(w.select(this),dt.minor?Se.minor.tickcolor:Se.tickcolor)}).style("stroke-width",function(dt){return c.crispRound(ke,dt.minor?Se.minor.tickwidth:Se.tickwidth,1)+"px"}).attr("d",nt.path).style("display",null),Pt(Se,[B]),At.attr("transform",nt.transFn)},re.drawGrid=function(ke,Se,nt){nt=nt||{};var it=Se._id+"grid",ct=Se.minor&&Se.minor.showgrid,At=ct?nt.vals.filter(function(Nr){return Nr.minor}):[],dt=Se.showgrid?nt.vals.filter(function(Nr){return!Nr.minor}):[],Tt=nt.counterAxis;if(Tt&&re.shouldShowZeroLine(ke,Se,Tt))for(var Ht=Se.tickmode==="array",ir=0;ir<dt.length;ir++){var kr=dt[ir].x;if(Ht?!kr:Math.abs(kr)<Se.dtick/100)if(dt=dt.slice(0,ir).concat(dt.slice(ir+1)),Ht)ir--;else break}Se._gw=c.crispRound(ke,Se.gridwidth,1);for(var br=ct?c.crispRound(ke,Se.minor.gridwidth,1):0,Mr=nt.layer,Hr=nt.minorLayer,nr=1;nr>=0;nr--){var mr=nr?Mr:Hr;if(!!mr){var Pr=mr.selectAll("path."+it).data(nr?dt:At,Nt);Pr.exit().remove(),Pr.enter().append("path").classed(it,1).classed("crisp",nt.crisp!==!1),Pr.attr("transform",nt.transFn).attr("d",nt.path).each(function(Nr){return t.stroke(w.select(this),Nr.minor?Se.minor.gridcolor:Se.gridcolor||"#ddd")}).style("stroke-dasharray",function(Nr){return c.dashStyle(Nr.minor?Se.minor.griddash:Se.griddash,Nr.minor?Se.minor.gridwidth:Se.gridwidth)}).style("stroke-width",function(Nr){return(Nr.minor?br:Se._gw)+"px"}).style("display",null),typeof nt.path=="function"&&Pr.attr("d",nt.path)}}Pt(Se,[D,R])},re.drawZeroLine=function(ke,Se,nt){nt=nt||nt;var it=Se._id+"zl",ct=re.shouldShowZeroLine(ke,Se,nt.counterAxis),At=nt.layer.selectAll("path."+it).data(ct?[{x:0,id:Se._id}]:[]);At.exit().remove(),At.enter().append("path").classed(it,1).classed("zl",1).classed("crisp",nt.crisp!==!1).each(function(){nt.layer.selectAll("path").sort(function(dt,Tt){return U(dt.id,Tt.id)})}),At.attr("transform",nt.transFn).attr("d",nt.path).call(t.stroke,Se.zerolinecolor||t.defaultLine).style("stroke-width",c.crispRound(ke,Se.zerolinewidth,Se._gw||1)+"px").style("display",null),Pt(Se,[I])},re.drawLabels=function(ke,Se,nt){nt=nt||{};var it=ke._fullLayout,ct=Se._id,At=ct.charAt(0),dt=nt.cls||ct+"tick",Tt=nt.vals.filter(function(Et){return Et.text}),Ht=nt.labelFns,ir=nt.secondary?0:Se.tickangle,kr=(Se._prevTickAngles||{})[dt],br=nt.layer.selectAll("g."+dt).data(Se.showticklabels?Tt:[],Nt),Mr=[];br.enter().append("g").classed(dt,1).append("text").attr("text-anchor","middle").each(function(Et){var Vt=w.select(this),ar=ke._promises.length;Vt.call(n.positionText,Ht.xFn(Et),Ht.yFn(Et)).call(c.font,Et.font,Et.fontSize,Et.fontColor).text(Et.text).call(n.convertToTspans,ke),ke._promises[ar]?Mr.push(ke._promises.pop().then(function(){Hr(Vt,ir)})):Hr(Vt,ir)}),Pt(Se,[F]),br.exit().remove(),nt.repositionOnUpdate&&br.each(function(Et){w.select(this).select("text").call(n.positionText,Ht.xFn(Et),Ht.yFn(Et))});function Hr(Et,Vt){Et.each(function(ar){var Cr=w.select(this),Or=Cr.select(".text-math-group"),Ir=Ht.anchorFn(ar,Vt),Tr=nt.transFn.call(Cr.node(),ar)+(v(Vt)&&+Vt!=0?" rotate("+Vt+","+Ht.xFn(ar)+","+(Ht.yFn(ar)-ar.fontSize/2)+")":""),Wr=n.lineCount(Cr),wn=Y*ar.fontSize,ln=Ht.heightFn(ar,v(Vt)?+Vt:0,(Wr-1)*wn);if(ln&&(Tr+=a(0,ln)),Or.empty()){var Bn=Cr.select("text");Bn.attr({transform:Tr,"text-anchor":Ir}),Bn.style("opacity",1),Se._adjustTickLabelsOverflow&&Se._adjustTickLabelsOverflow()}else{var Cn=c.bBox(Or.node()).width,Wn=Cn*{end:-.5,start:.5}[Ir];Or.attr("transform",Tr+a(Wn,0))}})}Se._adjustTickLabelsOverflow=function(){var Et=Se.ticklabeloverflow;if(!(!Et||Et==="allow")){var Vt=Et.indexOf("hide")!==-1,ar=Se._id.charAt(0)==="x",Cr=0,Or=ar?ke._fullLayout.width:ke._fullLayout.height;if(Et.indexOf("domain")!==-1){var Ir=e.simpleMap(Se.range,Se.r2l);Cr=Se.l2p(Ir[0])+Se._offset,Or=Se.l2p(Ir[1])+Se._offset}var Tr=Math.min(Cr,Or),Wr=Math.max(Cr,Or),wn=Se.side,ln=1/0,Bn=-1/0;br.each(function(ga){var La=w.select(this),ci=La.select(".text-math-group");if(ci.empty()){var Va=c.bBox(La.node()),ja=0;ar?(Va.right>Wr||Va.left<Tr)&&(ja=1):(Va.bottom>Wr||Va.top+(Se.tickangle?0:ga.fontSize/4)<Tr)&&(ja=1);var Wa=La.select("text");ja?Vt&&Wa.style("opacity",0):(Wa.style("opacity",1),wn==="bottom"||wn==="right"?ln=Math.min(ln,ar?Va.top:Va.left):ln=-1/0,wn==="top"||wn==="left"?Bn=Math.max(Bn,ar?Va.bottom:Va.right):Bn=1/0)}});for(var Cn in it._plots){var Wn=it._plots[Cn];if(!(Se._id!==Wn.xaxis._id&&Se._id!==Wn.yaxis._id)){var Hn=ar?Wn.yaxis:Wn.xaxis;Hn&&(Hn["_visibleLabelMin_"+Se._id]=ln,Hn["_visibleLabelMax_"+Se._id]=Bn)}}}},Se._hideCounterAxisInsideTickLabels=function(Et){var Vt=Se._id.charAt(0)==="x",ar=[];for(var Cr in it._plots){var Or=it._plots[Cr];Se._id!==Or.xaxis._id&&Se._id!==Or.yaxis._id||ar.push(Vt?Or.yaxis:Or.xaxis)}ar.forEach(function(Ir,Tr){Ir&&wt(Ir)&&(Et||[I,R,D,B,F]).forEach(function(Wr){var wn=Wr.K==="tick"&&Wr.L==="text"&&Se.ticklabelmode==="period",ln=it._plots[Se._mainSubplot],Bn;Wr.K===I.K?Bn=ln.zerolinelayer.selectAll("."+Se._id+"zl"):Wr.K===R.K?Bn=ln.minorGridlayer.selectAll("."+Se._id):Wr.K===D.K?Bn=ln.gridlayer.selectAll("."+Se._id):Bn=ln[Se._id.charAt(0)+"axislayer"],Bn.each(function(){var Cn=w.select(this);Wr.L&&(Cn=Cn.selectAll(Wr.L)),Cn.each(function(Wn){var Hn=Se.l2p(wn?Ot(Wn):Wn.x)+Se._offset,ga=w.select(this);Hn<Se["_visibleLabelMax_"+Ir._id]&&Hn>Se["_visibleLabelMin_"+Ir._id]?ga.style("display","none"):Wr.K==="tick"&&!Tr&&ga.style("display",null)})})})})},Hr(br,kr+1?kr:ir);function nr(){return Mr.length&&Promise.all(Mr)}var mr=null;function Pr(){if(Hr(br,ir),Tt.length&&At==="x"&&!v(ir)&&(Se.type!=="log"||String(Se.dtick).charAt(0)!=="D")){mr=0;var Et=0,Vt=[],ar;if(br.each(function(Va){Et=Math.max(Et,Va.fontSize);var ja=Se.l2p(Va.x),Wa=Qr(this),wr=c.bBox(Wa.node());Vt.push({top:0,bottom:10,height:10,left:ja-wr.width/2,right:ja+wr.width/2+2,width:wr.width+2})}),(Se.tickson==="boundaries"||Se.showdividers)&&!nt.secondary){var Cr=2;for(Se.ticks&&(Cr+=Se.tickwidth/2),ar=0;ar<Vt.length;ar++){var Or=Tt[ar].xbnd,Ir=Vt[ar];if(Or[0]!==null&&Ir.left-Se.l2p(Or[0])<Cr||Or[1]!==null&&Se.l2p(Or[1])-Ir.right<Cr){mr=90;break}}}else{var Tr=Tt.length,Wr=Math.abs((Tt[Tr-1].x-Tt[0].x)*Se._m)/(Tr-1),wn=Se.ticklabelposition||"",ln=function(Va){return wn.indexOf(Va)!==-1},Bn=ln("top"),Cn=ln("left"),Wn=ln("right"),Hn=ln("bottom"),ga=Hn||Cn||Bn||Wn,La=ga?(Se.tickwidth||0)+2*oe:0,ci=Wr<Et*2.5||Se.type==="multicategory"||Se._name==="realaxis";for(ar=0;ar<Vt.length-1;ar++)if(e.bBoxIntersect(Vt[ar],Vt[ar+1],La)){mr=ci?90:30;break}}mr&&Hr(br,mr)}}Se._selections&&(Se._selections[dt]=br);var Nr=[nr];Se.automargin&&it._redrawFromAutoMarginCount&&kr===90?(mr=90,Nr.push(function(){Hr(br,kr)})):Nr.push(Pr),Se._tickAngles&&Nr.push(function(){Se._tickAngles[dt]=mr===null?v(ir)?ir:0:mr});var Sr=Se._anchorAxis;Sr&&Sr.autorange&&wt(Se)&&!q(it,Se._id)&&(it._insideTickLabelsAutorange||(it._insideTickLabelsAutorange={}),it._insideTickLabelsAutorange[Sr._name+".autorange"]=Sr.autorange,Nr.push(function(){br.each(function(Vt,ar){var Cr=Qr(this),Or=Cr.select(".text-math-group");Or.empty()&&(Se._vals[ar].bb=c.bBox(Cr.node()))})}));var tt=e.syncOrAsync(Nr);return tt&&tt.then&&ke._promises.push(tt),tt};function Wt(ke,Se,nt){var it=Se._id+"divider",ct=nt.vals,At=nt.layer.selectAll("path."+it).data(ct,Nt);At.exit().remove(),At.enter().insert("path",":first-child").classed(it,1).classed("crisp",1).call(t.stroke,Se.dividercolor).style("stroke-width",c.crispRound(ke,Se.dividerwidth,1)+"px"),At.attr("transform",nt.transFn).attr("d",nt.path)}re.getPxPosition=function(ke,Se){var nt=ke._fullLayout._size,it=Se._id.charAt(0),ct=Se.side,At;if(Se.anchor!=="free"?At=Se._anchorAxis:it==="x"?At={_offset:nt.t+(1-(Se.position||0))*nt.h,_length:0}:it==="y"&&(At={_offset:nt.l+(Se.position||0)*nt.w,_length:0}),ct==="top"||ct==="left")return At._offset;if(ct==="bottom"||ct==="right")return At._offset+At._length};function qt(ke){var Se=ke.title.font.size,nt=(ke.title.text.match(n.BR_TAG_ALL)||[]).length;return ke.title.hasOwnProperty("standoff")?nt?Se*(X+nt*Y):Se*X:nt?Se*(nt+1)*Y:Se}function Yt(ke,Se){var nt=ke._fullLayout,it=Se._id,ct=it.charAt(0),At=Se.title.font.size,dt;if(Se.title.hasOwnProperty("standoff"))dt=Se._depth+Se.title.standoff+qt(Se);else{var Tt=wt(Se);if(Se.type==="multicategory")dt=Se._depth;else{var Ht=1.5*At;Tt&&(Ht=.5*At,Se.ticks==="outside"&&(Ht+=Se.ticklen)),dt=10+Ht+(Se.linewidth?Se.linewidth-1:0)}Tt||(ct==="x"?dt+=Se.side==="top"?At*(Se.showticklabels?1:0):At*(Se.showticklabels?1.5:.5):dt+=Se.side==="right"?At*(Se.showticklabels?1:.5):At*(Se.showticklabels?.5:0))}var ir=re.getPxPosition(ke,Se),kr,br,Mr;ct==="x"?(br=Se._offset+Se._length/2,Mr=Se.side==="top"?ir-dt:ir+dt):(Mr=Se._offset+Se._length/2,br=Se.side==="right"?ir+dt:ir-dt,kr={rotate:"-90",offset:0});var Hr;if(Se.type!=="multicategory"){var nr=Se._selections[Se._id+"tick"];if(Hr={selection:nr,side:Se.side},nr&&nr.node()&&nr.node().parentNode){var mr=c.getTranslate(nr.node().parentNode);Hr.offsetLeft=mr.x,Hr.offsetTop=mr.y}Se.title.hasOwnProperty("standoff")&&(Hr.pad=0)}return r.draw(ke,it+"title",{propContainer:Se,propName:Se._name+".title.text",placeholder:nt._dfltTitle[ct],avoid:Hr,transform:kr,attributes:{x:br,y:Mr,"text-anchor":"middle"}})}re.shouldShowZeroLine=function(ke,Se,nt){var it=e.simpleMap(Se.range,Se.r2l);return it[0]*it[1]<=0&&Se.zeroline&&(Se.type==="linear"||Se.type==="-")&&!(Se.rangebreaks&&Se.maskBreaks(0)===z)&&(fr(Se,0)||!Yr(ke,Se,nt,it)||hn(ke,Se))},re.clipEnds=function(ke,Se){return Se.filter(function(nt){return fr(ke,nt.x)})};function fr(ke,Se){var nt=ke.l2p(Se);return nt>1&&nt<ke._length-1}function Yr(ke,Se,nt,it){var ct=nt._mainAxis;if(!ct)return;var At=ke._fullLayout,dt=Se._id.charAt(0),Tt=re.counterLetter(Se._id),Ht=Se._offset+(Math.abs(it[0])<Math.abs(it[1])==(dt==="x")?0:Se._length);function ir(nr){if(!nr.showline||!nr.linewidth)return!1;var mr=Math.max((nr.linewidth+Se.zerolinewidth)/2,1);function Pr(tt){return typeof tt=="number"&&Math.abs(tt-Ht)<mr}if(Pr(nr._mainLinePosition)||Pr(nr._mainMirrorPosition))return!0;var Nr=nr._linepositions||{};for(var Sr in Nr)if(Pr(Nr[Sr][0])||Pr(Nr[Sr][1]))return!0}var kr=At._plots[nt._mainSubplot];if(!(kr.mainplotinfo||kr).overlays.length)return ir(nt);for(var br=re.list(ke,Tt),Mr=0;Mr<br.length;Mr++){var Hr=br[Mr];if(Hr._mainAxis===ct&&ir(Hr))return!0}}function hn(ke,Se){for(var nt=ke._fullData,it=Se._mainSubplot,ct=Se._id.charAt(0),At=0;At<nt.length;At++){var dt=nt[At];if(dt.visible===!0&&dt.xaxis+dt.yaxis===it&&(M.traceIs(dt,"bar-like")&&dt.orientation==={x:"h",y:"v"}[ct]||dt.fill&&dt.fill.charAt(dt.fill.length-1)===ct))return!0}return!1}function Qr(ke){var Se=w.select(ke),nt=Se.select(".text-math-group");return nt.empty()?Se.select("text"):nt}re.allowAutoMargin=function(ke){for(var Se=re.list(ke,"",!0),nt=0;nt<Se.length;nt++){var it=Se[nt];it.automargin&&(S.allowAutoMargin(ke,at(it)),it.mirror&&S.allowAutoMargin(ke,Jt(it))),M.getComponentMethod("rangeslider","isVisible")(it)&&S.allowAutoMargin(ke,Zt(it))}};function at(ke){return ke._id+".automargin"}function Jt(ke){return at(ke)+".mirror"}function Zt(ke){return ke._id+".rangeslider"}re.swap=function(ke,Se){for(var nt=Ut(ke,Se),it=0;it<nt.length;it++)rt(ke,nt[it].x,nt[it].y)};function Ut(ke,Se){var nt=[],it,ct;for(it=0;it<Se.length;it++){var At=[],dt=ke._fullData[Se[it]].xaxis,Tt=ke._fullData[Se[it]].yaxis;if(!(!dt||!Tt)){for(ct=0;ct<nt.length;ct++)(nt[ct].x.indexOf(dt)!==-1||nt[ct].y.indexOf(Tt)!==-1)&&At.push(ct);if(!At.length){nt.push({x:[dt],y:[Tt]});continue}var Ht=nt[At[0]],ir;if(At.length>1)for(ct=1;ct<At.length;ct++)ir=nt[At[ct]],_r(Ht.x,ir.x),_r(Ht.y,ir.y);_r(Ht.x,[dt]),_r(Ht.y,[Tt])}}return nt}function _r(ke,Se){for(var nt=0;nt<Se.length;nt++)ke.indexOf(Se[nt])===-1&&ke.push(Se[nt])}function rt(ke,Se,nt){var it=[],ct=[],At=ke.layout,dt,Tt;for(dt=0;dt<Se.length;dt++)it.push(re.getFromId(ke,Se[dt]));for(dt=0;dt<nt.length;dt++)ct.push(re.getFromId(ke,nt[dt]));var Ht=Object.keys(o),ir=["anchor","domain","overlaying","position","side","tickangle","editType"],kr=["linear","log"];for(dt=0;dt<Ht.length;dt++){var br=Ht[dt],Mr=it[0][br],Hr=ct[0][br],nr=!0,mr=!1,Pr=!1;if(!(br.charAt(0)==="_"||typeof Mr=="function"||ir.indexOf(br)!==-1)){for(Tt=1;Tt<it.length&&nr;Tt++){var Nr=it[Tt][br];br==="type"&&kr.indexOf(Mr)!==-1&&kr.indexOf(Nr)!==-1&&Mr!==Nr?mr=!0:Nr!==Mr&&(nr=!1)}for(Tt=1;Tt<ct.length&&nr;Tt++){var Sr=ct[Tt][br];br==="type"&&kr.indexOf(Hr)!==-1&&kr.indexOf(Sr)!==-1&&Hr!==Sr?Pr=!0:ct[Tt][br]!==Hr&&(nr=!1)}nr&&(mr&&(At[it[0]._name].type="linear"),Pr&&(At[ct[0]._name].type="linear"),Ke(At,br,it,ct,ke._fullLayout._dfltTitle))}}for(dt=0;dt<ke._fullLayout.annotations.length;dt++){var tt=ke._fullLayout.annotations[dt];Se.indexOf(tt.xref)!==-1&&nt.indexOf(tt.yref)!==-1&&e.swapAttrs(At.annotations[dt],["?"])}}function Ke(ke,Se,nt,it,ct){var At=e.nestedProperty,dt=At(ke[nt[0]._name],Se).get(),Tt=At(ke[it[0]._name],Se).get(),Ht;for(Se==="title"&&(dt&&dt.text===ct.x&&(dt.text=ct.y),Tt&&Tt.text===ct.y&&(Tt.text=ct.x)),Ht=0;Ht<nt.length;Ht++)At(ke,nt[Ht]._name+"."+Se).set(Tt);for(Ht=0;Ht<it.length;Ht++)At(ke,it[Ht]._name+"."+Se).set(dt)}function st(ke){return ke._id==="angularaxis"}function lt(ke,Se){for(var nt=Se._rangebreaks.length,it=0;it<nt;it++){var ct=Se._rangebreaks[it];if(ke>=ct.min&&ke<ct.max)return ct.max}return ke}function wt(ke){return(ke.ticklabelposition||"").indexOf("inside")!==-1}function Pt(ke,Se){wt(ke._anchorAxis||{})&&ke._hideCounterAxisInsideTickLabels&&ke._hideCounterAxisInsideTickLabels(Se)}},{"../../components/color":367,"../../components/drawing":389,"../../components/titles":476,"../../constants/alignment":483,"../../constants/numerical":491,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/plots":628,"../../registry":647,"./autorange":565,"./axis_autotype":567,"./axis_ids":570,"./clean_ticks":572,"./layout_attributes":579,"./set_convert":585,"@plotly/d3":58,"fast-isnumeric":190}],567:[function(d,ee,te){var w=d("fast-isnumeric"),v=d("../../lib"),S=d("../../constants/numerical").BADNUM,M=v.isArrayOrTypedArray,e=v.isDateTime,a=v.cleanNumber,n=Math.round;ee.exports=function(g,h,m){var u=g,_=m.noMultiCategory;if(M(u)&&!u.length)return"-";if(!_&&y(u))return"multicategory";if(_&&Array.isArray(u[0])){for(var s=[],A=0;A<u.length;A++)if(M(u[A]))for(var b=0;b<u[A].length;b++)s.push(u[A][b]);u=s}if(c(u,h))return"date";var f=m.autotypenumbers!=="strict";return i(u,f)?"category":t(u,f)?"linear":"-"};function r(p,g){return g?w(p):typeof p=="number"}function t(p,g){for(var h=p.length,m=0;m<h;m++)if(r(p[m],g))return!0;return!1}function c(p,g){for(var h=p.length,m=o(h),u=0,_=0,s={},A=0;A<h;A+=m){var b=n(A),f=p[b],x=String(f);s[x]||(s[x]=1,e(f,g)&&u++,w(f)&&_++)}return u>_*2}function o(p){return Math.max(1,(p-1)/1e3)}function i(p,g){for(var h=p.length,m=o(h),u=0,_=0,s={},A=0;A<h;A+=m){var b=n(A),f=p[b],x=String(f);if(!s[x]){s[x]=1;var l=typeof f;l==="boolean"?_++:(g?a(f)!==S:l==="number")?u++:l==="string"&&_++}}return _>u*2}function y(p){return M(p[0])&&M(p[1])}},{"../../constants/numerical":491,"../../lib":515,"fast-isnumeric":190}],568:[function(d,ee,te){var w=d("fast-isnumeric"),v=d("../../registry"),S=d("../../lib"),M=d("../../plot_api/plot_template"),e=d("../array_container_defaults"),a=d("./layout_attributes"),n=d("./tick_value_defaults"),r=d("./tick_mark_defaults"),t=d("./tick_label_defaults"),c=d("./prefix_suffix_defaults"),o=d("./category_order_defaults"),i=d("./line_grid_defaults"),y=d("./set_convert"),p=d("./constants").WEEKDAY_PATTERN,g=d("./constants").HOUR_PATTERN;ee.exports=function(s,A,b,f,x){var l=f.letter,L=f.font||{},T=f.splomStash||{},k=b("visible",!f.visibleDflt),P=A._template||{},z=A.type||P.type||"-",I;if(z==="date"){var D=v.getComponentMethod("calendars","handleDefaults");D(s,A,"calendar",f.calendar),f.noTicklabelmode||(I=b("ticklabelmode"))}var R="";(!f.noTicklabelposition||z==="multicategory")&&(R=S.coerce(s,A,{ticklabelposition:{valType:"enumerated",dflt:"outside",values:I==="period"?["outside","inside"]:l==="x"?["outside","inside","outside left","inside left","outside right","inside right"]:["outside","inside","outside top","inside top","outside bottom","inside bottom"]}},"ticklabelposition")),f.noTicklabeloverflow||b("ticklabeloverflow",R.indexOf("inside")!==-1?"hide past domain":z==="category"||z==="multicategory"?"allow":"hide past div"),y(A,x);var B=!A.isValidRange(s.range);B&&f.reverseDflt&&(B="reversed");var F=b("autorange",B);F&&(z==="linear"||z==="-")&&b("rangemode"),b("range"),A.cleanRange(),o(s,A,b,f),z!=="category"&&!f.noHover&&b("hoverformat");var H=b("color"),G=H!==a.color.dflt?H:L.color,J=T.label||x._dfltTitle[l];if(c(s,A,b,z,f),!k)return A;b("title.text",J),S.coerceFont(b,"title.font",{family:L.family,size:S.bigFont(L.size),color:G}),n(s,A,b,z);var X=f.hasMinor;if(X&&(M.newContainer(A,"minor"),n(s,A,b,z,{isMinor:!0})),t(s,A,b,z,f),r(s,A,b,f),X){var Y=f.isMinor;f.isMinor=!0,r(s,A,b,f),f.isMinor=Y}i(s,A,b,{dfltColor:H,bgColor:f.bgColor,showGrid:f.showGrid,hasMinor:X,attributes:a}),X&&!A.minor.ticks&&!A.minor.showgrid&&delete A.minor,(A.showline||A.ticks)&&b("mirror"),f.automargin&&b("automargin");var Z=z==="multicategory";if(!f.noTickson&&(z==="category"||Z)&&(A.ticks||A.showgrid)){var oe;Z&&(oe="boundaries");var re=b("tickson",oe);re==="boundaries"&&delete A.ticklabelposition}if(Z){var se=b("showdividers");se&&(b("dividercolor"),b("dividerwidth"))}if(z==="date")if(e(s,A,{name:"rangebreaks",inclusionAttr:"enabled",handleItemDefaults:h}),!A.rangebreaks.length)delete A.rangebreaks;else{for(var N=0;N<A.rangebreaks.length;N++)if(A.rangebreaks[N].pattern===p){A._hasDayOfWeekBreaks=!0;break}if(y(A,x),x._has("scattergl")||x._has("splom"))for(var U=0;U<f.data.length;U++){var q=f.data[U];(q.type==="scattergl"||q.type==="splom")&&(q.visible=!1,S.warn(q.type+" traces do not work on axes with rangebreaks. Setting trace "+q.index+" to `visible: false`."))}}return A};function h(_,s,A){function b(I,D){return S.coerce(_,s,a.rangebreaks,I,D)}var f=b("enabled");if(f){var x=b("bounds");if(x&&x.length>=2){var l="",L,T;if(x.length===2){for(L=0;L<2;L++)if(T=u(x[L]),T){l=p;break}}var k=b("pattern",l);if(k===p)for(L=0;L<2;L++)T=u(x[L]),T&&(s.bounds[L]=x[L]=T-1);if(k)for(L=0;L<2;L++)switch(T=x[L],k){case p:if(!w(T)){s.enabled=!1;return}if(T=+T,T!==Math.floor(T)||T<0||T>=7){s.enabled=!1;return}s.bounds[L]=x[L]=T;break;case g:if(!w(T)){s.enabled=!1;return}if(T=+T,T<0||T>24){s.enabled=!1;return}s.bounds[L]=x[L]=T;break}if(A.autorange===!1){var P=A.range;if(P[0]<P[1]){if(x[0]<P[0]&&x[1]>P[1]){s.enabled=!1;return}}else if(x[0]>P[0]&&x[1]<P[1]){s.enabled=!1;return}}}else{var z=b("values");if(z&&z.length)b("dvalue");else{s.enabled=!1;return}}}}var m={sun:1,mon:2,tue:3,wed:4,thu:5,fri:6,sat:7};function u(_){if(typeof _=="string")return m[_.substr(0,3).toLowerCase()]}},{"../../lib":515,"../../plot_api/plot_template":555,"../../registry":647,"../array_container_defaults":561,"./category_order_defaults":571,"./constants":573,"./layout_attributes":579,"./line_grid_defaults":581,"./prefix_suffix_defaults":583,"./set_convert":585,"./tick_label_defaults":587,"./tick_mark_defaults":588,"./tick_value_defaults":589,"fast-isnumeric":190}],569:[function(d,ee,te){var w=d("../../constants/docs"),v=w.FORMAT_LINK,S=w.DATE_FORMAT_LINK;function M(n,r){return{valType:"string",dflt:"",editType:"none",description:(r?e:a)("hover text",n)+["By default the values are formatted using "+(r?"generic number format":"`"+n+"axis.hoverformat`")+"."].join(" ")}}function e(n,r){return["Sets the "+n+" formatting rule"+(r?"for `"+r+"` ":""),"using d3 formatting mini-languages","which are very similar to those in Python. For numbers, see: "+v+"."].join(" ")}function a(n,r){return e(n,r)+[" And for dates see: "+S+".","We add two items to d3's date formatter:","*%h* for half of the year as a decimal number as well as","*%{n}f* for fractional seconds","with n digits. For example, *2016-10-13 09:15:23.456* with tickformat","*%H~%M~%S.%2f* would display *09~15~23.46*"].join(" ")}ee.exports={axisHoverFormat:M,descriptionOnlyNumbers:e,descriptionWithDates:a}},{"../../constants/docs":486}],570:[function(d,ee,te){var w=d("../../registry"),v=d("./constants");te.id2name=function(e){if(!(typeof e!="string"||!e.match(v.AX_ID_PATTERN))){var a=e.split(" ")[0].substr(1);return a==="1"&&(a=""),e.charAt(0)+"axis"+a}},te.name2id=function(e){if(!!e.match(v.AX_NAME_PATTERN)){var a=e.substr(5);return a==="1"&&(a=""),e.charAt(0)+a}},te.cleanId=function(e,a,n){var r=/( domain)$/.test(e);if(!(typeof e!="string"||!e.match(v.AX_ID_PATTERN))&&!(a&&e.charAt(0)!==a)&&!(r&&!n)){var t=e.split(" ")[0].substr(1).replace(/^0+/,"");return t==="1"&&(t=""),e.charAt(0)+t+(r&&n?" domain":"")}},te.list=function(M,e,a){var n=M._fullLayout;if(!n)return[];var r=te.listIds(M,e),t=new Array(r.length),c;for(c=0;c<r.length;c++){var o=r[c];t[c]=n[o.charAt(0)+"axis"+o.substr(1)]}if(!a){var i=n._subplots.gl3d||[];for(c=0;c<i.length;c++){var y=n[i[c]];e?t.push(y[e+"axis"]):t.push(y.xaxis,y.yaxis,y.zaxis)}}return t},te.listIds=function(M,e){var a=M._fullLayout;if(!a)return[];var n=a._subplots;return e?n[e+"axis"]:n.xaxis.concat(n.yaxis)},te.getFromId=function(M,e,a){var n=M._fullLayout;return e=e===void 0||typeof e!="string"?e:e.replace(" domain",""),a==="x"?e=e.replace(/y[0-9]*/,""):a==="y"&&(e=e.replace(/x[0-9]*/,"")),n[te.id2name(e)]},te.getFromTrace=function(M,e,a){var n=M._fullLayout,r=null;if(w.traceIs(e,"gl3d")){var t=e.scene;t.substr(0,5)==="scene"&&(r=n[t][a+"axis"])}else r=te.getFromId(M,e[a+"axis"]||a);return r},te.idSort=function(M,e){var a=M.charAt(0),n=e.charAt(0);return a!==n?a>n?1:-1:+(M.substr(1)||1)-+(e.substr(1)||1)},te.ref2id=function(M){return/^[xyz]/.test(M)?M.split(" ")[0]:!1};function S(M,e){if(e&&e.length){for(var a=0;a<e.length;a++)if(e[a][M])return!0}return!1}te.isLinked=function(M,e){return S(e,M._axisMatchGroups)||S(e,M._axisConstraintGroups)}},{"../../registry":647,"./constants":573}],571:[function(d,ee,te){function w(v,S){var M=S.dataAttr||v._id.charAt(0),e={},a,n,r;if(S.axData)a=S.axData;else for(a=[],n=0;n<S.data.length;n++){var t=S.data[n];t[M+"axis"]===v._id&&a.push(t)}for(n=0;n<a.length;n++){var c=a[n][M];for(r=0;r<c.length;r++){var o=c[r];o!=null&&(e[o]=1)}}return Object.keys(e)}ee.exports=function(S,M,e,a){if(M.type==="category"){var n=S.categoryarray,r=Array.isArray(n)&&n.length>0,t;r&&(t="array");var c=e("categoryorder",t),o;c==="array"&&(o=e("categoryarray")),!r&&c==="array"&&(c=M.categoryorder="trace"),c==="trace"?M._initialCategories=[]:c==="array"?M._initialCategories=o.slice():(o=w(M,a).sort(),c==="category ascending"?M._initialCategories=o:c==="category descending"&&(M._initialCategories=o.reverse()))}}},{}],572:[function(d,ee,te){var w=d("fast-isnumeric"),v=d("../../lib"),S=d("../../constants/numerical"),M=S.ONEDAY,e=S.ONEWEEK;te.dtick=function(a,n){var r=n==="log",t=n==="date",c=n==="category",o=t?M:1;if(!a)return o;if(w(a))return a=Number(a),a<=0?o:c?Math.max(1,Math.round(a)):t?Math.max(.1,a):a;if(typeof a!="string"||!(t||r))return o;var i=a.charAt(0),y=a.substr(1);return y=w(y)?Number(y):0,y<=0||!(t&&i==="M"&&y===Math.round(y)||r&&i==="L"||r&&i==="D"&&(y===1||y===2))?o:a},te.tick0=function(a,n,r,t){if(n==="date")return v.cleanDate(a,v.dateTick0(r,t%e===0?1:0));if(!(t==="D1"||t==="D2"))return w(a)?Number(a):0}},{"../../constants/numerical":491,"../../lib":515,"fast-isnumeric":190}],573:[function(d,ee,te){var w=d("../../lib/regex").counter;ee.exports={idRegex:{x:w("x","( domain)?"),y:w("y","( domain)?")},attrRegex:w("[xy]axis"),xAxisMatch:w("xaxis"),yAxisMatch:w("yaxis"),AX_ID_PATTERN:/^[xyz][0-9]*( domain)?$/,AX_NAME_PATTERN:/^[xyz]axis[0-9]*$/,SUBPLOT_PATTERN:/^x([0-9]*)y([0-9]*)$/,HOUR_PATTERN:"hour",WEEKDAY_PATTERN:"day of week",MINDRAG:8,MINZOOM:20,DRAGGERSIZE:20,REDRAWDELAY:50,DFLTRANGEX:[-1,6],DFLTRANGEY:[-1,4],traceLayerClasses:["imagelayer","heatmaplayer","contourcarpetlayer","contourlayer","funnellayer","waterfalllayer","barlayer","carpetlayer","violinlayer","boxlayer","ohlclayer","scattercarpetlayer","scatterlayer"],clipOnAxisFalseQuery:[".scatterlayer",".barlayer",".funnellayer",".waterfalllayer"],layerValue2layerClass:{"above traces":"above","below traces":"below"}}},{"../../lib/regex":532}],574:[function(d,ee,te){var w=d("../../lib"),v=d("./autorange"),S=d("./axis_ids").id2name,M=d("./layout_attributes"),e=d("./scale_zoom"),a=d("./set_convert"),n=d("../../constants/numerical").ALMOST_EQUAL,r=d("../../constants/alignment").FROM_BL;te.handleDefaults=function(h,m,u){var _=u.axIds,s=u.axHasImage,A=m._axisConstraintGroups=[],b=m._axisMatchGroups=[],f,x,l,L,T,k,P,z;for(f=0;f<_.length;f++)L=S(_[f]),T=h[L],k=m[L],t(T,k,{axIds:_,layoutOut:m,hasImage:s[L]});function I(Y,Z){for(f=0;f<Y.length;f++){x=Y[f];for(l in x)m[S(l)][Z]=x}}for(I(b,"_matchGroup"),f=0;f<A.length;f++){x=A[f];for(l in x)if(k=m[S(l)],k.fixedrange){for(var D in x){var R=S(D);(h[R]||{}).fixedrange===!1&&w.warn("fixedrange was specified as false for axis "+R+" but was overridden because another axis in its constraint group has fixedrange true"),m[R].fixedrange=!0}break}}for(f=0;f<A.length;){x=A[f];for(l in x){k=m[S(l)],k._matchGroup&&Object.keys(k._matchGroup).length===Object.keys(x).length&&(A.splice(f,1),f--);break}f++}I(A,"_constraintGroup");var B=["constrain","range","autorange","rangemode","rangebreaks","categoryorder","categoryarray"],F=!1,H=!1;function G(){z=k[P],P==="rangebreaks"&&(H=k._hasDayOfWeekBreaks)}for(f=0;f<b.length;f++){x=b[f];for(var J=0;J<B.length;J++){P=B[J],z=null;var X;for(l in x)if(L=S(l),T=h[L],k=m[L],P in k){if(!k.matches&&(X=k,P in T)){G();break}z===null&&P in T&&G()}if(P==="range"&&z&&(F=!0),P==="autorange"&&z===null&&F&&(z=!1),z===null&&P in X&&(z=X[P]),z!==null)for(l in x)k=m[S(l)],k[P]=P==="range"?z.slice():z,P==="rangebreaks"&&(k._hasDayOfWeekBreaks=H,a(k,m))}}};function t(h,m,u){var _=u.axIds,s=u.layoutOut,A=u.hasImage,b=s._axisConstraintGroups,f=s._axisMatchGroups,x=m._id,l=x.charAt(0),L=((s._splomAxes||{})[l]||{})[x]||{},T=m._id,k=T.charAt(0)==="x";m._matchGroup=null,m._constraintGroup=null;function P(se,N){return w.coerce(h,m,M,se,N)}P("constrain",A?"domain":"range"),w.coerce(h,m,{constraintoward:{valType:"enumerated",values:k?["left","center","right"]:["bottom","middle","top"],dflt:k?"center":"middle"}},"constraintoward");var z=m.type,I,D,R=[];for(I=0;I<_.length;I++)if(D=_[I],D!==T){var B=s[S(D)];B.type===z&&R.push(D)}var F=o(b,T);if(F){var H=[];for(I=0;I<R.length;I++)D=R[I],F[D]||H.push(D);R=H}var G=R.length,J,X;G&&(h.matches||L.matches)&&(J=w.coerce(h,m,{matches:{valType:"enumerated",values:R,dflt:R.indexOf(L.matches)!==-1?L.matches:void 0}},"matches"));var Y=A&&!k?m.anchor:void 0;if(G&&!J&&(h.scaleanchor||Y)&&(X=w.coerce(h,m,{scaleanchor:{valType:"enumerated",values:R}},"scaleanchor",Y)),J){m._matchGroup=i(f,T,J,1);var Z=s[S(J)],oe=c(s,m)/c(s,Z);k!==(J.charAt(0)==="x")&&(oe=(k?"x":"y")+oe),i(b,T,J,oe)}else h.matches&&_.indexOf(h.matches)!==-1&&w.warn("ignored "+m._name+'.matches: "'+h.matches+'" to avoid an infinite loop');if(X){var re=P("scaleratio");re||(re=m.scaleratio=1),i(b,T,X,re)}else h.scaleanchor&&_.indexOf(h.scaleanchor)!==-1&&w.warn("ignored "+m._name+'.scaleanchor: "'+h.scaleanchor+'" to avoid either an infinite loop and possibly inconsistent scaleratios, or because this axis declares a *matches* constraint.')}function c(h,m){var u=m.domain;return u||(u=h[S(m.overlaying)].domain),u[1]-u[0]}function o(h,m){for(var u=0;u<h.length;u++)if(h[u][m])return h[u];return null}function i(h,m,u,_){var s,A,b,f,x,l=o(h,m);l===null?(l={},l[m]=1,x=h.length,h.push(l)):x=h.indexOf(l);var L=Object.keys(l);for(s=0;s<h.length;s++)if(b=h[s],s!==x&&b[u]){var T=b[u];for(A=0;A<L.length;A++)f=L[A],b[f]=y(T,y(_,l[f]));h.splice(x,1);return}if(_!==1)for(A=0;A<L.length;A++){var k=L[A];l[k]=y(_,l[k])}l[u]=1}function y(h,m){var u="",_="",s,A;typeof h=="string"&&(u=h.match(/^[xy]*/)[0],s=u.length,h=+h.substr(s)),typeof m=="string"&&(_=m.match(/^[xy]*/)[0],A=_.length,m=+m.substr(A));var b=h*m;return!s&&!A?b:!s||!A||u.charAt(0)===_.charAt(0)?u+_+h*m:s===A?b:(s>A?u.substr(A):_.substr(s))+b}function p(h,m){for(var u=m._size,_=u.h/u.w,s={},A=Object.keys(h),b=0;b<A.length;b++){var f=A[b],x=h[f];if(typeof x=="string"){var l=x.match(/^[xy]*/)[0],L=l.length;x=+x.substr(L);for(var T=l.charAt(0)==="y"?_:1/_,k=0;k<L;k++)x*=T}s[f]=x}return s}te.enforce=function(m){var u=m._fullLayout,_=u._axisConstraintGroups||[],s,A,b,f,x,l,L,T;for(s=0;s<_.length;s++){b=p(_[s],u);var k=Object.keys(b),P=1/0,z=0,I=1/0,D={},R={},B=!1;for(A=0;A<k.length;A++)f=k[A],R[f]=x=u[S(f)],x._inputDomain?x.domain=x._inputDomain.slice():x._inputDomain=x.domain.slice(),x._inputRange||(x._inputRange=x.range.slice()),x.setScale(),D[f]=l=Math.abs(x._m)/b[f],P=Math.min(P,l),(x.constrain==="domain"||!x._constraintShrinkable)&&(I=Math.min(I,l)),delete x._constraintShrinkable,z=Math.max(z,l),x.constrain==="domain"&&(B=!0);if(!(P>n*z&&!B)){for(A=0;A<k.length;A++)if(f=k[A],l=D[f],x=R[f],L=x.constrain,l!==I||L==="domain")if(T=l/I,L==="range")e(x,T);else{var F=x._inputDomain,H=(x.domain[1]-x.domain[0])/(F[1]-F[0]),G=(x.r2l(x.range[1])-x.r2l(x.range[0]))/(x.r2l(x._inputRange[1])-x.r2l(x._inputRange[0]));if(T/=H,T*G<1){x.domain=x._input.domain=F.slice(),e(x,T);continue}if(G<1&&(x.range=x._input.range=x._inputRange.slice(),T*=G),x.autorange){var J=x.r2l(x.range[0]),X=x.r2l(x.range[1]),Y=(J+X)/2,Z=Y,oe=Y,re=Math.abs(X-Y),se=Y-re*T*1.0001,N=Y+re*T*1.0001,U=v.makePadFn(u,x,0),q=v.makePadFn(u,x,1);g(x,T);var $=Math.abs(x._m),W=v.concatExtremes(m,x),K=W.min,ne=W.max,ae,ie;for(ie=0;ie<K.length;ie++)ae=K[ie].val-U(K[ie])/$,ae>se&&ae<Z&&(Z=ae);for(ie=0;ie<ne.length;ie++)ae=ne[ie].val+q(ne[ie])/$,ae<N&&ae>oe&&(oe=ae);var le=(oe-Z)/(2*re);T/=le,Z=x.l2r(Z),oe=x.l2r(oe),x.range=x._input.range=J<X?[Z,oe]:[oe,Z]}g(x,T)}}}},te.getAxisGroup=function(m,u){for(var _=m._axisMatchGroups,s=0;s<_.length;s++){var A=_[s];if(A[u])return"g"+s}return u},te.clean=function(m,u){if(u._inputDomain){for(var _=!1,s=u._id,A=m._fullLayout._axisConstraintGroups,b=0;b<A.length;b++)if(A[b][s]){_=!0;break}(!_||u.constrain!=="domain")&&(u._input.domain=u.domain=u._inputDomain,delete u._inputDomain)}};function g(h,m){var u=h._inputDomain,_=r[h.constraintoward],s=u[0]+(u[1]-u[0])*_;h.domain=h._input.domain=[s+(u[0]-s)/m,s+(u[1]-s)/m],h.setScale()}},{"../../constants/alignment":483,"../../constants/numerical":491,"../../lib":515,"./autorange":565,"./axis_ids":570,"./layout_attributes":579,"./scale_zoom":584,"./set_convert":585}],575:[function(d,ee,te){var w=d("@plotly/d3"),v=d("../../lib"),S=v.numberFormat,M=d("tinycolor2"),e=d("has-passive-events"),a=d("../../registry"),n=v.strTranslate,r=d("../../lib/svg_text_utils"),t=d("../../components/color"),c=d("../../components/drawing"),o=d("../../components/fx"),i=d("./axes"),y=d("../../lib/setcursor"),p=d("../../components/dragelement"),g=d("../../components/dragelement/helpers"),h=g.selectingOrDrawing,m=g.freeMode,u=d("../../constants/alignment").FROM_TL,_=d("../../lib/clear_gl_canvases"),s=d("../../plot_api/subroutines").redrawReglTraces,A=d("../plots"),b=d("./axis_ids").getFromId,f=d("../../components/selections").prepSelect,x=d("../../components/selections").clearOutline,l=d("../../components/selections").selectOnClick,L=d("./scale_zoom"),T=d("./constants"),k=T.MINDRAG,P=T.MINZOOM,z=!0;function I(ae,ie,le,ye,ue,pe,ge,Te){var _e=ae._fullLayout._zoomlayer,ze=ge+Te==="nsew",Oe=(ge+Te).length===1,Ye,be,Pe,Ge,Qe,Be,Le,He,vt,Rt,rr,Lt,Ft,Gt,Dt,kt,Ue,qe,Ve,Ae,Ne,Xe,Je;function _t(){if(Ye=ie.xaxis,be=ie.yaxis,vt=Ye._length,Rt=be._length,Le=Ye._offset,He=be._offset,Pe={},Pe[Ye._id]=Ye,Ge={},Ge[be._id]=be,ge&&Te)for(var br=ie.overlays,Mr=0;Mr<br.length;Mr++){var Hr=br[Mr].xaxis;Pe[Hr._id]=Hr;var nr=br[Mr].yaxis;Ge[nr._id]=nr}Qe=ne(Pe),Be=ne(Ge),Ft=B(Qe,Te),Gt=B(Be,ge),Dt=!Gt&&!Ft,Lt=W(ae,ae._fullLayout._axisMatchGroups,Pe,Ge),rr=W(ae,ae._fullLayout._axisConstraintGroups,Pe,Ge,Lt);var mr=rr.isSubplotConstrained||Lt.isSubplotConstrained;kt=Te||mr,Ue=ge||mr;var Pr=ae._fullLayout;qe=Pr._has("scattergl"),Ve=Pr._has("splom"),Ae=Pr._has("svg")}_t();var mt=X(Gt+Ft,ae._fullLayout.dragmode,ze),Ot=R(ie,ge+Te+"drag",mt,le,ye,ue,pe);if(Dt&&!ze)return Ot.onmousedown=null,Ot.style.pointerEvents="none",Ot;var Kt={element:Ot,gd:ae,plotinfo:ie};Kt.prepFn=function(br,Mr,Hr){var nr=Kt.dragmode,mr=ae._fullLayout.dragmode;mr!==nr&&(Kt.dragmode=mr),_t(),Xe=ae._fullLayout._invScaleX,Je=ae._fullLayout._invScaleY,Dt||(ze?br.shiftKey?mr==="pan"?mr="zoom":h(mr)||(mr="pan"):br.ctrlKey&&(mr="pan"):mr="pan"),m(mr)?Kt.minDrag=1:Kt.minDrag=void 0,h(mr)?(Kt.xaxes=Qe,Kt.yaxes=Be,f(br,Mr,Hr,Kt,mr)):(Kt.clickFn=Wt,h(nr)&&Nt(),Dt||(mr==="zoom"?(Kt.moveFn=rt,Kt.doneFn=st,Kt.minDrag=1,_r(br,Mr,Hr)):mr==="pan"&&(Kt.moveFn=nt,Kt.doneFn=dt))),ae._fullLayout._redrag=function(){var Pr=ae._dragdata;if(Pr&&Pr.element===Ot){var Nr=ae._fullLayout.dragmode;h(Nr)||(_t(),Tt([0,0,vt,Rt]),Kt.moveFn(Pr.dx,Pr.dy))}}};function Nt(){Kt.plotinfo.selection=!1,x(ae)}function Wt(br,Mr){var Hr=Kt.gd;if(Hr._fullLayout._activeShapeIndex>=0){Hr._fullLayout._deactivateShape(Hr);return}var nr=Hr._fullLayout.clickmode;if(se(Hr),br===2&&!Oe&&At(),ze)nr.indexOf("select")>-1&&l(Mr,Hr,Qe,Be,ie.id,Kt),nr.indexOf("event")>-1&&o.click(Hr,Mr,ie.id);else if(br===1&&Oe){var mr=ge?be:Ye,Pr=ge==="s"||Te==="w"?0:1,Nr=mr._name+".range["+Pr+"]",Sr=F(mr,Pr),tt="left",Et="middle";if(mr.fixedrange)return;ge?(Et=ge==="n"?"top":"bottom",mr.side==="right"&&(tt="right")):Te==="e"&&(tt="right"),Hr._context.showAxisRangeEntryBoxes&&w.select(Ot).call(r.makeEditable,{gd:Hr,immediate:!0,background:Hr._fullLayout.paper_bgcolor,text:String(Sr),fill:mr.tickfont?mr.tickfont.color:"#444",horizontalAlign:tt,verticalAlign:Et}).on("edit",function(Vt){var ar=mr.d2r(Vt);ar!==void 0&&a.call("_guiRelayout",Hr,Nr,ar)})}}p.init(Kt);var qt,Yt,fr,Yr,hn,Qr,at,Jt,Zt,Ut;function _r(br,Mr,Hr){var nr=Ot.getBoundingClientRect();qt=Mr-nr.left,Yt=Hr-nr.top,ae._fullLayout._calcInverseTransform(ae);var mr=v.apply3DTransform(ae._fullLayout._invTransform)(qt,Yt);qt=mr[0],Yt=mr[1],fr={l:qt,r:qt,w:0,t:Yt,b:Yt,h:0},Yr=ae._hmpixcount?ae._hmlumcount/ae._hmpixcount:M(ae._fullLayout.plot_bgcolor).getLuminance(),hn="M0,0H"+vt+"V"+Rt+"H0V0",Qr=!1,at="xy",Ut=!1,Jt=Y(_e,Yr,Le,He,hn),Zt=Z(_e,Le,He)}function rt(br,Mr){if(ae._transitioningWithDuration)return!1;var Hr=Math.max(0,Math.min(vt,Xe*br+qt)),nr=Math.max(0,Math.min(Rt,Je*Mr+Yt)),mr=Math.abs(Hr-qt),Pr=Math.abs(nr-Yt);fr.l=Math.min(qt,Hr),fr.r=Math.max(qt,Hr),fr.t=Math.min(Yt,nr),fr.b=Math.max(Yt,nr);function Nr(){at="",fr.r=fr.l,fr.t=fr.b,Zt.attr("d","M0,0Z")}if(rr.isSubplotConstrained)mr>P||Pr>P?(at="xy",mr/vt>Pr/Rt?(Pr=mr*Rt/vt,Yt>nr?fr.t=Yt-Pr:fr.b=Yt+Pr):(mr=Pr*vt/Rt,qt>Hr?fr.l=qt-mr:fr.r=qt+mr),Zt.attr("d",$(fr))):Nr();else if(Lt.isSubplotConstrained)if(mr>P||Pr>P){at="xy";var Sr=Math.min(fr.l/vt,(Rt-fr.b)/Rt),tt=Math.max(fr.r/vt,(Rt-fr.t)/Rt);fr.l=Sr*vt,fr.r=tt*vt,fr.b=(1-Sr)*Rt,fr.t=(1-tt)*Rt,Zt.attr("d",$(fr))}else Nr();else!Gt||Pr<Math.min(Math.max(mr*.6,k),P)?mr<k||!Ft?Nr():(fr.t=0,fr.b=Rt,at="x",Zt.attr("d",U(fr,Yt))):!Ft||mr<Math.min(Pr*.6,P)?(fr.l=0,fr.r=vt,at="y",Zt.attr("d",q(fr,qt))):(at="xy",Zt.attr("d",$(fr)));fr.w=fr.r-fr.l,fr.h=fr.b-fr.t,at&&(Ut=!0),ae._dragged=Ut,oe(Jt,Zt,fr,hn,Qr,Yr),Ke(),ae.emit("plotly_relayouting",Ne),Qr=!0}function Ke(){Ne={},(at==="xy"||at==="x")&&(H(Qe,fr.l/vt,fr.r/vt,Ne,rr.xaxes),it("x",Ne)),(at==="xy"||at==="y")&&(H(Be,(Rt-fr.b)/Rt,(Rt-fr.t)/Rt,Ne,rr.yaxes),it("y",Ne))}function st(){Ke(),se(ae),dt(),N(ae)}var lt=[0,0,vt,Rt],wt=null,Pt=T.REDRAWDELAY,ke=ie.mainplot?ae._fullLayout._plots[ie.mainplot]:ie;function Se(br){if(!ae._context._scrollZoom.cartesian&&!ae._fullLayout._enablescrollzoom)return;if(Nt(),ae._transitioningWithDuration){br.preventDefault(),br.stopPropagation();return}_t(),clearTimeout(wt);var Mr=-br.deltaY;if(isFinite(Mr)||(Mr=br.wheelDelta/10),!isFinite(Mr)){v.log("Did not find wheel motion attributes: ",br);return}var Hr=Math.exp(-Math.min(Math.max(Mr,-20),20)/200),nr=ke.draglayer.select(".nsewdrag").node().getBoundingClientRect(),mr=(br.clientX-nr.left)/nr.width,Pr=(nr.bottom-br.clientY)/nr.height,Nr;function Sr(tt,Et,Vt){if(tt.fixedrange)return;var ar=v.simpleMap(tt.range,tt.r2l),Cr=ar[0]+(ar[1]-ar[0])*Et;function Or(Ir){return tt.l2r(Cr+(Ir-Cr)*Vt)}tt.range=ar.map(Or)}if(kt){for(Te||(mr=.5),Nr=0;Nr<Qe.length;Nr++)Sr(Qe[Nr],mr,Hr);it("x"),lt[2]*=Hr,lt[0]+=lt[2]*mr*(1/Hr-1)}if(Ue){for(ge||(Pr=.5),Nr=0;Nr<Be.length;Nr++)Sr(Be[Nr],Pr,Hr);it("y"),lt[3]*=Hr,lt[1]+=lt[3]*(1-Pr)*(1/Hr-1)}Tt(lt),ct(),ae.emit("plotly_relayouting",Ne),wt=setTimeout(function(){!ae._fullLayout||(lt=[0,0,vt,Rt],dt())},Pt),br.preventDefault()}ge.length*Te.length!==1&&K(Ot,Se);function nt(br,Mr){if(br=br*Xe,Mr=Mr*Je,ae._transitioningWithDuration)return;if(ae._fullLayout._replotting=!0,Ft==="ew"||Gt==="ns"){var Hr=Ft?-br:0,nr=Gt?-Mr:0;if(Lt.isSubplotConstrained){if(Ft&&Gt){var mr=(br/vt-Mr/Rt)/2;br=mr*vt,Mr=-mr*Rt,Hr=-br,nr=-Mr}Gt?Hr=-nr*vt/Rt:nr=-Hr*Rt/vt}Ft&&(G(Qe,br),it("x")),Gt&&(G(Be,Mr),it("y")),Tt([Hr,nr,vt,Rt]),ct(),ae.emit("plotly_relayouting",Ne);return}function Pr(Or,Ir,Tr){for(var Wr=1-Ir,wn,ln,Bn=0;Bn<Or.length;Bn++){var Cn=Or[Bn];if(!Cn.fixedrange){wn=Cn,ln=Cn._rl[Wr]+(Cn._rl[Ir]-Cn._rl[Wr])/J(Tr/Cn._length);var Wn=Cn.l2r(ln);Wn!==!1&&Wn!==void 0&&(Cn.range[Ir]=Wn)}}return wn._length*(wn._rl[Ir]-ln)/(wn._rl[Ir]-wn._rl[Wr])}var Nr=Ft==="w"==(Gt==="n")?1:-1;if(Ft&&Gt&&(rr.isSubplotConstrained||Lt.isSubplotConstrained)){var Sr=(br/vt+Nr*Mr/Rt)/2;br=Sr*vt,Mr=Nr*Sr*Rt}var tt,Et;if(Ft==="w"?br=Pr(Qe,0,br):Ft==="e"?br=Pr(Qe,1,-br):Ft||(br=0),Gt==="n"?Mr=Pr(Be,1,Mr):Gt==="s"?Mr=Pr(Be,0,-Mr):Gt||(Mr=0),tt=Ft==="w"?br:0,Et=Gt==="n"?Mr:0,rr.isSubplotConstrained&&!Lt.isSubplotConstrained||Lt.isSubplotConstrained&&Ft&&Gt&&Nr>0){var Vt;if(Lt.isSubplotConstrained||!Ft&&Gt.length===1){for(Vt=0;Vt<Qe.length;Vt++)Qe[Vt].range=Qe[Vt]._r.slice(),L(Qe[Vt],1-Mr/Rt);br=Mr*vt/Rt,tt=br/2}if(Lt.isSubplotConstrained||!Gt&&Ft.length===1){for(Vt=0;Vt<Be.length;Vt++)Be[Vt].range=Be[Vt]._r.slice(),L(Be[Vt],1-br/vt);Mr=br*Rt/vt,Et=Mr/2}}(!Lt.isSubplotConstrained||!Gt)&&it("x"),(!Lt.isSubplotConstrained||!Ft)&&it("y");var ar=vt-br,Cr=Rt-Mr;Lt.isSubplotConstrained&&!(Ft&&Gt)&&(Ft?(Et=tt?0:br*Rt/vt,Cr=ar*Rt/vt):(tt=Et?0:Mr*vt/Rt,ar=Cr*vt/Rt)),Tt([tt,Et,ar,Cr]),ct(),ae.emit("plotly_relayouting",Ne)}function it(br,Mr){for(var Hr=Lt.isSubplotConstrained?{x:Be,y:Qe}[br]:Lt[br+"axes"],nr=Lt.isSubplotConstrained?{x:Qe,y:Be}[br]:[],mr=0;mr<Hr.length;mr++){var Pr=Hr[mr],Nr=Pr._id,Sr=Lt.xLinks[Nr]||Lt.yLinks[Nr],tt=nr[0]||Pe[Sr]||Ge[Sr];tt&&(Mr?(Mr[Pr._name+".range[0]"]=Mr[tt._name+".range[0]"],Mr[Pr._name+".range[1]"]=Mr[tt._name+".range[1]"]):Pr.range=tt.range.slice())}}function ct(){var br=[],Mr;function Hr(Pr){for(Mr=0;Mr<Pr.length;Mr++)Pr[Mr].fixedrange||br.push(Pr[Mr]._id)}for(kt&&(Hr(Qe),Hr(rr.xaxes),Hr(Lt.xaxes)),Ue&&(Hr(Be),Hr(rr.yaxes),Hr(Lt.yaxes)),Ne={},Mr=0;Mr<br.length;Mr++){var nr=br[Mr],mr=b(ae,nr);i.drawOne(ae,mr,{skipTitle:!0}),Ne[mr._name+".range[0]"]=mr.range[0],Ne[mr._name+".range[1]"]=mr.range[1]}i.redrawComponents(ae,br)}function At(){if(!ae._transitioningWithDuration){var br=ae._context.doubleClick,Mr=[];Ft&&(Mr=Mr.concat(Qe)),Gt&&(Mr=Mr.concat(Be)),Lt.xaxes&&(Mr=Mr.concat(Lt.xaxes)),Lt.yaxes&&(Mr=Mr.concat(Lt.yaxes));var Hr={},nr,mr,Pr;if(br==="reset+autosize"){for(br="autosize",mr=0;mr<Mr.length;mr++)if(nr=Mr[mr],nr._rangeInitial&&(nr.range[0]!==nr._rangeInitial[0]||nr.range[1]!==nr._rangeInitial[1])||!nr._rangeInitial&&!nr.autorange){br="reset";break}}if(br==="autosize")for(mr=0;mr<Mr.length;mr++)nr=Mr[mr],nr.fixedrange||(Hr[nr._name+".autorange"]=!0);else if(br==="reset")for((Ft||rr.isSubplotConstrained)&&(Mr=Mr.concat(rr.xaxes)),Gt&&!rr.isSubplotConstrained&&(Mr=Mr.concat(rr.yaxes)),rr.isSubplotConstrained&&(Ft?Gt||(Mr=Mr.concat(Be)):Mr=Mr.concat(Qe)),mr=0;mr<Mr.length;mr++)nr=Mr[mr],nr.fixedrange||(nr._rangeInitial?(Pr=nr._rangeInitial,Hr[nr._name+".range[0]"]=Pr[0],Hr[nr._name+".range[1]"]=Pr[1]):Hr[nr._name+".autorange"]=!0);ae.emit("plotly_doubleclick",null),a.call("_guiRelayout",ae,Hr)}}function dt(){Tt([0,0,vt,Rt]),v.syncOrAsync([A.previousPromises,function(){ae._fullLayout._replotting=!1,a.call("_guiRelayout",ae,Ne)}],ae)}function Tt(br){var Mr=ae._fullLayout,Hr=Mr._plots,nr=Mr._subplots.cartesian,mr,Pr,Nr,Sr;if(Ve&&a.subplotsRegistry.splom.drag(ae),qe){for(mr=0;mr<nr.length;mr++)if(Pr=Hr[nr[mr]],Nr=Pr.xaxis,Sr=Pr.yaxis,Pr._scene){var tt=v.simpleMap(Nr.range,Nr.r2l),Et=v.simpleMap(Sr.range,Sr.r2l);Pr._scene.update({range:[tt[0],Et[0],tt[1],Et[1]]})}}if((Ve||qe)&&(_(ae),s(ae)),Ae){var Vt=br[2]/Ye._length,ar=br[3]/be._length;for(mr=0;mr<nr.length;mr++){Pr=Hr[nr[mr]],Nr=Pr.xaxis,Sr=Pr.yaxis;var Cr=(kt||Lt.isSubplotConstrained)&&!Nr.fixedrange&&Pe[Nr._id],Or=(Ue||Lt.isSubplotConstrained)&&!Sr.fixedrange&&Ge[Sr._id],Ir,Tr,Wr,wn;if(Cr?(Ir=Vt,Wr=Te||Lt.isSubplotConstrained?br[0]:kr(Nr,Ir)):Lt.xaHash[Nr._id]?(Ir=Vt,Wr=br[0]*Nr._length/Ye._length):Lt.yaHash[Nr._id]?(Ir=ar,Wr=Gt==="ns"?-br[1]*Nr._length/be._length:kr(Nr,Ir,{n:"top",s:"bottom"}[Gt])):(Ir=Ht(Nr,Vt,ar),Wr=ir(Nr,Ir)),Or?(Tr=ar,wn=ge||Lt.isSubplotConstrained?br[1]:kr(Sr,Tr)):Lt.yaHash[Sr._id]?(Tr=ar,wn=br[1]*Sr._length/be._length):Lt.xaHash[Sr._id]?(Tr=Vt,wn=Ft==="ew"?-br[0]*Sr._length/Ye._length:kr(Sr,Tr,{e:"right",w:"left"}[Ft])):(Tr=Ht(Sr,Vt,ar),wn=ir(Sr,Tr)),!(!Ir&&!Tr)){Ir||(Ir=1),Tr||(Tr=1);var ln=Nr._offset-Wr/Ir,Bn=Sr._offset-wn/Tr;Pr.clipRect.call(c.setTranslate,Wr,wn).call(c.setScale,Ir,Tr),Pr.plot.call(c.setTranslate,ln,Bn).call(c.setScale,1/Ir,1/Tr),(Ir!==Pr.xScaleFactor||Tr!==Pr.yScaleFactor)&&(c.setPointGroupScale(Pr.zoomScalePts,Ir,Tr),c.setTextPointsScale(Pr.zoomScaleTxt,Ir,Tr)),c.hideOutsideRangePoints(Pr.clipOnAxisFalseTraces,Pr),Pr.xScaleFactor=Ir,Pr.yScaleFactor=Tr}}}}function Ht(br,Mr,Hr){return br.fixedrange?0:kt&&rr.xaHash[br._id]?Mr:Ue&&(rr.isSubplotConstrained?rr.xaHash:rr.yaHash)[br._id]?Hr:0}function ir(br,Mr){return Mr?(br.range=br._r.slice(),L(br,Mr),kr(br,Mr)):0}function kr(br,Mr,Hr){return br._length*(1-Mr)*u[Hr||br.constraintoward||"middle"]}return Ot}function D(ae,ie,le,ye){var ue=v.ensureSingle(ae.draglayer,ie,le,function(pe){pe.classed("drag",!0).style({fill:"transparent","stroke-width":0}).attr("data-subplot",ae.id)});return ue.call(y,ye),ue.node()}function R(ae,ie,le,ye,ue,pe,ge){var Te=D(ae,"rect",ie,le);return w.select(Te).call(c.setRect,ye,ue,pe,ge),Te}function B(ae,ie){for(var le=0;le<ae.length;le++)if(!ae[le].fixedrange)return ie;return""}function F(ae,ie){var le=ae.range[ie],ye=Math.abs(le-ae.range[1-ie]),ue;return ae.type==="date"?le:ae.type==="log"?(ue=Math.ceil(Math.max(0,-Math.log(ye)/Math.LN10))+3,S("."+ue+"g")(Math.pow(10,le))):(ue=Math.floor(Math.log(Math.abs(le))/Math.LN10)-Math.floor(Math.log(ye)/Math.LN10)+4,S("."+String(ue)+"g")(le))}function H(ae,ie,le,ye,ue){for(var pe=0;pe<ae.length;pe++){var ge=ae[pe];if(!ge.fixedrange)if(ge.rangebreaks){var Te=ge._id.charAt(0)==="y",_e=Te?1-ie:ie,ze=Te?1-le:le;ye[ge._name+".range[0]"]=ge.l2r(ge.p2l(_e*ge._length)),ye[ge._name+".range[1]"]=ge.l2r(ge.p2l(ze*ge._length))}else{var Oe=ge._rl[0],Ye=ge._rl[1]-Oe;ye[ge._name+".range[0]"]=ge.l2r(Oe+Ye*ie),ye[ge._name+".range[1]"]=ge.l2r(Oe+Ye*le)}}if(ue&&ue.length){var be=(ie+(1-le))/2;H(ue,be,1-be,ye,[])}}function G(ae,ie){for(var le=0;le<ae.length;le++){var ye=ae[le];if(!ye.fixedrange)if(ye.rangebreaks){var ue=0,pe=ye._length,ge=ye.p2l(ue+ie)-ye.p2l(ue),Te=ye.p2l(pe+ie)-ye.p2l(pe),_e=(ge+Te)/2;ye.range=[ye.l2r(ye._rl[0]-_e),ye.l2r(ye._rl[1]-_e)]}else ye.range=[ye.l2r(ye._rl[0]-ie/ye._m),ye.l2r(ye._rl[1]-ie/ye._m)]}}function J(ae){return 1-(ae>=0?Math.min(ae,.9):1/(1/Math.max(ae,-.3)+3.222))}function X(ae,ie,le){return ae?ae==="nsew"?le?"":ie==="pan"?"move":"crosshair":ae.toLowerCase()+"-resize":"pointer"}function Y(ae,ie,le,ye,ue){return ae.append("path").attr("class","zoombox").style({fill:ie>.2?"rgba(0,0,0,0)":"rgba(255,255,255,0)","stroke-width":0}).attr("transform",n(le,ye)).attr("d",ue+"Z")}function Z(ae,ie,le){return ae.append("path").attr("class","zoombox-corners").style({fill:t.background,stroke:t.defaultLine,"stroke-width":1,opacity:0}).attr("transform",n(ie,le)).attr("d","M0,0Z")}function oe(ae,ie,le,ye,ue,pe){ae.attr("d",ye+"M"+le.l+","+le.t+"v"+le.h+"h"+le.w+"v-"+le.h+"h-"+le.w+"Z"),re(ae,ie,ue,pe)}function re(ae,ie,le,ye){le||(ae.transition().style("fill",ye>.2?"rgba(0,0,0,0.4)":"rgba(255,255,255,0.3)").duration(200),ie.transition().style("opacity",1).duration(200))}function se(ae){w.select(ae).selectAll(".zoombox,.js-zoombox-backdrop,.js-zoombox-menu,.zoombox-corners").remove()}function N(ae){z&&ae.data&&ae._context.showTips&&(v.notifier(v._(ae,"Double-click to zoom back out"),"long"),z=!1)}function U(ae,ie){return"M"+(ae.l-.5)+","+(ie-P-.5)+"h-3v"+(2*P+1)+"h3ZM"+(ae.r+.5)+","+(ie-P-.5)+"h3v"+(2*P+1)+"h-3Z"}function q(ae,ie){return"M"+(ie-P-.5)+","+(ae.t-.5)+"v-3h"+(2*P+1)+"v3ZM"+(ie-P-.5)+","+(ae.b+.5)+"v3h"+(2*P+1)+"v-3Z"}function $(ae){var ie=Math.floor(Math.min(ae.b-ae.t,ae.r-ae.l,P)/2);return"M"+(ae.l-3.5)+","+(ae.t-.5+ie)+"h3v"+-ie+"h"+ie+"v-3h-"+(ie+3)+"ZM"+(ae.r+3.5)+","+(ae.t-.5+ie)+"h-3v"+-ie+"h"+-ie+"v-3h"+(ie+3)+"ZM"+(ae.r+3.5)+","+(ae.b+.5-ie)+"h-3v"+ie+"h"+-ie+"v3h"+(ie+3)+"ZM"+(ae.l-3.5)+","+(ae.b+.5-ie)+"h3v"+ie+"h"+ie+"v3h-"+(ie+3)+"Z"}function W(ae,ie,le,ye,ue){for(var pe=!1,ge={},Te={},_e,ze,Oe,Ye,be=(ue||{}).xaHash,Pe=(ue||{}).yaHash,Ge=0;Ge<ie.length;Ge++){var Qe=ie[Ge];for(_e in le)if(Qe[_e]){for(Oe in Qe)!(ue&&(be[Oe]||Pe[Oe]))&&!(Oe.charAt(0)==="x"?le:ye)[Oe]&&(ge[Oe]=_e);for(ze in ye)!(ue&&(be[ze]||Pe[ze]))&&Qe[ze]&&(pe=!0)}for(ze in ye)if(Qe[ze])for(Ye in Qe)!(ue&&(be[Ye]||Pe[Ye]))&&!(Ye.charAt(0)==="x"?le:ye)[Ye]&&(Te[Ye]=ze)}pe&&(v.extendFlat(ge,Te),Te={});var Be={},Le=[];for(Oe in ge){var He=b(ae,Oe);Le.push(He),Be[He._id]=He}var vt={},Rt=[];for(Ye in Te){var rr=b(ae,Ye);Rt.push(rr),vt[rr._id]=rr}return{xaHash:Be,yaHash:vt,xaxes:Le,yaxes:Rt,xLinks:ge,yLinks:Te,isSubplotConstrained:pe}}function K(ae,ie){if(!e)ae.onwheel!==void 0?ae.onwheel=ie:ae.onmousewheel!==void 0?ae.onmousewheel=ie:ae.isAddedWheelEvent||(ae.isAddedWheelEvent=!0,ae.addEventListener("wheel",ie,{passive:!1}));else{var le=ae.onwheel!==void 0?"wheel":"mousewheel";ae._onwheel&&ae.removeEventListener(le,ae._onwheel),ae._onwheel=ie,ae.addEventListener(le,ie,{passive:!1})}}function ne(ae){var ie=[];for(var le in ae)ie.push(ae[le]);return ie}ee.exports={makeDragBox:I,makeDragger:D,makeRectDragger:R,makeZoombox:Y,makeCorners:Z,updateZoombox:oe,xyCorners:$,transitionZoombox:re,removeZoombox:se,showDoubleClickNotifier:N,attachWheelEventHandler:K}},{"../../components/color":367,"../../components/dragelement":386,"../../components/dragelement/helpers":385,"../../components/drawing":389,"../../components/fx":407,"../../components/selections":455,"../../constants/alignment":483,"../../lib":515,"../../lib/clear_gl_canvases":499,"../../lib/setcursor":536,"../../lib/svg_text_utils":541,"../../plot_api/subroutines":556,"../../registry":647,"../plots":628,"./axes":566,"./axis_ids":570,"./constants":573,"./scale_zoom":584,"@plotly/d3":58,"has-passive-events":229,tinycolor2:313}],576:[function(d,ee,te){var w=d("@plotly/d3"),v=d("../../components/fx"),S=d("../../components/dragelement"),M=d("../../lib/setcursor"),e=d("./dragbox").makeDragBox,a=d("./constants").DRAGGERSIZE;te.initInteractions=function(r){var t=r._fullLayout;if(r._context.staticPlot){w.select(r).selectAll(".drag").remove();return}if(!(!t._has("cartesian")&&!t._has("splom"))){var c=Object.keys(t._plots||{}).sort(function(i,y){if((t._plots[i].mainplot&&!0)===(t._plots[y].mainplot&&!0)){var p=i.split("y"),g=y.split("y");return p[0]===g[0]?Number(p[1]||1)-Number(g[1]||1):Number(p[0]||1)-Number(g[0]||1)}return t._plots[i].mainplot?1:-1});c.forEach(function(i){var y=t._plots[i],p=y.xaxis,g=y.yaxis;if(!y.mainplot){var h=e(r,y,p._offset,g._offset,p._length,g._length,"ns","ew");h.onmousemove=function(_){r._fullLayout._rehover=function(){r._fullLayout._hoversubplot===i&&r._fullLayout._plots[i]&&v.hover(r,_,i)},v.hover(r,_,i),r._fullLayout._lasthover=h,r._fullLayout._hoversubplot=i},h.onmouseout=function(_){r._dragging||(r._fullLayout._hoversubplot=null,S.unhover(r,_))},r._context.showAxisDragHandles&&(e(r,y,p._offset-a,g._offset-a,a,a,"n","w"),e(r,y,p._offset+p._length,g._offset-a,a,a,"n","e"),e(r,y,p._offset-a,g._offset+g._length,a,a,"s","w"),e(r,y,p._offset+p._length,g._offset+g._length,a,a,"s","e"))}if(r._context.showAxisDragHandles){if(i===p._mainSubplot){var m=p._mainLinePosition;p.side==="top"&&(m-=a),e(r,y,p._offset+p._length*.1,m,p._length*.8,a,"","ew"),e(r,y,p._offset,m,p._length*.1,a,"","w"),e(r,y,p._offset+p._length*.9,m,p._length*.1,a,"","e")}if(i===g._mainSubplot){var u=g._mainLinePosition;g.side!=="right"&&(u-=a),e(r,y,u,g._offset+g._length*.1,a,g._length*.8,"ns",""),e(r,y,u,g._offset+g._length*.9,a,g._length*.1,"s",""),e(r,y,u,g._offset,a,g._length*.1,"n","")}}});var o=t._hoverlayer.node();o.onmousemove=function(i){i.target=r._fullLayout._lasthover,v.hover(r,i,t._hoversubplot)},o.onclick=function(i){i.target=r._fullLayout._lasthover,v.click(r,i)},o.onmousedown=function(i){r._fullLayout._lasthover.onmousedown(i)},te.updateFx(r)}},te.updateFx=function(n){var r=n._fullLayout,t=r.dragmode==="pan"?"move":"crosshair";M(r._draggers,t)}},{"../../components/dragelement":386,"../../components/fx":407,"../../lib/setcursor":536,"./constants":573,"./dragbox":575,"@plotly/d3":58}],577:[function(d,ee,te){var w=d("../../registry"),v=d("../../lib"),S=d("./axis_ids");ee.exports=function(e){return function(n,r){var t=n[e];if(!!Array.isArray(t))for(var c=w.subplotsRegistry.cartesian,o=c.idRegex,i=r._subplots,y=i.xaxis,p=i.yaxis,g=i.cartesian,h=r._has("cartesian")||r._has("gl2d"),m=0;m<t.length;m++){var u=t[m];if(!!v.isPlainObject(u)){var _=S.cleanId(u.xref,"x",!1),s=S.cleanId(u.yref,"y",!1),A=o.x.test(_),b=o.y.test(s);if(A||b){h||v.pushUnique(r._basePlotModules,c);var f=!1;A&&y.indexOf(_)===-1&&(y.push(_),f=!0),b&&p.indexOf(s)===-1&&(p.push(s),f=!0),f&&A&&b&&g.push(_+s)}}}}}},{"../../lib":515,"../../registry":647,"./axis_ids":570}],578:[function(d,ee,te){var w=d("@plotly/d3"),v=d("../../registry"),S=d("../../lib"),M=d("../plots"),e=d("../../components/drawing"),a=d("../get_data").getModuleCalcData,n=d("./axis_ids"),r=d("./constants"),t=d("../../constants/xmlns_namespaces"),c=S.ensureSingle;function o(m,u,_){return S.ensureSingle(m,u,_,function(s){s.datum(_)})}te.name="cartesian",te.attr=["xaxis","yaxis"],te.idRoot=["x","y"],te.idRegex=r.idRegex,te.attrRegex=r.attrRegex,te.attributes=d("./attributes"),te.layoutAttributes=d("./layout_attributes"),te.supplyLayoutDefaults=d("./layout_defaults"),te.transitionAxes=d("./transition_axes"),te.finalizeSubplots=function(m,u){var _=u._subplots,s=_.xaxis,A=_.yaxis,b=_.cartesian,f=b.concat(_.gl2d||[]),x={},l={},L,T,k;for(L=0;L<f.length;L++){var P=f[L].split("y");x[P[0]]=1,l["y"+P[1]]=1}for(L=0;L<s.length;L++)T=s[L],x[T]||(k=(m[n.id2name(T)]||{}).anchor,r.idRegex.y.test(k)||(k="y"),b.push(T+k),f.push(T+k),l[k]||(l[k]=1,S.pushUnique(A,k)));for(L=0;L<A.length;L++)k=A[L],l[k]||(T=(m[n.id2name(k)]||{}).anchor,r.idRegex.x.test(T)||(T="x"),b.push(T+k),f.push(T+k),x[T]||(x[T]=1,S.pushUnique(s,T)));if(!f.length){T="",k="";for(var z in m)if(r.attrRegex.test(z)){var I=z.charAt(0);I==="x"?(!T||+z.substr(5)<+T.substr(5))&&(T=z):(!k||+z.substr(5)<+k.substr(5))&&(k=z)}T=T?n.name2id(T):"x",k=k?n.name2id(k):"y",s.push(T),A.push(k),b.push(T+k)}},te.plot=function(m,u,_,s){var A=m._fullLayout,b=A._subplots.cartesian,f=m.calcdata,x;if(!Array.isArray(u))for(u=[],x=0;x<f.length;x++)u.push(x);for(x=0;x<b.length;x++){for(var l=b[x],L=A._plots[l],T=[],k,P=0;P<f.length;P++){var z=f[P],I=z[0].trace;I.xaxis+I.yaxis===l&&((u.indexOf(I.index)!==-1||I.carpet)&&(k&&k[0].trace.xaxis+k[0].trace.yaxis===l&&["tonextx","tonexty","tonext"].indexOf(I.fill)!==-1&&T.indexOf(k)===-1&&T.push(k),T.push(z)),k=z)}i(m,L,T,_,s)}};function i(m,u,_,s,A){for(var b=r.traceLayerClasses,f=m._fullLayout,x=f._modules,l,L,T,k=[],P=[],z=0;z<x.length;z++){l=x[z];var I=l.name,D=v.modules[I].categories;if(D.svg){var R=l.layerName||I+"layer",B=l.plot;L=a(_,B),T=L[0],_=L[1],T.length&&k.push({i:b.indexOf(R),className:R,plotMethod:B,cdModule:T}),D.zoomScale&&P.push("."+R)}}k.sort(function(G,J){return G.i-J.i});var F=u.plot.selectAll("g.mlayer").data(k,function(G){return G.className});if(F.enter().append("g").attr("class",function(G){return G.className}).classed("mlayer",!0).classed("rangeplot",u.isRangePlot),F.exit().remove(),F.order(),F.each(function(G){var J=w.select(this),X=G.className;G.plotMethod(m,u,G.cdModule,J,s,A),r.clipOnAxisFalseQuery.indexOf("."+X)===-1&&e.setClipUrl(J,u.layerClipId,m)}),f._has("scattergl")&&(l=v.getModule("scattergl"),T=a(_,l)[0],l.plot(m,u,T)),!m._context.staticPlot&&(u._hasClipOnAxisFalse&&(u.clipOnAxisFalseTraces=u.plot.selectAll(r.clipOnAxisFalseQuery.join(",")).selectAll(".trace")),P.length)){var H=u.plot.selectAll(P.join(",")).selectAll(".trace");u.zoomScalePts=H.selectAll("path.point"),u.zoomScaleTxt=H.selectAll(".textpoint")}}te.clean=function(m,u,_,s){var A=s._plots||{},b=u._plots||{},f=s._subplots||{},x,l,L;if(s._hasOnlyLargeSploms&&!u._hasOnlyLargeSploms)for(L in A)x=A[L],x.plotgroup&&x.plotgroup.remove();var T=s._has&&s._has("gl"),k=u._has&&u._has("gl");if(T&&!k)for(L in A)x=A[L],x._scene&&x._scene.destroy();if(f.xaxis&&f.yaxis){var P=n.listIds({_fullLayout:s});for(l=0;l<P.length;l++){var z=P[l];u[n.id2name(z)]||s._infolayer.selectAll(".g-"+z+"title").remove()}}var I=s._has&&s._has("cartesian"),D=u._has&&u._has("cartesian");if(I&&!D)g(s._cartesianlayer.selectAll(".subplot"),s),s._defs.selectAll(".axesclip").remove(),delete s._axisConstraintGroups,delete s._axisMatchGroups;else if(f.cartesian)for(l=0;l<f.cartesian.length;l++){var R=f.cartesian[l];if(!b[R]){var B="."+R+",."+R+"-x,."+R+"-y";s._cartesianlayer.selectAll(B).remove(),h(R,s)}}},te.drawFramework=function(m){var u=m._fullLayout,_=y(m),s=u._cartesianlayer.selectAll(".subplot").data(_,String);s.enter().append("g").attr("class",function(A){return"subplot "+A[0]}),s.order(),s.exit().call(g,u),s.each(function(A){var b=A[0],f=u._plots[b];f.plotgroup=w.select(this),p(m,f),f.draglayer=c(u._draggers,"g",b)})},te.rangePlot=function(m,u,_){p(m,u),i(m,u,_),M.style(m)};function y(m){var u=m._fullLayout,_=u._subplots.cartesian,s=_.length,A,b,f,x,l,L,T=[],k=[];for(A=0;A<s;A++){f=_[A],x=u._plots[f],l=x.xaxis,L=x.yaxis;var P=l._mainAxis,z=L._mainAxis,I=P._id+z._id,D=u._plots[I];x.overlays=[],I!==f&&D?(x.mainplot=I,x.mainplotinfo=D,k.push(f)):(x.mainplot=void 0,x.mainplotinfo=void 0,T.push(f))}for(A=0;A<k.length;A++)f=k[A],x=u._plots[f],x.mainplotinfo.overlays.push(x);var R=T.concat(k),B=new Array(s);for(A=0;A<s;A++){f=R[A],x=u._plots[f],l=x.xaxis,L=x.yaxis;var F=[f,l.layer,L.layer,l.overlaying||"",L.overlaying||""];for(b=0;b<x.overlays.length;b++)F.push(x.overlays[b].id);B[A]=F}return B}function p(m,u){var _=u.plotgroup,s=u.id,A=r.layerValue2layerClass[u.xaxis.layer],b=r.layerValue2layerClass[u.yaxis.layer],f=m._fullLayout._hasOnlyLargeSploms;if(u.mainplot){var l=u.mainplotinfo,L=l.plotgroup,T=s+"-x",k=s+"-y";u.minorGridlayer=l.minorGridlayer,u.gridlayer=l.gridlayer,u.zerolinelayer=l.zerolinelayer,c(l.overlinesBelow,"path",T),c(l.overlinesBelow,"path",k),c(l.overaxesBelow,"g",T),c(l.overaxesBelow,"g",k),u.plot=c(l.overplot,"g",s),c(l.overlinesAbove,"path",T),c(l.overlinesAbove,"path",k),c(l.overaxesAbove,"g",T),c(l.overaxesAbove,"g",k),u.xlines=L.select(".overlines-"+A).select("."+T),u.ylines=L.select(".overlines-"+b).select("."+k),u.xaxislayer=L.select(".overaxes-"+A).select("."+T),u.yaxislayer=L.select(".overaxes-"+b).select("."+k)}else if(f)u.xlines=c(_,"path","xlines-above"),u.ylines=c(_,"path","ylines-above"),u.xaxislayer=c(_,"g","xaxislayer-above"),u.yaxislayer=c(_,"g","yaxislayer-above");else{var x=c(_,"g","layer-subplot");u.shapelayer=c(x,"g","shapelayer"),u.imagelayer=c(x,"g","imagelayer"),u.minorGridlayer=c(_,"g","minor-gridlayer"),u.gridlayer=c(_,"g","gridlayer"),u.zerolinelayer=c(_,"g","zerolinelayer"),c(_,"path","xlines-below"),c(_,"path","ylines-below"),u.overlinesBelow=c(_,"g","overlines-below"),c(_,"g","xaxislayer-below"),c(_,"g","yaxislayer-below"),u.overaxesBelow=c(_,"g","overaxes-below"),u.plot=c(_,"g","plot"),u.overplot=c(_,"g","overplot"),u.xlines=c(_,"path","xlines-above"),u.ylines=c(_,"path","ylines-above"),u.overlinesAbove=c(_,"g","overlines-above"),c(_,"g","xaxislayer-above"),c(_,"g","yaxislayer-above"),u.overaxesAbove=c(_,"g","overaxes-above"),u.xlines=_.select(".xlines-"+A),u.ylines=_.select(".ylines-"+b),u.xaxislayer=_.select(".xaxislayer-"+A),u.yaxislayer=_.select(".yaxislayer-"+b)}f||(o(u.minorGridlayer,"g",u.xaxis._id),o(u.minorGridlayer,"g",u.yaxis._id),u.minorGridlayer.selectAll("g").map(function(P){return P[0]}).sort(n.idSort),o(u.gridlayer,"g",u.xaxis._id),o(u.gridlayer,"g",u.yaxis._id),u.gridlayer.selectAll("g").map(function(P){return P[0]}).sort(n.idSort)),u.xlines.style("fill","none").classed("crisp",!0),u.ylines.style("fill","none").classed("crisp",!0)}function g(m,u){if(!!m){var _={};m.each(function(l){var L=l[0],T=w.select(this);T.remove(),h(L,u),_[L]=!0});for(var s in u._plots)for(var A=u._plots[s],b=A.overlays||[],f=0;f<b.length;f++){var x=b[f];_[x.id]&&x.plot.selectAll(".trace").remove()}}}function h(m,u){u._draggers.selectAll("g."+m).remove(),u._defs.select("#clip"+u._uid+m+"plot").remove()}te.toSVG=function(m){var u=m._fullLayout._glimages,_=w.select(m).selectAll(".svg-container"),s=_.filter(function(b,f){return f===_.size()-1}).selectAll(".gl-canvas-context, .gl-canvas-focus");function A(){var b=this,f=b.toDataURL("image/png"),x=u.append("svg:image");x.attr({xmlns:t.svg,"xlink:href":f,preserveAspectRatio:"none",x:0,y:0,width:b.style.width,height:b.style.height})}s.each(A)},te.updateFx=d("./graph_interact").updateFx},{"../../components/drawing":389,"../../constants/xmlns_namespaces":492,"../../lib":515,"../../registry":647,"../get_data":602,"../plots":628,"./attributes":564,"./axis_ids":570,"./constants":573,"./graph_interact":576,"./layout_attributes":579,"./layout_defaults":580,"./transition_axes":590,"@plotly/d3":58}],579:[function(d,ee,te){var w=d("../font_attributes"),v=d("../../components/color/attributes"),S=d("../../components/drawing/attributes").dash,M=d("../../lib/extend").extendFlat,e=d("../../plot_api/plot_template").templatedArray,a=d("../../plots/cartesian/axis_format_attributes").descriptionWithDates,n=d("../../constants/numerical").ONEDAY,r=d("./constants"),t=r.HOUR_PATTERN,c=r.WEEKDAY_PATTERN,o={valType:"enumerated",values:["auto","linear","array"],editType:"ticks",impliedEdits:{tick0:void 0,dtick:void 0}};function i(x){return{valType:"integer",min:0,dflt:x?5:0,editType:"ticks"}}var y={valType:"any",editType:"ticks",impliedEdits:{tickmode:"linear"}},p={valType:"any",editType:"ticks",impliedEdits:{tickmode:"linear"}},g={valType:"data_array",editType:"ticks"},h={valType:"enumerated",values:["outside","inside",""],editType:"ticks"};function m(x){var l={valType:"number",min:0,editType:"ticks"};return x||(l.dflt=5),l}function u(x){var l={valType:"number",min:0,editType:"ticks"};return x||(l.dflt=1),l}var _={valType:"color",dflt:v.defaultLine,editType:"ticks"},s={valType:"color",dflt:v.lightLine,editType:"ticks"};function A(x){var l={valType:"number",min:0,editType:"ticks"};return x||(l.dflt=1),l}var b=M({},S,{editType:"ticks"}),f={valType:"boolean",editType:"ticks"};ee.exports={visible:{valType:"boolean",editType:"plot"},color:{valType:"color",dflt:v.defaultLine,editType:"ticks"},title:{text:{valType:"string",editType:"ticks"},font:w({editType:"ticks"}),standoff:{valType:"number",min:0,editType:"ticks"},editType:"ticks"},type:{valType:"enumerated",values:["-","linear","log","date","category","multicategory"],dflt:"-",editType:"calc",_noTemplating:!0},autotypenumbers:{valType:"enumerated",values:["convert types","strict"],dflt:"convert types",editType:"calc"},autorange:{valType:"enumerated",values:[!0,!1,"reversed"],dflt:!0,editType:"axrange",impliedEdits:{"range[0]":void 0,"range[1]":void 0}},rangemode:{valType:"enumerated",values:["normal","tozero","nonnegative"],dflt:"normal",editType:"plot"},range:{valType:"info_array",items:[{valType:"any",editType:"axrange",impliedEdits:{"^autorange":!1},anim:!0},{valType:"any",editType:"axrange",impliedEdits:{"^autorange":!1},anim:!0}],editType:"axrange",impliedEdits:{autorange:!1},anim:!0},fixedrange:{valType:"boolean",dflt:!1,editType:"calc"},scaleanchor:{valType:"enumerated",values:[r.idRegex.x.toString(),r.idRegex.y.toString()],editType:"plot"},scaleratio:{valType:"number",min:0,dflt:1,editType:"plot"},constrain:{valType:"enumerated",values:["range","domain"],editType:"plot"},constraintoward:{valType:"enumerated",values:["left","center","right","top","middle","bottom"],editType:"plot"},matches:{valType:"enumerated",values:[r.idRegex.x.toString(),r.idRegex.y.toString()],editType:"calc"},rangebreaks:e("rangebreak",{enabled:{valType:"boolean",dflt:!0,editType:"calc"},bounds:{valType:"info_array",items:[{valType:"any",editType:"calc"},{valType:"any",editType:"calc"}],editType:"calc"},pattern:{valType:"enumerated",values:[c,t,""],editType:"calc"},values:{valType:"info_array",freeLength:!0,editType:"calc",items:{valType:"any",editType:"calc"}},dvalue:{valType:"number",editType:"calc",min:0,dflt:n},editType:"calc"}),tickmode:o,nticks:i(),tick0:y,dtick:p,ticklabelstep:{valType:"integer",min:1,dflt:1,editType:"ticks"},tickvals:g,ticktext:{valType:"data_array",editType:"ticks"},ticks:h,tickson:{valType:"enumerated",values:["labels","boundaries"],dflt:"labels",editType:"ticks"},ticklabelmode:{valType:"enumerated",values:["instant","period"],dflt:"instant",editType:"ticks"},ticklabelposition:{valType:"enumerated",values:["outside","inside","outside top","inside top","outside left","inside left","outside right","inside right","outside bottom","inside bottom"],dflt:"outside",editType:"calc"},ticklabeloverflow:{valType:"enumerated",values:["allow","hide past div","hide past domain"],editType:"calc"},mirror:{valType:"enumerated",values:[!0,"ticks",!1,"all","allticks"],dflt:!1,editType:"ticks+layoutstyle"},ticklen:m(),tickwidth:u(),tickcolor:_,showticklabels:{valType:"boolean",dflt:!0,editType:"ticks"},automargin:{valType:"flaglist",flags:["height","width","left","right","top","bottom"],extras:[!0,!1],dflt:!1,editType:"ticks"},showspikes:{valType:"boolean",dflt:!1,editType:"modebar"},spikecolor:{valType:"color",dflt:null,editType:"none"},spikethickness:{valType:"number",dflt:3,editType:"none"},spikedash:M({},S,{dflt:"dash",editType:"none"}),spikemode:{valType:"flaglist",flags:["toaxis","across","marker"],dflt:"toaxis",editType:"none"},spikesnap:{valType:"enumerated",values:["data","cursor","hovered data"],dflt:"hovered data",editType:"none"},tickfont:w({editType:"ticks"}),tickangle:{valType:"angle",dflt:"auto",editType:"ticks"},tickprefix:{valType:"string",dflt:"",editType:"ticks"},showtickprefix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"ticks"},ticksuffix:{valType:"string",dflt:"",editType:"ticks"},showticksuffix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"ticks"},showexponent:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"ticks"},exponentformat:{valType:"enumerated",values:["none","e","E","power","SI","B"],dflt:"B",editType:"ticks"},minexponent:{valType:"number",dflt:3,min:0,editType:"ticks"},separatethousands:{valType:"boolean",dflt:!1,editType:"ticks"},tickformat:{valType:"string",dflt:"",editType:"ticks",description:a("tick label")},tickformatstops:e("tickformatstop",{enabled:{valType:"boolean",dflt:!0,editType:"ticks"},dtickrange:{valType:"info_array",items:[{valType:"any",editType:"ticks"},{valType:"any",editType:"ticks"}],editType:"ticks"},value:{valType:"string",dflt:"",editType:"ticks"},editType:"ticks"}),hoverformat:{valType:"string",dflt:"",editType:"none",description:a("hover text")},showline:{valType:"boolean",dflt:!1,editType:"ticks+layoutstyle"},linecolor:{valType:"color",dflt:v.defaultLine,editType:"layoutstyle"},linewidth:{valType:"number",min:0,dflt:1,editType:"ticks+layoutstyle"},showgrid:f,gridcolor:s,gridwidth:A(),griddash:b,zeroline:{valType:"boolean",editType:"ticks"},zerolinecolor:{valType:"color",dflt:v.defaultLine,editType:"ticks"},zerolinewidth:{valType:"number",dflt:1,editType:"ticks"},showdividers:{valType:"boolean",dflt:!0,editType:"ticks"},dividercolor:{valType:"color",dflt:v.defaultLine,editType:"ticks"},dividerwidth:{valType:"number",dflt:1,editType:"ticks"},anchor:{valType:"enumerated",values:["free",r.idRegex.x.toString(),r.idRegex.y.toString()],editType:"plot"},side:{valType:"enumerated",values:["top","bottom","left","right"],editType:"plot"},overlaying:{valType:"enumerated",values:["free",r.idRegex.x.toString(),r.idRegex.y.toString()],editType:"plot"},minor:{tickmode:o,nticks:i("minor"),tick0:y,dtick:p,tickvals:g,ticks:h,ticklen:m("minor"),tickwidth:u("minor"),tickcolor:_,gridcolor:s,gridwidth:A("minor"),griddash:b,showgrid:f,editType:"ticks"},layer:{valType:"enumerated",values:["above traces","below traces"],dflt:"above traces",editType:"plot"},domain:{valType:"info_array",items:[{valType:"number",min:0,max:1,editType:"plot"},{valType:"number",min:0,max:1,editType:"plot"}],dflt:[0,1],editType:"plot"},position:{valType:"number",min:0,max:1,dflt:0,editType:"plot"},categoryorder:{valType:"enumerated",values:["trace","category ascending","category descending","array","total ascending","total descending","min ascending","min descending","max ascending","max descending","sum ascending","sum descending","mean ascending","mean descending","median ascending","median descending"],dflt:"trace",editType:"calc"},categoryarray:{valType:"data_array",editType:"calc"},uirevision:{valType:"any",editType:"none"},editType:"calc",_deprecated:{autotick:{valType:"boolean",editType:"ticks"},title:{valType:"string",editType:"ticks"},titlefont:w({editType:"ticks"})}}},{"../../components/color/attributes":366,"../../components/drawing/attributes":388,"../../constants/numerical":491,"../../lib/extend":505,"../../plot_api/plot_template":555,"../../plots/cartesian/axis_format_attributes":569,"../font_attributes":594,"./constants":573}],580:[function(d,ee,te){var w=d("../../lib"),v=d("../../components/color"),S=d("../../components/fx/helpers").isUnifiedHover,M=d("../../components/fx/hovermode_defaults"),e=d("../../plot_api/plot_template"),a=d("../layout_attributes"),n=d("./layout_attributes"),r=d("./type_defaults"),t=d("./axis_defaults"),c=d("./constraints"),o=d("./position_defaults"),i=d("./axis_ids"),y=i.id2name,p=i.name2id,g=d("./constants").AX_ID_PATTERN,h=d("../../registry"),m=h.traceIs,u=h.getComponentMethod;function _(s,A,b){Array.isArray(s[A])?s[A].push(b):s[A]=[b]}ee.exports=function(A,b,f){var x=b.autotypenumbers,l={},L={},T={},k={},P={},z={},I={},D={},R={},B={},F,H;for(F=0;F<f.length;F++){var G=f[F];if(!(!m(G,"cartesian")&&!m(G,"gl2d"))){var J;if(G.xaxis)J=y(G.xaxis),_(l,J,G);else if(G.xaxes)for(H=0;H<G.xaxes.length;H++)_(l,y(G.xaxes[H]),G);var X;if(G.yaxis)X=y(G.yaxis),_(l,X,G);else if(G.yaxes)for(H=0;H<G.yaxes.length;H++)_(l,y(G.yaxes[H]),G);if(G.type==="funnel"?G.orientation==="h"?(J&&(L[J]=!0),X&&(I[X]=!0)):X&&(T[X]=!0):G.type==="image"?(X&&(D[X]=!0),J&&(D[J]=!0)):(X&&(P[X]=!0,z[X]=!0),(!m(G,"carpet")||G.type==="carpet"&&!G._cheater)&&J&&(k[J]=!0)),G.type==="carpet"&&G._cheater&&J&&(L[J]=!0),m(G,"2dMap")&&(R[J]=!0,R[X]=!0),m(G,"oriented")){var Y=G.orientation==="h"?X:J;B[Y]=!0}}}var Z=b._subplots,oe=Z.xaxis,re=Z.yaxis,se=w.simpleMap(oe,y),N=w.simpleMap(re,y),U=se.concat(N),q=v.background;oe.length&&re.length&&(q=w.coerce(A,b,a,"plot_bgcolor"));var $=v.combine(q,b.paper_bgcolor),W,K,ne,ae,ie;function le(){var Ve=l[W]||[];ie._traceIndices=Ve.map(function(Ae){return Ae._expandedIndex}),ie._annIndices=[],ie._shapeIndices=[],ie._selectionIndices=[],ie._imgIndices=[],ie._subplotsWith=[],ie._counterAxes=[],ie._name=ie._attr=W,ie._id=K}function ye(Ve,Ae){return w.coerce(ae,ie,n,Ve,Ae)}function ue(Ve,Ae){return w.coerce2(ae,ie,n,Ve,Ae)}function pe(Ve){return Ve==="x"?re:oe}function ge(Ve,Ae){for(var Ne=Ve==="x"?se:N,Xe=[],Je=0;Je<Ne.length;Je++){var _t=Ne[Je];_t!==Ae&&!(A[_t]||{}).overlaying&&Xe.push(p(_t))}return Xe}var Te={x:pe("x"),y:pe("y")},_e=Te.x.concat(Te.y),ze={},Oe=[];function Ye(){var Ve=ae.matches;g.test(Ve)&&_e.indexOf(Ve)===-1&&(ze[Ve]=ae.type,Oe=Object.keys(ze))}var be=M(A,b),Pe=S(be);for(F=0;F<U.length;F++){W=U[F],K=p(W),ne=W.charAt(0),w.isPlainObject(A[W])||(A[W]={}),ae=A[W],ie=e.newContainer(b,W,ne+"axis"),le();var Ge=ne==="x"&&!k[W]&&L[W]||ne==="y"&&!P[W]&&T[W],Qe=ne==="y"&&(!z[W]&&I[W]||D[W]),Be={hasMinor:!0,letter:ne,font:b.font,outerTicks:R[W],showGrid:!B[W],data:l[W]||[],bgColor:$,calendar:b.calendar,automargin:!0,visibleDflt:Ge,reverseDflt:Qe,autotypenumbersDflt:x,splomStash:((b._splomAxes||{})[ne]||{})[K]};ye("uirevision",b.uirevision),r(ae,ie,ye,Be),t(ae,ie,ye,Be,b);var Le=Pe&&ne===be.charAt(0),He=ue("spikecolor",Pe?ie.color:void 0),vt=ue("spikethickness",Pe?1.5:void 0),Rt=ue("spikedash",Pe?"dot":void 0),rr=ue("spikemode",Pe?"across":void 0),Lt=ue("spikesnap"),Ft=ye("showspikes",!!Le||!!He||!!vt||!!Rt||!!rr||!!Lt);Ft||(delete ie.spikecolor,delete ie.spikethickness,delete ie.spikedash,delete ie.spikemode,delete ie.spikesnap),o(ae,ie,ye,{letter:ne,counterAxes:Te[ne],overlayableAxes:ge(ne,W),grid:b.grid}),ye("title.standoff"),Ye(),ie._input=ae}for(F=0;F<Oe.length;){K=Oe[F++],W=y(K),ne=W.charAt(0),w.isPlainObject(A[W])||(A[W]={}),ae=A[W],ie=e.newContainer(b,W,ne+"axis"),le();var Gt={letter:ne,font:b.font,outerTicks:R[W],showGrid:!B[W],data:[],bgColor:$,calendar:b.calendar,automargin:!0,visibleDflt:!1,reverseDflt:!1,autotypenumbersDflt:x,splomStash:((b._splomAxes||{})[ne]||{})[K]};ye("uirevision",b.uirevision),ie.type=ze[K]||"linear",t(ae,ie,ye,Gt,b),o(ae,ie,ye,{letter:ne,counterAxes:Te[ne],overlayableAxes:ge(ne,W),grid:b.grid}),ye("fixedrange"),Ye(),ie._input=ae}var Dt=u("rangeslider","handleDefaults"),kt=u("rangeselector","handleDefaults");for(F=0;F<se.length;F++)W=se[F],ae=A[W],ie=b[W],Dt(A,b,W),ie.type==="date"&&kt(ae,ie,b,N,ie.calendar),ye("fixedrange");for(F=0;F<N.length;F++){W=N[F],ae=A[W],ie=b[W];var Ue=b[y(ie.anchor)],qe=u("rangeslider","isVisible")(Ue);ye("fixedrange",qe)}c.handleDefaults(A,b,{axIds:_e.concat(Oe).sort(i.idSort),axHasImage:D})}},{"../../components/color":367,"../../components/fx/helpers":403,"../../components/fx/hovermode_defaults":406,"../../lib":515,"../../plot_api/plot_template":555,"../../registry":647,"../layout_attributes":619,"./axis_defaults":568,"./axis_ids":570,"./constants":573,"./constraints":574,"./layout_attributes":579,"./position_defaults":582,"./type_defaults":591}],581:[function(d,ee,te){var w=d("tinycolor2").mix,v=d("../../components/color/attributes"),S=d("../../lib");ee.exports=function(e,a,n,r){r=r||{};var t=r.dfltColor;function c(T,k){return S.coerce2(e,a,r.attributes,T,k)}var o=c("linecolor",t),i=c("linewidth"),y=n("showline",r.showLine||!!o||!!i);y||(delete a.linecolor,delete a.linewidth);var p=w(t,r.bgColor,r.blend||v.lightFraction).toRgbString(),g=c("gridcolor",p),h=c("gridwidth"),m=c("griddash"),u=n("showgrid",r.showGrid||!!g||!!h||!!m);if(u||(delete a.gridcolor,delete a.gridwidth,delete a.griddash),r.hasMinor){var _=w(a.gridcolor,r.bgColor,67).toRgbString(),s=c("minor.gridcolor",_),A=c("minor.gridwidth",a.gridwidth||1),b=c("minor.griddash",a.griddash||"solid"),f=n("minor.showgrid",!!s||!!A||!!b);f||(delete a.minor.gridcolor,delete a.minor.gridwidth,delete a.minor.griddash)}if(!r.noZeroLine){var x=c("zerolinecolor",t),l=c("zerolinewidth"),L=n("zeroline",r.showGrid||!!x||!!l);L||(delete a.zerolinecolor,delete a.zerolinewidth)}}},{"../../components/color/attributes":366,"../../lib":515,tinycolor2:313}],582:[function(d,ee,te){var w=d("fast-isnumeric"),v=d("../../lib");ee.exports=function(M,e,a,n){var r=n.counterAxes||[],t=n.overlayableAxes||[],c=n.letter,o=n.grid,i,y,p,g;o&&(y=o._domains[c][o._axisMap[e._id]],i=o._anchors[e._id],y&&(p=o[c+"side"].split(" ")[0],g=o.domain[c][p==="right"||p==="top"?1:0])),y=y||[0,1],i=i||(w(M.position)?"free":r[0]||"free"),p=p||(c==="x"?"bottom":"left"),g=g||0;var h=v.coerce(M,e,{anchor:{valType:"enumerated",values:["free"].concat(r),dflt:i}},"anchor");h==="free"&&a("position",g),v.coerce(M,e,{side:{valType:"enumerated",values:c==="x"?["bottom","top"]:["left","right"],dflt:p}},"side");var m=!1;if(t.length&&(m=v.coerce(M,e,{overlaying:{valType:"enumerated",values:[!1].concat(t),dflt:!1}},"overlaying")),!m){var u=a("domain",y);u[0]>u[1]-1/4096&&(e.domain=y),v.noneOrAll(M.domain,e.domain,y)}return a("layer"),e}},{"../../lib":515,"fast-isnumeric":190}],583:[function(d,ee,te){var w=d("./show_dflt");ee.exports=function(S,M,e,a,n){n||(n={});var r=n.tickSuffixDflt,t=w(S),c=e("tickprefix");c&&e("showtickprefix",t);var o=e("ticksuffix",r);o&&e("showticksuffix",t)}},{"./show_dflt":586}],584:[function(d,ee,te){var w=d("../../constants/alignment").FROM_BL;ee.exports=function(S,M,e){e===void 0&&(e=w[S.constraintoward||"center"]);var a=[S.r2l(S.range[0]),S.r2l(S.range[1])],n=a[0]+(a[1]-a[0])*e;S.range=S._input.range=[S.l2r(n+(a[0]-n)*M),S.l2r(n+(a[1]-n)*M)],S.setScale()}},{"../../constants/alignment":483}],585:[function(d,ee,te){var w=d("@plotly/d3"),v=d("d3-time-format").utcFormat,S=d("../../lib"),M=S.numberFormat,e=d("fast-isnumeric"),a=S.cleanNumber,n=S.ms2DateTime,r=S.dateTime2ms,t=S.ensureNumber,c=S.isArrayOrTypedArray,o=d("../../constants/numerical"),i=o.FP_SAFE,y=o.BADNUM,p=o.LOG_CLIP,g=o.ONEWEEK,h=o.ONEDAY,m=o.ONEHOUR,u=o.ONEMIN,_=o.ONESEC,s=d("./axis_ids"),A=d("./constants"),b=A.HOUR_PATTERN,f=A.WEEKDAY_PATTERN;function x(L){return Math.pow(10,L)}function l(L){return L!=null}ee.exports=function(T,k){k=k||{};var P=T._id||"x",z=P.charAt(0);function I(U,q){if(U>0)return Math.log(U)/Math.LN10;if(U<=0&&q&&T.range&&T.range.length===2){var $=T.range[0],W=T.range[1];return .5*($+W-2*p*Math.abs($-W))}else return y}function D(U,q,$,W){if((W||{}).msUTC&&e(U))return+U;var K=r(U,$||T.calendar);if(K===y)if(e(U)){U=+U;var ne=Math.floor(S.mod(U+.05,1)*10),ae=Math.round(U-ne/10);K=r(new Date(ae))+ne/10}else return y;return K}function R(U,q,$){return n(U,q,$||T.calendar)}function B(U){return T._categories[Math.round(U)]}function F(U){if(l(U)){if(T._categoriesMap===void 0&&(T._categoriesMap={}),T._categoriesMap[U]!==void 0)return T._categoriesMap[U];T._categories.push(typeof U=="number"?String(U):U);var q=T._categories.length-1;return T._categoriesMap[U]=q,q}return y}function H(U,q){for(var $=new Array(q),W=0;W<q;W++){var K=(U[0]||[])[W],ne=(U[1]||[])[W];$[W]=G([K,ne])}return $}function G(U){if(T._categoriesMap)return T._categoriesMap[U]}function J(U){var q=G(U);if(q!==void 0)return q;if(e(U))return+U}function X(U){return e(U)?+U:G(U)}function Y(U,q,$){return w.round($+q*U,2)}function Z(U,q,$){return(U-$)/q}var oe=function(q){return e(q)?Y(q,T._m,T._b):y},re=function(U){return Z(U,T._m,T._b)};if(T.rangebreaks){var se=z==="y";oe=function(U){if(!e(U))return y;var q=T._rangebreaks.length;if(!q)return Y(U,T._m,T._b);var $=se;T.range[0]>T.range[1]&&($=!$);for(var W=$?-1:1,K=W*U,ne=0,ae=0;ae<q;ae++){var ie=W*T._rangebreaks[ae].min,le=W*T._rangebreaks[ae].max;if(K<ie)break;if(K>le)ne=ae+1;else{ne=K<(ie+le)/2?ae:ae+1;break}}var ye=T._B[ne]||0;return isFinite(ye)?Y(U,T._m2,ye):0},re=function(U){var q=T._rangebreaks.length;if(!q)return Z(U,T._m,T._b);for(var $=0,W=0;W<q&&!(U<T._rangebreaks[W].pmin);W++)U>T._rangebreaks[W].pmax&&($=W+1);return Z(U,T._m2,T._B[$])}}T.c2l=T.type==="log"?I:t,T.l2c=T.type==="log"?x:t,T.l2p=oe,T.p2l=re,T.c2p=T.type==="log"?function(U,q){return oe(I(U,q))}:oe,T.p2c=T.type==="log"?function(U){return x(re(U))}:re,["linear","-"].indexOf(T.type)!==-1?(T.d2r=T.r2d=T.d2c=T.r2c=T.d2l=T.r2l=a,T.c2d=T.c2r=T.l2d=T.l2r=t,T.d2p=T.r2p=function(U){return T.l2p(a(U))},T.p2d=T.p2r=re,T.cleanPos=t):T.type==="log"?(T.d2r=T.d2l=function(U,q){return I(a(U),q)},T.r2d=T.r2c=function(U){return x(a(U))},T.d2c=T.r2l=a,T.c2d=T.l2r=t,T.c2r=I,T.l2d=x,T.d2p=function(U,q){return T.l2p(T.d2r(U,q))},T.p2d=function(U){return x(re(U))},T.r2p=function(U){return T.l2p(a(U))},T.p2r=re,T.cleanPos=t):T.type==="date"?(T.d2r=T.r2d=S.identity,T.d2c=T.r2c=T.d2l=T.r2l=D,T.c2d=T.c2r=T.l2d=T.l2r=R,T.d2p=T.r2p=function(U,q,$){return T.l2p(D(U,0,$))},T.p2d=T.p2r=function(U,q,$){return R(re(U),q,$)},T.cleanPos=function(U){return S.cleanDate(U,y,T.calendar)}):T.type==="category"?(T.d2c=T.d2l=F,T.r2d=T.c2d=T.l2d=B,T.d2r=T.d2l_noadd=J,T.r2c=function(U){var q=X(U);return q!==void 0?q:T.fraction2r(.5)},T.l2r=T.c2r=t,T.r2l=X,T.d2p=function(U){return T.l2p(T.r2c(U))},T.p2d=function(U){return B(re(U))},T.r2p=T.d2p,T.p2r=re,T.cleanPos=function(U){return typeof U=="string"&&U!==""?U:t(U)}):T.type==="multicategory"&&(T.r2d=T.c2d=T.l2d=B,T.d2r=T.d2l_noadd=J,T.r2c=function(U){var q=J(U);return q!==void 0?q:T.fraction2r(.5)},T.r2c_just_indices=G,T.l2r=T.c2r=t,T.r2l=J,T.d2p=function(U){return T.l2p(T.r2c(U))},T.p2d=function(U){return B(re(U))},T.r2p=T.d2p,T.p2r=re,T.cleanPos=function(U){return Array.isArray(U)||typeof U=="string"&&U!==""?U:t(U)},T.setupMultiCategory=function(U){var q=T._traceIndices,$,W,K=T._matchGroup;if(K&&T._categories.length===0){for(var ne in K)if(ne!==P){var ae=k[s.id2name(ne)];q=q.concat(ae._traceIndices)}}var ie=[[0,{}],[0,{}]],le=[];for($=0;$<q.length;$++){var ye=U[q[$]];if(z in ye){var ue=ye[z],pe=ye._length||S.minRowLength(ue);if(c(ue[0])&&c(ue[1]))for(W=0;W<pe;W++){var ge=ue[0][W],Te=ue[1][W];l(ge)&&l(Te)&&(le.push([ge,Te]),ge in ie[0][1]||(ie[0][1][ge]=ie[0][0]++),Te in ie[1][1]||(ie[1][1][Te]=ie[1][0]++))}}}for(le.sort(function(_e,ze){var Oe=ie[0][1],Ye=Oe[_e[0]]-Oe[ze[0]];if(Ye)return Ye;var be=ie[1][1];return be[_e[1]]-be[ze[1]]}),$=0;$<le.length;$++)F(le[$])}),T.fraction2r=function(U){var q=T.r2l(T.range[0]),$=T.r2l(T.range[1]);return T.l2r(q+U*($-q))},T.r2fraction=function(U){var q=T.r2l(T.range[0]),$=T.r2l(T.range[1]);return(T.r2l(U)-q)/($-q)},T.cleanRange=function(U,q){q||(q={}),U||(U="range");var $=S.nestedProperty(T,U).get(),W,K;if(T.type==="date"?K=S.dfltRange(T.calendar):z==="y"?K=A.DFLTRANGEY:T._name==="realaxis"?K=[0,1]:K=q.dfltRange||A.DFLTRANGEX,K=K.slice(),(T.rangemode==="tozero"||T.rangemode==="nonnegative")&&(K[0]=0),!$||$.length!==2){S.nestedProperty(T,U).set(K);return}for(T.type==="date"&&!T.autorange&&($[0]=S.cleanDate($[0],y,T.calendar),$[1]=S.cleanDate($[1],y,T.calendar)),W=0;W<2;W++)if(T.type==="date"){if(!S.isDateTime($[W],T.calendar)){T[U]=K;break}if(T.r2l($[0])===T.r2l($[1])){var ne=S.constrain(T.r2l($[0]),S.MIN_MS+1e3,S.MAX_MS-1e3);$[0]=T.l2r(ne-1e3),$[1]=T.l2r(ne+1e3);break}}else{if(!e($[W]))if(e($[1-W]))$[W]=$[1-W]*(W?10:.1);else{T[U]=K;break}if($[W]<-i?$[W]=-i:$[W]>i&&($[W]=i),$[0]===$[1]){var ae=Math.max(1,Math.abs($[0]*1e-6));$[0]-=ae,$[1]+=ae}}},T.setScale=function(U){var q=k._size;if(T.overlaying){var $=s.getFromId({_fullLayout:k},T.overlaying);T.domain=$.domain}var W=U&&T._r?"_r":"range",K=T.calendar;T.cleanRange(W);var ne=T.r2l(T[W][0],K),ae=T.r2l(T[W][1],K),ie=z==="y";if(ie?(T._offset=q.t+(1-T.domain[1])*q.h,T._length=q.h*(T.domain[1]-T.domain[0]),T._m=T._length/(ne-ae),T._b=-T._m*ae):(T._offset=q.l+T.domain[0]*q.w,T._length=q.w*(T.domain[1]-T.domain[0]),T._m=T._length/(ae-ne),T._b=-T._m*ne),T._rangebreaks=[],T._lBreaks=0,T._m2=0,T._B=[],T.rangebreaks){var le,ye;if(T._rangebreaks=T.locateBreaks(Math.min(ne,ae),Math.max(ne,ae)),T._rangebreaks.length){for(le=0;le<T._rangebreaks.length;le++)ye=T._rangebreaks[le],T._lBreaks+=Math.abs(ye.max-ye.min);var ue=ie;ne>ae&&(ue=!ue),ue&&T._rangebreaks.reverse();var pe=ue?-1:1;for(T._m2=pe*T._length/(Math.abs(ae-ne)-T._lBreaks),T._B.push(-T._m2*(ie?ae:ne)),le=0;le<T._rangebreaks.length;le++)ye=T._rangebreaks[le],T._B.push(T._B[T._B.length-1]-pe*T._m2*(ye.max-ye.min));for(le=0;le<T._rangebreaks.length;le++)ye=T._rangebreaks[le],ye.pmin=oe(ye.min),ye.pmax=oe(ye.max)}}if(!isFinite(T._m)||!isFinite(T._b)||T._length<0)throw k._replotting=!1,new Error("Something went wrong with axis scaling")},T.maskBreaks=function(U){var q=T.rangebreaks||[],$,W,K,ne,ae;q._cachedPatterns||(q._cachedPatterns=q.map(function(Oe){return Oe.enabled&&Oe.bounds?S.simpleMap(Oe.bounds,Oe.pattern?a:T.d2c):null})),q._cachedValues||(q._cachedValues=q.map(function(Oe){return Oe.enabled&&Oe.values?S.simpleMap(Oe.values,T.d2c).sort(S.sorterAsc):null}));for(var ie=0;ie<q.length;ie++){var le=q[ie];if(le.enabled){if(le.bounds){var ye=le.pattern;switch($=q._cachedPatterns[ie],W=$[0],K=$[1],ye){case f:ae=new Date(U),ne=ae.getUTCDay(),W>K&&(K+=7,ne<W&&(ne+=7));break;case b:ae=new Date(U);var ue=ae.getUTCHours(),pe=ae.getUTCMinutes(),ge=ae.getUTCSeconds(),Te=ae.getUTCMilliseconds();ne=ue+(pe/60+ge/3600+Te/36e5),W>K&&(K+=24,ne<W&&(ne+=24));break;case"":ne=U;break}if(ne>=W&&ne<K)return y}else for(var _e=q._cachedValues[ie],ze=0;ze<_e.length;ze++)if(W=_e[ze],K=W+le.dvalue,U>=W&&U<K)return y}}return U},T.locateBreaks=function(U,q){var $,W,K,ne,ae=[];if(!T.rangebreaks)return ae;var ie=T.rangebreaks.slice().sort(function(be,Pe){return be.pattern===f&&Pe.pattern===b?-1:Pe.pattern===f&&be.pattern===b?1:0}),le=function(be,Pe){if(be=S.constrain(be,U,q),Pe=S.constrain(Pe,U,q),be!==Pe){for(var Ge=!0,Qe=0;Qe<ae.length;Qe++){var Be=ae[Qe];be<Be.max&&Pe>=Be.min&&(be<Be.min&&(Be.min=be),Pe>Be.max&&(Be.max=Pe),Ge=!1)}Ge&&ae.push({min:be,max:Pe})}};for($=0;$<ie.length;$++){var ye=ie[$];if(ye.enabled)if(ye.bounds){var ue=U,pe=q;ye.pattern&&(ue=Math.floor(ue)),W=S.simpleMap(ye.bounds,ye.pattern?a:T.r2l),K=W[0],ne=W[1];var ge=new Date(ue),Te,_e;switch(ye.pattern){case f:_e=g,Te=((ne<K?7:0)+(ne-K))*h,ue+=K*h-(ge.getUTCDay()*h+ge.getUTCHours()*m+ge.getUTCMinutes()*u+ge.getUTCSeconds()*_+ge.getUTCMilliseconds());break;case b:_e=h,Te=((ne<K?24:0)+(ne-K))*m,ue+=K*m-(ge.getUTCHours()*m+ge.getUTCMinutes()*u+ge.getUTCSeconds()*_+ge.getUTCMilliseconds());break;default:ue=Math.min(W[0],W[1]),pe=Math.max(W[0],W[1]),_e=pe-ue,Te=_e}for(var ze=ue;ze<pe;ze+=_e)le(ze,ze+Te)}else for(var Oe=S.simpleMap(ye.values,T.d2c),Ye=0;Ye<Oe.length;Ye++)K=Oe[Ye],ne=K+ye.dvalue,le(K,ne)}return ae.sort(function(be,Pe){return be.min-Pe.min}),ae},T.makeCalcdata=function(U,q,$){var W,K,ne,ae,ie=T.type,le=ie==="date"&&U[q+"calendar"];if(q in U){if(W=U[q],ae=U._length||S.minRowLength(W),S.isTypedArray(W)&&(ie==="linear"||ie==="log")){if(ae===W.length)return W;if(W.subarray)return W.subarray(0,ae)}if(ie==="multicategory")return H(W,ae);for(K=new Array(ae),ne=0;ne<ae;ne++)K[ne]=T.d2c(W[ne],0,le,$)}else{var ye=q+"0"in U?T.d2c(U[q+"0"],0,le):0,ue=U["d"+q]?Number(U["d"+q]):1;for(W=U[{x:"y",y:"x"}[q]],ae=U._length||W.length,K=new Array(ae),ne=0;ne<ae;ne++)K[ne]=ye+ne*ue}if(T.rangebreaks)for(ne=0;ne<ae;ne++)K[ne]=T.maskBreaks(K[ne]);return K},T.isValidRange=function(U){return Array.isArray(U)&&U.length===2&&e(T.r2l(U[0]))&&e(T.r2l(U[1]))},T.isPtWithinRange=function(U,q){var $=T.c2l(U[z],null,q),W=T.r2l(T.range[0]),K=T.r2l(T.range[1]);return W<K?W<=$&&$<=K:K<=$&&$<=W},T._emptyCategories=function(){T._categories=[],T._categoriesMap={}},T.clearCalc=function(){var U=T._matchGroup;if(U){var q=null,$=null;for(var W in U){var K=k[s.id2name(W)];if(K._categories){q=K._categories,$=K._categoriesMap;break}}q&&$?(T._categories=q,T._categoriesMap=$):T._emptyCategories()}else T._emptyCategories();if(T._initialCategories)for(var ne=0;ne<T._initialCategories.length;ne++)F(T._initialCategories[ne])},T.sortByInitialCategories=function(){var U=[];if(T._emptyCategories(),T._initialCategories)for(var q=0;q<T._initialCategories.length;q++)F(T._initialCategories[q]);U=U.concat(T._traceIndices);var $=T._matchGroup;for(var W in $)if(P!==W){var K=k[s.id2name(W)];K._categories=T._categories,K._categoriesMap=T._categoriesMap,U=U.concat(K._traceIndices)}return U};var N=k._d3locale;T.type==="date"&&(T._dateFormat=N?N.timeFormat:v,T._extraFormat=k._extraFormat),T._separators=k.separators,T._numFormat=N?N.numberFormat:M,delete T._minDtick,delete T._forceTick0}},{"../../constants/numerical":491,"../../lib":515,"./axis_ids":570,"./constants":573,"@plotly/d3":58,"d3-time-format":120,"fast-isnumeric":190}],586:[function(d,ee,te){ee.exports=function(v){var S=["showexponent","showtickprefix","showticksuffix"],M=S.filter(function(a){return v[a]!==void 0}),e=function(a){return v[a]===v[M[0]]};if(M.every(e)||M.length===1)return v[M[0]]}},{}],587:[function(d,ee,te){var w=d("../../lib"),v=d("../../components/color").contrast,S=d("./layout_attributes"),M=d("./show_dflt"),e=d("../array_container_defaults");ee.exports=function(r,t,c,o,i){i||(i={});var y=M(r),p=c("showticklabels");if(p){var g=i.font||{},h=t.color,m=t.ticklabelposition||"",u=m.indexOf("inside")!==-1?v(i.bgColor):h&&h!==S.color.dflt?h:g.color;if(w.coerceFont(c,"tickfont",{family:g.family,size:g.size,color:u}),!i.noTicklabelstep&&o!=="multicategory"&&o!=="log"&&c("ticklabelstep"),i.noAng||c("tickangle"),o!=="category"){var _=c("tickformat");e(r,t,{name:"tickformatstops",inclusionAttr:"enabled",handleItemDefaults:a}),t.tickformatstops.length||delete t.tickformatstops,!i.noExp&&!_&&o!=="date"&&(c("showexponent",y),c("exponentformat"),c("minexponent"),c("separatethousands"))}}};function a(n,r){function t(o,i){return w.coerce(n,r,S.tickformatstops,o,i)}var c=t("enabled");c&&(t("dtickrange"),t("value"))}},{"../../components/color":367,"../../lib":515,"../array_container_defaults":561,"./layout_attributes":579,"./show_dflt":586}],588:[function(d,ee,te){var w=d("../../lib"),v=d("./layout_attributes");ee.exports=function(M,e,a,n){var r=n.isMinor,t=r?M.minor||{}:M,c=r?e.minor:e,o=r?v.minor:v,i=r?"minor.":"",y=w.coerce2(t,c,o,"ticklen",r?(e.ticklen||5)*.6:void 0),p=w.coerce2(t,c,o,"tickwidth",r?e.tickwidth||1:void 0),g=w.coerce2(t,c,o,"tickcolor",(r?e.tickcolor:void 0)||c.color),h=a(i+"ticks",!r&&n.outerTicks||y||p||g?"outside":"");h||(delete c.ticklen,delete c.tickwidth,delete c.tickcolor)}},{"../../lib":515,"./layout_attributes":579}],589:[function(d,ee,te){var w=d("./clean_ticks"),v=d("../../lib").isArrayOrTypedArray;ee.exports=function(M,e,a,n,r){r||(r={});var t=r.isMinor,c=t?M.minor||{}:M,o=t?e.minor:e,i=t?"minor.":"";function y(A){var b=c[A];return b!==void 0?b:(o._template||{})[A]}var p=y("tick0"),g=y("dtick"),h=y("tickvals"),m=v(h)?"array":g?"linear":"auto",u=a(i+"tickmode",m);if(u==="auto")a(i+"nticks");else if(u==="linear"){var _=o.dtick=w.dtick(g,n);o.tick0=w.tick0(p,n,e.calendar,_)}else if(n!=="multicategory"){var s=a(i+"tickvals");s===void 0?o.tickmode="auto":t||a("ticktext")}}},{"../../lib":515,"./clean_ticks":572}],590:[function(d,ee,te){var w=d("@plotly/d3"),v=d("../../registry"),S=d("../../lib"),M=d("../../components/drawing"),e=d("./axes");ee.exports=function(n,r,t,c){var o=n._fullLayout;if(r.length===0){e.redrawComponents(n);return}function i(b){var f=b.xaxis,x=b.yaxis;o._defs.select("#"+b.clipId+"> rect").call(M.setTranslate,0,0).call(M.setScale,1,1),b.plot.call(M.setTranslate,f._offset,x._offset).call(M.setScale,1,1);var l=b.plot.selectAll(".scatterlayer .trace");l.selectAll(".point").call(M.setPointGroupScale,1,1),l.selectAll(".textpoint").call(M.setTextPointsScale,1,1),l.call(M.hideOutsideRangePoints,b)}function y(b,f){var x=b.plotinfo,l=x.xaxis,L=x.yaxis,T=l._length,k=L._length,P=!!b.xr1,z=!!b.yr1,I=[];if(P){var D=S.simpleMap(b.xr0,l.r2l),R=S.simpleMap(b.xr1,l.r2l),B=D[1]-D[0],F=R[1]-R[0];I[0]=(D[0]*(1-f)+f*R[0]-D[0])/(D[1]-D[0])*T,I[2]=T*(1-f+f*F/B),l.range[0]=l.l2r(D[0]*(1-f)+f*R[0]),l.range[1]=l.l2r(D[1]*(1-f)+f*R[1])}else I[0]=0,I[2]=T;if(z){var H=S.simpleMap(b.yr0,L.r2l),G=S.simpleMap(b.yr1,L.r2l),J=H[1]-H[0],X=G[1]-G[0];I[1]=(H[1]*(1-f)+f*G[1]-H[1])/(H[0]-H[1])*k,I[3]=k*(1-f+f*X/J),L.range[0]=l.l2r(H[0]*(1-f)+f*G[0]),L.range[1]=L.l2r(H[1]*(1-f)+f*G[1])}else I[1]=0,I[3]=k;e.drawOne(n,l,{skipTitle:!0}),e.drawOne(n,L,{skipTitle:!0}),e.redrawComponents(n,[l._id,L._id]);var Y=P?T/I[2]:1,Z=z?k/I[3]:1,oe=P?I[0]:0,re=z?I[1]:0,se=P?I[0]/I[2]*T:0,N=z?I[1]/I[3]*k:0,U=l._offset-se,q=L._offset-N;x.clipRect.call(M.setTranslate,oe,re).call(M.setScale,1/Y,1/Z),x.plot.call(M.setTranslate,U,q).call(M.setScale,Y,Z),M.setPointGroupScale(x.zoomScalePts,1/Y,1/Z),M.setTextPointsScale(x.zoomScaleTxt,1/Y,1/Z)}var p;c&&(p=c());function g(){for(var b={},f=0;f<r.length;f++){var x=r[f],l=x.plotinfo.xaxis,L=x.plotinfo.yaxis;x.xr1&&(b[l._name+".range"]=x.xr1.slice()),x.yr1&&(b[L._name+".range"]=x.yr1.slice())}return p&&p(),v.call("relayout",n,b).then(function(){for(var T=0;T<r.length;T++)i(r[T].plotinfo)})}function h(){for(var b={},f=0;f<r.length;f++){var x=r[f],l=x.plotinfo.xaxis,L=x.plotinfo.yaxis;x.xr0&&(b[l._name+".range"]=x.xr0.slice()),x.yr0&&(b[L._name+".range"]=x.yr0.slice())}return v.call("relayout",n,b).then(function(){for(var T=0;T<r.length;T++)i(r[T].plotinfo)})}var m,u,_,s=w.ease(t.easing);n._transitionData._interruptCallbacks.push(function(){return window.cancelAnimationFrame(_),_=null,h()});function A(){u=Date.now();for(var b=Math.min(1,(u-m)/t.duration),f=s(b),x=0;x<r.length;x++)y(r[x],f);u-m>t.duration?(g(),_=window.cancelAnimationFrame(A)):_=window.requestAnimationFrame(A)}return m=Date.now(),_=window.requestAnimationFrame(A),Promise.resolve()}},{"../../components/drawing":389,"../../lib":515,"../../registry":647,"./axes":566,"@plotly/d3":58}],591:[function(d,ee,te){var w=d("../../registry").traceIs,v=d("./axis_autotype");ee.exports=function(r,t,c,o){c("autotypenumbers",o.autotypenumbersDflt);var i=c("type",(o.splomStash||{}).type);i==="-"&&(S(t,o.data),t.type==="-"?t.type="linear":r.type=t.type)};function S(n,r){if(n.type==="-"){var t=n._id,c=t.charAt(0),o;t.indexOf("scene")!==-1&&(t=c);var i=M(r,t,c);if(!!i){if(i.type==="histogram"&&c==={v:"y",h:"x"}[i.orientation||"v"]){n.type="linear";return}var y=c+"calendar",p=i[y],g={noMultiCategory:!w(i,"cartesian")||w(i,"noMultiCategory")};if(i.type==="box"&&i._hasPreCompStats&&c==={h:"x",v:"y"}[i.orientation||"v"]&&(g.noMultiCategory=!0),g.autotypenumbers=n.autotypenumbers,a(i,c)){var h=e(i),m=[];for(o=0;o<r.length;o++){var u=r[o];!w(u,"box-violin")||(u[c+"axis"]||c)!==t||(u[h]!==void 0?m.push(u[h][0]):u.name!==void 0?m.push(u.name):m.push("text"),u[y]!==p&&(p=void 0))}n.type=v(m,p,g)}else if(i.type==="splom"){var _=i.dimensions,s=_[i._axesDim[t]];s.visible&&(n.type=v(s.values,p,g))}else n.type=v(i[c]||[i[c+"0"]],p,g)}}}function M(n,r,t){for(var c=0;c<n.length;c++){var o=n[c];if(o.type==="splom"&&o._length>0&&(o["_"+t+"axes"]||{})[r])return o;if((o[t+"axis"]||t)===r){if(a(o,t))return o;if((o[t]||[]).length||o[t+"0"])return o}}}function e(n){return{v:"x",h:"y"}[n.orientation||"v"]}function a(n,r){var t=e(n),c=w(n,"box-violin"),o=w(n._fullInput||{},"candlestick");return c&&!o&&r===t&&n[t]===void 0&&n[t+"0"]===void 0}},{"../../registry":647,"./axis_autotype":567}],592:[function(d,ee,te){var w=d("../registry"),v=d("../lib");te.manageCommandObserver=function(r,t,c,o){var i={},y=!0;t&&t._commandObserver&&(i=t._commandObserver),i.cache||(i.cache={}),i.lookupTable={};var p=te.hasSimpleAPICommandBindings(r,c,i.lookupTable);if(t&&t._commandObserver){if(p)return i;if(t._commandObserver.remove)return t._commandObserver.remove(),t._commandObserver=null,i}if(p){S(r,p,i.cache),i.check=function(){if(!!y){var u=S(r,p,i.cache);return u.changed&&o&&i.lookupTable[u.value]!==void 0&&(i.disable(),Promise.resolve(o({value:u.value,type:p.type,prop:p.prop,traces:p.traces,index:i.lookupTable[u.value]})).then(i.enable,i.enable)),u.changed}};for(var g=["plotly_relayout","plotly_redraw","plotly_restyle","plotly_update","plotly_animatingframe","plotly_afterplot"],h=0;h<g.length;h++)r._internalOn(g[h],i.check);i.remove=function(){for(var m=0;m<g.length;m++)r._removeInternalListener(g[m],i.check)}}else v.log("Unable to automatically bind plot updates to API command"),i.lookupTable={},i.remove=function(){};return i.disable=function(){y=!1},i.enable=function(){y=!0},t&&(t._commandObserver=i),i},te.hasSimpleAPICommandBindings=function(r,t,c){var o,i=t.length,y;for(o=0;o<i;o++){var p,g=t[o],h=g.method,m=g.args;if(Array.isArray(m)||(m=[]),!h)return!1;var u=te.computeAPICommandBindings(r,h,m);if(u.length!==1)return!1;if(!y)y=u[0],Array.isArray(y.traces)&&y.traces.sort();else{if(p=u[0],p.type!==y.type||p.prop!==y.prop)return!1;if(Array.isArray(y.traces))if(Array.isArray(p.traces)){p.traces.sort();for(var _=0;_<y.traces.length;_++)if(y.traces[_]!==p.traces[_])return!1}else return!1;else if(p.prop!==y.prop)return!1}p=u[0];var s=p.value;if(Array.isArray(s))if(s.length===1)s=s[0];else return!1;c&&(c[s]=o)}return y};function S(r,t,c){var o,i,y,p=!1;if(t.type==="data")o=r._fullData[t.traces!==null?t.traces[0]:0];else if(t.type==="layout")o=r._fullLayout;else return!1;return i=v.nestedProperty(o,t.prop).get(),y=c[t.type]=c[t.type]||{},y.hasOwnProperty(t.prop)&&y[t.prop]!==i&&(p=!0),y[t.prop]=i,{changed:p,value:i}}te.executeAPICommand=function(r,t,c){if(t==="skip")return Promise.resolve();var o=w.apiMethodRegistry[t],i=[r];Array.isArray(c)||(c=[]);for(var y=0;y<c.length;y++)i.push(c[y]);return o.apply(null,i).catch(function(p){return v.warn("API call to Plotly."+t+" rejected.",p),Promise.reject(p)})},te.computeAPICommandBindings=function(r,t,c){var o;switch(Array.isArray(c)||(c=[]),t){case"restyle":o=a(r,c);break;case"relayout":o=e(r,c);break;case"update":o=a(r,[c[0],c[2]]).concat(e(r,[c[1]]));break;case"animate":o=M(r,c);break;default:o=[]}return o};function M(r,t){return Array.isArray(t[0])&&t[0].length===1&&["string","number"].indexOf(typeof t[0][0])!==-1?[{type:"layout",prop:"_currentFrame",value:t[0][0].toString()}]:[]}function e(r,t){var c=[],o=t[0],i={};if(typeof o=="string")i[o]=t[1];else if(v.isPlainObject(o))i=o;else return c;return n(i,function(y,p,g){c.push({type:"layout",prop:y,value:g})},"",0),c}function a(r,t){var c,o,i,y,p=[];if(o=t[0],i=t[1],c=t[2],y={},typeof o=="string")y[o]=i;else if(v.isPlainObject(o))y=o,c===void 0&&(c=i);else return p;return c===void 0&&(c=null),n(y,function(g,h,m){var u,_;if(Array.isArray(m)){_=m.slice();var s=Math.min(_.length,r.data.length);c&&(s=Math.min(s,c.length)),u=[];for(var A=0;A<s;A++)u[A]=c?c[A]:A}else _=m,u=c?c.slice():null;if(u===null)Array.isArray(_)&&(_=_[0]);else if(Array.isArray(u)){if(!Array.isArray(_)){var b=_;_=[];for(var f=0;f<u.length;f++)_[f]=b}_.length=Math.min(u.length,_.length)}p.push({type:"data",prop:g,traces:u,value:_})},"",0),p}function n(r,t,c,o){Object.keys(r).forEach(function(i){var y=r[i];if(i[0]!=="_"){var p=c+(o>0?".":"")+i;v.isPlainObject(y)?n(y,t,p,o+1):t(p,i,y)}})}},{"../lib":515,"../registry":647}],593:[function(d,ee,te){var w=d("../lib/extend").extendFlat;te.attributes=function(v,S){v=v||{},S=S||{};var M={valType:"info_array",editType:v.editType,items:[{valType:"number",min:0,max:1,editType:v.editType},{valType:"number",min:0,max:1,editType:v.editType}],dflt:[0,1]};v.name&&v.name+"",v.trace,S.description&&""+S.description;var e={x:w({},M,{}),y:w({},M,{}),editType:v.editType};return v.noGridCell||(e.row={valType:"integer",min:0,dflt:0,editType:v.editType},e.column={valType:"integer",min:0,dflt:0,editType:v.editType}),e},te.defaults=function(v,S,M,e){var a=e&&e.x||[0,1],n=e&&e.y||[0,1],r=S.grid;if(r){var t=M("domain.column");t!==void 0&&(t<r.columns?a=r._domains.x[t]:delete v.domain.column);var c=M("domain.row");c!==void 0&&(c<r.rows?n=r._domains.y[c]:delete v.domain.row)}var o=M("domain.x",a),i=M("domain.y",n);o[0]<o[1]||(v.domain.x=a.slice()),i[0]<i[1]||(v.domain.y=n.slice())}},{"../lib/extend":505}],594:[function(d,ee,te){ee.exports=function(w){var v=w.editType,S=w.colorEditType;S===void 0&&(S=v);var M={family:{valType:"string",noBlank:!0,strict:!0,editType:v},size:{valType:"number",min:1,editType:v},color:{valType:"color",editType:S},editType:v};return w.autoSize&&(M.size.dflt="auto"),w.autoColor&&(M.color.dflt="auto"),w.arrayOk&&(M.family.arrayOk=!0,M.size.arrayOk=!0,M.color.arrayOk=!0),M}},{}],595:[function(d,ee,te){ee.exports={_isLinkedToArray:"frames_entry",group:{valType:"string"},name:{valType:"string"},traces:{valType:"any"},baseframe:{valType:"string"},data:{valType:"any"},layout:{valType:"any"}}},{}],596:[function(d,ee,te){te.projNames={airy:"airy",aitoff:"aitoff","albers usa":"albersUsa",albers:"albers",august:"august","azimuthal equal area":"azimuthalEqualArea","azimuthal equidistant":"azimuthalEquidistant",baker:"baker",bertin1953:"bertin1953",boggs:"boggs",bonne:"bonne",bottomley:"bottomley",bromley:"bromley",collignon:"collignon","conic conformal":"conicConformal","conic equal area":"conicEqualArea","conic equidistant":"conicEquidistant",craig:"craig",craster:"craster","cylindrical equal area":"cylindricalEqualArea","cylindrical stereographic":"cylindricalStereographic",eckert1:"eckert1",eckert2:"eckert2",eckert3:"eckert3",eckert4:"eckert4",eckert5:"eckert5",eckert6:"eckert6",eisenlohr:"eisenlohr",equirectangular:"equirectangular",fahey:"fahey","foucaut sinusoidal":"foucautSinusoidal",foucaut:"foucaut",ginzburg4:"ginzburg4",ginzburg5:"ginzburg5",ginzburg6:"ginzburg6",ginzburg8:"ginzburg8",ginzburg9:"ginzburg9",gnomonic:"gnomonic","gringorten quincuncial":"gringortenQuincuncial",gringorten:"gringorten",guyou:"guyou",hammer:"hammer",hill:"hill",homolosine:"homolosine",hufnagel:"hufnagel",hyperelliptical:"hyperelliptical",kavrayskiy7:"kavrayskiy7",lagrange:"lagrange",larrivee:"larrivee",laskowski:"laskowski",loximuthal:"loximuthal",mercator:"mercator",miller:"miller",mollweide:"mollweide","mt flat polar parabolic":"mtFlatPolarParabolic","mt flat polar quartic":"mtFlatPolarQuartic","mt flat polar sinusoidal":"mtFlatPolarSinusoidal","natural earth":"naturalEarth","natural earth1":"naturalEarth1","natural earth2":"naturalEarth2","nell hammer":"nellHammer",nicolosi:"nicolosi",orthographic:"orthographic",patterson:"patterson","peirce quincuncial":"peirceQuincuncial",polyconic:"polyconic","rectangular polyconic":"rectangularPolyconic",robinson:"robinson",satellite:"satellite","sinu mollweide":"sinuMollweide",sinusoidal:"sinusoidal",stereographic:"stereographic",times:"times","transverse mercator":"transverseMercator","van der grinten":"vanDerGrinten","van der grinten2":"vanDerGrinten2","van der grinten3":"vanDerGrinten3","van der grinten4":"vanDerGrinten4",wagner4:"wagner4",wagner6:"wagner6",wiechel:"wiechel","winkel tripel":"winkel3",winkel3:"winkel3"},te.axesNames=["lonaxis","lataxis"],te.lonaxisSpan={orthographic:180,"azimuthal equal area":360,"azimuthal equidistant":360,"conic conformal":180,gnomonic:160,stereographic:180,"transverse mercator":180,"*":360},te.lataxisSpan={"conic conformal":150,stereographic:179.5,"*":180},te.scopeDefaults={world:{lonaxisRange:[-180,180],lataxisRange:[-90,90],projType:"equirectangular",projRotate:[0,0,0]},usa:{lonaxisRange:[-180,-50],lataxisRange:[15,80],projType:"albers usa"},europe:{lonaxisRange:[-30,60],lataxisRange:[30,85],projType:"conic conformal",projRotate:[15,0,0],projParallels:[0,60]},asia:{lonaxisRange:[22,160],lataxisRange:[-15,55],projType:"mercator",projRotate:[0,0,0]},africa:{lonaxisRange:[-30,60],lataxisRange:[-40,40],projType:"mercator",projRotate:[0,0,0]},"north america":{lonaxisRange:[-180,-45],lataxisRange:[5,85],projType:"conic conformal",projRotate:[-100,0,0],projParallels:[29.5,45.5]},"south america":{lonaxisRange:[-100,-30],lataxisRange:[-60,15],projType:"mercator",projRotate:[0,0,0]}},te.clipPad=.001,te.precision=.1,te.landColor="#F0DC82",te.waterColor="#3399FF",te.locationmodeToLayer={"ISO-3":"countries","USA-states":"subunits","country names":"countries"},te.sphereSVG={type:"Sphere"},te.fillLayers={ocean:1,land:1,lakes:1},te.lineLayers={subunits:1,countries:1,coastlines:1,rivers:1,frame:1},te.layers=["bg","ocean","land","lakes","subunits","countries","coastlines","rivers","lataxis","lonaxis","frame","backplot","frontplot"],te.layersForChoropleth=["bg","ocean","land","subunits","countries","coastlines","lataxis","lonaxis","frame","backplot","rivers","lakes","frontplot"],te.layerNameToAdjective={ocean:"ocean",land:"land",lakes:"lake",subunits:"subunit",countries:"country",coastlines:"coastline",rivers:"river",frame:"frame"}},{}],597:[function(d,ee,te){var w=d("@plotly/d3"),v=d("d3-geo"),S=v.geoPath,M=v.geoDistance,e=d("d3-geo-projection"),a=d("../../registry"),n=d("../../lib"),r=n.strTranslate,t=d("../../components/color"),c=d("../../components/drawing"),o=d("../../components/fx"),i=d("../plots"),y=d("../cartesian/axes"),p=d("../cartesian/autorange").getAutoRange,g=d("../../components/dragelement"),h=d("../../components/selections").prepSelect,m=d("../../components/selections").clearOutline,u=d("../../components/selections").selectOnClick,_=d("./zoom"),s=d("./constants"),A=d("../../lib/geo_location_utils"),b=d("../../lib/topojson_utils"),f=d("topojson-client").feature;function x(P){this.id=P.id,this.graphDiv=P.graphDiv,this.container=P.container,this.topojsonURL=P.topojsonURL,this.isStatic=P.staticPlot,this.topojsonName=null,this.topojson=null,this.projection=null,this.scope=null,this.viewInitial=null,this.fitScale=null,this.bounds=null,this.midPt=null,this.hasChoropleth=!1,this.traceHash={},this.layers={},this.basePaths={},this.dataPaths={},this.dataPoints={},this.clipDef=null,this.clipRect=null,this.bgRect=null,this.makeFramework()}var l=x.prototype;ee.exports=function(z){return new x(z)},l.plot=function(P,z,I){var D=this,R=z[this.id],B=[],F=!1;for(var H in s.layerNameToAdjective)if(H!=="frame"&&R["show"+H]){F=!0;break}for(var G=0;G<P.length;G++)if(P[0][0].trace.locationmode){F=!0;break}if(F){var J=b.getTopojsonName(R);(D.topojson===null||J!==D.topojsonName)&&(D.topojsonName=J,PlotlyGeoAssets.topojson[D.topojsonName]===void 0&&B.push(D.fetchTopojson()))}B=B.concat(A.fetchTraceGeoData(P)),I.push(new Promise(function(X,Y){Promise.all(B).then(function(){D.topojson=PlotlyGeoAssets.topojson[D.topojsonName],D.update(P,z),X()}).catch(Y)}))},l.fetchTopojson=function(){var P=this,z=b.getTopojsonPath(P.topojsonURL,P.topojsonName);return new Promise(function(I,D){w.json(z,function(R,B){if(R)return R.status===404?D(new Error(["plotly.js could not find topojson file at",z+".","Make sure the *topojsonURL* plot config option","is set properly."].join(" "))):D(new Error(["unexpected error while fetching topojson file at",z].join(" ")));PlotlyGeoAssets.topojson[P.topojsonName]=B,I()})})},l.update=function(P,z){var I=z[this.id];this.hasChoropleth=!1;for(var D=0;D<P.length;D++){var R=P[D],B=R[0].trace;B.type==="choropleth"&&(this.hasChoropleth=!0),B.visible===!0&&B._length>0&&B._module.calcGeoJSON(R,z)}var F=this.updateProjection(P,z);if(!F){(!this.viewInitial||this.scope!==I.scope)&&this.saveViewInitial(I),this.scope=I.scope,this.updateBaseLayers(z,I),this.updateDims(z,I),this.updateFx(z,I),i.generalUpdatePerTraceModule(this.graphDiv,this,P,I);var H=this.layers.frontplot.select(".scatterlayer");this.dataPoints.point=H.selectAll(".point"),this.dataPoints.text=H.selectAll("text"),this.dataPaths.line=H.selectAll(".js-line");var G=this.layers.backplot.select(".choroplethlayer");this.dataPaths.choropleth=G.selectAll("path"),this.render()}},l.updateProjection=function(P,z){var I=this.graphDiv,D=z[this.id],R=z._size,B=D.domain,F=D.projection,H=D.lonaxis,G=D.lataxis,J=H._ax,X=G._ax,Y=this.projection=L(D),Z=[[R.l+R.w*B.x[0],R.t+R.h*(1-B.y[1])],[R.l+R.w*B.x[1],R.t+R.h*(1-B.y[0])]],oe=D.center||{},re=F.rotation||{},se=H.range||[],N=G.range||[];if(D.fitbounds){J._length=Z[1][0]-Z[0][0],X._length=Z[1][1]-Z[0][1],J.range=p(I,J),X.range=p(I,X);var U=(J.range[0]+J.range[1])/2,q=(X.range[0]+X.range[1])/2;if(D._isScoped)oe={lon:U,lat:q};else if(D._isClipped){oe={lon:U,lat:q},re={lon:U,lat:q,roll:re.roll};var $=F.type,W=s.lonaxisSpan[$]/2||180,K=s.lataxisSpan[$]/2||90;se=[U-W,U+W],N=[q-K,q+K]}else oe={lon:U,lat:q},re={lon:U,lat:re.lat,roll:re.roll}}Y.center([oe.lon-re.lon,oe.lat-re.lat]).rotate([-re.lon,-re.lat,re.roll]).parallels(F.parallels);var ne=k(se,N);Y.fitExtent(Z,ne);var ae=this.bounds=Y.getBounds(ne),ie=this.fitScale=Y.scale(),le=Y.translate();if(D.fitbounds){var ye=Y.getBounds(k(J.range,X.range)),ue=Math.min((ae[1][0]-ae[0][0])/(ye[1][0]-ye[0][0]),(ae[1][1]-ae[0][1])/(ye[1][1]-ye[0][1]));isFinite(ue)?Y.scale(ue*ie):n.warn("Something went wrong during"+this.id+"fitbounds computations.")}else Y.scale(F.scale*ie);var pe=this.midPt=[(ae[0][0]+ae[1][0])/2,(ae[0][1]+ae[1][1])/2];if(Y.translate([le[0]+(pe[0]-le[0]),le[1]+(pe[1]-le[1])]).clipExtent(ae),D._isAlbersUsa){var ge=Y([oe.lon,oe.lat]),Te=Y.translate();Y.translate([Te[0]-(ge[0]-Te[0]),Te[1]-(ge[1]-Te[1])])}},l.updateBaseLayers=function(P,z){var I=this,D=I.topojson,R=I.layers,B=I.basePaths;function F(Z){return Z==="lonaxis"||Z==="lataxis"}function H(Z){return Boolean(s.lineLayers[Z])}function G(Z){return Boolean(s.fillLayers[Z])}var J=this.hasChoropleth?s.layersForChoropleth:s.layers,X=J.filter(function(Z){return H(Z)||G(Z)?z["show"+Z]:F(Z)?z[Z].showgrid:!0}),Y=I.framework.selectAll(".layer").data(X,String);Y.exit().each(function(Z){delete R[Z],delete B[Z],w.select(this).remove()}),Y.enter().append("g").attr("class",function(Z){return"layer "+Z}).each(function(Z){var oe=R[Z]=w.select(this);Z==="bg"?I.bgRect=oe.append("rect").style("pointer-events","all"):F(Z)?B[Z]=oe.append("path").style("fill","none"):Z==="backplot"?oe.append("g").classed("choroplethlayer",!0):Z==="frontplot"?oe.append("g").classed("scatterlayer",!0):H(Z)?B[Z]=oe.append("path").style("fill","none").style("stroke-miterlimit",2):G(Z)&&(B[Z]=oe.append("path").style("stroke","none"))}),Y.order(),Y.each(function(Z){var oe=B[Z],re=s.layerNameToAdjective[Z];Z==="frame"?oe.datum(s.sphereSVG):H(Z)||G(Z)?oe.datum(f(D,D.objects[Z])):F(Z)&&oe.datum(T(Z,z,P)).call(t.stroke,z[Z].gridcolor).call(c.dashLine,z[Z].griddash,z[Z].gridwidth),H(Z)?oe.call(t.stroke,z[re+"color"]).call(c.dashLine,"",z[re+"width"]):G(Z)&&oe.call(t.fill,z[re+"color"])})},l.updateDims=function(P,z){var I=this.bounds,D=(z.framewidth||0)/2,R=I[0][0]-D,B=I[0][1]-D,F=I[1][0]-R+D,H=I[1][1]-B+D;c.setRect(this.clipRect,R,B,F,H),this.bgRect.call(c.setRect,R,B,F,H).call(t.fill,z.bgcolor),this.xaxis._offset=R,this.xaxis._length=F,this.yaxis._offset=B,this.yaxis._length=H},l.updateFx=function(P,z){var I=this,D=I.graphDiv,R=I.bgRect,B=P.dragmode,F=P.clickmode;if(I.isStatic)return;function H(){var Y=I.viewInitial,Z={};for(var oe in Y)Z[I.id+"."+oe]=Y[oe];a.call("_guiRelayout",D,Z),D.emit("plotly_doubleclick",null)}function G(Y){return I.projection.invert([Y[0]+I.xaxis._offset,Y[1]+I.yaxis._offset])}var J=function(Y,Z){if(Z.isRect){var oe=Y.range={};oe[I.id]=[G([Z.xmin,Z.ymin]),G([Z.xmax,Z.ymax])]}else{var re=Y.lassoPoints={};re[I.id]=Z.map(G)}},X={element:I.bgRect.node(),gd:D,plotinfo:{id:I.id,xaxis:I.xaxis,yaxis:I.yaxis,fillRangeItems:J},xaxes:[I.xaxis],yaxes:[I.yaxis],subplot:I.id,clickFn:function(Y){Y===2&&m(D)}};B==="pan"?(R.node().onmousedown=null,R.call(_(I,z)),R.on("dblclick.zoom",H),D._context._scrollZoom.geo||R.on("wheel.zoom",null)):(B==="select"||B==="lasso")&&(R.on(".zoom",null),X.prepFn=function(Y,Z,oe){h(Y,Z,oe,X,B)},g.init(X)),R.on("mousemove",function(){var Y=I.projection.invert(n.getPositionFromD3Event());if(!Y)return g.unhover(D,w.event);I.xaxis.p2c=function(){return Y[0]},I.yaxis.p2c=function(){return Y[1]},o.hover(D,w.event,I.id)}),R.on("mouseout",function(){D._dragging||g.unhover(D,w.event)}),R.on("click",function(){B!=="select"&&B!=="lasso"&&(F.indexOf("select")>-1&&u(w.event,D,[I.xaxis],[I.yaxis],I.id,X),F.indexOf("event")>-1&&o.click(D,w.event))})},l.makeFramework=function(){var P=this,z=P.graphDiv,I=z._fullLayout,D="clip"+I._uid+P.id;P.clipDef=I._clips.append("clipPath").attr("id",D),P.clipRect=P.clipDef.append("rect"),P.framework=w.select(P.container).append("g").attr("class","geo "+P.id).call(c.setClipUrl,D,z),P.project=function(R){var B=P.projection(R);return B?[B[0]-P.xaxis._offset,B[1]-P.yaxis._offset]:[null,null]},P.xaxis={_id:"x",c2p:function(R){return P.project(R)[0]}},P.yaxis={_id:"y",c2p:function(R){return P.project(R)[1]}},P.mockAxis={type:"linear",showexponent:"all",exponentformat:"B"},y.setConvert(P.mockAxis,I)},l.saveViewInitial=function(P){var z=P.center||{},I=P.projection,D=I.rotation||{};this.viewInitial={fitbounds:P.fitbounds,"projection.scale":I.scale};var R;P._isScoped?R={"center.lon":z.lon,"center.lat":z.lat}:P._isClipped?R={"projection.rotation.lon":D.lon,"projection.rotation.lat":D.lat}:R={"center.lon":z.lon,"center.lat":z.lat,"projection.rotation.lon":D.lon},n.extendFlat(this.viewInitial,R)},l.render=function(){var P=this.projection,z=P.getPath(),I;function D(B){var F=P(B.lonlat);return F?r(F[0],F[1]):null}function R(B){return P.isLonLatOverEdges(B.lonlat)?"none":null}for(I in this.basePaths)this.basePaths[I].attr("d",z);for(I in this.dataPaths)this.dataPaths[I].attr("d",function(B){return z(B.geojson)});for(I in this.dataPoints)this.dataPoints[I].attr("display",R).attr("transform",D)};function L(P){var z=P.projection,I=z.type,D=s.projNames[I];D="geo"+n.titleCase(D);for(var R=v[D]||e[D],B=R(),F=P._isSatellite?Math.acos(1/z.distance)*180/Math.PI:P._isClipped?s.lonaxisSpan[I]/2:null,H=["center","rotate","parallels","clipExtent"],G=function(Y){return Y?B:[]},J=0;J<H.length;J++){var X=H[J];typeof B[X]!="function"&&(B[X]=G)}return B.isLonLatOverEdges=function(Y){if(B(Y)===null)return!0;if(F){var Z=B.rotate(),oe=M(Y,[-Z[0],-Z[1]]),re=F*Math.PI/180;return oe>re}else return!1},B.getPath=function(){return S().projection(B)},B.getBounds=function(Y){return B.getPath().bounds(Y)},B.precision(s.precision),P._isSatellite&&B.tilt(z.tilt).distance(z.distance),F&&B.clipAngle(F-s.clipPad),B}function T(P,z,I){var D=1e-6,R=2.5,B=z[P],F=s.scopeDefaults[z.scope],H,G,J;P==="lonaxis"?(H=F.lonaxisRange,G=F.lataxisRange,J=function(q,$){return[q,$]}):P==="lataxis"&&(H=F.lataxisRange,G=F.lonaxisRange,J=function(q,$){return[$,q]});var X={type:"linear",range:[H[0],H[1]-D],tick0:B.tick0,dtick:B.dtick};y.setConvert(X,I);var Y=y.calcTicks(X);!z.isScoped&&P==="lonaxis"&&Y.pop();for(var Z=Y.length,oe=new Array(Z),re=0;re<Z;re++)for(var se=Y[re].x,N=oe[re]=[],U=G[0];U<G[1]+R;U+=R)N.push(J(se,U));return{type:"MultiLineString",coordinates:oe}}function k(P,z){var I=s.clipPad,D=P[0]+I,R=P[1]-I,B=z[0]+I,F=z[1]-I;D>0&&R<0&&(R+=360);var H=(R-D)/4;return{type:"Polygon",coordinates:[[[D,B],[D,F],[D+H,F],[D+2*H,F],[D+3*H,F],[R,F],[R,B],[R-H,B],[R-2*H,B],[R-3*H,B],[D,B]]]}}},{"../../components/color":367,"../../components/dragelement":386,"../../components/drawing":389,"../../components/fx":407,"../../components/selections":455,"../../lib":515,"../../lib/geo_location_utils":508,"../../lib/topojson_utils":544,"../../registry":647,"../cartesian/autorange":565,"../cartesian/axes":566,"../plots":628,"./constants":596,"./zoom":601,"@plotly/d3":58,"d3-geo":114,"d3-geo-projection":113,"topojson-client":316}],598:[function(d,ee,te){var w=d("../../plots/get_data").getSubplotCalcData,v=d("../../lib").counterRegex,S=d("./geo"),M="geo",e=v(M),a={};a[M]={valType:"subplotid",dflt:M,editType:"calc"};function n(c){for(var o=c._fullLayout,i=c.calcdata,y=o._subplots[M],p=0;p<y.length;p++){var g=y[p],h=w(i,M,g),m=o[g],u=m._subplot;u||(u=S({id:g,graphDiv:c,container:o._geolayer.node(),topojsonURL:c._context.topojsonURL,staticPlot:c._context.staticPlot}),o[g]._subplot=u),u.plot(h,o,c._promises)}}function r(c,o,i,y){for(var p=y._subplots[M]||[],g=0;g<p.length;g++){var h=p[g],m=y[h]._subplot;!o[h]&&!!m&&(m.framework.remove(),m.clipDef.remove())}}function t(c){for(var o=c._fullLayout,i=o._subplots[M],y=0;y<i.length;y++){var p=o[i[y]],g=p._subplot;g.updateFx(o,p)}}ee.exports={attr:M,name:M,idRoot:M,idRegex:e,attrRegex:e,attributes:a,layoutAttributes:d("./layout_attributes"),supplyLayoutDefaults:d("./layout_defaults"),plot:n,updateFx:t,clean:r}},{"../../lib":515,"../../plots/get_data":602,"./geo":597,"./layout_attributes":599,"./layout_defaults":600}],599:[function(d,ee,te){var w=d("../../components/color/attributes"),v=d("../domain").attributes,S=d("../../components/drawing/attributes").dash,M=d("./constants"),e=d("../../plot_api/edit_types").overrideAll,a=d("../../lib/sort_object_keys"),n={range:{valType:"info_array",items:[{valType:"number"},{valType:"number"}]},showgrid:{valType:"boolean",dflt:!1},tick0:{valType:"number",dflt:0},dtick:{valType:"number"},gridcolor:{valType:"color",dflt:w.lightLine},gridwidth:{valType:"number",min:0,dflt:1},griddash:S},r=ee.exports=e({domain:v({name:"geo"},{}),fitbounds:{valType:"enumerated",values:[!1,"locations","geojson"],dflt:!1,editType:"plot"},resolution:{valType:"enumerated",values:[110,50],dflt:110,coerceNumber:!0},scope:{valType:"enumerated",values:a(M.scopeDefaults),dflt:"world"},projection:{type:{valType:"enumerated",values:a(M.projNames)},rotation:{lon:{valType:"number"},lat:{valType:"number"},roll:{valType:"number"}},tilt:{valType:"number",dflt:0},distance:{valType:"number",min:1.001,dflt:2},parallels:{valType:"info_array",items:[{valType:"number"},{valType:"number"}]},scale:{valType:"number",min:0,dflt:1}},center:{lon:{valType:"number"},lat:{valType:"number"}},visible:{valType:"boolean",dflt:!0},showcoastlines:{valType:"boolean"},coastlinecolor:{valType:"color",dflt:w.defaultLine},coastlinewidth:{valType:"number",min:0,dflt:1},showland:{valType:"boolean",dflt:!1},landcolor:{valType:"color",dflt:M.landColor},showocean:{valType:"boolean",dflt:!1},oceancolor:{valType:"color",dflt:M.waterColor},showlakes:{valType:"boolean",dflt:!1},lakecolor:{valType:"color",dflt:M.waterColor},showrivers:{valType:"boolean",dflt:!1},rivercolor:{valType:"color",dflt:M.waterColor},riverwidth:{valType:"number",min:0,dflt:1},showcountries:{valType:"boolean"},countrycolor:{valType:"color",dflt:w.defaultLine},countrywidth:{valType:"number",min:0,dflt:1},showsubunits:{valType:"boolean"},subunitcolor:{valType:"color",dflt:w.defaultLine},subunitwidth:{valType:"number",min:0,dflt:1},showframe:{valType:"boolean"},framecolor:{valType:"color",dflt:w.defaultLine},framewidth:{valType:"number",min:0,dflt:1},bgcolor:{valType:"color",dflt:w.background},lonaxis:n,lataxis:n},"plot","from-root");r.uirevision={valType:"any",editType:"none"}},{"../../components/color/attributes":366,"../../components/drawing/attributes":388,"../../lib/sort_object_keys":538,"../../plot_api/edit_types":548,"../domain":593,"./constants":596}],600:[function(d,ee,te){var w=d("../../lib"),v=d("../subplot_defaults"),S=d("../get_data").getSubplotData,M=d("./constants"),e=d("./layout_attributes"),a=M.axesNames;ee.exports=function(t,c,o){v(t,c,o,{type:"geo",attributes:e,handleDefaults:n,fullData:o,partition:"y"})};function n(r,t,c,o){var i=S(o.fullData,"geo",o.id),y=i.map(function(N){return N._expandedIndex}),p=c("resolution"),g=c("scope"),h=M.scopeDefaults[g],m=c("projection.type",h.projType),u=t._isAlbersUsa=m==="albers usa";u&&(g=t.scope="usa");var _=t._isScoped=g!=="world",s=t._isSatellite=m==="satellite",A=t._isConic=m.indexOf("conic")!==-1||m==="albers",b=t._isClipped=!!M.lonaxisSpan[m];if(r.visible===!1){var f=w.extendDeep({},t._template);f.showcoastlines=!1,f.showcountries=!1,f.showframe=!1,f.showlakes=!1,f.showland=!1,f.showocean=!1,f.showrivers=!1,f.showsubunits=!1,f.lonaxis&&(f.lonaxis.showgrid=!1),f.lataxis&&(f.lataxis.showgrid=!1),t._template=f}for(var x=c("visible"),l,L=0;L<a.length;L++){var T=a[L],k=[30,10][L],P;if(_)P=h[T+"Range"];else{var z=M[T+"Span"],I=(z[m]||z["*"])/2,D=c("projection.rotation."+T.substr(0,3),h.projRotate[L]);P=[D-I,D+I]}var R=c(T+".range",P);c(T+".tick0"),c(T+".dtick",k),l=c(T+".showgrid",x?void 0:!1),l&&(c(T+".gridcolor"),c(T+".gridwidth"),c(T+".griddash")),t[T]._ax={type:"linear",_id:T.slice(0,3),_traceIndices:y,setScale:w.identity,c2l:w.identity,r2l:w.identity,autorange:!0,range:R.slice(),_m:1,_input:{}}}var B=t.lonaxis.range,F=t.lataxis.range,H=B[0],G=B[1];H>0&&G<0&&(G+=360);var J=(H+G)/2,X;if(!u){var Y=_?h.projRotate:[J,0,0];X=c("projection.rotation.lon",Y[0]),c("projection.rotation.lat",Y[1]),c("projection.rotation.roll",Y[2]),l=c("showcoastlines",!_&&x),l&&(c("coastlinecolor"),c("coastlinewidth")),l=c("showocean",x?void 0:!1),l&&c("oceancolor")}var Z,oe;if(u?(Z=-96.6,oe=38.7):(Z=_?J:X,oe=(F[0]+F[1])/2),c("center.lon",Z),c("center.lat",oe),s&&(c("projection.tilt"),c("projection.distance")),A){var re=h.projParallels||[0,60];c("projection.parallels",re)}c("projection.scale"),l=c("showland",x?void 0:!1),l&&c("landcolor"),l=c("showlakes",x?void 0:!1),l&&c("lakecolor"),l=c("showrivers",x?void 0:!1),l&&(c("rivercolor"),c("riverwidth")),l=c("showcountries",_&&g!=="usa"&&x),l&&(c("countrycolor"),c("countrywidth")),(g==="usa"||g==="north america"&&p===50)&&(c("showsubunits",x),c("subunitcolor"),c("subunitwidth")),_||(l=c("showframe",x),l&&(c("framecolor"),c("framewidth"))),c("bgcolor");var se=c("fitbounds");se&&(delete t.projection.scale,_?(delete t.center.lon,delete t.center.lat):b?(delete t.center.lon,delete t.center.lat,delete t.projection.rotation.lon,delete t.projection.rotation.lat,delete t.lonaxis.range,delete t.lataxis.range):(delete t.center.lon,delete t.center.lat,delete t.projection.rotation.lon))}},{"../../lib":515,"../get_data":602,"../subplot_defaults":641,"./constants":596,"./layout_attributes":599}],601:[function(d,ee,te){var w=d("@plotly/d3"),v=d("../../lib"),S=d("../../registry"),M=Math.PI/180,e=180/Math.PI,a={cursor:"pointer"},n={cursor:"auto"};function r(T,k){var P=T.projection,z;return k._isScoped?z=o:k._isClipped?z=y:z=i,z(T,P)}ee.exports=r;function t(T,k){return w.behavior.zoom().translate(k.translate()).scale(k.scale())}function c(T,k,P){var z=T.id,I=T.graphDiv,D=I.layout,R=D[z],B=I._fullLayout,F=B[z],H={},G={};function J(X,Y){H[z+"."+X]=v.nestedProperty(R,X).get(),S.call("_storeDirectGUIEdit",D,B._preGUI,H);var Z=v.nestedProperty(F,X);Z.get()!==Y&&(Z.set(Y),v.nestedProperty(R,X).set(Y),G[z+"."+X]=Y)}P(J),J("projection.scale",k.scale()/T.fitScale),J("fitbounds",!1),I.emit("plotly_relayout",G)}function o(T,k){var P=t(T,k);function z(){w.select(this).style(a)}function I(){k.scale(w.event.scale).translate(w.event.translate),T.render();var B=k.invert(T.midPt);T.graphDiv.emit("plotly_relayouting",{"geo.projection.scale":k.scale()/T.fitScale,"geo.center.lon":B[0],"geo.center.lat":B[1]})}function D(B){var F=k.invert(T.midPt);B("center.lon",F[0]),B("center.lat",F[1])}function R(){w.select(this).style(n),c(T,k,D)}return P.on("zoomstart",z).on("zoom",I).on("zoomend",R),P}function i(T,k){var P=t(T,k),z=2,I,D,R,B,F,H,G,J,X;function Y(U){return k.invert(U)}function Z(U){var q=Y(U);if(!q)return!0;var $=k(q);return Math.abs($[0]-U[0])>z||Math.abs($[1]-U[1])>z}function oe(){w.select(this).style(a),I=w.mouse(this),D=k.rotate(),R=k.translate(),B=D,F=Y(I)}function re(){if(H=w.mouse(this),Z(I)){P.scale(k.scale()),P.translate(k.translate());return}k.scale(w.event.scale),k.translate([R[0],w.event.translate[1]]),F?Y(H)&&(J=Y(H),G=[B[0]+(J[0]-F[0]),D[1],D[2]],k.rotate(G),B=G):(I=H,F=Y(I)),X=!0,T.render();var U=k.rotate(),q=k.invert(T.midPt);T.graphDiv.emit("plotly_relayouting",{"geo.projection.scale":k.scale()/T.fitScale,"geo.center.lon":q[0],"geo.center.lat":q[1],"geo.projection.rotation.lon":-U[0]})}function se(){w.select(this).style(n),X&&c(T,k,N)}function N(U){var q=k.rotate(),$=k.invert(T.midPt);U("projection.rotation.lon",-q[0]),U("center.lon",$[0]),U("center.lat",$[1])}return P.on("zoomstart",oe).on("zoom",re).on("zoomend",se),P}function y(T,k){k.rotate(),k.scale();var P=t(T,k),z=L(P,"zoomstart","zoom","zoomend"),I=0,D=P.on,R;P.on("zoomstart",function(){w.select(this).style(a);var J=w.mouse(this),X=k.rotate(),Y=X,Z=k.translate(),oe=g(X);R=p(k,J),D.call(P,"zoom",function(){var re=w.mouse(this);if(k.scale(w.event.scale),!R)J=re,R=p(k,J);else if(p(k,re)){k.rotate(X).translate(Z);var se=p(k,re),N=m(R,se),U=b(h(oe,N)),q=u(U,R,Y);(!isFinite(q[0])||!isFinite(q[1])||!isFinite(q[2]))&&(q=Y),k.rotate(q),Y=q}F(z.of(this,arguments))}),B(z.of(this,arguments))}).on("zoomend",function(){w.select(this).style(n),D.call(P,"zoom",null),H(z.of(this,arguments)),c(T,k,G)}).on("zoom.redraw",function(){T.render();var J=k.rotate();T.graphDiv.emit("plotly_relayouting",{"geo.projection.scale":k.scale()/T.fitScale,"geo.projection.rotation.lon":-J[0],"geo.projection.rotation.lat":-J[1]})});function B(J){I++||J({type:"zoomstart"})}function F(J){J({type:"zoom"})}function H(J){--I||J({type:"zoomend"})}function G(J){var X=k.rotate();J("projection.rotation.lon",-X[0]),J("projection.rotation.lat",-X[1])}return w.rebind(P,z,"on")}function p(T,k){var P=T.invert(k);return P&&isFinite(P[0])&&isFinite(P[1])&&f(P)}function g(T){var k=.5*T[0]*M,P=.5*T[1]*M,z=.5*T[2]*M,I=Math.sin(k),D=Math.cos(k),R=Math.sin(P),B=Math.cos(P),F=Math.sin(z),H=Math.cos(z);return[D*B*H+I*R*F,I*B*H-D*R*F,D*R*H+I*B*F,D*B*F-I*R*H]}function h(T,k){var P=T[0],z=T[1],I=T[2],D=T[3],R=k[0],B=k[1],F=k[2],H=k[3];return[P*R-z*B-I*F-D*H,P*B+z*R+I*H-D*F,P*F-z*H+I*R+D*B,P*H+z*F-I*B+D*R]}function m(T,k){if(!(!T||!k)){var P=l(T,k),z=Math.sqrt(x(P,P)),I=.5*Math.acos(Math.max(-1,Math.min(1,x(T,k)))),D=Math.sin(I)/z;return z&&[Math.cos(I),P[2]*D,-P[1]*D,P[0]*D]}}function u(T,k,P){var z=A(k,2,T[0]);z=A(z,1,T[1]),z=A(z,0,T[2]-P[2]);var I=k[0],D=k[1],R=k[2],B=z[0],F=z[1],H=z[2],G=Math.atan2(D,I)*e,J=Math.sqrt(I*I+D*D),X,Y;Math.abs(F)>J?(Y=(F>0?90:-90)-G,X=0):(Y=Math.asin(F/J)*e-G,X=Math.sqrt(J*J-F*F));var Z=180-Y-2*G,oe=(Math.atan2(H,B)-Math.atan2(R,X))*e,re=(Math.atan2(H,B)-Math.atan2(R,-X))*e,se=_(P[0],P[1],Y,oe),N=_(P[0],P[1],Z,re);return se<=N?[Y,oe,P[2]]:[Z,re,P[2]]}function _(T,k,P,z){var I=s(P-T),D=s(z-k);return Math.sqrt(I*I+D*D)}function s(T){return(T%360+540)%360-180}function A(T,k,P){var z=P*M,I=T.slice(),D=k===0?1:0,R=k===2?1:2,B=Math.cos(z),F=Math.sin(z);return I[D]=T[D]*B-T[R]*F,I[R]=T[R]*B+T[D]*F,I}function b(T){return[Math.atan2(2*(T[0]*T[1]+T[2]*T[3]),1-2*(T[1]*T[1]+T[2]*T[2]))*e,Math.asin(Math.max(-1,Math.min(1,2*(T[0]*T[2]-T[3]*T[1]))))*e,Math.atan2(2*(T[0]*T[3]+T[1]*T[2]),1-2*(T[2]*T[2]+T[3]*T[3]))*e]}function f(T){var k=T[0]*M,P=T[1]*M,z=Math.cos(P);return[z*Math.cos(k),z*Math.sin(k),Math.sin(P)]}function x(T,k){for(var P=0,z=0,I=T.length;z<I;++z)P+=T[z]*k[z];return P}function l(T,k){return[T[1]*k[2]-T[2]*k[1],T[2]*k[0]-T[0]*k[2],T[0]*k[1]-T[1]*k[0]]}function L(T){for(var k=0,P=arguments.length,z=[];++k<P;)z.push(arguments[k]);var I=w.dispatch.apply(null,z);return I.of=function(D,R){return function(B){var F;try{F=B.sourceEvent=w.event,B.target=T,w.event=B,I[B.type].apply(D,R)}finally{w.event=F}}},I}},{"../../lib":515,"../../registry":647,"@plotly/d3":58}],602:[function(d,ee,te){var w=d("../registry"),v=d("./cartesian/constants").SUBPLOT_PATTERN;te.getSubplotCalcData=function(S,M,e){var a=w.subplotsRegistry[M];if(!a)return[];for(var n=a.attr,r=[],t=0;t<S.length;t++){var c=S[t],o=c[0].trace;o[n]===e&&r.push(c)}return r},te.getModuleCalcData=function(S,M){var e=[],a=[],n;if(typeof M=="string"?n=w.getModule(M).plot:typeof M=="function"?n=M:n=M.plot,!n)return[e,S];for(var r=0;r<S.length;r++){var t=S[r],c=t[0].trace;c.visible!==!0||c._length===0||(c._module.plot===n?e.push(t):a.push(t))}return[e,a]},te.getSubplotData=function(M,e,a){if(!w.subplotsRegistry[e])return[];var n=w.subplotsRegistry[e].attr,r=[],t,c,o;if(e==="gl2d"){var i=a.match(v);c="x"+i[1],o="y"+i[2]}for(var y=0;y<M.length;y++)t=M[y],e==="gl2d"&&w.traceIs(t,"gl2d")?t[n[0]]===c&&t[n[1]]===o&&r.push(t):t[n]===a&&r.push(t);return r}},{"../registry":647,"./cartesian/constants":573}],603:[function(d,ee,te){var w=d("mouse-change"),v=d("mouse-wheel"),S=d("mouse-event-offset"),M=d("../cartesian/constants"),e=d("has-passive-events");ee.exports=n;function a(r,t){this.element=r,this.plot=t,this.mouseListener=null,this.wheelListener=null,this.lastInputTime=Date.now(),this.lastPos=[0,0],this.boxEnabled=!1,this.boxInited=!1,this.boxStart=[0,0],this.boxEnd=[0,0],this.dragStart=[0,0]}function n(r){var t=r.mouseContainer,c=r.glplot,o=new a(t,c);function i(){r.xaxis.autorange=!1,r.yaxis.autorange=!1}function y(){for(var g=r.graphDiv._fullLayout._axisConstraintGroups,h=r.xaxis._id,m=r.yaxis._id,u=0;u<g.length;u++)if(g[u][h]!==-1){if(g[u][m]!==-1)return!0;break}return!1}o.mouseListener=w(t,p),t.addEventListener("touchstart",function(g){var h=S(g.changedTouches[0],t);p(0,h[0],h[1]),p(1,h[0],h[1]),g.preventDefault()},e?{passive:!1}:!1),t.addEventListener("touchmove",function(g){g.preventDefault();var h=S(g.changedTouches[0],t);p(1,h[0],h[1]),g.preventDefault()},e?{passive:!1}:!1),t.addEventListener("touchend",function(g){p(0,o.lastPos[0],o.lastPos[1]),g.preventDefault()},e?{passive:!1}:!1);function p(g,h,m){var u=r.calcDataBox(),_=c.viewBox,s=o.lastPos[0],A=o.lastPos[1],b=M.MINDRAG*c.pixelRatio,f=M.MINZOOM*c.pixelRatio,x,l;h*=c.pixelRatio,m*=c.pixelRatio,m=_[3]-_[1]-m;function L(D,R,B){var F=Math.min(R,B),H=Math.max(R,B);F!==H?(u[D]=F,u[D+2]=H,o.dataBox=u,r.setRanges(u)):(r.selectBox.selectBox=[0,0,1,1],r.glplot.setDirty())}switch(r.fullLayout.dragmode){case"zoom":if(g){var T=h/(_[2]-_[0])*(u[2]-u[0])+u[0],k=m/(_[3]-_[1])*(u[3]-u[1])+u[1];o.boxInited||(o.boxStart[0]=T,o.boxStart[1]=k,o.dragStart[0]=h,o.dragStart[1]=m),o.boxEnd[0]=T,o.boxEnd[1]=k,o.boxInited=!0,!o.boxEnabled&&(o.boxStart[0]!==o.boxEnd[0]||o.boxStart[1]!==o.boxEnd[1])&&(o.boxEnabled=!0);var P=Math.abs(o.dragStart[0]-h)<f,z=Math.abs(o.dragStart[1]-m)<f;if(y()&&!(P&&z)){x=o.boxEnd[0]-o.boxStart[0],l=o.boxEnd[1]-o.boxStart[1];var I=(u[3]-u[1])/(u[2]-u[0]);Math.abs(x*I)>Math.abs(l)?(o.boxEnd[1]=o.boxStart[1]+Math.abs(x)*I*(l>=0?1:-1),o.boxEnd[1]<u[1]?(o.boxEnd[1]=u[1],o.boxEnd[0]=o.boxStart[0]+(u[1]-o.boxStart[1])/Math.abs(I)):o.boxEnd[1]>u[3]&&(o.boxEnd[1]=u[3],o.boxEnd[0]=o.boxStart[0]+(u[3]-o.boxStart[1])/Math.abs(I))):(o.boxEnd[0]=o.boxStart[0]+Math.abs(l)/I*(x>=0?1:-1),o.boxEnd[0]<u[0]?(o.boxEnd[0]=u[0],o.boxEnd[1]=o.boxStart[1]+(u[0]-o.boxStart[0])*Math.abs(I)):o.boxEnd[0]>u[2]&&(o.boxEnd[0]=u[2],o.boxEnd[1]=o.boxStart[1]+(u[2]-o.boxStart[0])*Math.abs(I)))}else P&&(o.boxEnd[0]=o.boxStart[0]),z&&(o.boxEnd[1]=o.boxStart[1])}else o.boxEnabled?(x=o.boxStart[0]!==o.boxEnd[0],l=o.boxStart[1]!==o.boxEnd[1],x||l?(x&&(L(0,o.boxStart[0],o.boxEnd[0]),r.xaxis.autorange=!1),l&&(L(1,o.boxStart[1],o.boxEnd[1]),r.yaxis.autorange=!1),r.relayoutCallback()):r.glplot.setDirty(),o.boxEnabled=!1,o.boxInited=!1):o.boxInited&&(o.boxInited=!1);break;case"pan":o.boxEnabled=!1,o.boxInited=!1,g?(o.panning||(o.dragStart[0]=h,o.dragStart[1]=m),Math.abs(o.dragStart[0]-h)<b&&(h=o.dragStart[0]),Math.abs(o.dragStart[1]-m)<b&&(m=o.dragStart[1]),x=(s-h)*(u[2]-u[0])/(c.viewBox[2]-c.viewBox[0]),l=(A-m)*(u[3]-u[1])/(c.viewBox[3]-c.viewBox[1]),u[0]+=x,u[2]+=x,u[1]+=l,u[3]+=l,r.setRanges(u),o.panning=!0,o.lastInputTime=Date.now(),i(),r.cameraChanged(),r.handleAnnotations()):o.panning&&(o.panning=!1,r.relayoutCallback());break}o.lastPos[0]=h,o.lastPos[1]=m}return o.wheelListener=v(t,function(g,h){if(!r.scrollZoom)return!1;var m=r.calcDataBox(),u=c.viewBox,_=o.lastPos[0],s=o.lastPos[1],A=Math.exp(5*h/(u[3]-u[1])),b=_/(u[2]-u[0])*(m[2]-m[0])+m[0],f=s/(u[3]-u[1])*(m[3]-m[1])+m[1];return m[0]=(m[0]-b)*A+b,m[2]=(m[2]-b)*A+b,m[1]=(m[1]-f)*A+f,m[3]=(m[3]-f)*A+f,r.setRanges(m),o.lastInputTime=Date.now(),i(),r.cameraChanged(),r.handleAnnotations(),r.relayoutCallback(),!0},!0),o}},{"../cartesian/constants":573,"has-passive-events":229,"mouse-change":241,"mouse-event-offset":242,"mouse-wheel":244}],604:[function(d,ee,te){var w=d("../cartesian/axes"),v=d("../../lib/str2rgbarray");function S(n){this.scene=n,this.gl=n.gl,this.pixelRatio=n.pixelRatio,this.screenBox=[0,0,1,1],this.viewBox=[0,0,1,1],this.dataBox=[-1,-1,1,1],this.borderLineEnable=[!1,!1,!1,!1],this.borderLineWidth=[1,1,1,1],this.borderLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.ticks=[[],[]],this.tickEnable=[!0,!0,!1,!1],this.tickPad=[15,15,15,15],this.tickAngle=[0,0,0,0],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickMarkLength=[0,0,0,0],this.tickMarkWidth=[0,0,0,0],this.tickMarkColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labels=["x","y"],this.labelEnable=[!0,!0,!1,!1],this.labelAngle=[0,Math.PI/2,0,3*Math.PI/2],this.labelPad=[15,15,15,15],this.labelSize=[12,12],this.labelFont=["sans-serif","sans-serif"],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.title="",this.titleEnable=!0,this.titleCenter=[0,0,0,0],this.titleAngle=0,this.titleColor=[0,0,0,1],this.titleFont="sans-serif",this.titleSize=18,this.gridLineEnable=[!0,!0],this.gridLineColor=[[0,0,0,.5],[0,0,0,.5]],this.gridLineWidth=[1,1],this.zeroLineEnable=[!0,!0],this.zeroLineWidth=[1,1],this.zeroLineColor=[[0,0,0,1],[0,0,0,1]],this.borderColor=[0,0,0,0],this.backgroundColor=[0,0,0,0],this.static=this.scene.staticPlot}var M=S.prototype,e=["xaxis","yaxis"];M.merge=function(n){this.titleEnable=!1,this.backgroundColor=v(n.plot_bgcolor);var r,t,c,o,i,y,p,g,h,m,u;for(m=0;m<2;++m){r=e[m];var _=r.charAt(0);for(t=n[this.scene[r]._name],c=t.title.text===this.scene.fullLayout._dfltTitle[_]?"":t.title.text,u=0;u<=2;u+=2)this.labelEnable[m+u]=!1,this.labels[m+u]=c,this.labelColor[m+u]=v(t.title.font.color),this.labelFont[m+u]=t.title.font.family,this.labelSize[m+u]=t.title.font.size,this.labelPad[m+u]=this.getLabelPad(r,t),this.tickEnable[m+u]=!1,this.tickColor[m+u]=v((t.tickfont||{}).color),this.tickAngle[m+u]=t.tickangle==="auto"?0:Math.PI*-t.tickangle/180,this.tickPad[m+u]=this.getTickPad(t),this.tickMarkLength[m+u]=0,this.tickMarkWidth[m+u]=t.tickwidth||0,this.tickMarkColor[m+u]=v(t.tickcolor),this.borderLineEnable[m+u]=!1,this.borderLineColor[m+u]=v(t.linecolor),this.borderLineWidth[m+u]=t.linewidth||0;p=this.hasSharedAxis(t),i=this.hasAxisInDfltPos(r,t)&&!p,y=this.hasAxisInAltrPos(r,t)&&!p,o=t.mirror||!1,g=p?String(o).indexOf("all")!==-1:!!o,h=p?o==="allticks":String(o).indexOf("ticks")!==-1,i?this.labelEnable[m]=!0:y&&(this.labelEnable[m+2]=!0),i?this.tickEnable[m]=t.showticklabels:y&&(this.tickEnable[m+2]=t.showticklabels),(i||g)&&(this.borderLineEnable[m]=t.showline),(y||g)&&(this.borderLineEnable[m+2]=t.showline),(i||h)&&(this.tickMarkLength[m]=this.getTickMarkLength(t)),(y||h)&&(this.tickMarkLength[m+2]=this.getTickMarkLength(t)),this.gridLineEnable[m]=t.showgrid,this.gridLineColor[m]=v(t.gridcolor),this.gridLineWidth[m]=t.gridwidth,this.zeroLineEnable[m]=t.zeroline,this.zeroLineColor[m]=v(t.zerolinecolor),this.zeroLineWidth[m]=t.zerolinewidth}},M.hasSharedAxis=function(n){var r=this.scene,t=r.fullLayout._subplots.gl2d,c=w.findSubplotsWithAxis(t,n);return c.indexOf(r.id)!==0},M.hasAxisInDfltPos=function(n,r){var t=r.side;if(n==="xaxis")return t==="bottom";if(n==="yaxis")return t==="left"},M.hasAxisInAltrPos=function(n,r){var t=r.side;if(n==="xaxis")return t==="top";if(n==="yaxis")return t==="right"},M.getLabelPad=function(n,r){var t=1.5,c=r.title.font.size,o=r.showticklabels;if(n==="xaxis")return r.side==="top"?-10+c*(t+(o?1:0)):-10+c*(t+(o?.5:0));if(n==="yaxis")return r.side==="right"?10+c*(t+(o?1:.5)):10+c*(t+(o?.5:0))},M.getTickPad=function(n){return n.ticks==="outside"?10+n.ticklen:15},M.getTickMarkLength=function(n){if(!n.ticks)return 0;var r=n.ticklen;return n.ticks==="inside"?-r:r};function a(n){return new S(n)}ee.exports=a},{"../../lib/str2rgbarray":540,"../cartesian/axes":566}],605:[function(d,ee,te){var w=d("../../plot_api/edit_types").overrideAll,v=d("./scene2d"),S=d("../layout_attributes"),M=d("../../constants/xmlns_namespaces"),e=d("../cartesian/constants"),a=d("../cartesian"),n=d("../../components/fx/layout_attributes"),r=d("../get_data").getSubplotData;te.name="gl2d",te.attr=["xaxis","yaxis"],te.idRoot=["x","y"],te.idRegex=e.idRegex,te.attrRegex=e.attrRegex,te.attributes=d("../cartesian/attributes"),te.supplyLayoutDefaults=function(t,c,o){c._has("cartesian")||a.supplyLayoutDefaults(t,c,o)},te.layoutAttrOverrides=w(a.layoutAttributes,"plot","from-root"),te.baseLayoutAttrOverrides=w({plot_bgcolor:S.plot_bgcolor,hoverlabel:n.hoverlabel},"plot","nested"),te.plot=function(c){for(var o=c._fullLayout,i=c._fullData,y=o._subplots.gl2d,p=0;p<y.length;p++){var g=y[p],h=o._plots[g],m=r(i,"gl2d",g),u=h._scene2d;u===void 0&&(u=new v({id:g,graphDiv:c,container:c.querySelector(".gl-container"),staticPlot:c._context.staticPlot,plotGlPixelRatio:c._context.plotGlPixelRatio},o),h._scene2d=u),u.plot(m,c.calcdata,o,c.layout)}},te.clean=function(t,c,o,i){for(var y=i._subplots.gl2d||[],p=0;p<y.length;p++){var g=y[p],h=i._plots[g];if(!!h._scene2d){var m=r(t,"gl2d",g);m.length===0&&(h._scene2d.destroy(),delete i._plots[g])}}a.clean.apply(this,arguments)},te.drawFramework=function(t){t._context.staticPlot||a.drawFramework(t)},te.toSVG=function(t){for(var c=t._fullLayout,o=c._subplots.gl2d,i=0;i<o.length;i++){var y=c._plots[o[i]],p=y._scene2d,g=p.toImage("png"),h=c._glimages.append("svg:image");h.attr({xmlns:M.svg,"xlink:href":g,x:0,y:0,width:"100%",height:"100%",preserveAspectRatio:"none"}),p.destroy()}},te.updateFx=function(t){for(var c=t._fullLayout,o=c._subplots.gl2d,i=0;i<o.length;i++){var y=c._plots[o[i]]._scene2d;y.updateFx(c.dragmode)}}},{"../../components/fx/layout_attributes":408,"../../constants/xmlns_namespaces":492,"../../plot_api/edit_types":548,"../cartesian":578,"../cartesian/attributes":564,"../cartesian/constants":573,"../get_data":602,"../layout_attributes":619,"./scene2d":606}],606:[function(d,ee,te){var w=d("../../registry"),v=d("../../plots/cartesian/axes"),S=d("../../components/fx"),M=d("../../../stackgl_modules").gl_plot2d,e=d("../../../stackgl_modules").gl_spikes2d,a=d("../../../stackgl_modules").gl_select_box,n=d("webgl-context"),r=d("./convert"),t=d("./camera"),c=d("../../lib/show_no_webgl_msg"),o=d("../cartesian/constraints"),i=o.enforce,y=o.clean,p=d("../cartesian/autorange").doAutoRange,g=d("../../components/dragelement/helpers"),h=g.drawMode,m=g.selectMode,u=["xaxis","yaxis"],_,s,A=d("../cartesian/constants").SUBPLOT_PATTERN;function b(l,L){this.container=l.container,this.graphDiv=l.graphDiv,this.pixelRatio=l.plotGlPixelRatio||window.devicePixelRatio,this.id=l.id,this.staticPlot=!!l.staticPlot,this.scrollZoom=this.graphDiv._context._scrollZoom.cartesian,this.fullData=null,this.updateRefs(L),this.makeFramework(),!this.stopped&&(this.glplotOptions=r(this),this.glplotOptions.merge(L),this.glplot=M(this.glplotOptions),this.camera=t(this),this.traces={},this.spikes=e(this.glplot),this.selectBox=a(this.glplot,{innerFill:!1,outerFill:!0}),this.lastButtonState=0,this.pickResult=null,this.isMouseOver=!0,this.stopped=!1,this.redraw=this.draw.bind(this),this.redraw())}ee.exports=b;var f=b.prototype;f.makeFramework=function(){if(this.staticPlot){if(!s&&(_=document.createElement("canvas"),s=n({canvas:_,preserveDrawingBuffer:!1,premultipliedAlpha:!0,antialias:!0}),!s))throw new Error("Error creating static canvas/context for image server");this.canvas=_,this.gl=s}else{var l=this.container.querySelector(".gl-canvas-focus"),L=n({canvas:l,preserveDrawingBuffer:!0,premultipliedAlpha:!0});if(!L){c(this),this.stopped=!0;return}this.canvas=l,this.gl=L}var T=this.canvas;T.style.width="100%",T.style.height="100%",T.style.position="absolute",T.style.top="0px",T.style.left="0px",T.style["pointer-events"]="none",this.updateSize(T);var k=this.svgContainer=document.createElementNS("http://www.w3.org/2000/svg","svg");k.style.position="absolute",k.style.top=k.style.left="0px",k.style.width=k.style.height="100%",k.style["z-index"]=20,k.style["pointer-events"]="none";var P=this.mouseContainer=document.createElement("div");P.style.position="absolute",P.style["pointer-events"]="auto",this.pickCanvas=this.container.querySelector(".gl-canvas-pick");var z=this.container;z.appendChild(k),z.appendChild(P);var I=this;P.addEventListener("mouseout",function(){I.isMouseOver=!1,I.unhover()}),P.addEventListener("mouseover",function(){I.isMouseOver=!0})},f.toImage=function(l){l||(l="png"),this.stopped=!0,this.staticPlot&&this.container.appendChild(_),this.updateSize(this.canvas);var L=this.glplot.gl,T=L.drawingBufferWidth,k=L.drawingBufferHeight;L.clearColor(1,1,1,0),L.clear(L.COLOR_BUFFER_BIT|L.DEPTH_BUFFER_BIT),this.glplot.setDirty(),this.glplot.draw(),L.bindFramebuffer(L.FRAMEBUFFER,null);var P=new Uint8Array(T*k*4);L.readPixels(0,0,T,k,L.RGBA,L.UNSIGNED_BYTE,P);for(var z=0,I=k-1;z<I;++z,--I)for(var D=0;D<T;++D)for(var R=0;R<4;++R){var B=P[4*(T*z+D)+R];P[4*(T*z+D)+R]=P[4*(T*I+D)+R],P[4*(T*I+D)+R]=B}var F=document.createElement("canvas");F.width=T,F.height=k;var H=F.getContext("2d",{willReadFrequently:!0}),G=H.createImageData(T,k);G.data.set(P),H.putImageData(G,0,0);var J;switch(l){case"jpeg":J=F.toDataURL("image/jpeg");break;case"webp":J=F.toDataURL("image/webp");break;default:J=F.toDataURL("image/png")}return this.staticPlot&&this.container.removeChild(_),J},f.updateSize=function(l){l||(l=this.canvas);var L=this.pixelRatio,T=this.fullLayout,k=T.width,P=T.height,z=Math.ceil(L*k)|0,I=Math.ceil(L*P)|0;return(l.width!==z||l.height!==I)&&(l.width=z,l.height=I),l},f.computeTickMarks=function(){this.xaxis.setScale(),this.yaxis.setScale();for(var l=[v.calcTicks(this.xaxis),v.calcTicks(this.yaxis)],L=0;L<2;++L)for(var T=0;T<l[L].length;++T)l[L][T].text=l[L][T].text+"";return l};function x(l,L){for(var T=0;T<2;++T){var k=l[T],P=L[T];if(k.length!==P.length)return!0;for(var z=0;z<k.length;++z)if(k[z].x!==P[z].x)return!0}return!1}f.updateRefs=function(l){this.fullLayout=l;var L=this.id.match(A),T="xaxis"+L[1],k="yaxis"+L[2];this.xaxis=this.fullLayout[T],this.yaxis=this.fullLayout[k]},f.relayoutCallback=function(){var l=this.graphDiv,L=this.xaxis,T=this.yaxis,k=l.layout,P={},z=P[L._name+".range"]=L.range.slice(),I=P[T._name+".range"]=T.range.slice();P[L._name+".autorange"]=L.autorange,P[T._name+".autorange"]=T.autorange,w.call("_storeDirectGUIEdit",l.layout,l._fullLayout._preGUI,P);var D=k[L._name];D.range=z,D.autorange=L.autorange;var R=k[T._name];R.range=I,R.autorange=T.autorange,P.lastInputTime=this.camera.lastInputTime,l.emit("plotly_relayout",P)},f.cameraChanged=function(){var l=this.camera;this.glplot.setDataBox(this.calcDataBox());var L=this.computeTickMarks(),T=this.glplotOptions.ticks;x(L,T)&&(this.glplotOptions.ticks=L,this.glplotOptions.dataBox=l.dataBox,this.glplot.update(this.glplotOptions),this.handleAnnotations())},f.handleAnnotations=function(){for(var l=this.graphDiv,L=this.fullLayout.annotations,T=0;T<L.length;T++){var k=L[T];k.xref===this.xaxis._id&&k.yref===this.yaxis._id&&w.getComponentMethod("annotations","drawOne")(l,T)}},f.destroy=function(){if(!!this.glplot){var l=this.traces;l&&Object.keys(l).map(function(L){l[L].dispose(),delete l[L]}),this.glplot.dispose(),this.container.removeChild(this.svgContainer),this.container.removeChild(this.mouseContainer),this.fullData=null,this.glplot=null,this.stopped=!0,this.camera.mouseListener.enabled=!1,this.mouseContainer.removeEventListener("wheel",this.camera.wheelListener),this.camera=null}},f.plot=function(l,L,T){var k=this.glplot;this.updateRefs(T),this.xaxis.clearCalc(),this.yaxis.clearCalc(),this.updateTraces(l,L),this.updateFx(T.dragmode);var P=T.width,z=T.height;this.updateSize(this.canvas);var I=this.glplotOptions;I.merge(T),I.screenBox=[0,0,P,z];var D={_fullLayout:{_axisConstraintGroups:T._axisConstraintGroups,xaxis:this.xaxis,yaxis:this.yaxis,_size:T._size}};y(D,this.xaxis),y(D,this.yaxis);var R=T._size,B=this.xaxis.domain,F=this.yaxis.domain;I.viewBox=[R.l+B[0]*R.w,R.b+F[0]*R.h,P-R.r-(1-B[1])*R.w,z-R.t-(1-F[1])*R.h],this.mouseContainer.style.width=R.w*(B[1]-B[0])+"px",this.mouseContainer.style.height=R.h*(F[1]-F[0])+"px",this.mouseContainer.height=R.h*(F[1]-F[0]),this.mouseContainer.style.left=R.l+B[0]*R.w+"px",this.mouseContainer.style.top=R.t+(1-F[1])*R.h+"px";var H,G;for(G=0;G<2;++G)H=this[u[G]],H._length=I.viewBox[G+2]-I.viewBox[G],p(this.graphDiv,H),H.setScale();i(D),I.ticks=this.computeTickMarks(),I.dataBox=this.calcDataBox(),I.merge(T),k.update(I),this.glplot.draw()},f.calcDataBox=function(){var l=this.xaxis,L=this.yaxis,T=l.range,k=L.range,P=l.r2l,z=L.r2l;return[P(T[0]),z(k[0]),P(T[1]),z(k[1])]},f.setRanges=function(l){var L=this.xaxis,T=this.yaxis,k=L.l2r,P=T.l2r;L.range=[k(l[0]),k(l[2])],T.range=[P(l[1]),P(l[3])]},f.updateTraces=function(l,L){var T=Object.keys(this.traces),k,P,z;this.fullData=l;e:for(k=0;k<T.length;k++){var I=T[k],D=this.traces[I];for(P=0;P<l.length;P++)if(z=l[P],z.uid===I&&z.type===D.type)continue e;D.dispose(),delete this.traces[I]}for(k=0;k<l.length;k++){z=l[k];var R=L[k],B=this.traces[z.uid];B?B.update(z,R):(B=z._module.plot(this,z,R),this.traces[z.uid]=B)}this.glplot.objects.sort(function(F,H){return F._trace.index-H._trace.index})},f.updateFx=function(l){m(l)||h(l)?(this.pickCanvas.style["pointer-events"]="none",this.mouseContainer.style["pointer-events"]="none"):(this.pickCanvas.style["pointer-events"]="auto",this.mouseContainer.style["pointer-events"]="auto"),l==="pan"?this.mouseContainer.style.cursor="move":l==="zoom"?this.mouseContainer.style.cursor="crosshair":this.mouseContainer.style.cursor=null},f.emitPointAction=function(l,L){for(var T=l.trace.uid,k=l.pointIndex,P,z=0;z<this.fullData.length;z++)this.fullData[z].uid===T&&(P=this.fullData[z]);var I={x:l.traceCoord[0],y:l.traceCoord[1],curveNumber:P.index,pointNumber:k,data:P._input,fullData:this.fullData,xaxis:this.xaxis,yaxis:this.yaxis};S.appendArrayPointValue(I,P,k),this.graphDiv.emit(L,{points:[I]})},f.draw=function(){if(!this.stopped){requestAnimationFrame(this.redraw);var l=this.glplot,L=this.camera,T=L.mouseListener,k=this.lastButtonState===1&&T.buttons===0,P=this.fullLayout;this.lastButtonState=T.buttons,this.cameraChanged();var z=T.x*l.pixelRatio,I=this.canvas.height-l.pixelRatio*T.y,D;if(L.boxEnabled&&P.dragmode==="zoom"){this.selectBox.enabled=!0;for(var R=this.selectBox.selectBox=[Math.min(L.boxStart[0],L.boxEnd[0]),Math.min(L.boxStart[1],L.boxEnd[1]),Math.max(L.boxStart[0],L.boxEnd[0]),Math.max(L.boxStart[1],L.boxEnd[1])],B=0;B<2;B++)L.boxStart[B]===L.boxEnd[B]&&(R[B]=l.dataBox[B],R[B+2]=l.dataBox[B+2]);l.setDirty()}else if(!L.panning&&this.isMouseOver){this.selectBox.enabled=!1;var F=P._size,H=this.xaxis.domain,G=this.yaxis.domain;D=l.pick(z/l.pixelRatio+F.l+H[0]*F.w,I/l.pixelRatio-(F.t+(1-G[1])*F.h));var J=D&&D.object._trace.handlePick(D);if(J&&k&&this.emitPointAction(J,"plotly_click"),D&&D.object._trace.hoverinfo!=="skip"&&P.hovermode&&J&&(!this.lastPickResult||this.lastPickResult.traceUid!==J.trace.uid||this.lastPickResult.dataCoord[0]!==J.dataCoord[0]||this.lastPickResult.dataCoord[1]!==J.dataCoord[1])){var X=J;this.lastPickResult={traceUid:J.trace?J.trace.uid:null,dataCoord:J.dataCoord.slice()},this.spikes.update({center:D.dataCoord}),X.screenCoord=[((l.viewBox[2]-l.viewBox[0])*(D.dataCoord[0]-l.dataBox[0])/(l.dataBox[2]-l.dataBox[0])+l.viewBox[0])/l.pixelRatio,(this.canvas.height-(l.viewBox[3]-l.viewBox[1])*(D.dataCoord[1]-l.dataBox[1])/(l.dataBox[3]-l.dataBox[1])-l.viewBox[1])/l.pixelRatio],this.emitPointAction(J,"plotly_hover");var Y=this.fullData[X.trace.index]||{},Z=X.pointIndex,oe=S.castHoverinfo(Y,P,Z);if(oe&&oe!=="all"){var re=oe.split("+");re.indexOf("x")===-1&&(X.traceCoord[0]=void 0),re.indexOf("y")===-1&&(X.traceCoord[1]=void 0),re.indexOf("z")===-1&&(X.traceCoord[2]=void 0),re.indexOf("text")===-1&&(X.textLabel=void 0),re.indexOf("name")===-1&&(X.name=void 0)}S.loneHover({x:X.screenCoord[0],y:X.screenCoord[1],xLabel:this.hoverFormatter("xaxis",X.traceCoord[0]),yLabel:this.hoverFormatter("yaxis",X.traceCoord[1]),zLabel:X.traceCoord[2],text:X.textLabel,name:X.name,color:S.castHoverOption(Y,Z,"bgcolor")||X.color,borderColor:S.castHoverOption(Y,Z,"bordercolor"),fontFamily:S.castHoverOption(Y,Z,"font.family"),fontSize:S.castHoverOption(Y,Z,"font.size"),fontColor:S.castHoverOption(Y,Z,"font.color"),nameLength:S.castHoverOption(Y,Z,"namelength"),textAlign:S.castHoverOption(Y,Z,"align")},{container:this.svgContainer,gd:this.graphDiv})}}D||this.unhover(),l.draw()}},f.unhover=function(){this.lastPickResult&&(this.spikes.update({}),this.lastPickResult=null,this.graphDiv.emit("plotly_unhover"),S.loneUnhover(this.svgContainer))},f.hoverFormatter=function(l,L){if(L!==void 0){var T=this[l];return v.tickText(T,T.c2l(L),"hover").text}}},{"../../../stackgl_modules":1133,"../../components/dragelement/helpers":385,"../../components/fx":407,"../../lib/show_no_webgl_msg":537,"../../plots/cartesian/axes":566,"../../registry":647,"../cartesian/autorange":565,"../cartesian/constants":573,"../cartesian/constraints":574,"./camera":603,"./convert":604,"webgl-context":332}],607:[function(d,ee,te){var w=d("../../plot_api/edit_types").overrideAll,v=d("../../components/fx/layout_attributes"),S=d("./scene"),M=d("../get_data").getSubplotData,e=d("../../lib"),a=d("../../constants/xmlns_namespaces"),n="gl3d",r="scene";te.name=n,te.attr=r,te.idRoot=r,te.idRegex=te.attrRegex=e.counterRegex("scene"),te.attributes=d("./layout/attributes"),te.layoutAttributes=d("./layout/layout_attributes"),te.baseLayoutAttrOverrides=w({hoverlabel:v.hoverlabel},"plot","nested"),te.supplyLayoutDefaults=d("./layout/defaults"),te.plot=function(c){for(var o=c._fullLayout,i=c._fullData,y=o._subplots[n],p=0;p<y.length;p++){var g=y[p],h=M(i,n,g),m=o[g],u=m.camera,_=m._scene;_||(_=new S({id:g,graphDiv:c,container:c.querySelector(".gl-container"),staticPlot:c._context.staticPlot,plotGlPixelRatio:c._context.plotGlPixelRatio,camera:u},o),m._scene=_),_.viewInitial||(_.viewInitial={up:{x:u.up.x,y:u.up.y,z:u.up.z},eye:{x:u.eye.x,y:u.eye.y,z:u.eye.z},center:{x:u.center.x,y:u.center.y,z:u.center.z}}),_.plot(h,o,c.layout)}},te.clean=function(t,c,o,i){for(var y=i._subplots[n]||[],p=0;p<y.length;p++){var g=y[p];!c[g]&&!!i[g]._scene&&(i[g]._scene.destroy(),i._infolayer&&i._infolayer.selectAll(".annotation-"+g).remove())}},te.toSVG=function(t){for(var c=t._fullLayout,o=c._subplots[n],i=c._size,y=0;y<o.length;y++){var p=c[o[y]],g=p.domain,h=p._scene,m=h.toImage("png"),u=c._glimages.append("svg:image");u.attr({xmlns:a.svg,"xlink:href":m,x:i.l+i.w*g.x[0],y:i.t+i.h*(1-g.y[1]),width:i.w*(g.x[1]-g.x[0]),height:i.h*(g.y[1]-g.y[0]),preserveAspectRatio:"none"}),h.destroy()}},te.cleanId=function(c){if(!!c.match(/^scene[0-9]*$/)){var o=c.substr(5);return o==="1"&&(o=""),r+o}},te.updateFx=function(t){for(var c=t._fullLayout,o=c._subplots[n],i=0;i<o.length;i++){var y=c[o[i]]._scene;y.updateFx(c.dragmode,c.hovermode)}}},{"../../components/fx/layout_attributes":408,"../../constants/xmlns_namespaces":492,"../../lib":515,"../../plot_api/edit_types":548,"../get_data":602,"./layout/attributes":608,"./layout/defaults":612,"./layout/layout_attributes":613,"./scene":617}],608:[function(d,ee,te){ee.exports={scene:{valType:"subplotid",dflt:"scene",editType:"calc+clearAxisTypes"}}},{}],609:[function(d,ee,te){var w=d("../../../components/color"),v=d("../../cartesian/layout_attributes"),S=d("../../../lib/extend").extendFlat,M=d("../../../plot_api/edit_types").overrideAll;ee.exports=M({visible:v.visible,showspikes:{valType:"boolean",dflt:!0},spikesides:{valType:"boolean",dflt:!0},spikethickness:{valType:"number",min:0,dflt:2},spikecolor:{valType:"color",dflt:w.defaultLine},showbackground:{valType:"boolean",dflt:!1},backgroundcolor:{valType:"color",dflt:"rgba(204, 204, 204, 0.5)"},showaxeslabels:{valType:"boolean",dflt:!0},color:v.color,categoryorder:v.categoryorder,categoryarray:v.categoryarray,title:{text:v.title.text,font:v.title.font},type:S({},v.type,{values:["-","linear","log","date","category"]}),autotypenumbers:v.autotypenumbers,autorange:v.autorange,rangemode:v.rangemode,range:S({},v.range,{items:[{valType:"any",editType:"plot",impliedEdits:{"^autorange":!1}},{valType:"any",editType:"plot",impliedEdits:{"^autorange":!1}}],anim:!1}),tickmode:v.tickmode,nticks:v.nticks,tick0:v.tick0,dtick:v.dtick,tickvals:v.tickvals,ticktext:v.ticktext,ticks:v.ticks,mirror:v.mirror,ticklen:v.ticklen,tickwidth:v.tickwidth,tickcolor:v.tickcolor,showticklabels:v.showticklabels,tickfont:v.tickfont,tickangle:v.tickangle,tickprefix:v.tickprefix,showtickprefix:v.showtickprefix,ticksuffix:v.ticksuffix,showticksuffix:v.showticksuffix,showexponent:v.showexponent,exponentformat:v.exponentformat,minexponent:v.minexponent,separatethousands:v.separatethousands,tickformat:v.tickformat,tickformatstops:v.tickformatstops,hoverformat:v.hoverformat,showline:v.showline,linecolor:v.linecolor,linewidth:v.linewidth,showgrid:v.showgrid,gridcolor:S({},v.gridcolor,{dflt:"rgb(204, 204, 204)"}),gridwidth:v.gridwidth,zeroline:v.zeroline,zerolinecolor:v.zerolinecolor,zerolinewidth:v.zerolinewidth,_deprecated:{title:v._deprecated.title,titlefont:v._deprecated.titlefont}},"plot","from-root")},{"../../../components/color":367,"../../../lib/extend":505,"../../../plot_api/edit_types":548,"../../cartesian/layout_attributes":579}],610:[function(d,ee,te){var w=d("tinycolor2").mix,v=d("../../../lib"),S=d("../../../plot_api/plot_template"),M=d("./axis_attributes"),e=d("../../cartesian/type_defaults"),a=d("../../cartesian/axis_defaults"),n=["xaxis","yaxis","zaxis"],r=100*(204-68)/(255-68);ee.exports=function(c,o,i){var y,p;function g(u,_){return v.coerce(y,p,M,u,_)}for(var h=0;h<n.length;h++){var m=n[h];y=c[m]||{},p=S.newContainer(o,m),p._id=m[0]+i.scene,p._name=m,e(y,p,g,i),a(y,p,g,{font:i.font,letter:m[0],data:i.data,showGrid:!0,noTickson:!0,noTicklabelmode:!0,noTicklabelstep:!0,noTicklabelposition:!0,noTicklabeloverflow:!0,bgColor:i.bgColor,calendar:i.calendar},i.fullLayout),g("gridcolor",w(p.color,i.bgColor,r).toRgbString()),g("title.text",m[0]),p.setScale=v.noop,g("showspikes")&&(g("spikesides"),g("spikethickness"),g("spikecolor",p.color)),g("showaxeslabels"),g("showbackground")&&g("backgroundcolor")}}},{"../../../lib":515,"../../../plot_api/plot_template":555,"../../cartesian/axis_defaults":568,"../../cartesian/type_defaults":591,"./axis_attributes":609,tinycolor2:313}],611:[function(d,ee,te){var w=d("../../../lib/str2rgbarray"),v=d("../../../lib"),S=["xaxis","yaxis","zaxis"];function M(){this.bounds=[[-10,-10,-10],[10,10,10]],this.ticks=[[],[],[]],this.tickEnable=[!0,!0,!0],this.tickFont=["sans-serif","sans-serif","sans-serif"],this.tickSize=[12,12,12],this.tickAngle=[0,0,0],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickPad=[18,18,18],this.labels=["x","y","z"],this.labelEnable=[!0,!0,!0],this.labelFont=["Open Sans","Open Sans","Open Sans"],this.labelSize=[20,20,20],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labelPad=[30,30,30],this.lineEnable=[!0,!0,!0],this.lineMirror=[!1,!1,!1],this.lineWidth=[1,1,1],this.lineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.lineTickEnable=[!0,!0,!0],this.lineTickMirror=[!1,!1,!1],this.lineTickLength=[10,10,10],this.lineTickWidth=[1,1,1],this.lineTickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.gridEnable=[!0,!0,!0],this.gridWidth=[1,1,1],this.gridColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroEnable=[!0,!0,!0],this.zeroLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroLineWidth=[2,2,2],this.backgroundEnable=[!0,!0,!0],this.backgroundColor=[[.8,.8,.8,.5],[.8,.8,.8,.5],[.8,.8,.8,.5]],this._defaultTickPad=this.tickPad.slice(),this._defaultLabelPad=this.labelPad.slice(),this._defaultLineTickLength=this.lineTickLength.slice()}var e=M.prototype;e.merge=function(n,r){for(var t=this,c=0;c<3;++c){var o=r[S[c]];if(!o.visible){t.tickEnable[c]=!1,t.labelEnable[c]=!1,t.lineEnable[c]=!1,t.lineTickEnable[c]=!1,t.gridEnable[c]=!1,t.zeroEnable[c]=!1,t.backgroundEnable[c]=!1;continue}t.labels[c]=n._meta?v.templateString(o.title.text,n._meta):o.title.text,"font"in o.title&&(o.title.font.color&&(t.labelColor[c]=w(o.title.font.color)),o.title.font.family&&(t.labelFont[c]=o.title.font.family),o.title.font.size&&(t.labelSize[c]=o.title.font.size)),"showline"in o&&(t.lineEnable[c]=o.showline),"linecolor"in o&&(t.lineColor[c]=w(o.linecolor)),"linewidth"in o&&(t.lineWidth[c]=o.linewidth),"showgrid"in o&&(t.gridEnable[c]=o.showgrid),"gridcolor"in o&&(t.gridColor[c]=w(o.gridcolor)),"gridwidth"in o&&(t.gridWidth[c]=o.gridwidth),o.type==="log"?t.zeroEnable[c]=!1:"zeroline"in o&&(t.zeroEnable[c]=o.zeroline),"zerolinecolor"in o&&(t.zeroLineColor[c]=w(o.zerolinecolor)),"zerolinewidth"in o&&(t.zeroLineWidth[c]=o.zerolinewidth),"ticks"in o&&!!o.ticks?t.lineTickEnable[c]=!0:t.lineTickEnable[c]=!1,"ticklen"in o&&(t.lineTickLength[c]=t._defaultLineTickLength[c]=o.ticklen),"tickcolor"in o&&(t.lineTickColor[c]=w(o.tickcolor)),"tickwidth"in o&&(t.lineTickWidth[c]=o.tickwidth),"tickangle"in o&&(t.tickAngle[c]=o.tickangle==="auto"?-3600:Math.PI*-o.tickangle/180),"showticklabels"in o&&(t.tickEnable[c]=o.showticklabels),"tickfont"in o&&(o.tickfont.color&&(t.tickColor[c]=w(o.tickfont.color)),o.tickfont.family&&(t.tickFont[c]=o.tickfont.family),o.tickfont.size&&(t.tickSize[c]=o.tickfont.size)),"mirror"in o?["ticks","all","allticks"].indexOf(o.mirror)!==-1?(t.lineTickMirror[c]=!0,t.lineMirror[c]=!0):o.mirror===!0?(t.lineTickMirror[c]=!1,t.lineMirror[c]=!0):(t.lineTickMirror[c]=!1,t.lineMirror[c]=!1):t.lineMirror[c]=!1,"showbackground"in o&&o.showbackground!==!1?(t.backgroundEnable[c]=!0,t.backgroundColor[c]=w(o.backgroundcolor)):t.backgroundEnable[c]=!1}};function a(n,r){var t=new M;return t.merge(n,r),t}ee.exports=a},{"../../../lib":515,"../../../lib/str2rgbarray":540}],612:[function(d,ee,te){var w=d("../../../lib"),v=d("../../../components/color"),S=d("../../../registry"),M=d("../../subplot_defaults"),e=d("./axis_defaults"),a=d("./layout_attributes"),n=d("../../get_data").getSubplotData,r="gl3d";ee.exports=function(o,i,y){var p=i._basePlotModules.length>1;function g(h){if(!p){var m=w.validate(o[h],a[h]);if(m)return o[h]}}M(o,i,y,{type:r,attributes:a,handleDefaults:t,fullLayout:i,font:i.font,fullData:y,getDfltFromLayout:g,autotypenumbersDflt:i.autotypenumbers,paper_bgcolor:i.paper_bgcolor,calendar:i.calendar})};function t(c,o,i,y){for(var p=i("bgcolor"),g=v.combine(p,y.paper_bgcolor),h=["up","center","eye"],m=0;m<h.length;m++)i("camera."+h[m]+".x"),i("camera."+h[m]+".y"),i("camera."+h[m]+".z");i("camera.projection.type");var u=!!i("aspectratio.x")&&!!i("aspectratio.y")&&!!i("aspectratio.z"),_=u?"manual":"auto",s=i("aspectmode",_);u||(c.aspectratio=o.aspectratio={x:1,y:1,z:1},s==="manual"&&(o.aspectmode="auto"),c.aspectmode=o.aspectmode);var A=n(y.fullData,r,y.id);e(c,o,{font:y.font,scene:y.id,data:A,bgColor:g,calendar:y.calendar,autotypenumbersDflt:y.autotypenumbersDflt,fullLayout:y.fullLayout}),S.getComponentMethod("annotations3d","handleDefaults")(c,o,y);var b=y.getDfltFromLayout("dragmode");if(b!==!1&&!b)if(b="orbit",c.camera&&c.camera.up){var f=c.camera.up.x,x=c.camera.up.y,l=c.camera.up.z;l!==0&&(!f||!x||!l||l/Math.sqrt(f*f+x*x+l*l)>.999)&&(b="turntable")}else b="turntable";i("dragmode",b),i("hovermode",y.getDfltFromLayout("hovermode"))}},{"../../../components/color":367,"../../../lib":515,"../../../registry":647,"../../get_data":602,"../../subplot_defaults":641,"./axis_defaults":610,"./layout_attributes":613}],613:[function(d,ee,te){var w=d("./axis_attributes"),v=d("../../domain").attributes,S=d("../../../lib/extend").extendFlat,M=d("../../../lib").counterRegex;function e(a,n,r){return{x:{valType:"number",dflt:a,editType:"camera"},y:{valType:"number",dflt:n,editType:"camera"},z:{valType:"number",dflt:r,editType:"camera"},editType:"camera"}}ee.exports={_arrayAttrRegexps:[M("scene",".annotations",!0)],bgcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"plot"},camera:{up:S(e(0,0,1),{}),center:S(e(0,0,0),{}),eye:S(e(1.25,1.25,1.25),{}),projection:{type:{valType:"enumerated",values:["perspective","orthographic"],dflt:"perspective",editType:"calc"},editType:"calc"},editType:"camera"},domain:v({name:"scene",editType:"plot"}),aspectmode:{valType:"enumerated",values:["auto","cube","data","manual"],dflt:"auto",editType:"plot",impliedEdits:{"aspectratio.x":void 0,"aspectratio.y":void 0,"aspectratio.z":void 0}},aspectratio:{x:{valType:"number",min:0,editType:"plot",impliedEdits:{"^aspectmode":"manual"}},y:{valType:"number",min:0,editType:"plot",impliedEdits:{"^aspectmode":"manual"}},z:{valType:"number",min:0,editType:"plot",impliedEdits:{"^aspectmode":"manual"}},editType:"plot",impliedEdits:{aspectmode:"manual"}},xaxis:w,yaxis:w,zaxis:w,dragmode:{valType:"enumerated",values:["orbit","turntable","zoom","pan",!1],editType:"plot"},hovermode:{valType:"enumerated",values:["closest",!1],dflt:"closest",editType:"modebar"},uirevision:{valType:"any",editType:"none"},editType:"plot",_deprecated:{cameraposition:{valType:"info_array",editType:"camera"}}}},{"../../../lib":515,"../../../lib/extend":505,"../../domain":593,"./axis_attributes":609}],614:[function(d,ee,te){var w=d("../../../lib/str2rgbarray"),v=["xaxis","yaxis","zaxis"];function S(){this.enabled=[!0,!0,!0],this.colors=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.drawSides=[!0,!0,!0],this.lineWidth=[1,1,1]}var M=S.prototype;M.merge=function(a){for(var n=0;n<3;++n){var r=a[v[n]];if(!r.visible){this.enabled[n]=!1,this.drawSides[n]=!1;continue}this.enabled[n]=r.showspikes,this.colors[n]=w(r.spikecolor),this.drawSides[n]=r.spikesides,this.lineWidth[n]=r.spikethickness}};function e(a){var n=new S;return n.merge(a),n}ee.exports=e},{"../../../lib/str2rgbarray":540}],615:[function(d,ee,te){ee.exports=e;var w=d("../../cartesian/axes"),v=d("../../../lib"),S=["xaxis","yaxis","zaxis"];function M(a){for(var n=new Array(3),r=0;r<3;++r){for(var t=a[r],c=new Array(t.length),o=0;o<t.length;++o)c[o]=t[o].x;n[r]=c}return n}function e(a){for(var n=a.axesOptions,r=a.glplot.axesPixels,t=a.fullSceneLayout,c=[[],[],[]],o=0;o<3;++o){var i=t[S[o]];if(i._length=(r[o].hi-r[o].lo)*r[o].pixelsPerDataUnit/a.dataScale[o],Math.abs(i._length)===1/0||isNaN(i._length))c[o]=[];else{i._input_range=i.range.slice(),i.range[0]=r[o].lo/a.dataScale[o],i.range[1]=r[o].hi/a.dataScale[o],i._m=1/(a.dataScale[o]*r[o].pixelsPerDataUnit),i.range[0]===i.range[1]&&(i.range[0]-=1,i.range[1]+=1);var y=i.tickmode;if(i.tickmode==="auto"){i.tickmode="linear";var p=i.nticks||v.constrain(i._length/40,4,9);w.autoTicks(i,Math.abs(i.range[1]-i.range[0])/p)}for(var g=w.calcTicks(i,{msUTC:!0}),h=0;h<g.length;++h)g[h].x=g[h].x*a.dataScale[o],i.type==="date"&&(g[h].text=g[h].text.replace(/\<br\>/g," "));c[o]=g,i.tickmode=y}}n.ticks=c;for(var o=0;o<3;++o){.5*(a.glplot.bounds[0][o]+a.glplot.bounds[1][o]);for(var h=0;h<2;++h)n.bounds[h][o]=a.glplot.bounds[h][o]}a.contourLevels=M(c)}},{"../../../lib":515,"../../cartesian/axes":566}],616:[function(d,ee,te){function w(S,M){var e=[0,0,0,0],a,n;for(a=0;a<4;++a)for(n=0;n<4;++n)e[n]+=S[4*a+n]*M[a];return e}function v(S,M){var e=w(S.projection,w(S.view,w(S.model,[M[0],M[1],M[2],1])));return e}ee.exports=v},{}],617:[function(d,ee,te){var w=d("../../../stackgl_modules").gl_plot3d,v=w.createCamera,S=w.createScene,M=d("webgl-context"),e=d("has-passive-events"),a=d("../../registry"),n=d("../../lib"),r=n.preserveDrawingBuffer(),t=d("../../plots/cartesian/axes"),c=d("../../components/fx"),o=d("../../lib/str2rgbarray"),i=d("../../lib/show_no_webgl_msg"),y=d("./project"),p=d("./layout/convert"),g=d("./layout/spikes"),h=d("./layout/tick_marks"),m,u;function _(P,z){var I=document.createElement("div"),D=P.container;this.graphDiv=P.graphDiv;var R=document.createElementNS("http://www.w3.org/2000/svg","svg");R.style.position="absolute",R.style.top=R.style.left="0px",R.style.width=R.style.height="100%",R.style["z-index"]=20,R.style["pointer-events"]="none",I.appendChild(R),this.svgContainer=R,I.id=P.id,I.style.position="absolute",I.style.top=I.style.left="0px",I.style.width=I.style.height="100%",D.appendChild(I),this.fullLayout=z,this.id=P.id||"scene",this.fullSceneLayout=z[this.id],this.plotArgs=[[],{},{}],this.axesOptions=p(z,z[this.id]),this.spikeOptions=g(z[this.id]),this.container=I,this.staticMode=!!P.staticPlot,this.pixelRatio=this.pixelRatio||P.plotGlPixelRatio||2,this.dataScale=[1,1,1],this.contourLevels=[[],[],[]],this.convertAnnotations=a.getComponentMethod("annotations3d","convert"),this.drawAnnotations=a.getComponentMethod("annotations3d","draw"),this.initializeGLPlot()}var s=_.prototype;s.prepareOptions=function(){var P=this,z={canvas:P.canvas,gl:P.gl,glOptions:{preserveDrawingBuffer:r,premultipliedAlpha:!0,antialias:!0},container:P.container,axes:P.axesOptions,spikes:P.spikeOptions,pickRadius:10,snapToData:!0,autoScale:!0,autoBounds:!1,cameraObject:P.camera,pixelRatio:P.pixelRatio};if(P.staticMode){if(!u&&(m=document.createElement("canvas"),u=M({canvas:m,preserveDrawingBuffer:!0,premultipliedAlpha:!0,antialias:!0}),!u))throw new Error("error creating static canvas/context for image server");z.gl=u,z.canvas=m}return z};var A=!0;s.tryCreatePlot=function(){var P=this,z=P.prepareOptions(),I=!0;try{P.glplot=S(z)}catch{if(P.staticMode||!A||r)I=!1;else{n.warn(["webgl setup failed possibly due to","false preserveDrawingBuffer config.","The mobile/tablet device may not be detected by is-mobile module.","Enabling preserveDrawingBuffer in second attempt to create webgl scene..."].join(" "));try{r=z.glOptions.preserveDrawingBuffer=!0,P.glplot=S(z)}catch{r=z.glOptions.preserveDrawingBuffer=!1,I=!1}}}return A=!1,I},s.initializeGLCamera=function(){var P=this,z=P.fullSceneLayout.camera,I=z.projection.type==="orthographic";P.camera=v(P.container,{center:[z.center.x,z.center.y,z.center.z],eye:[z.eye.x,z.eye.y,z.eye.z],up:[z.up.x,z.up.y,z.up.z],_ortho:I,zoomMin:.01,zoomMax:100,mode:"orbit"})},s.initializeGLPlot=function(){var P=this;P.initializeGLCamera();var z=P.tryCreatePlot();if(!z)return i(P);P.traces={},P.make4thDimension();var I=P.graphDiv,D=I.layout,R=function(){var F={};return P.isCameraChanged(D)&&(F[P.id+".camera"]=P.getCamera()),P.isAspectChanged(D)&&(F[P.id+".aspectratio"]=P.glplot.getAspectratio(),D[P.id].aspectmode!=="manual"&&(P.fullSceneLayout.aspectmode=D[P.id].aspectmode=F[P.id+".aspectmode"]="manual")),F},B=function(F){if(F.fullSceneLayout.dragmode!==!1){var H=R();F.saveLayout(D),F.graphDiv.emit("plotly_relayout",H)}};return P.glplot.canvas&&(P.glplot.canvas.addEventListener("mouseup",function(){B(P)}),P.glplot.canvas.addEventListener("wheel",function(F){if(I._context._scrollZoom.gl3d){if(P.camera._ortho){var H=F.deltaX>F.deltaY?1.1:.9090909090909091,G=P.glplot.getAspectratio();P.glplot.setAspectratio({x:H*G.x,y:H*G.y,z:H*G.z})}B(P)}},e?{passive:!1}:!1),P.glplot.canvas.addEventListener("mousemove",function(){if(P.fullSceneLayout.dragmode!==!1&&P.camera.mouseListener.buttons!==0){var F=R();P.graphDiv.emit("plotly_relayouting",F)}}),P.staticMode||P.glplot.canvas.addEventListener("webglcontextlost",function(F){I&&I.emit&&I.emit("plotly_webglcontextlost",{event:F,layer:P.id})},!1)),P.glplot.oncontextloss=function(){P.recoverContext()},P.glplot.onrender=function(){P.render()},!0},s.render=function(){var P=this,z=P.graphDiv,I,D=P.svgContainer,R=P.container.getBoundingClientRect();z._fullLayout._calcInverseTransform(z);var B=z._fullLayout._invScaleX,F=z._fullLayout._invScaleY,H=R.width*B,G=R.height*F;D.setAttributeNS(null,"viewBox","0 0 "+H+" "+G),D.setAttributeNS(null,"width",H),D.setAttributeNS(null,"height",G),h(P),P.glplot.axes.update(P.axesOptions);for(var J=Object.keys(P.traces),X=null,Y=P.glplot.selection,Z=0;Z<J.length;++Z)I=P.traces[J[Z]],I.data.hoverinfo!=="skip"&&I.handlePick(Y)&&(X=I),I.setContourLevels&&I.setContourLevels();function oe(ye,ue,pe){var ge=P.fullSceneLayout[ye+"axis"];return ge.type!=="log"&&(ue=ge.d2l(ue)),t.hoverLabelText(ge,ue,pe)}if(X!==null){var re=y(P.glplot.cameraParams,Y.dataCoordinate);I=X.data;var se=z._fullData[I.index],N=Y.index,U={xLabel:oe("x",Y.traceCoordinate[0],I.xhoverformat),yLabel:oe("y",Y.traceCoordinate[1],I.yhoverformat),zLabel:oe("z",Y.traceCoordinate[2],I.zhoverformat)},q=c.castHoverinfo(se,P.fullLayout,N),$=(q||"").split("+"),W=q&&q==="all";!se.hovertemplate&&!W&&($.indexOf("x")===-1&&(U.xLabel=void 0),$.indexOf("y")===-1&&(U.yLabel=void 0),$.indexOf("z")===-1&&(U.zLabel=void 0),$.indexOf("text")===-1&&(Y.textLabel=void 0),$.indexOf("name")===-1&&(X.name=void 0));var K,ne=[];I.type==="cone"||I.type==="streamtube"?(U.uLabel=oe("x",Y.traceCoordinate[3],I.uhoverformat),(W||$.indexOf("u")!==-1)&&ne.push("u: "+U.uLabel),U.vLabel=oe("y",Y.traceCoordinate[4],I.vhoverformat),(W||$.indexOf("v")!==-1)&&ne.push("v: "+U.vLabel),U.wLabel=oe("z",Y.traceCoordinate[5],I.whoverformat),(W||$.indexOf("w")!==-1)&&ne.push("w: "+U.wLabel),U.normLabel=Y.traceCoordinate[6].toPrecision(3),(W||$.indexOf("norm")!==-1)&&ne.push("norm: "+U.normLabel),I.type==="streamtube"&&(U.divergenceLabel=Y.traceCoordinate[7].toPrecision(3),(W||$.indexOf("divergence")!==-1)&&ne.push("divergence: "+U.divergenceLabel)),Y.textLabel&&ne.push(Y.textLabel),K=ne.join("<br>")):I.type==="isosurface"||I.type==="volume"?(U.valueLabel=t.hoverLabelText(P._mockAxis,P._mockAxis.d2l(Y.traceCoordinate[3]),I.valuehoverformat),ne.push("value: "+U.valueLabel),Y.textLabel&&ne.push(Y.textLabel),K=ne.join("<br>")):K=Y.textLabel;var ae={x:Y.traceCoordinate[0],y:Y.traceCoordinate[1],z:Y.traceCoordinate[2],data:se._input,fullData:se,curveNumber:se.index,pointNumber:N};c.appendArrayPointValue(ae,se,N),I._module.eventData&&(ae=se._module.eventData(ae,Y,se,{},N));var ie={points:[ae]};if(P.fullSceneLayout.hovermode){var le=[];c.loneHover({trace:se,x:(.5+.5*re[0]/re[3])*H,y:(.5-.5*re[1]/re[3])*G,xLabel:U.xLabel,yLabel:U.yLabel,zLabel:U.zLabel,text:K,name:X.name,color:c.castHoverOption(se,N,"bgcolor")||X.color,borderColor:c.castHoverOption(se,N,"bordercolor"),fontFamily:c.castHoverOption(se,N,"font.family"),fontSize:c.castHoverOption(se,N,"font.size"),fontColor:c.castHoverOption(se,N,"font.color"),nameLength:c.castHoverOption(se,N,"namelength"),textAlign:c.castHoverOption(se,N,"align"),hovertemplate:n.castOption(se,N,"hovertemplate"),hovertemplateLabels:n.extendFlat({},ae,U),eventData:[ae]},{container:D,gd:z,inOut_bbox:le}),ae.bbox=le[0]}Y.buttons&&Y.distance<5?z.emit("plotly_click",ie):z.emit("plotly_hover",ie),this.oldEventData=ie}else c.loneUnhover(D),this.oldEventData&&z.emit("plotly_unhover",this.oldEventData),this.oldEventData=void 0;P.drawAnnotations(P)},s.recoverContext=function(){var P=this;P.glplot.dispose();var z=function(){if(P.glplot.gl.isContextLost()){requestAnimationFrame(z);return}if(!P.initializeGLPlot()){n.error("Catastrophic and unrecoverable WebGL error. Context lost.");return}P.plot.apply(P,P.plotArgs)};requestAnimationFrame(z)};var b=["xaxis","yaxis","zaxis"];function f(P,z,I){for(var D=P.fullSceneLayout,R=0;R<3;R++){var B=b[R],F=B.charAt(0),H=D[B],G=z[F],J=z[F+"calendar"],X=z["_"+F+"length"];if(!n.isArrayOrTypedArray(G))I[0][R]=Math.min(I[0][R],0),I[1][R]=Math.max(I[1][R],X-1);else for(var Y,Z=0;Z<(X||G.length);Z++)if(n.isArrayOrTypedArray(G[Z]))for(var oe=0;oe<G[Z].length;++oe)Y=H.d2l(G[Z][oe],0,J),!isNaN(Y)&&isFinite(Y)&&(I[0][R]=Math.min(I[0][R],Y),I[1][R]=Math.max(I[1][R],Y));else Y=H.d2l(G[Z],0,J),!isNaN(Y)&&isFinite(Y)&&(I[0][R]=Math.min(I[0][R],Y),I[1][R]=Math.max(I[1][R],Y))}}function x(P,z){for(var I=P.fullSceneLayout,D=I.annotations||[],R=0;R<3;R++)for(var B=b[R],F=B.charAt(0),H=I[B],G=0;G<D.length;G++){var J=D[G];if(J.visible){var X=H.r2l(J[F]);!isNaN(X)&&isFinite(X)&&(z[0][R]=Math.min(z[0][R],X),z[1][R]=Math.max(z[1][R],X))}}}s.plot=function(P,z,I){var D=this;if(D.plotArgs=[P,z,I],D.glplot.contextLost)return;var R,B,F,H,G,J,X=z[D.id],Y=I[D.id];D.fullLayout=z,D.fullSceneLayout=X,D.axesOptions.merge(z,X),D.spikeOptions.merge(X),D.setViewport(X),D.updateFx(X.dragmode,X.hovermode),D.camera.enableWheel=D.graphDiv._context._scrollZoom.gl3d,D.glplot.setClearColor(o(X.bgcolor)),D.setConvert(G),P?Array.isArray(P)||(P=[P]):P=[];var Z=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]];for(F=0;F<P.length;++F)R=P[F],!(R.visible!==!0||R._length===0)&&f(this,R,Z);x(this,Z);var oe=[1,1,1];for(H=0;H<3;++H)Z[1][H]===Z[0][H]?oe[H]=1:oe[H]=1/(Z[1][H]-Z[0][H]);for(D.dataScale=oe,D.convertAnnotations(this),F=0;F<P.length;++F)R=P[F],!(R.visible!==!0||R._length===0)&&(B=D.traces[R.uid],B?B.data.type===R.type?B.update(R):(B.dispose(),B=R._module.plot(this,R),D.traces[R.uid]=B):(B=R._module.plot(this,R),D.traces[R.uid]=B),B.name=R.name);var re=Object.keys(D.traces);e:for(F=0;F<re.length;++F){for(H=0;H<P.length;++H)if(P[H].uid===re[F]&&P[H].visible===!0&&P[H]._length!==0)continue e;B=D.traces[re[F]],B.dispose(),delete D.traces[re[F]]}D.glplot.objects.sort(function(Pe,Ge){return Pe._trace.data.index-Ge._trace.data.index});var se=[[0,0,0],[0,0,0]],N={};for(F=0;F<3;++F){if(G=X[b[F]],J=G.type,J in N?(N[J].acc*=oe[F],N[J].count+=1):N[J]={acc:oe[F],count:1},G.autorange){se[0][F]=1/0,se[1][F]=-1/0;var U=D.glplot.objects,q=D.fullSceneLayout.annotations||[],$=G._name.charAt(0);for(H=0;H<U.length;H++){var W=U[H],K=W.bounds,ne=W._trace.data._pad||0;W.constructor.name==="ErrorBars"&&G._lowerLogErrorBound?se[0][F]=Math.min(se[0][F],G._lowerLogErrorBound):se[0][F]=Math.min(se[0][F],K[0][F]/oe[F]-ne),se[1][F]=Math.max(se[1][F],K[1][F]/oe[F]+ne)}for(H=0;H<q.length;H++){var ae=q[H];if(ae.visible){var ie=G.r2l(ae[$]);se[0][F]=Math.min(se[0][F],ie),se[1][F]=Math.max(se[1][F],ie)}}if("rangemode"in G&&G.rangemode==="tozero"&&(se[0][F]=Math.min(se[0][F],0),se[1][F]=Math.max(se[1][F],0)),se[0][F]>se[1][F])se[0][F]=-1,se[1][F]=1;else{var le=se[1][F]-se[0][F];se[0][F]-=le/32,se[1][F]+=le/32}if(G.autorange==="reversed"){var ye=se[0][F];se[0][F]=se[1][F],se[1][F]=ye}}else{var ue=G.range;se[0][F]=G.r2l(ue[0]),se[1][F]=G.r2l(ue[1])}se[0][F]===se[1][F]&&(se[0][F]-=1,se[1][F]+=1),D.glplot.setBounds(F,{min:se[0][F]*oe[F],max:se[1][F]*oe[F]})}var pe,ge=X.aspectmode;if(ge==="cube")pe=[1,1,1];else if(ge==="manual"){var Te=X.aspectratio;pe=[Te.x,Te.y,Te.z]}else if(ge==="auto"||ge==="data"){var _e=[1,1,1];for(F=0;F<3;++F){G=X[b[F]],J=G.type;var ze=N[J];_e[F]=Math.pow(ze.acc,1/ze.count)/oe[F]}ge==="data"||Math.max.apply(null,_e)/Math.min.apply(null,_e)<=4?pe=_e:pe=[1,1,1]}else throw new Error("scene.js aspectRatio was not one of the enumerated types");X.aspectratio.x=Y.aspectratio.x=pe[0],X.aspectratio.y=Y.aspectratio.y=pe[1],X.aspectratio.z=Y.aspectratio.z=pe[2],D.glplot.setAspectratio(X.aspectratio),D.viewInitial.aspectratio||(D.viewInitial.aspectratio={x:X.aspectratio.x,y:X.aspectratio.y,z:X.aspectratio.z}),D.viewInitial.aspectmode||(D.viewInitial.aspectmode=X.aspectmode);var Oe=X.domain||null,Ye=z._size||null;if(Oe&&Ye){var be=D.container.style;be.position="absolute",be.left=Ye.l+Oe.x[0]*Ye.w+"px",be.top=Ye.t+(1-Oe.y[1])*Ye.h+"px",be.width=Ye.w*(Oe.x[1]-Oe.x[0])+"px",be.height=Ye.h*(Oe.y[1]-Oe.y[0])+"px"}D.glplot.redraw()},s.destroy=function(){var P=this;!P.glplot||(P.camera.mouseListener.enabled=!1,P.container.removeEventListener("wheel",P.camera.wheelListener),P.camera=null,P.glplot.dispose(),P.container.parentNode.removeChild(P.container),P.glplot=null)};function l(P){return[[P.eye.x,P.eye.y,P.eye.z],[P.center.x,P.center.y,P.center.z],[P.up.x,P.up.y,P.up.z]]}function L(P){return{up:{x:P.up[0],y:P.up[1],z:P.up[2]},center:{x:P.center[0],y:P.center[1],z:P.center[2]},eye:{x:P.eye[0],y:P.eye[1],z:P.eye[2]},projection:{type:P._ortho===!0?"orthographic":"perspective"}}}s.getCamera=function(){var P=this;return P.camera.view.recalcMatrix(P.camera.view.lastT()),L(P.camera)},s.setViewport=function(P){var z=this,I=P.camera;z.camera.lookAt.apply(this,l(I)),z.glplot.setAspectratio(P.aspectratio);var D=I.projection.type==="orthographic",R=z.camera._ortho;D!==R&&(z.glplot.redraw(),z.glplot.clearRGBA(),z.glplot.dispose(),z.initializeGLPlot())},s.isCameraChanged=function(P){var z=this,I=z.getCamera(),D=n.nestedProperty(P,z.id+".camera"),R=D.get();function B(J,X,Y,Z){var oe=["up","center","eye"],re=["x","y","z"];return X[oe[Y]]&&J[oe[Y]][re[Z]]===X[oe[Y]][re[Z]]}var F=!1;if(R===void 0)F=!0;else{for(var H=0;H<3;H++)for(var G=0;G<3;G++)if(!B(I,R,H,G)){F=!0;break}(!R.projection||I.projection&&I.projection.type!==R.projection.type)&&(F=!0)}return F},s.isAspectChanged=function(P){var z=this,I=z.glplot.getAspectratio(),D=n.nestedProperty(P,z.id+".aspectratio"),R=D.get();return R===void 0||R.x!==I.x||R.y!==I.y||R.z!==I.z},s.saveLayout=function(P){var z=this,I=z.fullLayout,D,R,B,F,H,G,J=z.isCameraChanged(P),X=z.isAspectChanged(P),Y=J||X;if(Y){var Z={};if(J&&(D=z.getCamera(),R=n.nestedProperty(P,z.id+".camera"),B=R.get(),Z[z.id+".camera"]=B),X&&(F=z.glplot.getAspectratio(),H=n.nestedProperty(P,z.id+".aspectratio"),G=H.get(),Z[z.id+".aspectratio"]=G),a.call("_storeDirectGUIEdit",P,I._preGUI,Z),J){R.set(D);var oe=n.nestedProperty(I,z.id+".camera");oe.set(D)}if(X){H.set(F);var re=n.nestedProperty(I,z.id+".aspectratio");re.set(F),z.glplot.redraw()}}return Y},s.updateFx=function(P,z){var I=this,D=I.camera;if(D)if(P==="orbit")D.mode="orbit",D.keyBindingMode="rotate";else if(P==="turntable"){D.up=[0,0,1],D.mode="turntable",D.keyBindingMode="rotate";var R=I.graphDiv,B=R._fullLayout,F=I.fullSceneLayout.camera,H=F.up.x,G=F.up.y,J=F.up.z;if(J/Math.sqrt(H*H+G*G+J*J)<.999){var X=I.id+".camera.up",Y={x:0,y:0,z:1},Z={};Z[X]=Y;var oe=R.layout;a.call("_storeDirectGUIEdit",oe,B._preGUI,Z),F.up=Y,n.nestedProperty(oe,X).set(Y)}}else D.keyBindingMode=P;I.fullSceneLayout.hovermode=z};function T(P,z,I){for(var D=0,R=I-1;D<R;++D,--R)for(var B=0;B<z;++B)for(var F=0;F<4;++F){var H=4*(z*D+B)+F,G=4*(z*R+B)+F,J=P[H];P[H]=P[G],P[G]=J}}function k(P,z,I){for(var D=0;D<I;++D)for(var R=0;R<z;++R){var B=4*(z*D+R),F=P[B+3];if(F>0)for(var H=255/F,G=0;G<3;++G)P[B+G]=Math.min(H*P[B+G],255)}}s.toImage=function(P){var z=this;P||(P="png"),z.staticMode&&z.container.appendChild(m),z.glplot.redraw();var I=z.glplot.gl,D=I.drawingBufferWidth,R=I.drawingBufferHeight;I.bindFramebuffer(I.FRAMEBUFFER,null);var B=new Uint8Array(D*R*4);I.readPixels(0,0,D,R,I.RGBA,I.UNSIGNED_BYTE,B),T(B,D,R),k(B,D,R);var F=document.createElement("canvas");F.width=D,F.height=R;var H=F.getContext("2d",{willReadFrequently:!0}),G=H.createImageData(D,R);G.data.set(B),H.putImageData(G,0,0);var J;switch(P){case"jpeg":J=F.toDataURL("image/jpeg");break;case"webp":J=F.toDataURL("image/webp");break;default:J=F.toDataURL("image/png")}return z.staticMode&&z.container.removeChild(m),J},s.setConvert=function(){for(var P=this,z=0;z<3;z++){var I=P.fullSceneLayout[b[z]];t.setConvert(I,P.fullLayout),I.setScale=n.noop}},s.make4thDimension=function(){var P=this,z=P.graphDiv,I=z._fullLayout;P._mockAxis={type:"linear",showexponent:"all",exponentformat:"B"},t.setConvert(P._mockAxis,I)},ee.exports=_},{"../../../stackgl_modules":1133,"../../components/fx":407,"../../lib":515,"../../lib/show_no_webgl_msg":537,"../../lib/str2rgbarray":540,"../../plots/cartesian/axes":566,"../../registry":647,"./layout/convert":611,"./layout/spikes":614,"./layout/tick_marks":615,"./project":616,"has-passive-events":229,"webgl-context":332}],618:[function(d,ee,te){ee.exports=function(v,S,M,e){e=e||v.length;for(var a=new Array(e),n=0;n<e;n++)a[n]=[v[n],S[n],M[n]];return a}},{}],619:[function(d,ee,te){var w=d("./font_attributes"),v=d("./animation_attributes"),S=d("../components/color/attributes"),M=d("../components/shapes/draw_newshape/attributes"),e=d("../components/selections/draw_newselection/attributes"),a=d("./pad_attributes"),n=d("../lib/extend").extendFlat,r=w({editType:"calc"});r.family.dflt='"Open Sans", verdana, arial, sans-serif',r.size.dflt=12,r.color.dflt=S.defaultLine,ee.exports={font:r,title:{text:{valType:"string",editType:"layoutstyle"},font:w({editType:"layoutstyle"}),xref:{valType:"enumerated",dflt:"container",values:["container","paper"],editType:"layoutstyle"},yref:{valType:"enumerated",dflt:"container",values:["container","paper"],editType:"layoutstyle"},x:{valType:"number",min:0,max:1,dflt:.5,editType:"layoutstyle"},y:{valType:"number",min:0,max:1,dflt:"auto",editType:"layoutstyle"},xanchor:{valType:"enumerated",dflt:"auto",values:["auto","left","center","right"],editType:"layoutstyle"},yanchor:{valType:"enumerated",dflt:"auto",values:["auto","top","middle","bottom"],editType:"layoutstyle"},pad:n(a({editType:"layoutstyle"}),{}),editType:"layoutstyle"},uniformtext:{mode:{valType:"enumerated",values:[!1,"hide","show"],dflt:!1,editType:"plot"},minsize:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"plot"},autosize:{valType:"boolean",dflt:!1,editType:"none"},width:{valType:"number",min:10,dflt:700,editType:"plot"},height:{valType:"number",min:10,dflt:450,editType:"plot"},margin:{l:{valType:"number",min:0,dflt:80,editType:"plot"},r:{valType:"number",min:0,dflt:80,editType:"plot"},t:{valType:"number",min:0,dflt:100,editType:"plot"},b:{valType:"number",min:0,dflt:80,editType:"plot"},pad:{valType:"number",min:0,dflt:0,editType:"plot"},autoexpand:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},computed:{valType:"any",editType:"none"},paper_bgcolor:{valType:"color",dflt:S.background,editType:"plot"},plot_bgcolor:{valType:"color",dflt:S.background,editType:"layoutstyle"},autotypenumbers:{valType:"enumerated",values:["convert types","strict"],dflt:"convert types",editType:"calc"},separators:{valType:"string",editType:"plot"},hidesources:{valType:"boolean",dflt:!1,editType:"plot"},showlegend:{valType:"boolean",editType:"legend"},colorway:{valType:"colorlist",dflt:S.defaults,editType:"calc"},datarevision:{valType:"any",editType:"calc"},uirevision:{valType:"any",editType:"none"},editrevision:{valType:"any",editType:"none"},selectionrevision:{valType:"any",editType:"none"},template:{valType:"any",editType:"calc"},newshape:M.newshape,activeshape:M.activeshape,newselection:e.newselection,activeselection:e.activeselection,meta:{valType:"any",arrayOk:!0,editType:"plot"},transition:n({},v.transition,{editType:"none"}),_deprecated:{title:{valType:"string",editType:"layoutstyle"},titlefont:w({editType:"layoutstyle"})}}},{"../components/color/attributes":366,"../components/selections/draw_newselection/attributes":451,"../components/shapes/draw_newshape/attributes":463,"../lib/extend":505,"./animation_attributes":560,"./font_attributes":594,"./pad_attributes":627}],620:[function(d,ee,te){var w=d("../../lib/sort_object_keys"),v="1.10.1",S='\xA9 <a target="_blank" href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',M=['\xA9 <a target="_blank" href="https://carto.com/">Carto</a>',S].join(" "),e=['Map tiles by <a target="_blank" href="https://stamen.com">Stamen Design</a>','under <a target="_blank" href="https://creativecommons.org/licenses/by/3.0">CC BY 3.0</a>',"|",'Data by <a target="_blank" href="https://openstreetmap.org">OpenStreetMap</a> contributors','under <a target="_blank" href="https://www.openstreetmap.org/copyright">ODbL</a>'].join(" "),a=['Map tiles by <a target="_blank" href="https://stamen.com">Stamen Design</a>','under <a target="_blank" href="https://creativecommons.org/licenses/by/3.0">CC BY 3.0</a>',"|",'Data by <a target="_blank" href="https://openstreetmap.org">OpenStreetMap</a> contributors','under <a target="_blank" href="https://creativecommons.org/licenses/by-sa/3.0">CC BY SA</a>'].join(" "),n={"open-street-map":{id:"osm",version:8,sources:{"plotly-osm-tiles":{type:"raster",attribution:S,tiles:["https://a.tile.openstreetmap.org/{z}/{x}/{y}.png","https://b.tile.openstreetmap.org/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-osm-tiles",type:"raster",source:"plotly-osm-tiles",minzoom:0,maxzoom:22}]},"white-bg":{id:"white-bg",version:8,sources:{},layers:[{id:"white-bg",type:"background",paint:{"background-color":"#FFFFFF"},minzoom:0,maxzoom:22}]},"carto-positron":{id:"carto-positron",version:8,sources:{"plotly-carto-positron":{type:"raster",attribution:M,tiles:["https://cartodb-basemaps-c.global.ssl.fastly.net/light_all/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-carto-positron",type:"raster",source:"plotly-carto-positron",minzoom:0,maxzoom:22}]},"carto-darkmatter":{id:"carto-darkmatter",version:8,sources:{"plotly-carto-darkmatter":{type:"raster",attribution:M,tiles:["https://cartodb-basemaps-c.global.ssl.fastly.net/dark_all/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-carto-darkmatter",type:"raster",source:"plotly-carto-darkmatter",minzoom:0,maxzoom:22}]},"stamen-terrain":{id:"stamen-terrain",version:8,sources:{"plotly-stamen-terrain":{type:"raster",attribution:e,tiles:["https://stamen-tiles.a.ssl.fastly.net/terrain/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-stamen-terrain",type:"raster",source:"plotly-stamen-terrain",minzoom:0,maxzoom:22}]},"stamen-toner":{id:"stamen-toner",version:8,sources:{"plotly-stamen-toner":{type:"raster",attribution:e,tiles:["https://stamen-tiles.a.ssl.fastly.net/toner/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-stamen-toner",type:"raster",source:"plotly-stamen-toner",minzoom:0,maxzoom:22}]},"stamen-watercolor":{id:"stamen-watercolor",version:8,sources:{"plotly-stamen-watercolor":{type:"raster",attribution:a,tiles:["https://stamen-tiles.a.ssl.fastly.net/watercolor/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-stamen-watercolor",type:"raster",source:"plotly-stamen-watercolor",minzoom:0,maxzoom:22}]}},r=w(n);ee.exports={requiredVersion:v,styleUrlPrefix:"mapbox://styles/mapbox/",styleUrlSuffix:"v9",styleValuesMapbox:["basic","streets","outdoors","light","dark","satellite","satellite-streets"],styleValueDflt:"basic",stylesNonMapbox:n,styleValuesNonMapbox:r,traceLayerPrefix:"plotly-trace-layer-",layoutLayerPrefix:"plotly-layout-layer-",wrongVersionErrorMsg:["Your custom plotly.js bundle is not using the correct mapbox-gl version","Please install mapbox-gl@"+v+"."].join(`
`),noAccessTokenErrorMsg:["Missing Mapbox access token.","Mapbox trace type require a Mapbox access token to be registered.","For example:","  Plotly.newPlot(gd, data, layout, { mapboxAccessToken: 'my-access-token' });","More info here: https://www.mapbox.com/help/define-access-token/"].join(`
`),missingStyleErrorMsg:["No valid mapbox style found, please set `mapbox.style` to one of:",r.join(", "),"or register a Mapbox access token to use a Mapbox-served style."].join(`
`),multipleTokensErrorMsg:["Set multiple mapbox access token across different mapbox subplot,","using first token found as mapbox-gl does not allow multipleaccess tokens on the same page."].join(`
`),mapOnErrorMsg:"Mapbox error.",mapboxLogo:{path0:"m 10.5,1.24 c -5.11,0 -9.25,4.15 -9.25,9.25 0,5.1 4.15,9.25 9.25,9.25 5.1,0 9.25,-4.15 9.25,-9.25 0,-5.11 -4.14,-9.25 -9.25,-9.25 z m 4.39,11.53 c -1.93,1.93 -4.78,2.31 -6.7,2.31 -0.7,0 -1.41,-0.05 -2.1,-0.16 0,0 -1.02,-5.64 2.14,-8.81 0.83,-0.83 1.95,-1.28 3.13,-1.28 1.27,0 2.49,0.51 3.39,1.42 1.84,1.84 1.89,4.75 0.14,6.52 z",path1:"M 10.5,-0.01 C 4.7,-0.01 0,4.7 0,10.49 c 0,5.79 4.7,10.5 10.5,10.5 5.8,0 10.5,-4.7 10.5,-10.5 C 20.99,4.7 16.3,-0.01 10.5,-0.01 Z m 0,19.75 c -5.11,0 -9.25,-4.15 -9.25,-9.25 0,-5.1 4.14,-9.26 9.25,-9.26 5.11,0 9.25,4.15 9.25,9.25 0,5.13 -4.14,9.26 -9.25,9.26 z",path2:"M 14.74,6.25 C 12.9,4.41 9.98,4.35 8.23,6.1 5.07,9.27 6.09,14.91 6.09,14.91 c 0,0 5.64,1.02 8.81,-2.14 C 16.64,11 16.59,8.09 14.74,6.25 Z m -2.27,4.09 -0.91,1.87 -0.9,-1.87 -1.86,-0.91 1.86,-0.9 0.9,-1.87 0.91,1.87 1.86,0.9 z",polygon:"11.56,12.21 10.66,10.34 8.8,9.43 10.66,8.53 11.56,6.66 12.47,8.53 14.33,9.43 12.47,10.34"},styleRules:{map:"overflow:hidden;position:relative;","missing-css":"display:none;",canary:"background-color:salmon;","ctrl-bottom-left":"position: absolute; pointer-events: none; z-index: 2; bottom: 0; left: 0;","ctrl-bottom-right":"position: absolute; pointer-events: none; z-index: 2; right: 0; bottom: 0;",ctrl:"clear: both; pointer-events: auto; transform: translate(0, 0);","ctrl-attrib.mapboxgl-compact .mapboxgl-ctrl-attrib-inner":"display: none;","ctrl-attrib.mapboxgl-compact:hover .mapboxgl-ctrl-attrib-inner":"display: block; margin-top:2px","ctrl-attrib.mapboxgl-compact:hover":"padding: 2px 24px 2px 4px; visibility: visible; margin-top: 6px;","ctrl-attrib.mapboxgl-compact::after":`content: ""; cursor: pointer; position: absolute; background-image: url('data:image/svg+xml;charset=utf-8,%3Csvg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"%3E %3Cpath fill="%23333333" fill-rule="evenodd" d="M4,10a6,6 0 1,0 12,0a6,6 0 1,0 -12,0 M9,7a1,1 0 1,0 2,0a1,1 0 1,0 -2,0 M9,10a1,1 0 1,1 2,0l0,3a1,1 0 1,1 -2,0"/%3E %3C/svg%3E'); background-color: rgba(255, 255, 255, 0.5); width: 24px; height: 24px; box-sizing: border-box; border-radius: 12px;`,"ctrl-attrib.mapboxgl-compact":"min-height: 20px; padding: 0; margin: 10px; position: relative; background-color: #fff; border-radius: 3px 12px 12px 3px;","ctrl-bottom-right > .mapboxgl-ctrl-attrib.mapboxgl-compact::after":"bottom: 0; right: 0","ctrl-bottom-left > .mapboxgl-ctrl-attrib.mapboxgl-compact::after":"bottom: 0; left: 0","ctrl-bottom-left .mapboxgl-ctrl":"margin: 0 0 10px 10px; float: left;","ctrl-bottom-right .mapboxgl-ctrl":"margin: 0 10px 10px 0; float: right;","ctrl-attrib":"color: rgba(0, 0, 0, 0.75); text-decoration: none; font-size: 12px","ctrl-attrib a":"color: rgba(0, 0, 0, 0.75); text-decoration: none; font-size: 12px","ctrl-attrib a:hover":"color: inherit; text-decoration: underline;","ctrl-attrib .mapbox-improve-map":"font-weight: bold; margin-left: 2px;","attrib-empty":"display: none;","ctrl-logo":`display:block; width: 21px; height: 21px; background-image: url('data:image/svg+xml;charset=utf-8,%3C?xml version="1.0" encoding="utf-8"?%3E %3Csvg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 21 21" style="enable-background:new 0 0 21 21;" xml:space="preserve"%3E%3Cg transform="translate(0,0.01)"%3E%3Cpath d="m 10.5,1.24 c -5.11,0 -9.25,4.15 -9.25,9.25 0,5.1 4.15,9.25 9.25,9.25 5.1,0 9.25,-4.15 9.25,-9.25 0,-5.11 -4.14,-9.25 -9.25,-9.25 z m 4.39,11.53 c -1.93,1.93 -4.78,2.31 -6.7,2.31 -0.7,0 -1.41,-0.05 -2.1,-0.16 0,0 -1.02,-5.64 2.14,-8.81 0.83,-0.83 1.95,-1.28 3.13,-1.28 1.27,0 2.49,0.51 3.39,1.42 1.84,1.84 1.89,4.75 0.14,6.52 z" style="opacity:0.9;fill:%23ffffff;enable-background:new" class="st0"/%3E%3Cpath d="M 10.5,-0.01 C 4.7,-0.01 0,4.7 0,10.49 c 0,5.79 4.7,10.5 10.5,10.5 5.8,0 10.5,-4.7 10.5,-10.5 C 20.99,4.7 16.3,-0.01 10.5,-0.01 Z m 0,19.75 c -5.11,0 -9.25,-4.15 -9.25,-9.25 0,-5.1 4.14,-9.26 9.25,-9.26 5.11,0 9.25,4.15 9.25,9.25 0,5.13 -4.14,9.26 -9.25,9.26 z" style="opacity:0.35;enable-background:new" class="st1"/%3E%3Cpath d="M 14.74,6.25 C 12.9,4.41 9.98,4.35 8.23,6.1 5.07,9.27 6.09,14.91 6.09,14.91 c 0,0 5.64,1.02 8.81,-2.14 C 16.64,11 16.59,8.09 14.74,6.25 Z m -2.27,4.09 -0.91,1.87 -0.9,-1.87 -1.86,-0.91 1.86,-0.9 0.9,-1.87 0.91,1.87 1.86,0.9 z" style="opacity:0.35;enable-background:new" class="st1"/%3E%3Cpolygon points="11.56,12.21 10.66,10.34 8.8,9.43 10.66,8.53 11.56,6.66 12.47,8.53 14.33,9.43 12.47,10.34 " style="opacity:0.9;fill:%23ffffff;enable-background:new" class="st0"/%3E%3C/g%3E%3C/svg%3E')`}}},{"../../lib/sort_object_keys":538}],621:[function(d,ee,te){var w=d("../../lib");ee.exports=function(S,M){var e=S.split(" "),a=e[0],n=e[1],r=w.isArrayOrTypedArray(M)?w.mean(M):M,t=.5+r/100,c=1.5+r/100,o=["",""],i=[0,0];switch(a){case"top":o[0]="top",i[1]=-c;break;case"bottom":o[0]="bottom",i[1]=c;break}switch(n){case"left":o[1]="right",i[0]=-t;break;case"right":o[1]="left",i[0]=t;break}var y;return o[0]&&o[1]?y=o.join("-"):o[0]?y=o[0]:o[1]?y=o[1]:y="center",{anchor:y,offset:i}}},{"../../lib":515}],622:[function(d,ee,te){var w=d("mapbox-gl/dist/mapbox-gl-unminified"),v=d("../../lib"),S=v.strTranslate,M=v.strScale,e=d("../../plots/get_data").getSubplotCalcData,a=d("../../constants/xmlns_namespaces"),n=d("@plotly/d3"),r=d("../../components/drawing"),t=d("../../lib/svg_text_utils"),c=d("./mapbox"),o="mapbox",i=te.constants=d("./constants");te.name=o,te.attr="subplot",te.idRoot=o,te.idRegex=te.attrRegex=v.counterRegex(o),te.attributes={subplot:{valType:"subplotid",dflt:"mapbox",editType:"calc"}},te.layoutAttributes=d("./layout_attributes"),te.supplyLayoutDefaults=d("./layout_defaults"),te.plot=function(h){var m=h._fullLayout,u=h.calcdata,_=m._subplots[o];if(w.version!==i.requiredVersion)throw new Error(i.wrongVersionErrorMsg);var s=y(h,_);w.accessToken=s;for(var A=0;A<_.length;A++){var b=_[A],f=e(u,o,b),x=m[b],l=x._subplot;l||(l=new c(h,b),m[b]._subplot=l),l.viewInitial||(l.viewInitial={center:v.extendFlat({},x.center),zoom:x.zoom,bearing:x.bearing,pitch:x.pitch}),l.plot(f,m,h._promises)}},te.clean=function(g,h,m,u){for(var _=u._subplots[o]||[],s=0;s<_.length;s++){var A=_[s];!h[A]&&!!u[A]._subplot&&u[A]._subplot.destroy()}},te.toSVG=function(g){for(var h=g._fullLayout,m=h._subplots[o],u=h._size,_=0;_<m.length;_++){var s=h[m[_]],A=s.domain,b=s._subplot,f=b.toImage("png"),x=h._glimages.append("svg:image");x.attr({xmlns:a.svg,"xlink:href":f,x:u.l+u.w*A.x[0],y:u.t+u.h*(1-A.y[1]),width:u.w*(A.x[1]-A.x[0]),height:u.h*(A.y[1]-A.y[0]),preserveAspectRatio:"none"});var l=n.select(s._subplot.div),L=l.select(".mapboxgl-ctrl-logo").node().offsetParent===null;if(!L){var T=h._glimages.append("g");T.attr("transform",S(u.l+u.w*A.x[0]+10,u.t+u.h*(1-A.y[0])-31)),T.append("path").attr("d",i.mapboxLogo.path0).style({opacity:.9,fill:"#ffffff","enable-background":"new"}),T.append("path").attr("d",i.mapboxLogo.path1).style("opacity",.35).style("enable-background","new"),T.append("path").attr("d",i.mapboxLogo.path2).style("opacity",.35).style("enable-background","new"),T.append("polygon").attr("points",i.mapboxLogo.polygon).style({opacity:.9,fill:"#ffffff","enable-background":"new"})}var k=l.select(".mapboxgl-ctrl-attrib").text().replace("Improve this map",""),P=h._glimages.append("g"),z=P.append("text");z.text(k).classed("static-attribution",!0).attr({"font-size":12,"font-family":"Arial",color:"rgba(0, 0, 0, 0.75)","text-anchor":"end","data-unformatted":k});var I=r.bBox(z.node()),D=u.w*(A.x[1]-A.x[0]);if(I.width>D/2){var R=k.split("|").join("<br>");z.text(R).attr("data-unformatted",R).call(t.convertToTspans,g),I=r.bBox(z.node())}z.attr("transform",S(-3,-I.height+8)),P.insert("rect",".static-attribution").attr({x:-I.width-6,y:-I.height-3,width:I.width+6,height:I.height+3,fill:"rgba(255, 255, 255, 0.75)"});var B=1;I.width+6>D&&(B=D/(I.width+6));var F=[u.l+u.w*A.x[1],u.t+u.h*(1-A.y[0])];P.attr("transform",S(F[0],F[1])+M(B))}};function y(g,h){var m=g._fullLayout,u=g._context;if(u.mapboxAccessToken==="")return"";for(var _=[],s=[],A=!1,b=!1,f=0;f<h.length;f++){var x=m[h[f]],l=x.accesstoken;p(x.style)&&(l?v.pushUnique(_,l):(p(x._input.style)&&(v.error("Uses Mapbox map style, but did not set an access token."),A=!0),b=!0)),l&&v.pushUnique(s,l)}if(b){var L=A?i.noAccessTokenErrorMsg:i.missingStyleErrorMsg;throw v.error(L),new Error(L)}return _.length?(_.length>1&&v.warn(i.multipleTokensErrorMsg),_[0]):(s.length&&v.log(["Listed mapbox access token(s)",s.join(","),"but did not use a Mapbox map style, ignoring token(s)."].join(" ")),"")}function p(g){return typeof g=="string"&&(i.styleValuesMapbox.indexOf(g)!==-1||g.indexOf("mapbox://")===0)}te.updateFx=function(g){for(var h=g._fullLayout,m=h._subplots[o],u=0;u<m.length;u++){var _=h[m[u]]._subplot;_.updateFx(h)}}},{"../../components/drawing":389,"../../constants/xmlns_namespaces":492,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/get_data":602,"./constants":620,"./layout_attributes":624,"./layout_defaults":625,"./mapbox":626,"@plotly/d3":58,"mapbox-gl/dist/mapbox-gl-unminified":239}],623:[function(d,ee,te){var w=d("../../lib"),v=d("../../lib/svg_text_utils").sanitizeHTML,S=d("./convert_text_opts"),M=d("./constants");function e(c,o){this.subplot=c,this.uid=c.uid+"-"+o,this.index=o,this.idSource="source-"+this.uid,this.idLayer=M.layoutLayerPrefix+this.uid,this.sourceType=null,this.source=null,this.layerType=null,this.below=null,this.visible=!1}var a=e.prototype;a.update=function(o){this.visible?this.needsNewImage(o)?this.updateImage(o):this.needsNewSource(o)?(this.removeLayer(),this.updateSource(o),this.updateLayer(o)):this.needsNewLayer(o)?this.updateLayer(o):this.updateStyle(o):(this.updateSource(o),this.updateLayer(o)),this.visible=n(o)},a.needsNewImage=function(c){var o=this.subplot.map;return o.getSource(this.idSource)&&this.sourceType==="image"&&c.sourcetype==="image"&&(this.source!==c.source||JSON.stringify(this.coordinates)!==JSON.stringify(c.coordinates))},a.needsNewSource=function(c){return this.sourceType!==c.sourcetype||JSON.stringify(this.source)!==JSON.stringify(c.source)||this.layerType!==c.type},a.needsNewLayer=function(c){return this.layerType!==c.type||this.below!==this.subplot.belowLookup["layout-"+this.index]},a.lookupBelow=function(){return this.subplot.belowLookup["layout-"+this.index]},a.updateImage=function(c){var o=this.subplot.map;o.getSource(this.idSource).updateImage({url:c.source,coordinates:c.coordinates});var i=this.findFollowingMapboxLayerId(this.lookupBelow());i!==null&&this.subplot.map.moveLayer(this.idLayer,i)},a.updateSource=function(c){var o=this.subplot.map;if(o.getSource(this.idSource)&&o.removeSource(this.idSource),this.sourceType=c.sourcetype,this.source=c.source,!!n(c)){var i=t(c);o.addSource(this.idSource,i)}},a.findFollowingMapboxLayerId=function(c){if(c==="traces")for(var o=this.subplot.getMapLayers(),i=0;i<o.length;i++){var y=o[i].id;if(typeof y=="string"&&y.indexOf(M.traceLayerPrefix)===0){c=y;break}}return c},a.updateLayer=function(c){var o=this.subplot,i=r(c),y=this.lookupBelow(),p=this.findFollowingMapboxLayerId(y);this.removeLayer(),n(c)&&o.addLayer({id:this.idLayer,source:this.idSource,"source-layer":c.sourcelayer||"",type:c.type,minzoom:c.minzoom,maxzoom:c.maxzoom,layout:i.layout,paint:i.paint},p),this.layerType=c.type,this.below=y},a.updateStyle=function(c){if(n(c)){var o=r(c);this.subplot.setOptions(this.idLayer,"setLayoutProperty",o.layout),this.subplot.setOptions(this.idLayer,"setPaintProperty",o.paint)}},a.removeLayer=function(){var c=this.subplot.map;c.getLayer(this.idLayer)&&c.removeLayer(this.idLayer)},a.dispose=function(){var c=this.subplot.map;c.getLayer(this.idLayer)&&c.removeLayer(this.idLayer),c.getSource(this.idSource)&&c.removeSource(this.idSource)};function n(c){if(!c.visible)return!1;var o=c.source;if(Array.isArray(o)&&o.length>0){for(var i=0;i<o.length;i++)if(typeof o[i]!="string"||o[i].length===0)return!1;return!0}return w.isPlainObject(o)||typeof o=="string"&&o.length>0}function r(c){var o={},i={};switch(c.type){case"circle":w.extendFlat(i,{"circle-radius":c.circle.radius,"circle-color":c.color,"circle-opacity":c.opacity});break;case"line":w.extendFlat(i,{"line-width":c.line.width,"line-color":c.color,"line-opacity":c.opacity,"line-dasharray":c.line.dash});break;case"fill":w.extendFlat(i,{"fill-color":c.color,"fill-outline-color":c.fill.outlinecolor,"fill-opacity":c.opacity});break;case"symbol":var y=c.symbol,p=S(y.textposition,y.iconsize);w.extendFlat(o,{"icon-image":y.icon+"-15","icon-size":y.iconsize/10,"text-field":y.text,"text-size":y.textfont.size,"text-anchor":p.anchor,"text-offset":p.offset,"symbol-placement":y.placement}),w.extendFlat(i,{"icon-color":c.color,"text-color":y.textfont.color,"text-opacity":c.opacity});break;case"raster":w.extendFlat(i,{"raster-fade-duration":0,"raster-opacity":c.opacity});break}return{layout:o,paint:i}}function t(c){var o=c.sourcetype,i=c.source,y={type:o},p;return o==="geojson"?p="data":o==="vector"?p=typeof i=="string"?"url":"tiles":o==="raster"?(p="tiles",y.tileSize=256):o==="image"&&(p="url",y.coordinates=c.coordinates),y[p]=i,c.sourceattribution&&(y.attribution=v(c.sourceattribution)),y}ee.exports=function(o,i,y){var p=new e(o,i);return p.update(y),p}},{"../../lib":515,"../../lib/svg_text_utils":541,"./constants":620,"./convert_text_opts":621}],624:[function(d,ee,te){var w=d("../../lib"),v=d("../../components/color").defaultLine,S=d("../domain").attributes,M=d("../font_attributes"),e=d("../../traces/scatter/attributes").textposition,a=d("../../plot_api/edit_types").overrideAll,n=d("../../plot_api/plot_template").templatedArray,r=d("./constants"),t=M({});t.family.dflt="Open Sans Regular, Arial Unicode MS Regular";var c=ee.exports=a({_arrayAttrRegexps:[w.counterRegex("mapbox",".layers",!0)],domain:S({name:"mapbox"}),accesstoken:{valType:"string",noBlank:!0,strict:!0},style:{valType:"any",values:r.styleValuesMapbox.concat(r.styleValuesNonMapbox),dflt:r.styleValueDflt},center:{lon:{valType:"number",dflt:0},lat:{valType:"number",dflt:0}},zoom:{valType:"number",dflt:1},bearing:{valType:"number",dflt:0},pitch:{valType:"number",dflt:0},layers:n("layer",{visible:{valType:"boolean",dflt:!0},sourcetype:{valType:"enumerated",values:["geojson","vector","raster","image"],dflt:"geojson"},source:{valType:"any"},sourcelayer:{valType:"string",dflt:""},sourceattribution:{valType:"string"},type:{valType:"enumerated",values:["circle","line","fill","symbol","raster"],dflt:"circle"},coordinates:{valType:"any"},below:{valType:"string"},color:{valType:"color",dflt:v},opacity:{valType:"number",min:0,max:1,dflt:1},minzoom:{valType:"number",min:0,max:24,dflt:0},maxzoom:{valType:"number",min:0,max:24,dflt:24},circle:{radius:{valType:"number",dflt:15}},line:{width:{valType:"number",dflt:2},dash:{valType:"data_array"}},fill:{outlinecolor:{valType:"color",dflt:v}},symbol:{icon:{valType:"string",dflt:"marker"},iconsize:{valType:"number",dflt:10},text:{valType:"string",dflt:""},placement:{valType:"enumerated",values:["point","line","line-center"],dflt:"point"},textfont:t,textposition:w.extendFlat({},e,{arrayOk:!1})}})},"plot","from-root");c.uirevision={valType:"any",editType:"none"}},{"../../components/color":367,"../../lib":515,"../../plot_api/edit_types":548,"../../plot_api/plot_template":555,"../../traces/scatter/attributes":936,"../domain":593,"../font_attributes":594,"./constants":620}],625:[function(d,ee,te){var w=d("../../lib"),v=d("../subplot_defaults"),S=d("../array_container_defaults"),M=d("./layout_attributes");ee.exports=function(r,t,c){v(r,t,c,{type:"mapbox",attributes:M,handleDefaults:e,partition:"y",accessToken:t._mapboxAccessToken})};function e(n,r,t,c){t("accesstoken",c.accessToken),t("style"),t("center.lon"),t("center.lat"),t("zoom"),t("bearing"),t("pitch"),S(n,r,{name:"layers",handleItemDefaults:a}),r._input=n}function a(n,r){function t(g,h){return w.coerce(n,r,M.layers,g,h)}var c=t("visible");if(c){var o=t("sourcetype"),i=o==="raster"||o==="image";t("source"),t("sourceattribution"),o==="vector"&&t("sourcelayer"),o==="image"&&t("coordinates");var y;i&&(y="raster");var p=t("type",y);i&&p!=="raster"&&(p=r.type="raster",w.log("Source types *raster* and *image* must drawn *raster* layer type.")),t("below"),t("color"),t("opacity"),t("minzoom"),t("maxzoom"),p==="circle"&&t("circle.radius"),p==="line"&&(t("line.width"),t("line.dash")),p==="fill"&&t("fill.outlinecolor"),p==="symbol"&&(t("symbol.icon"),t("symbol.iconsize"),t("symbol.text"),w.coerceFont(t,"symbol.textfont"),t("symbol.textposition"),t("symbol.placement"))}}},{"../../lib":515,"../array_container_defaults":561,"../subplot_defaults":641,"./layout_attributes":624}],626:[function(d,ee,te){var w=d("mapbox-gl/dist/mapbox-gl-unminified"),v=d("../../lib"),S=d("../../lib/geo_location_utils"),M=d("../../registry"),e=d("../cartesian/axes"),a=d("../../components/dragelement"),n=d("../../components/fx"),r=d("../../components/dragelement/helpers"),t=r.drawMode,c=r.selectMode,o=d("../../components/selections").prepSelect,i=d("../../components/selections").clearOutline,y=d("../../components/selections").clearSelectionsCache,p=d("../../components/selections").selectOnClick,g=d("./constants"),h=d("./layers");function m(f,x){this.id=x,this.gd=f;var l=f._fullLayout,L=f._context;this.container=l._glcontainer.node(),this.isStatic=L.staticPlot,this.uid=l._uid+"-"+this.id,this.div=null,this.xaxis=null,this.yaxis=null,this.createFramework(l),this.map=null,this.accessToken=null,this.styleObj=null,this.traceHash={},this.layerList=[],this.belowLookup={},this.dragging=!1,this.wheeling=!1}var u=m.prototype;u.plot=function(f,x,l){var L=this,T=x[L.id];L.map&&T.accesstoken!==L.accessToken&&(L.map.remove(),L.map=null,L.styleObj=null,L.traceHash={},L.layerList=[]);var k;L.map?k=new Promise(function(P,z){L.updateMap(f,x,P,z)}):k=new Promise(function(P,z){L.createMap(f,x,P,z)}),l.push(k)},u.createMap=function(f,x,l,L){var T=this,k=x[T.id],P=T.styleObj=s(k.style);T.accessToken=k.accesstoken;var z=T.map=new w.Map({container:T.div,style:P.style,center:b(k.center),zoom:k.zoom,bearing:k.bearing,pitch:k.pitch,interactive:!T.isStatic,preserveDrawingBuffer:T.isStatic,doubleClickZoom:!1,boxZoom:!1,attributionControl:!1}).addControl(new w.AttributionControl({compact:!0}));z._canvas.style.left="0px",z._canvas.style.top="0px",T.rejectOnError(L),T.isStatic||T.initFx(f,x);var I=[];I.push(new Promise(function(D){z.once("load",D)})),I=I.concat(S.fetchTraceGeoData(f)),Promise.all(I).then(function(){T.fillBelowLookup(f,x),T.updateData(f),T.updateLayout(x),T.resolveOnRender(l)}).catch(L)},u.updateMap=function(f,x,l,L){var T=this,k=T.map,P=x[this.id];T.rejectOnError(L);var z=[],I=s(P.style);JSON.stringify(T.styleObj)!==JSON.stringify(I)&&(T.styleObj=I,k.setStyle(I.style),T.traceHash={},z.push(new Promise(function(D){k.once("styledata",D)}))),z=z.concat(S.fetchTraceGeoData(f)),Promise.all(z).then(function(){T.fillBelowLookup(f,x),T.updateData(f),T.updateLayout(x),T.resolveOnRender(l)}).catch(L)},u.fillBelowLookup=function(f,x){var l=x[this.id],L=l.layers,T,k,P=this.belowLookup={},z=!1;for(T=0;T<f.length;T++){var I=f[T][0].trace,D=I._module;typeof I.below=="string"?k=I.below:D.getBelow&&(k=D.getBelow(I,this)),k===""&&(z=!0),P["trace-"+I.uid]=k||""}for(T=0;T<L.length;T++){var R=L[T];typeof R.below=="string"?k=R.below:z?k="traces":k="",P["layout-"+T]=k}var B={},F,H;for(F in P)k=P[F],B[k]?B[k].push(F):B[k]=[F];for(k in B){var G=B[k];if(G.length>1)for(T=0;T<G.length;T++)F=G[T],F.indexOf("trace-")===0?(H=F.split("trace-")[1],this.traceHash[H]&&(this.traceHash[H].below=null)):F.indexOf("layout-")===0&&(H=F.split("layout-")[1],this.layerList[H]&&(this.layerList[H].below=null))}};var _={choroplethmapbox:0,densitymapbox:1,scattermapbox:2};u.updateData=function(f){var x=this.traceHash,l,L,T,k,P=f.slice().sort(function(B,F){return _[B[0].trace.type]-_[F[0].trace.type]});for(T=0;T<P.length;T++){var z=P[T];L=z[0].trace,l=x[L.uid];var I=!1;l&&(l.type===L.type?(l.update(z),I=!0):l.dispose()),!I&&L._module&&(x[L.uid]=L._module.plot(this,z))}var D=Object.keys(x);e:for(T=0;T<D.length;T++){var R=D[T];for(k=0;k<f.length;k++)if(L=f[k][0].trace,R===L.uid)continue e;l=x[R],l.dispose(),delete x[R]}},u.updateLayout=function(f){var x=this.map,l=f[this.id];!this.dragging&&!this.wheeling&&(x.setCenter(b(l.center)),x.setZoom(l.zoom),x.setBearing(l.bearing),x.setPitch(l.pitch)),this.updateLayers(f),this.updateFramework(f),this.updateFx(f),this.map.resize(),this.gd._context._scrollZoom.mapbox?x.scrollZoom.enable():x.scrollZoom.disable()},u.resolveOnRender=function(f){var x=this.map;x.on("render",function l(){x.loaded()&&(x.off("render",l),setTimeout(f,10))})},u.rejectOnError=function(f){var x=this.map;function l(){f(new Error(g.mapOnErrorMsg))}x.once("error",l),x.once("style.error",l),x.once("source.error",l),x.once("tile.error",l),x.once("layer.error",l)},u.createFramework=function(f){var x=this,l=x.div=document.createElement("div");l.id=x.uid,l.style.position="absolute",x.container.appendChild(l),x.xaxis={_id:"x",c2p:function(L){return x.project(L).x}},x.yaxis={_id:"y",c2p:function(L){return x.project(L).y}},x.updateFramework(f),x.mockAxis={type:"linear",showexponent:"all",exponentformat:"B"},e.setConvert(x.mockAxis,f)},u.initFx=function(f,x){var l=this,L=l.gd,T=l.map;T.on("moveend",function(z){if(!!l.map){var I=L._fullLayout;if(z.originalEvent||l.wheeling){var D=I[l.id];M.call("_storeDirectGUIEdit",L.layout,I._preGUI,l.getViewEdits(D));var R=l.getView();D._input.center=D.center=R.center,D._input.zoom=D.zoom=R.zoom,D._input.bearing=D.bearing=R.bearing,D._input.pitch=D.pitch=R.pitch,L.emit("plotly_relayout",l.getViewEditsWithDerived(R))}z.originalEvent&&z.originalEvent.type==="mouseup"?l.dragging=!1:l.wheeling&&(l.wheeling=!1),I._rehover&&I._rehover()}}),T.on("wheel",function(){l.wheeling=!0}),T.on("mousemove",function(z){var I=l.div.getBoundingClientRect(),D=[z.originalEvent.offsetX,z.originalEvent.offsetY];z.target.getBoundingClientRect=function(){return I},l.xaxis.p2c=function(){return T.unproject(D).lng},l.yaxis.p2c=function(){return T.unproject(D).lat},L._fullLayout._rehover=function(){L._fullLayout._hoversubplot===l.id&&L._fullLayout[l.id]&&n.hover(L,z,l.id)},n.hover(L,z,l.id),L._fullLayout._hoversubplot=l.id});function k(){n.loneUnhover(x._hoverlayer)}T.on("dragstart",function(){l.dragging=!0,k()}),T.on("zoomstart",k),T.on("mouseout",function(){L._fullLayout._hoversubplot=null});function P(){var z=l.getView();L.emit("plotly_relayouting",l.getViewEditsWithDerived(z))}T.on("drag",P),T.on("zoom",P),T.on("dblclick",function(){var z=L._fullLayout[l.id];M.call("_storeDirectGUIEdit",L.layout,L._fullLayout._preGUI,l.getViewEdits(z));var I=l.viewInitial;T.setCenter(b(I.center)),T.setZoom(I.zoom),T.setBearing(I.bearing),T.setPitch(I.pitch);var D=l.getView();z._input.center=z.center=D.center,z._input.zoom=z.zoom=D.zoom,z._input.bearing=z.bearing=D.bearing,z._input.pitch=z.pitch=D.pitch,L.emit("plotly_doubleclick",null),L.emit("plotly_relayout",l.getViewEditsWithDerived(D))}),l.clearOutline=function(){y(l.dragOptions),i(l.dragOptions.gd)},l.onClickInPanFn=function(z){return function(I){var D=L._fullLayout.clickmode;D.indexOf("select")>-1&&p(I.originalEvent,L,[l.xaxis],[l.yaxis],l.id,z),D.indexOf("event")>-1&&n.click(L,I.originalEvent)}}},u.updateFx=function(f){var x=this,l=x.map,L=x.gd;if(x.isStatic)return;function T(I){var D=x.map.unproject(I);return[D.lng,D.lat]}var k=f.dragmode,P;P=function(I,D){if(D.isRect){var R=I.range={};R[x.id]=[T([D.xmin,D.ymin]),T([D.xmax,D.ymax])]}else{var B=I.lassoPoints={};B[x.id]=D.map(T)}};var z=x.dragOptions;x.dragOptions=v.extendDeep(z||{},{dragmode:f.dragmode,element:x.div,gd:L,plotinfo:{id:x.id,domain:f[x.id].domain,xaxis:x.xaxis,yaxis:x.yaxis,fillRangeItems:P},xaxes:[x.xaxis],yaxes:[x.yaxis],subplot:x.id}),l.off("click",x.onClickInPanHandler),c(k)||t(k)?(l.dragPan.disable(),l.on("zoomstart",x.clearSelect),x.dragOptions.prepFn=function(I,D,R){o(I,D,R,x.dragOptions,k)},a.init(x.dragOptions)):(l.dragPan.enable(),l.off("zoomstart",x.clearSelect),x.div.onmousedown=null,x.onClickInPanHandler=x.onClickInPanFn(x.dragOptions),l.on("click",x.onClickInPanHandler))},u.updateFramework=function(f){var x=f[this.id].domain,l=f._size,L=this.div.style;L.width=l.w*(x.x[1]-x.x[0])+"px",L.height=l.h*(x.y[1]-x.y[0])+"px",L.left=l.l+x.x[0]*l.w+"px",L.top=l.t+(1-x.y[1])*l.h+"px",this.xaxis._offset=l.l+x.x[0]*l.w,this.xaxis._length=l.w*(x.x[1]-x.x[0]),this.yaxis._offset=l.t+(1-x.y[1])*l.h,this.yaxis._length=l.h*(x.y[1]-x.y[0])},u.updateLayers=function(f){var x=f[this.id],l=x.layers,L=this.layerList,T;if(l.length!==L.length){for(T=0;T<L.length;T++)L[T].dispose();for(L=this.layerList=[],T=0;T<l.length;T++)L.push(h(this,T,l[T]))}else for(T=0;T<l.length;T++)L[T].update(l[T])},u.destroy=function(){this.map&&(this.map.remove(),this.map=null,this.container.removeChild(this.div))},u.toImage=function(){return this.map.stop(),this.map.getCanvas().toDataURL()},u.setOptions=function(f,x,l){for(var L in l)this.map[x](f,L,l[L])},u.getMapLayers=function(){return this.map.getStyle().layers},u.addLayer=function(f,x){var l=this.map;if(typeof x=="string"){if(x===""){l.addLayer(f,x);return}for(var L=this.getMapLayers(),T=0;T<L.length;T++)if(x===L[T].id){l.addLayer(f,x);return}v.warn(["Trying to add layer with *below* value",x,"referencing a layer that does not exist","or that does not yet exist."].join(" "))}l.addLayer(f)},u.project=function(f){return this.map.project(new w.LngLat(f[0],f[1]))},u.getView=function(){var f=this.map,x=f.getCenter(),l=x.lng,L=x.lat,T={lon:l,lat:L},k=f.getCanvas(),P=parseInt(k.style.width),z=parseInt(k.style.height);return{center:T,zoom:f.getZoom(),bearing:f.getBearing(),pitch:f.getPitch(),_derived:{coordinates:[f.unproject([0,0]).toArray(),f.unproject([P,0]).toArray(),f.unproject([P,z]).toArray(),f.unproject([0,z]).toArray()]}}},u.getViewEdits=function(f){for(var x=this.id,l=["center","zoom","bearing","pitch"],L={},T=0;T<l.length;T++){var k=l[T];L[x+"."+k]=f[k]}return L},u.getViewEditsWithDerived=function(f){var x=this.id,l=this.getViewEdits(f);return l[x+"._derived"]=f._derived,l};function s(f){var x={};return v.isPlainObject(f)?(x.id=f.id,x.style=f):typeof f=="string"?(x.id=f,g.styleValuesMapbox.indexOf(f)!==-1?x.style=A(f):g.stylesNonMapbox[f]?x.style=g.stylesNonMapbox[f]:x.style=f):(x.id=g.styleValueDflt,x.style=A(g.styleValueDflt)),x.transition={duration:0,delay:0},x}function A(f){return g.styleUrlPrefix+f+"-"+g.styleUrlSuffix}function b(f){return[f.lon,f.lat]}ee.exports=m},{"../../components/dragelement":386,"../../components/dragelement/helpers":385,"../../components/fx":407,"../../components/selections":455,"../../lib":515,"../../lib/geo_location_utils":508,"../../registry":647,"../cartesian/axes":566,"./constants":620,"./layers":623,"mapbox-gl/dist/mapbox-gl-unminified":239}],627:[function(d,ee,te){ee.exports=function(w){var v=w.editType;return{t:{valType:"number",dflt:0,editType:v},r:{valType:"number",dflt:0,editType:v},b:{valType:"number",dflt:0,editType:v},l:{valType:"number",dflt:0,editType:v},editType:v}}},{}],628:[function(d,ee,te){var w=d("@plotly/d3"),v=d("d3-time-format").timeFormatLocale,S=d("d3-format").formatLocale,M=d("fast-isnumeric"),e=d("../registry"),a=d("../plot_api/plot_schema"),n=d("../plot_api/plot_template"),r=d("../lib"),t=d("../components/color"),c=d("../constants/numerical").BADNUM,o=d("./cartesian/axis_ids"),i=d("../components/shapes/handle_outline").clearOutline,y=d("./animation_attributes"),p=d("./frame_attributes"),g=d("../plots/get_data").getModuleCalcData,h=r.relinkPrivateKeys,m=r._,u=ee.exports={};r.extendFlat(u,e),u.attributes=d("./attributes"),u.attributes.type.values=u.allTypes,u.fontAttrs=d("./font_attributes"),u.layoutAttributes=d("./layout_attributes"),u.fontWeight="normal";var _=u.transformsRegistry,s=d("./command");u.executeAPICommand=s.executeAPICommand,u.computeAPICommandBindings=s.computeAPICommandBindings,u.manageCommandObserver=s.manageCommandObserver,u.hasSimpleAPICommandBindings=s.hasSimpleAPICommandBindings,u.redrawText=function(N){return N=r.getGraphDiv(N),new Promise(function(U){setTimeout(function(){!N._fullLayout||(e.getComponentMethod("annotations","draw")(N),e.getComponentMethod("legend","draw")(N),e.getComponentMethod("colorbar","draw")(N),U(u.previousPromises(N)))},300)})},u.resize=function(N){N=r.getGraphDiv(N);var U,q=new Promise(function($,W){(!N||r.isHidden(N))&&W(new Error("Resize must be passed a displayed plot div element.")),N._redrawTimer&&clearTimeout(N._redrawTimer),N._resolveResize&&(U=N._resolveResize),N._resolveResize=$,N._redrawTimer=setTimeout(function(){if(!N.layout||N.layout.width&&N.layout.height||r.isHidden(N)){$(N);return}delete N.layout.width,delete N.layout.height;var K=N.changed;N.autoplay=!0,e.call("relayout",N,{autosize:!0}).then(function(){N.changed=K,N._resolveResize===$&&(delete N._resolveResize,$(N))})},100)});return U&&U(q),q},u.previousPromises=function(N){if((N._promises||[]).length)return Promise.all(N._promises).then(function(){N._promises=[]})},u.addLinks=function(N){if(!(!N._context.showLink&&!N._context.showSources)){var U=N._fullLayout,q=r.ensureSingle(U._paper,"text","js-plot-link-container",function(ie){ie.style({"font-family":'"Open Sans", Arial, sans-serif',"font-size":"12px",fill:t.defaultLine,"pointer-events":"all"}).each(function(){var le=w.select(this);le.append("tspan").classed("js-link-to-tool",!0),le.append("tspan").classed("js-link-spacer",!0),le.append("tspan").classed("js-sourcelinks",!0)})}),$=q.node(),W={y:U._paper.attr("height")-9};document.body.contains($)&&$.getComputedTextLength()>=U.width-20?(W["text-anchor"]="start",W.x=5):(W["text-anchor"]="end",W.x=U._paper.attr("width")-7),q.attr(W);var K=q.select(".js-link-to-tool"),ne=q.select(".js-link-spacer"),ae=q.select(".js-sourcelinks");N._context.showSources&&N._context.showSources(N),N._context.showLink&&A(N,K),ne.text(K.text()&&ae.text()?" - ":"")}};function A(N,U){U.text("");var q=U.append("a").attr({"xlink:xlink:href":"#",class:"link--impt link--embedview","font-weight":"bold"}).text(N._context.linkText+" "+String.fromCharCode(187));if(N._context.sendData)q.on("click",function(){u.sendDataToCloud(N)});else{var $=window.location.pathname.split("/"),W=window.location.search;q.attr({"xlink:xlink:show":"new","xlink:xlink:href":"/"+$[2].split(".")[0]+"/"+$[1]+W})}}u.sendDataToCloud=function(N){var U=(window.PLOTLYENV||{}).BASE_URL||N._context.plotlyServerURL;if(!!U){N.emit("plotly_beforeexport");var q=w.select(N).append("div").attr("id","hiddenform").style("display","none"),$=q.append("form").attr({action:U+"/external",method:"post",target:"_blank"}),W=$.append("input").attr({type:"text",name:"data"});return W.node().value=u.graphJson(N,!1,"keepdata"),$.node().submit(),q.remove(),N.emit("plotly_afterexport"),!1}};var b=["days","shortDays","months","shortMonths","periods","dateTime","date","time","decimal","thousands","grouping","currency"],f=["year","month","dayMonth","dayMonthYear"];u.supplyDefaults=function(N,U){var q=U&&U.skipUpdateCalc,$=N._fullLayout||{};if($._skipDefaults){delete $._skipDefaults;return}var W=N._fullLayout={},K=N.layout||{},ne=N._fullData||[],ae=N._fullData=[],ie=N.data||[],le=N.calcdata||[],ye=N._context||{},ue;N._transitionData||u.createTransitionData(N),W._dfltTitle={plot:m(N,"Click to enter Plot title"),x:m(N,"Click to enter X axis title"),y:m(N,"Click to enter Y axis title"),colorbar:m(N,"Click to enter Colorscale title"),annotation:m(N,"new text")},W._traceWord=m(N,"trace");var pe=L(N,b);if(W._mapboxAccessToken=ye.mapboxAccessToken,$._initialAutoSizeIsDone){var ge=$.width,Te=$.height;u.supplyLayoutGlobalDefaults(K,W,pe),K.width||(W.width=ge),K.height||(W.height=Te),u.sanitizeMargins(W)}else{u.supplyLayoutGlobalDefaults(K,W,pe);var _e=!K.width||!K.height,ze=W.autosize,Oe=ye.autosizable,Ye=_e&&(ze||Oe);Ye?u.plotAutoSize(N,K,W):_e&&u.sanitizeMargins(W),!ze&&_e&&(K.width=W.width,K.height=W.height)}W._d3locale=T(pe,W.separators),W._extraFormat=L(N,f),W._initialAutoSizeIsDone=!0,W._dataLength=ie.length,W._modules=[],W._visibleModules=[],W._basePlotModules=[];var be=W._subplots=l(),Pe=W._splomAxes={x:{},y:{}},Ge=W._splomSubplots={};W._splomGridDflt={},W._scatterStackOpts={},W._firstScatter={},W._alignmentOpts={},W._colorAxes={},W._requestRangeslider={},W._traceUids=x(ne,ie),W._globalTransforms=(N._context||{}).globalTransforms,u.supplyDataDefaults(ie,ae,K,W);var Qe=Object.keys(Pe.x),Be=Object.keys(Pe.y);if(Qe.length>1&&Be.length>1){for(e.getComponentMethod("grid","sizeDefaults")(K,W),ue=0;ue<Qe.length;ue++)r.pushUnique(be.xaxis,Qe[ue]);for(ue=0;ue<Be.length;ue++)r.pushUnique(be.yaxis,Be[ue]);for(var Le in Ge)r.pushUnique(be.cartesian,Le)}if(W._has=u._hasPlotType.bind(W),ne.length===ae.length)for(ue=0;ue<ae.length;ue++)h(ae[ue],ne[ue]);u.supplyLayoutModuleDefaults(K,W,ae,N._transitionData);var He=W._visibleModules,vt=[];for(ue=0;ue<He.length;ue++){var Rt=He[ue].crossTraceDefaults;Rt&&r.pushUnique(vt,Rt)}for(ue=0;ue<vt.length;ue++)vt[ue](ae,W);W._hasOnlyLargeSploms=W._basePlotModules.length===1&&W._basePlotModules[0].name==="splom"&&Qe.length>15&&Be.length>15&&W.shapes.length===0&&W.images.length===0,u.linkSubplots(ae,W,ne,$),u.cleanPlot(ae,W,ne,$);var rr=!!($._has&&$._has("gl2d")),Lt=!!(W._has&&W._has("gl2d")),Ft=!!($._has&&$._has("cartesian")),Gt=!!(W._has&&W._has("cartesian")),Dt=Ft||rr,kt=Gt||Lt;Dt&&!kt?$._bgLayer.remove():kt&&!Dt&&(W._shouldCreateBgLayer=!0),$._zoomlayer&&!N._dragging&&i({_fullLayout:$}),k(ae,W),h(W,$),e.getComponentMethod("colorscale","crossTraceDefaults")(ae,W),W._preGUI||(W._preGUI={}),W._tracePreGUI||(W._tracePreGUI={});var Ue=W._tracePreGUI,qe={},Ve;for(Ve in Ue)qe[Ve]="old";for(ue=0;ue<ae.length;ue++)Ve=ae[ue]._fullInput.uid,qe[Ve]||(Ue[Ve]={}),qe[Ve]="new";for(Ve in qe)qe[Ve]==="old"&&delete Ue[Ve];R(W),e.getComponentMethod("rangeslider","makeData")(W),!q&&le.length===ae.length&&u.supplyDefaultsUpdateCalc(le,ae)},u.supplyDefaultsUpdateCalc=function(N,U){for(var q=0;q<U.length;q++){var $=U[q],W=(N[q]||[])[0];if(W&&W.trace){var K=W.trace;if(K._hasCalcTransform){var ne=K._arrayAttrs,ae,ie,le;for(ae=0;ae<ne.length;ae++)ie=ne[ae],le=r.nestedProperty(K,ie).get().slice(),r.nestedProperty($,ie).set(le)}W.trace=$}}};function x(N,U){var q=U.length,$=[],W,K;for(W=0;W<N.length;W++){var ne=N[W]._fullInput;ne!==K&&$.push(ne),K=ne}var ae=$.length,ie=new Array(q),le={};function ye(ge,Te){ie[Te]=ge,le[ge]=1}function ue(ge,Te){if(ge&&typeof ge=="string"&&!le[ge])return ye(ge,Te),!0}for(W=0;W<q;W++){var pe=U[W].uid;typeof pe=="number"&&(pe=String(pe)),!ue(pe,W)&&(W<ae&&ue($[W].uid,W)||ye(r.randstr(le),W))}return ie}function l(){var N=e.collectableSubplotTypes,U={},q,$;if(!N){N=[];var W=e.subplotsRegistry;for(var K in W){var ne=W[K],ae=ne.attr;if(ae&&(N.push(K),Array.isArray(ae)))for($=0;$<ae.length;$++)r.pushUnique(N,ae[$])}}for(q=0;q<N.length;q++)U[N[q]]=[];return U}function L(N,U){var q=N._context.locale;q||(q="en-US");var $=!1,W={};function K(ue){for(var pe=!0,ge=0;ge<U.length;ge++){var Te=U[ge];W[Te]||(ue[Te]?W[Te]=ue[Te]:pe=!1)}pe&&($=!0)}for(var ne=0;ne<2;ne++){for(var ae=N._context.locales,ie=0;ie<2;ie++){var le=(ae[q]||{}).format;if(le&&(K(le),$))break;ae=e.localeRegistry}var ye=q.split("-")[0];if($||ye===q)break;q=ye}return $||K(e.localeRegistry.en.format),W}function T(N,U){return N.decimal=U.charAt(0),N.thousands=U.charAt(1),{numberFormat:function(q){try{q=S(N).format(r.adjustFormat(q))}catch{return r.warnBadFormat(q),r.noFormat}return q},timeFormat:v(N).utcFormat}}function k(N,U){var q,$=[];U.meta&&(q=U._meta={meta:U.meta,layout:{meta:U.meta}});for(var W=0;W<N.length;W++){var K=N[W];K.meta?$[K.index]=K._meta={meta:K.meta}:U.meta&&(K._meta={meta:U.meta}),U.meta&&(K._meta.layout={meta:U.meta})}$.length&&(q||(q=U._meta={}),q.data=$)}u.createTransitionData=function(N){N._transitionData||(N._transitionData={}),N._transitionData._frames||(N._transitionData._frames=[]),N._transitionData._frameHash||(N._transitionData._frameHash={}),N._transitionData._counter||(N._transitionData._counter=0),N._transitionData._interruptCallbacks||(N._transitionData._interruptCallbacks=[])},u._hasPlotType=function(N){var U,q=this._basePlotModules||[];for(U=0;U<q.length;U++)if(q[U].name===N)return!0;var $=this._modules||[];for(U=0;U<$.length;U++){var W=$[U].name;if(W===N)return!0;var K=e.modules[W];if(K&&K.categories[N])return!0}return!1},u.cleanPlot=function(N,U,q,$){var W,K,ne=$._basePlotModules||[];for(W=0;W<ne.length;W++){var ae=ne[W];ae.clean&&ae.clean(N,U,q,$)}var ie=$._has&&$._has("gl"),le=U._has&&U._has("gl");ie&&!le&&$._glcontainer!==void 0&&($._glcontainer.selectAll(".gl-canvas").remove(),$._glcontainer.selectAll(".no-webgl").remove(),$._glcanvas=null);var ye=!!$._infolayer;e:for(W=0;W<q.length;W++){var ue=q[W],pe=ue.uid;for(K=0;K<N.length;K++){var ge=N[K];if(pe===ge.uid)continue e}ye&&$._infolayer.select(".cb"+pe).remove()}},u.linkSubplots=function(N,U,q,$){var W,K,ne=$._plots||{},ae=U._plots={},ie=U._subplots,le={_fullData:N,_fullLayout:U},ye=ie.cartesian.concat(ie.gl2d||[]);for(W=0;W<ye.length;W++){var ue=ye[W],pe=ne[ue],ge=o.getFromId(le,ue,"x"),Te=o.getFromId(le,ue,"y"),_e;for(pe?_e=ae[ue]=pe:(_e=ae[ue]={},_e.id=ue),ge._counterAxes.push(Te._id),Te._counterAxes.push(ge._id),ge._subplotsWith.push(ue),Te._subplotsWith.push(ue),_e.xaxis=ge,_e.yaxis=Te,_e._hasClipOnAxisFalse=!1,K=0;K<N.length;K++){var ze=N[K];if(ze.xaxis===_e.xaxis._id&&ze.yaxis===_e.yaxis._id&&ze.cliponaxis===!1){_e._hasClipOnAxisFalse=!0;break}}}var Oe=o.list(le,null,!0),Ye;for(W=0;W<Oe.length;W++){Ye=Oe[W];var be=null;Ye.overlaying&&(be=o.getFromId(le,Ye.overlaying),be&&be.overlaying&&(Ye.overlaying=!1,be=null)),Ye._mainAxis=be||Ye,be&&(Ye.domain=be.domain.slice()),Ye._anchorAxis=Ye.anchor==="free"?null:o.getFromId(le,Ye.anchor)}for(W=0;W<Oe.length;W++)if(Ye=Oe[W],Ye._counterAxes.sort(o.idSort),Ye._subplotsWith.sort(r.subplotSort),Ye._mainSubplot=P(Ye,U),Ye._counterAxes.length&&(Ye.spikemode&&Ye.spikemode.indexOf("across")!==-1||Ye.automargin&&Ye.mirror&&Ye.anchor!=="free"||e.getComponentMethod("rangeslider","isVisible")(Ye))){var Pe=1,Ge=0;for(K=0;K<Ye._counterAxes.length;K++){var Qe=o.getFromId(le,Ye._counterAxes[K]);Pe=Math.min(Pe,Qe.domain[0]),Ge=Math.max(Ge,Qe.domain[1])}Pe<Ge&&(Ye._counterDomainMin=Pe,Ye._counterDomainMax=Ge)}};function P(N,U){var q={_fullLayout:U},$=N._id.charAt(0)==="x",W=N._mainAxis._anchorAxis,K="",ne="",ae="";if(W&&(ae=W._mainAxis._id,K=$?N._id+ae:ae+N._id),!K||!U._plots[K]){K="";for(var ie=N._counterAxes,le=0;le<ie.length;le++){var ye=ie[le],ue=$?N._id+ye:ye+N._id;ne||(ne=ue);var pe=o.getFromId(q,ye);if(ae&&pe.overlaying===ae){K=ue;break}}}return K||ne}u.clearExpandedTraceDefaultColors=function(N){var U,q,$;function W(ne,ae,ie,le){q[le]=ae,q.length=le+1,ne.valType==="color"&&ne.dflt===void 0&&U.push(q.join("."))}for(q=[],U=N._module._colorAttrs,U||(N._module._colorAttrs=U=[],a.crawl(N._module.attributes,W)),$=0;$<U.length;$++){var K=r.nestedProperty(N,"_input."+U[$]);K.get()||r.nestedProperty(N,U[$]).set(null)}},u.supplyDataDefaults=function(N,U,q,$){var W=$._modules,K=$._visibleModules,ne=$._basePlotModules,ae=0,ie=0,le,ye,ue;$._transformModules=[];function pe(Be){U.push(Be);var Le=Be._module;!Le||(r.pushUnique(W,Le),Be.visible===!0&&r.pushUnique(K,Le),r.pushUnique(ne,Be._module.basePlotModule),ae++,Be._input.visible!==!1&&ie++)}var ge={},Te=[],_e=(q.template||{}).data||{},ze=n.traceTemplater(_e);for(le=0;le<N.length;le++){if(ue=N[le],ye=ze.newTrace(ue),ye.uid=$._traceUids[le],u.supplyTraceDefaults(ue,ye,ie,$,le),ye.index=le,ye._input=ue,ye._expandedIndex=ae,ye.transforms&&ye.transforms.length)for(var Oe=ue.visible!==!1&&ye.visible===!1,Ye=I(ye,U,q,$),be=0;be<Ye.length;be++){var Pe=Ye[be],Ge={_template:ye._template,type:ye.type,uid:ye.uid+be};Oe&&Pe.visible===!1&&delete Pe.visible,u.supplyTraceDefaults(Pe,Ge,ae,$,le),h(Ge,Pe),Ge.index=le,Ge._input=ue,Ge._fullInput=ye,Ge._expandedIndex=ae,Ge._expandedInput=Pe,pe(Ge)}else ye._fullInput=ye,ye._expandedInput=ye,pe(ye);e.traceIs(ye,"carpetAxis")&&(ge[ye.carpet]=ye),e.traceIs(ye,"carpetDependent")&&Te.push(le)}for(le=0;le<Te.length;le++)if(ye=U[Te[le]],!!ye.visible){var Qe=ge[ye.carpet];if(ye._carpet=Qe,!Qe||!Qe.visible){ye.visible=!1;continue}ye.xaxis=Qe.xaxis,ye.yaxis=Qe.yaxis}},u.supplyAnimationDefaults=function(N){N=N||{};var U,q={};function $(W,K){return r.coerce(N||{},q,y,W,K)}if($("mode"),$("direction"),$("fromcurrent"),Array.isArray(N.frame))for(q.frame=[],U=0;U<N.frame.length;U++)q.frame[U]=u.supplyAnimationFrameDefaults(N.frame[U]||{});else q.frame=u.supplyAnimationFrameDefaults(N.frame||{});if(Array.isArray(N.transition))for(q.transition=[],U=0;U<N.transition.length;U++)q.transition[U]=u.supplyAnimationTransitionDefaults(N.transition[U]||{});else q.transition=u.supplyAnimationTransitionDefaults(N.transition||{});return q},u.supplyAnimationFrameDefaults=function(N){var U={};function q($,W){return r.coerce(N||{},U,y.frame,$,W)}return q("duration"),q("redraw"),U},u.supplyAnimationTransitionDefaults=function(N){var U={};function q($,W){return r.coerce(N||{},U,y.transition,$,W)}return q("duration"),q("easing"),U},u.supplyFrameDefaults=function(N){var U={};function q($,W){return r.coerce(N,U,p,$,W)}return q("group"),q("name"),q("traces"),q("baseframe"),q("data"),q("layout"),U},u.supplyTraceDefaults=function(N,U,q,$,W){var K=$.colorway||t.defaults,ne=K[q%K.length],ae;function ie(Ye,be){return r.coerce(N,U,u.attributes,Ye,be)}var le=ie("visible");ie("type"),ie("name",$._traceWord+" "+W),ie("uirevision",$.uirevision);var ye=u.getModule(U);if(U._module=ye,ye){var ue=ye.basePlotModule,pe=ue.attr,ge=ue.attributes;if(pe&&ge){var Te=$._subplots,_e="";if(le||ue.name!=="gl2d"){if(Array.isArray(pe))for(ae=0;ae<pe.length;ae++){var ze=pe[ae],Oe=r.coerce(N,U,ge,ze);Te[ze]&&r.pushUnique(Te[ze],Oe),_e+=Oe}else _e=r.coerce(N,U,ge,pe);Te[ue.name]&&r.pushUnique(Te[ue.name],_e)}}}return le&&(ie("customdata"),ie("ids"),ie("meta"),e.traceIs(U,"showLegend")?(r.coerce(N,U,ye.attributes.showlegend?ye.attributes:u.attributes,"showlegend"),ie("legendgroup"),ie("legendgrouptitle.text"),ie("legendrank"),U._dfltShowLegend=!0):U._dfltShowLegend=!1,ye&&ye.supplyDefaults(N,U,ne,$),e.traceIs(U,"noOpacity")||ie("opacity"),e.traceIs(U,"notLegendIsolatable")&&(U.visible=!!U.visible),e.traceIs(U,"noHover")||(U.hovertemplate||r.coerceHoverinfo(N,U,$),U.type!=="parcats"&&e.getComponentMethod("fx","supplyDefaults")(N,U,ne,$)),ye&&ye.selectPoints&&ie("selectedpoints"),u.supplyTransformDefaults(N,U,$)),U};function z(N){var U=N.transforms;if(Array.isArray(U)&&U.length)for(var q=0;q<U.length;q++){var $=U[q],W=$._module||_[$.type];if(W&&W.makesData)return!0}return!1}u.hasMakesDataTransform=z,u.supplyTransformDefaults=function(N,U,q){if(!!(U._length||z(N))){var $=q._globalTransforms||[],W=q._transformModules||[];if(!(!Array.isArray(N.transforms)&&$.length===0))for(var K=N.transforms||[],ne=$.concat(K),ae=U.transforms=[],ie=0;ie<ne.length;ie++){var le=ne[ie],ye=le.type,ue=_[ye],pe,ge=!(le._module&&le._module===ue),Te=ue&&typeof ue.transform=="function";ue||r.warn("Unrecognized transform type "+ye+"."),ue&&ue.supplyDefaults&&(ge||Te)?(pe=ue.supplyDefaults(le,U,q,N),pe.type=ye,pe._module=ue,r.pushUnique(W,ue)):pe=r.extendFlat({},le),ae.push(pe)}}};function I(N,U,q,$){for(var W=N.transforms,K=[N],ne=0;ne<W.length;ne++){var ae=W[ne],ie=_[ae.type];ie&&ie.transform&&(K=ie.transform(K,{transform:ae,fullTrace:N,fullData:U,layout:q,fullLayout:$,transformIndex:ne}))}return K}u.supplyLayoutGlobalDefaults=function(N,U,q){function $(le,ye){return r.coerce(N,U,u.layoutAttributes,le,ye)}var W=N.template;r.isPlainObject(W)&&(U.template=W,U._template=W.layout,U._dataTemplate=W.data),$("autotypenumbers");var K=r.coerceFont($,"font"),ne=K.size;r.coerceFont($,"title.font",r.extendFlat({},K,{size:Math.round(ne*1.4)})),$("title.text",U._dfltTitle.plot),$("title.xref"),$("title.yref"),$("title.x"),$("title.y"),$("title.xanchor"),$("title.yanchor"),$("title.pad.t"),$("title.pad.r"),$("title.pad.b"),$("title.pad.l");var ae=$("uniformtext.mode");ae&&$("uniformtext.minsize"),$("autosize",!(N.width&&N.height)),$("width"),$("height"),$("margin.l"),$("margin.r"),$("margin.t"),$("margin.b"),$("margin.pad"),$("margin.autoexpand"),N.width&&N.height&&u.sanitizeMargins(U),e.getComponentMethod("grid","sizeDefaults")(N,U),$("paper_bgcolor"),$("separators",q.decimal+q.thousands),$("hidesources"),$("colorway"),$("datarevision");var ie=$("uirevision");$("editrevision",ie),$("selectionrevision",ie),e.getComponentMethod("modebar","supplyLayoutDefaults")(N,U),e.getComponentMethod("shapes","supplyDrawNewShapeDefaults")(N,U,$),e.getComponentMethod("selections","supplyDrawNewSelectionDefaults")(N,U,$),$("meta"),r.isPlainObject(N.transition)&&($("transition.duration"),$("transition.easing"),$("transition.ordering")),e.getComponentMethod("calendars","handleDefaults")(N,U,"calendar"),e.getComponentMethod("fx","supplyLayoutGlobalDefaults")(N,U,$)};function D(N){return typeof N=="string"&&N.substr(N.length-2)==="px"&&parseFloat(N)}u.plotAutoSize=function(U,q,$){var W=U._context||{},K=W.frameMargins,ne,ae,ie=r.isPlotDiv(U);if(ie&&U.emit("plotly_autosize"),W.fillFrame)ne=window.innerWidth,ae=window.innerHeight,document.body.style.overflow="hidden";else{var le=ie?window.getComputedStyle(U):{};if(ne=D(le.width)||D(le.maxWidth)||$.width,ae=D(le.height)||D(le.maxHeight)||$.height,M(K)&&K>0){var ye=1-2*K;ne=Math.round(ye*ne),ae=Math.round(ye*ae)}}var ue=u.layoutAttributes.width.min,pe=u.layoutAttributes.height.min;ne<ue&&(ne=ue),ae<pe&&(ae=pe);var ge=!q.width&&Math.abs($.width-ne)>1,Te=!q.height&&Math.abs($.height-ae)>1;(Te||ge)&&(ge&&($.width=ne),Te&&($.height=ae)),U._initialAutoSize||(U._initialAutoSize={width:ne,height:ae}),u.sanitizeMargins($)},u.supplyLayoutModuleDefaults=function(N,U,q,$){var W=e.componentsRegistry,K=U._basePlotModules,ne,ae,ie,le=e.subplotsRegistry.cartesian;for(ne in W)ie=W[ne],ie.includeBasePlot&&ie.includeBasePlot(N,U);K.length||K.push(le),U._has("cartesian")&&(e.getComponentMethod("grid","contentDefaults")(N,U),le.finalizeSubplots(N,U));for(var ye in U._subplots)U._subplots[ye].sort(r.subplotSort);for(ae=0;ae<K.length;ae++)ie=K[ae],ie.supplyLayoutDefaults&&ie.supplyLayoutDefaults(N,U,q);var ue=U._modules;for(ae=0;ae<ue.length;ae++)ie=ue[ae],ie.supplyLayoutDefaults&&ie.supplyLayoutDefaults(N,U,q);var pe=U._transformModules;for(ae=0;ae<pe.length;ae++)ie=pe[ae],ie.supplyLayoutDefaults&&ie.supplyLayoutDefaults(N,U,q,$);for(ne in W)ie=W[ne],ie.supplyLayoutDefaults&&ie.supplyLayoutDefaults(N,U,q)},u.purge=function(N){var U=N._fullLayout||{};U._glcontainer!==void 0&&(U._glcontainer.selectAll(".gl-canvas").remove(),U._glcontainer.remove(),U._glcanvas=null),U._modeBar&&U._modeBar.destroy(),N._transitionData&&(N._transitionData._interruptCallbacks&&(N._transitionData._interruptCallbacks.length=0),N._transitionData._animationRaf&&window.cancelAnimationFrame(N._transitionData._animationRaf)),r.clearThrottle(),r.clearResponsive(N),delete N.data,delete N.layout,delete N._fullData,delete N._fullLayout,delete N.calcdata,delete N.empty,delete N.fid,delete N.undoqueue,delete N.undonum,delete N.autoplay,delete N.changed,delete N._promises,delete N._redrawTimer,delete N._hmlumcount,delete N._hmpixcount,delete N._transitionData,delete N._transitioning,delete N._initialAutoSize,delete N._transitioningWithDuration,delete N._dragging,delete N._dragged,delete N._dragdata,delete N._hoverdata,delete N._snapshotInProgress,delete N._editing,delete N._mouseDownTime,delete N._legendMouseDownTime,N.removeAllListeners&&N.removeAllListeners()},u.style=function(N){var U=N._fullLayout._visibleModules,q=[],$;for($=0;$<U.length;$++){var W=U[$];W.style&&r.pushUnique(q,W.style)}for($=0;$<q.length;$++)q[$](N)},u.sanitizeMargins=function(N){if(!(!N||!N.margin)){var U=N.width,q=N.height,$=N.margin,W=U-($.l+$.r),K=q-($.t+$.b),ne;W<0&&(ne=(U-1)/($.l+$.r),$.l=Math.floor(ne*$.l),$.r=Math.floor(ne*$.r)),K<0&&(ne=(q-1)/($.t+$.b),$.t=Math.floor(ne*$.t),$.b=Math.floor(ne*$.b))}},u.clearAutoMarginIds=function(N){N._fullLayout._pushmarginIds={}},u.allowAutoMargin=function(N,U){N._fullLayout._pushmarginIds[U]=1};function R(N){var U=N.margin;if(!N._size){var q=N._size={l:Math.round(U.l),r:Math.round(U.r),t:Math.round(U.t),b:Math.round(U.b),p:Math.round(U.pad)};q.w=Math.round(N.width)-q.l-q.r,q.h=Math.round(N.height)-q.t-q.b}N._pushmargin||(N._pushmargin={}),N._pushmarginIds||(N._pushmarginIds={})}var B=2,F=2,H=64,G=64;u.autoMargin=function(N,U,q){var $=N._fullLayout,W=$.width,K=$.height,ne=$.margin,ae=r.constrain(W-ne.l-ne.r,B,H),ie=r.constrain(K-ne.t-ne.b,F,G),le=Math.max(0,W-ae),ye=Math.max(0,K-ie),ue=$._pushmargin,pe=$._pushmarginIds;if(ne.autoexpand!==!1){if(!q)delete ue[U],delete pe[U];else{var ge=q.pad;if(ge===void 0&&(ge=Math.min(12,ne.l,ne.r,ne.t,ne.b)),le){var Te=(q.l+q.r)/le;Te>1&&(q.l/=Te,q.r/=Te)}if(ye){var _e=(q.t+q.b)/ye;_e>1&&(q.t/=_e,q.b/=_e)}var ze=q.xl!==void 0?q.xl:q.x,Oe=q.xr!==void 0?q.xr:q.x,Ye=q.yt!==void 0?q.yt:q.y,be=q.yb!==void 0?q.yb:q.y;ue[U]={l:{val:ze,size:q.l+ge},r:{val:Oe,size:q.r+ge},b:{val:be,size:q.b+ge},t:{val:Ye,size:q.t+ge}},pe[U]=1}if(!$._replotting)return u.doAutoMargin(N)}},u.doAutoMargin=function(N){var U=N._fullLayout,q=U.width,$=U.height;U._size||(U._size={}),R(U);var W=U._size,K=U.margin,ne=r.extendFlat({},W),ae=K.l,ie=K.r,le=K.t,ye=K.b,ue=U._pushmargin,pe=U._pushmarginIds;if(U.margin.autoexpand!==!1){for(var ge in ue)pe[ge]||delete ue[ge];ue.base={l:{val:0,size:ae},r:{val:1,size:ie},t:{val:1,size:le},b:{val:0,size:ye}};for(var Te in ue){var _e=ue[Te].l||{},ze=ue[Te].b||{},Oe=_e.val,Ye=_e.size,be=ze.val,Pe=ze.size;for(var Ge in ue){if(M(Ye)&&ue[Ge].r){var Qe=ue[Ge].r.val,Be=ue[Ge].r.size;if(Qe>Oe){var Le=(Ye*Qe+(Be-q)*Oe)/(Qe-Oe),He=(Be*(1-Oe)+(Ye-q)*(1-Qe))/(Qe-Oe);Le+He>ae+ie&&(ae=Le,ie=He)}}if(M(Pe)&&ue[Ge].t){var vt=ue[Ge].t.val,Rt=ue[Ge].t.size;if(vt>be){var rr=(Pe*vt+(Rt-$)*be)/(vt-be),Lt=(Rt*(1-be)+(Pe-$)*(1-vt))/(vt-be);rr+Lt>ye+le&&(ye=rr,le=Lt)}}}}}var Ft=r.constrain(q-K.l-K.r,B,H),Gt=r.constrain($-K.t-K.b,F,G),Dt=Math.max(0,q-Ft),kt=Math.max(0,$-Gt);if(Dt){var Ue=(ae+ie)/Dt;Ue>1&&(ae/=Ue,ie/=Ue)}if(kt){var qe=(ye+le)/kt;qe>1&&(ye/=qe,le/=qe)}if(W.l=Math.round(ae),W.r=Math.round(ie),W.t=Math.round(le),W.b=Math.round(ye),W.p=Math.round(K.pad),W.w=Math.round(q)-W.l-W.r,W.h=Math.round($)-W.t-W.b,!U._replotting&&u.didMarginChange(ne,W)){"_redrawFromAutoMarginCount"in U?U._redrawFromAutoMarginCount++:U._redrawFromAutoMarginCount=1;var Ve=3*(1+Object.keys(pe).length);if(U._redrawFromAutoMarginCount<Ve)return e.call("_doPlot",N);U._size=ne,r.warn("Too many auto-margin redraws.")}J(N)};function J(N){var U=o.list(N,"",!0);["_adjustTickLabelsOverflow","_hideCounterAxisInsideTickLabels"].forEach(function(q){for(var $=0;$<U.length;$++){var W=U[$][q];W&&W()}})}var X=["l","r","t","b","p","w","h"];u.didMarginChange=function(N,U){for(var q=0;q<X.length;q++){var $=X[q],W=N[$],K=U[$];if(!M(W)||Math.abs(K-W)>1)return!0}return!1},u.graphJson=function(N,U,q,$,W,K){(W&&U&&!N._fullData||W&&!U&&!N._fullLayout)&&u.supplyDefaults(N);var ne=W?N._fullData:N.data,ae=W?N._fullLayout:N.layout,ie=(N._transitionData||{})._frames;function le(pe,ge){if(typeof pe=="function")return ge?"_function_":null;if(r.isPlainObject(pe)){var Te={},_e;return Object.keys(pe).sort().forEach(function(ze){if(["_","["].indexOf(ze.charAt(0))===-1){if(typeof pe[ze]=="function"){ge&&(Te[ze]="_function");return}if(q==="keepdata"){if(ze.substr(ze.length-3)==="src")return}else if(q==="keepstream"){if(_e=pe[ze+"src"],typeof _e=="string"&&_e.indexOf(":")>0&&!r.isPlainObject(pe.stream))return}else if(q!=="keepall"&&(_e=pe[ze+"src"],typeof _e=="string"&&_e.indexOf(":")>0))return;Te[ze]=le(pe[ze],ge)}}),Te}return Array.isArray(pe)?pe.map(function(ze){return le(ze,ge)}):r.isTypedArray(pe)?r.simpleMap(pe,r.identity):r.isJSDate(pe)?r.ms2DateTimeLocal(+pe):pe}var ye={data:(ne||[]).map(function(pe){var ge=le(pe);return U&&delete ge.fit,ge})};if(!U&&(ye.layout=le(ae),W)){var ue=ae._size;ye.layout.computed={margin:{b:ue.b,l:ue.l,r:ue.r,t:ue.t}}}return ie&&(ye.frames=le(ie)),K&&(ye.config=le(N._context,!0)),$==="object"?ye:JSON.stringify(ye)},u.modifyFrames=function(N,U){var q,$,W,K=N._transitionData._frames,ne=N._transitionData._frameHash;for(q=0;q<U.length;q++)switch($=U[q],$.type){case"replace":W=$.value;var ae=(K[$.index]||{}).name,ie=W.name;K[$.index]=ne[ie]=W,ie!==ae&&(delete ne[ae],ne[ie]=W);break;case"insert":W=$.value,ne[W.name]=W,K.splice($.index,0,W);break;case"delete":W=K[$.index],delete ne[W.name],K.splice($.index,1);break}return Promise.resolve()},u.computeFrame=function(N,U){var q=N._transitionData._frameHash,$,W,K,ne;if(!U)throw new Error("computeFrame must be given a string frame name");var ae=q[U.toString()];if(!ae)return!1;for(var ie=[ae],le=[ae.name];ae.baseframe&&(ae=q[ae.baseframe.toString()])&&le.indexOf(ae.name)===-1;)ie.push(ae),le.push(ae.name);for(var ye={};ae=ie.pop();)if(ae.layout&&(ye.layout=u.extendLayout(ye.layout,ae.layout)),ae.data){if(ye.data||(ye.data=[]),W=ae.traces,!W)for(W=[],$=0;$<ae.data.length;$++)W[$]=$;for(ye.traces||(ye.traces=[]),$=0;$<ae.data.length;$++)K=W[$],K!=null&&(ne=ye.traces.indexOf(K),ne===-1&&(ne=ye.data.length,ye.traces[ne]=K),ye.data[ne]=u.extendTrace(ye.data[ne],ae.data[$]))}return ye},u.recomputeFrameHash=function(N){for(var U=N._transitionData._frameHash={},q=N._transitionData._frames,$=0;$<q.length;$++){var W=q[$];W&&W.name&&(U[W.name]=W)}},u.extendObjectWithContainers=function(N,U,q){var $,W,K,ne,ae,ie,le,ye,ue=r.extendDeepNoArrays({},U||{}),pe=r.expandObjectPaths(ue),ge={};if(q&&q.length)for(K=0;K<q.length;K++)$=r.nestedProperty(pe,q[K]),W=$.get(),W===void 0?r.nestedProperty(ge,q[K]).set(null):($.set(null),r.nestedProperty(ge,q[K]).set(W));if(N=r.extendDeepNoArrays(N||{},pe),q&&q.length){for(K=0;K<q.length;K++)if(ae=r.nestedProperty(ge,q[K]),le=ae.get(),!!le){for(ie=r.nestedProperty(N,q[K]),ye=ie.get(),Array.isArray(ye)||(ye=[],ie.set(ye)),ne=0;ne<le.length;ne++){var Te=le[ne];Te===null?ye[ne]=null:ye[ne]=u.extendObjectWithContainers(ye[ne],Te)}ie.set(ye)}}return N},u.dataArrayContainers=["transforms","dimensions"],u.layoutArrayContainers=e.layoutArrayContainers,u.extendTrace=function(N,U){return u.extendObjectWithContainers(N,U,u.dataArrayContainers)},u.extendLayout=function(N,U){return u.extendObjectWithContainers(N,U,u.layoutArrayContainers)},u.transition=function(N,U,q,$,W,K){var ne={redraw:W.redraw},ae={},ie=[];return ne.prepareFn=function(){for(var le=Array.isArray(U)?U.length:0,ye=$.slice(0,le),ue=0;ue<ye.length;ue++){var pe=ye[ue],ge=N._fullData[pe],Te=ge._module;if(!!Te){if(Te.animatable){var _e=Te.basePlotModule.name;ae[_e]||(ae[_e]=[]),ae[_e].push(pe)}N.data[ye[ue]]=u.extendTrace(N.data[ye[ue]],U[ue])}}var ze=r.expandObjectPaths(r.extendDeepNoArrays({},q)),Oe=/^[xy]axis[0-9]*$/;for(var Ye in ze)!Oe.test(Ye)||delete ze[Ye].range;u.extendLayout(N.layout,ze),delete N.calcdata,u.supplyDefaults(N),u.doCalcdata(N);var be=r.expandObjectPaths(q);if(be){var Pe=N._fullLayout._plots;for(var Ge in Pe){var Qe=Pe[Ge],Be=Qe.xaxis,Le=Qe.yaxis,He=Be.range.slice(),vt=Le.range.slice(),Rt=null,rr=null,Lt=null,Ft=null;Array.isArray(be[Be._name+".range"])?Rt=be[Be._name+".range"].slice():Array.isArray((be[Be._name]||{}).range)&&(Rt=be[Be._name].range.slice()),Array.isArray(be[Le._name+".range"])?rr=be[Le._name+".range"].slice():Array.isArray((be[Le._name]||{}).range)&&(rr=be[Le._name].range.slice()),He&&Rt&&(Be.r2l(He[0])!==Be.r2l(Rt[0])||Be.r2l(He[1])!==Be.r2l(Rt[1]))&&(Lt={xr0:He,xr1:Rt}),vt&&rr&&(Le.r2l(vt[0])!==Le.r2l(rr[0])||Le.r2l(vt[1])!==Le.r2l(rr[1]))&&(Ft={yr0:vt,yr1:rr}),(Lt||Ft)&&ie.push(r.extendFlat({plotinfo:Qe},Lt,Ft))}}return Promise.resolve()},ne.runFn=function(le){var ye,ue=N._fullLayout._basePlotModules,pe=ie.length,ge;if(q)for(ge=0;ge<ue.length;ge++)ue[ge].transitionAxes&&ue[ge].transitionAxes(N,ie,K,le);pe?(ye=r.extendFlat({},K),ye.duration=0,delete ae.cartesian):ye=K;for(var Te in ae){var _e=ae[Te],ze=N._fullData[_e[0]]._module;ze.basePlotModule.plot(N,_e,ye,le)}},Y(N,K,ne)},u.transitionFromReact=function(N,U,q,$){var W=N._fullLayout,K=W.transition,ne={},ae=[];return ne.prepareFn=function(){var ie=W._plots;ne.redraw=!1,U.anim==="some"&&(ne.redraw=!0),q.anim==="some"&&(ne.redraw=!0);for(var le in ie){var ye=ie[le],ue=ye.xaxis,pe=ye.yaxis,ge=$[ue._name].range.slice(),Te=$[pe._name].range.slice(),_e=ue.range.slice(),ze=pe.range.slice();ue.setScale(),pe.setScale();var Oe=null,Ye=null;(ue.r2l(ge[0])!==ue.r2l(_e[0])||ue.r2l(ge[1])!==ue.r2l(_e[1]))&&(Oe={xr0:ge,xr1:_e}),(pe.r2l(Te[0])!==pe.r2l(ze[0])||pe.r2l(Te[1])!==pe.r2l(ze[1]))&&(Ye={yr0:Te,yr1:ze}),(Oe||Ye)&&ae.push(r.extendFlat({plotinfo:ye},Oe,Ye))}return Promise.resolve()},ne.runFn=function(ie){for(var le=N._fullData,ye=N._fullLayout,ue=ye._basePlotModules,pe,ge,Te,_e=[],ze=0;ze<le.length;ze++)_e.push(ze);function Oe(){if(!!N._fullLayout)for(var be=0;be<ue.length;be++)ue[be].transitionAxes&&ue[be].transitionAxes(N,ae,pe,ie)}function Ye(){if(!!N._fullLayout)for(var be=0;be<ue.length;be++)ue[be].plot(N,Te,ge,ie)}ae.length&&U.anim?K.ordering==="traces first"?(pe=r.extendFlat({},K,{duration:0}),Te=_e,ge=K,setTimeout(Oe,K.duration),Ye()):(pe=K,Te=null,ge=r.extendFlat({},K,{duration:0}),setTimeout(Ye,pe.duration),Oe()):ae.length?(pe=K,Oe()):U.anim&&(Te=_e,ge=K,Ye())},Y(N,K,ne)};function Y(N,U,q){var $=!1;function W(ue){var pe=Promise.resolve();if(!ue)return pe;for(;ue.length;)pe=pe.then(ue.shift());return pe}function K(ue){if(!!ue)for(;ue.length;)ue.shift()}function ne(){return N.emit("plotly_transitioning",[]),new Promise(function(ue){N._transitioning=!0,U.duration>0&&(N._transitioningWithDuration=!0),N._transitionData._interruptCallbacks.push(function(){$=!0}),q.redraw&&N._transitionData._interruptCallbacks.push(function(){return e.call("redraw",N)}),N._transitionData._interruptCallbacks.push(function(){N.emit("plotly_transitioninterrupted",[])});var pe=0,ge=0;function Te(){return pe++,function(){ge++,!$&&ge===pe&&ae(ue)}}q.runFn(Te),setTimeout(Te())})}function ae(ue){if(!!N._transitionData)return K(N._transitionData._interruptCallbacks),Promise.resolve().then(function(){if(q.redraw)return e.call("redraw",N)}).then(function(){N._transitioning=!1,N._transitioningWithDuration=!1,N.emit("plotly_transitioned",[])}).then(ue)}function ie(){if(!!N._transitionData)return N._transitioning=!1,W(N._transitionData._interruptCallbacks)}var le=[u.previousPromises,ie,q.prepareFn,u.rehover,u.reselect,ne],ye=r.syncOrAsync(le,N);return(!ye||!ye.then)&&(ye=Promise.resolve()),ye.then(function(){return N})}u.doCalcdata=function(N,U){var q=o.list(N),$=N._fullData,W=N._fullLayout,K,ne,ae,ie,le=new Array($.length),ye=(N.calcdata||[]).slice();for(N.calcdata=le,W._numBoxes=0,W._numViolins=0,W._violinScaleGroupStats={},N._hmpixcount=0,N._hmlumcount=0,W._piecolormap={},W._sunburstcolormap={},W._treemapcolormap={},W._iciclecolormap={},W._funnelareacolormap={},ae=0;ae<$.length;ae++)if(Array.isArray(U)&&U.indexOf(ae)===-1){le[ae]=ye[ae];continue}for(ae=0;ae<$.length;ae++)K=$[ae],K._arrayAttrs=a.findArrayAttributes(K),K._extremes={};var ue=W._subplots.polar||[];for(ae=0;ae<ue.length;ae++)q.push(W[ue[ae]].radialaxis,W[ue[ae]].angularaxis);for(var pe in W._colorAxes){var ge=W[pe];ge.cauto!==!1&&(delete ge.cmin,delete ge.cmax)}var Te=!1;function _e(Ye){if(K=$[Ye],ne=K._module,K.visible===!0&&K.transforms){if(ne&&ne.calc){var be=ne.calc(N,K);be[0]&&be[0].t&&be[0].t._scene&&delete be[0].t._scene.dirty}for(ie=0;ie<K.transforms.length;ie++){var Pe=K.transforms[ie];ne=_[Pe.type],ne&&ne.calcTransform&&(K._hasCalcTransform=!0,Te=!0,ne.calcTransform(N,K,Pe))}}}function ze(Ye,be){if(K=$[Ye],ne=K._module,!!ne.isContainer===be){var Pe=[];if(K.visible===!0&&K._length!==0){delete K._indexToPoints;var Ge=K.transforms||[];for(ie=Ge.length-1;ie>=0;ie--)if(Ge[ie].enabled){K._indexToPoints=Ge[ie]._indexToPoints;break}ne&&ne.calc&&(Pe=ne.calc(N,K))}(!Array.isArray(Pe)||!Pe[0])&&(Pe=[{x:c,y:c}]),Pe[0].t||(Pe[0].t={}),Pe[0].trace=K,le[Ye]=Pe}}for(re(q,$,W),ae=0;ae<$.length;ae++)ze(ae,!0);for(ae=0;ae<$.length;ae++)_e(ae);for(Te&&re(q,$,W),ae=0;ae<$.length;ae++)ze(ae,!0);for(ae=0;ae<$.length;ae++)ze(ae,!1);se(N);var Oe=oe(q,N);if(Oe.length){for(W._numBoxes=0,W._numViolins=0,ae=0;ae<Oe.length;ae++)ze(Oe[ae],!0);for(ae=0;ae<Oe.length;ae++)ze(Oe[ae],!1);se(N)}e.getComponentMethod("fx","calc")(N),e.getComponentMethod("errorbars","calc")(N)};var Z=/(total|sum|min|max|mean|median) (ascending|descending)/;function oe(N,U){var q=[],$,W,K,ne,ae;function ie(Dt,kt,Ue){var qe=kt._id.charAt(0);if(Dt==="histogram2dcontour"){var Ve=kt._counterAxes[0],Ae=o.getFromId(U,Ve),Ne=qe==="x"||Ve==="x"&&Ae.type==="category",Xe=qe==="y"||Ve==="y"&&Ae.type==="category";return function(Je,_t){return Je===0||_t===0||Ne&&Je===Ue[_t].length-1||Xe&&_t===Ue.length-1?-1:(qe==="y"?_t:Je)-1}}else return function(Je,_t){return qe==="y"?_t:Je}}var le={min:function(Dt){return r.aggNums(Math.min,null,Dt)},max:function(Dt){return r.aggNums(Math.max,null,Dt)},sum:function(Dt){return r.aggNums(function(kt,Ue){return kt+Ue},null,Dt)},total:function(Dt){return r.aggNums(function(kt,Ue){return kt+Ue},null,Dt)},mean:function(Dt){return r.mean(Dt)},median:function(Dt){return r.median(Dt)}};for($=0;$<N.length;$++){var ye=N[$];if(ye.type==="category"){var ue=ye.categoryorder.match(Z);if(ue){var pe=ue[1],ge=ue[2],Te=ye._id.charAt(0),_e=Te==="x",ze=[];for(W=0;W<ye._categories.length;W++)ze.push([ye._categories[W],[]]);for(W=0;W<ye._traceIndices.length;W++){var Oe=ye._traceIndices[W],Ye=U._fullData[Oe];if(Ye.visible===!0){var be=Ye.type;e.traceIs(Ye,"histogram")&&(delete Ye._xautoBinFinished,delete Ye._yautoBinFinished);var Pe=be==="splom",Ge=be==="scattergl",Qe=U.calcdata[Oe];for(K=0;K<Qe.length;K++){var Be=Qe[K],Le,He;if(Pe){var vt=Ye._axesDim[ye._id];if(!_e){var Rt=Ye._diag[vt][0];Rt&&(ye=U._fullLayout[o.id2name(Rt)])}var rr=Be.trace.dimensions[vt].values;for(ne=0;ne<rr.length;ne++)for(Le=ye._categoriesMap[rr[ne]],ae=0;ae<Be.trace.dimensions.length;ae++)if(ae!==vt){var Lt=Be.trace.dimensions[ae];ze[Le][1].push(Lt.values[ne])}}else if(Ge){for(ne=0;ne<Be.t.x.length;ne++)_e?(Le=Be.t.x[ne],He=Be.t.y[ne]):(Le=Be.t.y[ne],He=Be.t.x[ne]),ze[Le][1].push(He);Be.t&&Be.t._scene&&delete Be.t._scene.dirty}else if(Be.hasOwnProperty("z")){He=Be.z;var Ft=ie(Ye.type,ye,He);for(ne=0;ne<He.length;ne++)for(ae=0;ae<He[ne].length;ae++)Le=Ft(ae,ne),Le+1&&ze[Le][1].push(He[ne][ae])}else for(Le=Be.p,Le===void 0&&(Le=Be[Te]),He=Be.s,He===void 0&&(He=Be.v),He===void 0&&(He=_e?Be.y:Be.x),Array.isArray(He)||(He===void 0?He=[]:He=[He]),ne=0;ne<He.length;ne++)ze[Le][1].push(He[ne])}}}ye._categoriesValue=ze;var Gt=[];for(W=0;W<ze.length;W++)Gt.push([ze[W][0],le[pe](ze[W][1])]);Gt.sort(function(Dt,kt){return Dt[1]-kt[1]}),ye._categoriesAggregatedValue=Gt,ye._initialCategories=Gt.map(function(Dt){return Dt[0]}),ge==="descending"&&ye._initialCategories.reverse(),q=q.concat(ye.sortByInitialCategories())}}}return q}function re(N,U,q){var $={};function W(ie){ie.clearCalc(),ie.type==="multicategory"&&ie.setupMultiCategory(U),$[ie._id]=1}r.simpleMap(N,W);for(var K=q._axisMatchGroups||[],ne=0;ne<K.length;ne++)for(var ae in K[ne])$[ae]||W(q[o.id2name(ae)])}function se(N){var U=N._fullLayout,q=U._visibleModules,$={},W,K,ne;for(K=0;K<q.length;K++){var ae=q[K],ie=ae.crossTraceCalc;if(ie){var le=ae.basePlotModule.name;$[le]?r.pushUnique($[le],ie):$[le]=[ie]}}for(ne in $){var ye=$[ne],ue=U._subplots[ne];if(Array.isArray(ue))for(W=0;W<ue.length;W++){var pe=ue[W],ge=ne==="cartesian"?U._plots[pe]:U[pe];for(K=0;K<ye.length;K++)ye[K](N,ge,pe)}else for(K=0;K<ye.length;K++)ye[K](N)}}u.rehover=function(N){N._fullLayout._rehover&&N._fullLayout._rehover()},u.redrag=function(N){N._fullLayout._redrag&&N._fullLayout._redrag()},u.reselect=function(N){var U=N._fullLayout,q=(N.layout||{}).selections,$=U._previousSelections;U._previousSelections=q;var W=U._reselect||JSON.stringify(q)!==JSON.stringify($);e.getComponentMethod("selections","reselect")(N,W)},u.generalUpdatePerTraceModule=function(N,U,q,$){var W=U.traceHash,K={},ne;for(ne=0;ne<q.length;ne++){var ae=q[ne],ie=ae[0].trace;ie.visible&&(K[ie.type]=K[ie.type]||[],K[ie.type].push(ae))}for(var le in W)if(!K[le]){var ye=W[le][0],ue=ye[0].trace;ue.visible=!1,K[le]=[ye]}for(var pe in K){var ge=K[pe],Te=ge[0][0].trace._module;Te.plot(N,U,r.filterVisible(ge),$)}U.traceHash=K},u.plotBasePlot=function(N,U,q,$,W){var K=e.getModule(N),ne=g(U.calcdata,K)[0];K.plot(U,ne,$,W)},u.cleanBasePlot=function(N,U,q,$,W){var K=W._has&&W._has(N),ne=q._has&&q._has(N);K&&!ne&&W["_"+N+"layer"].selectAll("g.trace").remove()}},{"../components/color":367,"../components/shapes/handle_outline":468,"../constants/numerical":491,"../lib":515,"../plot_api/plot_schema":554,"../plot_api/plot_template":555,"../plots/get_data":602,"../registry":647,"./animation_attributes":560,"./attributes":562,"./cartesian/axis_ids":570,"./command":592,"./font_attributes":594,"./frame_attributes":595,"./layout_attributes":619,"@plotly/d3":58,"d3-format":112,"d3-time-format":120,"fast-isnumeric":190}],629:[function(d,ee,te){ee.exports={attr:"subplot",name:"polar",axisNames:["angularaxis","radialaxis"],axisName2dataArray:{angularaxis:"theta",radialaxis:"r"},layerNames:["draglayer","plotbg","backplot","angular-grid","radial-grid","frontplot","angular-line","radial-line","angular-axis","radial-axis"],radialDragBoxSize:50,angularDragBoxSize:30,cornerLen:25,cornerHalfWidth:2,MINDRAG:8,MINZOOM:20,OFFEDGE:20}},{}],630:[function(d,ee,te){var w=d("../../lib"),v=d("../../lib/polygon").tester,S=w.findIndexOfMin,M=w.isAngleInsideSector,e=w.angleDelta,a=w.angleDist;function n(_,s,A,b,f){if(!M(s,b))return!1;var x,l;A[0]<A[1]?(x=A[0],l=A[1]):(x=A[1],l=A[0]);var L=v(i(x,b[0],b[1],f)),T=v(i(l,b[0],b[1],f)),k=[_*Math.cos(s),_*Math.sin(s)];return T.contains(k)&&!L.contains(k)}function r(_,s,A,b){var f,x,l=b[0],L=b[1],T=g(Math.sin(s)-Math.sin(_)),k=g(Math.cos(s)-Math.cos(_)),P=Math.tan(A),z=g(1/P),I=T/k,D=L-I*l;return z?T&&k?(f=D/(P-I),x=P*f):k?(f=L*z,x=L):(f=l,x=l*P):T&&k?(f=0,x=D):k?(f=0,x=L):f=x=NaN,[f,x]}function t(_,s,A,b){var f=-s*A,x=s*s+1,l=2*(s*f-A),L=f*f+A*A-_*_,T=Math.sqrt(l*l-4*x*L),k=(-l+T)/(2*x),P=(-l-T)/(2*x);return[[k,s*k+f+b],[P,s*P+f+b]]}function c(_,s){var A=s.length,b=new Array(A+1),f;for(f=0;f<A;f++){var x=s[f];b[f]=[_*Math.cos(x),_*Math.sin(x)]}return b[f]=b[0].slice(),b}function o(_,s,A,b){var f=b.length,x=[],l,L;function T(H){return[_*Math.cos(H),_*Math.sin(H)]}function k(H,G,J){return r(H,G,J,T(H))}function P(H){return w.mod(H,f)}function z(H){return M(H,[s,A])}var I=S(b,function(H){return z(H)?a(H,s):1/0}),D=k(b[I],b[P(I-1)],s);for(x.push(D),l=I,L=0;L<f;l++,L++){var R=b[P(l)];if(!z(R))break;x.push(T(R))}var B=S(b,function(H){return z(H)?a(H,A):1/0}),F=k(b[B],b[P(B+1)],A);return x.push(F),x.push([0,0]),x.push(x[0].slice()),x}function i(_,s,A,b){return w.isFullCircle([s,A])?c(_,b):o(_,s,A,b)}function y(_,s,A,b){for(var f=1/0,x=1/0,l=i(_,s,A,b),L=0;L<l.length;L++){var T=l[L];f=Math.min(f,T[0]),x=Math.min(x,-T[1])}return[f,x]}function p(_,s){var A=function(x){var l=e(x,_);return l>0?l:1/0},b=S(s,A),f=w.mod(b+1,s.length);return[s[b],s[f]]}function g(_){return Math.abs(_)>1e-10?_:0}function h(_,s,A){s=s||0,A=A||0;for(var b=_.length,f=new Array(b),x=0;x<b;x++){var l=_[x];f[x]=[s+l[0],A-l[1]]}return f}function m(_,s,A,b,f,x){var l=i(_,s,A,b);return"M"+h(l,f,x).join("L")}function u(_,s,A,b,f,x,l){var L,T;_<s?(L=_,T=s):(L=s,T=_);var k=h(i(L,A,b,f),x,l),P=h(i(T,A,b,f),x,l);return"M"+P.reverse().join("L")+"M"+k.join("L")}ee.exports={isPtInsidePolygon:n,findPolygonOffset:y,findEnclosingVertexAngles:p,findIntersectionXY:r,findXYatLength:t,clampTiny:g,pathPolygon:m,pathPolygonAnnulus:u}},{"../../lib":515,"../../lib/polygon":527}],631:[function(d,ee,te){var w=d("../get_data").getSubplotCalcData,v=d("../../lib").counterRegex,S=d("./polar"),M=d("./constants"),e=M.attr,a=M.name,n=v(a),r={};r[e]={valType:"subplotid",dflt:a,editType:"calc"};function t(o){for(var i=o._fullLayout,y=o.calcdata,p=i._subplots[a],g=0;g<p.length;g++){var h=p[g],m=w(y,a,h),u=i[h]._subplot;u||(u=S(o,h),i[h]._subplot=u),u.plot(m,i,o._promises)}}function c(o,i,y,p){for(var g=p._subplots[a]||[],h=p._has&&p._has("gl"),m=i._has&&i._has("gl"),u=h&&!m,_=0;_<g.length;_++){var s=g[_],A=p[s]._subplot;if(!i[s]&&!!A){A.framework.remove(),A.layers["radial-axis-title"].remove();for(var b in A.clipPaths)A.clipPaths[b].remove()}u&&A._scene&&(A._scene.destroy(),A._scene=null)}}ee.exports={attr:e,name:a,idRoot:a,idRegex:n,attrRegex:n,attributes:r,layoutAttributes:d("./layout_attributes"),supplyLayoutDefaults:d("./layout_defaults"),plot:t,clean:c,toSVG:d("../cartesian").toSVG}},{"../../lib":515,"../cartesian":578,"../get_data":602,"./constants":629,"./layout_attributes":632,"./layout_defaults":633,"./polar":634}],632:[function(d,ee,te){var w=d("../../components/color/attributes"),v=d("../cartesian/layout_attributes"),S=d("../domain").attributes,M=d("../../lib").extendFlat,e=d("../../plot_api/edit_types").overrideAll,a=e({color:v.color,showline:M({},v.showline,{dflt:!0}),linecolor:v.linecolor,linewidth:v.linewidth,showgrid:M({},v.showgrid,{dflt:!0}),gridcolor:v.gridcolor,gridwidth:v.gridwidth,griddash:v.griddash},"plot","from-root"),n=e({tickmode:v.tickmode,nticks:v.nticks,tick0:v.tick0,dtick:v.dtick,tickvals:v.tickvals,ticktext:v.ticktext,ticks:v.ticks,ticklen:v.ticklen,tickwidth:v.tickwidth,tickcolor:v.tickcolor,ticklabelstep:v.ticklabelstep,showticklabels:v.showticklabels,showtickprefix:v.showtickprefix,tickprefix:v.tickprefix,showticksuffix:v.showticksuffix,ticksuffix:v.ticksuffix,showexponent:v.showexponent,exponentformat:v.exponentformat,minexponent:v.minexponent,separatethousands:v.separatethousands,tickfont:v.tickfont,tickangle:v.tickangle,tickformat:v.tickformat,tickformatstops:v.tickformatstops,layer:v.layer},"plot","from-root"),r={visible:M({},v.visible,{dflt:!0}),type:M({},v.type,{values:["-","linear","log","date","category"]}),autotypenumbers:v.autotypenumbers,autorange:M({},v.autorange,{editType:"plot"}),rangemode:{valType:"enumerated",values:["tozero","nonnegative","normal"],dflt:"tozero",editType:"calc"},range:M({},v.range,{items:[{valType:"any",editType:"plot",impliedEdits:{"^autorange":!1}},{valType:"any",editType:"plot",impliedEdits:{"^autorange":!1}}],editType:"plot"}),categoryorder:v.categoryorder,categoryarray:v.categoryarray,angle:{valType:"angle",editType:"plot"},side:{valType:"enumerated",values:["clockwise","counterclockwise"],dflt:"clockwise",editType:"plot"},title:{text:M({},v.title.text,{editType:"plot",dflt:""}),font:M({},v.title.font,{editType:"plot"}),editType:"plot"},hoverformat:v.hoverformat,uirevision:{valType:"any",editType:"none"},editType:"calc",_deprecated:{title:v._deprecated.title,titlefont:v._deprecated.titlefont}};M(r,a,n);var t={visible:M({},v.visible,{dflt:!0}),type:{valType:"enumerated",values:["-","linear","category"],dflt:"-",editType:"calc",_noTemplating:!0},autotypenumbers:v.autotypenumbers,categoryorder:v.categoryorder,categoryarray:v.categoryarray,thetaunit:{valType:"enumerated",values:["radians","degrees"],dflt:"degrees",editType:"calc"},period:{valType:"number",editType:"calc",min:0},direction:{valType:"enumerated",values:["counterclockwise","clockwise"],dflt:"counterclockwise",editType:"calc"},rotation:{valType:"angle",editType:"calc"},hoverformat:v.hoverformat,uirevision:{valType:"any",editType:"none"},editType:"calc"};M(t,a,n),ee.exports={domain:S({name:"polar",editType:"plot"}),sector:{valType:"info_array",items:[{valType:"number",editType:"plot"},{valType:"number",editType:"plot"}],dflt:[0,360],editType:"plot"},hole:{valType:"number",min:0,max:1,dflt:0,editType:"plot"},bgcolor:{valType:"color",editType:"plot",dflt:w.background},radialaxis:r,angularaxis:t,gridshape:{valType:"enumerated",values:["circular","linear"],dflt:"circular",editType:"plot"},uirevision:{valType:"any",editType:"none"},editType:"calc"}},{"../../components/color/attributes":366,"../../lib":515,"../../plot_api/edit_types":548,"../cartesian/layout_attributes":579,"../domain":593}],633:[function(d,ee,te){var w=d("../../lib"),v=d("../../components/color"),S=d("../../plot_api/plot_template"),M=d("../subplot_defaults"),e=d("../get_data").getSubplotData,a=d("../cartesian/tick_value_defaults"),n=d("../cartesian/tick_mark_defaults"),r=d("../cartesian/tick_label_defaults"),t=d("../cartesian/prefix_suffix_defaults"),c=d("../cartesian/category_order_defaults"),o=d("../cartesian/line_grid_defaults"),i=d("../cartesian/axis_autotype"),y=d("./layout_attributes"),p=d("./set_convert"),g=d("./constants"),h=g.axisNames;function m(_,s,A,b){var f=A("bgcolor");b.bgColor=v.combine(f,b.paper_bgcolor);var x=A("sector");A("hole");var l=e(b.fullData,g.name,b.id),L=b.layoutOut,T;function k(re,se){return A(T+"."+re,se)}for(var P=0;P<h.length;P++){T=h[P],w.isPlainObject(_[T])||(_[T]={});var z=_[T],I=S.newContainer(s,T);I._id=I._name=T,I._attr=b.id+"."+T,I._traceIndices=l.map(function(re){return re._expandedIndex});var D=g.axisName2dataArray[T],R=u(z,I,k,l,D,b);c(z,I,k,{axData:l,dataAttr:D});var B=k("visible");switch(p(I,s,L),k("uirevision",s.uirevision),I._m=1,T){case"radialaxis":var F=k("autorange",!I.isValidRange(z.range));z.autorange=F,F&&(R==="linear"||R==="-")&&k("rangemode"),F==="reversed"&&(I._m=-1),k("range"),I.cleanRange("range",{dfltRange:[0,1]});break;case"angularaxis":if(R==="date"){w.log("Polar plots do not support date angular axes yet.");for(var H=0;H<l.length;H++)l[H].visible=!1;R=z.type=I.type="linear"}k(R==="linear"?"thetaunit":"period");var G=k("direction");k("rotation",{counterclockwise:0,clockwise:90}[G]);break}if(t(z,I,k,I.type,{tickSuffixDflt:I.thetaunit==="degrees"?"\xB0":void 0}),B){var J,X,Y,Z,oe=b.font||{};J=k("color"),X=J===z.color?J:oe.color,Y=oe.size,Z=oe.family,a(z,I,k,I.type),r(z,I,k,I.type,{font:{color:X,size:Y,family:Z}}),n(z,I,k,{outerTicks:!0}),o(z,I,k,{dfltColor:J,bgColor:b.bgColor,blend:60,showLine:!0,showGrid:!0,noZeroLine:!0,attributes:y[T]}),k("layer"),T==="radialaxis"&&(k("side"),k("angle",x[0]),k("title.text"),w.coerceFont(k,"title.font",{color:X,size:w.bigFont(Y),family:Z}))}R!=="category"&&k("hoverformat"),I._input=z}s.angularaxis.type==="category"&&A("gridshape")}function u(_,s,A,b,f,x){var l=A("autotypenumbers",x.autotypenumbersDflt),L=A("type");if(L==="-"){for(var T,k=0;k<b.length;k++)if(b[k].visible){T=b[k];break}T&&T[f]&&(s.type=i(T[f],"gregorian",{noMultiCategory:!0,autotypenumbers:l})),s.type==="-"?s.type="linear":_.type=s.type}return s.type}ee.exports=function(s,A,b){M(s,A,b,{type:g.name,attributes:y,handleDefaults:m,font:A.font,autotypenumbersDflt:A.autotypenumbers,paper_bgcolor:A.paper_bgcolor,fullData:b,layoutOut:A})}},{"../../components/color":367,"../../lib":515,"../../plot_api/plot_template":555,"../cartesian/axis_autotype":567,"../cartesian/category_order_defaults":571,"../cartesian/line_grid_defaults":581,"../cartesian/prefix_suffix_defaults":583,"../cartesian/tick_label_defaults":587,"../cartesian/tick_mark_defaults":588,"../cartesian/tick_value_defaults":589,"../get_data":602,"../subplot_defaults":641,"./constants":629,"./layout_attributes":632,"./set_convert":635}],634:[function(d,ee,te){var w=d("@plotly/d3"),v=d("tinycolor2"),S=d("../../registry"),M=d("../../lib"),e=M.strRotate,a=M.strTranslate,n=d("../../components/color"),r=d("../../components/drawing"),t=d("../plots"),c=d("../../plots/cartesian/axes"),o=d("../cartesian/set_convert"),i=d("./set_convert"),y=d("../cartesian/autorange").doAutoRange,p=d("../cartesian/dragbox"),g=d("../../components/dragelement"),h=d("../../components/fx"),m=d("../../components/titles"),u=d("../../components/selections").prepSelect,_=d("../../components/selections").selectOnClick,s=d("../../components/selections").clearOutline,A=d("../../lib/setcursor"),b=d("../../lib/clear_gl_canvases"),f=d("../../plot_api/subroutines").redrawReglTraces,x=d("../../constants/alignment").MID_SHIFT,l=d("./constants"),L=d("./helpers"),T=d("../smith/helpers"),k=T.smith,P=T.reactanceArc,z=T.resistanceArc,I=T.smithTransform,D=M._,R=M.mod,B=M.deg2rad,F=M.rad2deg;function H(oe,re,se){this.isSmith=se||!1,this.id=re,this.gd=oe,this._hasClipOnAxisFalse=null,this.vangles=null,this.radialAxisAngle=null,this.traceHash={},this.layers={},this.clipPaths={},this.clipIds={},this.viewInitial={};var N=oe._fullLayout,U="clip"+N._uid+re;this.clipIds.forTraces=U+"-for-traces",this.clipPaths.forTraces=N._clips.append("clipPath").attr("id",this.clipIds.forTraces),this.clipPaths.forTraces.append("path"),this.framework=N["_"+(se?"smith":"polar")+"layer"].append("g").attr("class",re),this.getHole=function(q){return this.isSmith?0:q.hole},this.getSector=function(q){return this.isSmith?[0,360]:q.sector},this.getRadial=function(q){return this.isSmith?q.realaxis:q.radialaxis},this.getAngular=function(q){return this.isSmith?q.imaginaryaxis:q.angularaxis},se||(this.radialTickLayout=null,this.angularTickLayout=null)}var G=H.prototype;ee.exports=function(re,se,N){return new H(re,se,N)},G.plot=function(oe,re){for(var se=this,N=re[se.id],U=!1,q=0;q<oe.length;q++){var $=oe[q][0].trace;if($.cliponaxis===!1){U=!0;break}}se._hasClipOnAxisFalse=U,se.updateLayers(re,N),se.updateLayout(re,N),t.generalUpdatePerTraceModule(se.gd,se,oe,N),se.updateFx(re,N),se.isSmith&&(delete N.realaxis.range,delete N.imaginaryaxis.range)},G.updateLayers=function(oe,re){var se=this,N=se.isSmith,U=se.layers,q=se.getRadial(re),$=se.getAngular(re),W=l.layerNames,K=W.indexOf("frontplot"),ne=W.slice(0,K),ae=$.layer==="below traces",ie=q.layer==="below traces";ae&&ne.push("angular-line"),ie&&ne.push("radial-line"),ae&&ne.push("angular-axis"),ie&&ne.push("radial-axis"),ne.push("frontplot"),ae||ne.push("angular-line"),ie||ne.push("radial-line"),ae||ne.push("angular-axis"),ie||ne.push("radial-axis");var le=(N?"smith":"polar")+"sublayer",ye=se.framework.selectAll("."+le).data(ne,String);ye.enter().append("g").attr("class",function(ue){return le+" "+ue}).each(function(ue){var pe=U[ue]=w.select(this);switch(ue){case"frontplot":N||pe.append("g").classed("barlayer",!0),pe.append("g").classed("scatterlayer",!0);break;case"backplot":pe.append("g").classed("maplayer",!0);break;case"plotbg":U.bg=pe.append("path");break;case"radial-grid":pe.style("fill","none");break;case"angular-grid":pe.style("fill","none");break;case"radial-line":pe.append("line").style("fill","none");break;case"angular-line":pe.append("path").style("fill","none");break}}),ye.order()},G.updateLayout=function(oe,re){var se=this,N=se.layers,U=oe._size,q=se.getRadial(re),$=se.getAngular(re),W=re.domain.x,K=re.domain.y;se.xOffset=U.l+U.w*W[0],se.yOffset=U.t+U.h*(1-K[1]);var ne=se.xLength=U.w*(W[1]-W[0]),ae=se.yLength=U.h*(K[1]-K[0]),ie=se.getSector(re);se.sectorInRad=ie.map(B);var le=se.sectorBBox=X(ie),ye=le[2]-le[0],ue=le[3]-le[1],pe=ae/ne,ge=Math.abs(ue/ye),Te,_e,ze,Oe,Ye;pe>ge?(Te=ne,_e=ne*ge,Ye=(ae-_e)/U.h/2,ze=[W[0],W[1]],Oe=[K[0]+Ye,K[1]-Ye]):(Te=ae/ge,_e=ae,Ye=(ne-Te)/U.w/2,ze=[W[0]+Ye,W[1]-Ye],Oe=[K[0],K[1]]),se.xLength2=Te,se.yLength2=_e,se.xDomain2=ze,se.yDomain2=Oe;var be=se.xOffset2=U.l+U.w*ze[0],Pe=se.yOffset2=U.t+U.h*(1-Oe[1]),Ge=se.radius=Te/ye,Qe=se.innerRadius=se.getHole(re)*Ge,Be=se.cx=be-Ge*le[0],Le=se.cy=Pe+Ge*le[3],He=se.cxx=Be-be,vt=se.cyy=Le-Pe,Rt=q.side,rr;Rt==="counterclockwise"?(rr=Rt,Rt="top"):Rt==="clockwise"&&(rr=Rt,Rt="bottom"),se.radialAxis=se.mockAxis(oe,re,q,{_id:"x",side:Rt,_trueSide:rr,domain:[Qe/U.w,Ge/U.w]}),se.angularAxis=se.mockAxis(oe,re,$,{side:"right",domain:[0,Math.PI],autorange:!1}),se.doAutoRange(oe,re),se.updateAngularAxis(oe,re),se.updateRadialAxis(oe,re),se.updateRadialAxisTitle(oe,re),se.xaxis=se.mockCartesianAxis(oe,re,{_id:"x",domain:ze}),se.yaxis=se.mockCartesianAxis(oe,re,{_id:"y",domain:Oe});var Lt=se.pathSubplot();se.clipPaths.forTraces.select("path").attr("d",Lt).attr("transform",a(He,vt)),N.frontplot.attr("transform",a(be,Pe)).call(r.setClipUrl,se._hasClipOnAxisFalse?null:se.clipIds.forTraces,se.gd),N.bg.attr("d",Lt).attr("transform",a(Be,Le)).call(n.fill,re.bgcolor)},G.mockAxis=function(oe,re,se,N){var U=M.extendFlat({},se,N);return i(U,re,oe),U},G.mockCartesianAxis=function(oe,re,se){var N=this,U=N.isSmith,q=se._id,$=M.extendFlat({type:"linear"},se);o($,oe);var W={x:[0,2],y:[1,3]};return $.setRange=function(){var K=N.sectorBBox,ne=W[q],ae=N.radialAxis._rl,ie=(ae[1]-ae[0])/(1-N.getHole(re));$.range=[K[ne[0]]*ie,K[ne[1]]*ie]},$.isPtWithinRange=q==="x"&&!U?function(K){return N.isPtInside(K)}:function(){return!0},$.setRange(),$.setScale(),$},G.doAutoRange=function(oe,re){var se=this,N=se.gd,U=se.radialAxis,q=se.getRadial(re);y(N,U);var $=U.range;q.range=$.slice(),q._input.range=$.slice(),U._rl=[U.r2l($[0],null,"gregorian"),U.r2l($[1],null,"gregorian")]},G.updateRadialAxis=function(oe,re){var se=this,N=se.gd,U=se.layers,q=se.radius,$=se.innerRadius,W=se.cx,K=se.cy,ne=se.getRadial(re),ae=R(se.getSector(re)[0],360),ie=se.radialAxis,le=$<q,ye=se.isSmith;ye||(se.fillViewInitialKey("radialaxis.angle",ne.angle),se.fillViewInitialKey("radialaxis.range",ie.range.slice()),ie.setGeometry()),ie.tickangle==="auto"&&ae>90&&ae<=270&&(ie.tickangle=180);var ue=ye?function(Ge){var Qe=I(se,k([Ge.x,0]));return a(Qe[0]-W,Qe[1]-K)}:function(Ge){return a(ie.l2p(Ge.x)+$,0)},pe=ye?function(Ge){return z(se,Ge.x,-1/0,1/0)}:function(Ge){return se.pathArc(ie.r2p(Ge.x)+$)},ge=J(ne);if(se.radialTickLayout!==ge&&(U["radial-axis"].selectAll(".xtick").remove(),se.radialTickLayout=ge),le){ie.setScale();var Te=0,_e=ye?(ie.tickvals||[]).filter(function(Ge){return Ge>=0}).map(function(Ge){return c.tickText(ie,Ge,!0,!1)}):c.calcTicks(ie),ze=ye?_e:c.clipEnds(ie,_e),Oe=c.getTickSigns(ie)[2];ye&&((ie.ticks==="top"&&ie.side==="bottom"||ie.ticks==="bottom"&&ie.side==="top")&&(Oe=-Oe),ie.ticks==="top"&&ie.side==="top"&&(Te=-ie.ticklen),ie.ticks==="bottom"&&ie.side==="bottom"&&(Te=ie.ticklen)),c.drawTicks(N,ie,{vals:_e,layer:U["radial-axis"],path:c.makeTickPath(ie,0,Oe),transFn:ue,crisp:!1}),c.drawGrid(N,ie,{vals:ze,layer:U["radial-grid"],path:pe,transFn:M.noop,crisp:!1}),c.drawLabels(N,ie,{vals:_e,layer:U["radial-axis"],transFn:ue,labelFns:c.makeLabelFns(ie,Te)})}var Ye=se.radialAxisAngle=se.vangles?F(Y(B(ne.angle),se.vangles)):ne.angle,be=a(W,K),Pe=be+e(-Ye);Z(U["radial-axis"],le&&(ne.showticklabels||ne.ticks),{transform:Pe}),Z(U["radial-grid"],le&&ne.showgrid,{transform:ye?"":be}),Z(U["radial-line"].select("line"),le&&ne.showline,{x1:ye?-q:$,y1:0,x2:q,y2:0,transform:Pe}).attr("stroke-width",ne.linewidth).call(n.stroke,ne.linecolor)},G.updateRadialAxisTitle=function(oe,re,se){if(!this.isSmith){var N=this,U=N.gd,q=N.radius,$=N.cx,W=N.cy,K=N.getRadial(re),ne=N.id+"title",ae=0;if(K.title){var ie=r.bBox(N.layers["radial-axis"].node()).height,le=K.title.font.size,ye=K.side;ae=ye==="top"?le:ye==="counterclockwise"?-(ie+le*.4):ie+le*.8}var ue=se!==void 0?se:N.radialAxisAngle,pe=B(ue),ge=Math.cos(pe),Te=Math.sin(pe),_e=$+q/2*ge+ae*Te,ze=W-q/2*Te+ae*ge;N.layers["radial-axis-title"]=m.draw(U,ne,{propContainer:K,propName:N.id+".radialaxis.title",placeholder:D(U,"Click to enter radial axis title"),attributes:{x:_e,y:ze,"text-anchor":"middle"},transform:{rotate:-ue}})}},G.updateAngularAxis=function(oe,re){var se=this,N=se.gd,U=se.layers,q=se.radius,$=se.innerRadius,W=se.cx,K=se.cy,ne=se.getAngular(re),ae=se.angularAxis,ie=se.isSmith;ie||(se.fillViewInitialKey("angularaxis.rotation",ne.rotation),ae.setGeometry(),ae.setScale());var le=ie?function(Qe){var Be=I(se,k([0,Qe.x]));return Math.atan2(Be[0]-W,Be[1]-K)-Math.PI/2}:function(Qe){return ae.t2g(Qe.x)};ae.type==="linear"&&ae.thetaunit==="radians"&&(ae.tick0=F(ae.tick0),ae.dtick=F(ae.dtick));var ye=function(Qe){return a(W+q*Math.cos(Qe),K-q*Math.sin(Qe))},ue=ie?function(Qe){var Be=I(se,k([0,Qe.x]));return a(Be[0],Be[1])}:function(Qe){return ye(le(Qe))},pe=ie?function(Qe){var Be=I(se,k([0,Qe.x])),Le=Math.atan2(Be[0]-W,Be[1]-K)-Math.PI/2;return a(Be[0],Be[1])+e(-F(Le))}:function(Qe){var Be=le(Qe);return ye(Be)+e(-F(Be))},ge=ie?function(Qe){return P(se,Qe.x,0,1/0)}:function(Qe){var Be=le(Qe),Le=Math.cos(Be),He=Math.sin(Be);return"M"+[W+$*Le,K-$*He]+"L"+[W+q*Le,K-q*He]},Te=c.makeLabelFns(ae,0),_e=Te.labelStandoff,ze={};ze.xFn=function(Qe){var Be=le(Qe);return Math.cos(Be)*_e},ze.yFn=function(Qe){var Be=le(Qe),Le=Math.sin(Be)>0?.2:1;return-Math.sin(Be)*(_e+Qe.fontSize*Le)+Math.abs(Math.cos(Be))*(Qe.fontSize*x)},ze.anchorFn=function(Qe){var Be=le(Qe),Le=Math.cos(Be);return Math.abs(Le)<.1?"middle":Le>0?"start":"end"},ze.heightFn=function(Qe,Be,Le){var He=le(Qe);return-.5*(1+Math.sin(He))*Le};var Oe=J(ne);se.angularTickLayout!==Oe&&(U["angular-axis"].selectAll("."+ae._id+"tick").remove(),se.angularTickLayout=Oe);var Ye=ie?[1/0].concat(ae.tickvals||[]).map(function(Qe){return c.tickText(ae,Qe,!0,!1)}):c.calcTicks(ae);ie&&(Ye[0].text="\u221E",Ye[0].fontSize*=1.75);var be;if(re.gridshape==="linear"?(be=Ye.map(le),M.angleDelta(be[0],be[1])<0&&(be=be.slice().reverse())):be=null,se.vangles=be,ae.type==="category"&&(Ye=Ye.filter(function(Qe){return M.isAngleInsideSector(le(Qe),se.sectorInRad)})),ae.visible){var Pe=ae.ticks==="inside"?-1:1,Ge=(ae.linewidth||1)/2;c.drawTicks(N,ae,{vals:Ye,layer:U["angular-axis"],path:"M"+Pe*Ge+",0h"+Pe*ae.ticklen,transFn:pe,crisp:!1}),c.drawGrid(N,ae,{vals:Ye,layer:U["angular-grid"],path:ge,transFn:M.noop,crisp:!1}),c.drawLabels(N,ae,{vals:Ye,layer:U["angular-axis"],repositionOnUpdate:!0,transFn:ue,labelFns:ze})}Z(U["angular-line"].select("path"),ne.showline,{d:se.pathSubplot(),transform:a(W,K)}).attr("stroke-width",ne.linewidth).call(n.stroke,ne.linecolor)},G.updateFx=function(oe,re){if(!this.gd._context.staticPlot){var se=!this.isSmith;se&&(this.updateAngularDrag(oe),this.updateRadialDrag(oe,re,0),this.updateRadialDrag(oe,re,1)),this.updateHoverAndMainDrag(oe)}},G.updateHoverAndMainDrag=function(oe){var re=this,se=re.isSmith,N=re.gd,U=re.layers,q=oe._zoomlayer,$=l.MINZOOM,W=l.OFFEDGE,K=re.radius,ne=re.innerRadius,ae=re.cx,ie=re.cy,le=re.cxx,ye=re.cyy,ue=re.sectorInRad,pe=re.vangles,ge=re.radialAxis,Te=L.clampTiny,_e=L.findXYatLength,ze=L.findEnclosingVertexAngles,Oe=l.cornerHalfWidth,Ye=l.cornerLen/2,be,Pe,Ge=p.makeDragger(U,"path","maindrag",oe.dragmode===!1?"none":"crosshair");w.select(Ge).attr("d",re.pathSubplot()).attr("transform",a(ae,ie)),Ge.onmousemove=function(qt){h.hover(N,qt,re.id),N._fullLayout._lasthover=Ge,N._fullLayout._hoversubplot=re.id},Ge.onmouseout=function(qt){N._dragging||g.unhover(N,qt)};var Qe={element:Ge,gd:N,subplot:re.id,plotinfo:{id:re.id,xaxis:re.xaxis,yaxis:re.yaxis},xaxes:[re.xaxis],yaxes:[re.yaxis]},Be,Le,He,vt,Rt,rr,Lt,Ft,Gt;function Dt(qt,Yt){return Math.sqrt(qt*qt+Yt*Yt)}function kt(qt,Yt){return Dt(qt-le,Yt-ye)}function Ue(qt,Yt){return Math.atan2(ye-Yt,qt-le)}function qe(qt,Yt){return[qt*Math.cos(Yt),qt*Math.sin(-Yt)]}function Ve(qt,Yt){if(qt===0)return re.pathSector(2*Oe);var fr=Ye/qt,Yr=Yt-fr,hn=Yt+fr,Qr=Math.max(0,Math.min(qt,K)),at=Qr-Oe,Jt=Qr+Oe;return"M"+qe(at,Yr)+"A"+[at,at]+" 0,0,0 "+qe(at,hn)+"L"+qe(Jt,hn)+"A"+[Jt,Jt]+" 0,0,1 "+qe(Jt,Yr)+"Z"}function Ae(qt,Yt,fr){if(qt===0)return re.pathSector(2*Oe);var Yr=qe(qt,Yt),hn=qe(qt,fr),Qr=Te((Yr[0]+hn[0])/2),at=Te((Yr[1]+hn[1])/2),Jt,Zt;if(Qr&&at){var Ut=at/Qr,_r=-1/Ut,rt=_e(Oe,Ut,Qr,at);Jt=_e(Ye,_r,rt[0][0],rt[0][1]),Zt=_e(Ye,_r,rt[1][0],rt[1][1])}else{var Ke,st;at?(Ke=Ye,st=Oe):(Ke=Oe,st=Ye),Jt=[[Qr-Ke,at-st],[Qr+Ke,at-st]],Zt=[[Qr-Ke,at+st],[Qr+Ke,at+st]]}return"M"+Jt.join("L")+"L"+Zt.reverse().join("L")+"Z"}function Ne(){He=null,vt=null,Rt=re.pathSubplot(),rr=!1;var qt=N._fullLayout[re.id];Lt=v(qt.bgcolor).getLuminance(),Ft=p.makeZoombox(q,Lt,ae,ie,Rt),Ft.attr("fill-rule","evenodd"),Gt=p.makeCorners(q,ae,ie),s(N)}function Xe(qt,Yt){return Yt=Math.max(Math.min(Yt,K),ne),qt<W?qt=0:K-qt<W?qt=K:Yt<W?Yt=0:K-Yt<W&&(Yt=K),Math.abs(Yt-qt)>$?(qt<Yt?(He=qt,vt=Yt):(He=Yt,vt=qt),!0):(He=null,vt=null,!1)}function Je(qt,Yt){qt=qt||Rt,Yt=Yt||"M0,0Z",Ft.attr("d",qt),Gt.attr("d",Yt),p.transitionZoombox(Ft,Gt,rr,Lt),rr=!0;var fr={};Nt(fr),N.emit("plotly_relayouting",fr)}function _t(qt,Yt){qt=qt*be,Yt=Yt*Pe;var fr=Be+qt,Yr=Le+Yt,hn=kt(Be,Le),Qr=Math.min(kt(fr,Yr),K),at=Ue(Be,Le),Jt,Zt;Xe(hn,Qr)&&(Jt=Rt+re.pathSector(vt),He&&(Jt+=re.pathSector(He)),Zt=Ve(He,at)+Ve(vt,at)),Je(Jt,Zt)}function mt(qt,Yt,fr,Yr){var hn=L.findIntersectionXY(fr,Yr,fr,[qt-le,ye-Yt]);return Dt(hn[0],hn[1])}function Ot(qt,Yt){var fr=Be+qt,Yr=Le+Yt,hn=Ue(Be,Le),Qr=Ue(fr,Yr),at=ze(hn,pe),Jt=ze(Qr,pe),Zt=mt(Be,Le,at[0],at[1]),Ut=Math.min(mt(fr,Yr,Jt[0],Jt[1]),K),_r,rt;Xe(Zt,Ut)&&(_r=Rt+re.pathSector(vt),He&&(_r+=re.pathSector(He)),rt=[Ae(He,at[0],at[1]),Ae(vt,at[0],at[1])].join(" ")),Je(_r,rt)}function Kt(){if(p.removeZoombox(N),!(He===null||vt===null)){var qt={};Nt(qt),p.showDoubleClickNotifier(N),S.call("_guiRelayout",N,qt)}}function Nt(qt){var Yt=ge._rl,fr=(Yt[1]-Yt[0])/(1-ne/K)/K,Yr=[Yt[0]+(He-ne)*fr,Yt[0]+(vt-ne)*fr];qt[re.id+".radialaxis.range"]=Yr}function Wt(qt,Yt){var fr=N._fullLayout.clickmode;if(p.removeZoombox(N),qt===2){var Yr={};for(var hn in re.viewInitial)Yr[re.id+"."+hn]=re.viewInitial[hn];N.emit("plotly_doubleclick",null),S.call("_guiRelayout",N,Yr)}fr.indexOf("select")>-1&&qt===1&&_(Yt,N,[re.xaxis],[re.yaxis],re.id,Qe),fr.indexOf("event")>-1&&h.click(N,Yt,re.id)}Qe.prepFn=function(qt,Yt,fr){var Yr=N._fullLayout.dragmode,hn=Ge.getBoundingClientRect();N._fullLayout._calcInverseTransform(N);var Qr=N._fullLayout._invTransform;be=N._fullLayout._invScaleX,Pe=N._fullLayout._invScaleY;var at=M.apply3DTransform(Qr)(Yt-hn.left,fr-hn.top);if(Be=at[0],Le=at[1],pe){var Jt=L.findPolygonOffset(K,ue[0],ue[1],pe);Be+=le+Jt[0],Le+=ye+Jt[1]}switch(Yr){case"zoom":Qe.clickFn=Wt,se||(pe?Qe.moveFn=Ot:Qe.moveFn=_t,Qe.doneFn=Kt,Ne());break;case"select":case"lasso":u(qt,Yt,fr,Qe,Yr);break}},g.init(Qe)},G.updateRadialDrag=function(oe,re,se){var N=this,U=N.gd,q=N.layers,$=N.radius,W=N.innerRadius,K=N.cx,ne=N.cy,ae=N.radialAxis,ie=l.radialDragBoxSize,le=ie/2;if(!ae.visible)return;var ye=B(N.radialAxisAngle),ue=ae._rl,pe=ue[0],ge=ue[1],Te=ue[se],_e=.75*(ue[1]-ue[0])/(1-N.getHole(re))/$,ze,Oe,Ye;se?(ze=K+($+le)*Math.cos(ye),Oe=ne-($+le)*Math.sin(ye),Ye="radialdrag"):(ze=K+(W-le)*Math.cos(ye),Oe=ne-(W-le)*Math.sin(ye),Ye="radialdrag-inner");var be=p.makeRectDragger(q,Ye,"crosshair",-le,-le,ie,ie),Pe={element:be,gd:U};oe.dragmode===!1&&(Pe.dragmode=!1),Z(w.select(be),ae.visible&&W<$,{transform:a(ze,Oe)});var Ge,Qe,Be;function Le(Lt,Ft){if(Ge)Ge(Lt,Ft);else{var Gt=[Lt,-Ft],Dt=[Math.cos(ye),Math.sin(ye)],kt=Math.abs(M.dot(Gt,Dt)/Math.sqrt(M.dot(Gt,Gt)));isNaN(kt)||(Ge=kt<.5?Rt:rr)}var Ue={};He(Ue),U.emit("plotly_relayouting",Ue)}function He(Lt){Qe!==null?Lt[N.id+".radialaxis.angle"]=Qe:Be!==null&&(Lt[N.id+".radialaxis.range["+se+"]"]=Be)}function vt(){Qe!==null?S.call("_guiRelayout",U,N.id+".radialaxis.angle",Qe):Be!==null&&S.call("_guiRelayout",U,N.id+".radialaxis.range["+se+"]",Be)}function Rt(Lt,Ft){if(se!==0){var Gt=ze+Lt,Dt=Oe+Ft;Qe=Math.atan2(ne-Dt,Gt-K),N.vangles&&(Qe=Y(Qe,N.vangles)),Qe=F(Qe);var kt=a(K,ne)+e(-Qe);q["radial-axis"].attr("transform",kt),q["radial-line"].select("line").attr("transform",kt);var Ue=N.gd._fullLayout,qe=Ue[N.id];N.updateRadialAxisTitle(Ue,qe,Qe)}}function rr(Lt,Ft){var Gt=M.dot([Lt,-Ft],[Math.cos(ye),Math.sin(ye)]);if(Be=Te-_e*Gt,_e>0!=(se?Be>pe:Be<ge)){Be=null;return}var Dt=U._fullLayout,kt=Dt[N.id];ae.range[se]=Be,ae._rl[se]=Be,N.updateRadialAxis(Dt,kt),N.xaxis.setRange(),N.xaxis.setScale(),N.yaxis.setRange(),N.yaxis.setScale();var Ue=!1;for(var qe in N.traceHash){var Ve=N.traceHash[qe],Ae=M.filterVisible(Ve),Ne=Ve[0][0].trace._module;Ne.plot(U,N,Ae,kt),S.traceIs(qe,"gl")&&Ae.length&&(Ue=!0)}Ue&&(b(U),f(U))}Pe.prepFn=function(){Ge=null,Qe=null,Be=null,Pe.moveFn=Le,Pe.doneFn=vt,s(U)},Pe.clampFn=function(Lt,Ft){return Math.sqrt(Lt*Lt+Ft*Ft)<l.MINDRAG&&(Lt=0,Ft=0),[Lt,Ft]},g.init(Pe)},G.updateAngularDrag=function(oe){var re=this,se=re.gd,N=re.layers,U=re.radius,q=re.angularAxis,$=re.cx,W=re.cy,K=re.cxx,ne=re.cyy,ae=l.angularDragBoxSize,ie=p.makeDragger(N,"path","angulardrag",oe.dragmode===!1?"none":"move"),le={element:ie,gd:se};oe.dragmode===!1?le.dragmode=!1:w.select(ie).attr("d",re.pathAnnulus(U,U+ae)).attr("transform",a($,W)).call(A,"move");function ye(Be,Le){return Math.atan2(ne+ae-Le,Be-K-ae)}var ue=N.frontplot.select(".scatterlayer").selectAll(".trace"),pe=ue.selectAll(".point"),ge=ue.selectAll(".textpoint"),Te,_e,ze,Oe,Ye,be;function Pe(Be,Le){var He=re.gd._fullLayout,vt=He[re.id],Rt=Te+Be*oe._invScaleX,rr=_e+Le*oe._invScaleY,Lt=ye(Rt,rr),Ft=F(Lt-be);if(Oe=ze+Ft,N.frontplot.attr("transform",a(re.xOffset2,re.yOffset2)+e([-Ft,K,ne])),re.vangles){Ye=re.radialAxisAngle+Ft;var Gt=a($,W)+e(-Ft),Dt=a($,W)+e(-Ye);N.bg.attr("transform",Gt),N["radial-grid"].attr("transform",Gt),N["radial-axis"].attr("transform",Dt),N["radial-line"].select("line").attr("transform",Dt),re.updateRadialAxisTitle(He,vt,Ye)}else re.clipPaths.forTraces.select("path").attr("transform",a(K,ne)+e(Ft));pe.each(function(){var Xe=w.select(this),Je=r.getTranslate(Xe);Xe.attr("transform",a(Je.x,Je.y)+e([Ft]))}),ge.each(function(){var Xe=w.select(this),Je=Xe.select("text"),_t=r.getTranslate(Xe);Xe.attr("transform",e([Ft,Je.attr("x"),Je.attr("y")])+a(_t.x,_t.y))}),q.rotation=M.modHalf(Oe,360),re.updateAngularAxis(He,vt),re._hasClipOnAxisFalse&&!M.isFullCircle(re.sectorInRad)&&ue.call(r.hideOutsideRangePoints,re);var kt=!1;for(var Ue in re.traceHash)if(S.traceIs(Ue,"gl")){var qe=re.traceHash[Ue],Ve=M.filterVisible(qe),Ae=qe[0][0].trace._module;Ae.plot(se,re,Ve,vt),Ve.length&&(kt=!0)}kt&&(b(se),f(se));var Ne={};Ge(Ne),se.emit("plotly_relayouting",Ne)}function Ge(Be){Be[re.id+".angularaxis.rotation"]=Oe,re.vangles&&(Be[re.id+".radialaxis.angle"]=Ye)}function Qe(){ge.select("text").attr("transform",null);var Be={};Ge(Be),S.call("_guiRelayout",se,Be)}le.prepFn=function(Be,Le,He){var vt=oe[re.id];ze=vt.angularaxis.rotation;var Rt=ie.getBoundingClientRect();Te=Le-Rt.left,_e=He-Rt.top,se._fullLayout._calcInverseTransform(se);var rr=M.apply3DTransform(oe._invTransform)(Te,_e);Te=rr[0],_e=rr[1],be=ye(Te,_e),le.moveFn=Pe,le.doneFn=Qe,s(se)},re.vangles&&!M.isFullCircle(re.sectorInRad)&&(le.prepFn=M.noop,A(w.select(ie),null)),g.init(le)},G.isPtInside=function(oe){if(this.isSmith)return!0;var re=this.sectorInRad,se=this.vangles,N=this.angularAxis.c2g(oe.theta),U=this.radialAxis,q=U.c2l(oe.r),$=U._rl,W=se?L.isPtInsidePolygon:M.isPtInsideSector;return W(q,N,$,re,se)},G.pathArc=function(oe){var re=this.sectorInRad,se=this.vangles,N=se?L.pathPolygon:M.pathArc;return N(oe,re[0],re[1],se)},G.pathSector=function(oe){var re=this.sectorInRad,se=this.vangles,N=se?L.pathPolygon:M.pathSector;return N(oe,re[0],re[1],se)},G.pathAnnulus=function(oe,re){var se=this.sectorInRad,N=this.vangles,U=N?L.pathPolygonAnnulus:M.pathAnnulus;return U(oe,re,se[0],se[1],N)},G.pathSubplot=function(){var oe=this.innerRadius,re=this.radius;return oe?this.pathAnnulus(oe,re):this.pathSector(re)},G.fillViewInitialKey=function(oe,re){oe in this.viewInitial||(this.viewInitial[oe]=re)};function J(oe){var re=oe.ticks+String(oe.ticklen)+String(oe.showticklabels);return"side"in oe&&(re+=oe.side),re}function X(oe){var re=oe[0],se=oe[1],N=se-re,U=R(re,360),q=U+N,$=Math.cos(B(U)),W=Math.sin(B(U)),K=Math.cos(B(q)),ne=Math.sin(B(q)),ae,ie,le,ye;return U<=90&&q>=90||U>90&&q>=450?ye=1:W<=0&&ne<=0?ye=0:ye=Math.max(W,ne),U<=180&&q>=180||U>180&&q>=540?ae=-1:$>=0&&K>=0?ae=0:ae=Math.min($,K),U<=270&&q>=270||U>270&&q>=630?ie=-1:W>=0&&ne>=0?ie=0:ie=Math.min(W,ne),q>=360?le=1:$<=0&&K<=0?le=0:le=Math.max($,K),[ae,ie,le,ye]}function Y(oe,re){var se=function(U){return M.angleDist(oe,U)},N=M.findIndexOfMin(re,se);return re[N]}function Z(oe,re,se){return re?(oe.attr("display",null),oe.attr(se)):oe&&oe.attr("display","none"),oe}},{"../../components/color":367,"../../components/dragelement":386,"../../components/drawing":389,"../../components/fx":407,"../../components/selections":455,"../../components/titles":476,"../../constants/alignment":483,"../../lib":515,"../../lib/clear_gl_canvases":499,"../../lib/setcursor":536,"../../plot_api/subroutines":556,"../../plots/cartesian/axes":566,"../../registry":647,"../cartesian/autorange":565,"../cartesian/dragbox":575,"../cartesian/set_convert":585,"../plots":628,"../smith/helpers":637,"./constants":629,"./helpers":630,"./set_convert":635,"@plotly/d3":58,tinycolor2:313}],635:[function(d,ee,te){var w=d("../../lib"),v=d("../cartesian/set_convert"),S=w.deg2rad,M=w.rad2deg;ee.exports=function(c,o,i){switch(v(c,i),c._id){case"x":case"radialaxis":e(c,o);break;case"angularaxis":r(c,o);break}};function e(t,c){var o=c._subplot;t.setGeometry=function(){var i=t._rl[0],y=t._rl[1],p=o.innerRadius,g=(o.radius-p)/(y-i),h=p/g,m=i>y?function(u){return u<=0}:function(u){return u>=0};t.c2g=function(u){var _=t.c2l(u)-i;return(m(_)?_:0)+h},t.g2c=function(u){return t.l2c(u+i-h)},t.g2p=function(u){return u*g},t.c2p=function(u){return t.g2p(t.c2g(u))}}}function a(t,c){return c==="degrees"?S(t):t}function n(t,c){return c==="degrees"?M(t):t}function r(t,c){var o=t.type;if(o==="linear"){var i=t.d2c,y=t.c2d;t.d2c=function(p,g){return a(i(p),g)},t.c2d=function(p,g){return y(n(p,g))}}t.makeCalcdata=function(p,g){var h=p[g],m=p._length,u,_,s=function(l){return t.d2c(l,p.thetaunit)};if(h){if(w.isTypedArray(h)&&o==="linear"){if(m===h.length)return h;if(h.subarray)return h.subarray(0,m)}for(u=new Array(m),_=0;_<m;_++)u[_]=s(h[_])}else{var A=g+"0",b="d"+g,f=A in p?s(p[A]):0,x=p[b]?s(p[b]):(t.period||2*Math.PI)/m;for(u=new Array(m),_=0;_<m;_++)u[_]=f+_*x}return u},t.setGeometry=function(){var p=c.sector,g=p.map(S),h={clockwise:-1,counterclockwise:1}[t.direction],m=S(t.rotation),u=function(L){return h*L+m},_=function(L){return(L-m)/h},s,A,b,f;switch(o){case"linear":A=s=w.identity,f=S,b=M,t.range=w.isFullCircle(g)?[p[0],p[0]+360]:g.map(_).map(M);break;case"category":var x=t._categories.length,l=t.period?Math.max(t.period,x):x;l===0&&(l=1),A=f=function(L){return L*2*Math.PI/l},s=b=function(L){return L*l/Math.PI/2},t.range=[0,l];break}t.c2g=function(L){return u(A(L))},t.g2c=function(L){return s(_(L))},t.t2g=function(L){return u(f(L))},t.g2t=function(L){return b(_(L))}}}},{"../../lib":515,"../cartesian/set_convert":585}],636:[function(d,ee,te){ee.exports={attr:"subplot",name:"smith",axisNames:["realaxis","imaginaryaxis"],axisName2dataArray:{imaginaryaxis:"imag",realaxis:"real"}}},{}],637:[function(d,ee,te){function w(n){return n<0?-1:n>0?1:0}function v(n){var r=n[0],t=n[1];if(!isFinite(r)||!isFinite(t))return[1,0];var c=(r+1)*(r+1)+t*t;return[(r*r+t*t-1)/c,2*t/c]}function S(n,r){var t=r[0],c=r[1];return[t*n.radius+n.cx,-c*n.radius+n.cy]}function M(n,r){return r*n.radius}function e(n,r,t,c){var o=S(n,v([t,r])),i=o[0],y=o[1],p=S(n,v([c,r])),g=p[0],h=p[1];if(r===0)return["M"+i+","+y,"L"+g+","+h].join(" ");var m=M(n,1/Math.abs(r));return["M"+i+","+y,"A"+m+","+m+" 0 0,"+(r<0?1:0)+" "+g+","+h].join(" ")}function a(n,r,t,c){var o=M(n,1/(r+1)),i=S(n,v([r,t])),y=i[0],p=i[1],g=S(n,v([r,c])),h=g[0],m=g[1];if(w(t)!==w(c)){var u=S(n,v([r,0])),_=u[0],s=u[1];return["M"+y+","+p,"A"+o+","+o+" 0 0,"+(0<t?0:1)+" "+_+","+s,"A"+o+","+o+" 0 0,"+(c<0?0:1)+h+","+m].join(" ")}return["M"+y+","+p,"A"+o+","+o+" 0 0,"+(c<t?0:1)+" "+h+","+m].join(" ")}ee.exports={smith:v,reactanceArc:e,resistanceArc:a,smithTransform:S}},{}],638:[function(d,ee,te){var w=d("../get_data").getSubplotCalcData,v=d("../../lib").counterRegex,S=d("../polar/polar"),M=d("./constants"),e=M.attr,a=M.name,n=v(a),r={};r[e]={valType:"subplotid",dflt:a,editType:"calc"};function t(o){for(var i=o._fullLayout,y=o.calcdata,p=i._subplots[a],g=0;g<p.length;g++){var h=p[g],m=w(y,a,h),u=i[h]._subplot;u||(u=S(o,h,!0),i[h]._subplot=u),u.plot(m,i,o._promises)}}function c(o,i,y,p){for(var g=p._subplots[a]||[],h=0;h<g.length;h++){var m=g[h],u=p[m]._subplot;if(!i[m]&&!!u){u.framework.remove();for(var _ in u.clipPaths)u.clipPaths[_].remove()}}}ee.exports={attr:e,name:a,idRoot:a,idRegex:n,attrRegex:n,attributes:r,layoutAttributes:d("./layout_attributes"),supplyLayoutDefaults:d("./layout_defaults"),plot:t,clean:c,toSVG:d("../cartesian").toSVG}},{"../../lib":515,"../cartesian":578,"../get_data":602,"../polar/polar":634,"./constants":636,"./layout_attributes":639,"./layout_defaults":640}],639:[function(d,ee,te){var w=d("../../components/color/attributes"),v=d("../cartesian/layout_attributes"),S=d("../domain").attributes,M=d("../../lib").extendFlat,e=d("../../plot_api/edit_types").overrideAll,a=e({color:v.color,showline:M({},v.showline,{dflt:!0}),linecolor:v.linecolor,linewidth:v.linewidth,showgrid:M({},v.showgrid,{dflt:!0}),gridcolor:v.gridcolor,gridwidth:v.gridwidth,griddash:v.griddash},"plot","from-root"),n=e({ticklen:v.ticklen,tickwidth:M({},v.tickwidth,{dflt:2}),tickcolor:v.tickcolor,showticklabels:v.showticklabels,showtickprefix:v.showtickprefix,tickprefix:v.tickprefix,showticksuffix:v.showticksuffix,ticksuffix:v.ticksuffix,tickfont:v.tickfont,tickformat:v.tickformat,hoverformat:v.hoverformat,layer:v.layer},"plot","from-root"),r=M({visible:M({},v.visible,{dflt:!0}),tickvals:{dflt:[.2,.5,1,2,5],valType:"data_array",editType:"plot"},tickangle:M({},v.tickangle,{dflt:90}),ticks:{valType:"enumerated",values:["top","bottom",""],editType:"ticks"},side:{valType:"enumerated",values:["top","bottom"],dflt:"top",editType:"plot"},editType:"calc"},a,n),t=M({visible:M({},v.visible,{dflt:!0}),tickvals:{valType:"data_array",editType:"plot"},ticks:v.ticks,editType:"calc"},a,n);ee.exports={domain:S({name:"smith",editType:"plot"}),bgcolor:{valType:"color",editType:"plot",dflt:w.background},realaxis:r,imaginaryaxis:t,editType:"calc"}},{"../../components/color/attributes":366,"../../lib":515,"../../plot_api/edit_types":548,"../cartesian/layout_attributes":579,"../domain":593}],640:[function(d,ee,te){var w=d("../../lib"),v=d("../../components/color"),S=d("../../plot_api/plot_template"),M=d("../subplot_defaults"),e=d("../get_data").getSubplotData,a=d("../cartesian/prefix_suffix_defaults"),n=d("../cartesian/tick_label_defaults"),r=d("../cartesian/line_grid_defaults"),t=d("../cartesian/set_convert"),c=d("./layout_attributes"),o=d("./constants"),i=o.axisNames,y=g(function(h){return h.slice().reverse().map(function(m){return-m}).concat([0]).concat(h)},String);function p(h,m,u,_){var s=u("bgcolor");_.bgColor=v.combine(s,_.paper_bgcolor);var A=e(_.fullData,o.name,_.id),b=_.layoutOut,f;function x(G,J){return u(f+"."+G,J)}for(var l=0;l<i.length;l++){f=i[l],w.isPlainObject(h[f])||(h[f]={});var L=h[f],T=S.newContainer(m,f);T._id=T._name=f,T._attr=_.id+"."+f,T._traceIndices=A.map(function(G){return G._expandedIndex});var k=x("visible");if(T.type="linear",t(T,b),a(L,T,x,T.type),k){var P=f==="realaxis";if(P&&x("side"),P)x("tickvals");else{var z=y(m.realaxis.tickvals||c.realaxis.tickvals.dflt);x("tickvals",z)}var I,D,R,B,F=_.font||{};k&&(I=x("color"),D=I===L.color?I:F.color,R=F.size,B=F.family),n(L,T,x,T.type,{noTicklabelstep:!0,noAng:!P,noExp:!0,font:{color:D,size:R,family:B}}),w.coerce2(h,m,c,f+".ticklen"),w.coerce2(h,m,c,f+".tickwidth"),w.coerce2(h,m,c,f+".tickcolor",m.color);var H=x("ticks");H||(delete m[f].ticklen,delete m[f].tickwidth,delete m[f].tickcolor),r(L,T,x,{dfltColor:I,bgColor:_.bgColor,blend:60,showLine:!0,showGrid:!0,noZeroLine:!0,attributes:c[f]}),x("layer")}x("hoverformat"),delete T.type,T._input=L}}ee.exports=function(m,u,_){M(m,u,_,{noUirevision:!0,type:o.name,attributes:c,handleDefaults:p,font:u.font,paper_bgcolor:u.paper_bgcolor,fullData:_,layoutOut:u})};function g(h,m){var u={};return function(_){var s=m?m(_):_;if(s in u)return u[s];var A=h(_);return u[s]=A,A}}},{"../../components/color":367,"../../lib":515,"../../plot_api/plot_template":555,"../cartesian/line_grid_defaults":581,"../cartesian/prefix_suffix_defaults":583,"../cartesian/set_convert":585,"../cartesian/tick_label_defaults":587,"../get_data":602,"../subplot_defaults":641,"./constants":636,"./layout_attributes":639}],641:[function(d,ee,te){var w=d("../lib"),v=d("../plot_api/plot_template"),S=d("./domain").defaults;ee.exports=function(e,a,n,r){var t=r.type,c=r.attributes,o=r.handleDefaults,i=r.partition||"x",y=a._subplots[t],p=y.length,g=p&&y[0].replace(/\d+$/,""),h,m;function u(b,f){return w.coerce(h,m,c,b,f)}for(var _=0;_<p;_++){var s=y[_];e[s]?h=e[s]:h=e[s]={},m=v.newContainer(a,s,g),r.noUirevision||u("uirevision",a.uirevision);var A={};A[i]=[_/p,(_+1)/p],S(m,a,u,A),r.id=s,o(h,m,u,r)}}},{"../lib":515,"../plot_api/plot_template":555,"./domain":593}],642:[function(d,ee,te){var w=d("../constants/docs");w.FORMAT_LINK,w.DATE_FORMAT_LINK;function v(S){var M=S.description?" "+S.description:"",e=S.keys||[];if(e.length>0){for(var a=[],n=0;n<e.length;n++)a[n]="`"+e[n]+"`";M=M+"Finally, the template string has access to ",e.length===1?M="variable "+a[0]:M="variables "+a.slice(0,-1).join(", ")+" and "+a.slice(-1)+"."}return M}te.hovertemplateAttrs=function(S,M){S=S||{},M=M||{},v(M);var e={valType:"string",dflt:"",editType:S.editType||"none"};return S.arrayOk!==!1&&(e.arrayOk=!0),e},te.texttemplateAttrs=function(S,M){S=S||{},M=M||{},v(M);var e={valType:"string",dflt:"",editType:S.editType||"calc"};return S.arrayOk!==!1&&(e.arrayOk=!0),e}},{"../constants/docs":486}],643:[function(d,ee,te){var w=d("./ternary"),v=d("../../plots/get_data").getSubplotCalcData,S=d("../../lib").counterRegex,M="ternary";te.name=M;var e=te.attr="subplot";te.idRoot=M,te.idRegex=te.attrRegex=S(M);var a=te.attributes={};a[e]={valType:"subplotid",dflt:"ternary",editType:"calc"},te.layoutAttributes=d("./layout_attributes"),te.supplyLayoutDefaults=d("./layout_defaults"),te.plot=function(r){for(var t=r._fullLayout,c=r.calcdata,o=t._subplots[M],i=0;i<o.length;i++){var y=o[i],p=v(c,M,y),g=t[y]._subplot;g||(g=new w({id:y,graphDiv:r,container:t._ternarylayer.node()},t),t[y]._subplot=g),g.plot(p,t,r._promises)}},te.clean=function(n,r,t,c){for(var o=c._subplots[M]||[],i=0;i<o.length;i++){var y=o[i],p=c[y]._subplot;!r[y]&&!!p&&(p.plotContainer.remove(),p.clipDef.remove(),p.clipDefRelative.remove(),p.layers["a-title"].remove(),p.layers["b-title"].remove(),p.layers["c-title"].remove())}}},{"../../lib":515,"../../plots/get_data":602,"./layout_attributes":644,"./layout_defaults":645,"./ternary":646}],644:[function(d,ee,te){var w=d("../../components/color/attributes"),v=d("../domain").attributes,S=d("../cartesian/layout_attributes"),M=d("../../plot_api/edit_types").overrideAll,e=d("../../lib/extend").extendFlat,a={title:{text:S.title.text,font:S.title.font},color:S.color,tickmode:S.tickmode,nticks:e({},S.nticks,{dflt:6,min:1}),tick0:S.tick0,dtick:S.dtick,tickvals:S.tickvals,ticktext:S.ticktext,ticks:S.ticks,ticklen:S.ticklen,tickwidth:S.tickwidth,tickcolor:S.tickcolor,ticklabelstep:S.ticklabelstep,showticklabels:S.showticklabels,showtickprefix:S.showtickprefix,tickprefix:S.tickprefix,showticksuffix:S.showticksuffix,ticksuffix:S.ticksuffix,showexponent:S.showexponent,exponentformat:S.exponentformat,minexponent:S.minexponent,separatethousands:S.separatethousands,tickfont:S.tickfont,tickangle:S.tickangle,tickformat:S.tickformat,tickformatstops:S.tickformatstops,hoverformat:S.hoverformat,showline:e({},S.showline,{dflt:!0}),linecolor:S.linecolor,linewidth:S.linewidth,showgrid:e({},S.showgrid,{dflt:!0}),gridcolor:S.gridcolor,gridwidth:S.gridwidth,griddash:S.griddash,layer:S.layer,min:{valType:"number",dflt:0,min:0},_deprecated:{title:S._deprecated.title,titlefont:S._deprecated.titlefont}},n=ee.exports=M({domain:v({name:"ternary"}),bgcolor:{valType:"color",dflt:w.background},sum:{valType:"number",dflt:1,min:0},aaxis:a,baxis:a,caxis:a},"plot","from-root");n.uirevision={valType:"any",editType:"none"},n.aaxis.uirevision=n.baxis.uirevision=n.caxis.uirevision={valType:"any",editType:"none"}},{"../../components/color/attributes":366,"../../lib/extend":505,"../../plot_api/edit_types":548,"../cartesian/layout_attributes":579,"../domain":593}],645:[function(d,ee,te){var w=d("../../components/color"),v=d("../../plot_api/plot_template"),S=d("../../lib"),M=d("../subplot_defaults"),e=d("../cartesian/tick_label_defaults"),a=d("../cartesian/prefix_suffix_defaults"),n=d("../cartesian/tick_mark_defaults"),r=d("../cartesian/tick_value_defaults"),t=d("../cartesian/line_grid_defaults"),c=d("./layout_attributes"),o=["aaxis","baxis","caxis"];ee.exports=function(g,h,m){M(g,h,m,{type:"ternary",attributes:c,handleDefaults:i,font:h.font,paper_bgcolor:h.paper_bgcolor})};function i(p,g,h,m){var u=h("bgcolor"),_=h("sum");m.bgColor=w.combine(u,m.paper_bgcolor);for(var s,A,b,f=0;f<o.length;f++)s=o[f],A=p[s]||{},b=v.newContainer(g,s),b._name=s,y(A,b,m,g);var x=g.aaxis,l=g.baxis,L=g.caxis;x.min+l.min+L.min>=_&&(x.min=0,l.min=0,L.min=0,p.aaxis&&delete p.aaxis.min,p.baxis&&delete p.baxis.min,p.caxis&&delete p.caxis.min)}function y(p,g,h,m){var u=c[g._name];function _(T,k){return S.coerce(p,g,u,T,k)}_("uirevision",m.uirevision),g.type="linear";var s=_("color"),A=s!==u.color.dflt?s:h.font.color,b=g._name,f=b.charAt(0).toUpperCase(),x="Component "+f,l=_("title.text",x);g._hovertitle=l===x?l:f,S.coerceFont(_,"title.font",{family:h.font.family,size:S.bigFont(h.font.size),color:A}),_("min"),r(p,g,_,"linear"),a(p,g,_,"linear"),e(p,g,_,"linear"),n(p,g,_,{outerTicks:!0});var L=_("showticklabels");L&&(S.coerceFont(_,"tickfont",{family:h.font.family,size:h.font.size,color:A}),_("tickangle"),_("tickformat")),t(p,g,_,{dfltColor:s,bgColor:h.bgColor,blend:60,showLine:!0,showGrid:!0,noZeroLine:!0,attributes:u}),_("hoverformat"),_("layer")}},{"../../components/color":367,"../../lib":515,"../../plot_api/plot_template":555,"../cartesian/line_grid_defaults":581,"../cartesian/prefix_suffix_defaults":583,"../cartesian/tick_label_defaults":587,"../cartesian/tick_mark_defaults":588,"../cartesian/tick_value_defaults":589,"../subplot_defaults":641,"./layout_attributes":644}],646:[function(d,ee,te){var w=d("@plotly/d3"),v=d("tinycolor2"),S=d("../../registry"),M=d("../../lib"),e=M.strTranslate,a=M._,n=d("../../components/color"),r=d("../../components/drawing"),t=d("../cartesian/set_convert"),c=d("../../lib/extend").extendFlat,o=d("../plots"),i=d("../cartesian/axes"),y=d("../../components/dragelement"),p=d("../../components/fx"),g=d("../../components/dragelement/helpers"),h=g.freeMode,m=g.rectMode,u=d("../../components/titles"),_=d("../../components/selections").prepSelect,s=d("../../components/selections").selectOnClick,A=d("../../components/selections").clearOutline,b=d("../../components/selections").clearSelectionsCache,f=d("../cartesian/constants");function x(F,H){this.id=F.id,this.graphDiv=F.graphDiv,this.init(H),this.makeFramework(H),this.aTickLayout=null,this.bTickLayout=null,this.cTickLayout=null}ee.exports=x;var l=x.prototype;l.init=function(F){this.container=F._ternarylayer,this.defs=F._defs,this.layoutId=F._uid,this.traceHash={},this.layers={}},l.plot=function(F,H){var G=this,J=H[G.id],X=H._size;G._hasClipOnAxisFalse=!1;for(var Y=0;Y<F.length;Y++){var Z=F[Y][0].trace;if(Z.cliponaxis===!1){G._hasClipOnAxisFalse=!0;break}}G.updateLayers(J),G.adjustLayout(J,X),o.generalUpdatePerTraceModule(G.graphDiv,G,F,J),G.layers.plotbg.select("path").call(n.fill,J.bgcolor)},l.makeFramework=function(F){var H=this,G=H.graphDiv,J=F[H.id],X=H.clipId="clip"+H.layoutId+H.id,Y=H.clipIdRelative="clip-relative"+H.layoutId+H.id;H.clipDef=M.ensureSingleById(F._clips,"clipPath",X,function(Z){Z.append("path").attr("d","M0,0Z")}),H.clipDefRelative=M.ensureSingleById(F._clips,"clipPath",Y,function(Z){Z.append("path").attr("d","M0,0Z")}),H.plotContainer=M.ensureSingle(H.container,"g",H.id),H.updateLayers(J),r.setClipUrl(H.layers.backplot,X,G),r.setClipUrl(H.layers.grids,X,G)},l.updateLayers=function(F){var H=this,G=H.layers,J=["draglayer","plotbg","backplot","grids"];F.aaxis.layer==="below traces"&&J.push("aaxis","aline"),F.baxis.layer==="below traces"&&J.push("baxis","bline"),F.caxis.layer==="below traces"&&J.push("caxis","cline"),J.push("frontplot"),F.aaxis.layer==="above traces"&&J.push("aaxis","aline"),F.baxis.layer==="above traces"&&J.push("baxis","bline"),F.caxis.layer==="above traces"&&J.push("caxis","cline");var X=H.plotContainer.selectAll("g.toplevel").data(J,String),Y=["agrid","bgrid","cgrid"];X.enter().append("g").attr("class",function(Z){return"toplevel "+Z}).each(function(Z){var oe=w.select(this);G[Z]=oe,Z==="frontplot"?oe.append("g").classed("scatterlayer",!0):Z==="backplot"?oe.append("g").classed("maplayer",!0):Z==="plotbg"?oe.append("path").attr("d","M0,0Z"):Z==="aline"||Z==="bline"||Z==="cline"?oe.append("path"):Z==="grids"&&Y.forEach(function(re){G[re]=oe.append("g").classed("grid "+re,!0)})}),X.order()};var L=Math.sqrt(4/3);l.adjustLayout=function(F,H){var G=this,J=F.domain,X=(J.x[0]+J.x[1])/2,Y=(J.y[0]+J.y[1])/2,Z=J.x[1]-J.x[0],oe=J.y[1]-J.y[0],re=Z*H.w,se=oe*H.h,N=F.sum,U=F.aaxis.min,q=F.baxis.min,$=F.caxis.min,W,K,ne,ae,ie,le;re>L*se?(ae=se,ne=ae*L):(ne=re,ae=ne/L),ie=Z*ne/re,le=oe*ae/se,W=H.l+H.w*X-ne/2,K=H.t+H.h*(1-Y)-ae/2,G.x0=W,G.y0=K,G.w=ne,G.h=ae,G.sum=N,G.xaxis={type:"linear",range:[U+2*$-N,N-U-2*q],domain:[X-ie/2,X+ie/2],_id:"x"},t(G.xaxis,G.graphDiv._fullLayout),G.xaxis.setScale(),G.xaxis.isPtWithinRange=function(Pe){return Pe.a>=G.aaxis.range[0]&&Pe.a<=G.aaxis.range[1]&&Pe.b>=G.baxis.range[1]&&Pe.b<=G.baxis.range[0]&&Pe.c>=G.caxis.range[1]&&Pe.c<=G.caxis.range[0]},G.yaxis={type:"linear",range:[U,N-q-$],domain:[Y-le/2,Y+le/2],_id:"y"},t(G.yaxis,G.graphDiv._fullLayout),G.yaxis.setScale(),G.yaxis.isPtWithinRange=function(){return!0};var ye=G.yaxis.domain[0],ue=G.aaxis=c({},F.aaxis,{range:[U,N-q-$],side:"left",tickangle:(+F.aaxis.tickangle||0)-30,domain:[ye,ye+le*L],anchor:"free",position:0,_id:"y",_length:ne});t(ue,G.graphDiv._fullLayout),ue.setScale();var pe=G.baxis=c({},F.baxis,{range:[N-U-$,q],side:"bottom",domain:G.xaxis.domain,anchor:"free",position:0,_id:"x",_length:ne});t(pe,G.graphDiv._fullLayout),pe.setScale();var ge=G.caxis=c({},F.caxis,{range:[N-U-q,$],side:"right",tickangle:(+F.caxis.tickangle||0)+30,domain:[ye,ye+le*L],anchor:"free",position:0,_id:"y",_length:ne});t(ge,G.graphDiv._fullLayout),ge.setScale();var Te="M"+W+","+(K+ae)+"h"+ne+"l-"+ne/2+",-"+ae+"Z";G.clipDef.select("path").attr("d",Te),G.layers.plotbg.select("path").attr("d",Te);var _e="M0,"+ae+"h"+ne+"l-"+ne/2+",-"+ae+"Z";G.clipDefRelative.select("path").attr("d",_e);var ze=e(W,K);G.plotContainer.selectAll(".scatterlayer,.maplayer").attr("transform",ze),G.clipDefRelative.select("path").attr("transform",null);var Oe=e(W-pe._offset,K+ae);G.layers.baxis.attr("transform",Oe),G.layers.bgrid.attr("transform",Oe);var Ye=e(W+ne/2,K)+"rotate(30)"+e(0,-ue._offset);G.layers.aaxis.attr("transform",Ye),G.layers.agrid.attr("transform",Ye);var be=e(W+ne/2,K)+"rotate(-30)"+e(0,-ge._offset);G.layers.caxis.attr("transform",be),G.layers.cgrid.attr("transform",be),G.drawAxes(!0),G.layers.aline.select("path").attr("d",ue.showline?"M"+W+","+(K+ae)+"l"+ne/2+",-"+ae:"M0,0").call(n.stroke,ue.linecolor||"#000").style("stroke-width",(ue.linewidth||0)+"px"),G.layers.bline.select("path").attr("d",pe.showline?"M"+W+","+(K+ae)+"h"+ne:"M0,0").call(n.stroke,pe.linecolor||"#000").style("stroke-width",(pe.linewidth||0)+"px"),G.layers.cline.select("path").attr("d",ge.showline?"M"+(W+ne/2)+","+K+"l"+ne/2+","+ae:"M0,0").call(n.stroke,ge.linecolor||"#000").style("stroke-width",(ge.linewidth||0)+"px"),G.graphDiv._context.staticPlot||G.initInteractions(),r.setClipUrl(G.layers.frontplot,G._hasClipOnAxisFalse?null:G.clipId,G.graphDiv)},l.drawAxes=function(F){var H=this,G=H.graphDiv,J=H.id.substr(7)+"title",X=H.layers,Y=H.aaxis,Z=H.baxis,oe=H.caxis;if(H.drawAx(Y),H.drawAx(Z),H.drawAx(oe),F){var re=Math.max(Y.showticklabels?Y.tickfont.size/2:0,(oe.showticklabels?oe.tickfont.size*.75:0)+(oe.ticks==="outside"?oe.ticklen*.87:0)),se=(Z.showticklabels?Z.tickfont.size:0)+(Z.ticks==="outside"?Z.ticklen:0)+3;X["a-title"]=u.draw(G,"a"+J,{propContainer:Y,propName:H.id+".aaxis.title",placeholder:a(G,"Click to enter Component A title"),attributes:{x:H.x0+H.w/2,y:H.y0-Y.title.font.size/3-re,"text-anchor":"middle"}}),X["b-title"]=u.draw(G,"b"+J,{propContainer:Z,propName:H.id+".baxis.title",placeholder:a(G,"Click to enter Component B title"),attributes:{x:H.x0-se,y:H.y0+H.h+Z.title.font.size*.83+se,"text-anchor":"middle"}}),X["c-title"]=u.draw(G,"c"+J,{propContainer:oe,propName:H.id+".caxis.title",placeholder:a(G,"Click to enter Component C title"),attributes:{x:H.x0+H.w+se,y:H.y0+H.h+oe.title.font.size*.83+se,"text-anchor":"middle"}})}},l.drawAx=function(F){var H=this,G=H.graphDiv,J=F._name,X=J.charAt(0),Y=F._id,Z=H.layers[J],oe=30,re=X+"tickLayout",se=T(F);H[re]!==se&&(Z.selectAll("."+Y+"tick").remove(),H[re]=se),F.setScale();var N=i.calcTicks(F),U=i.clipEnds(F,N),q=i.makeTransTickFn(F),$=i.getTickSigns(F)[2],W=M.deg2rad(oe),K=$*(F.linewidth||1)/2,ne=$*F.ticklen,ae=H.w,ie=H.h,le=X==="b"?"M0,"+K+"l"+Math.sin(W)*ne+","+Math.cos(W)*ne:"M"+K+",0l"+Math.cos(W)*ne+","+-Math.sin(W)*ne,ye={a:"M0,0l"+ie+",-"+ae/2,b:"M0,0l-"+ae/2+",-"+ie,c:"M0,0l-"+ie+","+ae/2}[X];i.drawTicks(G,F,{vals:F.ticks==="inside"?U:N,layer:Z,path:le,transFn:q,crisp:!1}),i.drawGrid(G,F,{vals:U,layer:H.layers[X+"grid"],path:ye,transFn:q,crisp:!1}),i.drawLabels(G,F,{vals:N,layer:Z,transFn:q,labelFns:i.makeLabelFns(F,0,oe)})};function T(F){return F.ticks+String(F.ticklen)+String(F.showticklabels)}var k=f.MINZOOM/2+.87,P="m-0.87,.5h"+k+"v3h-"+(k+5.2)+"l"+(k/2+2.6)+",-"+(k*.87+4.5)+"l2.6,1.5l-"+k/2+","+k*.87+"Z",z="m0.87,.5h-"+k+"v3h"+(k+5.2)+"l-"+(k/2+2.6)+",-"+(k*.87+4.5)+"l-2.6,1.5l"+k/2+","+k*.87+"Z",I="m0,1l"+k/2+","+k*.87+"l2.6,-1.5l-"+(k/2+2.6)+",-"+(k*.87+4.5)+"l-"+(k/2+2.6)+","+(k*.87+4.5)+"l2.6,1.5l"+k/2+",-"+k*.87+"Z",D="m0.5,0.5h5v-2h-5v-5h-2v5h-5v2h5v5h2Z",R=!0;l.clearOutline=function(){b(this.dragOptions),A(this.dragOptions.gd)},l.initInteractions=function(){var F=this,H=F.layers.plotbg.select("path").node(),G=F.graphDiv,J=G._fullLayout._zoomlayer,X,Y;this.dragOptions={element:H,gd:G,plotinfo:{id:F.id,domain:G._fullLayout[F.id].domain,xaxis:F.xaxis,yaxis:F.yaxis},subplot:F.id,prepFn:function(Oe,Ye,be){F.dragOptions.xaxes=[F.xaxis],F.dragOptions.yaxes=[F.yaxis],X=G._fullLayout._invScaleX,Y=G._fullLayout._invScaleY;var Pe=F.dragOptions.dragmode=G._fullLayout.dragmode;h(Pe)?F.dragOptions.minDrag=1:F.dragOptions.minDrag=void 0,Pe==="zoom"?(F.dragOptions.moveFn=pe,F.dragOptions.clickFn=ae,F.dragOptions.doneFn=ge,ie(Oe,Ye,be)):Pe==="pan"?(F.dragOptions.moveFn=_e,F.dragOptions.clickFn=ae,F.dragOptions.doneFn=ze,Te(),F.clearOutline(G)):(m(Pe)||h(Pe))&&_(Oe,Ye,be,F.dragOptions,Pe)}};var Z,oe,re,se,N,U,q,$,W,K;function ne(Oe){var Ye={};return Ye[F.id+".aaxis.min"]=Oe.a,Ye[F.id+".baxis.min"]=Oe.b,Ye[F.id+".caxis.min"]=Oe.c,Ye}function ae(Oe,Ye){var be=G._fullLayout.clickmode;B(G),Oe===2&&(G.emit("plotly_doubleclick",null),S.call("_guiRelayout",G,ne({a:0,b:0,c:0}))),be.indexOf("select")>-1&&Oe===1&&s(Ye,G,[F.xaxis],[F.yaxis],F.id,F.dragOptions),be.indexOf("event")>-1&&p.click(G,Ye,F.id)}function ie(Oe,Ye,be){var Pe=H.getBoundingClientRect();Z=Ye-Pe.left,oe=be-Pe.top,G._fullLayout._calcInverseTransform(G);var Ge=G._fullLayout._invTransform,Qe=M.apply3DTransform(Ge)(Z,oe);Z=Qe[0],oe=Qe[1],re={a:F.aaxis.range[0],b:F.baxis.range[1],c:F.caxis.range[1]},N=re,se=F.aaxis.range[1]-re.a,U=v(F.graphDiv._fullLayout[F.id].bgcolor).getLuminance(),q="M0,"+F.h+"L"+F.w/2+", 0L"+F.w+","+F.h+"Z",$=!1,W=J.append("path").attr("class","zoombox").attr("transform",e(F.x0,F.y0)).style({fill:U>.2?"rgba(0,0,0,0)":"rgba(255,255,255,0)","stroke-width":0}).attr("d",q),K=J.append("path").attr("class","zoombox-corners").attr("transform",e(F.x0,F.y0)).style({fill:n.background,stroke:n.defaultLine,"stroke-width":1,opacity:0}).attr("d","M0,0Z"),F.clearOutline(G)}function le(Oe,Ye){return 1-Ye/F.h}function ye(Oe,Ye){return 1-(Oe+(F.h-Ye)/Math.sqrt(3))/F.w}function ue(Oe,Ye){return(Oe-(F.h-Ye)/Math.sqrt(3))/F.w}function pe(Oe,Ye){var be=Z+Oe*X,Pe=oe+Ye*Y,Ge=Math.max(0,Math.min(1,le(Z,oe),le(be,Pe))),Qe=Math.max(0,Math.min(1,ye(Z,oe),ye(be,Pe))),Be=Math.max(0,Math.min(1,ue(Z,oe),ue(be,Pe))),Le=(Ge/2+Be)*F.w,He=(1-Ge/2-Qe)*F.w,vt=(Le+He)/2,Rt=He-Le,rr=(1-Ge)*F.h,Lt=rr-Rt/L;Rt<f.MINZOOM?(N=re,W.attr("d",q),K.attr("d","M0,0Z")):(N={a:re.a+Ge*se,b:re.b+Qe*se,c:re.c+Be*se},W.attr("d",q+"M"+Le+","+rr+"H"+He+"L"+vt+","+Lt+"L"+Le+","+rr+"Z"),K.attr("d","M"+Z+","+oe+D+"M"+Le+","+rr+P+"M"+He+","+rr+z+"M"+vt+","+Lt+I)),$||(W.transition().style("fill",U>.2?"rgba(0,0,0,0.4)":"rgba(255,255,255,0.3)").duration(200),K.transition().style("opacity",1).duration(200),$=!0),G.emit("plotly_relayouting",ne(N))}function ge(){B(G),N!==re&&(S.call("_guiRelayout",G,ne(N)),R&&G.data&&G._context.showTips&&(M.notifier(a(G,"Double-click to zoom back out"),"long"),R=!1))}function Te(){re={a:F.aaxis.range[0],b:F.baxis.range[1],c:F.caxis.range[1]},N=re}function _e(Oe,Ye){var be=Oe/F.xaxis._m,Pe=Ye/F.yaxis._m;N={a:re.a-Pe,b:re.b+(be+Pe)/2,c:re.c-(be-Pe)/2};var Ge=[N.a,N.b,N.c].sort(M.sorterAsc),Qe={a:Ge.indexOf(N.a),b:Ge.indexOf(N.b),c:Ge.indexOf(N.c)};Ge[0]<0&&(Ge[1]+Ge[0]/2<0?(Ge[2]+=Ge[0]+Ge[1],Ge[0]=Ge[1]=0):(Ge[2]+=Ge[0]/2,Ge[1]+=Ge[0]/2,Ge[0]=0),N={a:Ge[Qe.a],b:Ge[Qe.b],c:Ge[Qe.c]},Ye=(re.a-N.a)*F.yaxis._m,Oe=(re.c-N.c-re.b+N.b)*F.xaxis._m);var Be=e(F.x0+Oe,F.y0+Ye);F.plotContainer.selectAll(".scatterlayer,.maplayer").attr("transform",Be);var Le=e(-Oe,-Ye);F.clipDefRelative.select("path").attr("transform",Le),F.aaxis.range=[N.a,F.sum-N.b-N.c],F.baxis.range=[F.sum-N.a-N.c,N.b],F.caxis.range=[F.sum-N.a-N.b,N.c],F.drawAxes(!1),F._hasClipOnAxisFalse&&F.plotContainer.select(".scatterlayer").selectAll(".trace").call(r.hideOutsideRangePoints,F),G.emit("plotly_relayouting",ne(N))}function ze(){S.call("_guiRelayout",G,ne(N))}H.onmousemove=function(Oe){p.hover(G,Oe,F.id),G._fullLayout._lasthover=H,G._fullLayout._hoversubplot=F.id},H.onmouseout=function(Oe){G._dragging||y.unhover(G,Oe)},y.init(this.dragOptions)};function B(F){w.select(F).selectAll(".zoombox,.js-zoombox-backdrop,.js-zoombox-menu,.zoombox-corners").remove()}},{"../../components/color":367,"../../components/dragelement":386,"../../components/dragelement/helpers":385,"../../components/drawing":389,"../../components/fx":407,"../../components/selections":455,"../../components/titles":476,"../../lib":515,"../../lib/extend":505,"../../registry":647,"../cartesian/axes":566,"../cartesian/constants":573,"../cartesian/set_convert":585,"../plots":628,"@plotly/d3":58,tinycolor2:313}],647:[function(d,ee,te){var w=d("./lib/loggers"),v=d("./lib/noop"),S=d("./lib/push_unique"),M=d("./lib/is_plain_object"),e=d("./lib/dom").addStyleRule,a=d("./lib/extend"),n=d("./plots/attributes"),r=d("./plots/layout_attributes"),t=a.extendFlat,c=a.extendDeepAll;te.modules={},te.allCategories={},te.allTypes=[],te.subplotsRegistry={},te.transformsRegistry={},te.componentsRegistry={},te.layoutArrayContainers=[],te.layoutArrayRegexes=[],te.traceLayoutAttributes={},te.localeRegistry={},te.apiMethodRegistry={},te.collectableSubplotTypes=null,te.register=function(b){if(te.collectableSubplotTypes=null,b)b&&!Array.isArray(b)&&(b=[b]);else throw new Error("No argument passed to Plotly.register.");for(var f=0;f<b.length;f++){var x=b[f];if(!x)throw new Error("Invalid module was attempted to be registered!");switch(x.moduleType){case"trace":o(x);break;case"transform":p(x);break;case"component":y(x);break;case"locale":g(x);break;case"apiMethod":var l=x.name;te.apiMethodRegistry[l]=x.fn;break;default:throw new Error("Invalid module was attempted to be registered!")}}},te.getModule=function(A){var b=te.modules[s(A)];return b?b._module:!1},te.traceIs=function(A,b){if(A=s(A),A==="various")return!1;var f=te.modules[A];return f||(A&&w.log("Unrecognized trace type "+A+"."),f=te.modules[n.type.dflt]),!!f.categories[b]},te.getTransformIndices=function(A,b){for(var f=[],x=A.transforms||[],l=0;l<x.length;l++)x[l].type===b&&f.push(l);return f},te.hasTransform=function(A,b){for(var f=A.transforms||[],x=0;x<f.length;x++)if(f[x].type===b)return!0;return!1},te.getComponentMethod=function(A,b){var f=te.componentsRegistry[A];return f&&f[b]||v},te.call=function(){var A=arguments[0],b=[].slice.call(arguments,1);return te.apiMethodRegistry[A].apply(null,b)};function o(A){var b=A.name,f=A.categories,x=A.meta;if(te.modules[b]){w.log("Type "+b+" already registered");return}te.subplotsRegistry[A.basePlotModule.name]||i(A.basePlotModule);for(var l={},L=0;L<f.length;L++)l[f[L]]=!0,te.allCategories[f[L]]=!0;te.modules[b]={_module:A,categories:l},x&&Object.keys(x).length&&(te.modules[b].meta=x),te.allTypes.push(b);for(var T in te.componentsRegistry)m(T,b);A.layoutAttributes&&t(te.traceLayoutAttributes,A.layoutAttributes);var k=A.basePlotModule,P=k.name;if(P==="mapbox"){var z=k.constants.styleRules;for(var I in z)e(".js-plotly-plot .plotly .mapboxgl-"+I,z[I])}(P==="geo"||P==="mapbox")&&window.PlotlyGeoAssets===void 0&&(window.PlotlyGeoAssets={topojson:{}})}function i(A){var b=A.name;if(te.subplotsRegistry[b]){w.log("Plot type "+b+" already registered.");return}h(A),te.subplotsRegistry[b]=A;for(var f in te.componentsRegistry)_(f,A.name)}function y(A){if(typeof A.name!="string")throw new Error("Component module *name* must be a string.");var b=A.name;te.componentsRegistry[b]=A,A.layoutAttributes&&(A.layoutAttributes._isLinkedToArray&&S(te.layoutArrayContainers,b),h(A));for(var f in te.modules)m(b,f);for(var x in te.subplotsRegistry)_(b,x);for(var l in te.transformsRegistry)u(b,l);A.schema&&A.schema.layout&&c(r,A.schema.layout)}function p(A){if(typeof A.name!="string")throw new Error("Transform module *name* must be a string.");var b="Transform module "+A.name,f=typeof A.transform=="function",x=typeof A.calcTransform=="function";if(!f&&!x)throw new Error(b+" is missing a *transform* or *calcTransform* method.");f&&x&&w.log([b+" has both a *transform* and *calcTransform* methods.","Please note that all *transform* methods are executed","before all *calcTransform* methods."].join(" ")),M(A.attributes)||w.log(b+" registered without an *attributes* object."),typeof A.supplyDefaults!="function"&&w.log(b+" registered without a *supplyDefaults* method."),te.transformsRegistry[A.name]=A;for(var l in te.componentsRegistry)u(l,A.name)}function g(A){var b=A.name,f=b.split("-")[0],x=A.dictionary,l=A.format,L=x&&Object.keys(x).length,T=l&&Object.keys(l).length,k=te.localeRegistry,P=k[b];if(P||(k[b]=P={}),f!==b){var z=k[f];z||(k[f]=z={}),L&&z.dictionary===P.dictionary&&(z.dictionary=x),T&&z.format===P.format&&(z.format=l)}L&&(P.dictionary=x),T&&(P.format=l)}function h(A){if(A.layoutAttributes){var b=A.layoutAttributes._arrayAttrRegexps;if(b)for(var f=0;f<b.length;f++)S(te.layoutArrayRegexes,b[f])}}function m(A,b){var f=te.componentsRegistry[A].schema;if(!(!f||!f.traces)){var x=f.traces[b];x&&c(te.modules[b]._module.attributes,x)}}function u(A,b){var f=te.componentsRegistry[A].schema;if(!(!f||!f.transforms)){var x=f.transforms[b];x&&c(te.transformsRegistry[b].attributes,x)}}function _(A,b){var f=te.componentsRegistry[A].schema;if(!(!f||!f.subplots)){var x=te.subplotsRegistry[b],l=x.layoutAttributes,L=x.attr==="subplot"?x.name:x.attr;Array.isArray(L)&&(L=L[0]);var T=f.subplots[L];l&&T&&c(l,T)}}function s(A){return typeof A=="object"&&(A=A.type),A}},{"./lib/dom":503,"./lib/extend":505,"./lib/is_plain_object":516,"./lib/loggers":519,"./lib/noop":524,"./lib/push_unique":530,"./plots/attributes":562,"./plots/layout_attributes":619}],648:[function(d,ee,te){var w=d("../registry"),v=d("../lib"),S=v.extendFlat,M=v.extendDeep;function e(n){var r;switch(n){case"themes__thumb":r={autosize:!0,width:150,height:150,title:{text:""},showlegend:!1,margin:{l:5,r:5,t:5,b:5,pad:0},annotations:[]};break;case"thumbnail":r={title:{text:""},hidesources:!0,showlegend:!1,borderwidth:0,bordercolor:"",margin:{l:1,r:1,t:1,b:1,pad:0},annotations:[]};break;default:r={}}return r}function a(n){var r=["xaxis","yaxis","zaxis"];return r.indexOf(n.slice(0,5))>-1}ee.exports=function(r,t){var c,o=r.data,i=r.layout,y=M([],o),p=M({},i,e(t.tileClass)),g=r._context||{};if(t.width&&(p.width=t.width),t.height&&(p.height=t.height),t.tileClass==="thumbnail"||t.tileClass==="themes__thumb"){p.annotations=[];var h=Object.keys(p);for(c=0;c<h.length;c++)a(h[c])&&(p[h[c]].title={text:""});for(c=0;c<y.length;c++){var m=y[c];m.showscale=!1,m.marker&&(m.marker.showscale=!1),w.traceIs(m,"pie-like")&&(m.textposition="none")}}if(Array.isArray(t.annotations))for(c=0;c<t.annotations.length;c++)p.annotations.push(t.annotations[c]);var u=Object.keys(p).filter(function(f){return f.match(/^scene\d*$/)});if(u.length){var _={};for(t.tileClass==="thumbnail"&&(_={title:{text:""},showaxeslabels:!1,showticklabels:!1,linetickenable:!1}),c=0;c<u.length;c++){var s=p[u[c]];s.xaxis||(s.xaxis={}),s.yaxis||(s.yaxis={}),s.zaxis||(s.zaxis={}),S(s.xaxis,_),S(s.yaxis,_),S(s.zaxis,_),s._scene=null}}var A=document.createElement("div");t.tileClass&&(A.className=t.tileClass);var b={gd:A,td:A,layout:p,data:y,config:{staticPlot:t.staticPlot===void 0?!0:t.staticPlot,plotGlPixelRatio:t.plotGlPixelRatio===void 0?2:t.plotGlPixelRatio,displaylogo:t.displaylogo||!1,showLink:t.showLink||!1,showTips:t.showTips||!1,mapboxAccessToken:g.mapboxAccessToken}};return t.setBackground!=="transparent"&&(b.config.setBackground=t.setBackground||"opaque"),b.gd.defaultLayout=e(t.tileClass),b}},{"../lib":515,"../registry":647}],649:[function(d,ee,te){var w=d("../lib"),v=d("../plot_api/to_image"),S=d("./filesaver"),M=d("./helpers");function e(a,n){var r;return w.isPlainObject(a)||(r=w.getGraphDiv(a)),n=n||{},n.format=n.format||"png",n.width=n.width||null,n.height=n.height||null,n.imageDataOnly=!0,new Promise(function(t,c){r&&r._snapshotInProgress&&c(new Error("Snapshotting already in progress.")),w.isIE()&&n.format!=="svg"&&c(new Error(M.MSG_IE_BAD_FORMAT)),r&&(r._snapshotInProgress=!0);var o=v(a,n),i=n.filename||a.fn||"newplot";i+="."+n.format.replace("-","."),o.then(function(y){return r&&(r._snapshotInProgress=!1),S(y,i,n.format)}).then(function(y){t(y)}).catch(function(y){r&&(r._snapshotInProgress=!1),c(y)})})}ee.exports=e},{"../lib":515,"../plot_api/to_image":558,"./filesaver":650,"./helpers":651}],650:[function(d,ee,te){var w=d("../lib"),v=d("./helpers");function S(M,e,a){var n=document.createElement("a"),r="download"in n,t=new Promise(function(c,o){var i,y;if(w.isIE())return i=v.createBlob(M,"svg"),window.navigator.msSaveBlob(i,e),i=null,c(e);if(r)return i=v.createBlob(M,a),y=v.createObjectURL(i),n.href=y,n.download=e,document.body.appendChild(n),n.click(),document.body.removeChild(n),v.revokeObjectURL(y),i=null,c(e);if(w.isSafari()){var p=a==="svg"?",":";base64,";return v.octetStream(p+encodeURIComponent(M)),c(e)}o(new Error("download error"))});return t}ee.exports=S},{"../lib":515,"./helpers":651}],651:[function(d,ee,te){var w=d("../registry");te.getDelay=function(M){return M._has&&(M._has("gl3d")||M._has("gl2d")||M._has("mapbox"))?500:0},te.getRedrawFunc=function(M){return function(){w.getComponentMethod("colorbar","draw")(M)}},te.encodeSVG=function(M){return"data:image/svg+xml,"+encodeURIComponent(M)},te.encodeJSON=function(M){return"data:application/json,"+encodeURIComponent(M)};var v=window.URL||window.webkitURL;te.createObjectURL=function(M){return v.createObjectURL(M)},te.revokeObjectURL=function(M){return v.revokeObjectURL(M)},te.createBlob=function(M,e){if(e==="svg")return new window.Blob([M],{type:"image/svg+xml;charset=utf-8"});if(e==="full-json")return new window.Blob([M],{type:"application/json;charset=utf-8"});var a=S(window.atob(M));return new window.Blob([a],{type:"image/"+e})},te.octetStream=function(M){document.location.href="data:application/octet-stream"+M};function S(M){for(var e=M.length,a=new ArrayBuffer(e),n=new Uint8Array(a),r=0;r<e;r++)n[r]=M.charCodeAt(r);return a}te.IMAGE_URL_PREFIX=/^data:image\/\w+;base64,/,te.MSG_IE_BAD_FORMAT="Sorry IE does not support downloading from canvas. Try {format:'svg'} instead."},{"../registry":647}],652:[function(d,ee,te){var w=d("./helpers"),v={getDelay:w.getDelay,getRedrawFunc:w.getRedrawFunc,clone:d("./cloneplot"),toSVG:d("./tosvg"),svgToImg:d("./svgtoimg"),toImage:d("./toimage"),downloadImage:d("./download")};ee.exports=v},{"./cloneplot":648,"./download":649,"./helpers":651,"./svgtoimg":653,"./toimage":654,"./tosvg":655}],653:[function(d,ee,te){var w=d("../lib"),v=d("events").EventEmitter,S=d("./helpers");function M(e){var a=e.emitter||new v,n=new Promise(function(r,t){var c=window.Image,o=e.svg,i=e.format||"png";if(w.isIE()&&i!=="svg"){var y=new Error(S.MSG_IE_BAD_FORMAT);return t(y),e.promise?n:a.emit("error",y)}var p=e.canvas,g=e.scale||1,h=e.width||300,m=e.height||150,u=g*h,_=g*m,s=p.getContext("2d",{willReadFrequently:!0}),A=new c,b,f;i==="svg"||w.isSafari()?f=S.encodeSVG(o):(b=S.createBlob(o,"svg"),f=S.createObjectURL(b)),p.width=u,p.height=_,A.onload=function(){var x;switch(b=null,S.revokeObjectURL(f),i!=="svg"&&s.drawImage(A,0,0,u,_),i){case"jpeg":x=p.toDataURL("image/jpeg");break;case"png":x=p.toDataURL("image/png");break;case"webp":x=p.toDataURL("image/webp");break;case"svg":x=f;break;default:var l="Image format is not jpeg, png, svg or webp.";if(t(new Error(l)),!e.promise)return a.emit("error",l)}r(x),e.promise||a.emit("success",x)},A.onerror=function(x){if(b=null,S.revokeObjectURL(f),t(x),!e.promise)return a.emit("error",x)},A.src=f});return e.promise?n:a}ee.exports=M},{"../lib":515,"./helpers":651,events:84}],654:[function(d,ee,te){var w=d("events").EventEmitter,v=d("../registry"),S=d("../lib"),M=d("./helpers"),e=d("./cloneplot"),a=d("./tosvg"),n=d("./svgtoimg");function r(t,c){var o=new w,i=e(t,{format:"png"}),y=i.gd;y.style.position="absolute",y.style.left="-5000px",document.body.appendChild(y);function p(){var h=M.getDelay(y._fullLayout);setTimeout(function(){var m=a(y),u=document.createElement("canvas");u.id=S.randstr(),o=n({format:c.format,width:y._fullLayout.width,height:y._fullLayout.height,canvas:u,emitter:o,svg:m}),o.clean=function(){y&&document.body.removeChild(y)}},h)}var g=M.getRedrawFunc(y);return v.call("_doPlot",y,i.data,i.layout,i.config).then(g).then(p).catch(function(h){o.emit("error",h)}),o}ee.exports=r},{"../lib":515,"../registry":647,"./cloneplot":648,"./helpers":651,"./svgtoimg":653,"./tosvg":655,events:84}],655:[function(d,ee,te){var w=d("@plotly/d3"),v=d("../lib"),S=d("../components/drawing"),M=d("../components/color"),e=d("../constants/xmlns_namespaces"),a=/"/g,n="TOBESTRIPPED",r=new RegExp('("'+n+")|("+n+'")',"g");function t(o){var i=w.select("body").append("div").style({display:"none"}).html(""),y=o.replace(/(&[^;]*;)/gi,function(p){return p==="&lt;"?"&#60;":p==="&rt;"?"&#62;":p.indexOf("<")!==-1||p.indexOf(">")!==-1?"":i.html(p).text()});return i.remove(),y}function c(o){return o.replace(/&(?!\w+;|\#[0-9]+;| \#x[0-9A-F]+;)/g,"&amp;")}ee.exports=function(i,y,p){var g=i._fullLayout,h=g._paper,m=g._toppaper,u=g.width,_=g.height,s;h.insert("rect",":first-child").call(S.setRect,0,0,u,_).call(M.fill,g.paper_bgcolor);var A=g._basePlotModules||[];for(s=0;s<A.length;s++){var b=A[s];b.toSVG&&b.toSVG(i)}if(m){var f=m.node().childNodes,x=Array.prototype.slice.call(f);for(s=0;s<x.length;s++){var l=x[s];l.childNodes.length&&h.node().appendChild(l)}}g._draggers&&g._draggers.remove(),h.node().style.background="",h.selectAll("text").attr({"data-unformatted":null,"data-math":null}).each(function(){var T=w.select(this);if(this.style.visibility==="hidden"||this.style.display==="none"){T.remove();return}else T.style({visibility:null,display:null});var k=this.style.fontFamily;k&&k.indexOf('"')!==-1&&T.style("font-family",k.replace(a,n))}),h.selectAll(".gradient_filled,.pattern_filled").each(function(){var T=w.select(this),k=this.style.fill;k&&k.indexOf("url(")!==-1&&T.style("fill",k.replace(a,n));var P=this.style.stroke;P&&P.indexOf("url(")!==-1&&T.style("stroke",P.replace(a,n))}),(y==="pdf"||y==="eps")&&h.selectAll("#MathJax_SVG_glyphs path").attr("stroke-width",0),h.node().setAttributeNS(e.xmlns,"xmlns",e.svg),h.node().setAttributeNS(e.xmlns,"xmlns:xlink",e.xlink),y==="svg"&&p&&(h.attr("width",p*u),h.attr("height",p*_),h.attr("viewBox","0 0 "+u+" "+_));var L=new window.XMLSerializer().serializeToString(h.node());return L=t(L),L=c(L),L=L.replace(r,"'"),v.isIE()&&(L=L.replace(/"/gi,"'"),L=L.replace(/(\('#)([^']*)('\))/gi,'("#$2")'),L=L.replace(/(\\')/gi,'"')),L}},{"../components/color":367,"../components/drawing":389,"../constants/xmlns_namespaces":492,"../lib":515,"@plotly/d3":58}],656:[function(d,ee,te){var w=d("../../lib");ee.exports=function(S,M){for(var e=0;e<S.length;e++)S[e].i=e;w.mergeArray(M.text,S,"tx"),w.mergeArray(M.hovertext,S,"htx");var a=M.marker;if(a){w.mergeArray(a.opacity,S,"mo",!0),w.mergeArray(a.color,S,"mc");var n=a.line;n&&(w.mergeArray(n.color,S,"mlc"),w.mergeArrayCastPositive(n.width,S,"mlw"))}}},{"../../lib":515}],657:[function(d,ee,te){var w=d("../scatter/attributes"),v=d("../../plots/cartesian/axis_format_attributes").axisHoverFormat,S=d("../../plots/template_attributes").hovertemplateAttrs,M=d("../../plots/template_attributes").texttemplateAttrs,e=d("../../components/colorscale/attributes"),a=d("../../plots/font_attributes"),n=d("./constants"),r=d("../../components/drawing/attributes").pattern,t=d("../../lib/extend").extendFlat,c=a({editType:"calc",arrayOk:!0,colorEditType:"style"}),o=w.marker,i=o.line,y=t({},i.width,{dflt:0}),p=t({width:y,editType:"calc"},e("marker.line")),g=t({line:p,editType:"calc"},e("marker"),{opacity:{valType:"number",arrayOk:!0,dflt:1,min:0,max:1,editType:"style"},pattern:r});ee.exports={x:w.x,x0:w.x0,dx:w.dx,y:w.y,y0:w.y0,dy:w.dy,xperiod:w.xperiod,yperiod:w.yperiod,xperiod0:w.xperiod0,yperiod0:w.yperiod0,xperiodalignment:w.xperiodalignment,yperiodalignment:w.yperiodalignment,xhoverformat:v("x"),yhoverformat:v("y"),text:w.text,texttemplate:M({editType:"plot"},{keys:n.eventDataKeys}),hovertext:w.hovertext,hovertemplate:S({},{keys:n.eventDataKeys}),textposition:{valType:"enumerated",values:["inside","outside","auto","none"],dflt:"auto",arrayOk:!0,editType:"calc"},insidetextanchor:{valType:"enumerated",values:["end","middle","start"],dflt:"end",editType:"plot"},textangle:{valType:"angle",dflt:"auto",editType:"plot"},textfont:t({},c,{}),insidetextfont:t({},c,{}),outsidetextfont:t({},c,{}),constraintext:{valType:"enumerated",values:["inside","outside","both","none"],dflt:"both",editType:"calc"},cliponaxis:t({},w.cliponaxis,{}),orientation:{valType:"enumerated",values:["v","h"],editType:"calc+clearAxisTypes"},base:{valType:"any",dflt:null,arrayOk:!0,editType:"calc"},offset:{valType:"number",dflt:null,arrayOk:!0,editType:"calc"},width:{valType:"number",dflt:null,min:0,arrayOk:!0,editType:"calc"},marker:g,offsetgroup:{valType:"string",dflt:"",editType:"calc"},alignmentgroup:{valType:"string",dflt:"",editType:"calc"},selected:{marker:{opacity:w.selected.marker.opacity,color:w.selected.marker.color,editType:"style"},textfont:w.selected.textfont,editType:"style"},unselected:{marker:{opacity:w.unselected.marker.opacity,color:w.unselected.marker.color,editType:"style"},textfont:w.unselected.textfont,editType:"style"},_deprecated:{bardir:{valType:"enumerated",editType:"calc",values:["v","h"]}}}},{"../../components/colorscale/attributes":374,"../../components/drawing/attributes":388,"../../lib/extend":505,"../../plots/cartesian/axis_format_attributes":569,"../../plots/font_attributes":594,"../../plots/template_attributes":642,"../scatter/attributes":936,"./constants":659}],658:[function(d,ee,te){var w=d("../../plots/cartesian/axes"),v=d("../../plots/cartesian/align_period"),S=d("../../components/colorscale/helpers").hasColorscale,M=d("../../components/colorscale/calc"),e=d("./arrays_to_calcdata"),a=d("../scatter/calc_selection");ee.exports=function(r,t){var c=w.getFromId(r,t.xaxis||"x"),o=w.getFromId(r,t.yaxis||"y"),i,y,p,g,h,m,u={msUTC:!!(t.base||t.base===0)};t.orientation==="h"?(i=c.makeCalcdata(t,"x",u),p=o.makeCalcdata(t,"y"),g=v(t,o,"y",p),h=!!t.yperiodalignment,m="y"):(i=o.makeCalcdata(t,"y",u),p=c.makeCalcdata(t,"x"),g=v(t,c,"x",p),h=!!t.xperiodalignment,m="x"),y=g.vals;for(var _=Math.min(y.length,i.length),s=new Array(_),A=0;A<_;A++)s[A]={p:y[A],s:i[A]},h&&(s[A].orig_p=p[A],s[A][m+"End"]=g.ends[A],s[A][m+"Start"]=g.starts[A]),t.ids&&(s[A].id=String(t.ids[A]));return S(t,"marker")&&M(r,t,{vals:t.marker.color,containerStr:"marker",cLetter:"c"}),S(t,"marker.line")&&M(r,t,{vals:t.marker.line.color,containerStr:"marker.line",cLetter:"c"}),e(s,t),a(s,t),s}},{"../../components/colorscale/calc":375,"../../components/colorscale/helpers":378,"../../plots/cartesian/align_period":563,"../../plots/cartesian/axes":566,"../scatter/calc_selection":938,"./arrays_to_calcdata":656}],659:[function(d,ee,te){ee.exports={TEXTPAD:3,eventDataKeys:["value","label"]}},{}],660:[function(d,ee,te){var w=d("fast-isnumeric"),v=d("../../lib").isArrayOrTypedArray,S=d("../../constants/numerical").BADNUM,M=d("../../registry"),e=d("../../plots/cartesian/axes"),a=d("../../plots/cartesian/constraints").getAxisGroup,n=d("./sieve.js");function r(L,T){for(var k=T.xaxis,P=T.yaxis,z=L._fullLayout,I=L._fullData,D=L.calcdata,R=[],B=[],F=0;F<I.length;F++){var H=I[F];if(H.visible===!0&&M.traceIs(H,"bar")&&H.xaxis===k._id&&H.yaxis===P._id&&(H.orientation==="h"?R.push(D[F]):B.push(D[F]),H._computePh))for(var G=L.calcdata[F],J=0;J<G.length;J++)typeof G[J].ph0=="function"&&(G[J].ph0=G[J].ph0()),typeof G[J].ph1=="function"&&(G[J].ph1=G[J].ph1())}var X={xCat:k.type==="category"||k.type==="multicategory",yCat:P.type==="category"||P.type==="multicategory",mode:z.barmode,norm:z.barnorm,gap:z.bargap,groupgap:z.bargroupgap};t(L,k,P,B,X),t(L,P,k,R,X)}function t(L,T,k,P,z){if(!!P.length){var I,D,R,B,F;switch(c(k,P),z.mode){case"overlay":o(T,k,P,z);break;case"group":for(I=[],D=[],R=0;R<P.length;R++)B=P[R],F=B[0].trace,F.offset===void 0?D.push(B):I.push(B);D.length&&i(L,T,k,D,z),I.length&&o(T,k,I,z);break;case"stack":case"relative":for(I=[],D=[],R=0;R<P.length;R++)B=P[R],F=B[0].trace,F.base===void 0?D.push(B):I.push(B);D.length&&y(L,T,k,D,z),I.length&&o(T,k,I,z);break}x(P,T)}}function c(L,T){var k,P;for(k=0;k<T.length;k++){var z=T[k],I=z[0].trace,D=I.type==="funnel"?I._base:I.base,R,B=I.orientation==="h"?I.xcalendar:I.ycalendar,F=L.type==="category"||L.type==="multicategory"?function(){return null}:L.d2c;if(v(D)){for(P=0;P<Math.min(D.length,z.length);P++)R=F(D[P],0,B),w(R)?(z[P].b=+R,z[P].hasB=1):z[P].b=0;for(;P<z.length;P++)z[P].b=0}else{R=F(D,0,B);var H=w(R);for(R=H?R:0,P=0;P<z.length;P++)z[P].b=R,H&&(z[P].hasB=1)}}}function o(L,T,k,P){for(var z=0;z<k.length;z++){var I=k[z],D=new n([I],{posAxis:L,sepNegVal:!1,overlapNoMerge:!P.norm});p(L,D,P),P.norm?(A(D),f(T,D,P)):_(T,D)}}function i(L,T,k,P,z){var I=new n(P,{posAxis:T,sepNegVal:!1,overlapNoMerge:!z.norm});g(L,T,I,z),b(I,T),z.norm?(A(I),f(k,I,z)):_(k,I)}function y(L,T,k,P,z){var I=new n(P,{posAxis:T,sepNegVal:z.mode==="relative",overlapNoMerge:!(z.norm||z.mode==="stack"||z.mode==="relative")});p(T,I,z),s(k,I,z);for(var D=0;D<P.length;D++)for(var R=P[D],B=0;B<R.length;B++){var F=R[B];if(F.s!==S){var H=F.b+F.s===I.get(F.p,F.s);H&&(F._outmost=!0)}}z.norm&&f(k,I,z)}function p(L,T,k){for(var P=T.minDiff,z=T.traces,I=P*(1-k.gap),D=I,R=D*(1-(k.groupgap||0)),B=-R/2,F=0;F<z.length;F++){var H=z[F],G=H[0].t;G.barwidth=R,G.poffset=B,G.bargroupwidth=I,G.bardelta=P}T.binWidth=z[0][0].t.barwidth/100,h(T),m(L,T),u(L,T)}function g(L,T,k,P){for(var z=L._fullLayout,I=k.positions,D=k.distinctPositions,R=k.minDiff,B=k.traces,F=B.length,H=I.length!==D.length,G=R*(1-P.gap),J=a(z,T._id)+B[0][0].trace.orientation,X=z._alignmentOpts[J]||{},Y=0;Y<F;Y++){var Z=B[Y],oe=Z[0].trace,re=X[oe.alignmentgroup]||{},se=Object.keys(re.offsetGroups||{}).length,N;se?N=G/se:N=H?G/F:G;var U=N*(1-(P.groupgap||0)),q;se?q=((2*oe._offsetIndex+1-se)*N-U)/2:q=H?((2*Y+1-F)*N-U)/2:-U/2;var $=Z[0].t;$.barwidth=U,$.poffset=q,$.bargroupwidth=G,$.bardelta=R}k.binWidth=B[0][0].t.barwidth/100,h(k),m(T,k),u(T,k,H)}function h(L){var T=L.traces,k,P;for(k=0;k<T.length;k++){var z=T[k],I=z[0],D=I.trace,R=I.t,B=D._offset||D.offset,F=R.poffset,H;if(v(B)){for(H=Array.prototype.slice.call(B,0,z.length),P=0;P<H.length;P++)w(H[P])||(H[P]=F);for(P=H.length;P<z.length;P++)H.push(F);R.poffset=H}else B!==void 0&&(R.poffset=B);var G=D._width||D.width,J=R.barwidth;if(v(G)){var X=Array.prototype.slice.call(G,0,z.length);for(P=0;P<X.length;P++)w(X[P])||(X[P]=J);for(P=X.length;P<z.length;P++)X.push(J);if(R.barwidth=X,B===void 0){for(H=[],P=0;P<z.length;P++)H.push(F+(J-X[P])/2);R.poffset=H}}else G!==void 0&&(R.barwidth=G,B===void 0&&(R.poffset=F+(J-G)/2))}}function m(L,T){for(var k=T.traces,P=l(L),z=0;z<k.length;z++)for(var I=k[z],D=I[0].t,R=D.poffset,B=Array.isArray(R),F=D.barwidth,H=Array.isArray(F),G=0;G<I.length;G++){var J=I[G],X=J.w=H?F[G]:F;J[P]=J.p+(B?R[G]:R)+X/2}}function u(L,T,k){var P=T.traces,z=T.minDiff,I=z/2;e.minDtick(L,T.minDiff,T.distinctPositions[0],k);for(var D=0;D<P.length;D++){var R=P[D],B=R[0],F=B.trace,H=[],G,J,X,Y;for(Y=0;Y<R.length;Y++)G=R[Y],J=G.p-I,X=G.p+I,H.push(J,X);if(F.width||F.offset){var Z=B.t,oe=Z.poffset,re=Z.barwidth,se=Array.isArray(oe),N=Array.isArray(re);for(Y=0;Y<R.length;Y++){G=R[Y];var U=se?oe[Y]:oe,q=N?re[Y]:re;J=G.p+U,X=J+q,H.push(J,X)}}F._extremes[L._id]=e.findExtremes(L,H,{padded:!1})}}function _(L,T){for(var k=T.traces,P=l(L),z=0;z<k.length;z++){for(var I=k[z],D=I[0].trace,R=[],B=!1,F=0;F<I.length;F++){var H=I[F],G=H.b,J=G+H.s;H[P]=J,R.push(J),H.hasB&&R.push(G),(!H.hasB||!H.b)&&(B=!0)}D._extremes[L._id]=e.findExtremes(L,R,{tozero:B,padded:!0})}}function s(L,T,k){var P=l(L),z=T.traces,I,D,R,B,F,H;for(B=0;B<z.length;B++)if(I=z[B],D=I[0].trace,D.type==="funnel")for(F=0;F<I.length;F++)H=I[F],H.s!==S&&T.put(H.p,-.5*H.s);for(B=0;B<z.length;B++){I=z[B],D=I[0].trace,R=D.type==="funnel";var G=[];for(F=0;F<I.length;F++)if(H=I[F],H.s!==S){var J;R?J=H.s:J=H.s+H.b;var X=T.put(H.p,J),Y=X+J;H.b=X,H[P]=Y,k.norm||(G.push(Y),H.hasB&&G.push(X))}k.norm||(D._extremes[L._id]=e.findExtremes(L,G,{tozero:!0,padded:!0}))}}function A(L){for(var T=L.traces,k=0;k<T.length;k++)for(var P=T[k],z=0;z<P.length;z++){var I=P[z];I.s!==S&&L.put(I.p,I.b+I.s)}}function b(L,T){for(var k=L.traces,P=0;P<k.length;P++){var z=k[P],I=z[0].trace;if(I.base===void 0)for(var D=new n([z],{posAxis:T,sepNegVal:!0,overlapNoMerge:!0}),R=0;R<z.length;R++){var B=z[R];if(B.p!==S){var F=D.put(B.p,B.b+B.s);F&&(B.b=F)}}}}function f(L,T,k){var P=T.traces,z=l(L),I=k.norm==="fraction"?1:100,D=I/1e9,R=L.l2c(L.c2l(0)),B=k.mode==="stack"?I:R;function F(q){return w(L.c2l(q))&&(q<R-D||q>B+D||!w(R))}for(var H=0;H<P.length;H++){for(var G=P[H],J=G[0].trace,X=[],Y=!1,Z=!1,oe=0;oe<G.length;oe++){var re=G[oe];if(re.s!==S){var se=Math.abs(I/T.get(re.p,re.s));re.b*=se,re.s*=se;var N=re.b,U=N+re.s;re[z]=U,X.push(U),Z=Z||F(U),re.hasB&&(X.push(N),Z=Z||F(N)),(!re.hasB||!re.b)&&(Y=!0)}}J._extremes[L._id]=e.findExtremes(L,X,{tozero:Y,padded:Z})}}function x(L,T){var k=l(T),P={},z,I,D,R=1/0,B=-1/0;for(z=0;z<L.length;z++)for(D=L[z],I=0;I<D.length;I++){var F=D[I].p;w(F)&&(R=Math.min(R,F),B=Math.max(B,F))}var H=1e4/(B-R),G=P.round=function(se){return String(Math.round(H*(se-R)))};for(z=0;z<L.length;z++){D=L[z],D[0].t.extents=P;var J=D[0].t.poffset,X=Array.isArray(J);for(I=0;I<D.length;I++){var Y=D[I],Z=Y[k]-Y.w/2;if(w(Z)){var oe=Y[k]+Y.w/2,re=G(Y.p);P[re]?P[re]=[Math.min(Z,P[re][0]),Math.max(oe,P[re][1])]:P[re]=[Z,oe]}Y.p0=Y.p+(X?J[I]:J),Y.p1=Y.p0+Y.w,Y.s0=Y.b,Y.s1=Y.s0+Y.s}}}function l(L){return L._id.charAt(0)}ee.exports={crossTraceCalc:r,setGroupPositions:t}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/axes":566,"../../plots/cartesian/constraints":574,"../../registry":647,"./sieve.js":670,"fast-isnumeric":190}],661:[function(d,ee,te){var w=d("../../lib"),v=d("../../components/color"),S=d("../../registry"),M=d("../scatter/xy_defaults"),e=d("../scatter/period_defaults"),a=d("./style_defaults"),n=d("../../plots/cartesian/constraints").getAxisGroup,r=d("./attributes"),t=w.coerceFont;function c(p,g,h,m){function u(f,x){return w.coerce(p,g,r,f,x)}var _=M(p,g,m,u);if(!_){g.visible=!1;return}e(p,g,m,u),u("xhoverformat"),u("yhoverformat"),u("orientation",g.x&&!g.y?"h":"v"),u("base"),u("offset"),u("width"),u("text"),u("hovertext"),u("hovertemplate");var s=u("textposition");y(p,g,m,u,s,{moduleHasSelected:!0,moduleHasUnselected:!0,moduleHasConstrain:!0,moduleHasCliponaxis:!0,moduleHasTextangle:!0,moduleHasInsideanchor:!0}),a(p,g,u,h,m);var A=(g.marker.line||{}).color,b=S.getComponentMethod("errorbars","supplyDefaults");b(p,g,A||v.defaultLine,{axis:"y"}),b(p,g,A||v.defaultLine,{axis:"x",inherit:"y"}),w.coerceSelectionMarkerOpacity(g,u)}function o(p,g,h,m){var u=g.orientation,_=g[{v:"x",h:"y"}[u]+"axis"],s=n(h,_)+u,A=h._alignmentOpts||{},b=m("alignmentgroup"),f=A[s];f||(f=A[s]={});var x=f[b];x?x.traces.push(g):x=f[b]={traces:[g],alignmentIndex:Object.keys(f).length,offsetGroups:{}};var l=m("offsetgroup"),L=x.offsetGroups,T=L[l];l&&(T||(T=L[l]={offsetIndex:Object.keys(L).length}),g._offsetIndex=T.offsetIndex)}function i(p,g){var h,m;function u(s){return w.coerce(m._input,m,r,s)}if(g.barmode==="group")for(var _=0;_<p.length;_++)m=p[_],m.type==="bar"&&(h=m._input,o(h,m,g,u))}function y(p,g,h,m,u,_){_=_||{};var s=_.moduleHasSelected!==!1,A=_.moduleHasUnselected!==!1,b=_.moduleHasConstrain!==!1,f=_.moduleHasCliponaxis!==!1,x=_.moduleHasTextangle!==!1,l=_.moduleHasInsideanchor!==!1,L=!!_.hasPathbar,T=Array.isArray(u)||u==="auto",k=T||u==="inside",P=T||u==="outside";if(k||P){var z=t(m,"textfont",h.font),I=w.extendFlat({},z),D=p.textfont&&p.textfont.color,R=!D;if(R&&delete I.color,t(m,"insidetextfont",I),L){var B=w.extendFlat({},z);R&&delete B.color,t(m,"pathbar.textfont",B)}P&&t(m,"outsidetextfont",z),s&&m("selected.textfont.color"),A&&m("unselected.textfont.color"),b&&m("constraintext"),f&&m("cliponaxis"),x&&m("textangle"),m("texttemplate")}k&&l&&m("insidetextanchor")}ee.exports={supplyDefaults:c,crossTraceDefaults:i,handleGroupingDefaults:o,handleText:y}},{"../../components/color":367,"../../lib":515,"../../plots/cartesian/constraints":574,"../../registry":647,"../scatter/period_defaults":956,"../scatter/xy_defaults":963,"./attributes":657,"./style_defaults":672}],662:[function(d,ee,te){ee.exports=function(v,S,M){return v.x="xVal"in S?S.xVal:S.x,v.y="yVal"in S?S.yVal:S.y,S.xa&&(v.xaxis=S.xa),S.ya&&(v.yaxis=S.ya),M.orientation==="h"?(v.label=v.y,v.value=v.x):(v.label=v.x,v.value=v.y),v}},{}],663:[function(d,ee,te){var w=d("fast-isnumeric"),v=d("tinycolor2"),S=d("../../lib").isArrayOrTypedArray;te.coerceString=function(M,e,a){if(typeof e=="string"){if(e||!M.noBlank)return e}else if((typeof e=="number"||e===!0)&&!M.strict)return String(e);return a!==void 0?a:M.dflt},te.coerceNumber=function(M,e,a){if(w(e)){e=+e;var n=M.min,r=M.max,t=n!==void 0&&e<n||r!==void 0&&e>r;if(!t)return e}return a!==void 0?a:M.dflt},te.coerceColor=function(M,e,a){return v(e).isValid()?e:a!==void 0?a:M.dflt},te.coerceEnumerated=function(M,e,a){return M.coerceNumber&&(e=+e),M.values.indexOf(e)!==-1?e:a!==void 0?a:M.dflt},te.getValue=function(M,e){var a;return Array.isArray(M)?e<M.length&&(a=M[e]):a=M,a},te.getLineWidth=function(M,e){var a=0<e.mlw?e.mlw:S(M.marker.line.width)?0:M.marker.line.width;return a}},{"../../lib":515,"fast-isnumeric":190,tinycolor2:313}],664:[function(d,ee,te){var w=d("../../components/fx"),v=d("../../registry"),S=d("../../components/color"),M=d("../../lib").fillText,e=d("./helpers").getLineWidth,a=d("../../plots/cartesian/axes").hoverLabelText,n=d("../../constants/numerical").BADNUM;function r(o,i,y,p,g){var h=t(o,i,y,p,g);if(h){var m=h.cd,u=m[0].trace,_=m[h.index];return h.color=c(u,_),v.getComponentMethod("errorbars","hoverInfo")(_,u,h),[h]}}function t(o,i,y,p,g){var h=o.cd,m=h[0].trace,u=h[0].t,_=p==="closest",s=m.type==="waterfall",A=o.maxHoverDistance,b=o.maxSpikeDistance,f,x,l,L,T,k,P;m.orientation==="h"?(f=y,x=i,l="y",L="x",T=oe,k=X):(f=i,x=y,l="x",L="y",k=oe,T=X);var z=m[l+"period"],I=_||z;function D(ie){return B(ie,-1)}function R(ie){return B(ie,1)}function B(ie,le){var ye=ie.w;return ie[l]+le*ye/2}function F(ie){return ie[l+"End"]-ie[l+"Start"]}var H=_?D:z?function(ie){return ie.p-F(ie)/2}:function(ie){return Math.min(D(ie),ie.p-u.bardelta/2)},G=_?R:z?function(ie){return ie.p+F(ie)/2}:function(ie){return Math.max(R(ie),ie.p+u.bardelta/2)};function J(ie,le,ye){return g.finiteRange&&(ye=0),w.inbox(ie-f,le-f,ye+Math.min(1,Math.abs(le-ie)/P)-1)}function X(ie){return J(H(ie),G(ie),A)}function Y(ie){return J(D(ie),R(ie),b)}function Z(ie){var le=ie[L];if(s){var ye=Math.abs(ie.rawS)||0;x>0?le+=ye:x<0&&(le-=ye)}return le}function oe(ie){var le=x,ye=ie.b,ue=Z(ie);return w.inbox(ye-le,ue-le,A+(ue-le)/(ue-ye)-1)}function re(ie){var le=x,ye=ie.b,ue=Z(ie);return w.inbox(ye-le,ue-le,b+(ue-le)/(ue-ye)-1)}var se=o[l+"a"],N=o[L+"a"];P=Math.abs(se.r2c(se.range[1])-se.r2c(se.range[0]));function U(ie){return(T(ie)+k(ie))/2}var q=w.getDistanceFunction(p,T,k,U);if(w.getClosest(h,q,o),o.index!==!1&&h[o.index].p!==n){I||(H=function(ie){return Math.min(D(ie),ie.p-u.bargroupwidth/2)},G=function(ie){return Math.max(R(ie),ie.p+u.bargroupwidth/2)});var $=o.index,W=h[$],K=m.base?W.b+W.s:W.s;o[L+"0"]=o[L+"1"]=N.c2p(W[L],!0),o[L+"LabelVal"]=K;var ne=u.extents[u.extents.round(W.p)];o[l+"0"]=se.c2p(_?H(W):ne[0],!0),o[l+"1"]=se.c2p(_?G(W):ne[1],!0);var ae=W.orig_p!==void 0;return o[l+"LabelVal"]=ae?W.orig_p:W.p,o.labelLabel=a(se,o[l+"LabelVal"],m[l+"hoverformat"]),o.valueLabel=a(N,o[L+"LabelVal"],m[L+"hoverformat"]),o.baseLabel=a(N,W.b,m[L+"hoverformat"]),o.spikeDistance=(re(W)+Y(W))/2,o[l+"Spike"]=se.c2p(W.p,!0),M(W,m,o),o.hovertemplate=m.hovertemplate,o}}function c(o,i){var y=i.mcc||o.marker.color,p=i.mlcc||o.marker.line.color,g=e(o,i);if(S.opacity(y))return y;if(S.opacity(p)&&g)return p}ee.exports={hoverPoints:r,hoverOnBars:t,getTraceColor:c}},{"../../components/color":367,"../../components/fx":407,"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/axes":566,"../../registry":647,"./helpers":663}],665:[function(d,ee,te){ee.exports={attributes:d("./attributes"),layoutAttributes:d("./layout_attributes"),supplyDefaults:d("./defaults").supplyDefaults,crossTraceDefaults:d("./defaults").crossTraceDefaults,supplyLayoutDefaults:d("./layout_defaults"),calc:d("./calc"),crossTraceCalc:d("./cross_trace_calc").crossTraceCalc,colorbar:d("../scatter/marker_colorbar"),arraysToCalcdata:d("./arrays_to_calcdata"),plot:d("./plot").plot,style:d("./style").style,styleOnSelect:d("./style").styleOnSelect,hoverPoints:d("./hover").hoverPoints,eventData:d("./event_data"),selectPoints:d("./select"),moduleType:"trace",name:"bar",basePlotModule:d("../../plots/cartesian"),categories:["bar-like","cartesian","svg","bar","oriented","errorBarsOK","showLegend","zoomScale"],animatable:!0,meta:{}}},{"../../plots/cartesian":578,"../scatter/marker_colorbar":954,"./arrays_to_calcdata":656,"./attributes":657,"./calc":658,"./cross_trace_calc":660,"./defaults":661,"./event_data":662,"./hover":664,"./layout_attributes":666,"./layout_defaults":667,"./plot":668,"./select":669,"./style":671}],666:[function(d,ee,te){ee.exports={barmode:{valType:"enumerated",values:["stack","group","overlay","relative"],dflt:"group",editType:"calc"},barnorm:{valType:"enumerated",values:["","fraction","percent"],dflt:"",editType:"calc"},bargap:{valType:"number",min:0,max:1,editType:"calc"},bargroupgap:{valType:"number",min:0,max:1,dflt:0,editType:"calc"}}},{}],667:[function(d,ee,te){var w=d("../../registry"),v=d("../../plots/cartesian/axes"),S=d("../../lib"),M=d("./layout_attributes");ee.exports=function(e,a,n){function r(u,_){return S.coerce(e,a,M,u,_)}for(var t=!1,c=!1,o=!1,i={},y=r("barmode"),p=0;p<n.length;p++){var g=n[p];if(w.traceIs(g,"bar")&&g.visible)t=!0;else continue;if(y==="group"){var h=g.xaxis+g.yaxis;i[h]&&(o=!0),i[h]=!0}if(g.visible&&g.type==="histogram"){var m=v.getFromId({_fullLayout:a},g[g.orientation==="v"?"xaxis":"yaxis"]);m.type!=="category"&&(c=!0)}}if(!t){delete a.barmode;return}y!=="overlay"&&r("barnorm"),r("bargap",c&&!o?0:.2),r("bargroupgap")}},{"../../lib":515,"../../plots/cartesian/axes":566,"../../registry":647,"./layout_attributes":666}],668:[function(d,ee,te){var w=d("@plotly/d3"),v=d("fast-isnumeric"),S=d("../../lib"),M=d("../../lib/svg_text_utils"),e=d("../../components/color"),a=d("../../components/drawing"),n=d("../../registry"),r=d("../../plots/cartesian/axes").tickText,t=d("./uniform_text"),c=t.recordMinTextSize,o=t.clearMinTextSize,i=d("./style"),y=d("./helpers"),p=d("./constants"),g=d("./attributes"),h=g.text,m=g.textposition,u=d("../../components/fx/helpers").appendArrayPointValue,_=p.TEXTPAD;function s(H){return H.id}function A(H){if(H.ids)return s}function b(H,G){return H<G?1:-1}function f(H,G,J,X){var Y=[],Z=[],oe=X?G:J,re=X?J:G;return Y[0]=oe.c2p(H.s0,!0),Z[0]=re.c2p(H.p0,!0),Y[1]=oe.c2p(H.s1,!0),Z[1]=re.c2p(H.p1,!0),X?[Y,Z]:[Z,Y]}function x(H,G,J,X){if(!G.uniformtext.mode&&l(J)){var Y;return X&&(Y=X()),H.transition().duration(J.duration).ease(J.easing).each("end",function(){Y&&Y()}).each("interrupt",function(){Y&&Y()})}else return H}function l(H){return H&&H.duration>0}function L(H,G,J,X,Y,Z){var oe=G.xaxis,re=G.yaxis,se=H._fullLayout;Y||(Y={mode:se.barmode,norm:se.barmode,gap:se.bargap,groupgap:se.bargroupgap},o("bar",se));var N=S.makeTraceGroups(X,J,"trace bars").each(function(U){var q=w.select(this),$=U[0].trace,W=$.type==="waterfall",K=$.type==="funnel",ne=$.type==="bar",ae=ne||K,ie=0;W&&$.connector.visible&&$.connector.mode==="between"&&(ie=$.connector.line.width/2);var le=$.orientation==="h",ye=l(Y),ue=S.ensureSingle(q,"g","points"),pe=A($),ge=ue.selectAll("g.point").data(S.identity,pe);ge.enter().append("g").classed("point",!0),ge.exit().remove(),ge.each(function(_e,ze){var Oe=w.select(this),Ye=f(_e,oe,re,le),be=Ye[0][0],Pe=Ye[0][1],Ge=Ye[1][0],Qe=Ye[1][1],Be=(le?Pe-be:Qe-Ge)===0;Be&&ae&&y.getLineWidth($,_e)&&(Be=!1),Be||(Be=!v(be)||!v(Pe)||!v(Ge)||!v(Qe)),_e.isBlank=Be,Be&&(le?Pe=be:Qe=Ge),ie&&!Be&&(le?(be-=b(be,Pe)*ie,Pe+=b(be,Pe)*ie):(Ge-=b(Ge,Qe)*ie,Qe+=b(Ge,Qe)*ie));var Le,He;if($.type==="waterfall"){if(!Be){var vt=$[_e.dir].marker;Le=vt.line.width,He=vt.color}}else Le=y.getLineWidth($,_e),He=_e.mc||$.marker.color;function Rt(kt){var Ue=w.round(Le/2%1,2);return Y.gap===0&&Y.groupgap===0?w.round(Math.round(kt)-Ue,2):kt}function rr(kt,Ue,qe){return qe&&kt===Ue?kt:Math.abs(kt-Ue)>=2?Rt(kt):kt>Ue?Math.ceil(kt):Math.floor(kt)}if(!H._context.staticPlot){var Lt=e.opacity(He),Ft=Lt<1||Le>.01?Rt:rr;be=Ft(be,Pe,le),Pe=Ft(Pe,be,le),Ge=Ft(Ge,Qe,!le),Qe=Ft(Qe,Ge,!le)}var Gt=x(S.ensureSingle(Oe,"path"),se,Y,Z);if(Gt.style("vector-effect","non-scaling-stroke").attr("d",isNaN((Pe-be)*(Qe-Ge))||Be&&H._context.staticPlot?"M0,0Z":"M"+be+","+Ge+"V"+Qe+"H"+Pe+"V"+Ge+"Z").call(a.setClipUrl,G.layerClipId,H),!se.uniformtext.mode&&ye){var Dt=a.makePointStyleFns($);a.singlePointStyle(_e,Gt,$,Dt,H)}T(H,G,Oe,U,ze,be,Pe,Ge,Qe,Y,Z),G.layerClipId&&a.hideOutsideRangePoint(_e,Oe.select("text"),oe,re,$.xcalendar,$.ycalendar)});var Te=$.cliponaxis===!1;a.setClipUrl(q,Te?null:G.layerClipId,H)});n.getComponentMethod("errorbars","plot")(H,N,G,Y)}function T(H,G,J,X,Y,Z,oe,re,se,N,U){var q=G.xaxis,$=G.yaxis,W=H._fullLayout,K;function ne(kt,Ue,qe){var Ve=S.ensureSingle(kt,"text").text(Ue).attr({class:"bartext bartext-"+K,"text-anchor":"middle","data-notex":1}).call(a.font,qe).call(M.convertToTspans,H);return Ve}var ae=X[0].trace,ie=ae.orientation==="h",le=D(W,X,Y,q,$);K=R(ae,Y);var ye=N.mode==="stack"||N.mode==="relative",ue=X[Y],pe=!ye||ue._outmost;if(!le||K==="none"||(ue.isBlank||Z===oe||re===se)&&(K==="auto"||K==="inside")){J.select("text").remove();return}var ge=W.font,Te=i.getBarColor(X[Y],ae),_e=i.getInsideTextFont(ae,Y,ge,Te),ze=i.getOutsideTextFont(ae,Y,ge),Oe=J.datum();ie?q.type==="log"&&Oe.s0<=0&&(q.range[0]<q.range[1]?Z=0:Z=q._length):$.type==="log"&&Oe.s0<=0&&($.range[0]<$.range[1]?re=$._length:re=0);var Ye=Math.abs(oe-Z)-2*_,be=Math.abs(se-re)-2*_,Pe,Ge,Qe,Be,Le;if(K==="outside"&&!pe&&!ue.hasB&&(K="inside"),K==="auto")if(pe){K="inside",Le=S.ensureUniformFontSize(H,_e),Pe=ne(J,le,Le),Ge=a.bBox(Pe.node()),Qe=Ge.width,Be=Ge.height;var He=Qe>0&&Be>0,vt=Qe<=Ye&&Be<=be,Rt=Qe<=be&&Be<=Ye,rr=ie?Ye>=Qe*(be/Be):be>=Be*(Ye/Qe);He&&(vt||Rt||rr)?K="inside":(K="outside",Pe.remove(),Pe=null)}else K="inside";if(!Pe){Le=S.ensureUniformFontSize(H,K==="outside"?ze:_e),Pe=ne(J,le,Le);var Lt=Pe.attr("transform");if(Pe.attr("transform",""),Ge=a.bBox(Pe.node()),Qe=Ge.width,Be=Ge.height,Pe.attr("transform",Lt),Qe<=0||Be<=0){Pe.remove();return}}var Ft=ae.textangle,Gt,Dt;K==="outside"?(Dt=ae.constraintext==="both"||ae.constraintext==="outside",Gt=I(Z,oe,re,se,Ge,{isHorizontal:ie,constrained:Dt,angle:Ft})):(Dt=ae.constraintext==="both"||ae.constraintext==="inside",Gt=z(Z,oe,re,se,Ge,{isHorizontal:ie,constrained:Dt,angle:Ft,anchor:ae.insidetextanchor})),Gt.fontSize=Le.size,c(ae.type==="histogram"?"bar":ae.type,Gt,W),ue.transform=Gt,x(Pe,W,N,U).attr("transform",S.getTextTransform(Gt))}function k(H){return H==="auto"?0:H}function P(H,G){var J=Math.PI/180*G,X=Math.abs(Math.sin(J)),Y=Math.abs(Math.cos(J));return{x:H.width*Y+H.height*X,y:H.width*X+H.height*Y}}function z(H,G,J,X,Y,Z){var oe=!!Z.isHorizontal,re=!!Z.constrained,se=Z.angle||0,N=Z.anchor||"end",U=N==="end",q=N==="start",$=Z.leftToRight||0,W=($+1)/2,K=1-W,ne=Y.width,ae=Y.height,ie=Math.abs(G-H),le=Math.abs(X-J),ye=ie>2*_&&le>2*_?_:0;ie-=2*ye,le-=2*ye;var ue=k(se);se==="auto"&&!(ne<=ie&&ae<=le)&&(ne>ie||ae>le)&&(!(ne>le||ae>ie)||ne<ae!=ie<le)&&(ue+=90);var pe=P(Y,ue),ge=1;re&&(ge=Math.min(1,ie/pe.x,le/pe.y));var Te=Y.left*K+Y.right*W,_e=(Y.top+Y.bottom)/2,ze=(H+_)*K+(G-_)*W,Oe=(J+X)/2,Ye=0,be=0;if(q||U){var Pe=(oe?pe.x:pe.y)/2,Ge=oe?b(H,G):b(J,X);oe?q?(ze=H+Ge*ye,Ye=-Ge*Pe):(ze=G-Ge*ye,Ye=Ge*Pe):q?(Oe=J+Ge*ye,be=-Ge*Pe):(Oe=X-Ge*ye,be=Ge*Pe)}return{textX:Te,textY:_e,targetX:ze,targetY:Oe,anchorX:Ye,anchorY:be,scale:ge,rotate:ue}}function I(H,G,J,X,Y,Z){var oe=!!Z.isHorizontal,re=!!Z.constrained,se=Z.angle||0,N=Y.width,U=Y.height,q=Math.abs(G-H),$=Math.abs(X-J),W;oe?W=$>2*_?_:0:W=q>2*_?_:0;var K=1;re&&(K=oe?Math.min(1,$/U):Math.min(1,q/N));var ne=k(se),ae=P(Y,ne),ie=(oe?ae.x:ae.y)/2,le=(Y.left+Y.right)/2,ye=(Y.top+Y.bottom)/2,ue=(H+G)/2,pe=(J+X)/2,ge=0,Te=0,_e=oe?b(G,H):b(J,X);return oe?(ue=G-_e*W,ge=_e*ie):(pe=X+_e*W,Te=-_e*ie),{textX:le,textY:ye,targetX:ue,targetY:pe,anchorX:ge,anchorY:Te,scale:K,rotate:ne}}function D(H,G,J,X,Y){var Z=G[0].trace,oe=Z.texttemplate,re;return oe?re=B(H,G,J,X,Y):Z.textinfo?re=F(G,J,X,Y):re=y.getValue(Z.text,J),y.coerceString(h,re)}function R(H,G){var J=y.getValue(H.textposition,G);return y.coerceEnumerated(m,J)}function B(H,G,J,X,Y){var Z=G[0].trace,oe=S.castOption(Z,J,"texttemplate");if(!oe)return"";var re=Z.type==="histogram",se=Z.type==="waterfall",N=Z.type==="funnel",U=Z.orientation==="h",q,$,W,K;U?(q="y",$=Y,W="x",K=X):(q="x",$=X,W="y",K=Y);function ne(ge){return r($,$.c2l(ge),!0).text}function ae(ge){return r(K,K.c2l(ge),!0).text}var ie=G[J],le={};le.label=ie.p,le.labelLabel=le[q+"Label"]=ne(ie.p);var ye=S.castOption(Z,ie.i,"text");(ye===0||ye)&&(le.text=ye),le.value=ie.s,le.valueLabel=le[W+"Label"]=ae(ie.s);var ue={};u(ue,Z,ie.i),(re||ue.x===void 0)&&(ue.x=U?le.value:le.label),(re||ue.y===void 0)&&(ue.y=U?le.label:le.value),(re||ue.xLabel===void 0)&&(ue.xLabel=U?le.valueLabel:le.labelLabel),(re||ue.yLabel===void 0)&&(ue.yLabel=U?le.labelLabel:le.valueLabel),se&&(le.delta=+ie.rawS||ie.s,le.deltaLabel=ae(le.delta),le.final=ie.v,le.finalLabel=ae(le.final),le.initial=le.final-le.delta,le.initialLabel=ae(le.initial)),N&&(le.value=ie.s,le.valueLabel=ae(le.value),le.percentInitial=ie.begR,le.percentInitialLabel=S.formatPercent(ie.begR),le.percentPrevious=ie.difR,le.percentPreviousLabel=S.formatPercent(ie.difR),le.percentTotal=ie.sumR,le.percenTotalLabel=S.formatPercent(ie.sumR));var pe=S.castOption(Z,ie.i,"customdata");return pe&&(le.customdata=pe),S.texttemplateString(oe,le,H._d3locale,ue,le,Z._meta||{})}function F(H,G,J,X){var Y=H[0].trace,Z=Y.orientation==="h",oe=Y.type==="waterfall",re=Y.type==="funnel";function se(pe){var ge=Z?X:J;return r(ge,pe,!0).text}function N(pe){var ge=Z?J:X;return r(ge,+pe,!0).text}var U=Y.textinfo,q=H[G],$=U.split("+"),W=[],K,ne=function(pe){return $.indexOf(pe)!==-1};if(ne("label")&&W.push(se(H[G].p)),ne("text")&&(K=S.castOption(Y,q.i,"text"),(K===0||K)&&W.push(K)),oe){var ae=+q.rawS||q.s,ie=q.v,le=ie-ae;ne("initial")&&W.push(N(le)),ne("delta")&&W.push(N(ae)),ne("final")&&W.push(N(ie))}if(re){ne("value")&&W.push(N(q.s));var ye=0;ne("percent initial")&&ye++,ne("percent previous")&&ye++,ne("percent total")&&ye++;var ue=ye>1;ne("percent initial")&&(K=S.formatPercent(q.begR),ue&&(K+=" of initial"),W.push(K)),ne("percent previous")&&(K=S.formatPercent(q.difR),ue&&(K+=" of previous"),W.push(K)),ne("percent total")&&(K=S.formatPercent(q.sumR),ue&&(K+=" of total"),W.push(K))}return W.join("<br>")}ee.exports={plot:L,toMoveInsideBar:z}},{"../../components/color":367,"../../components/drawing":389,"../../components/fx/helpers":403,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/cartesian/axes":566,"../../registry":647,"./attributes":657,"./constants":659,"./helpers":663,"./style":671,"./uniform_text":673,"@plotly/d3":58,"fast-isnumeric":190}],669:[function(d,ee,te){ee.exports=function(S,M){var e=S.cd,a=S.xaxis,n=S.yaxis,r=e[0].trace,t=r.type==="funnel",c=r.orientation==="h",o=[],i;if(M===!1)for(i=0;i<e.length;i++)e[i].selected=0;else for(i=0;i<e.length;i++){var y=e[i],p="ct"in y?y.ct:w(y,a,n,c,t);M.contains(p,!1,i,S)?(o.push({pointNumber:i,x:a.c2d(y.x),y:n.c2d(y.y)}),y.selected=1):y.selected=0}return o};function w(v,S,M,e,a){var n=S.c2p(e?v.s0:v.p0,!0),r=S.c2p(e?v.s1:v.p1,!0),t=M.c2p(e?v.p0:v.s0,!0),c=M.c2p(e?v.p1:v.s1,!0);return a?[(n+r)/2,(t+c)/2]:e?[r,(t+c)/2]:[(n+r)/2,c]}},{}],670:[function(d,ee,te){ee.exports=S;var w=d("../../lib").distinctVals,v=d("../../constants/numerical").BADNUM;function S(M,e){this.traces=M,this.sepNegVal=e.sepNegVal,this.overlapNoMerge=e.overlapNoMerge;for(var a=1/0,n=[],r=0;r<M.length;r++){for(var t=M[r],c=0;c<t.length;c++){var o=t[c];o.p!==v&&n.push(o.p)}t[0]&&t[0].width1&&(a=Math.min(t[0].width1,a))}this.positions=n;var i=w(n);this.distinctPositions=i.vals,i.vals.length===1&&a!==1/0?this.minDiff=a:this.minDiff=Math.min(i.minDiff,a);var y=(e.posAxis||{}).type;(y==="category"||y==="multicategory")&&(this.minDiff=1),this.binWidth=this.minDiff,this.bins={}}S.prototype.put=function(e,a){var n=this.getLabel(e,a),r=this.bins[n]||0;return this.bins[n]=r+a,r},S.prototype.get=function(e,a){var n=this.getLabel(e,a);return this.bins[n]||0},S.prototype.getLabel=function(e,a){var n=a<0&&this.sepNegVal?"v":"^",r=this.overlapNoMerge?e:Math.round(e/this.binWidth);return n+r}},{"../../constants/numerical":491,"../../lib":515}],671:[function(d,ee,te){var w=d("@plotly/d3"),v=d("../../components/color"),S=d("../../components/drawing"),M=d("../../lib"),e=d("../../registry"),a=d("./uniform_text").resizeText,n=d("./attributes"),r=n.textfont,t=n.insidetextfont,c=n.outsidetextfont,o=d("./helpers");function i(x){var l=w.select(x).selectAll("g.barlayer").selectAll("g.trace");a(x,l,"bar");var L=l.size(),T=x._fullLayout;l.style("opacity",function(k){return k[0].trace.opacity}).each(function(k){(T.barmode==="stack"&&L>1||T.bargap===0&&T.bargroupgap===0&&!k[0].trace.marker.line.width)&&w.select(this).attr("shape-rendering","crispEdges")}),l.selectAll("g.points").each(function(k){var P=w.select(this),z=k[0].trace;y(P,z,x)}),e.getComponentMethod("errorbars","style")(l)}function y(x,l,L){S.pointStyle(x.selectAll("path"),l,L),p(x,l,L)}function p(x,l,L){x.selectAll("text").each(function(T){var k=w.select(this),P=M.ensureUniformFontSize(L,u(k,T,l,L));S.font(k,P)})}function g(x,l,L){var T=l[0].trace;T.selectedpoints?h(L,T,x):(y(L,T,x),e.getComponentMethod("errorbars","style")(L))}function h(x,l,L){S.selectedPointStyle(x.selectAll("path"),l),m(x.selectAll("text"),l,L)}function m(x,l,L){x.each(function(T){var k=w.select(this),P;if(T.selected){P=M.ensureUniformFontSize(L,u(k,T,l,L));var z=l.selected.textfont&&l.selected.textfont.color;z&&(P.color=z),S.font(k,P)}else S.selectedTextStyle(k,l)})}function u(x,l,L,T){var k=T._fullLayout.font,P=L.textfont;if(x.classed("bartext-inside")){var z=f(l,L);P=s(L,l.i,k,z)}else x.classed("bartext-outside")&&(P=A(L,l.i,k));return P}function _(x,l,L){return b(r,x.textfont,l,L)}function s(x,l,L,T){var k=_(x,l,L),P=x._input.textfont===void 0||x._input.textfont.color===void 0||Array.isArray(x.textfont.color)&&x.textfont.color[l]===void 0;return P&&(k={color:v.contrast(T),family:k.family,size:k.size}),b(t,x.insidetextfont,l,k)}function A(x,l,L){var T=_(x,l,L);return b(c,x.outsidetextfont,l,T)}function b(x,l,L,T){l=l||{};var k=o.getValue(l.family,L),P=o.getValue(l.size,L),z=o.getValue(l.color,L);return{family:o.coerceString(x.family,k,T.family),size:o.coerceNumber(x.size,P,T.size),color:o.coerceColor(x.color,z,T.color)}}function f(x,l){return l.type==="waterfall"?l[x.dir].marker.color:x.mcc||x.mc||l.marker.color}ee.exports={style:i,styleTextPoints:p,styleOnSelect:g,getInsideTextFont:s,getOutsideTextFont:A,getBarColor:f,resizeText:a}},{"../../components/color":367,"../../components/drawing":389,"../../lib":515,"../../registry":647,"./attributes":657,"./helpers":663,"./uniform_text":673,"@plotly/d3":58}],672:[function(d,ee,te){var w=d("../../components/color"),v=d("../../components/colorscale/helpers").hasColorscale,S=d("../../components/colorscale/defaults"),M=d("../../lib").coercePattern;ee.exports=function(a,n,r,t,c){var o=r("marker.color",t),i=v(a,"marker");i&&S(a,n,c,r,{prefix:"marker.",cLetter:"c"}),r("marker.line.color",w.defaultLine),v(a,"marker.line")&&S(a,n,c,r,{prefix:"marker.line.",cLetter:"c"}),r("marker.line.width"),r("marker.opacity"),M(r,"marker.pattern",o,i),r("selected.marker.color"),r("unselected.marker.color")}},{"../../components/color":367,"../../components/colorscale/defaults":377,"../../components/colorscale/helpers":378,"../../lib":515}],673:[function(d,ee,te){var w=d("@plotly/d3"),v=d("../../lib");function S(n,r,t){var c=n._fullLayout,o=c["_"+t+"Text_minsize"];if(o){var i=c.uniformtext.mode==="hide",y;switch(t){case"funnelarea":case"pie":case"sunburst":y="g.slice";break;case"treemap":case"icicle":y="g.slice, g.pathbar";break;default:y="g.points > g.point"}r.selectAll(y).each(function(p){var g=p.transform;if(g){g.scale=i&&g.hide?0:o/g.fontSize;var h=w.select(this).select("text");h.attr("transform",v.getTextTransform(g))}})}}function M(n,r,t){if(t.uniformtext.mode){var c=a(n),o=t.uniformtext.minsize,i=r.scale*r.fontSize;r.hide=i<o,t[c]=t[c]||1/0,r.hide||(t[c]=Math.min(t[c],Math.max(i,o)))}}function e(n,r){var t=a(n);r[t]=void 0}function a(n){return"_"+n+"Text_minsize"}ee.exports={recordMinTextSize:M,clearMinTextSize:e,resizeText:S}},{"../../lib":515,"@plotly/d3":58}],674:[function(d,ee,te){var w=d("../../plots/template_attributes").hovertemplateAttrs,v=d("../../lib/extend").extendFlat,S=d("../scatterpolar/attributes"),M=d("../bar/attributes");ee.exports={r:S.r,theta:S.theta,r0:S.r0,dr:S.dr,theta0:S.theta0,dtheta:S.dtheta,thetaunit:S.thetaunit,base:v({},M.base,{}),offset:v({},M.offset,{}),width:v({},M.width,{}),text:v({},M.text,{}),hovertext:v({},M.hovertext,{}),marker:M.marker,hoverinfo:S.hoverinfo,hovertemplate:w(),selected:M.selected,unselected:M.unselected}},{"../../lib/extend":505,"../../plots/template_attributes":642,"../bar/attributes":657,"../scatterpolar/attributes":1011}],675:[function(d,ee,te){var w=d("../../components/colorscale/helpers").hasColorscale,v=d("../../components/colorscale/calc"),S=d("../bar/arrays_to_calcdata"),M=d("../bar/cross_trace_calc").setGroupPositions,e=d("../scatter/calc_selection"),a=d("../../registry").traceIs,n=d("../../lib").extendFlat;function r(c,o){for(var i=c._fullLayout,y=o.subplot,p=i[y].radialaxis,g=i[y].angularaxis,h=p.makeCalcdata(o,"r"),m=g.makeCalcdata(o,"theta"),u=o._length,_=new Array(u),s=h,A=m,b=0;b<u;b++)_[b]={p:A[b],s:s[b]};function f(x){var l=o[x];l!==void 0&&(o["_"+x]=Array.isArray(l)?g.makeCalcdata(o,x):g.d2c(l,o.thetaunit))}return g.type==="linear"&&(f("width"),f("offset")),w(o,"marker")&&v(c,o,{vals:o.marker.color,containerStr:"marker",cLetter:"c"}),w(o,"marker.line")&&v(c,o,{vals:o.marker.line.color,containerStr:"marker.line",cLetter:"c"}),S(_,o),e(_,o),_}function t(c,o,i){for(var y=c.calcdata,p=[],g=0;g<y.length;g++){var h=y[g],m=h[0].trace;m.visible===!0&&a(m,"bar")&&m.subplot===i&&p.push(h)}var u=n({},o.radialaxis,{_id:"x"}),_=o.angularaxis;M(c,_,u,p,{mode:o.barmode,norm:o.barnorm,gap:o.bargap,groupgap:o.bargroupgap})}ee.exports={calc:r,crossTraceCalc:t}},{"../../components/colorscale/calc":375,"../../components/colorscale/helpers":378,"../../lib":515,"../../registry":647,"../bar/arrays_to_calcdata":656,"../bar/cross_trace_calc":660,"../scatter/calc_selection":938}],676:[function(d,ee,te){var w=d("../../lib"),v=d("../scatterpolar/defaults").handleRThetaDefaults,S=d("../bar/style_defaults"),M=d("./attributes");ee.exports=function(a,n,r,t){function c(i,y){return w.coerce(a,n,M,i,y)}var o=v(a,n,t,c);if(!o){n.visible=!1;return}c("thetaunit"),c("base"),c("offset"),c("width"),c("text"),c("hovertext"),c("hovertemplate"),S(a,n,c,r,t),w.coerceSelectionMarkerOpacity(n,c)}},{"../../lib":515,"../bar/style_defaults":672,"../scatterpolar/defaults":1013,"./attributes":674}],677:[function(d,ee,te){var w=d("../../components/fx"),v=d("../../lib"),S=d("../bar/hover").getTraceColor,M=v.fillText,e=d("../scatterpolar/hover").makeHoverPointText,a=d("../../plots/polar/helpers").isPtInsidePolygon;ee.exports=function(r,t,c){var o=r.cd,i=o[0].trace,y=r.subplot,p=y.radialAxis,g=y.angularAxis,h=y.vangles,m=h?a:v.isPtInsideSector,u=r.maxHoverDistance,_=g._period||2*Math.PI,s=Math.abs(p.g2p(Math.sqrt(t*t+c*c))),A=Math.atan2(c,t);p.range[0]>p.range[1]&&(A+=Math.PI);var b=function(L){return m(s,A,[L.rp0,L.rp1],[L.thetag0,L.thetag1],h)?u+Math.min(1,Math.abs(L.thetag1-L.thetag0)/_)-1+(L.rp1-s)/(L.rp1-L.rp0)-1:1/0};if(w.getClosest(o,b,r),r.index!==!1){var f=r.index,x=o[f];r.x0=r.x1=x.ct[0],r.y0=r.y1=x.ct[1];var l=v.extendFlat({},x,{r:x.s,theta:x.p});return M(x,i,r),e(l,i,y,r),r.hovertemplate=i.hovertemplate,r.color=S(i,x),r.xLabelVal=r.yLabelVal=void 0,x.s<0&&(r.idealAlign="left"),[r]}}},{"../../components/fx":407,"../../lib":515,"../../plots/polar/helpers":630,"../bar/hover":664,"../scatterpolar/hover":1015}],678:[function(d,ee,te){ee.exports={moduleType:"trace",name:"barpolar",basePlotModule:d("../../plots/polar"),categories:["polar","bar","showLegend"],attributes:d("./attributes"),layoutAttributes:d("./layout_attributes"),supplyDefaults:d("./defaults"),supplyLayoutDefaults:d("./layout_defaults"),calc:d("./calc").calc,crossTraceCalc:d("./calc").crossTraceCalc,plot:d("./plot"),colorbar:d("../scatter/marker_colorbar"),formatLabels:d("../scatterpolar/format_labels"),style:d("../bar/style").style,styleOnSelect:d("../bar/style").styleOnSelect,hoverPoints:d("./hover"),selectPoints:d("../bar/select"),meta:{}}},{"../../plots/polar":631,"../bar/select":669,"../bar/style":671,"../scatter/marker_colorbar":954,"../scatterpolar/format_labels":1014,"./attributes":674,"./calc":675,"./defaults":676,"./hover":677,"./layout_attributes":679,"./layout_defaults":680,"./plot":681}],679:[function(d,ee,te){ee.exports={barmode:{valType:"enumerated",values:["stack","overlay"],dflt:"stack",editType:"calc"},bargap:{valType:"number",dflt:.1,min:0,max:1,editType:"calc"}}},{}],680:[function(d,ee,te){var w=d("../../lib"),v=d("./layout_attributes");ee.exports=function(S,M,e){var a={},n;function r(o,i){return w.coerce(S[n]||{},M[n],v,o,i)}for(var t=0;t<e.length;t++){var c=e[t];c.type==="barpolar"&&c.visible===!0&&(n=c.subplot,a[n]||(r("barmode"),r("bargap"),a[n]=1))}}},{"../../lib":515,"./layout_attributes":679}],681:[function(d,ee,te){var w=d("@plotly/d3"),v=d("fast-isnumeric"),S=d("../../lib"),M=d("../../components/drawing"),e=d("../../plots/polar/helpers");ee.exports=function(r,t,c){var o=t.xaxis,i=t.yaxis,y=t.radialAxis,p=t.angularAxis,g=a(t),h=t.layers.frontplot.select("g.barlayer");S.makeTraceGroups(h,c,"trace bars").each(function(){var m=w.select(this),u=S.ensureSingle(m,"g","points"),_=u.selectAll("g.point").data(S.identity);_.enter().append("g").style("vector-effect","non-scaling-stroke").style("stroke-miterlimit",2).classed("point",!0),_.exit().remove(),_.each(function(s){var A=w.select(this),b=s.rp0=y.c2p(s.s0),f=s.rp1=y.c2p(s.s1),x=s.thetag0=p.c2g(s.p0),l=s.thetag1=p.c2g(s.p1),L;if(!v(b)||!v(f)||!v(x)||!v(l)||b===f||x===l)L="M0,0Z";else{var T=y.c2g(s.s1),k=(x+l)/2;s.ct=[o.c2p(T*Math.cos(k)),i.c2p(T*Math.sin(k))],L=g(b,f,x,l)}S.ensureSingle(A,"path").attr("d",L)}),M.setClipUrl(m,t._hasClipOnAxisFalse?t.clipIds.forTraces:null,r)})};function a(n){var r=n.cxx,t=n.cyy;return n.vangles?function(c,o,i,y){var p,g;S.angleDelta(i,y)>0?(p=i,g=y):(p=y,g=i);var h=e.findEnclosingVertexAngles(p,n.vangles)[0],m=e.findEnclosingVertexAngles(g,n.vangles)[1],u=[h,(p+g)/2,m];return e.pathPolygonAnnulus(c,o,p,g,u,r,t)}:function(c,o,i,y){return S.pathAnnulus(c,o,i,y,r,t)}}},{"../../components/drawing":389,"../../lib":515,"../../plots/polar/helpers":630,"@plotly/d3":58,"fast-isnumeric":190}],682:[function(d,ee,te){var w=d("../scatter/attributes"),v=d("../bar/attributes"),S=d("../../components/color/attributes"),M=d("../../plots/cartesian/axis_format_attributes").axisHoverFormat,e=d("../../plots/template_attributes").hovertemplateAttrs,a=d("../../lib/extend").extendFlat,n=w.marker,r=n.line;ee.exports={y:{valType:"data_array",editType:"calc+clearAxisTypes"},x:{valType:"data_array",editType:"calc+clearAxisTypes"},x0:{valType:"any",editType:"calc+clearAxisTypes"},y0:{valType:"any",editType:"calc+clearAxisTypes"},dx:{valType:"number",editType:"calc"},dy:{valType:"number",editType:"calc"},xperiod:w.xperiod,yperiod:w.yperiod,xperiod0:w.xperiod0,yperiod0:w.yperiod0,xperiodalignment:w.xperiodalignment,yperiodalignment:w.yperiodalignment,xhoverformat:M("x"),yhoverformat:M("y"),name:{valType:"string",editType:"calc+clearAxisTypes"},q1:{valType:"data_array",editType:"calc+clearAxisTypes"},median:{valType:"data_array",editType:"calc+clearAxisTypes"},q3:{valType:"data_array",editType:"calc+clearAxisTypes"},lowerfence:{valType:"data_array",editType:"calc"},upperfence:{valType:"data_array",editType:"calc"},notched:{valType:"boolean",editType:"calc"},notchwidth:{valType:"number",min:0,max:.5,dflt:.25,editType:"calc"},notchspan:{valType:"data_array",editType:"calc"},boxpoints:{valType:"enumerated",values:["all","outliers","suspectedoutliers",!1],editType:"calc"},jitter:{valType:"number",min:0,max:1,editType:"calc"},pointpos:{valType:"number",min:-2,max:2,editType:"calc"},boxmean:{valType:"enumerated",values:[!0,"sd",!1],editType:"calc"},mean:{valType:"data_array",editType:"calc"},sd:{valType:"data_array",editType:"calc"},orientation:{valType:"enumerated",values:["v","h"],editType:"calc+clearAxisTypes"},quartilemethod:{valType:"enumerated",values:["linear","exclusive","inclusive"],dflt:"linear",editType:"calc"},width:{valType:"number",min:0,dflt:0,editType:"calc"},marker:{outliercolor:{valType:"color",dflt:"rgba(0, 0, 0, 0)",editType:"style"},symbol:a({},n.symbol,{arrayOk:!1,editType:"plot"}),opacity:a({},n.opacity,{arrayOk:!1,dflt:1,editType:"style"}),size:a({},n.size,{arrayOk:!1,editType:"calc"}),color:a({},n.color,{arrayOk:!1,editType:"style"}),line:{color:a({},r.color,{arrayOk:!1,dflt:S.defaultLine,editType:"style"}),width:a({},r.width,{arrayOk:!1,dflt:0,editType:"style"}),outliercolor:{valType:"color",editType:"style"},outlierwidth:{valType:"number",min:0,dflt:1,editType:"style"},editType:"style"},editType:"plot"},line:{color:{valType:"color",editType:"style"},width:{valType:"number",min:0,dflt:2,editType:"style"},editType:"plot"},fillcolor:w.fillcolor,whiskerwidth:{valType:"number",min:0,max:1,dflt:.5,editType:"calc"},offsetgroup:v.offsetgroup,alignmentgroup:v.alignmentgroup,selected:{marker:w.selected.marker,editType:"style"},unselected:{marker:w.unselected.marker,editType:"style"},text:a({},w.text,{}),hovertext:a({},w.hovertext,{}),hovertemplate:e({}),hoveron:{valType:"flaglist",flags:["boxes","points"],dflt:"boxes+points",editType:"style"}}},{"../../components/color/attributes":366,"../../lib/extend":505,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../bar/attributes":657,"../scatter/attributes":936}],683:[function(d,ee,te){var w=d("fast-isnumeric"),v=d("../../plots/cartesian/axes"),S=d("../../plots/cartesian/align_period"),M=d("../../lib"),e=d("../../constants/numerical").BADNUM,a=M._;ee.exports=function(A,b){var f=A._fullLayout,x=v.getFromId(A,b.xaxis||"x"),l=v.getFromId(A,b.yaxis||"y"),L=[],T=b.type==="violin"?"_numViolins":"_numBoxes",k,P,z,I,D,R,B;b.orientation==="h"?(z=x,I="x",D=l,R="y",B=!!b.yperiodalignment):(z=l,I="y",D=x,R="x",B=!!b.xperiodalignment);var F=n(b,R,D,f[T]),H=F[0],G=F[1],J=M.distinctVals(H,D),X=J.vals,Y=J.minDiff/2,Z,oe,re,se,N,U,q=(b.boxpoints||b.points)==="all"?M.identity:function(Lt){return Lt.v<Z.lf||Lt.v>Z.uf};if(b._hasPreCompStats){var $=b[I],W=function(Lt){return z.d2c((b[Lt]||[])[k])},K=1/0,ne=-1/0;for(k=0;k<b._length;k++){var ae=H[k];if(!!w(ae)){if(Z={},Z.pos=Z[R]=ae,B&&G&&(Z.orig_p=G[k]),Z.q1=W("q1"),Z.med=W("median"),Z.q3=W("q3"),oe=[],$&&M.isArrayOrTypedArray($[k]))for(P=0;P<$[k].length;P++)U=z.d2c($[k][P]),U!==e&&(N={v:U,i:[k,P]},o(N,b,[k,P]),oe.push(N));if(Z.pts=oe.sort(y),re=Z[I]=oe.map(p),se=re.length,Z.med!==e&&Z.q1!==e&&Z.q3!==e&&Z.med>=Z.q1&&Z.q3>=Z.med){var ie=W("lowerfence");Z.lf=ie!==e&&ie<=Z.q1?ie:g(Z,re,se);var le=W("upperfence");Z.uf=le!==e&&le>=Z.q3?le:h(Z,re,se);var ye=W("mean");Z.mean=ye!==e?ye:se?M.mean(re,se):(Z.q1+Z.q3)/2;var ue=W("sd");Z.sd=ye!==e&&ue>=0?ue:se?M.stdev(re,se,Z.mean):Z.q3-Z.q1,Z.lo=m(Z),Z.uo=u(Z);var pe=W("notchspan");pe=pe!==e&&pe>0?pe:_(Z,se),Z.ln=Z.med-pe,Z.un=Z.med+pe;var ge=Z.lf,Te=Z.uf;b.boxpoints&&re.length&&(ge=Math.min(ge,re[0]),Te=Math.max(Te,re[se-1])),b.notched&&(ge=Math.min(ge,Z.ln),Te=Math.max(Te,Z.un)),Z.min=ge,Z.max=Te}else{M.warn(["Invalid input - make sure that q1 <= median <= q3","q1 = "+Z.q1,"median = "+Z.med,"q3 = "+Z.q3].join(`
`));var _e;Z.med!==e?_e=Z.med:Z.q1!==e?Z.q3!==e?_e=(Z.q1+Z.q3)/2:_e=Z.q1:Z.q3!==e?_e=Z.q3:_e=0,Z.med=_e,Z.q1=Z.q3=_e,Z.lf=Z.uf=_e,Z.mean=Z.sd=_e,Z.ln=Z.un=_e,Z.min=Z.max=_e}K=Math.min(K,Z.min),ne=Math.max(ne,Z.max),Z.pts2=oe.filter(q),L.push(Z)}}b._extremes[z._id]=v.findExtremes(z,[K,ne],{padded:!0})}else{var ze=z.makeCalcdata(b,I),Oe=r(X,Y),Ye=X.length,be=t(Ye);for(k=0;k<b._length;k++)if(U=ze[k],!!w(U)){var Pe=M.findBin(H[k],Oe);Pe>=0&&Pe<Ye&&(N={v:U,i:k},o(N,b,k),be[Pe].push(N))}var Ge=1/0,Qe=-1/0,Be=b.quartilemethod,Le=Be==="exclusive",He=Be==="inclusive";for(k=0;k<Ye;k++)if(be[k].length>0){if(Z={},Z.pos=Z[R]=X[k],oe=Z.pts=be[k].sort(y),re=Z[I]=oe.map(p),se=re.length,Z.min=re[0],Z.max=re[se-1],Z.mean=M.mean(re,se),Z.sd=M.stdev(re,se,Z.mean),Z.med=M.interp(re,.5),se%2&&(Le||He)){var vt,Rt;Le?(vt=re.slice(0,se/2),Rt=re.slice(se/2+1)):He&&(vt=re.slice(0,se/2+1),Rt=re.slice(se/2)),Z.q1=M.interp(vt,.5),Z.q3=M.interp(Rt,.5)}else Z.q1=M.interp(re,.25),Z.q3=M.interp(re,.75);Z.lf=g(Z,re,se),Z.uf=h(Z,re,se),Z.lo=m(Z),Z.uo=u(Z);var rr=_(Z,se);Z.ln=Z.med-rr,Z.un=Z.med+rr,Ge=Math.min(Ge,Z.ln),Qe=Math.max(Qe,Z.un),Z.pts2=oe.filter(q),L.push(Z)}b._extremes[z._id]=v.findExtremes(z,b.notched?ze.concat([Ge,Qe]):ze,{padded:!0})}return i(L,b),L.length>0?(L[0].t={num:f[T],dPos:Y,posLetter:R,valLetter:I,labels:{med:a(A,"median:"),min:a(A,"min:"),q1:a(A,"q1:"),q3:a(A,"q3:"),max:a(A,"max:"),mean:b.boxmean==="sd"?a(A,"mean \xB1 \u03C3:"):a(A,"mean:"),lf:a(A,"lower fence:"),uf:a(A,"upper fence:")}},f[T]++,L):[{t:{empty:!0}}]};function n(s,A,b,f){var x=A in s,l=A+"0"in s,L="d"+A in s;if(x||l&&L){var T=b.makeCalcdata(s,A),k=S(s,b,A,T).vals;return[k,T]}var P;l?P=s[A+"0"]:"name"in s&&(b.type==="category"||w(s.name)&&["linear","log"].indexOf(b.type)!==-1||M.isDateTime(s.name)&&b.type==="date")?P=s.name:P=f;for(var z=b.type==="multicategory"?b.r2c_just_indices(P):b.d2c(P,0,s[A+"calendar"]),I=s._length,D=new Array(I),R=0;R<I;R++)D[R]=z;return[D]}function r(s,A){for(var b=s.length,f=new Array(b+1),x=0;x<b;x++)f[x]=s[x]-A;return f[b]=s[b-1]+A,f}function t(s){for(var A=new Array(s),b=0;b<s;b++)A[b]=[];return A}var c={text:"tx",hovertext:"htx"};function o(s,A,b){for(var f in c)M.isArrayOrTypedArray(A[f])&&(Array.isArray(b)?M.isArrayOrTypedArray(A[f][b[0]])&&(s[c[f]]=A[f][b[0]][b[1]]):s[c[f]]=A[f][b])}function i(s,A){if(M.isArrayOrTypedArray(A.selectedpoints))for(var b=0;b<s.length;b++){for(var f=s[b].pts||[],x={},l=0;l<f.length;l++)x[f[l].i]=l;M.tagSelected(f,A,x)}}function y(s,A){return s.v-A.v}function p(s){return s.v}function g(s,A,b){return b===0?s.q1:Math.min(s.q1,A[Math.min(M.findBin(2.5*s.q1-1.5*s.q3,A,!0)+1,b-1)])}function h(s,A,b){return b===0?s.q3:Math.max(s.q3,A[Math.max(M.findBin(2.5*s.q3-1.5*s.q1,A),0)])}function m(s){return 4*s.q1-3*s.q3}function u(s){return 4*s.q3-3*s.q1}function _(s,A){return A===0?0:1.57*(s.q3-s.q1)/Math.sqrt(A)}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/align_period":563,"../../plots/cartesian/axes":566,"fast-isnumeric":190}],684:[function(d,ee,te){var w=d("../../plots/cartesian/axes"),v=d("../../lib"),S=d("../../plots/cartesian/constraints").getAxisGroup,M=["v","h"];function e(n,r){for(var t=n.calcdata,c=r.xaxis,o=r.yaxis,i=0;i<M.length;i++){for(var y=M[i],p=y==="h"?o:c,g=[],h=0;h<t.length;h++){var m=t[h],u=m[0].t,_=m[0].trace;_.visible===!0&&(_.type==="box"||_.type==="candlestick")&&!u.empty&&(_.orientation||"v")===y&&_.xaxis===c._id&&_.yaxis===o._id&&g.push(h)}a("box",n,g,p)}}function a(n,r,t,c){var o=r.calcdata,i=r._fullLayout,y=c._id,p=y.charAt(0),g,h,m,u=[],_=0;for(g=0;g<t.length;g++)for(m=o[t[g]],h=0;h<m.length;h++)u.push(c.c2l(m[h].pos,!0)),_+=(m[h].pts2||[]).length;if(!!u.length){var s=v.distinctVals(u);(c.type==="category"||c.type==="multicategory")&&(s.minDiff=1);var A=s.minDiff/2;w.minDtick(c,s.minDiff,s.vals[0],!0);var b=n==="violin"?"_numViolins":"_numBoxes",f=i[b],x=i[n+"mode"]==="group"&&f>1,l=1-i[n+"gap"],L=1-i[n+"groupgap"];for(g=0;g<t.length;g++){m=o[t[g]];var T=m[0].trace,k=m[0].t,P=T.width,z=T.side,I,D,R,B;if(P)I=D=B=P/2,R=0;else if(I=A,x){var F=S(i,c._id)+T.orientation,H=i._alignmentOpts[F]||{},G=H[T.alignmentgroup]||{},J=Object.keys(G.offsetGroups||{}).length,X=J||f,Y=J?T._offsetIndex:k.num;D=I*l*L/X,R=2*I*(-.5+(Y+.5)/X)*l,B=I*l/X}else D=I*l*L,R=0,B=I;k.dPos=I,k.bPos=R,k.bdPos=D,k.wHover=B;var Z,oe,re=R+D,se,N,U,q,$,W,K=Boolean(P),ne=(T.boxpoints||T.points)&&_>0;if(z==="positive"?(Z=I*(P?1:.5),se=re,oe=se=R):z==="negative"?(Z=se=R,oe=I*(P?1:.5),N=re):(Z=oe=I,se=N=re),ne){var ae=T.pointpos,ie=T.jitter,le=T.marker.size/2,ye=0;ae+ie>=0&&(ye=re*(ae+ie),ye>Z?(K=!0,$=le,U=ye):ye>se&&($=le,U=Z)),ye<=Z&&(U=Z);var ue=0;ae-ie<=0&&(ue=-re*(ae-ie),ue>oe?(K=!0,W=le,q=ue):ue>N&&(W=le,q=oe)),ue<=oe&&(q=oe)}else U=Z,q=oe;var pe=new Array(m.length);for(h=0;h<m.length;h++)pe[h]=m[h].pos;T._extremes[y]=w.findExtremes(c,pe,{padded:K,vpadminus:q,vpadplus:U,vpadLinearized:!0,ppadminus:{x:W,y:$}[p],ppadplus:{x:$,y:W}[p]})}}}ee.exports={crossTraceCalc:e,setPositionOffset:a}},{"../../lib":515,"../../plots/cartesian/axes":566,"../../plots/cartesian/constraints":574}],685:[function(d,ee,te){var w=d("../../lib"),v=d("../../registry"),S=d("../../components/color"),M=d("../scatter/period_defaults"),e=d("../bar/defaults").handleGroupingDefaults,a=d("../../plots/cartesian/axis_autotype"),n=d("./attributes");function r(i,y,p,g){function h(x,l){return w.coerce(i,y,n,x,l)}if(t(i,y,h,g),y.visible!==!1){M(i,y,g,h),h("xhoverformat"),h("yhoverformat");var m=y._hasPreCompStats;m&&(h("lowerfence"),h("upperfence")),h("line.color",(i.marker||{}).color||p),h("line.width"),h("fillcolor",S.addOpacity(y.line.color,.5));var u=!1;if(m){var _=h("mean"),s=h("sd");_&&_.length&&(u=!0,s&&s.length&&(u="sd"))}h("boxmean",u),h("whiskerwidth"),h("width"),h("quartilemethod");var A=!1;if(m){var b=h("notchspan");b&&b.length&&(A=!0)}else w.validate(i.notchwidth,n.notchwidth)&&(A=!0);var f=h("notched",A);f&&h("notchwidth"),c(i,y,h,{prefix:"box"})}}function t(i,y,p,g){function h(J){var X=0;return J&&J.length&&(X+=1,w.isArrayOrTypedArray(J[0])&&J[0].length&&(X+=1)),X}function m(J){return w.validate(i[J],n[J])}var u=p("y"),_=p("x"),s;if(y.type==="box"){var A=p("q1"),b=p("median"),f=p("q3");y._hasPreCompStats=A&&A.length&&b&&b.length&&f&&f.length,s=Math.min(w.minRowLength(A),w.minRowLength(b),w.minRowLength(f))}var x=h(u),l=h(_),L=x&&w.minRowLength(u),T=l&&w.minRowLength(_),k=g.calendar,P={autotypenumbers:g.autotypenumbers},z,I;if(y._hasPreCompStats)switch(String(l)+String(x)){case"00":var D=m("x0")||m("dx"),R=m("y0")||m("dy");R&&!D?z="h":z="v",I=s;break;case"10":z="v",I=Math.min(s,T);break;case"20":z="h",I=Math.min(s,_.length);break;case"01":z="h",I=Math.min(s,L);break;case"02":z="v",I=Math.min(s,u.length);break;case"12":z="v",I=Math.min(s,T,u.length);break;case"21":z="h",I=Math.min(s,_.length,L);break;case"11":I=0;break;case"22":var B=!1,F;for(F=0;F<_.length;F++)if(a(_[F],k,P)==="category"){B=!0;break}if(B)z="v",I=Math.min(s,T,u.length);else{for(F=0;F<u.length;F++)if(a(u[F],k,P)==="category"){B=!0;break}B?(z="h",I=Math.min(s,_.length,L)):(z="v",I=Math.min(s,T,u.length))}break}else x>0?(z="v",l>0?I=Math.min(T,L):I=Math.min(L)):l>0?(z="h",I=Math.min(T)):I=0;if(!I){y.visible=!1;return}y._length=I;var H=p("orientation",z);y._hasPreCompStats?H==="v"&&l===0?(p("x0",0),p("dx",1)):H==="h"&&x===0&&(p("y0",0),p("dy",1)):H==="v"&&l===0?p("x0"):H==="h"&&x===0&&p("y0");var G=v.getComponentMethod("calendars","handleTraceDefaults");G(i,y,["x","y"],g)}function c(i,y,p,g){var h=g.prefix,m=w.coerce2(i,y,n,"marker.outliercolor"),u=p("marker.line.outliercolor"),_="outliers";y._hasPreCompStats?_="all":(m||u)&&(_="suspectedoutliers");var s=p(h+"points",_);s?(p("jitter",s==="all"?.3:0),p("pointpos",s==="all"?-1.5:0),p("marker.symbol"),p("marker.opacity"),p("marker.size"),p("marker.color",y.line.color),p("marker.line.color"),p("marker.line.width"),s==="suspectedoutliers"&&(p("marker.line.outliercolor",y.marker.color),p("marker.line.outlierwidth")),p("selected.marker.color"),p("unselected.marker.color"),p("selected.marker.size"),p("unselected.marker.size"),p("text"),p("hovertext")):delete y.marker;var A=p("hoveron");(A==="all"||A.indexOf("points")!==-1)&&p("hovertemplate"),w.coerceSelectionMarkerOpacity(y,p)}function o(i,y){var p,g;function h(_){return w.coerce(g._input,g,n,_)}for(var m=0;m<i.length;m++){g=i[m];var u=g.type;(u==="box"||u==="violin")&&(p=g._input,y[u+"mode"]==="group"&&e(p,g,y,h))}}ee.exports={supplyDefaults:r,crossTraceDefaults:o,handleSampleDefaults:t,handlePointsDefaults:c}},{"../../components/color":367,"../../lib":515,"../../plots/cartesian/axis_autotype":567,"../../registry":647,"../bar/defaults":661,"../scatter/period_defaults":956,"./attributes":682}],686:[function(d,ee,te){ee.exports=function(v,S){return S.hoverOnBox&&(v.hoverOnBox=S.hoverOnBox),"xVal"in S&&(v.x=S.xVal),"yVal"in S&&(v.y=S.yVal),S.xa&&(v.xaxis=S.xa),S.ya&&(v.yaxis=S.ya),v}},{}],687:[function(d,ee,te){var w=d("../../plots/cartesian/axes"),v=d("../../lib"),S=d("../../components/fx"),M=d("../../components/color"),e=v.fillText;function a(t,c,o,i){var y=t.cd,p=y[0].trace,g=p.hoveron,h=[],m;return g.indexOf("boxes")!==-1&&(h=h.concat(n(t,c,o,i))),g.indexOf("points")!==-1&&(m=r(t,c,o)),i==="closest"?m?[m]:h:(m&&h.push(m),h)}function n(t,c,o,i){var y=t.cd,p=t.xa,g=t.ya,h=y[0].trace,m=y[0].t,u=h.type==="violin",_,s,A,b,f,x,l,L,T,k,P,z=m.bdPos,I,D,R=m.wHover,B=function(ue){return A.c2l(ue.pos)+m.bPos-A.c2l(x)};u&&h.side!=="both"?(h.side==="positive"&&(T=function(ue){var pe=B(ue);return S.inbox(pe,pe+R,k)},I=z,D=0),h.side==="negative"&&(T=function(ue){var pe=B(ue);return S.inbox(pe-R,pe,k)},I=0,D=z)):(T=function(ue){var pe=B(ue);return S.inbox(pe-R,pe+R,k)},I=D=z);var F;u?F=function(ue){return S.inbox(ue.span[0]-f,ue.span[1]-f,k)}:F=function(ue){return S.inbox(ue.min-f,ue.max-f,k)},h.orientation==="h"?(f=c,x=o,l=F,L=T,_="y",A=g,s="x",b=p):(f=o,x=c,l=T,L=F,_="x",A=p,s="y",b=g);var H=Math.min(1,z/Math.abs(A.r2c(A.range[1])-A.r2c(A.range[0])));k=t.maxHoverDistance-H,P=t.maxSpikeDistance-H;function G(ue){return(l(ue)+L(ue))/2}var J=S.getDistanceFunction(i,l,L,G);if(S.getClosest(y,J,t),t.index===!1)return[];var X=y[t.index],Y=h.line.color,Z=(h.marker||{}).color;M.opacity(Y)&&h.line.width?t.color=Y:M.opacity(Z)&&h.boxpoints?t.color=Z:t.color=h.fillcolor,t[_+"0"]=A.c2p(X.pos+m.bPos-D,!0),t[_+"1"]=A.c2p(X.pos+m.bPos+I,!0),t[_+"LabelVal"]=X.orig_p!==void 0?X.orig_p:X.pos;var oe=_+"Spike";t.spikeDistance=G(X)*P/k,t[oe]=A.c2p(X.pos,!0);var re=h.boxmean||(h.meanline||{}).visible,se=h.boxpoints||h.points,N=se&&re?["max","uf","q3","med","mean","q1","lf","min"]:se&&!re?["max","uf","q3","med","q1","lf","min"]:!se&&re?["max","q3","med","mean","q1","min"]:["max","q3","med","q1","min"],U=b.range[1]<b.range[0];h.orientation===(U?"v":"h")&&N.reverse();for(var q=t.spikeDistance,$=t[oe],W=[],K=0;K<N.length;K++){var ne=N[K];if(ne in X){var ae=X[ne],ie=b.c2p(ae,!0),le=v.extendFlat({},t);le.attr=ne,le[s+"0"]=le[s+"1"]=ie,le[s+"LabelVal"]=ae,le[s+"Label"]=(m.labels?m.labels[ne]+" ":"")+w.hoverLabelText(b,ae,h[s+"hoverformat"]),le.hoverOnBox=!0,ne==="mean"&&"sd"in X&&h.boxmean==="sd"&&(le[s+"err"]=X.sd),le.hovertemplate=!1,W.push(le)}}t.name="",t.spikeDistance=void 0,t[oe]=void 0;for(var ye=0;ye<W.length;ye++)W[ye].attr!=="med"?(W[ye].name="",W[ye].spikeDistance=void 0,W[ye][oe]=void 0):(W[ye].spikeDistance=q,W[ye][oe]=$);return W}function r(t,c,o){for(var i=t.cd,y=t.xa,p=t.ya,g=i[0].trace,h=y.c2p(c),m=p.c2p(o),u,_=function(F){var H=Math.max(3,F.mrc||0);return Math.max(Math.abs(y.c2p(F.x)-h)-H,1-3/H)},s=function(F){var H=Math.max(3,F.mrc||0);return Math.max(Math.abs(p.c2p(F.y)-m)-H,1-3/H)},A=S.quadrature(_,s),b=!1,f,x,l=0;l<i.length;l++){f=i[l];for(var L=0;L<(f.pts||[]).length;L++){x=f.pts[L];var T=A(x);T<=t.distance&&(t.distance=T,b=[l,L])}}if(!b)return!1;f=i[b[0]],x=f.pts[b[1]];var k=y.c2p(x.x,!0),P=p.c2p(x.y,!0),z=x.mrc||1;u=v.extendFlat({},t,{index:x.i,color:(g.marker||{}).color,name:g.name,x0:k-z,x1:k+z,y0:P-z,y1:P+z,spikeDistance:t.distance,hovertemplate:g.hovertemplate});var I=f.orig_p,D=I!==void 0?I:f.pos,R;g.orientation==="h"?(R=p,u.xLabelVal=x.x,u.yLabelVal=D):(R=y,u.xLabelVal=D,u.yLabelVal=x.y);var B=R._id.charAt(0);return u[B+"Spike"]=R.c2p(f.pos,!0),e(x,g,u),u}ee.exports={hoverPoints:a,hoverOnBoxes:n,hoverOnPoints:r}},{"../../components/color":367,"../../components/fx":407,"../../lib":515,"../../plots/cartesian/axes":566}],688:[function(d,ee,te){ee.exports={attributes:d("./attributes"),layoutAttributes:d("./layout_attributes"),supplyDefaults:d("./defaults").supplyDefaults,crossTraceDefaults:d("./defaults").crossTraceDefaults,supplyLayoutDefaults:d("./layout_defaults").supplyLayoutDefaults,calc:d("./calc"),crossTraceCalc:d("./cross_trace_calc").crossTraceCalc,plot:d("./plot").plot,style:d("./style").style,styleOnSelect:d("./style").styleOnSelect,hoverPoints:d("./hover").hoverPoints,eventData:d("./event_data"),selectPoints:d("./select"),moduleType:"trace",name:"box",basePlotModule:d("../../plots/cartesian"),categories:["cartesian","svg","symbols","oriented","box-violin","showLegend","boxLayout","zoomScale"],meta:{}}},{"../../plots/cartesian":578,"./attributes":682,"./calc":683,"./cross_trace_calc":684,"./defaults":685,"./event_data":686,"./hover":687,"./layout_attributes":689,"./layout_defaults":690,"./plot":691,"./select":692,"./style":693}],689:[function(d,ee,te){ee.exports={boxmode:{valType:"enumerated",values:["group","overlay"],dflt:"overlay",editType:"calc"},boxgap:{valType:"number",min:0,max:1,dflt:.3,editType:"calc"},boxgroupgap:{valType:"number",min:0,max:1,dflt:.3,editType:"calc"}}},{}],690:[function(d,ee,te){var w=d("../../registry"),v=d("../../lib"),S=d("./layout_attributes");function M(a,n,r,t,c){for(var o=c+"Layout",i=!1,y=0;y<r.length;y++){var p=r[y];if(w.traceIs(p,o)){i=!0;break}}!i||(t(c+"mode"),t(c+"gap"),t(c+"groupgap"))}function e(a,n,r){function t(c,o){return v.coerce(a,n,S,c,o)}M(a,n,r,t,"box")}ee.exports={supplyLayoutDefaults:e,_supply:M}},{"../../lib":515,"../../registry":647,"./layout_attributes":689}],691:[function(d,ee,te){var w=d("@plotly/d3"),v=d("../../lib"),S=d("../../components/drawing"),M=5,e=.01;function a(c,o,i,y){var p=o.xaxis,g=o.yaxis;v.makeTraceGroups(y,i,"trace boxes").each(function(h){var m=w.select(this),u=h[0],_=u.t,s=u.trace;if(_.wdPos=_.bdPos*s.whiskerwidth,s.visible!==!0||_.empty){m.remove();return}var A,b;s.orientation==="h"?(A=g,b=p):(A=p,b=g),n(m,{pos:A,val:b},s,_),r(m,{x:p,y:g},s,_),t(m,{pos:A,val:b},s,_)})}function n(c,o,i,y){var p=i.orientation==="h",g=o.val,h=o.pos,m=!!h.rangebreaks,u=y.bPos,_=y.wdPos||0,s=y.bPosPxOffset||0,A=i.whiskerwidth||0,b=i.notched||!1,f=b?1-2*i.notchwidth:1,x,l;Array.isArray(y.bdPos)?(x=y.bdPos[0],l=y.bdPos[1]):(x=y.bdPos,l=y.bdPos);var L=c.selectAll("path.box").data(i.type!=="violin"||i.box.visible?v.identity:[]);L.enter().append("path").style("vector-effect","non-scaling-stroke").attr("class","box"),L.exit().remove(),L.each(function(T){if(T.empty)return"M0,0Z";var k=h.c2l(T.pos+u,!0),P=h.l2p(k-x)+s,z=h.l2p(k+l)+s,I=m?(P+z)/2:h.l2p(k)+s,D=i.whiskerwidth,R=m?P*D+(1-D)*I:h.l2p(k-_)+s,B=m?z*D+(1-D)*I:h.l2p(k+_)+s,F=h.l2p(k-x*f)+s,H=h.l2p(k+l*f)+s,G=g.c2p(T.q1,!0),J=g.c2p(T.q3,!0),X=v.constrain(g.c2p(T.med,!0),Math.min(G,J)+1,Math.max(G,J)-1),Y=T.lf===void 0||i.boxpoints===!1,Z=g.c2p(Y?T.min:T.lf,!0),oe=g.c2p(Y?T.max:T.uf,!0),re=g.c2p(T.ln,!0),se=g.c2p(T.un,!0);p?w.select(this).attr("d","M"+X+","+F+"V"+H+"M"+G+","+P+"V"+z+(b?"H"+re+"L"+X+","+H+"L"+se+","+z:"")+"H"+J+"V"+P+(b?"H"+se+"L"+X+","+F+"L"+re+","+P:"")+"ZM"+G+","+I+"H"+Z+"M"+J+","+I+"H"+oe+(A===0?"":"M"+Z+","+R+"V"+B+"M"+oe+","+R+"V"+B)):w.select(this).attr("d","M"+F+","+X+"H"+H+"M"+P+","+G+"H"+z+(b?"V"+re+"L"+H+","+X+"L"+z+","+se:"")+"V"+J+"H"+P+(b?"V"+se+"L"+F+","+X+"L"+P+","+re:"")+"ZM"+I+","+G+"V"+Z+"M"+I+","+J+"V"+oe+(A===0?"":"M"+R+","+Z+"H"+B+"M"+R+","+oe+"H"+B))})}function r(c,o,i,y){var p=o.x,g=o.y,h=y.bdPos,m=y.bPos,u=i.boxpoints||i.points;v.seedPseudoRandom();var _=function(b){return b.forEach(function(f){f.t=y,f.trace=i}),b},s=c.selectAll("g.points").data(u?_:[]);s.enter().append("g").attr("class","points"),s.exit().remove();var A=s.selectAll("path").data(function(b){var f,x=b.pts2,l=Math.max((b.max-b.min)/10,b.q3-b.q1),L=l*1e-9,T=l*e,k=[],P=0,z;if(i.jitter){if(l===0)for(P=1,k=new Array(x.length),f=0;f<x.length;f++)k[f]=1;else for(f=0;f<x.length;f++){var I=Math.max(0,f-M),D=x[I].v,R=Math.min(x.length-1,f+M),B=x[R].v;u!=="all"&&(x[f].v<b.lf?B=Math.min(B,b.lf):D=Math.max(D,b.uf));var F=Math.sqrt(T*(R-I)/(B-D+L))||0;F=v.constrain(Math.abs(F),0,1),k.push(F),P=Math.max(F,P)}z=i.jitter*2/(P||1)}for(f=0;f<x.length;f++){var H=x[f],G=H.v,J=i.jitter?z*k[f]*(v.pseudoRandom()-.5):0,X=b.pos+m+h*(i.pointpos+J);i.orientation==="h"?(H.y=X,H.x=G):(H.x=X,H.y=G),u==="suspectedoutliers"&&G<b.uo&&G>b.lo&&(H.so=!0)}return x});A.enter().append("path").classed("point",!0),A.exit().remove(),A.call(S.translatePoints,p,g)}function t(c,o,i,y){var p=o.val,g=o.pos,h=!!g.rangebreaks,m=y.bPos,u=y.bPosPxOffset||0,_=i.boxmean||(i.meanline||{}).visible,s,A;Array.isArray(y.bdPos)?(s=y.bdPos[0],A=y.bdPos[1]):(s=y.bdPos,A=y.bdPos);var b=c.selectAll("path.mean").data(i.type==="box"&&i.boxmean||i.type==="violin"&&i.box.visible&&i.meanline.visible?v.identity:[]);b.enter().append("path").attr("class","mean").style({fill:"none","vector-effect":"non-scaling-stroke"}),b.exit().remove(),b.each(function(f){var x=g.c2l(f.pos+m,!0),l=g.l2p(x-s)+u,L=g.l2p(x+A)+u,T=h?(l+L)/2:g.l2p(x)+u,k=p.c2p(f.mean,!0),P=p.c2p(f.mean-f.sd,!0),z=p.c2p(f.mean+f.sd,!0);i.orientation==="h"?w.select(this).attr("d","M"+k+","+l+"V"+L+(_==="sd"?"m0,0L"+P+","+T+"L"+k+","+l+"L"+z+","+T+"Z":"")):w.select(this).attr("d","M"+l+","+k+"H"+L+(_==="sd"?"m0,0L"+T+","+P+"L"+l+","+k+"L"+T+","+z+"Z":""))})}ee.exports={plot:a,plotBoxAndWhiskers:n,plotPoints:r,plotBoxMean:t}},{"../../components/drawing":389,"../../lib":515,"@plotly/d3":58}],692:[function(d,ee,te){ee.exports=function(v,S){var M=v.cd,e=v.xaxis,a=v.yaxis,n=[],r,t;if(S===!1)for(r=0;r<M.length;r++)for(t=0;t<(M[r].pts||[]).length;t++)M[r].pts[t].selected=0;else for(r=0;r<M.length;r++)for(t=0;t<(M[r].pts||[]).length;t++){var c=M[r].pts[t],o=e.c2p(c.x),i=a.c2p(c.y);S.contains([o,i],null,c.i,v)?(n.push({pointNumber:c.i,x:e.c2d(c.x),y:a.c2d(c.y)}),c.selected=1):c.selected=0}return n}},{}],693:[function(d,ee,te){var w=d("@plotly/d3"),v=d("../../components/color"),S=d("../../components/drawing");function M(a,n,r){var t=r||w.select(a).selectAll("g.trace.boxes");t.style("opacity",function(c){return c[0].trace.opacity}),t.each(function(c){var o=w.select(this),i=c[0].trace,y=i.line.width;function p(m,u,_,s){m.style("stroke-width",u+"px").call(v.stroke,_).call(v.fill,s)}var g=o.selectAll("path.box");if(i.type==="candlestick")g.each(function(m){if(!m.empty){var u=w.select(this),_=i[m.dir];p(u,_.line.width,_.line.color,_.fillcolor),u.style("opacity",i.selectedpoints&&!m.selected?.3:1)}});else{p(g,y,i.line.color,i.fillcolor),o.selectAll("path.mean").style({"stroke-width":y,"stroke-dasharray":2*y+"px,"+y+"px"}).call(v.stroke,i.line.color);var h=o.selectAll("path.point");S.pointStyle(h,i,a)}})}function e(a,n,r){var t=n[0].trace,c=r.selectAll("path.point");t.selectedpoints?S.selectedPointStyle(c,t):S.pointStyle(c,t,a)}ee.exports={style:M,styleOnSelect:e}},{"../../components/color":367,"../../components/drawing":389,"@plotly/d3":58}],694:[function(d,ee,te){var w=d("../../lib").extendFlat,v=d("../../plots/cartesian/axis_format_attributes").axisHoverFormat,S=d("../ohlc/attributes"),M=d("../box/attributes");function e(a){return{line:{color:w({},M.line.color,{dflt:a}),width:M.line.width,editType:"style"},fillcolor:M.fillcolor,editType:"style"}}ee.exports={xperiod:S.xperiod,xperiod0:S.xperiod0,xperiodalignment:S.xperiodalignment,xhoverformat:v("x"),yhoverformat:v("y"),x:S.x,open:S.open,high:S.high,low:S.low,close:S.close,line:{width:w({},M.line.width,{}),editType:"style"},increasing:e(S.increasing.line.color.dflt),decreasing:e(S.decreasing.line.color.dflt),text:S.text,hovertext:S.hovertext,whiskerwidth:w({},M.whiskerwidth,{dflt:0}),hoverlabel:S.hoverlabel}},{"../../lib":515,"../../plots/cartesian/axis_format_attributes":569,"../box/attributes":682,"../ohlc/attributes":881}],695:[function(d,ee,te){var w=d("../../lib"),v=d("../../plots/cartesian/axes"),S=d("../../plots/cartesian/align_period"),M=d("../ohlc/calc").calcCommon;ee.exports=function(a,n){var r=a._fullLayout,t=v.getFromId(a,n.xaxis),c=v.getFromId(a,n.yaxis),o=t.makeCalcdata(n,"x"),i=S(n,t,"x",o).vals,y=M(a,n,o,i,c,e);return y.length?(w.extendFlat(y[0].t,{num:r._numBoxes,dPos:w.distinctVals(i).minDiff/2,posLetter:"x",valLetter:"y"}),r._numBoxes++,y):[{t:{empty:!0}}]};function e(a,n,r,t){return{min:r,q1:Math.min(a,t),med:t,q3:Math.max(a,t),max:n}}},{"../../lib":515,"../../plots/cartesian/align_period":563,"../../plots/cartesian/axes":566,"../ohlc/calc":882}],696:[function(d,ee,te){var w=d("../../lib"),v=d("../../components/color"),S=d("../ohlc/ohlc_defaults"),M=d("../scatter/period_defaults"),e=d("./attributes");ee.exports=function(r,t,c,o){function i(p,g){return w.coerce(r,t,e,p,g)}var y=S(r,t,i,o);if(!y){t.visible=!1;return}M(r,t,o,i,{x:!0}),i("xhoverformat"),i("yhoverformat"),i("line.width"),a(r,t,i,"increasing"),a(r,t,i,"decreasing"),i("text"),i("hovertext"),i("whiskerwidth"),o._requestRangeslider[t.xaxis]=!0};function a(n,r,t,c){var o=t(c+".line.color");t(c+".line.width",r.line.width),t(c+".fillcolor",v.addOpacity(o,.5))}},{"../../components/color":367,"../../lib":515,"../ohlc/ohlc_defaults":886,"../scatter/period_defaults":956,"./attributes":694}],697:[function(d,ee,te){ee.exports={moduleType:"trace",name:"candlestick",basePlotModule:d("../../plots/cartesian"),categories:["cartesian","svg","showLegend","candlestick","boxLayout"],meta:{},attributes:d("./attributes"),layoutAttributes:d("../box/layout_attributes"),supplyLayoutDefaults:d("../box/layout_defaults").supplyLayoutDefaults,crossTraceCalc:d("../box/cross_trace_calc").crossTraceCalc,supplyDefaults:d("./defaults"),calc:d("./calc"),plot:d("../box/plot").plot,layerName:"boxlayer",style:d("../box/style").style,hoverPoints:d("../ohlc/hover").hoverPoints,selectPoints:d("../ohlc/select")}},{"../../plots/cartesian":578,"../box/cross_trace_calc":684,"../box/layout_attributes":689,"../box/layout_defaults":690,"../box/plot":691,"../box/style":693,"../ohlc/hover":884,"../ohlc/select":888,"./attributes":694,"./calc":695,"./defaults":696}],698:[function(d,ee,te){var w=d("./axis_defaults"),v=d("../../plot_api/plot_template");ee.exports=function(e,a,n,r,t){var c=r("a");c||(r("da"),r("a0"));var o=r("b");o||(r("db"),r("b0")),S(e,a,n,t)};function S(M,e,a,n){var r=["aaxis","baxis"];r.forEach(function(t){var c=t.charAt(0),o=M[t]||{},i=v.newContainer(e,t),y={noTicklabelstep:!0,tickfont:"x",id:c+"axis",letter:c,font:e.font,name:t,data:M[c],calendar:e.calendar,dfltColor:n,bgColor:a.paper_bgcolor,autotypenumbersDflt:a.autotypenumbers,fullLayout:a};w(o,i,y),i._categories=i._categories||[],!M[t]&&o.type!=="-"&&(M[t]={type:o.type})})}},{"../../plot_api/plot_template":555,"./axis_defaults":703}],699:[function(d,ee,te){var w=d("../../lib").isArrayOrTypedArray;ee.exports=function(S){return v(S,0)};function v(S,M){if(!w(S)||M>=10)return null;for(var e=1/0,a=-1/0,n=S.length,r=0;r<n;r++){var t=S[r];if(w(t)){var c=v(t,M+1);c&&(e=Math.min(c[0],e),a=Math.max(c[1],a))}else e=Math.min(t,e),a=Math.max(t,a)}return[e,a]}},{"../../lib":515}],700:[function(d,ee,te){var w=d("../../plots/font_attributes"),v=d("./axis_attributes"),S=d("../../components/color/attributes"),M=w({editType:"calc"});M.family.dflt='"Open Sans", verdana, arial, sans-serif',M.size.dflt=12,M.color.dflt=S.defaultLine,ee.exports={carpet:{valType:"string",editType:"calc"},x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},a:{valType:"data_array",editType:"calc"},a0:{valType:"number",dflt:0,editType:"calc"},da:{valType:"number",dflt:1,editType:"calc"},b:{valType:"data_array",editType:"calc"},b0:{valType:"number",dflt:0,editType:"calc"},db:{valType:"number",dflt:1,editType:"calc"},cheaterslope:{valType:"number",dflt:1,editType:"calc"},aaxis:v,baxis:v,font:M,color:{valType:"color",dflt:S.defaultLine,editType:"plot"},transforms:void 0}},{"../../components/color/attributes":366,"../../plots/font_attributes":594,"./axis_attributes":702}],701:[function(d,ee,te){var w=d("../../lib").isArrayOrTypedArray;ee.exports=function(v,S,M,e){var a,n,r,t,c,o,i,y,p,g,h,m,u,_=w(M)?"a":"b",s=_==="a"?v.aaxis:v.baxis,A=s.smoothing,b=_==="a"?v.a2i:v.b2j,f=_==="a"?M:e,x=_==="a"?e:M,l=_==="a"?S.a.length:S.b.length,L=_==="a"?S.b.length:S.a.length,T=Math.floor(_==="a"?v.b2j(x):v.a2i(x)),k=_==="a"?function(Y){return v.evalxy([],Y,T)}:function(Y){return v.evalxy([],T,Y)};A&&(r=Math.max(0,Math.min(L-2,T)),t=T-r,n=_==="a"?function(Y,Z){return v.dxydi([],Y,r,Z,t)}:function(Y,Z){return v.dxydj([],r,Y,t,Z)});var P=b(f[0]),z=b(f[1]),I=P<z?1:-1,D=(z-P)*1e-8,R=I>0?Math.floor:Math.ceil,B=I>0?Math.ceil:Math.floor,F=I>0?Math.min:Math.max,H=I>0?Math.max:Math.min,G=R(P+D),J=B(z-D);i=k(P);var X=[[i]];for(a=G;a*I<J*I;a+=I)c=[],h=H(P,a),m=F(z,a+I),u=m-h,o=Math.max(0,Math.min(l-2,Math.floor(.5*(h+m)))),y=k(m),A&&(p=n(o,h-o),g=n(o,m-o),c.push([i[0]+p[0]/3*u,i[1]+p[1]/3*u]),c.push([y[0]-g[0]/3*u,y[1]-g[1]/3*u])),c.push(y),X.push(c),i=y;return X}},{"../../lib":515}],702:[function(d,ee,te){var w=d("../../plots/font_attributes"),v=d("../../components/color/attributes"),S=d("../../plots/cartesian/layout_attributes"),M=d("../../plots/cartesian/axis_format_attributes").descriptionWithDates,e=d("../../plot_api/edit_types").overrideAll,a=d("../../components/drawing/attributes").dash,n=d("../../lib/extend").extendFlat;ee.exports={color:{valType:"color",editType:"calc"},smoothing:{valType:"number",dflt:1,min:0,max:1.3,editType:"calc"},title:{text:{valType:"string",dflt:"",editType:"calc"},font:w({editType:"calc"}),offset:{valType:"number",dflt:10,editType:"calc"},editType:"calc"},type:{valType:"enumerated",values:["-","linear","date","category"],dflt:"-",editType:"calc"},autotypenumbers:S.autotypenumbers,autorange:{valType:"enumerated",values:[!0,!1,"reversed"],dflt:!0,editType:"calc"},rangemode:{valType:"enumerated",values:["normal","tozero","nonnegative"],dflt:"normal",editType:"calc"},range:{valType:"info_array",editType:"calc",items:[{valType:"any",editType:"calc"},{valType:"any",editType:"calc"}]},fixedrange:{valType:"boolean",dflt:!1,editType:"calc"},cheatertype:{valType:"enumerated",values:["index","value"],dflt:"value",editType:"calc"},tickmode:{valType:"enumerated",values:["linear","array"],dflt:"array",editType:"calc"},nticks:{valType:"integer",min:0,dflt:0,editType:"calc"},tickvals:{valType:"data_array",editType:"calc"},ticktext:{valType:"data_array",editType:"calc"},showticklabels:{valType:"enumerated",values:["start","end","both","none"],dflt:"start",editType:"calc"},tickfont:w({editType:"calc"}),tickangle:{valType:"angle",dflt:"auto",editType:"calc"},tickprefix:{valType:"string",dflt:"",editType:"calc"},showtickprefix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"calc"},ticksuffix:{valType:"string",dflt:"",editType:"calc"},showticksuffix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"calc"},showexponent:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"calc"},exponentformat:{valType:"enumerated",values:["none","e","E","power","SI","B"],dflt:"B",editType:"calc"},minexponent:{valType:"number",dflt:3,min:0,editType:"calc"},separatethousands:{valType:"boolean",dflt:!1,editType:"calc"},tickformat:{valType:"string",dflt:"",editType:"calc",description:M("tick label")},tickformatstops:e(S.tickformatstops,"calc","from-root"),categoryorder:{valType:"enumerated",values:["trace","category ascending","category descending","array"],dflt:"trace",editType:"calc"},categoryarray:{valType:"data_array",editType:"calc"},labelpadding:{valType:"integer",dflt:10,editType:"calc"},labelprefix:{valType:"string",editType:"calc"},labelsuffix:{valType:"string",dflt:"",editType:"calc"},showline:{valType:"boolean",dflt:!1,editType:"calc"},linecolor:{valType:"color",dflt:v.defaultLine,editType:"calc"},linewidth:{valType:"number",min:0,dflt:1,editType:"calc"},gridcolor:{valType:"color",editType:"calc"},gridwidth:{valType:"number",min:0,dflt:1,editType:"calc"},griddash:n({},a,{editType:"calc"}),showgrid:{valType:"boolean",dflt:!0,editType:"calc"},minorgridcount:{valType:"integer",min:0,dflt:0,editType:"calc"},minorgridwidth:{valType:"number",min:0,dflt:1,editType:"calc"},minorgriddash:n({},a,{editType:"calc"}),minorgridcolor:{valType:"color",dflt:v.lightLine,editType:"calc"},startline:{valType:"boolean",editType:"calc"},startlinecolor:{valType:"color",editType:"calc"},startlinewidth:{valType:"number",dflt:1,editType:"calc"},endline:{valType:"boolean",editType:"calc"},endlinewidth:{valType:"number",dflt:1,editType:"calc"},endlinecolor:{valType:"color",editType:"calc"},tick0:{valType:"number",min:0,dflt:0,editType:"calc"},dtick:{valType:"number",min:0,dflt:1,editType:"calc"},arraytick0:{valType:"integer",min:0,dflt:0,editType:"calc"},arraydtick:{valType:"integer",min:1,dflt:1,editType:"calc"},_deprecated:{title:{valType:"string",editType:"calc"},titlefont:w({editType:"calc"}),titleoffset:{valType:"number",dflt:10,editType:"calc"}},editType:"calc"}},{"../../components/color/attributes":366,"../../components/drawing/attributes":388,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plots/cartesian/axis_format_attributes":569,"../../plots/cartesian/layout_attributes":579,"../../plots/font_attributes":594}],703:[function(d,ee,te){var w=d("./attributes"),v=d("../../components/color").addOpacity,S=d("../../registry"),M=d("../../lib"),e=d("../../plots/cartesian/tick_value_defaults"),a=d("../../plots/cartesian/tick_label_defaults"),n=d("../../plots/cartesian/prefix_suffix_defaults"),r=d("../../plots/cartesian/category_order_defaults"),t=d("../../plots/cartesian/set_convert"),c=d("../../plots/cartesian/axis_autotype");ee.exports=function(y,p,g){var h=g.letter,m=g.font||{},u=w[h+"axis"];function _(G,J){return M.coerce(y,p,u,G,J)}function s(G,J){return M.coerce2(y,p,u,G,J)}g.name&&(p._name=g.name,p._id=g.name),_("autotypenumbers",g.autotypenumbersDflt);var A=_("type");if(A==="-"&&(g.data&&o(p,g.data),p.type==="-"?p.type="linear":A=y.type=p.type),_("smoothing"),_("cheatertype"),_("showticklabels"),_("labelprefix",h+" = "),_("labelsuffix"),_("showtickprefix"),_("showticksuffix"),_("separatethousands"),_("tickformat"),_("exponentformat"),_("minexponent"),_("showexponent"),_("categoryorder"),_("tickmode"),_("tickvals"),_("ticktext"),_("tick0"),_("dtick"),p.tickmode==="array"&&(_("arraytick0"),_("arraydtick")),_("labelpadding"),p._hovertitle=h,A==="date"){var b=S.getComponentMethod("calendars","handleDefaults");b(y,p,"calendar",g.calendar)}t(p,g.fullLayout),p.c2p=M.identity;var f=_("color",g.dfltColor),x=f===y.color?f:m.color,l=_("title.text");l&&(M.coerceFont(_,"title.font",{family:m.family,size:M.bigFont(m.size),color:x}),_("title.offset")),_("tickangle");var L=_("autorange",!p.isValidRange(y.range));L&&_("rangemode"),_("range"),p.cleanRange(),_("fixedrange"),e(y,p,_,A),n(y,p,_,A,g),a(y,p,_,A,g),r(y,p,_,{data:g.data,dataAttr:h});var T=s("gridcolor",v(f,.3)),k=s("gridwidth"),P=s("griddash"),z=_("showgrid");z||(delete p.gridcolor,delete p.gridwidth,delete p.griddash);var I=s("startlinecolor",f),D=s("startlinewidth",k),R=_("startline",p.showgrid||!!I||!!D);R||(delete p.startlinecolor,delete p.startlinewidth);var B=s("endlinecolor",f),F=s("endlinewidth",k),H=_("endline",p.showgrid||!!B||!!F);return H||(delete p.endlinecolor,delete p.endlinewidth),z?(_("minorgridcount"),_("minorgridwidth",k),_("minorgriddash",P),_("minorgridcolor",v(T,.06)),p.minorgridcount||(delete p.minorgridwidth,delete p.minorgriddash,delete p.minorgridcolor)):(delete p.gridcolor,delete p.gridwidth,delete p.griddash),p.showticklabels==="none"&&(delete p.tickfont,delete p.tickangle,delete p.showexponent,delete p.exponentformat,delete p.minexponent,delete p.tickformat,delete p.showticksuffix,delete p.showtickprefix),p.showticksuffix||delete p.ticksuffix,p.showtickprefix||delete p.tickprefix,_("tickmode"),p};function o(i,y){if(i.type==="-"){var p=i._id,g=p.charAt(0),h=g+"calendar",m=i[h];i.type=c(y,m,{autotypenumbers:i.autotypenumbers})}}},{"../../components/color":367,"../../lib":515,"../../plots/cartesian/axis_autotype":567,"../../plots/cartesian/category_order_defaults":571,"../../plots/cartesian/prefix_suffix_defaults":583,"../../plots/cartesian/set_convert":585,"../../plots/cartesian/tick_label_defaults":587,"../../plots/cartesian/tick_value_defaults":589,"../../registry":647,"./attributes":700}],704:[function(d,ee,te){var w=d("../../plots/cartesian/axes"),v=d("../../lib").isArray1D,S=d("./cheater_basis"),M=d("./array_minmax"),e=d("./calc_gridlines"),a=d("./calc_labels"),n=d("./calc_clippath"),r=d("../heatmap/clean_2d_array"),t=d("./smooth_fill_2d_array"),c=d("../heatmap/convert_column_xyz"),o=d("./set_convert");ee.exports=function(y,p){var g=w.getFromId(y,p.xaxis),h=w.getFromId(y,p.yaxis),m=p.aaxis,u=p.baxis,_=p.x,s=p.y,A=[];_&&v(_)&&A.push("x"),s&&v(s)&&A.push("y"),A.length&&c(p,m,u,"a","b",A);var b=p._a=p._a||p.a,f=p._b=p._b||p.b;_=p._x||p.x,s=p._y||p.y;var x={};if(p._cheater){var l=m.cheatertype==="index"?b.length:b,L=u.cheatertype==="index"?f.length:f;_=S(l,L,p.cheaterslope)}p._x=_=r(_),p._y=s=r(s),t(_,b,f),t(s,b,f),o(p),p.setScale();var T=M(_),k=M(s),P=.5*(T[1]-T[0]),z=.5*(T[1]+T[0]),I=.5*(k[1]-k[0]),D=.5*(k[1]+k[0]),R=1.3;return T=[z-P*R,z+P*R],k=[D-I*R,D+I*R],p._extremes[g._id]=w.findExtremes(g,T,{padded:!0}),p._extremes[h._id]=w.findExtremes(h,k,{padded:!0}),e(p,"a","b"),e(p,"b","a"),a(p,m),a(p,u),x.clipsegments=n(p._xctrl,p._yctrl,m,u),x.x=_,x.y=s,x.a=b,x.b=f,[x]}},{"../../lib":515,"../../plots/cartesian/axes":566,"../heatmap/clean_2d_array":803,"../heatmap/convert_column_xyz":805,"./array_minmax":699,"./calc_clippath":705,"./calc_gridlines":706,"./calc_labels":707,"./cheater_basis":709,"./set_convert":722,"./smooth_fill_2d_array":723}],705:[function(d,ee,te){ee.exports=function(v,S,M,e){var a,n,r,t=[],c=!!M.smoothing,o=!!e.smoothing,i=v[0].length-1,y=v.length-1;for(a=0,n=[],r=[];a<=i;a++)n[a]=v[0][a],r[a]=S[0][a];for(t.push({x:n,y:r,bicubic:c}),a=0,n=[],r=[];a<=y;a++)n[a]=v[a][i],r[a]=S[a][i];for(t.push({x:n,y:r,bicubic:o}),a=i,n=[],r=[];a>=0;a--)n[i-a]=v[y][a],r[i-a]=S[y][a];for(t.push({x:n,y:r,bicubic:c}),a=y,n=[],r=[];a>=0;a--)n[y-a]=v[a][0],r[y-a]=S[a][0];return t.push({x:n,y:r,bicubic:o}),t}},{}],706:[function(d,ee,te){var w=d("../../plots/cartesian/axes"),v=d("../../lib/extend").extendFlat;ee.exports=function(M,e,a){var n,r,t,c,o,i,y,p,g,h,m,u,_,s,A=M["_"+e],b=M[e+"axis"],f=b._gridlines=[],x=b._minorgridlines=[],l=b._boundarylines=[],L=M["_"+a],T=M[a+"axis"];b.tickmode==="array"&&(b.tickvals=A.slice());var k=M._xctrl,P=M._yctrl,z=k[0].length,I=k.length,D=M._a.length,R=M._b.length;w.prepTicks(b),b.tickmode==="array"&&delete b.tickvals;var B=b.smoothing?3:1;function F(G){var J,X,Y,Z,oe,re,se,N,U,q,$,W,K=[],ne=[],ae={};if(e==="b")for(X=M.b2j(G),Y=Math.floor(Math.max(0,Math.min(R-2,X))),Z=X-Y,ae.length=R,ae.crossLength=D,ae.xy=function(ie){return M.evalxy([],ie,X)},ae.dxy=function(ie,le){return M.dxydi([],ie,Y,le,Z)},J=0;J<D;J++)re=Math.min(D-2,J),se=J-re,N=M.evalxy([],J,X),T.smoothing&&J>0&&(U=M.dxydi([],J-1,Y,0,Z),K.push(oe[0]+U[0]/3),ne.push(oe[1]+U[1]/3),q=M.dxydi([],J-1,Y,1,Z),K.push(N[0]-q[0]/3),ne.push(N[1]-q[1]/3)),K.push(N[0]),ne.push(N[1]),oe=N;else for(J=M.a2i(G),re=Math.floor(Math.max(0,Math.min(D-2,J))),se=J-re,ae.length=D,ae.crossLength=R,ae.xy=function(ie){return M.evalxy([],J,ie)},ae.dxy=function(ie,le){return M.dxydj([],re,ie,se,le)},X=0;X<R;X++)Y=Math.min(R-2,X),Z=X-Y,N=M.evalxy([],J,X),T.smoothing&&X>0&&($=M.dxydj([],re,X-1,se,0),K.push(oe[0]+$[0]/3),ne.push(oe[1]+$[1]/3),W=M.dxydj([],re,X-1,se,1),K.push(N[0]-W[0]/3),ne.push(N[1]-W[1]/3)),K.push(N[0]),ne.push(N[1]),oe=N;return ae.axisLetter=e,ae.axis=b,ae.crossAxis=T,ae.value=G,ae.constvar=a,ae.index=p,ae.x=K,ae.y=ne,ae.smoothing=T.smoothing,ae}function H(G){var J,X,Y,Z,oe,re=[],se=[],N={};if(N.length=A.length,N.crossLength=L.length,e==="b")for(Y=Math.max(0,Math.min(R-2,G)),oe=Math.min(1,Math.max(0,G-Y)),N.xy=function(U){return M.evalxy([],U,G)},N.dxy=function(U,q){return M.dxydi([],U,Y,q,oe)},J=0;J<z;J++)re[J]=k[G*B][J],se[J]=P[G*B][J];else for(X=Math.max(0,Math.min(D-2,G)),Z=Math.min(1,Math.max(0,G-X)),N.xy=function(U){return M.evalxy([],G,U)},N.dxy=function(U,q){return M.dxydj([],X,U,Z,q)},J=0;J<I;J++)re[J]=k[J][G*B],se[J]=P[J][G*B];return N.axisLetter=e,N.axis=b,N.crossAxis=T,N.value=A[G],N.constvar=a,N.index=G,N.x=re,N.y=se,N.smoothing=T.smoothing,N}if(b.tickmode==="array"){for(c=5e-15,o=[Math.floor((A.length-1-b.arraytick0)/b.arraydtick*(1+c)),Math.ceil(-b.arraytick0/b.arraydtick/(1+c))].sort(function(G,J){return G-J}),i=o[0]-1,y=o[1]+1,p=i;p<y;p++)r=b.arraytick0+b.arraydtick*p,!(r<0||r>A.length-1)&&f.push(v(H(r),{color:b.gridcolor,width:b.gridwidth,dash:b.griddash}));for(p=i;p<y;p++)if(t=b.arraytick0+b.arraydtick*p,m=Math.min(t+b.arraydtick,A.length-1),!(t<0||t>A.length-1)&&!(m<0||m>A.length-1))for(u=A[t],_=A[m],n=0;n<b.minorgridcount;n++)s=m-t,!(s<=0)&&(h=u+(_-u)*(n+1)/(b.minorgridcount+1)*(b.arraydtick/s),!(h<A[0]||h>A[A.length-1])&&x.push(v(F(h),{color:b.minorgridcolor,width:b.minorgridwidth,dash:b.minorgriddash})));b.startline&&l.push(v(H(0),{color:b.startlinecolor,width:b.startlinewidth})),b.endline&&l.push(v(H(A.length-1),{color:b.endlinecolor,width:b.endlinewidth}))}else{for(c=5e-15,o=[Math.floor((A[A.length-1]-b.tick0)/b.dtick*(1+c)),Math.ceil((A[0]-b.tick0)/b.dtick/(1+c))].sort(function(G,J){return G-J}),i=o[0],y=o[1],p=i;p<=y;p++)g=b.tick0+b.dtick*p,f.push(v(F(g),{color:b.gridcolor,width:b.gridwidth,dash:b.griddash}));for(p=i-1;p<y+1;p++)for(g=b.tick0+b.dtick*p,n=0;n<b.minorgridcount;n++)h=g+b.dtick*(n+1)/(b.minorgridcount+1),!(h<A[0]||h>A[A.length-1])&&x.push(v(F(h),{color:b.minorgridcolor,width:b.minorgridwidth,dash:b.minorgriddash}));b.startline&&l.push(v(F(A[0]),{color:b.startlinecolor,width:b.startlinewidth})),b.endline&&l.push(v(F(A[A.length-1]),{color:b.endlinecolor,width:b.endlinewidth}))}}},{"../../lib/extend":505,"../../plots/cartesian/axes":566}],707:[function(d,ee,te){var w=d("../../plots/cartesian/axes"),v=d("../../lib/extend").extendFlat;ee.exports=function(M,e){var a,n,r,t,c,o=e._labels=[],i=e._gridlines;for(a=0;a<i.length;a++)c=i[a],["start","both"].indexOf(e.showticklabels)!==-1&&(n=w.tickText(e,c.value),v(n,{prefix:r,suffix:t,endAnchor:!0,xy:c.xy(0),dxy:c.dxy(0,0),axis:c.axis,length:c.crossAxis.length,font:c.axis.tickfont,isFirst:a===0,isLast:a===i.length-1}),o.push(n)),["end","both"].indexOf(e.showticklabels)!==-1&&(n=w.tickText(e,c.value),v(n,{endAnchor:!1,xy:c.xy(c.crossLength-1),dxy:c.dxy(c.crossLength-2,1),axis:c.axis,length:c.crossAxis.length,font:c.axis.tickfont,isFirst:a===0,isLast:a===i.length-1}),o.push(n))}},{"../../lib/extend":505,"../../plots/cartesian/axes":566}],708:[function(d,ee,te){var w=.5;ee.exports=function(S,M,e,a){var n=S[0]-M[0],r=S[1]-M[1],t=e[0]-M[0],c=e[1]-M[1],o=Math.pow(n*n+r*r,w/2),i=Math.pow(t*t+c*c,w/2),y=(i*i*n-o*o*t)*a,p=(i*i*r-o*o*c)*a,g=i*(o+i)*3,h=o*(o+i)*3;return[[M[0]+(g&&y/g),M[1]+(g&&p/g)],[M[0]-(h&&y/h),M[1]-(h&&p/h)]]}},{}],709:[function(d,ee,te){var w=d("../../lib").isArrayOrTypedArray;ee.exports=function(v,S,M){var e,a,n,r,t,c,o=[],i=w(v)?v.length:v,y=w(S)?S.length:S,p=w(v)?v:null,g=w(S)?S:null;p&&(n=(p.length-1)/(p[p.length-1]-p[0])/(i-1)),g&&(r=(g.length-1)/(g[g.length-1]-g[0])/(y-1));var h,m=1/0,u=-1/0;for(a=0;a<y;a++)for(o[a]=[],c=g?(g[a]-g[0])*r:a/(y-1),e=0;e<i;e++)t=p?(p[e]-p[0])*n:e/(i-1),h=t-c*M,m=Math.min(h,m),u=Math.max(h,u),o[a][e]=h;var _=1/(u-m),s=-m*_;for(a=0;a<y;a++)for(e=0;e<i;e++)o[a][e]=_*o[a][e]+s;return o}},{"../../lib":515}],710:[function(d,ee,te){var w=d("./catmull_rom"),v=d("../../lib").ensureArray;function S(M,e,a){var n=-.5*a[0]+1.5*e[0],r=-.5*a[1]+1.5*e[1];return[(2*n+M[0])/3,(2*r+M[1])/3]}ee.exports=function(e,a,n,r,t,c){var o,i,y,p,g,h,m,u,_,s,A=n[0].length,b=n.length,f=t?3*A-2:A,x=c?3*b-2:b;for(e=v(e,x),a=v(a,x),y=0;y<x;y++)e[y]=v(e[y],f),a[y]=v(a[y],f);for(i=0,p=0;i<b;i++,p+=c?3:1)for(g=e[p],h=a[p],m=n[i],u=r[i],o=0,y=0;o<A;o++,y+=t?3:1)g[y]=m[o],h[y]=u[o];if(t)for(i=0,p=0;i<b;i++,p+=c?3:1){for(o=1,y=3;o<A-1;o++,y+=3)_=w([n[i][o-1],r[i][o-1]],[n[i][o],r[i][o]],[n[i][o+1],r[i][o+1]],t),e[p][y-1]=_[0][0],a[p][y-1]=_[0][1],e[p][y+1]=_[1][0],a[p][y+1]=_[1][1];s=S([e[p][0],a[p][0]],[e[p][2],a[p][2]],[e[p][3],a[p][3]]),e[p][1]=s[0],a[p][1]=s[1],s=S([e[p][f-1],a[p][f-1]],[e[p][f-3],a[p][f-3]],[e[p][f-4],a[p][f-4]]),e[p][f-2]=s[0],a[p][f-2]=s[1]}if(c)for(y=0;y<f;y++){for(p=3;p<x-3;p+=3)_=w([e[p-3][y],a[p-3][y]],[e[p][y],a[p][y]],[e[p+3][y],a[p+3][y]],c),e[p-1][y]=_[0][0],a[p-1][y]=_[0][1],e[p+1][y]=_[1][0],a[p+1][y]=_[1][1];s=S([e[0][y],a[0][y]],[e[2][y],a[2][y]],[e[3][y],a[3][y]]),e[1][y]=s[0],a[1][y]=s[1],s=S([e[x-1][y],a[x-1][y]],[e[x-3][y],a[x-3][y]],[e[x-4][y],a[x-4][y]]),e[x-2][y]=s[0],a[x-2][y]=s[1]}if(t&&c)for(p=1;p<x;p+=(p+1)%3===0?2:1){for(y=3;y<f-3;y+=3)_=w([e[p][y-3],a[p][y-3]],[e[p][y],a[p][y]],[e[p][y+3],a[p][y+3]],t),e[p][y-1]=.5*(e[p][y-1]+_[0][0]),a[p][y-1]=.5*(a[p][y-1]+_[0][1]),e[p][y+1]=.5*(e[p][y+1]+_[1][0]),a[p][y+1]=.5*(a[p][y+1]+_[1][1]);s=S([e[p][0],a[p][0]],[e[p][2],a[p][2]],[e[p][3],a[p][3]]),e[p][1]=.5*(e[p][1]+s[0]),a[p][1]=.5*(a[p][1]+s[1]),s=S([e[p][f-1],a[p][f-1]],[e[p][f-3],a[p][f-3]],[e[p][f-4],a[p][f-4]]),e[p][f-2]=.5*(e[p][f-2]+s[0]),a[p][f-2]=.5*(a[p][f-2]+s[1])}return[e,a]}},{"../../lib":515,"./catmull_rom":708}],711:[function(d,ee,te){ee.exports={RELATIVE_CULL_TOLERANCE:1e-6}},{}],712:[function(d,ee,te){ee.exports=function(w,v,S){return v&&S?function(M,e,a,n,r){M||(M=[]);var t,c,o,i,y,p;e*=3,a*=3;var g=n*n,h=1-n,m=h*h,u=h*n*2,_=-3*m,s=3*(m-u),A=3*(u-g),b=3*g,f=r*r,x=f*r,l=1-r,L=l*l,T=L*l;for(p=0;p<w.length;p++)y=w[p],t=_*y[a][e]+s*y[a][e+1]+A*y[a][e+2]+b*y[a][e+3],c=_*y[a+1][e]+s*y[a+1][e+1]+A*y[a+1][e+2]+b*y[a+1][e+3],o=_*y[a+2][e]+s*y[a+2][e+1]+A*y[a+2][e+2]+b*y[a+2][e+3],i=_*y[a+3][e]+s*y[a+3][e+1]+A*y[a+3][e+2]+b*y[a+3][e+3],M[p]=T*t+3*(L*r*c+l*f*o)+x*i;return M}:v?function(M,e,a,n,r){M||(M=[]);var t,c,o,i;e*=3;var y=n*n,p=1-n,g=p*p,h=p*n*2,m=-3*g,u=3*(g-h),_=3*(h-y),s=3*y,A=1-r;for(o=0;o<w.length;o++)i=w[o],t=m*i[a][e]+u*i[a][e+1]+_*i[a][e+2]+s*i[a][e+3],c=m*i[a+1][e]+u*i[a+1][e+1]+_*i[a+1][e+2]+s*i[a+1][e+3],M[o]=A*t+r*c;return M}:S?function(M,e,a,n,r){M||(M=[]);var t,c,o,i,y,p;a*=3;var g=r*r,h=g*r,m=1-r,u=m*m,_=u*m;for(y=0;y<w.length;y++)p=w[y],t=p[a][e+1]-p[a][e],c=p[a+1][e+1]-p[a+1][e],o=p[a+2][e+1]-p[a+2][e],i=p[a+3][e+1]-p[a+3][e],M[y]=_*t+3*(u*r*c+m*g*o)+h*i;return M}:function(M,e,a,n,r){M||(M=[]);var t,c,o,i,y=1-r;for(o=0;o<w.length;o++)i=w[o],t=i[a][e+1]-i[a][e],c=i[a+1][e+1]-i[a+1][e],M[o]=y*t+r*c;return M}}},{}],713:[function(d,ee,te){ee.exports=function(w,v,S){return v&&S?function(M,e,a,n,r){M||(M=[]);var t,c,o,i,y,p;e*=3,a*=3;var g=n*n,h=g*n,m=1-n,u=m*m,_=u*m,s=r*r,A=1-r,b=A*A,f=A*r*2,x=-3*b,l=3*(b-f),L=3*(f-s),T=3*s;for(p=0;p<w.length;p++)y=w[p],t=x*y[a][e]+l*y[a+1][e]+L*y[a+2][e]+T*y[a+3][e],c=x*y[a][e+1]+l*y[a+1][e+1]+L*y[a+2][e+1]+T*y[a+3][e+1],o=x*y[a][e+2]+l*y[a+1][e+2]+L*y[a+2][e+2]+T*y[a+3][e+2],i=x*y[a][e+3]+l*y[a+1][e+3]+L*y[a+2][e+3]+T*y[a+3][e+3],M[p]=_*t+3*(u*n*c+m*g*o)+h*i;return M}:v?function(M,e,a,n,r){M||(M=[]);var t,c,o,i,y,p;e*=3;var g=r*r,h=g*r,m=1-r,u=m*m,_=u*m;for(y=0;y<w.length;y++)p=w[y],t=p[a+1][e]-p[a][e],c=p[a+1][e+1]-p[a][e+1],o=p[a+1][e+2]-p[a][e+2],i=p[a+1][e+3]-p[a][e+3],M[y]=_*t+3*(u*r*c+m*g*o)+h*i;return M}:S?function(M,e,a,n,r){M||(M=[]);var t,c,o,i;a*=3;var y=1-n,p=r*r,g=1-r,h=g*g,m=g*r*2,u=-3*h,_=3*(h-m),s=3*(m-p),A=3*p;for(o=0;o<w.length;o++)i=w[o],t=u*i[a][e]+_*i[a+1][e]+s*i[a+2][e]+A*i[a+3][e],c=u*i[a][e+1]+_*i[a+1][e+1]+s*i[a+2][e+1]+A*i[a+3][e+1],M[o]=y*t+n*c;return M}:function(M,e,a,n,r){M||(M=[]);var t,c,o,i,y=1-n;for(o=0;o<w.length;o++)i=w[o],t=i[a+1][e]-i[a][e],c=i[a+1][e+1]-i[a][e+1],M[o]=y*t+n*c;return M}}},{}],714:[function(d,ee,te){ee.exports=function(w,v,S,M,e){var a=v-2,n=S-2;return M&&e?function(r,t,c){r||(r=[]);var o,i,y,p,g,h,m=Math.max(0,Math.min(Math.floor(t),a)),u=Math.max(0,Math.min(Math.floor(c),n)),_=Math.max(0,Math.min(1,t-m)),s=Math.max(0,Math.min(1,c-u));m*=3,u*=3;var A=_*_,b=A*_,f=1-_,x=f*f,l=x*f,L=s*s,T=L*s,k=1-s,P=k*k,z=P*k;for(h=0;h<w.length;h++)g=w[h],o=l*g[u][m]+3*(x*_*g[u][m+1]+f*A*g[u][m+2])+b*g[u][m+3],i=l*g[u+1][m]+3*(x*_*g[u+1][m+1]+f*A*g[u+1][m+2])+b*g[u+1][m+3],y=l*g[u+2][m]+3*(x*_*g[u+2][m+1]+f*A*g[u+2][m+2])+b*g[u+2][m+3],p=l*g[u+3][m]+3*(x*_*g[u+3][m+1]+f*A*g[u+3][m+2])+b*g[u+3][m+3],r[h]=z*o+3*(P*s*i+k*L*y)+T*p;return r}:M?function(r,t,c){r||(r=[]);var o=Math.max(0,Math.min(Math.floor(t),a)),i=Math.max(0,Math.min(Math.floor(c),n)),y=Math.max(0,Math.min(1,t-o)),p=Math.max(0,Math.min(1,c-i)),g,h,m,u,_,s;o*=3;var A=y*y,b=A*y,f=1-y,x=f*f,l=x*f,L=1-p;for(_=0;_<w.length;_++)s=w[_],g=L*s[i][o]+p*s[i+1][o],h=L*s[i][o+1]+p*s[i+1][o+1],m=L*s[i][o+2]+p*s[i+1][o+1],u=L*s[i][o+3]+p*s[i+1][o+1],r[_]=l*g+3*(x*y*h+f*A*m)+b*u;return r}:e?function(r,t,c){r||(r=[]);var o=Math.max(0,Math.min(Math.floor(t),a)),i=Math.max(0,Math.min(Math.floor(c),n)),y=Math.max(0,Math.min(1,t-o)),p=Math.max(0,Math.min(1,c-i)),g,h,m,u,_,s;i*=3;var A=p*p,b=A*p,f=1-p,x=f*f,l=x*f,L=1-y;for(_=0;_<w.length;_++)s=w[_],g=L*s[i][o]+y*s[i][o+1],h=L*s[i+1][o]+y*s[i+1][o+1],m=L*s[i+2][o]+y*s[i+2][o+1],u=L*s[i+3][o]+y*s[i+3][o+1],r[_]=l*g+3*(x*p*h+f*A*m)+b*u;return r}:function(r,t,c){r||(r=[]);var o=Math.max(0,Math.min(Math.floor(t),a)),i=Math.max(0,Math.min(Math.floor(c),n)),y=Math.max(0,Math.min(1,t-o)),p=Math.max(0,Math.min(1,c-i)),g,h,m,u,_=1-p,s=1-y;for(m=0;m<w.length;m++)u=w[m],g=s*u[i][o]+y*u[i][o+1],h=s*u[i+1][o]+y*u[i+1][o+1],r[m]=_*g+p*h;return r}}},{}],715:[function(d,ee,te){var w=d("../../lib"),v=d("./xy_defaults"),S=d("./ab_defaults"),M=d("./attributes"),e=d("../../components/color/attributes");ee.exports=function(n,r,t,c){function o(p,g){return w.coerce(n,r,M,p,g)}r._clipPathId="clip"+r.uid+"carpet";var i=o("color",e.defaultLine);if(w.coerceFont(o,"font"),o("carpet"),S(n,r,c,o,i),!r.a||!r.b){r.visible=!1;return}r.a.length<3&&(r.aaxis.smoothing=0),r.b.length<3&&(r.baxis.smoothing=0);var y=v(n,r,o);y||(r.visible=!1),r._cheater&&o("cheaterslope")}},{"../../components/color/attributes":366,"../../lib":515,"./ab_defaults":698,"./attributes":700,"./xy_defaults":724}],716:[function(d,ee,te){ee.exports={attributes:d("./attributes"),supplyDefaults:d("./defaults"),plot:d("./plot"),calc:d("./calc"),animatable:!0,isContainer:!0,moduleType:"trace",name:"carpet",basePlotModule:d("../../plots/cartesian"),categories:["cartesian","svg","carpet","carpetAxis","notLegendIsolatable","noMultiCategory","noHover","noSortingByValue"],meta:{}}},{"../../plots/cartesian":578,"./attributes":700,"./calc":704,"./defaults":715,"./plot":721}],717:[function(d,ee,te){ee.exports=function(w,v){for(var S=w._fullData.length,M,e=0;e<S;e++){var a=w._fullData[e];if(a.index!==v.index&&a.type==="carpet"&&(M||(M=a),a.carpet===v.carpet))return a}return M}},{}],718:[function(d,ee,te){ee.exports=function(v,S,M){if(v.length===0)return"";var e,a=[],n=M?3:1;for(e=0;e<v.length;e+=n)a.push(v[e]+","+S[e]),M&&e<v.length-n&&(a.push("C"),a.push([v[e+1]+","+S[e+1],v[e+2]+","+S[e+2]+" "].join(" ")));return a.join(M?"":"L")}},{}],719:[function(d,ee,te){var w=d("../../lib").isArrayOrTypedArray;ee.exports=function(S,M,e){var a;for(w(S)?S.length>M.length&&(S=S.slice(0,M.length)):S=[],a=0;a<M.length;a++)S[a]=e(M[a]);return S}},{"../../lib":515}],720:[function(d,ee,te){ee.exports=function(v,S,M,e,a,n){var r=a[0]*v.dpdx(S),t=a[1]*v.dpdy(M),c=1,o=1;if(n){var i=Math.sqrt(a[0]*a[0]+a[1]*a[1]),y=Math.sqrt(n[0]*n[0]+n[1]*n[1]),p=(a[0]*n[0]+a[1]*n[1])/i/y;o=Math.max(0,p)}var g=Math.atan2(t,r)*180/Math.PI;return g<-90?(g+=180,c=-c):g>90&&(g-=180,c=-c),{angle:g,flip:c,p:v.c2p(e,S,M),offsetMultplier:o}}},{}],721:[function(d,ee,te){var w=d("@plotly/d3"),v=d("../../components/drawing"),S=d("./map_1d_array"),M=d("./makepath"),e=d("./orient_text"),a=d("../../lib/svg_text_utils"),n=d("../../lib"),r=n.strRotate,t=n.strTranslate,c=d("../../constants/alignment");ee.exports=function(_,s,A,b){var f=s.xaxis,x=s.yaxis,l=_._fullLayout,L=l._clips;n.makeTraceGroups(b,A,"trace").each(function(T){var k=w.select(this),P=T[0],z=P.trace,I=z.aaxis,D=z.baxis,R=n.ensureSingle(k,"g","minorlayer"),B=n.ensureSingle(k,"g","majorlayer"),F=n.ensureSingle(k,"g","boundarylayer"),H=n.ensureSingle(k,"g","labellayer");k.style("opacity",z.opacity),i(f,x,B,I,"a",I._gridlines),i(f,x,B,D,"b",D._gridlines),i(f,x,R,I,"a",I._minorgridlines),i(f,x,R,D,"b",D._minorgridlines),i(f,x,F,I,"a-boundary",I._boundarylines),i(f,x,F,D,"b-boundary",D._boundarylines);var G=y(_,f,x,z,P,H,I._labels,"a-label"),J=y(_,f,x,z,P,H,D._labels,"b-label");p(_,H,z,P,f,x,G,J),o(z,P,L,f,x)})};function o(u,_,s,A,b){var f,x,l,L,T=s.select("#"+u._clipPathId);T.size()||(T=s.append("clipPath").classed("carpetclip",!0));var k=n.ensureSingle(T,"path","carpetboundary"),P=_.clipsegments,z=[];for(L=0;L<P.length;L++)f=P[L],x=S([],f.x,A.c2p),l=S([],f.y,b.c2p),z.push(M(x,l,f.bicubic));var I="M"+z.join("L")+"Z";T.attr("id",u._clipPathId),k.attr("d",I)}function i(u,_,s,A,b,f){var x="const-"+b+"-lines",l=s.selectAll("."+x).data(f);l.enter().append("path").classed(x,!0).style("vector-effect","non-scaling-stroke"),l.each(function(L){var T=L,k=T.x,P=T.y,z=S([],k,u.c2p),I=S([],P,_.c2p),D="M"+M(z,I,T.smoothing),R=w.select(this);R.attr("d",D).style("stroke-width",T.width).style("stroke",T.color).style("stroke-dasharray",v.dashStyle(T.dash,T.width)).style("fill","none")}),l.exit().remove()}function y(u,_,s,A,b,f,x,l){var L=f.selectAll("text."+l).data(x);L.enter().append("text").classed(l,!0);var T=0,k={};return L.each(function(P,z){var I;if(P.axis.tickangle==="auto")I=e(A,_,s,P.xy,P.dxy);else{var D=(P.axis.tickangle+180)*Math.PI/180;I=e(A,_,s,P.xy,[Math.cos(D),Math.sin(D)])}z||(k={angle:I.angle,flip:I.flip});var R=(P.endAnchor?-1:1)*I.flip,B=w.select(this).attr({"text-anchor":R>0?"start":"end","data-notex":1}).call(v.font,P.font).text(P.text).call(a.convertToTspans,u),F=v.bBox(this);B.attr("transform",t(I.p[0],I.p[1])+r(I.angle)+t(P.axis.labelpadding*R,F.height*.3)),T=Math.max(T,F.width+P.axis.labelpadding)}),L.exit().remove(),k.maxExtent=T,k}function p(u,_,s,A,b,f,x,l){var L,T,k,P,z=n.aggNums(Math.min,null,s.a),I=n.aggNums(Math.max,null,s.a),D=n.aggNums(Math.min,null,s.b),R=n.aggNums(Math.max,null,s.b);L=.5*(z+I),T=D,k=s.ab2xy(L,T,!0),P=s.dxyda_rough(L,T),x.angle===void 0&&n.extendFlat(x,e(s,b,f,k,s.dxydb_rough(L,T))),m(u,_,s,A,k,P,s.aaxis,b,f,x,"a-title"),L=z,T=.5*(D+R),k=s.ab2xy(L,T,!0),P=s.dxydb_rough(L,T),l.angle===void 0&&n.extendFlat(l,e(s,b,f,k,s.dxyda_rough(L,T))),m(u,_,s,A,k,P,s.baxis,b,f,l,"b-title")}var g=c.LINE_SPACING,h=(1-c.MID_SHIFT)/g+1;function m(u,_,s,A,b,f,x,l,L,T,k){var P=[];x.title.text&&P.push(x.title.text);var z=_.selectAll("text."+k).data(P),I=T.maxExtent;z.enter().append("text").classed(k,!0),z.each(function(){var D=e(s,l,L,b,f);["start","both"].indexOf(x.showticklabels)===-1&&(I=0);var R=x.title.font.size;I+=R+x.title.offset;var B=T.angle+(T.flip<0?180:0),F=(B-D.angle+450)%360,H=F>90&&F<270,G=w.select(this);G.text(x.title.text).call(a.convertToTspans,u),H&&(I=(-a.lineCount(G)+h)*g*R-I),G.attr("transform",t(D.p[0],D.p[1])+r(D.angle)+t(0,I)).attr("text-anchor","middle").call(v.font,x.title.font)}),z.exit().remove()}},{"../../components/drawing":389,"../../constants/alignment":483,"../../lib":515,"../../lib/svg_text_utils":541,"./makepath":718,"./map_1d_array":719,"./orient_text":720,"@plotly/d3":58}],722:[function(d,ee,te){var w=d("./constants"),v=d("../../lib/search").findBin,S=d("./compute_control_points"),M=d("./create_spline_evaluator"),e=d("./create_i_derivative_evaluator"),a=d("./create_j_derivative_evaluator");ee.exports=function(r){var t=r._a,c=r._b,o=t.length,i=c.length,y=r.aaxis,p=r.baxis,g=t[0],h=t[o-1],m=c[0],u=c[i-1],_=t[t.length-1]-t[0],s=c[c.length-1]-c[0],A=_*w.RELATIVE_CULL_TOLERANCE,b=s*w.RELATIVE_CULL_TOLERANCE;g-=A,h+=A,m-=b,u+=b,r.isVisible=function(f,x){return f>g&&f<h&&x>m&&x<u},r.isOccluded=function(f,x){return f<g||f>h||x<m||x>u},r.setScale=function(){var f=r._x,x=r._y,l=S(r._xctrl,r._yctrl,f,x,y.smoothing,p.smoothing);r._xctrl=l[0],r._yctrl=l[1],r.evalxy=M([r._xctrl,r._yctrl],o,i,y.smoothing,p.smoothing),r.dxydi=e([r._xctrl,r._yctrl],y.smoothing,p.smoothing),r.dxydj=a([r._xctrl,r._yctrl],y.smoothing,p.smoothing)},r.i2a=function(f){var x=Math.max(0,Math.floor(f[0]),o-2),l=f[0]-x;return(1-l)*t[x]+l*t[x+1]},r.j2b=function(f){var x=Math.max(0,Math.floor(f[1]),o-2),l=f[1]-x;return(1-l)*c[x]+l*c[x+1]},r.ij2ab=function(f){return[r.i2a(f[0]),r.j2b(f[1])]},r.a2i=function(f){var x=Math.max(0,Math.min(v(f,t),o-2)),l=t[x],L=t[x+1];return Math.max(0,Math.min(o-1,x+(f-l)/(L-l)))},r.b2j=function(f){var x=Math.max(0,Math.min(v(f,c),i-2)),l=c[x],L=c[x+1];return Math.max(0,Math.min(i-1,x+(f-l)/(L-l)))},r.ab2ij=function(f){return[r.a2i(f[0]),r.b2j(f[1])]},r.i2c=function(f,x){return r.evalxy([],f,x)},r.ab2xy=function(f,x,l){if(!l&&(f<t[0]||f>t[o-1]|x<c[0]||x>c[i-1]))return[!1,!1];var L=r.a2i(f),T=r.b2j(x),k=r.evalxy([],L,T);if(l){var P=0,z=0,I=[],D,R,B,F;f<t[0]?(D=0,R=0,P=(f-t[0])/(t[1]-t[0])):f>t[o-1]?(D=o-2,R=1,P=(f-t[o-1])/(t[o-1]-t[o-2])):(D=Math.max(0,Math.min(o-2,Math.floor(L))),R=L-D),x<c[0]?(B=0,F=0,z=(x-c[0])/(c[1]-c[0])):x>c[i-1]?(B=i-2,F=1,z=(x-c[i-1])/(c[i-1]-c[i-2])):(B=Math.max(0,Math.min(i-2,Math.floor(T))),F=T-B),P&&(r.dxydi(I,D,B,R,F),k[0]+=I[0]*P,k[1]+=I[1]*P),z&&(r.dxydj(I,D,B,R,F),k[0]+=I[0]*z,k[1]+=I[1]*z)}return k},r.c2p=function(f,x,l){return[x.c2p(f[0]),l.c2p(f[1])]},r.p2x=function(f,x,l){return[x.p2c(f[0]),l.p2c(f[1])]},r.dadi=function(f){var x=Math.max(0,Math.min(t.length-2,f));return t[x+1]-t[x]},r.dbdj=function(f){var x=Math.max(0,Math.min(c.length-2,f));return c[x+1]-c[x]},r.dxyda=function(f,x,l,L){var T=r.dxydi(null,f,x,l,L),k=r.dadi(f,l);return[T[0]/k,T[1]/k]},r.dxydb=function(f,x,l,L){var T=r.dxydj(null,f,x,l,L),k=r.dbdj(x,L);return[T[0]/k,T[1]/k]},r.dxyda_rough=function(f,x,l){var L=_*(l||.1),T=r.ab2xy(f+L,x,!0),k=r.ab2xy(f-L,x,!0);return[(T[0]-k[0])*.5/L,(T[1]-k[1])*.5/L]},r.dxydb_rough=function(f,x,l){var L=s*(l||.1),T=r.ab2xy(f,x+L,!0),k=r.ab2xy(f,x-L,!0);return[(T[0]-k[0])*.5/L,(T[1]-k[1])*.5/L]},r.dpdx=function(f){return f._m},r.dpdy=function(f){return f._m}}},{"../../lib/search":535,"./compute_control_points":710,"./constants":711,"./create_i_derivative_evaluator":712,"./create_j_derivative_evaluator":713,"./create_spline_evaluator":714}],723:[function(d,ee,te){var w=d("../../lib");ee.exports=function(S,M,e){var a,n,r,t=[],c=[],o=S[0].length,i=S.length;function y(X,Y){var Z=0,oe,re=0;return X>0&&(oe=S[Y][X-1])!==void 0&&(re++,Z+=oe),X<o-1&&(oe=S[Y][X+1])!==void 0&&(re++,Z+=oe),Y>0&&(oe=S[Y-1][X])!==void 0&&(re++,Z+=oe),Y<i-1&&(oe=S[Y+1][X])!==void 0&&(re++,Z+=oe),Z/Math.max(1,re)}var p=0;for(a=0;a<o;a++)for(n=0;n<i;n++)S[n][a]===void 0&&(t.push(a),c.push(n),S[n][a]=y(a,n)),p=Math.max(p,Math.abs(S[n][a]));if(!t.length)return S;var g,h,m,u,_,s,A,b,f,x,l,L=1e-5,T=0,k=100,P=0,z=t.length;do{for(T=0,r=0;r<z;r++){a=t[r],n=c[r];var I=0,D=0,R,B,F,H,G,J;a===0?(G=Math.min(o-1,2),F=M[G],H=M[1],R=S[n][G],B=S[n][1],D+=B+(B-R)*(M[0]-H)/(H-F),I++):a===o-1&&(G=Math.max(0,o-3),F=M[G],H=M[o-2],R=S[n][G],B=S[n][o-2],D+=B+(B-R)*(M[o-1]-H)/(H-F),I++),(a===0||a===o-1)&&n>0&&n<i-1&&(g=e[n+1]-e[n],h=e[n]-e[n-1],D+=(h*S[n+1][a]+g*S[n-1][a])/(h+g),I++),n===0?(J=Math.min(i-1,2),F=e[J],H=e[1],R=S[J][a],B=S[1][a],D+=B+(B-R)*(e[0]-H)/(H-F),I++):n===i-1&&(J=Math.max(0,i-3),F=e[J],H=e[i-2],R=S[J][a],B=S[i-2][a],D+=B+(B-R)*(e[i-1]-H)/(H-F),I++),(n===0||n===i-1)&&a>0&&a<o-1&&(g=M[a+1]-M[a],h=M[a]-M[a-1],D+=(h*S[n][a+1]+g*S[n][a-1])/(h+g),I++),I?D/=I:(m=M[a+1]-M[a],u=M[a]-M[a-1],_=e[n+1]-e[n],s=e[n]-e[n-1],A=m*u*(m+u),b=_*s*(_+s),D=(A*(s*S[n+1][a]+_*S[n-1][a])+b*(u*S[n][a+1]+m*S[n][a-1]))/(b*(u+m)+A*(s+_))),f=D-S[n][a],x=f/p,T+=x*x,l=I?0:.85,S[n][a]+=f*(1+l)}T=Math.sqrt(T)}while(P++<k&&T>L);return w.log("Smoother converged to",T,"after",P,"iterations"),S}},{"../../lib":515}],724:[function(d,ee,te){var w=d("../../lib").isArray1D;ee.exports=function(S,M,e){var a=e("x"),n=a&&a.length,r=e("y"),t=r&&r.length;if(!n&&!t)return!1;if(M._cheater=!a,(!n||w(a))&&(!t||w(r))){var c=n?a.length:1/0;t&&(c=Math.min(c,r.length)),M.a&&M.a.length&&(c=Math.min(c,M.a.length)),M.b&&M.b.length&&(c=Math.min(c,M.b.length)),M._length=c}else M._length=null;return!0}},{"../../lib":515}],725:[function(d,ee,te){var w=d("../../plots/template_attributes").hovertemplateAttrs,v=d("../scattergeo/attributes"),S=d("../../components/colorscale/attributes"),M=d("../../plots/attributes"),e=d("../../components/color/attributes").defaultLine,a=d("../../lib/extend").extendFlat,n=v.marker.line;ee.exports=a({locations:{valType:"data_array",editType:"calc"},locationmode:v.locationmode,z:{valType:"data_array",editType:"calc"},geojson:a({},v.geojson,{}),featureidkey:v.featureidkey,text:a({},v.text,{}),hovertext:a({},v.hovertext,{}),marker:{line:{color:a({},n.color,{dflt:e}),width:a({},n.width,{dflt:1}),editType:"calc"},opacity:{valType:"number",arrayOk:!0,min:0,max:1,dflt:1,editType:"style"},editType:"calc"},selected:{marker:{opacity:v.selected.marker.opacity,editType:"plot"},editType:"plot"},unselected:{marker:{opacity:v.unselected.marker.opacity,editType:"plot"},editType:"plot"},hoverinfo:a({},M.hoverinfo,{editType:"calc",flags:["location","z","text","name"]}),hovertemplate:w(),showlegend:a({},M.showlegend,{dflt:!1})},S("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/color/attributes":366,"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/template_attributes":642,"../scattergeo/attributes":978}],726:[function(d,ee,te){var w=d("fast-isnumeric"),v=d("../../constants/numerical").BADNUM,S=d("../../components/colorscale/calc"),M=d("../scatter/arrays_to_calcdata"),e=d("../scatter/calc_selection");function a(n){return n&&typeof n=="string"}ee.exports=function(r,t){var c=t._length,o=new Array(c),i;t.geojson?i=function(m){return a(m)||w(m)}:i=a;for(var y=0;y<c;y++){var p=o[y]={},g=t.locations[y],h=t.z[y];i(g)&&w(h)?(p.loc=g,p.z=h):(p.loc=null,p.z=v),p.index=y}return M(o,t),S(r,t,{vals:t.z,containerStr:"",cLetter:"z"}),e(o,t),o}},{"../../components/colorscale/calc":375,"../../constants/numerical":491,"../scatter/arrays_to_calcdata":935,"../scatter/calc_selection":938,"fast-isnumeric":190}],727:[function(d,ee,te){var w=d("../../lib"),v=d("../../components/colorscale/defaults"),S=d("./attributes");ee.exports=function(e,a,n,r){function t(h,m){return w.coerce(e,a,S,h,m)}var c=t("locations"),o=t("z");if(!(c&&c.length&&w.isArrayOrTypedArray(o)&&o.length)){a.visible=!1;return}a._length=Math.min(c.length,o.length);var i=t("geojson"),y;(typeof i=="string"&&i!==""||w.isPlainObject(i))&&(y="geojson-id");var p=t("locationmode",y);p==="geojson-id"&&t("featureidkey"),t("text"),t("hovertext"),t("hovertemplate");var g=t("marker.line.width");g&&t("marker.line.color"),t("marker.opacity"),v(e,a,r,t,{prefix:"",cLetter:"z"}),w.coerceSelectionMarkerOpacity(a,t)}},{"../../components/colorscale/defaults":377,"../../lib":515,"./attributes":725}],728:[function(d,ee,te){ee.exports=function(v,S,M,e,a){v.location=S.location,v.z=S.z;var n=e[a];return n.fIn&&n.fIn.properties&&(v.properties=n.fIn.properties),v.ct=n.ct,v}},{}],729:[function(d,ee,te){var w=d("../../plots/cartesian/axes"),v=d("./attributes"),S=d("../../lib").fillText;ee.exports=function(a,n,r){var t=a.cd,c=t[0].trace,o=a.subplot,i,y,p,g,h=[n,r],m=[n+360,r];for(y=0;y<t.length;y++)if(i=t[y],g=!1,i._polygons){for(p=0;p<i._polygons.length;p++)i._polygons[p].contains(h)&&(g=!g),i._polygons[p].contains(m)&&(g=!g);if(g)break}if(!(!g||!i))return a.x0=a.x1=a.xa.c2p(i.ct),a.y0=a.y1=a.ya.c2p(i.ct),a.index=i.index,a.location=i.loc,a.z=i.z,a.zLabel=w.tickText(o.mockAxis,o.mockAxis.c2l(i.z),"hover").text,a.hovertemplate=i.hovertemplate,M(a,c,i),[a]};function M(e,a,n){if(!a.hovertemplate){var r=n.hi||a.hoverinfo,t=String(n.loc),c=r==="all"?v.hoverinfo.flags:r.split("+"),o=c.indexOf("name")!==-1,i=c.indexOf("location")!==-1,y=c.indexOf("z")!==-1,p=c.indexOf("text")!==-1,g=!o&&i,h=[];g?e.nameOverride=t:(o&&(e.nameOverride=a.name),i&&h.push(t)),y&&h.push(e.zLabel),p&&S(n,a,h),e.extraText=h.join("<br>")}}},{"../../lib":515,"../../plots/cartesian/axes":566,"./attributes":725}],730:[function(d,ee,te){ee.exports={attributes:d("./attributes"),supplyDefaults:d("./defaults"),colorbar:d("../heatmap/colorbar"),calc:d("./calc"),calcGeoJSON:d("./plot").calcGeoJSON,plot:d("./plot").plot,style:d("./style").style,styleOnSelect:d("./style").styleOnSelect,hoverPoints:d("./hover"),eventData:d("./event_data"),selectPoints:d("./select"),moduleType:"trace",name:"choropleth",basePlotModule:d("../../plots/geo"),categories:["geo","noOpacity","showLegend"],meta:{}}},{"../../plots/geo":598,"../heatmap/colorbar":804,"./attributes":725,"./calc":726,"./defaults":727,"./event_data":728,"./hover":729,"./plot":731,"./select":732,"./style":733}],731:[function(d,ee,te){var w=d("@plotly/d3"),v=d("../../lib"),S=d("../../lib/geo_location_utils"),M=d("../../lib/topojson_utils").getTopojsonFeatures,e=d("../../plots/cartesian/autorange").findExtremes,a=d("./style").style;function n(t,c,o){var i=c.layers.backplot.select(".choroplethlayer");v.makeTraceGroups(i,o,"trace choropleth").each(function(y){var p=w.select(this),g=p.selectAll("path.choroplethlocation").data(v.identity);g.enter().append("path").classed("choroplethlocation",!0),g.exit().remove(),a(t,y)})}function r(t,c){for(var o=t[0].trace,i=c[o.geo],y=i._subplot,p=o.locationmode,g=o._length,h=p==="geojson-id"?S.extractTraceFeature(t):M(o,y.topojson),m=[],u=[],_=0;_<g;_++){var s=t[_],A=p==="geojson-id"?s.fOut:S.locationToFeature(p,s.loc,h);if(A){s.geojson=A,s.ct=A.properties.ct,s._polygons=S.feature2polygons(A);var b=S.computeBbox(A);m.push(b[0],b[2]),u.push(b[1],b[3])}else s.geojson=null}if(i.fitbounds==="geojson"&&p==="geojson-id"){var f=S.computeBbox(S.getTraceGeojson(o));m=[f[0],f[2]],u=[f[1],f[3]]}var x={padded:!0};o._extremes.lon=e(i.lonaxis._ax,m,x),o._extremes.lat=e(i.lataxis._ax,u,x)}ee.exports={calcGeoJSON:r,plot:n}},{"../../lib":515,"../../lib/geo_location_utils":508,"../../lib/topojson_utils":544,"../../plots/cartesian/autorange":565,"./style":733,"@plotly/d3":58}],732:[function(d,ee,te){ee.exports=function(v,S){var M=v.cd,e=v.xaxis,a=v.yaxis,n=[],r,t,c,o,i;if(S===!1)for(r=0;r<M.length;r++)M[r].selected=0;else for(r=0;r<M.length;r++)t=M[r],c=t.ct,c&&(o=e.c2p(c),i=a.c2p(c),S.contains([o,i],null,r,v)?(n.push({pointNumber:r,lon:c[0],lat:c[1]}),t.selected=1):t.selected=0);return n}},{}],733:[function(d,ee,te){var w=d("@plotly/d3"),v=d("../../components/color"),S=d("../../components/drawing"),M=d("../../components/colorscale");function e(r,t){t&&a(r,t)}function a(r,t){var c=t[0].trace,o=t[0].node3,i=o.selectAll(".choroplethlocation"),y=c.marker||{},p=y.line||{},g=M.makeColorScaleFuncFromTrace(c);i.each(function(h){w.select(this).attr("fill",g(h.z)).call(v.stroke,h.mlc||p.color).call(S.dashLine,"",h.mlw||p.width||0).style("opacity",y.opacity)}),S.selectedPointStyle(i,c,r)}function n(r,t){var c=t[0].node3,o=t[0].trace;o.selectedpoints?S.selectedPointStyle(c.selectAll(".choroplethlocation"),o,r):a(r,t)}ee.exports={style:e,styleOnSelect:n}},{"../../components/color":367,"../../components/colorscale":379,"../../components/drawing":389,"@plotly/d3":58}],734:[function(d,ee,te){var w=d("../choropleth/attributes"),v=d("../../components/colorscale/attributes"),S=d("../../plots/template_attributes").hovertemplateAttrs,M=d("../../plots/attributes"),e=d("../../lib/extend").extendFlat;ee.exports=e({locations:{valType:"data_array",editType:"calc"},z:{valType:"data_array",editType:"calc"},geojson:{valType:"any",editType:"calc"},featureidkey:e({},w.featureidkey,{}),below:{valType:"string",editType:"plot"},text:w.text,hovertext:w.hovertext,marker:{line:{color:e({},w.marker.line.color,{editType:"plot"}),width:e({},w.marker.line.width,{editType:"plot"}),editType:"calc"},opacity:e({},w.marker.opacity,{editType:"plot"}),editType:"calc"},selected:{marker:{opacity:e({},w.selected.marker.opacity,{editType:"plot"}),editType:"plot"},editType:"plot"},unselected:{marker:{opacity:e({},w.unselected.marker.opacity,{editType:"plot"}),editType:"plot"},editType:"plot"},hoverinfo:w.hoverinfo,hovertemplate:S({},{keys:["properties"]}),showlegend:e({},M.showlegend,{dflt:!1})},v("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/template_attributes":642,"../choropleth/attributes":725}],735:[function(d,ee,te){var w=d("fast-isnumeric"),v=d("../../lib"),S=d("../../components/colorscale"),M=d("../../components/drawing"),e=d("../../lib/geojson_utils").makeBlank,a=d("../../lib/geo_location_utils");function n(t){var c=t[0].trace,o=c.visible===!0&&c._length!==0,i={layout:{visibility:"none"},paint:{}},y={layout:{visibility:"none"},paint:{}},p=c._opts={fill:i,line:y,geojson:e()};if(!o)return p;var g=a.extractTraceFeature(t);if(!g)return p;var h=S.makeColorScaleFuncFromTrace(c),m=c.marker,u=m.line||{},_;v.isArrayOrTypedArray(m.opacity)&&(_=function(T){var k=T.mo;return w(k)?+v.constrain(k,0,1):0});var s;v.isArrayOrTypedArray(u.color)&&(s=function(T){return T.mlc});var A;v.isArrayOrTypedArray(u.width)&&(A=function(T){return T.mlw});for(var b=0;b<t.length;b++){var f=t[b],x=f.fOut;if(x){var l=x.properties;l.fc=h(f.z),_&&(l.mo=_(f)),s&&(l.mlc=s(f)),A&&(l.mlw=A(f)),f.ct=l.ct,f._polygons=a.feature2polygons(x)}}var L=_?{type:"identity",property:"mo"}:m.opacity;return v.extendFlat(i.paint,{"fill-color":{type:"identity",property:"fc"},"fill-opacity":L}),v.extendFlat(y.paint,{"line-color":s?{type:"identity",property:"mlc"}:u.color,"line-width":A?{type:"identity",property:"mlw"}:u.width,"line-opacity":L}),i.layout.visibility="visible",y.layout.visibility="visible",p.geojson={type:"FeatureCollection",features:g},r(t),p}function r(t){var c=t[0].trace,o=c._opts,i;if(c.selectedpoints){for(var y=M.makeSelectedPointStyleFns(c),p=0;p<t.length;p++){var g=t[p];g.fOut&&(g.fOut.properties.mo2=y.selectedOpacityFn(g))}i={type:"identity",property:"mo2"}}else i=v.isArrayOrTypedArray(c.marker.opacity)?{type:"identity",property:"mo"}:c.marker.opacity;return v.extendFlat(o.fill.paint,{"fill-opacity":i}),v.extendFlat(o.line.paint,{"line-opacity":i}),o}ee.exports={convert:n,convertOnSelect:r}},{"../../components/colorscale":379,"../../components/drawing":389,"../../lib":515,"../../lib/geo_location_utils":508,"../../lib/geojson_utils":509,"fast-isnumeric":190}],736:[function(d,ee,te){var w=d("../../lib"),v=d("../../components/colorscale/defaults"),S=d("./attributes");ee.exports=function(e,a,n,r){function t(p,g){return w.coerce(e,a,S,p,g)}var c=t("locations"),o=t("z"),i=t("geojson");if(!w.isArrayOrTypedArray(c)||!c.length||!w.isArrayOrTypedArray(o)||!o.length||!(typeof i=="string"&&i!==""||w.isPlainObject(i))){a.visible=!1;return}t("featureidkey"),a._length=Math.min(c.length,o.length),t("below"),t("text"),t("hovertext"),t("hovertemplate");var y=t("marker.line.width");y&&t("marker.line.color"),t("marker.opacity"),v(e,a,r,t,{prefix:"",cLetter:"z"}),w.coerceSelectionMarkerOpacity(a,t)}},{"../../components/colorscale/defaults":377,"../../lib":515,"./attributes":734}],737:[function(d,ee,te){ee.exports={attributes:d("./attributes"),supplyDefaults:d("./defaults"),colorbar:d("../heatmap/colorbar"),calc:d("../choropleth/calc"),plot:d("./plot"),hoverPoints:d("../choropleth/hover"),eventData:d("../choropleth/event_data"),selectPoints:d("../choropleth/select"),styleOnSelect:function(w,v){if(v){var S=v[0].trace;S._glTrace.updateOnSelect(v)}},getBelow:function(w,v){for(var S=v.getMapLayers(),M=S.length-2;M>=0;M--){var e=S[M].id;if(typeof e=="string"&&e.indexOf("water")===0){for(var a=M+1;a<S.length;a++)if(e=S[a].id,typeof e=="string"&&e.indexOf("plotly-")===-1)return e}}},moduleType:"trace",name:"choroplethmapbox",basePlotModule:d("../../plots/mapbox"),categories:["mapbox","gl","noOpacity","showLegend"],meta:{hr_name:"choropleth_mapbox"}}},{"../../plots/mapbox":622,"../choropleth/calc":726,"../choropleth/event_data":728,"../choropleth/hover":729,"../choropleth/select":732,"../heatmap/colorbar":804,"./attributes":734,"./defaults":736,"./plot":738}],738:[function(d,ee,te){var w=d("./convert").convert,v=d("./convert").convertOnSelect,S=d("../../plots/mapbox/constants").traceLayerPrefix;function M(a,n){this.type="choroplethmapbox",this.subplot=a,this.uid=n,this.sourceId="source-"+n,this.layerList=[["fill",S+n+"-fill"],["line",S+n+"-line"]],this.below=null}var e=M.prototype;e.update=function(a){this._update(w(a))},e.updateOnSelect=function(a){this._update(v(a))},e._update=function(a){var n=this.subplot,r=this.layerList,t=n.belowLookup["trace-"+this.uid];n.map.getSource(this.sourceId).setData(a.geojson),t!==this.below&&(this._removeLayers(),this._addLayers(a,t),this.below=t);for(var c=0;c<r.length;c++){var o=r[c],i=o[0],y=o[1],p=a[i];n.setOptions(y,"setLayoutProperty",p.layout),p.layout.visibility==="visible"&&n.setOptions(y,"setPaintProperty",p.paint)}},e._addLayers=function(a,n){for(var r=this.subplot,t=this.layerList,c=this.sourceId,o=0;o<t.length;o++){var i=t[o],y=i[0],p=a[y];r.addLayer({type:y,id:i[1],source:c,layout:p.layout,paint:p.paint},n)}},e._removeLayers=function(){for(var a=this.subplot.map,n=this.layerList,r=n.length-1;r>=0;r--)a.removeLayer(n[r][1])},e.dispose=function(){var a=this.subplot.map;this._removeLayers(),a.removeSource(this.sourceId)},ee.exports=function(n,r){var t=r[0].trace,c=new M(n,t.uid),o=c.sourceId,i=w(r),y=c.below=n.belowLookup["trace-"+t.uid];return n.map.addSource(o,{type:"geojson",data:i.geojson}),c._addLayers(i,y),r[0].trace._glTrace=c,c}},{"../../plots/mapbox/constants":620,"./convert":735}],739:[function(d,ee,te){var w=d("../../components/colorscale/attributes"),v=d("../../plots/cartesian/axis_format_attributes").axisHoverFormat,S=d("../../plots/template_attributes").hovertemplateAttrs,M=d("../mesh3d/attributes"),e=d("../../plots/attributes"),a=d("../../lib/extend").extendFlat,n={x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},z:{valType:"data_array",editType:"calc+clearAxisTypes"},u:{valType:"data_array",editType:"calc"},v:{valType:"data_array",editType:"calc"},w:{valType:"data_array",editType:"calc"},sizemode:{valType:"enumerated",values:["scaled","absolute"],editType:"calc",dflt:"scaled"},sizeref:{valType:"number",editType:"calc",min:0},anchor:{valType:"enumerated",editType:"calc",values:["tip","tail","cm","center"],dflt:"cm"},text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertemplate:S({editType:"calc"},{keys:["norm"]}),uhoverformat:v("u",1),vhoverformat:v("v",1),whoverformat:v("w",1),xhoverformat:v("x"),yhoverformat:v("y"),zhoverformat:v("z"),showlegend:a({},e.showlegend,{dflt:!1})};a(n,w("",{colorAttr:"u/v/w norm",showScaleDflt:!0,editTypeOverride:"calc"}));var r=["opacity","lightposition","lighting"];r.forEach(function(t){n[t]=M[t]}),n.hoverinfo=a({},e.hoverinfo,{editType:"calc",flags:["x","y","z","u","v","w","norm","text","name"],dflt:"x+y+z+norm+text+name"}),n.transforms=void 0,ee.exports=n},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../mesh3d/attributes":876}],740:[function(d,ee,te){var w=d("../../components/colorscale/calc");ee.exports=function(S,M){for(var e=M.u,a=M.v,n=M.w,r=Math.min(M.x.length,M.y.length,M.z.length,e.length,a.length,n.length),t=-1/0,c=1/0,o=0;o<r;o++){var i=e[o],y=a[o],p=n[o],g=Math.sqrt(i*i+y*y+p*p);t=Math.max(t,g),c=Math.min(c,g)}M._len=r,M._normMax=t,w(S,M,{vals:[c,t],containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":375}],741:[function(d,ee,te){var w=d("../../../stackgl_modules").gl_cone3d,v=d("../../../stackgl_modules").gl_cone3d.createConeMesh,S=d("../../lib").simpleMap,M=d("../../lib/gl_format_color").parseColorScale,e=d("../../components/colorscale").extractOpts,a=d("../../plots/gl3d/zip3");function n(p,g){this.scene=p,this.uid=g,this.mesh=null,this.data=null}var r=n.prototype;r.handlePick=function(p){if(p.object===this.mesh){var g=p.index=p.data.index,h=this.data.x[g],m=this.data.y[g],u=this.data.z[g],_=this.data.u[g],s=this.data.v[g],A=this.data.w[g];p.traceCoordinate=[h,m,u,_,s,A,Math.sqrt(_*_+s*s+A*A)];var b=this.data.hovertext||this.data.text;return Array.isArray(b)&&b[g]!==void 0?p.textLabel=b[g]:b&&(p.textLabel=b),!0}};var t={xaxis:0,yaxis:1,zaxis:2},c={tip:1,tail:0,cm:.25,center:.5},o={tip:1,tail:1,cm:.75,center:.5};function i(p,g){var h=p.fullSceneLayout,m=p.dataScale,u={};function _(f,x){var l=h[x],L=m[t[x]];return S(f,function(T){return l.d2l(T)*L})}u.vectors=a(_(g.u,"xaxis"),_(g.v,"yaxis"),_(g.w,"zaxis"),g._len),u.positions=a(_(g.x,"xaxis"),_(g.y,"yaxis"),_(g.z,"zaxis"),g._len);var s=e(g);u.colormap=M(g),u.vertexIntensityBounds=[s.min/g._normMax,s.max/g._normMax],u.coneOffset=c[g.anchor],g.sizemode==="scaled"?u.coneSize=g.sizeref||.5:u.coneSize=g.sizeref&&g._normMax?g.sizeref/g._normMax:.5;var A=w(u),b=g.lightposition;return A.lightPosition=[b.x,b.y,b.z],A.ambient=g.lighting.ambient,A.diffuse=g.lighting.diffuse,A.specular=g.lighting.specular,A.roughness=g.lighting.roughness,A.fresnel=g.lighting.fresnel,A.opacity=g.opacity,g._pad=o[g.anchor]*A.vectorScale*A.coneScale*g._normMax,A}r.update=function(p){this.data=p;var g=i(this.scene,p);this.mesh.update(g)},r.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()};function y(p,g){var h=p.glplot.gl,m=i(p,g),u=v(h,m),_=new n(p,g.uid);return _.mesh=u,_.data=g,u._trace=_,p.glplot.add(u),_}ee.exports=y},{"../../../stackgl_modules":1133,"../../components/colorscale":379,"../../lib":515,"../../lib/gl_format_color":511,"../../plots/gl3d/zip3":618}],742:[function(d,ee,te){var w=d("../../lib"),v=d("../../components/colorscale/defaults"),S=d("./attributes");ee.exports=function(e,a,n,r){function t(h,m){return w.coerce(e,a,S,h,m)}var c=t("u"),o=t("v"),i=t("w"),y=t("x"),p=t("y"),g=t("z");if(!c||!c.length||!o||!o.length||!i||!i.length||!y||!y.length||!p||!p.length||!g||!g.length){a.visible=!1;return}t("sizeref"),t("sizemode"),t("anchor"),t("lighting.ambient"),t("lighting.diffuse"),t("lighting.specular"),t("lighting.roughness"),t("lighting.fresnel"),t("lightposition.x"),t("lightposition.y"),t("lightposition.z"),v(e,a,r,t,{prefix:"",cLetter:"c"}),t("text"),t("hovertext"),t("hovertemplate"),t("uhoverformat"),t("vhoverformat"),t("whoverformat"),t("xhoverformat"),t("yhoverformat"),t("zhoverformat"),a._length=null}},{"../../components/colorscale/defaults":377,"../../lib":515,"./attributes":739}],743:[function(d,ee,te){ee.exports={moduleType:"trace",name:"cone",basePlotModule:d("../../plots/gl3d"),categories:["gl3d","showLegend"],attributes:d("./attributes"),supplyDefaults:d("./defaults"),colorbar:{min:"cmin",max:"cmax"},calc:d("./calc"),plot:d("./convert"),eventData:function(w,v){return w.norm=v.traceCoordinate[6],w},meta:{}}},{"../../plots/gl3d":607,"./attributes":739,"./calc":740,"./convert":741,"./defaults":742}],744:[function(d,ee,te){var w=d("../heatmap/attributes"),v=d("../scatter/attributes"),S=d("../../plots/cartesian/axis_format_attributes"),M=S.axisHoverFormat,e=S.descriptionOnlyNumbers,a=d("../../components/colorscale/attributes"),n=d("../../components/drawing/attributes").dash,r=d("../../plots/font_attributes"),t=d("../../lib/extend").extendFlat,c=d("../../constants/filter_ops"),o=c.COMPARISON_OPS2,i=c.INTERVAL_OPS,y=v.line;ee.exports=t({z:w.z,x:w.x,x0:w.x0,dx:w.dx,y:w.y,y0:w.y0,dy:w.dy,xperiod:w.xperiod,yperiod:w.yperiod,xperiod0:v.xperiod0,yperiod0:v.yperiod0,xperiodalignment:w.xperiodalignment,yperiodalignment:w.yperiodalignment,text:w.text,hovertext:w.hovertext,transpose:w.transpose,xtype:w.xtype,ytype:w.ytype,xhoverformat:M("x"),yhoverformat:M("y"),zhoverformat:M("z",1),hovertemplate:w.hovertemplate,texttemplate:t({},w.texttemplate,{}),textfont:t({},w.textfont,{}),hoverongaps:w.hoverongaps,connectgaps:t({},w.connectgaps,{}),fillcolor:{valType:"color",editType:"calc"},autocontour:{valType:"boolean",dflt:!0,editType:"calc",impliedEdits:{"contours.start":void 0,"contours.end":void 0,"contours.size":void 0}},ncontours:{valType:"integer",dflt:15,min:1,editType:"calc"},contours:{type:{valType:"enumerated",values:["levels","constraint"],dflt:"levels",editType:"calc"},start:{valType:"number",dflt:null,editType:"plot",impliedEdits:{"^autocontour":!1}},end:{valType:"number",dflt:null,editType:"plot",impliedEdits:{"^autocontour":!1}},size:{valType:"number",dflt:null,min:0,editType:"plot",impliedEdits:{"^autocontour":!1}},coloring:{valType:"enumerated",values:["fill","heatmap","lines","none"],dflt:"fill",editType:"calc"},showlines:{valType:"boolean",dflt:!0,editType:"plot"},showlabels:{valType:"boolean",dflt:!1,editType:"plot"},labelfont:r({editType:"plot",colorEditType:"style"}),labelformat:{valType:"string",dflt:"",editType:"plot",description:e("contour label")},operation:{valType:"enumerated",values:[].concat(o).concat(i),dflt:"=",editType:"calc"},value:{valType:"any",dflt:0,editType:"calc"},editType:"calc",impliedEdits:{autocontour:!1}},line:{color:t({},y.color,{editType:"style+colorbars"}),width:{valType:"number",min:0,editType:"style+colorbars"},dash:n,smoothing:t({},y.smoothing,{}),editType:"plot"}},a("",{cLetter:"z",autoColorDflt:!1,editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":374,"../../components/drawing/attributes":388,"../../constants/filter_ops":487,"../../lib/extend":505,"../../plots/cartesian/axis_format_attributes":569,"../../plots/font_attributes":594,"../heatmap/attributes":801,"../scatter/attributes":936}],745:[function(d,ee,te){var w=d("../../components/colorscale"),v=d("../heatmap/calc"),S=d("./set_contours"),M=d("./end_plus");ee.exports=function(a,n){var r=v(a,n),t=r[0].z;S(n,t);var c=n.contours,o=w.extractOpts(n),i;if(c.coloring==="heatmap"&&o.auto&&n.autocontour===!1){var y=c.start,p=M(c),g=c.size||1,h=Math.floor((p-y)/g)+1;isFinite(g)||(g=1,h=1);var m=y-g/2,u=m+h*g;i=[m,u]}else i=t;return w.calc(a,n,{vals:i,cLetter:"z"}),r}},{"../../components/colorscale":379,"../heatmap/calc":802,"./end_plus":755,"./set_contours":763}],746:[function(d,ee,te){ee.exports=function(w,v){var S=w[0],M=S.z,e;switch(v.type){case"levels":var a=Math.min(M[0][0],M[0][1]);for(e=0;e<w.length;e++){var n=w[e];n.prefixBoundary=!n.edgepaths.length&&(a>n.level||n.starts.length&&a===n.level)}break;case"constraint":if(S.prefixBoundary=!1,S.edgepaths.length)return;var r=S.x.length,t=S.y.length,c=-1/0,o=1/0;for(e=0;e<t;e++)o=Math.min(o,M[e][0]),o=Math.min(o,M[e][r-1]),c=Math.max(c,M[e][0]),c=Math.max(c,M[e][r-1]);for(e=1;e<r-1;e++)o=Math.min(o,M[0][e]),o=Math.min(o,M[t-1][e]),c=Math.max(c,M[0][e]),c=Math.max(c,M[t-1][e]);var i=v.value,y,p;switch(v._operation){case">":i>c&&(S.prefixBoundary=!0);break;case"<":(i<o||S.starts.length&&i===o)&&(S.prefixBoundary=!0);break;case"[]":y=Math.min(i[0],i[1]),p=Math.max(i[0],i[1]),(p<o||y>c||S.starts.length&&p===o)&&(S.prefixBoundary=!0);break;case"][":y=Math.min(i[0],i[1]),p=Math.max(i[0],i[1]),y<o&&p>c&&(S.prefixBoundary=!0);break}break}}},{}],747:[function(d,ee,te){var w=d("../../components/colorscale"),v=d("./make_color_map"),S=d("./end_plus");function M(e,a,n){var r=a.contours,t=a.line,c=r.size||1,o=r.coloring,i=v(a,{isColorbar:!0});if(o==="heatmap"){var y=w.extractOpts(a);n._fillgradient=y.reversescale?w.flipScale(y.colorscale):y.colorscale,n._zrange=[y.min,y.max]}else o==="fill"&&(n._fillcolor=i);n._line={color:o==="lines"?i:t.color,width:r.showlines!==!1?t.width:0,dash:t.dash},n._levels={start:r.start,end:S(r),size:c}}ee.exports={min:"zmin",max:"zmax",calc:M}},{"../../components/colorscale":379,"./end_plus":755,"./make_color_map":760}],748:[function(d,ee,te){ee.exports={BOTTOMSTART:[1,9,13,104,713],TOPSTART:[4,6,7,104,713],LEFTSTART:[8,12,14,208,1114],RIGHTSTART:[2,3,11,208,1114],NEWDELTA:[null,[-1,0],[0,-1],[-1,0],[1,0],null,[0,-1],[-1,0],[0,1],[0,1],null,[0,1],[1,0],[1,0],[0,-1]],CHOOSESADDLE:{104:[4,1],208:[2,8],713:[7,13],1114:[11,14]},SADDLEREMAINDER:{1:4,2:8,4:1,7:13,8:2,11:14,13:7,14:11},LABELDISTANCE:2,LABELINCREASE:10,LABELMIN:3,LABELMAX:10,LABELOPTIMIZER:{EDGECOST:1,ANGLECOST:1,NEIGHBORCOST:5,SAMELEVELFACTOR:10,SAMELEVELDISTANCE:5,MAXCOST:100,INITIALSEARCHPOINTS:10,ITERATIONS:5}}},{}],749:[function(d,ee,te){var w=d("fast-isnumeric"),v=d("./label_defaults"),S=d("../../components/color"),M=S.addOpacity,e=S.opacity,a=d("../../constants/filter_ops"),n=a.CONSTRAINT_REDUCTION,r=a.COMPARISON_OPS2;ee.exports=function(o,i,y,p,g,h){var m=i.contours,u,_,s,A=y("contours.operation");if(m._operation=n[A],t(y,m),A==="="?u=m.showlines=!0:(u=y("contours.showlines"),s=y("fillcolor",M((o.line||{}).color||g,.5))),u){var b=s&&e(s)?M(i.fillcolor,1):g;_=y("line.color",b),y("line.width",2),y("line.dash")}y("line.smoothing"),v(y,p,_,h)};function t(c,o){var i;r.indexOf(o.operation)===-1?(c("contours.value",[0,1]),Array.isArray(o.value)?o.value.length>2?o.value=o.value.slice(2):o.length===0?o.value=[0,1]:o.length<2?(i=parseFloat(o.value[0]),o.value=[i,i+1]):o.value=[parseFloat(o.value[0]),parseFloat(o.value[1])]:w(o.value)&&(i=parseFloat(o.value),o.value=[i,i+1])):(c("contours.value",0),w(o.value)||(Array.isArray(o.value)?o.value=parseFloat(o.value[0]):o.value=0))}},{"../../components/color":367,"../../constants/filter_ops":487,"./label_defaults":759,"fast-isnumeric":190}],750:[function(d,ee,te){var w=d("../../constants/filter_ops"),v=d("fast-isnumeric");ee.exports={"[]":M("[]"),"][":M("]["),">":e(">"),"<":e("<"),"=":e("=")};function S(a,n){var r=Array.isArray(n),t;function c(o){return v(o)?+o:null}return w.COMPARISON_OPS2.indexOf(a)!==-1?t=c(r?n[0]:n):w.INTERVAL_OPS.indexOf(a)!==-1?t=r?[c(n[0]),c(n[1])]:[c(n),c(n)]:w.SET_OPS.indexOf(a)!==-1&&(t=r?n.map(c):[c(n)]),t}function M(a){return function(n){n=S(a,n);var r=Math.min(n[0],n[1]),t=Math.max(n[0],n[1]);return{start:r,end:t,size:t-r}}}function e(a){return function(n){return n=S(a,n),{start:n,end:1/0,size:1/0}}}},{"../../constants/filter_ops":487,"fast-isnumeric":190}],751:[function(d,ee,te){ee.exports=function(v,S,M,e){var a=e("contours.start"),n=e("contours.end"),r=a===!1||n===!1,t=M("contours.size"),c;r?c=S.autocontour=!0:c=M("autocontour",!1),(c||!t)&&M("ncontours")}},{}],752:[function(d,ee,te){var w=d("../../lib");ee.exports=function(S,M){var e,a,n,r=function(o){return o.reverse()},t=function(o){return o};switch(M){case"=":case"<":return S;case">":for(S.length!==1&&w.warn("Contour data invalid for the specified inequality operation."),a=S[0],e=0;e<a.edgepaths.length;e++)a.edgepaths[e]=r(a.edgepaths[e]);for(e=0;e<a.paths.length;e++)a.paths[e]=r(a.paths[e]);for(e=0;e<a.starts.length;e++)a.starts[e]=r(a.starts[e]);return S;case"][":var c=r;r=t,t=c;case"[]":for(S.length!==2&&w.warn("Contour data invalid for the specified inequality range operation."),a=v(S[0]),n=v(S[1]),e=0;e<a.edgepaths.length;e++)a.edgepaths[e]=r(a.edgepaths[e]);for(e=0;e<a.paths.length;e++)a.paths[e]=r(a.paths[e]);for(e=0;e<a.starts.length;e++)a.starts[e]=r(a.starts[e]);for(;n.edgepaths.length;)a.edgepaths.push(t(n.edgepaths.shift()));for(;n.paths.length;)a.paths.push(t(n.paths.shift()));for(;n.starts.length;)a.starts.push(t(n.starts.shift()));return[a]}};function v(S){return w.extendFlat({},S,{edgepaths:w.extendDeep([],S.edgepaths),paths:w.extendDeep([],S.paths),starts:w.extendDeep([],S.starts)})}},{"../../lib":515}],753:[function(d,ee,te){var w=d("../../lib"),v=d("../heatmap/xyz_defaults"),S=d("../scatter/period_defaults"),M=d("./constraint_defaults"),e=d("./contours_defaults"),a=d("./style_defaults"),n=d("../heatmap/label_defaults"),r=d("./attributes");ee.exports=function(c,o,i,y){function p(u,_){return w.coerce(c,o,r,u,_)}function g(u){return w.coerce2(c,o,r,u)}var h=v(c,o,p,y);if(!h){o.visible=!1;return}S(c,o,y,p),p("xhoverformat"),p("yhoverformat"),p("text"),p("hovertext"),p("hoverongaps"),p("hovertemplate");var m=p("contours.type")==="constraint";p("connectgaps",w.isArray1D(o.z)),m?M(c,o,p,y,i):(e(c,o,p,g),a(c,o,p,y)),o.contours&&o.contours.coloring==="heatmap"&&n(p,y)}},{"../../lib":515,"../heatmap/label_defaults":811,"../heatmap/xyz_defaults":816,"../scatter/period_defaults":956,"./attributes":744,"./constraint_defaults":749,"./contours_defaults":751,"./style_defaults":765}],754:[function(d,ee,te){var w=d("../../lib"),v=d("./constraint_mapping"),S=d("./end_plus");ee.exports=function(e,a,n){for(var r=e.type==="constraint"?v[e._operation](e.value):e,t=r.size,c=[],o=S(r),i=n.trace._carpetTrace,y=i?{xaxis:i.aaxis,yaxis:i.baxis,x:n.a,y:n.b}:{xaxis:a.xaxis,yaxis:a.yaxis,x:n.x,y:n.y},p=r.start;p<o;p+=t)if(c.push(w.extendFlat({level:p,crossings:{},starts:[],edgepaths:[],paths:[],z:n.z,smoothing:n.trace.line.smoothing},y)),c.length>1e3){w.warn("Too many contours, clipping at 1000",e);break}return c}},{"../../lib":515,"./constraint_mapping":750,"./end_plus":755}],755:[function(d,ee,te){ee.exports=function(v){return v.end+v.size/1e6}},{}],756:[function(d,ee,te){var w=d("../../lib"),v=d("./constants");ee.exports=function(t,c,o){var i,y,p,g,h;for(c=c||.01,o=o||.01,p=0;p<t.length;p++){for(g=t[p],h=0;h<g.starts.length;h++)y=g.starts[h],e(g,y,"edge",c,o);for(i=0;Object.keys(g.crossings).length&&i<1e4;)i++,y=Object.keys(g.crossings)[0].split(",").map(Number),e(g,y,void 0,c,o);i===1e4&&w.log("Infinite loop in contour?")}};function S(r,t,c,o){return Math.abs(r[0]-t[0])<c&&Math.abs(r[1]-t[1])<o}function M(r,t){var c=r[2]-t[2],o=r[3]-t[3];return Math.sqrt(c*c+o*o)}function e(r,t,c,o,i){var y=t.join(","),p=r.crossings[y],g=a(p,c,t),h=[n(r,t,[-g[0],-g[1]])],m=r.z.length,u=r.z[0].length,_=t.slice(),s=g.slice(),A;for(A=0;A<1e4;A++){if(p>20?(p=v.CHOOSESADDLE[p][(g[0]||g[1])<0?0:1],r.crossings[y]=v.SADDLEREMAINDER[p]):delete r.crossings[y],g=v.NEWDELTA[p],!g){w.log("Found bad marching index:",p,t,r.level);break}h.push(n(r,t,g)),t[0]+=g[0],t[1]+=g[1],y=t.join(","),S(h[h.length-1],h[h.length-2],o,i)&&h.pop();var b=g[0]&&(t[0]<0||t[0]>u-2)||g[1]&&(t[1]<0||t[1]>m-2),f=t[0]===_[0]&&t[1]===_[1]&&g[0]===s[0]&&g[1]===s[1];if(f||c&&b)break;p=r.crossings[y]}A===1e4&&w.log("Infinite loop in contour?");var x=S(h[0],h[h.length-1],o,i),l=0,L=.2*r.smoothing,T=[],k=0,P,z,I,D,R,B,F,H,G,J,X;for(A=1;A<h.length;A++)F=M(h[A],h[A-1]),l+=F,T.push(F);var Y=l/T.length*L;function Z(se){return h[se%h.length]}for(A=h.length-2;A>=k;A--)if(P=T[A],P<Y){for(I=0,z=A-1;z>=k&&P+T[z]<Y;z--)P+=T[z];if(x&&A===h.length-2)for(I=0;I<z&&P+T[I]<Y;I++)P+=T[I];R=A-z+I+1,B=Math.floor((A+z+I+2)/2),!x&&A===h.length-2?D=h[h.length-1]:!x&&z===-1?D=h[0]:R%2?D=Z(B):D=[(Z(B)[0]+Z(B+1)[0])/2,(Z(B)[1]+Z(B+1)[1])/2],h.splice(z+1,A-z+1,D),A=z+1,I&&(k=I),x&&(A===h.length-2?h[I]=h[h.length-1]:A===0&&(h[h.length-1]=h[0]))}for(h.splice(0,k),A=0;A<h.length;A++)h[A].length=2;if(!(h.length<2))if(x)h.pop(),r.paths.push(h);else{c||w.log("Unclosed interior contour?",r.level,_.join(","),h.join("L"));var oe=!1;for(H=0;H<r.edgepaths.length;H++)if(J=r.edgepaths[H],!oe&&S(J[0],h[h.length-1],o,i)){h.pop(),oe=!0;var re=!1;for(G=0;G<r.edgepaths.length;G++)if(X=r.edgepaths[G],S(X[X.length-1],h[0],o,i)){re=!0,h.shift(),r.edgepaths.splice(H,1),G===H?r.paths.push(h.concat(X)):(G>H&&G--,r.edgepaths[G]=X.concat(h,J));break}re||(r.edgepaths[H]=h.concat(J))}for(H=0;H<r.edgepaths.length&&!oe;H++)J=r.edgepaths[H],S(J[J.length-1],h[0],o,i)&&(h.shift(),r.edgepaths[H]=J.concat(h),oe=!0);oe||r.edgepaths.push(h)}}function a(r,t,c){var o=0,i=0;return r>20&&t?r===208||r===1114?o=c[0]===0?1:-1:i=c[1]===0?1:-1:v.BOTTOMSTART.indexOf(r)!==-1?i=1:v.LEFTSTART.indexOf(r)!==-1?o=1:v.TOPSTART.indexOf(r)!==-1?i=-1:o=-1,[o,i]}function n(r,t,c){var o=t[0]+Math.max(c[0],0),i=t[1]+Math.max(c[1],0),y=r.z[i][o],p=r.xaxis,g=r.yaxis;if(c[1]){var h=(r.level-y)/(r.z[i][o+1]-y),m=(h!==1?(1-h)*p.c2l(r.x[o]):0)+(h!==0?h*p.c2l(r.x[o+1]):0);return[p.c2p(p.l2c(m),!0),g.c2p(r.y[i],!0),o+h,i]}else{var u=(r.level-y)/(r.z[i+1][o]-y),_=(u!==1?(1-u)*g.c2l(r.y[i]):0)+(u!==0?u*g.c2l(r.y[i+1]):0);return[p.c2p(r.x[o],!0),g.c2p(g.l2c(_),!0),o,i+u]}}},{"../../lib":515,"./constants":748}],757:[function(d,ee,te){var w=d("../../components/color"),v=d("../heatmap/hover");ee.exports=function(M,e,a,n,r){r||(r={}),r.isContour=!0;var t=v(M,e,a,n,r);return t&&t.forEach(function(c){var o=c.trace;o.contours.type==="constraint"&&(o.fillcolor&&w.opacity(o.fillcolor)?c.color=w.addOpacity(o.fillcolor,1):o.contours.showlines&&w.opacity(o.line.color)&&(c.color=w.addOpacity(o.line.color,1)))}),t}},{"../../components/color":367,"../heatmap/hover":808}],758:[function(d,ee,te){ee.exports={attributes:d("./attributes"),supplyDefaults:d("./defaults"),calc:d("./calc"),plot:d("./plot").plot,style:d("./style"),colorbar:d("./colorbar"),hoverPoints:d("./hover"),moduleType:"trace",name:"contour",basePlotModule:d("../../plots/cartesian"),categories:["cartesian","svg","2dMap","contour","showLegend"],meta:{}}},{"../../plots/cartesian":578,"./attributes":744,"./calc":745,"./colorbar":747,"./defaults":753,"./hover":757,"./plot":762,"./style":764}],759:[function(d,ee,te){var w=d("../../lib");ee.exports=function(S,M,e,a){a||(a={});var n=S("contours.showlabels");if(n){var r=M.font;w.coerceFont(S,"contours.labelfont",{family:r.family,size:r.size,color:e}),S("contours.labelformat")}a.hasHover!==!1&&S("zhoverformat")}},{"../../lib":515}],760:[function(d,ee,te){var w=d("@plotly/d3"),v=d("../../components/colorscale"),S=d("./end_plus");ee.exports=function(e){var a=e.contours,n=a.start,r=S(a),t=a.size||1,c=Math.floor((r-n)/t)+1,o=a.coloring==="lines"?0:1,i=v.extractOpts(e);isFinite(t)||(t=1,c=1);var y=i.reversescale?v.flipScale(i.colorscale):i.colorscale,p=y.length,g=new Array(p),h=new Array(p),m,u;if(a.coloring==="heatmap"){var _=i.min,s=i.max;for(u=0;u<p;u++)m=y[u],g[u]=m[0]*(s-_)+_,h[u]=m[1];var A=w.extent([_,s,a.start,a.start+t*(c-1)]),b=A[_<s?0:1],f=A[_<s?1:0];b!==_&&(g.splice(0,0,b),h.splice(0,0,h[0])),f!==s&&(g.push(f),h.push(h[h.length-1]))}else for(u=0;u<p;u++)m=y[u],g[u]=(m[0]*(c+o-1)-o/2)*t+n,h[u]=m[1];return v.makeColorScaleFunc({domain:g,range:h},{noNumericCheck:!0})}},{"../../components/colorscale":379,"./end_plus":755,"@plotly/d3":58}],761:[function(d,ee,te){var w=d("./constants");ee.exports=function(M){var e=M[0].z,a=e.length,n=e[0].length,r=a===2||n===2,t,c,o,i,y,p,g,h,m;for(c=0;c<a-1;c++)for(i=[],c===0&&(i=i.concat(w.BOTTOMSTART)),c===a-2&&(i=i.concat(w.TOPSTART)),t=0;t<n-1;t++)for(o=i.slice(),t===0&&(o=o.concat(w.LEFTSTART)),t===n-2&&(o=o.concat(w.RIGHTSTART)),y=t+","+c,p=[[e[c][t],e[c][t+1]],[e[c+1][t],e[c+1][t+1]]],m=0;m<M.length;m++)h=M[m],g=v(h.level,p),g&&(h.crossings[y]=g,o.indexOf(g)!==-1&&(h.starts.push([t,c]),r&&o.indexOf(g,o.indexOf(g)+1)!==-1&&h.starts.push([t,c])))};function v(S,M){var e=(M[0][0]>S?0:1)+(M[0][1]>S?0:2)+(M[1][1]>S?0:4)+(M[1][0]>S?0:8);if(e===5||e===10){var a=(M[0][0]+M[0][1]+M[1][0]+M[1][1])/4;return S>a?e===5?713:1114:e===5?104:208}return e===15?0:e}},{"./constants":748}],762:[function(d,ee,te){var w=d("@plotly/d3"),v=d("../../lib"),S=d("../../components/drawing"),M=d("../../components/colorscale"),e=d("../../lib/svg_text_utils"),a=d("../../plots/cartesian/axes"),n=d("../../plots/cartesian/set_convert"),r=d("../heatmap/plot"),t=d("./make_crossings"),c=d("./find_all_paths"),o=d("./empty_pathinfo"),i=d("./convert_to_constraints"),y=d("./close_boundaries"),p=d("./constants"),g=p.LABELOPTIMIZER;te.plot=function(x,l,L,T){var k=l.xaxis,P=l.yaxis;v.makeTraceGroups(T,L,"contour").each(function(z){var I=w.select(this),D=z[0],R=D.trace,B=D.x,F=D.y,H=R.contours,G=o(H,l,D),J=v.ensureSingle(I,"g","heatmapcoloring"),X=[];H.coloring==="heatmap"&&(X=[z]),r(x,l,X,J),t(G),c(G);var Y=k.c2p(B[0],!0),Z=k.c2p(B[B.length-1],!0),oe=P.c2p(F[0],!0),re=P.c2p(F[F.length-1],!0),se=[[Y,re],[Z,re],[Z,oe],[Y,oe]],N=G;H.type==="constraint"&&(N=i(G,H._operation)),h(I,se,H),m(I,N,se,H),_(I,G,x,D,H),A(I,l,x,D,se)})};function h(f,x,l){var L=v.ensureSingle(f,"g","contourbg"),T=L.selectAll("path").data(l.coloring==="fill"?[0]:[]);T.enter().append("path"),T.exit().remove(),T.attr("d","M"+x.join("L")+"Z").style("stroke","none")}function m(f,x,l,L){var T=L.coloring==="fill"||L.type==="constraint"&&L._operation!=="=",k="M"+l.join("L")+"Z";T&&y(x,L);var P=v.ensureSingle(f,"g","contourfill"),z=P.selectAll("path").data(T?x:[]);z.enter().append("path"),z.exit().remove(),z.each(function(I){var D=(I.prefixBoundary?k:"")+u(I,l);D?w.select(this).attr("d",D).style("stroke","none"):w.select(this).remove()})}function u(f,x){var l="",L=0,T=f.edgepaths.map(function(Y,Z){return Z}),k=!0,P,z,I,D,R,B;function F(Y){return Math.abs(Y[1]-x[0][1])<.01}function H(Y){return Math.abs(Y[1]-x[2][1])<.01}function G(Y){return Math.abs(Y[0]-x[0][0])<.01}function J(Y){return Math.abs(Y[0]-x[2][0])<.01}for(;T.length;){for(B=S.smoothopen(f.edgepaths[L],f.smoothing),l+=k?B:B.replace(/^M/,"L"),T.splice(T.indexOf(L),1),P=f.edgepaths[L][f.edgepaths[L].length-1],D=-1,I=0;I<4;I++){if(!P){v.log("Missing end?",L,f);break}for(F(P)&&!J(P)?z=x[1]:G(P)?z=x[0]:H(P)?z=x[3]:J(P)&&(z=x[2]),R=0;R<f.edgepaths.length;R++){var X=f.edgepaths[R][0];Math.abs(P[0]-z[0])<.01?Math.abs(P[0]-X[0])<.01&&(X[1]-P[1])*(z[1]-X[1])>=0&&(z=X,D=R):Math.abs(P[1]-z[1])<.01?Math.abs(P[1]-X[1])<.01&&(X[0]-P[0])*(z[0]-X[0])>=0&&(z=X,D=R):v.log("endpt to newendpt is not vert. or horz.",P,z,X)}if(P=z,D>=0)break;l+="L"+z}if(D===f.edgepaths.length){v.log("unclosed perimeter path");break}L=D,k=T.indexOf(L)===-1,k&&(L=T[0],l+="Z")}for(L=0;L<f.paths.length;L++)l+=S.smoothclosed(f.paths[L],f.smoothing);return l}function _(f,x,l,L,T){var k=v.ensureSingle(f,"g","contourlines"),P=T.showlines!==!1,z=T.showlabels,I=P&&z,D=te.createLines(k,P||z,x),R=te.createLineClip(k,I,l,L.trace.uid),B=f.selectAll("g.contourlabels").data(z?[0]:[]);if(B.exit().remove(),B.enter().append("g").classed("contourlabels",!0),z){var F=[],H=[];v.clearLocationCache();var G=te.labelFormatter(l,L),J=S.tester.append("text").attr("data-notex",1).call(S.font,T.labelfont),X=x[0].xaxis,Y=x[0].yaxis,Z=X._length,oe=Y._length,re=X.range,se=Y.range,N=v.aggNums(Math.min,null,L.x),U=v.aggNums(Math.max,null,L.x),q=v.aggNums(Math.min,null,L.y),$=v.aggNums(Math.max,null,L.y),W=Math.max(X.c2p(N,!0),0),K=Math.min(X.c2p(U,!0),Z),ne=Math.max(Y.c2p($,!0),0),ae=Math.min(Y.c2p(q,!0),oe),ie={};re[0]<re[1]?(ie.left=W,ie.right=K):(ie.left=K,ie.right=W),se[0]<se[1]?(ie.top=ne,ie.bottom=ae):(ie.top=ae,ie.bottom=ne),ie.middle=(ie.top+ie.bottom)/2,ie.center=(ie.left+ie.right)/2,F.push([[ie.left,ie.top],[ie.right,ie.top],[ie.right,ie.bottom],[ie.left,ie.bottom]]);var le=Math.sqrt(Z*Z+oe*oe),ye=p.LABELDISTANCE*le/Math.max(1,x.length/p.LABELINCREASE);D.each(function(ue){var pe=te.calcTextOpts(ue.level,G,J,l);w.select(this).selectAll("path").each(function(){var ge=this,Te=v.getVisibleSegment(ge,ie,pe.height/2);if(!!Te&&!(Te.len<(pe.width+pe.height)*p.LABELMIN))for(var _e=Math.min(Math.ceil(Te.len/ye),p.LABELMAX),ze=0;ze<_e;ze++){var Oe=te.findBestTextLocation(ge,Te,pe,H,ie);if(!Oe)break;te.addLabelData(Oe,pe,H,F)}})}),J.remove(),te.drawLabels(B,H,l,R,I?F:null)}z&&!P&&D.remove()}te.createLines=function(f,x,l){var L=l[0].smoothing,T=f.selectAll("g.contourlevel").data(x?l:[]);if(T.exit().remove(),T.enter().append("g").classed("contourlevel",!0),x){var k=T.selectAll("path.openline").data(function(z){return z.pedgepaths||z.edgepaths});k.exit().remove(),k.enter().append("path").classed("openline",!0),k.attr("d",function(z){return S.smoothopen(z,L)}).style("stroke-miterlimit",1).style("vector-effect","non-scaling-stroke");var P=T.selectAll("path.closedline").data(function(z){return z.ppaths||z.paths});P.exit().remove(),P.enter().append("path").classed("closedline",!0),P.attr("d",function(z){return S.smoothclosed(z,L)}).style("stroke-miterlimit",1).style("vector-effect","non-scaling-stroke")}return T},te.createLineClip=function(f,x,l,L){var T=l._fullLayout._clips,k=x?"clipline"+L:null,P=T.selectAll("#"+k).data(x?[0]:[]);return P.exit().remove(),P.enter().append("clipPath").classed("contourlineclip",!0).attr("id",k),S.setClipUrl(f,k,l),P},te.labelFormatter=function(f,x){var l=f._fullLayout,L=x.trace,T=L.contours,k={type:"linear",_id:"ycontour",showexponent:"all",exponentformat:"B"};if(T.labelformat)k.tickformat=T.labelformat,n(k,l);else{var P=M.extractOpts(L);if(P&&P.colorbar&&P.colorbar._axis)k=P.colorbar._axis;else{if(T.type==="constraint"){var z=T.value;Array.isArray(z)?k.range=[z[0],z[z.length-1]]:k.range=[z,z]}else k.range=[T.start,T.end],k.nticks=(T.end-T.start)/T.size;k.range[0]===k.range[1]&&(k.range[1]+=k.range[0]||1),k.nticks||(k.nticks=1e3),n(k,l),a.prepTicks(k),k._tmin=null,k._tmax=null}}return function(I){return a.tickText(k,I).text}},te.calcTextOpts=function(f,x,l,L){var T=x(f);l.text(T).call(e.convertToTspans,L);var k=l.node(),P=S.bBox(k,!0);return{text:T,width:P.width,height:P.height,fontSize:+k.style["font-size"].replace("px",""),level:f,dy:(P.top+P.bottom)/2}},te.findBestTextLocation=function(f,x,l,L,T){var k=l.width,P,z,I,D,R;x.isClosed?(z=x.len/g.INITIALSEARCHPOINTS,P=x.min+z/2,I=x.max):(z=(x.len-k)/(g.INITIALSEARCHPOINTS+1),P=x.min+z+k/2,I=x.max-(z+k)/2);for(var B=1/0,F=0;F<g.ITERATIONS;F++){for(var H=P;H<I;H+=z){var G=v.getTextLocation(f,x.total,H,k),J=s(G,l,L,T);J<B&&(B=J,R=G,D=H)}if(B>g.MAXCOST*2)break;F&&(z/=2),P=D-z/2,I=P+z*1.5}if(B<=g.MAXCOST)return R};function s(f,x,l,L){var T=x.width/2,k=x.height/2,P=f.x,z=f.y,I=f.theta,D=Math.cos(I)*T,R=Math.sin(I)*T,B=(P>L.center?L.right-P:P-L.left)/(D+Math.abs(Math.sin(I)*k)),F=(z>L.middle?L.bottom-z:z-L.top)/(Math.abs(R)+Math.cos(I)*k);if(B<1||F<1)return 1/0;var H=g.EDGECOST*(1/(B-1)+1/(F-1));H+=g.ANGLECOST*I*I;for(var G=P-D,J=z-R,X=P+D,Y=z+R,Z=0;Z<l.length;Z++){var oe=l[Z],re=Math.cos(oe.theta)*oe.width/2,se=Math.sin(oe.theta)*oe.width/2,N=v.segmentDistance(G,J,X,Y,oe.x-re,oe.y-se,oe.x+re,oe.y+se)*2/(x.height+oe.height),U=oe.level===x.level,q=U?g.SAMELEVELDISTANCE:1;if(N<=q)return 1/0;var $=g.NEIGHBORCOST*(U?g.SAMELEVELFACTOR:1);H+=$/(N-q)}return H}te.addLabelData=function(f,x,l,L){var T=x.fontSize,k=x.width+T/3,P=Math.max(0,x.height-T/3),z=f.x,I=f.y,D=f.theta,R=Math.sin(D),B=Math.cos(D),F=function(G,J){return[z+G*B-J*R,I+G*R+J*B]},H=[F(-k/2,-P/2),F(-k/2,P/2),F(k/2,P/2),F(k/2,-P/2)];l.push({text:x.text,x:z,y:I,dy:x.dy,theta:D,level:x.level,width:k,height:P}),L.push(H)},te.drawLabels=function(f,x,l,L,T){var k=f.selectAll("text").data(x,function(D){return D.text+","+D.x+","+D.y+","+D.theta});if(k.exit().remove(),k.enter().append("text").attr({"data-notex":1,"text-anchor":"middle"}).each(function(D){var R=D.x+Math.sin(D.theta)*D.dy,B=D.y-Math.cos(D.theta)*D.dy;w.select(this).text(D.text).attr({x:R,y:B,transform:"rotate("+180*D.theta/Math.PI+" "+R+" "+B+")"}).call(e.convertToTspans,l)}),T){for(var P="",z=0;z<T.length;z++)P+="M"+T[z].join("L")+"Z";var I=v.ensureSingle(L,"path","");I.attr("d",P)}};function A(f,x,l,L,T){var k=L.trace,P=l._fullLayout._clips,z="clip"+k.uid,I=P.selectAll("#"+z).data(k.connectgaps?[]:[0]);if(I.enter().append("clipPath").classed("contourclip",!0).attr("id",z),I.exit().remove(),k.connectgaps===!1){var D={level:.9,crossings:{},starts:[],edgepaths:[],paths:[],xaxis:x.xaxis,yaxis:x.yaxis,x:L.x,y:L.y,z:b(L),smoothing:0};t([D]),c([D]),y([D],{type:"levels"});var R=v.ensureSingle(I,"path","");R.attr("d",(D.prefixBoundary?"M"+T.join("L")+"Z":"")+u(D,T))}else z=null;S.setClipUrl(f,z,l)}function b(f){var x=f.trace._emptypoints,l=[],L=f.z.length,T=f.z[0].length,k,P=[],z;for(k=0;k<T;k++)P.push(1);for(k=0;k<L;k++)l.push(P.slice());for(k=0;k<x.length;k++)z=x[k],l[z[0]][z[1]]=0;return f.zmask=l,l}},{"../../components/colorscale":379,"../../components/drawing":389,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/cartesian/axes":566,"../../plots/cartesian/set_convert":585,"../heatmap/plot":813,"./close_boundaries":746,"./constants":748,"./convert_to_constraints":752,"./empty_pathinfo":754,"./find_all_paths":756,"./make_crossings":761,"@plotly/d3":58}],763:[function(d,ee,te){var w=d("../../plots/cartesian/axes"),v=d("../../lib");ee.exports=function(e,a){var n=e.contours;if(e.autocontour){var r=e.zmin,t=e.zmax;(e.zauto||r===void 0)&&(r=v.aggNums(Math.min,null,a)),(e.zauto||t===void 0)&&(t=v.aggNums(Math.max,null,a));var c=S(r,t,e.ncontours);n.size=c.dtick,n.start=w.tickFirst(c),c.range.reverse(),n.end=w.tickFirst(c),n.start===r&&(n.start+=n.size),n.end===t&&(n.end-=n.size),n.start>n.end&&(n.start=n.end=(n.start+n.end)/2),e._input.contours||(e._input.contours={}),v.extendFlat(e._input.contours,{start:n.start,end:n.end,size:n.size}),e._input.autocontour=!0}else if(n.type!=="constraint"){var o=n.start,i=n.end,y=e._input.contours;if(o>i&&(n.start=y.start=i,i=n.end=y.end=o,o=n.start),!(n.size>0)){var p;o===i?p=1:p=S(o,i,e.ncontours).dtick,y.size=n.size=p}}};function S(M,e,a){var n={type:"linear",range:[M,e]};return w.autoTicks(n,(e-M)/(a||15)),n}},{"../../lib":515,"../../plots/cartesian/axes":566}],764:[function(d,ee,te){var w=d("@plotly/d3"),v=d("../../components/drawing"),S=d("../heatmap/style"),M=d("./make_color_map");ee.exports=function(a){var n=w.select(a).selectAll("g.contour");n.style("opacity",function(r){return r[0].trace.opacity}),n.each(function(r){var t=w.select(this),c=r[0].trace,o=c.contours,i=c.line,y=o.size||1,p=o.start,g=o.type==="constraint",h=!g&&o.coloring==="lines",m=!g&&o.coloring==="fill",u=h||m?M(c):null;t.selectAll("g.contourlevel").each(function(A){w.select(this).selectAll("path").call(v.lineGroupStyle,i.width,h?u(A.level):i.color,i.dash)});var _=o.labelfont;if(t.selectAll("g.contourlabels text").each(function(A){v.font(w.select(this),{family:_.family,size:_.size,color:_.color||(h?u(A.level):i.color)})}),g)t.selectAll("g.contourfill path").style("fill",c.fillcolor);else if(m){var s;t.selectAll("g.contourfill path").style("fill",function(A){return s===void 0&&(s=A.level),u(A.level+.5*y)}),s===void 0&&(s=p),t.selectAll("g.contourbg path").style("fill",u(s-.5*y))}}),S(a)}},{"../../components/drawing":389,"../heatmap/style":814,"./make_color_map":760,"@plotly/d3":58}],765:[function(d,ee,te){var w=d("../../components/colorscale/defaults"),v=d("./label_defaults");ee.exports=function(M,e,a,n,r){var t=a("contours.coloring"),c,o="";t==="fill"&&(c=a("contours.showlines")),c!==!1&&(t!=="lines"&&(o=a("line.color","#000")),a("line.width",.5),a("line.dash")),t!=="none"&&(M.showlegend!==!0&&(e.showlegend=!1),e._dfltShowLegend=!1,w(M,e,n,a,{prefix:"",cLetter:"z"})),a("line.smoothing"),v(a,n,o,r)}},{"../../components/colorscale/defaults":377,"./label_defaults":759}],766:[function(d,ee,te){var w=d("../heatmap/attributes"),v=d("../contour/attributes"),S=d("../../components/colorscale/attributes"),M=d("../../lib/extend").extendFlat,e=v.contours;ee.exports=M({carpet:{valType:"string",editType:"calc"},z:w.z,a:w.x,a0:w.x0,da:w.dx,b:w.y,b0:w.y0,db:w.dy,text:w.text,hovertext:w.hovertext,transpose:w.transpose,atype:w.xtype,btype:w.ytype,fillcolor:v.fillcolor,autocontour:v.autocontour,ncontours:v.ncontours,contours:{type:e.type,start:e.start,end:e.end,size:e.size,coloring:{valType:"enumerated",values:["fill","lines","none"],dflt:"fill",editType:"calc"},showlines:e.showlines,showlabels:e.showlabels,labelfont:e.labelfont,labelformat:e.labelformat,operation:e.operation,value:e.value,editType:"calc",impliedEdits:{autocontour:!1}},line:{color:v.line.color,width:v.line.width,dash:v.line.dash,smoothing:v.line.smoothing,editType:"plot"},transforms:void 0},S("",{cLetter:"z",autoColorDflt:!1}))},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../contour/attributes":744,"../heatmap/attributes":801}],767:[function(d,ee,te){var w=d("../../components/colorscale/calc"),v=d("../../lib"),S=d("../heatmap/convert_column_xyz"),M=d("../heatmap/clean_2d_array"),e=d("../heatmap/interp2d"),a=d("../heatmap/find_empties"),n=d("../heatmap/make_bound_array"),r=d("./defaults"),t=d("../carpet/lookup_carpetid"),c=d("../contour/set_contours");ee.exports=function(y,p){var g=p._carpetTrace=t(y,p);if(!(!g||!g.visible||g.visible==="legendonly")){if(!p.a||!p.b){var h=y.data[g.index],m=y.data[p.index];m.a||(m.a=h.a),m.b||(m.b=h.b),r(m,p,p._defaultColor,y._fullLayout)}var u=o(y,p);return c(p,p._z),u}};function o(i,y){var p=y._carpetTrace,g=p.aaxis,h=p.baxis,m,u,_,s,A,b,f;g._minDtick=0,h._minDtick=0,v.isArray1D(y.z)&&S(y,g,h,"a","b",["z"]),m=y._a=y._a||y.a,s=y._b=y._b||y.b,m=m?g.makeCalcdata(y,"_a"):[],s=s?h.makeCalcdata(y,"_b"):[],u=y.a0||0,_=y.da||1,A=y.b0||0,b=y.db||1,f=y._z=M(y._z||y.z,y.transpose),y._emptypoints=a(f),e(f,y._emptypoints);var x=v.maxRowLength(f),l=y.xtype==="scaled"?"":m,L=n(y,l,u,_,x,g),T=y.ytype==="scaled"?"":s,k=n(y,T,A,b,f.length,h),P={a:L,b:k,z:f};return y.contours.type==="levels"&&y.contours.coloring!=="none"&&w(i,y,{vals:f,containerStr:"",cLetter:"z"}),[P]}},{"../../components/colorscale/calc":375,"../../lib":515,"../carpet/lookup_carpetid":717,"../contour/set_contours":763,"../heatmap/clean_2d_array":803,"../heatmap/convert_column_xyz":805,"../heatmap/find_empties":807,"../heatmap/interp2d":810,"../heatmap/make_bound_array":812,"./defaults":768}],768:[function(d,ee,te){var w=d("../../lib"),v=d("../heatmap/xyz_defaults"),S=d("./attributes"),M=d("../contour/constraint_defaults"),e=d("../contour/contours_defaults"),a=d("../contour/style_defaults");ee.exports=function(r,t,c,o){function i(h,m){return w.coerce(r,t,S,h,m)}function y(h){return w.coerce2(r,t,S,h)}if(i("carpet"),r.a&&r.b){var p=v(r,t,i,o,"a","b");if(!p){t.visible=!1;return}i("text");var g=i("contours.type")==="constraint";g?M(r,t,i,o,c,{hasHover:!1}):(e(r,t,i,y),a(r,t,i,o,{hasHover:!1}))}else t._defaultColor=c,t._length=null}},{"../../lib":515,"../contour/constraint_defaults":749,"../contour/contours_defaults":751,"../contour/style_defaults":765,"../heatmap/xyz_defaults":816,"./attributes":766}],769:[function(d,ee,te){ee.exports={attributes:d("./attributes"),supplyDefaults:d("./defaults"),colorbar:d("../contour/colorbar"),calc:d("./calc"),plot:d("./plot"),style:d("../contour/style"),moduleType:"trace",name:"contourcarpet",basePlotModule:d("../../plots/cartesian"),categories:["cartesian","svg","carpet","contour","symbols","showLegend","hasLines","carpetDependent","noHover","noSortingByValue"],meta:{}}},{"../../plots/cartesian":578,"../contour/colorbar":747,"../contour/style":764,"./attributes":766,"./calc":767,"./defaults":768,"./plot":770}],770:[function(d,ee,te){var w=d("@plotly/d3"),v=d("../carpet/map_1d_array"),S=d("../carpet/makepath"),M=d("../../components/drawing"),e=d("../../lib"),a=d("../contour/make_crossings"),n=d("../contour/find_all_paths"),r=d("../contour/plot"),t=d("../contour/constants"),c=d("../contour/convert_to_constraints"),o=d("../contour/empty_pathinfo"),i=d("../contour/close_boundaries"),y=d("../carpet/lookup_carpetid"),p=d("../carpet/axis_aligned_line");ee.exports=function(l,L,T,k){var P=L.xaxis,z=L.yaxis;e.makeTraceGroups(k,T,"contour").each(function(I){var D=w.select(this),R=I[0],B=R.trace,F=B._carpetTrace=y(l,B),H=l.calcdata[F.index][0];if(!F.visible||F.visible==="legendonly")return;var G=R.a,J=R.b,X=B.contours,Y=o(X,L,R),Z=X.type==="constraint",oe=X._operation,re=Z?oe==="="?"lines":"fill":X.coloring;function se(ye){var ue=F.ab2xy(ye[0],ye[1],!0);return[P.c2p(ue[0]),z.c2p(ue[1])]}var N=[[G[0],J[J.length-1]],[G[G.length-1],J[J.length-1]],[G[G.length-1],J[0]],[G[0],J[0]]];a(Y);var U=(G[G.length-1]-G[0])*1e-8,q=(J[J.length-1]-J[0])*1e-8;n(Y,U,q);var $=Y;X.type==="constraint"&&($=c(Y,oe)),g(Y,se);var W,K,ne,ae,ie=[];for(ae=H.clipsegments.length-1;ae>=0;ae--)W=H.clipsegments[ae],K=v([],W.x,P.c2p),ne=v([],W.y,z.c2p),K.reverse(),ne.reverse(),ie.push(S(K,ne,W.bicubic));var le="M"+ie.join("L")+"Z";A(D,H.clipsegments,P,z,Z,re),b(B,D,P,z,$,N,se,F,H,re,le),h(D,Y,l,R,X,L,F),M.setClipUrl(D,F._clipPathId,l)})};function g(x,l){var L,T,k,P,z,I,D,R,B;for(L=0;L<x.length;L++){for(P=x[L],z=P.pedgepaths=[],I=P.ppaths=[],T=0;T<P.edgepaths.length;T++){for(B=P.edgepaths[T],D=[],k=0;k<B.length;k++)D[k]=l(B[k]);z.push(D)}for(T=0;T<P.paths.length;T++){for(B=P.paths[T],R=[],k=0;k<B.length;k++)R[k]=l(B[k]);I.push(R)}}}function h(x,l,L,T,k,P,z){var I=e.ensureSingle(x,"g","contourlines"),D=k.showlines!==!1,R=k.showlabels,B=D&&R,F=r.createLines(I,D||R,l),H=r.createLineClip(I,B,L,T.trace.uid),G=x.selectAll("g.contourlabels").data(R?[0]:[]);if(G.exit().remove(),G.enter().append("g").classed("contourlabels",!0),R){var J=P.xaxis,X=P.yaxis,Y=J._length,Z=X._length,oe=[[[0,0],[Y,0],[Y,Z],[0,Z]]],re=[];e.clearLocationCache();var se=r.labelFormatter(L,T),N=M.tester.append("text").attr("data-notex",1).call(M.font,k.labelfont),U={left:0,right:Y,center:Y/2,top:0,bottom:Z,middle:Z/2},q=Math.sqrt(Y*Y+Z*Z),$=t.LABELDISTANCE*q/Math.max(1,l.length/t.LABELINCREASE);F.each(function(W){var K=r.calcTextOpts(W.level,se,N,L);w.select(this).selectAll("path").each(function(ne){var ae=this,ie=e.getVisibleSegment(ae,U,K.height/2);if(!!ie&&(m(ae,ne,W,ie,z,K.height),!(ie.len<(K.width+K.height)*t.LABELMIN)))for(var le=Math.min(Math.ceil(ie.len/$),t.LABELMAX),ye=0;ye<le;ye++){var ue=r.findBestTextLocation(ae,ie,K,re,U);if(!ue)break;r.addLabelData(ue,K,re,oe)}})}),N.remove(),r.drawLabels(G,re,L,H,B?oe:null)}R&&!D&&F.remove()}function m(x,l,L,T,k,P){for(var z,I=0;I<L.pedgepaths.length;I++)l===L.pedgepaths[I]&&(z=L.edgepaths[I]);if(!z)return;var D=k.a[0],R=k.a[k.a.length-1],B=k.b[0],F=k.b[k.b.length-1];function H(Z,oe){var re=0,se,N=.1;return(Math.abs(Z[0]-D)<N||Math.abs(Z[0]-R)<N)&&(se=_(k.dxydb_rough(Z[0],Z[1],N)),re=Math.max(re,P*s(oe,se)/2)),(Math.abs(Z[1]-B)<N||Math.abs(Z[1]-F)<N)&&(se=_(k.dxyda_rough(Z[0],Z[1],N)),re=Math.max(re,P*s(oe,se)/2)),re}var G=u(x,0,1),J=u(x,T.total,T.total-1),X=H(z[0],G),Y=T.total-H(z[z.length-1],J);T.min<X&&(T.min=X),T.max>Y&&(T.max=Y),T.len=T.max-T.min}function u(x,l,L){var T=x.getPointAtLength(l),k=x.getPointAtLength(L),P=k.x-T.x,z=k.y-T.y,I=Math.sqrt(P*P+z*z);return[P/I,z/I]}function _(x){var l=Math.sqrt(x[0]*x[0]+x[1]*x[1]);return[x[0]/l,x[1]/l]}function s(x,l){var L=Math.abs(x[0]*l[0]+x[1]*l[1]),T=Math.sqrt(1-L*L);return T/L}function A(x,l,L,T,k,P){var z,I,D,R,B=e.ensureSingle(x,"g","contourbg"),F=B.selectAll("path").data(P==="fill"&&!k?[0]:[]);F.enter().append("path"),F.exit().remove();var H=[];for(R=0;R<l.length;R++)z=l[R],I=v([],z.x,L.c2p),D=v([],z.y,T.c2p),H.push(S(I,D,z.bicubic));F.attr("d","M"+H.join("L")+"Z").style("stroke","none")}function b(x,l,L,T,k,P,z,I,D,R,B){var F=R==="fill";F&&i(k,x.contours);var H=e.ensureSingle(l,"g","contourfill"),G=H.selectAll("path").data(F?k:[]);G.enter().append("path"),G.exit().remove(),G.each(function(J){var X=(J.prefixBoundary?B:"")+f(x,J,P,z,I,D,L,T);X?w.select(this).attr("d",X).style("stroke","none"):w.select(this).remove()})}function f(x,l,L,T,k,P,z,I){var D,R="",B=l.edgepaths.map(function(ne,ae){return ae}),F=!0,H,G,J,X,Y,Z,oe=Math.abs(L[0][0]-L[2][0])*1e-4,re=Math.abs(L[0][1]-L[2][1])*1e-4;function se(ne){return Math.abs(ne[1]-L[0][1])<re}function N(ne){return Math.abs(ne[1]-L[2][1])<re}function U(ne){return Math.abs(ne[0]-L[0][0])<oe}function q(ne){return Math.abs(ne[0]-L[2][0])<oe}function $(ne,ae){var ie,le,ye,ue,pe="";for(se(ne)&&!q(ne)||N(ne)&&!U(ne)?(ue=k.aaxis,ye=p(k,P,[ne[0],ae[0]],.5*(ne[1]+ae[1]))):(ue=k.baxis,ye=p(k,P,.5*(ne[0]+ae[0]),[ne[1],ae[1]])),ie=1;ie<ye.length;ie++)for(pe+=ue.smoothing?"C":"L",le=0;le<ye[ie].length;le++){var ge=ye[ie][le];pe+=[z.c2p(ge[0]),I.c2p(ge[1])]+" "}return pe}for(D=0,H=null;B.length;){var W=l.edgepaths[D][0];for(H&&(R+=$(H,W)),Z=M.smoothopen(l.edgepaths[D].map(T),l.smoothing),R+=F?Z:Z.replace(/^M/,"L"),B.splice(B.indexOf(D),1),H=l.edgepaths[D][l.edgepaths[D].length-1],X=-1,J=0;J<4;J++){if(!H){e.log("Missing end?",D,l);break}for(se(H)&&!q(H)?G=L[1]:U(H)?G=L[0]:N(H)?G=L[3]:q(H)&&(G=L[2]),Y=0;Y<l.edgepaths.length;Y++){var K=l.edgepaths[Y][0];Math.abs(H[0]-G[0])<oe?Math.abs(H[0]-K[0])<oe&&(K[1]-H[1])*(G[1]-K[1])>=0&&(G=K,X=Y):Math.abs(H[1]-G[1])<re?Math.abs(H[1]-K[1])<re&&(K[0]-H[0])*(G[0]-K[0])>=0&&(G=K,X=Y):e.log("endpt to newendpt is not vert. or horz.",H,G,K)}if(X>=0)break;R+=$(H,G),H=G}if(X===l.edgepaths.length){e.log("unclosed perimeter path");break}D=X,F=B.indexOf(D)===-1,F&&(D=B[0],R+=$(H,G)+"Z",H=null)}for(D=0;D<l.paths.length;D++)R+=M.smoothclosed(l.paths[D].map(T),l.smoothing);return R}},{"../../components/drawing":389,"../../lib":515,"../carpet/axis_aligned_line":701,"../carpet/lookup_carpetid":717,"../carpet/makepath":718,"../carpet/map_1d_array":719,"../contour/close_boundaries":746,"../contour/constants":748,"../contour/convert_to_constraints":752,"../contour/empty_pathinfo":754,"../contour/find_all_paths":756,"../contour/make_crossings":761,"../contour/plot":762,"@plotly/d3":58}],771:[function(d,ee,te){var w=d("../../components/colorscale/attributes"),v=d("../../plots/template_attributes").hovertemplateAttrs,S=d("../../plots/attributes"),M=d("../scattermapbox/attributes"),e=d("../../lib/extend").extendFlat;ee.exports=e({lon:M.lon,lat:M.lat,z:{valType:"data_array",editType:"calc"},radius:{valType:"number",editType:"plot",arrayOk:!0,min:1,dflt:30},below:{valType:"string",editType:"plot"},text:M.text,hovertext:M.hovertext,hoverinfo:e({},S.hoverinfo,{flags:["lon","lat","z","text","name"]}),hovertemplate:v(),showlegend:e({},S.showlegend,{dflt:!1})},w("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/template_attributes":642,"../scattermapbox/attributes":1002}],772:[function(d,ee,te){var w=d("fast-isnumeric"),v=d("../../lib").isArrayOrTypedArray,S=d("../../constants/numerical").BADNUM,M=d("../../components/colorscale/calc"),e=d("../../lib")._;ee.exports=function(n,r){for(var t=r._length,c=new Array(t),o=r.z,i=v(o)&&o.length,y=0;y<t;y++){var p=c[y]={},g=r.lon[y],h=r.lat[y];if(p.lonlat=w(g)&&w(h)?[+g,+h]:[S,S],i){var m=o[y];p.z=w(m)?m:S}}return M(n,r,{vals:i?o:[0,1],containerStr:"",cLetter:"z"}),t&&(c[0].t={labels:{lat:e(n,"lat:")+" ",lon:e(n,"lon:")+" "}}),c}},{"../../components/colorscale/calc":375,"../../constants/numerical":491,"../../lib":515,"fast-isnumeric":190}],773:[function(d,ee,te){var w=d("fast-isnumeric"),v=d("../../lib"),S=d("../../components/color"),M=d("../../components/colorscale"),e=d("../../constants/numerical").BADNUM,a=d("../../lib/geojson_utils").makeBlank;ee.exports=function(r){var t=r[0].trace,c=t.visible===!0&&t._length!==0,o={layout:{visibility:"none"},paint:{}},i=t._opts={heatmap:o,geojson:a()};if(!c)return i;var y=[],p,g=t.z,h=t.radius,m=v.isArrayOrTypedArray(g)&&g.length,u=v.isArrayOrTypedArray(h);for(p=0;p<r.length;p++){var _=r[p],s=_.lonlat;if(s[0]!==e){var A={};if(m){var b=_.z;A.z=b!==e?b:0}u&&(A.r=w(h[p])&&h[p]>0?+h[p]:0),y.push({type:"Feature",geometry:{type:"Point",coordinates:s},properties:A})}}var f=M.extractOpts(t),x=f.reversescale?M.flipScale(f.colorscale):f.colorscale,l=x[0][1],L=S.opacity(l)<1?l:S.addOpacity(l,0),T=["interpolate",["linear"],["heatmap-density"],0,L];for(p=1;p<x.length;p++)T.push(x[p][0],x[p][1]);var k=["interpolate",["linear"],["get","z"],f.min,0,f.max,1];return v.extendFlat(i.heatmap.paint,{"heatmap-weight":m?k:1/(f.max-f.min),"heatmap-color":T,"heatmap-radius":u?{type:"identity",property:"r"}:t.radius,"heatmap-opacity":t.opacity}),i.geojson={type:"FeatureCollection",features:y},i.heatmap.layout.visibility="visible",i}},{"../../components/color":367,"../../components/colorscale":379,"../../constants/numerical":491,"../../lib":515,"../../lib/geojson_utils":509,"fast-isnumeric":190}],774:[function(d,ee,te){var w=d("../../lib"),v=d("../../components/colorscale/defaults"),S=d("./attributes");ee.exports=function(e,a,n,r){function t(y,p){return w.coerce(e,a,S,y,p)}var c=t("lon")||[],o=t("lat")||[],i=Math.min(c.length,o.length);if(!i){a.visible=!1;return}a._length=i,t("z"),t("radius"),t("below"),t("text"),t("hovertext"),t("hovertemplate"),v(e,a,r,t,{prefix:"",cLetter:"z"})}},{"../../components/colorscale/defaults":377,"../../lib":515,"./attributes":771}],775:[function(d,ee,te){ee.exports=function(v,S){return v.lon=S.lon,v.lat=S.lat,v.z=S.z,v}},{}],776:[function(d,ee,te){var w=d("../../plots/cartesian/axes"),v=d("../scattermapbox/hover").hoverPoints,S=d("../scattermapbox/hover").getExtraText;ee.exports=function(e,a,n){var r=v(e,a,n);if(!!r){var t=r[0],c=t.cd,o=c[0].trace,i=c[t.index];if(delete t.color,"z"in i){var y=t.subplot.mockAxis;t.z=i.z,t.zLabel=w.tickText(y,y.c2l(i.z),"hover").text}return t.extraText=S(o,i,c[0].t.labels),[t]}}},{"../../plots/cartesian/axes":566,"../scattermapbox/hover":1007}],777:[function(d,ee,te){ee.exports={attributes:d("./attributes"),supplyDefaults:d("./defaults"),colorbar:d("../heatmap/colorbar"),formatLabels:d("../scattermapbox/format_labels"),calc:d("./calc"),plot:d("./plot"),hoverPoints:d("./hover"),eventData:d("./event_data"),getBelow:function(w,v){for(var S=v.getMapLayers(),M=0;M<S.length;M++){var e=S[M],a=e.id;if(e.type==="symbol"&&typeof a=="string"&&a.indexOf("plotly-")===-1)return a}},moduleType:"trace",name:"densitymapbox",basePlotModule:d("../../plots/mapbox"),categories:["mapbox","gl","showLegend"],meta:{hr_name:"density_mapbox"}}},{"../../plots/mapbox":622,"../heatmap/colorbar":804,"../scattermapbox/format_labels":1006,"./attributes":771,"./calc":772,"./defaults":774,"./event_data":775,"./hover":776,"./plot":778}],778:[function(d,ee,te){var w=d("./convert"),v=d("../../plots/mapbox/constants").traceLayerPrefix;function S(e,a){this.type="densitymapbox",this.subplot=e,this.uid=a,this.sourceId="source-"+a,this.layerList=[["heatmap",v+a+"-heatmap"]],this.below=null}var M=S.prototype;M.update=function(e){var a=this.subplot,n=this.layerList,r=w(e),t=a.belowLookup["trace-"+this.uid];a.map.getSource(this.sourceId).setData(r.geojson),t!==this.below&&(this._removeLayers(),this._addLayers(r,t),this.below=t);for(var c=0;c<n.length;c++){var o=n[c],i=o[0],y=o[1],p=r[i];a.setOptions(y,"setLayoutProperty",p.layout),p.layout.visibility==="visible"&&a.setOptions(y,"setPaintProperty",p.paint)}},M._addLayers=function(e,a){for(var n=this.subplot,r=this.layerList,t=this.sourceId,c=0;c<r.length;c++){var o=r[c],i=o[0],y=e[i];n.addLayer({type:i,id:o[1],source:t,layout:y.layout,paint:y.paint},a)}},M._removeLayers=function(){for(var e=this.subplot.map,a=this.layerList,n=a.length-1;n>=0;n--)e.removeLayer(a[n][1])},M.dispose=function(){var e=this.subplot.map;this._removeLayers(),e.removeSource(this.sourceId)},ee.exports=function(a,n){var r=n[0].trace,t=new S(a,r.uid),c=t.sourceId,o=w(n),i=t.below=a.belowLookup["trace-"+r.uid];return a.map.addSource(c,{type:"geojson",data:o.geojson}),t._addLayers(o,i),t}},{"../../plots/mapbox/constants":620,"./convert":773}],779:[function(d,ee,te){var w=d("../../lib");ee.exports=function(S,M){for(var e=0;e<S.length;e++)S[e].i=e;w.mergeArray(M.text,S,"tx"),w.mergeArray(M.hovertext,S,"htx");var a=M.marker;if(a){w.mergeArray(a.opacity,S,"mo"),w.mergeArray(a.color,S,"mc");var n=a.line;n&&(w.mergeArray(n.color,S,"mlc"),w.mergeArrayCastPositive(n.width,S,"mlw"))}}},{"../../lib":515}],780:[function(d,ee,te){var w=d("../bar/attributes"),v=d("../scatter/attributes").line,S=d("../../plots/attributes"),M=d("../../plots/cartesian/axis_format_attributes").axisHoverFormat,e=d("../../plots/template_attributes").hovertemplateAttrs,a=d("../../plots/template_attributes").texttemplateAttrs,n=d("./constants"),r=d("../../lib/extend").extendFlat,t=d("../../components/color");ee.exports={x:w.x,x0:w.x0,dx:w.dx,y:w.y,y0:w.y0,dy:w.dy,xperiod:w.xperiod,yperiod:w.yperiod,xperiod0:w.xperiod0,yperiod0:w.yperiod0,xperiodalignment:w.xperiodalignment,yperiodalignment:w.yperiodalignment,xhoverformat:M("x"),yhoverformat:M("y"),hovertext:w.hovertext,hovertemplate:e({},{keys:n.eventDataKeys}),hoverinfo:r({},S.hoverinfo,{flags:["name","x","y","text","percent initial","percent previous","percent total"]}),textinfo:{valType:"flaglist",flags:["label","text","percent initial","percent previous","percent total","value"],extras:["none"],editType:"plot",arrayOk:!1},texttemplate:a({editType:"plot"},{keys:n.eventDataKeys.concat(["label","value"])}),text:w.text,textposition:w.textposition,insidetextanchor:r({},w.insidetextanchor,{dflt:"middle"}),textangle:r({},w.textangle,{dflt:0}),textfont:w.textfont,insidetextfont:w.insidetextfont,outsidetextfont:w.outsidetextfont,constraintext:w.constraintext,cliponaxis:w.cliponaxis,orientation:r({},w.orientation,{}),offset:r({},w.offset,{arrayOk:!1}),width:r({},w.width,{arrayOk:!1}),marker:c(),connector:{fillcolor:{valType:"color",editType:"style"},line:{color:r({},v.color,{dflt:t.defaultLine}),width:r({},v.width,{dflt:0,editType:"plot"}),dash:v.dash,editType:"style"},visible:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},offsetgroup:w.offsetgroup,alignmentgroup:w.alignmentgroup};function c(){var o=r({},w.marker);return delete o.pattern,o}},{"../../components/color":367,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../bar/attributes":657,"../scatter/attributes":936,"./constants":782}],781:[function(d,ee,te){var w=d("../../plots/cartesian/axes"),v=d("../../plots/cartesian/align_period"),S=d("./arrays_to_calcdata"),M=d("../scatter/calc_selection"),e=d("../../constants/numerical").BADNUM;ee.exports=function(r,t){var c=w.getFromId(r,t.xaxis||"x"),o=w.getFromId(r,t.yaxis||"y"),i,y,p,g,h,m,u,_;t.orientation==="h"?(i=c.makeCalcdata(t,"x"),p=o.makeCalcdata(t,"y"),g=v(t,o,"y",p),h=!!t.yperiodalignment,m="y"):(i=o.makeCalcdata(t,"y"),p=c.makeCalcdata(t,"x"),g=v(t,c,"x",p),h=!!t.xperiodalignment,m="x"),y=g.vals;var s=Math.min(y.length,i.length),A=new Array(s);for(t._base=[],u=0;u<s;u++){i[u]<0&&(i[u]=e);var b=!1;i[u]!==e&&u+1<s&&i[u+1]!==e&&(b=!0),_=A[u]={p:y[u],s:i[u],cNext:b},t._base[u]=-.5*_.s,h&&(A[u].orig_p=p[u],A[u][m+"End"]=g.ends[u],A[u][m+"Start"]=g.starts[u]),t.ids&&(_.id=String(t.ids[u])),u===0&&(A[0].vTotal=0),A[0].vTotal+=a(_.s),_.begR=a(_.s)/a(A[0].s)}var f;for(u=0;u<s;u++)_=A[u],_.s!==e&&(_.sumR=_.s/A[0].vTotal,_.difR=f!==void 0?_.s/f:1,f=_.s);return S(A,t),M(A,t),A};function a(n){return n===e?0:n}},{"../../constants/numerical":491,"../../plots/cartesian/align_period":563,"../../plots/cartesian/axes":566,"../scatter/calc_selection":938,"./arrays_to_calcdata":779}],782:[function(d,ee,te){ee.exports={eventDataKeys:["percentInitial","percentPrevious","percentTotal"]}},{}],783:[function(d,ee,te){var w=d("../bar/cross_trace_calc").setGroupPositions;ee.exports=function(S,M){var e=S._fullLayout,a=S._fullData,n=S.calcdata,r=M.xaxis,t=M.yaxis,c=[],o=[],i=[],y,p;for(p=0;p<a.length;p++){var g=a[p],h=g.orientation==="h";g.visible===!0&&g.xaxis===r._id&&g.yaxis===t._id&&g.type==="funnel"&&(y=n[p],h?i.push(y):o.push(y),c.push(y))}var m={mode:e.funnelmode,norm:e.funnelnorm,gap:e.funnelgap,groupgap:e.funnelgroupgap};for(w(S,r,t,o,m),w(S,t,r,i,m),p=0;p<c.length;p++){y=c[p];for(var u=0;u<y.length;u++)u+1<y.length&&(y[u].nextP0=y[u+1].p0,y[u].nextS0=y[u+1].s0,y[u].nextP1=y[u+1].p1,y[u].nextS1=y[u+1].s1)}}},{"../bar/cross_trace_calc":660}],784:[function(d,ee,te){var w=d("../../lib"),v=d("../bar/defaults").handleGroupingDefaults,S=d("../bar/defaults").handleText,M=d("../scatter/xy_defaults"),e=d("../scatter/period_defaults"),a=d("./attributes"),n=d("../../components/color");function r(o,i,y,p){function g(b,f){return w.coerce(o,i,a,b,f)}var h=M(o,i,p,g);if(!h){i.visible=!1;return}e(o,i,p,g),g("xhoverformat"),g("yhoverformat"),g("orientation",i.y&&!i.x?"v":"h"),g("offset"),g("width");var m=g("text");g("hovertext"),g("hovertemplate");var u=g("textposition");S(o,i,p,g,u,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!0,moduleHasCliponaxis:!0,moduleHasTextangle:!0,moduleHasInsideanchor:!0}),i.textposition!=="none"&&!i.texttemplate&&g("textinfo",Array.isArray(m)?"text+value":"value");var _=g("marker.color",y);g("marker.line.color",n.defaultLine),g("marker.line.width");var s=g("connector.visible");if(s){g("connector.fillcolor",t(_));var A=g("connector.line.width");A&&(g("connector.line.color"),g("connector.line.dash"))}}function t(o){var i=w.isArrayOrTypedArray(o)?"#000":o;return n.addOpacity(i,.5*n.opacity(i))}function c(o,i){var y,p;function g(m){return w.coerce(p._input,p,a,m)}if(i.funnelmode==="group")for(var h=0;h<o.length;h++)p=o[h],y=p._input,v(y,p,i,g)}ee.exports={supplyDefaults:r,crossTraceDefaults:c}},{"../../components/color":367,"../../lib":515,"../bar/defaults":661,"../scatter/period_defaults":956,"../scatter/xy_defaults":963,"./attributes":780}],785:[function(d,ee,te){ee.exports=function(v,S){return v.x="xVal"in S?S.xVal:S.x,v.y="yVal"in S?S.yVal:S.y,"percentInitial"in S&&(v.percentInitial=S.percentInitial),"percentPrevious"in S&&(v.percentPrevious=S.percentPrevious),"percentTotal"in S&&(v.percentTotal=S.percentTotal),S.xa&&(v.xaxis=S.xa),S.ya&&(v.yaxis=S.ya),v}},{}],786:[function(d,ee,te){var w=d("../../components/color").opacity,v=d("../bar/hover").hoverOnBars,S=d("../../lib").formatPercent;ee.exports=function(a,n,r,t,c){var o=v(a,n,r,t,c);if(!!o){var i=o.cd,y=i[0].trace,p=y.orientation==="h",g=o.index,h=i[g],m=p?"x":"y";o[m+"LabelVal"]=h.s,o.percentInitial=h.begR,o.percentInitialLabel=S(h.begR,1),o.percentPrevious=h.difR,o.percentPreviousLabel=S(h.difR,1),o.percentTotal=h.sumR,o.percentTotalLabel=S(h.sumR,1);var u=h.hi||y.hoverinfo,_=[];if(u&&u!=="none"&&u!=="skip"){var s=u==="all",A=u.split("+"),b=function(f){return s||A.indexOf(f)!==-1};b("percent initial")&&_.push(o.percentInitialLabel+" of initial"),b("percent previous")&&_.push(o.percentPreviousLabel+" of previous"),b("percent total")&&_.push(o.percentTotalLabel+" of total")}return o.extraText=_.join("<br>"),o.color=M(y,h),[o]}};function M(e,a){var n=e.marker,r=a.mc||n.color,t=a.mlc||n.line.color,c=a.mlw||n.line.width;if(w(r))return r;if(w(t)&&c)return t}},{"../../components/color":367,"../../lib":515,"../bar/hover":664}],787:[function(d,ee,te){ee.exports={attributes:d("./attributes"),layoutAttributes:d("./layout_attributes"),supplyDefaults:d("./defaults").supplyDefaults,crossTraceDefaults:d("./defaults").crossTraceDefaults,supplyLayoutDefaults:d("./layout_defaults"),calc:d("./calc"),crossTraceCalc:d("./cross_trace_calc"),plot:d("./plot"),style:d("./style").style,hoverPoints:d("./hover"),eventData:d("./event_data"),selectPoints:d("../bar/select"),moduleType:"trace",name:"funnel",basePlotModule:d("../../plots/cartesian"),categories:["bar-like","cartesian","svg","oriented","showLegend","zoomScale"],meta:{}}},{"../../plots/cartesian":578,"../bar/select":669,"./attributes":780,"./calc":781,"./cross_trace_calc":783,"./defaults":784,"./event_data":785,"./hover":786,"./layout_attributes":788,"./layout_defaults":789,"./plot":790,"./style":791}],788:[function(d,ee,te){ee.exports={funnelmode:{valType:"enumerated",values:["stack","group","overlay"],dflt:"stack",editType:"calc"},funnelgap:{valType:"number",min:0,max:1,editType:"calc"},funnelgroupgap:{valType:"number",min:0,max:1,dflt:0,editType:"calc"}}},{}],789:[function(d,ee,te){var w=d("../../lib"),v=d("./layout_attributes");ee.exports=function(S,M,e){var a=!1;function n(c,o){return w.coerce(S,M,v,c,o)}for(var r=0;r<e.length;r++){var t=e[r];if(t.visible&&t.type==="funnel"){a=!0;break}}a&&(n("funnelmode"),n("funnelgap",.2),n("funnelgroupgap"))}},{"../../lib":515,"./layout_attributes":788}],790:[function(d,ee,te){var w=d("@plotly/d3"),v=d("../../lib"),S=d("../../components/drawing"),M=d("../../constants/numerical").BADNUM,e=d("../bar/plot"),a=d("../bar/uniform_text").clearMinTextSize;ee.exports=function(o,i,y,p){var g=o._fullLayout;a("funnel",g),n(o,i,y,p),r(o,i,y,p),e.plot(o,i,y,p,{mode:g.funnelmode,norm:g.funnelmode,gap:g.funnelgap,groupgap:g.funnelgroupgap})};function n(c,o,i,y){var p=o.xaxis,g=o.yaxis;v.makeTraceGroups(y,i,"trace bars").each(function(h){var m=w.select(this),u=h[0].trace,_=v.ensureSingle(m,"g","regions");if(!u.connector||!u.connector.visible){_.remove();return}var s=u.orientation==="h",A=_.selectAll("g.region").data(v.identity);A.enter().append("g").classed("region",!0),A.exit().remove();var b=A.size();A.each(function(f,x){if(!(x!==b-1&&!f.cNext)){var l=t(f,p,g,s),L=l[0],T=l[1],k="";L[0]!==M&&T[0]!==M&&L[1]!==M&&T[1]!==M&&L[2]!==M&&T[2]!==M&&L[3]!==M&&T[3]!==M&&(s?k+="M"+L[0]+","+T[1]+"L"+L[2]+","+T[2]+"H"+L[3]+"L"+L[1]+","+T[1]+"Z":k+="M"+L[1]+","+T[1]+"L"+L[2]+","+T[3]+"V"+T[2]+"L"+L[1]+","+T[0]+"Z"),k===""&&(k="M0,0Z"),v.ensureSingle(w.select(this),"path").attr("d",k).call(S.setClipUrl,o.layerClipId,c)}})})}function r(c,o,i,y){var p=o.xaxis,g=o.yaxis;v.makeTraceGroups(y,i,"trace bars").each(function(h){var m=w.select(this),u=h[0].trace,_=v.ensureSingle(m,"g","lines");if(!u.connector||!u.connector.visible||!u.connector.line.width){_.remove();return}var s=u.orientation==="h",A=_.selectAll("g.line").data(v.identity);A.enter().append("g").classed("line",!0),A.exit().remove();var b=A.size();A.each(function(f,x){if(!(x!==b-1&&!f.cNext)){var l=t(f,p,g,s),L=l[0],T=l[1],k="";L[3]!==void 0&&T[3]!==void 0&&(s?(k+="M"+L[0]+","+T[1]+"L"+L[2]+","+T[2],k+="M"+L[1]+","+T[1]+"L"+L[3]+","+T[2]):(k+="M"+L[1]+","+T[1]+"L"+L[2]+","+T[3],k+="M"+L[1]+","+T[0]+"L"+L[2]+","+T[2])),k===""&&(k="M0,0Z"),v.ensureSingle(w.select(this),"path").attr("d",k).call(S.setClipUrl,o.layerClipId,c)}})})}function t(c,o,i,y){var p=[],g=[],h=y?o:i,m=y?i:o;return p[0]=h.c2p(c.s0,!0),g[0]=m.c2p(c.p0,!0),p[1]=h.c2p(c.s1,!0),g[1]=m.c2p(c.p1,!0),p[2]=h.c2p(c.nextS0,!0),g[2]=m.c2p(c.nextP0,!0),p[3]=h.c2p(c.nextS1,!0),g[3]=m.c2p(c.nextP1,!0),y?[p,g]:[g,p]}},{"../../components/drawing":389,"../../constants/numerical":491,"../../lib":515,"../bar/plot":668,"../bar/uniform_text":673,"@plotly/d3":58}],791:[function(d,ee,te){var w=d("@plotly/d3"),v=d("../../components/drawing"),S=d("../../components/color"),M=d("../../constants/interactions").DESELECTDIM,e=d("../bar/style"),a=d("../bar/uniform_text").resizeText,n=e.styleTextPoints;function r(t,c,o){var i=o||w.select(t).selectAll("g.funnellayer").selectAll("g.trace");a(t,i,"funnel"),i.style("opacity",function(y){return y[0].trace.opacity}),i.each(function(y){var p=w.select(this),g=y[0].trace;p.selectAll(".point > path").each(function(h){if(!h.isBlank){var m=g.marker;w.select(this).call(S.fill,h.mc||m.color).call(S.stroke,h.mlc||m.line.color).call(v.dashLine,m.line.dash,h.mlw||m.line.width).style("opacity",g.selectedpoints&&!h.selected?M:1)}}),n(p,g,t),p.selectAll(".regions").each(function(){w.select(this).selectAll("path").style("stroke-width",0).call(S.fill,g.connector.fillcolor)}),p.selectAll(".lines").each(function(){var h=g.connector.line;v.lineGroupStyle(w.select(this).selectAll("path"),h.width,h.color,h.dash)})})}ee.exports={style:r}},{"../../components/color":367,"../../components/drawing":389,"../../constants/interactions":490,"../bar/style":671,"../bar/uniform_text":673,"@plotly/d3":58}],792:[function(d,ee,te){var w=d("../pie/attributes"),v=d("../../plots/attributes"),S=d("../../plots/domain").attributes,M=d("../../plots/template_attributes").hovertemplateAttrs,e=d("../../plots/template_attributes").texttemplateAttrs,a=d("../../lib/extend").extendFlat;ee.exports={labels:w.labels,label0:w.label0,dlabel:w.dlabel,values:w.values,marker:{colors:w.marker.colors,line:{color:a({},w.marker.line.color,{dflt:null}),width:a({},w.marker.line.width,{dflt:1}),editType:"calc"},editType:"calc"},text:w.text,hovertext:w.hovertext,scalegroup:a({},w.scalegroup,{}),textinfo:a({},w.textinfo,{flags:["label","text","value","percent"]}),texttemplate:e({editType:"plot"},{keys:["label","color","value","text","percent"]}),hoverinfo:a({},v.hoverinfo,{flags:["label","text","value","percent","name"]}),hovertemplate:M({},{keys:["label","color","value","text","percent"]}),textposition:a({},w.textposition,{values:["inside","none"],dflt:"inside"}),textfont:w.textfont,insidetextfont:w.insidetextfont,title:{text:w.title.text,font:w.title.font,position:a({},w.title.position,{values:["top left","top center","top right"],dflt:"top center"}),editType:"plot"},domain:S({name:"funnelarea",trace:!0,editType:"calc"}),aspectratio:{valType:"number",min:0,dflt:1,editType:"plot"},baseratio:{valType:"number",min:0,max:1,dflt:.333,editType:"plot"}}},{"../../lib/extend":505,"../../plots/attributes":562,"../../plots/domain":593,"../../plots/template_attributes":642,"../pie/attributes":910}],793:[function(d,ee,te){var w=d("../../plots/plots");te.name="funnelarea",te.plot=function(v,S,M,e){w.plotBasePlot(te.name,v,S,M,e)},te.clean=function(v,S,M,e){w.cleanBasePlot(te.name,v,S,M,e)}},{"../../plots/plots":628}],794:[function(d,ee,te){var w=d("../pie/calc");function v(M,e){return w.calc(M,e)}function S(M){w.crossTraceCalc(M,{type:"funnelarea"})}ee.exports={calc:v,crossTraceCalc:S}},{"../pie/calc":912}],795:[function(d,ee,te){var w=d("../../lib"),v=d("./attributes"),S=d("../../plots/domain").defaults,M=d("../bar/defaults").handleText,e=d("../pie/defaults").handleLabelsAndValues;ee.exports=function(n,r,t,c){function o(b,f){return w.coerce(n,r,v,b,f)}var i=o("labels"),y=o("values"),p=e(i,y),g=p.len;if(r._hasLabels=p.hasLabels,r._hasValues=p.hasValues,!r._hasLabels&&r._hasValues&&(o("label0"),o("dlabel")),!g){r.visible=!1;return}r._length=g;var h=o("marker.line.width");h&&o("marker.line.color",c.paper_bgcolor),o("marker.colors"),o("scalegroup");var m=o("text"),u=o("texttemplate"),_;if(u||(_=o("textinfo",Array.isArray(m)?"text+percent":"percent")),o("hovertext"),o("hovertemplate"),u||_&&_!=="none"){var s=o("textposition");M(n,r,c,o,s,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1})}S(r,c,o);var A=o("title.text");A&&(o("title.position"),w.coerceFont(o,"title.font",c.font)),o("aspectratio"),o("baseratio")}},{"../../lib":515,"../../plots/domain":593,"../bar/defaults":661,"../pie/defaults":913,"./attributes":792}],796:[function(d,ee,te){ee.exports={moduleType:"trace",name:"funnelarea",basePlotModule:d("./base_plot"),categories:["pie-like","funnelarea","showLegend"],attributes:d("./attributes"),layoutAttributes:d("./layout_attributes"),supplyDefaults:d("./defaults"),supplyLayoutDefaults:d("./layout_defaults"),calc:d("./calc").calc,crossTraceCalc:d("./calc").crossTraceCalc,plot:d("./plot"),style:d("./style"),styleOne:d("../pie/style_one"),meta:{}}},{"../pie/style_one":921,"./attributes":792,"./base_plot":793,"./calc":794,"./defaults":795,"./layout_attributes":797,"./layout_defaults":798,"./plot":799,"./style":800}],797:[function(d,ee,te){var w=d("../pie/layout_attributes").hiddenlabels;ee.exports={hiddenlabels:w,funnelareacolorway:{valType:"colorlist",editType:"calc"},extendfunnelareacolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{"../pie/layout_attributes":917}],798:[function(d,ee,te){var w=d("../../lib"),v=d("./layout_attributes");ee.exports=function(M,e){function a(n,r){return w.coerce(M,e,v,n,r)}a("hiddenlabels"),a("funnelareacolorway",e.colorway),a("extendfunnelareacolors")}},{"../../lib":515,"./layout_attributes":797}],799:[function(d,ee,te){var w=d("@plotly/d3"),v=d("../../components/drawing"),S=d("../../lib"),M=S.strScale,e=S.strTranslate,a=d("../../lib/svg_text_utils"),n=d("../bar/plot"),r=n.toMoveInsideBar,t=d("../bar/uniform_text"),c=t.recordMinTextSize,o=t.clearMinTextSize,i=d("../pie/helpers"),y=d("../pie/plot"),p=y.attachFxHandlers,g=y.determineInsideTextFont,h=y.layoutAreas,m=y.prerenderTitles,u=y.positionTitleOutside,_=y.formatSliceLabel;ee.exports=function(x,l){var L=x._fullLayout;o("funnelarea",L),m(l,x),h(l,L._size),S.makeTraceGroups(L._funnelarealayer,l,"trace").each(function(T){var k=w.select(this),P=T[0],z=P.trace;b(T),k.each(function(){var I=w.select(this).selectAll("g.slice").data(T);I.enter().append("g").classed("slice",!0),I.exit().remove(),I.each(function(R,B){if(R.hidden){w.select(this).selectAll("path,g").remove();return}R.pointNumber=R.i,R.curveNumber=z.index;var F=P.cx,H=P.cy,G=w.select(this),J=G.selectAll("path.surface").data([R]);J.enter().append("path").classed("surface",!0).style({"pointer-events":"all"}),G.call(p,x,T);var X="M"+(F+R.TR[0])+","+(H+R.TR[1])+s(R.TR,R.BR)+s(R.BR,R.BL)+s(R.BL,R.TL)+"Z";J.attr("d",X),_(x,R,P);var Y=i.castOption(z.textposition,R.pts),Z=G.selectAll("g.slicetext").data(R.text&&Y!=="none"?[0]:[]);Z.enter().append("g").classed("slicetext",!0),Z.exit().remove(),Z.each(function(){var oe=S.ensureSingle(w.select(this),"text","",function(K){K.attr("data-notex",1)}),re=S.ensureUniformFontSize(x,g(z,R,L.font));oe.text(R.text).attr({class:"slicetext",transform:"","text-anchor":"middle"}).call(v.font,re).call(a.convertToTspans,x);var se=v.bBox(oe.node()),N,U,q,$=Math.min(R.BL[1],R.BR[1])+H,W=Math.max(R.TL[1],R.TR[1])+H;U=Math.max(R.TL[0],R.BL[0])+F,q=Math.min(R.TR[0],R.BR[0])+F,N=r(U,q,$,W,se,{isHorizontal:!0,constrained:!0,angle:0,anchor:"middle"}),N.fontSize=re.size,c(z.type,N,L),T[B].transform=N,oe.attr("transform",S.getTextTransform(N))})});var D=w.select(this).selectAll("g.titletext").data(z.title.text?[0]:[]);D.enter().append("g").classed("titletext",!0),D.exit().remove(),D.each(function(){var R=S.ensureSingle(w.select(this),"text","",function(H){H.attr("data-notex",1)}),B=z.title.text;z._meta&&(B=S.templateString(B,z._meta)),R.text(B).attr({class:"titletext",transform:"","text-anchor":"middle"}).call(v.font,z.title.font).call(a.convertToTspans,x);var F=u(P,L._size);R.attr("transform",e(F.x,F.y)+M(Math.min(1,F.scale))+e(F.tx,F.ty))})})})};function s(f,x){var l=x[0]-f[0],L=x[1]-f[1];return"l"+l+","+L}function A(f,x){return[.5*(f[0]+x[0]),.5*(f[1]+x[1])]}function b(f){if(!f.length)return;var x=f[0],l=x.trace,L=l.aspectratio,T=l.baseratio;T>.999&&(T=.999);var k=Math.pow(T,2),P=x.vTotal,z=P*k/(1-k),I=P,D=z/P;function R(){var ae=Math.sqrt(D);return{x:ae,y:-ae}}function B(){var ae=R();return[ae.x,ae.y]}var F,H=[];H.push(B());var G,J;for(G=f.length-1;G>-1;G--)if(J=f[G],!J.hidden){var X=J.v/I;D+=X,H.push(B())}var Y=1/0,Z=-1/0;for(G=0;G<H.length;G++)F=H[G],Y=Math.min(Y,F[1]),Z=Math.max(Z,F[1]);for(G=0;G<H.length;G++)H[G][1]-=(Z+Y)/2;var oe=H[H.length-1][0],re=x.r,se=(Z-Y)/2,N=re/oe,U=re/se*L;for(x.r=U*se,G=0;G<H.length;G++)H[G][0]*=N,H[G][1]*=U;F=H[0];var q=[-F[0],F[1]],$=[F[0],F[1]],W=0;for(G=f.length-1;G>-1;G--)if(J=f[G],!J.hidden){W+=1;var K=H[W][0],ne=H[W][1];J.TL=[-K,ne],J.TR=[K,ne],J.BL=q,J.BR=$,J.pxmid=A(J.TR,J.BR),q=J.TL,$=J.TR}}},{"../../components/drawing":389,"../../lib":515,"../../lib/svg_text_utils":541,"../bar/plot":668,"../bar/uniform_text":673,"../pie/helpers":915,"../pie/plot":919,"@plotly/d3":58}],800:[function(d,ee,te){var w=d("@plotly/d3"),v=d("../pie/style_one"),S=d("../bar/uniform_text").resizeText;ee.exports=function(e){var a=e._fullLayout._funnelarealayer.selectAll(".trace");S(e,a,"funnelarea"),a.each(function(n){var r=n[0],t=r.trace,c=w.select(this);c.style({opacity:t.opacity}),c.selectAll("path.surface").each(function(o){w.select(this).call(v,o,t)})})}},{"../bar/uniform_text":673,"../pie/style_one":921,"@plotly/d3":58}],801:[function(d,ee,te){var w=d("../scatter/attributes"),v=d("../../plots/attributes"),S=d("../../plots/font_attributes"),M=d("../../plots/cartesian/axis_format_attributes").axisHoverFormat,e=d("../../plots/template_attributes").hovertemplateAttrs,a=d("../../plots/template_attributes").texttemplateAttrs,n=d("../../components/colorscale/attributes"),r=d("../../lib/extend").extendFlat;ee.exports=r({z:{valType:"data_array",editType:"calc"},x:r({},w.x,{impliedEdits:{xtype:"array"}}),x0:r({},w.x0,{impliedEdits:{xtype:"scaled"}}),dx:r({},w.dx,{impliedEdits:{xtype:"scaled"}}),y:r({},w.y,{impliedEdits:{ytype:"array"}}),y0:r({},w.y0,{impliedEdits:{ytype:"scaled"}}),dy:r({},w.dy,{impliedEdits:{ytype:"scaled"}}),xperiod:r({},w.xperiod,{impliedEdits:{xtype:"scaled"}}),yperiod:r({},w.yperiod,{impliedEdits:{ytype:"scaled"}}),xperiod0:r({},w.xperiod0,{impliedEdits:{xtype:"scaled"}}),yperiod0:r({},w.yperiod0,{impliedEdits:{ytype:"scaled"}}),xperiodalignment:r({},w.xperiodalignment,{impliedEdits:{xtype:"scaled"}}),yperiodalignment:r({},w.yperiodalignment,{impliedEdits:{ytype:"scaled"}}),text:{valType:"data_array",editType:"calc"},hovertext:{valType:"data_array",editType:"calc"},transpose:{valType:"boolean",dflt:!1,editType:"calc"},xtype:{valType:"enumerated",values:["array","scaled"],editType:"calc+clearAxisTypes"},ytype:{valType:"enumerated",values:["array","scaled"],editType:"calc+clearAxisTypes"},zsmooth:{valType:"enumerated",values:["fast","best",!1],dflt:!1,editType:"calc"},hoverongaps:{valType:"boolean",dflt:!0,editType:"none"},connectgaps:{valType:"boolean",editType:"calc"},xgap:{valType:"number",dflt:0,min:0,editType:"plot"},ygap:{valType:"number",dflt:0,min:0,editType:"plot"},xhoverformat:M("x"),yhoverformat:M("y"),zhoverformat:M("z",1),hovertemplate:e(),texttemplate:a({arrayOk:!1,editType:"plot"},{keys:["x","y","z","text"]}),textfont:S({editType:"plot",autoSize:!0,autoColor:!0,colorEditType:"style"}),showlegend:r({},v.showlegend,{dflt:!1})},{transforms:void 0},n("",{cLetter:"z",autoColorDflt:!1}))},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/font_attributes":594,"../../plots/template_attributes":642,"../scatter/attributes":936}],802:[function(d,ee,te){var w=d("../../registry"),v=d("../../lib"),S=d("../../plots/cartesian/axes"),M=d("../../plots/cartesian/align_period"),e=d("../histogram2d/calc"),a=d("../../components/colorscale/calc"),n=d("./convert_column_xyz"),r=d("./clean_2d_array"),t=d("./interp2d"),c=d("./find_empties"),o=d("./make_bound_array"),i=d("../../constants/numerical").BADNUM;ee.exports=function(h,m){var u=S.getFromId(h,m.xaxis||"x"),_=S.getFromId(h,m.yaxis||"y"),s=w.traceIs(m,"contour"),A=w.traceIs(m,"histogram"),b=w.traceIs(m,"gl2d"),f=s?"best":m.zsmooth,x,l,L,T,k,P,z,I,D,R,B;if(u._minDtick=0,_._minDtick=0,A)B=e(h,m),T=B.orig_x,x=B.x,l=B.x0,L=B.dx,I=B.orig_y,k=B.y,P=B.y0,z=B.dy,D=B.z;else{var F=m.z;v.isArray1D(F)?(n(m,u,_,"x","y",["z"]),x=m._x,k=m._y,F=m._z):(T=m.x?u.makeCalcdata(m,"x"):[],I=m.y?_.makeCalcdata(m,"y"):[],x=M(m,u,"x",T).vals,k=M(m,_,"y",I).vals,m._x=x,m._y=k),l=m.x0,L=m.dx,P=m.y0,z=m.dy,D=r(F,m,u,_)}(u.rangebreaks||_.rangebreaks)&&(D=p(x,k,D),A||(x=y(x),k=y(k),m._x=x,m._y=k)),!A&&(s||m.connectgaps)&&(m._emptypoints=c(D),t(D,m._emptypoints));function H($){f=m._input.zsmooth=m.zsmooth=!1,v.warn('cannot use zsmooth: "fast": '+$)}if(f==="fast"){if(u.type==="log"||_.type==="log")H("log axis found");else if(!A){if(x.length){var G=(x[x.length-1]-x[0])/(x.length-1),J=Math.abs(G/100);for(R=0;R<x.length-1;R++)if(Math.abs(x[R+1]-x[R]-G)>J){H("x scale is not linear");break}}if(k.length&&f==="fast"){var X=(k[k.length-1]-k[0])/(k.length-1),Y=Math.abs(X/100);for(R=0;R<k.length-1;R++)if(Math.abs(k[R+1]-k[R]-X)>Y){H("y scale is not linear");break}}}}var Z=v.maxRowLength(D),oe=m.xtype==="scaled"?"":x,re=o(m,oe,l,L,Z,u),se=m.ytype==="scaled"?"":k,N=o(m,se,P,z,D.length,_);b||(m._extremes[u._id]=S.findExtremes(u,re),m._extremes[_._id]=S.findExtremes(_,N));var U={x:re,y:N,z:D,text:m._text||m.text,hovertext:m._hovertext||m.hovertext};if(m.xperiodalignment&&T&&(U.orig_x=T),m.yperiodalignment&&I&&(U.orig_y=I),oe&&oe.length===re.length-1&&(U.xCenter=oe),se&&se.length===N.length-1&&(U.yCenter=se),A&&(U.xRanges=B.xRanges,U.yRanges=B.yRanges,U.pts=B.pts),s||a(h,m,{vals:D,cLetter:"z"}),s&&m.contours&&m.contours.coloring==="heatmap"){var q={type:m.type==="contour"?"heatmap":"histogram2d",xcalendar:m.xcalendar,ycalendar:m.ycalendar};U.xfill=o(q,oe,l,L,Z,u),U.yfill=o(q,se,P,z,D.length,_)}return[U]};function y(g){for(var h=[],m=g.length,u=0;u<m;u++){var _=g[u];_!==i&&h.push(_)}return h}function p(g,h,m){for(var u=[],_=-1,s=0;s<m.length;s++)if(h[s]!==i){_++,u[_]=[];for(var A=0;A<m[s].length;A++)g[A]!==i&&u[_].push(m[s][A])}return u}},{"../../components/colorscale/calc":375,"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/align_period":563,"../../plots/cartesian/axes":566,"../../registry":647,"../histogram2d/calc":835,"./clean_2d_array":803,"./convert_column_xyz":805,"./find_empties":807,"./interp2d":810,"./make_bound_array":812}],803:[function(d,ee,te){var w=d("fast-isnumeric"),v=d("../../lib"),S=d("../../constants/numerical").BADNUM;ee.exports=function(e,a,n,r){var t,c,o,i,y,p;function g(A){if(!!w(A))return+A}if(a&&a.transpose){for(t=0,y=0;y<e.length;y++)t=Math.max(t,e[y].length);if(t===0)return!1;o=function(A){return A.length},i=function(A,b,f){return(A[f]||[])[b]}}else t=e.length,o=function(A,b){return A[b].length},i=function(A,b,f){return(A[b]||[])[f]};var h=function(A,b,f){return b===S||f===S?S:i(A,b,f)};function m(A){if(a&&a.type!=="carpet"&&a.type!=="contourcarpet"&&A&&A.type==="category"&&a["_"+A._id.charAt(0)].length){var b=A._id.charAt(0),f={},x=a["_"+b+"CategoryMap"]||a[b];for(y=0;y<x.length;y++)f[x[y]]=y;return function(l){var L=f[A._categories[l]];return L+1?L:S}}else return v.identity}var u=m(n),_=m(r);r&&r.type==="category"&&(t=r._categories.length);var s=new Array(t);for(y=0;y<t;y++)for(n&&n.type==="category"?c=n._categories.length:c=o(e,y),s[y]=new Array(c),p=0;p<c;p++)s[y][p]=g(h(e,_(y),u(p)));return s}},{"../../constants/numerical":491,"../../lib":515,"fast-isnumeric":190}],804:[function(d,ee,te){ee.exports={min:"zmin",max:"zmax"}},{}],805:[function(d,ee,te){var w=d("../../lib"),v=d("../../constants/numerical").BADNUM,S=d("../../plots/cartesian/align_period");ee.exports=function(e,a,n,r,t,c){var o=e._length,i=a.makeCalcdata(e,r),y=n.makeCalcdata(e,t);i=S(e,a,r,i).vals,y=S(e,n,t,y).vals;var p=e.text,g=p!==void 0&&w.isArray1D(p),h=e.hovertext,m=h!==void 0&&w.isArray1D(h),u,_,s=w.distinctVals(i),A=s.vals,b=w.distinctVals(y),f=b.vals,x=[],l,L,T=f.length,k=A.length;for(u=0;u<c.length;u++)x[u]=w.init2dArray(T,k);g&&(l=w.init2dArray(T,k)),m&&(L=w.init2dArray(T,k));var P=w.init2dArray(T,k);for(u=0;u<o;u++)if(i[u]!==v&&y[u]!==v){var z=w.findBin(i[u]+s.minDiff/2,A),I=w.findBin(y[u]+b.minDiff/2,f);for(_=0;_<c.length;_++){var D=c[_],R=e[D],B=x[_];B[I][z]=R[u],P[I][z]=u}g&&(l[I][z]=p[u]),m&&(L[I][z]=h[u])}for(e["_"+r]=A,e["_"+t]=f,_=0;_<c.length;_++)e["_"+c[_]]=x[_];g&&(e._text=l),m&&(e._hovertext=L),a&&a.type==="category"&&(e["_"+r+"CategoryMap"]=A.map(function(F){return a._categories[F]})),n&&n.type==="category"&&(e["_"+t+"CategoryMap"]=f.map(function(F){return n._categories[F]})),e._after2before=P}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/align_period":563}],806:[function(d,ee,te){var w=d("../../lib"),v=d("./xyz_defaults"),S=d("./label_defaults"),M=d("../scatter/period_defaults"),e=d("./style_defaults"),a=d("../../components/colorscale/defaults"),n=d("./attributes");ee.exports=function(t,c,o,i){function y(g,h){return w.coerce(t,c,n,g,h)}var p=v(t,c,y,i);if(!p){c.visible=!1;return}M(t,c,i,y),y("xhoverformat"),y("yhoverformat"),y("text"),y("hovertext"),y("hovertemplate"),S(y,i),e(t,c,y,i),y("hoverongaps"),y("connectgaps",w.isArray1D(c.z)&&c.zsmooth!==!1),a(t,c,i,y,{prefix:"",cLetter:"z"})}},{"../../components/colorscale/defaults":377,"../../lib":515,"../scatter/period_defaults":956,"./attributes":801,"./label_defaults":811,"./style_defaults":815,"./xyz_defaults":816}],807:[function(d,ee,te){var w=d("../../lib").maxRowLength;ee.exports=function(S){var M=[],e={},a=[],n=S[0],r=[],t=[0,0,0],c=w(S),o,i,y,p,g,h,m,u;for(i=0;i<S.length;i++)for(o=r,r=n,n=S[i+1]||[],y=0;y<c;y++)r[y]===void 0&&(h=(r[y-1]!==void 0?1:0)+(r[y+1]!==void 0?1:0)+(o[y]!==void 0?1:0)+(n[y]!==void 0?1:0),h?(i===0&&h++,y===0&&h++,i===S.length-1&&h++,y===r.length-1&&h++,h<4&&(e[[i,y]]=[i,y,h]),M.push([i,y,h])):a.push([i,y]));for(;a.length;){for(m={},u=!1,g=a.length-1;g>=0;g--)p=a[g],i=p[0],y=p[1],h=((e[[i-1,y]]||t)[2]+(e[[i+1,y]]||t)[2]+(e[[i,y-1]]||t)[2]+(e[[i,y+1]]||t)[2])/20,h&&(m[p]=[i,y,h],a.splice(g,1),u=!0);if(!u)throw"findEmpties iterated with no new neighbors";for(p in m)e[p]=m[p],M.push(m[p])}return M.sort(function(_,s){return s[2]-_[2]})}},{"../../lib":515}],808:[function(d,ee,te){var w=d("../../components/fx"),v=d("../../lib"),S=d("../../plots/cartesian/axes"),M=d("../../components/colorscale").extractOpts;ee.exports=function(a,n,r,t,c){c||(c={});var o=c.isContour,i=a.cd[0],y=i.trace,p=a.xa,g=a.ya,h=i.x,m=i.y,u=i.z,_=i.xCenter,s=i.yCenter,A=i.zmask,b=y.zhoverformat,f=h,x=m,l,L,T,k;if(a.index!==!1){try{T=Math.round(a.index[1]),k=Math.round(a.index[0])}catch{v.error("Error hovering on heatmap, pointNumber must be [row,col], found:",a.index);return}if(T<0||T>=u[0].length||k<0||k>u.length)return}else{if(w.inbox(n-h[0],n-h[h.length-1],0)>0||w.inbox(r-m[0],r-m[m.length-1],0)>0)return;if(o){var P;for(f=[2*h[0]-h[1]],P=1;P<h.length;P++)f.push((h[P]+h[P-1])/2);for(f.push([2*h[h.length-1]-h[h.length-2]]),x=[2*m[0]-m[1]],P=1;P<m.length;P++)x.push((m[P]+m[P-1])/2);x.push([2*m[m.length-1]-m[m.length-2]])}T=Math.max(0,Math.min(f.length-2,v.findBin(n,f))),k=Math.max(0,Math.min(x.length-2,v.findBin(r,x)))}var z=p.c2p(h[T]),I=p.c2p(h[T+1]),D=g.c2p(m[k]),R=g.c2p(m[k+1]),B,F;o?(B=i.orig_x||h,F=i.orig_y||m,I=z,l=B[T],R=D,L=F[k]):(B=i.orig_x||_||h,F=i.orig_y||s||m,l=_?B[T]:(B[T]+B[T+1])/2,L=s?F[k]:(F[k]+F[k+1])/2,p&&p.type==="category"&&(l=h[T]),g&&g.type==="category"&&(L=m[k]),y.zsmooth&&(z=I=p.c2p(l),D=R=g.c2p(L)));var H=u[k][T];if(A&&!A[k][T]&&(H=void 0),!(H===void 0&&!y.hoverongaps)){var G;Array.isArray(i.hovertext)&&Array.isArray(i.hovertext[k])?G=i.hovertext[k][T]:Array.isArray(i.text)&&Array.isArray(i.text[k])&&(G=i.text[k][T]);var J=M(y),X={type:"linear",range:[J.min,J.max],hoverformat:b,_separators:p._separators,_numFormat:p._numFormat},Y=S.tickText(X,H,"hover").text;return[v.extendFlat(a,{index:y._after2before?y._after2before[k][T]:[k,T],distance:a.maxHoverDistance,spikeDistance:a.maxSpikeDistance,x0:z,x1:I,y0:D,y1:R,xLabelVal:l,yLabelVal:L,zLabelVal:H,zLabel:Y,text:G})]}}},{"../../components/colorscale":379,"../../components/fx":407,"../../lib":515,"../../plots/cartesian/axes":566}],809:[function(d,ee,te){ee.exports={attributes:d("./attributes"),supplyDefaults:d("./defaults"),calc:d("./calc"),plot:d("./plot"),colorbar:d("./colorbar"),style:d("./style"),hoverPoints:d("./hover"),moduleType:"trace",name:"heatmap",basePlotModule:d("../../plots/cartesian"),categories:["cartesian","svg","2dMap","showLegend"],meta:{}}},{"../../plots/cartesian":578,"./attributes":801,"./calc":802,"./colorbar":804,"./defaults":806,"./hover":808,"./plot":813,"./style":814}],810:[function(d,ee,te){var w=d("../../lib"),v=.01,S=[[-1,0],[1,0],[0,-1],[0,1]];function M(a){return .5-.25*Math.min(1,a*.5)}ee.exports=function(n,r){var t=1,c;for(e(n,r),c=0;c<r.length&&!(r[c][2]<4);c++);for(r=r.slice(c),c=0;c<100&&t>v;c++)t=e(n,r,M(t));return t>v&&w.log("interp2d didn't converge quickly",t),n};function e(a,n,r){var t=0,c,o,i,y,p,g,h,m,u,_,s,A,b;for(y=0;y<n.length;y++){for(c=n[y],o=c[0],i=c[1],s=a[o][i],_=0,u=0,p=0;p<4;p++)g=S[p],h=a[o+g[0]],h&&(m=h[i+g[1]],m!==void 0&&(_===0?A=b=m:(A=Math.min(A,m),b=Math.max(b,m)),u++,_+=m));if(u===0)throw"iterateInterp2d order is wrong: no defined neighbors";a[o][i]=_/u,s===void 0?u<4&&(t=1):(a[o][i]=(1+r)*a[o][i]-r*s,b>A&&(t=Math.max(t,Math.abs(a[o][i]-s)/(b-A))))}return t}},{"../../lib":515}],811:[function(d,ee,te){var w=d("../../lib");ee.exports=function(S,M){S("texttemplate");var e=w.extendFlat({},M.font,{color:"auto",size:"auto"});w.coerceFont(S,"textfont",e)}},{"../../lib":515}],812:[function(d,ee,te){var w=d("../../registry"),v=d("../../lib").isArrayOrTypedArray;ee.exports=function(M,e,a,n,r,t){var c=[],o=w.traceIs(M,"contour"),i=w.traceIs(M,"histogram"),y=w.traceIs(M,"gl2d"),p,g,h,m=v(e)&&e.length>1;if(m&&!i&&t.type!=="category"){var u=e.length;if(u<=r){if(o||y)c=e.slice(0,r);else if(r===1)c=[e[0]-.5,e[0]+.5];else{for(c=[1.5*e[0]-.5*e[1]],h=1;h<u;h++)c.push((e[h-1]+e[h])*.5);c.push(1.5*e[u-1]-.5*e[u-2])}if(u<r){var _=c[c.length-1],s=_-c[c.length-2];for(h=u;h<r;h++)_+=s,c.push(_)}}else return o?e.slice(0,r):e.slice(0,r+1)}else{var A=M[t._id.charAt(0)+"calendar"];if(i)p=t.r2c(a,0,A);else if(v(e)&&e.length===1)p=e[0];else if(a===void 0)p=0;else{var b=t.type==="log"?t.d2c:t.r2c;p=b(a,0,A)}for(g=n||1,h=o||y?0:-.5;h<r;h++)c.push(p+g*h)}return c}},{"../../lib":515,"../../registry":647}],813:[function(d,ee,te){var w=d("@plotly/d3"),v=d("tinycolor2"),S=d("../../registry"),M=d("../../components/drawing"),e=d("../../plots/cartesian/axes"),a=d("../../lib"),n=d("../../lib/svg_text_utils"),r=d("../scatter/format_labels"),t=d("../../components/color"),c=d("../../components/colorscale").extractOpts,o=d("../../components/colorscale").makeColorScaleFuncFromTrace,i=d("../../constants/xmlns_namespaces"),y=d("../../constants/alignment"),p=y.LINE_SPACING,g="heatmap-label";function h(A){return A.selectAll("g."+g)}function m(A){h(A).remove()}ee.exports=function(A,b,f,x){var l=b.xaxis,L=b.yaxis;a.makeTraceGroups(x,f,"hm").each(function(T){var k=w.select(this),P=T[0],z=P.trace,I=z.xgap||0,D=z.ygap||0,R=P.z,B=P.x,F=P.y,H=P.xCenter,G=P.yCenter,J=S.traceIs(z,"contour"),X=J?"best":z.zsmooth,Y=R.length,Z=a.maxRowLength(R),oe=!1,re=!1,se,N,U,q,$,W,K,ne;for(W=0;se===void 0&&W<B.length-1;)se=l.c2p(B[W]),W++;for(W=B.length-1;N===void 0&&W>0;)N=l.c2p(B[W]),W--;for(N<se&&(U=N,N=se,se=U,oe=!0),W=0;q===void 0&&W<F.length-1;)q=L.c2p(F[W]),W++;for(W=F.length-1;$===void 0&&W>0;)$=L.c2p(F[W]),W--;if($<q&&(U=q,q=$,$=U,re=!0),J&&(H=B,G=F,B=P.xfill,F=P.yfill),X!=="fast"){var ae=X==="best"?0:.5;se=Math.max(-ae*l._length,se),N=Math.min((1+ae)*l._length,N),q=Math.max(-ae*L._length,q),$=Math.min((1+ae)*L._length,$)}var ie=Math.round(N-se),le=Math.round($-q),ye=ie<=0||le<=0;if(ye){var ue=k.selectAll("image").data([]);ue.exit().remove(),m(k);return}var pe,ge;X==="fast"?(pe=Z,ge=Y):(pe=ie,ge=le);var Te=document.createElement("canvas");Te.width=pe,Te.height=ge;var _e=Te.getContext("2d"),ze=o(z,{noNumericCheck:!0,returnArray:!0}),Oe,Ye;X==="fast"?(Oe=oe?function(Ir){return Z-1-Ir}:a.identity,Ye=re?function(Ir){return Y-1-Ir}:a.identity):(Oe=function(Ir){return a.constrain(Math.round(l.c2p(B[Ir])-se),0,ie)},Ye=function(Ir){return a.constrain(Math.round(L.c2p(F[Ir])-q),0,le)});var be=Ye(0),Pe=[be,be],Ge=oe?0:1,Qe=re?0:1,Be=0,Le=0,He=0,vt=0,Rt,rr,Lt,Ft,Gt;function Dt(Ir,Tr){if(Ir!==void 0){var Wr=ze(Ir);return Wr[0]=Math.round(Wr[0]),Wr[1]=Math.round(Wr[1]),Wr[2]=Math.round(Wr[2]),Be+=Tr,Le+=Wr[0]*Tr,He+=Wr[1]*Tr,vt+=Wr[2]*Tr,Wr}return[0,0,0,0]}function kt(Ir,Tr,Wr,wn){var ln=Ir[Wr.bin0];if(ln===void 0)return Dt(void 0,1);var Bn=Ir[Wr.bin1],Cn=Tr[Wr.bin0],Wn=Tr[Wr.bin1],Hn=Bn-ln||0,ga=Cn-ln||0,La;return Bn===void 0?Wn===void 0?La=0:Cn===void 0?La=2*(Wn-ln):La=(2*Wn-Cn-ln)*2/3:Wn===void 0?Cn===void 0?La=0:La=(2*ln-Bn-Cn)*2/3:Cn===void 0?La=(2*Wn-Bn-ln)*2/3:La=Wn+ln-Bn-Cn,Dt(ln+Wr.frac*Hn+wn.frac*(ga+Wr.frac*La))}if(X){var Ue=0,qe;try{qe=new Uint8Array(ie*le*4)}catch{qe=new Array(ie*le*4)}if(X==="best"){var Ve=H||B,Ae=G||F,Ne=new Array(Ve.length),Xe=new Array(Ae.length),Je=new Array(ie),_t=H?_:u,mt=G?_:u,Ot,Kt,Nt;for(W=0;W<Ve.length;W++)Ne[W]=Math.round(l.c2p(Ve[W])-se);for(W=0;W<Ae.length;W++)Xe[W]=Math.round(L.c2p(Ae[W])-q);for(W=0;W<ie;W++)Je[W]=_t(W,Ne);for(K=0;K<le;K++)for(Ot=mt(K,Xe),Kt=R[Ot.bin0],Nt=R[Ot.bin1],W=0;W<ie;W++,Ue+=4)Gt=kt(Kt,Nt,Je[W],Ot),s(qe,Ue,Gt)}else for(K=0;K<Y;K++)for(Ft=R[K],Pe=Ye(K),W=0;W<ie;W++)Gt=Dt(Ft[W],1),Ue=(Pe*ie+Oe(W))*4,s(qe,Ue,Gt);var Wt=_e.createImageData(ie,le);try{Wt.data.set(qe)}catch{var qt=Wt.data,Yt=qt.length;for(K=0;K<Yt;K++)qt[K]=qe[K]}_e.putImageData(Wt,0,0)}else{var fr=Math.floor(I/2),Yr=Math.floor(D/2);for(K=0;K<Y;K++)if(Ft=R[K],Pe.reverse(),Pe[Qe]=Ye(K+1),!(Pe[0]===Pe[1]||Pe[0]===void 0||Pe[1]===void 0))for(rr=Oe(0),Rt=[rr,rr],W=0;W<Z;W++)Rt.reverse(),Rt[Ge]=Oe(W+1),!(Rt[0]===Rt[1]||Rt[0]===void 0||Rt[1]===void 0)&&(Lt=Ft[W],Gt=Dt(Lt,(Rt[1]-Rt[0])*(Pe[1]-Pe[0])),_e.fillStyle="rgba("+Gt.join(",")+")",_e.fillRect(Rt[0]+fr,Pe[0]+Yr,Rt[1]-Rt[0]-I,Pe[1]-Pe[0]-D))}Le=Math.round(Le/Be),He=Math.round(He/Be),vt=Math.round(vt/Be);var hn=v("rgb("+Le+","+He+","+vt+")");A._hmpixcount=(A._hmpixcount||0)+Be,A._hmlumcount=(A._hmlumcount||0)+Be*hn.getLuminance();var Qr=k.selectAll("image").data(T);Qr.enter().append("svg:image").attr({xmlns:i.svg,preserveAspectRatio:"none"}),Qr.attr({height:le,width:ie,x:se,y:q,"xlink:href":Te.toDataURL("image/png")}),m(k);var at=z.texttemplate;if(at){var Jt=c(z),Zt={type:"linear",range:[Jt.min,Jt.max],_separators:l._separators,_numFormat:l._numFormat},Ut=z.type==="histogram2dcontour",_r=z.type==="contour",rt=_r?1:0,Ke=_r?Y-1:Y,st=_r?1:0,lt=_r?Z-1:Z,wt=[];for(W=rt;W<Ke;W++){var Pt;if(_r)Pt=P.y[W];else if(Ut){if(W===0||W===Y-1)continue;Pt=P.y[W]}else if(P.yCenter)Pt=P.yCenter[W];else{if(W+1===Y&&P.y[W+1]===void 0)continue;Pt=(P.y[W]+P.y[W+1])/2}var ke=Math.round(L.c2p(Pt));if(!(0>ke||ke>L._length))for(K=st;K<lt;K++){var Se;if(_r)Se=P.x[K];else if(Ut){if(K===0||K===Z-1)continue;Se=P.x[K]}else if(P.xCenter)Se=P.xCenter[K];else{if(K+1===Z&&P.x[K+1]===void 0)continue;Se=(P.x[K]+P.x[K+1])/2}var nt=Math.round(l.c2p(Se));if(!(0>nt||nt>l._length)){var it=r({x:Se,y:Pt},z,A._fullLayout);it.x=Se,it.y=Pt;var ct=P.z[W][K];ct===void 0?(it.z="",it.zLabel=""):(it.z=ct,it.zLabel=e.tickText(Zt,ct,"hover").text);var At=P.text&&P.text[W]&&P.text[W][K];(At===void 0||At===!1)&&(At=""),it.text=At;var dt=a.texttemplateString(at,it,A._fullLayout._d3locale,it,z._meta||{});if(!!dt){var Tt=dt.split("<br>"),Ht=Tt.length,ir=0;for(ne=0;ne<Ht;ne++)ir=Math.max(ir,Tt[ne].length);wt.push({l:Ht,c:ir,t:dt,x:nt,y:ke,z:ct})}}}}var kr=z.textfont,br=kr.family,Mr=kr.size,Hr=A._fullLayout.font.size;if(!Mr||Mr==="auto"){var nr=1/0,mr=1/0,Pr=0,Nr=0;for(ne=0;ne<wt.length;ne++){var Sr=wt[ne];if(Pr=Math.max(Pr,Sr.l),Nr=Math.max(Nr,Sr.c),ne<wt.length-1){var tt=wt[ne+1],Et=Math.abs(tt.x-Sr.x),Vt=Math.abs(tt.y-Sr.y);Et&&(nr=Math.min(nr,Et)),Vt&&(mr=Math.min(mr,Vt))}}!isFinite(nr)||!isFinite(mr)?Mr=Hr:(nr-=I,mr-=D,nr/=Nr,mr/=Pr,nr/=p/2,mr/=p,Mr=Math.min(Math.floor(nr),Math.floor(mr),Hr))}if(Mr<=0||!isFinite(Mr))return;var ar=function(Ir){return Ir.x},Cr=function(Ir){return Ir.y-Mr*(Ir.l*p/2-1)},Or=h(k).data(wt);Or.enter().append("g").classed(g,1).append("text").attr("text-anchor","middle").each(function(Ir){var Tr=w.select(this),Wr=kr.color;(!Wr||Wr==="auto")&&(Wr=t.contrast("rgba("+ze(Ir.z).join()+")")),Tr.attr("data-notex",1).call(n.positionText,ar(Ir),Cr(Ir)).call(M.font,br,Mr,Wr).text(Ir.t).call(n.convertToTspans,A)})}})};function u(A,b){var f=b.length-2,x=a.constrain(a.findBin(A,b),0,f),l=b[x],L=b[x+1],T=a.constrain(x+(A-l)/(L-l)-.5,0,f),k=Math.round(T),P=Math.abs(T-k);return!T||T===f||!P?{bin0:k,bin1:k,frac:0}:{bin0:k,frac:P,bin1:Math.round(k+P/(T-k))}}function _(A,b){var f=b.length-1,x=a.constrain(a.findBin(A,b),0,f),l=b[x],L=b[x+1],T=(A-l)/(L-l)||0;return T<=0?{bin0:x,bin1:x,frac:0}:T<.5?{bin0:x,bin1:x+1,frac:T}:{bin0:x+1,bin1:x,frac:1-T}}function s(A,b,f){A[b]=f[0],A[b+1]=f[1],A[b+2]=f[2],A[b+3]=Math.round(f[3]*255)}},{"../../components/color":367,"../../components/colorscale":379,"../../components/drawing":389,"../../constants/alignment":483,"../../constants/xmlns_namespaces":492,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/cartesian/axes":566,"../../registry":647,"../scatter/format_labels":945,"@plotly/d3":58,tinycolor2:313}],814:[function(d,ee,te){var w=d("@plotly/d3");ee.exports=function(S){w.select(S).selectAll(".hm image").style("opacity",function(M){return M.trace.opacity})}},{"@plotly/d3":58}],815:[function(d,ee,te){ee.exports=function(v,S,M){var e=M("zsmooth");e===!1&&(M("xgap"),M("ygap")),M("zhoverformat")}},{}],816:[function(d,ee,te){var w=d("fast-isnumeric"),v=d("../../lib"),S=d("../../registry");ee.exports=function(n,r,t,c,o,i){var y=t("z");o=o||"x",i=i||"y";var p,g;if(y===void 0||!y.length)return 0;if(v.isArray1D(n.z)){p=t(o),g=t(i);var h=v.minRowLength(p),m=v.minRowLength(g);if(h===0||m===0)return 0;r._length=Math.min(h,m,y.length)}else{if(p=M(o,t),g=M(i,t),!e(y))return 0;t("transpose"),r._length=null}if(n.type==="heatmapgl")return!0;var u=S.getComponentMethod("calendars","handleTraceDefaults");return u(n,r,[o,i],c),!0};function M(a,n){var r=n(a),t=r?n(a+"type","array"):"scaled";return t==="scaled"&&(n(a+"0"),n("d"+a)),r}function e(a){for(var n=!0,r=!1,t=!1,c,o=0;o<a.length;o++){if(c=a[o],!v.isArrayOrTypedArray(c)){n=!1;break}c.length>0&&(r=!0);for(var i=0;i<c.length;i++)if(w(c[i])){t=!0;break}}return n&&r&&t}},{"../../lib":515,"../../registry":647,"fast-isnumeric":190}],817:[function(d,ee,te){for(var w=d("../heatmap/attributes"),v=d("../../components/colorscale/attributes"),S=d("../../lib/extend").extendFlat,M=d("../../plot_api/edit_types").overrideAll,e=["z","x","x0","dx","y","y0","dy","text","transpose","xtype","ytype"],a={},n=0;n<e.length;n++){var r=e[n];a[r]=w[r]}a.zsmooth={valType:"enumerated",values:["fast",!1],dflt:"fast",editType:"calc"},S(a,v("",{cLetter:"z",autoColorDflt:!1})),ee.exports=M(a,"calc","nested")},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plot_api/edit_types":548,"../heatmap/attributes":801}],818:[function(d,ee,te){var w=d("../../../stackgl_modules").gl_heatmap2d,v=d("../../plots/cartesian/axes"),S=d("../../lib/str2rgbarray");function M(r,t){this.scene=r,this.uid=t,this.type="heatmapgl",this.name="",this.hoverinfo="all",this.xData=[],this.yData=[],this.zData=[],this.textLabels=[],this.idToIndex=[],this.bounds=[0,0,0,0],this.options={zsmooth:"fast",z:[],x:[],y:[],shape:[0,0],colorLevels:[0],colorValues:[0,0,0,1]},this.heatmap=w(r.glplot,this.options),this.heatmap._trace=this}var e=M.prototype;e.handlePick=function(r){var t=this.options,c=t.shape,o=r.pointId,i=o%c[0],y=Math.floor(o/c[0]),p=o;return{trace:this,dataCoord:r.dataCoord,traceCoord:[t.x[i],t.y[y],t.z[p]],textLabel:this.textLabels[o],name:this.name,pointIndex:[y,i],hoverinfo:this.hoverinfo}},e.update=function(r,t){var c=t[0];this.index=r.index,this.name=r.name,this.hoverinfo=r.hoverinfo;var o=c.z;this.options.z=[].concat.apply([],o);var i=o[0].length,y=o.length;this.options.shape=[i,y],this.options.x=c.x,this.options.y=c.y,this.options.zsmooth=r.zsmooth;var p=a(r);this.options.colorLevels=p.colorLevels,this.options.colorValues=p.colorValues,this.textLabels=[].concat.apply([],r.text),this.heatmap.update(this.options);var g=this.scene.xaxis,h=this.scene.yaxis,m,u;r.zsmooth===!1&&(m={ppad:c.x[1]-c.x[0]},u={ppad:c.y[1]-c.y[0]}),r._extremes[g._id]=v.findExtremes(g,c.x,m),r._extremes[h._id]=v.findExtremes(h,c.y,u)},e.dispose=function(){this.heatmap.dispose()};function a(r){for(var t=r.colorscale,c=r.zmin,o=r.zmax,i=t.length,y=new Array(i),p=new Array(4*i),g=0;g<i;g++){var h=t[g],m=S(h[1]);y[g]=c+h[0]*(o-c);for(var u=0;u<4;u++)p[4*g+u]=m[u]}return{colorLevels:y,colorValues:p}}function n(r,t,c){var o=new M(r,t.uid);return o.update(t,c),o}ee.exports=n},{"../../../stackgl_modules":1133,"../../lib/str2rgbarray":540,"../../plots/cartesian/axes":566}],819:[function(d,ee,te){var w=d("../../lib"),v=d("../heatmap/xyz_defaults"),S=d("../../components/colorscale/defaults"),M=d("./attributes");ee.exports=function(a,n,r,t){function c(i,y){return w.coerce(a,n,M,i,y)}var o=v(a,n,c,t);if(!o){n.visible=!1;return}c("text"),c("zsmooth"),S(a,n,t,c,{prefix:"",cLetter:"z"})}},{"../../components/colorscale/defaults":377,"../../lib":515,"../heatmap/xyz_defaults":816,"./attributes":817}],820:[function(d,ee,te){ee.exports={attributes:d("./attributes"),supplyDefaults:d("./defaults"),colorbar:d("../heatmap/colorbar"),calc:d("../heatmap/calc"),plot:d("./convert"),moduleType:"trace",name:"heatmapgl",basePlotModule:d("../../plots/gl2d"),categories:["gl","gl2d","2dMap"],meta:{}}},{"../../plots/gl2d":605,"../heatmap/calc":802,"../heatmap/colorbar":804,"./attributes":817,"./convert":818,"./defaults":819}],821:[function(d,ee,te){var w=d("../bar/attributes"),v=d("../../plots/cartesian/axis_format_attributes").axisHoverFormat,S=d("../../plots/template_attributes").hovertemplateAttrs,M=d("../../plots/template_attributes").texttemplateAttrs,e=d("../../plots/font_attributes"),a=d("./bin_attributes"),n=d("./constants"),r=d("../../lib/extend").extendFlat;ee.exports={x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},xhoverformat:v("x"),yhoverformat:v("y"),text:r({},w.text,{}),hovertext:r({},w.hovertext,{}),orientation:w.orientation,histfunc:{valType:"enumerated",values:["count","sum","avg","min","max"],dflt:"count",editType:"calc"},histnorm:{valType:"enumerated",values:["","percent","probability","density","probability density"],dflt:"",editType:"calc"},cumulative:{enabled:{valType:"boolean",dflt:!1,editType:"calc"},direction:{valType:"enumerated",values:["increasing","decreasing"],dflt:"increasing",editType:"calc"},currentbin:{valType:"enumerated",values:["include","exclude","half"],dflt:"include",editType:"calc"},editType:"calc"},nbinsx:{valType:"integer",min:0,dflt:0,editType:"calc"},xbins:a("x",!0),nbinsy:{valType:"integer",min:0,dflt:0,editType:"calc"},ybins:a("y",!0),autobinx:{valType:"boolean",dflt:null,editType:"calc"},autobiny:{valType:"boolean",dflt:null,editType:"calc"},bingroup:{valType:"string",dflt:"",editType:"calc"},hovertemplate:S({},{keys:n.eventDataKeys}),texttemplate:M({arrayOk:!1,editType:"plot"},{keys:["label","value"]}),textposition:r({},w.textposition,{arrayOk:!1}),textfont:e({arrayOk:!1,editType:"plot",colorEditType:"style"}),outsidetextfont:e({arrayOk:!1,editType:"plot",colorEditType:"style"}),insidetextfont:e({arrayOk:!1,editType:"plot",colorEditType:"style"}),insidetextanchor:w.insidetextanchor,textangle:w.textangle,cliponaxis:w.cliponaxis,constraintext:w.constraintext,marker:w.marker,offsetgroup:w.offsetgroup,alignmentgroup:w.alignmentgroup,selected:w.selected,unselected:w.unselected,_deprecated:{bardir:w._deprecated.bardir}}},{"../../lib/extend":505,"../../plots/cartesian/axis_format_attributes":569,"../../plots/font_attributes":594,"../../plots/template_attributes":642,"../bar/attributes":657,"./bin_attributes":823,"./constants":827}],822:[function(d,ee,te){ee.exports=function(v,S){for(var M=v.length,e=0,a=0;a<M;a++)S[a]?(v[a]/=S[a],e+=v[a]):v[a]=null;return e}},{}],823:[function(d,ee,te){ee.exports=function(v,S){return{start:{valType:"any",editType:"calc"},end:{valType:"any",editType:"calc"},size:{valType:"any",editType:"calc"},editType:"calc"}}},{}],824:[function(d,ee,te){var w=d("fast-isnumeric");ee.exports={count:function(v,S,M){return M[v]++,1},sum:function(v,S,M,e){var a=e[S];return w(a)?(a=Number(a),M[v]+=a,a):0},avg:function(v,S,M,e,a){var n=e[S];return w(n)&&(n=Number(n),M[v]+=n,a[v]++),0},min:function(v,S,M,e){var a=e[S];if(w(a))if(a=Number(a),w(M[v])){if(M[v]>a){var n=a-M[v];return M[v]=a,n}}else return M[v]=a,a;return 0},max:function(v,S,M,e){var a=e[S];if(w(a))if(a=Number(a),w(M[v])){if(M[v]<a){var n=a-M[v];return M[v]=a,n}}else return M[v]=a,a;return 0}}},{"fast-isnumeric":190}],825:[function(d,ee,te){var w=d("../../constants/numerical"),v=w.ONEAVGYEAR,S=w.ONEAVGMONTH,M=w.ONEDAY,e=w.ONEHOUR,a=w.ONEMIN,n=w.ONESEC,r=d("../../plots/cartesian/axes").tickIncrement;ee.exports=function(p,g,h,m,u){var _=-1.1*g,s=-.1*g,A=p-s,b=h[0],f=h[1],x=Math.min(t(b+s,b+A,m,u),t(f+s,f+A,m,u)),l=Math.min(t(b+_,b+s,m,u),t(f+_,f+s,m,u)),L,T;if(x>l&&l<Math.abs(f-b)/4e3?(L=x,T=!1):(L=Math.min(x,l),T=!0),m.type==="date"&&L>M){var k=L===v?1:6,P=L===v?"M12":"M1";return function(z,I){var D=m.c2d(z,v,u),R=D.indexOf("-",k);R>0&&(D=D.substr(0,R));var B=m.d2c(D,0,u);if(B<z){var F=r(B,P,!1,u);(B+F)/2<z+p&&(B=F)}return I&&T?r(B,P,!0,u):B}}return function(z,I){var D=L*Math.round(z/L);return D+L/10<z&&D+L*.9<z+p&&(D+=L),I&&T&&(D-=L),D}};function t(y,p,g,h){if(y*p<=0)return 1/0;for(var m=Math.abs(p-y),u=g.type==="date",_=c(m,u),s=0;s<10;s++){var A=c(_*80,u);if(_===A)break;if(o(A,y,p,u,g,h))_=A;else break}return _}function c(y,p){return p&&y>n?y>M?y>v*1.1?v:y>S*1.1?S:M:y>e?e:y>a?a:n:Math.pow(10,Math.floor(Math.log(y)/Math.LN10))}function o(y,p,g,h,m,u){if(h&&y>M){var _=i(p,m,u),s=i(g,m,u),A=y===v?0:1;return _[A]!==s[A]}return Math.floor(g/y)-Math.floor(p/y)>.1}function i(y,p,g){var h=p.c2d(y,v,g).split("-");return h[0]===""&&(h.unshift(),h[0]="-"+h[0]),h}},{"../../constants/numerical":491,"../../plots/cartesian/axes":566}],826:[function(d,ee,te){var w=d("fast-isnumeric"),v=d("../../lib"),S=d("../../registry"),M=d("../../plots/cartesian/axes"),e=d("../bar/arrays_to_calcdata"),a=d("./bin_functions"),n=d("./norm_functions"),r=d("./average"),t=d("./bin_label_vals");function c(g,h){var m=[],u=[],_=h.orientation==="h",s=M.getFromId(g,_?h.yaxis:h.xaxis),A=_?"y":"x",b={x:"y",y:"x"}[A],f=h[A+"calendar"],x=h.cumulative,l,L=o(g,h,s,A),T=L[0],k=L[1],P=typeof T.size=="string",z=[],I=P?z:T,D=[],R=[],B=[],F=0,H=h.histnorm,G=h.histfunc,J=H.indexOf("density")!==-1,X,Y,Z;x.enabled&&J&&(H=H.replace(/ ?density$/,""),J=!1);var oe=G==="max"||G==="min",re=oe?null:0,se=a.count,N=n[H],U=!1,q=function(Ye){return s.r2c(Ye,0,f)},$;for(v.isArrayOrTypedArray(h[b])&&G!=="count"&&($=h[b],U=G==="avg",se=a[G]),l=q(T.start),Y=q(T.end)+(l-M.tickIncrement(l,T.size,!1,f))/1e6;l<Y&&m.length<1e6&&(X=M.tickIncrement(l,T.size,!1,f),m.push((l+X)/2),u.push(re),B.push([]),z.push(l),J&&D.push(1/(X-l)),U&&R.push(0),!(X<=l));)l=X;z.push(l),!P&&s.type==="date"&&(I={start:q(I.start),end:q(I.end),size:I.size}),g._fullLayout._roundFnOpts||(g._fullLayout._roundFnOpts={});var W=h["_"+A+"bingroup"],K={leftGap:1/0,rightGap:1/0};W&&(g._fullLayout._roundFnOpts[W]||(g._fullLayout._roundFnOpts[W]=K),K=g._fullLayout._roundFnOpts[W]);var ne=u.length,ae=!0,ie=K.leftGap,le=K.rightGap,ye={};for(l=0;l<k.length;l++){var ue=k[l];Z=v.findBin(ue,I),Z>=0&&Z<ne&&(F+=se(Z,l,u,$,R),ae&&B[Z].length&&ue!==k[B[Z][0]]&&(ae=!1),B[Z].push(l),ye[l]=Z,ie=Math.min(ie,ue-z[Z]),le=Math.min(le,z[Z+1]-ue))}K.leftGap=ie,K.rightGap=le;var pe;ae||(pe=function(Ye,be){return function(){var Pe=g._fullLayout._roundFnOpts[W];return t(Pe.leftGap,Pe.rightGap,z,s,f)(Ye,be)}}),U&&(F=r(u,R)),N&&N(u,F,D),x.enabled&&p(u,x.direction,x.currentbin);var ge=Math.min(m.length,u.length),Te=[],_e=0,ze=ge-1;for(l=0;l<ge;l++)if(u[l]){_e=l;break}for(l=ge-1;l>=_e;l--)if(u[l]){ze=l;break}for(l=_e;l<=ze;l++)if(w(m[l])&&w(u[l])){var Oe={p:m[l],s:u[l],b:0};x.enabled||(Oe.pts=B[l],ae?Oe.ph0=Oe.ph1=B[l].length?k[B[l][0]]:m[l]:(h._computePh=!0,Oe.ph0=pe(z[l]),Oe.ph1=pe(z[l+1],!0))),Te.push(Oe)}return Te.length===1&&(Te[0].width1=M.tickIncrement(Te[0].p,T.size,!1,f)-Te[0].p),e(Te,h),v.isArrayOrTypedArray(h.selectedpoints)&&v.tagSelected(Te,h,ye),Te}function o(g,h,m,u,_){var s=u+"bins",A=g._fullLayout,b=h["_"+u+"bingroup"],f=A._histogramBinOpts[b],x=A.barmode==="overlay",l,L,T,k,P,z,I,D=function(ue){return m.r2c(ue,0,k)},R=function(ue){return m.c2r(ue,0,k)},B=m.type==="date"?function(ue){return ue||ue===0?v.cleanDate(ue,null,k):null}:function(ue){return w(ue)?Number(ue):null};function F(ue,pe,ge){pe[ue+"Found"]?(pe[ue]=B(pe[ue]),pe[ue]===null&&(pe[ue]=ge[ue])):(z[ue]=pe[ue]=ge[ue],v.nestedProperty(L[0],s+"."+ue).set(ge[ue]))}if(h["_"+u+"autoBinFinished"])delete h["_"+u+"autoBinFinished"];else{L=f.traces;var H=[],G=!0,J=!1,X=!1;for(l=0;l<L.length;l++)if(T=L[l],T.visible){var Y=f.dirs[l];P=T["_"+Y+"pos0"]=m.makeCalcdata(T,Y),H=v.concat(H,P),delete T["_"+u+"autoBinFinished"],h.visible===!0&&(G?G=!1:(delete T._autoBin,T["_"+u+"autoBinFinished"]=1),S.traceIs(T,"2dMap")&&(J=!0),T.type==="histogram2dcontour"&&(X=!0))}k=L[0][u+"calendar"];var Z=M.autoBin(H,m,f.nbins,J,k,f.sizeFound&&f.size),oe=L[0]._autoBin={};if(z=oe[f.dirs[0]]={},X&&(f.size||(Z.start=R(M.tickIncrement(D(Z.start),Z.size,!0,k))),f.end===void 0&&(Z.end=R(M.tickIncrement(D(Z.end),Z.size,!1,k)))),x&&!S.traceIs(h,"2dMap")&&Z._dataSpan===0&&m.type!=="category"&&m.type!=="multicategory"){if(_)return[Z,P,!0];Z=i(g,h,m,u,s)}I=T.cumulative||{},I.enabled&&I.currentbin!=="include"&&(I.direction==="decreasing"?Z.start=R(M.tickIncrement(D(Z.start),Z.size,!0,k)):Z.end=R(M.tickIncrement(D(Z.end),Z.size,!1,k))),f.size=Z.size,f.sizeFound||(z.size=Z.size,v.nestedProperty(L[0],s+".size").set(Z.size)),F("start",f,Z),F("end",f,Z)}P=h["_"+u+"pos0"],delete h["_"+u+"pos0"];var re=h._input[s]||{},se=v.extendFlat({},f),N=f.start,U=m.r2l(re.start),q=U!==void 0;if((f.startFound||q)&&U!==m.r2l(N)){var $=q?U:v.aggNums(Math.min,null,P),W={type:m.type==="category"||m.type==="multicategory"?"linear":m.type,r2l:m.r2l,dtick:f.size,tick0:N,calendar:k,range:[$,M.tickIncrement($,f.size,!1,k)].map(m.l2r)},K=M.tickFirst(W);K>m.r2l($)&&(K=M.tickIncrement(K,f.size,!0,k)),se.start=m.l2r(K),q||v.nestedProperty(h,s+".start").set(se.start)}var ne=f.end,ae=m.r2l(re.end),ie=ae!==void 0;if((f.endFound||ie)&&ae!==m.r2l(ne)){var le=ie?ae:v.aggNums(Math.max,null,P);se.end=m.l2r(le),ie||v.nestedProperty(h,s+".start").set(se.end)}var ye="autobin"+u;return h._input[ye]===!1&&(h._input[s]=v.extendFlat({},h[s]||{}),delete h._input[ye],delete h[ye]),[se,P]}function i(g,h,m,u,_){var s=g._fullLayout,A=y(g,h),b=!1,f=1/0,x=[h],l,L,T;for(l=0;l<A.length;l++)if(L=A[l],L===h)b=!0;else if(!b)T=s._histogramBinOpts[L["_"+u+"bingroup"]],f=Math.min(f,T.size||L[_].size);else{var k=o(g,L,m,u,!0),P=k[0],z=k[2];L["_"+u+"autoBinFinished"]=1,L["_"+u+"pos0"]=k[1],z?x.push(L):f=Math.min(f,P.size)}var I=new Array(x.length);for(l=0;l<x.length;l++)for(var D=x[l]["_"+u+"pos0"],R=0;R<D.length;R++)if(D[R]!==void 0){I[l]=D[R];break}for(isFinite(f)||(f=v.distinctVals(I).minDiff),l=0;l<x.length;l++){L=x[l];var B=L[u+"calendar"],F={start:m.c2r(I[l]-f/2,0,B),end:m.c2r(I[l]+f/2,0,B),size:f};L._input[_]=L[_]=F,T=s._histogramBinOpts[L["_"+u+"bingroup"]],T&&v.extendFlat(T,F)}return h[_]}function y(g,h){for(var m=h.xaxis,u=h.yaxis,_=h.orientation,s=[],A=g._fullData,b=0;b<A.length;b++){var f=A[b];f.type==="histogram"&&f.visible===!0&&f.orientation===_&&f.xaxis===m&&f.yaxis===u&&s.push(f)}return s}function p(g,h,m){var u,_,s;function A(f){s=g[f],g[f]/=2}function b(f){_=g[f],g[f]=s+_/2,s+=_}if(m==="half")if(h==="increasing")for(A(0),u=1;u<g.length;u++)b(u);else for(A(g.length-1),u=g.length-2;u>=0;u--)b(u);else if(h==="increasing"){for(u=1;u<g.length;u++)g[u]+=g[u-1];m==="exclude"&&(g.unshift(0),g.pop())}else{for(u=g.length-2;u>=0;u--)g[u]+=g[u+1];m==="exclude"&&(g.push(0),g.shift())}}ee.exports={calc:c,calcAllAutoBins:o}},{"../../lib":515,"../../plots/cartesian/axes":566,"../../registry":647,"../bar/arrays_to_calcdata":656,"./average":822,"./bin_functions":824,"./bin_label_vals":825,"./norm_functions":833,"fast-isnumeric":190}],827:[function(d,ee,te){ee.exports={eventDataKeys:["binNumber"]}},{}],828:[function(d,ee,te){var w=d("../../lib"),v=d("../../plots/cartesian/axis_ids"),S=d("../../registry").traceIs,M=d("../bar/defaults").handleGroupingDefaults,e=w.nestedProperty,a=d("../../plots/cartesian/constraints").getAxisGroup,n=[{aStr:{x:"xbins.start",y:"ybins.start"},name:"start"},{aStr:{x:"xbins.end",y:"ybins.end"},name:"end"},{aStr:{x:"xbins.size",y:"ybins.size"},name:"size"},{aStr:{x:"nbinsx",y:"nbinsy"},name:"nbins"}],r=["x","y"];ee.exports=function(c,o){var i=o._histogramBinOpts={},y=[],p={},g=[],h,m,u,_,s,A,b;function f(X,Y){return w.coerce(h._input,h,h._module.attributes,X,Y)}function x(X){return X.orientation==="v"?"x":"y"}function l(X,Y){var Z=v.getFromTrace({_fullLayout:o},X,Y);return Z.type}function L(X,Y,Z){var oe=X.uid+"__"+Z;Y||(Y=oe);var re=l(X,Z),se=X[Z+"calendar"]||"",N=i[Y],U=!0;N&&(re===N.axType&&se===N.calendar?(U=!1,N.traces.push(X),N.dirs.push(Z)):(Y=oe,re!==N.axType&&w.warn(["Attempted to group the bins of trace",X.index,"set on a","type:"+re,"axis","with bins on","type:"+N.axType,"axis."].join(" ")),se!==N.calendar&&w.warn(["Attempted to group the bins of trace",X.index,"set with a",se,"calendar","with bins",N.calendar?"on a "+N.calendar+" calendar":"w/o a set calendar"].join(" ")))),U&&(i[Y]={traces:[X],dirs:[Z],axType:re,calendar:X[Z+"calendar"]||""}),X["_"+Z+"bingroup"]=Y}for(s=0;s<c.length;s++)h=c[s],S(h,"histogram")&&(y.push(h),delete h._xautoBinFinished,delete h._yautoBinFinished,S(h,"2dMap")||M(h._input,h,o,f));var T=o._alignmentOpts||{};for(s=0;s<y.length;s++){if(h=y[s],u="",!S(h,"2dMap")){if(_=x(h),o.barmode==="group"&&h.alignmentgroup){var k=h[_+"axis"],P=a(o,k)+h.orientation;(T[P]||{})[h.alignmentgroup]&&(u=P)}!u&&o.barmode!=="overlay"&&(u=a(o,h.xaxis)+a(o,h.yaxis)+x(h))}u?(p[u]||(p[u]=[]),p[u].push(h)):g.push(h)}for(u in p){if(m=p[u],m.length===1){g.push(m[0]);continue}var z=!1;for(m.length&&(h=m[0],z=f("bingroup")),u=z||u,s=0;s<m.length;s++){h=m[s];var I=h._input.bingroup;I&&I!==u&&w.warn(["Trace",h.index,"must match","within bingroup",u+".","Ignoring its bingroup:",I,"setting."].join(" ")),h.bingroup=u,L(h,u,x(h))}}for(s=0;s<g.length;s++){h=g[s];var D=f("bingroup");if(S(h,"2dMap"))for(b=0;b<2;b++){_=r[b];var R=f(_+"bingroup",D?D+"__"+_:null);L(h,R,_)}else L(h,D,x(h))}for(u in i){var B=i[u];for(m=B.traces,A=0;A<n.length;A++){var F=n[A],H=F.name,G,J;if(!(H==="nbins"&&B.sizeFound)){for(s=0;s<m.length;s++){if(h=m[s],_=B.dirs[s],G=F.aStr[_],e(h._input,G).get()!==void 0){B[H]=f(G),B[H+"Found"]=!0;break}J=(h._autoBin||{})[_]||{},J[H]&&e(h,G).set(J[H])}if(H==="start"||H==="end")for(;s<m.length;s++)h=m[s],h["_"+_+"bingroup"]&&(J=(h._autoBin||{})[_]||{},f(G,J[H]));H==="nbins"&&!B.sizeFound&&!B.nbinsFound&&(h=m[0],B[H]=f(G))}}}}},{"../../lib":515,"../../plots/cartesian/axis_ids":570,"../../plots/cartesian/constraints":574,"../../registry":647,"../bar/defaults":661}],829:[function(d,ee,te){var w=d("../../registry"),v=d("../../lib"),S=d("../../components/color"),M=d("../bar/defaults").handleText,e=d("../bar/style_defaults"),a=d("./attributes");ee.exports=function(r,t,c,o){function i(l,L){return v.coerce(r,t,a,l,L)}var y=i("x"),p=i("y"),g=i("cumulative.enabled");g&&(i("cumulative.direction"),i("cumulative.currentbin")),i("text");var h=i("textposition");M(r,t,o,i,h,{moduleHasSelected:!0,moduleHasUnselected:!0,moduleHasConstrain:!0,moduleHasCliponaxis:!0,moduleHasTextangle:!0,moduleHasInsideanchor:!0}),i("hovertext"),i("hovertemplate"),i("xhoverformat"),i("yhoverformat");var m=i("orientation",p&&!y?"h":"v"),u=m==="v"?"x":"y",_=m==="v"?"y":"x",s=y&&p?Math.min(v.minRowLength(y)&&v.minRowLength(p)):v.minRowLength(t[u]||[]);if(!s){t.visible=!1;return}t._length=s;var A=w.getComponentMethod("calendars","handleTraceDefaults");A(r,t,["x","y"],o);var b=t[_];b&&i("histfunc"),i("histnorm"),i("autobin"+u),e(r,t,i,c,o),v.coerceSelectionMarkerOpacity(t,i);var f=(t.marker.line||{}).color,x=w.getComponentMethod("errorbars","supplyDefaults");x(r,t,f||S.defaultLine,{axis:"y"}),x(r,t,f||S.defaultLine,{axis:"x",inherit:"y"})}},{"../../components/color":367,"../../lib":515,"../../registry":647,"../bar/defaults":661,"../bar/style_defaults":672,"./attributes":821}],830:[function(d,ee,te){ee.exports=function(v,S,M,e,a){if(v.x="xVal"in S?S.xVal:S.x,v.y="yVal"in S?S.yVal:S.y,"zLabelVal"in S&&(v.z=S.zLabelVal),S.xa&&(v.xaxis=S.xa),S.ya&&(v.yaxis=S.ya),!(M.cumulative||{}).enabled){var n=Array.isArray(a)?e[0].pts[a[0]][a[1]]:e[a].pts;v.pointNumbers=n,v.binNumber=v.pointNumber,delete v.pointNumber,delete v.pointIndex;var r;if(M._indexToPoints){r=[];for(var t=0;t<n.length;t++)r=r.concat(M._indexToPoints[n[t]])}else r=n;v.pointIndices=r}return v}},{}],831:[function(d,ee,te){var w=d("../bar/hover").hoverPoints,v=d("../../plots/cartesian/axes").hoverLabelText;ee.exports=function(M,e,a,n,r){var t=w(M,e,a,n,r);if(!!t){M=t[0];var c=M.cd[M.index],o=M.cd[0].trace;if(!o.cumulative.enabled){var i=o.orientation==="h"?"y":"x";M[i+"Label"]=v(M[i+"a"],[c.ph0,c.ph1],o[i+"hoverformat"])}return t}}},{"../../plots/cartesian/axes":566,"../bar/hover":664}],832:[function(d,ee,te){ee.exports={attributes:d("./attributes"),layoutAttributes:d("../bar/layout_attributes"),supplyDefaults:d("./defaults"),crossTraceDefaults:d("./cross_trace_defaults"),supplyLayoutDefaults:d("../bar/layout_defaults"),calc:d("./calc").calc,crossTraceCalc:d("../bar/cross_trace_calc").crossTraceCalc,plot:d("../bar/plot").plot,layerName:"barlayer",style:d("../bar/style").style,styleOnSelect:d("../bar/style").styleOnSelect,colorbar:d("../scatter/marker_colorbar"),hoverPoints:d("./hover"),selectPoints:d("../bar/select"),eventData:d("./event_data"),moduleType:"trace",name:"histogram",basePlotModule:d("../../plots/cartesian"),categories:["bar-like","cartesian","svg","bar","histogram","oriented","errorBarsOK","showLegend"],meta:{}}},{"../../plots/cartesian":578,"../bar/cross_trace_calc":660,"../bar/layout_attributes":666,"../bar/layout_defaults":667,"../bar/plot":668,"../bar/select":669,"../bar/style":671,"../scatter/marker_colorbar":954,"./attributes":821,"./calc":826,"./cross_trace_defaults":828,"./defaults":829,"./event_data":830,"./hover":831}],833:[function(d,ee,te){ee.exports={percent:function(w,v){for(var S=w.length,M=100/v,e=0;e<S;e++)w[e]*=M},probability:function(w,v){for(var S=w.length,M=0;M<S;M++)w[M]/=v},density:function(w,v,S,M){var e=w.length;M=M||1;for(var a=0;a<e;a++)w[a]*=S[a]*M},"probability density":function(w,v,S,M){var e=w.length;M&&(v/=M);for(var a=0;a<e;a++)w[a]*=S[a]/v}}},{}],834:[function(d,ee,te){var w=d("../histogram/attributes"),v=d("../histogram/bin_attributes"),S=d("../heatmap/attributes"),M=d("../../plots/attributes"),e=d("../../plots/cartesian/axis_format_attributes").axisHoverFormat,a=d("../../plots/template_attributes").hovertemplateAttrs,n=d("../../plots/template_attributes").texttemplateAttrs,r=d("../../components/colorscale/attributes"),t=d("../../lib/extend").extendFlat;ee.exports=t({x:w.x,y:w.y,z:{valType:"data_array",editType:"calc"},marker:{color:{valType:"data_array",editType:"calc"},editType:"calc"},histnorm:w.histnorm,histfunc:w.histfunc,nbinsx:w.nbinsx,xbins:v("x"),nbinsy:w.nbinsy,ybins:v("y"),autobinx:w.autobinx,autobiny:w.autobiny,bingroup:t({},w.bingroup,{}),xbingroup:t({},w.bingroup,{}),ybingroup:t({},w.bingroup,{}),xgap:S.xgap,ygap:S.ygap,zsmooth:S.zsmooth,xhoverformat:e("x"),yhoverformat:e("y"),zhoverformat:e("z",1),hovertemplate:a({},{keys:"z"}),texttemplate:n({arrayOk:!1,editType:"plot"},{keys:"z"}),textfont:S.textfont,showlegend:t({},M.showlegend,{dflt:!1})},r("",{cLetter:"z",autoColorDflt:!1}))},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../heatmap/attributes":801,"../histogram/attributes":821,"../histogram/bin_attributes":823}],835:[function(d,ee,te){var w=d("../../lib"),v=d("../../plots/cartesian/axes"),S=d("../histogram/bin_functions"),M=d("../histogram/norm_functions"),e=d("../histogram/average"),a=d("../histogram/bin_label_vals"),n=d("../histogram/calc").calcAllAutoBins;ee.exports=function(i,y){var p=v.getFromId(i,y.xaxis),g=v.getFromId(i,y.yaxis),h=y.xcalendar,m=y.ycalendar,u=function(Ue){return p.r2c(Ue,0,h)},_=function(Ue){return g.r2c(Ue,0,m)},s=function(Ue){return p.c2r(Ue,0,h)},A=function(Ue){return g.c2r(Ue,0,m)},b,f,x,l,L=n(i,y,p,"x"),T=L[0],k=L[1],P=n(i,y,g,"y"),z=P[0],I=P[1],D=y._length;k.length>D&&k.splice(D,k.length-D),I.length>D&&I.splice(D,I.length-D);var R=[],B=[],F=[],H=typeof T.size=="string",G=typeof z.size=="string",J=[],X=[],Y=H?J:T,Z=G?X:z,oe=0,re=[],se=[],N=y.histnorm,U=y.histfunc,q=N.indexOf("density")!==-1,$=U==="max"||U==="min",W=$?null:0,K=S.count,ne=M[N],ae=!1,ie=[],le=[],ye="z"in y?y.z:"marker"in y&&Array.isArray(y.marker.color)?y.marker.color:"";ye&&U!=="count"&&(ae=U==="avg",K=S[U]);var ue=T.size,pe=u(T.start),ge=u(T.end)+(pe-v.tickIncrement(pe,ue,!1,h))/1e6;for(b=pe;b<ge;b=v.tickIncrement(b,ue,!1,h))B.push(W),J.push(b),ae&&F.push(0);J.push(b);var Te=B.length,_e=(b-pe)/Te,ze=s(pe+_e/2),Oe=z.size,Ye=_(z.start),be=_(z.end)+(Ye-v.tickIncrement(Ye,Oe,!1,m))/1e6;for(b=Ye;b<be;b=v.tickIncrement(b,Oe,!1,m)){R.push(B.slice()),X.push(b);var Pe=new Array(Te);for(f=0;f<Te;f++)Pe[f]=[];se.push(Pe),ae&&re.push(F.slice())}X.push(b);var Ge=R.length,Qe=(b-Ye)/Ge,Be=A(Ye+Qe/2);q&&(ie=r(B.length,Y,_e,H),le=r(R.length,Z,Qe,G)),!H&&p.type==="date"&&(Y=t(u,Y)),!G&&g.type==="date"&&(Z=t(_,Z));var Le=!0,He=!0,vt=new Array(Te),Rt=new Array(Ge),rr=1/0,Lt=1/0,Ft=1/0,Gt=1/0;for(b=0;b<D;b++){var Dt=k[b],kt=I[b];x=w.findBin(Dt,Y),l=w.findBin(kt,Z),x>=0&&x<Te&&l>=0&&l<Ge&&(oe+=K(x,b,R[l],ye,re[l]),se[l][x].push(b),Le&&(vt[x]===void 0?vt[x]=Dt:vt[x]!==Dt&&(Le=!1)),He&&(Rt[l]===void 0?Rt[l]=kt:Rt[l]!==kt&&(He=!1)),rr=Math.min(rr,Dt-J[x]),Lt=Math.min(Lt,J[x+1]-Dt),Ft=Math.min(Ft,kt-X[l]),Gt=Math.min(Gt,X[l+1]-kt))}if(ae)for(l=0;l<Ge;l++)oe+=e(R[l],re[l]);if(ne)for(l=0;l<Ge;l++)ne(R[l],oe,ie,le[l]);return{x:k,xRanges:c(J,Le&&vt,rr,Lt,p,h),x0:ze,dx:_e,y:I,yRanges:c(X,He&&Rt,Ft,Gt,g,m),y0:Be,dy:Qe,z:R,pts:se}};function r(o,i,y,p){var g=new Array(o),h;if(p)for(h=0;h<o;h++)g[h]=1/(i[h+1]-i[h]);else{var m=1/y;for(h=0;h<o;h++)g[h]=m}return g}function t(o,i){return{start:o(i.start),end:o(i.end),size:i.size}}function c(o,i,y,p,g,h){var m,u=o.length-1,_=new Array(u),s=a(y,p,o,g,h);for(m=0;m<u;m++){var A=(i||[])[m];_[m]=A===void 0?[s(o[m]),s(o[m+1],!0)]:[A,A]}return _}},{"../../lib":515,"../../plots/cartesian/axes":566,"../histogram/average":822,"../histogram/bin_functions":824,"../histogram/bin_label_vals":825,"../histogram/calc":826,"../histogram/norm_functions":833}],836:[function(d,ee,te){var w=d("../../lib"),v=d("./sample_defaults"),S=d("../heatmap/style_defaults"),M=d("../../components/colorscale/defaults"),e=d("../heatmap/label_defaults"),a=d("./attributes");ee.exports=function(r,t,c,o){function i(y,p){return w.coerce(r,t,a,y,p)}v(r,t,i,o),t.visible!==!1&&(S(r,t,i,o),M(r,t,o,i,{prefix:"",cLetter:"z"}),i("hovertemplate"),e(i,o),i("xhoverformat"),i("yhoverformat"))}},{"../../components/colorscale/defaults":377,"../../lib":515,"../heatmap/label_defaults":811,"../heatmap/style_defaults":815,"./attributes":834,"./sample_defaults":839}],837:[function(d,ee,te){var w=d("../heatmap/hover"),v=d("../../plots/cartesian/axes").hoverLabelText;ee.exports=function(M,e,a,n,r){var t=w(M,e,a,n,r);if(!!t){M=t[0];var c=M.index,o=c[0],i=c[1],y=M.cd[0],p=y.trace,g=y.xRanges[i],h=y.yRanges[o];return M.xLabel=v(M.xa,[g[0],g[1]],p.xhoverformat),M.yLabel=v(M.ya,[h[0],h[1]],p.yhoverformat),t}}},{"../../plots/cartesian/axes":566,"../heatmap/hover":808}],838:[function(d,ee,te){ee.exports={attributes:d("./attributes"),supplyDefaults:d("./defaults"),crossTraceDefaults:d("../histogram/cross_trace_defaults"),calc:d("../heatmap/calc"),plot:d("../heatmap/plot"),layerName:"heatmaplayer",colorbar:d("../heatmap/colorbar"),style:d("../heatmap/style"),hoverPoints:d("./hover"),eventData:d("../histogram/event_data"),moduleType:"trace",name:"histogram2d",basePlotModule:d("../../plots/cartesian"),categories:["cartesian","svg","2dMap","histogram","showLegend"],meta:{}}},{"../../plots/cartesian":578,"../heatmap/calc":802,"../heatmap/colorbar":804,"../heatmap/plot":813,"../heatmap/style":814,"../histogram/cross_trace_defaults":828,"../histogram/event_data":830,"./attributes":834,"./defaults":836,"./hover":837}],839:[function(d,ee,te){var w=d("../../registry"),v=d("../../lib");ee.exports=function(M,e,a,n){var r=a("x"),t=a("y"),c=v.minRowLength(r),o=v.minRowLength(t);if(!c||!o){e.visible=!1;return}e._length=Math.min(c,o);var i=w.getComponentMethod("calendars","handleTraceDefaults");i(M,e,["x","y"],n);var y=a("z")||a("marker.color");y&&a("histfunc"),a("histnorm"),a("autobinx"),a("autobiny")}},{"../../lib":515,"../../registry":647}],840:[function(d,ee,te){var w=d("../histogram2d/attributes"),v=d("../contour/attributes"),S=d("../../components/colorscale/attributes"),M=d("../../plots/cartesian/axis_format_attributes").axisHoverFormat,e=d("../../lib/extend").extendFlat;ee.exports=e({x:w.x,y:w.y,z:w.z,marker:w.marker,histnorm:w.histnorm,histfunc:w.histfunc,nbinsx:w.nbinsx,xbins:w.xbins,nbinsy:w.nbinsy,ybins:w.ybins,autobinx:w.autobinx,autobiny:w.autobiny,bingroup:w.bingroup,xbingroup:w.xbingroup,ybingroup:w.ybingroup,autocontour:v.autocontour,ncontours:v.ncontours,contours:v.contours,line:{color:v.line.color,width:e({},v.line.width,{dflt:.5}),dash:v.line.dash,smoothing:v.line.smoothing,editType:"plot"},xhoverformat:M("x"),yhoverformat:M("y"),zhoverformat:M("z",1),hovertemplate:w.hovertemplate,texttemplate:v.texttemplate,textfont:v.textfont},S("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/cartesian/axis_format_attributes":569,"../contour/attributes":744,"../histogram2d/attributes":834}],841:[function(d,ee,te){var w=d("../../lib"),v=d("../histogram2d/sample_defaults"),S=d("../contour/contours_defaults"),M=d("../contour/style_defaults"),e=d("../heatmap/label_defaults"),a=d("./attributes");ee.exports=function(r,t,c,o){function i(p,g){return w.coerce(r,t,a,p,g)}function y(p){return w.coerce2(r,t,a,p)}v(r,t,i,o),t.visible!==!1&&(S(r,t,i,y),M(r,t,i,o),i("xhoverformat"),i("yhoverformat"),i("hovertemplate"),t.contours&&t.contours.coloring==="heatmap"&&e(i,o))}},{"../../lib":515,"../contour/contours_defaults":751,"../contour/style_defaults":765,"../heatmap/label_defaults":811,"../histogram2d/sample_defaults":839,"./attributes":840}],842:[function(d,ee,te){ee.exports={attributes:d("./attributes"),supplyDefaults:d("./defaults"),crossTraceDefaults:d("../histogram/cross_trace_defaults"),calc:d("../contour/calc"),plot:d("../contour/plot").plot,layerName:"contourlayer",style:d("../contour/style"),colorbar:d("../contour/colorbar"),hoverPoints:d("../contour/hover"),moduleType:"trace",name:"histogram2dcontour",basePlotModule:d("../../plots/cartesian"),categories:["cartesian","svg","2dMap","contour","histogram","showLegend"],meta:{}}},{"../../plots/cartesian":578,"../contour/calc":745,"../contour/colorbar":747,"../contour/hover":757,"../contour/plot":762,"../contour/style":764,"../histogram/cross_trace_defaults":828,"./attributes":840,"./defaults":841}],843:[function(d,ee,te){var w=d("../../plots/template_attributes").hovertemplateAttrs,v=d("../../plots/template_attributes").texttemplateAttrs,S=d("../../components/colorscale/attributes"),M=d("../../plots/domain").attributes,e=d("../pie/attributes"),a=d("../sunburst/attributes"),n=d("../treemap/attributes"),r=d("../treemap/constants"),t=d("../../lib/extend").extendFlat;ee.exports={labels:a.labels,parents:a.parents,values:a.values,branchvalues:a.branchvalues,count:a.count,level:a.level,maxdepth:a.maxdepth,tiling:{orientation:{valType:"enumerated",values:["v","h"],dflt:"h",editType:"plot"},flip:n.tiling.flip,pad:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"calc"},marker:t({colors:a.marker.colors,line:a.marker.line,editType:"calc"},S("marker",{colorAttr:"colors",anim:!1})),leaf:a.leaf,pathbar:n.pathbar,text:e.text,textinfo:a.textinfo,texttemplate:v({editType:"plot"},{keys:r.eventDataKeys.concat(["label","value"])}),hovertext:e.hovertext,hoverinfo:a.hoverinfo,hovertemplate:w({},{keys:r.eventDataKeys}),textfont:e.textfont,insidetextfont:e.insidetextfont,outsidetextfont:n.outsidetextfont,textposition:n.textposition,sort:e.sort,root:a.root,domain:M({name:"icicle",trace:!0,editType:"calc"})}},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/domain":593,"../../plots/template_attributes":642,"../pie/attributes":910,"../sunburst/attributes":1058,"../treemap/attributes":1084,"../treemap/constants":1087}],844:[function(d,ee,te){var w=d("../../plots/plots");te.name="icicle",te.plot=function(v,S,M,e){w.plotBasePlot(te.name,v,S,M,e)},te.clean=function(v,S,M,e){w.cleanBasePlot(te.name,v,S,M,e)}},{"../../plots/plots":628}],845:[function(d,ee,te){var w=d("../sunburst/calc");te.calc=function(v,S){return w.calc(v,S)},te.crossTraceCalc=function(v){return w._runCrossTraceCalc("icicle",v)}},{"../sunburst/calc":1060}],846:[function(d,ee,te){var w=d("../../lib"),v=d("./attributes"),S=d("../../components/color"),M=d("../../plots/domain").defaults,e=d("../bar/defaults").handleText,a=d("../bar/constants").TEXTPAD,n=d("../../components/colorscale"),r=n.hasColorscale,t=n.handleDefaults;ee.exports=function(o,i,y,p){function g(x,l){return w.coerce(o,i,v,x,l)}var h=g("labels"),m=g("parents");if(!h||!h.length||!m||!m.length){i.visible=!1;return}var u=g("values");u&&u.length?g("branchvalues"):g("count"),g("level"),g("maxdepth"),g("tiling.orientation"),g("tiling.flip"),g("tiling.pad");var _=g("text");g("texttemplate"),i.texttemplate||g("textinfo",Array.isArray(_)?"text+label":"label"),g("hovertext"),g("hovertemplate");var s=g("pathbar.visible"),A="auto";e(o,i,p,g,A,{hasPathbar:s,moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1}),g("textposition");var b=g("marker.line.width");b&&g("marker.line.color",p.paper_bgcolor),g("marker.colors");var f=i._hasColorscale=r(o,"marker","colors")||(o.marker||{}).coloraxis;f&&t(o,i,p,g,{prefix:"marker.",cLetter:"c"}),g("leaf.opacity",f?1:.7),i._hovered={marker:{line:{width:2,color:S.contrast(p.paper_bgcolor)}}},s&&(g("pathbar.thickness",i.pathbar.textfont.size+2*a),g("pathbar.side"),g("pathbar.edgeshape")),g("sort"),g("root.color"),M(i,p,g),i._length=null}},{"../../components/color":367,"../../components/colorscale":379,"../../lib":515,"../../plots/domain":593,"../bar/constants":659,"../bar/defaults":661,"./attributes":843}],847:[function(d,ee,te){var w=d("@plotly/d3"),v=d("../../lib"),S=d("../../components/drawing"),M=d("../../lib/svg_text_utils"),e=d("./partition"),a=d("./style").styleOne,n=d("../treemap/constants"),r=d("../sunburst/helpers"),t=d("../sunburst/fx"),c=d("../sunburst/plot").formatSliceLabel,o=!1;ee.exports=function(y,p,g,h,m){var u=m.width,_=m.height,s=m.viewX,A=m.viewY,b=m.pathSlice,f=m.toMoveInsideSlice,x=m.strTransform,l=m.hasTransition,L=m.handleSlicesExit,T=m.makeUpdateSliceInterpolator,k=m.makeUpdateTextInterpolator,P=m.prevEntry,z={},I=y._fullLayout,D=p[0],R=D.trace,B=R.textposition.indexOf("left")!==-1,F=R.textposition.indexOf("right")!==-1,H=R.textposition.indexOf("bottom")!==-1,G=e(g,[u,_],{flipX:R.tiling.flip.indexOf("x")>-1,flipY:R.tiling.flip.indexOf("y")>-1,orientation:R.tiling.orientation,pad:{inner:R.tiling.pad},maxDepth:R._maxDepth}),J=G.descendants(),X=1/0,Y=-1/0;J.forEach(function(N){var U=N.depth;U>=R._maxDepth?(N.x0=N.x1=(N.x0+N.x1)/2,N.y0=N.y1=(N.y0+N.y1)/2):(X=Math.min(X,U),Y=Math.max(Y,U))}),h=h.data(J,r.getPtId),R._maxVisibleLayers=isFinite(Y)?Y-X+1:0,h.enter().append("g").classed("slice",!0),L(h,o,z,[u,_],b),h.order();var Z=null;if(l&&P){var oe=r.getPtId(P);h.each(function(N){Z===null&&r.getPtId(N)===oe&&(Z={x0:N.x0,x1:N.x1,y0:N.y0,y1:N.y1})})}var re=function(){return Z||{x0:0,x1:u,y0:0,y1:_}},se=h;return l&&(se=se.transition().each("end",function(){var N=w.select(this);r.setSliceCursor(N,y,{hideOnRoot:!0,hideOnLeaves:!1,isTransitioning:!1})})),se.each(function(N){N._x0=s(N.x0),N._x1=s(N.x1),N._y0=A(N.y0),N._y1=A(N.y1),N._hoverX=s(N.x1-R.tiling.pad),N._hoverY=A(H?N.y1-R.tiling.pad/2:N.y0+R.tiling.pad/2);var U=w.select(this),q=v.ensureSingle(U,"path","surface",function(ne){ne.style("pointer-events","all")});l?q.transition().attrTween("d",function(ne){var ae=T(ne,o,re(),[u,_],{orientation:R.tiling.orientation,flipX:R.tiling.flip.indexOf("x")>-1,flipY:R.tiling.flip.indexOf("y")>-1});return function(ie){return b(ae(ie))}}):q.attr("d",b),U.call(t,g,y,p,{styleOne:a,eventDataKeys:n.eventDataKeys,transitionTime:n.CLICK_TRANSITION_TIME,transitionEasing:n.CLICK_TRANSITION_EASING}).call(r.setSliceCursor,y,{isTransitioning:y._transitioning}),q.call(a,N,R,{hovered:!1}),N.x0===N.x1||N.y0===N.y1?N._text="":N._text=c(N,g,R,p,I)||"";var $=v.ensureSingle(U,"g","slicetext"),W=v.ensureSingle($,"text","",function(ne){ne.attr("data-notex",1)}),K=v.ensureUniformFontSize(y,r.determineTextFont(R,N,I.font));W.text(N._text||" ").classed("slicetext",!0).attr("text-anchor",F?"end":B?"start":"middle").call(S.font,K).call(M.convertToTspans,y),N.textBB=S.bBox(W.node()),N.transform=f(N,{fontSize:K.size}),N.transform.fontSize=K.size,l?W.transition().attrTween("transform",function(ne){var ae=k(ne,o,re(),[u,_]);return function(ie){return x(ae(ie))}}):W.attr("transform",x(N))}),Z}},{"../../components/drawing":389,"../../lib":515,"../../lib/svg_text_utils":541,"../sunburst/fx":1063,"../sunburst/helpers":1064,"../sunburst/plot":1068,"../treemap/constants":1087,"./partition":851,"./style":853,"@plotly/d3":58}],848:[function(d,ee,te){ee.exports={moduleType:"trace",name:"icicle",basePlotModule:d("./base_plot"),categories:[],animatable:!0,attributes:d("./attributes"),layoutAttributes:d("./layout_attributes"),supplyDefaults:d("./defaults"),supplyLayoutDefaults:d("./layout_defaults"),calc:d("./calc").calc,crossTraceCalc:d("./calc").crossTraceCalc,plot:d("./plot"),style:d("./style").style,colorbar:d("../scatter/marker_colorbar"),meta:{}}},{"../scatter/marker_colorbar":954,"./attributes":843,"./base_plot":844,"./calc":845,"./defaults":846,"./layout_attributes":849,"./layout_defaults":850,"./plot":852,"./style":853}],849:[function(d,ee,te){ee.exports={iciclecolorway:{valType:"colorlist",editType:"calc"},extendiciclecolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{}],850:[function(d,ee,te){var w=d("../../lib"),v=d("./layout_attributes");ee.exports=function(M,e){function a(n,r){return w.coerce(M,e,v,n,r)}a("iciclecolorway",e.colorway),a("extendiciclecolors")}},{"../../lib":515,"./layout_attributes":849}],851:[function(d,ee,te){var w=d("d3-hierarchy"),v=d("../treemap/flip_tree");ee.exports=function(M,e,a){var n=a.flipX,r=a.flipY,t=a.orientation==="h",c=a.maxDepth,o=e[0],i=e[1];c&&(o=(M.height+1)*e[0]/Math.min(M.height+1,c),i=(M.height+1)*e[1]/Math.min(M.height+1,c));var y=w.partition().padding(a.pad.inner).size(t?[e[1],o]:[e[0],i])(M);return(t||n||r)&&v(y,e,{swapXY:t,flipX:n,flipY:r}),y}},{"../treemap/flip_tree":1092,"d3-hierarchy":115}],852:[function(d,ee,te){var w=d("../treemap/draw"),v=d("./draw_descendants");ee.exports=function(M,e,a,n){return w(M,e,a,n,{type:"icicle",drawDescendants:v})}},{"../treemap/draw":1089,"./draw_descendants":847}],853:[function(d,ee,te){var w=d("@plotly/d3"),v=d("../../components/color"),S=d("../../lib"),M=d("../bar/uniform_text").resizeText;function e(n){var r=n._fullLayout._iciclelayer.selectAll(".trace");M(n,r,"icicle"),r.each(function(t){var c=w.select(this),o=t[0],i=o.trace;c.style("opacity",i.opacity),c.selectAll("path.surface").each(function(y){w.select(this).call(a,y,i)})})}function a(n,r,t){var c=r.data.data,o=!r.children,i=c.i,y=S.castOption(t,i,"marker.line.color")||v.defaultLine,p=S.castOption(t,i,"marker.line.width")||0;n.style("stroke-width",p).call(v.fill,c.color).call(v.stroke,y).style("opacity",o?t.leaf.opacity:null)}ee.exports={style:e,styleOne:a}},{"../../components/color":367,"../../lib":515,"../bar/uniform_text":673,"@plotly/d3":58}],854:[function(d,ee,te){for(var w=d("../../plots/attributes"),v=d("../../plots/template_attributes").hovertemplateAttrs,S=d("../../lib/extend").extendFlat,M=d("./constants").colormodel,e=["rgb","rgba","rgba256","hsl","hsla"],a=[],n=[],r=0;r<e.length;r++){var t=M[e[r]];a.push("For the `"+e[r]+"` colormodel, it is ["+(t.zminDflt||t.min).join(", ")+"]."),n.push("For the `"+e[r]+"` colormodel, it is ["+(t.zmaxDflt||t.max).join(", ")+"].")}ee.exports=S({source:{valType:"string",editType:"calc"},z:{valType:"data_array",editType:"calc"},colormodel:{valType:"enumerated",values:e,editType:"calc"},zsmooth:{valType:"enumerated",values:["fast",!1],dflt:!1,editType:"plot"},zmin:{valType:"info_array",items:[{valType:"number",editType:"calc"},{valType:"number",editType:"calc"},{valType:"number",editType:"calc"},{valType:"number",editType:"calc"}],editType:"calc"},zmax:{valType:"info_array",items:[{valType:"number",editType:"calc"},{valType:"number",editType:"calc"},{valType:"number",editType:"calc"},{valType:"number",editType:"calc"}],editType:"calc"},x0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},y0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},dx:{valType:"number",dflt:1,editType:"calc"},dy:{valType:"number",dflt:1,editType:"calc"},text:{valType:"data_array",editType:"plot"},hovertext:{valType:"data_array",editType:"plot"},hoverinfo:S({},w.hoverinfo,{flags:["x","y","z","color","name","text"],dflt:"x+y+z+text+name"}),hovertemplate:v({},{keys:["z","color","colormodel"]}),transforms:void 0})},{"../../lib/extend":505,"../../plots/attributes":562,"../../plots/template_attributes":642,"./constants":856}],855:[function(d,ee,te){var w=d("../../lib"),v=d("./constants"),S=d("fast-isnumeric"),M=d("../../plots/cartesian/axes"),e=d("../../lib").maxRowLength,a=d("./helpers").getImageSize;ee.exports=function(o,i){var y,p;if(i._hasZ)y=i.z.length,p=e(i.z);else if(i._hasSource){var g=a(i.source);y=g.height,p=g.width}var h=M.getFromId(o,i.xaxis||"x"),m=M.getFromId(o,i.yaxis||"y"),u=h.d2c(i.x0)-i.dx/2,_=m.d2c(i.y0)-i.dy/2,s,A=[u,u+p*i.dx],b=[_,_+y*i.dy];if(h&&h.type==="log")for(s=0;s<p;s++)A.push(u+s*i.dx);if(m&&m.type==="log")for(s=0;s<y;s++)b.push(_+s*i.dy);i._extremes[h._id]=M.findExtremes(h,A),i._extremes[m._id]=M.findExtremes(m,b),i._scaler=t(i);var f={x0:u,y0:_,z:i.z,w:p,h:y};return[f]};function n(c,o,i,y){return function(p){return w.constrain((p-c)*o,i,y)}}function r(c,o){return function(i){return w.constrain(i,c,o)}}function t(c){var o=v.colormodel[c.colormodel],i=o.colormodel||c.colormodel,y=i.length;c._sArray=[];for(var p=0;p<y;p++)o.min[p]!==c.zmin[p]||o.max[p]!==c.zmax[p]?c._sArray.push(n(c.zmin[p],(o.max[p]-o.min[p])/(c.zmax[p]-c.zmin[p]),o.min[p],o.max[p])):c._sArray.push(r(o.min[p],o.max[p]));return function(g){for(var h=g.slice(0,y),m=0;m<y;m++){var u=h[m];if(!S(u))return!1;h[m]=c._sArray[m](u)}return h}}},{"../../lib":515,"../../plots/cartesian/axes":566,"./constants":856,"./helpers":859,"fast-isnumeric":190}],856:[function(d,ee,te){ee.exports={colormodel:{rgb:{min:[0,0,0],max:[255,255,255],fmt:function(w){return w.slice(0,3)},suffix:["","",""]},rgba:{min:[0,0,0,0],max:[255,255,255,1],fmt:function(w){return w.slice(0,4)},suffix:["","","",""]},rgba256:{colormodel:"rgba",zminDflt:[0,0,0,0],zmaxDflt:[255,255,255,255],min:[0,0,0,0],max:[255,255,255,1],fmt:function(w){return w.slice(0,4)},suffix:["","","",""]},hsl:{min:[0,0,0],max:[360,100,100],fmt:function(w){var v=w.slice(0,3);return v[1]=v[1]+"%",v[2]=v[2]+"%",v},suffix:["\xB0","%","%"]},hsla:{min:[0,0,0,0],max:[360,100,100,1],fmt:function(w){var v=w.slice(0,4);return v[1]=v[1]+"%",v[2]=v[2]+"%",v},suffix:["\xB0","%","%",""]}},pixelatedStyle:["image-rendering: optimizeSpeed","image-rendering: -moz-crisp-edges","image-rendering: -o-crisp-edges","image-rendering: -webkit-optimize-contrast","image-rendering: optimize-contrast","image-rendering: crisp-edges","image-rendering: pixelated",""].join("; ")}},{}],857:[function(d,ee,te){var w=d("../../lib"),v=d("./attributes"),S=d("./constants"),M=d("../../snapshot/helpers").IMAGE_URL_PREFIX;ee.exports=function(a,n){function r(o,i){return w.coerce(a,n,v,o,i)}r("source"),n.source&&!n.source.match(M)&&delete n.source,n._hasSource=!!n.source;var t=r("z");if(n._hasZ=!(t===void 0||!t.length||!t[0]||!t[0].length),!n._hasZ&&!n._hasSource){n.visible=!1;return}r("x0"),r("y0"),r("dx"),r("dy");var c;n._hasZ?(r("colormodel","rgb"),c=S.colormodel[n.colormodel],r("zmin",c.zminDflt||c.min),r("zmax",c.zmaxDflt||c.max)):n._hasSource&&(n.colormodel="rgba256",c=S.colormodel[n.colormodel],n.zmin=c.zminDflt,n.zmax=c.zmaxDflt),r("zsmooth"),r("text"),r("hovertext"),r("hovertemplate"),n._length=null}},{"../../lib":515,"../../snapshot/helpers":651,"./attributes":854,"./constants":856}],858:[function(d,ee,te){ee.exports=function(v,S){return"xVal"in S&&(v.x=S.xVal),"yVal"in S&&(v.y=S.yVal),S.xa&&(v.xaxis=S.xa),S.ya&&(v.yaxis=S.ya),v.color=S.color,v.colormodel=S.trace.colormodel,v.z||(v.z=S.color),v}},{}],859:[function(d,ee,te){var w=d("probe-image-size/sync"),v=d("../../snapshot/helpers").IMAGE_URL_PREFIX,S=d("buffer/").Buffer;te.getImageSize=function(M){var e=M.replace(v,""),a=new S(e,"base64");return w(a)}},{"../../snapshot/helpers":651,"buffer/":85,"probe-image-size/sync":277}],860:[function(d,ee,te){var w=d("../../components/fx"),v=d("../../lib"),S=d("./constants");ee.exports=function(e,a,n){var r=e.cd[0],t=r.trace,c=e.xa,o=e.ya;if(!(w.inbox(a-r.x0,a-(r.x0+r.w*t.dx),0)>0||w.inbox(n-r.y0,n-(r.y0+r.h*t.dy),0)>0)){var i=Math.floor((a-r.x0)/t.dx),y=Math.floor(Math.abs(n-r.y0)/t.dy),p;if(t._hasZ?p=r.z[y][i]:t._hasSource&&(p=t._canvas.el.getContext("2d",{willReadFrequently:!0}).getImageData(i,y,1,1).data),!!p){var g=r.hi||t.hoverinfo,h;if(g){var m=g.split("+");m.indexOf("all")!==-1&&(m=["color"]),m.indexOf("color")!==-1&&(h=!0)}var u=S.colormodel[t.colormodel],_=u.colormodel||t.colormodel,s=_.length,A=t._scaler(p),b=u.suffix,f=[];(t.hovertemplate||h)&&(f.push("["+[A[0]+b[0],A[1]+b[1],A[2]+b[2]].join(", ")),s===4&&f.push(", "+A[3]+b[3]),f.push("]"),f=f.join(""),e.extraText=_.toUpperCase()+": "+f);var x;Array.isArray(t.hovertext)&&Array.isArray(t.hovertext[y])?x=t.hovertext[y][i]:Array.isArray(t.text)&&Array.isArray(t.text[y])&&(x=t.text[y][i]);var l=o.c2p(r.y0+(y+.5)*t.dy),L=r.x0+(i+.5)*t.dx,T=r.y0+(y+.5)*t.dy,k="["+p.slice(0,t.colormodel.length).join(", ")+"]";return[v.extendFlat(e,{index:[y,i],x0:c.c2p(r.x0+i*t.dx),x1:c.c2p(r.x0+(i+1)*t.dx),y0:l,y1:l,color:A,xVal:L,xLabelVal:L,yVal:T,yLabelVal:T,zLabelVal:k,text:x,hovertemplateLabels:{zLabel:k,colorLabel:f,"color[0]Label":A[0]+b[0],"color[1]Label":A[1]+b[1],"color[2]Label":A[2]+b[2],"color[3]Label":A[3]+b[3]}})]}}}},{"../../components/fx":407,"../../lib":515,"./constants":856}],861:[function(d,ee,te){ee.exports={attributes:d("./attributes"),supplyDefaults:d("./defaults"),calc:d("./calc"),plot:d("./plot"),style:d("./style"),hoverPoints:d("./hover"),eventData:d("./event_data"),moduleType:"trace",name:"image",basePlotModule:d("../../plots/cartesian"),categories:["cartesian","svg","2dMap","noSortingByValue"],animatable:!1,meta:{}}},{"../../plots/cartesian":578,"./attributes":854,"./calc":855,"./defaults":857,"./event_data":858,"./hover":860,"./plot":862,"./style":863}],862:[function(d,ee,te){var w=d("@plotly/d3"),v=d("../../lib"),S=v.strTranslate,M=d("../../constants/xmlns_namespaces"),e=d("./constants"),a=v.isIOS()||v.isSafari()||v.isIE();ee.exports=function(r,t,c,o){var i=t.xaxis,y=t.yaxis,p=!(a||r._context._exportedPlot);v.makeTraceGroups(o,c,"im").each(function(g){var h=w.select(this),m=g[0],u=m.trace,_=(u.zsmooth==="fast"||u.zsmooth===!1&&p)&&!u._hasZ&&u._hasSource&&i.type==="linear"&&y.type==="linear";u._realImage=_;var s=m.z,A=m.x0,b=m.y0,f=m.w,x=m.h,l=u.dx,L=u.dy,T,k,P,z,I,D;for(D=0;T===void 0&&D<f;)T=i.c2p(A+D*l),D++;for(D=f;k===void 0&&D>0;)k=i.c2p(A+D*l),D--;for(D=0;z===void 0&&D<x;)z=y.c2p(b+D*L),D++;for(D=x;I===void 0&&D>0;)I=y.c2p(b+D*L),D--;if(k<T&&(P=k,k=T,T=P),I<z&&(P=z,z=I,I=P),!_){var R=.5;T=Math.max(-R*i._length,T),k=Math.min((1+R)*i._length,k),z=Math.max(-R*y._length,z),I=Math.min((1+R)*y._length,I)}var B=Math.round(k-T),F=Math.round(I-z),H=B<=0||F<=0;if(H){var G=h.selectAll("image").data([]);G.exit().remove();return}function J($){var W=document.createElement("canvas");W.width=B,W.height=F;var K=W.getContext("2d",{willReadFrequently:!0}),ne=function(Oe){return v.constrain(Math.round(i.c2p(A+Oe*l)-T),0,B)},ae=function(Oe){return v.constrain(Math.round(y.c2p(b+Oe*L)-z),0,F)},ie=e.colormodel[u.colormodel],le=ie.colormodel||u.colormodel,ye=ie.fmt,ue;for(D=0;D<m.w;D++){var pe=ne(D),ge=ne(D+1);if(!(ge===pe||isNaN(ge)||isNaN(pe)))for(var Te=0;Te<m.h;Te++){var _e=ae(Te),ze=ae(Te+1);ze===_e||isNaN(ze)||isNaN(_e)||!$(D,Te)||(ue=u._scaler($(D,Te)),ue?K.fillStyle=le+"("+ye(ue).join(",")+")":K.fillStyle="rgba(0,0,0,0)",K.fillRect(pe,_e,ge-pe,ze-_e))}}return W}var X=h.selectAll("image").data([g]);X.enter().append("svg:image").attr({xmlns:M.svg,preserveAspectRatio:"none"}),X.exit().remove();var Y=u.zsmooth===!1?e.pixelatedStyle:"";if(_){var Z=v.simpleMap(i.range,i.r2l),oe=v.simpleMap(y.range,y.r2l),re=Z[1]<Z[0],se=oe[1]>oe[0];if(re||se){var N=T+B/2,U=z+F/2;Y+="transform:"+S(N+"px",U+"px")+"scale("+(re?-1:1)+","+(se?-1:1)+")"+S(-N+"px",-U+"px")+";"}}X.attr("style",Y);var q=new Promise(function($){if(u._hasZ)$();else if(u._hasSource)if(u._canvas&&u._canvas.el.width===f&&u._canvas.el.height===x&&u._canvas.source===u.source)$();else{var W=document.createElement("canvas");W.width=f,W.height=x;var K=W.getContext("2d",{willReadFrequently:!0});u._image=u._image||new Image;var ne=u._image;ne.onload=function(){K.drawImage(ne,0,0),u._canvas={el:W,source:u.source},$()},ne.setAttribute("src",u.source)}}).then(function(){var $,W;if(u._hasZ)W=J(function(ae,ie){return s[ie][ae]}),$=W.toDataURL("image/png");else if(u._hasSource)if(_)$=u.source;else{var K=u._canvas.el.getContext("2d",{willReadFrequently:!0}),ne=K.getImageData(0,0,f,x).data;W=J(function(ae,ie){var le=4*(ie*f+ae);return[ne[le],ne[le+1],ne[le+2],ne[le+3]]}),$=W.toDataURL("image/png")}X.attr({"xlink:href":$,height:F,width:B,x:T,y:z})});r._promises.push(q)})}},{"../../constants/xmlns_namespaces":492,"../../lib":515,"./constants":856,"@plotly/d3":58}],863:[function(d,ee,te){var w=d("@plotly/d3");ee.exports=function(S){w.select(S).selectAll(".im image").style("opacity",function(M){return M[0].trace.opacity})}},{"@plotly/d3":58}],864:[function(d,ee,te){var w=d("../../lib/extend").extendFlat,v=d("../../lib/extend").extendDeep,S=d("../../plot_api/edit_types").overrideAll,M=d("../../plots/font_attributes"),e=d("../../components/color/attributes"),a=d("../../plots/domain").attributes,n=d("../../plots/cartesian/layout_attributes"),r=d("../../plot_api/plot_template").templatedArray,t=d("../../constants/delta.js"),c=d("../../plots/cartesian/axis_format_attributes").descriptionOnlyNumbers,o=M({editType:"plot",colorEditType:"plot"}),i={color:{valType:"color",editType:"plot"},line:{color:{valType:"color",dflt:e.defaultLine,editType:"plot"},width:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"calc"},thickness:{valType:"number",min:0,max:1,dflt:1,editType:"plot"},editType:"calc"},y={valType:"info_array",items:[{valType:"number",editType:"plot"},{valType:"number",editType:"plot"}],editType:"plot"},p=r("step",v({},i,{range:y}));ee.exports={mode:{valType:"flaglist",editType:"calc",flags:["number","delta","gauge"],dflt:"number"},value:{valType:"number",editType:"calc",anim:!0},align:{valType:"enumerated",values:["left","center","right"],editType:"plot"},domain:a({name:"indicator",trace:!0,editType:"calc"}),title:{text:{valType:"string",editType:"plot"},align:{valType:"enumerated",values:["left","center","right"],editType:"plot"},font:w({},o,{}),editType:"plot"},number:{valueformat:{valType:"string",dflt:"",editType:"plot",description:c("value")},font:w({},o,{}),prefix:{valType:"string",dflt:"",editType:"plot"},suffix:{valType:"string",dflt:"",editType:"plot"},editType:"plot"},delta:{reference:{valType:"number",editType:"calc"},position:{valType:"enumerated",values:["top","bottom","left","right"],dflt:"bottom",editType:"plot"},relative:{valType:"boolean",editType:"plot",dflt:!1},valueformat:{valType:"string",editType:"plot",description:c("value")},increasing:{symbol:{valType:"string",dflt:t.INCREASING.SYMBOL,editType:"plot"},color:{valType:"color",dflt:t.INCREASING.COLOR,editType:"plot"},editType:"plot"},decreasing:{symbol:{valType:"string",dflt:t.DECREASING.SYMBOL,editType:"plot"},color:{valType:"color",dflt:t.DECREASING.COLOR,editType:"plot"},editType:"plot"},font:w({},o,{}),prefix:{valType:"string",dflt:"",editType:"plot"},suffix:{valType:"string",dflt:"",editType:"plot"},editType:"calc"},gauge:{shape:{valType:"enumerated",editType:"plot",dflt:"angular",values:["angular","bullet"]},bar:v({},i,{color:{dflt:"green"}}),bgcolor:{valType:"color",editType:"plot"},bordercolor:{valType:"color",dflt:e.defaultLine,editType:"plot"},borderwidth:{valType:"number",min:0,dflt:1,editType:"plot"},axis:S({range:y,visible:w({},n.visible,{dflt:!0}),tickmode:n.tickmode,nticks:n.nticks,tick0:n.tick0,dtick:n.dtick,tickvals:n.tickvals,ticktext:n.ticktext,ticks:w({},n.ticks,{dflt:"outside"}),ticklen:n.ticklen,tickwidth:n.tickwidth,tickcolor:n.tickcolor,ticklabelstep:n.ticklabelstep,showticklabels:n.showticklabels,tickfont:M({}),tickangle:n.tickangle,tickformat:n.tickformat,tickformatstops:n.tickformatstops,tickprefix:n.tickprefix,showtickprefix:n.showtickprefix,ticksuffix:n.ticksuffix,showticksuffix:n.showticksuffix,separatethousands:n.separatethousands,exponentformat:n.exponentformat,minexponent:n.minexponent,showexponent:n.showexponent,editType:"plot"},"plot"),steps:p,threshold:{line:{color:w({},i.line.color,{}),width:w({},i.line.width,{dflt:1}),editType:"plot"},thickness:w({},i.thickness,{dflt:.85}),value:{valType:"number",editType:"calc",dflt:!1},editType:"plot"},editType:"plot"}}},{"../../components/color/attributes":366,"../../constants/delta.js":485,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plot_api/plot_template":555,"../../plots/cartesian/axis_format_attributes":569,"../../plots/cartesian/layout_attributes":579,"../../plots/domain":593,"../../plots/font_attributes":594}],865:[function(d,ee,te){var w=d("../../plots/plots");te.name="indicator",te.plot=function(v,S,M,e){w.plotBasePlot(te.name,v,S,M,e)},te.clean=function(v,S,M,e){w.cleanBasePlot(te.name,v,S,M,e)}},{"../../plots/plots":628}],866:[function(d,ee,te){function w(v,S){var M=[],e=S.value;typeof S._lastValue!="number"&&(S._lastValue=S.value);var a=S._lastValue,n=a;return S._hasDelta&&typeof S.delta.reference=="number"&&(n=S.delta.reference),M[0]={y:e,lastY:a,delta:e-n,relativeDelta:(e-n)/n},M}ee.exports={calc:w}},{}],867:[function(d,ee,te){ee.exports={defaultNumberFontSize:80,bulletNumberDomainSize:.25,bulletPadding:.025,innerRadius:.75,valueThickness:.5,titlePadding:5,horizontalPadding:10}},{}],868:[function(d,ee,te){var w=d("../../lib"),v=d("./attributes"),S=d("../../plots/domain").defaults,M=d("../../plot_api/plot_template"),e=d("../../plots/array_container_defaults"),a=d("./constants.js"),n=d("../../plots/cartesian/tick_value_defaults"),r=d("../../plots/cartesian/tick_mark_defaults"),t=d("../../plots/cartesian/tick_label_defaults"),c=d("../../plots/cartesian/prefix_suffix_defaults");function o(y,p,g,h){function m(D,R){return w.coerce(y,p,v,D,R)}S(p,h,m),m("mode"),p._hasNumber=p.mode.indexOf("number")!==-1,p._hasDelta=p.mode.indexOf("delta")!==-1,p._hasGauge=p.mode.indexOf("gauge")!==-1;var u=m("value");p._range=[0,typeof u=="number"?1.5*u:1];var _=new Array(2),s;p._hasNumber&&(m("number.valueformat"),m("number.font.color",h.font.color),m("number.font.family",h.font.family),m("number.font.size"),p.number.font.size===void 0&&(p.number.font.size=a.defaultNumberFontSize,_[0]=!0),m("number.prefix"),m("number.suffix"),s=p.number.font.size);var A;p._hasDelta&&(m("delta.font.color",h.font.color),m("delta.font.family",h.font.family),m("delta.font.size"),p.delta.font.size===void 0&&(p.delta.font.size=(p._hasNumber?.5:1)*(s||a.defaultNumberFontSize),_[1]=!0),m("delta.reference",p.value),m("delta.relative"),m("delta.valueformat",p.delta.relative?"2%":""),m("delta.increasing.symbol"),m("delta.increasing.color"),m("delta.decreasing.symbol"),m("delta.decreasing.color"),m("delta.position"),m("delta.prefix"),m("delta.suffix"),A=p.delta.font.size),p._scaleNumbers=(!p._hasNumber||_[0])&&(!p._hasDelta||_[1])||!1,m("title.font.color",h.font.color),m("title.font.family",h.font.family),m("title.font.size",.25*(s||A||a.defaultNumberFontSize)),m("title.text");var b,f,x,l;function L(D,R){return w.coerce(b,f,v.gauge,D,R)}function T(D,R){return w.coerce(x,l,v.gauge.axis,D,R)}if(p._hasGauge){b=y.gauge,b||(b={}),f=M.newContainer(p,"gauge"),L("shape");var k=p._isBullet=p.gauge.shape==="bullet";k||m("title.align","center");var P=p._isAngular=p.gauge.shape==="angular";P||m("align","center"),L("bgcolor",h.paper_bgcolor),L("borderwidth"),L("bordercolor"),L("bar.color"),L("bar.line.color"),L("bar.line.width");var z=a.valueThickness*(p.gauge.shape==="bullet"?.5:1);L("bar.thickness",z),e(b,f,{name:"steps",handleItemDefaults:i}),L("threshold.value"),L("threshold.thickness"),L("threshold.line.width"),L("threshold.line.color"),x={},b&&(x=b.axis||{}),l=M.newContainer(f,"axis"),T("visible"),p._range=T("range",p._range);var I={outerTicks:!0};n(x,l,T,"linear"),c(x,l,T,"linear",I),t(x,l,T,"linear",I),r(x,l,T,I)}else m("title.align","center"),m("align","center"),p._isAngular=p._isBullet=!1;p._length=null}function i(y,p){function g(h,m){return w.coerce(y,p,v.gauge.steps,h,m)}g("color"),g("line.color"),g("line.width"),g("range"),g("thickness")}ee.exports={supplyDefaults:o}},{"../../lib":515,"../../plot_api/plot_template":555,"../../plots/array_container_defaults":561,"../../plots/cartesian/prefix_suffix_defaults":583,"../../plots/cartesian/tick_label_defaults":587,"../../plots/cartesian/tick_mark_defaults":588,"../../plots/cartesian/tick_value_defaults":589,"../../plots/domain":593,"./attributes":864,"./constants.js":867}],869:[function(d,ee,te){ee.exports={moduleType:"trace",name:"indicator",basePlotModule:d("./base_plot"),categories:["svg","noOpacity","noHover"],animatable:!0,attributes:d("./attributes"),supplyDefaults:d("./defaults").supplyDefaults,calc:d("./calc").calc,plot:d("./plot"),meta:{}}},{"./attributes":864,"./base_plot":865,"./calc":866,"./defaults":868,"./plot":870}],870:[function(d,ee,te){var w=d("@plotly/d3"),v=d("d3-interpolate").interpolate,S=d("d3-interpolate").interpolateNumber,M=d("../../lib"),e=M.strScale,a=M.strTranslate,n=M.rad2deg,r=d("../../constants/alignment").MID_SHIFT,t=d("../../components/drawing"),c=d("./constants"),o=d("../../lib/svg_text_utils"),i=d("../../plots/cartesian/axes"),y=d("../../plots/cartesian/axis_defaults"),p=d("../../plots/cartesian/position_defaults"),g=d("../../plots/cartesian/layout_attributes"),h=d("../../components/color"),m={left:"start",center:"middle",right:"end"},u={left:0,center:.5,right:1},_=/[yzafpnmkMGTPEZY]/;function s(I){return I&&I.duration>0}ee.exports=function(D,R,B,F){var H=D._fullLayout,G;s(B)&&F&&(G=F()),M.makeTraceGroups(H._indicatorlayer,R,"trace").each(function(J){var X=J[0],Y=X.trace,Z=w.select(this),oe=Y._hasGauge,re=Y._isAngular,se=Y._isBullet,N=Y.domain,U={w:H._size.w*(N.x[1]-N.x[0]),h:H._size.h*(N.y[1]-N.y[0]),l:H._size.l+H._size.w*N.x[0],r:H._size.r+H._size.w*(1-N.x[1]),t:H._size.t+H._size.h*(1-N.y[1]),b:H._size.b+H._size.h*N.y[0]},q=U.l+U.w/2,$=U.t+U.h/2,W=Math.min(U.w/2,U.h),K=c.innerRadius*W,ne,ae,ie,le=Y.align||"center";if(ae=$,!oe)ne=U.l+u[le]*U.w,ie=function(be){return T(be,U.w,U.h)};else if(re&&(ne=q,ae=$+W/2,ie=function(be){return k(be,.9*K)}),se){var ye=c.bulletPadding,ue=1-c.bulletNumberDomainSize+ye;ne=U.l+(ue+(1-ue)*u[le])*U.w,ie=function(be){return T(be,(c.bulletNumberDomainSize-ye)*U.w,U.h)}}f(D,Z,J,{numbersX:ne,numbersY:ae,numbersScaler:ie,transitionOpts:B,onComplete:G});var pe,ge;oe&&(pe={range:Y.gauge.axis.range,color:Y.gauge.bgcolor,line:{color:Y.gauge.bordercolor,width:0},thickness:1},ge={range:Y.gauge.axis.range,color:"rgba(0, 0, 0, 0)",line:{color:Y.gauge.bordercolor,width:Y.gauge.borderwidth},thickness:1});var Te=Z.selectAll("g.angular").data(re?J:[]);Te.exit().remove();var _e=Z.selectAll("g.angularaxis").data(re?J:[]);_e.exit().remove(),re&&b(D,Z,J,{radius:W,innerRadius:K,gauge:Te,layer:_e,size:U,gaugeBg:pe,gaugeOutline:ge,transitionOpts:B,onComplete:G});var ze=Z.selectAll("g.bullet").data(se?J:[]);ze.exit().remove();var Oe=Z.selectAll("g.bulletaxis").data(se?J:[]);Oe.exit().remove(),se&&A(D,Z,J,{gauge:ze,layer:Oe,size:U,gaugeBg:pe,gaugeOutline:ge,transitionOpts:B,onComplete:G});var Ye=Z.selectAll("text.title").data(J);Ye.exit().remove(),Ye.enter().append("text").classed("title",!0),Ye.attr("text-anchor",function(){return se?m.right:m[Y.title.align]}).text(Y.title.text).call(t.font,Y.title.font).call(o.convertToTspans,D),Ye.attr("transform",function(){var be=U.l+U.w*u[Y.title.align],Pe,Ge=c.titlePadding,Qe=t.bBox(Ye.node());if(oe){if(re)if(Y.gauge.axis.visible){var Be=t.bBox(_e.node());Pe=Be.top-Ge-Qe.bottom}else Pe=U.t+U.h/2-W/2-Qe.bottom-Ge;se&&(Pe=ae-(Qe.top+Qe.bottom)/2,be=U.l-c.bulletPadding*U.w)}else Pe=Y._numbersTop-Ge-Qe.bottom;return a(be,Pe)})})};function A(I,D,R,B){var F=R[0].trace,H=B.gauge,G=B.layer,J=B.gaugeBg,X=B.gaugeOutline,Y=B.size,Z=F.domain,oe=B.transitionOpts,re=B.onComplete,se,N,U,q,$;H.enter().append("g").classed("bullet",!0),H.attr("transform",a(Y.l,Y.t)),G.enter().append("g").classed("bulletaxis",!0).classed("crisp",!0),G.selectAll("g.xbulletaxistick,path,text").remove();var W=Y.h,K=F.gauge.bar.thickness*W,ne=Z.x[0],ae=Z.x[0]+(Z.x[1]-Z.x[0])*(F._hasNumber||F._hasDelta?1-c.bulletNumberDomainSize:1);se=L(I,F.gauge.axis),se._id="xbulletaxis",se.domain=[ne,ae],se.setScale(),N=i.calcTicks(se),U=i.makeTransTickFn(se),q=i.getTickSigns(se)[2],$=Y.t+Y.h,se.visible&&(i.drawTicks(I,se,{vals:se.ticks==="inside"?i.clipEnds(se,N):N,layer:G,path:i.makeTickPath(se,$,q),transFn:U}),i.drawLabels(I,se,{vals:N,layer:G,transFn:U,labelFns:i.makeLabelFns(se,$)}));function ie(_e){_e.attr("width",function(ze){return Math.max(0,se.c2p(ze.range[1])-se.c2p(ze.range[0]))}).attr("x",function(ze){return se.c2p(ze.range[0])}).attr("y",function(ze){return .5*(1-ze.thickness)*W}).attr("height",function(ze){return ze.thickness*W})}var le=[J].concat(F.gauge.steps),ye=H.selectAll("g.bg-bullet").data(le);ye.enter().append("g").classed("bg-bullet",!0).append("rect"),ye.select("rect").call(ie).call(x),ye.exit().remove();var ue=H.selectAll("g.value-bullet").data([F.gauge.bar]);ue.enter().append("g").classed("value-bullet",!0).append("rect"),ue.select("rect").attr("height",K).attr("y",(W-K)/2).call(x),s(oe)?ue.select("rect").transition().duration(oe.duration).ease(oe.easing).each("end",function(){re&&re()}).each("interrupt",function(){re&&re()}).attr("width",Math.max(0,se.c2p(Math.min(F.gauge.axis.range[1],R[0].y)))):ue.select("rect").attr("width",typeof R[0].y=="number"?Math.max(0,se.c2p(Math.min(F.gauge.axis.range[1],R[0].y))):0),ue.exit().remove();var pe=R.filter(function(){return F.gauge.threshold.value||F.gauge.threshold.value===0}),ge=H.selectAll("g.threshold-bullet").data(pe);ge.enter().append("g").classed("threshold-bullet",!0).append("line"),ge.select("line").attr("x1",se.c2p(F.gauge.threshold.value)).attr("x2",se.c2p(F.gauge.threshold.value)).attr("y1",(1-F.gauge.threshold.thickness)/2*W).attr("y2",(1-(1-F.gauge.threshold.thickness)/2)*W).call(h.stroke,F.gauge.threshold.line.color).style("stroke-width",F.gauge.threshold.line.width),ge.exit().remove();var Te=H.selectAll("g.gauge-outline").data([X]);Te.enter().append("g").classed("gauge-outline",!0).append("rect"),Te.select("rect").call(ie).call(x),Te.exit().remove()}function b(I,D,R,B){var F=R[0].trace,H=B.size,G=B.radius,J=B.innerRadius,X=B.gaugeBg,Y=B.gaugeOutline,Z=[H.l+H.w/2,H.t+H.h/2+G/2],oe=B.gauge,re=B.layer,se=B.transitionOpts,N=B.onComplete,U=Math.PI/2;function q(Le){var He=F.gauge.axis.range[0],vt=F.gauge.axis.range[1],Rt=(Le-He)/(vt-He)*Math.PI-U;return Rt<-U?-U:Rt>U?U:Rt}function $(Le){return w.svg.arc().innerRadius((J+G)/2-Le/2*(G-J)).outerRadius((J+G)/2+Le/2*(G-J)).startAngle(-U)}function W(Le){Le.attr("d",function(He){return $(He.thickness).startAngle(q(He.range[0])).endAngle(q(He.range[1]))()})}var K,ne,ae,ie;oe.enter().append("g").classed("angular",!0),oe.attr("transform",a(Z[0],Z[1])),re.enter().append("g").classed("angularaxis",!0).classed("crisp",!0),re.selectAll("g.xangularaxistick,path,text").remove(),K=L(I,F.gauge.axis),K.type="linear",K.range=F.gauge.axis.range,K._id="xangularaxis",K.ticklabeloverflow="allow",K.setScale();var le=function(Le){return(K.range[0]-Le.x)/(K.range[1]-K.range[0])*Math.PI+Math.PI},ye={},ue=i.makeLabelFns(K,0),pe=ue.labelStandoff;ye.xFn=function(Le){var He=le(Le);return Math.cos(He)*pe},ye.yFn=function(Le){var He=le(Le),vt=Math.sin(He)>0?.2:1;return-Math.sin(He)*(pe+Le.fontSize*vt)+Math.abs(Math.cos(He))*(Le.fontSize*r)},ye.anchorFn=function(Le){var He=le(Le),vt=Math.cos(He);return Math.abs(vt)<.1?"middle":vt>0?"start":"end"},ye.heightFn=function(Le,He,vt){var Rt=le(Le);return-.5*(1+Math.sin(Rt))*vt};var ge=function(Le){return a(Z[0]+G*Math.cos(Le),Z[1]-G*Math.sin(Le))};ae=function(Le){return ge(le(Le))};var Te=function(Le){var He=le(Le);return ge(He)+"rotate("+-n(He)+")"};if(ne=i.calcTicks(K),ie=i.getTickSigns(K)[2],K.visible){ie=K.ticks==="inside"?-1:1;var _e=(K.linewidth||1)/2;i.drawTicks(I,K,{vals:ne,layer:re,path:"M"+ie*_e+",0h"+ie*K.ticklen,transFn:Te}),i.drawLabels(I,K,{vals:ne,layer:re,transFn:ae,labelFns:ye})}var ze=[X].concat(F.gauge.steps),Oe=oe.selectAll("g.bg-arc").data(ze);Oe.enter().append("g").classed("bg-arc",!0).append("path"),Oe.select("path").call(W).call(x),Oe.exit().remove();var Ye=$(F.gauge.bar.thickness),be=oe.selectAll("g.value-arc").data([F.gauge.bar]);be.enter().append("g").classed("value-arc",!0).append("path");var Pe=be.select("path");s(se)?(Pe.transition().duration(se.duration).ease(se.easing).each("end",function(){N&&N()}).each("interrupt",function(){N&&N()}).attrTween("d",l(Ye,q(R[0].lastY),q(R[0].y))),F._lastValue=R[0].y):Pe.attr("d",typeof R[0].y=="number"?Ye.endAngle(q(R[0].y)):"M0,0Z"),Pe.call(x),be.exit().remove(),ze=[];var Ge=F.gauge.threshold.value;(Ge||Ge===0)&&ze.push({range:[Ge,Ge],color:F.gauge.threshold.color,line:{color:F.gauge.threshold.line.color,width:F.gauge.threshold.line.width},thickness:F.gauge.threshold.thickness});var Qe=oe.selectAll("g.threshold-arc").data(ze);Qe.enter().append("g").classed("threshold-arc",!0).append("path"),Qe.select("path").call(W).call(x),Qe.exit().remove();var Be=oe.selectAll("g.gauge-outline").data([Y]);Be.enter().append("g").classed("gauge-outline",!0).append("path"),Be.select("path").call(W).call(x),Be.exit().remove()}function f(I,D,R,B){var F=R[0].trace,H=B.numbersX,G=B.numbersY,J=F.align||"center",X=m[J],Y=B.transitionOpts,Z=B.onComplete,oe=M.ensureSingle(D,"g","numbers"),re,se,N,U=[];F._hasNumber&&U.push("number"),F._hasDelta&&(U.push("delta"),F.delta.position==="left"&&U.reverse());var q=oe.selectAll("text").data(U);q.enter().append("text"),q.attr("text-anchor",function(){return X}).attr("class",function(ge){return ge}).attr("x",null).attr("y",null).attr("dx",null).attr("dy",null),q.exit().remove();function $(ge,Te,_e,ze){if(ge.match("s")&&_e>=0!=ze>=0&&!Te(_e).slice(-1).match(_)&&!Te(ze).slice(-1).match(_)){var Oe=ge.slice().replace("s","f").replace(/\d+/,function(be){return parseInt(be)-1}),Ye=L(I,{tickformat:Oe});return function(be){return Math.abs(be)<1?i.tickText(Ye,be).text:Te(be)}}else return Te}function W(){var ge=L(I,{tickformat:F.number.valueformat},F._range);ge.setScale(),i.prepTicks(ge);var Te=function(be){return i.tickText(ge,be).text},_e=F.number.suffix,ze=F.number.prefix,Oe=oe.select("text.number");function Ye(){var be=typeof R[0].y=="number"?ze+Te(R[0].y)+_e:"-";Oe.text(be).call(t.font,F.number.font).call(o.convertToTspans,I)}return s(Y)?Oe.transition().duration(Y.duration).ease(Y.easing).each("end",function(){Ye(),Z&&Z()}).each("interrupt",function(){Ye(),Z&&Z()}).attrTween("text",function(){var be=w.select(this),Pe=S(R[0].lastY,R[0].y);F._lastValue=R[0].y;var Ge=$(F.number.valueformat,Te,R[0].lastY,R[0].y);return function(Qe){be.text(ze+Ge(Pe(Qe))+_e)}}):Ye(),re=P(ze+Te(R[0].y)+_e,F.number.font,X,I),Oe}function K(){var ge=L(I,{tickformat:F.delta.valueformat},F._range);ge.setScale(),i.prepTicks(ge);var Te=function(Qe){return i.tickText(ge,Qe).text},_e=F.delta.suffix,ze=F.delta.prefix,Oe=function(Qe){var Be=F.delta.relative?Qe.relativeDelta:Qe.delta;return Be},Ye=function(Qe,Be){return Qe===0||typeof Qe!="number"||isNaN(Qe)?"-":(Qe>0?F.delta.increasing.symbol:F.delta.decreasing.symbol)+ze+Be(Qe)+_e},be=function(Qe){return Qe.delta>=0?F.delta.increasing.color:F.delta.decreasing.color};F._deltaLastValue===void 0&&(F._deltaLastValue=Oe(R[0]));var Pe=oe.select("text.delta");Pe.call(t.font,F.delta.font).call(h.fill,be({delta:F._deltaLastValue}));function Ge(){Pe.text(Ye(Oe(R[0]),Te)).call(h.fill,be(R[0])).call(o.convertToTspans,I)}return s(Y)?Pe.transition().duration(Y.duration).ease(Y.easing).tween("text",function(){var Qe=w.select(this),Be=Oe(R[0]),Le=F._deltaLastValue,He=$(F.delta.valueformat,Te,Le,Be),vt=S(Le,Be);return F._deltaLastValue=Be,function(Rt){Qe.text(Ye(vt(Rt),He)),Qe.call(h.fill,be({delta:vt(Rt)}))}}).each("end",function(){Ge(),Z&&Z()}).each("interrupt",function(){Ge(),Z&&Z()}):Ge(),se=P(Ye(Oe(R[0]),Te),F.delta.font,X,I),Pe}var ne=F.mode+F.align,ae;if(F._hasDelta&&(ae=K(),ne+=F.delta.position+F.delta.font.size+F.delta.font.family+F.delta.valueformat,ne+=F.delta.increasing.symbol+F.delta.decreasing.symbol,N=se),F._hasNumber&&(W(),ne+=F.number.font.size+F.number.font.family+F.number.valueformat+F.number.suffix+F.number.prefix,N=re),F._hasDelta&&F._hasNumber){var ie=[(re.left+re.right)/2,(re.top+re.bottom)/2],le=[(se.left+se.right)/2,(se.top+se.bottom)/2],ye,ue,pe=.75*F.delta.font.size;F.delta.position==="left"&&(ye=z(F,"deltaPos",0,-1*(re.width*u[F.align]+se.width*(1-u[F.align])+pe),ne,Math.min),ue=ie[1]-le[1],N={width:re.width+se.width+pe,height:Math.max(re.height,se.height),left:se.left+ye,right:re.right,top:Math.min(re.top,se.top+ue),bottom:Math.max(re.bottom,se.bottom+ue)}),F.delta.position==="right"&&(ye=z(F,"deltaPos",0,re.width*(1-u[F.align])+se.width*u[F.align]+pe,ne,Math.max),ue=ie[1]-le[1],N={width:re.width+se.width+pe,height:Math.max(re.height,se.height),left:re.left,right:se.right+ye,top:Math.min(re.top,se.top+ue),bottom:Math.max(re.bottom,se.bottom+ue)}),F.delta.position==="bottom"&&(ye=null,ue=se.height,N={width:Math.max(re.width,se.width),height:re.height+se.height,left:Math.min(re.left,se.left),right:Math.max(re.right,se.right),top:re.bottom-re.height,bottom:re.bottom+se.height}),F.delta.position==="top"&&(ye=null,ue=re.top,N={width:Math.max(re.width,se.width),height:re.height+se.height,left:Math.min(re.left,se.left),right:Math.max(re.right,se.right),top:re.bottom-re.height-se.height,bottom:re.bottom}),ae.attr({dx:ye,dy:ue})}(F._hasNumber||F._hasDelta)&&oe.attr("transform",function(){var ge=B.numbersScaler(N);ne+=ge[2];var Te=z(F,"numbersScale",1,ge[0],ne,Math.min),_e;F._scaleNumbers||(Te=1),F._isAngular?_e=G-Te*N.bottom:_e=G-Te*(N.top+N.bottom)/2,F._numbersTop=Te*N.top+_e;var ze=N[J];J==="center"&&(ze=(N.left+N.right)/2);var Oe=H-Te*ze;return Oe=z(F,"numbersTranslate",0,Oe,ne,Math.max),a(Oe,_e)+e(Te)})}function x(I){I.each(function(D){h.stroke(w.select(this),D.line.color)}).each(function(D){h.fill(w.select(this),D.color)}).style("stroke-width",function(D){return D.line.width})}function l(I,D,R){return function(){var B=v(D,R);return function(F){return I.endAngle(B(F))()}}}function L(I,D,R){var B=I._fullLayout,F=M.extendFlat({type:"linear",ticks:"outside",range:R,showline:!0},D),H={type:"linear",_id:"x"+D._id},G={letter:"x",font:B.font,noHover:!0,noTickson:!0};function J(X,Y){return M.coerce(F,H,g,X,Y)}return y(F,H,J,G,B),p(F,H,J,G),H}function T(I,D,R){var B=Math.min(D/I.width,R/I.height);return[B,I,D+"x"+R]}function k(I,D){var R=Math.sqrt(I.width/2*(I.width/2)+I.height*I.height),B=D/R;return[B,I,D]}function P(I,D,R,B){var F=document.createElementNS("http://www.w3.org/2000/svg","text"),H=w.select(F);return H.text(I).attr("x",0).attr("y",0).attr("text-anchor",R).attr("data-unformatted",I).call(o.convertToTspans,B).call(t.font,D),t.bBox(H.node())}function z(I,D,R,B,F,H){var G="_cache"+D;I[G]&&I[G].key===F||(I[G]={key:F,value:R});var J=M.aggNums(H,null,[I[G].value,B],2);return I[G].value=J,J}},{"../../components/color":367,"../../components/drawing":389,"../../constants/alignment":483,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/cartesian/axes":566,"../../plots/cartesian/axis_defaults":568,"../../plots/cartesian/layout_attributes":579,"../../plots/cartesian/position_defaults":582,"./constants":867,"@plotly/d3":58,"d3-interpolate":116}],871:[function(d,ee,te){var w=d("../../components/colorscale/attributes"),v=d("../../plots/cartesian/axis_format_attributes").axisHoverFormat,S=d("../../plots/template_attributes").hovertemplateAttrs,M=d("../mesh3d/attributes"),e=d("../../plots/attributes"),a=d("../../lib/extend").extendFlat,n=d("../../plot_api/edit_types").overrideAll;function r(o){return{show:{valType:"boolean",dflt:!1},locations:{valType:"data_array",dflt:[]},fill:{valType:"number",min:0,max:1,dflt:1}}}function t(o){return{show:{valType:"boolean",dflt:!0},fill:{valType:"number",min:0,max:1,dflt:1}}}var c=ee.exports=n(a({x:{valType:"data_array"},y:{valType:"data_array"},z:{valType:"data_array"},value:{valType:"data_array"},isomin:{valType:"number"},isomax:{valType:"number"},surface:{show:{valType:"boolean",dflt:!0},count:{valType:"integer",dflt:2,min:1},fill:{valType:"number",min:0,max:1,dflt:1},pattern:{valType:"flaglist",flags:["A","B","C","D","E"],extras:["all","odd","even"],dflt:"all"}},spaceframe:{show:{valType:"boolean",dflt:!1},fill:{valType:"number",min:0,max:1,dflt:.15}},slices:{x:r(),y:r(),z:r()},caps:{x:t(),y:t(),z:t()},text:{valType:"string",dflt:"",arrayOk:!0},hovertext:{valType:"string",dflt:"",arrayOk:!0},hovertemplate:S(),xhoverformat:v("x"),yhoverformat:v("y"),zhoverformat:v("z"),valuehoverformat:v("value",1),showlegend:a({},e.showlegend,{dflt:!1})},w("",{colorAttr:"`value`",showScaleDflt:!0,editTypeOverride:"calc"}),{opacity:M.opacity,lightposition:M.lightposition,lighting:M.lighting,flatshading:M.flatshading,contour:M.contour,hoverinfo:a({},e.hoverinfo)}),"calc","nested");c.flatshading.dflt=!0,c.lighting.facenormalsepsilon.dflt=0,c.x.editType=c.y.editType=c.z.editType=c.value.editType="calc+clearAxisTypes",c.transforms=void 0},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../mesh3d/attributes":876}],872:[function(d,ee,te){var w=d("../../components/colorscale/calc"),v=d("../streamtube/calc").processGrid,S=d("../streamtube/calc").filter;ee.exports=function(e,a){a._len=Math.min(a.x.length,a.y.length,a.z.length,a.value.length),a._x=S(a.x,a._len),a._y=S(a.y,a._len),a._z=S(a.z,a._len),a._value=S(a.value,a._len);var n=v(a);a._gridFill=n.fill,a._Xs=n.Xs,a._Ys=n.Ys,a._Zs=n.Zs,a._len=n.len;for(var r=1/0,t=-1/0,c=0;c<a._len;c++){var o=a._value[c];r=Math.min(r,o),t=Math.max(t,o)}a._minValues=r,a._maxValues=t,a._vMin=a.isomin===void 0||a.isomin===null?r:a.isomin,a._vMax=a.isomax===void 0||a.isomin===null?t:a.isomax,w(e,a,{vals:[a._vMin,a._vMax],containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":375,"../streamtube/calc":1054}],873:[function(d,ee,te){var w=d("../../../stackgl_modules").gl_mesh3d,v=d("../../lib/gl_format_color").parseColorScale,S=d("../../lib/str2rgbarray"),M=d("../../components/colorscale").extractOpts,e=d("../../plots/gl3d/zip3"),a=function(i,y){for(var p=y.length-1;p>0;p--){var g=Math.min(y[p],y[p-1]),h=Math.max(y[p],y[p-1]);if(h>g&&g<i&&i<=h)return{id:p,distRatio:(h-i)/(h-g)}}return{id:0,distRatio:0}};function n(i,y,p){this.scene=i,this.uid=p,this.mesh=y,this.name="",this.data=null,this.showContour=!1}var r=n.prototype;r.handlePick=function(i){if(i.object===this.mesh){var y=i.data.index,p=this.data._meshX[y],g=this.data._meshY[y],h=this.data._meshZ[y],m=this.data._Ys.length,u=this.data._Zs.length,_=a(p,this.data._Xs).id,s=a(g,this.data._Ys).id,A=a(h,this.data._Zs).id,b=i.index=A+u*s+u*m*_;i.traceCoordinate=[this.data._meshX[b],this.data._meshY[b],this.data._meshZ[b],this.data._value[b]];var f=this.data.hovertext||this.data.text;return Array.isArray(f)&&f[b]!==void 0?i.textLabel=f[b]:f&&(i.textLabel=f),!0}},r.update=function(i){var y=this.scene,p=y.fullSceneLayout;this.data=c(i);function g(s,A,b,f){return A.map(function(x){return s.d2l(x,0,f)*b})}var h=e(g(p.xaxis,i._meshX,y.dataScale[0],i.xcalendar),g(p.yaxis,i._meshY,y.dataScale[1],i.ycalendar),g(p.zaxis,i._meshZ,y.dataScale[2],i.zcalendar)),m=e(i._meshI,i._meshJ,i._meshK),u={positions:h,cells:m,lightPosition:[i.lightposition.x,i.lightposition.y,i.lightposition.z],ambient:i.lighting.ambient,diffuse:i.lighting.diffuse,specular:i.lighting.specular,roughness:i.lighting.roughness,fresnel:i.lighting.fresnel,vertexNormalsEpsilon:i.lighting.vertexnormalsepsilon,faceNormalsEpsilon:i.lighting.facenormalsepsilon,opacity:i.opacity,contourEnable:i.contour.show,contourColor:S(i.contour.color).slice(0,3),contourWidth:i.contour.width,useFacetNormals:i.flatshading},_=M(i);u.vertexIntensity=i._meshIntensity,u.vertexIntensityBounds=[_.min,_.max],u.colormap=v(i),this.mesh.update(u)},r.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()};var t=["xyz","xzy","yxz","yzx","zxy","zyx"];function c(i){i._meshI=[],i._meshJ=[],i._meshK=[];var y=i.surface.show,p=i.spaceframe.show,g=i.surface.fill,h=i.spaceframe.fill,m=!1,u=!1,_=0,s,A,b=i._Xs,f=i._Ys,x=i._Zs,l=b.length,L=f.length,T=x.length,k=t.indexOf(i._gridFill.replace(/-/g,"").replace(/\+/g,"")),P=function(Dt,kt,Ue){switch(k){case 5:return Ue+T*kt+T*L*Dt;case 4:return Ue+T*Dt+T*l*kt;case 3:return kt+L*Ue+L*T*Dt;case 2:return kt+L*Dt+L*l*Ue;case 1:return Dt+l*Ue+l*T*kt;default:return Dt+l*kt+l*L*Ue}},z=i._minValues,I=i._maxValues,D=i._vMin,R=i._vMax,B,F,H,G;function J(Dt,kt,Ue){for(var qe=G.length,Ve=A;Ve<qe;Ve++)if(Dt===B[Ve]&&kt===F[Ve]&&Ue===H[Ve])return Ve;return-1}function X(){A=s}function Y(){B=[],F=[],H=[],G=[],s=0,X()}function Z(Dt,kt,Ue,qe){return B.push(Dt),F.push(kt),H.push(Ue),G.push(qe),s++,s-1}function oe(Dt,kt,Ue){return i._meshI.push(Dt),i._meshJ.push(kt),i._meshK.push(Ue),_++,_-1}function re(Dt,kt,Ue){for(var qe=[],Ve=0;Ve<Dt.length;Ve++)qe[Ve]=(Dt[Ve]+kt[Ve]+Ue[Ve])/3;return qe}function se(Dt,kt,Ue){for(var qe=[],Ve=0;Ve<Dt.length;Ve++)qe[Ve]=Dt[Ve]*(1-Ue)+Ue*kt[Ve];return qe}var N;function U(Dt){N=Dt}function q(Dt,kt){var Ue=Dt[0],qe=Dt[1],Ve=Dt[2],Ae=re(Ue,qe,Ve),Ne=Math.sqrt(1-N),Xe=se(Ae,Ue,Ne),Je=se(Ae,qe,Ne),_t=se(Ae,Ve,Ne),mt=kt[0],Ot=kt[1],Kt=kt[2];return{xyzv:[[Ue,qe,Je],[Je,Xe,Ue],[qe,Ve,_t],[_t,Je,qe],[Ve,Ue,Xe],[Xe,_t,Ve]],abc:[[mt,Ot,-1],[-1,-1,mt],[Ot,Kt,-1],[-1,-1,Ot],[Kt,mt,-1],[-1,-1,Kt]]}}function $(Dt,kt){return Dt==="all"||Dt===null?!0:Dt.indexOf(kt)>-1}function W(Dt,kt){return Dt===null?kt:Dt}function K(Dt,kt,Ue){X();var qe=[kt],Ve=[Ue];if(N>=1)qe=[kt],Ve=[Ue];else if(N>0){var Ae=q(kt,Ue);qe=Ae.xyzv,Ve=Ae.abc}for(var Ne=0;Ne<qe.length;Ne++){kt=qe[Ne],Ue=Ve[Ne];for(var Xe=[],Je=0;Je<3;Je++){var _t=kt[Je][0],mt=kt[Je][1],Ot=kt[Je][2],Kt=kt[Je][3],Nt=Ue[Je]>-1?Ue[Je]:J(_t,mt,Ot);Nt>-1?Xe[Je]=Nt:Xe[Je]=Z(_t,mt,Ot,W(Dt,Kt))}oe(Xe[0],Xe[1],Xe[2])}}function ne(Dt,kt,Ue){var qe=function(Ve,Ae,Ne){K(Dt,[kt[Ve],kt[Ae],kt[Ne]],[Ue[Ve],Ue[Ae],Ue[Ne]])};qe(0,1,2),qe(2,3,0)}function ae(Dt,kt,Ue){var qe=function(Ve,Ae,Ne){K(Dt,[kt[Ve],kt[Ae],kt[Ne]],[Ue[Ve],Ue[Ae],Ue[Ne]])};qe(0,1,2),qe(3,0,1),qe(2,3,0),qe(1,2,3)}function ie(Dt,kt,Ue,qe){var Ve=Dt[3];Ve<Ue&&(Ve=Ue),Ve>qe&&(Ve=qe);for(var Ae=(Dt[3]-Ve)/(Dt[3]-kt[3]+1e-9),Ne=[],Xe=0;Xe<4;Xe++)Ne[Xe]=(1-Ae)*Dt[Xe]+Ae*kt[Xe];return Ne}function le(Dt,kt,Ue){return Dt>=kt&&Dt<=Ue}function ye(Dt){var kt=.001*(R-D);return Dt>=D-kt&&Dt<=R+kt}function ue(Dt){for(var kt=[],Ue=0;Ue<4;Ue++){var qe=Dt[Ue];kt.push([i._x[qe],i._y[qe],i._z[qe],i._value[qe]])}return kt}var pe=3;function ge(Dt,kt,Ue,qe,Ve,Ae){Ae||(Ae=1),Ue=[-1,-1,-1];var Ne=!1,Xe=[le(kt[0][3],qe,Ve),le(kt[1][3],qe,Ve),le(kt[2][3],qe,Ve)];if(!Xe[0]&&!Xe[1]&&!Xe[2])return!1;var Je=function(mt,Ot,Kt){return ye(Ot[0][3])&&ye(Ot[1][3])&&ye(Ot[2][3])?(K(mt,Ot,Kt),!0):Ae<pe?ge(mt,Ot,Kt,D,R,++Ae):!1};if(Xe[0]&&Xe[1]&&Xe[2])return Je(Dt,kt,Ue)||Ne;var _t=!1;return[[0,1,2],[2,0,1],[1,2,0]].forEach(function(mt){if(Xe[mt[0]]&&Xe[mt[1]]&&!Xe[mt[2]]){var Ot=kt[mt[0]],Kt=kt[mt[1]],Nt=kt[mt[2]],Wt=ie(Nt,Ot,qe,Ve),qt=ie(Nt,Kt,qe,Ve);Ne=Je(Dt,[qt,Wt,Ot],[-1,-1,Ue[mt[0]]])||Ne,Ne=Je(Dt,[Ot,Kt,qt],[Ue[mt[0]],Ue[mt[1]],-1])||Ne,_t=!0}}),_t||[[0,1,2],[1,2,0],[2,0,1]].forEach(function(mt){if(Xe[mt[0]]&&!Xe[mt[1]]&&!Xe[mt[2]]){var Ot=kt[mt[0]],Kt=kt[mt[1]],Nt=kt[mt[2]],Wt=ie(Kt,Ot,qe,Ve),qt=ie(Nt,Ot,qe,Ve);Ne=Je(Dt,[qt,Wt,Ot],[-1,-1,Ue[mt[0]]])||Ne,_t=!0}}),Ne}function Te(Dt,kt,Ue,qe){var Ve=!1,Ae=ue(kt),Ne=[le(Ae[0][3],Ue,qe),le(Ae[1][3],Ue,qe),le(Ae[2][3],Ue,qe),le(Ae[3][3],Ue,qe)];if(!Ne[0]&&!Ne[1]&&!Ne[2]&&!Ne[3])return Ve;if(Ne[0]&&Ne[1]&&Ne[2]&&Ne[3])return u&&(Ve=ae(Dt,Ae,kt)||Ve),Ve;var Xe=!1;return[[0,1,2,3],[3,0,1,2],[2,3,0,1],[1,2,3,0]].forEach(function(Je){if(Ne[Je[0]]&&Ne[Je[1]]&&Ne[Je[2]]&&!Ne[Je[3]]){var _t=Ae[Je[0]],mt=Ae[Je[1]],Ot=Ae[Je[2]],Kt=Ae[Je[3]];if(u)Ve=K(Dt,[_t,mt,Ot],[kt[Je[0]],kt[Je[1]],kt[Je[2]]])||Ve;else{var Nt=ie(Kt,_t,Ue,qe),Wt=ie(Kt,mt,Ue,qe),qt=ie(Kt,Ot,Ue,qe);Ve=K(null,[Nt,Wt,qt],[-1,-1,-1])||Ve}Xe=!0}}),Xe||([[0,1,2,3],[1,2,3,0],[2,3,0,1],[3,0,1,2],[0,2,3,1],[1,3,2,0]].forEach(function(Je){if(Ne[Je[0]]&&Ne[Je[1]]&&!Ne[Je[2]]&&!Ne[Je[3]]){var _t=Ae[Je[0]],mt=Ae[Je[1]],Ot=Ae[Je[2]],Kt=Ae[Je[3]],Nt=ie(Ot,_t,Ue,qe),Wt=ie(Ot,mt,Ue,qe),qt=ie(Kt,mt,Ue,qe),Yt=ie(Kt,_t,Ue,qe);u?(Ve=K(Dt,[_t,Yt,Nt],[kt[Je[0]],-1,-1])||Ve,Ve=K(Dt,[mt,Wt,qt],[kt[Je[1]],-1,-1])||Ve):Ve=ne(null,[Nt,Wt,qt,Yt],[-1,-1,-1,-1])||Ve,Xe=!0}}),Xe)||[[0,1,2,3],[1,2,3,0],[2,3,0,1],[3,0,1,2]].forEach(function(Je){if(Ne[Je[0]]&&!Ne[Je[1]]&&!Ne[Je[2]]&&!Ne[Je[3]]){var _t=Ae[Je[0]],mt=Ae[Je[1]],Ot=Ae[Je[2]],Kt=Ae[Je[3]],Nt=ie(mt,_t,Ue,qe),Wt=ie(Ot,_t,Ue,qe),qt=ie(Kt,_t,Ue,qe);u?(Ve=K(Dt,[_t,Nt,Wt],[kt[Je[0]],-1,-1])||Ve,Ve=K(Dt,[_t,Wt,qt],[kt[Je[0]],-1,-1])||Ve,Ve=K(Dt,[_t,qt,Nt],[kt[Je[0]],-1,-1])||Ve):Ve=K(null,[Nt,Wt,qt],[-1,-1,-1])||Ve,Xe=!0}}),Ve}function _e(Dt,kt,Ue,qe,Ve,Ae,Ne,Xe,Je,_t,mt){var Ot=!1;return m&&($(Dt,"A")&&(Ot=Te(null,[kt,Ue,qe,Ae],_t,mt)||Ot),$(Dt,"B")&&(Ot=Te(null,[Ue,qe,Ve,Je],_t,mt)||Ot),$(Dt,"C")&&(Ot=Te(null,[Ue,Ae,Ne,Je],_t,mt)||Ot),$(Dt,"D")&&(Ot=Te(null,[qe,Ae,Xe,Je],_t,mt)||Ot),$(Dt,"E")&&(Ot=Te(null,[Ue,qe,Ae,Je],_t,mt)||Ot)),u&&(Ot=Te(Dt,[Ue,qe,Ae,Je],_t,mt)||Ot),Ot}function ze(Dt,kt,Ue,qe,Ve,Ae,Ne,Xe){return[Xe[0]===!0?!0:ge(Dt,ue([kt,Ue,qe]),[kt,Ue,qe],Ae,Ne),Xe[1]===!0?!0:ge(Dt,ue([qe,Ve,kt]),[qe,Ve,kt],Ae,Ne)]}function Oe(Dt,kt,Ue,qe,Ve,Ae,Ne,Xe,Je){return Xe?ze(Dt,kt,Ue,Ve,qe,Ae,Ne,Je):ze(Dt,Ue,Ve,qe,kt,Ae,Ne,Je)}function Ye(Dt,kt,Ue,qe,Ve,Ae,Ne){var Xe=!1,Je,_t,mt,Ot,Kt=function(){Xe=ge(Dt,[Je,_t,mt],[-1,-1,-1],Ve,Ae)||Xe,Xe=ge(Dt,[mt,Ot,Je],[-1,-1,-1],Ve,Ae)||Xe},Nt=Ne[0],Wt=Ne[1],qt=Ne[2];return Nt&&(Je=se(ue([P(kt,Ue-0,qe-0)])[0],ue([P(kt-1,Ue-0,qe-0)])[0],Nt),_t=se(ue([P(kt,Ue-0,qe-1)])[0],ue([P(kt-1,Ue-0,qe-1)])[0],Nt),mt=se(ue([P(kt,Ue-1,qe-1)])[0],ue([P(kt-1,Ue-1,qe-1)])[0],Nt),Ot=se(ue([P(kt,Ue-1,qe-0)])[0],ue([P(kt-1,Ue-1,qe-0)])[0],Nt),Kt()),Wt&&(Je=se(ue([P(kt-0,Ue,qe-0)])[0],ue([P(kt-0,Ue-1,qe-0)])[0],Wt),_t=se(ue([P(kt-0,Ue,qe-1)])[0],ue([P(kt-0,Ue-1,qe-1)])[0],Wt),mt=se(ue([P(kt-1,Ue,qe-1)])[0],ue([P(kt-1,Ue-1,qe-1)])[0],Wt),Ot=se(ue([P(kt-1,Ue,qe-0)])[0],ue([P(kt-1,Ue-1,qe-0)])[0],Wt),Kt()),qt&&(Je=se(ue([P(kt-0,Ue-0,qe)])[0],ue([P(kt-0,Ue-0,qe-1)])[0],qt),_t=se(ue([P(kt-0,Ue-1,qe)])[0],ue([P(kt-0,Ue-1,qe-1)])[0],qt),mt=se(ue([P(kt-1,Ue-1,qe)])[0],ue([P(kt-1,Ue-1,qe-1)])[0],qt),Ot=se(ue([P(kt-1,Ue-0,qe)])[0],ue([P(kt-1,Ue-0,qe-1)])[0],qt),Kt()),Xe}function be(Dt,kt,Ue,qe,Ve,Ae,Ne,Xe,Je,_t,mt,Ot){var Kt=Dt;return Ot?(m&&Dt==="even"&&(Kt=null),_e(Kt,kt,Ue,qe,Ve,Ae,Ne,Xe,Je,_t,mt)):(m&&Dt==="odd"&&(Kt=null),_e(Kt,Je,Xe,Ne,Ae,Ve,qe,Ue,kt,_t,mt))}function Pe(Dt,kt,Ue,qe,Ve){for(var Ae=[],Ne=0,Xe=0;Xe<kt.length;Xe++)for(var Je=kt[Xe],_t=1;_t<T;_t++)for(var mt=1;mt<L;mt++)Ae.push(Oe(Dt,P(Je,mt-1,_t-1),P(Je,mt-1,_t),P(Je,mt,_t-1),P(Je,mt,_t),Ue,qe,(Je+mt+_t)%2,Ve&&Ve[Ne]?Ve[Ne]:[])),Ne++;return Ae}function Ge(Dt,kt,Ue,qe,Ve){for(var Ae=[],Ne=0,Xe=0;Xe<kt.length;Xe++)for(var Je=kt[Xe],_t=1;_t<l;_t++)for(var mt=1;mt<T;mt++)Ae.push(Oe(Dt,P(_t-1,Je,mt-1),P(_t,Je,mt-1),P(_t-1,Je,mt),P(_t,Je,mt),Ue,qe,(_t+Je+mt)%2,Ve&&Ve[Ne]?Ve[Ne]:[])),Ne++;return Ae}function Qe(Dt,kt,Ue,qe,Ve){for(var Ae=[],Ne=0,Xe=0;Xe<kt.length;Xe++)for(var Je=kt[Xe],_t=1;_t<L;_t++)for(var mt=1;mt<l;mt++)Ae.push(Oe(Dt,P(mt-1,_t-1,Je),P(mt-1,_t,Je),P(mt,_t-1,Je),P(mt,_t,Je),Ue,qe,(mt+_t+Je)%2,Ve&&Ve[Ne]?Ve[Ne]:[])),Ne++;return Ae}function Be(Dt,kt,Ue){for(var qe=1;qe<T;qe++)for(var Ve=1;Ve<L;Ve++)for(var Ae=1;Ae<l;Ae++)be(Dt,P(Ae-1,Ve-1,qe-1),P(Ae-1,Ve-1,qe),P(Ae-1,Ve,qe-1),P(Ae-1,Ve,qe),P(Ae,Ve-1,qe-1),P(Ae,Ve-1,qe),P(Ae,Ve,qe-1),P(Ae,Ve,qe),kt,Ue,(Ae+Ve+qe)%2)}function Le(Dt,kt,Ue){u=!0,Be(Dt,kt,Ue),u=!1}function He(Dt,kt,Ue){m=!0,Be(Dt,kt,Ue),m=!1}function vt(Dt,kt,Ue,qe,Ve,Ae){for(var Ne=[],Xe=0,Je=0;Je<kt.length;Je++)for(var _t=kt[Je],mt=1;mt<T;mt++)for(var Ot=1;Ot<L;Ot++)Ne.push(Ye(Dt,_t,Ot,mt,Ue,qe,Ve[Je],Ae&&Ae[Xe]?Ae[Xe]:[])),Xe++;return Ne}function Rt(Dt,kt,Ue,qe,Ve,Ae){for(var Ne=[],Xe=0,Je=0;Je<kt.length;Je++)for(var _t=kt[Je],mt=1;mt<l;mt++)for(var Ot=1;Ot<T;Ot++)Ne.push(Ye(Dt,mt,_t,Ot,Ue,qe,Ve[Je],Ae&&Ae[Xe]?Ae[Xe]:[])),Xe++;return Ne}function rr(Dt,kt,Ue,qe,Ve,Ae){for(var Ne=[],Xe=0,Je=0;Je<kt.length;Je++)for(var _t=kt[Je],mt=1;mt<L;mt++)for(var Ot=1;Ot<l;Ot++)Ne.push(Ye(Dt,Ot,mt,_t,Ue,qe,Ve[Je],Ae&&Ae[Xe]?Ae[Xe]:[])),Xe++;return Ne}function Lt(Dt,kt){for(var Ue=[],qe=Dt;qe<kt;qe++)Ue.push(qe);return Ue}function Ft(){for(var Dt=0;Dt<l;Dt++)for(var kt=0;kt<L;kt++)for(var Ue=0;Ue<T;Ue++){var qe=P(Dt,kt,Ue);Z(i._x[qe],i._y[qe],i._z[qe],i._value[qe])}}function Gt(){Y(),Ft();var Dt=null;if(p&&h&&(U(h),Le(Dt,D,R)),y&&g){U(g);for(var kt=i.surface.pattern,Ue=i.surface.count,qe=0;qe<Ue;qe++){var Ve=Ue===1?.5:qe/(Ue-1),Ae=(1-Ve)*D+Ve*R,Ne=Math.abs(Ae-z),Xe=Math.abs(Ae-I),Je=Ne>Xe?[z,Ae]:[Ae,I];He(kt,Je[0],Je[1])}}var _t=[[Math.min(D,I),Math.max(D,I)],[Math.min(z,R),Math.max(z,R)]];["x","y","z"].forEach(function(mt){for(var Ot=[],Kt=0;Kt<_t.length;Kt++){var Nt=0,Wt=_t[Kt][0],qt=_t[Kt][1],Yt=i.slices[mt];if(Yt.show&&Yt.fill){U(Yt.fill);var fr=[],Yr=[],hn=[];if(Yt.locations.length)for(var Qr=0;Qr<Yt.locations.length;Qr++){var at=a(Yt.locations[Qr],mt==="x"?b:mt==="y"?f:x);at.distRatio===0?fr.push(at.id):at.id>0&&(Yr.push(at.id),mt==="x"?hn.push([at.distRatio,0,0]):mt==="y"?hn.push([0,at.distRatio,0]):hn.push([0,0,at.distRatio]))}else mt==="x"?fr=Lt(1,l-1):mt==="y"?fr=Lt(1,L-1):fr=Lt(1,T-1);Yr.length>0&&(mt==="x"?Ot[Nt]=vt(Dt,Yr,Wt,qt,hn,Ot[Nt]):mt==="y"?Ot[Nt]=Rt(Dt,Yr,Wt,qt,hn,Ot[Nt]):Ot[Nt]=rr(Dt,Yr,Wt,qt,hn,Ot[Nt]),Nt++),fr.length>0&&(mt==="x"?Ot[Nt]=Pe(Dt,fr,Wt,qt,Ot[Nt]):mt==="y"?Ot[Nt]=Ge(Dt,fr,Wt,qt,Ot[Nt]):Ot[Nt]=Qe(Dt,fr,Wt,qt,Ot[Nt]),Nt++)}var Jt=i.caps[mt];Jt.show&&Jt.fill&&(U(Jt.fill),mt==="x"?Ot[Nt]=Pe(Dt,[0,l-1],Wt,qt,Ot[Nt]):mt==="y"?Ot[Nt]=Ge(Dt,[0,L-1],Wt,qt,Ot[Nt]):Ot[Nt]=Qe(Dt,[0,T-1],Wt,qt,Ot[Nt]),Nt++)}}),_===0&&Y(),i._meshX=B,i._meshY=F,i._meshZ=H,i._meshIntensity=G,i._Xs=b,i._Ys=f,i._Zs=x}return Gt(),i}function o(i,y){var p=i.glplot.gl,g=w({gl:p}),h=new n(i,g,y.uid);return g._trace=h,h.update(y),i.glplot.add(g),h}ee.exports={findNearestOnAxis:a,generateIsoMeshes:c,createIsosurfaceTrace:o}},{"../../../stackgl_modules":1133,"../../components/colorscale":379,"../../lib/gl_format_color":511,"../../lib/str2rgbarray":540,"../../plots/gl3d/zip3":618}],874:[function(d,ee,te){var w=d("../../lib"),v=d("../../registry"),S=d("./attributes"),M=d("../../components/colorscale/defaults");function e(n,r,t,c){function o(i,y){return w.coerce(n,r,S,i,y)}a(n,r,t,c,o)}function a(n,r,t,c,o){var i=o("isomin"),y=o("isomax");y!=null&&i!==void 0&&i!==null&&i>y&&(r.isomin=null,r.isomax=null);var p=o("x"),g=o("y"),h=o("z"),m=o("value");if(!p||!p.length||!g||!g.length||!h||!h.length||!m||!m.length){r.visible=!1;return}var u=v.getComponentMethod("calendars","handleTraceDefaults");u(n,r,["x","y","z"],c),o("valuehoverformat"),["x","y","z"].forEach(function(b){o(b+"hoverformat");var f="caps."+b,x=o(f+".show");x&&o(f+".fill");var l="slices."+b,L=o(l+".show");L&&(o(l+".fill"),o(l+".locations"))});var _=o("spaceframe.show");_&&o("spaceframe.fill");var s=o("surface.show");s&&(o("surface.count"),o("surface.fill"),o("surface.pattern"));var A=o("contour.show");A&&(o("contour.color"),o("contour.width")),["text","hovertext","hovertemplate","lighting.ambient","lighting.diffuse","lighting.specular","lighting.roughness","lighting.fresnel","lighting.vertexnormalsepsilon","lighting.facenormalsepsilon","lightposition.x","lightposition.y","lightposition.z","flatshading","opacity"].forEach(function(b){o(b)}),M(n,r,c,o,{prefix:"",cLetter:"c"}),r._length=null}ee.exports={supplyDefaults:e,supplyIsoDefaults:a}},{"../../components/colorscale/defaults":377,"../../lib":515,"../../registry":647,"./attributes":871}],875:[function(d,ee,te){ee.exports={attributes:d("./attributes"),supplyDefaults:d("./defaults").supplyDefaults,calc:d("./calc"),colorbar:{min:"cmin",max:"cmax"},plot:d("./convert").createIsosurfaceTrace,moduleType:"trace",name:"isosurface",basePlotModule:d("../../plots/gl3d"),categories:["gl3d","showLegend"],meta:{}}},{"../../plots/gl3d":607,"./attributes":871,"./calc":872,"./convert":873,"./defaults":874}],876:[function(d,ee,te){var w=d("../../components/colorscale/attributes"),v=d("../../plots/cartesian/axis_format_attributes").axisHoverFormat,S=d("../../plots/template_attributes").hovertemplateAttrs,M=d("../surface/attributes"),e=d("../../plots/attributes"),a=d("../../lib/extend").extendFlat;ee.exports=a({x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},z:{valType:"data_array",editType:"calc+clearAxisTypes"},i:{valType:"data_array",editType:"calc"},j:{valType:"data_array",editType:"calc"},k:{valType:"data_array",editType:"calc"},text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertemplate:S({editType:"calc"}),xhoverformat:v("x"),yhoverformat:v("y"),zhoverformat:v("z"),delaunayaxis:{valType:"enumerated",values:["x","y","z"],dflt:"z",editType:"calc"},alphahull:{valType:"number",dflt:-1,editType:"calc"},intensity:{valType:"data_array",editType:"calc"},intensitymode:{valType:"enumerated",values:["vertex","cell"],dflt:"vertex",editType:"calc"},color:{valType:"color",editType:"calc"},vertexcolor:{valType:"data_array",editType:"calc"},facecolor:{valType:"data_array",editType:"calc"},transforms:void 0},w("",{colorAttr:"`intensity`",showScaleDflt:!0,editTypeOverride:"calc"}),{opacity:M.opacity,flatshading:{valType:"boolean",dflt:!1,editType:"calc"},contour:{show:a({},M.contours.x.show,{}),color:M.contours.x.color,width:M.contours.x.width,editType:"calc"},lightposition:{x:a({},M.lightposition.x,{dflt:1e5}),y:a({},M.lightposition.y,{dflt:1e5}),z:a({},M.lightposition.z,{dflt:0}),editType:"calc"},lighting:a({vertexnormalsepsilon:{valType:"number",min:0,max:1,dflt:1e-12,editType:"calc"},facenormalsepsilon:{valType:"number",min:0,max:1,dflt:1e-6,editType:"calc"},editType:"calc"},M.lighting),hoverinfo:a({},e.hoverinfo,{editType:"calc"}),showlegend:a({},e.showlegend,{dflt:!1})})},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../surface/attributes":1070}],877:[function(d,ee,te){var w=d("../../components/colorscale/calc");ee.exports=function(S,M){M.intensity&&w(S,M,{vals:M.intensity,containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":375}],878:[function(d,ee,te){var w=d("../../../stackgl_modules").gl_mesh3d,v=d("../../../stackgl_modules").delaunay_triangulate,S=d("../../../stackgl_modules").alpha_shape,M=d("../../../stackgl_modules").convex_hull,e=d("../../lib/gl_format_color").parseColorScale,a=d("../../lib/str2rgbarray"),n=d("../../components/colorscale").extractOpts,r=d("../../plots/gl3d/zip3");function t(m,u,_){this.scene=m,this.uid=_,this.mesh=u,this.name="",this.color="#fff",this.data=null,this.showContour=!1}var c=t.prototype;c.handlePick=function(m){if(m.object===this.mesh){var u=m.index=m.data.index;m.data._cellCenter?m.traceCoordinate=m.data.dataCoordinate:m.traceCoordinate=[this.data.x[u],this.data.y[u],this.data.z[u]];var _=this.data.hovertext||this.data.text;return Array.isArray(_)&&_[u]!==void 0?m.textLabel=_[u]:_&&(m.textLabel=_),!0}};function o(m){for(var u=[],_=m.length,s=0;s<_;s++)u[s]=a(m[s]);return u}function i(m,u,_,s){for(var A=[],b=u.length,f=0;f<b;f++)A[f]=m.d2l(u[f],0,s)*_;return A}function y(m){for(var u=[],_=m.length,s=0;s<_;s++)u[s]=Math.round(m[s]);return u}function p(m,u){for(var _=["x","y","z"].indexOf(m),s=[],A=u.length,b=0;b<A;b++)s[b]=[u[b][(_+1)%3],u[b][(_+2)%3]];return v(s)}function g(m,u){for(var _=m.length,s=0;s<_;s++)if(m[s]<=-.5||m[s]>=u-.5)return!1;return!0}c.update=function(m){var u=this.scene,_=u.fullSceneLayout;this.data=m;var s=m.x.length,A=r(i(_.xaxis,m.x,u.dataScale[0],m.xcalendar),i(_.yaxis,m.y,u.dataScale[1],m.ycalendar),i(_.zaxis,m.z,u.dataScale[2],m.zcalendar)),b;if(m.i&&m.j&&m.k){if(m.i.length!==m.j.length||m.j.length!==m.k.length||!g(m.i,s)||!g(m.j,s)||!g(m.k,s))return;b=r(y(m.i),y(m.j),y(m.k))}else m.alphahull===0?b=M(A):m.alphahull>0?b=S(m.alphahull,A):b=p(m.delaunayaxis,A);var f={positions:A,cells:b,lightPosition:[m.lightposition.x,m.lightposition.y,m.lightposition.z],ambient:m.lighting.ambient,diffuse:m.lighting.diffuse,specular:m.lighting.specular,roughness:m.lighting.roughness,fresnel:m.lighting.fresnel,vertexNormalsEpsilon:m.lighting.vertexnormalsepsilon,faceNormalsEpsilon:m.lighting.facenormalsepsilon,opacity:m.opacity,contourEnable:m.contour.show,contourColor:a(m.contour.color).slice(0,3),contourWidth:m.contour.width,useFacetNormals:m.flatshading};if(m.intensity){var x=n(m);this.color="#fff";var l=m.intensitymode;f[l+"Intensity"]=m.intensity,f[l+"IntensityBounds"]=[x.min,x.max],f.colormap=e(m)}else m.vertexcolor?(this.color=m.vertexcolor[0],f.vertexColors=o(m.vertexcolor)):m.facecolor?(this.color=m.facecolor[0],f.cellColors=o(m.facecolor)):(this.color=m.color,f.meshColor=a(m.color));this.mesh.update(f)},c.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()};function h(m,u){var _=m.glplot.gl,s=w({gl:_}),A=new t(m,s,u.uid);return s._trace=A,A.update(u),m.glplot.add(s),A}ee.exports=h},{"../../../stackgl_modules":1133,"../../components/colorscale":379,"../../lib/gl_format_color":511,"../../lib/str2rgbarray":540,"../../plots/gl3d/zip3":618}],879:[function(d,ee,te){var w=d("../../registry"),v=d("../../lib"),S=d("../../components/colorscale/defaults"),M=d("./attributes");ee.exports=function(a,n,r,t){function c(g,h){return v.coerce(a,n,M,g,h)}function o(g){var h=g.map(function(m){var u=c(m);return u&&v.isArrayOrTypedArray(u)?u:null});return h.every(function(m){return m&&m.length===h[0].length})&&h}var i=o(["x","y","z"]);if(!i){n.visible=!1;return}if(o(["i","j","k"]),n.i&&(!n.j||!n.k)||n.j&&(!n.k||!n.i)||n.k&&(!n.i||!n.j)){n.visible=!1;return}var y=w.getComponentMethod("calendars","handleTraceDefaults");y(a,n,["x","y","z"],t),["lighting.ambient","lighting.diffuse","lighting.specular","lighting.roughness","lighting.fresnel","lighting.vertexnormalsepsilon","lighting.facenormalsepsilon","lightposition.x","lightposition.y","lightposition.z","flatshading","alphahull","delaunayaxis","opacity"].forEach(function(g){c(g)});var p=c("contour.show");p&&(c("contour.color"),c("contour.width")),"intensity"in a?(c("intensity"),c("intensitymode"),S(a,n,t,c,{prefix:"",cLetter:"c"})):(n.showscale=!1,"facecolor"in a?c("facecolor"):"vertexcolor"in a?c("vertexcolor"):c("color",r)),c("text"),c("hovertext"),c("hovertemplate"),c("xhoverformat"),c("yhoverformat"),c("zhoverformat"),n._length=null}},{"../../components/colorscale/defaults":377,"../../lib":515,"../../registry":647,"./attributes":876}],880:[function(d,ee,te){ee.exports={attributes:d("./attributes"),supplyDefaults:d("./defaults"),calc:d("./calc"),colorbar:{min:"cmin",max:"cmax"},plot:d("./convert"),moduleType:"trace",name:"mesh3d",basePlotModule:d("../../plots/gl3d"),categories:["gl3d","showLegend"],meta:{}}},{"../../plots/gl3d":607,"./attributes":876,"./calc":877,"./convert":878,"./defaults":879}],881:[function(d,ee,te){var w=d("../../lib").extendFlat,v=d("../scatter/attributes"),S=d("../../plots/cartesian/axis_format_attributes").axisHoverFormat,M=d("../../components/drawing/attributes").dash,e=d("../../components/fx/attributes"),a=d("../../constants/delta.js"),n=a.INCREASING.COLOR,r=a.DECREASING.COLOR,t=v.line;function c(o){return{line:{color:w({},t.color,{dflt:o}),width:t.width,dash:M,editType:"style"},editType:"style"}}ee.exports={xperiod:v.xperiod,xperiod0:v.xperiod0,xperiodalignment:v.xperiodalignment,xhoverformat:S("x"),yhoverformat:S("y"),x:{valType:"data_array",editType:"calc+clearAxisTypes"},open:{valType:"data_array",editType:"calc"},high:{valType:"data_array",editType:"calc"},low:{valType:"data_array",editType:"calc"},close:{valType:"data_array",editType:"calc"},line:{width:w({},t.width,{}),dash:w({},M,{}),editType:"style"},increasing:c(n),decreasing:c(r),text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},tickwidth:{valType:"number",min:0,max:.5,dflt:.3,editType:"calc"},hoverlabel:w({},e.hoverlabel,{split:{valType:"boolean",dflt:!1,editType:"style"}})}},{"../../components/drawing/attributes":388,"../../components/fx/attributes":398,"../../constants/delta.js":485,"../../lib":515,"../../plots/cartesian/axis_format_attributes":569,"../scatter/attributes":936}],882:[function(d,ee,te){var w=d("../../lib"),v=w._,S=d("../../plots/cartesian/axes"),M=d("../../plots/cartesian/align_period"),e=d("../../constants/numerical").BADNUM;function a(c,o){var i=S.getFromId(c,o.xaxis),y=S.getFromId(c,o.yaxis),p=t(c,i,o),g=o._minDiff;o._minDiff=null;var h=o._origX;o._origX=null;var m=o._xcalc;o._xcalc=null;var u=r(c,o,h,m,y,n);return o._extremes[i._id]=S.findExtremes(i,m,{vpad:g/2}),u.length?(w.extendFlat(u[0].t,{wHover:g/2,tickLen:p}),u):[{t:{empty:!0}}]}function n(c,o,i,y){return{o:c,h:o,l:i,c:y}}function r(c,o,i,y,p,g){for(var h=p.makeCalcdata(o,"open"),m=p.makeCalcdata(o,"high"),u=p.makeCalcdata(o,"low"),_=p.makeCalcdata(o,"close"),s=Array.isArray(o.text),A=Array.isArray(o.hovertext),b=!0,f=null,x=!!o.xperiodalignment,l=[],L=0;L<y.length;L++){var T=y[L],k=h[L],P=m[L],z=u[L],I=_[L];if(T!==e&&k!==e&&P!==e&&z!==e&&I!==e){I===k?f!==null&&I!==f&&(b=I>f):b=I>k,f=I;var D=g(k,P,z,I);D.pos=T,D.yc=(k+I)/2,D.i=L,D.dir=b?"increasing":"decreasing",D.x=D.pos,D.y=[z,P],x&&(D.orig_p=i[L]),s&&(D.tx=o.text[L]),A&&(D.htx=o.hovertext[L]),l.push(D)}else l.push({pos:T,empty:!0})}return o._extremes[p._id]=S.findExtremes(p,w.concat(u,m),{padded:!0}),l.length&&(l[0].t={labels:{open:v(c,"open:")+" ",high:v(c,"high:")+" ",low:v(c,"low:")+" ",close:v(c,"close:")+" "}}),l}function t(c,o,i){var y=i._minDiff;if(!y){var p=c._fullData,g=[];y=1/0;var h;for(h=0;h<p.length;h++){var m=p[h];if(m.type==="ohlc"&&m.visible===!0&&m.xaxis===o._id){g.push(m);var u=o.makeCalcdata(m,"x");m._origX=u;var _=M(i,o,"x",u).vals;m._xcalc=_;var s=w.distinctVals(_).minDiff;s&&isFinite(s)&&(y=Math.min(y,s))}}for(y===1/0&&(y=1),h=0;h<g.length;h++)g[h]._minDiff=y}return y*i.tickwidth}ee.exports={calc:a,calcCommon:r}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/align_period":563,"../../plots/cartesian/axes":566}],883:[function(d,ee,te){var w=d("../../lib"),v=d("./ohlc_defaults"),S=d("../scatter/period_defaults"),M=d("./attributes");ee.exports=function(n,r,t,c){function o(y,p){return w.coerce(n,r,M,y,p)}var i=v(n,r,o,c);if(!i){r.visible=!1;return}S(n,r,c,o,{x:!0}),o("xhoverformat"),o("yhoverformat"),o("line.width"),o("line.dash"),e(n,r,o,"increasing"),e(n,r,o,"decreasing"),o("text"),o("hovertext"),o("tickwidth"),c._requestRangeslider[r.xaxis]=!0};function e(a,n,r,t){r(t+".line.color"),r(t+".line.width",n.line.width),r(t+".line.dash",n.line.dash)}},{"../../lib":515,"../scatter/period_defaults":956,"./attributes":881,"./ohlc_defaults":886}],884:[function(d,ee,te){var w=d("../../plots/cartesian/axes"),v=d("../../lib"),S=d("../../components/fx"),M=d("../../components/color"),e=d("../../lib").fillText,a=d("../../constants/delta.js"),n={increasing:a.INCREASING.SYMBOL,decreasing:a.DECREASING.SYMBOL};function r(i,y,p,g){var h=i.cd,m=h[0].trace;return m.hoverlabel.split?c(i,y,p,g):o(i,y,p,g)}function t(i,y,p,g){var h=i.cd,m=i.xa,u=h[0].trace,_=h[0].t,s=u.type,A=s==="ohlc"?"l":"min",b=s==="ohlc"?"h":"max",f,x,l=_.bPos||0,L=function(J){return J.pos+l-y},T=_.bdPos||_.tickLen,k=_.wHover,P=Math.min(1,T/Math.abs(m.r2c(m.range[1])-m.r2c(m.range[0])));f=i.maxHoverDistance-P,x=i.maxSpikeDistance-P;function z(J){var X=L(J);return S.inbox(X-k,X+k,f)}function I(J){var X=J[A],Y=J[b];return X===Y||S.inbox(X-p,Y-p,f)}function D(J){return(z(J)+I(J))/2}var R=S.getDistanceFunction(g,z,I,D);if(S.getClosest(h,R,i),i.index===!1)return null;var B=h[i.index];if(B.empty)return null;var F=B.dir,H=u[F],G=H.line.color;return M.opacity(G)&&H.line.width?i.color=G:i.color=H.fillcolor,i.x0=m.c2p(B.pos+l-T,!0),i.x1=m.c2p(B.pos+l+T,!0),i.xLabelVal=B.orig_p!==void 0?B.orig_p:B.pos,i.spikeDistance=D(B)*x/f,i.xSpike=m.c2p(B.pos,!0),i}function c(i,y,p,g){var h=i.cd,m=i.ya,u=h[0].trace,_=h[0].t,s=[],A=t(i,y,p,g);if(!A)return[];var b=A.index,f=h[b],x=f.hi||u.hoverinfo,l=x.split("+"),L=x==="all",T=L||l.indexOf("y")!==-1;if(!T)return[];for(var k=["high","open","close","low"],P={},z=0;z<k.length;z++){var I=k[z],D=u[I][A.index],R=m.c2p(D,!0),B;D in P?(B=P[D],B.yLabel+="<br>"+_.labels[I]+w.hoverLabelText(m,D,u.yhoverformat)):(B=v.extendFlat({},A),B.y0=B.y1=R,B.yLabelVal=D,B.yLabel=_.labels[I]+w.hoverLabelText(m,D,u.yhoverformat),B.name="",s.push(B),P[D]=B)}return s}function o(i,y,p,g){var h=i.cd,m=i.ya,u=h[0].trace,_=h[0].t,s=t(i,y,p,g);if(!s)return[];var A=s.index,b=h[A],f=s.index=b.i,x=b.dir;function l(D){return _.labels[D]+w.hoverLabelText(m,u[D][f],u.yhoverformat)}var L=b.hi||u.hoverinfo,T=L.split("+"),k=L==="all",P=k||T.indexOf("y")!==-1,z=k||T.indexOf("text")!==-1,I=P?[l("open"),l("high"),l("low"),l("close")+"  "+n[x]]:[];return z&&e(b,u,I),s.extraText=I.join("<br>"),s.y0=s.y1=m.c2p(b.yc,!0),[s]}ee.exports={hoverPoints:r,hoverSplit:c,hoverOnPoints:o}},{"../../components/color":367,"../../components/fx":407,"../../constants/delta.js":485,"../../lib":515,"../../plots/cartesian/axes":566}],885:[function(d,ee,te){ee.exports={moduleType:"trace",name:"ohlc",basePlotModule:d("../../plots/cartesian"),categories:["cartesian","svg","showLegend"],meta:{},attributes:d("./attributes"),supplyDefaults:d("./defaults"),calc:d("./calc").calc,plot:d("./plot"),style:d("./style"),hoverPoints:d("./hover").hoverPoints,selectPoints:d("./select")}},{"../../plots/cartesian":578,"./attributes":881,"./calc":882,"./defaults":883,"./hover":884,"./plot":887,"./select":888,"./style":889}],886:[function(d,ee,te){var w=d("../../registry"),v=d("../../lib");ee.exports=function(M,e,a,n){var r=a("x"),t=a("open"),c=a("high"),o=a("low"),i=a("close");a("hoverlabel.split");var y=w.getComponentMethod("calendars","handleTraceDefaults");if(y(M,e,["x"],n),!!(t&&c&&o&&i)){var p=Math.min(t.length,c.length,o.length,i.length);return r&&(p=Math.min(p,v.minRowLength(r))),e._length=p,p}}},{"../../lib":515,"../../registry":647}],887:[function(d,ee,te){var w=d("@plotly/d3"),v=d("../../lib");ee.exports=function(M,e,a,n){var r=e.yaxis,t=e.xaxis,c=!!t.rangebreaks;v.makeTraceGroups(n,a,"trace ohlc").each(function(o){var i=w.select(this),y=o[0],p=y.t,g=y.trace;if(g.visible!==!0||p.empty){i.remove();return}var h=p.tickLen,m=i.selectAll("path").data(v.identity);m.enter().append("path"),m.exit().remove(),m.attr("d",function(u){if(u.empty)return"M0,0Z";var _=t.c2p(u.pos-h,!0),s=t.c2p(u.pos+h,!0),A=c?(_+s)/2:t.c2p(u.pos,!0),b=r.c2p(u.o,!0),f=r.c2p(u.h,!0),x=r.c2p(u.l,!0),l=r.c2p(u.c,!0);return"M"+_+","+b+"H"+A+"M"+A+","+f+"V"+x+"M"+s+","+l+"H"+A})})}},{"../../lib":515,"@plotly/d3":58}],888:[function(d,ee,te){ee.exports=function(v,S){var M=v.cd,e=v.xaxis,a=v.yaxis,n=[],r,t=M[0].t.bPos||0;if(S===!1)for(r=0;r<M.length;r++)M[r].selected=0;else for(r=0;r<M.length;r++){var c=M[r];S.contains([e.c2p(c.pos+t),a.c2p(c.yc)],null,c.i,v)?(n.push({pointNumber:c.i,x:e.c2d(c.pos),y:a.c2d(c.yc)}),c.selected=1):c.selected=0}return n}},{}],889:[function(d,ee,te){var w=d("@plotly/d3"),v=d("../../components/drawing"),S=d("../../components/color");ee.exports=function(e,a,n){var r=n||w.select(e).selectAll("g.ohlclayer").selectAll("g.trace");r.style("opacity",function(t){return t[0].trace.opacity}),r.each(function(t){var c=t[0].trace;w.select(this).selectAll("path").each(function(o){if(!o.empty){var i=c[o.dir].line;w.select(this).style("fill","none").call(S.stroke,i.color).call(v.dashLine,i.dash,i.width).style("opacity",c.selectedpoints&&!o.selected?.3:1)}})})}},{"../../components/color":367,"../../components/drawing":389,"@plotly/d3":58}],890:[function(d,ee,te){var w=d("../../lib/extend").extendFlat,v=d("../../plots/attributes"),S=d("../../plots/font_attributes"),M=d("../../components/colorscale/attributes"),e=d("../../plots/template_attributes").hovertemplateAttrs,a=d("../../plots/domain").attributes,n=w({editType:"calc"},M("line",{editTypeOverride:"calc"}),{shape:{valType:"enumerated",values:["linear","hspline"],dflt:"linear",editType:"plot"},hovertemplate:e({editType:"plot",arrayOk:!1},{keys:["count","probability"]})});ee.exports={domain:a({name:"parcats",trace:!0,editType:"calc"}),hoverinfo:w({},v.hoverinfo,{flags:["count","probability"],editType:"plot",arrayOk:!1}),hoveron:{valType:"enumerated",values:["category","color","dimension"],dflt:"category",editType:"plot"},hovertemplate:e({editType:"plot",arrayOk:!1},{keys:["count","probability","category","categorycount","colorcount","bandcolorcount"]}),arrangement:{valType:"enumerated",values:["perpendicular","freeform","fixed"],dflt:"perpendicular",editType:"plot"},bundlecolors:{valType:"boolean",dflt:!0,editType:"plot"},sortpaths:{valType:"enumerated",values:["forward","backward"],dflt:"forward",editType:"plot"},labelfont:S({editType:"calc"}),tickfont:S({editType:"calc"}),dimensions:{_isLinkedToArray:"dimension",label:{valType:"string",editType:"calc"},categoryorder:{valType:"enumerated",values:["trace","category ascending","category descending","array"],dflt:"trace",editType:"calc"},categoryarray:{valType:"data_array",editType:"calc"},ticktext:{valType:"data_array",editType:"calc"},values:{valType:"data_array",dflt:[],editType:"calc"},displayindex:{valType:"integer",editType:"calc"},editType:"calc",visible:{valType:"boolean",dflt:!0,editType:"calc"}},line:n,counts:{valType:"number",min:0,dflt:1,arrayOk:!0,editType:"calc"},customdata:void 0,hoverlabel:void 0,ids:void 0,legendgroup:void 0,legendrank:void 0,opacity:void 0,selectedpoints:void 0,showlegend:void 0}},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/domain":593,"../../plots/font_attributes":594,"../../plots/template_attributes":642}],891:[function(d,ee,te){var w=d("../../plots/get_data").getModuleCalcData,v=d("./plot"),S="parcats";te.name=S,te.plot=function(M,e,a,n){var r=w(M.calcdata,S);if(r.length){var t=r[0];v(M,t,a,n)}},te.clean=function(M,e,a,n){var r=n._has&&n._has("parcats"),t=e._has&&e._has("parcats");r&&!t&&n._paperdiv.selectAll(".parcats").remove()}},{"../../plots/get_data":602,"./plot":896}],892:[function(d,ee,te){var w=d("../../lib/gup").wrap,v=d("../../components/colorscale/helpers").hasColorscale,S=d("../../components/colorscale/calc"),M=d("../../lib/filter_unique.js"),e=d("../../components/drawing"),a=d("../../lib"),n=d("fast-isnumeric");ee.exports=function(_,s){var A=a.filterVisible(s.dimensions);if(A.length===0)return[];var b=A.map(function(re){var se;if(re.categoryorder==="trace")se=null;else if(re.categoryorder==="array")se=re.categoryarray;else{se=M(re.values);for(var N=!0,U=0;U<se.length;U++)if(!n(se[U])){N=!1;break}se.sort(N?a.sorterAsc:void 0),re.categoryorder==="category descending"&&(se=se.reverse())}return p(re.values,se)}),f,x,l;a.isArrayOrTypedArray(s.counts)?f=s.counts:f=[s.counts],g(A),A.forEach(function(re,se){h(re,b[se])});var L=s.line,T;L?(v(s,"line")&&S(_,s,{vals:s.line.color,containerStr:"line",cLetter:"c"}),T=e.tryColorscale(L)):T=a.identity;function k(re){var se,N;return a.isArrayOrTypedArray(L.color)?(se=L.color[re%L.color.length],N=se):se=L.color,{color:T(se),rawColor:N}}var P=A[0].values.length,z={},I=b.map(function(re){return re.inds});l=0;var D,R;for(D=0;D<P;D++){var B=[];for(R=0;R<I.length;R++)B.push(I[R][D]);x=f[D%f.length],l+=x;var F=k(D),H=B+"-"+F.rawColor;z[H]===void 0&&(z[H]=i(B,F.color,F.rawColor)),y(z[H],D,x)}var G=A.map(function(re,se){return t(se,re._index,re._displayindex,re.label,l)});for(D=0;D<P;D++)for(x=f[D%f.length],R=0;R<G.length;R++){var J=G[R].containerInd,X=b[R].inds[D],Y=G[R].categories;if(Y[X]===void 0){var Z=s.dimensions[J]._categoryarray[X],oe=s.dimensions[J]._ticktext[X];Y[X]=c(R,X,Z,oe)}o(Y[X],D,x)}return w(r(G,z,l))};function r(u,_,s){var A=u.map(function(b){return b.categories.length}).reduce(function(b,f){return Math.max(b,f)});return{dimensions:u,paths:_,trace:void 0,maxCats:A,count:s}}function t(u,_,s,A,b){return{dimensionInd:u,containerInd:_,displayInd:s,dimensionLabel:A,count:b,categories:[],dragX:null}}function c(u,_,s,A){return{dimensionInd:u,categoryInd:_,categoryValue:s,displayInd:_,categoryLabel:A,valueInds:[],count:0,dragY:null}}function o(u,_,s){u.valueInds.push(_),u.count+=s}function i(u,_,s){return{categoryInds:u,color:_,rawColor:s,valueInds:[],count:0}}function y(u,_,s){u.valueInds.push(_),u.count+=s}function p(u,_){_==null?_=[]:_=_.map(function(T){return T});var s={},A={},b=[];_.forEach(function(T,k){s[T]=0,A[T]=k});for(var f=0;f<u.length;f++){var x=u[f],l;s[x]===void 0?(s[x]=1,l=_.push(x)-1,A[x]=l):(s[x]++,l=A[x]),b.push(l)}var L=_.map(function(T){return s[T]});return{uniqueValues:_,uniqueCounts:L,inds:b}}function g(u){var _=u.map(function(A){return A.displayindex}),s;if(m(_))for(s=0;s<u.length;s++)u[s]._displayindex=u[s].displayindex;else for(s=0;s<u.length;s++)u[s]._displayindex=s}function h(u,_){u._categoryarray=_.uniqueValues,u.ticktext===null||u.ticktext===void 0?u._ticktext=[]:u._ticktext=u.ticktext.slice();for(var s=u._ticktext.length;s<_.uniqueValues.length;s++)u._ticktext.push(_.uniqueValues[s])}function m(u){for(var _=new Array(u.length),s=0;s<u.length;s++){if(u[s]<0||u[s]>=u.length||_[u[s]]!==void 0)return!1;_[u[s]]=!0}return!0}},{"../../components/colorscale/calc":375,"../../components/colorscale/helpers":378,"../../components/drawing":389,"../../lib":515,"../../lib/filter_unique.js":506,"../../lib/gup":512,"fast-isnumeric":190}],893:[function(d,ee,te){var w=d("../../lib"),v=d("../../components/colorscale/helpers").hasColorscale,S=d("../../components/colorscale/defaults"),M=d("../../plots/domain").defaults,e=d("../../plots/array_container_defaults"),a=d("./attributes"),n=d("../parcoords/merge_length");function r(c,o,i,y,p){p("line.shape"),p("line.hovertemplate");var g=p("line.color",y.colorway[0]);if(v(c,"line")&&w.isArrayOrTypedArray(g)){if(g.length)return p("line.colorscale"),S(c,o,y,p,{prefix:"line.",cLetter:"c"}),g.length;o.line.color=i}return 1/0}function t(c,o){function i(_,s){return w.coerce(c,o,a.dimensions,_,s)}var y=i("values"),p=i("visible");if(y&&y.length||(p=o.visible=!1),p){i("label"),i("displayindex",o._index);var g=c.categoryarray,h=Array.isArray(g)&&g.length>0,m;h&&(m="array");var u=i("categoryorder",m);u==="array"?(i("categoryarray"),i("ticktext")):(delete c.categoryarray,delete c.ticktext),!h&&u==="array"&&(o.categoryorder="trace")}}ee.exports=function(o,i,y,p){function g(s,A){return w.coerce(o,i,a,s,A)}var h=e(o,i,{name:"dimensions",handleItemDefaults:t}),m=r(o,i,y,p,g);M(i,p,g),(!Array.isArray(h)||!h.length)&&(i.visible=!1),n(i,h,"values",m),g("hoveron"),g("hovertemplate"),g("arrangement"),g("bundlecolors"),g("sortpaths"),g("counts");var u={family:p.font.family,size:Math.round(p.font.size),color:p.font.color};w.coerceFont(g,"labelfont",u);var _={family:p.font.family,size:Math.round(p.font.size/1.2),color:p.font.color};w.coerceFont(g,"tickfont",_)}},{"../../components/colorscale/defaults":377,"../../components/colorscale/helpers":378,"../../lib":515,"../../plots/array_container_defaults":561,"../../plots/domain":593,"../parcoords/merge_length":907,"./attributes":890}],894:[function(d,ee,te){ee.exports={attributes:d("./attributes"),supplyDefaults:d("./defaults"),calc:d("./calc"),plot:d("./plot"),colorbar:{container:"line",min:"cmin",max:"cmax"},moduleType:"trace",name:"parcats",basePlotModule:d("./base_plot"),categories:["noOpacity"],meta:{}}},{"./attributes":890,"./base_plot":891,"./calc":892,"./defaults":893,"./plot":896}],895:[function(d,ee,te){var w=d("@plotly/d3"),v=d("d3-interpolate").interpolateNumber,S=d("../../plot_api/plot_api"),M=d("../../components/fx"),e=d("../../lib"),a=e.strTranslate,n=d("../../components/drawing"),r=d("tinycolor2"),t=d("../../lib/svg_text_utils");function c(U,q,$,W){var K=U.map(Z.bind(0,q,$)),ne=W.selectAll("g.parcatslayer").data([null]);ne.enter().append("g").attr("class","parcatslayer").style("pointer-events","all");var ae=ne.selectAll("g.trace.parcats").data(K,o),ie=ae.enter().append("g").attr("class","trace parcats");ae.attr("transform",function(be){return a(be.x,be.y)}),ie.append("g").attr("class","paths");var le=ae.select("g.paths"),ye=le.selectAll("path.path").data(function(be){return be.paths},o);ye.attr("fill",function(be){return be.model.color});var ue=ye.enter().append("path").attr("class","path").attr("stroke-opacity",0).attr("fill",function(be){return be.model.color}).attr("fill-opacity",0);_(ue),ye.attr("d",function(be){return be.svgD}),ue.empty()||ye.sort(y),ye.exit().remove(),ye.on("mouseover",p).on("mouseout",g).on("click",u),ie.append("g").attr("class","dimensions");var pe=ae.select("g.dimensions"),ge=pe.selectAll("g.dimension").data(function(be){return be.dimensions},o);ge.enter().append("g").attr("class","dimension"),ge.attr("transform",function(be){return a(be.x,0)}),ge.exit().remove();var Te=ge.selectAll("g.category").data(function(be){return be.categories},o),_e=Te.enter().append("g").attr("class","category");Te.attr("transform",function(be){return a(0,be.y)}),_e.append("rect").attr("class","catrect").attr("pointer-events","none"),Te.select("rect.catrect").attr("fill","none").attr("width",function(be){return be.width}).attr("height",function(be){return be.height}),b(_e);var ze=Te.selectAll("rect.bandrect").data(function(be){return be.bands},o);ze.each(function(){e.raiseToTop(this)}),ze.attr("fill",function(be){return be.color});var Oe=ze.enter().append("rect").attr("class","bandrect").attr("stroke-opacity",0).attr("fill",function(be){return be.color}).attr("fill-opacity",0);ze.attr("fill",function(be){return be.color}).attr("width",function(be){return be.width}).attr("height",function(be){return be.height}).attr("y",function(be){return be.y}).attr("cursor",function(be){return be.parcatsViewModel.arrangement==="fixed"?"default":be.parcatsViewModel.arrangement==="perpendicular"?"ns-resize":"move"}),x(Oe),ze.exit().remove(),_e.append("text").attr("class","catlabel").attr("pointer-events","none");var Ye=q._fullLayout.paper_bgcolor;Te.select("text.catlabel").attr("text-anchor",function(be){return i(be)?"start":"end"}).attr("alignment-baseline","middle").style("text-shadow",t.makeTextShadow(Ye)).style("fill","rgb(0, 0, 0)").attr("x",function(be){return i(be)?be.width+5:-5}).attr("y",function(be){return be.height/2}).text(function(be){return be.model.categoryLabel}).each(function(be){n.font(w.select(this),be.parcatsViewModel.categorylabelfont),t.convertToTspans(w.select(this),q)}),_e.append("text").attr("class","dimlabel"),Te.select("text.dimlabel").attr("text-anchor","middle").attr("alignment-baseline","baseline").attr("cursor",function(be){return be.parcatsViewModel.arrangement==="fixed"?"default":"ew-resize"}).attr("x",function(be){return be.width/2}).attr("y",-5).text(function(be,Pe){return Pe===0?be.parcatsViewModel.model.dimensions[be.model.dimensionInd].dimensionLabel:null}).each(function(be){n.font(w.select(this),be.parcatsViewModel.labelfont)}),Te.selectAll("rect.bandrect").on("mouseover",R).on("mouseout",B),Te.exit().remove(),ge.call(w.behavior.drag().origin(function(be){return{x:be.x,y:0}}).on("dragstart",F).on("drag",H).on("dragend",G)),ae.each(function(be){be.traceSelection=w.select(this),be.pathSelection=w.select(this).selectAll("g.paths").selectAll("path.path"),be.dimensionSelection=w.select(this).selectAll("g.dimensions").selectAll("g.dimension")}),ae.exit().remove()}ee.exports=function(U,q,$,W){c($,U,W,q)};function o(U){return U.key}function i(U){var q=U.parcatsViewModel.dimensions.length,$=U.parcatsViewModel.dimensions[q-1].model.dimensionInd;return U.model.dimensionInd===$}function y(U,q){return U.model.rawColor>q.model.rawColor?1:U.model.rawColor<q.model.rawColor?-1:0}function p(U){if(!U.parcatsViewModel.dragDimension&&U.parcatsViewModel.hoverinfoItems.indexOf("skip")===-1){e.raiseToTop(this),s(w.select(this));var q=h(U),$=m(U);if(U.parcatsViewModel.graphDiv.emit("plotly_hover",{points:q,event:w.event,constraints:$}),U.parcatsViewModel.hoverinfoItems.indexOf("none")===-1){var W=w.mouse(this)[0],K=U.parcatsViewModel.graphDiv,ne=U.parcatsViewModel.trace,ae=K._fullLayout,ie=ae._paperdiv.node().getBoundingClientRect(),le=U.parcatsViewModel.graphDiv.getBoundingClientRect(),ye,ue,pe;for(pe=0;pe<U.leftXs.length-1;pe++)if(U.leftXs[pe]+U.dimWidths[pe]-2<=W&&W<=U.leftXs[pe+1]+2){var ge=U.parcatsViewModel.dimensions[pe],Te=U.parcatsViewModel.dimensions[pe+1];ye=(ge.x+ge.width+Te.x)/2,ue=(U.topYs[pe]+U.topYs[pe+1]+U.height)/2;break}var _e=U.parcatsViewModel.x+ye,ze=U.parcatsViewModel.y+ue,Oe=r.mostReadable(U.model.color,["black","white"]),Ye=U.model.count,be=Ye/U.parcatsViewModel.model.count,Pe={countLabel:Ye,probabilityLabel:be.toFixed(3)},Ge=[];U.parcatsViewModel.hoverinfoItems.indexOf("count")!==-1&&Ge.push(["Count:",Pe.countLabel].join(" ")),U.parcatsViewModel.hoverinfoItems.indexOf("probability")!==-1&&Ge.push(["P:",Pe.probabilityLabel].join(" "));var Qe=Ge.join("<br>"),Be=w.mouse(K)[0];M.loneHover({trace:ne,x:_e-ie.left+le.left,y:ze-ie.top+le.top,text:Qe,color:U.model.color,borderColor:"black",fontFamily:'Monaco, "Courier New", monospace',fontSize:10,fontColor:Oe,idealAlign:Be<_e?"right":"left",hovertemplate:(ne.line||{}).hovertemplate,hovertemplateLabels:Pe,eventData:[{data:ne._input,fullData:ne,count:Ye,probability:be}]},{container:ae._hoverlayer.node(),outerContainer:ae._paper.node(),gd:K})}}}function g(U){if(!U.parcatsViewModel.dragDimension&&(_(w.select(this)),M.loneUnhover(U.parcatsViewModel.graphDiv._fullLayout._hoverlayer.node()),U.parcatsViewModel.pathSelection.sort(y),U.parcatsViewModel.hoverinfoItems.indexOf("skip")===-1)){var q=h(U),$=m(U);U.parcatsViewModel.graphDiv.emit("plotly_unhover",{points:q,event:w.event,constraints:$})}}function h(U){for(var q=[],$=J(U.parcatsViewModel),W=0;W<U.model.valueInds.length;W++){var K=U.model.valueInds[W];q.push({curveNumber:$,pointNumber:K})}return q}function m(U){for(var q={},$=U.parcatsViewModel.model.dimensions,W=0;W<$.length;W++){var K=$[W],ne=K.categories[U.model.categoryInds[W]];q[K.containerInd]=ne.categoryValue}return U.model.rawColor!==void 0&&(q.color=U.model.rawColor),q}function u(U){if(U.parcatsViewModel.hoverinfoItems.indexOf("skip")===-1){var q=h(U),$=m(U);U.parcatsViewModel.graphDiv.emit("plotly_click",{points:q,event:w.event,constraints:$})}}function _(U){U.attr("fill",function(q){return q.model.color}).attr("fill-opacity",.6).attr("stroke","lightgray").attr("stroke-width",.2).attr("stroke-opacity",1)}function s(U){U.attr("fill-opacity",.8).attr("stroke",function(q){return r.mostReadable(q.model.color,["black","white"])}).attr("stroke-width",.3)}function A(U){U.select("rect.catrect").attr("stroke","black").attr("stroke-width",2.5)}function b(U){U.select("rect.catrect").attr("stroke","black").attr("stroke-width",1).attr("stroke-opacity",1)}function f(U){U.attr("stroke","black").attr("stroke-width",1.5)}function x(U){U.attr("stroke","black").attr("stroke-width",.2).attr("stroke-opacity",1).attr("fill-opacity",1)}function l(U){var q=U.parcatsViewModel.pathSelection,$=U.categoryViewModel.model.dimensionInd,W=U.categoryViewModel.model.categoryInd;return q.filter(function(K){return K.model.categoryInds[$]===W&&K.model.color===U.color})}function L(U){var q=w.select(U.parentNode).selectAll("rect.bandrect");q.each(function($){var W=l($);s(W),W.each(function(){e.raiseToTop(this)})}),A(w.select(U.parentNode))}function T(U){var q=w.select(U).datum(),$=l(q);s($),$.each(function(){e.raiseToTop(this)}),w.select(U.parentNode).selectAll("rect.bandrect").filter(function(W){return W.color===q.color}).each(function(){e.raiseToTop(this),f(w.select(this))})}function k(U,q,$){var W=w.select(U).datum(),K=W.categoryViewModel.model,ne=W.parcatsViewModel.graphDiv,ae=w.select(U.parentNode).selectAll("rect.bandrect"),ie=[];ae.each(function(ye){var ue=l(ye);ue.each(function(pe){Array.prototype.push.apply(ie,h(pe))})});var le={};le[K.dimensionInd]=K.categoryValue,ne.emit(q,{points:ie,event:$,constraints:le})}function P(U,q,$){var W=w.select(U).datum(),K=W.categoryViewModel.model,ne=W.parcatsViewModel.graphDiv,ae=l(W),ie=[];ae.each(function(ye){Array.prototype.push.apply(ie,h(ye))});var le={};le[K.dimensionInd]=K.categoryValue,W.rawColor!==void 0&&(le.color=W.rawColor),ne.emit(q,{points:ie,event:$,constraints:le})}function z(U,q,$){U._fullLayout._calcInverseTransform(U);var W=U._fullLayout._invScaleX,K=U._fullLayout._invScaleY,ne=w.select($.parentNode).select("rect.catrect"),ae=ne.node().getBoundingClientRect(),ie=ne.datum(),le=ie.parcatsViewModel,ye=le.model.dimensions[ie.model.dimensionInd],ue=le.trace,pe=ae.top+ae.height/2,ge,Te;le.dimensions.length>1&&ye.displayInd===le.dimensions.length-1?(ge=ae.left,Te="left"):(ge=ae.left+ae.width,Te="right");var _e=ie.model.count,ze=ie.model.categoryLabel,Oe=_e/ie.parcatsViewModel.model.count,Ye={countLabel:_e,categoryLabel:ze,probabilityLabel:Oe.toFixed(3)},be=[];ie.parcatsViewModel.hoverinfoItems.indexOf("count")!==-1&&be.push(["Count:",Ye.countLabel].join(" ")),ie.parcatsViewModel.hoverinfoItems.indexOf("probability")!==-1&&be.push(["P("+Ye.categoryLabel+"):",Ye.probabilityLabel].join(" "));var Pe=be.join("<br>");return{trace:ue,x:W*(ge-q.left),y:K*(pe-q.top),text:Pe,color:"lightgray",borderColor:"black",fontFamily:'Monaco, "Courier New", monospace',fontSize:12,fontColor:"black",idealAlign:Te,hovertemplate:ue.hovertemplate,hovertemplateLabels:Ye,eventData:[{data:ue._input,fullData:ue,count:_e,category:ze,probability:Oe}]}}function I(U,q,$){var W=[];return w.select($.parentNode.parentNode).selectAll("g.category").select("rect.catrect").each(function(){var K=this;W.push(z(U,q,K))}),W}function D(U,q,$){U._fullLayout._calcInverseTransform(U);var W=U._fullLayout._invScaleX,K=U._fullLayout._invScaleY,ne=$.getBoundingClientRect(),ae=w.select($).datum(),ie=ae.categoryViewModel,le=ie.parcatsViewModel,ye=le.model.dimensions[ie.model.dimensionInd],ue=le.trace,pe=ne.y+ne.height/2,ge,Te;le.dimensions.length>1&&ye.displayInd===le.dimensions.length-1?(ge=ne.left,Te="left"):(ge=ne.left+ne.width,Te="right");var _e=ie.model.categoryLabel,ze=ae.parcatsViewModel.model.count,Oe=0;ae.categoryViewModel.bands.forEach(function(Rt){Rt.color===ae.color&&(Oe+=Rt.count)});var Ye=ie.model.count,be=0;le.pathSelection.each(function(Rt){Rt.model.color===ae.color&&(be+=Rt.model.count)});var Pe=Oe/ze,Ge=Oe/be,Qe=Oe/Ye,Be={countLabel:ze,categoryLabel:_e,probabilityLabel:Pe.toFixed(3)},Le=[];ie.parcatsViewModel.hoverinfoItems.indexOf("count")!==-1&&Le.push(["Count:",Be.countLabel].join(" ")),ie.parcatsViewModel.hoverinfoItems.indexOf("probability")!==-1&&(Le.push("P(color \u2229 "+_e+"): "+Be.probabilityLabel),Le.push("P("+_e+" | color): "+Ge.toFixed(3)),Le.push("P(color | "+_e+"): "+Qe.toFixed(3)));var He=Le.join("<br>"),vt=r.mostReadable(ae.color,["black","white"]);return{trace:ue,x:W*(ge-q.left),y:K*(pe-q.top),text:He,color:ae.color,borderColor:"black",fontFamily:'Monaco, "Courier New", monospace',fontColor:vt,fontSize:10,idealAlign:Te,hovertemplate:ue.hovertemplate,hovertemplateLabels:Be,eventData:[{data:ue._input,fullData:ue,category:_e,count:ze,probability:Pe,categorycount:Ye,colorcount:be,bandcolorcount:Oe}]}}function R(U){if(!U.parcatsViewModel.dragDimension&&U.parcatsViewModel.hoverinfoItems.indexOf("skip")===-1){var q=w.mouse(this)[1];if(q<-1)return;var $=U.parcatsViewModel.graphDiv,W=$._fullLayout,K=W._paperdiv.node().getBoundingClientRect(),ne=U.parcatsViewModel.hoveron,ae=this;if(ne==="color"?(T(ae),P(ae,"plotly_hover",w.event)):(L(ae),k(ae,"plotly_hover",w.event)),U.parcatsViewModel.hoverinfoItems.indexOf("none")===-1){var ie;ne==="category"?ie=z($,K,ae):ne==="color"?ie=D($,K,ae):ne==="dimension"&&(ie=I($,K,ae)),ie&&M.loneHover(ie,{container:W._hoverlayer.node(),outerContainer:W._paper.node(),gd:$})}}}function B(U){var q=U.parcatsViewModel;if(!q.dragDimension&&(_(q.pathSelection),b(q.dimensionSelection.selectAll("g.category")),x(q.dimensionSelection.selectAll("g.category").selectAll("rect.bandrect")),M.loneUnhover(q.graphDiv._fullLayout._hoverlayer.node()),q.pathSelection.sort(y),q.hoverinfoItems.indexOf("skip")===-1)){var $=U.parcatsViewModel.hoveron,W=this;$==="color"?P(W,"plotly_unhover",w.event):k(W,"plotly_unhover",w.event)}}function F(U){U.parcatsViewModel.arrangement!=="fixed"&&(U.dragDimensionDisplayInd=U.model.displayInd,U.initialDragDimensionDisplayInds=U.parcatsViewModel.model.dimensions.map(function(q){return q.displayInd}),U.dragHasMoved=!1,U.dragCategoryDisplayInd=null,w.select(this).selectAll("g.category").select("rect.catrect").each(function(q){var $=w.mouse(this)[0],W=w.mouse(this)[1];-2<=$&&$<=q.width+2&&-2<=W&&W<=q.height+2&&(U.dragCategoryDisplayInd=q.model.displayInd,U.initialDragCategoryDisplayInds=U.model.categories.map(function(K){return K.displayInd}),q.model.dragY=q.y,e.raiseToTop(this.parentNode),w.select(this.parentNode).selectAll("rect.bandrect").each(function(K){K.y<W&&W<=K.y+K.height&&(U.potentialClickBand=this)}))}),U.parcatsViewModel.dragDimension=U,M.loneUnhover(U.parcatsViewModel.graphDiv._fullLayout._hoverlayer.node()))}function H(U){if(U.parcatsViewModel.arrangement!=="fixed"&&(U.dragHasMoved=!0,U.dragDimensionDisplayInd!==null)){var q=U.dragDimensionDisplayInd,$=q-1,W=q+1,K=U.parcatsViewModel.dimensions[q];if(U.dragCategoryDisplayInd!==null){var ne=K.categories[U.dragCategoryDisplayInd];ne.model.dragY+=w.event.dy;var ae=ne.model.dragY,ie=ne.model.displayInd,le=K.categories,ye=le[ie-1],ue=le[ie+1];ye!==void 0&&ae<ye.y+ye.height/2&&(ne.model.displayInd=ye.model.displayInd,ye.model.displayInd=ie),ue!==void 0&&ae+ne.height>ue.y+ue.height/2&&(ne.model.displayInd=ue.model.displayInd,ue.model.displayInd=ie),U.dragCategoryDisplayInd=ne.model.displayInd}if(U.dragCategoryDisplayInd===null||U.parcatsViewModel.arrangement==="freeform"){K.model.dragX=w.event.x;var pe=U.parcatsViewModel.dimensions[$],ge=U.parcatsViewModel.dimensions[W];pe!==void 0&&K.model.dragX<pe.x+pe.width&&(K.model.displayInd=pe.model.displayInd,pe.model.displayInd=q),ge!==void 0&&K.model.dragX+K.width>ge.x&&(K.model.displayInd=ge.model.displayInd,ge.model.displayInd=U.dragDimensionDisplayInd),U.dragDimensionDisplayInd=K.model.displayInd}se(U.parcatsViewModel),re(U.parcatsViewModel),Y(U.parcatsViewModel),X(U.parcatsViewModel)}}function G(U){if(U.parcatsViewModel.arrangement!=="fixed"&&U.dragDimensionDisplayInd!==null){w.select(this).selectAll("text").attr("font-weight","normal");var q={},$=J(U.parcatsViewModel),W=U.parcatsViewModel.model.dimensions.map(function(ge){return ge.displayInd}),K=U.initialDragDimensionDisplayInds.some(function(ge,Te){return ge!==W[Te]});K&&W.forEach(function(ge,Te){var _e=U.parcatsViewModel.model.dimensions[Te].containerInd;q["dimensions["+_e+"].displayindex"]=ge});var ne=!1;if(U.dragCategoryDisplayInd!==null){var ae=U.model.categories.map(function(ge){return ge.displayInd});if(ne=U.initialDragCategoryDisplayInds.some(function(ge,Te){return ge!==ae[Te]}),ne){var ie=U.model.categories.slice().sort(function(ge,Te){return ge.displayInd-Te.displayInd}),le=ie.map(function(ge){return ge.categoryValue}),ye=ie.map(function(ge){return ge.categoryLabel});q["dimensions["+U.model.containerInd+"].categoryarray"]=[le],q["dimensions["+U.model.containerInd+"].ticktext"]=[ye],q["dimensions["+U.model.containerInd+"].categoryorder"]="array"}}if(U.parcatsViewModel.hoverinfoItems.indexOf("skip")===-1&&!U.dragHasMoved&&U.potentialClickBand&&(U.parcatsViewModel.hoveron==="color"?P(U.potentialClickBand,"plotly_click",w.event.sourceEvent):k(U.potentialClickBand,"plotly_click",w.event.sourceEvent)),U.model.dragX=null,U.dragCategoryDisplayInd!==null){var ue=U.parcatsViewModel.dimensions[U.dragDimensionDisplayInd].categories[U.dragCategoryDisplayInd];ue.model.dragY=null,U.dragCategoryDisplayInd=null}U.dragDimensionDisplayInd=null,U.parcatsViewModel.dragDimension=null,U.dragHasMoved=null,U.potentialClickBand=null,se(U.parcatsViewModel),re(U.parcatsViewModel);var pe=w.transition().duration(300).ease("cubic-in-out");pe.each(function(){Y(U.parcatsViewModel,!0),X(U.parcatsViewModel,!0)}).each("end",function(){(K||ne)&&S.restyle(U.parcatsViewModel.graphDiv,q,[$])})}}function J(U){for(var q,$=U.graphDiv._fullData,W=0;W<$.length;W++)if(U.key===$[W].uid){q=W;break}return q}function X(U,q){q===void 0&&(q=!1);function $(W){return q?W.transition():W}U.pathSelection.data(function(W){return W.paths},o),$(U.pathSelection).attr("d",function(W){return W.svgD})}function Y(U,q){q===void 0&&(q=!1);function $(le){return q?le.transition():le}U.dimensionSelection.data(function(le){return le.dimensions},o);var W=U.dimensionSelection.selectAll("g.category").data(function(le){return le.categories},o);$(U.dimensionSelection).attr("transform",function(le){return a(le.x,0)}),$(W).attr("transform",function(le){return a(0,le.y)});var K=W.select(".dimlabel");K.text(function(le,ye){return ye===0?le.parcatsViewModel.model.dimensions[le.model.dimensionInd].dimensionLabel:null});var ne=W.select(".catlabel");ne.attr("text-anchor",function(le){return i(le)?"start":"end"}).attr("x",function(le){return i(le)?le.width+5:-5}).each(function(le){var ye,ue;i(le)?(ye=le.width+5,ue="start"):(ye=-5,ue="end"),w.select(this).selectAll("tspan").attr("x",ye).attr("text-anchor",ue)});var ae=W.selectAll("rect.bandrect").data(function(le){return le.bands},o),ie=ae.enter().append("rect").attr("class","bandrect").attr("cursor","move").attr("stroke-opacity",0).attr("fill",function(le){return le.color}).attr("fill-opacity",0);ae.attr("fill",function(le){return le.color}).attr("width",function(le){return le.width}).attr("height",function(le){return le.height}).attr("y",function(le){return le.y}),x(ie),ae.each(function(){e.raiseToTop(this)}),ae.exit().remove()}function Z(U,q,$){var W=$[0],K=q.margin||{l:80,r:80,t:100,b:80},ne=W.trace,ae=ne.domain,ie=q.width,le=q.height,ye=Math.floor(ie*(ae.x[1]-ae.x[0])),ue=Math.floor(le*(ae.y[1]-ae.y[0])),pe=ae.x[0]*ie+K.l,ge=q.height-ae.y[1]*q.height+K.t,Te=ne.line.shape,_e;ne.hoverinfo==="all"?_e=["count","probability"]:_e=(ne.hoverinfo||"").split("+");var ze={trace:ne,key:ne.uid,model:W,x:pe,y:ge,width:ye,height:ue,hoveron:ne.hoveron,hoverinfoItems:_e,arrangement:ne.arrangement,bundlecolors:ne.bundlecolors,sortpaths:ne.sortpaths,labelfont:ne.labelfont,categorylabelfont:ne.tickfont,pathShape:Te,dragDimension:null,margin:K,paths:[],dimensions:[],graphDiv:U,traceSelection:null,pathSelection:null,dimensionSelection:null};return W.dimensions&&(se(ze),re(ze)),ze}function oe(U,q,$,W,K){var ne=[],ae=[],ie,le;for(le=0;le<$.length-1;le++)ie=v($[le]+U[le],U[le+1]),ne.push(ie(K)),ae.push(ie(1-K));var ye="M "+U[0]+","+q[0];for(ye+="l"+$[0]+",0 ",le=1;le<$.length;le++)ye+="C"+ne[le-1]+","+q[le-1]+" "+ae[le-1]+","+q[le]+" "+U[le]+","+q[le],ye+="l"+$[le]+",0 ";for(ye+="l0,"+W+" ",ye+="l -"+$[$.length-1]+",0 ",le=$.length-2;le>=0;le--)ye+="C"+ae[le]+","+(q[le+1]+W)+" "+ne[le]+","+(q[le]+W)+" "+(U[le]+$[le])+","+(q[le]+W),ye+="l-"+$[le]+",0 ";return ye+="Z",ye}function re(U){var q=U.dimensions,$=U.model,W=q.map(function(Ft){return Ft.categories.map(function(Gt){return Gt.y})}),K=U.model.dimensions.map(function(Ft){return Ft.categories.map(function(Gt){return Gt.displayInd})}),ne=U.model.dimensions.map(function(Ft){return Ft.displayInd}),ae=U.dimensions.map(function(Ft){return Ft.model.dimensionInd}),ie=q.map(function(Ft){return Ft.x}),le=q.map(function(Ft){return Ft.width}),ye=[];for(var ue in $.paths)$.paths.hasOwnProperty(ue)&&ye.push($.paths[ue]);function pe(Ft){var Gt=Ft.categoryInds.map(function(kt,Ue){return K[Ue][kt]}),Dt=ae.map(function(kt){return Gt[kt]});return Dt}ye.sort(function(Ft,Gt){var Dt=pe(Ft),kt=pe(Gt);return U.sortpaths==="backward"&&(Dt.reverse(),kt.reverse()),Dt.push(Ft.valueInds[0]),kt.push(Gt.valueInds[0]),U.bundlecolors&&(Dt.unshift(Ft.rawColor),kt.unshift(Gt.rawColor)),Dt<kt?-1:Dt>kt?1:0});for(var ge=new Array(ye.length),Te=q[0].model.count,_e=q[0].categories.map(function(Ft){return Ft.height}).reduce(function(Ft,Gt){return Ft+Gt}),ze=0;ze<ye.length;ze++){var Oe=ye[ze],Ye;Te>0?Ye=_e*(Oe.count/Te):Ye=0;for(var be=new Array(W.length),Pe=0;Pe<Oe.categoryInds.length;Pe++){var Ge=Oe.categoryInds[Pe],Qe=K[Pe][Ge],Be=ne[Pe];be[Be]=W[Be][Qe],W[Be][Qe]+=Ye;var Le=U.dimensions[Be].categories[Qe],He=Le.bands.length,vt=Le.bands[He-1];if(vt===void 0||Oe.rawColor!==vt.rawColor){var Rt=vt===void 0?0:vt.y+vt.height;Le.bands.push({key:Rt,color:Oe.color,rawColor:Oe.rawColor,height:Ye,width:Le.width,count:Oe.count,y:Rt,categoryViewModel:Le,parcatsViewModel:U})}else{var rr=Le.bands[He-1];rr.height+=Ye,rr.count+=Oe.count}}var Lt;U.pathShape==="hspline"?Lt=oe(ie,be,le,Ye,.5):Lt=oe(ie,be,le,Ye,0),ge[ze]={key:Oe.valueInds[0],model:Oe,height:Ye,leftXs:ie,topYs:be,dimWidths:le,svgD:Lt,parcatsViewModel:U}}U.paths=ge}function se(U){var q=U.model.dimensions.map(function(ae){return{displayInd:ae.displayInd,dimensionInd:ae.dimensionInd}});q.sort(function(ae,ie){return ae.displayInd-ie.displayInd});var $=[];for(var W in q){var K=q[W].dimensionInd,ne=U.model.dimensions[K];$.push(N(U,ne))}U.dimensions=$}function N(U,q){var $=40,W=16,K=U.model.dimensions.length,ne=q.displayInd,ae,ie,le;K>1?ae=(U.width-2*$-W)/(K-1):ae=0,ie=$,le=ie+ae*ne;var ye=[],ue=U.model.maxCats,pe=q.categories.length,ge=8,Te=q.count,_e=U.height-ge*(ue-1),ze,Oe,Ye,be,Pe,Ge=(ue-pe)*ge/2,Qe=q.categories.map(function(Be){return{displayInd:Be.displayInd,categoryInd:Be.categoryInd}});for(Qe.sort(function(Be,Le){return Be.displayInd-Le.displayInd}),Pe=0;Pe<pe;Pe++)be=Qe[Pe].categoryInd,Oe=q.categories[be],Te>0?ze=Oe.count/Te*_e:ze=0,Ye={key:Oe.valueInds[0],model:Oe,width:W,height:ze,y:Oe.dragY!==null?Oe.dragY:Ge,bands:[],parcatsViewModel:U},Ge=Ge+ze+ge,ye.push(Ye);return{key:q.dimensionInd,x:q.dragX!==null?q.dragX:le,y:0,width:W,model:q,categories:ye,parcatsViewModel:U,dragCategoryDisplayInd:null,dragDimensionDisplayInd:null,initialDragDimensionDisplayInds:null,initialDragCategoryDisplayInds:null,dragHasMoved:null,potentialClickBand:null}}},{"../../components/drawing":389,"../../components/fx":407,"../../lib":515,"../../lib/svg_text_utils":541,"../../plot_api/plot_api":552,"@plotly/d3":58,"d3-interpolate":116,tinycolor2:313}],896:[function(d,ee,te){var w=d("./parcats");ee.exports=function(S,M,e,a){var n=S._fullLayout,r=n._paper,t=n._size;w(S,r,M,{width:t.w,height:t.h,margin:{t:t.t,r:t.r,b:t.b,l:t.l}},e,a)}},{"./parcats":895}],897:[function(d,ee,te){var w=d("../../components/colorscale/attributes"),v=d("../../plots/cartesian/layout_attributes"),S=d("../../plots/font_attributes"),M=d("../../plots/domain").attributes,e=d("../../lib/extend").extendFlat,a=d("../../plot_api/plot_template").templatedArray;ee.exports={domain:M({name:"parcoords",trace:!0,editType:"plot"}),labelangle:{valType:"angle",dflt:0,editType:"plot"},labelside:{valType:"enumerated",values:["top","bottom"],dflt:"top",editType:"plot"},labelfont:S({editType:"plot"}),tickfont:S({editType:"plot"}),rangefont:S({editType:"plot"}),dimensions:a("dimension",{label:{valType:"string",editType:"plot"},tickvals:e({},v.tickvals,{editType:"plot"}),ticktext:e({},v.ticktext,{editType:"plot"}),tickformat:e({},v.tickformat,{editType:"plot"}),visible:{valType:"boolean",dflt:!0,editType:"plot"},range:{valType:"info_array",items:[{valType:"number",editType:"plot"},{valType:"number",editType:"plot"}],editType:"plot"},constraintrange:{valType:"info_array",freeLength:!0,dimensions:"1-2",items:[{valType:"any",editType:"plot"},{valType:"any",editType:"plot"}],editType:"plot"},multiselect:{valType:"boolean",dflt:!0,editType:"plot"},values:{valType:"data_array",editType:"calc"},editType:"calc"}),line:e({editType:"calc"},w("line",{colorscaleDflt:"Viridis",autoColorDflt:!1,editTypeOverride:"calc"})),unselected:{line:{color:{valType:"color",dflt:"#7f7f7f",editType:"plot"},opacity:{valType:"number",min:0,max:1,dflt:"auto",editType:"plot"},editType:"plot"},editType:"plot"}}},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plot_api/plot_template":555,"../../plots/cartesian/layout_attributes":579,"../../plots/domain":593,"../../plots/font_attributes":594}],898:[function(d,ee,te){var w=d("./constants"),v=d("@plotly/d3"),S=d("../../lib/gup").keyFun,M=d("../../lib/gup").repeat,e=d("../../lib").sorterAsc,a=d("../../lib").strTranslate,n=w.bar.snapRatio;function r(G,J){return G*(1-n)+J*n}var t=w.bar.snapClose;function c(G,J){return G*(1-t)+J*t}function o(G,J,X,Y){if(i(X,Y))return X;var Z=G?-1:1,oe=0,re=J.length-1;if(Z<0){var se=oe;oe=re,re=se}for(var N=J[oe],U=N,q=oe;Z*q<Z*re;q+=Z){var $=q+Z,W=J[$];if(Z*X<Z*c(N,W))return r(N,U);if(Z*X<Z*W||$===re)return r(W,N);U=N,N=W}}function i(G,J){for(var X=0;X<J.length;X++)if(G>=J[X][0]&&G<=J[X][1])return!0;return!1}function y(G){G.attr("x",-w.bar.captureWidth/2).attr("width",w.bar.captureWidth)}function p(G){G.attr("visibility","visible").style("visibility","visible").attr("fill","yellow").attr("opacity",0)}function g(G){if(!G.brush.filterSpecified)return"0,"+G.height;for(var J=h(G.brush.filter.getConsolidated(),G.height),X=[0],Y,Z,oe,re=J.length?J[0][0]:null,se=0;se<J.length;se++)Y=J[se],Z=Y[1]-Y[0],X.push(re),X.push(Z),oe=se+1,oe<J.length&&(re=J[oe][0]-Y[1]);return X.push(G.height),X}function h(G,J){return G.map(function(X){return X.map(function(Y){return Math.max(0,Y*J)}).sort(e)})}function m(G,J){var X=w.bar.handleHeight;if(!(J>G[1]+X||J<G[0]-X))return J>=.9*G[1]+.1*G[0]?"n":J<=.9*G[0]+.1*G[1]?"s":"ns"}function u(){v.select(document.body).style("cursor",null)}function _(G){G.attr("stroke-dasharray",g)}function s(G,J){var X=v.select(G).selectAll(".highlight, .highlight-shadow"),Y=J?X.transition().duration(w.bar.snapDuration).each("end",J):X;_(Y)}function A(G,J){var X=G.brush,Y=X.filterSpecified,Z=NaN,oe={},re;if(Y){var se=G.height,N=X.filter.getConsolidated(),U=h(N,se),q=NaN,$=NaN,W=NaN;for(re=0;re<=U.length;re++){var K=U[re];if(K&&K[0]<=J&&J<=K[1]){q=re;break}else if($=re?re-1:NaN,K&&K[0]>J){W=re;break}}if(Z=q,isNaN(Z)&&(isNaN($)||isNaN(W)?Z=isNaN($)?W:$:Z=J-U[$][1]<U[W][0]-J?$:W),!isNaN(Z)){var ne=U[Z],ae=m(ne,J);ae&&(oe.interval=N[Z],oe.intervalPix=ne,oe.region=ae)}}if(G.ordinal&&!oe.region){var ie=G.unitTickvals,le=G.unitToPaddedPx.invert(J);for(re=0;re<ie.length;re++){var ye=[ie[Math.max(re-1,0)]*.25+ie[re]*.75,ie[Math.min(re+1,ie.length-1)]*.25+ie[re]*.75];if(le>=ye[0]&&le<=ye[1]){oe.clickableOrdinalRange=ye;break}}}return oe}function b(G,J){v.event.sourceEvent.stopPropagation();var X=J.height-v.mouse(G)[1]-2*w.verticalPadding,Y=J.unitToPaddedPx.invert(X),Z=J.brush,oe=A(J,X),re=oe.interval,se=Z.svgBrush;if(se.wasDragged=!1,se.grabbingBar=oe.region==="ns",se.grabbingBar){var N=re.map(J.unitToPaddedPx);se.grabPoint=X-N[0]-w.verticalPadding,se.barLength=N[1]-N[0]}se.clickableOrdinalRange=oe.clickableOrdinalRange,se.stayingIntervals=J.multiselect&&Z.filterSpecified?Z.filter.getConsolidated():[],re&&(se.stayingIntervals=se.stayingIntervals.filter(function(U){return U[0]!==re[0]&&U[1]!==re[1]})),se.startExtent=oe.region?re[oe.region==="s"?1:0]:Y,J.parent.inBrushDrag=!0,se.brushStartCallback()}function f(G,J){v.event.sourceEvent.stopPropagation();var X=J.height-v.mouse(G)[1]-2*w.verticalPadding,Y=J.brush.svgBrush;Y.wasDragged=!0,Y._dragging=!0,Y.grabbingBar?Y.newExtent=[X-Y.grabPoint,X+Y.barLength-Y.grabPoint].map(J.unitToPaddedPx.invert):Y.newExtent=[Y.startExtent,J.unitToPaddedPx.invert(X)].sort(e),J.brush.filterSpecified=!0,Y.extent=Y.stayingIntervals.concat([Y.newExtent]),Y.brushCallback(J),s(G.parentNode)}function x(G,J){var X=J.brush,Y=X.filter,Z=X.svgBrush;Z._dragging||(l(G,J),f(G,J),J.brush.svgBrush.wasDragged=!1),Z._dragging=!1;var oe=v.event;oe.sourceEvent.stopPropagation();var re=Z.grabbingBar;if(Z.grabbingBar=!1,Z.grabLocation=void 0,J.parent.inBrushDrag=!1,u(),!Z.wasDragged){Z.wasDragged=void 0,Z.clickableOrdinalRange?X.filterSpecified&&J.multiselect?Z.extent.push(Z.clickableOrdinalRange):(Z.extent=[Z.clickableOrdinalRange],X.filterSpecified=!0):re?(Z.extent=Z.stayingIntervals,Z.extent.length===0&&I(X)):I(X),Z.brushCallback(J),s(G.parentNode),Z.brushEndCallback(X.filterSpecified?Y.getConsolidated():[]);return}var se=function(){Y.set(Y.getConsolidated())};if(J.ordinal){var N=J.unitTickvals;N[N.length-1]<N[0]&&N.reverse(),Z.newExtent=[o(0,N,Z.newExtent[0],Z.stayingIntervals),o(1,N,Z.newExtent[1],Z.stayingIntervals)];var U=Z.newExtent[1]>Z.newExtent[0];Z.extent=Z.stayingIntervals.concat(U?[Z.newExtent]:[]),Z.extent.length||I(X),Z.brushCallback(J),U?s(G.parentNode,se):(se(),s(G.parentNode))}else se();Z.brushEndCallback(X.filterSpecified?Y.getConsolidated():[])}function l(G,J){var X=J.height-v.mouse(G)[1]-2*w.verticalPadding,Y=A(J,X),Z="crosshair";Y.clickableOrdinalRange?Z="pointer":Y.region&&(Z=Y.region+"-resize"),v.select(document.body).style("cursor",Z)}function L(G){G.on("mousemove",function(J){v.event.preventDefault(),J.parent.inBrushDrag||l(this,J)}).on("mouseleave",function(J){J.parent.inBrushDrag||u()}).call(v.behavior.drag().on("dragstart",function(J){b(this,J)}).on("drag",function(J){f(this,J)}).on("dragend",function(J){x(this,J)}))}function T(G,J){return G[0]-J[0]}function k(G,J){var X=G.selectAll(".background").data(M);X.enter().append("rect").classed("background",!0).call(y).call(p).style("pointer-events","auto").attr("transform",a(0,w.verticalPadding)),X.call(L).attr("height",function(oe){return oe.height-w.verticalPadding});var Y=G.selectAll(".highlight-shadow").data(M);Y.enter().append("line").classed("highlight-shadow",!0).attr("x",-w.bar.width/2).attr("stroke-width",w.bar.width+w.bar.strokeWidth).attr("stroke",J).attr("opacity",w.bar.strokeOpacity).attr("stroke-linecap","butt"),Y.attr("y1",function(oe){return oe.height}).call(_);var Z=G.selectAll(".highlight").data(M);Z.enter().append("line").classed("highlight",!0).attr("x",-w.bar.width/2).attr("stroke-width",w.bar.width-w.bar.strokeWidth).attr("stroke",w.bar.fillColor).attr("opacity",w.bar.fillOpacity).attr("stroke-linecap","butt"),Z.attr("y1",function(oe){return oe.height}).call(_)}function P(G,J){var X=G.selectAll("."+w.cn.axisBrush).data(M,S);X.enter().append("g").classed(w.cn.axisBrush,!0),k(X,J)}function z(G){return G.svgBrush.extent.map(function(J){return J.slice()})}function I(G){G.filterSpecified=!1,G.svgBrush.extent=[[-1/0,1/0]]}function D(G){return function(X){var Y=X.brush,Z=z(Y),oe=Z.slice();Y.filter.set(oe),G()}}function R(G){for(var J=G.slice(),X=[],Y,Z=J.shift();Z;){for(Y=Z.slice();(Z=J.shift())&&Z[0]<=Y[1];)Y[1]=Math.max(Y[1],Z[1]);X.push(Y)}return X.length===1&&X[0][0]>X[0][1]&&(X=[]),X}function B(){var G=[],J,X;return{set:function(Y){G=Y.map(function(Z){return Z.slice().sort(e)}).sort(T),G.length===1&&G[0][0]===-1/0&&G[0][1]===1/0&&(G=[[0,-1]]),J=R(G),X=G.reduce(function(Z,oe){return[Math.min(Z[0],oe[0]),Math.max(Z[1],oe[1])]},[1/0,-1/0])},get:function(){return G.slice()},getConsolidated:function(){return J},getBounds:function(){return X}}}function F(G,J,X,Y,Z,oe){var re=B();return re.set(X),{filter:re,filterSpecified:J,svgBrush:{extent:[],brushStartCallback:Y,brushCallback:D(Z),brushEndCallback:oe}}}function H(G,J){if(Array.isArray(G[0])?(G=G.map(function(Y){return Y.sort(e)}),J.multiselect?G=R(G.sort(T)):G=[G[0]]):G=[G.sort(e)],J.tickvals){var X=J.tickvals.slice().sort(e);if(G=G.map(function(Y){var Z=[o(0,X,Y[0],[]),o(1,X,Y[1],[])];if(Z[1]>Z[0])return Z}).filter(function(Y){return Y}),!G.length)return}return G.length>1?G:G[0]}ee.exports={makeBrush:F,ensureAxisBrush:P,cleanRanges:H}},{"../../lib":515,"../../lib/gup":512,"./constants":902,"@plotly/d3":58}],899:[function(d,ee,te){ee.exports={attributes:d("./attributes"),supplyDefaults:d("./defaults"),calc:d("./calc"),colorbar:{container:"line",min:"cmin",max:"cmax"},moduleType:"trace",name:"parcoords",basePlotModule:d("./base_plot"),categories:["gl","regl","noOpacity","noHover"],meta:{}}},{"./attributes":897,"./base_plot":900,"./calc":901,"./defaults":903}],900:[function(d,ee,te){var w=d("@plotly/d3"),v=d("../../plots/get_data").getModuleCalcData,S=d("./plot"),M=d("../../constants/xmlns_namespaces");te.name="parcoords",te.plot=function(e){var a=v(e.calcdata,"parcoords")[0];a.length&&S(e,a)},te.clean=function(e,a,n,r){var t=r._has&&r._has("parcoords"),c=a._has&&a._has("parcoords");t&&!c&&(r._paperdiv.selectAll(".parcoords").remove(),r._glimages.selectAll("*").remove())},te.toSVG=function(e){var a=e._fullLayout._glimages,n=w.select(e).selectAll(".svg-container"),r=n.filter(function(c,o){return o===n.size()-1}).selectAll(".gl-canvas-context, .gl-canvas-focus");function t(){var c=this,o=c.toDataURL("image/png"),i=a.append("svg:image");i.attr({xmlns:M.svg,"xlink:href":o,preserveAspectRatio:"none",x:0,y:0,width:c.style.width,height:c.style.height})}r.each(t),window.setTimeout(function(){w.selectAll("#filterBarPattern").attr("id","filterBarPattern")},60)}},{"../../constants/xmlns_namespaces":492,"../../plots/get_data":602,"./plot":909,"@plotly/d3":58}],901:[function(d,ee,te){var w=d("../../lib").isArrayOrTypedArray,v=d("../../components/colorscale"),S=d("../../lib/gup").wrap;ee.exports=function(a,n){var r,t;return v.hasColorscale(n,"line")&&w(n.line.color)?(r=n.line.color,t=v.extractOpts(n.line).colorscale,v.calc(a,n,{vals:r,containerStr:"line",cLetter:"c"})):(r=M(n._length),t=[[0,n.line.color],[1,n.line.color]]),S({lineColor:r,cscale:t})};function M(e){for(var a=new Array(e),n=0;n<e;n++)a[n]=.5;return a}},{"../../components/colorscale":379,"../../lib":515,"../../lib/gup":512}],902:[function(d,ee,te){ee.exports={maxDimensionCount:60,overdrag:45,verticalPadding:2,tickDistance:50,canvasPixelRatio:1,blockLineCount:5e3,layers:["contextLineLayer","focusLineLayer","pickLineLayer"],axisTitleOffset:28,axisExtentOffset:10,bar:{width:4,captureWidth:10,fillColor:"magenta",fillOpacity:1,snapDuration:150,snapRatio:.25,snapClose:.01,strokeOpacity:1,strokeWidth:1,handleHeight:8,handleOpacity:1,handleOverlap:0},cn:{axisExtentText:"axis-extent-text",parcoordsLineLayers:"parcoords-line-layers",parcoordsLineLayer:"parcoords-lines",parcoords:"parcoords",parcoordsControlView:"parcoords-control-view",yAxis:"y-axis",axisOverlays:"axis-overlays",axis:"axis",axisHeading:"axis-heading",axisTitle:"axis-title",axisExtent:"axis-extent",axisExtentTop:"axis-extent-top",axisExtentTopText:"axis-extent-top-text",axisExtentBottom:"axis-extent-bottom",axisExtentBottomText:"axis-extent-bottom-text",axisBrush:"axis-brush"},id:{filterBarPattern:"filter-bar-pattern"}}},{}],903:[function(d,ee,te){var w=d("../../lib"),v=d("../../components/colorscale/helpers").hasColorscale,S=d("../../components/colorscale/defaults"),M=d("../../plots/domain").defaults,e=d("../../plots/array_container_defaults"),a=d("../../plots/cartesian/axes"),n=d("./attributes"),r=d("./axisbrush"),t=d("./constants").maxDimensionCount,c=d("./merge_length");function o(y,p,g,h,m){var u=m("line.color",g);if(v(y,"line")&&w.isArrayOrTypedArray(u)){if(u.length)return m("line.colorscale"),S(y,p,h,m,{prefix:"line.",cLetter:"c"}),u.length;p.line.color=g}return 1/0}function i(y,p,g,h){function m(b,f){return w.coerce(y,p,n.dimensions,b,f)}var u=m("values"),_=m("visible");if(u&&u.length||(_=p.visible=!1),_){m("label"),m("tickvals"),m("ticktext"),m("tickformat");var s=m("range");p._ax={_id:"y",type:"linear",showexponent:"all",exponentformat:"B",range:s},a.setConvert(p._ax,h.layout),m("multiselect");var A=m("constraintrange");A&&(p.constraintrange=r.cleanRanges(A,p))}}ee.exports=function(p,g,h,m){function u(f,x){return w.coerce(p,g,n,f,x)}var _=p.dimensions;Array.isArray(_)&&_.length>t&&(w.log("parcoords traces support up to "+t+" dimensions at the moment"),_.splice(t));var s=e(p,g,{name:"dimensions",layout:m,handleItemDefaults:i}),A=o(p,g,h,m,u);M(g,m,u),(!Array.isArray(s)||!s.length)&&(g.visible=!1),c(g,s,"values",A);var b={family:m.font.family,size:Math.round(m.font.size/1.2),color:m.font.color};w.coerceFont(u,"labelfont",b),w.coerceFont(u,"tickfont",b),w.coerceFont(u,"rangefont",b),u("labelangle"),u("labelside"),u("unselected.line.color"),u("unselected.line.opacity")}},{"../../components/colorscale/defaults":377,"../../components/colorscale/helpers":378,"../../lib":515,"../../plots/array_container_defaults":561,"../../plots/cartesian/axes":566,"../../plots/domain":593,"./attributes":897,"./axisbrush":898,"./constants":902,"./merge_length":907}],904:[function(d,ee,te){var w=d("../../lib").isTypedArray;te.convertTypedArray=function(v){return w(v)?Array.prototype.slice.call(v):v},te.isOrdinal=function(v){return!!v.tickvals},te.isVisible=function(v){return v.visible||!("visible"in v)}},{"../../lib":515}],905:[function(d,ee,te){var w=d("./base_index");w.plot=d("./plot"),ee.exports=w},{"./base_index":899,"./plot":909}],906:[function(d,ee,te){var w=d("glslify"),v=w([`precision highp float;
#define GLSLIFY 1

varying vec4 fragColor;

attribute vec4 p01_04, p05_08, p09_12, p13_16,
               p17_20, p21_24, p25_28, p29_32,
               p33_36, p37_40, p41_44, p45_48,
               p49_52, p53_56, p57_60, colors;

uniform mat4 dim0A, dim1A, dim0B, dim1B, dim0C, dim1C, dim0D, dim1D,
             loA, hiA, loB, hiB, loC, hiC, loD, hiD;

uniform vec2 resolution, viewBoxPos, viewBoxSize;
uniform float maskHeight;
uniform float drwLayer; // 0: context, 1: focus, 2: pick
uniform vec4 contextColor;
uniform sampler2D maskTexture, palette;

bool isPick    = (drwLayer > 1.5);
bool isContext = (drwLayer < 0.5);

const vec4 ZEROS = vec4(0.0, 0.0, 0.0, 0.0);
const vec4 UNITS = vec4(1.0, 1.0, 1.0, 1.0);

float val(mat4 p, mat4 v) {
    return dot(matrixCompMult(p, v) * UNITS, UNITS);
}

float axisY(float ratio, mat4 A, mat4 B, mat4 C, mat4 D) {
    float y1 = val(A, dim0A) + val(B, dim0B) + val(C, dim0C) + val(D, dim0D);
    float y2 = val(A, dim1A) + val(B, dim1B) + val(C, dim1C) + val(D, dim1D);
    return y1 * (1.0 - ratio) + y2 * ratio;
}

int iMod(int a, int b) {
    return a - b * (a / b);
}

bool fOutside(float p, float lo, float hi) {
    return (lo < hi) && (lo > p || p > hi);
}

bool vOutside(vec4 p, vec4 lo, vec4 hi) {
    return (
        fOutside(p[0], lo[0], hi[0]) ||
        fOutside(p[1], lo[1], hi[1]) ||
        fOutside(p[2], lo[2], hi[2]) ||
        fOutside(p[3], lo[3], hi[3])
    );
}

bool mOutside(mat4 p, mat4 lo, mat4 hi) {
    return (
        vOutside(p[0], lo[0], hi[0]) ||
        vOutside(p[1], lo[1], hi[1]) ||
        vOutside(p[2], lo[2], hi[2]) ||
        vOutside(p[3], lo[3], hi[3])
    );
}

bool outsideBoundingBox(mat4 A, mat4 B, mat4 C, mat4 D) {
    return mOutside(A, loA, hiA) ||
           mOutside(B, loB, hiB) ||
           mOutside(C, loC, hiC) ||
           mOutside(D, loD, hiD);
}

bool outsideRasterMask(mat4 A, mat4 B, mat4 C, mat4 D) {
    mat4 pnts[4];
    pnts[0] = A;
    pnts[1] = B;
    pnts[2] = C;
    pnts[3] = D;

    for(int i = 0; i < 4; ++i) {
        for(int j = 0; j < 4; ++j) {
            for(int k = 0; k < 4; ++k) {
                if(0 == iMod(
                    int(255.0 * texture2D(maskTexture,
                        vec2(
                            (float(i * 2 + j / 2) + 0.5) / 8.0,
                            (pnts[i][j][k] * (maskHeight - 1.0) + 1.0) / maskHeight
                        ))[3]
                    ) / int(pow(2.0, float(iMod(j * 4 + k, 8)))),
                    2
                )) return true;
            }
        }
    }
    return false;
}

vec4 position(bool isContext, float v, mat4 A, mat4 B, mat4 C, mat4 D) {
    float x = 0.5 * sign(v) + 0.5;
    float y = axisY(x, A, B, C, D);
    float z = 1.0 - abs(v);

    z += isContext ? 0.0 : 2.0 * float(
        outsideBoundingBox(A, B, C, D) ||
        outsideRasterMask(A, B, C, D)
    );

    return vec4(
        2.0 * (vec2(x, y) * viewBoxSize + viewBoxPos) / resolution - 1.0,
        z,
        1.0
    );
}

void main() {
    mat4 A = mat4(p01_04, p05_08, p09_12, p13_16);
    mat4 B = mat4(p17_20, p21_24, p25_28, p29_32);
    mat4 C = mat4(p33_36, p37_40, p41_44, p45_48);
    mat4 D = mat4(p49_52, p53_56, p57_60, ZEROS);

    float v = colors[3];

    gl_Position = position(isContext, v, A, B, C, D);

    fragColor =
        isContext ? vec4(contextColor) :
        isPick ? vec4(colors.rgb, 1.0) : texture2D(palette, vec2(abs(v), 0.5));
}
`]),S=w([`precision highp float;
#define GLSLIFY 1

varying vec4 fragColor;

void main() {
    gl_FragColor = fragColor;
}
`]),M=d("./constants").maxDimensionCount,e=d("../../lib"),a=1e-6,n=2048,r=new Uint8Array(4),t=new Uint8Array(4),c={shape:[256,1],format:"rgba",type:"uint8",mag:"nearest",min:"nearest"};function o(l){l.read({x:0,y:0,width:1,height:1,data:r})}function i(l,L,T,k,P){var z=l._gl;z.enable(z.SCISSOR_TEST),z.scissor(L,T,k,P),l.clear({color:[0,0,0,0],depth:1})}function y(l,L,T,k,P,z){var I=z.key;function D(R){var B=Math.min(k,P-R*k);R===0&&(window.cancelAnimationFrame(T.currentRafs[I]),delete T.currentRafs[I],i(l,z.scissorX,z.scissorY,z.scissorWidth,z.viewBoxSize[1])),!T.clearOnly&&(z.count=2*B,z.offset=2*R*k,L(z),R*k+B<P&&(T.currentRafs[I]=window.requestAnimationFrame(function(){D(R+1)})),T.drawCompleted=!1)}T.drawCompleted||(o(l),T.drawCompleted=!0),D(0)}function p(l){return Math.max(a,Math.min(1-a,l))}function g(l,L){for(var T=new Array(256),k=0;k<256;k++)T[k]=l(k/255).concat(L);return T}function h(l,L){return(l>>>8*L)%256/255}function m(l,L,T){for(var k=new Array(l*(M+4)),P=0,z=0;z<l;z++){for(var I=0;I<M;I++)k[P++]=I<L.length?L[I].paddedUnitValues[z]:.5;k[P++]=h(z,2),k[P++]=h(z,1),k[P++]=h(z,0),k[P++]=p(T[z])}return k}function u(l,L,T){for(var k=new Array(L*8),P=0,z=0;z<L;z++)for(var I=0;I<2;I++)for(var D=0;D<4;D++){var R=l*4+D,B=T[z*64+R];R===63&&I===0&&(B*=-1),k[P++]=B}return k}function _(l){var L="0"+l;return L.substr(L.length-2)}function s(l){return l<M?"p"+_(l+1)+"_"+_(l+4):"colors"}function A(l,L,T){for(var k=0;k<=M;k+=4)l[s(k)](u(k/4,L,T))}function b(l){for(var L={},T=0;T<=M;T+=4)L[s(T)]=l.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)});return L}function f(l,L,T,k,P,z,I,D,R,B,F,H,G,J){for(var X=[[],[]],Y=0;Y<64;Y++)X[0][Y]=Y===P?1:0,X[1][Y]=Y===z?1:0;I*=J,D*=J,R*=J,B*=J;var Z=l.lines.canvasOverdrag*J,oe=l.domain,re=l.canvasWidth*J,se=l.canvasHeight*J,N=l.pad.l*J,U=l.pad.b*J,q=l.layoutHeight*J,$=l.layoutWidth*J,W=l.deselectedLines.color,K=l.deselectedLines.opacity,ne=e.extendFlat({key:F,resolution:[re,se],viewBoxPos:[I+Z,D],viewBoxSize:[R,B],i0:P,i1:z,dim0A:X[0].slice(0,16),dim0B:X[0].slice(16,32),dim0C:X[0].slice(32,48),dim0D:X[0].slice(48,64),dim1A:X[1].slice(0,16),dim1B:X[1].slice(16,32),dim1C:X[1].slice(32,48),dim1D:X[1].slice(48,64),drwLayer:H,contextColor:[W[0]/255,W[1]/255,W[2]/255,K!=="auto"?W[3]*K:Math.max(1/255,Math.pow(1/l.lines.color.length,1/3))],scissorX:(k===L?0:I+Z)+(N-Z)+$*oe.x[0],scissorWidth:(k===T?re-I+Z:R+.5)+(k===L?I+Z:0),scissorY:D+U+q*oe.y[0],scissorHeight:B,viewportX:N-Z+$*oe.x[0],viewportY:U+q*oe.y[0],viewportWidth:re,viewportHeight:se},G);return ne}function x(l){var L=n-1,T=Math.max(0,Math.floor(l[0]*L),0),k=Math.min(L,Math.ceil(l[1]*L),L);return[Math.min(T,k),Math.max(T,k)]}ee.exports=function(l,L){var T=L.context,k=L.pick,P=L.regl,z=P._gl,I=z.getParameter(z.ALIASED_LINE_WIDTH_RANGE),D=Math.max(I[0],Math.min(I[1],L.viewModel.plotGlPixelRatio)),R={currentRafs:{},drawCompleted:!0,clearOnly:!1},B,F,H,G,J=b(P),X,Y=P.texture(c),Z=[];re(L);var oe=P({profile:!1,blend:{enable:T,func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:1,dstAlpha:1},equation:{rgb:"add",alpha:"add"},color:[0,0,0,0]},depth:{enable:!T,mask:!0,func:"less",range:[0,1]},cull:{enable:!0,face:"back"},scissor:{enable:!0,box:{x:P.prop("scissorX"),y:P.prop("scissorY"),width:P.prop("scissorWidth"),height:P.prop("scissorHeight")}},viewport:{x:P.prop("viewportX"),y:P.prop("viewportY"),width:P.prop("viewportWidth"),height:P.prop("viewportHeight")},dither:!1,vert:v,frag:S,primitive:"lines",lineWidth:D,attributes:J,uniforms:{resolution:P.prop("resolution"),viewBoxPos:P.prop("viewBoxPos"),viewBoxSize:P.prop("viewBoxSize"),dim0A:P.prop("dim0A"),dim1A:P.prop("dim1A"),dim0B:P.prop("dim0B"),dim1B:P.prop("dim1B"),dim0C:P.prop("dim0C"),dim1C:P.prop("dim1C"),dim0D:P.prop("dim0D"),dim1D:P.prop("dim1D"),loA:P.prop("loA"),hiA:P.prop("hiA"),loB:P.prop("loB"),hiB:P.prop("hiB"),loC:P.prop("loC"),hiC:P.prop("hiC"),loD:P.prop("loD"),hiD:P.prop("hiD"),palette:Y,contextColor:P.prop("contextColor"),maskTexture:P.prop("maskTexture"),drwLayer:P.prop("drwLayer"),maskHeight:P.prop("maskHeight")},offset:P.prop("offset"),count:P.prop("count")});function re(W){B=W.model,F=W.viewModel,H=F.dimensions.slice(),G=H[0]?H[0].values.length:0;var K=B.lines,ne=k?K.color.map(function(ie,le){return le/K.color.length}):K.color,ae=m(G,H,ne);A(J,G,ae),!T&&!k&&(Y=P.texture(e.extendFlat({data:g(B.unitToColor,255)},c)))}function se(W){var K,ne,ae,ie=[[],[]];for(ae=0;ae<64;ae++){var le=!W&&ae<H.length?H[ae].brush.filter.getBounds():[-1/0,1/0];ie[0][ae]=le[0],ie[1][ae]=le[1]}var ye=n*8,ue=new Array(ye);for(K=0;K<ye;K++)ue[K]=255;if(!W)for(K=0;K<H.length;K++){var pe=K%8,ge=(K-pe)/8,Te=Math.pow(2,pe),_e=H[K],ze=_e.brush.filter.get();if(!(ze.length<2)){var Oe=x(ze[0])[1];for(ne=1;ne<ze.length;ne++){var Ye=x(ze[ne]);for(ae=Oe+1;ae<Ye[0];ae++)ue[ae*8+ge]&=~Te;Oe=Math.max(Oe,Ye[1])}}}var be={shape:[8,n],format:"alpha",type:"uint8",mag:"nearest",min:"nearest",data:ue};return X?X(be):X=P.texture(be),{maskTexture:X,maskHeight:n,loA:ie[0].slice(0,16),loB:ie[0].slice(16,32),loC:ie[0].slice(32,48),loD:ie[0].slice(48,64),hiA:ie[1].slice(0,16),hiB:ie[1].slice(16,32),hiC:ie[1].slice(32,48),hiD:ie[1].slice(48,64)}}function N(W,K,ne){var ae=W.length,ie,le,ye,ue=1/0,pe=-1/0;for(ie=0;ie<ae;ie++)W[ie].dim0.canvasX<ue&&(ue=W[ie].dim0.canvasX,le=ie),W[ie].dim1.canvasX>pe&&(pe=W[ie].dim1.canvasX,ye=ie);ae===0&&i(P,0,0,B.canvasWidth,B.canvasHeight);var ge=se(T);for(ie=0;ie<ae;ie++){var Te=W[ie],_e=Te.dim0.crossfilterDimensionIndex,ze=Te.dim1.crossfilterDimensionIndex,Oe=Te.canvasX,Ye=Te.canvasY,be=Oe+Te.panelSizeX,Pe=Te.plotGlPixelRatio;if(K||!Z[_e]||Z[_e][0]!==Oe||Z[_e][1]!==be){Z[_e]=[Oe,be];var Ge=f(B,le,ye,ie,_e,ze,Oe,Ye,Te.panelSizeX,Te.panelSizeY,Te.dim0.crossfilterDimensionIndex,T?0:k?2:1,ge,Pe);R.clearOnly=ne;var Qe=K?B.lines.blockLineCount:G;y(P,oe,R,Qe,G,Ge)}}}function U(W,K){return P.read({x:W,y:K,width:1,height:1,data:t}),t}function q(W,K,ne,ae){var ie=new Uint8Array(4*ne*ae);return P.read({x:W,y:K,width:ne,height:ae,data:ie}),ie}function $(){l.style["pointer-events"]="none",Y.destroy(),X&&X.destroy();for(var W in J)J[W].destroy()}return{render:N,readPixel:U,readPixels:q,destroy:$,update:re}}},{"../../lib":515,"./constants":902,glslify:227}],907:[function(d,ee,te){ee.exports=function(w,v,S,M){M||(M=1/0);var e,a;for(e=0;e<v.length;e++)a=v[e],a.visible&&(M=Math.min(M,a[S].length));for(M===1/0&&(M=0),w._length=M,e=0;e<v.length;e++)a=v[e],a.visible&&(a._length=M);return M}},{}],908:[function(d,ee,te){var w=d("@plotly/d3"),v=d("../../lib"),S=v.numberFormat,M=d("color-rgba"),e=d("../../plots/cartesian/axes"),a=v.strRotate,n=v.strTranslate,r=d("../../lib/svg_text_utils"),t=d("../../components/drawing"),c=d("../../components/colorscale"),o=d("../../lib/gup"),i=o.keyFun,y=o.repeat,p=o.unwrap,g=d("./helpers"),h=d("./constants"),m=d("./axisbrush"),u=d("./lines");function _(X,Y,Z){return v.aggNums(X,null,Y,Z)}function s(X,Y){return b(_(Math.min,X,Y),_(Math.max,X,Y))}function A(X){var Y=X.range;return Y?b(Y[0],Y[1]):s(X.values,X._length)}function b(X,Y){return(isNaN(X)||!isFinite(X))&&(X=0),(isNaN(Y)||!isFinite(Y))&&(Y=0),X===Y&&(X===0?(X-=1,Y+=1):(X*=.9,Y*=1.1)),[X,Y]}function f(X,Y){return Y?function(Z,oe){var re=Y[oe];return re==null?X(Z):re}:X}function x(X,Y,Z,oe,re){var se=A(Z);return oe?w.scale.ordinal().domain(oe.map(f(S(Z.tickformat),re))).range(oe.map(function(N){var U=(N-se[0])/(se[1]-se[0]);return X-Y+U*(2*Y-X)})):w.scale.linear().domain(se).range([X-Y,Y])}function l(X,Y){return w.scale.linear().range([Y,X-Y])}function L(X,Y){return w.scale.linear().domain(A(X)).range([Y,1-Y])}function T(X){if(!!X.tickvals){var Y=A(X);return w.scale.ordinal().domain(X.tickvals).range(X.tickvals.map(function(Z){return(Z-Y[0])/(Y[1]-Y[0])}))}}function k(X){var Y=X.map(function(se){return se[0]}),Z=X.map(function(se){var N=M(se[1]);return w.rgb("rgb("+N[0]+","+N[1]+","+N[2]+")")}),oe=function(se){return function(N){return N[se]}},re="rgb".split("").map(function(se){return w.scale.linear().clamp(!0).domain(Y).range(Z.map(oe(se)))});return function(se){return re.map(function(N){return N(se)})}}function P(X){return X.dimensions.some(function(Y){return Y.brush.filterSpecified})}function z(X,Y,Z){var oe=p(Y),re=oe.trace,se=g.convertTypedArray(oe.lineColor),N=re.line,U={color:M(re.unselected.line.color),opacity:re.unselected.line.opacity},q=c.extractOpts(N),$=q.reversescale?c.flipScale(oe.cscale):oe.cscale,W=re.domain,K=re.dimensions,ne=X.width,ae=re.labelangle,ie=re.labelside,le=re.labelfont,ye=re.tickfont,ue=re.rangefont,pe=v.extendDeepNoArrays({},N,{color:se.map(w.scale.linear().domain(A({values:se,range:[q.min,q.max],_length:re._length}))),blockLineCount:h.blockLineCount,canvasOverdrag:h.overdrag*h.canvasPixelRatio}),ge=Math.floor(ne*(W.x[1]-W.x[0])),Te=Math.floor(X.height*(W.y[1]-W.y[0])),_e=X.margin||{l:80,r:80,t:100,b:80},ze=ge,Oe=Te;return{key:Z,colCount:K.filter(g.isVisible).length,dimensions:K,tickDistance:h.tickDistance,unitToColor:k($),lines:pe,deselectedLines:U,labelAngle:ae,labelSide:ie,labelFont:le,tickFont:ye,rangeFont:ue,layoutWidth:ne,layoutHeight:X.height,domain:W,translateX:W.x[0]*ne,translateY:X.height-W.y[1]*X.height,pad:_e,canvasWidth:ze*h.canvasPixelRatio+2*pe.canvasOverdrag,canvasHeight:Oe*h.canvasPixelRatio,width:ze,height:Oe,canvasPixelRatio:h.canvasPixelRatio}}function I(X,Y,Z){var oe=Z.width,re=Z.height,se=Z.dimensions,N=Z.canvasPixelRatio,U=function(ne){return oe*ne/Math.max(1,Z.colCount-1)},q=h.verticalPadding/re,$=l(re,h.verticalPadding),W={key:Z.key,xScale:U,model:Z,inBrushDrag:!1},K={};return W.dimensions=se.filter(g.isVisible).map(function(ne,ae){var ie=L(ne,q),le=K[ne.label];K[ne.label]=(le||0)+1;var ye=ne.label+(le?"__"+le:""),ue=ne.constraintrange,pe=ue&&ue.length;pe&&!Array.isArray(ue[0])&&(ue=[ue]);var ge=pe?ue.map(function(Be){return Be.map(ie)}):[[-1/0,1/0]],Te=function(){var Be=W;Be.focusLayer&&Be.focusLayer.render(Be.panels,!0);var Le=P(Be);!X.contextShown()&&Le?(Be.contextLayer&&Be.contextLayer.render(Be.panels,!0),X.contextShown(!0)):X.contextShown()&&!Le&&(Be.contextLayer&&Be.contextLayer.render(Be.panels,!0,!0),X.contextShown(!1))},_e=ne.values;_e.length>ne._length&&(_e=_e.slice(0,ne._length));var ze=ne.tickvals,Oe;function Ye(Be,Le){return{val:Be,text:Oe[Le]}}function be(Be,Le){return Be.val-Le.val}if(Array.isArray(ze)&&ze.length){Oe=ne.ticktext,!Array.isArray(Oe)||!Oe.length?Oe=ze.map(S(ne.tickformat)):Oe.length>ze.length?Oe=Oe.slice(0,ze.length):ze.length>Oe.length&&(ze=ze.slice(0,Oe.length));for(var Pe=1;Pe<ze.length;Pe++)if(ze[Pe]<ze[Pe-1]){for(var Ge=ze.map(Ye).sort(be),Qe=0;Qe<ze.length;Qe++)ze[Qe]=Ge[Qe].val,Oe[Qe]=Ge[Qe].text;break}}else ze=void 0;return _e=g.convertTypedArray(_e),{key:ye,label:ne.label,tickFormat:ne.tickformat,tickvals:ze,ticktext:Oe,ordinal:g.isOrdinal(ne),multiselect:ne.multiselect,xIndex:ae,crossfilterDimensionIndex:ae,visibleIndex:ne._index,height:re,values:_e,paddedUnitValues:_e.map(ie),unitTickvals:ze&&ze.map(ie),xScale:U,x:U(ae),canvasX:U(ae)*N,unitToPaddedPx:$,domainScale:x(re,h.verticalPadding,ne,ze,Oe),ordinalScale:T(ne),parent:W,model:Z,brush:m.makeBrush(X,pe,ge,function(){X.linePickActive(!1)},Te,function(Be){if(W.focusLayer.render(W.panels,!0),W.pickLayer&&W.pickLayer.render(W.panels,!0),X.linePickActive(!0),Y&&Y.filterChanged){var Le=ie.invert,He=Be.map(function(vt){return vt.map(Le).sort(v.sorterAsc)}).sort(function(vt,Rt){return vt[0]-Rt[0]});Y.filterChanged(W.key,ne._index,He)}})}}),W}function D(X){X.classed(h.cn.axisExtentText,!0).attr("text-anchor","middle").style("cursor","default")}function R(){var X=!0,Y=!1;return{linePickActive:function(Z){return arguments.length?X=!!Z:X},contextShown:function(Z){return arguments.length?Y=!!Z:Y}}}function B(X,Y){var Z=Y==="top"?1:-1,oe=X*Math.PI/180,re=Math.sin(oe),se=Math.cos(oe);return{dir:Z,dx:re,dy:se,degrees:X}}function F(X,Y,Z){for(var oe=Y.panels||(Y.panels=[]),re=X.data(),se=0;se<re.length-1;se++){var N=oe[se]||(oe[se]={}),U=re[se],q=re[se+1];N.dim0=U,N.dim1=q,N.canvasX=U.canvasX,N.panelSizeX=q.canvasX-U.canvasX,N.panelSizeY=Y.model.canvasHeight,N.y=0,N.canvasY=0,N.plotGlPixelRatio=Z}}function H(X){for(var Y=0;Y<X.length;Y++)for(var Z=0;Z<X[Y].length;Z++)for(var oe=X[Y][Z].trace,re=oe.dimensions,se=0;se<re.length;se++){var N=re[se].values,U=re[se]._ax;U&&(U.range?U.range=b(U.range[0],U.range[1]):U.range=s(N,oe._length),U.dtick||(U.dtick=.01*(Math.abs(U.range[1]-U.range[0])||1)),U.tickformat=re[se].tickformat,e.calcTicks(U),U.cleanRange())}}function G(X,Y){return e.tickText(X._ax,Y,!1).text}function J(X,Y){if(X.ordinal)return"";var Z=X.domainScale.domain(),oe=Z[Y?Z.length-1:0];return G(X.model.dimensions[X.visibleIndex],oe)}ee.exports=function(Y,Z,oe,re){var se=Y._fullLayout,N=se._toppaper,U=se._glcontainer,q=Y._context.plotGlPixelRatio,$=Y._fullLayout.paper_bgcolor;H(Z);var W=R(),K=Z.filter(function(Ge){return p(Ge).trace.visible}).map(z.bind(0,oe)).map(I.bind(0,W,re));U.each(function(Ge,Qe){return v.extendFlat(Ge,K[Qe])});var ne=U.selectAll(".gl-canvas").each(function(Ge){Ge.viewModel=K[0],Ge.viewModel.plotGlPixelRatio=q,Ge.viewModel.paperColor=$,Ge.model=Ge.viewModel?Ge.viewModel.model:null}),ae=null,ie=ne.filter(function(Ge){return Ge.pick});ie.style("pointer-events","auto").on("mousemove",function(Ge){if(W.linePickActive()&&Ge.lineLayer&&re&&re.hover){var Qe=w.event,Be=this.width,Le=this.height,He=w.mouse(this),vt=He[0],Rt=He[1];if(vt<0||Rt<0||vt>=Be||Rt>=Le)return;var rr=Ge.lineLayer.readPixel(vt,Le-1-Rt),Lt=rr[3]!==0,Ft=Lt?rr[2]+256*(rr[1]+256*rr[0]):null,Gt={x:vt,y:Rt,clientX:Qe.clientX,clientY:Qe.clientY,dataIndex:Ge.model.key,curveNumber:Ft};Ft!==ae&&(Lt?re.hover(Gt):re.unhover&&re.unhover(Gt),ae=Ft)}}),ne.style("opacity",function(Ge){return Ge.pick?0:1}),N.style("background","rgba(255, 255, 255, 0)");var le=N.selectAll("."+h.cn.parcoords).data(K,i);le.exit().remove(),le.enter().append("g").classed(h.cn.parcoords,!0).style("shape-rendering","crispEdges").style("pointer-events","none"),le.attr("transform",function(Ge){return n(Ge.model.translateX,Ge.model.translateY)});var ye=le.selectAll("."+h.cn.parcoordsControlView).data(y,i);ye.enter().append("g").classed(h.cn.parcoordsControlView,!0),ye.attr("transform",function(Ge){return n(Ge.model.pad.l,Ge.model.pad.t)});var ue=ye.selectAll("."+h.cn.yAxis).data(function(Ge){return Ge.dimensions},i);ue.enter().append("g").classed(h.cn.yAxis,!0),ye.each(function(Ge){F(ue,Ge,q)}),ne.each(function(Ge){if(Ge.viewModel){!Ge.lineLayer||re?Ge.lineLayer=u(this,Ge):Ge.lineLayer.update(Ge),(Ge.key||Ge.key===0)&&(Ge.viewModel[Ge.key]=Ge.lineLayer);var Qe=!Ge.context||re;Ge.lineLayer.render(Ge.viewModel.panels,Qe)}}),ue.attr("transform",function(Ge){return n(Ge.xScale(Ge.xIndex),0)}),ue.call(w.behavior.drag().origin(function(Ge){return Ge}).on("drag",function(Ge){var Qe=Ge.parent;W.linePickActive(!1),Ge.x=Math.max(-h.overdrag,Math.min(Ge.model.width+h.overdrag,w.event.x)),Ge.canvasX=Ge.x*Ge.model.canvasPixelRatio,ue.sort(function(Be,Le){return Be.x-Le.x}).each(function(Be,Le){Be.xIndex=Le,Be.x=Ge===Be?Be.x:Be.xScale(Be.xIndex),Be.canvasX=Be.x*Be.model.canvasPixelRatio}),F(ue,Qe,q),ue.filter(function(Be){return Math.abs(Ge.xIndex-Be.xIndex)!==0}).attr("transform",function(Be){return n(Be.xScale(Be.xIndex),0)}),w.select(this).attr("transform",n(Ge.x,0)),ue.each(function(Be,Le,He){He===Ge.parent.key&&(Qe.dimensions[Le]=Be)}),Qe.contextLayer&&Qe.contextLayer.render(Qe.panels,!1,!P(Qe)),Qe.focusLayer.render&&Qe.focusLayer.render(Qe.panels)}).on("dragend",function(Ge){var Qe=Ge.parent;Ge.x=Ge.xScale(Ge.xIndex),Ge.canvasX=Ge.x*Ge.model.canvasPixelRatio,F(ue,Qe,q),w.select(this).attr("transform",function(Be){return n(Be.x,0)}),Qe.contextLayer&&Qe.contextLayer.render(Qe.panels,!1,!P(Qe)),Qe.focusLayer&&Qe.focusLayer.render(Qe.panels),Qe.pickLayer&&Qe.pickLayer.render(Qe.panels,!0),W.linePickActive(!0),re&&re.axesMoved&&re.axesMoved(Qe.key,Qe.dimensions.map(function(Be){return Be.crossfilterDimensionIndex}))})),ue.exit().remove();var pe=ue.selectAll("."+h.cn.axisOverlays).data(y,i);pe.enter().append("g").classed(h.cn.axisOverlays,!0),pe.selectAll("."+h.cn.axis).remove();var ge=pe.selectAll("."+h.cn.axis).data(y,i);ge.enter().append("g").classed(h.cn.axis,!0),ge.each(function(Ge){var Qe=Ge.model.height/Ge.model.tickDistance,Be=Ge.domainScale,Le=Be.domain();w.select(this).call(w.svg.axis().orient("left").tickSize(4).outerTickSize(2).ticks(Qe,Ge.tickFormat).tickValues(Ge.ordinal?Le:null).tickFormat(function(He){return g.isOrdinal(Ge)?He:G(Ge.model.dimensions[Ge.visibleIndex],He)}).scale(Be)),t.font(ge.selectAll("text"),Ge.model.tickFont)}),ge.selectAll(".domain, .tick>line").attr("fill","none").attr("stroke","black").attr("stroke-opacity",.25).attr("stroke-width","1px"),ge.selectAll("text").style("text-shadow",r.makeTextShadow($)).style("cursor","default");var Te=pe.selectAll("."+h.cn.axisHeading).data(y,i);Te.enter().append("g").classed(h.cn.axisHeading,!0);var _e=Te.selectAll("."+h.cn.axisTitle).data(y,i);_e.enter().append("text").classed(h.cn.axisTitle,!0).attr("text-anchor","middle").style("cursor","ew-resize").style("pointer-events","auto"),_e.text(function(Ge){return Ge.label}).each(function(Ge){var Qe=w.select(this);t.font(Qe,Ge.model.labelFont),r.convertToTspans(Qe,Y)}).attr("transform",function(Ge){var Qe=B(Ge.model.labelAngle,Ge.model.labelSide),Be=h.axisTitleOffset;return(Qe.dir>0?"":n(0,2*Be+Ge.model.height))+a(Qe.degrees)+n(-Be*Qe.dx,-Be*Qe.dy)}).attr("text-anchor",function(Ge){var Qe=B(Ge.model.labelAngle,Ge.model.labelSide),Be=Math.abs(Qe.dx),Le=Math.abs(Qe.dy);return 2*Be>Le?Qe.dir*Qe.dx<0?"start":"end":"middle"});var ze=pe.selectAll("."+h.cn.axisExtent).data(y,i);ze.enter().append("g").classed(h.cn.axisExtent,!0);var Oe=ze.selectAll("."+h.cn.axisExtentTop).data(y,i);Oe.enter().append("g").classed(h.cn.axisExtentTop,!0),Oe.attr("transform",n(0,-h.axisExtentOffset));var Ye=Oe.selectAll("."+h.cn.axisExtentTopText).data(y,i);Ye.enter().append("text").classed(h.cn.axisExtentTopText,!0).call(D),Ye.text(function(Ge){return J(Ge,!0)}).each(function(Ge){t.font(w.select(this),Ge.model.rangeFont)});var be=ze.selectAll("."+h.cn.axisExtentBottom).data(y,i);be.enter().append("g").classed(h.cn.axisExtentBottom,!0),be.attr("transform",function(Ge){return n(0,Ge.model.height+h.axisExtentOffset)});var Pe=be.selectAll("."+h.cn.axisExtentBottomText).data(y,i);Pe.enter().append("text").classed(h.cn.axisExtentBottomText,!0).attr("dy","0.75em").call(D),Pe.text(function(Ge){return J(Ge,!1)}).each(function(Ge){t.font(w.select(this),Ge.model.rangeFont)}),m.ensureAxisBrush(pe,$)}},{"../../components/colorscale":379,"../../components/drawing":389,"../../lib":515,"../../lib/gup":512,"../../lib/svg_text_utils":541,"../../plots/cartesian/axes":566,"./axisbrush":898,"./constants":902,"./helpers":904,"./lines":906,"@plotly/d3":58,"color-rgba":91}],909:[function(d,ee,n){var w=d("./parcoords"),v=d("../../lib/prepare_regl"),S=d("./helpers").isVisible,M={};function e(r,t,c){var o=t.indexOf(c),i=r.indexOf(o);return i===-1&&(i+=t.length),i}function a(r,t){return function(o,i){return e(r,t,o)-e(r,t,i)}}var n=ee.exports=function(t,c){var o=t._fullLayout,i=v(t,[],M);if(!!i){var y={},p={},g={},h={},m=o._size;c.forEach(function(b,f){var x=b[0].trace;g[f]=x.index;var l=h[f]=x._fullInput.index;y[f]=t.data[l].dimensions,p[f]=t.data[l].dimensions.slice()});var u=function(b,f,x){var l=p[b][f],L=x.map(function(D){return D.slice()}),T="dimensions["+f+"].constraintrange",k=o._tracePreGUI[t._fullData[g[b]]._fullInput.uid];if(k[T]===void 0){var P=l.constraintrange;k[T]=P||null}var z=t._fullData[g[b]].dimensions[f];L.length?(L.length===1&&(L=L[0]),l.constraintrange=L,z.constraintrange=L.slice(),L=[L]):(delete l.constraintrange,delete z.constraintrange,L=null);var I={};I[T]=L,t.emit("plotly_restyle",[I,[h[b]]])},_=function(b){t.emit("plotly_hover",b)},s=function(b){t.emit("plotly_unhover",b)},A=function(b,f){var x=a(f,p[b].filter(S));y[b].sort(x),p[b].filter(function(l){return!S(l)}).sort(function(l){return p[b].indexOf(l)}).forEach(function(l){y[b].splice(y[b].indexOf(l),1),y[b].splice(p[b].indexOf(l),0,l)}),t.emit("plotly_restyle",[{dimensions:[y[b]]},[h[b]]])};w(t,c,{width:m.w,height:m.h,margin:{t:m.t,r:m.r,b:m.b,l:m.l}},{filterChanged:u,hover:_,unhover:s,axesMoved:A})}};n.reglPrecompiled=M},{"../../lib/prepare_regl":528,"./helpers":904,"./parcoords":908}],910:[function(d,ee,te){var w=d("../../plots/attributes"),v=d("../../plots/domain").attributes,S=d("../../plots/font_attributes"),M=d("../../components/color/attributes"),e=d("../../plots/template_attributes").hovertemplateAttrs,a=d("../../plots/template_attributes").texttemplateAttrs,n=d("../../lib/extend").extendFlat,r=S({editType:"plot",arrayOk:!0,colorEditType:"plot"});ee.exports={labels:{valType:"data_array",editType:"calc"},label0:{valType:"number",dflt:0,editType:"calc"},dlabel:{valType:"number",dflt:1,editType:"calc"},values:{valType:"data_array",editType:"calc"},marker:{colors:{valType:"data_array",editType:"calc"},line:{color:{valType:"color",dflt:M.defaultLine,arrayOk:!0,editType:"style"},width:{valType:"number",min:0,dflt:0,arrayOk:!0,editType:"style"},editType:"calc"},editType:"calc"},text:{valType:"data_array",editType:"plot"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"style"},scalegroup:{valType:"string",dflt:"",editType:"calc"},textinfo:{valType:"flaglist",flags:["label","text","value","percent"],extras:["none"],editType:"calc"},hoverinfo:n({},w.hoverinfo,{flags:["label","text","value","percent","name"]}),hovertemplate:e({},{keys:["label","color","value","percent","text"]}),texttemplate:a({editType:"plot"},{keys:["label","color","value","percent","text"]}),textposition:{valType:"enumerated",values:["inside","outside","auto","none"],dflt:"auto",arrayOk:!0,editType:"plot"},textfont:n({},r,{}),insidetextorientation:{valType:"enumerated",values:["horizontal","radial","tangential","auto"],dflt:"auto",editType:"plot"},insidetextfont:n({},r,{}),outsidetextfont:n({},r,{}),automargin:{valType:"boolean",dflt:!1,editType:"plot"},title:{text:{valType:"string",dflt:"",editType:"plot"},font:n({},r,{}),position:{valType:"enumerated",values:["top left","top center","top right","middle center","bottom left","bottom center","bottom right"],editType:"plot"},editType:"plot"},domain:v({name:"pie",trace:!0,editType:"calc"}),hole:{valType:"number",min:0,max:1,dflt:0,editType:"calc"},sort:{valType:"boolean",dflt:!0,editType:"calc"},direction:{valType:"enumerated",values:["clockwise","counterclockwise"],dflt:"counterclockwise",editType:"calc"},rotation:{valType:"number",min:-360,max:360,dflt:0,editType:"calc"},pull:{valType:"number",min:0,max:1,dflt:0,arrayOk:!0,editType:"calc"},_deprecated:{title:{valType:"string",dflt:"",editType:"calc"},titlefont:n({},r,{}),titleposition:{valType:"enumerated",values:["top left","top center","top right","middle center","bottom left","bottom center","bottom right"],editType:"calc"}}}},{"../../components/color/attributes":366,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/domain":593,"../../plots/font_attributes":594,"../../plots/template_attributes":642}],911:[function(d,ee,te){var w=d("../../plots/plots");te.name="pie",te.plot=function(v,S,M,e){w.plotBasePlot(te.name,v,S,M,e)},te.clean=function(v,S,M,e){w.cleanBasePlot(te.name,v,S,M,e)}},{"../../plots/plots":628}],912:[function(d,ee,te){var w=d("fast-isnumeric"),v=d("tinycolor2"),S=d("../../components/color"),M={};function e(t,c){var o=[],i=t._fullLayout,y=i.hiddenlabels||[],p=c.labels,g=c.marker.colors||[],h=c.values,m=c._length,u=c._hasValues&&m,_,s;if(c.dlabel)for(p=new Array(m),_=0;_<m;_++)p[_]=String(c.label0+_*c.dlabel);var A={},b=a(i["_"+c.type+"colormap"]),f=0,x=!1;for(_=0;_<m;_++){var l,L,T;if(u){if(l=h[_],!w(l))continue;l=+l}else l=1;L=p[_],(L===void 0||L==="")&&(L=_),L=String(L);var k=A[L];k===void 0?(A[L]=o.length,T=y.indexOf(L)!==-1,T||(f+=l),o.push({v:l,label:L,color:b(g[_],L),i:_,pts:[_],hidden:T})):(x=!0,s=o[k],s.v+=l,s.pts.push(_),s.hidden||(f+=l),s.color===!1&&g[_]&&(s.color=b(g[_],L)))}o=o.filter(function(z){return z.v>=0});var P=c.type==="funnelarea"?x:c.sort;return P&&o.sort(function(z,I){return I.v-z.v}),o[0]&&(o[0].vTotal=f),o}function a(t){return function(o,i){return!o||(o=v(o),!o.isValid())?!1:(o=S.addOpacity(o,o.getAlpha()),t[i]||(t[i]=o),o)}}function n(t,c){var o=(c||{}).type;o||(o="pie");var i=t._fullLayout,y=t.calcdata,p=i[o+"colorway"],g=i["_"+o+"colormap"];i["extend"+o+"colors"]&&(p=r(p,M));for(var h=0,m=0;m<y.length;m++){var u=y[m],_=u[0].trace.type;if(_===o)for(var s=0;s<u.length;s++){var A=u[s];A.color===!1&&(g[A.label]?A.color=g[A.label]:(g[A.label]=A.color=p[h%p.length],h++))}}}function r(t,c){var o,i=JSON.stringify(t),y=c[i];if(!y){for(y=t.slice(),o=0;o<t.length;o++)y.push(v(t[o]).lighten(20).toHexString());for(o=0;o<t.length;o++)y.push(v(t[o]).darken(20).toHexString());c[i]=y}return y}ee.exports={calc:e,crossTraceCalc:n,makePullColorFn:a,generateExtendedColors:r}},{"../../components/color":367,"fast-isnumeric":190,tinycolor2:313}],913:[function(d,ee,te){var w=d("fast-isnumeric"),v=d("../../lib"),S=d("./attributes"),M=d("../../plots/domain").defaults,e=d("../bar/defaults").handleText;function a(r,t){var c=Array.isArray(r),o=v.isArrayOrTypedArray(t),i=Math.min(c?r.length:1/0,o?t.length:1/0);if(isFinite(i)||(i=0),i&&o){for(var y,p=0;p<i;p++){var g=t[p];if(w(g)&&g>0){y=!0;break}}y||(i=0)}return{hasLabels:c,hasValues:o,len:i}}function n(r,t,c,o){function i(T,k){return v.coerce(r,t,S,T,k)}var y=i("labels"),p=i("values"),g=a(y,p),h=g.len;if(t._hasLabels=g.hasLabels,t._hasValues=g.hasValues,!t._hasLabels&&t._hasValues&&(i("label0"),i("dlabel")),!h){t.visible=!1;return}t._length=h;var m=i("marker.line.width");m&&i("marker.line.color"),i("marker.colors"),i("scalegroup");var u=i("text"),_=i("texttemplate"),s;if(_||(s=i("textinfo",Array.isArray(u)?"text+percent":"percent")),i("hovertext"),i("hovertemplate"),_||s&&s!=="none"){var A=i("textposition");e(r,t,o,i,A,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1});var b=Array.isArray(A)||A==="auto",f=b||A==="outside";f&&i("automargin"),(A==="inside"||A==="auto"||Array.isArray(A))&&i("insidetextorientation")}M(t,o,i);var x=i("hole"),l=i("title.text");if(l){var L=i("title.position",x?"middle center":"top center");!x&&L==="middle center"&&(t.title.position="top center"),v.coerceFont(i,"title.font",o.font)}i("sort"),i("direction"),i("rotation"),i("pull")}ee.exports={handleLabelsAndValues:a,supplyDefaults:n}},{"../../lib":515,"../../plots/domain":593,"../bar/defaults":661,"./attributes":910,"fast-isnumeric":190}],914:[function(d,ee,te){var w=d("../../components/fx/helpers").appendArrayMultiPointValues;ee.exports=function(S,M){var e={curveNumber:M.index,pointNumbers:S.pts,data:M._input,fullData:M,label:S.label,color:S.color,value:S.v,percent:S.percent,text:S.text,bbox:S.bbox,v:S.v};return S.pts.length===1&&(e.pointNumber=e.i=S.pts[0]),w(e,M,S.pts),M.type==="funnelarea"&&(delete e.v,delete e.i),e}},{"../../components/fx/helpers":403}],915:[function(d,ee,te){var w=d("../../lib");function v(S){return S.indexOf("e")!==-1?S.replace(/[.]?0+e/,"e"):S.indexOf(".")!==-1?S.replace(/[.]?0+$/,""):S}te.formatPiePercent=function(M,e){var a=v((M*100).toPrecision(3));return w.numSeparate(a,e)+"%"},te.formatPieValue=function(M,e){var a=v(M.toPrecision(10));return w.numSeparate(a,e)},te.getFirstFilled=function(M,e){if(!!Array.isArray(M))for(var a=0;a<e.length;a++){var n=M[e[a]];if(n||n===0||n==="")return n}},te.castOption=function(M,e){if(Array.isArray(M))return te.getFirstFilled(M,e);if(M)return M},te.getRotationAngle=function(S){return(S==="auto"?0:S)*Math.PI/180}},{"../../lib":515}],916:[function(d,ee,te){ee.exports={attributes:d("./attributes"),supplyDefaults:d("./defaults").supplyDefaults,supplyLayoutDefaults:d("./layout_defaults"),layoutAttributes:d("./layout_attributes"),calc:d("./calc").calc,crossTraceCalc:d("./calc").crossTraceCalc,plot:d("./plot").plot,style:d("./style"),styleOne:d("./style_one"),moduleType:"trace",name:"pie",basePlotModule:d("./base_plot"),categories:["pie-like","pie","showLegend"],meta:{}}},{"./attributes":910,"./base_plot":911,"./calc":912,"./defaults":913,"./layout_attributes":917,"./layout_defaults":918,"./plot":919,"./style":920,"./style_one":921}],917:[function(d,ee,te){ee.exports={hiddenlabels:{valType:"data_array",editType:"calc"},piecolorway:{valType:"colorlist",editType:"calc"},extendpiecolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{}],918:[function(d,ee,te){var w=d("../../lib"),v=d("./layout_attributes");ee.exports=function(M,e){function a(n,r){return w.coerce(M,e,v,n,r)}a("hiddenlabels"),a("piecolorway",e.colorway),a("extendpiecolors")}},{"../../lib":515,"./layout_attributes":917}],919:[function(d,ee,te){var w=d("@plotly/d3"),v=d("../../plots/plots"),S=d("../../components/fx"),M=d("../../components/color"),e=d("../../components/drawing"),a=d("../../lib"),n=a.strScale,r=a.strTranslate,t=d("../../lib/svg_text_utils"),c=d("../bar/uniform_text"),o=c.recordMinTextSize,i=c.clearMinTextSize,y=d("../bar/constants").TEXTPAD,p=d("./helpers"),g=d("./event_data"),h=d("../../lib").isValidTextValue;function m(se,N){var U=se._fullLayout,q=U._size;i("pie",U),b(N,se),J(N,q);var $=a.makeTraceGroups(U._pielayer,N,"trace").each(function(W){var K=w.select(this),ne=W[0],ae=ne.trace;Y(W),K.attr("stroke-linejoin","round"),K.each(function(){var ie=w.select(this).selectAll("g.slice").data(W);ie.enter().append("g").classed("slice",!0),ie.exit().remove();var le=[[[],[]],[[],[]]],ye=!1;ie.each(function(Ye,be){if(Ye.hidden){w.select(this).selectAll("path,g").remove();return}Ye.pointNumber=Ye.i,Ye.curveNumber=ae.index,le[Ye.pxmid[1]<0?0:1][Ye.pxmid[0]<0?0:1].push(Ye);var Pe=ne.cx,Ge=ne.cy,Qe=w.select(this),Be=Qe.selectAll("path.surface").data([Ye]);if(Be.enter().append("path").classed("surface",!0).style({"pointer-events":"all"}),Qe.call(_,se,W),ae.pull){var Le=+p.castOption(ae.pull,Ye.pts)||0;Le>0&&(Pe+=Le*Ye.pxmid[0],Ge+=Le*Ye.pxmid[1])}Ye.cxFinal=Pe,Ye.cyFinal=Ge;function He(Dt,kt,Ue,qe){var Ve=qe*(kt[0]-Dt[0]),Ae=qe*(kt[1]-Dt[1]);return"a"+qe*ne.r+","+qe*ne.r+" 0 "+Ye.largeArc+(Ue?" 1 ":" 0 ")+Ve+","+Ae}var vt=ae.hole;if(Ye.v===ne.vTotal){var Rt="M"+(Pe+Ye.px0[0])+","+(Ge+Ye.px0[1])+He(Ye.px0,Ye.pxmid,!0,1)+He(Ye.pxmid,Ye.px0,!0,1)+"Z";vt?Be.attr("d","M"+(Pe+vt*Ye.px0[0])+","+(Ge+vt*Ye.px0[1])+He(Ye.px0,Ye.pxmid,!1,vt)+He(Ye.pxmid,Ye.px0,!1,vt)+"Z"+Rt):Be.attr("d",Rt)}else{var rr=He(Ye.px0,Ye.px1,!0,1);if(vt){var Lt=1-vt;Be.attr("d","M"+(Pe+vt*Ye.px1[0])+","+(Ge+vt*Ye.px1[1])+He(Ye.px1,Ye.px0,!1,vt)+"l"+Lt*Ye.px0[0]+","+Lt*Ye.px0[1]+rr+"Z")}else Be.attr("d","M"+Pe+","+Ge+"l"+Ye.px0[0]+","+Ye.px0[1]+rr+"Z")}oe(se,Ye,ne);var Ft=p.castOption(ae.textposition,Ye.pts),Gt=Qe.selectAll("g.slicetext").data(Ye.text&&Ft!=="none"?[0]:[]);Gt.enter().append("g").classed("slicetext",!0),Gt.exit().remove(),Gt.each(function(){var Dt=a.ensureSingle(w.select(this),"text","",function(Je){Je.attr("data-notex",1)}),kt=a.ensureUniformFontSize(se,Ft==="outside"?s(ae,Ye,U.font):A(ae,Ye,U.font));Dt.text(Ye.text).attr({class:"slicetext",transform:"","text-anchor":"middle"}).call(e.font,kt).call(t.convertToTspans,se);var Ue=e.bBox(Dt.node()),qe;if(Ft==="outside")qe=I(Ue,Ye);else if(qe=f(Ue,Ye,ne),Ft==="auto"&&qe.scale<1){var Ve=a.ensureUniformFontSize(se,ae.outsidetextfont);Dt.call(e.font,Ve),Ue=e.bBox(Dt.node()),qe=I(Ue,Ye)}var Ae=qe.textPosAngle,Ne=Ae===void 0?Ye.pxmid:Z(ne.r,Ae);if(qe.targetX=Pe+Ne[0]*qe.rCenter+(qe.x||0),qe.targetY=Ge+Ne[1]*qe.rCenter+(qe.y||0),re(qe,Ue),qe.outside){var Xe=qe.targetY;Ye.yLabelMin=Xe-Ue.height/2,Ye.yLabelMid=Xe,Ye.yLabelMax=Xe+Ue.height/2,Ye.labelExtraX=0,Ye.labelExtraY=0,ye=!0}qe.fontSize=kt.size,o(ae.type,qe,U),W[be].transform=qe,Dt.attr("transform",a.getTextTransform(qe))})});var ue=w.select(this).selectAll("g.titletext").data(ae.title.text?[0]:[]);if(ue.enter().append("g").classed("titletext",!0),ue.exit().remove(),ue.each(function(){var Ye=a.ensureSingle(w.select(this),"text","",function(Ge){Ge.attr("data-notex",1)}),be=ae.title.text;ae._meta&&(be=a.templateString(be,ae._meta)),Ye.text(be).attr({class:"titletext",transform:"","text-anchor":"middle"}).call(e.font,ae.title.font).call(t.convertToTspans,se);var Pe;ae.title.position==="middle center"?Pe=D(ne):Pe=R(ne,q),Ye.attr("transform",r(Pe.x,Pe.y)+n(Math.min(1,Pe.scale))+r(Pe.tx,Pe.ty))}),ye&&G(le,ae),u(ie,ae),ye&&ae.automargin){var pe=e.bBox(K.node()),ge=ae.domain,Te=q.w*(ge.x[1]-ge.x[0]),_e=q.h*(ge.y[1]-ge.y[0]),ze=(.5*Te-ne.r)/q.w,Oe=(.5*_e-ne.r)/q.h;v.autoMargin(se,"pie."+ae.uid+".automargin",{xl:ge.x[0]-ze,xr:ge.x[1]+ze,yb:ge.y[0]-Oe,yt:ge.y[1]+Oe,l:Math.max(ne.cx-ne.r-pe.left,0),r:Math.max(pe.right-(ne.cx+ne.r),0),b:Math.max(pe.bottom-(ne.cy+ne.r),0),t:Math.max(ne.cy-ne.r-pe.top,0),pad:5})}})});setTimeout(function(){$.selectAll("tspan").each(function(){var W=w.select(this);W.attr("dy")&&W.attr("dy",W.attr("dy"))})},0)}function u(se,N){se.each(function(U){var q=w.select(this);if(!U.labelExtraX&&!U.labelExtraY){q.select("path.textline").remove();return}var $=q.select("g.slicetext text");U.transform.targetX+=U.labelExtraX,U.transform.targetY+=U.labelExtraY,$.attr("transform",a.getTextTransform(U.transform));var W=U.cxFinal+U.pxmid[0],K=U.cyFinal+U.pxmid[1],ne="M"+W+","+K,ae=(U.yLabelMax-U.yLabelMin)*(U.pxmid[0]<0?-1:1)/4;if(U.labelExtraX){var ie=U.labelExtraX*U.pxmid[1]/U.pxmid[0],le=U.yLabelMid+U.labelExtraY-(U.cyFinal+U.pxmid[1]);Math.abs(ie)>Math.abs(le)?ne+="l"+le*U.pxmid[0]/U.pxmid[1]+","+le+"H"+(W+U.labelExtraX+ae):ne+="l"+U.labelExtraX+","+ie+"v"+(le-ie)+"h"+ae}else ne+="V"+(U.yLabelMid+U.labelExtraY)+"h"+ae;a.ensureSingle(q,"path","textline").call(M.stroke,N.outsidetextfont.color).attr({"stroke-width":Math.min(2,N.outsidetextfont.size/8),d:ne,fill:"none"})})}function _(se,N,U){var q=U[0],$=q.cx,W=q.cy,K=q.trace,ne=K.type==="funnelarea";"_hasHoverLabel"in K||(K._hasHoverLabel=!1),"_hasHoverEvent"in K||(K._hasHoverEvent=!1),se.on("mouseover",function(ae){var ie=N._fullLayout,le=N._fullData[K.index];if(!(N._dragging||ie.hovermode===!1)){var ye=le.hoverinfo;if(Array.isArray(ye)&&(ye=S.castHoverinfo({hoverinfo:[p.castOption(ye,ae.pts)],_module:K._module},ie,0)),ye==="all"&&(ye="label+text+value+percent+name"),le.hovertemplate||ye!=="none"&&ye!=="skip"&&ye){var ue=ae.rInscribed||0,pe=$+ae.pxmid[0]*(1-ue),ge=W+ae.pxmid[1]*(1-ue),Te=ie.separators,_e=[];if(ye&&ye.indexOf("label")!==-1&&_e.push(ae.label),ae.text=p.castOption(le.hovertext||le.text,ae.pts),ye&&ye.indexOf("text")!==-1){var ze=ae.text;a.isValidTextValue(ze)&&_e.push(ze)}ae.value=ae.v,ae.valueLabel=p.formatPieValue(ae.v,Te),ye&&ye.indexOf("value")!==-1&&_e.push(ae.valueLabel),ae.percent=ae.v/q.vTotal,ae.percentLabel=p.formatPiePercent(ae.percent,Te),ye&&ye.indexOf("percent")!==-1&&_e.push(ae.percentLabel);var Oe=le.hoverlabel,Ye=Oe.font,be=[];S.loneHover({trace:K,x0:pe-ue*q.r,x1:pe+ue*q.r,y:ge,_x0:ne?$+ae.TL[0]:pe-ue*q.r,_x1:ne?$+ae.TR[0]:pe+ue*q.r,_y0:ne?W+ae.TL[1]:ge-ue*q.r,_y1:ne?W+ae.BL[1]:ge+ue*q.r,text:_e.join("<br>"),name:le.hovertemplate||ye.indexOf("name")!==-1?le.name:void 0,idealAlign:ae.pxmid[0]<0?"left":"right",color:p.castOption(Oe.bgcolor,ae.pts)||ae.color,borderColor:p.castOption(Oe.bordercolor,ae.pts),fontFamily:p.castOption(Ye.family,ae.pts),fontSize:p.castOption(Ye.size,ae.pts),fontColor:p.castOption(Ye.color,ae.pts),nameLength:p.castOption(Oe.namelength,ae.pts),textAlign:p.castOption(Oe.align,ae.pts),hovertemplate:p.castOption(le.hovertemplate,ae.pts),hovertemplateLabels:ae,eventData:[g(ae,le)]},{container:ie._hoverlayer.node(),outerContainer:ie._paper.node(),gd:N,inOut_bbox:be}),ae.bbox=be[0],K._hasHoverLabel=!0}K._hasHoverEvent=!0,N.emit("plotly_hover",{points:[g(ae,le)],event:w.event})}}),se.on("mouseout",function(ae){var ie=N._fullLayout,le=N._fullData[K.index],ye=w.select(this).datum();K._hasHoverEvent&&(ae.originalEvent=w.event,N.emit("plotly_unhover",{points:[g(ye,le)],event:w.event}),K._hasHoverEvent=!1),K._hasHoverLabel&&(S.loneUnhover(ie._hoverlayer.node()),K._hasHoverLabel=!1)}),se.on("click",function(ae){var ie=N._fullLayout,le=N._fullData[K.index];N._dragging||ie.hovermode===!1||(N._hoverdata=[g(ae,le)],S.click(N,w.event))})}function s(se,N,U){var q=p.castOption(se.outsidetextfont.color,N.pts)||p.castOption(se.textfont.color,N.pts)||U.color,$=p.castOption(se.outsidetextfont.family,N.pts)||p.castOption(se.textfont.family,N.pts)||U.family,W=p.castOption(se.outsidetextfont.size,N.pts)||p.castOption(se.textfont.size,N.pts)||U.size;return{color:q,family:$,size:W}}function A(se,N,U){var q=p.castOption(se.insidetextfont.color,N.pts);!q&&se._input.textfont&&(q=p.castOption(se._input.textfont.color,N.pts));var $=p.castOption(se.insidetextfont.family,N.pts)||p.castOption(se.textfont.family,N.pts)||U.family,W=p.castOption(se.insidetextfont.size,N.pts)||p.castOption(se.textfont.size,N.pts)||U.size;return{color:q||M.contrast(N.color),family:$,size:W}}function b(se,N){for(var U,q,$=0;$<se.length;$++)if(U=se[$][0],q=U.trace,q.title.text){var W=q.title.text;q._meta&&(W=a.templateString(W,q._meta));var K=e.tester.append("text").attr("data-notex",1).text(W).call(e.font,q.title.font).call(t.convertToTspans,N),ne=e.bBox(K.node(),!0);U.titleBox={width:ne.width,height:ne.height},K.remove()}}function f(se,N,U){var q=U.r||N.rpx1,$=N.rInscribed,W=N.startangle===N.stopangle;if(W)return{rCenter:1-$,scale:0,rotate:0,textPosAngle:0};var K=N.ring,ne=K===1&&Math.abs(N.startangle-N.stopangle)===Math.PI*2,ae=N.halfangle,ie=N.midangle,le=U.trace.insidetextorientation,ye=le==="horizontal",ue=le==="tangential",pe=le==="radial",ge=le==="auto",Te=[],_e;if(!ge){var ze=function(Be,Le){if(x(N,Be)){var He=Math.abs(Be-N.startangle),vt=Math.abs(Be-N.stopangle),Rt=He<vt?He:vt;Le==="tan"?_e=L(se,q,K,Rt,0):_e=l(se,q,K,Rt,Math.PI/2),_e.textPosAngle=Be,Te.push(_e)}},Oe;if(ye||ue){for(Oe=4;Oe>=-4;Oe-=2)ze(Math.PI*Oe,"tan");for(Oe=4;Oe>=-4;Oe-=2)ze(Math.PI*(Oe+1),"tan")}if(ye||pe){for(Oe=4;Oe>=-4;Oe-=2)ze(Math.PI*(Oe+1.5),"rad");for(Oe=4;Oe>=-4;Oe-=2)ze(Math.PI*(Oe+.5),"rad")}}if(ne||ge||ye){var Ye=Math.sqrt(se.width*se.width+se.height*se.height);if(_e={scale:$*q*2/Ye,rCenter:1-$,rotate:0},_e.textPosAngle=(N.startangle+N.stopangle)/2,_e.scale>=1)return _e;Te.push(_e)}(ge||pe)&&(_e=l(se,q,K,ae,ie),_e.textPosAngle=(N.startangle+N.stopangle)/2,Te.push(_e)),(ge||ue)&&(_e=L(se,q,K,ae,ie),_e.textPosAngle=(N.startangle+N.stopangle)/2,Te.push(_e));for(var be=0,Pe=0,Ge=0;Ge<Te.length;Ge++){var Qe=Te[Ge].scale;if(Pe<Qe&&(Pe=Qe,be=Ge),!ge&&Pe>=1)break}return Te[be]}function x(se,N){var U=se.startangle,q=se.stopangle;return U>N&&N>q||U<N&&N<q}function l(se,N,U,q,$){N=Math.max(0,N-2*y);var W=se.width/se.height,K=P(W,q,N,U);return{scale:K*2/se.height,rCenter:T(W,K/N),rotate:k($)}}function L(se,N,U,q,$){N=Math.max(0,N-2*y);var W=se.height/se.width,K=P(W,q,N,U);return{scale:K*2/se.width,rCenter:T(W,K/N),rotate:k($+Math.PI/2)}}function T(se,N){return Math.cos(N)-se*N}function k(se){return(180/Math.PI*se+720)%180-90}function P(se,N,U,q){var $=se+1/(2*Math.tan(N));return U*Math.min(1/(Math.sqrt($*$+.5)+$),q/(Math.sqrt(se*se+q/2)+se))}function z(se,N){return se.v===N.vTotal&&!N.trace.hole?1:Math.min(1/(1+1/Math.sin(se.halfangle)),se.ring/2)}function I(se,N){var U=N.pxmid[0],q=N.pxmid[1],$=se.width/2,W=se.height/2;return U<0&&($*=-1),q<0&&(W*=-1),{scale:1,rCenter:1,rotate:0,x:$+Math.abs(W)*($>0?1:-1)/2,y:W/(1+U*U/(q*q)),outside:!0}}function D(se){var N=Math.sqrt(se.titleBox.width*se.titleBox.width+se.titleBox.height*se.titleBox.height);return{x:se.cx,y:se.cy,scale:se.trace.hole*se.r*2/N,tx:0,ty:-se.titleBox.height/2+se.trace.title.font.size}}function R(se,N){var U=1,q=1,$,W=se.trace,K={x:se.cx,y:se.cy},ne={tx:0,ty:0};ne.ty+=W.title.font.size,$=H(W),W.title.position.indexOf("top")!==-1?(K.y-=(1+$)*se.r,ne.ty-=se.titleBox.height):W.title.position.indexOf("bottom")!==-1&&(K.y+=(1+$)*se.r);var ae=B(se.r,se.trace.aspectratio),ie=N.w*(W.domain.x[1]-W.domain.x[0])/2;return W.title.position.indexOf("left")!==-1?(ie=ie+ae,K.x-=(1+$)*ae,ne.tx+=se.titleBox.width/2):W.title.position.indexOf("center")!==-1?ie*=2:W.title.position.indexOf("right")!==-1&&(ie=ie+ae,K.x+=(1+$)*ae,ne.tx-=se.titleBox.width/2),U=ie/se.titleBox.width,q=F(se,N)/se.titleBox.height,{x:K.x,y:K.y,scale:Math.min(U,q),tx:ne.tx,ty:ne.ty}}function B(se,N){return se/(N===void 0?1:N)}function F(se,N){var U=se.trace,q=N.h*(U.domain.y[1]-U.domain.y[0]);return Math.min(se.titleBox.height,q/2)}function H(se){var N=se.pull;if(!N)return 0;var U;if(Array.isArray(N))for(N=0,U=0;U<se.pull.length;U++)se.pull[U]>N&&(N=se.pull[U]);return N}function G(se,N){var U,q,$,W,K,ne,ae,ie,le,ye,ue,pe,ge;function Te(Ye,be){return Ye.pxmid[1]-be.pxmid[1]}function _e(Ye,be){return be.pxmid[1]-Ye.pxmid[1]}function ze(Ye,be){be||(be={});var Pe=be.labelExtraY+(q?be.yLabelMax:be.yLabelMin),Ge=q?Ye.yLabelMin:Ye.yLabelMax,Qe=q?Ye.yLabelMax:Ye.yLabelMin,Be=Ye.cyFinal+K(Ye.px0[1],Ye.px1[1]),Le=Pe-Ge,He,vt,Rt,rr,Lt,Ft;if(Le*ae>0&&(Ye.labelExtraY=Le),!!Array.isArray(N.pull))for(vt=0;vt<ye.length;vt++)Rt=ye[vt],!(Rt===Ye||(p.castOption(N.pull,Ye.pts)||0)>=(p.castOption(N.pull,Rt.pts)||0))&&((Ye.pxmid[1]-Rt.pxmid[1])*ae>0?(rr=Rt.cyFinal+K(Rt.px0[1],Rt.px1[1]),Le=rr-Ge-Ye.labelExtraY,Le*ae>0&&(Ye.labelExtraY+=Le)):(Qe+Ye.labelExtraY-Be)*ae>0&&(He=3*ne*Math.abs(vt-ye.indexOf(Ye)),Lt=Rt.cxFinal+W(Rt.px0[0],Rt.px1[0]),Ft=Lt+He-(Ye.cxFinal+Ye.pxmid[0])-Ye.labelExtraX,Ft*ne>0&&(Ye.labelExtraX+=Ft)))}for(q=0;q<2;q++)for($=q?Te:_e,K=q?Math.max:Math.min,ae=q?1:-1,U=0;U<2;U++){for(W=U?Math.max:Math.min,ne=U?1:-1,ie=se[q][U],ie.sort($),le=se[1-q][U],ye=le.concat(ie),pe=[],ue=0;ue<ie.length;ue++)ie[ue].yLabelMid!==void 0&&pe.push(ie[ue]);for(ge=!1,ue=0;q&&ue<le.length;ue++)if(le[ue].yLabelMid!==void 0){ge=le[ue];break}for(ue=0;ue<pe.length;ue++){var Oe=ue&&pe[ue-1];ge&&!ue&&(Oe=ge),ze(pe[ue],Oe)}}}function J(se,N){for(var U=[],q=0;q<se.length;q++){var $=se[q][0],W=$.trace,K=W.domain,ne=N.w*(K.x[1]-K.x[0]),ae=N.h*(K.y[1]-K.y[0]);W.title.text&&W.title.position!=="middle center"&&(ae-=F($,N));var ie=ne/2,le=ae/2;W.type==="funnelarea"&&!W.scalegroup&&(le/=W.aspectratio),$.r=Math.min(ie,le)/(1+H(W)),$.cx=N.l+N.w*(W.domain.x[1]+W.domain.x[0])/2,$.cy=N.t+N.h*(1-W.domain.y[0])-ae/2,W.title.text&&W.title.position.indexOf("bottom")!==-1&&($.cy-=F($,N)),W.scalegroup&&U.indexOf(W.scalegroup)===-1&&U.push(W.scalegroup)}X(se,U)}function X(se,N){for(var U,q,$,W=0;W<N.length;W++){var K=1/0,ne=N[W];for(q=0;q<se.length;q++)if(U=se[q][0],$=U.trace,$.scalegroup===ne){var ae;if($.type==="pie")ae=U.r*U.r;else if($.type==="funnelarea"){var ie,le;$.aspectratio>1?(ie=U.r,le=ie/$.aspectratio):(le=U.r,ie=le*$.aspectratio),ie*=(1+$.baseratio)/2,ae=ie*le}K=Math.min(K,ae/U.vTotal)}for(q=0;q<se.length;q++)if(U=se[q][0],$=U.trace,$.scalegroup===ne){var ye=K*U.vTotal;$.type==="funnelarea"&&(ye/=(1+$.baseratio)/2,ye/=$.aspectratio),U.r=Math.sqrt(ye)}}}function Y(se){var N=se[0],U=N.r,q=N.trace,$=p.getRotationAngle(q.rotation),W=2*Math.PI/N.vTotal,K="px0",ne="px1",ae,ie,le;if(q.direction==="counterclockwise"){for(ae=0;ae<se.length&&se[ae].hidden;ae++);if(ae===se.length)return;$+=W*se[ae].v,W*=-1,K="px1",ne="px0"}for(le=Z(U,$),ae=0;ae<se.length;ae++)ie=se[ae],!ie.hidden&&(ie[K]=le,ie.startangle=$,$+=W*ie.v/2,ie.pxmid=Z(U,$),ie.midangle=$,$+=W*ie.v/2,le=Z(U,$),ie.stopangle=$,ie[ne]=le,ie.largeArc=ie.v>N.vTotal/2?1:0,ie.halfangle=Math.PI*Math.min(ie.v/N.vTotal,.5),ie.ring=1-q.hole,ie.rInscribed=z(ie,N))}function Z(se,N){return[se*Math.sin(N),-se*Math.cos(N)]}function oe(se,N,U){var q=se._fullLayout,$=U.trace,W=$.texttemplate,K=$.textinfo;if(!W&&K&&K!=="none"){var ne=K.split("+"),ae=function(be){return ne.indexOf(be)!==-1},ie=ae("label"),le=ae("text"),ye=ae("value"),ue=ae("percent"),pe=q.separators,ge;if(ge=ie?[N.label]:[],le){var Te=p.getFirstFilled($.text,N.pts);h(Te)&&ge.push(Te)}ye&&ge.push(p.formatPieValue(N.v,pe)),ue&&ge.push(p.formatPiePercent(N.v/U.vTotal,pe)),N.text=ge.join("<br>")}function _e(be){return{label:be.label,value:be.v,valueLabel:p.formatPieValue(be.v,q.separators),percent:be.v/U.vTotal,percentLabel:p.formatPiePercent(be.v/U.vTotal,q.separators),color:be.color,text:be.text,customdata:a.castOption($,be.i,"customdata")}}if(W){var ze=a.castOption($,N.i,"texttemplate");if(!ze)N.text="";else{var Oe=_e(N),Ye=p.getFirstFilled($.text,N.pts);(h(Ye)||Ye==="")&&(Oe.text=Ye),N.text=a.texttemplateString(ze,Oe,se._fullLayout._d3locale,Oe,$._meta||{})}}}function re(se,N){var U=se.rotate*Math.PI/180,q=Math.cos(U),$=Math.sin(U),W=(N.left+N.right)/2,K=(N.top+N.bottom)/2;se.textX=W*q-K*$,se.textY=W*$+K*q,se.noCenter=!0}ee.exports={plot:m,formatSliceLabel:oe,transformInsideText:f,determineInsideTextFont:A,positionTitleOutside:R,prerenderTitles:b,layoutAreas:J,attachFxHandlers:_,computeTransform:re}},{"../../components/color":367,"../../components/drawing":389,"../../components/fx":407,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/plots":628,"../bar/constants":659,"../bar/uniform_text":673,"./event_data":914,"./helpers":915,"@plotly/d3":58}],920:[function(d,ee,te){var w=d("@plotly/d3"),v=d("./style_one"),S=d("../bar/uniform_text").resizeText;ee.exports=function(e){var a=e._fullLayout._pielayer.selectAll(".trace");S(e,a,"pie"),a.each(function(n){var r=n[0],t=r.trace,c=w.select(this);c.style({opacity:t.opacity}),c.selectAll("path.surface").each(function(o){w.select(this).call(v,o,t)})})}},{"../bar/uniform_text":673,"./style_one":921,"@plotly/d3":58}],921:[function(d,ee,te){var w=d("../../components/color"),v=d("./helpers").castOption;ee.exports=function(M,e,a){var n=a.marker.line,r=v(n.color,e.pts)||w.defaultLine,t=v(n.width,e.pts)||0;M.style("stroke-width",t).call(w.fill,e.color).call(w.stroke,r)}},{"../../components/color":367,"./helpers":915}],922:[function(d,ee,te){var w=d("../scatter/attributes");ee.exports={x:w.x,y:w.y,xy:{valType:"data_array",editType:"calc"},indices:{valType:"data_array",editType:"calc"},xbounds:{valType:"data_array",editType:"calc"},ybounds:{valType:"data_array",editType:"calc"},text:w.text,marker:{color:{valType:"color",arrayOk:!1,editType:"calc"},opacity:{valType:"number",min:0,max:1,dflt:1,arrayOk:!1,editType:"calc"},blend:{valType:"boolean",dflt:null,editType:"calc"},sizemin:{valType:"number",min:.1,max:2,dflt:.5,editType:"calc"},sizemax:{valType:"number",min:.1,dflt:20,editType:"calc"},border:{color:{valType:"color",arrayOk:!1,editType:"calc"},arearatio:{valType:"number",min:0,max:1,dflt:0,editType:"calc"},editType:"calc"},editType:"calc"},transforms:void 0}},{"../scatter/attributes":936}],923:[function(d,ee,te){var w=d("../../../stackgl_modules").gl_pointcloud2d,v=d("../../lib/str2rgbarray"),S=d("../../plots/cartesian/autorange").findExtremes,M=d("../scatter/get_trace_color");function e(r,t){this.scene=r,this.uid=t,this.type="pointcloud",this.pickXData=[],this.pickYData=[],this.xData=[],this.yData=[],this.textLabels=[],this.color="rgb(0, 0, 0)",this.name="",this.hoverinfo="all",this.idToIndex=new Int32Array(0),this.bounds=[0,0,0,0],this.pointcloudOptions={positions:new Float32Array(0),idToIndex:this.idToIndex,sizemin:.5,sizemax:12,color:[0,0,0,1],areaRatio:1,borderColor:[0,0,0,1]},this.pointcloud=w(r.glplot,this.pointcloudOptions),this.pointcloud._trace=this}var a=e.prototype;a.handlePick=function(r){var t=this.idToIndex[r.pointId];return{trace:this,dataCoord:r.dataCoord,traceCoord:this.pickXYData?[this.pickXYData[t*2],this.pickXYData[t*2+1]]:[this.pickXData[t],this.pickYData[t]],textLabel:Array.isArray(this.textLabels)?this.textLabels[t]:this.textLabels,color:this.color,name:this.name,pointIndex:t,hoverinfo:this.hoverinfo}},a.update=function(r){this.index=r.index,this.textLabels=r.text,this.name=r.name,this.hoverinfo=r.hoverinfo,this.bounds=[1/0,1/0,-1/0,-1/0],this.updateFast(r),this.color=M(r,{})},a.updateFast=function(r){var t=this.xData=this.pickXData=r.x,c=this.yData=this.pickYData=r.y,o=this.pickXYData=r.xy,i=r.xbounds&&r.ybounds,y=r.indices,p,g,h,m=this.bounds,u,_,s;if(o){if(h=o,p=o.length>>>1,i)m[0]=r.xbounds[0],m[2]=r.xbounds[1],m[1]=r.ybounds[0],m[3]=r.ybounds[1];else for(s=0;s<p;s++)u=h[s*2],_=h[s*2+1],u<m[0]&&(m[0]=u),u>m[2]&&(m[2]=u),_<m[1]&&(m[1]=_),_>m[3]&&(m[3]=_);if(y)g=y;else for(g=new Int32Array(p),s=0;s<p;s++)g[s]=s}else for(p=t.length,h=new Float32Array(2*p),g=new Int32Array(p),s=0;s<p;s++)u=t[s],_=c[s],g[s]=s,h[s*2]=u,h[s*2+1]=_,u<m[0]&&(m[0]=u),u>m[2]&&(m[2]=u),_<m[1]&&(m[1]=_),_>m[3]&&(m[3]=_);this.idToIndex=g,this.pointcloudOptions.idToIndex=g,this.pointcloudOptions.positions=h;var A=v(r.marker.color),b=v(r.marker.border.color),f=r.opacity*r.marker.opacity;A[3]*=f,this.pointcloudOptions.color=A;var x=r.marker.blend;if(x===null){var l=100;x=t.length<l||c.length<l}this.pointcloudOptions.blend=x,b[3]*=f,this.pointcloudOptions.borderColor=b;var L=r.marker.sizemin,T=Math.max(r.marker.sizemax,r.marker.sizemin);this.pointcloudOptions.sizeMin=L,this.pointcloudOptions.sizeMax=T,this.pointcloudOptions.areaRatio=r.marker.border.arearatio,this.pointcloud.update(this.pointcloudOptions);var k=this.scene.xaxis,P=this.scene.yaxis,z=T/2||.5;r._extremes[k._id]=S(k,[m[0],m[2]],{ppad:z}),r._extremes[P._id]=S(P,[m[1],m[3]],{ppad:z})},a.dispose=function(){this.pointcloud.dispose()};function n(r,t){var c=new e(r,t.uid);return c.update(t),c}ee.exports=n},{"../../../stackgl_modules":1133,"../../lib/str2rgbarray":540,"../../plots/cartesian/autorange":565,"../scatter/get_trace_color":946}],924:[function(d,ee,te){var w=d("../../lib"),v=d("./attributes");ee.exports=function(M,e,a){function n(r,t){return w.coerce(M,e,v,r,t)}n("x"),n("y"),n("xbounds"),n("ybounds"),M.xy&&M.xy instanceof Float32Array&&(e.xy=M.xy),M.indices&&M.indices instanceof Int32Array&&(e.indices=M.indices),n("text"),n("marker.color",a),n("marker.opacity"),n("marker.blend"),n("marker.sizemin"),n("marker.sizemax"),n("marker.border.color",a),n("marker.border.arearatio"),e._length=null}},{"../../lib":515,"./attributes":922}],925:[function(d,ee,te){ee.exports={attributes:d("./attributes"),supplyDefaults:d("./defaults"),calc:d("../scatter3d/calc"),plot:d("./convert"),moduleType:"trace",name:"pointcloud",basePlotModule:d("../../plots/gl2d"),categories:["gl","gl2d","showLegend"],meta:{}}},{"../../plots/gl2d":605,"../scatter3d/calc":965,"./attributes":922,"./convert":923,"./defaults":924}],926:[function(d,ee,te){var w=d("../../plots/font_attributes"),v=d("../../plots/attributes"),S=d("../../components/color/attributes"),M=d("../../components/fx/attributes"),e=d("../../plots/domain").attributes,a=d("../../plots/template_attributes").hovertemplateAttrs,n=d("../../components/colorscale/attributes"),r=d("../../plot_api/plot_template").templatedArray,t=d("../../plots/cartesian/axis_format_attributes").descriptionOnlyNumbers,c=d("../../lib/extend").extendFlat,o=d("../../plot_api/edit_types").overrideAll,i=ee.exports=o({hoverinfo:c({},v.hoverinfo,{flags:[],arrayOk:!1}),hoverlabel:M.hoverlabel,domain:e({name:"sankey",trace:!0}),orientation:{valType:"enumerated",values:["v","h"],dflt:"h"},valueformat:{valType:"string",dflt:".3s",description:t("value")},valuesuffix:{valType:"string",dflt:""},arrangement:{valType:"enumerated",values:["snap","perpendicular","freeform","fixed"],dflt:"snap"},textfont:w({}),customdata:void 0,node:{label:{valType:"data_array",dflt:[]},groups:{valType:"info_array",impliedEdits:{x:[],y:[]},dimensions:2,freeLength:!0,dflt:[],items:{valType:"number",editType:"calc"}},x:{valType:"data_array",dflt:[]},y:{valType:"data_array",dflt:[]},color:{valType:"color",arrayOk:!0},customdata:{valType:"data_array",editType:"calc"},line:{color:{valType:"color",dflt:S.defaultLine,arrayOk:!0},width:{valType:"number",min:0,dflt:.5,arrayOk:!0}},pad:{valType:"number",arrayOk:!1,min:0,dflt:20},thickness:{valType:"number",arrayOk:!1,min:1,dflt:20},hoverinfo:{valType:"enumerated",values:["all","none","skip"],dflt:"all"},hoverlabel:M.hoverlabel,hovertemplate:a({},{keys:["value","label"]})},link:{label:{valType:"data_array",dflt:[]},color:{valType:"color",arrayOk:!0},customdata:{valType:"data_array",editType:"calc"},line:{color:{valType:"color",dflt:S.defaultLine,arrayOk:!0},width:{valType:"number",min:0,dflt:0,arrayOk:!0}},source:{valType:"data_array",dflt:[]},target:{valType:"data_array",dflt:[]},value:{valType:"data_array",dflt:[]},hoverinfo:{valType:"enumerated",values:["all","none","skip"],dflt:"all"},hoverlabel:M.hoverlabel,hovertemplate:a({},{keys:["value","label"]}),colorscales:r("concentrationscales",{editType:"calc",label:{valType:"string",editType:"calc",dflt:""},cmax:{valType:"number",editType:"calc",dflt:1},cmin:{valType:"number",editType:"calc",dflt:0},colorscale:c(n().colorscale,{dflt:[[0,"white"],[1,"black"]]})})}},"calc","nested");i.transforms=void 0},{"../../components/color/attributes":366,"../../components/colorscale/attributes":374,"../../components/fx/attributes":398,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plot_api/plot_template":555,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/domain":593,"../../plots/font_attributes":594,"../../plots/template_attributes":642}],927:[function(d,ee,te){var w=d("../../plot_api/edit_types").overrideAll,v=d("../../plots/get_data").getModuleCalcData,S=d("./plot"),M=d("../../components/fx/layout_attributes"),e=d("../../lib/setcursor"),a=d("../../components/dragelement"),n=d("../../components/selections").prepSelect,r=d("../../lib"),t=d("../../registry"),c="sankey";te.name=c,te.baseLayoutAttrOverrides=w({hoverlabel:M.hoverlabel},"plot","nested"),te.plot=function(i){var y=v(i.calcdata,c)[0];S(i,y),te.updateFx(i)},te.clean=function(i,y,p,g){var h=g._has&&g._has(c),m=y._has&&y._has(c);h&&!m&&(g._paperdiv.selectAll(".sankey").remove(),g._paperdiv.selectAll(".bgsankey").remove())},te.updateFx=function(i){for(var y=0;y<i._fullData.length;y++)o(i,y)};function o(i,y){var p=i._fullData[y],g=i._fullLayout,h=g.dragmode,m=g.dragmode==="pan"?"move":"crosshair",u=p._bgRect;if(!!u&&!(h==="pan"||h==="zoom")){e(u,m);var _={_id:"x",c2p:r.identity,_offset:p._sankey.translateX,_length:p._sankey.width},s={_id:"y",c2p:r.identity,_offset:p._sankey.translateY,_length:p._sankey.height},A={gd:i,element:u.node(),plotinfo:{id:y,xaxis:_,yaxis:s,fillRangeItems:r.noop},subplot:y,xaxes:[_],yaxes:[s],doneFnCompleted:function(b){var f=i._fullData[y],x,l=f.node.groups.slice(),L=[];function T(I){for(var D=f._sankey.graph.nodes,R=0;R<D.length;R++)if(D[R].pointNumber===I)return D[R]}for(var k=0;k<b.length;k++){var P=T(b[k].pointNumber);if(!!P)if(P.group){for(var z=0;z<P.childrenNodes.length;z++)L.push(P.childrenNodes[z].pointNumber);l[P.pointNumber-f.node._count]=!1}else L.push(P.pointNumber)}x=l.filter(Boolean).concat([L]),t.call("_guiRestyle",i,{"node.groups":[x]},y)}};A.prepFn=function(b,f,x){n(b,f,x,A,h)},a.init(A)}}},{"../../components/dragelement":386,"../../components/fx/layout_attributes":408,"../../components/selections":455,"../../lib":515,"../../lib/setcursor":536,"../../plot_api/edit_types":548,"../../plots/get_data":602,"../../registry":647,"./plot":932}],928:[function(d,ee,te){var w=d("strongly-connected-components"),v=d("../../lib"),S=d("../../lib/gup").wrap,M=v.isArrayOrTypedArray,e=v.isIndex,a=d("../../components/colorscale");function n(t){var c=t.node,o=t.link,i=[],y=M(o.color),p=M(o.customdata),g={},h={},m=o.colorscales.length,u;for(u=0;u<m;u++){var _=o.colorscales[u],s=a.extractScale(_,{cLetter:"c"}),A=a.makeColorScaleFunc(s);h[_.label]=A}var b=0;for(u=0;u<o.value.length;u++)o.source[u]>b&&(b=o.source[u]),o.target[u]>b&&(b=o.target[u]);var f=b+1;t.node._count=f;var x,l=t.node.groups,L={};for(u=0;u<l.length;u++){var T=l[u];for(x=0;x<T.length;x++){var k=T[x],P=f+u;L.hasOwnProperty(k)?v.warn("Node "+k+" is already part of a group."):L[k]=P}}var z={source:[],target:[]};for(u=0;u<o.value.length;u++){var I=o.value[u],D=o.source[u],R=o.target[u];if(!!(I>0&&e(D,f)&&e(R,f))&&!(L.hasOwnProperty(D)&&L.hasOwnProperty(R)&&L[D]===L[R])){L.hasOwnProperty(R)&&(R=L[R]),L.hasOwnProperty(D)&&(D=L[D]),D=+D,R=+R,g[D]=g[R]=!0;var B="";o.label&&o.label[u]&&(B=o.label[u]);var F=null;B&&h.hasOwnProperty(B)&&(F=h[B]),i.push({pointNumber:u,label:B,color:y?o.color[u]:o.color,customdata:p?o.customdata[u]:o.customdata,concentrationscale:F,source:D,target:R,value:+I}),z.source.push(D),z.target.push(R)}}var H=f+l.length,G=M(c.color),J=M(c.customdata),X=[];for(u=0;u<H;u++)if(!!g[u]){var Y=c.label[u];X.push({group:u>f-1,childrenNodes:[],pointNumber:u,label:Y,color:G?c.color[u]:c.color,customdata:J?c.customdata[u]:c.customdata})}var Z=!1;return r(H,z.source,z.target)&&(Z=!0),{circular:Z,links:i,nodes:X,groups:l,groupLookup:L}}function r(t,c,o){for(var i=v.init2dArray(t,0),y=0;y<Math.min(c.length,o.length);y++)if(v.isIndex(c[y],t)&&v.isIndex(o[y],t)){if(c[y]===o[y])return!0;i[c[y]].push(o[y])}var p=w(i);return p.components.some(function(g){return g.length>1})}ee.exports=function(c,o){var i=n(o);return S({circular:i.circular,_nodes:i.nodes,_links:i.links,_groups:i.groups,_groupLookup:i.groupLookup})}},{"../../components/colorscale":379,"../../lib":515,"../../lib/gup":512,"strongly-connected-components":307}],929:[function(d,ee,te){ee.exports={nodeTextOffsetHorizontal:4,nodeTextOffsetVertical:3,nodePadAcross:10,sankeyIterations:50,forceIterations:5,forceTicksPerFrame:10,duration:500,ease:"linear",cn:{sankey:"sankey",sankeyLinks:"sankey-links",sankeyLink:"sankey-link",sankeyNodeSet:"sankey-node-set",sankeyNode:"sankey-node",nodeRect:"node-rect",nodeLabel:"node-label"}}},{}],930:[function(d,ee,te){var w=d("../../lib"),v=d("./attributes"),S=d("../../components/color"),M=d("tinycolor2"),e=d("../../plots/domain").defaults,a=d("../../components/fx/hoverlabel_defaults"),n=d("../../plot_api/plot_template"),r=d("../../plots/array_container_defaults");ee.exports=function(o,i,y,p){function g(T,k){return w.coerce(o,i,v,T,k)}var h=w.extendDeep(p.hoverlabel,o.hoverlabel),m=o.node,u=n.newContainer(i,"node");function _(T,k){return w.coerce(m,u,v.node,T,k)}_("label"),_("groups"),_("x"),_("y"),_("pad"),_("thickness"),_("line.color"),_("line.width"),_("hoverinfo",o.hoverinfo),a(m,u,_,h),_("hovertemplate");var s=p.colorway,A=function(T){return s[T%s.length]};_("color",u.label.map(function(T,k){return S.addOpacity(A(k),.8)})),_("customdata");var b=o.link||{},f=n.newContainer(i,"link");function x(T,k){return w.coerce(b,f,v.link,T,k)}x("label"),x("source"),x("target"),x("value"),x("line.color"),x("line.width"),x("hoverinfo",o.hoverinfo),a(b,f,x,h),x("hovertemplate");var l=M(p.paper_bgcolor).getLuminance()<.333?"rgba(255, 255, 255, 0.6)":"rgba(0, 0, 0, 0.2)";x("color",w.repeat(l,f.value.length)),x("customdata"),r(b,f,{name:"colorscales",handleItemDefaults:t}),e(i,p,g),g("orientation"),g("valueformat"),g("valuesuffix");var L;u.x.length&&u.y.length&&(L="freeform"),g("arrangement",L),w.coerceFont(g,"textfont",w.extendFlat({},p.font)),i._length=null};function t(c,o){function i(y,p){return w.coerce(c,o,v.link.colorscales,y,p)}i("label"),i("cmin"),i("cmax"),i("colorscale")}},{"../../components/color":367,"../../components/fx/hoverlabel_defaults":405,"../../lib":515,"../../plot_api/plot_template":555,"../../plots/array_container_defaults":561,"../../plots/domain":593,"./attributes":926,tinycolor2:313}],931:[function(d,ee,te){ee.exports={attributes:d("./attributes"),supplyDefaults:d("./defaults"),calc:d("./calc"),plot:d("./plot"),moduleType:"trace",name:"sankey",basePlotModule:d("./base_plot"),selectPoints:d("./select.js"),categories:["noOpacity"],meta:{}}},{"./attributes":926,"./base_plot":927,"./calc":928,"./defaults":930,"./plot":932,"./select.js":934}],932:[function(d,ee,te){var w=d("@plotly/d3"),v=d("../../lib"),S=v.numberFormat,M=d("./render"),e=d("../../components/fx"),a=d("../../components/color"),n=d("./constants").cn,r=v._;function t(s){return s!==""}function c(s,A){return s.filter(function(b){return b.key===A.traceId})}function o(s,A){w.select(s).select("path").style("fill-opacity",A),w.select(s).select("rect").style("fill-opacity",A)}function i(s){w.select(s).select("text.name").style("fill","black")}function y(s){return function(A){return s.node.sourceLinks.indexOf(A.link)!==-1||s.node.targetLinks.indexOf(A.link)!==-1}}function p(s){return function(A){return A.node.sourceLinks.indexOf(s.link)!==-1||A.node.targetLinks.indexOf(s.link)!==-1}}function g(s,A,b){A&&b&&c(b,A).selectAll("."+n.sankeyLink).filter(y(A)).call(m.bind(0,A,b,!1))}function h(s,A,b){A&&b&&c(b,A).selectAll("."+n.sankeyLink).filter(y(A)).call(u.bind(0,A,b,!1))}function m(s,A,b,f){var x=f.datum().link.label;f.style("fill-opacity",function(l){if(!l.link.concentrationscale)return .4}),x&&c(A,s).selectAll("."+n.sankeyLink).filter(function(l){return l.link.label===x}).style("fill-opacity",function(l){if(!l.link.concentrationscale)return .4}),b&&c(A,s).selectAll("."+n.sankeyNode).filter(p(s)).call(g)}function u(s,A,b,f){var x=f.datum().link.label;f.style("fill-opacity",function(l){return l.tinyColorAlpha}),x&&c(A,s).selectAll("."+n.sankeyLink).filter(function(l){return l.link.label===x}).style("fill-opacity",function(l){return l.tinyColorAlpha}),b&&c(A,s).selectAll(n.sankeyNode).filter(p(s)).call(h)}function _(s,A){var b=s.hoverlabel||{},f=v.nestedProperty(b,A).get();return Array.isArray(f)?!1:f}ee.exports=function(A,b){for(var f=A._fullLayout,x=f._paper,l=f._size,L=0;L<A._fullData.length;L++)if(!!A._fullData[L].visible&&A._fullData[L].type===n.sankey&&!A._fullData[L]._viewInitial){var T=A._fullData[L].node;A._fullData[L]._viewInitial={node:{groups:T.groups.slice(),x:T.x.slice(),y:T.y.slice()}}}var k=function(Z,oe){var re=oe.link;re.originalEvent=w.event,A._hoverdata=[re],e.click(A,{target:!0})},P=function(Z,oe,re){A._fullLayout.hovermode!==!1&&(w.select(Z).call(m.bind(0,oe,re,!0)),oe.link.trace.link.hoverinfo!=="skip"&&(oe.link.fullData=oe.link.trace,A.emit("plotly_hover",{event:w.event,points:[oe.link]})))},z=r(A,"source:")+" ",I=r(A,"target:")+" ",D=r(A,"concentration:")+" ",R=r(A,"incoming flow count:")+" ",B=r(A,"outgoing flow count:")+" ",F=function(Z,oe){if(A._fullLayout.hovermode===!1)return;var re=oe.link.trace.link;if(re.hoverinfo==="none"||re.hoverinfo==="skip")return;var se=[];function N(ae){var ie,le;ae.circular?(ie=(ae.circularPathData.leftInnerExtent+ae.circularPathData.rightInnerExtent)/2,le=ae.circularPathData.verticalFullExtent):(ie=(ae.source.x1+ae.target.x0)/2,le=(ae.y0+ae.y1)/2);var ye=[ie,le];return ae.trace.orientation==="v"&&ye.reverse(),ye[0]+=oe.parent.translateX,ye[1]+=oe.parent.translateY,ye}for(var U=0,q=0;q<oe.flow.links.length;q++){var $=oe.flow.links[q];if(!(A._fullLayout.hovermode==="closest"&&oe.link.pointNumber!==$.pointNumber)){oe.link.pointNumber===$.pointNumber&&(U=q),$.fullData=$.trace,re=oe.link.trace.link;var W=N($),K={valueLabel:S(oe.valueFormat)($.value)+oe.valueSuffix};se.push({x:W[0],y:W[1],name:K.valueLabel,text:[$.label||"",z+$.source.label,I+$.target.label,$.concentrationscale?D+S("%0.2f")($.flow.labelConcentration):""].filter(t).join("<br>"),color:_(re,"bgcolor")||a.addOpacity($.color,1),borderColor:_(re,"bordercolor"),fontFamily:_(re,"font.family"),fontSize:_(re,"font.size"),fontColor:_(re,"font.color"),nameLength:_(re,"namelength"),textAlign:_(re,"align"),idealAlign:w.event.x<W[0]?"right":"left",hovertemplate:re.hovertemplate,hovertemplateLabels:K,eventData:[$]})}}var ne=e.loneHover(se,{container:f._hoverlayer.node(),outerContainer:f._paper.node(),gd:A,anchorIndex:U});ne.each(function(){var ae=this;oe.link.concentrationscale||o(ae,.65),i(ae)})},H=function(Z,oe,re){A._fullLayout.hovermode!==!1&&(w.select(Z).call(u.bind(0,oe,re,!0)),oe.link.trace.link.hoverinfo!=="skip"&&(oe.link.fullData=oe.link.trace,A.emit("plotly_unhover",{event:w.event,points:[oe.link]})),e.loneUnhover(f._hoverlayer.node()))},G=function(Z,oe,re){var se=oe.node;se.originalEvent=w.event,A._hoverdata=[se],w.select(Z).call(h,oe,re),e.click(A,{target:!0})},J=function(Z,oe,re){A._fullLayout.hovermode!==!1&&(w.select(Z).call(g,oe,re),oe.node.trace.node.hoverinfo!=="skip"&&(oe.node.fullData=oe.node.trace,A.emit("plotly_hover",{event:w.event,points:[oe.node]})))},X=function(Z,oe){if(A._fullLayout.hovermode!==!1){var re=oe.node.trace.node;if(!(re.hoverinfo==="none"||re.hoverinfo==="skip")){var se=w.select(Z).select("."+n.nodeRect),N=A._fullLayout._paperdiv.node().getBoundingClientRect(),U=se.node().getBoundingClientRect(),q=U.left-2-N.left,$=U.right+2-N.left,W=U.top+U.height/4-N.top,K={valueLabel:S(oe.valueFormat)(oe.node.value)+oe.valueSuffix};oe.node.fullData=oe.node.trace,A._fullLayout._calcInverseTransform(A);var ne=A._fullLayout._invScaleX,ae=A._fullLayout._invScaleY,ie=e.loneHover({x0:ne*q,x1:ne*$,y:ae*W,name:S(oe.valueFormat)(oe.node.value)+oe.valueSuffix,text:[oe.node.label,R+oe.node.targetLinks.length,B+oe.node.sourceLinks.length].filter(t).join("<br>"),color:_(re,"bgcolor")||oe.tinyColorHue,borderColor:_(re,"bordercolor"),fontFamily:_(re,"font.family"),fontSize:_(re,"font.size"),fontColor:_(re,"font.color"),nameLength:_(re,"namelength"),textAlign:_(re,"align"),idealAlign:"left",hovertemplate:re.hovertemplate,hovertemplateLabels:K,eventData:[oe.node]},{container:f._hoverlayer.node(),outerContainer:f._paper.node(),gd:A});o(ie,.85),i(ie)}}},Y=function(Z,oe,re){A._fullLayout.hovermode!==!1&&(w.select(Z).call(h,oe,re),oe.node.trace.node.hoverinfo!=="skip"&&(oe.node.fullData=oe.node.trace,A.emit("plotly_unhover",{event:w.event,points:[oe.node]})),e.loneUnhover(f._hoverlayer.node()))};M(A,x,b,{width:l.w,height:l.h,margin:{t:l.t,r:l.r,b:l.b,l:l.l}},{linkEvents:{hover:P,follow:F,unhover:H,select:k},nodeEvents:{hover:J,follow:X,unhover:Y,select:G}})}},{"../../components/color":367,"../../components/fx":407,"../../lib":515,"./constants":929,"./render":933,"@plotly/d3":58}],933:[function(d,ee,te){var w=d("d3-force"),v=d("d3-interpolate").interpolateNumber,S=d("@plotly/d3"),M=d("@plotly/d3-sankey"),e=d("@plotly/d3-sankey-circular"),a=d("./constants"),n=d("tinycolor2"),r=d("../../components/color"),t=d("../../components/drawing"),c=d("../../lib"),o=c.strTranslate,i=c.strRotate,y=d("../../lib/gup"),p=y.keyFun,g=y.repeat,h=y.unwrap,m=d("../../lib/svg_text_utils"),u=d("../../registry"),_=d("../../constants/alignment"),s=_.CAP_SHIFT,A=_.LINE_SPACING,b=3;function f(N,U,q){var $=h(U),W=$.trace,K=W.domain,ne=W.orientation==="h",ae=W.node.pad,ie=W.node.thickness,le=N.width*(K.x[1]-K.x[0]),ye=N.height*(K.y[1]-K.y[0]),ue=$._nodes,pe=$._links,ge=$.circular,Te;ge?Te=e.sankeyCircular().circularLinkGap(0):Te=M.sankey(),Te.iterations(a.sankeyIterations).size(ne?[le,ye]:[ye,le]).nodeWidth(ie).nodePadding(ae).nodeId(function(Lt){return Lt.pointNumber}).nodes(ue).links(pe);var _e=Te();Te.nodePadding()<ae&&c.warn("node.pad was reduced to ",Te.nodePadding()," to fit within the figure.");var ze,Oe,Ye;for(var be in $._groupLookup){var Pe=parseInt($._groupLookup[be]),Ge;for(ze=0;ze<_e.nodes.length;ze++)if(_e.nodes[ze].pointNumber===Pe){Ge=_e.nodes[ze];break}if(!!Ge){var Qe={pointNumber:parseInt(be),x0:Ge.x0,x1:Ge.x1,y0:Ge.y0,y1:Ge.y1,partOfGroup:!0,sourceLinks:[],targetLinks:[]};_e.nodes.unshift(Qe),Ge.childrenNodes.unshift(Qe)}}function Be(){for(ze=0;ze<_e.nodes.length;ze++){var Lt=_e.nodes[ze],Ft={},Gt,Dt;for(Oe=0;Oe<Lt.targetLinks.length;Oe++)Dt=Lt.targetLinks[Oe],Gt=Dt.source.pointNumber+":"+Dt.target.pointNumber,Ft.hasOwnProperty(Gt)||(Ft[Gt]=[]),Ft[Gt].push(Dt);var kt=Object.keys(Ft);for(Oe=0;Oe<kt.length;Oe++){Gt=kt[Oe];var Ue=Ft[Gt],qe=0,Ve={};for(Ye=0;Ye<Ue.length;Ye++)Dt=Ue[Ye],Ve[Dt.label]||(Ve[Dt.label]=0),Ve[Dt.label]+=Dt.value,qe+=Dt.value;for(Ye=0;Ye<Ue.length;Ye++)Dt=Ue[Ye],Dt.flow={value:qe,labelConcentration:Ve[Dt.label]/qe,concentration:Dt.value/qe,links:Ue},Dt.concentrationscale&&(Dt.color=n(Dt.concentrationscale(Dt.flow.labelConcentration)))}var Ae=0;for(Oe=0;Oe<Lt.sourceLinks.length;Oe++)Ae+=Lt.sourceLinks[Oe].value;for(Oe=0;Oe<Lt.sourceLinks.length;Oe++)Dt=Lt.sourceLinks[Oe],Dt.concentrationOut=Dt.value/Ae;var Ne=0;for(Oe=0;Oe<Lt.targetLinks.length;Oe++)Ne+=Lt.targetLinks[Oe].value;for(Oe=0;Oe<Lt.targetLinks.length;Oe++)Dt=Lt.targetLinks[Oe],Dt.concenrationIn=Dt.value/Ne}}Be();function Le(Lt){Lt.forEach(function(Ft){var Gt,Dt,kt=0,Ue=Ft.length,qe;for(Ft.sort(function(Ve,Ae){return Ve.y0-Ae.y0}),qe=0;qe<Ue;++qe)Gt=Ft[qe],Gt.y0>=kt||(Dt=kt-Gt.y0,Dt>1e-6&&(Gt.y0+=Dt,Gt.y1+=Dt)),kt=Gt.y1+ae})}function He(Lt){var Ft=Lt.map(function(Ae,Ne){return{x0:Ae.x0,index:Ne}}).sort(function(Ae,Ne){return Ae.x0-Ne.x0}),Gt=[],Dt=-1,kt,Ue=-1/0,qe;for(ze=0;ze<Ft.length;ze++){var Ve=Lt[Ft[ze].index];Ve.x0>Ue+ie&&(Dt+=1,kt=Ve.x0),Ue=Ve.x0,Gt[Dt]||(Gt[Dt]=[]),Gt[Dt].push(Ve),qe=kt-Ve.x0,Ve.x0+=qe,Ve.x1+=qe}return Gt}if(W.node.x.length&&W.node.y.length){for(ze=0;ze<Math.min(W.node.x.length,W.node.y.length,_e.nodes.length);ze++)if(W.node.x[ze]&&W.node.y[ze]){var vt=[W.node.x[ze]*le,W.node.y[ze]*ye];_e.nodes[ze].x0=vt[0]-ie/2,_e.nodes[ze].x1=vt[0]+ie/2;var Rt=_e.nodes[ze].y1-_e.nodes[ze].y0;_e.nodes[ze].y0=vt[1]-Rt/2,_e.nodes[ze].y1=vt[1]+Rt/2}if(W.arrangement==="snap"){ue=_e.nodes;var rr=He(ue);Le(rr)}Te.update(_e)}return{circular:ge,key:q,trace:W,guid:c.randstr(),horizontal:ne,width:le,height:ye,nodePad:W.node.pad,nodeLineColor:W.node.line.color,nodeLineWidth:W.node.line.width,linkLineColor:W.link.line.color,linkLineWidth:W.link.line.width,valueFormat:W.valueformat,valueSuffix:W.valuesuffix,textFont:W.textfont,translateX:K.x[0]*N.width+N.margin.l,translateY:N.height-K.y[1]*N.height+N.margin.t,dragParallel:ne?ye:le,dragPerpendicular:ne?le:ye,arrangement:W.arrangement,sankey:Te,graph:_e,forceLayouts:{},interactionState:{dragInProgress:!1,hovered:!1}}}function x(N,U,q){var $=n(U.color),W=U.source.label+"|"+U.target.label,K=W+"__"+q;return U.trace=N.trace,U.curveNumber=N.trace.index,{circular:N.circular,key:K,traceId:N.key,pointNumber:U.pointNumber,link:U,tinyColorHue:r.tinyRGB($),tinyColorAlpha:$.getAlpha(),linkPath:L,linkLineColor:N.linkLineColor,linkLineWidth:N.linkLineWidth,valueFormat:N.valueFormat,valueSuffix:N.valueSuffix,sankey:N.sankey,parent:N,interactionState:N.interactionState,flow:U.flow}}function l(N){var U="",q=N.width/2,$=N.circularPathData;return N.circularLinkType==="top"?U="M "+$.targetX+" "+($.targetY+q)+" L"+$.rightInnerExtent+" "+($.targetY+q)+"A"+($.rightLargeArcRadius+q)+" "+($.rightSmallArcRadius+q)+" 0 0 1 "+($.rightFullExtent-q)+" "+($.targetY-$.rightSmallArcRadius)+"L"+($.rightFullExtent-q)+" "+$.verticalRightInnerExtent+"A"+($.rightLargeArcRadius+q)+" "+($.rightLargeArcRadius+q)+" 0 0 1 "+$.rightInnerExtent+" "+($.verticalFullExtent-q)+"L"+$.leftInnerExtent+" "+($.verticalFullExtent-q)+"A"+($.leftLargeArcRadius+q)+" "+($.leftLargeArcRadius+q)+" 0 0 1 "+($.leftFullExtent+q)+" "+$.verticalLeftInnerExtent+"L"+($.leftFullExtent+q)+" "+($.sourceY-$.leftSmallArcRadius)+"A"+($.leftLargeArcRadius+q)+" "+($.leftSmallArcRadius+q)+" 0 0 1 "+$.leftInnerExtent+" "+($.sourceY+q)+"L"+$.sourceX+" "+($.sourceY+q)+"L"+$.sourceX+" "+($.sourceY-q)+"L"+$.leftInnerExtent+" "+($.sourceY-q)+"A"+($.leftLargeArcRadius-q)+" "+($.leftSmallArcRadius-q)+" 0 0 0 "+($.leftFullExtent-q)+" "+($.sourceY-$.leftSmallArcRadius)+"L"+($.leftFullExtent-q)+" "+$.verticalLeftInnerExtent+"A"+($.leftLargeArcRadius-q)+" "+($.leftLargeArcRadius-q)+" 0 0 0 "+$.leftInnerExtent+" "+($.verticalFullExtent+q)+"L"+$.rightInnerExtent+" "+($.verticalFullExtent+q)+"A"+($.rightLargeArcRadius-q)+" "+($.rightLargeArcRadius-q)+" 0 0 0 "+($.rightFullExtent+q)+" "+$.verticalRightInnerExtent+"L"+($.rightFullExtent+q)+" "+($.targetY-$.rightSmallArcRadius)+"A"+($.rightLargeArcRadius-q)+" "+($.rightSmallArcRadius-q)+" 0 0 0 "+$.rightInnerExtent+" "+($.targetY-q)+"L"+$.targetX+" "+($.targetY-q)+"Z":U="M "+$.targetX+" "+($.targetY-q)+" L"+$.rightInnerExtent+" "+($.targetY-q)+"A"+($.rightLargeArcRadius+q)+" "+($.rightSmallArcRadius+q)+" 0 0 0 "+($.rightFullExtent-q)+" "+($.targetY+$.rightSmallArcRadius)+"L"+($.rightFullExtent-q)+" "+$.verticalRightInnerExtent+"A"+($.rightLargeArcRadius+q)+" "+($.rightLargeArcRadius+q)+" 0 0 0 "+$.rightInnerExtent+" "+($.verticalFullExtent+q)+"L"+$.leftInnerExtent+" "+($.verticalFullExtent+q)+"A"+($.leftLargeArcRadius+q)+" "+($.leftLargeArcRadius+q)+" 0 0 0 "+($.leftFullExtent+q)+" "+$.verticalLeftInnerExtent+"L"+($.leftFullExtent+q)+" "+($.sourceY+$.leftSmallArcRadius)+"A"+($.leftLargeArcRadius+q)+" "+($.leftSmallArcRadius+q)+" 0 0 0 "+$.leftInnerExtent+" "+($.sourceY-q)+"L"+$.sourceX+" "+($.sourceY-q)+"L"+$.sourceX+" "+($.sourceY+q)+"L"+$.leftInnerExtent+" "+($.sourceY+q)+"A"+($.leftLargeArcRadius-q)+" "+($.leftSmallArcRadius-q)+" 0 0 1 "+($.leftFullExtent-q)+" "+($.sourceY+$.leftSmallArcRadius)+"L"+($.leftFullExtent-q)+" "+$.verticalLeftInnerExtent+"A"+($.leftLargeArcRadius-q)+" "+($.leftLargeArcRadius-q)+" 0 0 1 "+$.leftInnerExtent+" "+($.verticalFullExtent-q)+"L"+$.rightInnerExtent+" "+($.verticalFullExtent-q)+"A"+($.rightLargeArcRadius-q)+" "+($.rightLargeArcRadius-q)+" 0 0 1 "+($.rightFullExtent+q)+" "+$.verticalRightInnerExtent+"L"+($.rightFullExtent+q)+" "+($.targetY+$.rightSmallArcRadius)+"A"+($.rightLargeArcRadius-q)+" "+($.rightSmallArcRadius-q)+" 0 0 1 "+$.rightInnerExtent+" "+($.targetY+q)+"L"+$.targetX+" "+($.targetY+q)+"Z",U}function L(){var N=.5;function U(q){if(q.link.circular)return l(q.link);var $=q.link.source.x1,W=q.link.target.x0,K=v($,W),ne=K(N),ae=K(1-N),ie=q.link.y0-q.link.width/2,le=q.link.y0+q.link.width/2,ye=q.link.y1-q.link.width/2,ue=q.link.y1+q.link.width/2;return"M"+$+","+ie+"C"+ne+","+ie+" "+ae+","+ye+" "+W+","+ye+"L"+W+","+ue+"C"+ae+","+ue+" "+ne+","+le+" "+$+","+le+"Z"}return U}function T(N,U){var q=n(U.color),$=a.nodePadAcross,W=N.nodePad/2;U.dx=U.x1-U.x0,U.dy=U.y1-U.y0;var K=U.dx,ne=Math.max(.5,U.dy),ae="node_"+U.pointNumber;return U.group&&(ae=c.randstr()),U.trace=N.trace,U.curveNumber=N.trace.index,{index:U.pointNumber,key:ae,partOfGroup:U.partOfGroup||!1,group:U.group,traceId:N.key,trace:N.trace,node:U,nodePad:N.nodePad,nodeLineColor:N.nodeLineColor,nodeLineWidth:N.nodeLineWidth,textFont:N.textFont,size:N.horizontal?N.height:N.width,visibleWidth:Math.ceil(K),visibleHeight:ne,zoneX:-$,zoneY:-W,zoneWidth:K+2*$,zoneHeight:ne+2*W,labelY:N.horizontal?U.dy/2+1:U.dx/2+1,left:U.originalLayer===1,sizeAcross:N.width,forceLayouts:N.forceLayouts,horizontal:N.horizontal,darkBackground:q.getBrightness()<=128,tinyColorHue:r.tinyRGB(q),tinyColorAlpha:q.getAlpha(),valueFormat:N.valueFormat,valueSuffix:N.valueSuffix,sankey:N.sankey,graph:N.graph,arrangement:N.arrangement,uniqueNodeLabelPathId:[N.guid,N.key,ae].join("_"),interactionState:N.interactionState,figure:N}}function k(N){N.attr("transform",function(U){return o(U.node.x0.toFixed(3),U.node.y0.toFixed(3))})}function P(N){N.call(k)}function z(N,U){N.call(P),U.attr("d",L())}function I(N){N.attr("width",function(U){return U.node.x1-U.node.x0}).attr("height",function(U){return U.visibleHeight})}function D(N){return N.link.width>1||N.linkLineWidth>0}function R(N){var U=o(N.translateX,N.translateY);return U+(N.horizontal?"matrix(1 0 0 1 0 0)":"matrix(0 1 1 0 0 0)")}function B(N,U,q){N.on(".basic",null).on("mouseover.basic",function($){!$.interactionState.dragInProgress&&!$.partOfGroup&&(q.hover(this,$,U),$.interactionState.hovered=[this,$])}).on("mousemove.basic",function($){!$.interactionState.dragInProgress&&!$.partOfGroup&&(q.follow(this,$),$.interactionState.hovered=[this,$])}).on("mouseout.basic",function($){!$.interactionState.dragInProgress&&!$.partOfGroup&&(q.unhover(this,$,U),$.interactionState.hovered=!1)}).on("click.basic",function($){$.interactionState.hovered&&(q.unhover(this,$,U),$.interactionState.hovered=!1),!$.interactionState.dragInProgress&&!$.partOfGroup&&q.select(this,$,U)})}function F(N,U,q,$){var W=S.behavior.drag().origin(function(K){return{x:K.node.x0+K.visibleWidth/2,y:K.node.y0+K.visibleHeight/2}}).on("dragstart",function(K){if(K.arrangement!=="fixed"&&(c.ensureSingle($._fullLayout._infolayer,"g","dragcover",function(ae){$._fullLayout._dragCover=ae}),c.raiseToTop(this),K.interactionState.dragInProgress=K.node,Z(K.node),K.interactionState.hovered&&(q.nodeEvents.unhover.apply(0,K.interactionState.hovered),K.interactionState.hovered=!1),K.arrangement==="snap")){var ne=K.traceId+"|"+K.key;K.forceLayouts[ne]?K.forceLayouts[ne].alpha(1):H(N,ne,K),G(N,U,K,ne,$)}}).on("drag",function(K){if(K.arrangement!=="fixed"){var ne=S.event.x,ae=S.event.y;K.arrangement==="snap"?(K.node.x0=ne-K.visibleWidth/2,K.node.x1=ne+K.visibleWidth/2,K.node.y0=ae-K.visibleHeight/2,K.node.y1=ae+K.visibleHeight/2):(K.arrangement==="freeform"&&(K.node.x0=ne-K.visibleWidth/2,K.node.x1=ne+K.visibleWidth/2),ae=Math.max(0,Math.min(K.size-K.visibleHeight/2,ae)),K.node.y0=ae-K.visibleHeight/2,K.node.y1=ae+K.visibleHeight/2),Z(K.node),K.arrangement!=="snap"&&(K.sankey.update(K.graph),z(N.filter(oe(K)),U))}}).on("dragend",function(K){if(K.arrangement!=="fixed"){K.interactionState.dragInProgress=!1;for(var ne=0;ne<K.node.childrenNodes.length;ne++)K.node.childrenNodes[ne].x=K.node.x,K.node.childrenNodes[ne].y=K.node.y;K.arrangement!=="snap"&&X(K,$)}});N.on(".drag",null).call(W)}function H(N,U,q,$){re(q.graph.nodes);var W=q.graph.nodes.filter(function(K){return K.originalX===q.node.originalX}).filter(function(K){return!K.partOfGroup});q.forceLayouts[U]=w.forceSimulation(W).alphaDecay(0).force("collide",w.forceCollide().radius(function(K){return K.dy/2+q.nodePad/2}).strength(1).iterations(a.forceIterations)).force("constrain",J(N,U,W,q)).stop()}function G(N,U,q,$,W){window.requestAnimationFrame(function K(){var ne;for(ne=0;ne<a.forceTicksPerFrame;ne++)q.forceLayouts[$].tick();var ae=q.graph.nodes;if(se(ae),q.sankey.update(q.graph),z(N.filter(oe(q)),U),q.forceLayouts[$].alpha()>0)window.requestAnimationFrame(K);else{var ie=q.node.originalX;q.node.x0=ie-q.visibleWidth/2,q.node.x1=ie+q.visibleWidth/2,X(q,W)}})}function J(N,U,q,$){return function(){for(var K=0,ne=0;ne<q.length;ne++){var ae=q[ne];ae===$.interactionState.dragInProgress?(ae.x=ae.lastDraggedX,ae.y=ae.lastDraggedY):(ae.vx=(ae.originalX-ae.x)/a.forceTicksPerFrame,ae.y=Math.min($.size-ae.dy/2,Math.max(ae.dy/2,ae.y))),K=Math.max(K,Math.abs(ae.vx),Math.abs(ae.vy))}!$.interactionState.dragInProgress&&K<.1&&$.forceLayouts[U].alpha()>0&&$.forceLayouts[U].alpha(0)}}function X(N,U){for(var q=[],$=[],W=0;W<N.graph.nodes.length;W++){var K=(N.graph.nodes[W].x0+N.graph.nodes[W].x1)/2,ne=(N.graph.nodes[W].y0+N.graph.nodes[W].y1)/2;q.push(K/N.figure.width),$.push(ne/N.figure.height)}u.call("_guiRestyle",U,{"node.x":[q],"node.y":[$]},N.trace.index).then(function(){U._fullLayout._dragCover&&U._fullLayout._dragCover.remove()})}function Y(N){var U=[],q;for(q=0;q<N.length;q++)N[q].originalX=(N[q].x0+N[q].x1)/2,N[q].originalY=(N[q].y0+N[q].y1)/2,U.indexOf(N[q].originalX)===-1&&U.push(N[q].originalX);for(U.sort(function($,W){return $-W}),q=0;q<N.length;q++)N[q].originalLayerIndex=U.indexOf(N[q].originalX),N[q].originalLayer=N[q].originalLayerIndex/(U.length-1)}function Z(N){N.lastDraggedX=N.x0+N.dx/2,N.lastDraggedY=N.y0+N.dy/2}function oe(N){return function(U){return U.node.originalX===N.node.originalX}}function re(N){for(var U=0;U<N.length;U++)N[U].y=(N[U].y0+N[U].y1)/2,N[U].x=(N[U].x0+N[U].x1)/2}function se(N){for(var U=0;U<N.length;U++)N[U].y0=N[U].y-N[U].dy/2,N[U].y1=N[U].y0+N[U].dy,N[U].x0=N[U].x-N[U].dx/2,N[U].x1=N[U].x0+N[U].dx}ee.exports=function(N,U,q,$,W){var K=!1;c.ensureSingle(N._fullLayout._infolayer,"g","first-render",function(){K=!0});var ne=N._fullLayout._dragCover,ae=q.filter(function(_e){return h(_e).trace.visible}).map(f.bind(null,$)),ie=U.selectAll("."+a.cn.sankey).data(ae,p);ie.exit().remove(),ie.enter().append("g").classed(a.cn.sankey,!0).style("box-sizing","content-box").style("position","absolute").style("left",0).style("shape-rendering","geometricPrecision").style("pointer-events","auto").attr("transform",R),ie.each(function(_e,ze){N._fullData[ze]._sankey=_e;var Oe="bgsankey-"+_e.trace.uid+"-"+ze;c.ensureSingle(N._fullLayout._draggers,"rect",Oe),N._fullData[ze]._bgRect=S.select("."+Oe),N._fullData[ze]._bgRect.style("pointer-events","all").attr("width",_e.width).attr("height",_e.height).attr("x",_e.translateX).attr("y",_e.translateY).classed("bgsankey",!0).style({fill:"transparent","stroke-width":0})}),ie.transition().ease(a.ease).duration(a.duration).attr("transform",R);var le=ie.selectAll("."+a.cn.sankeyLinks).data(g,p);le.enter().append("g").classed(a.cn.sankeyLinks,!0).style("fill","none");var ye=le.selectAll("."+a.cn.sankeyLink).data(function(_e){var ze=_e.graph.links;return ze.filter(function(Oe){return Oe.value}).map(x.bind(null,_e))},p);ye.enter().append("path").classed(a.cn.sankeyLink,!0).call(B,ie,W.linkEvents),ye.style("stroke",function(_e){return D(_e)?r.tinyRGB(n(_e.linkLineColor)):_e.tinyColorHue}).style("stroke-opacity",function(_e){return D(_e)?r.opacity(_e.linkLineColor):_e.tinyColorAlpha}).style("fill",function(_e){return _e.tinyColorHue}).style("fill-opacity",function(_e){return _e.tinyColorAlpha}).style("stroke-width",function(_e){return D(_e)?_e.linkLineWidth:1}).attr("d",L()),ye.style("opacity",function(){return N._context.staticPlot||K||ne?1:0}).transition().ease(a.ease).duration(a.duration).style("opacity",1),ye.exit().transition().ease(a.ease).duration(a.duration).style("opacity",0).remove();var ue=ie.selectAll("."+a.cn.sankeyNodeSet).data(g,p);ue.enter().append("g").classed(a.cn.sankeyNodeSet,!0),ue.style("cursor",function(_e){switch(_e.arrangement){case"fixed":return"default";case"perpendicular":return"ns-resize";default:return"move"}});var pe=ue.selectAll("."+a.cn.sankeyNode).data(function(_e){var ze=_e.graph.nodes;return Y(ze),ze.map(T.bind(null,_e))},p);pe.enter().append("g").classed(a.cn.sankeyNode,!0).call(k).style("opacity",function(_e){return(N._context.staticPlot||K)&&!_e.partOfGroup?1:0}),pe.call(B,ie,W.nodeEvents).call(F,ye,W,N),pe.transition().ease(a.ease).duration(a.duration).call(k).style("opacity",function(_e){return _e.partOfGroup?0:1}),pe.exit().transition().ease(a.ease).duration(a.duration).style("opacity",0).remove();var ge=pe.selectAll("."+a.cn.nodeRect).data(g);ge.enter().append("rect").classed(a.cn.nodeRect,!0).call(I),ge.style("stroke-width",function(_e){return _e.nodeLineWidth}).style("stroke",function(_e){return r.tinyRGB(n(_e.nodeLineColor))}).style("stroke-opacity",function(_e){return r.opacity(_e.nodeLineColor)}).style("fill",function(_e){return _e.tinyColorHue}).style("fill-opacity",function(_e){return _e.tinyColorAlpha}),ge.transition().ease(a.ease).duration(a.duration).call(I);var Te=pe.selectAll("."+a.cn.nodeLabel).data(g);Te.enter().append("text").classed(a.cn.nodeLabel,!0).style("cursor","default"),Te.attr("data-notex",1).text(function(_e){return _e.node.label}).each(function(_e){var ze=S.select(this);t.font(ze,_e.textFont),m.convertToTspans(ze,N)}).style("text-shadow",m.makeTextShadow(N._fullLayout.paper_bgcolor)).attr("text-anchor",function(_e){return _e.horizontal&&_e.left?"end":"start"}).attr("transform",function(_e){var ze=S.select(this),Oe=m.lineCount(ze),Ye=_e.textFont.size*((Oe-1)*A-s),be=_e.nodeLineWidth/2+b,Pe=((_e.horizontal?_e.visibleHeight:_e.visibleWidth)-Ye)/2;_e.horizontal&&(_e.left?be=-be:be+=_e.visibleWidth);var Ge=_e.horizontal?"":"scale(-1,1)"+i(90);return o(_e.horizontal?be:Pe,_e.horizontal?Pe:be)+Ge}),Te.transition().ease(a.ease).duration(a.duration)}},{"../../components/color":367,"../../components/drawing":389,"../../constants/alignment":483,"../../lib":515,"../../lib/gup":512,"../../lib/svg_text_utils":541,"../../registry":647,"./constants":929,"@plotly/d3":58,"@plotly/d3-sankey":57,"@plotly/d3-sankey-circular":56,"d3-force":111,"d3-interpolate":116,tinycolor2:313}],934:[function(d,ee,te){ee.exports=function(v,S){for(var M=v.cd,e=[],a=M[0].trace,n=a._sankey.graph.nodes,r=0;r<n.length;r++){var t=n[r];if(!t.partOfGroup){var c=[(t.x0+t.x1)/2,(t.y0+t.y1)/2];a.orientation==="v"&&c.reverse(),S&&S.contains(c,!1,r,v)&&e.push({pointNumber:t.pointNumber})}}return e}},{}],935:[function(d,ee,te){var w=d("../../lib");ee.exports=function(S,M){for(var e=0;e<S.length;e++)S[e].i=e;w.mergeArray(M.text,S,"tx"),w.mergeArray(M.texttemplate,S,"txt"),w.mergeArray(M.hovertext,S,"htx"),w.mergeArray(M.customdata,S,"data"),w.mergeArray(M.textposition,S,"tp"),M.textfont&&(w.mergeArrayCastPositive(M.textfont.size,S,"ts"),w.mergeArray(M.textfont.color,S,"tc"),w.mergeArray(M.textfont.family,S,"tf"));var a=M.marker;if(a){w.mergeArrayCastPositive(a.size,S,"ms"),w.mergeArrayCastPositive(a.opacity,S,"mo"),w.mergeArray(a.symbol,S,"mx"),w.mergeArray(a.color,S,"mc");var n=a.line;a.line&&(w.mergeArray(n.color,S,"mlc"),w.mergeArrayCastPositive(n.width,S,"mlw"));var r=a.gradient;r&&r.type!=="none"&&(w.mergeArray(r.type,S,"mgt"),w.mergeArray(r.color,S,"mgc"))}}},{"../../lib":515}],936:[function(d,ee,te){var w=d("../../plots/cartesian/axis_format_attributes").axisHoverFormat,v=d("../../plots/template_attributes").texttemplateAttrs,S=d("../../plots/template_attributes").hovertemplateAttrs,M=d("../../components/colorscale/attributes"),e=d("../../plots/font_attributes"),a=d("../../components/drawing/attributes").dash,n=d("../../components/drawing/attributes").pattern,r=d("../../components/drawing"),t=d("./constants"),c=d("../../lib/extend").extendFlat;function o(p){return{valType:"any",dflt:0,editType:"calc"}}function i(p){return{valType:"any",editType:"calc"}}function y(p){return{valType:"enumerated",values:["start","middle","end"],dflt:"middle",editType:"calc"}}ee.exports={x:{valType:"data_array",editType:"calc+clearAxisTypes",anim:!0},x0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes",anim:!0},dx:{valType:"number",dflt:1,editType:"calc",anim:!0},y:{valType:"data_array",editType:"calc+clearAxisTypes",anim:!0},y0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes",anim:!0},dy:{valType:"number",dflt:1,editType:"calc",anim:!0},xperiod:o(),yperiod:o(),xperiod0:i(),yperiod0:i(),xperiodalignment:y(),yperiodalignment:y(),xhoverformat:w("x"),yhoverformat:w("y"),stackgroup:{valType:"string",dflt:"",editType:"calc"},orientation:{valType:"enumerated",values:["v","h"],editType:"calc"},groupnorm:{valType:"enumerated",values:["","fraction","percent"],dflt:"",editType:"calc"},stackgaps:{valType:"enumerated",values:["infer zero","interpolate"],dflt:"infer zero",editType:"calc"},text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},texttemplate:v({},{}),hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"style"},mode:{valType:"flaglist",flags:["lines","markers","text"],extras:["none"],editType:"calc"},hoveron:{valType:"flaglist",flags:["points","fills"],editType:"style"},hovertemplate:S({},{keys:t.eventDataKeys}),line:{color:{valType:"color",editType:"style",anim:!0},width:{valType:"number",min:0,dflt:2,editType:"style",anim:!0},shape:{valType:"enumerated",values:["linear","spline","hv","vh","hvh","vhv"],dflt:"linear",editType:"plot"},smoothing:{valType:"number",min:0,max:1.3,dflt:1,editType:"plot"},dash:c({},a,{editType:"style"}),simplify:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},connectgaps:{valType:"boolean",dflt:!1,editType:"calc"},cliponaxis:{valType:"boolean",dflt:!0,editType:"plot"},fill:{valType:"enumerated",values:["none","tozeroy","tozerox","tonexty","tonextx","toself","tonext"],editType:"calc"},fillcolor:{valType:"color",editType:"style",anim:!0},fillpattern:n,marker:c({symbol:{valType:"enumerated",values:r.symbolList,dflt:"circle",arrayOk:!0,editType:"style"},opacity:{valType:"number",min:0,max:1,arrayOk:!0,editType:"style",anim:!0},size:{valType:"number",min:0,dflt:6,arrayOk:!0,editType:"calc",anim:!0},maxdisplayed:{valType:"number",min:0,dflt:0,editType:"plot"},sizeref:{valType:"number",dflt:1,editType:"calc"},sizemin:{valType:"number",min:0,dflt:0,editType:"calc"},sizemode:{valType:"enumerated",values:["diameter","area"],dflt:"diameter",editType:"calc"},line:c({width:{valType:"number",min:0,arrayOk:!0,editType:"style",anim:!0},editType:"calc"},M("marker.line",{anim:!0})),gradient:{type:{valType:"enumerated",values:["radial","horizontal","vertical","none"],arrayOk:!0,dflt:"none",editType:"calc"},color:{valType:"color",arrayOk:!0,editType:"calc"},editType:"calc"},editType:"calc"},M("marker",{anim:!0})),selected:{marker:{opacity:{valType:"number",min:0,max:1,editType:"style"},color:{valType:"color",editType:"style"},size:{valType:"number",min:0,editType:"style"},editType:"style"},textfont:{color:{valType:"color",editType:"style"},editType:"style"},editType:"style"},unselected:{marker:{opacity:{valType:"number",min:0,max:1,editType:"style"},color:{valType:"color",editType:"style"},size:{valType:"number",min:0,editType:"style"},editType:"style"},textfont:{color:{valType:"color",editType:"style"},editType:"style"},editType:"style"},textposition:{valType:"enumerated",values:["top left","top center","top right","middle left","middle center","middle right","bottom left","bottom center","bottom right"],dflt:"middle center",arrayOk:!0,editType:"calc"},textfont:e({editType:"calc",colorEditType:"style",arrayOk:!0})}},{"../../components/colorscale/attributes":374,"../../components/drawing":389,"../../components/drawing/attributes":388,"../../lib/extend":505,"../../plots/cartesian/axis_format_attributes":569,"../../plots/font_attributes":594,"../../plots/template_attributes":642,"./constants":940}],937:[function(d,ee,te){var w=d("fast-isnumeric"),v=d("../../lib"),S=d("../../plots/cartesian/axes"),M=d("../../plots/cartesian/align_period"),e=d("../../constants/numerical").BADNUM,a=d("./subtypes"),n=d("./colorscale_calc"),r=d("./arrays_to_calcdata"),t=d("./calc_selection");function c(h,m){var u=h._fullLayout,_=S.getFromId(h,m.xaxis||"x"),s=S.getFromId(h,m.yaxis||"y"),A=_.makeCalcdata(m,"x"),b=s.makeCalcdata(m,"y"),f=M(m,_,"x",A),x=M(m,s,"y",b),l=f.vals,L=x.vals,T=m._length,k=new Array(T),P=m.ids,z=g(m,u,_,s),I=!1,D,R,B,F,H,G;y(u,m);var J="x",X="y",Y;if(z)v.pushUnique(z.traceIndices,m._expandedIndex),D=z.orientation==="v",D?(X="s",Y="x"):(J="s",Y="y"),H=z.stackgaps==="interpolate";else{var Z=i(m,T);o(h,m,_,s,l,L,Z)}var oe=!!m.xperiodalignment,re=!!m.yperiodalignment;for(R=0;R<T;R++){var se=k[R]={},N=w(l[R]),U=w(L[R]);N&&U?(se[J]=l[R],se[X]=L[R],oe&&(se.orig_x=A[R],se.xEnd=f.ends[R],se.xStart=f.starts[R]),re&&(se.orig_y=b[R],se.yEnd=x.ends[R],se.yStart=x.starts[R])):z&&(D?N:U)?(se[Y]=D?l[R]:L[R],se.gap=!0,H?(se.s=e,I=!0):se.s=0):se[J]=se[X]=e,P&&(se.id=String(P[R]))}if(r(k,m),n(h,m),t(k,m),z){for(R=0;R<k.length;)k[R][Y]===e?k.splice(R,1):R++;if(v.sort(k,function(K,ne){return K[Y]-ne[Y]||K.i-ne.i}),I){for(R=0;R<k.length-1&&k[R].gap;)R++;for(G=k[R].s,G||(G=k[R].s=0),B=0;B<R;B++)k[B].s=G;for(F=k.length-1;F>R&&k[F].gap;)F--;for(G=k[F].s,B=k.length-1;B>F;B--)k[B].s=G;for(;R<F;)if(R++,k[R].gap){for(B=R+1;k[B].gap;)B++;for(var q=k[R-1][Y],$=k[R-1].s,W=(k[B].s-$)/(k[B][Y]-q);R<B;)k[R].s=$+(k[R][Y]-q)*W,R++}}}return k}function o(h,m,u,_,s,A,b){var f=m._length,x=h._fullLayout,l=u._id,L=_._id,T=x._firstScatter[p(m)]===m.uid,k=(g(m,x,u,_)||{}).orientation,P=m.fill;u._minDtick=0,_._minDtick=0;var z={padded:!0},I={padded:!0};b&&(z.ppad=I.ppad=b);var D=f<2||s[0]!==s[f-1]||A[0]!==A[f-1];D&&(P==="tozerox"||P==="tonextx"&&(T||k==="h"))?z.tozero=!0:!(m.error_y||{}).visible&&(P==="tonexty"||P==="tozeroy"||!a.hasMarkers(m)&&!a.hasText(m))&&(z.padded=!1,z.ppad=0),D&&(P==="tozeroy"||P==="tonexty"&&(T||k==="v"))?I.tozero=!0:(P==="tonextx"||P==="tozerox")&&(I.padded=!1),l&&(m._extremes[l]=S.findExtremes(u,s,z)),L&&(m._extremes[L]=S.findExtremes(_,A,I))}function i(h,m){if(!!a.hasMarkers(h)){var u=h.marker,_=1.6*(h.marker.sizeref||1),s;if(h.marker.sizemode==="area"?s=function(l){return Math.max(Math.sqrt((l||0)/_),3)}:s=function(l){return Math.max((l||0)/_,3)},v.isArrayOrTypedArray(u.size)){var A={type:"linear"};S.setConvert(A);for(var b=A.makeCalcdata(h.marker,"size"),f=new Array(m),x=0;x<m;x++)f[x]=s(b[x]);return f}else return s(u.size)}}function y(h,m){var u=p(m),_=h._firstScatter;_[u]||(_[u]=m.uid)}function p(h){var m=h.stackgroup;return h.xaxis+h.yaxis+h.type+(m?"-"+m:"")}function g(h,m,u,_){var s=h.stackgroup;if(!!s){var A=m._scatterStackOpts[u._id+_._id][s],b=A.orientation==="v"?_:u;if(b.type==="linear"||b.type==="log")return A}}ee.exports={calc:c,calcMarkerSize:i,calcAxisExpansion:o,setFirstScatter:y,getStackOpts:g}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/align_period":563,"../../plots/cartesian/axes":566,"./arrays_to_calcdata":935,"./calc_selection":938,"./colorscale_calc":939,"./subtypes":961,"fast-isnumeric":190}],938:[function(d,ee,te){var w=d("../../lib");ee.exports=function(S,M){w.isArrayOrTypedArray(M.selectedpoints)&&w.tagSelected(S,M)}},{"../../lib":515}],939:[function(d,ee,te){var w=d("../../components/colorscale/helpers").hasColorscale,v=d("../../components/colorscale/calc"),S=d("./subtypes");ee.exports=function(e,a){S.hasLines(a)&&w(a,"line")&&v(e,a,{vals:a.line.color,containerStr:"line",cLetter:"c"}),S.hasMarkers(a)&&(w(a,"marker")&&v(e,a,{vals:a.marker.color,containerStr:"marker",cLetter:"c"}),w(a,"marker.line")&&v(e,a,{vals:a.marker.line.color,containerStr:"marker.line",cLetter:"c"}))}},{"../../components/colorscale/calc":375,"../../components/colorscale/helpers":378,"./subtypes":961}],940:[function(d,ee,te){ee.exports={PTS_LINESONLY:20,minTolerance:.2,toleranceGrowth:10,maxScreensAway:20,eventDataKeys:[]}},{}],941:[function(d,ee,te){var w=d("./calc");ee.exports=function(e,a){var n=a.xaxis,r=a.yaxis,t=n._id+r._id,c=e._fullLayout._scatterStackOpts[t];if(!!c){var o=e.calcdata,i,y,p,g,h,m,u,_,s,A,b,f,x,l,L;for(var T in c){A=c[T];var k=A.traceIndices;if(!!k.length){for(b=A.stackgaps==="interpolate",f=A.groupnorm,A.orientation==="v"?(x="x",l="y"):(x="y",l="x"),L=new Array(k.length),i=0;i<L.length;i++)L[i]=!1;m=o[k[0]];var P=new Array(m.length);for(i=0;i<m.length;i++)P[i]=m[i][x];for(i=1;i<k.length;i++){for(h=o[k[i]],y=p=0;y<h.length;y++){for(u=h[y][x];u>P[p]&&p<P.length;p++)v(h,y,P[p],i,L,b,x),y++;if(u!==P[p]){for(g=0;g<i;g++)v(o[k[g]],p,u,g,L,b,x);P.splice(p,0,u)}p++}for(;p<P.length;p++)v(h,y,P[p],i,L,b,x),y++}var z=P.length;for(y=0;y<m.length;y++){for(_=m[y][l]=m[y].s,i=1;i<k.length;i++)h=o[k[i]],h[0].trace._rawLength=h[0].trace._length,h[0].trace._length=z,_+=h[y].s,h[y][l]=_;if(f)for(s=(f==="fraction"?_:_/100)||1,i=0;i<k.length;i++){var I=o[k[i]][y];I[l]/=s,I.sNorm=I.s/s}}for(i=0;i<k.length;i++){h=o[k[i]];var D=h[0].trace,R=w.calcMarkerSize(D,D._rawLength),B=Array.isArray(R);if(R&&L[i]||B){var F=R;for(R=new Array(z),y=0;y<z;y++)R[y]=h[y].gap?0:B?F[h[y].i]:F}var H=new Array(z),G=new Array(z);for(y=0;y<z;y++)H[y]=h[y].x,G[y]=h[y].y;w.calcAxisExpansion(e,D,n,r,H,G,R),h[0].t.orientation=A.orientation}}}}};function v(M,e,a,n,r,t,c){r[n]=!0;var o={i:null,gap:!0,s:0};if(o[c]=a,M.splice(e,0,o),e&&a===M[e-1][c]){var i=M[e-1];o.s=i.s,o.i=i.i,o.gap=i.gap}else t&&(o.s=S(M,e,a,c));e||(M[0].t=M[1].t,M[0].trace=M[1].trace,delete M[1].t,delete M[1].trace)}function S(M,e,a,n){var r=M[e-1],t=M[e+1];return t?r?r.s+(t.s-r.s)*(a-r[n])/(t[n]-r[n]):t.s:r.s}},{"./calc":937}],942:[function(d,ee,te){ee.exports=function(v){for(var S=0;S<v.length;S++){var M=v[S];if(M.type==="scatter"){var e=M.fill;if(!(e==="none"||e==="toself")&&(M.opacity=void 0,e==="tonexty"||e==="tonextx"))for(var a=S-1;a>=0;a--){var n=v[a];if(n.type==="scatter"&&n.xaxis===M.xaxis&&n.yaxis===M.yaxis){n.opacity=void 0;break}}}}}},{}],943:[function(d,ee,te){var w=d("../../lib"),v=d("../../registry"),S=d("./attributes"),M=d("./constants"),e=d("./subtypes"),a=d("./xy_defaults"),n=d("./period_defaults"),r=d("./stack_defaults"),t=d("./marker_defaults"),c=d("./line_defaults"),o=d("./line_shape_defaults"),i=d("./text_defaults"),y=d("./fillcolor_defaults"),p=d("../../lib").coercePattern;ee.exports=function(h,m,u,_){function s(k,P){return w.coerce(h,m,S,k,P)}var A=a(h,m,_,s);if(A||(m.visible=!1),!!m.visible){n(h,m,_,s),s("xhoverformat"),s("yhoverformat");var b=r(h,m,_,s),f=!b&&A<M.PTS_LINESONLY?"lines+markers":"lines";s("text"),s("hovertext"),s("mode",f),e.hasLines(m)&&(c(h,m,u,_,s),o(h,m,s),s("connectgaps"),s("line.simplify")),e.hasMarkers(m)&&t(h,m,u,_,s,{gradient:!0}),e.hasText(m)&&(s("texttemplate"),i(h,m,_,s));var x=[];(e.hasMarkers(m)||e.hasText(m))&&(s("cliponaxis"),s("marker.maxdisplayed"),x.push("points")),s("fill",b?b.fillDflt:"none"),m.fill!=="none"&&(y(h,m,u,s),e.hasLines(m)||o(h,m,s),p(s,"fillpattern",m.fillcolor,!1));var l=(m.line||{}).color,L=(m.marker||{}).color;(m.fill==="tonext"||m.fill==="toself")&&x.push("fills"),s("hoveron",x.join("+")||"points"),m.hoveron!=="fills"&&s("hovertemplate");var T=v.getComponentMethod("errorbars","supplyDefaults");T(h,m,l||L||u,{axis:"y"}),T(h,m,l||L||u,{axis:"x",inherit:"y"}),w.coerceSelectionMarkerOpacity(m,s)}}},{"../../lib":515,"../../registry":647,"./attributes":936,"./constants":940,"./fillcolor_defaults":944,"./line_defaults":949,"./line_shape_defaults":951,"./marker_defaults":955,"./period_defaults":956,"./stack_defaults":959,"./subtypes":961,"./text_defaults":962,"./xy_defaults":963}],944:[function(d,ee,te){var w=d("../../components/color"),v=d("../../lib").isArrayOrTypedArray;ee.exports=function(M,e,a,n){var r=!1;if(e.marker){var t=e.marker.color,c=(e.marker.line||{}).color;t&&!v(t)?r=t:c&&!v(c)&&(r=c)}n("fillcolor",w.addOpacity((e.line||{}).color||r||a,.5))}},{"../../components/color":367,"../../lib":515}],945:[function(d,ee,te){var w=d("../../plots/cartesian/axes");ee.exports=function(S,M,e){var a={},n={_fullLayout:e},r=w.getFromTrace(n,M,"x"),t=w.getFromTrace(n,M,"y");return a.xLabel=w.tickText(r,r.c2l(S.x),!0).text,a.yLabel=w.tickText(t,t.c2l(S.y),!0).text,a}},{"../../plots/cartesian/axes":566}],946:[function(d,ee,te){var w=d("../../components/color"),v=d("./subtypes");ee.exports=function(M,e){var a,n;if(M.mode==="lines")return a=M.line.color,a&&w.opacity(a)?a:M.fillcolor;if(M.mode==="none")return M.fill?M.fillcolor:"";var r=e.mcc||(M.marker||{}).color,t=e.mlcc||((M.marker||{}).line||{}).color;return n=r&&w.opacity(r)?r:t&&w.opacity(t)&&(e.mlw||((M.marker||{}).line||{}).width)?t:"",n?w.opacity(n)<.3?w.addOpacity(n,.3):n:(a=(M.line||{}).color,a&&w.opacity(a)&&v.hasLines(M)&&M.line.width?a:M.fillcolor)}},{"../../components/color":367,"./subtypes":961}],947:[function(d,ee,te){var w=d("../../lib"),v=d("../../components/fx"),S=d("../../registry"),M=d("./get_trace_color"),e=d("../../components/color"),a=w.fillText;ee.exports=function(r,t,c,o){var i=r.cd,y=i[0].trace,p=r.xa,g=r.ya,h=p.c2p(t),m=g.c2p(c),u=[h,m],_=y.hoveron||"",s=y.mode.indexOf("markers")!==-1?3:.5,A=!!y.xperiodalignment,b=!!y.yperiodalignment;if(_.indexOf("points")!==-1){var f=function(ie){if(A){var le=p.c2p(ie.xStart),ye=p.c2p(ie.xEnd);return h>=Math.min(le,ye)&&h<=Math.max(le,ye)?0:1/0}var ue=Math.max(3,ie.mrc||0),pe=1-1/ue,ge=Math.abs(p.c2p(ie.x)-h);return ge<ue?pe*ge/ue:ge-ue+pe},x=function(ie){if(b){var le=g.c2p(ie.yStart),ye=g.c2p(ie.yEnd);return m>=Math.min(le,ye)&&m<=Math.max(le,ye)?0:1/0}var ue=Math.max(3,ie.mrc||0),pe=1-1/ue,ge=Math.abs(g.c2p(ie.y)-m);return ge<ue?pe*ge/ue:ge-ue+pe},l=function(ie){var le=Math.max(s,ie.mrc||0),ye=p.c2p(ie.x)-h,ue=g.c2p(ie.y)-m;return Math.max(Math.sqrt(ye*ye+ue*ue)-le,1-s/le)},L=v.getDistanceFunction(o,f,x,l);if(v.getClosest(i,L,r),r.index!==!1){var T=i[r.index],k=p.c2p(T.x,!0),P=g.c2p(T.y,!0),z=T.mrc||1;r.index=T.i;var I=i[0].t.orientation,D=I&&(T.sNorm||T.s),R=I==="h"?D:T.orig_x!==void 0?T.orig_x:T.x,B=I==="v"?D:T.orig_y!==void 0?T.orig_y:T.y;return w.extendFlat(r,{color:M(y,T),x0:k-z,x1:k+z,xLabelVal:R,y0:P-z,y1:P+z,yLabelVal:B,spikeDistance:l(T),hovertemplate:y.hovertemplate}),a(T,y,r),S.getComponentMethod("errorbars","hoverInfo")(T,y,r),[r]}}if(_.indexOf("fills")!==-1&&y._polygons){var F=y._polygons,H=[],G=!1,J=1/0,X=-1/0,Y=1/0,Z=-1/0,oe,re,se,N,U,q,$,W,K;for(oe=0;oe<F.length;oe++)se=F[oe],se.contains(u)&&(G=!G,H.push(se),Y=Math.min(Y,se.ymin),Z=Math.max(Z,se.ymax));if(G){Y=Math.max(Y,0),Z=Math.min(Z,g._length);var ne=(Y+Z)/2;for(oe=0;oe<H.length;oe++)for(N=H[oe].pts,re=1;re<N.length;re++)W=N[re-1][1],K=N[re][1],W>ne!=K>=ne&&(q=N[re-1][0],$=N[re][0],K-W&&(U=q+($-q)*(ne-W)/(K-W),J=Math.min(J,U),X=Math.max(X,U)));J=Math.max(J,0),X=Math.min(X,p._length);var ae=e.defaultLine;return e.opacity(y.fillcolor)?ae=y.fillcolor:e.opacity((y.line||{}).color)&&(ae=y.line.color),w.extendFlat(r,{distance:r.maxHoverDistance,x0:J,x1:X,y0:ne,y1:ne,color:ae,hovertemplate:!1}),delete r.index,y.text&&!Array.isArray(y.text)?r.text=String(y.text):r.text=y.name,[r]}}}},{"../../components/color":367,"../../components/fx":407,"../../lib":515,"../../registry":647,"./get_trace_color":946}],948:[function(d,ee,te){var w=d("./subtypes");ee.exports={hasLines:w.hasLines,hasMarkers:w.hasMarkers,hasText:w.hasText,isBubble:w.isBubble,attributes:d("./attributes"),supplyDefaults:d("./defaults"),crossTraceDefaults:d("./cross_trace_defaults"),calc:d("./calc").calc,crossTraceCalc:d("./cross_trace_calc"),arraysToCalcdata:d("./arrays_to_calcdata"),plot:d("./plot"),colorbar:d("./marker_colorbar"),formatLabels:d("./format_labels"),style:d("./style").style,styleOnSelect:d("./style").styleOnSelect,hoverPoints:d("./hover"),selectPoints:d("./select"),animatable:!0,moduleType:"trace",name:"scatter",basePlotModule:d("../../plots/cartesian"),categories:["cartesian","svg","symbols","errorBarsOK","showLegend","scatter-like","zoomScale"],meta:{}}},{"../../plots/cartesian":578,"./arrays_to_calcdata":935,"./attributes":936,"./calc":937,"./cross_trace_calc":941,"./cross_trace_defaults":942,"./defaults":943,"./format_labels":945,"./hover":947,"./marker_colorbar":954,"./plot":957,"./select":958,"./style":960,"./subtypes":961}],949:[function(d,ee,te){var w=d("../../lib").isArrayOrTypedArray,v=d("../../components/colorscale/helpers").hasColorscale,S=d("../../components/colorscale/defaults");ee.exports=function(e,a,n,r,t,c){var o=(e.marker||{}).color;if(t("line.color",n),v(e,"line"))S(e,a,r,t,{prefix:"line.",cLetter:"c"});else{var i=(w(o)?!1:o)||n;t("line.color",i)}t("line.width"),(c||{}).noDash||t("line.dash")}},{"../../components/colorscale/defaults":377,"../../components/colorscale/helpers":378,"../../lib":515}],950:[function(d,ee,te){var w=d("../../constants/numerical"),v=w.BADNUM,S=w.LOG_CLIP,M=S+.5,e=S-.5,a=d("../../lib"),n=a.segmentsIntersect,r=a.constrain,t=d("./constants");ee.exports=function(o,i){var y=i.xaxis,p=i.yaxis,g=y.type==="log",h=p.type==="log",m=y._length,u=p._length,_=i.connectGaps,s=i.baseTolerance,A=i.shape,b=A==="linear",f=i.fill&&i.fill!=="none",x=[],l=t.minTolerance,L=o.length,T=new Array(L),k=0,P,z,I,D,R,B,F,H,G,J,X,Y,Z,oe,re,se;function N(Lt){var Ft=o[Lt];if(!Ft)return!1;var Gt=i.linearized?y.l2p(Ft.x):y.c2p(Ft.x),Dt=i.linearized?p.l2p(Ft.y):p.c2p(Ft.y);if(Gt===v){if(g&&(Gt=y.c2p(Ft.x,!0)),Gt===v)return!1;h&&Dt===v&&(Gt*=Math.abs(y._m*u*(y._m>0?M:e)/(p._m*m*(p._m>0?M:e)))),Gt*=1e3}if(Dt===v){if(h&&(Dt=p.c2p(Ft.y,!0)),Dt===v)return!1;Dt*=1e3}return[Gt,Dt]}function U(Lt,Ft,Gt,Dt){var kt=Gt-Lt,Ue=Dt-Ft,qe=.5-Lt,Ve=.5-Ft,Ae=kt*kt+Ue*Ue,Ne=kt*qe+Ue*Ve;if(Ne>0&&Ne<Ae){var Xe=qe*Ue-Ve*kt;if(Xe*Xe<Ae)return!0}}var q,$;function W(Lt,Ft){var Gt=Lt[0]/m,Dt=Lt[1]/u,kt=Math.max(0,-Gt,Gt-1,-Dt,Dt-1);return kt&&q!==void 0&&U(Gt,Dt,q,$)&&(kt=0),kt&&Ft&&U(Gt,Dt,Ft[0]/m,Ft[1]/u)&&(kt=0),(1+t.toleranceGrowth*kt)*s}function K(Lt,Ft){var Gt=Lt[0]-Ft[0],Dt=Lt[1]-Ft[1];return Math.sqrt(Gt*Gt+Dt*Dt)}var ne=t.maxScreensAway,ae=-m*ne,ie=m*(1+ne),le=-u*ne,ye=u*(1+ne),ue=[[ae,le,ie,le],[ie,le,ie,ye],[ie,ye,ae,ye],[ae,ye,ae,le]],pe,ge,Te,_e,ze,Oe;function Ye(Lt,Ft){for(var Gt=[],Dt=0,kt=0;kt<4;kt++){var Ue=ue[kt],qe=n(Lt[0],Lt[1],Ft[0],Ft[1],Ue[0],Ue[1],Ue[2],Ue[3]);qe&&(!Dt||Math.abs(qe.x-Gt[0][0])>1||Math.abs(qe.y-Gt[0][1])>1)&&(qe=[qe.x,qe.y],Dt&&K(qe,Lt)<K(Gt[0],Lt)?Gt.unshift(qe):Gt.push(qe),Dt++)}return Gt}function be(Lt){if(Lt[0]<ae||Lt[0]>ie||Lt[1]<le||Lt[1]>ye)return[r(Lt[0],ae,ie),r(Lt[1],le,ye)]}function Pe(Lt,Ft){if(Lt[0]===Ft[0]&&(Lt[0]===ae||Lt[0]===ie)||Lt[1]===Ft[1]&&(Lt[1]===le||Lt[1]===ye))return!0}function Ge(Lt,Ft){var Gt=[],Dt=be(Lt),kt=be(Ft);return Dt&&kt&&Pe(Dt,kt)||(Dt&&Gt.push(Dt),kt&&Gt.push(kt)),Gt}function Qe(Lt,Ft,Gt){return function(Dt,kt){var Ue=be(Dt),qe=be(kt),Ve=[];if(Ue&&qe&&Pe(Ue,qe))return Ve;Ue&&Ve.push(Ue),qe&&Ve.push(qe);var Ae=2*a.constrain((Dt[Lt]+kt[Lt])/2,Ft,Gt)-((Ue||Dt)[Lt]+(qe||kt)[Lt]);if(Ae){var Ne;Ue&&qe?Ne=Ae>0==Ue[Lt]>qe[Lt]?Ue:qe:Ne=Ue||qe,Ne[Lt]+=Ae}return Ve}}var Be;A==="linear"||A==="spline"?Be=Ye:A==="hv"||A==="vh"?Be=Ge:A==="hvh"?Be=Qe(0,ae,ie):A==="vhv"&&(Be=Qe(1,le,ye));function Le(Lt,Ft){var Gt=Ft[0]-Lt[0],Dt=(Ft[1]-Lt[1])/Gt,kt=(Lt[1]*Ft[0]-Ft[1]*Lt[0])/Gt;return kt>0?[Dt>0?ae:ie,ye]:[Dt>0?ie:ae,le]}function He(Lt){var Ft=Lt[0],Gt=Lt[1],Dt=Ft===T[k-1][0],kt=Gt===T[k-1][1];if(!(Dt&&kt))if(k>1){var Ue=Ft===T[k-2][0],qe=Gt===T[k-2][1];Dt&&(Ft===ae||Ft===ie)&&Ue?qe?k--:T[k-1]=Lt:kt&&(Gt===le||Gt===ye)&&qe?Ue?k--:T[k-1]=Lt:T[k++]=Lt}else T[k++]=Lt}function vt(Lt){T[k-1][0]!==Lt[0]&&T[k-1][1]!==Lt[1]&&He([Te,_e]),He(Lt),ze=null,Te=_e=0}function Rt(Lt){if(q=Lt[0]/m,$=Lt[1]/u,pe=Lt[0]<ae?ae:Lt[0]>ie?ie:0,ge=Lt[1]<le?le:Lt[1]>ye?ye:0,pe||ge){if(!k)T[k++]=[pe||Lt[0],ge||Lt[1]];else if(ze){var Ft=Be(ze,Lt);Ft.length>1&&(vt(Ft[0]),T[k++]=Ft[1])}else Oe=Be(T[k-1],Lt)[0],T[k++]=Oe;var Gt=T[k-1];pe&&ge&&(Gt[0]!==pe||Gt[1]!==ge)?(ze&&(Te!==pe&&_e!==ge?He(Te&&_e?Le(ze,Lt):[Te||pe,_e||ge]):Te&&_e&&He([Te,_e])),He([pe,ge])):Te-pe&&_e-ge&&He([pe||Te,ge||_e]),ze=Lt,Te=pe,_e=ge}else ze&&vt(Be(ze,Lt)[0]),T[k++]=Lt}for(P=0;P<L;P++)if(z=N(P),!!z){for(k=0,ze=null,Rt(z),P++;P<L;P++){if(D=N(P),!D){if(_)continue;break}if(!b||!i.simplify){Rt(D);continue}var rr=N(P+1);if(J=K(D,z),!(!(f&&(k===0||k===L-1))&&J<W(D,rr)*l)){for(H=[(D[0]-z[0])/J,(D[1]-z[1])/J],R=z,X=J,Y=oe=re=0,F=!1,I=D,P++;P<o.length;P++){if(B=rr,rr=N(P+1),!B){if(_)continue;break}if(G=[B[0]-z[0],B[1]-z[1]],se=G[0]*H[1]-G[1]*H[0],oe=Math.min(oe,se),re=Math.max(re,se),re-oe>W(B,rr))break;I=B,Z=G[0]*H[0]+G[1]*H[1],Z>X?(X=Z,D=B,F=!1):Z<Y&&(Y=Z,R=B,F=!0)}if(F?(Rt(D),I!==R&&Rt(R)):(R!==z&&Rt(R),I!==D&&Rt(D)),Rt(I),P>=o.length||!B)break;Rt(B),z=B}}ze&&He([Te||ze[0],_e||ze[1]]),x.push(T.slice(0,k))}return x}},{"../../constants/numerical":491,"../../lib":515,"./constants":940}],951:[function(d,ee,te){ee.exports=function(v,S,M){var e=M("line.shape");e==="spline"&&M("line.smoothing")}},{}],952:[function(d,ee,te){var w={tonextx:1,tonexty:1,tonext:1};ee.exports=function(S,M,e){var a,n,r,t,c,o={},i=!1,y=-1,p=0,g=-1;for(n=0;n<e.length;n++)a=e[n][0].trace,r=a.stackgroup||"",r?r in o?c=o[r]:(c=o[r]=p,p++):a.fill in w&&g>=0?c=g:(c=g=p,p++),c<y&&(i=!0),a._groupIndex=y=c;var h=e.slice();i&&h.sort(function(u,_){var s=u[0].trace,A=_[0].trace;return s._groupIndex-A._groupIndex||s.index-A.index});var m={};for(n=0;n<h.length;n++)a=h[n][0].trace,r=a.stackgroup||"",a.visible===!0?(a._nexttrace=null,a.fill in w&&(t=m[r],a._prevtrace=t||null,t&&(t._nexttrace=a)),a._ownfill=a.fill&&(a.fill.substr(0,6)==="tozero"||a.fill==="toself"||a.fill.substr(0,2)==="to"&&!a._prevtrace),m[r]=a):a._prevtrace=a._nexttrace=a._ownfill=null;return h}},{}],953:[function(d,ee,te){var w=d("fast-isnumeric");ee.exports=function(S,M){M||(M=2);var e=S.marker,a=e.sizeref||1,n=e.sizemin||0,r=e.sizemode==="area"?function(t){return Math.sqrt(t/a)}:function(t){return t/a};return function(t){var c=r(t/M);return w(c)&&c>0?Math.max(c,n):0}}},{"fast-isnumeric":190}],954:[function(d,ee,te){ee.exports={container:"marker",min:"cmin",max:"cmax"}},{}],955:[function(d,ee,te){var w=d("../../components/color"),v=d("../../components/colorscale/helpers").hasColorscale,S=d("../../components/colorscale/defaults"),M=d("./subtypes");ee.exports=function(a,n,r,t,c,o){var i=M.isBubble(a),y=(a.line||{}).color,p;if(o=o||{},y&&(r=y),c("marker.symbol"),c("marker.opacity",i?.7:1),c("marker.size"),c("marker.color",r),v(a,"marker")&&S(a,n,t,c,{prefix:"marker.",cLetter:"c"}),o.noSelect||(c("selected.marker.color"),c("unselected.marker.color"),c("selected.marker.size"),c("unselected.marker.size")),o.noLine||(y&&!Array.isArray(y)&&n.marker.color!==y?p=y:i?p=w.background:p=w.defaultLine,c("marker.line.color",p),v(a,"marker.line")&&S(a,n,t,c,{prefix:"marker.line.",cLetter:"c"}),c("marker.line.width",i?1:0)),i&&(c("marker.sizeref"),c("marker.sizemin"),c("marker.sizemode")),o.gradient){var g=c("marker.gradient.type");g!=="none"&&c("marker.gradient.color")}}},{"../../components/color":367,"../../components/colorscale/defaults":377,"../../components/colorscale/helpers":378,"./subtypes":961}],956:[function(d,ee,te){var w=d("../../lib").dateTick0,v=d("../../constants/numerical"),S=v.ONEWEEK;function M(e,a){return e%S===0?w(a,1):w(a,0)}ee.exports=function(a,n,r,t,c){if(c||(c={x:!0,y:!0}),c.x){var o=t("xperiod");o&&(t("xperiod0",M(o,n.xcalendar)),t("xperiodalignment"))}if(c.y){var i=t("yperiod");i&&(t("yperiod0",M(i,n.ycalendar)),t("yperiodalignment"))}}},{"../../constants/numerical":491,"../../lib":515}],957:[function(d,ee,te){var w=d("@plotly/d3"),v=d("../../registry"),S=d("../../lib"),M=S.ensureSingle,e=S.identity,a=d("../../components/drawing"),n=d("./subtypes"),r=d("./line_points"),t=d("./link_traces"),c=d("../../lib/polygon").tester;ee.exports=function(g,h,m,u,_,s){var A,b,f=!_,x=!!_&&_.duration>0,l=t(g,h,m);if(A=u.selectAll("g.trace").data(l,function(T){return T[0].trace.uid}),A.enter().append("g").attr("class",function(T){return"trace scatter trace"+T[0].trace.uid}).style("stroke-miterlimit",2),A.order(),o(g,A,h),x){s&&(b=s());var L=w.transition().duration(_.duration).ease(_.easing).each("end",function(){b&&b()}).each("interrupt",function(){b&&b()});L.each(function(){u.selectAll("g.trace").each(function(T,k){i(g,k,h,T,l,this,_)})})}else A.each(function(T,k){i(g,k,h,T,l,this,_)});f&&A.exit().remove(),u.selectAll("path:not([d])").remove()};function o(p,g,h){g.each(function(m){var u=M(w.select(this),"g","fills");a.setClipUrl(u,h.layerClipId,p);var _=m[0].trace,s=[];_._ownfill&&s.push("_ownFill"),_._nexttrace&&s.push("_nextFill");var A=u.selectAll("g").data(s,e);A.enter().append("g"),A.exit().each(function(b){_[b]=null}).remove(),A.order().each(function(b){_[b]=M(w.select(this),"path","js-fill")})})}function i(p,g,h,m,u,_,s){var A;y(p,g,h,m,u);var b=!!s&&s.duration>0;function f(Ye){return b?Ye.transition():Ye}var x=h.xaxis,l=h.yaxis,L=m[0].trace,T=L.line,k=w.select(_),P=M(k,"g","errorbars"),z=M(k,"g","lines"),I=M(k,"g","points"),D=M(k,"g","text");if(v.getComponentMethod("errorbars","plot")(p,P,h,s),L.visible!==!0)return;f(k).style("opacity",L.opacity);var R,B,F=L.fill.charAt(L.fill.length-1);F!=="x"&&F!=="y"&&(F=""),m[0][h.isRangePlot?"nodeRangePlot3":"node3"]=k;var H="",G=[],J=L._prevtrace;J&&(H=J._prevRevpath||"",B=J._nextFill,G=J._polygons);var X,Y,Z="",oe="",re,se,N,U,q,$,W,K=[],ne=S.noop;if(R=L._ownFill,n.hasLines(L)||L.fill!=="none"){for(B&&B.datum(m),["hv","vh","hvh","vhv"].indexOf(T.shape)!==-1?(re=a.steps(T.shape),se=a.steps(T.shape.split("").reverse().join(""))):T.shape==="spline"?re=se=function(Ye){var be=Ye[Ye.length-1];return Ye.length>1&&Ye[0][0]===be[0]&&Ye[0][1]===be[1]?a.smoothclosed(Ye.slice(1),T.smoothing):a.smoothopen(Ye,T.smoothing)}:re=se=function(Ye){return"M"+Ye.join("L")},N=function(Ye){return se(Ye.reverse())},K=r(m,{xaxis:x,yaxis:l,connectGaps:L.connectgaps,baseTolerance:Math.max(T.width||1,3)/4,shape:T.shape,simplify:T.simplify,fill:L.fill}),W=L._polygons=new Array(K.length),A=0;A<K.length;A++)L._polygons[A]=c(K[A]);K.length&&(U=K[0][0],q=K[K.length-1],$=q[q.length-1]),ne=function(Ye){return function(be){if(X=re(be),Y=N(be),Z?F?(Z+="L"+X.substr(1),oe=Y+("L"+oe.substr(1))):(Z+="Z"+X,oe=Y+"Z"+oe):(Z=X,oe=Y),n.hasLines(L)&&be.length>1){var Pe=w.select(this);if(Pe.datum(m),Ye)f(Pe.style("opacity",0).attr("d",X).call(a.lineGroupStyle)).style("opacity",1);else{var Ge=f(Pe);Ge.attr("d",X),a.singleLineStyle(m,Ge)}}}}}var ae=z.selectAll(".js-line").data(K);f(ae.exit()).style("opacity",0).remove(),ae.each(ne(!1)),ae.enter().append("path").classed("js-line",!0).style("vector-effect","non-scaling-stroke").call(a.lineGroupStyle).each(ne(!0)),a.setClipUrl(ae,h.layerClipId,p);function ie(Ye){f(Ye).attr("d","M0,0Z")}K.length?(R?(R.datum(m),U&&$&&(F?(F==="y"?U[1]=$[1]=l.c2p(0,!0):F==="x"&&(U[0]=$[0]=x.c2p(0,!0)),f(R).attr("d","M"+$+"L"+U+"L"+Z.substr(1)).call(a.singleFillStyle,p)):f(R).attr("d",Z+"Z").call(a.singleFillStyle,p))):B&&(L.fill.substr(0,6)==="tonext"&&Z&&H?(L.fill==="tonext"?f(B).attr("d",Z+"Z"+H+"Z").call(a.singleFillStyle,p):f(B).attr("d",Z+"L"+H.substr(1)+"Z").call(a.singleFillStyle,p),L._polygons=L._polygons.concat(G)):(ie(B),L._polygons=null)),L._prevRevpath=oe,L._prevPolygons=W):(R?ie(R):B&&ie(B),L._polygons=L._prevRevpath=L._prevPolygons=null);function le(Ye){return Ye.filter(function(be){return!be.gap&&be.vis})}function ye(Ye){return Ye.filter(function(be){return be.vis})}function ue(Ye){return Ye.filter(function(be){return!be.gap})}function pe(Ye){return Ye.id}function ge(Ye){if(Ye.ids)return pe}function Te(){return!1}function _e(Ye,be,Pe){var Ge,Qe,Be,Le=Pe[0].trace,He=n.hasMarkers(Le),vt=n.hasText(Le),Rt=ge(Le),rr=Te,Lt=Te;if(He||vt){var Ft=e,Gt=Le.stackgroup,Dt=Gt&&p._fullLayout._scatterStackOpts[x._id+l._id][Gt].stackgaps==="infer zero";Le.marker.maxdisplayed||Le._needsCull?Ft=Dt?ye:le:Gt&&!Dt&&(Ft=ue),He&&(rr=Ft),vt&&(Lt=Ft)}Qe=Ye.selectAll("path.point"),Ge=Qe.data(rr,Rt);var kt=Ge.enter().append("path").classed("point",!0);b&&kt.call(a.pointStyle,Le,p).call(a.translatePoints,x,l).style("opacity",0).transition().style("opacity",1),Ge.order();var Ue;He&&(Ue=a.makePointStyleFns(Le)),Ge.each(function(qe){var Ve=w.select(this),Ae=f(Ve);Be=a.translatePoint(qe,Ae,x,l),Be?(a.singlePointStyle(qe,Ae,Le,Ue,p),h.layerClipId&&a.hideOutsideRangePoint(qe,Ae,x,l,Le.xcalendar,Le.ycalendar),Le.customdata&&Ve.classed("plotly-customdata",qe.data!==null&&qe.data!==void 0)):Ae.remove()}),b?Ge.exit().transition().style("opacity",0).remove():Ge.exit().remove(),Qe=be.selectAll("g"),Ge=Qe.data(Lt,Rt),Ge.enter().append("g").classed("textpoint",!0).append("text"),Ge.order(),Ge.each(function(qe){var Ve=w.select(this),Ae=f(Ve.select("text"));Be=a.translatePoint(qe,Ae,x,l),Be?h.layerClipId&&a.hideOutsideRangePoint(qe,Ve,x,l,Le.xcalendar,Le.ycalendar):Ve.remove()}),Ge.selectAll("text").call(a.textPointStyle,Le,p).each(function(qe){var Ve=x.c2p(qe.x),Ae=l.c2p(qe.y);w.select(this).selectAll("tspan.line").each(function(){f(w.select(this)).attr({x:Ve,y:Ae})})}),Ge.exit().remove()}I.datum(m),D.datum(m),_e(I,D,m);var ze=L.cliponaxis===!1,Oe=ze?null:h.layerClipId;a.setClipUrl(I,Oe,p),a.setClipUrl(D,Oe,p)}function y(p,g,h,m,u){var _=h.xaxis,s=h.yaxis,A=w.extent(S.simpleMap(_.range,_.r2c)),b=w.extent(S.simpleMap(s.range,s.r2c)),f=m[0].trace;if(!!n.hasMarkers(f)){var x=f.marker.maxdisplayed;if(x!==0){var l=m.filter(function(P){return P.x>=A[0]&&P.x<=A[1]&&P.y>=b[0]&&P.y<=b[1]}),L=Math.ceil(l.length/x),T=0;u.forEach(function(P,z){var I=P[0].trace;n.hasMarkers(I)&&I.marker.maxdisplayed>0&&z<g&&T++});var k=Math.round(T*L/3+Math.floor(T/3)*L/7.1);m.forEach(function(P){delete P.vis}),l.forEach(function(P,z){Math.round((z+k)%L)===0&&(P.vis=!0)})}}}},{"../../components/drawing":389,"../../lib":515,"../../lib/polygon":527,"../../registry":647,"./line_points":950,"./link_traces":952,"./subtypes":961,"@plotly/d3":58}],958:[function(d,ee,te){var w=d("./subtypes");ee.exports=function(S,M){var e=S.cd,a=S.xaxis,n=S.yaxis,r=[],t=e[0].trace,c,o,i,y,p=!w.hasMarkers(t)&&!w.hasText(t);if(p)return[];if(M===!1)for(c=0;c<e.length;c++)e[c].selected=0;else for(c=0;c<e.length;c++)o=e[c],i=a.c2p(o.x),y=n.c2p(o.y),o.i!==null&&M.contains([i,y],!1,c,S)?(r.push({pointNumber:o.i,x:a.c2d(o.x),y:n.c2d(o.y)}),o.selected=1):o.selected=0;return r}},{"./subtypes":961}],959:[function(d,ee,te){var w=["orientation","groupnorm","stackgaps"];ee.exports=function(S,M,e,a){var n=e._scatterStackOpts,r=a("stackgroup");if(r){var t=M.xaxis+M.yaxis,c=n[t];c||(c=n[t]={});var o=c[r],i=!1;o?o.traces.push(M):(o=c[r]={traceIndices:[],traces:[M]},i=!0);for(var y={orientation:M.x&&!M.y?"h":"v"},p=0;p<w.length;p++){var g=w[p],h=g+"Found";if(!o[h]){var m=S[g]!==void 0,u=g==="orientation";if((m||i)&&(o[g]=a(g,y[g]),u&&(o.fillDflt=o[g]==="h"?"tonextx":"tonexty"),m&&(o[h]=!0,!i&&(delete o.traces[0][g],u))))for(var _=0;_<o.traces.length-1;_++){var s=o.traces[_];s._input.fill!==s.fill&&(s.fill=o.fillDflt)}}}return o}}},{}],960:[function(d,ee,te){var w=d("@plotly/d3"),v=d("../../components/drawing"),S=d("../../registry");function M(r){var t=w.select(r).selectAll("g.trace.scatter");t.style("opacity",function(c){return c[0].trace.opacity}),t.selectAll("g.points").each(function(c){var o=w.select(this),i=c.trace||c[0].trace;e(o,i,r)}),t.selectAll("g.text").each(function(c){var o=w.select(this),i=c.trace||c[0].trace;a(o,i,r)}),t.selectAll("g.trace path.js-line").call(v.lineGroupStyle),t.selectAll("g.trace path.js-fill").call(v.fillGroupStyle,r),S.getComponentMethod("errorbars","style")(t)}function e(r,t,c){v.pointStyle(r.selectAll("path.point"),t,c)}function a(r,t,c){v.textPointStyle(r.selectAll("text"),t,c)}function n(r,t,c){var o=t[0].trace;o.selectedpoints?(v.selectedPointStyle(c.selectAll("path.point"),o),v.selectedTextStyle(c.selectAll("text"),o)):(e(c,o,r),a(c,o,r))}ee.exports={style:M,stylePoints:e,styleText:a,styleOnSelect:n}},{"../../components/drawing":389,"../../registry":647,"@plotly/d3":58}],961:[function(d,ee,te){var w=d("../../lib");ee.exports={hasLines:function(v){return v.visible&&v.mode&&v.mode.indexOf("lines")!==-1},hasMarkers:function(v){return v.visible&&(v.mode&&v.mode.indexOf("markers")!==-1||v.type==="splom")},hasText:function(v){return v.visible&&v.mode&&v.mode.indexOf("text")!==-1},isBubble:function(v){return w.isPlainObject(v.marker)&&w.isArrayOrTypedArray(v.marker.size)}}},{"../../lib":515}],962:[function(d,ee,te){var w=d("../../lib");ee.exports=function(v,S,M,e,a){a=a||{},e("textposition"),w.coerceFont(e,"textfont",M.font),a.noSelect||(e("selected.textfont.color"),e("unselected.textfont.color"))}},{"../../lib":515}],963:[function(d,ee,te){var w=d("../../lib"),v=d("../../registry");ee.exports=function(M,e,a,n){var r=n("x"),t=n("y"),c,o=v.getComponentMethod("calendars","handleTraceDefaults");if(o(M,e,["x","y"],a),r){var i=w.minRowLength(r);t?c=Math.min(i,w.minRowLength(t)):(c=i,n("y0"),n("dy"))}else{if(!t)return 0;c=w.minRowLength(t),n("x0"),n("dx")}return e._length=c,c}},{"../../lib":515,"../../registry":647}],964:[function(d,ee,te){var w=d("../scatter/attributes"),v=d("../../components/colorscale/attributes"),S=d("../../plots/cartesian/axis_format_attributes").axisHoverFormat,M=d("../../plots/template_attributes").hovertemplateAttrs,e=d("../../plots/template_attributes").texttemplateAttrs,a=d("../../plots/attributes"),n=d("../../constants/gl3d_dashes"),r=d("../../constants/gl3d_markers"),t=d("../../lib/extend").extendFlat,c=d("../../plot_api/edit_types").overrideAll,o=d("../../lib/sort_object_keys"),i=w.line,y=w.marker,p=y.line,g=t({width:i.width,dash:{valType:"enumerated",values:o(n),dflt:"solid"}},v("line"));function h(u){return{show:{valType:"boolean",dflt:!1},opacity:{valType:"number",min:0,max:1,dflt:1},scale:{valType:"number",min:0,max:10,dflt:2/3}}}var m=ee.exports=c({x:w.x,y:w.y,z:{valType:"data_array"},text:t({},w.text,{}),texttemplate:e({},{}),hovertext:t({},w.hovertext,{}),hovertemplate:M(),xhoverformat:S("x"),yhoverformat:S("y"),zhoverformat:S("z"),mode:t({},w.mode,{dflt:"lines+markers"}),surfaceaxis:{valType:"enumerated",values:[-1,0,1,2],dflt:-1},surfacecolor:{valType:"color"},projection:{x:h(),y:h(),z:h()},connectgaps:w.connectgaps,line:g,marker:t({symbol:{valType:"enumerated",values:o(r),dflt:"circle",arrayOk:!0},size:t({},y.size,{dflt:8}),sizeref:y.sizeref,sizemin:y.sizemin,sizemode:y.sizemode,opacity:t({},y.opacity,{arrayOk:!1}),colorbar:y.colorbar,line:t({width:t({},p.width,{arrayOk:!1})},v("marker.line"))},v("marker")),textposition:t({},w.textposition,{dflt:"top center"}),textfont:{color:w.textfont.color,size:w.textfont.size,family:t({},w.textfont.family,{arrayOk:!1})},opacity:a.opacity,hoverinfo:t({},a.hoverinfo)},"calc","nested");m.x.editType=m.y.editType=m.z.editType="calc+clearAxisTypes"},{"../../components/colorscale/attributes":374,"../../constants/gl3d_dashes":488,"../../constants/gl3d_markers":489,"../../lib/extend":505,"../../lib/sort_object_keys":538,"../../plot_api/edit_types":548,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../scatter/attributes":936}],965:[function(d,ee,te){var w=d("../scatter/arrays_to_calcdata"),v=d("../scatter/colorscale_calc");ee.exports=function(M,e){var a=[{x:!1,y:!1,trace:e,t:{}}];return w(a,e),v(M,e),a}},{"../scatter/arrays_to_calcdata":935,"../scatter/colorscale_calc":939}],966:[function(d,ee,te){var w=d("../../registry");function v(e,a,n,r){if(!a||!a.visible)return null;for(var t=w.getComponentMethod("errorbars","makeComputeError")(a),c=new Array(e.length),o=0;o<e.length;o++){var i=t(+e[o],o);if(r.type==="log"){var y=r.c2l(e[o]),p=e[o]-i[0],g=e[o]+i[1];if(c[o]=[(r.c2l(p,!0)-y)*n,(r.c2l(g,!0)-y)*n],p>0){var h=r.c2l(p);r._lowerLogErrorBound||(r._lowerLogErrorBound=h),r._lowerErrorBound=Math.min(r._lowerLogErrorBound,h)}}else c[o]=[-i[0]*n,i[1]*n]}return c}function S(e){for(var a=0;a<e.length;a++)if(e[a])return e[a].length;return 0}function M(e,a,n){var r=[v(e.x,e.error_x,a[0],n.xaxis),v(e.y,e.error_y,a[1],n.yaxis),v(e.z,e.error_z,a[2],n.zaxis)],t=S(r);if(t===0)return null;for(var c=new Array(t),o=0;o<t;o++){for(var i=[[0,0,0],[0,0,0]],y=0;y<3;y++)if(r[y])for(var p=0;p<2;p++)i[p][y]=r[y][o][p];c[o]=i}return c}ee.exports=M},{"../../registry":647}],967:[function(d,ee,te){var w=d("../../../stackgl_modules").gl_line3d,v=d("../../../stackgl_modules").gl_scatter3d,S=d("../../../stackgl_modules").gl_error3d,M=d("../../../stackgl_modules").gl_mesh3d,e=d("../../../stackgl_modules").delaunay_triangulate,a=d("../../lib"),n=d("../../lib/str2rgbarray"),r=d("../../lib/gl_format_color").formatColor,t=d("../scatter/make_bubble_size_func"),c=d("../../constants/gl3d_dashes"),o=d("../../constants/gl3d_markers"),i=d("../../plots/cartesian/axes"),y=d("../../components/fx/helpers").appendArrayPointValue,p=d("./calc_errors");function g(P,z){this.scene=P,this.uid=z,this.linePlot=null,this.scatterPlot=null,this.errorBars=null,this.textMarkers=null,this.delaunayMesh=null,this.color=null,this.mode="",this.dataPoints=[],this.axesBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.textLabels=null,this.data=null}var h=g.prototype;h.handlePick=function(P){if(P.object&&(P.object===this.linePlot||P.object===this.delaunayMesh||P.object===this.textMarkers||P.object===this.scatterPlot)){var z=P.index=P.data.index;return P.object.highlight&&P.object.highlight(null),this.scatterPlot&&(P.object=this.scatterPlot,this.scatterPlot.highlight(P.data)),P.textLabel="",this.textLabels&&(Array.isArray(this.textLabels)?(this.textLabels[z]||this.textLabels[z]===0)&&(P.textLabel=this.textLabels[z]):P.textLabel=this.textLabels),P.traceCoordinate=[this.data.x[z],this.data.y[z],this.data.z[z]],!0}};function m(P,z,I){var D=(I+1)%3,R=(I+2)%3,B=[],F=[],H;for(H=0;H<P.length;++H){var G=P[H];isNaN(G[D])||!isFinite(G[D])||isNaN(G[R])||!isFinite(G[R])||(B.push([G[D],G[R]]),F.push(H))}var J=e(B);for(H=0;H<J.length;++H)for(var X=J[H],Y=0;Y<X.length;++Y)X[Y]=F[X[Y]];return{positions:P,cells:J,meshColor:z}}function u(P){for(var z=[0,0,0],I=[[0,0,0],[0,0,0],[0,0,0]],D=[1,1,1],R=0;R<3;R++){var B=P[R];B&&B.copy_zstyle!==!1&&P[2].visible!==!1&&(B=P[2]),!(!B||!B.visible)&&(z[R]=B.width/2,I[R]=n(B.color),D[R]=B.thickness)}return{capSize:z,color:I,lineWidth:D}}function _(P){return P==null?0:P.indexOf("left")>-1?-1:P.indexOf("right")>-1?1:0}function s(P){return P==null?0:P.indexOf("top")>-1?-1:P.indexOf("bottom")>-1?1:0}function A(P){var z=0,I=0,D=[z,I];if(Array.isArray(P))for(var R=0;R<P.length;R++)D[R]=[z,I],P[R]&&(D[R][0]=_(P[R]),D[R][1]=s(P[R]));else D[0]=_(P),D[1]=s(P);return D}function b(P,z){return z(P*4)}function f(P){return o[P]}function x(P,z,I,D,R){var B=null;if(a.isArrayOrTypedArray(P)){B=[];for(var F=0;F<z;F++)P[F]===void 0?B[F]=D:B[F]=I(P[F],R)}else B=I(P,a.identity);return B}function l(P,z){var I=[],D=P.fullSceneLayout,R=P.dataScale,B=D.xaxis,F=D.yaxis,H=D.zaxis,G=z.marker,J=z.line,X=z.x||[],Y=z.y||[],Z=z.z||[],oe=X.length,re=z.xcalendar,se=z.ycalendar,N=z.zcalendar,U,q,$,W,K,ne;for(K=0;K<oe;K++)U=B.d2l(X[K],0,re)*R[0],q=F.d2l(Y[K],0,se)*R[1],$=H.d2l(Z[K],0,N)*R[2],I[K]=[U,q,$];if(Array.isArray(z.text))ne=z.text;else if(z.text!==void 0)for(ne=new Array(oe),K=0;K<oe;K++)ne[K]=z.text;function ae(Qe,Be){var Le=D[Qe];return i.tickText(Le,Le.d2l(Be),!0).text}var ie=z.texttemplate;if(ie){var le=P.fullLayout,ye=le._d3locale,ue=Array.isArray(ie),pe=ue?Math.min(ie.length,oe):oe,ge=ue?function(Qe){return ie[Qe]}:function(){return ie};for(ne=new Array(pe),K=0;K<pe;K++){var Te={x:X[K],y:Y[K],z:Z[K]},_e={xLabel:ae("xaxis",X[K]),yLabel:ae("yaxis",Y[K]),zLabel:ae("zaxis",Z[K])},ze={};y(ze,z,K);var Oe=z._meta||{};ne[K]=a.texttemplateString(ge(K),_e,ye,ze,Te,Oe)}}if(W={position:I,mode:z.mode,text:ne},"line"in z&&(W.lineColor=r(J,1,oe),W.lineWidth=J.width,W.lineDashes=J.dash),"marker"in z){var Ye=t(z);W.scatterColor=r(G,1,oe),W.scatterSize=x(G.size,oe,b,20,Ye),W.scatterMarker=x(G.symbol,oe,f,"\u25CF"),W.scatterLineWidth=G.line.width,W.scatterLineColor=r(G.line,1,oe),W.scatterAngle=0}"textposition"in z&&(W.textOffset=A(z.textposition),W.textColor=r(z.textfont,1,oe),W.textSize=x(z.textfont.size,oe,a.identity,12),W.textFont=z.textfont.family,W.textAngle=0);var be=["x","y","z"];for(W.project=[!1,!1,!1],W.projectScale=[1,1,1],W.projectOpacity=[1,1,1],K=0;K<3;++K){var Pe=z.projection[be[K]];(W.project[K]=Pe.show)&&(W.projectOpacity[K]=Pe.opacity,W.projectScale[K]=Pe.scale)}W.errorBounds=p(z,R,D);var Ge=u([z.error_x,z.error_y,z.error_z]);return W.errorColor=Ge.color,W.errorLineWidth=Ge.lineWidth,W.errorCapSize=Ge.capSize,W.delaunayAxis=z.surfaceaxis,W.delaunayColor=n(z.surfacecolor),W}function L(P){if(a.isArrayOrTypedArray(P)){var z=P[0];return a.isArrayOrTypedArray(z)&&(P=z),"rgb("+P.slice(0,3).map(function(I){return Math.round(I*255)})+")"}return null}function T(P){return a.isArrayOrTypedArray(P)?P.length===4&&typeof P[0]=="number"?L(P):P.map(L):null}h.update=function(P){var z=this.scene.glplot.gl,I,D,R,B,F=c.solid;this.data=P;var H=l(this.scene,P);"mode"in H&&(this.mode=H.mode),"lineDashes"in H&&H.lineDashes in c&&(F=c[H.lineDashes]),this.color=T(H.scatterColor)||T(H.lineColor),this.dataPoints=H.position,I={gl:this.scene.glplot.gl,position:H.position,color:H.lineColor,lineWidth:H.lineWidth||1,dashes:F[0],dashScale:F[1],opacity:P.opacity,connectGaps:P.connectgaps},this.mode.indexOf("lines")!==-1?this.linePlot?this.linePlot.update(I):(this.linePlot=w(I),this.linePlot._trace=this,this.scene.glplot.add(this.linePlot)):this.linePlot&&(this.scene.glplot.remove(this.linePlot),this.linePlot.dispose(),this.linePlot=null);var G=P.opacity;if(P.marker&&P.marker.opacity&&(G*=P.marker.opacity),D={gl:this.scene.glplot.gl,position:H.position,color:H.scatterColor,size:H.scatterSize,glyph:H.scatterMarker,opacity:G,orthographic:!0,lineWidth:H.scatterLineWidth,lineColor:H.scatterLineColor,project:H.project,projectScale:H.projectScale,projectOpacity:H.projectOpacity},this.mode.indexOf("markers")!==-1?this.scatterPlot?this.scatterPlot.update(D):(this.scatterPlot=v(D),this.scatterPlot._trace=this,this.scatterPlot.highlightScale=1,this.scene.glplot.add(this.scatterPlot)):this.scatterPlot&&(this.scene.glplot.remove(this.scatterPlot),this.scatterPlot.dispose(),this.scatterPlot=null),B={gl:this.scene.glplot.gl,position:H.position,glyph:H.text,color:H.textColor,size:H.textSize,angle:H.textAngle,alignment:H.textOffset,font:H.textFont,orthographic:!0,lineWidth:0,project:!1,opacity:P.opacity},this.textLabels=P.hovertext||P.text,this.mode.indexOf("text")!==-1?this.textMarkers?this.textMarkers.update(B):(this.textMarkers=v(B),this.textMarkers._trace=this,this.textMarkers.highlightScale=1,this.scene.glplot.add(this.textMarkers)):this.textMarkers&&(this.scene.glplot.remove(this.textMarkers),this.textMarkers.dispose(),this.textMarkers=null),R={gl:this.scene.glplot.gl,position:H.position,color:H.errorColor,error:H.errorBounds,lineWidth:H.errorLineWidth,capSize:H.errorCapSize,opacity:P.opacity},this.errorBars?H.errorBounds?this.errorBars.update(R):(this.scene.glplot.remove(this.errorBars),this.errorBars.dispose(),this.errorBars=null):H.errorBounds&&(this.errorBars=S(R),this.errorBars._trace=this,this.scene.glplot.add(this.errorBars)),H.delaunayAxis>=0){var J=m(H.position,H.delaunayColor,H.delaunayAxis);J.opacity=P.opacity,this.delaunayMesh?this.delaunayMesh.update(J):(J.gl=z,this.delaunayMesh=M(J),this.delaunayMesh._trace=this,this.scene.glplot.add(this.delaunayMesh))}else this.delaunayMesh&&(this.scene.glplot.remove(this.delaunayMesh),this.delaunayMesh.dispose(),this.delaunayMesh=null)},h.dispose=function(){this.linePlot&&(this.scene.glplot.remove(this.linePlot),this.linePlot.dispose()),this.scatterPlot&&(this.scene.glplot.remove(this.scatterPlot),this.scatterPlot.dispose()),this.errorBars&&(this.scene.glplot.remove(this.errorBars),this.errorBars.dispose()),this.textMarkers&&(this.scene.glplot.remove(this.textMarkers),this.textMarkers.dispose()),this.delaunayMesh&&(this.scene.glplot.remove(this.delaunayMesh),this.delaunayMesh.dispose())};function k(P,z){var I=new g(P,z.uid);return I.update(z),I}ee.exports=k},{"../../../stackgl_modules":1133,"../../components/fx/helpers":403,"../../constants/gl3d_dashes":488,"../../constants/gl3d_markers":489,"../../lib":515,"../../lib/gl_format_color":511,"../../lib/str2rgbarray":540,"../../plots/cartesian/axes":566,"../scatter/make_bubble_size_func":953,"./calc_errors":966}],968:[function(d,ee,te){var w=d("../../registry"),v=d("../../lib"),S=d("../scatter/subtypes"),M=d("../scatter/marker_defaults"),e=d("../scatter/line_defaults"),a=d("../scatter/text_defaults"),n=d("./attributes");ee.exports=function(c,o,i,y){function p(b,f){return v.coerce(c,o,n,b,f)}var g=r(c,o,p,y);if(!g){o.visible=!1;return}p("text"),p("hovertext"),p("hovertemplate"),p("xhoverformat"),p("yhoverformat"),p("zhoverformat"),p("mode"),S.hasLines(o)&&(p("connectgaps"),e(c,o,i,y,p)),S.hasMarkers(o)&&M(c,o,i,y,p,{noSelect:!0}),S.hasText(o)&&(p("texttemplate"),a(c,o,y,p,{noSelect:!0}));var h=(o.line||{}).color,m=(o.marker||{}).color;p("surfaceaxis")>=0&&p("surfacecolor",h||m);for(var u=["x","y","z"],_=0;_<3;++_){var s="projection."+u[_];p(s+".show")&&(p(s+".opacity"),p(s+".scale"))}var A=w.getComponentMethod("errorbars","supplyDefaults");A(c,o,h||m||i,{axis:"z"}),A(c,o,h||m||i,{axis:"y",inherit:"z"}),A(c,o,h||m||i,{axis:"x",inherit:"z"})};function r(t,c,o,i){var y=0,p=o("x"),g=o("y"),h=o("z"),m=w.getComponentMethod("calendars","handleTraceDefaults");return m(t,c,["x","y","z"],i),p&&g&&h&&(y=Math.min(p.length,g.length,h.length),c._length=c._xlength=c._ylength=c._zlength=y),y}},{"../../lib":515,"../../registry":647,"../scatter/line_defaults":949,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scatter/text_defaults":962,"./attributes":964}],969:[function(d,ee,te){ee.exports={plot:d("./convert"),attributes:d("./attributes"),markerSymbols:d("../../constants/gl3d_markers"),supplyDefaults:d("./defaults"),colorbar:[{container:"marker",min:"cmin",max:"cmax"},{container:"line",min:"cmin",max:"cmax"}],calc:d("./calc"),moduleType:"trace",name:"scatter3d",basePlotModule:d("../../plots/gl3d"),categories:["gl3d","symbols","showLegend","scatter-like"],meta:{}}},{"../../constants/gl3d_markers":489,"../../plots/gl3d":607,"./attributes":964,"./calc":965,"./convert":967,"./defaults":968}],970:[function(d,ee,te){var w=d("../scatter/attributes"),v=d("../../plots/attributes"),S=d("../../plots/template_attributes").hovertemplateAttrs,M=d("../../plots/template_attributes").texttemplateAttrs,e=d("../../components/colorscale/attributes"),a=d("../../lib/extend").extendFlat,n=w.marker,r=w.line,t=n.line;ee.exports={carpet:{valType:"string",editType:"calc"},a:{valType:"data_array",editType:"calc"},b:{valType:"data_array",editType:"calc"},mode:a({},w.mode,{dflt:"markers"}),text:a({},w.text,{}),texttemplate:M({editType:"plot"},{keys:["a","b","text"]}),hovertext:a({},w.hovertext,{}),line:{color:r.color,width:r.width,dash:r.dash,shape:a({},r.shape,{values:["linear","spline"]}),smoothing:r.smoothing,editType:"calc"},connectgaps:w.connectgaps,fill:a({},w.fill,{values:["none","toself","tonext"],dflt:"none"}),fillcolor:w.fillcolor,marker:a({symbol:n.symbol,opacity:n.opacity,maxdisplayed:n.maxdisplayed,size:n.size,sizeref:n.sizeref,sizemin:n.sizemin,sizemode:n.sizemode,line:a({width:t.width,editType:"calc"},e("marker.line")),gradient:n.gradient,editType:"calc"},e("marker")),textfont:w.textfont,textposition:w.textposition,selected:w.selected,unselected:w.unselected,hoverinfo:a({},v.hoverinfo,{flags:["a","b","text","name"]}),hoveron:w.hoveron,hovertemplate:S()}},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/template_attributes":642,"../scatter/attributes":936}],971:[function(d,ee,te){var w=d("fast-isnumeric"),v=d("../scatter/colorscale_calc"),S=d("../scatter/arrays_to_calcdata"),M=d("../scatter/calc_selection"),e=d("../scatter/calc").calcMarkerSize,a=d("../carpet/lookup_carpetid");ee.exports=function(r,t){var c=t._carpetTrace=a(r,t);if(!(!c||!c.visible||c.visible==="legendonly")){var o;t.xaxis=c.xaxis,t.yaxis=c.yaxis;var i=t._length,y=new Array(i),p,g,h=!1;for(o=0;o<i;o++)if(p=t.a[o],g=t.b[o],w(p)&&w(g)){var m=c.ab2xy(+p,+g,!0),u=c.isVisible(+p,+g);u||(h=!0),y[o]={x:m[0],y:m[1],a:p,b:g,vis:u}}else y[o]={x:!1,y:!1};return t._needsCull=h,y[0].carpet=c,y[0].trace=t,e(t,i),v(r,t),S(y,t),M(y,t),y}}},{"../carpet/lookup_carpetid":717,"../scatter/arrays_to_calcdata":935,"../scatter/calc":937,"../scatter/calc_selection":938,"../scatter/colorscale_calc":939,"fast-isnumeric":190}],972:[function(d,ee,te){var w=d("../../lib"),v=d("../scatter/constants"),S=d("../scatter/subtypes"),M=d("../scatter/marker_defaults"),e=d("../scatter/line_defaults"),a=d("../scatter/line_shape_defaults"),n=d("../scatter/text_defaults"),r=d("../scatter/fillcolor_defaults"),t=d("./attributes");ee.exports=function(o,i,y,p){function g(b,f){return w.coerce(o,i,t,b,f)}g("carpet"),i.xaxis="x",i.yaxis="y";var h=g("a"),m=g("b"),u=Math.min(h.length,m.length);if(!u){i.visible=!1;return}i._length=u,g("text"),g("texttemplate"),g("hovertext");var _=u<v.PTS_LINESONLY?"lines+markers":"lines";g("mode",_),S.hasLines(i)&&(e(o,i,y,p,g),a(o,i,g),g("connectgaps")),S.hasMarkers(i)&&M(o,i,y,p,g,{gradient:!0}),S.hasText(i)&&n(o,i,p,g);var s=[];(S.hasMarkers(i)||S.hasText(i))&&(g("marker.maxdisplayed"),s.push("points")),g("fill"),i.fill!=="none"&&(r(o,i,y,g),S.hasLines(i)||a(o,i,g)),(i.fill==="tonext"||i.fill==="toself")&&s.push("fills");var A=g("hoveron",s.join("+")||"points");A!=="fills"&&g("hovertemplate"),w.coerceSelectionMarkerOpacity(i,g)}},{"../../lib":515,"../scatter/constants":940,"../scatter/fillcolor_defaults":944,"../scatter/line_defaults":949,"../scatter/line_shape_defaults":951,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scatter/text_defaults":962,"./attributes":970}],973:[function(d,ee,te){ee.exports=function(v,S,M,e,a){var n=e[a];return v.a=n.a,v.b=n.b,v.y=n.y,v}},{}],974:[function(d,ee,te){ee.exports=function(v,S){var M={},e=S._carpet,a=e.ab2ij([v.a,v.b]),n=Math.floor(a[0]),r=a[0]-n,t=Math.floor(a[1]),c=a[1]-t,o=e.evalxy([],n,t,r,c);return M.yLabel=o[1].toFixed(3),M}},{}],975:[function(d,ee,te){var w=d("../scatter/hover"),v=d("../../lib").fillText;ee.exports=function(M,e,a,n){var r=w(M,e,a,n);if(!r||r[0].index===!1)return;var t=r[0];if(t.index===void 0){var c=1-t.y0/M.ya._length,o=M.xa._length,i=o*c/2,y=o-i;return t.x0=Math.max(Math.min(t.x0,y),i),t.x1=Math.max(Math.min(t.x1,y),i),r}var p=t.cd[t.index];t.a=p.a,t.b=p.b,t.xLabelVal=void 0,t.yLabelVal=void 0;var g=t.trace,h=g._carpet,m=g._module.formatLabels(p,g);t.yLabel=m.yLabel,delete t.text;var u=[];function _(b,f){var x;b.labelprefix&&b.labelprefix.length>0?x=b.labelprefix.replace(/ = $/,""):x=b._hovertitle,u.push(x+": "+f.toFixed(3)+b.labelsuffix)}if(!g.hovertemplate){var s=p.hi||g.hoverinfo,A=s.split("+");A.indexOf("all")!==-1&&(A=["a","b","text"]),A.indexOf("a")!==-1&&_(h.aaxis,p.a),A.indexOf("b")!==-1&&_(h.baxis,p.b),u.push("y: "+t.yLabel),A.indexOf("text")!==-1&&v(p,g,u),t.extraText=u.join("<br>")}return r}},{"../../lib":515,"../scatter/hover":947}],976:[function(d,ee,te){ee.exports={attributes:d("./attributes"),supplyDefaults:d("./defaults"),colorbar:d("../scatter/marker_colorbar"),formatLabels:d("./format_labels"),calc:d("./calc"),plot:d("./plot"),style:d("../scatter/style").style,styleOnSelect:d("../scatter/style").styleOnSelect,hoverPoints:d("./hover"),selectPoints:d("../scatter/select"),eventData:d("./event_data"),moduleType:"trace",name:"scattercarpet",basePlotModule:d("../../plots/cartesian"),categories:["svg","carpet","symbols","showLegend","carpetDependent","zoomScale"],meta:{}}},{"../../plots/cartesian":578,"../scatter/marker_colorbar":954,"../scatter/select":958,"../scatter/style":960,"./attributes":970,"./calc":971,"./defaults":972,"./event_data":973,"./format_labels":974,"./hover":975,"./plot":977}],977:[function(d,ee,te){var w=d("../scatter/plot"),v=d("../../plots/cartesian/axes"),S=d("../../components/drawing");ee.exports=function(e,a,n,r){var t,c,o,i=n[0][0].carpet,y={xaxis:v.getFromId(e,i.xaxis||"x"),yaxis:v.getFromId(e,i.yaxis||"y"),plot:a.plot};for(w(e,y,n,r),t=0;t<n.length;t++)c=n[t][0].trace,o=r.selectAll("g.trace"+c.uid+" .js-line"),S.setClipUrl(o,n[t][0].carpet._clipPathId,e)}},{"../../components/drawing":389,"../../plots/cartesian/axes":566,"../scatter/plot":957}],978:[function(d,ee,te){var w=d("../../plots/template_attributes").hovertemplateAttrs,v=d("../../plots/template_attributes").texttemplateAttrs,S=d("../scatter/attributes"),M=d("../../plots/attributes"),e=d("../../components/colorscale/attributes"),a=d("../../components/drawing/attributes").dash,n=d("../../lib/extend").extendFlat,r=d("../../plot_api/edit_types").overrideAll,t=S.marker,c=S.line,o=t.line;ee.exports=r({lon:{valType:"data_array"},lat:{valType:"data_array"},locations:{valType:"data_array"},locationmode:{valType:"enumerated",values:["ISO-3","USA-states","country names","geojson-id"],dflt:"ISO-3"},geojson:{valType:"any",editType:"calc"},featureidkey:{valType:"string",editType:"calc",dflt:"id"},mode:n({},S.mode,{dflt:"markers"}),text:n({},S.text,{}),texttemplate:v({editType:"plot"},{keys:["lat","lon","location","text"]}),hovertext:n({},S.hovertext,{}),textfont:S.textfont,textposition:S.textposition,line:{color:c.color,width:c.width,dash:a},connectgaps:S.connectgaps,marker:n({symbol:t.symbol,opacity:t.opacity,size:t.size,sizeref:t.sizeref,sizemin:t.sizemin,sizemode:t.sizemode,colorbar:t.colorbar,line:n({width:o.width},e("marker.line")),gradient:t.gradient},e("marker")),fill:{valType:"enumerated",values:["none","toself"],dflt:"none"},fillcolor:S.fillcolor,selected:S.selected,unselected:S.unselected,hoverinfo:n({},M.hoverinfo,{flags:["lon","lat","location","text","name"]}),hovertemplate:w()},"calc","nested")},{"../../components/colorscale/attributes":374,"../../components/drawing/attributes":388,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plots/attributes":562,"../../plots/template_attributes":642,"../scatter/attributes":936}],979:[function(d,ee,te){var w=d("fast-isnumeric"),v=d("../../constants/numerical").BADNUM,S=d("../scatter/colorscale_calc"),M=d("../scatter/arrays_to_calcdata"),e=d("../scatter/calc_selection"),a=d("../../lib")._;function n(r){return r&&typeof r=="string"}ee.exports=function(t,c){var o=Array.isArray(c.locations),i=o?c.locations.length:c._length,y=new Array(i),p;c.geojson?p=function(s){return n(s)||w(s)}:p=n;for(var g=0;g<i;g++){var h=y[g]={};if(o){var m=c.locations[g];h.loc=p(m)?m:null}else{var u=c.lon[g],_=c.lat[g];w(u)&&w(_)?h.lonlat=[+u,+_]:h.lonlat=[v,v]}}return M(y,c),S(t,c),e(y,c),i&&(y[0].t={labels:{lat:a(t,"lat:")+" ",lon:a(t,"lon:")+" "}}),y}},{"../../constants/numerical":491,"../../lib":515,"../scatter/arrays_to_calcdata":935,"../scatter/calc_selection":938,"../scatter/colorscale_calc":939,"fast-isnumeric":190}],980:[function(d,ee,te){var w=d("../../lib"),v=d("../scatter/subtypes"),S=d("../scatter/marker_defaults"),M=d("../scatter/line_defaults"),e=d("../scatter/text_defaults"),a=d("../scatter/fillcolor_defaults"),n=d("./attributes");ee.exports=function(t,c,o,i){function y(A,b){return w.coerce(t,c,n,A,b)}var p=y("locations"),g;if(p&&p.length){var h=y("geojson"),m;(typeof h=="string"&&h!==""||w.isPlainObject(h))&&(m="geojson-id");var u=y("locationmode",m);u==="geojson-id"&&y("featureidkey"),g=p.length}else{var _=y("lon")||[],s=y("lat")||[];g=Math.min(_.length,s.length)}if(!g){c.visible=!1;return}c._length=g,y("text"),y("hovertext"),y("hovertemplate"),y("mode"),v.hasLines(c)&&(M(t,c,o,i,y),y("connectgaps")),v.hasMarkers(c)&&S(t,c,o,i,y,{gradient:!0}),v.hasText(c)&&(y("texttemplate"),e(t,c,i,y)),y("fill"),c.fill!=="none"&&a(t,c,o,y),w.coerceSelectionMarkerOpacity(c,y)}},{"../../lib":515,"../scatter/fillcolor_defaults":944,"../scatter/line_defaults":949,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scatter/text_defaults":962,"./attributes":978}],981:[function(d,ee,te){ee.exports=function(v,S,M,e,a){v.lon=S.lon,v.lat=S.lat,v.location=S.loc?S.loc:null;var n=e[a];return n.fIn&&n.fIn.properties&&(v.properties=n.fIn.properties),v}},{}],982:[function(d,ee,te){var w=d("../../plots/cartesian/axes");ee.exports=function(S,M,e){var a={},n=e[M.geo]._subplot,r=n.mockAxis,t=S.lonlat;return a.lonLabel=w.tickText(r,r.c2l(t[0]),!0).text,a.latLabel=w.tickText(r,r.c2l(t[1]),!0).text,a}},{"../../plots/cartesian/axes":566}],983:[function(d,ee,te){var w=d("../../components/fx"),v=d("../../constants/numerical").BADNUM,S=d("../scatter/get_trace_color"),M=d("../../lib").fillText,e=d("./attributes");ee.exports=function(r,t,c){var o=r.cd,i=o[0].trace,y=r.xa,p=r.ya,g=r.subplot,h=g.projection.isLonLatOverEdges,m=g.project;function u(l){var L=l.lonlat;if(L[0]===v||h(L))return 1/0;var T=m(L),k=m([t,c]),P=Math.abs(T[0]-k[0]),z=Math.abs(T[1]-k[1]),I=Math.max(3,l.mrc||0);return Math.max(Math.sqrt(P*P+z*z)-I,1-3/I)}if(w.getClosest(o,u,r),r.index!==!1){var _=o[r.index],s=_.lonlat,A=[y.c2p(s),p.c2p(s)],b=_.mrc||1;r.x0=A[0]-b,r.x1=A[0]+b,r.y0=A[1]-b,r.y1=A[1]+b,r.loc=_.loc,r.lon=s[0],r.lat=s[1];var f={};f[i.geo]={_subplot:g};var x=i._module.formatLabels(_,i,f);return r.lonLabel=x.lonLabel,r.latLabel=x.latLabel,r.color=S(i,_),r.extraText=a(i,_,r,o[0].t.labels),r.hovertemplate=i.hovertemplate,[r]}};function a(n,r,t,c){if(n.hovertemplate)return;var o=r.hi||n.hoverinfo,i=o==="all"?e.hoverinfo.flags:o.split("+"),y=i.indexOf("location")!==-1&&Array.isArray(n.locations),p=i.indexOf("lon")!==-1,g=i.indexOf("lat")!==-1,h=i.indexOf("text")!==-1,m=[];function u(_){return _+"\xB0"}return y?m.push(r.loc):p&&g?m.push("("+u(t.latLabel)+", "+u(t.lonLabel)+")"):p?m.push(c.lon+u(t.lonLabel)):g&&m.push(c.lat+u(t.latLabel)),h&&M(r,n,m),m.join("<br>")}},{"../../components/fx":407,"../../constants/numerical":491,"../../lib":515,"../scatter/get_trace_color":946,"./attributes":978}],984:[function(d,ee,te){ee.exports={attributes:d("./attributes"),supplyDefaults:d("./defaults"),colorbar:d("../scatter/marker_colorbar"),formatLabels:d("./format_labels"),calc:d("./calc"),calcGeoJSON:d("./plot").calcGeoJSON,plot:d("./plot").plot,style:d("./style"),styleOnSelect:d("../scatter/style").styleOnSelect,hoverPoints:d("./hover"),eventData:d("./event_data"),selectPoints:d("./select"),moduleType:"trace",name:"scattergeo",basePlotModule:d("../../plots/geo"),categories:["geo","symbols","showLegend","scatter-like"],meta:{}}},{"../../plots/geo":598,"../scatter/marker_colorbar":954,"../scatter/style":960,"./attributes":978,"./calc":979,"./defaults":980,"./event_data":981,"./format_labels":982,"./hover":983,"./plot":985,"./select":986,"./style":987}],985:[function(d,ee,te){var w=d("@plotly/d3"),v=d("../../lib"),S=d("../../lib/topojson_utils").getTopojsonFeatures,M=d("../../lib/geojson_utils"),e=d("../../lib/geo_location_utils"),a=d("../../plots/cartesian/autorange").findExtremes,n=d("../../constants/numerical").BADNUM,r=d("../scatter/calc").calcMarkerSize,t=d("../scatter/subtypes"),c=d("./style");function o(y,p,g){var h=p.layers.frontplot.select(".scatterlayer"),m=v.makeTraceGroups(h,g,"trace scattergeo");function u(_,s){_.lonlat[0]===n&&w.select(s).remove()}m.selectAll("*").remove(),m.each(function(_){var s=w.select(this),A=_[0].trace;if(t.hasLines(A)||A.fill!=="none"){var b=M.calcTraceToLineCoords(_),f=A.fill!=="none"?M.makePolygon(b):M.makeLine(b);s.selectAll("path.js-line").data([{geojson:f,trace:A}]).enter().append("path").classed("js-line",!0).style("stroke-miterlimit",2)}t.hasMarkers(A)&&s.selectAll("path.point").data(v.identity).enter().append("path").classed("point",!0).each(function(x){u(x,this)}),t.hasText(A)&&s.selectAll("g").data(v.identity).enter().append("g").append("text").each(function(x){u(x,this)}),c(y,_)})}function i(y,p){var g=y[0].trace,h=p[g.geo],m=h._subplot,u=g._length,_,s;if(Array.isArray(g.locations)){var A=g.locationmode,b=A==="geojson-id"?e.extractTraceFeature(y):S(g,m.topojson);for(_=0;_<u;_++){s=y[_];var f=A==="geojson-id"?s.fOut:e.locationToFeature(A,s.loc,b);s.lonlat=f?f.properties.ct:[n,n]}}var x={padded:!0},l,L;if(h.fitbounds==="geojson"&&g.locationmode==="geojson-id"){var T=e.computeBbox(e.getTraceGeojson(g));l=[T[0],T[2]],L=[T[1],T[3]]}else{for(l=new Array(u),L=new Array(u),_=0;_<u;_++)s=y[_],l[_]=s.lonlat[0],L[_]=s.lonlat[1];x.ppad=r(g,u)}g._extremes.lon=a(h.lonaxis._ax,l,x),g._extremes.lat=a(h.lataxis._ax,L,x)}ee.exports={calcGeoJSON:i,plot:o}},{"../../constants/numerical":491,"../../lib":515,"../../lib/geo_location_utils":508,"../../lib/geojson_utils":509,"../../lib/topojson_utils":544,"../../plots/cartesian/autorange":565,"../scatter/calc":937,"../scatter/subtypes":961,"./style":987,"@plotly/d3":58}],986:[function(d,ee,te){var w=d("../scatter/subtypes"),v=d("../../constants/numerical").BADNUM;ee.exports=function(M,e){var a=M.cd,n=M.xaxis,r=M.yaxis,t=[],c=a[0].trace,o,i,y,p,g,h=!w.hasMarkers(c)&&!w.hasText(c);if(h)return[];if(e===!1)for(g=0;g<a.length;g++)a[g].selected=0;else for(g=0;g<a.length;g++)o=a[g],i=o.lonlat,i[0]!==v&&(y=n.c2p(i),p=r.c2p(i),e.contains([y,p],null,g,M)?(t.push({pointNumber:g,lon:i[0],lat:i[1]}),o.selected=1):o.selected=0);return t}},{"../../constants/numerical":491,"../scatter/subtypes":961}],987:[function(d,ee,te){var w=d("@plotly/d3"),v=d("../../components/drawing"),S=d("../../components/color"),M=d("../scatter/style"),e=M.stylePoints,a=M.styleText;ee.exports=function(t,c){c&&n(t,c)};function n(r,t){var c=t[0].trace,o=t[0].node3;o.style("opacity",t[0].trace.opacity),e(o,c,r),a(o,c,r),o.selectAll("path.js-line").style("fill","none").each(function(i){var y=w.select(this),p=i.trace,g=p.line||{};y.call(S.stroke,g.color).call(v.dashLine,g.dash||"",g.width||0),p.fill!=="none"&&y.call(S.fill,p.fillcolor)})}},{"../../components/color":367,"../../components/drawing":389,"../scatter/style":960,"@plotly/d3":58}],988:[function(d,ee,te){var w=d("../../plots/attributes"),v=d("../scatter/attributes"),S=d("../../plots/cartesian/axis_format_attributes").axisHoverFormat,M=d("../../components/colorscale/attributes"),e=d("../../lib/sort_object_keys"),a=d("../../lib/extend").extendFlat,n=d("../../plot_api/edit_types").overrideAll,r=d("./constants").DASHES,t=v.line,c=v.marker,o=c.line,i=ee.exports=n({x:v.x,x0:v.x0,dx:v.dx,y:v.y,y0:v.y0,dy:v.dy,xperiod:v.xperiod,yperiod:v.yperiod,xperiod0:v.xperiod0,yperiod0:v.yperiod0,xperiodalignment:v.xperiodalignment,yperiodalignment:v.yperiodalignment,xhoverformat:S("x"),yhoverformat:S("y"),text:v.text,hovertext:v.hovertext,textposition:v.textposition,textfont:v.textfont,mode:{valType:"flaglist",flags:["lines","markers","text"],extras:["none"]},line:{color:t.color,width:t.width,shape:{valType:"enumerated",values:["linear","hv","vh","hvh","vhv"],dflt:"linear",editType:"plot"},dash:{valType:"enumerated",values:e(r),dflt:"solid"}},marker:a({},M("marker"),{symbol:c.symbol,size:c.size,sizeref:c.sizeref,sizemin:c.sizemin,sizemode:c.sizemode,opacity:c.opacity,colorbar:c.colorbar,line:a({},M("marker.line"),{width:o.width})}),connectgaps:v.connectgaps,fill:a({},v.fill,{dflt:"none"}),fillcolor:v.fillcolor,selected:{marker:v.selected.marker,textfont:v.selected.textfont},unselected:{marker:v.unselected.marker,textfont:v.unselected.textfont},opacity:w.opacity},"calc","nested");i.x.editType=i.y.editType=i.x0.editType=i.y0.editType="calc+clearAxisTypes",i.hovertemplate=v.hovertemplate,i.texttemplate=v.texttemplate},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../lib/sort_object_keys":538,"../../plot_api/edit_types":548,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../scatter/attributes":936,"./constants":991}],989:[function(d,ee,te){var w=d("./hover");ee.exports={moduleType:"trace",name:"scattergl",basePlotModule:d("../../plots/cartesian"),categories:["gl","regl","cartesian","symbols","errorBarsOK","showLegend","scatter-like"],attributes:d("./attributes"),supplyDefaults:d("./defaults"),crossTraceDefaults:d("../scatter/cross_trace_defaults"),colorbar:d("../scatter/marker_colorbar"),formatLabels:d("./format_labels"),calc:d("./calc"),hoverPoints:w.hoverPoints,selectPoints:d("./select"),meta:{}}},{"../../plots/cartesian":578,"../scatter/cross_trace_defaults":942,"../scatter/marker_colorbar":954,"./attributes":988,"./calc":990,"./defaults":993,"./format_labels":995,"./hover":997,"./select":1001}],990:[function(d,ee,te){var w=d("@plotly/point-cluster"),v=d("../../lib"),S=d("../../plots/cartesian/axis_ids"),M=d("../../plots/cartesian/autorange").findExtremes,e=d("../../plots/cartesian/align_period"),a=d("../scatter/calc"),n=a.calcMarkerSize,r=a.calcAxisExpansion,t=a.setFirstScatter,c=d("../scatter/colorscale_calc"),o=d("./convert"),i=d("./scene_update"),y=d("../../constants/numerical").BADNUM,p=d("./constants").TOO_MANY_POINTS;ee.exports=function(u,_){var s=u._fullLayout,A=S.getFromId(u,_.xaxis),b=S.getFromId(u,_.yaxis),f=s._plots[_.xaxis+_.yaxis],x=_._length,l=x>=p,L=x*2,T={},k,P=A.makeCalcdata(_,"x"),z=b.makeCalcdata(_,"y"),I=e(_,A,"x",P),D=e(_,b,"y",z),R=I.vals,B=D.vals;_._x=R,_._y=B,_.xperiodalignment&&(_._origX=P,_._xStarts=I.starts,_._xEnds=I.ends),_.yperiodalignment&&(_._origY=z,_._yStarts=D.starts,_._yEnds=D.ends);var F=new Array(L),H=new Array(x);for(k=0;k<x;k++)F[k*2]=R[k]===y?NaN:R[k],F[k*2+1]=B[k]===y?NaN:B[k],H[k]=k;if(A.type==="log")for(k=0;k<L;k+=2)F[k]=A.c2l(F[k]);if(b.type==="log")for(k=1;k<L;k+=2)F[k]=b.c2l(F[k]);l&&A.type!=="log"&&b.type!=="log"?T.tree=w(F):T.ids=H,c(u,_);var G=h(u,f,_,F,R,B),J=i(u,f);t(s,_);var X;return l?G.marker&&(X=G.marker.sizeAvg||Math.max(G.marker.size,3)):X=n(_,x),r(u,_,A,b,R,B,X),G.errorX&&g(_,A,G.errorX),G.errorY&&g(_,b,G.errorY),G.fill&&!J.fill2d&&(J.fill2d=!0),G.marker&&!J.scatter2d&&(J.scatter2d=!0),G.line&&!J.line2d&&(J.line2d=!0),(G.errorX||G.errorY)&&!J.error2d&&(J.error2d=!0),G.text&&!J.glText&&(J.glText=!0),G.marker&&(G.marker.snap=x),J.lineOptions.push(G.line),J.errorXOptions.push(G.errorX),J.errorYOptions.push(G.errorY),J.fillOptions.push(G.fill),J.markerOptions.push(G.marker),J.markerSelectedOptions.push(G.markerSel),J.markerUnselectedOptions.push(G.markerUnsel),J.textOptions.push(G.text),J.textSelectedOptions.push(G.textSel),J.textUnselectedOptions.push(G.textUnsel),J.selectBatch.push([]),J.unselectBatch.push([]),T._scene=J,T.index=J.count,T.x=R,T.y=B,T.positions=F,J.count++,[{x:!1,y:!1,t:T,trace:_}]};function g(m,u,_){var s=m._extremes[u._id],A=M(u,_._bnds,{padded:!0});s.min=s.min.concat(A.min),s.max=s.max.concat(A.max)}function h(m,u,_,s,A,b){var f=o.style(m,_);if(f.marker&&(f.marker.positions=s),f.line&&s.length>1&&v.extendFlat(f.line,o.linePositions(m,_,s)),f.errorX||f.errorY){var x=o.errorBarPositions(m,_,s,A,b);f.errorX&&v.extendFlat(f.errorX,x.x),f.errorY&&v.extendFlat(f.errorY,x.y)}return f.text&&(v.extendFlat(f.text,{positions:s},o.textPosition(m,_,f.text,f.marker)),v.extendFlat(f.textSel,{positions:s},o.textPosition(m,_,f.text,f.markerSel)),v.extendFlat(f.textUnsel,{positions:s},o.textPosition(m,_,f.text,f.markerUnsel))),f}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/align_period":563,"../../plots/cartesian/autorange":565,"../../plots/cartesian/axis_ids":570,"../scatter/calc":937,"../scatter/colorscale_calc":939,"./constants":991,"./convert":992,"./scene_update":1e3,"@plotly/point-cluster":59}],991:[function(d,ee,te){var w=20;ee.exports={TOO_MANY_POINTS:1e5,SYMBOL_SDF_SIZE:200,SYMBOL_SIZE:w,SYMBOL_STROKE:w/20,DOT_RE:/-dot/,OPEN_RE:/-open/,DASHES:{solid:[1],dot:[1,1],dash:[4,1],longdash:[8,1],dashdot:[4,1,1,1],longdashdot:[8,1,1,1]}}},{}],992:[function(d,ee,te){var w=d("fast-isnumeric"),v=d("svg-path-sdf"),S=d("color-normalize"),M=d("../../registry"),e=d("../../lib"),a=d("../../components/drawing"),n=d("../../plots/cartesian/axis_ids"),r=d("../../lib/gl_format_color").formatColor,t=d("../scatter/subtypes"),c=d("../scatter/make_bubble_size_func"),o=d("./helpers"),i=d("./constants"),y=d("../../constants/interactions").DESELECTDIM,p={start:1,left:1,end:-1,right:-1,middle:0,center:0,bottom:1,top:-1},g=d("../../components/fx/helpers").appendArrayPointValue;function h(I,D){var R,B={marker:void 0,markerSel:void 0,markerUnsel:void 0,line:void 0,fill:void 0,errorX:void 0,errorY:void 0,text:void 0,textSel:void 0,textUnsel:void 0},F=I._context.plotGlPixelRatio;if(D.visible!==!0)return B;if(t.hasText(D)&&(B.text=m(I,D),B.textSel=s(I,D,D.selected),B.textUnsel=s(I,D,D.unselected)),t.hasMarkers(D)&&(B.marker=u(D),B.markerSel=_(D,D.selected),B.markerUnsel=_(D,D.unselected),!D.unselected&&e.isArrayOrTypedArray(D.marker.opacity))){var H=D.marker.opacity;for(B.markerUnsel.opacity=new Array(H.length),R=0;R<H.length;R++)B.markerUnsel.opacity[R]=y*H[R]}if(t.hasLines(D)){B.line={overlay:!0,thickness:D.line.width*F,color:D.line.color,opacity:D.opacity};var G=(i.DASHES[D.line.dash]||[1]).slice();for(R=0;R<G.length;++R)G[R]*=D.line.width*F;B.line.dashes=G}return D.error_x&&D.error_x.visible&&(B.errorX=A(D,D.error_x,F)),D.error_y&&D.error_y.visible&&(B.errorY=A(D,D.error_y,F)),!!D.fill&&D.fill!=="none"&&(B.fill={closed:!0,fill:D.fillcolor,thickness:0}),B}function m(I,D){var R=I._fullLayout,B=D._length,F=D.textfont,H=D.textposition,G=Array.isArray(H)?H:[H],J=F.color,X=F.size,Y=F.family,Z={},oe,re=I._context.plotGlPixelRatio,se=D.texttemplate;if(se){Z.text=[];var N=R._d3locale,U=Array.isArray(se),q=U?Math.min(se.length,B):B,$=U?function(ye){return se[ye]}:function(){return se};for(oe=0;oe<q;oe++){var W={i:oe},K=D._module.formatLabels(W,D,R),ne={};g(ne,D,oe);var ae=D._meta||{};Z.text.push(e.texttemplateString($(oe),K,N,ne,W,ae))}}else Array.isArray(D.text)&&D.text.length<B?Z.text=D.text.slice():Z.text=D.text;if(Array.isArray(Z.text))for(oe=Z.text.length;oe<B;oe++)Z.text[oe]="";for(Z.opacity=D.opacity,Z.font={},Z.align=[],Z.baseline=[],oe=0;oe<G.length;oe++){var ie=G[oe].split(/\s+/);switch(ie[1]){case"left":Z.align.push("right");break;case"right":Z.align.push("left");break;default:Z.align.push(ie[1])}switch(ie[0]){case"top":Z.baseline.push("bottom");break;case"bottom":Z.baseline.push("top");break;default:Z.baseline.push(ie[0])}}if(Array.isArray(J))for(Z.color=new Array(B),oe=0;oe<B;oe++)Z.color[oe]=J[oe];else Z.color=J;if(e.isArrayOrTypedArray(X)||Array.isArray(Y))for(Z.font=new Array(B),oe=0;oe<B;oe++){var le=Z.font[oe]={};le.size=(e.isTypedArray(X)?X[oe]:Array.isArray(X)?w(X[oe])?X[oe]:0:X)*re,le.family=Array.isArray(Y)?Y[oe]:Y}else Z.font={size:X*re,family:Y};return Z}function u(I){var D=I._length,R=I.marker,B={},F,H=e.isArrayOrTypedArray(R.symbol),G=e.isArrayOrTypedArray(R.color),J=e.isArrayOrTypedArray(R.line.color),X=e.isArrayOrTypedArray(R.opacity),Y=e.isArrayOrTypedArray(R.size),Z=e.isArrayOrTypedArray(R.line.width),oe;if(H||(oe=o.isOpenSymbol(R.symbol)),H||G||J||X){B.colors=new Array(D),B.borderColors=new Array(D);var re=r(R,R.opacity,D),se=r(R.line,R.opacity,D);if(!Array.isArray(se[0])){var N=se;for(se=Array(D),F=0;F<D;F++)se[F]=N}if(!Array.isArray(re[0])){var U=re;for(re=Array(D),F=0;F<D;F++)re[F]=U}for(B.colors=re,B.borderColors=se,F=0;F<D;F++){if(H){var q=R.symbol[F];oe=o.isOpenSymbol(q)}oe&&(se[F]=re[F].slice(),re[F]=re[F].slice(),re[F][3]=0)}B.opacity=I.opacity}else oe?(B.color=S(R.color,"uint8"),B.color[3]=0,B.borderColor=S(R.color,"uint8")):(B.color=S(R.color,"uint8"),B.borderColor=S(R.line.color,"uint8")),B.opacity=I.opacity*R.opacity;if(H)for(B.markers=new Array(D),F=0;F<D;F++)B.markers[F]=T(R.symbol[F]);else B.marker=T(R.symbol);var $=1,W=c(I,$),K;if(Y||Z){var ne=B.sizes=new Array(D),ae=B.borderSizes=new Array(D),ie=0,le;if(Y){for(F=0;F<D;F++)ne[F]=W(R.size[F]),ie+=ne[F];le=ie/D}else for(K=W(R.size),F=0;F<D;F++)ne[F]=K;if(Z)for(F=0;F<D;F++)ae[F]=R.line.width[F];else for(K=R.line.width,F=0;F<D;F++)ae[F]=K;B.sizeAvg=le}else B.size=W(R&&R.size||10),B.borderSizes=W(R.line.width);return B}function _(I,D){var R=I.marker,B={};return D&&(D.marker&&D.marker.symbol?B=u(e.extendFlat({},R,D.marker)):D.marker&&(D.marker.size&&(B.size=D.marker.size),D.marker.color&&(B.colors=D.marker.color),D.marker.opacity!==void 0&&(B.opacity=D.marker.opacity))),B}function s(I,D,R){var B={};if(!R)return B;if(R.textfont){var F={opacity:1,text:D.text,texttemplate:D.texttemplate,textposition:D.textposition,textfont:e.extendFlat({},D.textfont)};R.textfont&&e.extendFlat(F.textfont,R.textfont),B=m(I,F)}return B}function A(I,D,R){var B={capSize:D.width*2*R,lineWidth:D.thickness*R,color:D.color};return D.copy_ystyle&&(B=I.error_y),B}var b=i.SYMBOL_SDF_SIZE,f=i.SYMBOL_SIZE,x=i.SYMBOL_STROKE,l={},L=a.symbolFuncs[0](f*.05);function T(I){if(I==="circle")return null;var D,R,B=a.symbolNumber(I),F=a.symbolFuncs[B%100],H=!!a.symbolNoDot[B%100],G=!!a.symbolNoFill[B%100],J=o.isDotSymbol(I);return l[I]?l[I]:(J&&!H?D=F(f*1.1)+L:D=F(f),R=v(D,{w:b,h:b,viewBox:[-f,-f,f,f],stroke:G?x:-x}),l[I]=R,R||null)}function k(I,D,R){var B=R.length,F=B/2,H,G;if(t.hasLines(D)&&F)if(D.line.shape==="hv"){for(H=[],G=0;G<F-1;G++)isNaN(R[G*2])||isNaN(R[G*2+1])?H.push(NaN,NaN,NaN,NaN):(H.push(R[G*2],R[G*2+1]),!isNaN(R[G*2+2])&&!isNaN(R[G*2+3])?H.push(R[G*2+2],R[G*2+1]):H.push(NaN,NaN));H.push(R[B-2],R[B-1])}else if(D.line.shape==="hvh"){for(H=[],G=0;G<F-1;G++)if(isNaN(R[G*2])||isNaN(R[G*2+1])||isNaN(R[G*2+2])||isNaN(R[G*2+3]))!isNaN(R[G*2])&&!isNaN(R[G*2+1])?H.push(R[G*2],R[G*2+1]):H.push(NaN,NaN),H.push(NaN,NaN);else{var J=(R[G*2]+R[G*2+2])/2;H.push(R[G*2],R[G*2+1],J,R[G*2+1],J,R[G*2+3])}H.push(R[B-2],R[B-1])}else if(D.line.shape==="vhv"){for(H=[],G=0;G<F-1;G++)if(isNaN(R[G*2])||isNaN(R[G*2+1])||isNaN(R[G*2+2])||isNaN(R[G*2+3]))!isNaN(R[G*2])&&!isNaN(R[G*2+1])?H.push(R[G*2],R[G*2+1]):H.push(NaN,NaN),H.push(NaN,NaN);else{var X=(R[G*2+1]+R[G*2+3])/2;H.push(R[G*2],R[G*2+1],R[G*2],X,R[G*2+2],X)}H.push(R[B-2],R[B-1])}else if(D.line.shape==="vh"){for(H=[],G=0;G<F-1;G++)isNaN(R[G*2])||isNaN(R[G*2+1])?H.push(NaN,NaN,NaN,NaN):(H.push(R[G*2],R[G*2+1]),!isNaN(R[G*2+2])&&!isNaN(R[G*2+3])?H.push(R[G*2],R[G*2+3]):H.push(NaN,NaN));H.push(R[B-2],R[B-1])}else H=R;var Y=!1;for(G=0;G<H.length;G++)if(isNaN(H[G])){Y=!0;break}var Z=Y||H.length>i.TOO_MANY_POINTS||t.hasMarkers(D)?"rect":"round";if(Y&&D.connectgaps){var oe=H[0],re=H[1];for(G=0;G<H.length;G+=2)isNaN(H[G])||isNaN(H[G+1])?(H[G]=oe,H[G+1]=re):(oe=H[G],re=H[G+1])}return{join:Z,positions:H}}function P(I,D,R,B,F){var H=M.getComponentMethod("errorbars","makeComputeError"),G=n.getFromId(I,D.xaxis),J=n.getFromId(I,D.yaxis),X=R.length/2,Y={};function Z(oe,re){var se=re._id.charAt(0),N=D["error_"+se];if(N&&N.visible&&(re.type==="linear"||re.type==="log")){for(var U=H(N),q={x:0,y:1}[se],$={x:[0,1,2,3],y:[2,3,0,1]}[se],W=new Float64Array(4*X),K=1/0,ne=-1/0,ae=0,ie=0;ae<X;ae++,ie+=4){var le=oe[ae];if(w(le)){var ye=R[ae*2+q],ue=U(le,ae),pe=ue[0],ge=ue[1];if(w(pe)&&w(ge)){var Te=le-pe,_e=le+ge;W[ie+$[0]]=ye-re.c2l(Te),W[ie+$[1]]=re.c2l(_e)-ye,W[ie+$[2]]=0,W[ie+$[3]]=0,K=Math.min(K,le-pe),ne=Math.max(ne,le+ge)}}}Y[se]={positions:R,errors:W,_bnds:[K,ne]}}}return Z(B,G),Z(F,J),Y}function z(I,D,R,B){var F=D._length,H={},G;if(t.hasMarkers(D)){var J=R.font,X=R.align,Y=R.baseline;for(H.offset=new Array(F),G=0;G<F;G++){var Z=B.sizes?B.sizes[G]:B.size,oe=Array.isArray(J)?J[G].size:J.size,re=Array.isArray(X)?X.length>1?X[G]:X[0]:X,se=Array.isArray(Y)?Y.length>1?Y[G]:Y[0]:Y,N=p[re],U=p[se],q=Z?Z/.8+1:0,$=-U*q-U*.5;H.offset[G]=[N*q/oe,$/oe]}}return H}ee.exports={style:h,markerStyle:u,markerSelection:_,linePositions:k,errorBarPositions:P,textPosition:z}},{"../../components/drawing":389,"../../components/fx/helpers":403,"../../constants/interactions":490,"../../lib":515,"../../lib/gl_format_color":511,"../../plots/cartesian/axis_ids":570,"../../registry":647,"../scatter/make_bubble_size_func":953,"../scatter/subtypes":961,"./constants":991,"./helpers":996,"color-normalize":89,"fast-isnumeric":190,"svg-path-sdf":311}],993:[function(d,ee,te){var w=d("../../lib"),v=d("../../registry"),S=d("./helpers"),M=d("./attributes"),e=d("../scatter/constants"),a=d("../scatter/subtypes"),n=d("../scatter/xy_defaults"),r=d("../scatter/period_defaults"),t=d("../scatter/marker_defaults"),c=d("../scatter/line_defaults"),o=d("../scatter/fillcolor_defaults"),i=d("../scatter/text_defaults");ee.exports=function(p,g,h,m){function u(L,T){return w.coerce(p,g,M,L,T)}var _=p.marker?S.isOpenSymbol(p.marker.symbol):!1,s=a.isBubble(p),A=n(p,g,m,u);if(!A){g.visible=!1;return}r(p,g,m,u),u("xhoverformat"),u("yhoverformat");var b=A<e.PTS_LINESONLY?"lines+markers":"lines";u("text"),u("hovertext"),u("hovertemplate"),u("mode",b),a.hasLines(g)&&(u("connectgaps"),c(p,g,h,m,u),u("line.shape")),a.hasMarkers(g)&&(t(p,g,h,m,u),u("marker.line.width",_||s?1:0)),a.hasText(g)&&(u("texttemplate"),i(p,g,m,u));var f=(g.line||{}).color,x=(g.marker||{}).color;u("fill"),g.fill!=="none"&&o(p,g,h,u);var l=v.getComponentMethod("errorbars","supplyDefaults");l(p,g,f||x||h,{axis:"y"}),l(p,g,f||x||h,{axis:"x",inherit:"y"}),w.coerceSelectionMarkerOpacity(g,u)}},{"../../lib":515,"../../registry":647,"../scatter/constants":940,"../scatter/fillcolor_defaults":944,"../scatter/line_defaults":949,"../scatter/marker_defaults":955,"../scatter/period_defaults":956,"../scatter/subtypes":961,"../scatter/text_defaults":962,"../scatter/xy_defaults":963,"./attributes":988,"./helpers":996}],994:[function(d,ee,te){var w=d("../../lib"),v=d("../../components/color"),S=d("../../constants/interactions").DESELECTDIM;function M(e){var a=e[0],n=a.trace,r=a.t,t=r._scene,c=r.index,o=t.selectBatch[c],i=t.unselectBatch[c],y=t.textOptions[c],p=t.textSelectedOptions[c]||{},g=t.textUnselectedOptions[c]||{},h=w.extendFlat({},y),m,u;if(o.length||i.length){var _=p.color,s=g.color,A=y.color,b=Array.isArray(A);for(h.color=new Array(n._length),m=0;m<o.length;m++)u=o[m],h.color[u]=_||(b?A[u]:A);for(m=0;m<i.length;m++){u=i[m];var f=b?A[u]:A;h.color[u]=s||(_?f:v.addOpacity(f,S))}}t.glText[c].update(h)}ee.exports={styleTextSelection:M}},{"../../components/color":367,"../../constants/interactions":490,"../../lib":515}],995:[function(d,ee,te){var w=d("../scatter/format_labels");ee.exports=function(S,M,e){var a=S.i;return"x"in S||(S.x=M._x[a]),"y"in S||(S.y=M._y[a]),w(S,M,e)}},{"../scatter/format_labels":945}],996:[function(d,ee,te){var w=d("./constants");te.isOpenSymbol=function(v){return typeof v=="string"?w.OPEN_RE.test(v):v%200>100},te.isDotSymbol=function(v){return typeof v=="string"?w.DOT_RE.test(v):v>200}},{"./constants":991}],997:[function(d,ee,te){var w=d("../../registry"),v=d("../../lib"),S=d("../scatter/get_trace_color");function M(a,n,r,t){var c=a.cd,o=c[0].t,i=c[0].trace,y=a.xa,p=a.ya,g=o.x,h=o.y,m=y.c2p(n),u=p.c2p(r),_=a.distance,s;if(o.tree){var A=y.p2c(m-_),b=y.p2c(m+_),f=p.p2c(u-_),x=p.p2c(u+_);t==="x"?s=o.tree.range(Math.min(A,b),Math.min(p._rl[0],p._rl[1]),Math.max(A,b),Math.max(p._rl[0],p._rl[1])):s=o.tree.range(Math.min(A,b),Math.min(f,x),Math.max(A,b),Math.max(f,x))}else s=o.ids;var l,L,T,k,P,z,I,D,R,B=_;if(t==="x"){var F=!!i.xperiodalignment,H=!!i.yperiodalignment;for(P=0;P<s.length;P++){if(l=s[P],T=g[l],z=Math.abs(y.c2p(T)-m),F){var G=y.c2p(i._xStarts[l]),J=y.c2p(i._xEnds[l]);z=m>=Math.min(G,J)&&m<=Math.max(G,J)?0:1/0}if(z<B){if(B=z,k=h[l],I=p.c2p(k)-u,H){var X=p.c2p(i._yStarts[l]),Y=p.c2p(i._yEnds[l]);I=u>=Math.min(X,Y)&&u<=Math.max(X,Y)?0:1/0}R=Math.sqrt(z*z+I*I),L=s[P]}}}else for(P=s.length-1;P>-1;P--)l=s[P],T=g[l],k=h[l],z=y.c2p(T)-m,I=p.c2p(k)-u,D=Math.sqrt(z*z+I*I),D<B&&(B=R=D,L=l);return a.index=L,a.distance=B,a.dxy=R,L===void 0?[a]:[e(a,g,h,i)]}function e(a,n,r,t){var c=a.xa,o=a.ya,i=a.distance,y=a.dxy,p=a.index,g={pointNumber:p,x:n[p],y:r[p]};g.tx=Array.isArray(t.text)?t.text[p]:t.text,g.htx=Array.isArray(t.hovertext)?t.hovertext[p]:t.hovertext,g.data=Array.isArray(t.customdata)?t.customdata[p]:t.customdata,g.tp=Array.isArray(t.textposition)?t.textposition[p]:t.textposition;var h=t.textfont;h&&(g.ts=v.isArrayOrTypedArray(h.size)?h.size[p]:h.size,g.tc=Array.isArray(h.color)?h.color[p]:h.color,g.tf=Array.isArray(h.family)?h.family[p]:h.family);var m=t.marker;m&&(g.ms=v.isArrayOrTypedArray(m.size)?m.size[p]:m.size,g.mo=v.isArrayOrTypedArray(m.opacity)?m.opacity[p]:m.opacity,g.mx=v.isArrayOrTypedArray(m.symbol)?m.symbol[p]:m.symbol,g.mc=v.isArrayOrTypedArray(m.color)?m.color[p]:m.color);var u=m&&m.line;u&&(g.mlc=Array.isArray(u.color)?u.color[p]:u.color,g.mlw=v.isArrayOrTypedArray(u.width)?u.width[p]:u.width);var _=m&&m.gradient;_&&_.type!=="none"&&(g.mgt=Array.isArray(_.type)?_.type[p]:_.type,g.mgc=Array.isArray(_.color)?_.color[p]:_.color);var s=c.c2p(g.x,!0),A=o.c2p(g.y,!0),b=g.mrc||1,f=t.hoverlabel;f&&(g.hbg=Array.isArray(f.bgcolor)?f.bgcolor[p]:f.bgcolor,g.hbc=Array.isArray(f.bordercolor)?f.bordercolor[p]:f.bordercolor,g.hts=v.isArrayOrTypedArray(f.font.size)?f.font.size[p]:f.font.size,g.htc=Array.isArray(f.font.color)?f.font.color[p]:f.font.color,g.htf=Array.isArray(f.font.family)?f.font.family[p]:f.font.family,g.hnl=v.isArrayOrTypedArray(f.namelength)?f.namelength[p]:f.namelength);var x=t.hoverinfo;x&&(g.hi=Array.isArray(x)?x[p]:x);var l=t.hovertemplate;l&&(g.ht=Array.isArray(l)?l[p]:l);var L={};L[a.index]=g;var T=t._origX,k=t._origY,P=v.extendFlat({},a,{color:S(t,g),x0:s-b,x1:s+b,xLabelVal:T?T[p]:g.x,y0:A-b,y1:A+b,yLabelVal:k?k[p]:g.y,cd:L,distance:i,spikeDistance:y,hovertemplate:g.ht});return g.htx?P.text=g.htx:g.tx?P.text=g.tx:t.text&&(P.text=t.text),v.fillText(g,t,P),w.getComponentMethod("errorbars","hoverInfo")(g,t,P),P}ee.exports={hoverPoints:M,calcHover:e}},{"../../lib":515,"../../registry":647,"../scatter/get_trace_color":946}],998:[function(d,ee,te){arguments[4][905][0].apply(te,arguments)},{"./base_index":989,"./plot":999,dup:905}],999:[function(d,ee,y){var w=d("regl-scatter2d"),v=d("regl-line2d"),S=d("regl-error2d"),M=d("gl-text"),e=d("../../lib"),a=d("../../components/dragelement/helpers").selectMode,n=d("../../lib/prepare_regl"),r=d("../scatter/subtypes"),t=d("../scatter/link_traces"),c=d("./edit_style").styleTextSelection,o={};function i(p,g,h,m){var u=p._size,_=p.width*m,s=p.height*m,A=u.l*m,b=u.b*m,f=u.r*m,x=u.t*m,l=u.w*m,L=u.h*m;return[A+g.domain[0]*l,b+h.domain[0]*L,_-f-(1-g.domain[1])*l,s-x-(1-h.domain[1])*L]}var y=ee.exports=function(g,h,m){if(!!m.length){var u=g._fullLayout,_=h._scene,s=h.xaxis,A=h.yaxis,b,f;if(!!_){var x=n(g,["ANGLE_instanced_arrays","OES_element_index_uint"],o);if(!x){_.init();return}var l=_.count,L=u._glcanvas.data()[0].regl;if(t(g,h,m),_.dirty){if(_.error2d===!0&&(_.error2d=S(L)),_.line2d===!0&&(_.line2d=v(L)),_.scatter2d===!0&&(_.scatter2d=w(L)),_.fill2d===!0&&(_.fill2d=v(L)),_.glText===!0)for(_.glText=new Array(l),b=0;b<l;b++)_.glText[b]=new M(L);if(_.glText){if(l>_.glText.length){var T=l-_.glText.length;for(b=0;b<T;b++)_.glText.push(new M(L))}else if(l<_.glText.length){var k=_.glText.length-l,P=_.glText.splice(l,k);P.forEach(function(W){W.destroy()})}for(b=0;b<l;b++)_.glText[b].update(_.textOptions[b])}if(_.line2d&&(_.line2d.update(_.lineOptions),_.lineOptions=_.lineOptions.map(function(W){if(W&&W.positions){for(var K=W.positions,ne=0;ne<K.length&&(isNaN(K[ne])||isNaN(K[ne+1]));)ne+=2;for(var ae=K.length-2;ae>ne&&(isNaN(K[ae])||isNaN(K[ae+1]));)ae-=2;W.positions=K.slice(ne,ae+2)}return W}),_.line2d.update(_.lineOptions)),_.error2d){var z=(_.errorXOptions||[]).concat(_.errorYOptions||[]);_.error2d.update(z)}_.scatter2d&&_.scatter2d.update(_.markerOptions),_.fillOrder=e.repeat(null,l),_.fill2d&&(_.fillOptions=_.fillOptions.map(function(W,K){var ne=m[K];if(!(!W||!ne||!ne[0]||!ne[0].trace)){var ae=ne[0],ie=ae.trace,le=ae.t,ye=_.lineOptions[K],ue,pe,ge=[];ie._ownfill&&ge.push(K),ie._nexttrace&&ge.push(K+1),ge.length&&(_.fillOrder[K]=ge);var Te=[],_e=ye&&ye.positions||le.positions,ze,Oe;if(ie.fill==="tozeroy"){for(ze=0;ze<_e.length&&isNaN(_e[ze+1]);)ze+=2;for(Oe=_e.length-2;Oe>ze&&isNaN(_e[Oe+1]);)Oe-=2;_e[ze+1]!==0&&(Te=[_e[ze],0]),Te=Te.concat(_e.slice(ze,Oe+2)),_e[Oe+1]!==0&&(Te=Te.concat([_e[Oe],0]))}else if(ie.fill==="tozerox"){for(ze=0;ze<_e.length&&isNaN(_e[ze]);)ze+=2;for(Oe=_e.length-2;Oe>ze&&isNaN(_e[Oe]);)Oe-=2;_e[ze]!==0&&(Te=[0,_e[ze+1]]),Te=Te.concat(_e.slice(ze,Oe+2)),_e[Oe]!==0&&(Te=Te.concat([0,_e[Oe+1]]))}else if(ie.fill==="toself"||ie.fill==="tonext"){for(Te=[],ue=0,W.splitNull=!0,pe=0;pe<_e.length;pe+=2)(isNaN(_e[pe])||isNaN(_e[pe+1]))&&(Te=Te.concat(_e.slice(ue,pe)),Te.push(_e[ue],_e[ue+1]),Te.push(null,null),ue=pe+2);Te=Te.concat(_e.slice(ue)),ue&&Te.push(_e[ue],_e[ue+1])}else{var Ye=ie._nexttrace;if(Ye){var be=_.lineOptions[K+1];if(be){var Pe=be.positions;if(ie.fill==="tonexty"){for(Te=_e.slice(),K=Math.floor(Pe.length/2);K--;){var Ge=Pe[K*2],Qe=Pe[K*2+1];isNaN(Ge)||isNaN(Qe)||Te.push(Ge,Qe)}W.fill=Ye.fillcolor}}}}if(ie._prevtrace&&ie._prevtrace.fill==="tonext"){var Be=_.lineOptions[K-1].positions,Le=Te.length/2;ue=Le;var He=[ue];for(pe=0;pe<Be.length;pe+=2)(isNaN(Be[pe])||isNaN(Be[pe+1]))&&(He.push(pe/2+Le+1),ue=pe+2);Te=Te.concat(Be),W.hole=He}return W.fillmode=ie.fill,W.opacity=ie.opacity,W.positions=Te,W}}),_.fill2d.update(_.fillOptions))}var I=u.dragmode,D=a(I),R=u.clickmode.indexOf("select")>-1;for(b=0;b<l;b++){var B=m[b][0],F=B.trace,H=B.t,G=H.index,J=F._length,X=H.x,Y=H.y;if(F.selectedpoints||D||R){if(D||(D=!0),F.selectedpoints){var Z=_.selectBatch[G]=e.selIndices2selPoints(F),oe={};for(f=0;f<Z.length;f++)oe[Z[f]]=1;var re=[];for(f=0;f<J;f++)oe[f]||re.push(f);_.unselectBatch[G]=re}var se=H.xpx=new Array(J),N=H.ypx=new Array(J);for(f=0;f<J;f++)se[f]=s.c2p(X[f]),N[f]=A.c2p(Y[f])}else H.xpx=H.ypx=null}if(D){if(_.select2d||(_.select2d=w(u._glcanvas.data()[1].regl)),_.scatter2d){var U=new Array(l);for(b=0;b<l;b++)U[b]=_.selectBatch[b].length||_.unselectBatch[b].length?_.markerUnselectedOptions[b]:{};_.scatter2d.update(U)}_.select2d&&(_.select2d.update(_.markerOptions),_.select2d.update(_.markerSelectedOptions)),_.glText&&m.forEach(function(W){var K=((W||[])[0]||{}).trace||{};r.hasText(K)&&c(W)})}else _.scatter2d&&_.scatter2d.update(_.markerOptions);var q={viewport:i(u,s,A,g._context.plotGlPixelRatio),range:[(s._rl||s.range)[0],(A._rl||A.range)[0],(s._rl||s.range)[1],(A._rl||A.range)[1]]},$=e.repeat(q,_.count);_.fill2d&&_.fill2d.update($),_.line2d&&_.line2d.update($),_.error2d&&_.error2d.update($.concat($)),_.scatter2d&&_.scatter2d.update($),_.select2d&&_.select2d.update($),_.glText&&_.glText.forEach(function(W){W.update(q)})}}};y.reglPrecompiled=o},{"../../components/dragelement/helpers":385,"../../lib":515,"../../lib/prepare_regl":528,"../scatter/link_traces":952,"../scatter/subtypes":961,"./edit_style":994,"gl-text":225,"regl-error2d":280,"regl-line2d":281,"regl-scatter2d":282}],1e3:[function(d,ee,te){var w=d("../../lib");ee.exports=function(S,M){var e=M._scene,a={count:0,dirty:!0,lineOptions:[],fillOptions:[],markerOptions:[],markerSelectedOptions:[],markerUnselectedOptions:[],errorXOptions:[],errorYOptions:[],textOptions:[],textSelectedOptions:[],textUnselectedOptions:[],selectBatch:[],unselectBatch:[]},n={fill2d:!1,scatter2d:!1,error2d:!1,line2d:!1,glText:!1,select2d:!1};return M._scene||(e=M._scene={},e.init=function(){w.extendFlat(e,n,a)},e.init(),e.update=function(t){var c=w.repeat(t,e.count);if(e.fill2d&&e.fill2d.update(c),e.scatter2d&&e.scatter2d.update(c),e.line2d&&e.line2d.update(c),e.error2d&&e.error2d.update(c.concat(c)),e.select2d&&e.select2d.update(c),e.glText)for(var o=0;o<e.count;o++)e.glText[o].update(t)},e.draw=function(){for(var t=e.count,c=e.fill2d,o=e.error2d,i=e.line2d,y=e.scatter2d,p=e.glText,g=e.select2d,h=e.selectBatch,m=e.unselectBatch,u=0;u<t;u++){if(c&&e.fillOrder[u]&&c.draw(e.fillOrder[u]),i&&e.lineOptions[u]&&i.draw(u),o&&(e.errorXOptions[u]&&o.draw(u),e.errorYOptions[u]&&o.draw(u+t)),y&&e.markerOptions[u])if(m[u].length){var _=w.repeat([],e.count);_[u]=m[u],y.draw(_)}else h[u].length||y.draw(u);p[u]&&e.textOptions[u]&&p[u].render()}g&&g.draw(h),e.dirty=!1},e.destroy=function(){e.fill2d&&e.fill2d.destroy&&e.fill2d.destroy(),e.scatter2d&&e.scatter2d.destroy&&e.scatter2d.destroy(),e.error2d&&e.error2d.destroy&&e.error2d.destroy(),e.line2d&&e.line2d.destroy&&e.line2d.destroy(),e.select2d&&e.select2d.destroy&&e.select2d.destroy(),e.glText&&e.glText.forEach(function(t){t.destroy&&t.destroy()}),e.lineOptions=null,e.fillOptions=null,e.markerOptions=null,e.markerSelectedOptions=null,e.markerUnselectedOptions=null,e.errorXOptions=null,e.errorYOptions=null,e.textOptions=null,e.textSelectedOptions=null,e.textUnselectedOptions=null,e.selectBatch=null,e.unselectBatch=null,M._scene=null}),e.dirty||w.extendFlat(e,a),e}},{"../../lib":515}],1001:[function(d,ee,te){var w=d("../scatter/subtypes"),v=d("./edit_style").styleTextSelection;ee.exports=function(M,e){var a=M.cd,n=M.xaxis,r=M.yaxis,t=[],c=a[0].trace,o=a[0].t,i=c._length,y=o.x,p=o.y,g=o._scene,h=o.index;if(!g)return t;var m=w.hasText(c),u=w.hasMarkers(c),_=!u&&!m;if(c.visible!==!0||_)return t;var s=[],A=[];if(e!==!1&&!e.degenerate)for(var b=0;b<i;b++)e.contains([o.xpx[b],o.ypx[b]],!1,b,M)?(s.push(b),t.push({pointNumber:b,x:n.c2d(y[b]),y:r.c2d(p[b])})):A.push(b);if(u){var f=g.scatter2d;if(!s.length&&!A.length){var x=new Array(g.count);x[h]=g.markerOptions[h],f.update.apply(f,x)}else if(!g.selectBatch[h].length&&!g.unselectBatch[h].length){var l=new Array(g.count);l[h]=g.markerUnselectedOptions[h],f.update.apply(f,l)}}return g.selectBatch[h]=s,g.unselectBatch[h]=A,m&&v(a),t}},{"../scatter/subtypes":961,"./edit_style":994}],1002:[function(d,ee,te){var w=d("../../plots/template_attributes").hovertemplateAttrs,v=d("../../plots/template_attributes").texttemplateAttrs,S=d("../scattergeo/attributes"),M=d("../scatter/attributes"),e=d("../../plots/mapbox/layout_attributes"),a=d("../../plots/attributes"),n=d("../../components/colorscale/attributes"),r=d("../../lib/extend").extendFlat,t=d("../../plot_api/edit_types").overrideAll,c=S.line,o=S.marker;ee.exports=t({lon:S.lon,lat:S.lat,mode:r({},M.mode,{dflt:"markers"}),text:r({},M.text,{}),texttemplate:v({editType:"plot"},{keys:["lat","lon","text"]}),hovertext:r({},M.hovertext,{}),line:{color:c.color,width:c.width},connectgaps:M.connectgaps,marker:r({symbol:{valType:"string",dflt:"circle",arrayOk:!0},angle:{valType:"number",dflt:"auto",arrayOk:!0},allowoverlap:{valType:"boolean",dflt:!1},opacity:o.opacity,size:o.size,sizeref:o.sizeref,sizemin:o.sizemin,sizemode:o.sizemode},n("marker")),fill:S.fill,fillcolor:M.fillcolor,textfont:e.layers.symbol.textfont,textposition:e.layers.symbol.textposition,below:{valType:"string"},selected:{marker:M.selected.marker},unselected:{marker:M.unselected.marker},hoverinfo:r({},a.hoverinfo,{flags:["lon","lat","text","name"]}),hovertemplate:w()},"calc","nested")},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plots/attributes":562,"../../plots/mapbox/layout_attributes":624,"../../plots/template_attributes":642,"../scatter/attributes":936,"../scattergeo/attributes":978}],1003:[function(d,ee,te){var w=d("fast-isnumeric"),v=d("../../lib"),S=d("../../constants/numerical").BADNUM,M=d("../../lib/geojson_utils"),e=d("../../components/colorscale"),a=d("../../components/drawing"),n=d("../scatter/make_bubble_size_func"),r=d("../scatter/subtypes"),t=d("../../plots/mapbox/convert_text_opts"),c=d("../../components/fx/helpers").appendArrayPointValue,o=d("../../lib/svg_text_utils").NEWLINES,i=d("../../lib/svg_text_utils").BR_TAG_ALL;ee.exports=function(s,A){var b=A[0].trace,f=b.visible===!0&&b._length!==0,x=b.fill!=="none",l=r.hasLines(b),L=r.hasMarkers(b),T=r.hasText(b),k=L&&b.marker.symbol==="circle",P=L&&b.marker.symbol!=="circle",z=y(),I=y(),D=y(),R=y(),B={fill:z,line:I,circle:D,symbol:R};if(!f)return B;var F;if((x||l)&&(F=M.calcTraceToLineCoords(A)),x&&(z.geojson=M.makePolygon(F),z.layout.visibility="visible",v.extendFlat(z.paint,{"fill-color":b.fillcolor})),l&&(I.geojson=M.makeLine(F),I.layout.visibility="visible",v.extendFlat(I.paint,{"line-width":b.line.width,"line-color":b.line.color,"line-opacity":b.opacity})),k){var H=p(A);D.geojson=H.geojson,D.layout.visibility="visible",v.extendFlat(D.paint,{"circle-color":H.mcc,"circle-radius":H.mrc,"circle-opacity":H.mo})}if((P||T)&&(R.geojson=g(A,s),v.extendFlat(R.layout,{visibility:"visible","icon-image":"{symbol}-15","text-field":"{text}"}),P&&(v.extendFlat(R.layout,{"icon-size":b.marker.size/10}),"angle"in b.marker&&b.marker.angle!=="auto"&&v.extendFlat(R.layout,{"icon-rotate":{type:"identity",property:"angle"},"icon-rotation-alignment":"map"}),R.layout["icon-allow-overlap"]=b.marker.allowoverlap,v.extendFlat(R.paint,{"icon-opacity":b.opacity*b.marker.opacity,"icon-color":b.marker.color})),T)){var G=(b.marker||{}).size,J=t(b.textposition,G);v.extendFlat(R.layout,{"text-size":b.textfont.size,"text-anchor":J.anchor,"text-offset":J.offset}),v.extendFlat(R.paint,{"text-color":b.textfont.color,"text-opacity":b.opacity})}return B};function y(){return{geojson:M.makeBlank(),layout:{visibility:"none"},paint:{}}}function p(_){var s=_[0].trace,A=s.marker,b=s.selectedpoints,f=v.isArrayOrTypedArray(A.color),x=v.isArrayOrTypedArray(A.size),l=v.isArrayOrTypedArray(A.opacity),L;function T(J){return s.opacity*J}function k(J){return J/2}var P;f&&(e.hasColorscale(s,"marker")?P=e.makeColorScaleFuncFromTrace(A):P=v.identity);var z;x&&(z=n(s));var I;l&&(I=function(J){var X=w(J)?+v.constrain(J,0,1):0;return T(X)});var D=[];for(L=0;L<_.length;L++){var R=_[L],B=R.lonlat;if(!u(B)){var F={};P&&(F.mcc=R.mcc=P(R.mc)),z&&(F.mrc=R.mrc=z(R.ms)),I&&(F.mo=I(R.mo)),b&&(F.selected=R.selected||0),D.push({type:"Feature",geometry:{type:"Point",coordinates:B},properties:F})}}var H;if(b)for(H=a.makeSelectedPointStyleFns(s),L=0;L<D.length;L++){var G=D[L].properties;H.selectedOpacityFn&&(G.mo=T(H.selectedOpacityFn(G))),H.selectedColorFn&&(G.mcc=H.selectedColorFn(G)),H.selectedSizeFn&&(G.mrc=H.selectedSizeFn(G))}return{geojson:{type:"FeatureCollection",features:D},mcc:f||H&&H.selectedColorFn?{type:"identity",property:"mcc"}:A.color,mrc:x||H&&H.selectedSizeFn?{type:"identity",property:"mrc"}:k(A.size),mo:l||H&&H.selectedOpacityFn?{type:"identity",property:"mo"}:T(A.opacity)}}function g(_,s){for(var A=s._fullLayout,b=_[0].trace,f=b.marker||{},x=f.symbol,l=f.angle,L=x!=="circle"?h(x):m,T=l!=="auto"?h(l,!0):m,k=r.hasText(b)?h(b.text):m,P=[],z=0;z<_.length;z++){var I=_[z];if(!u(I.lonlat)){var D=b.texttemplate,R;if(D){var B=Array.isArray(D)?D[z]||"":D,F=b._module.formatLabels(I,b,A),H={};c(H,b,I.i);var G=b._meta||{};R=v.texttemplateString(B,F,A._d3locale,H,I,G)}else R=k(z);R&&(R=R.replace(o,"").replace(i,`
`)),P.push({type:"Feature",geometry:{type:"Point",coordinates:I.lonlat},properties:{symbol:L(z),angle:T(z),text:R}})}}return{type:"FeatureCollection",features:P}}function h(_,s){return v.isArrayOrTypedArray(_)?s?function(A){return w(_[A])?+_[A]:0}:function(A){return _[A]}:_?function(){return _}:m}function m(){return""}function u(_){return _[0]===S}},{"../../components/colorscale":379,"../../components/drawing":389,"../../components/fx/helpers":403,"../../constants/numerical":491,"../../lib":515,"../../lib/geojson_utils":509,"../../lib/svg_text_utils":541,"../../plots/mapbox/convert_text_opts":621,"../scatter/make_bubble_size_func":953,"../scatter/subtypes":961,"fast-isnumeric":190}],1004:[function(d,ee,te){var w=d("../../lib"),v=d("../scatter/subtypes"),S=d("../scatter/marker_defaults"),M=d("../scatter/line_defaults"),e=d("../scatter/text_defaults"),a=d("../scatter/fillcolor_defaults"),n=d("./attributes");ee.exports=function(c,o,i,y){function p(m,u){return w.coerce(c,o,n,m,u)}var g=r(c,o,p);if(!g){o.visible=!1;return}if(p("text"),p("texttemplate"),p("hovertext"),p("hovertemplate"),p("mode"),p("below"),v.hasLines(o)&&(M(c,o,i,y,p,{noDash:!0}),p("connectgaps")),v.hasMarkers(o)){S(c,o,i,y,p,{noLine:!0}),p("marker.allowoverlap"),p("marker.angle");var h=o.marker;h.symbol!=="circle"&&(w.isArrayOrTypedArray(h.size)&&(h.size=h.size[0]),w.isArrayOrTypedArray(h.color)&&(h.color=h.color[0]))}v.hasText(o)&&e(c,o,y,p,{noSelect:!0}),p("fill"),o.fill!=="none"&&a(c,o,i,p),w.coerceSelectionMarkerOpacity(o,p)};function r(t,c,o){var i=o("lon")||[],y=o("lat")||[],p=Math.min(i.length,y.length);return c._length=p,p}},{"../../lib":515,"../scatter/fillcolor_defaults":944,"../scatter/line_defaults":949,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scatter/text_defaults":962,"./attributes":1002}],1005:[function(d,ee,te){ee.exports=function(v,S){return v.lon=S.lon,v.lat=S.lat,v}},{}],1006:[function(d,ee,te){var w=d("../../plots/cartesian/axes");ee.exports=function(S,M,e){var a={},n=e[M.subplot]._subplot,r=n.mockAxis,t=S.lonlat;return a.lonLabel=w.tickText(r,r.c2l(t[0]),!0).text,a.latLabel=w.tickText(r,r.c2l(t[1]),!0).text,a}},{"../../plots/cartesian/axes":566}],1007:[function(d,ee,te){var w=d("../../components/fx"),v=d("../../lib"),S=d("../scatter/get_trace_color"),M=v.fillText,e=d("../../constants/numerical").BADNUM;function a(r,t,c){var o=r.cd,i=o[0].trace,y=r.xa,p=r.ya,g=r.subplot,h=t>=0?Math.floor((t+180)/360):Math.ceil((t-180)/360),m=h*360,u=t-m;function _(k){var P=k.lonlat;if(P[0]===e)return 1/0;var z=v.modHalf(P[0],360),I=P[1],D=g.project([z,I]),R=D.x-y.c2p([u,I]),B=D.y-p.c2p([z,c]),F=Math.max(3,k.mrc||0);return Math.max(Math.sqrt(R*R+B*B)-F,1-3/F)}if(w.getClosest(o,_,r),r.index!==!1){var s=o[r.index],A=s.lonlat,b=[v.modHalf(A[0],360)+m,A[1]],f=y.c2p(b),x=p.c2p(b),l=s.mrc||1;r.x0=f-l,r.x1=f+l,r.y0=x-l,r.y1=x+l;var L={};L[i.subplot]={_subplot:g};var T=i._module.formatLabels(s,i,L);return r.lonLabel=T.lonLabel,r.latLabel=T.latLabel,r.color=S(i,s),r.extraText=n(i,s,o[0].t.labels),r.hovertemplate=i.hovertemplate,[r]}}function n(r,t,c){if(r.hovertemplate)return;var o=t.hi||r.hoverinfo,i=o.split("+"),y=i.indexOf("all")!==-1,p=i.indexOf("lon")!==-1,g=i.indexOf("lat")!==-1,h=t.lonlat,m=[];function u(_){return _+"\xB0"}return y||p&&g?m.push("("+u(h[1])+", "+u(h[0])+")"):p?m.push(c.lon+u(h[0])):g&&m.push(c.lat+u(h[1])),(y||i.indexOf("text")!==-1)&&M(t,r,m),m.join("<br>")}ee.exports={hoverPoints:a,getExtraText:n}},{"../../components/fx":407,"../../constants/numerical":491,"../../lib":515,"../scatter/get_trace_color":946}],1008:[function(d,ee,te){ee.exports={attributes:d("./attributes"),supplyDefaults:d("./defaults"),colorbar:d("../scatter/marker_colorbar"),formatLabels:d("./format_labels"),calc:d("../scattergeo/calc"),plot:d("./plot"),hoverPoints:d("./hover").hoverPoints,eventData:d("./event_data"),selectPoints:d("./select"),styleOnSelect:function(w,v){if(v){var S=v[0].trace;S._glTrace.update(v)}},moduleType:"trace",name:"scattermapbox",basePlotModule:d("../../plots/mapbox"),categories:["mapbox","gl","symbols","showLegend","scatter-like"],meta:{}}},{"../../plots/mapbox":622,"../scatter/marker_colorbar":954,"../scattergeo/calc":979,"./attributes":1002,"./defaults":1004,"./event_data":1005,"./format_labels":1006,"./hover":1007,"./plot":1009,"./select":1010}],1009:[function(d,ee,te){var w=d("./convert"),v=d("../../plots/mapbox/constants").traceLayerPrefix,S=["fill","line","circle","symbol"];function M(a,n){this.type="scattermapbox",this.subplot=a,this.uid=n,this.sourceIds={fill:"source-"+n+"-fill",line:"source-"+n+"-line",circle:"source-"+n+"-circle",symbol:"source-"+n+"-symbol"},this.layerIds={fill:v+n+"-fill",line:v+n+"-line",circle:v+n+"-circle",symbol:v+n+"-symbol"},this.below=null}var e=M.prototype;e.addSource=function(a,n){this.subplot.map.addSource(this.sourceIds[a],{type:"geojson",data:n.geojson})},e.setSourceData=function(a,n){this.subplot.map.getSource(this.sourceIds[a]).setData(n.geojson)},e.addLayer=function(a,n,r){this.subplot.addLayer({type:a,id:this.layerIds[a],source:this.sourceIds[a],layout:n.layout,paint:n.paint},r)},e.update=function(n){var r=this.subplot,t=r.map,c=w(r.gd,n),o=r.belowLookup["trace-"+this.uid],i,y,p;if(o!==this.below){for(i=S.length-1;i>=0;i--)y=S[i],t.removeLayer(this.layerIds[y]);for(i=0;i<S.length;i++)y=S[i],p=c[y],this.addLayer(y,p,o);this.below=o}for(i=0;i<S.length;i++)y=S[i],p=c[y],r.setOptions(this.layerIds[y],"setLayoutProperty",p.layout),p.layout.visibility==="visible"&&(this.setSourceData(y,p),r.setOptions(this.layerIds[y],"setPaintProperty",p.paint));n[0].trace._glTrace=this},e.dispose=function(){for(var n=this.subplot.map,r=S.length-1;r>=0;r--){var t=S[r];n.removeLayer(this.layerIds[t]),n.removeSource(this.sourceIds[t])}},ee.exports=function(n,r){for(var t=r[0].trace,c=new M(n,t.uid),o=w(n.gd,r),i=c.below=n.belowLookup["trace-"+t.uid],y=0;y<S.length;y++){var p=S[y],g=o[p];c.addSource(p,g),c.addLayer(p,g,i)}return r[0].trace._glTrace=c,c}},{"../../plots/mapbox/constants":620,"./convert":1003}],1010:[function(d,ee,te){var w=d("../../lib"),v=d("../scatter/subtypes"),S=d("../../constants/numerical").BADNUM;ee.exports=function(e,a){var n=e.cd,r=e.xaxis,t=e.yaxis,c=[],o=n[0].trace,i;if(!v.hasMarkers(o))return[];if(a===!1)for(i=0;i<n.length;i++)n[i].selected=0;else for(i=0;i<n.length;i++){var y=n[i],p=y.lonlat;if(p[0]!==S){var g=[w.modHalf(p[0],360),p[1]],h=[r.c2p(g),t.c2p(g)];a.contains(h,null,i,e)?(c.push({pointNumber:i,lon:p[0],lat:p[1]}),y.selected=1):y.selected=0}}return c}},{"../../constants/numerical":491,"../../lib":515,"../scatter/subtypes":961}],1011:[function(d,ee,te){var w=d("../../plots/template_attributes").hovertemplateAttrs,v=d("../../plots/template_attributes").texttemplateAttrs,S=d("../../lib/extend").extendFlat,M=d("../scatter/attributes"),e=d("../../plots/attributes"),a=M.line;ee.exports={mode:M.mode,r:{valType:"data_array",editType:"calc+clearAxisTypes"},theta:{valType:"data_array",editType:"calc+clearAxisTypes"},r0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},dr:{valType:"number",dflt:1,editType:"calc"},theta0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},dtheta:{valType:"number",editType:"calc"},thetaunit:{valType:"enumerated",values:["radians","degrees","gradians"],dflt:"degrees",editType:"calc+clearAxisTypes"},text:M.text,texttemplate:v({editType:"plot"},{keys:["r","theta","text"]}),hovertext:M.hovertext,line:{color:a.color,width:a.width,dash:a.dash,shape:S({},a.shape,{values:["linear","spline"]}),smoothing:a.smoothing,editType:"calc"},connectgaps:M.connectgaps,marker:M.marker,cliponaxis:S({},M.cliponaxis,{dflt:!1}),textposition:M.textposition,textfont:M.textfont,fill:S({},M.fill,{values:["none","toself","tonext"],dflt:"none"}),fillcolor:M.fillcolor,hoverinfo:S({},e.hoverinfo,{flags:["r","theta","text","name"]}),hoveron:M.hoveron,hovertemplate:w(),selected:M.selected,unselected:M.unselected}},{"../../lib/extend":505,"../../plots/attributes":562,"../../plots/template_attributes":642,"../scatter/attributes":936}],1012:[function(d,ee,te){var w=d("fast-isnumeric"),v=d("../../constants/numerical").BADNUM,S=d("../../plots/cartesian/axes"),M=d("../scatter/colorscale_calc"),e=d("../scatter/arrays_to_calcdata"),a=d("../scatter/calc_selection"),n=d("../scatter/calc").calcMarkerSize;ee.exports=function(t,c){for(var o=t._fullLayout,i=c.subplot,y=o[i].radialaxis,p=o[i].angularaxis,g=y.makeCalcdata(c,"r"),h=p.makeCalcdata(c,"theta"),m=c._length,u=new Array(m),_=0;_<m;_++){var s=g[_],A=h[_],b=u[_]={};w(s)&&w(A)?(b.r=s,b.theta=A):b.r=v}var f=n(c,m);return c._extremes.x=S.findExtremes(y,g,{ppad:f}),M(t,c),e(u,c),a(u,c),u}},{"../../constants/numerical":491,"../../plots/cartesian/axes":566,"../scatter/arrays_to_calcdata":935,"../scatter/calc":937,"../scatter/calc_selection":938,"../scatter/colorscale_calc":939,"fast-isnumeric":190}],1013:[function(d,ee,te){var w=d("../../lib"),v=d("../scatter/subtypes"),S=d("../scatter/marker_defaults"),M=d("../scatter/line_defaults"),e=d("../scatter/line_shape_defaults"),a=d("../scatter/text_defaults"),n=d("../scatter/fillcolor_defaults"),r=d("../scatter/constants").PTS_LINESONLY,t=d("./attributes");function c(i,y,p,g){function h(_,s){return w.coerce(i,y,t,_,s)}var m=o(i,y,g,h);if(!m){y.visible=!1;return}h("thetaunit"),h("mode",m<r?"lines+markers":"lines"),h("text"),h("hovertext"),y.hoveron!=="fills"&&h("hovertemplate"),v.hasLines(y)&&(M(i,y,p,g,h),e(i,y,h),h("connectgaps")),v.hasMarkers(y)&&S(i,y,p,g,h,{gradient:!0}),v.hasText(y)&&(h("texttemplate"),a(i,y,g,h));var u=[];(v.hasMarkers(y)||v.hasText(y))&&(h("cliponaxis"),h("marker.maxdisplayed"),u.push("points")),h("fill"),y.fill!=="none"&&(n(i,y,p,h),v.hasLines(y)||e(i,y,h)),(y.fill==="tonext"||y.fill==="toself")&&u.push("fills"),h("hoveron",u.join("+")||"points"),w.coerceSelectionMarkerOpacity(y,h)}function o(i,y,p,g){var h=g("r"),m=g("theta"),u;if(h)m?u=Math.min(h.length,m.length):(u=h.length,g("theta0"),g("dtheta"));else{if(!m)return 0;u=y.theta.length,g("r0"),g("dr")}return y._length=u,u}ee.exports={handleRThetaDefaults:o,supplyDefaults:c}},{"../../lib":515,"../scatter/constants":940,"../scatter/fillcolor_defaults":944,"../scatter/line_defaults":949,"../scatter/line_shape_defaults":951,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scatter/text_defaults":962,"./attributes":1011}],1014:[function(d,ee,te){var w=d("../../lib"),v=d("../../plots/cartesian/axes");ee.exports=function(M,e,a){var n={},r=a[e.subplot]._subplot,t,c;r?(t=r.radialAxis,c=r.angularAxis):(r=a[e.subplot],t=r.radialaxis,c=r.angularaxis);var o=t.c2l(M.r);n.rLabel=v.tickText(t,o,!0).text;var i=c.thetaunit==="degrees"?w.rad2deg(M.theta):M.theta;return n.thetaLabel=v.tickText(c,i,!0).text,n}},{"../../lib":515,"../../plots/cartesian/axes":566}],1015:[function(d,ee,te){var w=d("../scatter/hover");function v(M,e,a,n){var r=w(M,e,a,n);if(!(!r||r[0].index===!1)){var t=r[0];if(t.index===void 0)return r;var c=M.subplot,o=t.cd[t.index],i=t.trace;if(!!c.isPtInside(o))return t.xLabelVal=void 0,t.yLabelVal=void 0,S(o,i,c,t),t.hovertemplate=i.hovertemplate,r}}function S(M,e,a,n){var r=a.radialAxis,t=a.angularAxis;r._hovertitle="r",t._hovertitle="\u03B8";var c={};c[e.subplot]={_subplot:a};var o=e._module.formatLabels(M,e,c);n.rLabel=o.rLabel,n.thetaLabel=o.thetaLabel;var i=M.hi||e.hoverinfo,y=[];function p(h,m){y.push(h._hovertitle+": "+m)}if(!e.hovertemplate){var g=i.split("+");g.indexOf("all")!==-1&&(g=["r","theta","text"]),g.indexOf("r")!==-1&&p(r,n.rLabel),g.indexOf("theta")!==-1&&p(t,n.thetaLabel),g.indexOf("text")!==-1&&n.text&&(y.push(n.text),delete n.text),n.extraText=y.join("<br>")}}ee.exports={hoverPoints:v,makeHoverPointText:S}},{"../scatter/hover":947}],1016:[function(d,ee,te){ee.exports={moduleType:"trace",name:"scatterpolar",basePlotModule:d("../../plots/polar"),categories:["polar","symbols","showLegend","scatter-like"],attributes:d("./attributes"),supplyDefaults:d("./defaults").supplyDefaults,colorbar:d("../scatter/marker_colorbar"),formatLabels:d("./format_labels"),calc:d("./calc"),plot:d("./plot"),style:d("../scatter/style").style,styleOnSelect:d("../scatter/style").styleOnSelect,hoverPoints:d("./hover").hoverPoints,selectPoints:d("../scatter/select"),meta:{}}},{"../../plots/polar":631,"../scatter/marker_colorbar":954,"../scatter/select":958,"../scatter/style":960,"./attributes":1011,"./calc":1012,"./defaults":1013,"./format_labels":1014,"./hover":1015,"./plot":1017}],1017:[function(d,ee,te){var w=d("../scatter/plot"),v=d("../../constants/numerical").BADNUM;ee.exports=function(M,e,a){for(var n=e.layers.frontplot.select("g.scatterlayer"),r={xaxis:e.xaxis,yaxis:e.yaxis,plot:e.framework,layerClipId:e._hasClipOnAxisFalse?e.clipIds.forTraces:null},t=e.radialAxis,c=e.angularAxis,o=0;o<a.length;o++)for(var i=a[o],y=0;y<i.length;y++){var p=i[y],g=p.r;if(g===v)p.x=p.y=v;else{var h=t.c2g(g),m=c.c2g(p.theta);p.x=h*Math.cos(m),p.y=h*Math.sin(m)}}w(M,r,a,n)}},{"../../constants/numerical":491,"../scatter/plot":957}],1018:[function(d,ee,te){var w=d("../scatterpolar/attributes"),v=d("../scattergl/attributes"),S=d("../../plots/template_attributes").texttemplateAttrs;ee.exports={mode:w.mode,r:w.r,theta:w.theta,r0:w.r0,dr:w.dr,theta0:w.theta0,dtheta:w.dtheta,thetaunit:w.thetaunit,text:w.text,texttemplate:S({editType:"plot"},{keys:["r","theta","text"]}),hovertext:w.hovertext,hovertemplate:w.hovertemplate,line:v.line,connectgaps:v.connectgaps,marker:v.marker,fill:v.fill,fillcolor:v.fillcolor,textposition:v.textposition,textfont:v.textfont,hoverinfo:w.hoverinfo,selected:w.selected,unselected:w.unselected}},{"../../plots/template_attributes":642,"../scattergl/attributes":988,"../scatterpolar/attributes":1011}],1019:[function(d,ee,te){ee.exports={moduleType:"trace",name:"scatterpolargl",basePlotModule:d("../../plots/polar"),categories:["gl","regl","polar","symbols","showLegend","scatter-like"],attributes:d("./attributes"),supplyDefaults:d("./defaults"),colorbar:d("../scatter/marker_colorbar"),formatLabels:d("./format_labels"),calc:d("./calc"),hoverPoints:d("./hover").hoverPoints,selectPoints:d("../scattergl/select"),meta:{}}},{"../../plots/polar":631,"../scatter/marker_colorbar":954,"../scattergl/select":1001,"./attributes":1018,"./calc":1020,"./defaults":1021,"./format_labels":1022,"./hover":1023}],1020:[function(d,ee,te){var w=d("../scatter/colorscale_calc"),v=d("../scatter/calc").calcMarkerSize,S=d("../scattergl/convert"),M=d("../../plots/cartesian/axes"),e=d("../scattergl/constants").TOO_MANY_POINTS;ee.exports=function(n,r){var t=n._fullLayout,c=r.subplot,o=t[c].radialaxis,i=t[c].angularaxis,y=r._r=o.makeCalcdata(r,"r"),p=r._theta=i.makeCalcdata(r,"theta"),g=r._length,h={};g<y.length&&(y=y.slice(0,g)),g<p.length&&(p=p.slice(0,g)),h.r=y,h.theta=p,w(n,r);var m=h.opts=S.style(n,r),u;return g<e?u=v(r,g):m.marker&&(u=2*(m.marker.sizeAvg||Math.max(m.marker.size,3))),r._extremes.x=M.findExtremes(o,y,{ppad:u}),[{x:!1,y:!1,t:h,trace:r}]}},{"../../plots/cartesian/axes":566,"../scatter/calc":937,"../scatter/colorscale_calc":939,"../scattergl/constants":991,"../scattergl/convert":992}],1021:[function(d,ee,te){var w=d("../../lib"),v=d("../scatter/subtypes"),S=d("../scatterpolar/defaults").handleRThetaDefaults,M=d("../scatter/marker_defaults"),e=d("../scatter/line_defaults"),a=d("../scatter/text_defaults"),n=d("../scatter/fillcolor_defaults"),r=d("../scatter/constants").PTS_LINESONLY,t=d("./attributes");ee.exports=function(o,i,y,p){function g(m,u){return w.coerce(o,i,t,m,u)}var h=S(o,i,p,g);if(!h){i.visible=!1;return}g("thetaunit"),g("mode",h<r?"lines+markers":"lines"),g("text"),g("hovertext"),i.hoveron!=="fills"&&g("hovertemplate"),v.hasLines(i)&&(e(o,i,y,p,g),g("connectgaps")),v.hasMarkers(i)&&M(o,i,y,p,g),v.hasText(i)&&(g("texttemplate"),a(o,i,p,g)),g("fill"),i.fill!=="none"&&n(o,i,y,g),w.coerceSelectionMarkerOpacity(i,g)}},{"../../lib":515,"../scatter/constants":940,"../scatter/fillcolor_defaults":944,"../scatter/line_defaults":949,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scatter/text_defaults":962,"../scatterpolar/defaults":1013,"./attributes":1018}],1022:[function(d,ee,te){var w=d("../scatterpolar/format_labels");ee.exports=function(S,M,e){var a=S.i;return"r"in S||(S.r=M._r[a]),"theta"in S||(S.theta=M._theta[a]),w(S,M,e)}},{"../scatterpolar/format_labels":1014}],1023:[function(d,ee,te){var w=d("../scattergl/hover"),v=d("../scatterpolar/hover").makeHoverPointText;function S(M,e,a,n){var r=M.cd,t=r[0].t,c=t.r,o=t.theta,i=w.hoverPoints(M,e,a,n);if(!(!i||i[0].index===!1)){var y=i[0];if(y.index===void 0)return i;var p=M.subplot,g=y.cd[y.index],h=y.trace;if(g.r=c[y.index],g.theta=o[y.index],!!p.isPtInside(g))return y.xLabelVal=void 0,y.yLabelVal=void 0,v(g,h,p,y),i}}ee.exports={hoverPoints:S}},{"../scattergl/hover":997,"../scatterpolar/hover":1015}],1024:[function(d,ee,te){arguments[4][905][0].apply(te,arguments)},{"./base_index":1019,"./plot":1025,dup:905}],1025:[function(d,ee,te){var w=d("@plotly/point-cluster"),v=d("fast-isnumeric"),S=d("../scattergl/plot"),M=d("../scattergl/scene_update"),e=d("../scattergl/convert"),a=d("../../lib"),n=d("../scattergl/constants").TOO_MANY_POINTS,r={};ee.exports=function(c,o,i){if(!!i.length){var y=o.radialAxis,p=o.angularAxis,g=M(c,o);return i.forEach(function(h){if(!(!h||!h[0]||!h[0].trace)){var m=h[0],u=m.trace,_=m.t,s=u._length,A=_.r,b=_.theta,f=_.opts,x,l=A.slice(),L=b.slice();for(x=0;x<A.length;x++)o.isPtInside({r:A[x],theta:b[x]})||(l[x]=NaN,L[x]=NaN);var T=new Array(s*2),k=Array(s),P=Array(s);for(x=0;x<s;x++){var z=l[x],I,D;if(v(z)){var R=y.c2g(z),B=p.c2g(L[x],u.thetaunit);I=R*Math.cos(B),D=R*Math.sin(B)}else I=D=NaN;k[x]=T[x*2]=I,P[x]=T[x*2+1]=D}_.tree=w(T),f.marker&&s>=n&&(f.marker.cluster=_.tree),f.marker&&(f.markerSel.positions=f.markerUnsel.positions=f.marker.positions=T),f.line&&T.length>1&&a.extendFlat(f.line,e.linePositions(c,u,T)),f.text&&(a.extendFlat(f.text,{positions:T},e.textPosition(c,u,f.text,f.marker)),a.extendFlat(f.textSel,{positions:T},e.textPosition(c,u,f.text,f.markerSel)),a.extendFlat(f.textUnsel,{positions:T},e.textPosition(c,u,f.text,f.markerUnsel))),f.fill&&!g.fill2d&&(g.fill2d=!0),f.marker&&!g.scatter2d&&(g.scatter2d=!0),f.line&&!g.line2d&&(g.line2d=!0),f.text&&!g.glText&&(g.glText=!0),g.lineOptions.push(f.line),g.fillOptions.push(f.fill),g.markerOptions.push(f.marker),g.markerSelectedOptions.push(f.markerSel),g.markerUnselectedOptions.push(f.markerUnsel),g.textOptions.push(f.text),g.textSelectedOptions.push(f.textSel),g.textUnselectedOptions.push(f.textUnsel),g.selectBatch.push([]),g.unselectBatch.push([]),_.x=k,_.y=P,_.rawx=k,_.rawy=P,_.r=A,_.theta=b,_.positions=T,_._scene=g,_.index=g.count,g.count++}}),S(c,o,i)}},ee.exports.reglPrecompiled=r},{"../../lib":515,"../scattergl/constants":991,"../scattergl/convert":992,"../scattergl/plot":999,"../scattergl/scene_update":1e3,"@plotly/point-cluster":59,"fast-isnumeric":190}],1026:[function(d,ee,te){var w=d("../../plots/template_attributes").hovertemplateAttrs,v=d("../../plots/template_attributes").texttemplateAttrs,S=d("../../lib/extend").extendFlat,M=d("../scatter/attributes"),e=d("../../plots/attributes"),a=M.line;ee.exports={mode:M.mode,real:{valType:"data_array",editType:"calc+clearAxisTypes"},imag:{valType:"data_array",editType:"calc+clearAxisTypes"},text:M.text,texttemplate:v({editType:"plot"},{keys:["real","imag","text"]}),hovertext:M.hovertext,line:{color:a.color,width:a.width,dash:a.dash,shape:S({},a.shape,{values:["linear","spline"]}),smoothing:a.smoothing,editType:"calc"},connectgaps:M.connectgaps,marker:M.marker,cliponaxis:S({},M.cliponaxis,{dflt:!1}),textposition:M.textposition,textfont:M.textfont,fill:S({},M.fill,{values:["none","toself","tonext"],dflt:"none"}),fillcolor:M.fillcolor,hoverinfo:S({},e.hoverinfo,{flags:["real","imag","text","name"]}),hoveron:M.hoveron,hovertemplate:w(),selected:M.selected,unselected:M.unselected}},{"../../lib/extend":505,"../../plots/attributes":562,"../../plots/template_attributes":642,"../scatter/attributes":936}],1027:[function(d,ee,te){var w=d("fast-isnumeric"),v=d("../../constants/numerical").BADNUM,S=d("../scatter/colorscale_calc"),M=d("../scatter/arrays_to_calcdata"),e=d("../scatter/calc_selection"),a=d("../scatter/calc").calcMarkerSize;ee.exports=function(r,t){for(var c=r._fullLayout,o=t.subplot,i=c[o].realaxis,y=c[o].imaginaryaxis,p=i.makeCalcdata(t,"real"),g=y.makeCalcdata(t,"imag"),h=t._length,m=new Array(h),u=0;u<h;u++){var _=p[u],s=g[u],A=m[u]={};w(_)&&w(s)?(A.real=_,A.imag=s):A.real=v}return a(t,h),S(r,t),M(m,t),e(m,t),m}},{"../../constants/numerical":491,"../scatter/arrays_to_calcdata":935,"../scatter/calc":937,"../scatter/calc_selection":938,"../scatter/colorscale_calc":939,"fast-isnumeric":190}],1028:[function(d,ee,te){var w=d("../../lib"),v=d("../scatter/subtypes"),S=d("../scatter/marker_defaults"),M=d("../scatter/line_defaults"),e=d("../scatter/line_shape_defaults"),a=d("../scatter/text_defaults"),n=d("../scatter/fillcolor_defaults"),r=d("../scatter/constants").PTS_LINESONLY,t=d("./attributes");ee.exports=function(i,y,p,g){function h(_,s){return w.coerce(i,y,t,_,s)}var m=c(i,y,g,h);if(!m){y.visible=!1;return}h("mode",m<r?"lines+markers":"lines"),h("text"),h("hovertext"),y.hoveron!=="fills"&&h("hovertemplate"),v.hasLines(y)&&(M(i,y,p,g,h),e(i,y,h),h("connectgaps")),v.hasMarkers(y)&&S(i,y,p,g,h,{gradient:!0}),v.hasText(y)&&(h("texttemplate"),a(i,y,g,h));var u=[];(v.hasMarkers(y)||v.hasText(y))&&(h("cliponaxis"),h("marker.maxdisplayed"),u.push("points")),h("fill"),y.fill!=="none"&&(n(i,y,p,h),v.hasLines(y)||e(i,y,h)),(y.fill==="tonext"||y.fill==="toself")&&u.push("fills"),h("hoveron",u.join("+")||"points"),w.coerceSelectionMarkerOpacity(y,h)};function c(o,i,y,p){var g=p("real"),h=p("imag"),m;return g&&h&&(m=Math.min(g.length,h.length)),i._length=m,m}},{"../../lib":515,"../scatter/constants":940,"../scatter/fillcolor_defaults":944,"../scatter/line_defaults":949,"../scatter/line_shape_defaults":951,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scatter/text_defaults":962,"./attributes":1026}],1029:[function(d,ee,te){var w=d("../../plots/cartesian/axes");ee.exports=function(S,M,e){var a={},n=e[M.subplot]._subplot;return a.realLabel=w.tickText(n.radialAxis,S.real,!0).text,a.imagLabel=w.tickText(n.angularAxis,S.imag,!0).text,a}},{"../../plots/cartesian/axes":566}],1030:[function(d,ee,te){var w=d("../scatter/hover");function v(M,e,a,n){var r=w(M,e,a,n);if(!(!r||r[0].index===!1)){var t=r[0];if(t.index===void 0)return r;var c=M.subplot,o=t.cd[t.index],i=t.trace;if(!!c.isPtInside(o))return t.xLabelVal=void 0,t.yLabelVal=void 0,S(o,i,c,t),t.hovertemplate=i.hovertemplate,r}}function S(M,e,a,n){var r=a.radialAxis,t=a.angularAxis;r._hovertitle="real",t._hovertitle="imag";var c={};c[e.subplot]={_subplot:a};var o=e._module.formatLabels(M,e,c);n.realLabel=o.realLabel,n.imagLabel=o.imagLabel;var i=M.hi||e.hoverinfo,y=[];function p(h,m){y.push(h._hovertitle+": "+m)}if(!e.hovertemplate){var g=i.split("+");g.indexOf("all")!==-1&&(g=["real","imag","text"]),g.indexOf("real")!==-1&&p(r,n.realLabel),g.indexOf("imag")!==-1&&p(t,n.imagLabel),g.indexOf("text")!==-1&&n.text&&(y.push(n.text),delete n.text),n.extraText=y.join("<br>")}}ee.exports={hoverPoints:v,makeHoverPointText:S}},{"../scatter/hover":947}],1031:[function(d,ee,te){ee.exports={moduleType:"trace",name:"scattersmith",basePlotModule:d("../../plots/smith"),categories:["smith","symbols","showLegend","scatter-like"],attributes:d("./attributes"),supplyDefaults:d("./defaults"),colorbar:d("../scatter/marker_colorbar"),formatLabels:d("./format_labels"),calc:d("./calc"),plot:d("./plot"),style:d("../scatter/style").style,styleOnSelect:d("../scatter/style").styleOnSelect,hoverPoints:d("./hover").hoverPoints,selectPoints:d("../scatter/select"),meta:{}}},{"../../plots/smith":638,"../scatter/marker_colorbar":954,"../scatter/select":958,"../scatter/style":960,"./attributes":1026,"./calc":1027,"./defaults":1028,"./format_labels":1029,"./hover":1030,"./plot":1032}],1032:[function(d,ee,te){var w=d("../scatter/plot"),v=d("../../constants/numerical").BADNUM,S=d("../../plots/smith/helpers"),M=S.smith;ee.exports=function(a,n,r){for(var t=n.layers.frontplot.select("g.scatterlayer"),c={xaxis:n.xaxis,yaxis:n.yaxis,plot:n.framework,layerClipId:n._hasClipOnAxisFalse?n.clipIds.forTraces:null},o=0;o<r.length;o++)for(var i=r[o],y=0;y<i.length;y++){var p=i[y],g=p.real;if(g===v)p.x=p.y=v;else{var h=M([g,p.imag]);p.x=h[0],p.y=h[1]}}w(a,c,r,t)}},{"../../constants/numerical":491,"../../plots/smith/helpers":637,"../scatter/plot":957}],1033:[function(d,ee,te){var w=d("../../plots/template_attributes").hovertemplateAttrs,v=d("../../plots/template_attributes").texttemplateAttrs,S=d("../scatter/attributes"),M=d("../../plots/attributes"),e=d("../../components/colorscale/attributes"),a=d("../../components/drawing/attributes").dash,n=d("../../lib/extend").extendFlat,r=S.marker,t=S.line,c=r.line;ee.exports={a:{valType:"data_array",editType:"calc"},b:{valType:"data_array",editType:"calc"},c:{valType:"data_array",editType:"calc"},sum:{valType:"number",dflt:0,min:0,editType:"calc"},mode:n({},S.mode,{dflt:"markers"}),text:n({},S.text,{}),texttemplate:v({editType:"plot"},{keys:["a","b","c","text"]}),hovertext:n({},S.hovertext,{}),line:{color:t.color,width:t.width,dash:a,shape:n({},t.shape,{values:["linear","spline"]}),smoothing:t.smoothing,editType:"calc"},connectgaps:S.connectgaps,cliponaxis:S.cliponaxis,fill:n({},S.fill,{values:["none","toself","tonext"],dflt:"none"}),fillcolor:S.fillcolor,marker:n({symbol:r.symbol,opacity:r.opacity,maxdisplayed:r.maxdisplayed,size:r.size,sizeref:r.sizeref,sizemin:r.sizemin,sizemode:r.sizemode,line:n({width:c.width,editType:"calc"},e("marker.line")),gradient:r.gradient,editType:"calc"},e("marker")),textfont:S.textfont,textposition:S.textposition,selected:S.selected,unselected:S.unselected,hoverinfo:n({},M.hoverinfo,{flags:["a","b","c","text","name"]}),hoveron:S.hoveron,hovertemplate:w()}},{"../../components/colorscale/attributes":374,"../../components/drawing/attributes":388,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/template_attributes":642,"../scatter/attributes":936}],1034:[function(d,ee,te){var w=d("fast-isnumeric"),v=d("../scatter/colorscale_calc"),S=d("../scatter/arrays_to_calcdata"),M=d("../scatter/calc_selection"),e=d("../scatter/calc").calcMarkerSize,a=["a","b","c"],n={a:["b","c"],b:["a","c"],c:["a","b"]};ee.exports=function(t,c){var o=t._fullLayout[c.subplot],i=o.sum,y=c.sum||i,p={a:c.a,b:c.b,c:c.c},g,h,m,u,_,s;for(g=0;g<a.length;g++)if(m=a[g],!p[m]){for(_=p[n[m][0]],s=p[n[m][1]],u=new Array(_.length),h=0;h<_.length;h++)u[h]=y-_[h]-s[h];p[m]=u}var A=c._length,b=new Array(A),f,x,l,L,T,k;for(g=0;g<A;g++)f=p.a[g],x=p.b[g],l=p.c[g],w(f)&&w(x)&&w(l)?(f=+f,x=+x,l=+l,L=i/(f+x+l),L!==1&&(f*=L,x*=L,l*=L),k=f,T=l-x,b[g]={x:T,y:k,a:f,b:x,c:l}):b[g]={x:!1,y:!1};return e(c,A),v(t,c),S(b,c),M(b,c),b}},{"../scatter/arrays_to_calcdata":935,"../scatter/calc":937,"../scatter/calc_selection":938,"../scatter/colorscale_calc":939,"fast-isnumeric":190}],1035:[function(d,ee,te){var w=d("../../lib"),v=d("../scatter/constants"),S=d("../scatter/subtypes"),M=d("../scatter/marker_defaults"),e=d("../scatter/line_defaults"),a=d("../scatter/line_shape_defaults"),n=d("../scatter/text_defaults"),r=d("../scatter/fillcolor_defaults"),t=d("./attributes");ee.exports=function(o,i,y,p){function g(b,f){return w.coerce(o,i,t,b,f)}var h=g("a"),m=g("b"),u=g("c"),_;if(h?(_=h.length,m?(_=Math.min(_,m.length),u&&(_=Math.min(_,u.length))):u?_=Math.min(_,u.length):_=0):m&&u&&(_=Math.min(m.length,u.length)),!_){i.visible=!1;return}i._length=_,g("sum"),g("text"),g("hovertext"),i.hoveron!=="fills"&&g("hovertemplate");var s=_<v.PTS_LINESONLY?"lines+markers":"lines";g("mode",s),S.hasLines(i)&&(e(o,i,y,p,g),a(o,i,g),g("connectgaps")),S.hasMarkers(i)&&M(o,i,y,p,g,{gradient:!0}),S.hasText(i)&&(g("texttemplate"),n(o,i,p,g));var A=[];(S.hasMarkers(i)||S.hasText(i))&&(g("cliponaxis"),g("marker.maxdisplayed"),A.push("points")),g("fill"),i.fill!=="none"&&(r(o,i,y,g),S.hasLines(i)||a(o,i,g)),(i.fill==="tonext"||i.fill==="toself")&&A.push("fills"),g("hoveron",A.join("+")||"points"),w.coerceSelectionMarkerOpacity(i,g)}},{"../../lib":515,"../scatter/constants":940,"../scatter/fillcolor_defaults":944,"../scatter/line_defaults":949,"../scatter/line_shape_defaults":951,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scatter/text_defaults":962,"./attributes":1033}],1036:[function(d,ee,te){ee.exports=function(v,S,M,e,a){if(S.xa&&(v.xaxis=S.xa),S.ya&&(v.yaxis=S.ya),e[a]){var n=e[a];v.a=n.a,v.b=n.b,v.c=n.c}else v.a=S.a,v.b=S.b,v.c=S.c;return v}},{}],1037:[function(d,ee,te){var w=d("../../plots/cartesian/axes");ee.exports=function(S,M,e){var a={},n=e[M.subplot]._subplot;return a.aLabel=w.tickText(n.aaxis,S.a,!0).text,a.bLabel=w.tickText(n.baxis,S.b,!0).text,a.cLabel=w.tickText(n.caxis,S.c,!0).text,a}},{"../../plots/cartesian/axes":566}],1038:[function(d,ee,te){var w=d("../scatter/hover");ee.exports=function(S,M,e,a){var n=w(S,M,e,a);if(!n||n[0].index===!1)return;var r=n[0];if(r.index===void 0){var t=1-r.y0/S.ya._length,c=S.xa._length,o=c*t/2,i=c-o;return r.x0=Math.max(Math.min(r.x0,i),o),r.x1=Math.max(Math.min(r.x1,i),o),n}var y=r.cd[r.index],p=r.trace,g=r.subplot;r.a=y.a,r.b=y.b,r.c=y.c,r.xLabelVal=void 0,r.yLabelVal=void 0;var h={};h[p.subplot]={_subplot:g};var m=p._module.formatLabels(y,p,h);r.aLabel=m.aLabel,r.bLabel=m.bLabel,r.cLabel=m.cLabel;var u=y.hi||p.hoverinfo,_=[];function s(b,f){_.push(b._hovertitle+": "+f)}if(!p.hovertemplate){var A=u.split("+");A.indexOf("all")!==-1&&(A=["a","b","c"]),A.indexOf("a")!==-1&&s(g.aaxis,r.aLabel),A.indexOf("b")!==-1&&s(g.baxis,r.bLabel),A.indexOf("c")!==-1&&s(g.caxis,r.cLabel)}return r.extraText=_.join("<br>"),r.hovertemplate=p.hovertemplate,n}},{"../scatter/hover":947}],1039:[function(d,ee,te){ee.exports={attributes:d("./attributes"),supplyDefaults:d("./defaults"),colorbar:d("../scatter/marker_colorbar"),formatLabels:d("./format_labels"),calc:d("./calc"),plot:d("./plot"),style:d("../scatter/style").style,styleOnSelect:d("../scatter/style").styleOnSelect,hoverPoints:d("./hover"),selectPoints:d("../scatter/select"),eventData:d("./event_data"),moduleType:"trace",name:"scatterternary",basePlotModule:d("../../plots/ternary"),categories:["ternary","symbols","showLegend","scatter-like"],meta:{}}},{"../../plots/ternary":643,"../scatter/marker_colorbar":954,"../scatter/select":958,"../scatter/style":960,"./attributes":1033,"./calc":1034,"./defaults":1035,"./event_data":1036,"./format_labels":1037,"./hover":1038,"./plot":1040}],1040:[function(d,ee,te){var w=d("../scatter/plot");ee.exports=function(S,M,e){var a=M.plotContainer;a.select(".scatterlayer").selectAll("*").remove();var n={xaxis:M.xaxis,yaxis:M.yaxis,plot:a,layerClipId:M._hasClipOnAxisFalse?M.clipIdRelative:null},r=M.layers.frontplot.select("g.scatterlayer");w(S,n,e,r)}},{"../scatter/plot":957}],1041:[function(d,ee,te){var w=d("../scatter/attributes"),v=d("../../components/colorscale/attributes"),S=d("../../plots/cartesian/axis_format_attributes").axisHoverFormat,M=d("../../plots/template_attributes").hovertemplateAttrs,e=d("../scattergl/attributes"),a=d("../../plots/cartesian/constants").idRegex,n=d("../../plot_api/plot_template").templatedArray,r=d("../../lib/extend").extendFlat,t=w.marker,c=t.line,o=r(v("marker.line",{editTypeOverride:"calc"}),{width:r({},c.width,{editType:"calc"}),editType:"calc"}),i=r(v("marker"),{symbol:t.symbol,size:r({},t.size,{editType:"markerSize"}),sizeref:t.sizeref,sizemin:t.sizemin,sizemode:t.sizemode,opacity:t.opacity,colorbar:t.colorbar,line:o,editType:"calc"});i.color.editType=i.cmin.editType=i.cmax.editType="style";function y(p){return{valType:"info_array",freeLength:!0,editType:"calc",items:{valType:"subplotid",regex:a[p],editType:"plot"}}}ee.exports={dimensions:n("dimension",{visible:{valType:"boolean",dflt:!0,editType:"calc"},label:{valType:"string",editType:"calc"},values:{valType:"data_array",editType:"calc+clearAxisTypes"},axis:{type:{valType:"enumerated",values:["linear","log","date","category"],editType:"calc+clearAxisTypes"},matches:{valType:"boolean",dflt:!1,editType:"calc"},editType:"calc+clearAxisTypes"},editType:"calc+clearAxisTypes"}),text:r({},e.text,{}),hovertext:r({},e.hovertext,{}),hovertemplate:M(),xhoverformat:S("x"),yhoverformat:S("y"),marker:i,xaxes:y("x"),yaxes:y("y"),diagonal:{visible:{valType:"boolean",dflt:!0,editType:"calc"},editType:"calc"},showupperhalf:{valType:"boolean",dflt:!0,editType:"calc"},showlowerhalf:{valType:"boolean",dflt:!0,editType:"calc"},selected:{marker:e.selected.marker,editType:"calc"},unselected:{marker:e.unselected.marker,editType:"calc"},opacity:e.opacity}},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plot_api/plot_template":555,"../../plots/cartesian/axis_format_attributes":569,"../../plots/cartesian/constants":573,"../../plots/template_attributes":642,"../scatter/attributes":936,"../scattergl/attributes":988}],1042:[function(d,ee,te){var w=d("../../registry"),v=d("../../components/grid");ee.exports={moduleType:"trace",name:"splom",categories:["gl","regl","cartesian","symbols","showLegend","scatter-like"],attributes:d("./attributes"),supplyDefaults:d("./defaults"),colorbar:d("../scatter/marker_colorbar"),calc:d("./calc"),plot:d("./plot"),hoverPoints:d("./hover").hoverPoints,selectPoints:d("./select"),editStyle:d("./edit_style"),meta:{}},w.register(v)},{"../../components/grid":411,"../../registry":647,"../scatter/marker_colorbar":954,"./attributes":1041,"./calc":1044,"./defaults":1045,"./edit_style":1046,"./hover":1048,"./plot":1050,"./select":1052}],1043:[function(d,ee,te){var w=d("regl-line2d"),v=d("../../registry"),S=d("../../lib/prepare_regl"),M=d("../../plots/get_data").getModuleCalcData,e=d("../../plots/cartesian"),a=d("../../plots/cartesian/axis_ids").getFromId,n=d("../../plots/cartesian/axes").shouldShowZeroLine,r="splom",t={};function c(h){var m=h._fullLayout,u=v.getModule(r),_=M(h.calcdata,u)[0],s=S(h,["ANGLE_instanced_arrays","OES_element_index_uint"],t);!s||(m._hasOnlyLargeSploms&&y(h),u.plot(h,{},_))}function o(h){var m=h.calcdata,u=h._fullLayout;u._hasOnlyLargeSploms&&y(h);for(var _=0;_<m.length;_++){var s=m[_][0],A=s.trace,b=u._splomScenes[A.uid];A.type==="splom"&&b&&b.matrix&&i(h,A,b)}}function i(h,m,u){for(var _=u.matrixOptions.data.length,s=m._visibleDims,A=u.viewOpts.ranges=new Array(_),b=0;b<s.length;b++){var f=s[b],x=A[b]=new Array(4),l=a(h,m._diag[f][0]);l&&(x[0]=l.r2l(l.range[0]),x[2]=l.r2l(l.range[1]));var L=a(h,m._diag[f][1]);L&&(x[1]=L.r2l(L.range[0]),x[3]=L.r2l(L.range[1]))}u.selectBatch.length||u.unselectBatch.length?u.matrix.update({ranges:A},{ranges:A}):u.matrix.update({ranges:A})}function y(h){var m=h._fullLayout,u=m._glcanvas.data()[0].regl,_=m._splomGrid;_||(_=m._splomGrid=w(u)),_.update(p(h))}function p(h){var m=h._context.plotGlPixelRatio,u=h._fullLayout,_=u._size,s=[0,0,u.width*m,u.height*m],A={},b;function f(J,X,Y,Z,oe,re){Y*=m,Z*=m,oe*=m,re*=m;var se=X[J+"color"],N=X[J+"width"],U=String(se+N);U in A?A[U].data.push(NaN,NaN,Y,Z,oe,re):A[U]={data:[Y,Z,oe,re],join:"rect",thickness:N*m,color:se,viewport:s,range:s,overlay:!1}}for(b in u._splomSubplots){var x=u._plots[b],l=x.xaxis,L=x.yaxis,T=l._gridVals,k=L._gridVals,P=l._offset,z=l._length,I=L._length,D=_.b+L.domain[0]*_.h,R=-L._m,B=-R*L.r2l(L.range[0],L.calendar),F,H;if(l.showgrid)for(b=0;b<T.length;b++)F=P+l.l2p(T[b].x),f("grid",l,F,D,F,D+I);if(L.showgrid)for(b=0;b<k.length;b++)H=D+B+R*k[b].x,f("grid",L,P,H,P+z,H);n(h,l,L)&&(F=P+l.l2p(0),f("zeroline",l,F,D,F,D+I)),n(h,L,l)&&(H=D+B+0,f("zeroline",L,P,H,P+z,H))}var G=[];for(b in A)G.push(A[b]);return G}function g(h,m,u,_){var s={},A;if(_._splomScenes){for(A=0;A<h.length;A++){var b=h[A];b.type==="splom"&&(s[b.uid]=1)}for(A=0;A<u.length;A++){var f=u[A];if(!s[f.uid]){var x=_._splomScenes[f.uid];x&&x.destroy&&x.destroy(),_._splomScenes[f.uid]=null,delete _._splomScenes[f.uid]}}}Object.keys(_._splomScenes||{}).length===0&&delete _._splomScenes,_._splomGrid&&!m._hasOnlyLargeSploms&&_._hasOnlyLargeSploms&&(_._splomGrid.destroy(),_._splomGrid=null,delete _._splomGrid),e.clean(h,m,u,_)}ee.exports={name:r,attr:e.attr,attrRegex:e.attrRegex,layoutAttributes:e.layoutAttributes,supplyLayoutDefaults:e.supplyLayoutDefaults,drawFramework:e.drawFramework,plot:c,drag:o,updateGrid:y,clean:g,updateFx:e.updateFx,toSVG:e.toSVG,reglPrecompiled:t}},{"../../lib/prepare_regl":528,"../../plots/cartesian":578,"../../plots/cartesian/axes":566,"../../plots/cartesian/axis_ids":570,"../../plots/get_data":602,"../../registry":647,"regl-line2d":281}],1044:[function(d,ee,te){var w=d("../../lib"),v=d("../../plots/cartesian/axis_ids"),S=d("../scatter/calc").calcMarkerSize,M=d("../scatter/calc").calcAxisExpansion,e=d("../scatter/colorscale_calc"),a=d("../scattergl/convert").markerSelection,n=d("../scattergl/convert").markerStyle,r=d("./scene_update"),t=d("../../constants/numerical").BADNUM,c=d("../scattergl/constants").TOO_MANY_POINTS;ee.exports=function(i,y){var p=y.dimensions,g=y._length,h={},m=h.cdata=[],u=h.data=[],_=y._visibleDims=[],s,A,b,f,x;function l(z,I){for(var D=z.makeCalcdata({v:I.values,vcalendar:y.calendar},"v"),R=0;R<D.length;R++)D[R]=D[R]===t?NaN:D[R];m.push(D),u.push(z.type==="log"?w.simpleMap(D,z.c2l):D)}for(s=0;s<p.length;s++)if(b=p[s],b.visible){if(f=v.getFromId(i,y._diag[s][0]),x=v.getFromId(i,y._diag[s][1]),f&&x&&f.type!==x.type){w.log("Skipping splom dimension "+s+" with conflicting axis types");continue}f?(l(f,b),x&&x.type==="category"&&(x._categories=f._categories.slice())):l(x,b),_.push(s)}e(i,y),w.extendFlat(h,n(y));var L=m.length,T=L*g>c,k;for(T?k=h.sizeAvg||Math.max(h.size,3):k=S(y,g),A=0;A<_.length;A++)s=_[A],b=p[s],f=v.getFromId(i,y._diag[s][0])||{},x=v.getFromId(i,y._diag[s][1])||{},M(i,y,f,x,m[A],m[A],k);var P=r(i,y);return P.matrix||(P.matrix=!0),P.matrixOptions=h,P.selectedOptions=a(y,y.selected),P.unselectedOptions=a(y,y.unselected),[{x:!1,y:!1,t:{},trace:y}]}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/axis_ids":570,"../scatter/calc":937,"../scatter/colorscale_calc":939,"../scattergl/constants":991,"../scattergl/convert":992,"./scene_update":1051}],1045:[function(d,ee,te){var w=d("../../lib"),v=d("../../plots/array_container_defaults"),S=d("./attributes"),M=d("../scatter/subtypes"),e=d("../scatter/marker_defaults"),a=d("../parcoords/merge_length"),n=d("../scattergl/helpers").isOpenSymbol;ee.exports=function(o,i,y,p){function g(f,x){return w.coerce(o,i,S,f,x)}var h=v(o,i,{name:"dimensions",handleItemDefaults:r}),m=g("diagonal.visible"),u=g("showupperhalf"),_=g("showlowerhalf"),s=a(i,h,"values");if(!s||!m&&!u&&!_){i.visible=!1;return}g("text"),g("hovertext"),g("hovertemplate"),g("xhoverformat"),g("yhoverformat"),e(o,i,y,p,g);var A=n(i.marker.symbol),b=M.isBubble(i);g("marker.line.width",A||b?1:0),t(o,i,p,g),w.coerceSelectionMarkerOpacity(i,g)};function r(c,o){function i(p,g){return w.coerce(c,o,S.dimensions,p,g)}i("label");var y=i("values");y&&y.length?i("visible"):o.visible=!1,i("axis.type"),i("axis.matches")}function t(c,o,i,y){var p=o.dimensions,g=p.length,h=o.showupperhalf,m=o.showlowerhalf,u=o.diagonal.visible,_,s,A=new Array(g),b=new Array(g);for(_=0;_<g;_++){var f=_?_+1:"";A[_]="x"+f,b[_]="y"+f}var x=y("xaxes",A),l=y("yaxes",b),L=o._diag=new Array(g);o._xaxes={},o._yaxes={};var T=[],k=[];function P(J,X,Y,Z){if(!!J){var oe=J.charAt(0),re=i._splomAxes[oe];if(o["_"+oe+"axes"][J]=1,Z.push(J),!(J in re)){var se=re[J]={};Y&&(se.label=Y.label||"",Y.visible&&Y.axis&&(Y.axis.type&&(se.type=Y.axis.type),Y.axis.matches&&(se.matches=X)))}}}var z=!u&&!m,I=!u&&!h;for(o._axesDim={},_=0;_<g;_++){var D=p[_],R=_===0,B=_===g-1,F=R&&z||B&&I?void 0:x[_],H=R&&I||B&&z?void 0:l[_];P(F,H,D,T),P(H,F,D,k),L[_]=[F,H],o._axesDim[F]=_,o._axesDim[H]=_}for(_=0;_<T.length;_++)for(s=0;s<k.length;s++){var G=T[_]+k[s];(_>s&&h||_<s&&m||_===s&&(u||!m||!h))&&(i._splomSubplots[G]=1)}(!m||!u&&h&&m)&&(i._splomGridDflt.xside="bottom",i._splomGridDflt.yside="left")}},{"../../lib":515,"../../plots/array_container_defaults":561,"../parcoords/merge_length":907,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scattergl/helpers":996,"./attributes":1041}],1046:[function(d,ee,te){var w=d("../../lib"),v=d("../scatter/colorscale_calc"),S=d("../scattergl/convert").markerStyle;ee.exports=function(e,a){var n=a.trace,r=e._fullLayout._splomScenes[n.uid];if(r){v(e,n),w.extendFlat(r.matrixOptions,S(n));var t=w.extendFlat({},r.matrixOptions,r.viewOpts);r.matrix.update(t,null)}}},{"../../lib":515,"../scatter/colorscale_calc":939,"../scattergl/convert":992}],1047:[function(d,ee,te){te.getDimIndex=function(v,S){for(var M=S._id,e=M.charAt(0),a={x:0,y:1}[e],n=v._visibleDims,r=0;r<n.length;r++){var t=n[r];if(v._diag[t][a]===M)return r}return!1}},{}],1048:[function(d,ee,te){var w=d("./helpers"),v=d("../scattergl/hover").calcHover;function S(M,e,a){var n=M.cd,r=n[0].trace,t=M.scene,c=t.matrixOptions.cdata,o=M.xa,i=M.ya,y=o.c2p(e),p=i.c2p(a),g=M.distance,h=w.getDimIndex(r,o),m=w.getDimIndex(r,i);if(h===!1||m===!1)return[M];for(var u=c[h],_=c[m],s,A,b=g,f=0;f<u.length;f++){var x=u[f],l=_[f],L=o.c2p(x)-y,T=i.c2p(l)-p,k=Math.sqrt(L*L+T*T);k<b&&(b=A=k,s=f)}return M.index=s,M.distance=b,M.dxy=A,s===void 0?[M]:[v(M,u,_,r)]}ee.exports={hoverPoints:S}},{"../scattergl/hover":997,"./helpers":1047}],1049:[function(d,ee,te){var w=d("./base_index");w.basePlotModule=d("./base_plot"),ee.exports=w},{"./base_index":1042,"./base_plot":1043}],1050:[function(d,ee,te){var w=d("regl-splom"),v=d("../../lib"),S=d("../../plots/cartesian/axis_ids"),M=d("../../components/dragelement/helpers").selectMode;ee.exports=function(n,r,t){if(!!t.length)for(var c=0;c<t.length;c++)e(n,t[c][0])};function e(a,n){var r=a._fullLayout,t=r._size,c=n.trace,o=n.t,i=r._splomScenes[c.uid],y=i.matrixOptions,p=y.cdata,g=r._glcanvas.data()[0].regl,h=r.dragmode,m,u,_,s,A;if(p.length!==0){y.lower=c.showupperhalf,y.upper=c.showlowerhalf,y.diagonal=c.diagonal.visible;var b=c._visibleDims,f=p.length,x=i.viewOpts={};for(x.ranges=new Array(f),x.domains=new Array(f),A=0;A<b.length;A++){_=b[A];var l=x.ranges[A]=new Array(4),L=x.domains[A]=new Array(4);m=S.getFromId(a,c._diag[_][0]),m&&(l[0]=m._rl[0],l[2]=m._rl[1],L[0]=m.domain[0],L[2]=m.domain[1]),u=S.getFromId(a,c._diag[_][1]),u&&(l[1]=u._rl[0],l[3]=u._rl[1],L[1]=u.domain[0],L[3]=u.domain[1])}var T=a._context.plotGlPixelRatio,k=t.l*T,P=t.b*T,z=t.w*T,I=t.h*T;x.viewport=[k,P,z+k,I+P],i.matrix===!0&&(i.matrix=w(g));var D=r.clickmode.indexOf("select")>-1,R=M(h)||!!c.selectedpoints||D,B=!0;if(R){var F=c._length;if(c.selectedpoints){i.selectBatch=c.selectedpoints;var H=c.selectedpoints,G={};for(_=0;_<H.length;_++)G[H[_]]=!0;var J=[];for(_=0;_<F;_++)G[_]||J.push(_);i.unselectBatch=J}var X=o.xpx=new Array(f),Y=o.ypx=new Array(f);for(A=0;A<b.length;A++){if(_=b[A],m=S.getFromId(a,c._diag[_][0]),m)for(X[A]=new Array(F),s=0;s<F;s++)X[A][s]=m.c2p(p[A][s]);if(u=S.getFromId(a,c._diag[_][1]),u)for(Y[A]=new Array(F),s=0;s<F;s++)Y[A][s]=u.c2p(p[A][s])}if(i.selectBatch.length||i.unselectBatch.length){var Z=v.extendFlat({},y,i.unselectedOptions,x),oe=v.extendFlat({},y,i.selectedOptions,x);i.matrix.update(Z,oe),B=!1}}else o.xpx=o.ypx=null;if(B){var re=v.extendFlat({},y,x);i.matrix.update(re,null)}}}},{"../../components/dragelement/helpers":385,"../../lib":515,"../../plots/cartesian/axis_ids":570,"regl-splom":283}],1051:[function(d,ee,te){var w=d("../../lib");ee.exports=function(S,M){var e=S._fullLayout,a=M.uid,n=e._splomScenes;n||(n=e._splomScenes={});var r={dirty:!0,selectBatch:[],unselectBatch:[]},t={matrix:!1,selectBatch:[],unselectBatch:[]},c=n[M.uid];return c||(c=n[a]=w.extendFlat({},r,t),c.draw=function(){c.matrix&&c.matrix.draw&&(c.selectBatch.length||c.unselectBatch.length?c.matrix.draw(c.unselectBatch,c.selectBatch):c.matrix.draw()),c.dirty=!1},c.destroy=function(){c.matrix&&c.matrix.destroy&&c.matrix.destroy(),c.matrixOptions=null,c.selectBatch=null,c.unselectBatch=null,c=null}),c.dirty||w.extendFlat(c,r),c}},{"../../lib":515}],1052:[function(d,ee,te){var w=d("../../lib"),v=w.pushUnique,S=d("../scatter/subtypes"),M=d("./helpers");ee.exports=function(a,n){var r=a.cd,t=r[0].trace,c=r[0].t,o=a.scene,i=o.matrixOptions.cdata,y=a.xaxis,p=a.yaxis,g=[];if(!o)return g;var h=!S.hasMarkers(t)&&!S.hasText(t);if(t.visible!==!0||h)return g;var m=M.getDimIndex(t,y),u=M.getDimIndex(t,p);if(m===!1||u===!1)return g;var _=c.xpx[m],s=c.ypx[u],A=i[m],b=i[u],f=(a.scene.selectBatch||[]).slice(),x=[];if(n!==!1&&!n.degenerate)for(var l=0;l<A.length;l++)n.contains([_[l],s[l]],null,l,a)?(g.push({pointNumber:l,x:A[l],y:b[l]}),v(f,l)):f.indexOf(l)!==-1?v(f,l):x.push(l);var L=o.matrixOptions;return!f.length&&!x.length?o.matrix.update(L,null):!o.selectBatch.length&&!o.unselectBatch.length&&o.matrix.update(o.unselectedOptions,w.extendFlat({},L,o.selectedOptions,o.viewOpts)),o.selectBatch=f,o.unselectBatch=x,g}},{"../../lib":515,"../scatter/subtypes":961,"./helpers":1047}],1053:[function(d,ee,te){var w=d("../../components/colorscale/attributes"),v=d("../../plots/cartesian/axis_format_attributes").axisHoverFormat,S=d("../../plots/template_attributes").hovertemplateAttrs,M=d("../mesh3d/attributes"),e=d("../../plots/attributes"),a=d("../../lib/extend").extendFlat,n={x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},z:{valType:"data_array",editType:"calc+clearAxisTypes"},u:{valType:"data_array",editType:"calc"},v:{valType:"data_array",editType:"calc"},w:{valType:"data_array",editType:"calc"},starts:{x:{valType:"data_array",editType:"calc"},y:{valType:"data_array",editType:"calc"},z:{valType:"data_array",editType:"calc"},editType:"calc"},maxdisplayed:{valType:"integer",min:0,dflt:1e3,editType:"calc"},sizeref:{valType:"number",editType:"calc",min:0,dflt:1},text:{valType:"string",dflt:"",editType:"calc"},hovertext:{valType:"string",dflt:"",editType:"calc"},hovertemplate:S({editType:"calc"},{keys:["tubex","tubey","tubez","tubeu","tubev","tubew","norm","divergence"]}),uhoverformat:v("u",1),vhoverformat:v("v",1),whoverformat:v("w",1),xhoverformat:v("x"),yhoverformat:v("y"),zhoverformat:v("z"),showlegend:a({},e.showlegend,{dflt:!1})};a(n,w("",{colorAttr:"u/v/w norm",showScaleDflt:!0,editTypeOverride:"calc"}));var r=["opacity","lightposition","lighting"];r.forEach(function(t){n[t]=M[t]}),n.hoverinfo=a({},e.hoverinfo,{editType:"calc",flags:["x","y","z","u","v","w","norm","divergence","text","name"],dflt:"x+y+z+norm+text+name"}),n.transforms=void 0,ee.exports=n},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../mesh3d/attributes":876}],1054:[function(d,ee,te){var w=d("../../lib"),v=d("../../components/colorscale/calc");function S(n,r){r._len=Math.min(r.u.length,r.v.length,r.w.length,r.x.length,r.y.length,r.z.length),r._u=a(r.u,r._len),r._v=a(r.v,r._len),r._w=a(r.w,r._len),r._x=a(r.x,r._len),r._y=a(r.y,r._len),r._z=a(r.z,r._len);var t=M(r);r._gridFill=t.fill,r._Xs=t.Xs,r._Ys=t.Ys,r._Zs=t.Zs,r._len=t.len;var c=0,o,i,y;r.starts&&(o=a(r.starts.x||[]),i=a(r.starts.y||[]),y=a(r.starts.z||[]),c=Math.min(o.length,i.length,y.length)),r._startsX=o||[],r._startsY=i||[],r._startsZ=y||[];var p=0,g=1/0,h;for(h=0;h<r._len;h++){var m=r._u[h],u=r._v[h],_=r._w[h],s=Math.sqrt(m*m+u*u+_*_);p=Math.max(p,s),g=Math.min(g,s)}for(v(n,r,{vals:[g,p],containerStr:"",cLetter:"c"}),h=0;h<c;h++){var A=o[h];t.xMax=Math.max(t.xMax,A),t.xMin=Math.min(t.xMin,A);var b=i[h];t.yMax=Math.max(t.yMax,b),t.yMin=Math.min(t.yMin,b);var f=y[h];t.zMax=Math.max(t.zMax,f),t.zMin=Math.min(t.zMin,f)}r._slen=c,r._normMax=p,r._xbnds=[t.xMin,t.xMax],r._ybnds=[t.yMin,t.yMax],r._zbnds=[t.zMin,t.zMax]}function M(n){var r=n._x,t=n._y,c=n._z,o=n._len,i,y,p,g=-1/0,h=1/0,m=-1/0,u=1/0,_=-1/0,s=1/0,A="",b,f,x,l,L,T,k,P,z;for(o&&(l=r[0],T=t[0],P=c[0]),o>1&&(L=r[o-1],k=t[o-1],z=c[o-1]),i=0;i<o;i++)g=Math.max(g,r[i]),h=Math.min(h,r[i]),m=Math.max(m,t[i]),u=Math.min(u,t[i]),_=Math.max(_,c[i]),s=Math.min(s,c[i]),!b&&r[i]!==l&&(b=!0,A+="x"),!f&&t[i]!==T&&(f=!0,A+="y"),!x&&c[i]!==P&&(x=!0,A+="z");b||(A+="x"),f||(A+="y"),x||(A+="z");var I=e(n._x),D=e(n._y),R=e(n._z);A=A.replace("x",(l>L?"-":"+")+"x"),A=A.replace("y",(T>k?"-":"+")+"y"),A=A.replace("z",(P>z?"-":"+")+"z");var B=function(){o=0,I=[],D=[],R=[]};(!o||o<I.length*D.length*R.length)&&B();var F=function(ie){return ie==="x"?r:ie==="y"?t:c},H=function(ie){return ie==="x"?I:ie==="y"?D:R},G=function(ie){return ie[o-1]<ie[0]?-1:1},J=F(A[1]),X=F(A[3]),Y=F(A[5]),Z=H(A[1]).length,oe=H(A[3]).length,re=H(A[5]).length,se=!1,N=function(ie,le,ye){return Z*(oe*ie+le)+ye},U=G(F(A[1])),q=G(F(A[3])),$=G(F(A[5]));for(i=0;i<re-1;i++){for(y=0;y<oe-1;y++){for(p=0;p<Z-1;p++){var W=N(i,y,p),K=N(i,y,p+1),ne=N(i,y+1,p),ae=N(i+1,y,p);if((!(J[W]*U<J[K]*U)||!(X[W]*q<X[ne]*q)||!(Y[W]*$<Y[ae]*$))&&(se=!0),se)break}if(se)break}if(se)break}return se&&(w.warn("Encountered arbitrary coordinates! Unable to input data grid."),B()),{xMin:h,yMin:u,zMin:s,xMax:g,yMax:m,zMax:_,Xs:I,Ys:D,Zs:R,len:o,fill:A}}function e(n){return w.distinctVals(n).vals}function a(n,r){if(r===void 0&&(r=n.length),w.isTypedArray(n))return n.subarray(0,r);for(var t=[],c=0;c<r;c++)t[c]=+n[c];return t}ee.exports={calc:S,filter:a,processGrid:M}},{"../../components/colorscale/calc":375,"../../lib":515}],1055:[function(d,ee,te){var w=d("../../../stackgl_modules").gl_streamtube3d,v=w.createTubeMesh,S=d("../../lib"),M=d("../../lib/gl_format_color").parseColorScale,e=d("../../components/colorscale").extractOpts,a=d("../../plots/gl3d/zip3"),n={xaxis:0,yaxis:1,zaxis:2};function r(p,g){this.scene=p,this.uid=g,this.mesh=null,this.data=null}var t=r.prototype;t.handlePick=function(p){var g=this.scene.fullSceneLayout,h=this.scene.dataScale;function m(s,A){var b=g[A],f=h[n[A]];return b.l2c(s)/f}if(p.object===this.mesh){var u=p.data.position,_=p.data.velocity;return p.traceCoordinate=[m(u[0],"xaxis"),m(u[1],"yaxis"),m(u[2],"zaxis"),m(_[0],"xaxis"),m(_[1],"yaxis"),m(_[2],"zaxis"),p.data.intensity*this.data._normMax,p.data.divergence],p.textLabel=this.data.hovertext||this.data.text,!0}};function c(p){var g=p.length,h;return g>2?h=p.slice(1,g-1):g===2?h=[(p[0]+p[1])/2]:h=p,h}function o(p){var g=p.length;return g===1?[.5,.5]:[p[1]-p[0],p[g-1]-p[g-2]]}function i(p,g){var h=p.fullSceneLayout,m=p.dataScale,u=g._len,_={};function s(oe,re){var se=h[re],N=m[n[re]];return S.simpleMap(oe,function(U){return se.d2l(U)*N})}if(_.vectors=a(s(g._u,"xaxis"),s(g._v,"yaxis"),s(g._w,"zaxis"),u),!u)return{positions:[],cells:[]};var A=s(g._Xs,"xaxis"),b=s(g._Ys,"yaxis"),f=s(g._Zs,"zaxis");_.meshgrid=[A,b,f],_.gridFill=g._gridFill;var x=g._slen;if(x)_.startingPositions=a(s(g._startsX,"xaxis"),s(g._startsY,"yaxis"),s(g._startsZ,"zaxis"));else{for(var l=b[0],L=c(A),T=c(f),k=new Array(L.length*T.length),P=0,z=0;z<L.length;z++)for(var I=0;I<T.length;I++)k[P++]=[L[z],l,T[I]];_.startingPositions=k}_.colormap=M(g),_.tubeSize=g.sizeref,_.maxLength=g.maxdisplayed;var D=s(g._xbnds,"xaxis"),R=s(g._ybnds,"yaxis"),B=s(g._zbnds,"zaxis"),F=o(A),H=o(b),G=o(f),J=[[D[0]-F[0],R[0]-H[0],B[0]-G[0]],[D[1]+F[1],R[1]+H[1],B[1]+G[1]]],X=w(_,J),Y=e(g);X.vertexIntensityBounds=[Y.min/g._normMax,Y.max/g._normMax];var Z=g.lightposition;return X.lightPosition=[Z.x,Z.y,Z.z],X.ambient=g.lighting.ambient,X.diffuse=g.lighting.diffuse,X.specular=g.lighting.specular,X.roughness=g.lighting.roughness,X.fresnel=g.lighting.fresnel,X.opacity=g.opacity,g._pad=X.tubeScale*g.sizeref*2,X}t.update=function(p){this.data=p;var g=i(this.scene,p);this.mesh.update(g)},t.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()};function y(p,g){var h=p.glplot.gl,m=i(p,g),u=v(h,m),_=new r(p,g.uid);return _.mesh=u,_.data=g,u._trace=_,p.glplot.add(u),_}ee.exports=y},{"../../../stackgl_modules":1133,"../../components/colorscale":379,"../../lib":515,"../../lib/gl_format_color":511,"../../plots/gl3d/zip3":618}],1056:[function(d,ee,te){var w=d("../../lib"),v=d("../../components/colorscale/defaults"),S=d("./attributes");ee.exports=function(e,a,n,r){function t(h,m){return w.coerce(e,a,S,h,m)}var c=t("u"),o=t("v"),i=t("w"),y=t("x"),p=t("y"),g=t("z");if(!c||!c.length||!o||!o.length||!i||!i.length||!y||!y.length||!p||!p.length||!g||!g.length){a.visible=!1;return}t("starts.x"),t("starts.y"),t("starts.z"),t("maxdisplayed"),t("sizeref"),t("lighting.ambient"),t("lighting.diffuse"),t("lighting.specular"),t("lighting.roughness"),t("lighting.fresnel"),t("lightposition.x"),t("lightposition.y"),t("lightposition.z"),v(e,a,r,t,{prefix:"",cLetter:"c"}),t("text"),t("hovertext"),t("hovertemplate"),t("uhoverformat"),t("vhoverformat"),t("whoverformat"),t("xhoverformat"),t("yhoverformat"),t("zhoverformat"),a._length=null}},{"../../components/colorscale/defaults":377,"../../lib":515,"./attributes":1053}],1057:[function(d,ee,te){ee.exports={moduleType:"trace",name:"streamtube",basePlotModule:d("../../plots/gl3d"),categories:["gl3d","showLegend"],attributes:d("./attributes"),supplyDefaults:d("./defaults"),colorbar:{min:"cmin",max:"cmax"},calc:d("./calc").calc,plot:d("./convert"),eventData:function(w,v){return w.tubex=w.x,w.tubey=w.y,w.tubez=w.z,w.tubeu=v.traceCoordinate[3],w.tubev=v.traceCoordinate[4],w.tubew=v.traceCoordinate[5],w.norm=v.traceCoordinate[6],w.divergence=v.traceCoordinate[7],delete w.x,delete w.y,delete w.z,w},meta:{}}},{"../../plots/gl3d":607,"./attributes":1053,"./calc":1054,"./convert":1055,"./defaults":1056}],1058:[function(d,ee,te){var w=d("../../plots/attributes"),v=d("../../plots/template_attributes").hovertemplateAttrs,S=d("../../plots/template_attributes").texttemplateAttrs,M=d("../../components/colorscale/attributes"),e=d("../../plots/domain").attributes,a=d("../pie/attributes"),n=d("./constants"),r=d("../../lib/extend").extendFlat;ee.exports={labels:{valType:"data_array",editType:"calc"},parents:{valType:"data_array",editType:"calc"},values:{valType:"data_array",editType:"calc"},branchvalues:{valType:"enumerated",values:["remainder","total"],dflt:"remainder",editType:"calc"},count:{valType:"flaglist",flags:["branches","leaves"],dflt:"leaves",editType:"calc"},level:{valType:"any",editType:"plot",anim:!0},maxdepth:{valType:"integer",editType:"plot",dflt:-1},marker:r({colors:{valType:"data_array",editType:"calc"},line:{color:r({},a.marker.line.color,{dflt:null}),width:r({},a.marker.line.width,{dflt:1}),editType:"calc"},editType:"calc"},M("marker",{colorAttr:"colors",anim:!1})),leaf:{opacity:{valType:"number",editType:"style",min:0,max:1},editType:"plot"},text:a.text,textinfo:{valType:"flaglist",flags:["label","text","value","current path","percent root","percent entry","percent parent"],extras:["none"],editType:"plot"},texttemplate:S({editType:"plot"},{keys:n.eventDataKeys.concat(["label","value"])}),hovertext:a.hovertext,hoverinfo:r({},w.hoverinfo,{flags:["label","text","value","name","current path","percent root","percent entry","percent parent"],dflt:"label+text+value+name"}),hovertemplate:v({},{keys:n.eventDataKeys}),textfont:a.textfont,insidetextorientation:a.insidetextorientation,insidetextfont:a.insidetextfont,outsidetextfont:r({},a.outsidetextfont,{}),rotation:{valType:"angle",dflt:0,editType:"plot"},sort:a.sort,root:{color:{valType:"color",editType:"calc",dflt:"rgba(0,0,0,0)"},editType:"calc"},domain:e({name:"sunburst",trace:!0,editType:"calc"})}},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/domain":593,"../../plots/template_attributes":642,"../pie/attributes":910,"./constants":1061}],1059:[function(d,ee,te){var w=d("../../plots/plots");te.name="sunburst",te.plot=function(v,S,M,e){w.plotBasePlot(te.name,v,S,M,e)},te.clean=function(v,S,M,e){w.cleanBasePlot(te.name,v,S,M,e)}},{"../../plots/plots":628}],1060:[function(d,ee,te){var w=d("d3-hierarchy"),v=d("fast-isnumeric"),S=d("../../lib"),M=d("../../components/colorscale").makeColorScaleFuncFromTrace,e=d("../pie/calc").makePullColorFn,a=d("../pie/calc").generateExtendedColors,n=d("../../components/colorscale").calc,r=d("../../constants/numerical").ALMOST_EQUAL,t={},c={},o={};te.calc=function(y,p){var g=y._fullLayout,h=p.ids,m=S.isArrayOrTypedArray(h),u=p.labels,_=p.parents,s=p.values,A=S.isArrayOrTypedArray(s),b=[],f={},x={},l=function(U,q){f[U]?f[U].push(q):f[U]=[q],x[q]=1},L=function(U){return U||typeof U=="number"},T=function(U){return!A||v(s[U])&&s[U]>=0},k,P,z;m?(k=Math.min(h.length,_.length),P=function(U){return L(h[U])&&T(U)},z=function(U){return String(h[U])}):(k=Math.min(u.length,_.length),P=function(U){return L(u[U])&&T(U)},z=function(U){return String(u[U])}),A&&(k=Math.min(k,s.length));for(var I=0;I<k;I++)if(P(I)){var D=z(I),R=L(_[I])?String(_[I]):"",B={i:I,id:D,pid:R,label:L(u[I])?String(u[I]):""};A&&(B.v=+s[I]),b.push(B),l(R,D)}if(f[""]){if(f[""].length>1){for(var G=S.randstr(),J=0;J<b.length;J++)b[J].pid===""&&(b[J].pid=G);b.unshift({hasMultipleRoots:!0,id:G,pid:"",label:""})}}else{var F=[],H;for(H in f)x[H]||F.push(H);if(F.length===1)H=F[0],b.unshift({hasImpliedRoot:!0,id:H,pid:"",label:H});else return S.warn(["Multiple implied roots, cannot build",p.type,"hierarchy of",p.name+".","These roots include:",F.join(", ")].join(" "))}var X;try{X=w.stratify().id(function(U){return U.id}).parentId(function(U){return U.pid})(b)}catch(U){return S.warn(["Failed to build",p.type,"hierarchy of",p.name+".","Error:",U.message].join(" "))}var Y=w.hierarchy(X),Z=!1;if(A)switch(p.branchvalues){case"remainder":Y.sum(function(U){return U.data.v});break;case"total":Y.each(function(U){var q=U.data.data,$=q.v;if(U.children){var W=U.children.reduce(function(K,ne){return K+ne.data.data.v},0);if((q.hasImpliedRoot||q.hasMultipleRoots)&&($=W),$<W*r)return Z=!0,S.warn(["Total value for node",U.data.data.id,"of",p.name,"is smaller than the sum of its children.",`
parent value =`,$,`
children sum =`,W].join(" "))}U.value=$});break}else i(Y,p,{branches:p.count.indexOf("branches")!==-1,leaves:p.count.indexOf("leaves")!==-1});if(!Z){p.sort&&Y.sort(function(U,q){return q.value-U.value});var oe,re,se=p.marker.colors||[],N=!!se.length;return p._hasColorscale?(N||(se=A?p.values:p._values),n(y,p,{vals:se,containerStr:"marker",cLetter:"c"}),re=M(p.marker)):oe=e(g["_"+p.type+"colormap"]),Y.each(function(U){var q=U.data.data;q.color=p._hasColorscale?re(se[q.i]):oe(se[q.i],q.id)}),b[0].hierarchy=Y,b}},te._runCrossTraceCalc=function(y,p){var g=p._fullLayout,h=p.calcdata,m=g[y+"colorway"],u=g["_"+y+"colormap"];g["extend"+y+"colors"]&&(m=a(m,y==="icicle"?o:y==="treemap"?c:t));var _=0,s;function A(l){var L=l.data.data,T=L.id;L.color===!1&&(u[T]?L.color=u[T]:l.parent?l.parent.parent?L.color=l.parent.data.data.color:(u[T]=L.color=m[_%m.length],_++):L.color=s)}for(var b=0;b<h.length;b++){var f=h[b],x=f[0];x.trace.type===y&&x.hierarchy&&(s=x.trace.root.color,x.hierarchy.each(A))}},te.crossTraceCalc=function(y){return te._runCrossTraceCalc("sunburst",y)};function i(y,p,g){var h=0,m=y.children;if(m){for(var u=m.length,_=0;_<u;_++)h+=i(m[_],p,g);g.branches&&h++}else g.leaves&&h++;return y.value=y.data.data.value=h,p._values||(p._values=[]),p._values[y.data.data.i]=h,h}},{"../../components/colorscale":379,"../../constants/numerical":491,"../../lib":515,"../pie/calc":912,"d3-hierarchy":115,"fast-isnumeric":190}],1061:[function(d,ee,te){ee.exports={CLICK_TRANSITION_TIME:750,CLICK_TRANSITION_EASING:"linear",eventDataKeys:["currentPath","root","entry","percentRoot","percentEntry","percentParent"]}},{}],1062:[function(d,ee,te){var w=d("../../lib"),v=d("./attributes"),S=d("../../plots/domain").defaults,M=d("../bar/defaults").handleText,e=d("../../components/colorscale"),a=e.hasColorscale,n=e.handleDefaults;ee.exports=function(t,c,o,i){function y(A,b){return w.coerce(t,c,v,A,b)}var p=y("labels"),g=y("parents");if(!p||!p.length||!g||!g.length){c.visible=!1;return}var h=y("values");h&&h.length?y("branchvalues"):y("count"),y("level"),y("maxdepth");var m=y("marker.line.width");m&&y("marker.line.color",i.paper_bgcolor),y("marker.colors");var u=c._hasColorscale=a(t,"marker","colors")||(t.marker||{}).coloraxis;u&&n(t,c,i,y,{prefix:"marker.",cLetter:"c"}),y("leaf.opacity",u?1:.7);var _=y("text");y("texttemplate"),c.texttemplate||y("textinfo",Array.isArray(_)?"text+label":"label"),y("hovertext"),y("hovertemplate");var s="auto";M(t,c,i,y,s,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1}),y("insidetextorientation"),y("sort"),y("rotation"),y("root.color"),S(c,i,y),c._length=null}},{"../../components/colorscale":379,"../../lib":515,"../../plots/domain":593,"../bar/defaults":661,"./attributes":1058}],1063:[function(d,ee,te){var w=d("@plotly/d3"),v=d("../../registry"),S=d("../../components/fx/helpers").appendArrayPointValue,M=d("../../components/fx"),e=d("../../lib"),a=d("../../lib/events"),n=d("./helpers"),r=d("../pie/helpers"),t=r.formatPieValue;ee.exports=function(i,y,p,g,h){var m=g[0],u=m.trace,_=m.hierarchy,s=u.type==="sunburst",A=u.type==="treemap"||u.type==="icicle";"_hasHoverLabel"in u||(u._hasHoverLabel=!1),"_hasHoverEvent"in u||(u._hasHoverEvent=!1);var b=function(l){var L=p._fullLayout;if(!(p._dragging||L.hovermode===!1)){var T=p._fullData[u.index],k=l.data.data,P=k.i,z=n.isHierarchyRoot(l),I=n.getParent(_,l),D=n.getValue(l),R=function(K){return e.castOption(T,P,K)},B=R("hovertemplate"),F=M.castHoverinfo(T,L,P),H=L.separators,G;if(B||F&&F!=="none"&&F!=="skip"){var J,X;s&&(J=m.cx+l.pxmid[0]*(1-l.rInscribed),X=m.cy+l.pxmid[1]*(1-l.rInscribed)),A&&(J=l._hoverX,X=l._hoverY);var Y={},Z=[],oe=[],re=function(K){return Z.indexOf(K)!==-1};F&&(Z=F==="all"?T._module.attributes.hoverinfo.flags:F.split("+")),Y.label=k.label,re("label")&&Y.label&&oe.push(Y.label),k.hasOwnProperty("v")&&(Y.value=k.v,Y.valueLabel=t(Y.value,H),re("value")&&oe.push(Y.valueLabel)),Y.currentPath=l.currentPath=n.getPath(l.data),re("current path")&&!z&&oe.push(Y.currentPath);var se,N=[],U=function(){N.indexOf(se)===-1&&(oe.push(se),N.push(se))};Y.percentParent=l.percentParent=D/n.getValue(I),Y.parent=l.parentString=n.getPtLabel(I),re("percent parent")&&(se=n.formatPercent(Y.percentParent,H)+" of "+Y.parent,U()),Y.percentEntry=l.percentEntry=D/n.getValue(y),Y.entry=l.entry=n.getPtLabel(y),re("percent entry")&&!z&&!l.onPathbar&&(se=n.formatPercent(Y.percentEntry,H)+" of "+Y.entry,U()),Y.percentRoot=l.percentRoot=D/n.getValue(_),Y.root=l.root=n.getPtLabel(_),re("percent root")&&!z&&(se=n.formatPercent(Y.percentRoot,H)+" of "+Y.root,U()),Y.text=R("hovertext")||R("text"),re("text")&&(se=Y.text,e.isValidTextValue(se)&&oe.push(se)),G=[c(l,T,h.eventDataKeys)];var q={trace:T,y:X,_x0:l._x0,_x1:l._x1,_y0:l._y0,_y1:l._y1,text:oe.join("<br>"),name:B||re("name")?T.name:void 0,color:R("hoverlabel.bgcolor")||k.color,borderColor:R("hoverlabel.bordercolor"),fontFamily:R("hoverlabel.font.family"),fontSize:R("hoverlabel.font.size"),fontColor:R("hoverlabel.font.color"),nameLength:R("hoverlabel.namelength"),textAlign:R("hoverlabel.align"),hovertemplate:B,hovertemplateLabels:Y,eventData:G};s&&(q.x0=J-l.rInscribed*l.rpx1,q.x1=J+l.rInscribed*l.rpx1,q.idealAlign=l.pxmid[0]<0?"left":"right"),A&&(q.x=J,q.idealAlign=J<0?"left":"right");var $=[];M.loneHover(q,{container:L._hoverlayer.node(),outerContainer:L._paper.node(),gd:p,inOut_bbox:$}),G[0].bbox=$[0],u._hasHoverLabel=!0}if(A){var W=i.select("path.surface");h.styleOne(W,l,T,{hovered:!0})}u._hasHoverEvent=!0,p.emit("plotly_hover",{points:G||[c(l,T,h.eventDataKeys)],event:w.event})}},f=function(l){var L=p._fullLayout,T=p._fullData[u.index],k=w.select(this).datum();if(u._hasHoverEvent&&(l.originalEvent=w.event,p.emit("plotly_unhover",{points:[c(k,T,h.eventDataKeys)],event:w.event}),u._hasHoverEvent=!1),u._hasHoverLabel&&(M.loneUnhover(L._hoverlayer.node()),u._hasHoverLabel=!1),A){var P=i.select("path.surface");h.styleOne(P,k,T,{hovered:!1})}},x=function(l){var L=p._fullLayout,T=p._fullData[u.index],k=s&&(n.isHierarchyRoot(l)||n.isLeaf(l)),P=n.getPtId(l),z=n.isEntry(l)?n.findEntryWithChild(_,P):n.findEntryWithLevel(_,P),I=n.getPtId(z),D={points:[c(l,T,h.eventDataKeys)],event:w.event};k||(D.nextLevel=I);var R=a.triggerHandler(p,"plotly_"+u.type+"click",D);if(R!==!1&&L.hovermode&&(p._hoverdata=[c(l,T,h.eventDataKeys)],M.click(p,w.event)),!k&&R!==!1&&!p._dragging&&!p._transitioning){v.call("_storeDirectGUIEdit",T,L._tracePreGUI[T.uid],{level:T.level});var B={data:[{level:I}],traces:[u.index]},F={frame:{redraw:!1,duration:h.transitionTime},transition:{duration:h.transitionTime,easing:h.transitionEasing},mode:"immediate",fromcurrent:!0};M.loneUnhover(L._hoverlayer.node()),v.call("animate",p,B,F)}};i.on("mouseover",b),i.on("mouseout",f),i.on("click",x)};function c(o,i,y){for(var p=o.data.data,g={curveNumber:i.index,pointNumber:p.i,data:i._input,fullData:i},h=0;h<y.length;h++){var m=y[h];m in o&&(g[m]=o[m])}return"parentString"in o&&!n.isHierarchyRoot(o)&&(g.parent=o.parentString),S(g,i,p.i),g}},{"../../components/fx":407,"../../components/fx/helpers":403,"../../lib":515,"../../lib/events":504,"../../registry":647,"../pie/helpers":915,"./helpers":1064,"@plotly/d3":58}],1064:[function(d,ee,te){var w=d("../../lib"),v=d("../../components/color"),S=d("../../lib/setcursor"),M=d("../pie/helpers");te.findEntryWithLevel=function(r,t){var c;return t&&r.eachAfter(function(o){if(te.getPtId(o)===t)return c=o.copy()}),c||r},te.findEntryWithChild=function(r,t){var c;return r.eachAfter(function(o){for(var i=o.children||[],y=0;y<i.length;y++){var p=i[y];if(te.getPtId(p)===t)return c=o.copy()}}),c||r},te.isEntry=function(r){return!r.parent},te.isLeaf=function(r){return!r.children},te.getPtId=function(r){return r.data.data.id},te.getPtLabel=function(r){return r.data.data.label},te.getValue=function(r){return r.value},te.isHierarchyRoot=function(r){return n(r)===""},te.setSliceCursor=function(r,t,c){var o=c.isTransitioning;if(!o){var i=r.datum();o=c.hideOnRoot&&te.isHierarchyRoot(i)||c.hideOnLeaves&&te.isLeaf(i)}S(r,o?null:"pointer")};function e(r,t,c){return{color:te.getOutsideTextFontKey("color",r,t,c),family:te.getOutsideTextFontKey("family",r,t,c),size:te.getOutsideTextFontKey("size",r,t,c)}}function a(r,t,c,o){var i=(o||{}).onPathbar,y=t.data.data,p=y.i,g=w.castOption(r,p,(i?"pathbar.textfont":"insidetextfont")+".color");return!g&&r._input.textfont&&(g=w.castOption(r._input,p,"textfont.color")),{color:g||v.contrast(y.color),family:te.getInsideTextFontKey("family",r,t,c,o),size:te.getInsideTextFontKey("size",r,t,c,o)}}te.getInsideTextFontKey=function(r,t,c,o,i){var y=(i||{}).onPathbar,p=y?"pathbar.textfont":"insidetextfont",g=c.data.data.i;return w.castOption(t,g,p+"."+r)||w.castOption(t,g,"textfont."+r)||o.size},te.getOutsideTextFontKey=function(r,t,c,o){var i=c.data.data.i;return w.castOption(t,i,"outsidetextfont."+r)||w.castOption(t,i,"textfont."+r)||o.size},te.isOutsideText=function(r,t){return!r._hasColorscale&&te.isHierarchyRoot(t)},te.determineTextFont=function(r,t,c,o){return te.isOutsideText(r,t)?e(r,t,c):a(r,t,c,o)},te.hasTransition=function(r){return!!(r&&r.duration>0)},te.getMaxDepth=function(r){return r.maxdepth>=0?r.maxdepth:1/0},te.isHeader=function(r,t){return!(te.isLeaf(r)||r.depth===t._maxDepth-1)};function n(r){return r.data.data.pid}te.getParent=function(r,t){return te.findEntryWithLevel(r,n(t))},te.listPath=function(r,t){var c=r.parent;if(!c)return[];var o=t?[c.data[t]]:[c];return te.listPath(c,t).concat(o)},te.getPath=function(r){return te.listPath(r,"label").join("/")+"/"},te.formatValue=M.formatPieValue,te.formatPercent=function(r,t){var c=w.formatPercent(r,0);return c==="0%"&&(c=M.formatPiePercent(r,t)),c}},{"../../components/color":367,"../../lib":515,"../../lib/setcursor":536,"../pie/helpers":915}],1065:[function(d,ee,te){ee.exports={moduleType:"trace",name:"sunburst",basePlotModule:d("./base_plot"),categories:[],animatable:!0,attributes:d("./attributes"),layoutAttributes:d("./layout_attributes"),supplyDefaults:d("./defaults"),supplyLayoutDefaults:d("./layout_defaults"),calc:d("./calc").calc,crossTraceCalc:d("./calc").crossTraceCalc,plot:d("./plot").plot,style:d("./style").style,colorbar:d("../scatter/marker_colorbar"),meta:{}}},{"../scatter/marker_colorbar":954,"./attributes":1058,"./base_plot":1059,"./calc":1060,"./defaults":1062,"./layout_attributes":1066,"./layout_defaults":1067,"./plot":1068,"./style":1069}],1066:[function(d,ee,te){ee.exports={sunburstcolorway:{valType:"colorlist",editType:"calc"},extendsunburstcolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{}],1067:[function(d,ee,te){var w=d("../../lib"),v=d("./layout_attributes");ee.exports=function(M,e){function a(n,r){return w.coerce(M,e,v,n,r)}a("sunburstcolorway",e.colorway),a("extendsunburstcolors")}},{"../../lib":515,"./layout_attributes":1066}],1068:[function(d,ee,te){var w=d("@plotly/d3"),v=d("d3-hierarchy"),S=d("d3-interpolate").interpolate,M=d("../../components/drawing"),e=d("../../lib"),a=d("../../lib/svg_text_utils"),n=d("../bar/uniform_text"),r=n.recordMinTextSize,t=n.clearMinTextSize,c=d("../pie/plot"),o=d("../pie/helpers").getRotationAngle,i=c.computeTransform,y=c.transformInsideText,p=d("./style").styleOne,g=d("../bar/style").resizeText,h=d("./fx"),m=d("./constants"),u=d("./helpers");te.plot=function(x,l,L,T){var k=x._fullLayout,P=k._sunburstlayer,z,I,D=!L,R=!k.uniformtext.mode&&u.hasTransition(L);if(t("sunburst",k),z=P.selectAll("g.trace.sunburst").data(l,function(F){return F[0].trace.uid}),z.enter().append("g").classed("trace",!0).classed("sunburst",!0).attr("stroke-linejoin","round"),z.order(),R){T&&(I=T());var B=w.transition().duration(L.duration).ease(L.easing).each("end",function(){I&&I()}).each("interrupt",function(){I&&I()});B.each(function(){P.selectAll("g.trace").each(function(F){_(x,F,this,L)})})}else z.each(function(F){_(x,F,this,L)}),k.uniformtext.mode&&g(x,k._sunburstlayer.selectAll(".trace"),"sunburst");D&&z.exit().remove()};function _(x,l,L,T){var k=x._fullLayout,P=!k.uniformtext.mode&&u.hasTransition(T),z=w.select(L),I=z.selectAll("g.slice"),D=l[0],R=D.trace,B=D.hierarchy,F=u.findEntryWithLevel(B,R.level),H=u.getMaxDepth(R),G=k._size,J=R.domain,X=G.w*(J.x[1]-J.x[0]),Y=G.h*(J.y[1]-J.y[0]),Z=.5*Math.min(X,Y),oe=D.cx=G.l+G.w*(J.x[1]+J.x[0])/2,re=D.cy=G.t+G.h*(1-J.y[0])-Y/2;if(!F)return I.remove();var se=null,N={};P&&I.each(function(be){N[u.getPtId(be)]={rpx0:be.rpx0,rpx1:be.rpx1,x0:be.x0,x1:be.x1,transform:be.transform},!se&&u.isEntry(be)&&(se=be)});var U=s(F).descendants(),q=F.height+1,$=0,W=H;D.hasMultipleRoots&&u.isHierarchyRoot(F)&&(U=U.slice(1),q-=1,$=1,W+=1),U=U.filter(function(be){return be.y1<=W});var K=o(R.rotation);K&&U.forEach(function(be){be.x0+=K,be.x1+=K});var ne=Math.min(q,H),ae=function(be){return(be-$)/ne*Z},ie=function(be,Pe){return[be*Math.cos(Pe),-be*Math.sin(Pe)]},le=function(be){return e.pathAnnulus(be.rpx0,be.rpx1,be.x0,be.x1,oe,re)},ye=function(be){return oe+b(be)[0]*(be.transform.rCenter||0)+(be.transform.x||0)},ue=function(be){return re+b(be)[1]*(be.transform.rCenter||0)+(be.transform.y||0)};I=I.data(U,u.getPtId),I.enter().append("g").classed("slice",!0),P?I.exit().transition().each(function(){var be=w.select(this),Pe=be.select("path.surface");Pe.transition().attrTween("d",function(Qe){var Be=_e(Qe);return function(Le){return le(Be(Le))}});var Ge=be.select("g.slicetext");Ge.attr("opacity",0)}).remove():I.exit().remove(),I.order();var pe=null;if(P&&se){var ge=u.getPtId(se);I.each(function(be){pe===null&&u.getPtId(be)===ge&&(pe=be.x1)})}var Te=I;P&&(Te=Te.transition().each("end",function(){var be=w.select(this);u.setSliceCursor(be,x,{hideOnRoot:!0,hideOnLeaves:!0,isTransitioning:!1})})),Te.each(function(be){var Pe=w.select(this),Ge=e.ensureSingle(Pe,"path","surface",function(Rt){Rt.style("pointer-events","all")});be.rpx0=ae(be.y0),be.rpx1=ae(be.y1),be.xmid=(be.x0+be.x1)/2,be.pxmid=ie(be.rpx1,be.xmid),be.midangle=-(be.xmid-Math.PI/2),be.startangle=-(be.x0-Math.PI/2),be.stopangle=-(be.x1-Math.PI/2),be.halfangle=.5*Math.min(e.angleDelta(be.x0,be.x1)||Math.PI,Math.PI),be.ring=1-be.rpx0/be.rpx1,be.rInscribed=A(be),P?Ge.transition().attrTween("d",function(Rt){var rr=ze(Rt);return function(Lt){return le(rr(Lt))}}):Ge.attr("d",le),Pe.call(h,F,x,l,{eventDataKeys:m.eventDataKeys,transitionTime:m.CLICK_TRANSITION_TIME,transitionEasing:m.CLICK_TRANSITION_EASING}).call(u.setSliceCursor,x,{hideOnRoot:!0,hideOnLeaves:!0,isTransitioning:x._transitioning}),Ge.call(p,be,R);var Qe=e.ensureSingle(Pe,"g","slicetext"),Be=e.ensureSingle(Qe,"text","",function(Rt){Rt.attr("data-notex",1)}),Le=e.ensureUniformFontSize(x,u.determineTextFont(R,be,k.font));Be.text(te.formatSliceLabel(be,F,R,l,k)).classed("slicetext",!0).attr("text-anchor","middle").call(M.font,Le).call(a.convertToTspans,x);var He=M.bBox(Be.node());be.transform=y(He,be,D),be.transform.targetX=ye(be),be.transform.targetY=ue(be);var vt=function(Rt,rr){var Lt=Rt.transform;return i(Lt,rr),Lt.fontSize=Le.size,r(R.type,Lt,k),e.getTextTransform(Lt)};P?Be.transition().attrTween("transform",function(Rt){var rr=Oe(Rt);return function(Lt){return vt(rr(Lt),He)}}):Be.attr("transform",vt(be,He))});function _e(be){var Pe=u.getPtId(be),Ge=N[Pe],Qe=N[u.getPtId(F)],Be;if(Qe){var Le=(be.x1>Qe.x1?2*Math.PI:0)+K;Be=be.rpx1<Qe.rpx1?{x0:be.x0,x1:be.x1,rpx0:0,rpx1:0}:{x0:Le,x1:Le,rpx0:be.rpx0,rpx1:be.rpx1}}else{var He,vt=u.getPtId(be.parent);I.each(function(Gt){if(u.getPtId(Gt)===vt)return He=Gt});var Rt=He.children,rr;Rt.forEach(function(Gt,Dt){if(u.getPtId(Gt)===Pe)return rr=Dt});var Lt=Rt.length,Ft=S(He.x0,He.x1);Be={rpx0:Z,rpx1:Z,x0:Ft(rr/Lt),x1:Ft((rr+1)/Lt)}}return S(Ge,Be)}function ze(be){var Pe=N[u.getPtId(be)],Ge,Qe={x0:be.x0,x1:be.x1,rpx0:be.rpx0,rpx1:be.rpx1};if(Pe)Ge=Pe;else if(se)if(be.parent)if(pe){var Be=(be.x1>pe?2*Math.PI:0)+K;Ge={x0:Be,x1:Be}}else Ge={rpx0:Z,rpx1:Z},e.extendFlat(Ge,Ye(be));else Ge={rpx0:0,rpx1:0};else Ge={x0:K,x1:K};return S(Ge,Qe)}function Oe(be){var Pe=N[u.getPtId(be)],Ge,Qe=be.transform;if(Pe)Ge=Pe;else if(Ge={rpx1:be.rpx1,transform:{textPosAngle:Qe.textPosAngle,scale:0,rotate:Qe.rotate,rCenter:Qe.rCenter,x:Qe.x,y:Qe.y}},se)if(be.parent)if(pe){var Be=be.x1>pe?2*Math.PI:0;Ge.x0=Ge.x1=Be}else e.extendFlat(Ge,Ye(be));else Ge.x0=Ge.x1=K;else Ge.x0=Ge.x1=K;var Le=S(Ge.transform.textPosAngle,be.transform.textPosAngle),He=S(Ge.rpx1,be.rpx1),vt=S(Ge.x0,be.x0),Rt=S(Ge.x1,be.x1),rr=S(Ge.transform.scale,Qe.scale),Lt=S(Ge.transform.rotate,Qe.rotate),Ft=Qe.rCenter===0?3:Ge.transform.rCenter===0?1/3:1,Gt=S(Ge.transform.rCenter,Qe.rCenter),Dt=function(kt){return Gt(Math.pow(kt,Ft))};return function(kt){var Ue=He(kt),qe=vt(kt),Ve=Rt(kt),Ae=Dt(kt),Ne=ie(Ue,(qe+Ve)/2),Xe=Le(kt),Je={pxmid:Ne,rpx1:Ue,transform:{textPosAngle:Xe,rCenter:Ae,x:Qe.x,y:Qe.y}};return r(R.type,Qe,k),{transform:{targetX:ye(Je),targetY:ue(Je),scale:rr(kt),rotate:Lt(kt),rCenter:Ae}}}}function Ye(be){var Pe=be.parent,Ge=N[u.getPtId(Pe)],Qe={};if(Ge){var Be=Pe.children,Le=Be.indexOf(be),He=Be.length,vt=S(Ge.x0,Ge.x1);Qe.x0=vt(Le/He),Qe.x1=vt(Le/He)}else Qe.x0=Qe.x1=0;return Qe}}function s(x){return v.partition().size([2*Math.PI,x.height+1])(x)}te.formatSliceLabel=function(x,l,L,T,k){var P=L.texttemplate,z=L.textinfo;if(!P&&(!z||z==="none"))return"";var I=k.separators,D=T[0],R=x.data.data,B=D.hierarchy,F=u.isHierarchyRoot(x),H=u.getParent(B,x),G=u.getValue(x);if(!P){var J=z.split("+"),X=function(W){return J.indexOf(W)!==-1},Y=[],Z;if(X("label")&&R.label&&Y.push(R.label),R.hasOwnProperty("v")&&X("value")&&Y.push(u.formatValue(R.v,I)),!F){X("current path")&&Y.push(u.getPath(x.data));var oe=0;X("percent parent")&&oe++,X("percent entry")&&oe++,X("percent root")&&oe++;var re=oe>1;if(oe){var se,N=function(W){Z=u.formatPercent(se,I),re&&(Z+=" of "+W),Y.push(Z)};X("percent parent")&&!F&&(se=G/u.getValue(H),N("parent")),X("percent entry")&&(se=G/u.getValue(l),N("entry")),X("percent root")&&(se=G/u.getValue(B),N("root"))}}return X("text")&&(Z=e.castOption(L,R.i,"text"),e.isValidTextValue(Z)&&Y.push(Z)),Y.join("<br>")}var U=e.castOption(L,R.i,"texttemplate");if(!U)return"";var q={};R.label&&(q.label=R.label),R.hasOwnProperty("v")&&(q.value=R.v,q.valueLabel=u.formatValue(R.v,I)),q.currentPath=u.getPath(x.data),F||(q.percentParent=G/u.getValue(H),q.percentParentLabel=u.formatPercent(q.percentParent,I),q.parent=u.getPtLabel(H)),q.percentEntry=G/u.getValue(l),q.percentEntryLabel=u.formatPercent(q.percentEntry,I),q.entry=u.getPtLabel(l),q.percentRoot=G/u.getValue(B),q.percentRootLabel=u.formatPercent(q.percentRoot,I),q.root=u.getPtLabel(B),R.hasOwnProperty("color")&&(q.color=R.color);var $=e.castOption(L,R.i,"text");return(e.isValidTextValue($)||$==="")&&(q.text=$),q.customdata=e.castOption(L,R.i,"customdata"),e.texttemplateString(U,q,k._d3locale,q,L._meta||{})};function A(x){return x.rpx0===0&&e.isFullCircle([x.x0,x.x1])?1:Math.max(0,Math.min(1/(1+1/Math.sin(x.halfangle)),x.ring/2))}function b(x){return f(x.rpx1,x.transform.textPosAngle)}function f(x,l){return[x*Math.sin(l),-x*Math.cos(l)]}},{"../../components/drawing":389,"../../lib":515,"../../lib/svg_text_utils":541,"../bar/style":671,"../bar/uniform_text":673,"../pie/helpers":915,"../pie/plot":919,"./constants":1061,"./fx":1063,"./helpers":1064,"./style":1069,"@plotly/d3":58,"d3-hierarchy":115,"d3-interpolate":116}],1069:[function(d,ee,te){var w=d("@plotly/d3"),v=d("../../components/color"),S=d("../../lib"),M=d("../bar/uniform_text").resizeText;function e(n){var r=n._fullLayout._sunburstlayer.selectAll(".trace");M(n,r,"sunburst"),r.each(function(t){var c=w.select(this),o=t[0],i=o.trace;c.style("opacity",i.opacity),c.selectAll("path.surface").each(function(y){w.select(this).call(a,y,i)})})}function a(n,r,t){var c=r.data.data,o=!r.children,i=c.i,y=S.castOption(t,i,"marker.line.color")||v.defaultLine,p=S.castOption(t,i,"marker.line.width")||0;n.style("stroke-width",p).call(v.fill,c.color).call(v.stroke,y).style("opacity",o?t.leaf.opacity:null)}ee.exports={style:e,styleOne:a}},{"../../components/color":367,"../../lib":515,"../bar/uniform_text":673,"@plotly/d3":58}],1070:[function(d,ee,te){var w=d("../../components/color"),v=d("../../components/colorscale/attributes"),S=d("../../plots/cartesian/axis_format_attributes").axisHoverFormat,M=d("../../plots/template_attributes").hovertemplateAttrs,e=d("../../plots/attributes"),a=d("../../lib/extend").extendFlat,n=d("../../plot_api/edit_types").overrideAll;function r(o){return{valType:"boolean",dflt:!1}}function t(o){return{show:{valType:"boolean",dflt:!1},start:{valType:"number",dflt:null,editType:"plot"},end:{valType:"number",dflt:null,editType:"plot"},size:{valType:"number",dflt:null,min:0,editType:"plot"},project:{x:r(),y:r(),z:r()},color:{valType:"color",dflt:w.defaultLine},usecolormap:{valType:"boolean",dflt:!1},width:{valType:"number",min:1,max:16,dflt:2},highlight:{valType:"boolean",dflt:!0},highlightcolor:{valType:"color",dflt:w.defaultLine},highlightwidth:{valType:"number",min:1,max:16,dflt:2}}}var c=ee.exports=n(a({z:{valType:"data_array"},x:{valType:"data_array"},y:{valType:"data_array"},text:{valType:"string",dflt:"",arrayOk:!0},hovertext:{valType:"string",dflt:"",arrayOk:!0},hovertemplate:M(),xhoverformat:S("x"),yhoverformat:S("y"),zhoverformat:S("z"),connectgaps:{valType:"boolean",dflt:!1,editType:"calc"},surfacecolor:{valType:"data_array"}},v("",{colorAttr:"z or surfacecolor",showScaleDflt:!0,autoColorDflt:!1,editTypeOverride:"calc"}),{contours:{x:t(),y:t(),z:t()},hidesurface:{valType:"boolean",dflt:!1},lightposition:{x:{valType:"number",min:-1e5,max:1e5,dflt:10},y:{valType:"number",min:-1e5,max:1e5,dflt:1e4},z:{valType:"number",min:-1e5,max:1e5,dflt:0}},lighting:{ambient:{valType:"number",min:0,max:1,dflt:.8},diffuse:{valType:"number",min:0,max:1,dflt:.8},specular:{valType:"number",min:0,max:2,dflt:.05},roughness:{valType:"number",min:0,max:1,dflt:.5},fresnel:{valType:"number",min:0,max:5,dflt:.2}},opacity:{valType:"number",min:0,max:1,dflt:1},opacityscale:{valType:"any",editType:"calc"},_deprecated:{zauto:a({},v.zauto,{}),zmin:a({},v.zmin,{}),zmax:a({},v.zmax,{})},hoverinfo:a({},e.hoverinfo),showlegend:a({},e.showlegend,{dflt:!1})}),"calc","nested");c.x.editType=c.y.editType=c.z.editType="calc+clearAxisTypes",c.transforms=void 0},{"../../components/color":367,"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642}],1071:[function(d,ee,te){var w=d("../../components/colorscale/calc");ee.exports=function(S,M){M.surfacecolor?w(S,M,{vals:M.surfacecolor,containerStr:"",cLetter:"c"}):w(S,M,{vals:M.z,containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":375}],1072:[function(d,ee,te){var w=d("../../../stackgl_modules").gl_surface3d,v=d("../../../stackgl_modules").ndarray,S=d("../../../stackgl_modules").ndarray_linear_interpolate.d2,M=d("../heatmap/interp2d"),e=d("../heatmap/find_empties"),a=d("../../lib").isArrayOrTypedArray,n=d("../../lib/gl_format_color").parseColorScale,r=d("../../lib/str2rgbarray"),t=d("../../components/colorscale").extractOpts;function c(T,k,P){this.scene=T,this.uid=P,this.surface=k,this.data=null,this.showContour=[!1,!1,!1],this.contourStart=[null,null,null],this.contourEnd=[null,null,null],this.contourSize=[0,0,0],this.minValues=[1/0,1/0,1/0],this.maxValues=[-1/0,-1/0,-1/0],this.dataScaleX=1,this.dataScaleY=1,this.refineData=!0,this.objectOffset=[0,0,0]}var o=c.prototype;o.getXat=function(T,k,P,z){var I=a(this.data.x)?a(this.data.x[0])?this.data.x[k][T]:this.data.x[T]:T;return P===void 0?I:z.d2l(I,0,P)},o.getYat=function(T,k,P,z){var I=a(this.data.y)?a(this.data.y[0])?this.data.y[k][T]:this.data.y[k]:k;return P===void 0?I:z.d2l(I,0,P)},o.getZat=function(T,k,P,z){var I=this.data.z[k][T];return I===null&&this.data.connectgaps&&this.data._interpolatedZ&&(I=this.data._interpolatedZ[k][T]),P===void 0?I:z.d2l(I,0,P)},o.handlePick=function(T){if(T.object===this.surface){var k=(T.data.index[0]-1)/this.dataScaleX-1,P=(T.data.index[1]-1)/this.dataScaleY-1,z=Math.max(Math.min(Math.round(k),this.data.z[0].length-1),0),I=Math.max(Math.min(Math.round(P),this.data._ylength-1),0);T.index=[z,I],T.traceCoordinate=[this.getXat(z,I),this.getYat(z,I),this.getZat(z,I)],T.dataCoordinate=[this.getXat(z,I,this.data.xcalendar,this.scene.fullSceneLayout.xaxis),this.getYat(z,I,this.data.ycalendar,this.scene.fullSceneLayout.yaxis),this.getZat(z,I,this.data.zcalendar,this.scene.fullSceneLayout.zaxis)];for(var D=0;D<3;D++){var R=T.dataCoordinate[D];R!=null&&(T.dataCoordinate[D]*=this.scene.dataScale[D])}var B=this.data.hovertext||this.data.text;return Array.isArray(B)&&B[I]&&B[I][z]!==void 0?T.textLabel=B[I][z]:B?T.textLabel=B:T.textLabel="",T.data.dataCoordinate=T.dataCoordinate.slice(),this.surface.highlight(T.data),this.scene.glplot.spikes.position=T.dataCoordinate,!0}};function i(T){var k=T[0].rgb,P=T[T.length-1].rgb;return k[0]===P[0]&&k[1]===P[1]&&k[2]===P[2]&&k[3]===P[3]}var y=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997,1009,1013,1019,1021,1031,1033,1039,1049,1051,1061,1063,1069,1087,1091,1093,1097,1103,1109,1117,1123,1129,1151,1153,1163,1171,1181,1187,1193,1201,1213,1217,1223,1229,1231,1237,1249,1259,1277,1279,1283,1289,1291,1297,1301,1303,1307,1319,1321,1327,1361,1367,1373,1381,1399,1409,1423,1427,1429,1433,1439,1447,1451,1453,1459,1471,1481,1483,1487,1489,1493,1499,1511,1523,1531,1543,1549,1553,1559,1567,1571,1579,1583,1597,1601,1607,1609,1613,1619,1621,1627,1637,1657,1663,1667,1669,1693,1697,1699,1709,1721,1723,1733,1741,1747,1753,1759,1777,1783,1787,1789,1801,1811,1823,1831,1847,1861,1867,1871,1873,1877,1879,1889,1901,1907,1913,1931,1933,1949,1951,1973,1979,1987,1993,1997,1999,2003,2011,2017,2027,2029,2039,2053,2063,2069,2081,2083,2087,2089,2099,2111,2113,2129,2131,2137,2141,2143,2153,2161,2179,2203,2207,2213,2221,2237,2239,2243,2251,2267,2269,2273,2281,2287,2293,2297,2309,2311,2333,2339,2341,2347,2351,2357,2371,2377,2381,2383,2389,2393,2399,2411,2417,2423,2437,2441,2447,2459,2467,2473,2477,2503,2521,2531,2539,2543,2549,2551,2557,2579,2591,2593,2609,2617,2621,2633,2647,2657,2659,2663,2671,2677,2683,2687,2689,2693,2699,2707,2711,2713,2719,2729,2731,2741,2749,2753,2767,2777,2789,2791,2797,2801,2803,2819,2833,2837,2843,2851,2857,2861,2879,2887,2897,2903,2909,2917,2927,2939,2953,2957,2963,2969,2971,2999];function p(T,k){if(T<k)return 0;for(var P=0;Math.floor(T%k)===0;)T/=k,P++;return P}function g(T){for(var k=[],P=0;P<y.length;P++){var z=y[P];k.push(p(T,z))}return k}function h(T){for(var k=g(T),P=T,z=0;z<y.length;z++)if(k[z]>0){P=y[z];break}return P}function m(T,k){if(!(T<1||k<1)){for(var P=g(T),z=g(k),I=1,D=0;D<y.length;D++)I*=Math.pow(y[D],Math.max(P[D],z[D]));return I}}function u(T){if(T.length!==0){for(var k=1,P=0;P<T.length;P++)k=m(k,T[P]);return k}}o.calcXnums=function(T){var k,P=[];for(k=1;k<T;k++){var z=this.getXat(k-1,0),I=this.getXat(k,0);I!==z&&z!==void 0&&z!==null&&I!==void 0&&I!==null?P[k-1]=Math.abs(I-z):P[k-1]=0}var D=0;for(k=1;k<T;k++)D+=P[k-1];for(k=1;k<T;k++)P[k-1]===0?P[k-1]=1:P[k-1]=Math.round(D/P[k-1]);return P},o.calcYnums=function(T){var k,P=[];for(k=1;k<T;k++){var z=this.getYat(0,k-1),I=this.getYat(0,k);I!==z&&z!==void 0&&z!==null&&I!==void 0&&I!==null?P[k-1]=Math.abs(I-z):P[k-1]=0}var D=0;for(k=1;k<T;k++)D+=P[k-1];for(k=1;k<T;k++)P[k-1]===0?P[k-1]=1:P[k-1]=Math.round(D/P[k-1]);return P};var _=[1,2,4,6,12,24,36,48,60,120,180,240,360,720,840,1260],s=_[9],A=_[13];o.estimateScale=function(T,k){for(var P=k===0?this.calcXnums(T):this.calcYnums(T),z=1+u(P);z<s;)z*=2;for(;z>A;)z--,z/=h(z),z++,z<s&&(z=A);var I=Math.round(z/T);return I>1?I:1};function b(T,k,P){var z=P[8]+P[2]*k[0]+P[5]*k[1];return T[0]=(P[6]+P[0]*k[0]+P[3]*k[1])/z,T[1]=(P[7]+P[1]*k[0]+P[4]*k[1])/z,T}function f(T,k,P){return x(T,k,b,P),T}function x(T,k,P,z){for(var I=[0,0],D=T.shape[0],R=T.shape[1],B=0;B<D;B++)for(var F=0;F<R;F++)P(I,[B,F],z),T.set(B,F,S(k,I[0],I[1]));return T}o.refineCoords=function(T){for(var k=this.dataScaleX,P=this.dataScaleY,z=T[0].shape[0],I=T[0].shape[1],D=Math.floor(T[0].shape[0]*k+1)|0,R=Math.floor(T[0].shape[1]*P+1)|0,B=1+z+1,F=1+I+1,H=v(new Float32Array(B*F),[B,F]),G=[1/k,0,0,0,1/P,0,0,0,1],J=0;J<T.length;++J){this.surface.padField(H,T[J]);var X=v(new Float32Array(D*R),[D,R]);f(X,H,G),T[J]=X}};function l(T,k){for(var P=!1,z=0;z<T.length;z++)if(k===T[z]){P=!0;break}P===!1&&T.push(k)}o.setContourLevels=function(){var T=[[],[],[]],k=[!1,!1,!1],P=!1,z,I,D;for(z=0;z<3;++z)if(this.showContour[z]&&(P=!0,this.contourSize[z]>0&&this.contourStart[z]!==null&&this.contourEnd[z]!==null&&this.contourEnd[z]>this.contourStart[z]))for(k[z]=!0,I=this.contourStart[z];I<this.contourEnd[z];I+=this.contourSize[z])D=I*this.scene.dataScale[z],l(T[z],D);if(P){var R=[[],[],[]];for(z=0;z<3;++z)this.showContour[z]&&(R[z]=k[z]?T[z]:this.scene.contourLevels[z]);this.surface.update({levels:R})}},o.update=function(T){var k=this.scene,P=k.fullSceneLayout,z=this.surface,I=n(T),D=k.dataScale,R=T.z[0].length,B=T._ylength,F=k.contourLevels;this.data=T;var H,G,J,X,Y=[];for(H=0;H<3;H++)for(Y[H]=[],G=0;G<R;G++)Y[H][G]=[];for(G=0;G<R;G++)for(J=0;J<B;J++)Y[0][G][J]=this.getXat(G,J,T.xcalendar,P.xaxis),Y[1][G][J]=this.getYat(G,J,T.ycalendar,P.yaxis),Y[2][G][J]=this.getZat(G,J,T.zcalendar,P.zaxis);if(T.connectgaps)for(T._emptypoints=e(Y[2]),M(Y[2],T._emptypoints),T._interpolatedZ=[],G=0;G<R;G++)for(T._interpolatedZ[G]=[],J=0;J<B;J++)T._interpolatedZ[G][J]=Y[2][G][J];for(H=0;H<3;H++)for(G=0;G<R;G++)for(J=0;J<B;J++)X=Y[H][G][J],X==null?Y[H][G][J]=NaN:X=Y[H][G][J]*=D[H];for(H=0;H<3;H++)for(G=0;G<R;G++)for(J=0;J<B;J++)X=Y[H][G][J],X!=null&&(this.minValues[H]>X&&(this.minValues[H]=X),this.maxValues[H]<X&&(this.maxValues[H]=X));for(H=0;H<3;H++)this.objectOffset[H]=.5*(this.minValues[H]+this.maxValues[H]);for(H=0;H<3;H++)for(G=0;G<R;G++)for(J=0;J<B;J++)X=Y[H][G][J],X!=null&&(Y[H][G][J]-=this.objectOffset[H]);var Z=[v(new Float32Array(R*B),[R,B]),v(new Float32Array(R*B),[R,B]),v(new Float32Array(R*B),[R,B])];for(H=0;H<3;H++)for(G=0;G<R;G++)for(J=0;J<B;J++)Z[H].set(G,J,Y[H][G][J]);Y=[];var oe={colormap:I,levels:[[],[],[]],showContour:[!0,!0,!0],showSurface:!T.hidesurface,contourProject:[[!1,!1,!1],[!1,!1,!1],[!1,!1,!1]],contourWidth:[1,1,1],contourColor:[[1,1,1,1],[1,1,1,1],[1,1,1,1]],contourTint:[1,1,1],dynamicColor:[[1,1,1,1],[1,1,1,1],[1,1,1,1]],dynamicWidth:[1,1,1],dynamicTint:[1,1,1],opacityscale:T.opacityscale,opacity:T.opacity},re=t(T);if(oe.intensityBounds=[re.min,re.max],T.surfacecolor){var se=v(new Float32Array(R*B),[R,B]);for(G=0;G<R;G++)for(J=0;J<B;J++)se.set(G,J,T.surfacecolor[J][G]);Z.push(se)}else oe.intensityBounds[0]*=D[2],oe.intensityBounds[1]*=D[2];(A<Z[0].shape[0]||A<Z[0].shape[1])&&(this.refineData=!1),this.refineData===!0&&(this.dataScaleX=this.estimateScale(Z[0].shape[0],0),this.dataScaleY=this.estimateScale(Z[0].shape[1],1),(this.dataScaleX!==1||this.dataScaleY!==1)&&this.refineCoords(Z)),T.surfacecolor&&(oe.intensity=Z.pop());var N=[!0,!0,!0],U=["x","y","z"];for(H=0;H<3;++H){var q=T.contours[U[H]];N[H]=q.highlight,oe.showContour[H]=q.show||q.highlight,oe.showContour[H]&&(oe.contourProject[H]=[q.project.x,q.project.y,q.project.z],q.show?(this.showContour[H]=!0,oe.levels[H]=F[H],z.highlightColor[H]=oe.contourColor[H]=r(q.color),q.usecolormap?z.highlightTint[H]=oe.contourTint[H]=0:z.highlightTint[H]=oe.contourTint[H]=1,oe.contourWidth[H]=q.width,this.contourStart[H]=q.start,this.contourEnd[H]=q.end,this.contourSize[H]=q.size):(this.showContour[H]=!1,this.contourStart[H]=null,this.contourEnd[H]=null,this.contourSize[H]=0),q.highlight&&(oe.dynamicColor[H]=r(q.highlightcolor),oe.dynamicWidth[H]=q.highlightwidth))}i(I)&&(oe.vertexColor=!0),oe.objectOffset=this.objectOffset,oe.coords=Z,z.update(oe),z.visible=T.visible,z.enableDynamic=N,z.enableHighlight=N,z.snapToData=!0,"lighting"in T&&(z.ambientLight=T.lighting.ambient,z.diffuseLight=T.lighting.diffuse,z.specularLight=T.lighting.specular,z.roughness=T.lighting.roughness,z.fresnel=T.lighting.fresnel),"lightposition"in T&&(z.lightPosition=[T.lightposition.x,T.lightposition.y,T.lightposition.z])},o.dispose=function(){this.scene.glplot.remove(this.surface),this.surface.dispose()};function L(T,k){var P=T.glplot.gl,z=w({gl:P}),I=new c(T,z,k.uid);return z._trace=I,I.update(k),T.glplot.add(z),I}ee.exports=L},{"../../../stackgl_modules":1133,"../../components/colorscale":379,"../../lib":515,"../../lib/gl_format_color":511,"../../lib/str2rgbarray":540,"../heatmap/find_empties":807,"../heatmap/interp2d":810}],1073:[function(d,ee,te){var w=d("../../registry"),v=d("../../lib"),S=d("../../components/colorscale/defaults"),M=d("./attributes"),e=.1;function a(o,i){for(var y=[],p=32,g=0;g<p;g++){var h=g/(p-1),m=i+(1-i)*(1-Math.pow(Math.sin(o*h*Math.PI),2));y.push([h,Math.max(0,Math.min(1,m))])}return y}function n(o){var i=0;if(!Array.isArray(o)||o.length<2||!o[0]||!o[o.length-1]||+o[0][0]!=0||+o[o.length-1][0]!=1)return!1;for(var y=0;y<o.length;y++){var p=o[y];if(p.length!==2||+p[0]<i)return!1;i=+p[0]}return!0}function r(o,i,y,p){var g,h;function m(T,k){return v.coerce(o,i,M,T,k)}var u=m("x"),_=m("y"),s=m("z");if(!s||!s.length||(u?u.length<1:!1)||(_?_.length<1:!1)){i.visible=!1;return}i._xlength=Array.isArray(u)&&v.isArrayOrTypedArray(u[0])?s.length:s[0].length,i._ylength=s.length;var A=w.getComponentMethod("calendars","handleTraceDefaults");A(o,i,["x","y","z"],p),m("text"),m("hovertext"),m("hovertemplate"),m("xhoverformat"),m("yhoverformat"),m("zhoverformat"),["lighting.ambient","lighting.diffuse","lighting.specular","lighting.roughness","lighting.fresnel","lightposition.x","lightposition.y","lightposition.z","hidesurface","connectgaps","opacity"].forEach(function(T){m(T)});var b=m("surfacecolor"),f=["x","y","z"];for(g=0;g<3;++g){var x="contours."+f[g],l=m(x+".show"),L=m(x+".highlight");if(l||L)for(h=0;h<3;++h)m(x+".project."+f[h]);l&&(m(x+".color"),m(x+".width"),m(x+".usecolormap")),L&&(m(x+".highlightcolor"),m(x+".highlightwidth")),m(x+".start"),m(x+".end"),m(x+".size")}b||(c(o,"zmin","cmin"),c(o,"zmax","cmax"),c(o,"zauto","cauto")),S(o,i,p,m,{prefix:"",cLetter:"c"}),t(o,i,p,m),i._length=null}function t(o,i,y,p){var g=p("opacityscale");g==="max"?i.opacityscale=[[0,e],[1,1]]:g==="min"?i.opacityscale=[[0,1],[1,e]]:g==="extremes"?i.opacityscale=a(1,e):n(g)||(i.opacityscale=void 0)}function c(o,i,y){i in o&&!(y in o)&&(o[y]=o[i])}ee.exports={supplyDefaults:r,opacityscaleDefaults:t}},{"../../components/colorscale/defaults":377,"../../lib":515,"../../registry":647,"./attributes":1070}],1074:[function(d,ee,te){ee.exports={attributes:d("./attributes"),supplyDefaults:d("./defaults").supplyDefaults,colorbar:{min:"cmin",max:"cmax"},calc:d("./calc"),plot:d("./convert"),moduleType:"trace",name:"surface",basePlotModule:d("../../plots/gl3d"),categories:["gl3d","2dMap","showLegend"],meta:{}}},{"../../plots/gl3d":607,"./attributes":1070,"./calc":1071,"./convert":1072,"./defaults":1073}],1075:[function(d,ee,te){var w=d("../../components/annotations/attributes"),v=d("../../lib/extend").extendFlat,S=d("../../plot_api/edit_types").overrideAll,M=d("../../plots/font_attributes"),e=d("../../plots/domain").attributes,a=d("../../plots/cartesian/axis_format_attributes").descriptionOnlyNumbers,n=ee.exports=S({domain:e({name:"table",trace:!0}),columnwidth:{valType:"number",arrayOk:!0,dflt:null},columnorder:{valType:"data_array"},header:{values:{valType:"data_array",dflt:[]},format:{valType:"data_array",dflt:[],description:a("cell value")},prefix:{valType:"string",arrayOk:!0,dflt:null},suffix:{valType:"string",arrayOk:!0,dflt:null},height:{valType:"number",dflt:28},align:v({},w.align,{arrayOk:!0}),line:{width:{valType:"number",arrayOk:!0,dflt:1},color:{valType:"color",arrayOk:!0,dflt:"grey"}},fill:{color:{valType:"color",arrayOk:!0,dflt:"white"}},font:v({},M({arrayOk:!0}))},cells:{values:{valType:"data_array",dflt:[]},format:{valType:"data_array",dflt:[],description:a("cell value")},prefix:{valType:"string",arrayOk:!0,dflt:null},suffix:{valType:"string",arrayOk:!0,dflt:null},height:{valType:"number",dflt:20},align:v({},w.align,{arrayOk:!0}),line:{width:{valType:"number",arrayOk:!0,dflt:1},color:{valType:"color",arrayOk:!0,dflt:"grey"}},fill:{color:{valType:"color",arrayOk:!0,dflt:"white"}},font:v({},M({arrayOk:!0}))}},"calc","from-root");n.transforms=void 0},{"../../components/annotations/attributes":350,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plots/cartesian/axis_format_attributes":569,"../../plots/domain":593,"../../plots/font_attributes":594}],1076:[function(d,ee,te){var w=d("../../plots/get_data").getModuleCalcData,v=d("./plot"),S="table";te.name=S,te.plot=function(M){var e=w(M.calcdata,S)[0];e.length&&v(M,e)},te.clean=function(M,e,a,n){var r=n._has&&n._has(S),t=e._has&&e._has(S);r&&!t&&n._paperdiv.selectAll(".table").remove()}},{"../../plots/get_data":602,"./plot":1083}],1077:[function(d,ee,te){var w=d("../../lib/gup").wrap;ee.exports=function(){return w({})}},{"../../lib/gup":512}],1078:[function(d,ee,te){ee.exports={cellPad:8,columnExtentOffset:10,columnTitleOffset:28,emptyHeaderHeight:16,latexCheck:/^\$.*\$$/,goldenRatio:1.618,lineBreaker:"<br>",maxDimensionCount:60,overdrag:45,releaseTransitionDuration:120,releaseTransitionEase:"cubic-out",scrollbarCaptureWidth:18,scrollbarHideDelay:1e3,scrollbarHideDuration:1e3,scrollbarOffset:5,scrollbarWidth:8,transitionDuration:100,transitionEase:"cubic-out",uplift:5,wrapSpacer:" ",wrapSplitCharacter:" ",cn:{table:"table",tableControlView:"table-control-view",scrollBackground:"scroll-background",yColumn:"y-column",columnBlock:"column-block",scrollAreaClip:"scroll-area-clip",scrollAreaClipRect:"scroll-area-clip-rect",columnBoundary:"column-boundary",columnBoundaryClippath:"column-boundary-clippath",columnBoundaryRect:"column-boundary-rect",columnCells:"column-cells",columnCell:"column-cell",cellRect:"cell-rect",cellText:"cell-text",cellTextHolder:"cell-text-holder",scrollbarKit:"scrollbar-kit",scrollbar:"scrollbar",scrollbarSlider:"scrollbar-slider",scrollbarGlyph:"scrollbar-glyph",scrollbarCaptureZone:"scrollbar-capture-zone"}}},{}],1079:[function(d,ee,te){var w=d("./constants"),v=d("../../lib/extend").extendFlat,S=d("fast-isnumeric");ee.exports=function(y,p){var g=a(p.cells.values),h=function(G){return G.slice(p.header.values.length,G.length)},m=a(p.header.values);m.length&&!m[0].length&&(m[0]=[""],m=a(m));var u=m.concat(h(g).map(function(){return n((m[0]||[""]).length)})),_=p.domain,s=Math.floor(y._fullLayout._size.w*(_.x[1]-_.x[0])),A=Math.floor(y._fullLayout._size.h*(_.y[1]-_.y[0])),b=p.header.values.length?u[0].map(function(){return p.header.height}):[w.emptyHeaderHeight],f=g.length?g[0].map(function(){return p.cells.height}):[],x=b.reduce(e,0),l=A-x,L=l+w.uplift,T=c(f,L),k=c(b,x),P=t(k,[]),z=t(T,P),I={},D=p._fullInput.columnorder.concat(h(g.map(function(G,J){return J}))),R=u.map(function(G,J){var X=Array.isArray(p.columnwidth)?p.columnwidth[Math.min(J,p.columnwidth.length-1)]:p.columnwidth;return S(X)?Number(X):1}),B=R.reduce(e,0);R=R.map(function(G){return G/B*s});var F=Math.max(M(p.header.line.width),M(p.cells.line.width)),H={key:p.uid+y._context.staticPlot,translateX:_.x[0]*y._fullLayout._size.w,translateY:y._fullLayout._size.h*(1-_.y[1]),size:y._fullLayout._size,width:s,maxLineWidth:F,height:A,columnOrder:D,groupHeight:A,rowBlocks:z,headerRowBlocks:P,scrollY:0,cells:v({},p.cells,{values:g}),headerCells:v({},p.header,{values:u}),gdColumns:u.map(function(G){return G[0]}),gdColumnsOriginalOrder:u.map(function(G){return G[0]}),prevPages:[0,0],scrollbarState:{scrollbarScrollInProgress:!1},columns:u.map(function(G,J){var X=I[G];I[G]=(X||0)+1;var Y=G+"__"+I[G];return{key:Y,label:G,specIndex:J,xIndex:D[J],xScale:r,x:void 0,calcdata:void 0,columnWidth:R[J]}})};return H.columns.forEach(function(G){G.calcdata=H,G.x=r(G)}),H};function M(i){if(Array.isArray(i)){for(var y=0,p=0;p<i.length;p++)y=Math.max(y,M(i[p]));return y}return i}function e(i,y){return i+y}function a(i){var y=i.slice(),p=1/0,g=0,h;for(h=0;h<y.length;h++)Array.isArray(y[h])||(y[h]=[y[h]]),p=Math.min(p,y[h].length),g=Math.max(g,y[h].length);if(p!==g)for(h=0;h<y.length;h++){var m=g-y[h].length;m&&(y[h]=y[h].concat(n(m)))}return y}function n(i){for(var y=new Array(i),p=0;p<i;p++)y[p]="";return y}function r(i){return i.calcdata.columns.reduce(function(y,p){return p.xIndex<i.xIndex?y+p.columnWidth:y},0)}function t(i,y){var p=Object.keys(i);return p.map(function(g){return v({},i[g],{auxiliaryBlocks:y})})}function c(i,y){for(var p={},g,h=0,m=0,u=o(),_=0,s=0,A=0;A<i.length;A++)g=i[A],u.rows.push({rowIndex:A,rowHeight:g}),m+=g,(m>=y||A===i.length-1)&&(p[h]=u,u.key=s++,u.firstRowIndex=_,u.lastRowIndex=A,u=o(),h+=m,_=A+1,m=0);return p}function o(){return{firstRowIndex:null,lastRowIndex:null,rows:[]}}},{"../../lib/extend":505,"./constants":1078,"fast-isnumeric":190}],1080:[function(d,ee,te){var w=d("../../lib/extend").extendFlat;te.splitToPanels=function(S){var M=[0,0],e=w({},S,{key:"header",type:"header",page:0,prevPages:M,currentRepaint:[null,null],dragHandle:!0,values:S.calcdata.headerCells.values[S.specIndex],rowBlocks:S.calcdata.headerRowBlocks,calcdata:w({},S.calcdata,{cells:S.calcdata.headerCells})}),a=w({},S,{key:"cells1",type:"cells",page:0,prevPages:M,currentRepaint:[null,null],dragHandle:!1,values:S.calcdata.cells.values[S.specIndex],rowBlocks:S.calcdata.rowBlocks}),n=w({},S,{key:"cells2",type:"cells",page:1,prevPages:M,currentRepaint:[null,null],dragHandle:!1,values:S.calcdata.cells.values[S.specIndex],rowBlocks:S.calcdata.rowBlocks});return[a,n,e]},te.splitToCells=function(S){var M=v(S);return(S.values||[]).slice(M[0],M[1]).map(function(e,a){var n=typeof e=="string"&&e.match(/[<$&> ]/)?"_keybuster_"+Math.random():"";return{keyWithinBlock:a+n,key:M[0]+a,column:S,calcdata:S.calcdata,page:S.page,rowBlocks:S.rowBlocks,value:e}})};function v(S){var M=S.rowBlocks[S.page],e=M?M.rows[0].rowIndex:0,a=M?e+M.rows.length:0;return[e,a]}},{"../../lib/extend":505}],1081:[function(d,ee,te){var w=d("../../lib"),v=d("./attributes"),S=d("../../plots/domain").defaults;function M(e,a){for(var n=e.columnorder||[],r=e.header.values.length,t=n.slice(0,r),c=t.slice().sort(function(y,p){return y-p}),o=t.map(function(y){return c.indexOf(y)}),i=o.length;i<r;i++)o.push(i);a("columnorder",o)}ee.exports=function(a,n,r,t){function c(o,i){return w.coerce(a,n,v,o,i)}S(n,t,c),c("columnwidth"),c("header.values"),c("header.format"),c("header.align"),c("header.prefix"),c("header.suffix"),c("header.height"),c("header.line.width"),c("header.line.color"),c("header.fill.color"),w.coerceFont(c,"header.font",w.extendFlat({},t.font)),M(n,c),c("cells.values"),c("cells.format"),c("cells.align"),c("cells.prefix"),c("cells.suffix"),c("cells.height"),c("cells.line.width"),c("cells.line.color"),c("cells.fill.color"),w.coerceFont(c,"cells.font",w.extendFlat({},t.font)),n._length=null}},{"../../lib":515,"../../plots/domain":593,"./attributes":1075}],1082:[function(d,ee,te){ee.exports={attributes:d("./attributes"),supplyDefaults:d("./defaults"),calc:d("./calc"),plot:d("./plot"),moduleType:"trace",name:"table",basePlotModule:d("./base_plot"),categories:["noOpacity"],meta:{}}},{"./attributes":1075,"./base_plot":1076,"./calc":1077,"./defaults":1081,"./plot":1083}],1083:[function(d,ee,te){var w=d("./constants"),v=d("@plotly/d3"),S=d("../../lib"),M=S.numberFormat,e=d("../../lib/gup"),a=d("../../components/drawing"),n=d("../../lib/svg_text_utils"),r=d("../../lib").raiseToTop,t=d("../../lib").strTranslate,c=d("../../lib").cancelTransition,o=d("./data_preparation_helper"),i=d("./data_split_helpers"),y=d("../../components/color");ee.exports=function(ne,ae){var ie=!ne._context.staticPlot,le=ne._fullLayout._paper.selectAll("."+w.cn.table).data(ae.map(function(Be){var Le=e.unwrap(Be),He=Le.trace;return o(ne,He)}),e.keyFun);le.exit().remove(),le.enter().append("g").classed(w.cn.table,!0).attr("overflow","visible").style("box-sizing","content-box").style("position","absolute").style("left",0).style("overflow","visible").style("shape-rendering","crispEdges").style("pointer-events","all"),le.attr("width",function(Be){return Be.width+Be.size.l+Be.size.r}).attr("height",function(Be){return Be.height+Be.size.t+Be.size.b}).attr("transform",function(Be){return t(Be.translateX,Be.translateY)});var ye=le.selectAll("."+w.cn.tableControlView).data(e.repeat,e.keyFun),ue=ye.enter().append("g").classed(w.cn.tableControlView,!0).style("box-sizing","content-box");if(ie){var pe="onwheel"in document?"wheel":"mousewheel";ue.on("mousemove",function(Be){ye.filter(function(Le){return Be===Le}).call(u,ne)}).on(pe,function(Be){if(!Be.scrollbarState.wheeling){Be.scrollbarState.wheeling=!0;var Le=Be.scrollY+v.event.deltaY,He=X(ne,ye,null,Le)(Be);He||(v.event.stopPropagation(),v.event.preventDefault()),Be.scrollbarState.wheeling=!1}}).call(u,ne,!0)}ye.attr("transform",function(Be){return t(Be.size.l,Be.size.t)});var ge=ye.selectAll("."+w.cn.scrollBackground).data(e.repeat,e.keyFun);ge.enter().append("rect").classed(w.cn.scrollBackground,!0).attr("fill","none"),ge.attr("width",function(Be){return Be.width}).attr("height",function(Be){return Be.height}),ye.each(function(Be){a.setClipUrl(v.select(this),g(ne,Be),ne)});var Te=ye.selectAll("."+w.cn.yColumn).data(function(Be){return Be.columns},e.keyFun);Te.enter().append("g").classed(w.cn.yColumn,!0),Te.exit().remove(),Te.attr("transform",function(Be){return t(Be.x,0)}),ie&&Te.call(v.behavior.drag().origin(function(Be){var Le=v.select(this);return R(Le,Be,-w.uplift),r(this),Be.calcdata.columnDragInProgress=!0,u(ye.filter(function(He){return Be.calcdata.key===He.key}),ne),Be}).on("drag",function(Be){var Le=v.select(this),He=function(rr){return(Be===rr?v.event.x:rr.x)+rr.columnWidth/2};Be.x=Math.max(-w.overdrag,Math.min(Be.calcdata.width+w.overdrag-Be.columnWidth,v.event.x));var vt=m(Te).filter(function(rr){return rr.calcdata.key===Be.calcdata.key}),Rt=vt.sort(function(rr,Lt){return He(rr)-He(Lt)});Rt.forEach(function(rr,Lt){rr.xIndex=Lt,rr.x=Be===rr?rr.x:rr.xScale(rr)}),Te.filter(function(rr){return Be!==rr}).transition().ease(w.transitionEase).duration(w.transitionDuration).attr("transform",function(rr){return t(rr.x,0)}),Le.call(c).attr("transform",t(Be.x,-w.uplift))}).on("dragend",function(Be){var Le=v.select(this),He=Be.calcdata;Be.x=Be.xScale(Be),Be.calcdata.columnDragInProgress=!1,R(Le,Be,0),I(ne,He,He.columns.map(function(vt){return vt.xIndex}))})),Te.each(function(Be){a.setClipUrl(v.select(this),h(ne,Be),ne)});var _e=Te.selectAll("."+w.cn.columnBlock).data(i.splitToPanels,e.keyFun);_e.enter().append("g").classed(w.cn.columnBlock,!0).attr("id",function(Be){return Be.key}),_e.style("cursor",function(Be){return Be.dragHandle?"ew-resize":Be.calcdata.scrollbarState.barWiggleRoom?"ns-resize":"default"});var ze=_e.filter(F),Oe=_e.filter(B);ie&&Oe.call(v.behavior.drag().origin(function(Be){return v.event.stopPropagation(),Be}).on("drag",X(ne,ye,-1)).on("dragend",function(){})),_(ne,ye,ze,_e),_(ne,ye,Oe,_e);var Ye=ye.selectAll("."+w.cn.scrollAreaClip).data(e.repeat,e.keyFun);Ye.enter().append("clipPath").classed(w.cn.scrollAreaClip,!0).attr("id",function(Be){return g(ne,Be)});var be=Ye.selectAll("."+w.cn.scrollAreaClipRect).data(e.repeat,e.keyFun);be.enter().append("rect").classed(w.cn.scrollAreaClipRect,!0).attr("x",-w.overdrag).attr("y",-w.uplift).attr("fill","none"),be.attr("width",function(Be){return Be.width+2*w.overdrag}).attr("height",function(Be){return Be.height+w.uplift});var Pe=Te.selectAll("."+w.cn.columnBoundary).data(e.repeat,e.keyFun);Pe.enter().append("g").classed(w.cn.columnBoundary,!0);var Ge=Te.selectAll("."+w.cn.columnBoundaryClippath).data(e.repeat,e.keyFun);Ge.enter().append("clipPath").classed(w.cn.columnBoundaryClippath,!0),Ge.attr("id",function(Be){return h(ne,Be)});var Qe=Ge.selectAll("."+w.cn.columnBoundaryRect).data(e.repeat,e.keyFun);Qe.enter().append("rect").classed(w.cn.columnBoundaryRect,!0).attr("fill","none"),Qe.attr("width",function(Be){return Be.columnWidth+2*p(Be)}).attr("height",function(Be){return Be.calcdata.height+2*p(Be)+w.uplift}).attr("x",function(Be){return-p(Be)}).attr("y",function(Be){return-p(Be)}),J(null,Oe,ye)};function p(K){return Math.ceil(K.calcdata.maxLineWidth/2)}function g(K,ne){return"clip"+K._fullLayout._uid+"_scrollAreaBottomClip_"+ne.key}function h(K,ne){return"clip"+K._fullLayout._uid+"_columnBoundaryClippath_"+ne.calcdata.key+"_"+ne.specIndex}function m(K){return[].concat.apply([],K.map(function(ne){return ne})).map(function(ne){return ne.__data__})}function u(K,ne,ae){function ie(Te){var _e=Te.rowBlocks;return N(_e,_e.length-1)+(_e.length?U(_e[_e.length-1],1/0):1)}var le=K.selectAll("."+w.cn.scrollbarKit).data(e.repeat,e.keyFun);le.enter().append("g").classed(w.cn.scrollbarKit,!0).style("shape-rendering","geometricPrecision"),le.each(function(Te){var _e=Te.scrollbarState;_e.totalHeight=ie(Te),_e.scrollableAreaHeight=Te.groupHeight-H(Te),_e.currentlyVisibleHeight=Math.min(_e.totalHeight,_e.scrollableAreaHeight),_e.ratio=_e.currentlyVisibleHeight/_e.totalHeight,_e.barLength=Math.max(_e.ratio*_e.currentlyVisibleHeight,w.goldenRatio*w.scrollbarWidth),_e.barWiggleRoom=_e.currentlyVisibleHeight-_e.barLength,_e.wiggleRoom=Math.max(0,_e.totalHeight-_e.scrollableAreaHeight),_e.topY=_e.barWiggleRoom===0?0:Te.scrollY/_e.wiggleRoom*_e.barWiggleRoom,_e.bottomY=_e.topY+_e.barLength,_e.dragMultiplier=_e.wiggleRoom/_e.barWiggleRoom}).attr("transform",function(Te){var _e=Te.width+w.scrollbarWidth/2+w.scrollbarOffset;return t(_e,H(Te))});var ye=le.selectAll("."+w.cn.scrollbar).data(e.repeat,e.keyFun);ye.enter().append("g").classed(w.cn.scrollbar,!0);var ue=ye.selectAll("."+w.cn.scrollbarSlider).data(e.repeat,e.keyFun);ue.enter().append("g").classed(w.cn.scrollbarSlider,!0),ue.attr("transform",function(Te){return t(0,Te.scrollbarState.topY||0)});var pe=ue.selectAll("."+w.cn.scrollbarGlyph).data(e.repeat,e.keyFun);pe.enter().append("line").classed(w.cn.scrollbarGlyph,!0).attr("stroke","black").attr("stroke-width",w.scrollbarWidth).attr("stroke-linecap","round").attr("y1",w.scrollbarWidth/2),pe.attr("y2",function(Te){return Te.scrollbarState.barLength-w.scrollbarWidth/2}).attr("stroke-opacity",function(Te){return Te.columnDragInProgress||!Te.scrollbarState.barWiggleRoom||ae?0:.4}),pe.transition().delay(0).duration(0),pe.transition().delay(w.scrollbarHideDelay).duration(w.scrollbarHideDuration).attr("stroke-opacity",0);var ge=ye.selectAll("."+w.cn.scrollbarCaptureZone).data(e.repeat,e.keyFun);ge.enter().append("line").classed(w.cn.scrollbarCaptureZone,!0).attr("stroke","white").attr("stroke-opacity",.01).attr("stroke-width",w.scrollbarCaptureWidth).attr("stroke-linecap","butt").attr("y1",0).on("mousedown",function(Te){var _e=v.event.y,ze=this.getBoundingClientRect(),Oe=Te.scrollbarState,Ye=_e-ze.top,be=v.scale.linear().domain([0,Oe.scrollableAreaHeight]).range([0,Oe.totalHeight]).clamp(!0);Oe.topY<=Ye&&Ye<=Oe.bottomY||X(ne,K,null,be(Ye-Oe.barLength/2))(Te)}).call(v.behavior.drag().origin(function(Te){return v.event.stopPropagation(),Te.scrollbarState.scrollbarScrollInProgress=!0,Te}).on("drag",X(ne,K)).on("dragend",function(){})),ge.attr("y2",function(Te){return Te.scrollbarState.scrollableAreaHeight}),ne._context.staticPlot&&(pe.remove(),ge.remove())}function _(K,ne,ae,ie){var le=s(ae),ye=A(le);l(ye);var ue=b(ye);T(ue);var pe=x(ye),ge=f(pe);L(ge),k(ge,ne,ie,K),se(ye)}function s(K){var ne=K.selectAll("."+w.cn.columnCells).data(e.repeat,e.keyFun);return ne.enter().append("g").classed(w.cn.columnCells,!0),ne.exit().remove(),ne}function A(K){var ne=K.selectAll("."+w.cn.columnCell).data(i.splitToCells,function(ae){return ae.keyWithinBlock});return ne.enter().append("g").classed(w.cn.columnCell,!0),ne.exit().remove(),ne}function b(K){var ne=K.selectAll("."+w.cn.cellRect).data(e.repeat,function(ae){return ae.keyWithinBlock});return ne.enter().append("rect").classed(w.cn.cellRect,!0),ne}function f(K){var ne=K.selectAll("."+w.cn.cellText).data(e.repeat,function(ae){return ae.keyWithinBlock});return ne.enter().append("text").classed(w.cn.cellText,!0).style("cursor",function(){return"auto"}).on("mousedown",function(){v.event.stopPropagation()}),ne}function x(K){var ne=K.selectAll("."+w.cn.cellTextHolder).data(e.repeat,function(ae){return ae.keyWithinBlock});return ne.enter().append("g").classed(w.cn.cellTextHolder,!0).style("shape-rendering","geometricPrecision"),ne}function l(K){K.each(function(ne,ae){var ie=ne.calcdata.cells.font,le=ne.column.specIndex,ye={size:D(ie.size,le,ae),color:D(ie.color,le,ae),family:D(ie.family,le,ae)};ne.rowNumber=ne.key,ne.align=D(ne.calcdata.cells.align,le,ae),ne.cellBorderWidth=D(ne.calcdata.cells.line.width,le,ae),ne.font=ye})}function L(K){K.each(function(ne){a.font(v.select(this),ne.font)})}function T(K){K.attr("width",function(ne){return ne.column.columnWidth}).attr("stroke-width",function(ne){return ne.cellBorderWidth}).each(function(ne){var ae=v.select(this);y.stroke(ae,D(ne.calcdata.cells.line.color,ne.column.specIndex,ne.rowNumber)),y.fill(ae,D(ne.calcdata.cells.fill.color,ne.column.specIndex,ne.rowNumber))})}function k(K,ne,ae,ie){K.text(function(le){var ye=le.column.specIndex,ue=le.rowNumber,pe=le.value,ge=typeof pe=="string",Te=ge&&pe.match(/<br>/i),_e=!ge||Te;le.mayHaveMarkup=ge&&pe.match(/[<&>]/);var ze=P(pe);le.latex=ze;var Oe=ze?"":D(le.calcdata.cells.prefix,ye,ue)||"",Ye=ze?"":D(le.calcdata.cells.suffix,ye,ue)||"",be=ze?null:D(le.calcdata.cells.format,ye,ue)||null,Pe=Oe+(be?M(be)(le.value):le.value)+Ye,Ge;le.wrappingNeeded=!le.wrapped&&!_e&&!ze&&(Ge=z(Pe)),le.cellHeightMayIncrease=Te||ze||le.mayHaveMarkup||(Ge===void 0?z(Pe):Ge),le.needsConvertToTspans=le.mayHaveMarkup||le.wrappingNeeded||le.latex;var Qe;if(le.wrappingNeeded){var Be=w.wrapSplitCharacter===" "?Pe.replace(/<a href=/ig,"<a_href="):Pe,Le=Be.split(w.wrapSplitCharacter),He=w.wrapSplitCharacter===" "?Le.map(function(vt){return vt.replace(/<a_href=/ig,"<a href=")}):Le;le.fragments=He.map(function(vt){return{text:vt,width:null}}),le.fragments.push({fragment:w.wrapSpacer,width:null}),Qe=He.join(w.lineBreaker)+w.lineBreaker+w.wrapSpacer}else delete le.fragments,Qe=Pe;return Qe}).attr("dy",function(le){return le.needsConvertToTspans?0:"0.75em"}).each(function(le){var ye=this,ue=v.select(ye),pe=le.wrappingNeeded?Z:oe;le.needsConvertToTspans?n.convertToTspans(ue,ie,pe(ae,ye,ne,ie,le)):v.select(ye.parentNode).attr("transform",function(ge){return t(re(ge),w.cellPad)}).attr("text-anchor",function(ge){return{left:"start",center:"middle",right:"end"}[ge.align]})})}function P(K){return typeof K=="string"&&K.match(w.latexCheck)}function z(K){return K.indexOf(w.wrapSplitCharacter)!==-1}function I(K,ne,ae){var ie=ne.gdColumnsOriginalOrder;ne.gdColumns.sort(function(le,ye){return ae[ie.indexOf(le)]-ae[ie.indexOf(ye)]}),ne.columnorder=ae,K.emit("plotly_restyle")}function D(K,ne,ae){if(Array.isArray(K)){var ie=K[Math.min(ne,K.length-1)];return Array.isArray(ie)?ie[Math.min(ae,ie.length-1)]:ie}else return K}function R(K,ne,ae){K.transition().ease(w.releaseTransitionEase).duration(w.releaseTransitionDuration).attr("transform",t(ne.x,ae))}function B(K){return K.type==="cells"}function F(K){return K.type==="header"}function H(K){var ne=K.rowBlocks.length?K.rowBlocks[0].auxiliaryBlocks:[];return ne.reduce(function(ae,ie){return ae+U(ie,1/0)},0)}function G(K,ne,ae){for(var ie=[],le=0,ye=0;ye<K.length;ye++){for(var ue=K[ye],pe=ue.rows,ge=0,Te=0;Te<pe.length;Te++)ge+=pe[Te].rowHeight;ue.allRowsHeight=ge;var _e=le+ge,ze=ne,Oe=ze+ae;ze<_e&&Oe>le&&ie.push(ye),le+=ge}return ie}function J(K,ne,ae){var ie=m(ne)[0];if(ie!==void 0){var le=ie.rowBlocks,ye=ie.calcdata,ue=N(le,le.length),pe=ie.calcdata.groupHeight-H(ie),ge=ye.scrollY=Math.max(0,Math.min(ue-pe,ye.scrollY)),Te=G(le,ge,pe);Te.length===1&&(Te[0]===le.length-1?Te.unshift(Te[0]-1):Te.push(Te[0]+1)),Te[0]%2&&Te.reverse(),ne.each(function(_e,ze){_e.page=Te[ze],_e.scrollY=ge}),ne.attr("transform",function(_e){var ze=N(_e.rowBlocks,_e.page)-_e.scrollY;return t(0,ze)}),K&&(Y(K,ae,ne,Te,ie.prevPages,ie,0),Y(K,ae,ne,Te,ie.prevPages,ie,1),u(ae,K))}}function X(K,ne,ae,ie){return function(ye){var ue=ye.calcdata?ye.calcdata:ye,pe=ne.filter(function(ze){return ue.key===ze.key}),ge=ae||ue.scrollbarState.dragMultiplier,Te=ue.scrollY;ue.scrollY=ie===void 0?ue.scrollY+ge*v.event.dy:ie;var _e=pe.selectAll("."+w.cn.yColumn).selectAll("."+w.cn.columnBlock).filter(B);return J(K,_e,pe),ue.scrollY===Te}}function Y(K,ne,ae,ie,le,ye,ue){var pe=ie[ue]!==le[ue];pe&&(clearTimeout(ye.currentRepaint[ue]),ye.currentRepaint[ue]=setTimeout(function(){var ge=ae.filter(function(Te,_e){return _e===ue&&ie[_e]!==le[_e]});_(K,ne,ge,ae),le[ue]=ie[ue]}))}function Z(K,ne,ae,ie){return function(){var ye=v.select(ne.parentNode);ye.each(function(ue){var pe=ue.fragments;ye.selectAll("tspan.line").each(function(Pe,Ge){pe[Ge].width=this.getComputedTextLength()});var ge=pe[pe.length-1].width,Te=pe.slice(0,-1),_e=[],ze,Oe,Ye=0,be=ue.column.columnWidth-2*w.cellPad;for(ue.value="";Te.length;)ze=Te.shift(),Oe=ze.width+ge,Ye+Oe>be&&(ue.value+=_e.join(w.wrapSpacer)+w.lineBreaker,_e=[],Ye=0),_e.push(ze.text),Ye+=Oe;Ye&&(ue.value+=_e.join(w.wrapSpacer)),ue.wrapped=!0}),ye.selectAll("tspan.line").remove(),k(ye.select("."+w.cn.cellText),ae,K,ie),v.select(ne.parentNode.parentNode).call(se)}}function oe(K,ne,ae,ie,le){return function(){if(!le.settledY){var ue=v.select(ne.parentNode),pe=$(le),ge=le.key-pe.firstRowIndex,Te=pe.rows[ge].rowHeight,_e=le.cellHeightMayIncrease?ne.parentNode.getBoundingClientRect().height+2*w.cellPad:Te,ze=Math.max(_e,Te),Oe=ze-pe.rows[ge].rowHeight;Oe&&(pe.rows[ge].rowHeight=ze,K.selectAll("."+w.cn.columnCell).call(se),J(null,K.filter(B),0),u(ae,ie,!0)),ue.attr("transform",function(){var Ye=this,be=Ye.parentNode,Pe=be.getBoundingClientRect(),Ge=v.select(Ye.parentNode).select("."+w.cn.cellRect).node().getBoundingClientRect(),Qe=Ye.transform.baseVal.consolidate(),Be=Ge.top-Pe.top+(Qe?Qe.matrix.f:w.cellPad);return t(re(le,v.select(Ye.parentNode).select("."+w.cn.cellTextHolder).node().getBoundingClientRect().width),Be)}),le.settledY=!0}}}function re(K,ne){switch(K.align){case"left":return w.cellPad;case"right":return K.column.columnWidth-(ne||0)-w.cellPad;case"center":return(K.column.columnWidth-(ne||0))/2;default:return w.cellPad}}function se(K){K.attr("transform",function(ne){var ae=ne.rowBlocks[0].auxiliaryBlocks.reduce(function(ue,pe){return ue+U(pe,1/0)},0),ie=$(ne),le=U(ie,ne.key),ye=le+ae;return t(0,ye)}).selectAll("."+w.cn.cellRect).attr("height",function(ne){return W($(ne),ne.key).rowHeight})}function N(K,ne){for(var ae=0,ie=ne-1;ie>=0;ie--)ae+=q(K[ie]);return ae}function U(K,ne){for(var ae=0,ie=0;ie<K.rows.length&&K.rows[ie].rowIndex<ne;ie++)ae+=K.rows[ie].rowHeight;return ae}function q(K){var ne=K.allRowsHeight;if(ne!==void 0)return ne;for(var ae=0,ie=0;ie<K.rows.length;ie++)ae+=K.rows[ie].rowHeight;return K.allRowsHeight=ae,ae}function $(K){return K.rowBlocks[K.page]}function W(K,ne){return K.rows[ne-K.firstRowIndex]}},{"../../components/color":367,"../../components/drawing":389,"../../lib":515,"../../lib/gup":512,"../../lib/svg_text_utils":541,"./constants":1078,"./data_preparation_helper":1079,"./data_split_helpers":1080,"@plotly/d3":58}],1084:[function(d,ee,te){var w=d("../../plots/template_attributes").hovertemplateAttrs,v=d("../../plots/template_attributes").texttemplateAttrs,S=d("../../components/colorscale/attributes"),M=d("../../plots/domain").attributes,e=d("../pie/attributes"),a=d("../sunburst/attributes"),n=d("./constants"),r=d("../../lib/extend").extendFlat;ee.exports={labels:a.labels,parents:a.parents,values:a.values,branchvalues:a.branchvalues,count:a.count,level:a.level,maxdepth:a.maxdepth,tiling:{packing:{valType:"enumerated",values:["squarify","binary","dice","slice","slice-dice","dice-slice"],dflt:"squarify",editType:"plot"},squarifyratio:{valType:"number",min:1,dflt:1,editType:"plot"},flip:{valType:"flaglist",flags:["x","y"],dflt:"",editType:"plot"},pad:{valType:"number",min:0,dflt:3,editType:"plot"},editType:"calc"},marker:r({pad:{t:{valType:"number",min:0,editType:"plot"},l:{valType:"number",min:0,editType:"plot"},r:{valType:"number",min:0,editType:"plot"},b:{valType:"number",min:0,editType:"plot"},editType:"calc"},colors:a.marker.colors,depthfade:{valType:"enumerated",values:[!0,!1,"reversed"],editType:"style"},line:a.marker.line,editType:"calc"},S("marker",{colorAttr:"colors",anim:!1})),pathbar:{visible:{valType:"boolean",dflt:!0,editType:"plot"},side:{valType:"enumerated",values:["top","bottom"],dflt:"top",editType:"plot"},edgeshape:{valType:"enumerated",values:[">","<","|","/","\\"],dflt:">",editType:"plot"},thickness:{valType:"number",min:12,editType:"plot"},textfont:r({},e.textfont,{}),editType:"calc"},text:e.text,textinfo:a.textinfo,texttemplate:v({editType:"plot"},{keys:n.eventDataKeys.concat(["label","value"])}),hovertext:e.hovertext,hoverinfo:a.hoverinfo,hovertemplate:w({},{keys:n.eventDataKeys}),textfont:e.textfont,insidetextfont:e.insidetextfont,outsidetextfont:r({},e.outsidetextfont,{}),textposition:{valType:"enumerated",values:["top left","top center","top right","middle left","middle center","middle right","bottom left","bottom center","bottom right"],dflt:"top left",editType:"plot"},sort:e.sort,root:a.root,domain:M({name:"treemap",trace:!0,editType:"calc"})}},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/domain":593,"../../plots/template_attributes":642,"../pie/attributes":910,"../sunburst/attributes":1058,"./constants":1087}],1085:[function(d,ee,te){var w=d("../../plots/plots");te.name="treemap",te.plot=function(v,S,M,e){w.plotBasePlot(te.name,v,S,M,e)},te.clean=function(v,S,M,e){w.cleanBasePlot(te.name,v,S,M,e)}},{"../../plots/plots":628}],1086:[function(d,ee,te){var w=d("../sunburst/calc");te.calc=function(v,S){return w.calc(v,S)},te.crossTraceCalc=function(v){return w._runCrossTraceCalc("treemap",v)}},{"../sunburst/calc":1060}],1087:[function(d,ee,te){ee.exports={CLICK_TRANSITION_TIME:750,CLICK_TRANSITION_EASING:"poly",eventDataKeys:["currentPath","root","entry","percentRoot","percentEntry","percentParent"],gapWithPathbar:1}},{}],1088:[function(d,ee,te){var w=d("../../lib"),v=d("./attributes"),S=d("../../components/color"),M=d("../../plots/domain").defaults,e=d("../bar/defaults").handleText,a=d("../bar/constants").TEXTPAD,n=d("../../components/colorscale"),r=n.hasColorscale,t=n.handleDefaults;ee.exports=function(o,i,y,p){function g(k,P){return w.coerce(o,i,v,k,P)}var h=g("labels"),m=g("parents");if(!h||!h.length||!m||!m.length){i.visible=!1;return}var u=g("values");u&&u.length?g("branchvalues"):g("count"),g("level"),g("maxdepth");var _=g("tiling.packing");_==="squarify"&&g("tiling.squarifyratio"),g("tiling.flip"),g("tiling.pad");var s=g("text");g("texttemplate"),i.texttemplate||g("textinfo",Array.isArray(s)?"text+label":"label"),g("hovertext"),g("hovertemplate");var A=g("pathbar.visible"),b="auto";e(o,i,p,g,b,{hasPathbar:A,moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1}),g("textposition");var f=i.textposition.indexOf("bottom")!==-1,x=g("marker.line.width");x&&g("marker.line.color",p.paper_bgcolor);var l=g("marker.colors"),L=i._hasColorscale=r(o,"marker","colors")||(o.marker||{}).coloraxis;L?t(o,i,p,g,{prefix:"marker.",cLetter:"c"}):g("marker.depthfade",!(l||[]).length);var T=i.textfont.size*2;g("marker.pad.t",f?T/4:T),g("marker.pad.l",T/4),g("marker.pad.r",T/4),g("marker.pad.b",f?T:T/4),i._hovered={marker:{line:{width:2,color:S.contrast(p.paper_bgcolor)}}},A&&(g("pathbar.thickness",i.pathbar.textfont.size+2*a),g("pathbar.side"),g("pathbar.edgeshape")),g("sort"),g("root.color"),M(i,p,g),i._length=null}},{"../../components/color":367,"../../components/colorscale":379,"../../lib":515,"../../plots/domain":593,"../bar/constants":659,"../bar/defaults":661,"./attributes":1084}],1089:[function(d,ee,te){var w=d("@plotly/d3"),v=d("../sunburst/helpers"),S=d("../bar/uniform_text"),M=S.clearMinTextSize,e=d("../bar/style").resizeText,a=d("./plot_one");ee.exports=function(r,t,c,o,i){var y=i.type,p=i.drawDescendants,g=r._fullLayout,h=g["_"+y+"layer"],m,u,_=!c;if(M(y,g),m=h.selectAll("g.trace."+y).data(t,function(A){return A[0].trace.uid}),m.enter().append("g").classed("trace",!0).classed(y,!0),m.order(),!g.uniformtext.mode&&v.hasTransition(c)){o&&(u=o());var s=w.transition().duration(c.duration).ease(c.easing).each("end",function(){u&&u()}).each("interrupt",function(){u&&u()});s.each(function(){h.selectAll("g.trace").each(function(A){a(r,A,this,c,p)})})}else m.each(function(A){a(r,A,this,c,p)}),g.uniformtext.mode&&e(r,h.selectAll(".trace"),y);_&&m.exit().remove()}},{"../bar/style":671,"../bar/uniform_text":673,"../sunburst/helpers":1064,"./plot_one":1098,"@plotly/d3":58}],1090:[function(d,ee,te){var w=d("@plotly/d3"),v=d("../../lib"),S=d("../../components/drawing"),M=d("../../lib/svg_text_utils"),e=d("./partition"),a=d("./style").styleOne,n=d("./constants"),r=d("../sunburst/helpers"),t=d("../sunburst/fx"),c=!0;ee.exports=function(i,y,p,g,h){var m=h.barDifY,u=h.width,_=h.height,s=h.viewX,A=h.viewY,b=h.pathSlice,f=h.toMoveInsideSlice,x=h.strTransform,l=h.hasTransition,L=h.handleSlicesExit,T=h.makeUpdateSliceInterpolator,k=h.makeUpdateTextInterpolator,P={},z=i._fullLayout,I=y[0],D=I.trace,R=I.hierarchy,B=u/D._entryDepth,F=r.listPath(p.data,"id"),H=e(R.copy(),[u,_],{packing:"dice",pad:{inner:0,top:0,left:0,right:0,bottom:0}}).descendants();H=H.filter(function(J){var X=F.indexOf(J.data.id);return X===-1?!1:(J.x0=B*X,J.x1=B*(X+1),J.y0=m,J.y1=m+_,J.onPathbar=!0,!0)}),H.reverse(),g=g.data(H,r.getPtId),g.enter().append("g").classed("pathbar",!0),L(g,c,P,[u,_],b),g.order();var G=g;l&&(G=G.transition().each("end",function(){var J=w.select(this);r.setSliceCursor(J,i,{hideOnRoot:!1,hideOnLeaves:!1,isTransitioning:!1})})),G.each(function(J){J._x0=s(J.x0),J._x1=s(J.x1),J._y0=A(J.y0),J._y1=A(J.y1),J._hoverX=s(J.x1-Math.min(u,_)/2),J._hoverY=A(J.y1-_/2);var X=w.select(this),Y=v.ensureSingle(X,"path","surface",function(se){se.style("pointer-events","all")});l?Y.transition().attrTween("d",function(se){var N=T(se,c,P,[u,_]);return function(U){return b(N(U))}}):Y.attr("d",b),X.call(t,p,i,y,{styleOne:a,eventDataKeys:n.eventDataKeys,transitionTime:n.CLICK_TRANSITION_TIME,transitionEasing:n.CLICK_TRANSITION_EASING}).call(r.setSliceCursor,i,{hideOnRoot:!1,hideOnLeaves:!1,isTransitioning:i._transitioning}),Y.call(a,J,D,{hovered:!1}),J._text=(r.getPtLabel(J)||"").split("<br>").join(" ")||"";var Z=v.ensureSingle(X,"g","slicetext"),oe=v.ensureSingle(Z,"text","",function(se){se.attr("data-notex",1)}),re=v.ensureUniformFontSize(i,r.determineTextFont(D,J,z.font,{onPathbar:!0}));oe.text(J._text||" ").classed("slicetext",!0).attr("text-anchor","start").call(S.font,re).call(M.convertToTspans,i),J.textBB=S.bBox(oe.node()),J.transform=f(J,{fontSize:re.size,onPathbar:!0}),J.transform.fontSize=re.size,l?oe.transition().attrTween("transform",function(se){var N=k(se,c,P,[u,_]);return function(U){return x(N(U))}}):oe.attr("transform",x(J))})}},{"../../components/drawing":389,"../../lib":515,"../../lib/svg_text_utils":541,"../sunburst/fx":1063,"../sunburst/helpers":1064,"./constants":1087,"./partition":1096,"./style":1099,"@plotly/d3":58}],1091:[function(d,ee,te){var w=d("@plotly/d3"),v=d("../../lib"),S=d("../../components/drawing"),M=d("../../lib/svg_text_utils"),e=d("./partition"),a=d("./style").styleOne,n=d("./constants"),r=d("../sunburst/helpers"),t=d("../sunburst/fx"),c=d("../sunburst/plot").formatSliceLabel,o=!1;ee.exports=function(y,p,g,h,m){var u=m.width,_=m.height,s=m.viewX,A=m.viewY,b=m.pathSlice,f=m.toMoveInsideSlice,x=m.strTransform,l=m.hasTransition,L=m.handleSlicesExit,T=m.makeUpdateSliceInterpolator,k=m.makeUpdateTextInterpolator,P=m.prevEntry,z={},I=y._fullLayout,D=p[0],R=D.trace,B=R.textposition.indexOf("left")!==-1,F=R.textposition.indexOf("right")!==-1,H=R.textposition.indexOf("bottom")!==-1,G=!H&&!R.marker.pad.t||H&&!R.marker.pad.b,J=e(g,[u,_],{packing:R.tiling.packing,squarifyratio:R.tiling.squarifyratio,flipX:R.tiling.flip.indexOf("x")>-1,flipY:R.tiling.flip.indexOf("y")>-1,pad:{inner:R.tiling.pad,top:R.marker.pad.t,left:R.marker.pad.l,right:R.marker.pad.r,bottom:R.marker.pad.b}}),X=J.descendants(),Y=1/0,Z=-1/0;X.forEach(function(U){var q=U.depth;q>=R._maxDepth?(U.x0=U.x1=(U.x0+U.x1)/2,U.y0=U.y1=(U.y0+U.y1)/2):(Y=Math.min(Y,q),Z=Math.max(Z,q))}),h=h.data(X,r.getPtId),R._maxVisibleLayers=isFinite(Z)?Z-Y+1:0,h.enter().append("g").classed("slice",!0),L(h,o,z,[u,_],b),h.order();var oe=null;if(l&&P){var re=r.getPtId(P);h.each(function(U){oe===null&&r.getPtId(U)===re&&(oe={x0:U.x0,x1:U.x1,y0:U.y0,y1:U.y1})})}var se=function(){return oe||{x0:0,x1:u,y0:0,y1:_}},N=h;return l&&(N=N.transition().each("end",function(){var U=w.select(this);r.setSliceCursor(U,y,{hideOnRoot:!0,hideOnLeaves:!1,isTransitioning:!1})})),N.each(function(U){var q=r.isHeader(U,R);U._x0=s(U.x0),U._x1=s(U.x1),U._y0=A(U.y0),U._y1=A(U.y1),U._hoverX=s(U.x1-R.marker.pad.r),U._hoverY=A(H?U.y1-R.marker.pad.b/2:U.y0+R.marker.pad.t/2);var $=w.select(this),W=v.ensureSingle($,"path","surface",function(ie){ie.style("pointer-events","all")});l?W.transition().attrTween("d",function(ie){var le=T(ie,o,se(),[u,_]);return function(ye){return b(le(ye))}}):W.attr("d",b),$.call(t,g,y,p,{styleOne:a,eventDataKeys:n.eventDataKeys,transitionTime:n.CLICK_TRANSITION_TIME,transitionEasing:n.CLICK_TRANSITION_EASING}).call(r.setSliceCursor,y,{isTransitioning:y._transitioning}),W.call(a,U,R,{hovered:!1}),U.x0===U.x1||U.y0===U.y1?U._text="":q?U._text=G?"":r.getPtLabel(U)||"":U._text=c(U,g,R,p,I)||"";var K=v.ensureSingle($,"g","slicetext"),ne=v.ensureSingle(K,"text","",function(ie){ie.attr("data-notex",1)}),ae=v.ensureUniformFontSize(y,r.determineTextFont(R,U,I.font));ne.text(U._text||" ").classed("slicetext",!0).attr("text-anchor",F?"end":B||q?"start":"middle").call(S.font,ae).call(M.convertToTspans,y),U.textBB=S.bBox(ne.node()),U.transform=f(U,{fontSize:ae.size,isHeader:q}),U.transform.fontSize=ae.size,l?ne.transition().attrTween("transform",function(ie){var le=k(ie,o,se(),[u,_]);return function(ye){return x(le(ye))}}):ne.attr("transform",x(U))}),oe}},{"../../components/drawing":389,"../../lib":515,"../../lib/svg_text_utils":541,"../sunburst/fx":1063,"../sunburst/helpers":1064,"../sunburst/plot":1068,"./constants":1087,"./partition":1096,"./style":1099,"@plotly/d3":58}],1092:[function(d,ee,te){ee.exports=function w(v,S,M){var e;M.swapXY&&(e=v.x0,v.x0=v.y0,v.y0=e,e=v.x1,v.x1=v.y1,v.y1=e),M.flipX&&(e=v.x0,v.x0=S[0]-v.x1,v.x1=S[0]-e),M.flipY&&(e=v.y0,v.y0=S[1]-v.y1,v.y1=S[1]-e);var a=v.children;if(a)for(var n=0;n<a.length;n++)w(a[n],S,M)}},{}],1093:[function(d,ee,te){ee.exports={moduleType:"trace",name:"treemap",basePlotModule:d("./base_plot"),categories:[],animatable:!0,attributes:d("./attributes"),layoutAttributes:d("./layout_attributes"),supplyDefaults:d("./defaults"),supplyLayoutDefaults:d("./layout_defaults"),calc:d("./calc").calc,crossTraceCalc:d("./calc").crossTraceCalc,plot:d("./plot"),style:d("./style").style,colorbar:d("../scatter/marker_colorbar"),meta:{}}},{"../scatter/marker_colorbar":954,"./attributes":1084,"./base_plot":1085,"./calc":1086,"./defaults":1088,"./layout_attributes":1094,"./layout_defaults":1095,"./plot":1097,"./style":1099}],1094:[function(d,ee,te){ee.exports={treemapcolorway:{valType:"colorlist",editType:"calc"},extendtreemapcolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{}],1095:[function(d,ee,te){var w=d("../../lib"),v=d("./layout_attributes");ee.exports=function(M,e){function a(n,r){return w.coerce(M,e,v,n,r)}a("treemapcolorway",e.colorway),a("extendtreemapcolors")}},{"../../lib":515,"./layout_attributes":1094}],1096:[function(d,ee,te){var w=d("d3-hierarchy"),v=d("./flip_tree");ee.exports=function(e,a,n){var r=n.flipX,t=n.flipY,c=n.packing==="dice-slice",o=n.pad[t?"bottom":"top"],i=n.pad[r?"right":"left"],y=n.pad[r?"left":"right"],p=n.pad[t?"top":"bottom"],g;c&&(g=i,i=o,o=g,g=y,y=p,p=g);var h=w.treemap().tile(S(n.packing,n.squarifyratio)).paddingInner(n.pad.inner).paddingLeft(i).paddingRight(y).paddingTop(o).paddingBottom(p).size(c?[a[1],a[0]]:a)(e);return(c||r||t)&&v(h,a,{swapXY:c,flipX:r,flipY:t}),h};function S(M,e){switch(M){case"squarify":return w.treemapSquarify.ratio(e);case"binary":return w.treemapBinary;case"dice":return w.treemapDice;case"slice":return w.treemapSlice;default:return w.treemapSliceDice}}},{"./flip_tree":1092,"d3-hierarchy":115}],1097:[function(d,ee,te){var w=d("./draw"),v=d("./draw_descendants");ee.exports=function(M,e,a,n){return w(M,e,a,n,{type:"treemap",drawDescendants:v})}},{"./draw":1089,"./draw_descendants":1091}],1098:[function(d,ee,te){var w=d("@plotly/d3"),v=d("d3-interpolate").interpolate,S=d("../sunburst/helpers"),M=d("../../lib"),e=d("../bar/constants").TEXTPAD,a=d("../bar/plot"),n=a.toMoveInsideBar,r=d("../bar/uniform_text"),t=r.recordMinTextSize,c=d("./constants"),o=d("./draw_ancestors");function i(y){return S.isHierarchyRoot(y)?"":S.getPtId(y)}ee.exports=function(p,g,h,m,u){var _=p._fullLayout,s=g[0],A=s.trace,b=A.type,f=b==="icicle",x=s.hierarchy,l=S.findEntryWithLevel(x,A.level),L=w.select(h),T=L.selectAll("g.pathbar"),k=L.selectAll("g.slice");if(!l){T.remove(),k.remove();return}var P=S.isHierarchyRoot(l),z=!_.uniformtext.mode&&S.hasTransition(m),I=S.getMaxDepth(A),D=function(He){return He.data.depth-l.data.depth<I},R=_._size,B=A.domain,F=R.w*(B.x[1]-B.x[0]),H=R.h*(B.y[1]-B.y[0]),G=F,J=A.pathbar.thickness,X=A.marker.line.width+c.gapWithPathbar,Y=A.pathbar.visible?A.pathbar.side.indexOf("bottom")>-1?H+X:-(J+X):0,Z={x0:G,x1:G,y0:Y,y1:Y+J},oe=function(He,vt,Rt){var rr=A.tiling.pad,Lt=function(kt){return kt-rr<=vt.x0},Ft=function(kt){return kt+rr>=vt.x1},Gt=function(kt){return kt-rr<=vt.y0},Dt=function(kt){return kt+rr>=vt.y1};return He.x0===vt.x0&&He.x1===vt.x1&&He.y0===vt.y0&&He.y1===vt.y1?{x0:He.x0,x1:He.x1,y0:He.y0,y1:He.y1}:{x0:Lt(He.x0-rr)?0:Ft(He.x0-rr)?Rt[0]:He.x0,x1:Lt(He.x1+rr)?0:Ft(He.x1+rr)?Rt[0]:He.x1,y0:Gt(He.y0-rr)?0:Dt(He.y0-rr)?Rt[1]:He.y0,y1:Gt(He.y1+rr)?0:Dt(He.y1+rr)?Rt[1]:He.y1}},re=null,se={},N={},U=null,q=function(He,vt){return vt?se[i(He)]:N[i(He)]},$=function(He,vt,Rt,rr){if(vt)return se[i(x)]||Z;var Lt=N[A.level]||Rt;return D(He)?oe(He,Lt,rr):{}};s.hasMultipleRoots&&P&&I++,A._maxDepth=I,A._backgroundColor=_.paper_bgcolor,A._entryDepth=l.data.depth,A._atRootLevel=P;var W=-F/2+R.l+R.w*(B.x[1]+B.x[0])/2,K=-H/2+R.t+R.h*(1-(B.y[1]+B.y[0])/2),ne=function(He){return W+He},ae=function(He){return K+He},ie=ae(0),le=ne(0),ye=function(He){return le+He},ue=function(He){return ie+He};function pe(He,vt){return He+","+vt}var ge=ye(0),Te=function(He){He.x=Math.max(ge,He.x)},_e=A.pathbar.edgeshape,ze=function(He){var vt=ye(Math.max(Math.min(He.x0,He.x0),0)),Rt=ye(Math.min(Math.max(He.x1,He.x1),G)),rr=ue(He.y0),Lt=ue(He.y1),Ft=J/2,Gt={},Dt={};Gt.x=vt,Dt.x=Rt,Gt.y=Dt.y=(rr+Lt)/2;var kt={x:vt,y:rr},Ue={x:Rt,y:rr},qe={x:Rt,y:Lt},Ve={x:vt,y:Lt};return _e===">"?(kt.x-=Ft,Ue.x-=Ft,qe.x-=Ft,Ve.x-=Ft):_e==="/"?(qe.x-=Ft,Ve.x-=Ft,Gt.x-=Ft/2,Dt.x-=Ft/2):_e==="\\"?(kt.x-=Ft,Ue.x-=Ft,Gt.x-=Ft/2,Dt.x-=Ft/2):_e==="<"&&(Gt.x-=Ft,Dt.x-=Ft),Te(kt),Te(Ve),Te(Gt),Te(Ue),Te(qe),Te(Dt),"M"+pe(kt.x,kt.y)+"L"+pe(Ue.x,Ue.y)+"L"+pe(Dt.x,Dt.y)+"L"+pe(qe.x,qe.y)+"L"+pe(Ve.x,Ve.y)+"L"+pe(Gt.x,Gt.y)+"Z"},Oe=function(He){var vt=ne(He.x0),Rt=ne(He.x1),rr=ae(He.y0),Lt=ae(He.y1),Ft=Rt-vt,Gt=Lt-rr;if(!Ft||!Gt)return"";var Dt=0,kt=Ft>2*Dt&&Gt>2*Dt?Dt:0,Ue=function(qe,Ve){return kt?"a"+pe(kt,kt)+" 0 0 1 "+pe(qe,Ve):""};return"M"+pe(vt,rr+kt)+Ue(kt,-kt)+"L"+pe(Rt-kt,rr)+Ue(kt,kt)+"L"+pe(Rt,Lt-kt)+Ue(-kt,kt)+"L"+pe(vt+kt,Lt)+Ue(-kt,-kt)+"Z"},Ye=function(He,vt){var Rt=He.x0,rr=He.x1,Lt=He.y0,Ft=He.y1,Gt=He.textBB,Dt=function(Ot){return A.textposition.indexOf(Ot)!==-1},kt=Dt("bottom"),Ue=Dt("top")||vt.isHeader&&!kt,qe=Ue?"start":kt?"end":"middle",Ve=Dt("right"),Ae=Dt("left")||vt.onPathbar,Ne=Ae?-1:Ve?1:0,Xe=A[f?"tiling":"marker"].pad;if(vt.isHeader){if(Rt+=(f?Xe:Xe.l)-e,rr-=(f?Xe:Xe.r)-e,Rt>=rr){var Je=(Rt+rr)/2;Rt=Je,rr=Je}var _t;kt?(_t=Ft-(f?Xe:Xe.b),Lt<_t&&_t<Ft&&(Lt=_t)):(_t=Lt+(f?Xe:Xe.t),Lt<_t&&_t<Ft&&(Ft=_t))}var mt=n(Rt,rr,Lt,Ft,Gt,{isHorizontal:!1,constrained:!0,angle:0,anchor:qe,leftToRight:Ne});return mt.fontSize=vt.fontSize,mt.targetX=ne(mt.targetX),mt.targetY=ae(mt.targetY),isNaN(mt.targetX)||isNaN(mt.targetY)?{}:(Rt!==rr&&Lt!==Ft&&t(A.type,mt,_),{scale:mt.scale,rotate:mt.rotate,textX:mt.textX,textY:mt.textY,anchorX:mt.anchorX,anchorY:mt.anchorY,targetX:mt.targetX,targetY:mt.targetY})},be=function(He,vt){for(var Rt,rr=0,Lt=He;!Rt&&rr<I;)rr++,Lt=Lt.parent,Lt?Rt=q(Lt,vt):rr=I;return Rt||{}},Pe=function(He,vt,Rt,rr){var Lt=q(He,vt),Ft;if(vt)Ft=Z;else{var Gt=q(l,vt);Gt?Ft=oe(He,Gt,rr):Ft={}}return v(Lt,Ft)},Ge=function(He,vt,Rt,rr,Lt){var Ft=q(He,vt),Gt;if(Ft)Gt=Ft;else if(vt)Gt=Z;else if(re)if(He.parent){var Dt=U||Rt;Dt&&!vt?Gt=oe(He,Dt,rr):(Gt={},M.extendFlat(Gt,be(He,vt)))}else Gt=M.extendFlat({},He),f&&(Lt.orientation==="h"?Lt.flipX?Gt.x0=He.x1:Gt.x1=0:Lt.flipY?Gt.y0=He.y1:Gt.y1=0);else Gt={};return v(Gt,{x0:He.x0,x1:He.x1,y0:He.y0,y1:He.y1})},Qe=function(He,vt,Rt,rr){var Lt=q(He,vt),Ft={},Gt=$(He,vt,Rt,rr);M.extendFlat(Ft,{transform:Ye({x0:Gt.x0,x1:Gt.x1,y0:Gt.y0,y1:Gt.y1,textBB:He.textBB,_text:He._text},{isHeader:S.isHeader(He,A)})}),Lt?Ft=Lt:He.parent&&M.extendFlat(Ft,be(He,vt));var Dt=He.transform;return He.x0!==He.x1&&He.y0!==He.y1&&t(A.type,Dt,_),v(Ft,{transform:{scale:Dt.scale,rotate:Dt.rotate,textX:Dt.textX,textY:Dt.textY,anchorX:Dt.anchorX,anchorY:Dt.anchorY,targetX:Dt.targetX,targetY:Dt.targetY}})},Be=function(He,vt,Rt,rr,Lt){var Ft=rr[0],Gt=rr[1];z?He.exit().transition().each(function(){var Dt=w.select(this),kt=Dt.select("path.surface");kt.transition().attrTween("d",function(qe){var Ve=Pe(qe,vt,Rt,[Ft,Gt]);return function(Ae){return Lt(Ve(Ae))}});var Ue=Dt.select("g.slicetext");Ue.attr("opacity",0)}).remove():He.exit().remove()},Le=function(He){var vt=He.transform;return He.x0!==He.x1&&He.y0!==He.y1&&t(A.type,vt,_),M.getTextTransform({textX:vt.textX,textY:vt.textY,anchorX:vt.anchorX,anchorY:vt.anchorY,targetX:vt.targetX,targetY:vt.targetY,scale:vt.scale,rotate:vt.rotate})};z&&(T.each(function(He){se[i(He)]={x0:He.x0,x1:He.x1,y0:He.y0,y1:He.y1},He.transform&&(se[i(He)].transform={textX:He.transform.textX,textY:He.transform.textY,anchorX:He.transform.anchorX,anchorY:He.transform.anchorY,targetX:He.transform.targetX,targetY:He.transform.targetY,scale:He.transform.scale,rotate:He.transform.rotate})}),k.each(function(He){N[i(He)]={x0:He.x0,x1:He.x1,y0:He.y0,y1:He.y1},He.transform&&(N[i(He)].transform={textX:He.transform.textX,textY:He.transform.textY,anchorX:He.transform.anchorX,anchorY:He.transform.anchorY,targetX:He.transform.targetX,targetY:He.transform.targetY,scale:He.transform.scale,rotate:He.transform.rotate}),!re&&S.isEntry(He)&&(re=He)})),U=u(p,g,l,k,{width:F,height:H,viewX:ne,viewY:ae,pathSlice:Oe,toMoveInsideSlice:Ye,prevEntry:re,makeUpdateSliceInterpolator:Ge,makeUpdateTextInterpolator:Qe,handleSlicesExit:Be,hasTransition:z,strTransform:Le}),A.pathbar.visible?o(p,g,l,T,{barDifY:Y,width:G,height:J,viewX:ye,viewY:ue,pathSlice:ze,toMoveInsideSlice:Ye,makeUpdateSliceInterpolator:Ge,makeUpdateTextInterpolator:Qe,handleSlicesExit:Be,hasTransition:z,strTransform:Le}):T.remove()}},{"../../lib":515,"../bar/constants":659,"../bar/plot":668,"../bar/uniform_text":673,"../sunburst/helpers":1064,"./constants":1087,"./draw_ancestors":1090,"@plotly/d3":58,"d3-interpolate":116}],1099:[function(d,ee,te){var w=d("@plotly/d3"),v=d("../../components/color"),S=d("../../lib"),M=d("../sunburst/helpers"),e=d("../bar/uniform_text").resizeText;function a(r){var t=r._fullLayout._treemaplayer.selectAll(".trace");e(r,t,"treemap"),t.each(function(c){var o=w.select(this),i=c[0],y=i.trace;o.style("opacity",y.opacity),o.selectAll("path.surface").each(function(p){w.select(this).call(n,p,y,{hovered:!1})})})}function n(r,t,c,o){var i=(o||{}).hovered,y=t.data.data,p=y.i,g,h,m=y.color,u=M.isHierarchyRoot(t),_=1;if(i)g=c._hovered.marker.line.color,h=c._hovered.marker.line.width;else if(u&&m===c.root.color)_=100,g="rgba(0,0,0,0)",h=0;else if(g=S.castOption(c,p,"marker.line.color")||v.defaultLine,h=S.castOption(c,p,"marker.line.width")||0,!c._hasColorscale&&!t.onPathbar){var s=c.marker.depthfade;if(s){var A=v.combine(v.addOpacity(c._backgroundColor,.75),m),b;if(s===!0){var f=M.getMaxDepth(c);isFinite(f)?M.isLeaf(t)?b=0:b=c._maxVisibleLayers-(t.data.depth-c._entryDepth):b=t.data.height+1}else b=t.data.depth-c._entryDepth,c._atRootLevel||b++;if(b>0)for(var x=0;x<b;x++){var l=.5*x/b;m=v.combine(v.addOpacity(A,l),m)}}}r.style("stroke-width",h).call(v.fill,m).call(v.stroke,g).style("opacity",_)}ee.exports={style:a,styleOne:n}},{"../../components/color":367,"../../lib":515,"../bar/uniform_text":673,"../sunburst/helpers":1064,"@plotly/d3":58}],1100:[function(d,ee,te){var w=d("../box/attributes"),v=d("../../lib/extend").extendFlat,S=d("../../plots/cartesian/axis_format_attributes").axisHoverFormat;ee.exports={y:w.y,x:w.x,x0:w.x0,y0:w.y0,xhoverformat:S("x"),yhoverformat:S("y"),name:v({},w.name,{}),orientation:v({},w.orientation,{}),bandwidth:{valType:"number",min:0,editType:"calc"},scalegroup:{valType:"string",dflt:"",editType:"calc"},scalemode:{valType:"enumerated",values:["width","count"],dflt:"width",editType:"calc"},spanmode:{valType:"enumerated",values:["soft","hard","manual"],dflt:"soft",editType:"calc"},span:{valType:"info_array",items:[{valType:"any",editType:"calc"},{valType:"any",editType:"calc"}],editType:"calc"},line:{color:{valType:"color",editType:"style"},width:{valType:"number",min:0,dflt:2,editType:"style"},editType:"plot"},fillcolor:w.fillcolor,points:v({},w.boxpoints,{}),jitter:v({},w.jitter,{}),pointpos:v({},w.pointpos,{}),width:v({},w.width,{}),marker:w.marker,text:w.text,hovertext:w.hovertext,hovertemplate:w.hovertemplate,quartilemethod:w.quartilemethod,box:{visible:{valType:"boolean",dflt:!1,editType:"plot"},width:{valType:"number",min:0,max:1,dflt:.25,editType:"plot"},fillcolor:{valType:"color",editType:"style"},line:{color:{valType:"color",editType:"style"},width:{valType:"number",min:0,editType:"style"},editType:"style"},editType:"plot"},meanline:{visible:{valType:"boolean",dflt:!1,editType:"plot"},color:{valType:"color",editType:"style"},width:{valType:"number",min:0,editType:"style"},editType:"plot"},side:{valType:"enumerated",values:["both","positive","negative"],dflt:"both",editType:"calc"},offsetgroup:w.offsetgroup,alignmentgroup:w.alignmentgroup,selected:w.selected,unselected:w.unselected,hoveron:{valType:"flaglist",flags:["violins","points","kde"],dflt:"violins+points+kde",extras:["all"],editType:"style"}}},{"../../lib/extend":505,"../../plots/cartesian/axis_format_attributes":569,"../box/attributes":682}],1101:[function(d,ee,te){var w=d("../../lib"),v=d("../../plots/cartesian/axes"),S=d("../box/calc"),M=d("./helpers"),e=d("../../constants/numerical").BADNUM;ee.exports=function(c,o){var i=S(c,o);if(i[0].t.empty)return i;for(var y=c._fullLayout,p=v.getFromId(c,o[o.orientation==="h"?"xaxis":"yaxis"]),g=1/0,h=-1/0,m=0,u=0,_=0;_<i.length;_++){var s=i[_],A=s.pts.map(M.extractVal),b=s.bandwidth=n(o,s,A),f=s.span=r(o,s,p,b);if(s.min===s.max&&b===0)f=s.span=[s.min,s.max],s.density=[{v:1,t:f[0]}],s.bandwidth=b,m=Math.max(m,1);else{var x=f[1]-f[0],l=Math.ceil(x/(b/3)),L=x/l;if(!isFinite(L)||!isFinite(l))return w.error("Something went wrong with computing the violin span"),i[0].t.empty=!0,i;var T=M.makeKDE(s,o,A);s.density=new Array(l);for(var k=0,P=f[0];P<f[1]+L/2;k++,P+=L){var z=T(P);s.density[k]={v:z,t:P},m=Math.max(m,z)}}u=Math.max(u,A.length),g=Math.min(g,f[0]),h=Math.max(h,f[1])}var I=v.findExtremes(p,[g,h],{padded:!0});if(o._extremes[p._id]=I,o.width)i[0].t.maxKDE=m;else{var D=y._violinScaleGroupStats,R=o.scalegroup,B=D[R];B?(B.maxKDE=Math.max(B.maxKDE,m),B.maxCount=Math.max(B.maxCount,u)):D[R]={maxKDE:m,maxCount:u}}return i[0].t.labels.kde=w._(c,"kde:"),i};function a(t,c,o){var i=Math.min(c,o/1.349);return 1.059*i*Math.pow(t,-.2)}function n(t,c,o){var i=c.max-c.min;if(!i)return t.bandwidth?t.bandwidth:0;if(t.bandwidth)return Math.max(t.bandwidth,i/1e4);var y=o.length,p=w.stdev(o,y-1,c.mean);return Math.max(a(y,p,c.q3-c.q1),i/100)}function r(t,c,o,i){var y=t.spanmode,p=t.span||[],g=[c.min,c.max],h=[c.min-2*i,c.max+2*i],m;function u(s){var A=p[s],b=o.type==="multicategory"?o.r2c(A):o.d2c(A,0,t[c.valLetter+"calendar"]);return b===e?h[s]:b}y==="soft"?m=h:y==="hard"?m=g:m=[u(0),u(1)];var _={type:"linear",range:m};return v.setConvert(_),_.cleanRange(),m}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/axes":566,"../box/calc":683,"./helpers":1104}],1102:[function(d,ee,te){var w=d("../box/cross_trace_calc").setPositionOffset,v=["v","h"];ee.exports=function(M,e){for(var a=M.calcdata,n=e.xaxis,r=e.yaxis,t=0;t<v.length;t++){for(var c=v[t],o=c==="h"?r:n,i=[],y=0;y<a.length;y++){var p=a[y],g=p[0].t,h=p[0].trace;h.visible===!0&&h.type==="violin"&&!g.empty&&h.orientation===c&&h.xaxis===n._id&&h.yaxis===r._id&&i.push(y)}w("violin",M,i,o)}}},{"../box/cross_trace_calc":684}],1103:[function(d,ee,te){var w=d("../../lib"),v=d("../../components/color"),S=d("../box/defaults"),M=d("./attributes");ee.exports=function(a,n,r,t){function c(L,T){return w.coerce(a,n,M,L,T)}function o(L,T){return w.coerce2(a,n,M,L,T)}if(S.handleSampleDefaults(a,n,c,t),n.visible!==!1){c("bandwidth"),c("side");var i=c("width");i||(c("scalegroup",n.name),c("scalemode"));var y=c("span"),p;Array.isArray(y)&&(p="manual"),c("spanmode",p);var g=c("line.color",(a.marker||{}).color||r),h=c("line.width"),m=c("fillcolor",v.addOpacity(n.line.color,.5));S.handlePointsDefaults(a,n,c,{prefix:""});var u=o("box.width"),_=o("box.fillcolor",m),s=o("box.line.color",g),A=o("box.line.width",h),b=c("box.visible",Boolean(u||_||s||A));b||(n.box={visible:!1});var f=o("meanline.color",g),x=o("meanline.width",h),l=c("meanline.visible",Boolean(f||x));l||(n.meanline={visible:!1}),c("quartilemethod")}}},{"../../components/color":367,"../../lib":515,"../box/defaults":685,"./attributes":1100}],1104:[function(d,ee,te){var w=d("../../lib"),v={gaussian:function(S){return 1/Math.sqrt(2*Math.PI)*Math.exp(-.5*S*S)}};te.makeKDE=function(S,M,e){var a=e.length,n=v.gaussian,r=S.bandwidth,t=1/(a*r);return function(c){for(var o=0,i=0;i<a;i++)o+=n((c-e[i])/r);return t*o}},te.getPositionOnKdePath=function(S,M,e){var a,n;M.orientation==="h"?(a="y",n="x"):(a="x",n="y");var r=w.findPointOnPath(S.path,e,n,{pathLength:S.pathLength}),t=S.posCenterPx,c=r[a],o=M.side==="both"?2*t-c:t;return[c,o]},te.getKdeValue=function(S,M,e){var a=S.pts.map(te.extractVal),n=te.makeKDE(S,M,a);return n(e)/S.posDensityScale},te.extractVal=function(S){return S.v}},{"../../lib":515}],1105:[function(d,ee,te){var w=d("../../lib"),v=d("../../plots/cartesian/axes"),S=d("../box/hover"),M=d("./helpers");ee.exports=function(a,n,r,t,c){c||(c={});var o=c.hoverLayer,i=a.cd,y=i[0].trace,p=y.hoveron,g=p.indexOf("violins")!==-1,h=p.indexOf("kde")!==-1,m=[],u,_;if(g||h){var s=S.hoverOnBoxes(a,n,r,t);if(h&&s.length>0){var A=a.xa,b=a.ya,f,x,l,L,T;y.orientation==="h"?(T=n,f="y",l=b,x="x",L=A):(T=r,f="x",l=A,x="y",L=b);var k=i[a.index];if(T>=k.span[0]&&T<=k.span[1]){var P=w.extendFlat({},a),z=L.c2p(T,!0),I=M.getKdeValue(k,y,T),D=M.getPositionOnKdePath(k,y,z),R=l._offset,B=l._length;P[f+"0"]=D[0],P[f+"1"]=D[1],P[x+"0"]=P[x+"1"]=z,P[x+"Label"]=x+": "+v.hoverLabelText(L,T,y[x+"hoverformat"])+", "+i[0].t.labels.kde+" "+I.toFixed(3);for(var F=0,H=0;H<s.length;H++)if(s[H].attr==="med"){F=H;break}P.spikeDistance=s[F].spikeDistance;var G=f+"Spike";P[G]=s[F][G],s[F].spikeDistance=void 0,s[F][G]=void 0,P.hovertemplate=!1,m.push(P),_={stroke:a.color},_[f+"1"]=w.constrain(R+D[0],R,R+B),_[f+"2"]=w.constrain(R+D[1],R,R+B),_[x+"1"]=_[x+"2"]=L._offset+z}}g&&(m=m.concat(s))}p.indexOf("points")!==-1&&(u=S.hoverOnPoints(a,n,r));var J=o.selectAll(".violinline-"+y.uid).data(_?[0]:[]);return J.enter().append("line").classed("violinline-"+y.uid,!0).attr("stroke-width",1.5),J.exit().remove(),J.attr(_),t==="closest"?u?[u]:m:(u&&m.push(u),m)}},{"../../lib":515,"../../plots/cartesian/axes":566,"../box/hover":687,"./helpers":1104}],1106:[function(d,ee,te){ee.exports={attributes:d("./attributes"),layoutAttributes:d("./layout_attributes"),supplyDefaults:d("./defaults"),crossTraceDefaults:d("../box/defaults").crossTraceDefaults,supplyLayoutDefaults:d("./layout_defaults"),calc:d("./calc"),crossTraceCalc:d("./cross_trace_calc"),plot:d("./plot"),style:d("./style"),styleOnSelect:d("../scatter/style").styleOnSelect,hoverPoints:d("./hover"),selectPoints:d("../box/select"),moduleType:"trace",name:"violin",basePlotModule:d("../../plots/cartesian"),categories:["cartesian","svg","symbols","oriented","box-violin","showLegend","violinLayout","zoomScale"],meta:{}}},{"../../plots/cartesian":578,"../box/defaults":685,"../box/select":692,"../scatter/style":960,"./attributes":1100,"./calc":1101,"./cross_trace_calc":1102,"./defaults":1103,"./hover":1105,"./layout_attributes":1107,"./layout_defaults":1108,"./plot":1109,"./style":1110}],1107:[function(d,ee,te){var w=d("../box/layout_attributes"),v=d("../../lib").extendFlat;ee.exports={violinmode:v({},w.boxmode,{}),violingap:v({},w.boxgap,{}),violingroupgap:v({},w.boxgroupgap,{})}},{"../../lib":515,"../box/layout_attributes":689}],1108:[function(d,ee,te){var w=d("../../lib"),v=d("./layout_attributes"),S=d("../box/layout_defaults");ee.exports=function(e,a,n){function r(t,c){return w.coerce(e,a,v,t,c)}S._supply(e,a,n,r,"violin")}},{"../../lib":515,"../box/layout_defaults":690,"./layout_attributes":1107}],1109:[function(d,ee,te){var w=d("@plotly/d3"),v=d("../../lib"),S=d("../../components/drawing"),M=d("../box/plot"),e=d("../scatter/line_points"),a=d("./helpers");ee.exports=function(r,t,c,o){var i=r._fullLayout,y=t.xaxis,p=t.yaxis;function g(h){var m=e(h,{xaxis:y,yaxis:p,connectGaps:!0,baseTolerance:.75,shape:"spline",simplify:!0,linearized:!0});return S.smoothopen(m[0],1)}v.makeTraceGroups(o,c,"trace violins").each(function(h){var m=w.select(this),u=h[0],_=u.t,s=u.trace;if(s.visible!==!0||_.empty){m.remove();return}var A=_.bPos,b=_.bdPos,f=t[_.valLetter+"axis"],x=t[_.posLetter+"axis"],l=s.side==="both",L=l||s.side==="positive",T=l||s.side==="negative",k=m.selectAll("path.violin").data(v.identity);k.enter().append("path").style("vector-effect","non-scaling-stroke").attr("class","violin"),k.exit().remove(),k.each(function(H){var G=w.select(this),J=H.density,X=J.length,Y=x.c2l(H.pos+A,!0),Z=x.l2p(Y),oe;if(s.width)oe=_.maxKDE/b;else{var re=i._violinScaleGroupStats[s.scalegroup];oe=s.scalemode==="count"?re.maxKDE/b*(re.maxCount/H.pts.length):re.maxKDE/b}var se,N,U,q,$,W,K;if(L){for(W=new Array(X),q=0;q<X;q++)K=W[q]={},K[_.posLetter]=Y+J[q].v/oe,K[_.valLetter]=f.c2l(J[q].t,!0);se=g(W)}if(T){for(W=new Array(X),$=0,q=X-1;$<X;$++,q--)K=W[$]={},K[_.posLetter]=Y-J[q].v/oe,K[_.valLetter]=f.c2l(J[q].t,!0);N=g(W)}if(l)U=se+"L"+N.substr(1)+"Z";else{var ne=[Z,f.c2p(J[0].t)],ae=[Z,f.c2p(J[X-1].t)];s.orientation==="h"&&(ne.reverse(),ae.reverse()),L?U="M"+ne+"L"+se.substr(1)+"L"+ae:U="M"+ae+"L"+N.substr(1)+"L"+ne}G.attr("d",U),H.posCenterPx=Z,H.posDensityScale=oe*b,H.path=G.node(),H.pathLength=H.path.getTotalLength()/(l?2:1)});var P=s.box,z=P.width,I=(P.line||{}).width,D,R;l?(D=b*z,R=0):L?(D=[0,b*z/2],R=I*{x:1,y:-1}[_.posLetter]):(D=[b*z/2,0],R=I*{x:-1,y:1}[_.posLetter]),M.plotBoxAndWhiskers(m,{pos:x,val:f},s,{bPos:A,bdPos:D,bPosPxOffset:R}),M.plotBoxMean(m,{pos:x,val:f},s,{bPos:A,bdPos:D,bPosPxOffset:R});var B;!s.box.visible&&s.meanline.visible&&(B=v.identity);var F=m.selectAll("path.meanline").data(B||[]);F.enter().append("path").attr("class","meanline").style("fill","none").style("vector-effect","non-scaling-stroke"),F.exit().remove(),F.each(function(H){var G=f.c2p(H.mean,!0),J=a.getPositionOnKdePath(H,s,G);w.select(this).attr("d",s.orientation==="h"?"M"+G+","+J[0]+"V"+J[1]:"M"+J[0]+","+G+"H"+J[1])}),M.plotPoints(m,{x:y,y:p},s,_)})}},{"../../components/drawing":389,"../../lib":515,"../box/plot":691,"../scatter/line_points":950,"./helpers":1104,"@plotly/d3":58}],1110:[function(d,ee,te){var w=d("@plotly/d3"),v=d("../../components/color"),S=d("../scatter/style").stylePoints;ee.exports=function(e){var a=w.select(e).selectAll("g.trace.violins");a.style("opacity",function(n){return n[0].trace.opacity}),a.each(function(n){var r=n[0].trace,t=w.select(this),c=r.box||{},o=c.line||{},i=r.meanline||{},y=i.width;t.selectAll("path.violin").style("stroke-width",r.line.width+"px").call(v.stroke,r.line.color).call(v.fill,r.fillcolor),t.selectAll("path.box").style("stroke-width",o.width+"px").call(v.stroke,o.color).call(v.fill,c.fillcolor);var p={"stroke-width":y+"px","stroke-dasharray":2*y+"px,"+y+"px"};t.selectAll("path.mean").style(p).call(v.stroke,i.color),t.selectAll("path.meanline").style(p).call(v.stroke,i.color),S(t,r,e)})}},{"../../components/color":367,"../scatter/style":960,"@plotly/d3":58}],1111:[function(d,ee,te){var w=d("../../components/colorscale/attributes"),v=d("../isosurface/attributes"),S=d("../surface/attributes"),M=d("../../plots/attributes"),e=d("../../lib/extend").extendFlat,a=d("../../plot_api/edit_types").overrideAll,n=ee.exports=a(e({x:v.x,y:v.y,z:v.z,value:v.value,isomin:v.isomin,isomax:v.isomax,surface:v.surface,spaceframe:{show:{valType:"boolean",dflt:!1},fill:{valType:"number",min:0,max:1,dflt:1}},slices:v.slices,caps:v.caps,text:v.text,hovertext:v.hovertext,xhoverformat:v.xhoverformat,yhoverformat:v.yhoverformat,zhoverformat:v.zhoverformat,valuehoverformat:v.valuehoverformat,hovertemplate:v.hovertemplate},w("",{colorAttr:"`value`",showScaleDflt:!0,editTypeOverride:"calc"}),{colorbar:v.colorbar,opacity:v.opacity,opacityscale:S.opacityscale,lightposition:v.lightposition,lighting:v.lighting,flatshading:v.flatshading,contour:v.contour,hoverinfo:e({},M.hoverinfo),showlegend:e({},M.showlegend,{dflt:!1})}),"calc","nested");n.x.editType=n.y.editType=n.z.editType=n.value.editType="calc+clearAxisTypes",n.transforms=void 0},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plots/attributes":562,"../isosurface/attributes":871,"../surface/attributes":1070}],1112:[function(d,ee,te){var w=d("../../../stackgl_modules").gl_mesh3d,v=d("../../lib/gl_format_color").parseColorScale,S=d("../../lib/str2rgbarray"),M=d("../../components/colorscale").extractOpts,e=d("../../plots/gl3d/zip3"),a=d("../isosurface/convert").findNearestOnAxis,n=d("../isosurface/convert").generateIsoMeshes;function r(o,i,y){this.scene=o,this.uid=y,this.mesh=i,this.name="",this.data=null,this.showContour=!1}var t=r.prototype;t.handlePick=function(o){if(o.object===this.mesh){var i=o.data.index,y=this.data._meshX[i],p=this.data._meshY[i],g=this.data._meshZ[i],h=this.data._Ys.length,m=this.data._Zs.length,u=a(y,this.data._Xs).id,_=a(p,this.data._Ys).id,s=a(g,this.data._Zs).id,A=o.index=s+m*_+m*h*u;o.traceCoordinate=[this.data._meshX[A],this.data._meshY[A],this.data._meshZ[A],this.data._value[A]];var b=this.data.hovertext||this.data.text;return Array.isArray(b)&&b[A]!==void 0?o.textLabel=b[A]:b&&(o.textLabel=b),!0}},t.update=function(o){var i=this.scene,y=i.fullSceneLayout;this.data=n(o);function p(_,s,A,b){return s.map(function(f){return _.d2l(f,0,b)*A})}var g=e(p(y.xaxis,o._meshX,i.dataScale[0],o.xcalendar),p(y.yaxis,o._meshY,i.dataScale[1],o.ycalendar),p(y.zaxis,o._meshZ,i.dataScale[2],o.zcalendar)),h=e(o._meshI,o._meshJ,o._meshK),m={positions:g,cells:h,lightPosition:[o.lightposition.x,o.lightposition.y,o.lightposition.z],ambient:o.lighting.ambient,diffuse:o.lighting.diffuse,specular:o.lighting.specular,roughness:o.lighting.roughness,fresnel:o.lighting.fresnel,vertexNormalsEpsilon:o.lighting.vertexnormalsepsilon,faceNormalsEpsilon:o.lighting.facenormalsepsilon,opacity:o.opacity,opacityscale:o.opacityscale,contourEnable:o.contour.show,contourColor:S(o.contour.color).slice(0,3),contourWidth:o.contour.width,useFacetNormals:o.flatshading},u=M(o);m.vertexIntensity=o._meshIntensity,m.vertexIntensityBounds=[u.min,u.max],m.colormap=v(o),this.mesh.update(m)},t.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()};function c(o,i){var y=o.glplot.gl,p=w({gl:y}),g=new r(o,p,i.uid);return p._trace=g,g.update(i),o.glplot.add(p),g}ee.exports=c},{"../../../stackgl_modules":1133,"../../components/colorscale":379,"../../lib/gl_format_color":511,"../../lib/str2rgbarray":540,"../../plots/gl3d/zip3":618,"../isosurface/convert":873}],1113:[function(d,ee,te){var w=d("../../lib"),v=d("./attributes"),S=d("../isosurface/defaults").supplyIsoDefaults,M=d("../surface/defaults").opacityscaleDefaults;ee.exports=function(a,n,r,t){function c(o,i){return w.coerce(a,n,v,o,i)}S(a,n,r,t,c),M(a,n,t,c)}},{"../../lib":515,"../isosurface/defaults":874,"../surface/defaults":1073,"./attributes":1111}],1114:[function(d,ee,te){ee.exports={attributes:d("./attributes"),supplyDefaults:d("./defaults"),calc:d("../isosurface/calc"),colorbar:{min:"cmin",max:"cmax"},plot:d("./convert"),moduleType:"trace",name:"volume",basePlotModule:d("../../plots/gl3d"),categories:["gl3d","showLegend"],meta:{}}},{"../../plots/gl3d":607,"../isosurface/calc":872,"./attributes":1111,"./convert":1112,"./defaults":1113}],1115:[function(d,ee,te){var w=d("../bar/attributes"),v=d("../scatter/attributes").line,S=d("../../plots/attributes"),M=d("../../plots/cartesian/axis_format_attributes").axisHoverFormat,e=d("../../plots/template_attributes").hovertemplateAttrs,a=d("../../plots/template_attributes").texttemplateAttrs,n=d("./constants"),r=d("../../lib/extend").extendFlat,t=d("../../components/color");function c(o){return{marker:{color:r({},w.marker.color,{arrayOk:!1,editType:"style"}),line:{color:r({},w.marker.line.color,{arrayOk:!1,editType:"style"}),width:r({},w.marker.line.width,{arrayOk:!1,editType:"style"}),editType:"style"},editType:"style"},editType:"style"}}ee.exports={measure:{valType:"data_array",dflt:[],editType:"calc"},base:{valType:"number",dflt:null,arrayOk:!1,editType:"calc"},x:w.x,x0:w.x0,dx:w.dx,y:w.y,y0:w.y0,dy:w.dy,xperiod:w.xperiod,yperiod:w.yperiod,xperiod0:w.xperiod0,yperiod0:w.yperiod0,xperiodalignment:w.xperiodalignment,yperiodalignment:w.yperiodalignment,xhoverformat:M("x"),yhoverformat:M("y"),hovertext:w.hovertext,hovertemplate:e({},{keys:n.eventDataKeys}),hoverinfo:r({},S.hoverinfo,{flags:["name","x","y","text","initial","delta","final"]}),textinfo:{valType:"flaglist",flags:["label","text","initial","delta","final"],extras:["none"],editType:"plot",arrayOk:!1},texttemplate:a({editType:"plot"},{keys:n.eventDataKeys.concat(["label"])}),text:w.text,textposition:w.textposition,insidetextanchor:w.insidetextanchor,textangle:w.textangle,textfont:w.textfont,insidetextfont:w.insidetextfont,outsidetextfont:w.outsidetextfont,constraintext:w.constraintext,cliponaxis:w.cliponaxis,orientation:w.orientation,offset:w.offset,width:w.width,increasing:c(),decreasing:c(),totals:c(),connector:{line:{color:r({},v.color,{dflt:t.defaultLine}),width:r({},v.width,{editType:"plot"}),dash:v.dash,editType:"plot"},mode:{valType:"enumerated",values:["spanning","between"],dflt:"between",editType:"plot"},visible:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},offsetgroup:w.offsetgroup,alignmentgroup:w.alignmentgroup}},{"../../components/color":367,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../bar/attributes":657,"../scatter/attributes":936,"./constants":1117}],1116:[function(d,ee,te){var w=d("../../plots/cartesian/axes"),v=d("../../plots/cartesian/align_period"),S=d("../../lib").mergeArray,M=d("../scatter/calc_selection"),e=d("../../constants/numerical").BADNUM;function a(r){return r==="a"||r==="absolute"}function n(r){return r==="t"||r==="total"}ee.exports=function(t,c){var o=w.getFromId(t,c.xaxis||"x"),i=w.getFromId(t,c.yaxis||"y"),y,p,g,h,m,u;c.orientation==="h"?(y=o.makeCalcdata(c,"x"),g=i.makeCalcdata(c,"y"),h=v(c,i,"y",g),m=!!c.yperiodalignment,u="y"):(y=i.makeCalcdata(c,"y"),g=o.makeCalcdata(c,"x"),h=v(c,o,"x",g),m=!!c.xperiodalignment,u="x"),p=h.vals;for(var _=Math.min(p.length,y.length),s=new Array(_),A=0,b,f=!1,x=0;x<_;x++){var l=y[x]||0,L=!1;(y[x]!==e||n(c.measure[x])||a(c.measure[x]))&&x+1<_&&(y[x+1]!==e||n(c.measure[x+1])||a(c.measure[x+1]))&&(L=!0);var T=s[x]={i:x,p:p[x],s:l,rawS:l,cNext:L};a(c.measure[x])?(A=T.s,T.isSum=!0,T.dir="totals",T.s=A):n(c.measure[x])?(T.isSum=!0,T.dir="totals",T.s=A):(T.isSum=!1,T.dir=T.rawS<0?"decreasing":"increasing",b=T.s,T.s=A+b,A+=b),T.dir==="totals"&&(f=!0),m&&(s[x].orig_p=g[x],s[x][u+"End"]=h.ends[x],s[x][u+"Start"]=h.starts[x]),c.ids&&(T.id=String(c.ids[x])),T.v=(c.base||0)+A}return s.length&&(s[0].hasTotals=f),S(c.text,s,"tx"),S(c.hovertext,s,"htx"),M(s,c),s}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/align_period":563,"../../plots/cartesian/axes":566,"../scatter/calc_selection":938}],1117:[function(d,ee,te){ee.exports={eventDataKeys:["initial","delta","final"]}},{}],1118:[function(d,ee,te){var w=d("../bar/cross_trace_calc").setGroupPositions;ee.exports=function(S,M){var e=S._fullLayout,a=S._fullData,n=S.calcdata,r=M.xaxis,t=M.yaxis,c=[],o=[],i=[],y,p;for(p=0;p<a.length;p++){var g=a[p];g.visible===!0&&g.xaxis===r._id&&g.yaxis===t._id&&g.type==="waterfall"&&(y=n[p],g.orientation==="h"?i.push(y):o.push(y),c.push(y))}var h={mode:e.waterfallmode,norm:e.waterfallnorm,gap:e.waterfallgap,groupgap:e.waterfallgroupgap};for(w(S,r,t,o,h),w(S,t,r,i,h),p=0;p<c.length;p++){y=c[p];for(var m=0;m<y.length;m++){var u=y[m];u.isSum===!1&&(u.s0+=m===0?0:y[m-1].s),m+1<y.length&&(y[m].nextP0=y[m+1].p0,y[m].nextS0=y[m+1].s0)}}}},{"../bar/cross_trace_calc":660}],1119:[function(d,ee,te){var w=d("../../lib"),v=d("../bar/defaults").handleGroupingDefaults,S=d("../bar/defaults").handleText,M=d("../scatter/xy_defaults"),e=d("../scatter/period_defaults"),a=d("./attributes"),n=d("../../components/color"),r=d("../../constants/delta.js"),t=r.INCREASING.COLOR,c=r.DECREASING.COLOR,o="#4499FF";function i(g,h,m){g(h+".marker.color",m),g(h+".marker.line.color",n.defaultLine),g(h+".marker.line.width")}function y(g,h,m,u){function _(x,l){return w.coerce(g,h,a,x,l)}var s=M(g,h,u,_);if(!s){h.visible=!1;return}e(g,h,u,_),_("xhoverformat"),_("yhoverformat"),_("measure"),_("orientation",h.x&&!h.y?"h":"v"),_("base"),_("offset"),_("width"),_("text"),_("hovertext"),_("hovertemplate");var A=_("textposition");S(g,h,u,_,A,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!0,moduleHasCliponaxis:!0,moduleHasTextangle:!0,moduleHasInsideanchor:!0}),h.textposition!=="none"&&(_("texttemplate"),h.texttemplate||_("textinfo")),i(_,"increasing",t),i(_,"decreasing",c),i(_,"totals",o);var b=_("connector.visible");if(b){_("connector.mode");var f=_("connector.line.width");f&&(_("connector.line.color"),_("connector.line.dash"))}}function p(g,h){var m,u;function _(A){return w.coerce(u._input,u,a,A)}if(h.waterfallmode==="group")for(var s=0;s<g.length;s++)u=g[s],m=u._input,v(m,u,h,_)}ee.exports={supplyDefaults:y,crossTraceDefaults:p}},{"../../components/color":367,"../../constants/delta.js":485,"../../lib":515,"../bar/defaults":661,"../scatter/period_defaults":956,"../scatter/xy_defaults":963,"./attributes":1115}],1120:[function(d,ee,te){ee.exports=function(v,S){return v.x="xVal"in S?S.xVal:S.x,v.y="yVal"in S?S.yVal:S.y,"initial"in S&&(v.initial=S.initial),"delta"in S&&(v.delta=S.delta),"final"in S&&(v.final=S.final),S.xa&&(v.xaxis=S.xa),S.ya&&(v.yaxis=S.ya),v}},{}],1121:[function(d,ee,te){var w=d("../../plots/cartesian/axes").hoverLabelText,v=d("../../components/color").opacity,S=d("../bar/hover").hoverOnBars,M=d("../../constants/delta.js"),e={increasing:M.INCREASING.SYMBOL,decreasing:M.DECREASING.SYMBOL};ee.exports=function(r,t,c,o,i){var y=S(r,t,c,o,i);if(!y)return;var p=y.cd,g=p[0].trace,h=g.orientation==="h",m=h?"x":"y",u=h?r.xa:r.ya;function _(P){return w(u,P,g[m+"hoverformat"])}var s=y.index,A=p[s],b=A.isSum?A.b+A.s:A.rawS;if(!A.isSum){y.initial=A.b+A.s-b,y.delta=b,y.final=y.initial+y.delta;var f=_(Math.abs(y.delta));y.deltaLabel=b<0?"("+f+")":f,y.finalLabel=_(y.final),y.initialLabel=_(y.initial)}var x=A.hi||g.hoverinfo,l=[];if(x&&x!=="none"&&x!=="skip"){var L=x==="all",T=x.split("+"),k=function(P){return L||T.indexOf(P)!==-1};A.isSum||(k("final")&&(h?!k("x"):!k("y"))&&l.push(y.finalLabel),k("delta")&&(b<0?l.push(y.deltaLabel+" "+e.decreasing):l.push(y.deltaLabel+" "+e.increasing)),k("initial")&&l.push("Initial: "+y.initialLabel))}return l.length&&(y.extraText=l.join("<br>")),y.color=a(g,A),[y]};function a(n,r){var t=n[r.dir].marker,c=t.color,o=t.line.color,i=t.line.width;if(v(c))return c;if(v(o)&&i)return o}},{"../../components/color":367,"../../constants/delta.js":485,"../../plots/cartesian/axes":566,"../bar/hover":664}],1122:[function(d,ee,te){ee.exports={attributes:d("./attributes"),layoutAttributes:d("./layout_attributes"),supplyDefaults:d("./defaults").supplyDefaults,crossTraceDefaults:d("./defaults").crossTraceDefaults,supplyLayoutDefaults:d("./layout_defaults"),calc:d("./calc"),crossTraceCalc:d("./cross_trace_calc"),plot:d("./plot"),style:d("./style").style,hoverPoints:d("./hover"),eventData:d("./event_data"),selectPoints:d("../bar/select"),moduleType:"trace",name:"waterfall",basePlotModule:d("../../plots/cartesian"),categories:["bar-like","cartesian","svg","oriented","showLegend","zoomScale"],meta:{}}},{"../../plots/cartesian":578,"../bar/select":669,"./attributes":1115,"./calc":1116,"./cross_trace_calc":1118,"./defaults":1119,"./event_data":1120,"./hover":1121,"./layout_attributes":1123,"./layout_defaults":1124,"./plot":1125,"./style":1126}],1123:[function(d,ee,te){ee.exports={waterfallmode:{valType:"enumerated",values:["group","overlay"],dflt:"group",editType:"calc"},waterfallgap:{valType:"number",min:0,max:1,editType:"calc"},waterfallgroupgap:{valType:"number",min:0,max:1,dflt:0,editType:"calc"}}},{}],1124:[function(d,ee,te){var w=d("../../lib"),v=d("./layout_attributes");ee.exports=function(S,M,e){var a=!1;function n(c,o){return w.coerce(S,M,v,c,o)}for(var r=0;r<e.length;r++){var t=e[r];if(t.visible&&t.type==="waterfall"){a=!0;break}}a&&(n("waterfallmode"),n("waterfallgap",.2),n("waterfallgroupgap"))}},{"../../lib":515,"./layout_attributes":1123}],1125:[function(d,ee,te){var w=d("@plotly/d3"),v=d("../../lib"),S=d("../../components/drawing"),M=d("../../constants/numerical").BADNUM,e=d("../bar/plot"),a=d("../bar/uniform_text").clearMinTextSize;ee.exports=function(c,o,i,y){var p=c._fullLayout;a("waterfall",p),e.plot(c,o,i,y,{mode:p.waterfallmode,norm:p.waterfallmode,gap:p.waterfallgap,groupgap:p.waterfallgroupgap}),n(c,o,i,y)};function n(t,c,o,i){var y=c.xaxis,p=c.yaxis;v.makeTraceGroups(i,o,"trace bars").each(function(g){var h=w.select(this),m=g[0].trace,u=v.ensureSingle(h,"g","lines");if(!m.connector||!m.connector.visible){u.remove();return}var _=m.orientation==="h",s=m.connector.mode,A=u.selectAll("g.line").data(v.identity);A.enter().append("g").classed("line",!0),A.exit().remove();var b=A.size();A.each(function(f,x){if(!(x!==b-1&&!f.cNext)){var l=r(f,y,p,_),L=l[0],T=l[1],k="";L[0]!==M&&T[0]!==M&&L[1]!==M&&T[1]!==M&&(s==="spanning"&&!f.isSum&&x>0&&(_?k+="M"+L[0]+","+T[1]+"V"+T[0]:k+="M"+L[1]+","+T[0]+"H"+L[0]),s!=="between"&&(f.isSum||x<b-1)&&(_?k+="M"+L[1]+","+T[0]+"V"+T[1]:k+="M"+L[0]+","+T[1]+"H"+L[1]),L[2]!==M&&T[2]!==M&&(_?k+="M"+L[1]+","+T[1]+"V"+T[2]:k+="M"+L[1]+","+T[1]+"H"+L[2])),k===""&&(k="M0,0Z"),v.ensureSingle(w.select(this),"path").attr("d",k).call(S.setClipUrl,c.layerClipId,t)}})})}function r(t,c,o,i){var y=[],p=[],g=i?c:o,h=i?o:c;return y[0]=g.c2p(t.s0,!0),p[0]=h.c2p(t.p0,!0),y[1]=g.c2p(t.s1,!0),p[1]=h.c2p(t.p1,!0),y[2]=g.c2p(t.nextS0,!0),p[2]=h.c2p(t.nextP0,!0),i?[y,p]:[p,y]}},{"../../components/drawing":389,"../../constants/numerical":491,"../../lib":515,"../bar/plot":668,"../bar/uniform_text":673,"@plotly/d3":58}],1126:[function(d,ee,te){var w=d("@plotly/d3"),v=d("../../components/drawing"),S=d("../../components/color"),M=d("../../constants/interactions").DESELECTDIM,e=d("../bar/style"),a=d("../bar/uniform_text").resizeText,n=e.styleTextPoints;function r(t,c,o){var i=o||w.select(t).selectAll("g.waterfalllayer").selectAll("g.trace");a(t,i,"waterfall"),i.style("opacity",function(y){return y[0].trace.opacity}),i.each(function(y){var p=w.select(this),g=y[0].trace;p.selectAll(".point > path").each(function(h){if(!h.isBlank){var m=g[h.dir].marker;w.select(this).call(S.fill,m.color).call(S.stroke,m.line.color).call(v.dashLine,m.line.dash,m.line.width).style("opacity",g.selectedpoints&&!h.selected?M:1)}}),n(p,g,t),p.selectAll(".lines").each(function(){var h=g.connector.line;v.lineGroupStyle(w.select(this).selectAll("path"),h.width,h.color,h.dash)})})}ee.exports={style:r}},{"../../components/color":367,"../../components/drawing":389,"../../constants/interactions":490,"../bar/style":671,"../bar/uniform_text":673,"@plotly/d3":58}],1127:[function(d,ee,te){var w=d("../plots/cartesian/axes"),v=d("../lib"),S=d("../plot_api/plot_schema"),M=d("./helpers").pointsAccessorFunction,e=d("../constants/numerical").BADNUM;te.moduleType="transform",te.name="aggregate";var a=te.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},groups:{valType:"string",strict:!0,noBlank:!0,arrayOk:!0,dflt:"x",editType:"calc"},aggregations:{_isLinkedToArray:"aggregation",target:{valType:"string",editType:"calc"},func:{valType:"enumerated",values:["count","sum","avg","median","mode","rms","stddev","min","max","first","last","change","range"],dflt:"first",editType:"calc"},funcmode:{valType:"enumerated",values:["sample","population"],dflt:"sample",editType:"calc"},enabled:{valType:"boolean",dflt:!0,editType:"calc"},editType:"calc"},editType:"calc"},n=a.aggregations;te.supplyDefaults=function(y,p){var g={},h;function m(P,z){return v.coerce(y,g,a,P,z)}var u=m("enabled");if(!u)return g;var _=S.findArrayAttributes(p),s={};for(h=0;h<_.length;h++)s[_[h]]=1;var A=m("groups");if(!Array.isArray(A)){if(!s[A])return g.enabled=!1,g;s[A]=0}var b=y.aggregations||[],f=g.aggregations=new Array(b.length),x;function l(P,z){return v.coerce(b[h],x,n,P,z)}for(h=0;h<b.length;h++){x={_index:h};var L=l("target"),T=l("func"),k=l("enabled");k&&L&&(s[L]||T==="count"&&s[L]===void 0)?(T==="stddev"&&l("funcmode"),s[L]=0,f[h]=x):f[h]={enabled:!1,_index:h}}for(h=0;h<_.length;h++)s[_[h]]&&f.push({target:_[h],func:n.func.dflt,enabled:!0,_index:-1});return g},te.calcTransform=function(y,p,g){if(!!g.enabled){var h=g.groups,m=v.getTargetArray(p,{target:h});if(!!m){var u,_,s,A,b={},f={},x=[],l=M(p.transforms,g),L=m.length;for(p._length&&(L=Math.min(L,p._length)),u=0;u<L;u++)_=m[u],s=b[_],s===void 0?(b[_]=x.length,A=[u],x.push(A),f[b[_]]=l(u)):(x[s].push(u),f[b[_]]=(f[b[_]]||[]).concat(l(u)));g._indexToPoints=f;var T=g.aggregations;for(u=0;u<T.length;u++)r(y,p,x,T[u]);typeof h=="string"&&r(y,p,x,{target:h,func:"first",enabled:!0}),p._length=x.length}}};function r(y,p,g,h){if(!!h.enabled){for(var m=h.target,u=v.nestedProperty(p,m),_=u.get(),s=w.getDataConversions(y,p,m,_),A=t(h,s),b=new Array(g.length),f=0;f<g.length;f++)b[f]=A(_,g[f]);u.set(b),h.func==="count"&&v.pushUnique(p._arrayAttrs,m)}}function t(y,p){var g=y.func,h=p.d2c,m=p.c2d;switch(g){case"count":return c;case"first":return o;case"last":return i;case"sum":return function(u,_){for(var s=0,A=0;A<_.length;A++){var b=h(u[_[A]]);b!==e&&(s+=b)}return m(s)};case"avg":return function(u,_){for(var s=0,A=0,b=0;b<_.length;b++){var f=h(u[_[b]]);f!==e&&(s+=f,A++)}return A?m(s/A):e};case"min":return function(u,_){for(var s=1/0,A=0;A<_.length;A++){var b=h(u[_[A]]);b!==e&&(s=Math.min(s,b))}return s===1/0?e:m(s)};case"max":return function(u,_){for(var s=-1/0,A=0;A<_.length;A++){var b=h(u[_[A]]);b!==e&&(s=Math.max(s,b))}return s===-1/0?e:m(s)};case"range":return function(u,_){for(var s=1/0,A=-1/0,b=0;b<_.length;b++){var f=h(u[_[b]]);f!==e&&(s=Math.min(s,f),A=Math.max(A,f))}return A===-1/0||s===1/0?e:m(A-s)};case"change":return function(u,_){var s=h(u[_[0]]),A=h(u[_[_.length-1]]);return s===e||A===e?e:m(A-s)};case"median":return function(u,_){for(var s=[],A=0;A<_.length;A++){var b=h(u[_[A]]);b!==e&&s.push(b)}if(!s.length)return e;s.sort(v.sorterAsc);var f=(s.length-1)/2;return m((s[Math.floor(f)]+s[Math.ceil(f)])/2)};case"mode":return function(u,_){for(var s={},A=0,b=e,f=0;f<_.length;f++){var x=h(u[_[f]]);if(x!==e){var l=s[x]=(s[x]||0)+1;l>A&&(A=l,b=x)}}return A?m(b):e};case"rms":return function(u,_){for(var s=0,A=0,b=0;b<_.length;b++){var f=h(u[_[b]]);f!==e&&(s+=f*f,A++)}return A?m(Math.sqrt(s/A)):e};case"stddev":return function(u,_){var s=0,A=0,b=1,f=e,x;for(x=0;x<_.length&&f===e;x++)f=h(u[_[x]]);if(f===e)return e;for(;x<_.length;x++){var l=h(u[_[x]]);if(l!==e){var L=l-f;s+=L,A+=L*L,b++}}var T=y.funcmode==="sample"?b-1:b;return T?Math.sqrt((A-s*s/b)/T):0}}}function c(y,p){return p.length}function o(y,p){return y[p[0]]}function i(y,p){return y[p[p.length-1]]}},{"../constants/numerical":491,"../lib":515,"../plot_api/plot_schema":554,"../plots/cartesian/axes":566,"./helpers":1130}],1128:[function(d,ee,te){var w=d("../lib"),v=d("../registry"),S=d("../plots/cartesian/axes"),M=d("./helpers").pointsAccessorFunction,e=d("../constants/filter_ops"),a=e.COMPARISON_OPS,n=e.INTERVAL_OPS,r=e.SET_OPS;te.moduleType="transform",te.name="filter",te.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},target:{valType:"string",strict:!0,noBlank:!0,arrayOk:!0,dflt:"x",editType:"calc"},operation:{valType:"enumerated",values:[].concat(a).concat(n).concat(r),dflt:"=",editType:"calc"},value:{valType:"any",dflt:0,editType:"calc"},preservegaps:{valType:"boolean",dflt:!1,editType:"calc"},editType:"calc"},te.supplyDefaults=function(c){var o={};function i(h,m){return w.coerce(c,o,te.attributes,h,m)}var y=i("enabled");if(y){var p=i("target");if(w.isArrayOrTypedArray(p)&&p.length===0)return o.enabled=!1,o;i("preservegaps"),i("operation"),i("value");var g=v.getComponentMethod("calendars","handleDefaults");g(c,o,"valuecalendar",null),g(c,o,"targetcalendar",null)}return o},te.calcTransform=function(c,o,i){if(!i.enabled)return;var y=w.getTargetArray(o,i);if(!y)return;var p=i.target,g=y.length;o._length&&(g=Math.min(g,o._length));var h=i.targetcalendar,m=o._arrayAttrs,u=i.preservegaps;if(typeof p=="string"){var _=w.nestedProperty(o,p+"calendar").get();_&&(h=_)}var s=S.getDataToCoordFunc(c,o,p,y),A=t(i,s,h),b={},f={},x=0;function l(I,D){for(var R=0;R<m.length;R++){var B=w.nestedProperty(o,m[R]);I(B,D)}}var L,T;u?(L=function(I){b[I.astr]=w.extendDeep([],I.get()),I.set(new Array(g))},T=function(I,D){var R=b[I.astr][D];I.get()[D]=R}):(L=function(I){b[I.astr]=w.extendDeep([],I.get()),I.set([])},T=function(I,D){var R=b[I.astr][D];I.get().push(R)}),l(L);for(var k=M(o.transforms,i),P=0;P<g;P++){var z=A(y[P]);z?(l(T,P),f[x++]=k(P)):u&&x++}i._indexToPoints=f,o._length=x};function t(c,o,i){var y=c.operation,p=c.value,g=Array.isArray(p);function h(s){return s.indexOf(y)!==-1}var m=function(s){return o(s,0,c.valuecalendar)},u=function(s){return o(s,0,i)},_;switch(h(a)?_=m(g?p[0]:p):h(n)?_=g?[m(p[0]),m(p[1])]:[m(p),m(p)]:h(r)&&(_=g?p.map(m):[m(p)]),y){case"=":return function(s){return u(s)===_};case"!=":return function(s){return u(s)!==_};case"<":return function(s){return u(s)<_};case"<=":return function(s){return u(s)<=_};case">":return function(s){return u(s)>_};case">=":return function(s){return u(s)>=_};case"[]":return function(s){var A=u(s);return A>=_[0]&&A<=_[1]};case"()":return function(s){var A=u(s);return A>_[0]&&A<_[1]};case"[)":return function(s){var A=u(s);return A>=_[0]&&A<_[1]};case"(]":return function(s){var A=u(s);return A>_[0]&&A<=_[1]};case"][":return function(s){var A=u(s);return A<=_[0]||A>=_[1]};case")(":return function(s){var A=u(s);return A<_[0]||A>_[1]};case"](":return function(s){var A=u(s);return A<=_[0]||A>_[1]};case")[":return function(s){var A=u(s);return A<_[0]||A>=_[1]};case"{}":return function(s){return _.indexOf(u(s))!==-1};case"}{":return function(s){return _.indexOf(u(s))===-1}}}},{"../constants/filter_ops":487,"../lib":515,"../plots/cartesian/axes":566,"../registry":647,"./helpers":1130}],1129:[function(d,ee,te){var w=d("../lib"),v=d("../plot_api/plot_schema"),S=d("../plots/plots"),M=d("./helpers").pointsAccessorFunction;te.moduleType="transform",te.name="groupby",te.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},groups:{valType:"data_array",dflt:[],editType:"calc"},nameformat:{valType:"string",editType:"calc"},styles:{_isLinkedToArray:"style",target:{valType:"string",editType:"calc"},value:{valType:"any",dflt:{},editType:"calc",_compareAsJSON:!0},editType:"calc"},editType:"calc"},te.supplyDefaults=function(a,n,r){var t,c={};function o(m,u){return w.coerce(a,c,te.attributes,m,u)}var i=o("enabled");if(!i)return c;o("groups"),o("nameformat",r._dataLength>1?"%{group} (%{trace})":"%{group}");var y=a.styles,p=c.styles=[];if(y)for(t=0;t<y.length;t++){var g=p[t]={};w.coerce(y[t],p[t],te.attributes.styles,"target");var h=w.coerce(y[t],p[t],te.attributes.styles,"value");w.isPlainObject(h)?g.value=w.extendDeep({},h):h&&delete g.value}return c},te.transform=function(a,n){var r,t,c,o=[];for(t=0;t<a.length;t++)for(r=e(a[t],n),c=0;c<r.length;c++)o.push(r[c]);return o};function e(a,n){var r,t,c,o,i,y,p,g,h,m,u=n.transform,_=n.transformIndex,s=a.transforms[_].groups,A=M(a.transforms,u);if(!w.isArrayOrTypedArray(s)||s.length===0)return[a];var b=w.filterUnique(s),f=new Array(b.length),x=s.length,l=v.findArrayAttributes(a),L=u.styles||[],T={};for(r=0;r<L.length;r++)T[L[r].target]=L[r].value;u.styles&&(m=w.keyedContainer(u,"styles","target","value.name"));var k={},P={};for(r=0;r<b.length;r++){y=b[r],k[y]=r,P[y]=0,p=f[r]=w.extendDeepNoArrays({},a),p._group=y,p.transforms[_]._indexToPoints={};var z=null;for(m&&(z=m.get(y)),z||z===""?p.name=z:p.name=w.templateString(u.nameformat,{trace:a.name,group:y}),g=p.transforms,p.transforms=[],t=0;t<g.length;t++)p.transforms[t]=w.extendDeepNoArrays({},g[t]);for(t=0;t<l.length;t++)w.nestedProperty(p,l[t]).set([])}for(c=0;c<l.length;c++){for(o=l[c],t=0,h=[];t<b.length;t++)h[t]=w.nestedProperty(f[t],o).get();for(i=w.nestedProperty(a,o).get(),t=0;t<x;t++)h[k[s[t]]].push(i[t])}for(t=0;t<x;t++){p=f[k[s[t]]];var I=p.transforms[_]._indexToPoints;I[P[s[t]]]=A(t),P[s[t]]++}for(r=0;r<b.length;r++)y=b[r],p=f[r],S.clearExpandedTraceDefaultColors(p),p=w.extendDeepNoArrays(p,T[y]||{});return f}},{"../lib":515,"../plot_api/plot_schema":554,"../plots/plots":628,"./helpers":1130}],1130:[function(d,ee,te){te.pointsAccessorFunction=function(w,v){for(var S,M,e=0;e<w.length&&(S=w[e],S!==v);e++)!S._indexToPoints||S.enabled===!1||(M=S._indexToPoints);var a=M?function(n){return M[n]}:function(n){return[n]};return a}},{}],1131:[function(d,ee,te){var w=d("../lib"),v=d("../plots/cartesian/axes"),S=d("./helpers").pointsAccessorFunction,M=d("../constants/numerical").BADNUM;te.moduleType="transform",te.name="sort",te.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},target:{valType:"string",strict:!0,noBlank:!0,arrayOk:!0,dflt:"x",editType:"calc"},order:{valType:"enumerated",values:["ascending","descending"],dflt:"ascending",editType:"calc"},editType:"calc"},te.supplyDefaults=function(n){var r={};function t(o,i){return w.coerce(n,r,te.attributes,o,i)}var c=t("enabled");return c&&(t("target"),t("order")),r},te.calcTransform=function(n,r,t){if(!!t.enabled){var c=w.getTargetArray(r,t);if(!!c){var o=t.target,i=c.length;r._length&&(i=Math.min(i,r._length));var y=r._arrayAttrs,p=v.getDataToCoordFunc(n,r,o,c),g=e(t,c,p,i),h=S(r.transforms,t),m={},u,_;for(u=0;u<y.length;u++){var s=w.nestedProperty(r,y[u]),A=s.get(),b=new Array(i);for(_=0;_<i;_++)b[_]=A[g[_]];s.set(b)}for(_=0;_<i;_++)m[_]=h(g[_]);t._indexToPoints=m,r._length=i}}};function e(n,r,t,c){var o=new Array(c),i=new Array(c),y;for(y=0;y<c;y++)o[y]={v:r[y],i:y};for(o.sort(a(n,t)),y=0;y<c;y++)i[y]=o[y].i;return i}function a(n,r){switch(n.order){case"ascending":return function(t,c){var o=r(t.v),i=r(c.v);return o===M?1:i===M?-1:o-i};case"descending":return function(t,c){var o=r(t.v),i=r(c.v);return o===M?1:i===M?-1:i-o}}}},{"../constants/numerical":491,"../lib":515,"../plots/cartesian/axes":566,"./helpers":1130}],1132:[function(d,ee,te){te.version="2.13.3"},{}],1133:[function(d,ee,te){(function(w){(function(){(function(v){if(typeof te=="object"&&typeof ee<"u")ee.exports=v();else{var S;typeof window<"u"?S=window:typeof w<"u"?S=w:typeof self<"u"?S=self:S=this,S.stackgl=v()}})(function(){return function(){function v(S,M,e){function a(t,c){if(!M[t]){if(!S[t]){var o=typeof d=="function"&&d;if(!c&&o)return o(t,!0);if(n)return n(t,!0);var i=new Error("Cannot find module '"+t+"'");throw i.code="MODULE_NOT_FOUND",i}var y=M[t]={exports:{}};S[t][0].call(y.exports,function(p){var g=S[t][1][p];return a(g||p)},y,y.exports,v,S,M,e)}return M[t].exports}for(var n=typeof d=="function"&&d,r=0;r<e.length;r++)a(e[r]);return a}return v}()({1:[function(v,S,M){M.byteLength=i,M.toByteArray=p,M.fromByteArray=m;for(var e=[],a=[],n=typeof Uint8Array<"u"?Uint8Array:Array,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=0,c=r.length;t<c;++t)e[t]=r[t],a[r.charCodeAt(t)]=t;a["-".charCodeAt(0)]=62,a["_".charCodeAt(0)]=63;function o(u){var _=u.length;if(_%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var s=u.indexOf("=");s===-1&&(s=_);var A=s===_?0:4-s%4;return[s,A]}function i(u){var _=o(u),s=_[0],A=_[1];return(s+A)*3/4-A}function y(u,_,s){return(_+s)*3/4-s}function p(u){var _,s=o(u),A=s[0],b=s[1],f=new n(y(u,A,b)),x=0,l=b>0?A-4:A,L;for(L=0;L<l;L+=4)_=a[u.charCodeAt(L)]<<18|a[u.charCodeAt(L+1)]<<12|a[u.charCodeAt(L+2)]<<6|a[u.charCodeAt(L+3)],f[x++]=_>>16&255,f[x++]=_>>8&255,f[x++]=_&255;return b===2&&(_=a[u.charCodeAt(L)]<<2|a[u.charCodeAt(L+1)]>>4,f[x++]=_&255),b===1&&(_=a[u.charCodeAt(L)]<<10|a[u.charCodeAt(L+1)]<<4|a[u.charCodeAt(L+2)]>>2,f[x++]=_>>8&255,f[x++]=_&255),f}function g(u){return e[u>>18&63]+e[u>>12&63]+e[u>>6&63]+e[u&63]}function h(u,_,s){for(var A,b=[],f=_;f<s;f+=3)A=(u[f]<<16&16711680)+(u[f+1]<<8&65280)+(u[f+2]&255),b.push(g(A));return b.join("")}function m(u){for(var _,s=u.length,A=s%3,b=[],f=16383,x=0,l=s-A;x<l;x+=f)b.push(h(u,x,x+f>l?l:x+f));return A===1?(_=u[s-1],b.push(e[_>>2]+e[_<<4&63]+"==")):A===2&&(_=(u[s-2]<<8)+u[s-1],b.push(e[_>>10]+e[_>>4&63]+e[_<<2&63]+"=")),b.join("")}},{}],2:[function(v,S,M){},{}],3:[function(v,S,M){(function(e){(function(){var a=v("base64-js"),n=v("ieee754");M.Buffer=o,M.SlowBuffer=A,M.INSPECT_MAX_BYTES=50;var r=2147483647;M.kMaxLength=r,o.TYPED_ARRAY_SUPPORT=t(),!o.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function t(){try{var ue=new Uint8Array(1);return ue.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},ue.foo()===42}catch{return!1}}Object.defineProperty(o.prototype,"parent",{enumerable:!0,get:function(){if(!!o.isBuffer(this))return this.buffer}}),Object.defineProperty(o.prototype,"offset",{enumerable:!0,get:function(){if(!!o.isBuffer(this))return this.byteOffset}});function c(ue){if(ue>r)throw new RangeError('The value "'+ue+'" is invalid for option "size"');var pe=new Uint8Array(ue);return pe.__proto__=o.prototype,pe}function o(ue,pe,ge){if(typeof ue=="number"){if(typeof pe=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return g(ue)}return i(ue,pe,ge)}typeof Symbol<"u"&&Symbol.species!=null&&o[Symbol.species]===o&&Object.defineProperty(o,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),o.poolSize=8192;function i(ue,pe,ge){if(typeof ue=="string")return h(ue,pe);if(ArrayBuffer.isView(ue))return m(ue);if(ue==null)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof ue);if(le(ue,ArrayBuffer)||ue&&le(ue.buffer,ArrayBuffer))return u(ue,pe,ge);if(typeof ue=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var Te=ue.valueOf&&ue.valueOf();if(Te!=null&&Te!==ue)return o.from(Te,pe,ge);var _e=_(ue);if(_e)return _e;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof ue[Symbol.toPrimitive]=="function")return o.from(ue[Symbol.toPrimitive]("string"),pe,ge);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof ue)}o.from=function(ue,pe,ge){return i(ue,pe,ge)},o.prototype.__proto__=Uint8Array.prototype,o.__proto__=Uint8Array;function y(ue){if(typeof ue!="number")throw new TypeError('"size" argument must be of type number');if(ue<0)throw new RangeError('The value "'+ue+'" is invalid for option "size"')}function p(ue,pe,ge){return y(ue),ue<=0?c(ue):pe!==void 0?typeof ge=="string"?c(ue).fill(pe,ge):c(ue).fill(pe):c(ue)}o.alloc=function(ue,pe,ge){return p(ue,pe,ge)};function g(ue){return y(ue),c(ue<0?0:s(ue)|0)}o.allocUnsafe=function(ue){return g(ue)},o.allocUnsafeSlow=function(ue){return g(ue)};function h(ue,pe){if((typeof pe!="string"||pe==="")&&(pe="utf8"),!o.isEncoding(pe))throw new TypeError("Unknown encoding: "+pe);var ge=b(ue,pe)|0,Te=c(ge),_e=Te.write(ue,pe);return _e!==ge&&(Te=Te.slice(0,_e)),Te}function m(ue){for(var pe=ue.length<0?0:s(ue.length)|0,ge=c(pe),Te=0;Te<pe;Te+=1)ge[Te]=ue[Te]&255;return ge}function u(ue,pe,ge){if(pe<0||ue.byteLength<pe)throw new RangeError('"offset" is outside of buffer bounds');if(ue.byteLength<pe+(ge||0))throw new RangeError('"length" is outside of buffer bounds');var Te;return pe===void 0&&ge===void 0?Te=new Uint8Array(ue):ge===void 0?Te=new Uint8Array(ue,pe):Te=new Uint8Array(ue,pe,ge),Te.__proto__=o.prototype,Te}function _(ue){if(o.isBuffer(ue)){var pe=s(ue.length)|0,ge=c(pe);return ge.length===0||ue.copy(ge,0,0,pe),ge}if(ue.length!==void 0)return typeof ue.length!="number"||ye(ue.length)?c(0):m(ue);if(ue.type==="Buffer"&&Array.isArray(ue.data))return m(ue.data)}function s(ue){if(ue>=r)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+r.toString(16)+" bytes");return ue|0}function A(ue){return+ue!=ue&&(ue=0),o.alloc(+ue)}o.isBuffer=function(pe){return pe!=null&&pe._isBuffer===!0&&pe!==o.prototype},o.compare=function(pe,ge){if(le(pe,Uint8Array)&&(pe=o.from(pe,pe.offset,pe.byteLength)),le(ge,Uint8Array)&&(ge=o.from(ge,ge.offset,ge.byteLength)),!o.isBuffer(pe)||!o.isBuffer(ge))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(pe===ge)return 0;for(var Te=pe.length,_e=ge.length,ze=0,Oe=Math.min(Te,_e);ze<Oe;++ze)if(pe[ze]!==ge[ze]){Te=pe[ze],_e=ge[ze];break}return Te<_e?-1:_e<Te?1:0},o.isEncoding=function(pe){switch(String(pe).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},o.concat=function(pe,ge){if(!Array.isArray(pe))throw new TypeError('"list" argument must be an Array of Buffers');if(pe.length===0)return o.alloc(0);var Te;if(ge===void 0)for(ge=0,Te=0;Te<pe.length;++Te)ge+=pe[Te].length;var _e=o.allocUnsafe(ge),ze=0;for(Te=0;Te<pe.length;++Te){var Oe=pe[Te];if(le(Oe,Uint8Array)&&(Oe=o.from(Oe)),!o.isBuffer(Oe))throw new TypeError('"list" argument must be an Array of Buffers');Oe.copy(_e,ze),ze+=Oe.length}return _e};function b(ue,pe){if(o.isBuffer(ue))return ue.length;if(ArrayBuffer.isView(ue)||le(ue,ArrayBuffer))return ue.byteLength;if(typeof ue!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof ue);var ge=ue.length,Te=arguments.length>2&&arguments[2]===!0;if(!Te&&ge===0)return 0;for(var _e=!1;;)switch(pe){case"ascii":case"latin1":case"binary":return ge;case"utf8":case"utf-8":return W(ue).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ge*2;case"hex":return ge>>>1;case"base64":return ae(ue).length;default:if(_e)return Te?-1:W(ue).length;pe=(""+pe).toLowerCase(),_e=!0}}o.byteLength=b;function f(ue,pe,ge){var Te=!1;if((pe===void 0||pe<0)&&(pe=0),pe>this.length||((ge===void 0||ge>this.length)&&(ge=this.length),ge<=0)||(ge>>>=0,pe>>>=0,ge<=pe))return"";for(ue||(ue="utf8");;)switch(ue){case"hex":return X(this,pe,ge);case"utf8":case"utf-8":return B(this,pe,ge);case"ascii":return G(this,pe,ge);case"latin1":case"binary":return J(this,pe,ge);case"base64":return R(this,pe,ge);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Y(this,pe,ge);default:if(Te)throw new TypeError("Unknown encoding: "+ue);ue=(ue+"").toLowerCase(),Te=!0}}o.prototype._isBuffer=!0;function x(ue,pe,ge){var Te=ue[pe];ue[pe]=ue[ge],ue[ge]=Te}o.prototype.swap16=function(){var pe=this.length;if(pe%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var ge=0;ge<pe;ge+=2)x(this,ge,ge+1);return this},o.prototype.swap32=function(){var pe=this.length;if(pe%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var ge=0;ge<pe;ge+=4)x(this,ge,ge+3),x(this,ge+1,ge+2);return this},o.prototype.swap64=function(){var pe=this.length;if(pe%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var ge=0;ge<pe;ge+=8)x(this,ge,ge+7),x(this,ge+1,ge+6),x(this,ge+2,ge+5),x(this,ge+3,ge+4);return this},o.prototype.toString=function(){var pe=this.length;return pe===0?"":arguments.length===0?B(this,0,pe):f.apply(this,arguments)},o.prototype.toLocaleString=o.prototype.toString,o.prototype.equals=function(pe){if(!o.isBuffer(pe))throw new TypeError("Argument must be a Buffer");return this===pe?!0:o.compare(this,pe)===0},o.prototype.inspect=function(){var pe="",ge=M.INSPECT_MAX_BYTES;return pe=this.toString("hex",0,ge).replace(/(.{2})/g,"$1 ").trim(),this.length>ge&&(pe+=" ... "),"<Buffer "+pe+">"},o.prototype.compare=function(pe,ge,Te,_e,ze){if(le(pe,Uint8Array)&&(pe=o.from(pe,pe.offset,pe.byteLength)),!o.isBuffer(pe))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof pe);if(ge===void 0&&(ge=0),Te===void 0&&(Te=pe?pe.length:0),_e===void 0&&(_e=0),ze===void 0&&(ze=this.length),ge<0||Te>pe.length||_e<0||ze>this.length)throw new RangeError("out of range index");if(_e>=ze&&ge>=Te)return 0;if(_e>=ze)return-1;if(ge>=Te)return 1;if(ge>>>=0,Te>>>=0,_e>>>=0,ze>>>=0,this===pe)return 0;for(var Oe=ze-_e,Ye=Te-ge,be=Math.min(Oe,Ye),Pe=this.slice(_e,ze),Ge=pe.slice(ge,Te),Qe=0;Qe<be;++Qe)if(Pe[Qe]!==Ge[Qe]){Oe=Pe[Qe],Ye=Ge[Qe];break}return Oe<Ye?-1:Ye<Oe?1:0};function l(ue,pe,ge,Te,_e){if(ue.length===0)return-1;if(typeof ge=="string"?(Te=ge,ge=0):ge>2147483647?ge=2147483647:ge<-2147483648&&(ge=-2147483648),ge=+ge,ye(ge)&&(ge=_e?0:ue.length-1),ge<0&&(ge=ue.length+ge),ge>=ue.length){if(_e)return-1;ge=ue.length-1}else if(ge<0)if(_e)ge=0;else return-1;if(typeof pe=="string"&&(pe=o.from(pe,Te)),o.isBuffer(pe))return pe.length===0?-1:L(ue,pe,ge,Te,_e);if(typeof pe=="number")return pe=pe&255,typeof Uint8Array.prototype.indexOf=="function"?_e?Uint8Array.prototype.indexOf.call(ue,pe,ge):Uint8Array.prototype.lastIndexOf.call(ue,pe,ge):L(ue,[pe],ge,Te,_e);throw new TypeError("val must be string, number or Buffer")}function L(ue,pe,ge,Te,_e){var ze=1,Oe=ue.length,Ye=pe.length;if(Te!==void 0&&(Te=String(Te).toLowerCase(),Te==="ucs2"||Te==="ucs-2"||Te==="utf16le"||Te==="utf-16le")){if(ue.length<2||pe.length<2)return-1;ze=2,Oe/=2,Ye/=2,ge/=2}function be(Le,He){return ze===1?Le[He]:Le.readUInt16BE(He*ze)}var Pe;if(_e){var Ge=-1;for(Pe=ge;Pe<Oe;Pe++)if(be(ue,Pe)===be(pe,Ge===-1?0:Pe-Ge)){if(Ge===-1&&(Ge=Pe),Pe-Ge+1===Ye)return Ge*ze}else Ge!==-1&&(Pe-=Pe-Ge),Ge=-1}else for(ge+Ye>Oe&&(ge=Oe-Ye),Pe=ge;Pe>=0;Pe--){for(var Qe=!0,Be=0;Be<Ye;Be++)if(be(ue,Pe+Be)!==be(pe,Be)){Qe=!1;break}if(Qe)return Pe}return-1}o.prototype.includes=function(pe,ge,Te){return this.indexOf(pe,ge,Te)!==-1},o.prototype.indexOf=function(pe,ge,Te){return l(this,pe,ge,Te,!0)},o.prototype.lastIndexOf=function(pe,ge,Te){return l(this,pe,ge,Te,!1)};function T(ue,pe,ge,Te){ge=Number(ge)||0;var _e=ue.length-ge;Te?(Te=Number(Te),Te>_e&&(Te=_e)):Te=_e;var ze=pe.length;Te>ze/2&&(Te=ze/2);for(var Oe=0;Oe<Te;++Oe){var Ye=parseInt(pe.substr(Oe*2,2),16);if(ye(Ye))return Oe;ue[ge+Oe]=Ye}return Oe}function k(ue,pe,ge,Te){return ie(W(pe,ue.length-ge),ue,ge,Te)}function P(ue,pe,ge,Te){return ie(K(pe),ue,ge,Te)}function z(ue,pe,ge,Te){return P(ue,pe,ge,Te)}function I(ue,pe,ge,Te){return ie(ae(pe),ue,ge,Te)}function D(ue,pe,ge,Te){return ie(ne(pe,ue.length-ge),ue,ge,Te)}o.prototype.write=function(pe,ge,Te,_e){if(ge===void 0)_e="utf8",Te=this.length,ge=0;else if(Te===void 0&&typeof ge=="string")_e=ge,Te=this.length,ge=0;else if(isFinite(ge))ge=ge>>>0,isFinite(Te)?(Te=Te>>>0,_e===void 0&&(_e="utf8")):(_e=Te,Te=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var ze=this.length-ge;if((Te===void 0||Te>ze)&&(Te=ze),pe.length>0&&(Te<0||ge<0)||ge>this.length)throw new RangeError("Attempt to write outside buffer bounds");_e||(_e="utf8");for(var Oe=!1;;)switch(_e){case"hex":return T(this,pe,ge,Te);case"utf8":case"utf-8":return k(this,pe,ge,Te);case"ascii":return P(this,pe,ge,Te);case"latin1":case"binary":return z(this,pe,ge,Te);case"base64":return I(this,pe,ge,Te);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return D(this,pe,ge,Te);default:if(Oe)throw new TypeError("Unknown encoding: "+_e);_e=(""+_e).toLowerCase(),Oe=!0}},o.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function R(ue,pe,ge){return pe===0&&ge===ue.length?a.fromByteArray(ue):a.fromByteArray(ue.slice(pe,ge))}function B(ue,pe,ge){ge=Math.min(ue.length,ge);for(var Te=[],_e=pe;_e<ge;){var ze=ue[_e],Oe=null,Ye=ze>239?4:ze>223?3:ze>191?2:1;if(_e+Ye<=ge){var be,Pe,Ge,Qe;switch(Ye){case 1:ze<128&&(Oe=ze);break;case 2:be=ue[_e+1],(be&192)===128&&(Qe=(ze&31)<<6|be&63,Qe>127&&(Oe=Qe));break;case 3:be=ue[_e+1],Pe=ue[_e+2],(be&192)===128&&(Pe&192)===128&&(Qe=(ze&15)<<12|(be&63)<<6|Pe&63,Qe>2047&&(Qe<55296||Qe>57343)&&(Oe=Qe));break;case 4:be=ue[_e+1],Pe=ue[_e+2],Ge=ue[_e+3],(be&192)===128&&(Pe&192)===128&&(Ge&192)===128&&(Qe=(ze&15)<<18|(be&63)<<12|(Pe&63)<<6|Ge&63,Qe>65535&&Qe<1114112&&(Oe=Qe))}}Oe===null?(Oe=65533,Ye=1):Oe>65535&&(Oe-=65536,Te.push(Oe>>>10&1023|55296),Oe=56320|Oe&1023),Te.push(Oe),_e+=Ye}return H(Te)}var F=4096;function H(ue){var pe=ue.length;if(pe<=F)return String.fromCharCode.apply(String,ue);for(var ge="",Te=0;Te<pe;)ge+=String.fromCharCode.apply(String,ue.slice(Te,Te+=F));return ge}function G(ue,pe,ge){var Te="";ge=Math.min(ue.length,ge);for(var _e=pe;_e<ge;++_e)Te+=String.fromCharCode(ue[_e]&127);return Te}function J(ue,pe,ge){var Te="";ge=Math.min(ue.length,ge);for(var _e=pe;_e<ge;++_e)Te+=String.fromCharCode(ue[_e]);return Te}function X(ue,pe,ge){var Te=ue.length;(!pe||pe<0)&&(pe=0),(!ge||ge<0||ge>Te)&&(ge=Te);for(var _e="",ze=pe;ze<ge;++ze)_e+=$(ue[ze]);return _e}function Y(ue,pe,ge){for(var Te=ue.slice(pe,ge),_e="",ze=0;ze<Te.length;ze+=2)_e+=String.fromCharCode(Te[ze]+Te[ze+1]*256);return _e}o.prototype.slice=function(pe,ge){var Te=this.length;pe=~~pe,ge=ge===void 0?Te:~~ge,pe<0?(pe+=Te,pe<0&&(pe=0)):pe>Te&&(pe=Te),ge<0?(ge+=Te,ge<0&&(ge=0)):ge>Te&&(ge=Te),ge<pe&&(ge=pe);var _e=this.subarray(pe,ge);return _e.__proto__=o.prototype,_e};function Z(ue,pe,ge){if(ue%1!==0||ue<0)throw new RangeError("offset is not uint");if(ue+pe>ge)throw new RangeError("Trying to access beyond buffer length")}o.prototype.readUIntLE=function(pe,ge,Te){pe=pe>>>0,ge=ge>>>0,Te||Z(pe,ge,this.length);for(var _e=this[pe],ze=1,Oe=0;++Oe<ge&&(ze*=256);)_e+=this[pe+Oe]*ze;return _e},o.prototype.readUIntBE=function(pe,ge,Te){pe=pe>>>0,ge=ge>>>0,Te||Z(pe,ge,this.length);for(var _e=this[pe+--ge],ze=1;ge>0&&(ze*=256);)_e+=this[pe+--ge]*ze;return _e},o.prototype.readUInt8=function(pe,ge){return pe=pe>>>0,ge||Z(pe,1,this.length),this[pe]},o.prototype.readUInt16LE=function(pe,ge){return pe=pe>>>0,ge||Z(pe,2,this.length),this[pe]|this[pe+1]<<8},o.prototype.readUInt16BE=function(pe,ge){return pe=pe>>>0,ge||Z(pe,2,this.length),this[pe]<<8|this[pe+1]},o.prototype.readUInt32LE=function(pe,ge){return pe=pe>>>0,ge||Z(pe,4,this.length),(this[pe]|this[pe+1]<<8|this[pe+2]<<16)+this[pe+3]*16777216},o.prototype.readUInt32BE=function(pe,ge){return pe=pe>>>0,ge||Z(pe,4,this.length),this[pe]*16777216+(this[pe+1]<<16|this[pe+2]<<8|this[pe+3])},o.prototype.readIntLE=function(pe,ge,Te){pe=pe>>>0,ge=ge>>>0,Te||Z(pe,ge,this.length);for(var _e=this[pe],ze=1,Oe=0;++Oe<ge&&(ze*=256);)_e+=this[pe+Oe]*ze;return ze*=128,_e>=ze&&(_e-=Math.pow(2,8*ge)),_e},o.prototype.readIntBE=function(pe,ge,Te){pe=pe>>>0,ge=ge>>>0,Te||Z(pe,ge,this.length);for(var _e=ge,ze=1,Oe=this[pe+--_e];_e>0&&(ze*=256);)Oe+=this[pe+--_e]*ze;return ze*=128,Oe>=ze&&(Oe-=Math.pow(2,8*ge)),Oe},o.prototype.readInt8=function(pe,ge){return pe=pe>>>0,ge||Z(pe,1,this.length),this[pe]&128?(255-this[pe]+1)*-1:this[pe]},o.prototype.readInt16LE=function(pe,ge){pe=pe>>>0,ge||Z(pe,2,this.length);var Te=this[pe]|this[pe+1]<<8;return Te&32768?Te|4294901760:Te},o.prototype.readInt16BE=function(pe,ge){pe=pe>>>0,ge||Z(pe,2,this.length);var Te=this[pe+1]|this[pe]<<8;return Te&32768?Te|4294901760:Te},o.prototype.readInt32LE=function(pe,ge){return pe=pe>>>0,ge||Z(pe,4,this.length),this[pe]|this[pe+1]<<8|this[pe+2]<<16|this[pe+3]<<24},o.prototype.readInt32BE=function(pe,ge){return pe=pe>>>0,ge||Z(pe,4,this.length),this[pe]<<24|this[pe+1]<<16|this[pe+2]<<8|this[pe+3]},o.prototype.readFloatLE=function(pe,ge){return pe=pe>>>0,ge||Z(pe,4,this.length),n.read(this,pe,!0,23,4)},o.prototype.readFloatBE=function(pe,ge){return pe=pe>>>0,ge||Z(pe,4,this.length),n.read(this,pe,!1,23,4)},o.prototype.readDoubleLE=function(pe,ge){return pe=pe>>>0,ge||Z(pe,8,this.length),n.read(this,pe,!0,52,8)},o.prototype.readDoubleBE=function(pe,ge){return pe=pe>>>0,ge||Z(pe,8,this.length),n.read(this,pe,!1,52,8)};function oe(ue,pe,ge,Te,_e,ze){if(!o.isBuffer(ue))throw new TypeError('"buffer" argument must be a Buffer instance');if(pe>_e||pe<ze)throw new RangeError('"value" argument is out of bounds');if(ge+Te>ue.length)throw new RangeError("Index out of range")}o.prototype.writeUIntLE=function(pe,ge,Te,_e){if(pe=+pe,ge=ge>>>0,Te=Te>>>0,!_e){var ze=Math.pow(2,8*Te)-1;oe(this,pe,ge,Te,ze,0)}var Oe=1,Ye=0;for(this[ge]=pe&255;++Ye<Te&&(Oe*=256);)this[ge+Ye]=pe/Oe&255;return ge+Te},o.prototype.writeUIntBE=function(pe,ge,Te,_e){if(pe=+pe,ge=ge>>>0,Te=Te>>>0,!_e){var ze=Math.pow(2,8*Te)-1;oe(this,pe,ge,Te,ze,0)}var Oe=Te-1,Ye=1;for(this[ge+Oe]=pe&255;--Oe>=0&&(Ye*=256);)this[ge+Oe]=pe/Ye&255;return ge+Te},o.prototype.writeUInt8=function(pe,ge,Te){return pe=+pe,ge=ge>>>0,Te||oe(this,pe,ge,1,255,0),this[ge]=pe&255,ge+1},o.prototype.writeUInt16LE=function(pe,ge,Te){return pe=+pe,ge=ge>>>0,Te||oe(this,pe,ge,2,65535,0),this[ge]=pe&255,this[ge+1]=pe>>>8,ge+2},o.prototype.writeUInt16BE=function(pe,ge,Te){return pe=+pe,ge=ge>>>0,Te||oe(this,pe,ge,2,65535,0),this[ge]=pe>>>8,this[ge+1]=pe&255,ge+2},o.prototype.writeUInt32LE=function(pe,ge,Te){return pe=+pe,ge=ge>>>0,Te||oe(this,pe,ge,4,4294967295,0),this[ge+3]=pe>>>24,this[ge+2]=pe>>>16,this[ge+1]=pe>>>8,this[ge]=pe&255,ge+4},o.prototype.writeUInt32BE=function(pe,ge,Te){return pe=+pe,ge=ge>>>0,Te||oe(this,pe,ge,4,4294967295,0),this[ge]=pe>>>24,this[ge+1]=pe>>>16,this[ge+2]=pe>>>8,this[ge+3]=pe&255,ge+4},o.prototype.writeIntLE=function(pe,ge,Te,_e){if(pe=+pe,ge=ge>>>0,!_e){var ze=Math.pow(2,8*Te-1);oe(this,pe,ge,Te,ze-1,-ze)}var Oe=0,Ye=1,be=0;for(this[ge]=pe&255;++Oe<Te&&(Ye*=256);)pe<0&&be===0&&this[ge+Oe-1]!==0&&(be=1),this[ge+Oe]=(pe/Ye>>0)-be&255;return ge+Te},o.prototype.writeIntBE=function(pe,ge,Te,_e){if(pe=+pe,ge=ge>>>0,!_e){var ze=Math.pow(2,8*Te-1);oe(this,pe,ge,Te,ze-1,-ze)}var Oe=Te-1,Ye=1,be=0;for(this[ge+Oe]=pe&255;--Oe>=0&&(Ye*=256);)pe<0&&be===0&&this[ge+Oe+1]!==0&&(be=1),this[ge+Oe]=(pe/Ye>>0)-be&255;return ge+Te},o.prototype.writeInt8=function(pe,ge,Te){return pe=+pe,ge=ge>>>0,Te||oe(this,pe,ge,1,127,-128),pe<0&&(pe=255+pe+1),this[ge]=pe&255,ge+1},o.prototype.writeInt16LE=function(pe,ge,Te){return pe=+pe,ge=ge>>>0,Te||oe(this,pe,ge,2,32767,-32768),this[ge]=pe&255,this[ge+1]=pe>>>8,ge+2},o.prototype.writeInt16BE=function(pe,ge,Te){return pe=+pe,ge=ge>>>0,Te||oe(this,pe,ge,2,32767,-32768),this[ge]=pe>>>8,this[ge+1]=pe&255,ge+2},o.prototype.writeInt32LE=function(pe,ge,Te){return pe=+pe,ge=ge>>>0,Te||oe(this,pe,ge,4,2147483647,-2147483648),this[ge]=pe&255,this[ge+1]=pe>>>8,this[ge+2]=pe>>>16,this[ge+3]=pe>>>24,ge+4},o.prototype.writeInt32BE=function(pe,ge,Te){return pe=+pe,ge=ge>>>0,Te||oe(this,pe,ge,4,2147483647,-2147483648),pe<0&&(pe=4294967295+pe+1),this[ge]=pe>>>24,this[ge+1]=pe>>>16,this[ge+2]=pe>>>8,this[ge+3]=pe&255,ge+4};function re(ue,pe,ge,Te,_e,ze){if(ge+Te>ue.length)throw new RangeError("Index out of range");if(ge<0)throw new RangeError("Index out of range")}function se(ue,pe,ge,Te,_e){return pe=+pe,ge=ge>>>0,_e||re(ue,pe,ge,4),n.write(ue,pe,ge,Te,23,4),ge+4}o.prototype.writeFloatLE=function(pe,ge,Te){return se(this,pe,ge,!0,Te)},o.prototype.writeFloatBE=function(pe,ge,Te){return se(this,pe,ge,!1,Te)};function N(ue,pe,ge,Te,_e){return pe=+pe,ge=ge>>>0,_e||re(ue,pe,ge,8),n.write(ue,pe,ge,Te,52,8),ge+8}o.prototype.writeDoubleLE=function(pe,ge,Te){return N(this,pe,ge,!0,Te)},o.prototype.writeDoubleBE=function(pe,ge,Te){return N(this,pe,ge,!1,Te)},o.prototype.copy=function(pe,ge,Te,_e){if(!o.isBuffer(pe))throw new TypeError("argument should be a Buffer");if(Te||(Te=0),!_e&&_e!==0&&(_e=this.length),ge>=pe.length&&(ge=pe.length),ge||(ge=0),_e>0&&_e<Te&&(_e=Te),_e===Te||pe.length===0||this.length===0)return 0;if(ge<0)throw new RangeError("targetStart out of bounds");if(Te<0||Te>=this.length)throw new RangeError("Index out of range");if(_e<0)throw new RangeError("sourceEnd out of bounds");_e>this.length&&(_e=this.length),pe.length-ge<_e-Te&&(_e=pe.length-ge+Te);var ze=_e-Te;if(this===pe&&typeof Uint8Array.prototype.copyWithin=="function")this.copyWithin(ge,Te,_e);else if(this===pe&&Te<ge&&ge<_e)for(var Oe=ze-1;Oe>=0;--Oe)pe[Oe+ge]=this[Oe+Te];else Uint8Array.prototype.set.call(pe,this.subarray(Te,_e),ge);return ze},o.prototype.fill=function(pe,ge,Te,_e){if(typeof pe=="string"){if(typeof ge=="string"?(_e=ge,ge=0,Te=this.length):typeof Te=="string"&&(_e=Te,Te=this.length),_e!==void 0&&typeof _e!="string")throw new TypeError("encoding must be a string");if(typeof _e=="string"&&!o.isEncoding(_e))throw new TypeError("Unknown encoding: "+_e);if(pe.length===1){var ze=pe.charCodeAt(0);(_e==="utf8"&&ze<128||_e==="latin1")&&(pe=ze)}}else typeof pe=="number"&&(pe=pe&255);if(ge<0||this.length<ge||this.length<Te)throw new RangeError("Out of range index");if(Te<=ge)return this;ge=ge>>>0,Te=Te===void 0?this.length:Te>>>0,pe||(pe=0);var Oe;if(typeof pe=="number")for(Oe=ge;Oe<Te;++Oe)this[Oe]=pe;else{var Ye=o.isBuffer(pe)?pe:o.from(pe,_e),be=Ye.length;if(be===0)throw new TypeError('The value "'+pe+'" is invalid for argument "value"');for(Oe=0;Oe<Te-ge;++Oe)this[Oe+ge]=Ye[Oe%be]}return this};var U=/[^+/0-9A-Za-z-_]/g;function q(ue){if(ue=ue.split("=")[0],ue=ue.trim().replace(U,""),ue.length<2)return"";for(;ue.length%4!==0;)ue=ue+"=";return ue}function $(ue){return ue<16?"0"+ue.toString(16):ue.toString(16)}function W(ue,pe){pe=pe||1/0;for(var ge,Te=ue.length,_e=null,ze=[],Oe=0;Oe<Te;++Oe){if(ge=ue.charCodeAt(Oe),ge>55295&&ge<57344){if(!_e){if(ge>56319){(pe-=3)>-1&&ze.push(239,191,189);continue}else if(Oe+1===Te){(pe-=3)>-1&&ze.push(239,191,189);continue}_e=ge;continue}if(ge<56320){(pe-=3)>-1&&ze.push(239,191,189),_e=ge;continue}ge=(_e-55296<<10|ge-56320)+65536}else _e&&(pe-=3)>-1&&ze.push(239,191,189);if(_e=null,ge<128){if((pe-=1)<0)break;ze.push(ge)}else if(ge<2048){if((pe-=2)<0)break;ze.push(ge>>6|192,ge&63|128)}else if(ge<65536){if((pe-=3)<0)break;ze.push(ge>>12|224,ge>>6&63|128,ge&63|128)}else if(ge<1114112){if((pe-=4)<0)break;ze.push(ge>>18|240,ge>>12&63|128,ge>>6&63|128,ge&63|128)}else throw new Error("Invalid code point")}return ze}function K(ue){for(var pe=[],ge=0;ge<ue.length;++ge)pe.push(ue.charCodeAt(ge)&255);return pe}function ne(ue,pe){for(var ge,Te,_e,ze=[],Oe=0;Oe<ue.length&&!((pe-=2)<0);++Oe)ge=ue.charCodeAt(Oe),Te=ge>>8,_e=ge%256,ze.push(_e),ze.push(Te);return ze}function ae(ue){return a.toByteArray(q(ue))}function ie(ue,pe,ge,Te){for(var _e=0;_e<Te&&!(_e+ge>=pe.length||_e>=ue.length);++_e)pe[_e+ge]=ue[_e];return _e}function le(ue,pe){return ue instanceof pe||ue!=null&&ue.constructor!=null&&ue.constructor.name!=null&&ue.constructor.name===pe.name}function ye(ue){return ue!==ue}}).call(this)}).call(this,v("buffer").Buffer)},{"base64-js":1,buffer:3,ieee754:4}],4:[function(v,S,M){M.read=function(e,a,n,r,t){var c,o,i=t*8-r-1,y=(1<<i)-1,p=y>>1,g=-7,h=n?t-1:0,m=n?-1:1,u=e[a+h];for(h+=m,c=u&(1<<-g)-1,u>>=-g,g+=i;g>0;c=c*256+e[a+h],h+=m,g-=8);for(o=c&(1<<-g)-1,c>>=-g,g+=r;g>0;o=o*256+e[a+h],h+=m,g-=8);if(c===0)c=1-p;else{if(c===y)return o?NaN:(u?-1:1)*(1/0);o=o+Math.pow(2,r),c=c-p}return(u?-1:1)*o*Math.pow(2,c-r)},M.write=function(e,a,n,r,t,c){var o,i,y,p=c*8-t-1,g=(1<<p)-1,h=g>>1,m=t===23?Math.pow(2,-24)-Math.pow(2,-77):0,u=r?0:c-1,_=r?1:-1,s=a<0||a===0&&1/a<0?1:0;for(a=Math.abs(a),isNaN(a)||a===1/0?(i=isNaN(a)?1:0,o=g):(o=Math.floor(Math.log(a)/Math.LN2),a*(y=Math.pow(2,-o))<1&&(o--,y*=2),o+h>=1?a+=m/y:a+=m*Math.pow(2,1-h),a*y>=2&&(o++,y/=2),o+h>=g?(i=0,o=g):o+h>=1?(i=(a*y-1)*Math.pow(2,t),o=o+h):(i=a*Math.pow(2,h-1)*Math.pow(2,t),o=0));t>=8;e[n+u]=i&255,u+=_,i/=256,t-=8);for(o=o<<t|i,p+=t;p>0;e[n+u]=o&255,u+=_,o/=256,p-=8);e[n+u-_]|=s*128}},{}],5:[function(v,S,M){var e=S.exports={},a,n;function r(){throw new Error("setTimeout has not been defined")}function t(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?a=setTimeout:a=r}catch{a=r}try{typeof clearTimeout=="function"?n=clearTimeout:n=t}catch{n=t}})();function c(s){if(a===setTimeout)return setTimeout(s,0);if((a===r||!a)&&setTimeout)return a=setTimeout,setTimeout(s,0);try{return a(s,0)}catch{try{return a.call(null,s,0)}catch{return a.call(this,s,0)}}}function o(s){if(n===clearTimeout)return clearTimeout(s);if((n===t||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(s);try{return n(s)}catch{try{return n.call(null,s)}catch{return n.call(this,s)}}}var i=[],y=!1,p,g=-1;function h(){!y||!p||(y=!1,p.length?i=p.concat(i):g=-1,i.length&&m())}function m(){if(!y){var s=c(h);y=!0;for(var A=i.length;A;){for(p=i,i=[];++g<A;)p&&p[g].run();g=-1,A=i.length}p=null,y=!1,o(s)}}e.nextTick=function(s){var A=new Array(arguments.length-1);if(arguments.length>1)for(var b=1;b<arguments.length;b++)A[b-1]=arguments[b];i.push(new u(s,A)),i.length===1&&!y&&c(m)};function u(s,A){this.fun=s,this.array=A}u.prototype.run=function(){this.fun.apply(null,this.array)},e.title="browser",e.browser=!0,e.env={},e.argv=[],e.version="",e.versions={};function _(){}e.on=_,e.addListener=_,e.once=_,e.off=_,e.removeListener=_,e.removeAllListeners=_,e.emit=_,e.prependListener=_,e.prependOnceListener=_,e.listeners=function(s){return[]},e.binding=function(s){throw new Error("process.binding is not supported")},e.cwd=function(){return"/"},e.chdir=function(s){throw new Error("process.chdir is not supported")},e.umask=function(){return 0}},{}],6:[function(v,S,M){S.exports={alpha_shape:v("alpha-shape"),convex_hull:v("convex-hull"),delaunay_triangulate:v("delaunay-triangulate"),gl_cone3d:v("gl-cone3d"),gl_error3d:v("gl-error3d"),gl_heatmap2d:v("gl-heatmap2d"),gl_line3d:v("gl-line3d"),gl_mesh3d:v("gl-mesh3d"),gl_plot2d:v("gl-plot2d"),gl_plot3d:v("gl-plot3d"),gl_pointcloud2d:v("gl-pointcloud2d"),gl_scatter3d:v("gl-scatter3d"),gl_select_box:v("gl-select-box"),gl_spikes2d:v("gl-spikes2d"),gl_streamtube3d:v("gl-streamtube3d"),gl_surface3d:v("gl-surface3d"),ndarray:v("ndarray"),ndarray_linear_interpolate:v("ndarray-linear-interpolate")}},{"alpha-shape":12,"convex-hull":58,"delaunay-triangulate":63,"gl-cone3d":79,"gl-error3d":84,"gl-heatmap2d":88,"gl-line3d":91,"gl-mesh3d":112,"gl-plot2d":118,"gl-plot3d":121,"gl-pointcloud2d":123,"gl-scatter3d":128,"gl-select-box":130,"gl-spikes2d":139,"gl-streamtube3d":143,"gl-surface3d":145,ndarray:259,"ndarray-linear-interpolate":253}],7:[function(v,S,M){S.exports=c;var e=v("turntable-camera-controller"),a=v("orbit-camera-controller"),n=v("matrix-camera-controller");function r(o,i){this._controllerNames=Object.keys(o),this._controllerList=this._controllerNames.map(function(y){return o[y]}),this._mode=i,this._active=o[i],this._active||(this._mode="turntable",this._active=o.turntable),this.modes=this._controllerNames,this.computedMatrix=this._active.computedMatrix,this.computedEye=this._active.computedEye,this.computedUp=this._active.computedUp,this.computedCenter=this._active.computedCenter,this.computedRadius=this._active.computedRadius}var t=r.prototype;t.flush=function(o){for(var i=this._controllerList,y=0;y<i.length;++y)i[y].flush(o)},t.idle=function(o){for(var i=this._controllerList,y=0;y<i.length;++y)i[y].idle(o)},t.lookAt=function(o,i,y,p){for(var g=this._controllerList,h=0;h<g.length;++h)g[h].lookAt(o,i,y,p)},t.rotate=function(o,i,y,p){for(var g=this._controllerList,h=0;h<g.length;++h)g[h].rotate(o,i,y,p)},t.pan=function(o,i,y,p){for(var g=this._controllerList,h=0;h<g.length;++h)g[h].pan(o,i,y,p)},t.translate=function(o,i,y,p){for(var g=this._controllerList,h=0;h<g.length;++h)g[h].translate(o,i,y,p)},t.setMatrix=function(o,i){for(var y=this._controllerList,p=0;p<y.length;++p)y[p].setMatrix(o,i)},t.setDistanceLimits=function(o,i){for(var y=this._controllerList,p=0;p<y.length;++p)y[p].setDistanceLimits(o,i)},t.setDistance=function(o,i){for(var y=this._controllerList,p=0;p<y.length;++p)y[p].setDistance(o,i)},t.recalcMatrix=function(o){this._active.recalcMatrix(o)},t.getDistance=function(o){return this._active.getDistance(o)},t.getDistanceLimits=function(o){return this._active.getDistanceLimits(o)},t.lastT=function(){return this._active.lastT()},t.setMode=function(o){if(o!==this._mode){var i=this._controllerNames.indexOf(o);if(!(i<0)){var y=this._active,p=this._controllerList[i],g=Math.max(y.lastT(),p.lastT());y.recalcMatrix(g),p.setMatrix(g,y.computedMatrix),this._active=p,this._mode=o,this.computedMatrix=this._active.computedMatrix,this.computedEye=this._active.computedEye,this.computedUp=this._active.computedUp,this.computedCenter=this._active.computedCenter,this.computedRadius=this._active.computedRadius}}},t.getMode=function(){return this._mode};function c(o){o=o||{};var i=o.eye||[0,0,1],y=o.center||[0,0,0],p=o.up||[0,1,0],g=o.distanceLimits||[0,1/0],h=o.mode||"turntable",m=e(),u=a(),_=n();return m.setDistanceLimits(g[0],g[1]),m.lookAt(0,i,y,p),u.setDistanceLimits(g[0],g[1]),u.lookAt(0,i,y,p),_.setDistanceLimits(g[0],g[1]),_.lookAt(0,i,y,p),new r({turntable:m,orbit:u,matrix:_},h)}},{"matrix-camera-controller":245,"orbit-camera-controller":263,"turntable-camera-controller":305}],8:[function(v,S,M){var e=typeof WeakMap>"u"?v("weak-map"):WeakMap,a=v("gl-buffer"),n=v("gl-vao"),r=new e;function t(c){var o=r.get(c),i=o&&(o._triangleBuffer.handle||o._triangleBuffer.buffer);if(!i||!c.isBuffer(i)){var y=a(c,new Float32Array([-1,-1,-1,4,4,-1]));o=n(c,[{buffer:y,type:c.FLOAT,size:2}]),o._triangleBuffer=y,r.set(c,o)}o.bind(),c.drawArrays(c.TRIANGLES,0,3),o.unbind()}S.exports=t},{"gl-buffer":78,"gl-vao":150,"weak-map":313}],9:[function(v,S,M){var e=v("pad-left");S.exports=a;function a(n,r,t){r=typeof r=="number"?r:1,t=t||": ";var c=n.split(/\r?\n/),o=String(c.length+r-1).length;return c.map(function(i,y){var p=y+r,g=String(p).length,h=e(p,o-g);return h+t+i}).join(`
`)}},{"pad-left":264}],10:[function(v,S,M){S.exports=n;var e=v("robust-orientation");function a(r,t){for(var c=new Array(t+1),o=0;o<r.length;++o)c[o]=r[o];for(var o=0;o<=r.length;++o){for(var i=r.length;i<=t;++i){for(var y=new Array(t),p=0;p<t;++p)y[p]=Math.pow(i+1-o,p);c[i]=y}var g=e.apply(void 0,c);if(g)return!0}return!1}function n(r){var t=r.length;if(t===0)return[];if(t===1)return[0];for(var c=r[0].length,o=[r[0]],i=[0],y=1;y<t;++y){if(o.push(r[y]),!a(o,c)){o.pop();continue}if(i.push(y),i.length===c+1)return i}return i}},{"robust-orientation":284}],11:[function(v,S,M){S.exports=n;var e=v("delaunay-triangulate"),a=v("circumradius");function n(r,t){return e(t).filter(function(c){for(var o=new Array(c.length),i=0;i<c.length;++i)o[i]=t[c[i]];return a(o)*r<1})}},{circumradius:49,"delaunay-triangulate":63}],12:[function(v,S,M){S.exports=n;var e=v("alpha-complex"),a=v("simplicial-complex-boundary");function n(r,t){return a(e(r,t))}},{"alpha-complex":11,"simplicial-complex-boundary":290}],13:[function(v,S,M){S.exports=function(a){return atob(a)}},{}],14:[function(v,S,M){S.exports=n;var e=v("robust-linear-solve");function a(r){for(var t=0,c=0;c<r.length;++c)t+=r[c];return t}function n(r,t){for(var c=t.length,o=new Array(c+1),i=0;i<c;++i){for(var y=new Array(c+1),p=0;p<=c;++p)y[p]=r[p][i];o[i]=y}o[c]=new Array(c+1);for(var i=0;i<=c;++i)o[c][i]=1;for(var g=new Array(c+1),i=0;i<c;++i)g[i]=t[i];g[c]=1;var h=e(o,g),m=a(h[c+1]);m===0&&(m=1);for(var u=new Array(c+1),i=0;i<=c;++i)u[i]=a(h[i])/m;return u}},{"robust-linear-solve":283}],15:[function(v,S,M){var e=v("./lib/rationalize");S.exports=a;function a(n,r){return e(n[0].mul(r[1]).add(r[0].mul(n[1])),n[1].mul(r[1]))}},{"./lib/rationalize":25}],16:[function(v,S,M){S.exports=e;function e(a,n){return a[0].mul(n[1]).cmp(n[0].mul(a[1]))}},{}],17:[function(v,S,M){var e=v("./lib/rationalize");S.exports=a;function a(n,r){return e(n[0].mul(r[1]),n[1].mul(r[0]))}},{"./lib/rationalize":25}],18:[function(v,S,M){var e=v("./is-rat"),a=v("./lib/is-bn"),n=v("./lib/num-to-bn"),r=v("./lib/str-to-bn"),t=v("./lib/rationalize"),c=v("./div");S.exports=o;function o(i,y){if(e(i))return y?c(i,o(y)):[i[0].clone(),i[1].clone()];var p=0,g,h;if(a(i))g=i.clone();else if(typeof i=="string")g=r(i);else{if(i===0)return[n(0),n(1)];if(i===Math.floor(i))g=n(i);else{for(;i!==Math.floor(i);)i=i*Math.pow(2,256),p-=256;g=n(i)}}if(e(y))g.mul(y[1]),h=y[0].clone();else if(a(y))h=y.clone();else if(typeof y=="string")h=r(y);else if(!y)h=n(1);else if(y===Math.floor(y))h=n(y);else{for(;y!==Math.floor(y);)y=y*Math.pow(2,256),p+=256;h=n(y)}return p>0?g=g.ushln(p):p<0&&(h=h.ushln(-p)),t(g,h)}},{"./div":17,"./is-rat":19,"./lib/is-bn":23,"./lib/num-to-bn":24,"./lib/rationalize":25,"./lib/str-to-bn":26}],19:[function(v,S,M){var e=v("./lib/is-bn");S.exports=a;function a(n){return Array.isArray(n)&&n.length===2&&e(n[0])&&e(n[1])}},{"./lib/is-bn":23}],20:[function(v,S,M){var e=v("bn.js");S.exports=a;function a(n){return n.cmp(new e(0))}},{"bn.js":33}],21:[function(v,S,M){var e=v("./bn-sign");S.exports=a;function a(n){var r=n.length,t=n.words,c=0;if(r===1)c=t[0];else if(r===2)c=t[0]+t[1]*67108864;else for(var o=0;o<r;o++){var i=t[o];c+=i*Math.pow(67108864,o)}return e(n)*c}},{"./bn-sign":20}],22:[function(v,S,M){var e=v("double-bits"),a=v("bit-twiddle").countTrailingZeros;S.exports=n;function n(r){var t=a(e.lo(r));if(t<32)return t;var c=a(e.hi(r));return c>20?52:c+32}},{"bit-twiddle":32,"double-bits":64}],23:[function(v,S,M){v("bn.js"),S.exports=e;function e(a){return a&&typeof a=="object"&&Boolean(a.words)}},{"bn.js":33}],24:[function(v,S,M){var e=v("bn.js"),a=v("double-bits");S.exports=n;function n(r){var t=a.exponent(r);return t<52?new e(r):new e(r*Math.pow(2,52-t)).ushln(t-52)}},{"bn.js":33,"double-bits":64}],25:[function(v,S,M){var e=v("./num-to-bn"),a=v("./bn-sign");S.exports=n;function n(r,t){var c=a(r),o=a(t);if(c===0)return[e(0),e(1)];if(o===0)return[e(0),e(0)];o<0&&(r=r.neg(),t=t.neg());var i=r.gcd(t);return i.cmpn(1)?[r.div(i),t.div(i)]:[r,t]}},{"./bn-sign":20,"./num-to-bn":24}],26:[function(v,S,M){var e=v("bn.js");S.exports=a;function a(n){return new e(n)}},{"bn.js":33}],27:[function(v,S,M){var e=v("./lib/rationalize");S.exports=a;function a(n,r){return e(n[0].mul(r[0]),n[1].mul(r[1]))}},{"./lib/rationalize":25}],28:[function(v,S,M){var e=v("./lib/bn-sign");S.exports=a;function a(n){return e(n[0])*e(n[1])}},{"./lib/bn-sign":20}],29:[function(v,S,M){var e=v("./lib/rationalize");S.exports=a;function a(n,r){return e(n[0].mul(r[1]).sub(n[1].mul(r[0])),n[1].mul(r[1]))}},{"./lib/rationalize":25}],30:[function(v,S,M){var e=v("./lib/bn-to-num"),a=v("./lib/ctz");S.exports=n;function n(r){var t=r[0],c=r[1];if(t.cmpn(0)===0)return 0;var o=t.abs().divmod(c.abs()),i=o.div,y=e(i),p=o.mod,g=t.negative!==c.negative?-1:1;if(p.cmpn(0)===0)return g*y;if(y){var h=a(y)+4,m=e(p.ushln(h).divRound(c));return g*(y+m*Math.pow(2,-h))}else{var u=c.bitLength()-p.bitLength()+53,m=e(p.ushln(u).divRound(c));return u<1023?g*m*Math.pow(2,-u):(m*=Math.pow(2,-1023),g*m*Math.pow(2,1023-u))}}},{"./lib/bn-to-num":21,"./lib/ctz":22}],31:[function(v,S,M){function e(o,i,y,p,g){for(var h=g+1;p<=g;){var m=p+g>>>1,u=o[m],_=y!==void 0?y(u,i):u-i;_>=0?(h=m,g=m-1):p=m+1}return h}function a(o,i,y,p,g){for(var h=g+1;p<=g;){var m=p+g>>>1,u=o[m],_=y!==void 0?y(u,i):u-i;_>0?(h=m,g=m-1):p=m+1}return h}function n(o,i,y,p,g){for(var h=p-1;p<=g;){var m=p+g>>>1,u=o[m],_=y!==void 0?y(u,i):u-i;_<0?(h=m,p=m+1):g=m-1}return h}function r(o,i,y,p,g){for(var h=p-1;p<=g;){var m=p+g>>>1,u=o[m],_=y!==void 0?y(u,i):u-i;_<=0?(h=m,p=m+1):g=m-1}return h}function t(o,i,y,p,g){for(;p<=g;){var h=p+g>>>1,m=o[h],u=y!==void 0?y(m,i):m-i;if(u===0)return h;u<=0?p=h+1:g=h-1}return-1}function c(o,i,y,p,g,h){return typeof y=="function"?h(o,i,y,p===void 0?0:p|0,g===void 0?o.length-1:g|0):h(o,i,void 0,y===void 0?0:y|0,p===void 0?o.length-1:p|0)}S.exports={ge:function(o,i,y,p,g){return c(o,i,y,p,g,e)},gt:function(o,i,y,p,g){return c(o,i,y,p,g,a)},lt:function(o,i,y,p,g){return c(o,i,y,p,g,n)},le:function(o,i,y,p,g){return c(o,i,y,p,g,r)},eq:function(o,i,y,p,g){return c(o,i,y,p,g,t)}}},{}],32:[function(v,S,M){var e=32;M.INT_BITS=e,M.INT_MAX=2147483647,M.INT_MIN=-1<<e-1,M.sign=function(r){return(r>0)-(r<0)},M.abs=function(r){var t=r>>e-1;return(r^t)-t},M.min=function(r,t){return t^(r^t)&-(r<t)},M.max=function(r,t){return r^(r^t)&-(r<t)},M.isPow2=function(r){return!(r&r-1)&&!!r},M.log2=function(r){var t,c;return t=(r>65535)<<4,r>>>=t,c=(r>255)<<3,r>>>=c,t|=c,c=(r>15)<<2,r>>>=c,t|=c,c=(r>3)<<1,r>>>=c,t|=c,t|r>>1},M.log10=function(r){return r>=1e9?9:r>=1e8?8:r>=1e7?7:r>=1e6?6:r>=1e5?5:r>=1e4?4:r>=1e3?3:r>=100?2:r>=10?1:0},M.popCount=function(r){return r=r-(r>>>1&1431655765),r=(r&858993459)+(r>>>2&858993459),(r+(r>>>4)&252645135)*16843009>>>24};function a(r){var t=32;return r&=-r,r&&t--,r&65535&&(t-=16),r&16711935&&(t-=8),r&252645135&&(t-=4),r&858993459&&(t-=2),r&1431655765&&(t-=1),t}M.countTrailingZeros=a,M.nextPow2=function(r){return r+=r===0,--r,r|=r>>>1,r|=r>>>2,r|=r>>>4,r|=r>>>8,r|=r>>>16,r+1},M.prevPow2=function(r){return r|=r>>>1,r|=r>>>2,r|=r>>>4,r|=r>>>8,r|=r>>>16,r-(r>>>1)},M.parity=function(r){return r^=r>>>16,r^=r>>>8,r^=r>>>4,r&=15,27030>>>r&1};var n=new Array(256);(function(r){for(var t=0;t<256;++t){var c=t,o=t,i=7;for(c>>>=1;c;c>>>=1)o<<=1,o|=c&1,--i;r[t]=o<<i&255}})(n),M.reverse=function(r){return n[r&255]<<24|n[r>>>8&255]<<16|n[r>>>16&255]<<8|n[r>>>24&255]},M.interleave2=function(r,t){return r&=65535,r=(r|r<<8)&16711935,r=(r|r<<4)&252645135,r=(r|r<<2)&858993459,r=(r|r<<1)&1431655765,t&=65535,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,r|t<<1},M.deinterleave2=function(r,t){return r=r>>>t&1431655765,r=(r|r>>>1)&858993459,r=(r|r>>>2)&252645135,r=(r|r>>>4)&16711935,r=(r|r>>>16)&65535,r<<16>>16},M.interleave3=function(r,t,c){return r&=1023,r=(r|r<<16)&4278190335,r=(r|r<<8)&251719695,r=(r|r<<4)&3272356035,r=(r|r<<2)&1227133513,t&=1023,t=(t|t<<16)&4278190335,t=(t|t<<8)&251719695,t=(t|t<<4)&3272356035,t=(t|t<<2)&1227133513,r|=t<<1,c&=1023,c=(c|c<<16)&4278190335,c=(c|c<<8)&251719695,c=(c|c<<4)&3272356035,c=(c|c<<2)&1227133513,r|c<<2},M.deinterleave3=function(r,t){return r=r>>>t&1227133513,r=(r|r>>>2)&3272356035,r=(r|r>>>4)&251719695,r=(r|r>>>8)&4278190335,r=(r|r>>>16)&1023,r<<22>>22},M.nextCombination=function(r){var t=r|r-1;return t+1|(~t&-~t)-1>>>a(r)+1}},{}],33:[function(v,S,M){(function(e,a){function n(I,D){if(!I)throw new Error(D||"Assertion failed")}function r(I,D){I.super_=D;var R=function(){};R.prototype=D.prototype,I.prototype=new R,I.prototype.constructor=I}function t(I,D,R){if(t.isBN(I))return I;this.negative=0,this.words=null,this.length=0,this.red=null,I!==null&&((D==="le"||D==="be")&&(R=D,D=10),this._init(I||0,D||10,R||"be"))}typeof e=="object"?e.exports=t:a.BN=t,t.BN=t,t.wordSize=26;var c;try{typeof window<"u"&&typeof window.Buffer<"u"?c=window.Buffer:c=v("buffer").Buffer}catch{}t.isBN=function(D){return D instanceof t?!0:D!==null&&typeof D=="object"&&D.constructor.wordSize===t.wordSize&&Array.isArray(D.words)},t.max=function(D,R){return D.cmp(R)>0?D:R},t.min=function(D,R){return D.cmp(R)<0?D:R},t.prototype._init=function(D,R,B){if(typeof D=="number")return this._initNumber(D,R,B);if(typeof D=="object")return this._initArray(D,R,B);R==="hex"&&(R=16),n(R===(R|0)&&R>=2&&R<=36),D=D.toString().replace(/\s+/g,"");var F=0;D[0]==="-"&&(F++,this.negative=1),F<D.length&&(R===16?this._parseHex(D,F,B):(this._parseBase(D,R,F),B==="le"&&this._initArray(this.toArray(),R,B)))},t.prototype._initNumber=function(D,R,B){D<0&&(this.negative=1,D=-D),D<67108864?(this.words=[D&67108863],this.length=1):D<4503599627370496?(this.words=[D&67108863,D/67108864&67108863],this.length=2):(n(D<9007199254740992),this.words=[D&67108863,D/67108864&67108863,1],this.length=3),B==="le"&&this._initArray(this.toArray(),R,B)},t.prototype._initArray=function(D,R,B){if(n(typeof D.length=="number"),D.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(D.length/3),this.words=new Array(this.length);for(var F=0;F<this.length;F++)this.words[F]=0;var H,G,J=0;if(B==="be")for(F=D.length-1,H=0;F>=0;F-=3)G=D[F]|D[F-1]<<8|D[F-2]<<16,this.words[H]|=G<<J&67108863,this.words[H+1]=G>>>26-J&67108863,J+=24,J>=26&&(J-=26,H++);else if(B==="le")for(F=0,H=0;F<D.length;F+=3)G=D[F]|D[F+1]<<8|D[F+2]<<16,this.words[H]|=G<<J&67108863,this.words[H+1]=G>>>26-J&67108863,J+=24,J>=26&&(J-=26,H++);return this.strip()};function o(I,D){var R=I.charCodeAt(D);return R>=65&&R<=70?R-55:R>=97&&R<=102?R-87:R-48&15}function i(I,D,R){var B=o(I,R);return R-1>=D&&(B|=o(I,R-1)<<4),B}t.prototype._parseHex=function(D,R,B){this.length=Math.ceil((D.length-R)/6),this.words=new Array(this.length);for(var F=0;F<this.length;F++)this.words[F]=0;var H=0,G=0,J;if(B==="be")for(F=D.length-1;F>=R;F-=2)J=i(D,R,F)<<H,this.words[G]|=J&67108863,H>=18?(H-=18,G+=1,this.words[G]|=J>>>26):H+=8;else{var X=D.length-R;for(F=X%2===0?R+1:R;F<D.length;F+=2)J=i(D,R,F)<<H,this.words[G]|=J&67108863,H>=18?(H-=18,G+=1,this.words[G]|=J>>>26):H+=8}this.strip()};function y(I,D,R,B){for(var F=0,H=Math.min(I.length,R),G=D;G<H;G++){var J=I.charCodeAt(G)-48;F*=B,J>=49?F+=J-49+10:J>=17?F+=J-17+10:F+=J}return F}t.prototype._parseBase=function(D,R,B){this.words=[0],this.length=1;for(var F=0,H=1;H<=67108863;H*=R)F++;F--,H=H/R|0;for(var G=D.length-B,J=G%F,X=Math.min(G,G-J)+B,Y=0,Z=B;Z<X;Z+=F)Y=y(D,Z,Z+F,R),this.imuln(H),this.words[0]+Y<67108864?this.words[0]+=Y:this._iaddn(Y);if(J!==0){var oe=1;for(Y=y(D,Z,D.length,R),Z=0;Z<J;Z++)oe*=R;this.imuln(oe),this.words[0]+Y<67108864?this.words[0]+=Y:this._iaddn(Y)}this.strip()},t.prototype.copy=function(D){D.words=new Array(this.length);for(var R=0;R<this.length;R++)D.words[R]=this.words[R];D.length=this.length,D.negative=this.negative,D.red=this.red},t.prototype.clone=function(){var D=new t(null);return this.copy(D),D},t.prototype._expand=function(D){for(;this.length<D;)this.words[this.length++]=0;return this},t.prototype.strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},t.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},t.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var p=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],g=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],h=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];t.prototype.toString=function(D,R){D=D||10,R=R|0||1;var B;if(D===16||D==="hex"){B="";for(var F=0,H=0,G=0;G<this.length;G++){var J=this.words[G],X=((J<<F|H)&16777215).toString(16);H=J>>>24-F&16777215,H!==0||G!==this.length-1?B=p[6-X.length]+X+B:B=X+B,F+=2,F>=26&&(F-=26,G--)}for(H!==0&&(B=H.toString(16)+B);B.length%R!==0;)B="0"+B;return this.negative!==0&&(B="-"+B),B}if(D===(D|0)&&D>=2&&D<=36){var Y=g[D],Z=h[D];B="";var oe=this.clone();for(oe.negative=0;!oe.isZero();){var re=oe.modn(Z).toString(D);oe=oe.idivn(Z),oe.isZero()?B=re+B:B=p[Y-re.length]+re+B}for(this.isZero()&&(B="0"+B);B.length%R!==0;)B="0"+B;return this.negative!==0&&(B="-"+B),B}n(!1,"Base should be between 2 and 36")},t.prototype.toNumber=function(){var D=this.words[0];return this.length===2?D+=this.words[1]*67108864:this.length===3&&this.words[2]===1?D+=4503599627370496+this.words[1]*67108864:this.length>2&&n(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-D:D},t.prototype.toJSON=function(){return this.toString(16)},t.prototype.toBuffer=function(D,R){return n(typeof c<"u"),this.toArrayLike(c,D,R)},t.prototype.toArray=function(D,R){return this.toArrayLike(Array,D,R)},t.prototype.toArrayLike=function(D,R,B){var F=this.byteLength(),H=B||Math.max(1,F);n(F<=H,"byte array longer than desired length"),n(H>0,"Requested array length <= 0"),this.strip();var G=R==="le",J=new D(H),X,Y,Z=this.clone();if(G){for(Y=0;!Z.isZero();Y++)X=Z.andln(255),Z.iushrn(8),J[Y]=X;for(;Y<H;Y++)J[Y]=0}else{for(Y=0;Y<H-F;Y++)J[Y]=0;for(Y=0;!Z.isZero();Y++)X=Z.andln(255),Z.iushrn(8),J[H-Y-1]=X}return J},Math.clz32?t.prototype._countBits=function(D){return 32-Math.clz32(D)}:t.prototype._countBits=function(D){var R=D,B=0;return R>=4096&&(B+=13,R>>>=13),R>=64&&(B+=7,R>>>=7),R>=8&&(B+=4,R>>>=4),R>=2&&(B+=2,R>>>=2),B+R},t.prototype._zeroBits=function(D){if(D===0)return 26;var R=D,B=0;return(R&8191)===0&&(B+=13,R>>>=13),(R&127)===0&&(B+=7,R>>>=7),(R&15)===0&&(B+=4,R>>>=4),(R&3)===0&&(B+=2,R>>>=2),(R&1)===0&&B++,B},t.prototype.bitLength=function(){var D=this.words[this.length-1],R=this._countBits(D);return(this.length-1)*26+R};function m(I){for(var D=new Array(I.bitLength()),R=0;R<D.length;R++){var B=R/26|0,F=R%26;D[R]=(I.words[B]&1<<F)>>>F}return D}t.prototype.zeroBits=function(){if(this.isZero())return 0;for(var D=0,R=0;R<this.length;R++){var B=this._zeroBits(this.words[R]);if(D+=B,B!==26)break}return D},t.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},t.prototype.toTwos=function(D){return this.negative!==0?this.abs().inotn(D).iaddn(1):this.clone()},t.prototype.fromTwos=function(D){return this.testn(D-1)?this.notn(D).iaddn(1).ineg():this.clone()},t.prototype.isNeg=function(){return this.negative!==0},t.prototype.neg=function(){return this.clone().ineg()},t.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},t.prototype.iuor=function(D){for(;this.length<D.length;)this.words[this.length++]=0;for(var R=0;R<D.length;R++)this.words[R]=this.words[R]|D.words[R];return this.strip()},t.prototype.ior=function(D){return n((this.negative|D.negative)===0),this.iuor(D)},t.prototype.or=function(D){return this.length>D.length?this.clone().ior(D):D.clone().ior(this)},t.prototype.uor=function(D){return this.length>D.length?this.clone().iuor(D):D.clone().iuor(this)},t.prototype.iuand=function(D){var R;this.length>D.length?R=D:R=this;for(var B=0;B<R.length;B++)this.words[B]=this.words[B]&D.words[B];return this.length=R.length,this.strip()},t.prototype.iand=function(D){return n((this.negative|D.negative)===0),this.iuand(D)},t.prototype.and=function(D){return this.length>D.length?this.clone().iand(D):D.clone().iand(this)},t.prototype.uand=function(D){return this.length>D.length?this.clone().iuand(D):D.clone().iuand(this)},t.prototype.iuxor=function(D){var R,B;this.length>D.length?(R=this,B=D):(R=D,B=this);for(var F=0;F<B.length;F++)this.words[F]=R.words[F]^B.words[F];if(this!==R)for(;F<R.length;F++)this.words[F]=R.words[F];return this.length=R.length,this.strip()},t.prototype.ixor=function(D){return n((this.negative|D.negative)===0),this.iuxor(D)},t.prototype.xor=function(D){return this.length>D.length?this.clone().ixor(D):D.clone().ixor(this)},t.prototype.uxor=function(D){return this.length>D.length?this.clone().iuxor(D):D.clone().iuxor(this)},t.prototype.inotn=function(D){n(typeof D=="number"&&D>=0);var R=Math.ceil(D/26)|0,B=D%26;this._expand(R),B>0&&R--;for(var F=0;F<R;F++)this.words[F]=~this.words[F]&67108863;return B>0&&(this.words[F]=~this.words[F]&67108863>>26-B),this.strip()},t.prototype.notn=function(D){return this.clone().inotn(D)},t.prototype.setn=function(D,R){n(typeof D=="number"&&D>=0);var B=D/26|0,F=D%26;return this._expand(B+1),R?this.words[B]=this.words[B]|1<<F:this.words[B]=this.words[B]&~(1<<F),this.strip()},t.prototype.iadd=function(D){var R;if(this.negative!==0&&D.negative===0)return this.negative=0,R=this.isub(D),this.negative^=1,this._normSign();if(this.negative===0&&D.negative!==0)return D.negative=0,R=this.isub(D),D.negative=1,R._normSign();var B,F;this.length>D.length?(B=this,F=D):(B=D,F=this);for(var H=0,G=0;G<F.length;G++)R=(B.words[G]|0)+(F.words[G]|0)+H,this.words[G]=R&67108863,H=R>>>26;for(;H!==0&&G<B.length;G++)R=(B.words[G]|0)+H,this.words[G]=R&67108863,H=R>>>26;if(this.length=B.length,H!==0)this.words[this.length]=H,this.length++;else if(B!==this)for(;G<B.length;G++)this.words[G]=B.words[G];return this},t.prototype.add=function(D){var R;return D.negative!==0&&this.negative===0?(D.negative=0,R=this.sub(D),D.negative^=1,R):D.negative===0&&this.negative!==0?(this.negative=0,R=D.sub(this),this.negative=1,R):this.length>D.length?this.clone().iadd(D):D.clone().iadd(this)},t.prototype.isub=function(D){if(D.negative!==0){D.negative=0;var R=this.iadd(D);return D.negative=1,R._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(D),this.negative=1,this._normSign();var B=this.cmp(D);if(B===0)return this.negative=0,this.length=1,this.words[0]=0,this;var F,H;B>0?(F=this,H=D):(F=D,H=this);for(var G=0,J=0;J<H.length;J++)R=(F.words[J]|0)-(H.words[J]|0)+G,G=R>>26,this.words[J]=R&67108863;for(;G!==0&&J<F.length;J++)R=(F.words[J]|0)+G,G=R>>26,this.words[J]=R&67108863;if(G===0&&J<F.length&&F!==this)for(;J<F.length;J++)this.words[J]=F.words[J];return this.length=Math.max(this.length,J),F!==this&&(this.negative=1),this.strip()},t.prototype.sub=function(D){return this.clone().isub(D)};function u(I,D,R){R.negative=D.negative^I.negative;var B=I.length+D.length|0;R.length=B,B=B-1|0;var F=I.words[0]|0,H=D.words[0]|0,G=F*H,J=G&67108863,X=G/67108864|0;R.words[0]=J;for(var Y=1;Y<B;Y++){for(var Z=X>>>26,oe=X&67108863,re=Math.min(Y,D.length-1),se=Math.max(0,Y-I.length+1);se<=re;se++){var N=Y-se|0;F=I.words[N]|0,H=D.words[se]|0,G=F*H+oe,Z+=G/67108864|0,oe=G&67108863}R.words[Y]=oe|0,X=Z|0}return X!==0?R.words[Y]=X|0:R.length--,R.strip()}var _=function(D,R,B){var F=D.words,H=R.words,G=B.words,J=0,X,Y,Z,oe=F[0]|0,re=oe&8191,se=oe>>>13,N=F[1]|0,U=N&8191,q=N>>>13,$=F[2]|0,W=$&8191,K=$>>>13,ne=F[3]|0,ae=ne&8191,ie=ne>>>13,le=F[4]|0,ye=le&8191,ue=le>>>13,pe=F[5]|0,ge=pe&8191,Te=pe>>>13,_e=F[6]|0,ze=_e&8191,Oe=_e>>>13,Ye=F[7]|0,be=Ye&8191,Pe=Ye>>>13,Ge=F[8]|0,Qe=Ge&8191,Be=Ge>>>13,Le=F[9]|0,He=Le&8191,vt=Le>>>13,Rt=H[0]|0,rr=Rt&8191,Lt=Rt>>>13,Ft=H[1]|0,Gt=Ft&8191,Dt=Ft>>>13,kt=H[2]|0,Ue=kt&8191,qe=kt>>>13,Ve=H[3]|0,Ae=Ve&8191,Ne=Ve>>>13,Xe=H[4]|0,Je=Xe&8191,_t=Xe>>>13,mt=H[5]|0,Ot=mt&8191,Kt=mt>>>13,Nt=H[6]|0,Wt=Nt&8191,qt=Nt>>>13,Yt=H[7]|0,fr=Yt&8191,Yr=Yt>>>13,hn=H[8]|0,Qr=hn&8191,at=hn>>>13,Jt=H[9]|0,Zt=Jt&8191,Ut=Jt>>>13;B.negative=D.negative^R.negative,B.length=19,X=Math.imul(re,rr),Y=Math.imul(re,Lt),Y=Y+Math.imul(se,rr)|0,Z=Math.imul(se,Lt);var _r=(J+X|0)+((Y&8191)<<13)|0;J=(Z+(Y>>>13)|0)+(_r>>>26)|0,_r&=67108863,X=Math.imul(U,rr),Y=Math.imul(U,Lt),Y=Y+Math.imul(q,rr)|0,Z=Math.imul(q,Lt),X=X+Math.imul(re,Gt)|0,Y=Y+Math.imul(re,Dt)|0,Y=Y+Math.imul(se,Gt)|0,Z=Z+Math.imul(se,Dt)|0;var rt=(J+X|0)+((Y&8191)<<13)|0;J=(Z+(Y>>>13)|0)+(rt>>>26)|0,rt&=67108863,X=Math.imul(W,rr),Y=Math.imul(W,Lt),Y=Y+Math.imul(K,rr)|0,Z=Math.imul(K,Lt),X=X+Math.imul(U,Gt)|0,Y=Y+Math.imul(U,Dt)|0,Y=Y+Math.imul(q,Gt)|0,Z=Z+Math.imul(q,Dt)|0,X=X+Math.imul(re,Ue)|0,Y=Y+Math.imul(re,qe)|0,Y=Y+Math.imul(se,Ue)|0,Z=Z+Math.imul(se,qe)|0;var Ke=(J+X|0)+((Y&8191)<<13)|0;J=(Z+(Y>>>13)|0)+(Ke>>>26)|0,Ke&=67108863,X=Math.imul(ae,rr),Y=Math.imul(ae,Lt),Y=Y+Math.imul(ie,rr)|0,Z=Math.imul(ie,Lt),X=X+Math.imul(W,Gt)|0,Y=Y+Math.imul(W,Dt)|0,Y=Y+Math.imul(K,Gt)|0,Z=Z+Math.imul(K,Dt)|0,X=X+Math.imul(U,Ue)|0,Y=Y+Math.imul(U,qe)|0,Y=Y+Math.imul(q,Ue)|0,Z=Z+Math.imul(q,qe)|0,X=X+Math.imul(re,Ae)|0,Y=Y+Math.imul(re,Ne)|0,Y=Y+Math.imul(se,Ae)|0,Z=Z+Math.imul(se,Ne)|0;var st=(J+X|0)+((Y&8191)<<13)|0;J=(Z+(Y>>>13)|0)+(st>>>26)|0,st&=67108863,X=Math.imul(ye,rr),Y=Math.imul(ye,Lt),Y=Y+Math.imul(ue,rr)|0,Z=Math.imul(ue,Lt),X=X+Math.imul(ae,Gt)|0,Y=Y+Math.imul(ae,Dt)|0,Y=Y+Math.imul(ie,Gt)|0,Z=Z+Math.imul(ie,Dt)|0,X=X+Math.imul(W,Ue)|0,Y=Y+Math.imul(W,qe)|0,Y=Y+Math.imul(K,Ue)|0,Z=Z+Math.imul(K,qe)|0,X=X+Math.imul(U,Ae)|0,Y=Y+Math.imul(U,Ne)|0,Y=Y+Math.imul(q,Ae)|0,Z=Z+Math.imul(q,Ne)|0,X=X+Math.imul(re,Je)|0,Y=Y+Math.imul(re,_t)|0,Y=Y+Math.imul(se,Je)|0,Z=Z+Math.imul(se,_t)|0;var lt=(J+X|0)+((Y&8191)<<13)|0;J=(Z+(Y>>>13)|0)+(lt>>>26)|0,lt&=67108863,X=Math.imul(ge,rr),Y=Math.imul(ge,Lt),Y=Y+Math.imul(Te,rr)|0,Z=Math.imul(Te,Lt),X=X+Math.imul(ye,Gt)|0,Y=Y+Math.imul(ye,Dt)|0,Y=Y+Math.imul(ue,Gt)|0,Z=Z+Math.imul(ue,Dt)|0,X=X+Math.imul(ae,Ue)|0,Y=Y+Math.imul(ae,qe)|0,Y=Y+Math.imul(ie,Ue)|0,Z=Z+Math.imul(ie,qe)|0,X=X+Math.imul(W,Ae)|0,Y=Y+Math.imul(W,Ne)|0,Y=Y+Math.imul(K,Ae)|0,Z=Z+Math.imul(K,Ne)|0,X=X+Math.imul(U,Je)|0,Y=Y+Math.imul(U,_t)|0,Y=Y+Math.imul(q,Je)|0,Z=Z+Math.imul(q,_t)|0,X=X+Math.imul(re,Ot)|0,Y=Y+Math.imul(re,Kt)|0,Y=Y+Math.imul(se,Ot)|0,Z=Z+Math.imul(se,Kt)|0;var wt=(J+X|0)+((Y&8191)<<13)|0;J=(Z+(Y>>>13)|0)+(wt>>>26)|0,wt&=67108863,X=Math.imul(ze,rr),Y=Math.imul(ze,Lt),Y=Y+Math.imul(Oe,rr)|0,Z=Math.imul(Oe,Lt),X=X+Math.imul(ge,Gt)|0,Y=Y+Math.imul(ge,Dt)|0,Y=Y+Math.imul(Te,Gt)|0,Z=Z+Math.imul(Te,Dt)|0,X=X+Math.imul(ye,Ue)|0,Y=Y+Math.imul(ye,qe)|0,Y=Y+Math.imul(ue,Ue)|0,Z=Z+Math.imul(ue,qe)|0,X=X+Math.imul(ae,Ae)|0,Y=Y+Math.imul(ae,Ne)|0,Y=Y+Math.imul(ie,Ae)|0,Z=Z+Math.imul(ie,Ne)|0,X=X+Math.imul(W,Je)|0,Y=Y+Math.imul(W,_t)|0,Y=Y+Math.imul(K,Je)|0,Z=Z+Math.imul(K,_t)|0,X=X+Math.imul(U,Ot)|0,Y=Y+Math.imul(U,Kt)|0,Y=Y+Math.imul(q,Ot)|0,Z=Z+Math.imul(q,Kt)|0,X=X+Math.imul(re,Wt)|0,Y=Y+Math.imul(re,qt)|0,Y=Y+Math.imul(se,Wt)|0,Z=Z+Math.imul(se,qt)|0;var Pt=(J+X|0)+((Y&8191)<<13)|0;J=(Z+(Y>>>13)|0)+(Pt>>>26)|0,Pt&=67108863,X=Math.imul(be,rr),Y=Math.imul(be,Lt),Y=Y+Math.imul(Pe,rr)|0,Z=Math.imul(Pe,Lt),X=X+Math.imul(ze,Gt)|0,Y=Y+Math.imul(ze,Dt)|0,Y=Y+Math.imul(Oe,Gt)|0,Z=Z+Math.imul(Oe,Dt)|0,X=X+Math.imul(ge,Ue)|0,Y=Y+Math.imul(ge,qe)|0,Y=Y+Math.imul(Te,Ue)|0,Z=Z+Math.imul(Te,qe)|0,X=X+Math.imul(ye,Ae)|0,Y=Y+Math.imul(ye,Ne)|0,Y=Y+Math.imul(ue,Ae)|0,Z=Z+Math.imul(ue,Ne)|0,X=X+Math.imul(ae,Je)|0,Y=Y+Math.imul(ae,_t)|0,Y=Y+Math.imul(ie,Je)|0,Z=Z+Math.imul(ie,_t)|0,X=X+Math.imul(W,Ot)|0,Y=Y+Math.imul(W,Kt)|0,Y=Y+Math.imul(K,Ot)|0,Z=Z+Math.imul(K,Kt)|0,X=X+Math.imul(U,Wt)|0,Y=Y+Math.imul(U,qt)|0,Y=Y+Math.imul(q,Wt)|0,Z=Z+Math.imul(q,qt)|0,X=X+Math.imul(re,fr)|0,Y=Y+Math.imul(re,Yr)|0,Y=Y+Math.imul(se,fr)|0,Z=Z+Math.imul(se,Yr)|0;var ke=(J+X|0)+((Y&8191)<<13)|0;J=(Z+(Y>>>13)|0)+(ke>>>26)|0,ke&=67108863,X=Math.imul(Qe,rr),Y=Math.imul(Qe,Lt),Y=Y+Math.imul(Be,rr)|0,Z=Math.imul(Be,Lt),X=X+Math.imul(be,Gt)|0,Y=Y+Math.imul(be,Dt)|0,Y=Y+Math.imul(Pe,Gt)|0,Z=Z+Math.imul(Pe,Dt)|0,X=X+Math.imul(ze,Ue)|0,Y=Y+Math.imul(ze,qe)|0,Y=Y+Math.imul(Oe,Ue)|0,Z=Z+Math.imul(Oe,qe)|0,X=X+Math.imul(ge,Ae)|0,Y=Y+Math.imul(ge,Ne)|0,Y=Y+Math.imul(Te,Ae)|0,Z=Z+Math.imul(Te,Ne)|0,X=X+Math.imul(ye,Je)|0,Y=Y+Math.imul(ye,_t)|0,Y=Y+Math.imul(ue,Je)|0,Z=Z+Math.imul(ue,_t)|0,X=X+Math.imul(ae,Ot)|0,Y=Y+Math.imul(ae,Kt)|0,Y=Y+Math.imul(ie,Ot)|0,Z=Z+Math.imul(ie,Kt)|0,X=X+Math.imul(W,Wt)|0,Y=Y+Math.imul(W,qt)|0,Y=Y+Math.imul(K,Wt)|0,Z=Z+Math.imul(K,qt)|0,X=X+Math.imul(U,fr)|0,Y=Y+Math.imul(U,Yr)|0,Y=Y+Math.imul(q,fr)|0,Z=Z+Math.imul(q,Yr)|0,X=X+Math.imul(re,Qr)|0,Y=Y+Math.imul(re,at)|0,Y=Y+Math.imul(se,Qr)|0,Z=Z+Math.imul(se,at)|0;var Se=(J+X|0)+((Y&8191)<<13)|0;J=(Z+(Y>>>13)|0)+(Se>>>26)|0,Se&=67108863,X=Math.imul(He,rr),Y=Math.imul(He,Lt),Y=Y+Math.imul(vt,rr)|0,Z=Math.imul(vt,Lt),X=X+Math.imul(Qe,Gt)|0,Y=Y+Math.imul(Qe,Dt)|0,Y=Y+Math.imul(Be,Gt)|0,Z=Z+Math.imul(Be,Dt)|0,X=X+Math.imul(be,Ue)|0,Y=Y+Math.imul(be,qe)|0,Y=Y+Math.imul(Pe,Ue)|0,Z=Z+Math.imul(Pe,qe)|0,X=X+Math.imul(ze,Ae)|0,Y=Y+Math.imul(ze,Ne)|0,Y=Y+Math.imul(Oe,Ae)|0,Z=Z+Math.imul(Oe,Ne)|0,X=X+Math.imul(ge,Je)|0,Y=Y+Math.imul(ge,_t)|0,Y=Y+Math.imul(Te,Je)|0,Z=Z+Math.imul(Te,_t)|0,X=X+Math.imul(ye,Ot)|0,Y=Y+Math.imul(ye,Kt)|0,Y=Y+Math.imul(ue,Ot)|0,Z=Z+Math.imul(ue,Kt)|0,X=X+Math.imul(ae,Wt)|0,Y=Y+Math.imul(ae,qt)|0,Y=Y+Math.imul(ie,Wt)|0,Z=Z+Math.imul(ie,qt)|0,X=X+Math.imul(W,fr)|0,Y=Y+Math.imul(W,Yr)|0,Y=Y+Math.imul(K,fr)|0,Z=Z+Math.imul(K,Yr)|0,X=X+Math.imul(U,Qr)|0,Y=Y+Math.imul(U,at)|0,Y=Y+Math.imul(q,Qr)|0,Z=Z+Math.imul(q,at)|0,X=X+Math.imul(re,Zt)|0,Y=Y+Math.imul(re,Ut)|0,Y=Y+Math.imul(se,Zt)|0,Z=Z+Math.imul(se,Ut)|0;var nt=(J+X|0)+((Y&8191)<<13)|0;J=(Z+(Y>>>13)|0)+(nt>>>26)|0,nt&=67108863,X=Math.imul(He,Gt),Y=Math.imul(He,Dt),Y=Y+Math.imul(vt,Gt)|0,Z=Math.imul(vt,Dt),X=X+Math.imul(Qe,Ue)|0,Y=Y+Math.imul(Qe,qe)|0,Y=Y+Math.imul(Be,Ue)|0,Z=Z+Math.imul(Be,qe)|0,X=X+Math.imul(be,Ae)|0,Y=Y+Math.imul(be,Ne)|0,Y=Y+Math.imul(Pe,Ae)|0,Z=Z+Math.imul(Pe,Ne)|0,X=X+Math.imul(ze,Je)|0,Y=Y+Math.imul(ze,_t)|0,Y=Y+Math.imul(Oe,Je)|0,Z=Z+Math.imul(Oe,_t)|0,X=X+Math.imul(ge,Ot)|0,Y=Y+Math.imul(ge,Kt)|0,Y=Y+Math.imul(Te,Ot)|0,Z=Z+Math.imul(Te,Kt)|0,X=X+Math.imul(ye,Wt)|0,Y=Y+Math.imul(ye,qt)|0,Y=Y+Math.imul(ue,Wt)|0,Z=Z+Math.imul(ue,qt)|0,X=X+Math.imul(ae,fr)|0,Y=Y+Math.imul(ae,Yr)|0,Y=Y+Math.imul(ie,fr)|0,Z=Z+Math.imul(ie,Yr)|0,X=X+Math.imul(W,Qr)|0,Y=Y+Math.imul(W,at)|0,Y=Y+Math.imul(K,Qr)|0,Z=Z+Math.imul(K,at)|0,X=X+Math.imul(U,Zt)|0,Y=Y+Math.imul(U,Ut)|0,Y=Y+Math.imul(q,Zt)|0,Z=Z+Math.imul(q,Ut)|0;var it=(J+X|0)+((Y&8191)<<13)|0;J=(Z+(Y>>>13)|0)+(it>>>26)|0,it&=67108863,X=Math.imul(He,Ue),Y=Math.imul(He,qe),Y=Y+Math.imul(vt,Ue)|0,Z=Math.imul(vt,qe),X=X+Math.imul(Qe,Ae)|0,Y=Y+Math.imul(Qe,Ne)|0,Y=Y+Math.imul(Be,Ae)|0,Z=Z+Math.imul(Be,Ne)|0,X=X+Math.imul(be,Je)|0,Y=Y+Math.imul(be,_t)|0,Y=Y+Math.imul(Pe,Je)|0,Z=Z+Math.imul(Pe,_t)|0,X=X+Math.imul(ze,Ot)|0,Y=Y+Math.imul(ze,Kt)|0,Y=Y+Math.imul(Oe,Ot)|0,Z=Z+Math.imul(Oe,Kt)|0,X=X+Math.imul(ge,Wt)|0,Y=Y+Math.imul(ge,qt)|0,Y=Y+Math.imul(Te,Wt)|0,Z=Z+Math.imul(Te,qt)|0,X=X+Math.imul(ye,fr)|0,Y=Y+Math.imul(ye,Yr)|0,Y=Y+Math.imul(ue,fr)|0,Z=Z+Math.imul(ue,Yr)|0,X=X+Math.imul(ae,Qr)|0,Y=Y+Math.imul(ae,at)|0,Y=Y+Math.imul(ie,Qr)|0,Z=Z+Math.imul(ie,at)|0,X=X+Math.imul(W,Zt)|0,Y=Y+Math.imul(W,Ut)|0,Y=Y+Math.imul(K,Zt)|0,Z=Z+Math.imul(K,Ut)|0;var ct=(J+X|0)+((Y&8191)<<13)|0;J=(Z+(Y>>>13)|0)+(ct>>>26)|0,ct&=67108863,X=Math.imul(He,Ae),Y=Math.imul(He,Ne),Y=Y+Math.imul(vt,Ae)|0,Z=Math.imul(vt,Ne),X=X+Math.imul(Qe,Je)|0,Y=Y+Math.imul(Qe,_t)|0,Y=Y+Math.imul(Be,Je)|0,Z=Z+Math.imul(Be,_t)|0,X=X+Math.imul(be,Ot)|0,Y=Y+Math.imul(be,Kt)|0,Y=Y+Math.imul(Pe,Ot)|0,Z=Z+Math.imul(Pe,Kt)|0,X=X+Math.imul(ze,Wt)|0,Y=Y+Math.imul(ze,qt)|0,Y=Y+Math.imul(Oe,Wt)|0,Z=Z+Math.imul(Oe,qt)|0,X=X+Math.imul(ge,fr)|0,Y=Y+Math.imul(ge,Yr)|0,Y=Y+Math.imul(Te,fr)|0,Z=Z+Math.imul(Te,Yr)|0,X=X+Math.imul(ye,Qr)|0,Y=Y+Math.imul(ye,at)|0,Y=Y+Math.imul(ue,Qr)|0,Z=Z+Math.imul(ue,at)|0,X=X+Math.imul(ae,Zt)|0,Y=Y+Math.imul(ae,Ut)|0,Y=Y+Math.imul(ie,Zt)|0,Z=Z+Math.imul(ie,Ut)|0;var At=(J+X|0)+((Y&8191)<<13)|0;J=(Z+(Y>>>13)|0)+(At>>>26)|0,At&=67108863,X=Math.imul(He,Je),Y=Math.imul(He,_t),Y=Y+Math.imul(vt,Je)|0,Z=Math.imul(vt,_t),X=X+Math.imul(Qe,Ot)|0,Y=Y+Math.imul(Qe,Kt)|0,Y=Y+Math.imul(Be,Ot)|0,Z=Z+Math.imul(Be,Kt)|0,X=X+Math.imul(be,Wt)|0,Y=Y+Math.imul(be,qt)|0,Y=Y+Math.imul(Pe,Wt)|0,Z=Z+Math.imul(Pe,qt)|0,X=X+Math.imul(ze,fr)|0,Y=Y+Math.imul(ze,Yr)|0,Y=Y+Math.imul(Oe,fr)|0,Z=Z+Math.imul(Oe,Yr)|0,X=X+Math.imul(ge,Qr)|0,Y=Y+Math.imul(ge,at)|0,Y=Y+Math.imul(Te,Qr)|0,Z=Z+Math.imul(Te,at)|0,X=X+Math.imul(ye,Zt)|0,Y=Y+Math.imul(ye,Ut)|0,Y=Y+Math.imul(ue,Zt)|0,Z=Z+Math.imul(ue,Ut)|0;var dt=(J+X|0)+((Y&8191)<<13)|0;J=(Z+(Y>>>13)|0)+(dt>>>26)|0,dt&=67108863,X=Math.imul(He,Ot),Y=Math.imul(He,Kt),Y=Y+Math.imul(vt,Ot)|0,Z=Math.imul(vt,Kt),X=X+Math.imul(Qe,Wt)|0,Y=Y+Math.imul(Qe,qt)|0,Y=Y+Math.imul(Be,Wt)|0,Z=Z+Math.imul(Be,qt)|0,X=X+Math.imul(be,fr)|0,Y=Y+Math.imul(be,Yr)|0,Y=Y+Math.imul(Pe,fr)|0,Z=Z+Math.imul(Pe,Yr)|0,X=X+Math.imul(ze,Qr)|0,Y=Y+Math.imul(ze,at)|0,Y=Y+Math.imul(Oe,Qr)|0,Z=Z+Math.imul(Oe,at)|0,X=X+Math.imul(ge,Zt)|0,Y=Y+Math.imul(ge,Ut)|0,Y=Y+Math.imul(Te,Zt)|0,Z=Z+Math.imul(Te,Ut)|0;var Tt=(J+X|0)+((Y&8191)<<13)|0;J=(Z+(Y>>>13)|0)+(Tt>>>26)|0,Tt&=67108863,X=Math.imul(He,Wt),Y=Math.imul(He,qt),Y=Y+Math.imul(vt,Wt)|0,Z=Math.imul(vt,qt),X=X+Math.imul(Qe,fr)|0,Y=Y+Math.imul(Qe,Yr)|0,Y=Y+Math.imul(Be,fr)|0,Z=Z+Math.imul(Be,Yr)|0,X=X+Math.imul(be,Qr)|0,Y=Y+Math.imul(be,at)|0,Y=Y+Math.imul(Pe,Qr)|0,Z=Z+Math.imul(Pe,at)|0,X=X+Math.imul(ze,Zt)|0,Y=Y+Math.imul(ze,Ut)|0,Y=Y+Math.imul(Oe,Zt)|0,Z=Z+Math.imul(Oe,Ut)|0;var Ht=(J+X|0)+((Y&8191)<<13)|0;J=(Z+(Y>>>13)|0)+(Ht>>>26)|0,Ht&=67108863,X=Math.imul(He,fr),Y=Math.imul(He,Yr),Y=Y+Math.imul(vt,fr)|0,Z=Math.imul(vt,Yr),X=X+Math.imul(Qe,Qr)|0,Y=Y+Math.imul(Qe,at)|0,Y=Y+Math.imul(Be,Qr)|0,Z=Z+Math.imul(Be,at)|0,X=X+Math.imul(be,Zt)|0,Y=Y+Math.imul(be,Ut)|0,Y=Y+Math.imul(Pe,Zt)|0,Z=Z+Math.imul(Pe,Ut)|0;var ir=(J+X|0)+((Y&8191)<<13)|0;J=(Z+(Y>>>13)|0)+(ir>>>26)|0,ir&=67108863,X=Math.imul(He,Qr),Y=Math.imul(He,at),Y=Y+Math.imul(vt,Qr)|0,Z=Math.imul(vt,at),X=X+Math.imul(Qe,Zt)|0,Y=Y+Math.imul(Qe,Ut)|0,Y=Y+Math.imul(Be,Zt)|0,Z=Z+Math.imul(Be,Ut)|0;var kr=(J+X|0)+((Y&8191)<<13)|0;J=(Z+(Y>>>13)|0)+(kr>>>26)|0,kr&=67108863,X=Math.imul(He,Zt),Y=Math.imul(He,Ut),Y=Y+Math.imul(vt,Zt)|0,Z=Math.imul(vt,Ut);var br=(J+X|0)+((Y&8191)<<13)|0;return J=(Z+(Y>>>13)|0)+(br>>>26)|0,br&=67108863,G[0]=_r,G[1]=rt,G[2]=Ke,G[3]=st,G[4]=lt,G[5]=wt,G[6]=Pt,G[7]=ke,G[8]=Se,G[9]=nt,G[10]=it,G[11]=ct,G[12]=At,G[13]=dt,G[14]=Tt,G[15]=Ht,G[16]=ir,G[17]=kr,G[18]=br,J!==0&&(G[19]=J,B.length++),B};Math.imul||(_=u);function s(I,D,R){R.negative=D.negative^I.negative,R.length=I.length+D.length;for(var B=0,F=0,H=0;H<R.length-1;H++){var G=F;F=0;for(var J=B&67108863,X=Math.min(H,D.length-1),Y=Math.max(0,H-I.length+1);Y<=X;Y++){var Z=H-Y,oe=I.words[Z]|0,re=D.words[Y]|0,se=oe*re,N=se&67108863;G=G+(se/67108864|0)|0,N=N+J|0,J=N&67108863,G=G+(N>>>26)|0,F+=G>>>26,G&=67108863}R.words[H]=J,B=G,G=F}return B!==0?R.words[H]=B:R.length--,R.strip()}function A(I,D,R){var B=new b;return B.mulp(I,D,R)}t.prototype.mulTo=function(D,R){var B,F=this.length+D.length;return this.length===10&&D.length===10?B=_(this,D,R):F<63?B=u(this,D,R):F<1024?B=s(this,D,R):B=A(this,D,R),B};function b(I,D){this.x=I,this.y=D}b.prototype.makeRBT=function(D){for(var R=new Array(D),B=t.prototype._countBits(D)-1,F=0;F<D;F++)R[F]=this.revBin(F,B,D);return R},b.prototype.revBin=function(D,R,B){if(D===0||D===B-1)return D;for(var F=0,H=0;H<R;H++)F|=(D&1)<<R-H-1,D>>=1;return F},b.prototype.permute=function(D,R,B,F,H,G){for(var J=0;J<G;J++)F[J]=R[D[J]],H[J]=B[D[J]]},b.prototype.transform=function(D,R,B,F,H,G){this.permute(G,D,R,B,F,H);for(var J=1;J<H;J<<=1)for(var X=J<<1,Y=Math.cos(2*Math.PI/X),Z=Math.sin(2*Math.PI/X),oe=0;oe<H;oe+=X)for(var re=Y,se=Z,N=0;N<J;N++){var U=B[oe+N],q=F[oe+N],$=B[oe+N+J],W=F[oe+N+J],K=re*$-se*W;W=re*W+se*$,$=K,B[oe+N]=U+$,F[oe+N]=q+W,B[oe+N+J]=U-$,F[oe+N+J]=q-W,N!==X&&(K=Y*re-Z*se,se=Y*se+Z*re,re=K)}},b.prototype.guessLen13b=function(D,R){var B=Math.max(R,D)|1,F=B&1,H=0;for(B=B/2|0;B;B=B>>>1)H++;return 1<<H+1+F},b.prototype.conjugate=function(D,R,B){if(!(B<=1))for(var F=0;F<B/2;F++){var H=D[F];D[F]=D[B-F-1],D[B-F-1]=H,H=R[F],R[F]=-R[B-F-1],R[B-F-1]=-H}},b.prototype.normalize13b=function(D,R){for(var B=0,F=0;F<R/2;F++){var H=Math.round(D[2*F+1]/R)*8192+Math.round(D[2*F]/R)+B;D[F]=H&67108863,H<67108864?B=0:B=H/67108864|0}return D},b.prototype.convert13b=function(D,R,B,F){for(var H=0,G=0;G<R;G++)H=H+(D[G]|0),B[2*G]=H&8191,H=H>>>13,B[2*G+1]=H&8191,H=H>>>13;for(G=2*R;G<F;++G)B[G]=0;n(H===0),n((H&-8192)===0)},b.prototype.stub=function(D){for(var R=new Array(D),B=0;B<D;B++)R[B]=0;return R},b.prototype.mulp=function(D,R,B){var F=2*this.guessLen13b(D.length,R.length),H=this.makeRBT(F),G=this.stub(F),J=new Array(F),X=new Array(F),Y=new Array(F),Z=new Array(F),oe=new Array(F),re=new Array(F),se=B.words;se.length=F,this.convert13b(D.words,D.length,J,F),this.convert13b(R.words,R.length,Z,F),this.transform(J,G,X,Y,F,H),this.transform(Z,G,oe,re,F,H);for(var N=0;N<F;N++){var U=X[N]*oe[N]-Y[N]*re[N];Y[N]=X[N]*re[N]+Y[N]*oe[N],X[N]=U}return this.conjugate(X,Y,F),this.transform(X,Y,se,G,F,H),this.conjugate(se,G,F),this.normalize13b(se,F),B.negative=D.negative^R.negative,B.length=D.length+R.length,B.strip()},t.prototype.mul=function(D){var R=new t(null);return R.words=new Array(this.length+D.length),this.mulTo(D,R)},t.prototype.mulf=function(D){var R=new t(null);return R.words=new Array(this.length+D.length),A(this,D,R)},t.prototype.imul=function(D){return this.clone().mulTo(D,this)},t.prototype.imuln=function(D){n(typeof D=="number"),n(D<67108864);for(var R=0,B=0;B<this.length;B++){var F=(this.words[B]|0)*D,H=(F&67108863)+(R&67108863);R>>=26,R+=F/67108864|0,R+=H>>>26,this.words[B]=H&67108863}return R!==0&&(this.words[B]=R,this.length++),this},t.prototype.muln=function(D){return this.clone().imuln(D)},t.prototype.sqr=function(){return this.mul(this)},t.prototype.isqr=function(){return this.imul(this.clone())},t.prototype.pow=function(D){var R=m(D);if(R.length===0)return new t(1);for(var B=this,F=0;F<R.length&&R[F]===0;F++,B=B.sqr());if(++F<R.length)for(var H=B.sqr();F<R.length;F++,H=H.sqr())R[F]!==0&&(B=B.mul(H));return B},t.prototype.iushln=function(D){n(typeof D=="number"&&D>=0);var R=D%26,B=(D-R)/26,F=67108863>>>26-R<<26-R,H;if(R!==0){var G=0;for(H=0;H<this.length;H++){var J=this.words[H]&F,X=(this.words[H]|0)-J<<R;this.words[H]=X|G,G=J>>>26-R}G&&(this.words[H]=G,this.length++)}if(B!==0){for(H=this.length-1;H>=0;H--)this.words[H+B]=this.words[H];for(H=0;H<B;H++)this.words[H]=0;this.length+=B}return this.strip()},t.prototype.ishln=function(D){return n(this.negative===0),this.iushln(D)},t.prototype.iushrn=function(D,R,B){n(typeof D=="number"&&D>=0);var F;R?F=(R-R%26)/26:F=0;var H=D%26,G=Math.min((D-H)/26,this.length),J=67108863^67108863>>>H<<H,X=B;if(F-=G,F=Math.max(0,F),X){for(var Y=0;Y<G;Y++)X.words[Y]=this.words[Y];X.length=G}if(G!==0)if(this.length>G)for(this.length-=G,Y=0;Y<this.length;Y++)this.words[Y]=this.words[Y+G];else this.words[0]=0,this.length=1;var Z=0;for(Y=this.length-1;Y>=0&&(Z!==0||Y>=F);Y--){var oe=this.words[Y]|0;this.words[Y]=Z<<26-H|oe>>>H,Z=oe&J}return X&&Z!==0&&(X.words[X.length++]=Z),this.length===0&&(this.words[0]=0,this.length=1),this.strip()},t.prototype.ishrn=function(D,R,B){return n(this.negative===0),this.iushrn(D,R,B)},t.prototype.shln=function(D){return this.clone().ishln(D)},t.prototype.ushln=function(D){return this.clone().iushln(D)},t.prototype.shrn=function(D){return this.clone().ishrn(D)},t.prototype.ushrn=function(D){return this.clone().iushrn(D)},t.prototype.testn=function(D){n(typeof D=="number"&&D>=0);var R=D%26,B=(D-R)/26,F=1<<R;if(this.length<=B)return!1;var H=this.words[B];return!!(H&F)},t.prototype.imaskn=function(D){n(typeof D=="number"&&D>=0);var R=D%26,B=(D-R)/26;if(n(this.negative===0,"imaskn works only with positive numbers"),this.length<=B)return this;if(R!==0&&B++,this.length=Math.min(B,this.length),R!==0){var F=67108863^67108863>>>R<<R;this.words[this.length-1]&=F}return this.strip()},t.prototype.maskn=function(D){return this.clone().imaskn(D)},t.prototype.iaddn=function(D){return n(typeof D=="number"),n(D<67108864),D<0?this.isubn(-D):this.negative!==0?this.length===1&&(this.words[0]|0)<D?(this.words[0]=D-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(D),this.negative=1,this):this._iaddn(D)},t.prototype._iaddn=function(D){this.words[0]+=D;for(var R=0;R<this.length&&this.words[R]>=67108864;R++)this.words[R]-=67108864,R===this.length-1?this.words[R+1]=1:this.words[R+1]++;return this.length=Math.max(this.length,R+1),this},t.prototype.isubn=function(D){if(n(typeof D=="number"),n(D<67108864),D<0)return this.iaddn(-D);if(this.negative!==0)return this.negative=0,this.iaddn(D),this.negative=1,this;if(this.words[0]-=D,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var R=0;R<this.length&&this.words[R]<0;R++)this.words[R]+=67108864,this.words[R+1]-=1;return this.strip()},t.prototype.addn=function(D){return this.clone().iaddn(D)},t.prototype.subn=function(D){return this.clone().isubn(D)},t.prototype.iabs=function(){return this.negative=0,this},t.prototype.abs=function(){return this.clone().iabs()},t.prototype._ishlnsubmul=function(D,R,B){var F=D.length+B,H;this._expand(F);var G,J=0;for(H=0;H<D.length;H++){G=(this.words[H+B]|0)+J;var X=(D.words[H]|0)*R;G-=X&67108863,J=(G>>26)-(X/67108864|0),this.words[H+B]=G&67108863}for(;H<this.length-B;H++)G=(this.words[H+B]|0)+J,J=G>>26,this.words[H+B]=G&67108863;if(J===0)return this.strip();for(n(J===-1),J=0,H=0;H<this.length;H++)G=-(this.words[H]|0)+J,J=G>>26,this.words[H]=G&67108863;return this.negative=1,this.strip()},t.prototype._wordDiv=function(D,R){var B=this.length-D.length,F=this.clone(),H=D,G=H.words[H.length-1]|0,J=this._countBits(G);B=26-J,B!==0&&(H=H.ushln(B),F.iushln(B),G=H.words[H.length-1]|0);var X=F.length-H.length,Y;if(R!=="mod"){Y=new t(null),Y.length=X+1,Y.words=new Array(Y.length);for(var Z=0;Z<Y.length;Z++)Y.words[Z]=0}var oe=F.clone()._ishlnsubmul(H,1,X);oe.negative===0&&(F=oe,Y&&(Y.words[X]=1));for(var re=X-1;re>=0;re--){var se=(F.words[H.length+re]|0)*67108864+(F.words[H.length+re-1]|0);for(se=Math.min(se/G|0,67108863),F._ishlnsubmul(H,se,re);F.negative!==0;)se--,F.negative=0,F._ishlnsubmul(H,1,re),F.isZero()||(F.negative^=1);Y&&(Y.words[re]=se)}return Y&&Y.strip(),F.strip(),R!=="div"&&B!==0&&F.iushrn(B),{div:Y||null,mod:F}},t.prototype.divmod=function(D,R,B){if(n(!D.isZero()),this.isZero())return{div:new t(0),mod:new t(0)};var F,H,G;return this.negative!==0&&D.negative===0?(G=this.neg().divmod(D,R),R!=="mod"&&(F=G.div.neg()),R!=="div"&&(H=G.mod.neg(),B&&H.negative!==0&&H.iadd(D)),{div:F,mod:H}):this.negative===0&&D.negative!==0?(G=this.divmod(D.neg(),R),R!=="mod"&&(F=G.div.neg()),{div:F,mod:G.mod}):(this.negative&D.negative)!==0?(G=this.neg().divmod(D.neg(),R),R!=="div"&&(H=G.mod.neg(),B&&H.negative!==0&&H.isub(D)),{div:G.div,mod:H}):D.length>this.length||this.cmp(D)<0?{div:new t(0),mod:this}:D.length===1?R==="div"?{div:this.divn(D.words[0]),mod:null}:R==="mod"?{div:null,mod:new t(this.modn(D.words[0]))}:{div:this.divn(D.words[0]),mod:new t(this.modn(D.words[0]))}:this._wordDiv(D,R)},t.prototype.div=function(D){return this.divmod(D,"div",!1).div},t.prototype.mod=function(D){return this.divmod(D,"mod",!1).mod},t.prototype.umod=function(D){return this.divmod(D,"mod",!0).mod},t.prototype.divRound=function(D){var R=this.divmod(D);if(R.mod.isZero())return R.div;var B=R.div.negative!==0?R.mod.isub(D):R.mod,F=D.ushrn(1),H=D.andln(1),G=B.cmp(F);return G<0||H===1&&G===0?R.div:R.div.negative!==0?R.div.isubn(1):R.div.iaddn(1)},t.prototype.modn=function(D){n(D<=67108863);for(var R=(1<<26)%D,B=0,F=this.length-1;F>=0;F--)B=(R*B+(this.words[F]|0))%D;return B},t.prototype.idivn=function(D){n(D<=67108863);for(var R=0,B=this.length-1;B>=0;B--){var F=(this.words[B]|0)+R*67108864;this.words[B]=F/D|0,R=F%D}return this.strip()},t.prototype.divn=function(D){return this.clone().idivn(D)},t.prototype.egcd=function(D){n(D.negative===0),n(!D.isZero());var R=this,B=D.clone();R.negative!==0?R=R.umod(D):R=R.clone();for(var F=new t(1),H=new t(0),G=new t(0),J=new t(1),X=0;R.isEven()&&B.isEven();)R.iushrn(1),B.iushrn(1),++X;for(var Y=B.clone(),Z=R.clone();!R.isZero();){for(var oe=0,re=1;(R.words[0]&re)===0&&oe<26;++oe,re<<=1);if(oe>0)for(R.iushrn(oe);oe-- >0;)(F.isOdd()||H.isOdd())&&(F.iadd(Y),H.isub(Z)),F.iushrn(1),H.iushrn(1);for(var se=0,N=1;(B.words[0]&N)===0&&se<26;++se,N<<=1);if(se>0)for(B.iushrn(se);se-- >0;)(G.isOdd()||J.isOdd())&&(G.iadd(Y),J.isub(Z)),G.iushrn(1),J.iushrn(1);R.cmp(B)>=0?(R.isub(B),F.isub(G),H.isub(J)):(B.isub(R),G.isub(F),J.isub(H))}return{a:G,b:J,gcd:B.iushln(X)}},t.prototype._invmp=function(D){n(D.negative===0),n(!D.isZero());var R=this,B=D.clone();R.negative!==0?R=R.umod(D):R=R.clone();for(var F=new t(1),H=new t(0),G=B.clone();R.cmpn(1)>0&&B.cmpn(1)>0;){for(var J=0,X=1;(R.words[0]&X)===0&&J<26;++J,X<<=1);if(J>0)for(R.iushrn(J);J-- >0;)F.isOdd()&&F.iadd(G),F.iushrn(1);for(var Y=0,Z=1;(B.words[0]&Z)===0&&Y<26;++Y,Z<<=1);if(Y>0)for(B.iushrn(Y);Y-- >0;)H.isOdd()&&H.iadd(G),H.iushrn(1);R.cmp(B)>=0?(R.isub(B),F.isub(H)):(B.isub(R),H.isub(F))}var oe;return R.cmpn(1)===0?oe=F:oe=H,oe.cmpn(0)<0&&oe.iadd(D),oe},t.prototype.gcd=function(D){if(this.isZero())return D.abs();if(D.isZero())return this.abs();var R=this.clone(),B=D.clone();R.negative=0,B.negative=0;for(var F=0;R.isEven()&&B.isEven();F++)R.iushrn(1),B.iushrn(1);do{for(;R.isEven();)R.iushrn(1);for(;B.isEven();)B.iushrn(1);var H=R.cmp(B);if(H<0){var G=R;R=B,B=G}else if(H===0||B.cmpn(1)===0)break;R.isub(B)}while(!0);return B.iushln(F)},t.prototype.invm=function(D){return this.egcd(D).a.umod(D)},t.prototype.isEven=function(){return(this.words[0]&1)===0},t.prototype.isOdd=function(){return(this.words[0]&1)===1},t.prototype.andln=function(D){return this.words[0]&D},t.prototype.bincn=function(D){n(typeof D=="number");var R=D%26,B=(D-R)/26,F=1<<R;if(this.length<=B)return this._expand(B+1),this.words[B]|=F,this;for(var H=F,G=B;H!==0&&G<this.length;G++){var J=this.words[G]|0;J+=H,H=J>>>26,J&=67108863,this.words[G]=J}return H!==0&&(this.words[G]=H,this.length++),this},t.prototype.isZero=function(){return this.length===1&&this.words[0]===0},t.prototype.cmpn=function(D){var R=D<0;if(this.negative!==0&&!R)return-1;if(this.negative===0&&R)return 1;this.strip();var B;if(this.length>1)B=1;else{R&&(D=-D),n(D<=67108863,"Number is too big");var F=this.words[0]|0;B=F===D?0:F<D?-1:1}return this.negative!==0?-B|0:B},t.prototype.cmp=function(D){if(this.negative!==0&&D.negative===0)return-1;if(this.negative===0&&D.negative!==0)return 1;var R=this.ucmp(D);return this.negative!==0?-R|0:R},t.prototype.ucmp=function(D){if(this.length>D.length)return 1;if(this.length<D.length)return-1;for(var R=0,B=this.length-1;B>=0;B--){var F=this.words[B]|0,H=D.words[B]|0;if(F!==H){F<H?R=-1:F>H&&(R=1);break}}return R},t.prototype.gtn=function(D){return this.cmpn(D)===1},t.prototype.gt=function(D){return this.cmp(D)===1},t.prototype.gten=function(D){return this.cmpn(D)>=0},t.prototype.gte=function(D){return this.cmp(D)>=0},t.prototype.ltn=function(D){return this.cmpn(D)===-1},t.prototype.lt=function(D){return this.cmp(D)===-1},t.prototype.lten=function(D){return this.cmpn(D)<=0},t.prototype.lte=function(D){return this.cmp(D)<=0},t.prototype.eqn=function(D){return this.cmpn(D)===0},t.prototype.eq=function(D){return this.cmp(D)===0},t.red=function(D){return new P(D)},t.prototype.toRed=function(D){return n(!this.red,"Already a number in reduction context"),n(this.negative===0,"red works only with positives"),D.convertTo(this)._forceRed(D)},t.prototype.fromRed=function(){return n(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},t.prototype._forceRed=function(D){return this.red=D,this},t.prototype.forceRed=function(D){return n(!this.red,"Already a number in reduction context"),this._forceRed(D)},t.prototype.redAdd=function(D){return n(this.red,"redAdd works only with red numbers"),this.red.add(this,D)},t.prototype.redIAdd=function(D){return n(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,D)},t.prototype.redSub=function(D){return n(this.red,"redSub works only with red numbers"),this.red.sub(this,D)},t.prototype.redISub=function(D){return n(this.red,"redISub works only with red numbers"),this.red.isub(this,D)},t.prototype.redShl=function(D){return n(this.red,"redShl works only with red numbers"),this.red.shl(this,D)},t.prototype.redMul=function(D){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,D),this.red.mul(this,D)},t.prototype.redIMul=function(D){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,D),this.red.imul(this,D)},t.prototype.redSqr=function(){return n(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},t.prototype.redISqr=function(){return n(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},t.prototype.redSqrt=function(){return n(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},t.prototype.redInvm=function(){return n(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},t.prototype.redNeg=function(){return n(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},t.prototype.redPow=function(D){return n(this.red&&!D.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,D)};var f={k256:null,p224:null,p192:null,p25519:null};function x(I,D){this.name=I,this.p=new t(D,16),this.n=this.p.bitLength(),this.k=new t(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}x.prototype._tmp=function(){var D=new t(null);return D.words=new Array(Math.ceil(this.n/13)),D},x.prototype.ireduce=function(D){var R=D,B;do this.split(R,this.tmp),R=this.imulK(R),R=R.iadd(this.tmp),B=R.bitLength();while(B>this.n);var F=B<this.n?-1:R.ucmp(this.p);return F===0?(R.words[0]=0,R.length=1):F>0?R.isub(this.p):R.strip!==void 0?R.strip():R._strip(),R},x.prototype.split=function(D,R){D.iushrn(this.n,0,R)},x.prototype.imulK=function(D){return D.imul(this.k)};function l(){x.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}r(l,x),l.prototype.split=function(D,R){for(var B=4194303,F=Math.min(D.length,9),H=0;H<F;H++)R.words[H]=D.words[H];if(R.length=F,D.length<=9){D.words[0]=0,D.length=1;return}var G=D.words[9];for(R.words[R.length++]=G&B,H=10;H<D.length;H++){var J=D.words[H]|0;D.words[H-10]=(J&B)<<4|G>>>22,G=J}G>>>=22,D.words[H-10]=G,G===0&&D.length>10?D.length-=10:D.length-=9},l.prototype.imulK=function(D){D.words[D.length]=0,D.words[D.length+1]=0,D.length+=2;for(var R=0,B=0;B<D.length;B++){var F=D.words[B]|0;R+=F*977,D.words[B]=R&67108863,R=F*64+(R/67108864|0)}return D.words[D.length-1]===0&&(D.length--,D.words[D.length-1]===0&&D.length--),D};function L(){x.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}r(L,x);function T(){x.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}r(T,x);function k(){x.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}r(k,x),k.prototype.imulK=function(D){for(var R=0,B=0;B<D.length;B++){var F=(D.words[B]|0)*19+R,H=F&67108863;F>>>=26,D.words[B]=H,R=F}return R!==0&&(D.words[D.length++]=R),D},t._prime=function(D){if(f[D])return f[D];var R;if(D==="k256")R=new l;else if(D==="p224")R=new L;else if(D==="p192")R=new T;else if(D==="p25519")R=new k;else throw new Error("Unknown prime "+D);return f[D]=R,R};function P(I){if(typeof I=="string"){var D=t._prime(I);this.m=D.p,this.prime=D}else n(I.gtn(1),"modulus must be greater than 1"),this.m=I,this.prime=null}P.prototype._verify1=function(D){n(D.negative===0,"red works only with positives"),n(D.red,"red works only with red numbers")},P.prototype._verify2=function(D,R){n((D.negative|R.negative)===0,"red works only with positives"),n(D.red&&D.red===R.red,"red works only with red numbers")},P.prototype.imod=function(D){return this.prime?this.prime.ireduce(D)._forceRed(this):D.umod(this.m)._forceRed(this)},P.prototype.neg=function(D){return D.isZero()?D.clone():this.m.sub(D)._forceRed(this)},P.prototype.add=function(D,R){this._verify2(D,R);var B=D.add(R);return B.cmp(this.m)>=0&&B.isub(this.m),B._forceRed(this)},P.prototype.iadd=function(D,R){this._verify2(D,R);var B=D.iadd(R);return B.cmp(this.m)>=0&&B.isub(this.m),B},P.prototype.sub=function(D,R){this._verify2(D,R);var B=D.sub(R);return B.cmpn(0)<0&&B.iadd(this.m),B._forceRed(this)},P.prototype.isub=function(D,R){this._verify2(D,R);var B=D.isub(R);return B.cmpn(0)<0&&B.iadd(this.m),B},P.prototype.shl=function(D,R){return this._verify1(D),this.imod(D.ushln(R))},P.prototype.imul=function(D,R){return this._verify2(D,R),this.imod(D.imul(R))},P.prototype.mul=function(D,R){return this._verify2(D,R),this.imod(D.mul(R))},P.prototype.isqr=function(D){return this.imul(D,D.clone())},P.prototype.sqr=function(D){return this.mul(D,D)},P.prototype.sqrt=function(D){if(D.isZero())return D.clone();var R=this.m.andln(3);if(n(R%2===1),R===3){var B=this.m.add(new t(1)).iushrn(2);return this.pow(D,B)}for(var F=this.m.subn(1),H=0;!F.isZero()&&F.andln(1)===0;)H++,F.iushrn(1);n(!F.isZero());var G=new t(1).toRed(this),J=G.redNeg(),X=this.m.subn(1).iushrn(1),Y=this.m.bitLength();for(Y=new t(2*Y*Y).toRed(this);this.pow(Y,X).cmp(J)!==0;)Y.redIAdd(J);for(var Z=this.pow(Y,F),oe=this.pow(D,F.addn(1).iushrn(1)),re=this.pow(D,F),se=H;re.cmp(G)!==0;){for(var N=re,U=0;N.cmp(G)!==0;U++)N=N.redSqr();n(U<se);var q=this.pow(Z,new t(1).iushln(se-U-1));oe=oe.redMul(q),Z=q.redSqr(),re=re.redMul(Z),se=U}return oe},P.prototype.invm=function(D){var R=D._invmp(this.m);return R.negative!==0?(R.negative=0,this.imod(R).redNeg()):this.imod(R)},P.prototype.pow=function(D,R){if(R.isZero())return new t(1).toRed(this);if(R.cmpn(1)===0)return D.clone();var B=4,F=new Array(1<<B);F[0]=new t(1).toRed(this),F[1]=D;for(var H=2;H<F.length;H++)F[H]=this.mul(F[H-1],D);var G=F[0],J=0,X=0,Y=R.bitLength()%26;for(Y===0&&(Y=26),H=R.length-1;H>=0;H--){for(var Z=R.words[H],oe=Y-1;oe>=0;oe--){var re=Z>>oe&1;if(G!==F[0]&&(G=this.sqr(G)),re===0&&J===0){X=0;continue}J<<=1,J|=re,X++,!(X!==B&&(H!==0||oe!==0))&&(G=this.mul(G,F[J]),X=0,J=0)}Y=26}return G},P.prototype.convertTo=function(D){var R=D.umod(this.m);return R===D?R.clone():R},P.prototype.convertFrom=function(D){var R=D.clone();return R.red=null,R},t.mont=function(D){return new z(D)};function z(I){P.call(this,I),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new t(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}r(z,P),z.prototype.convertTo=function(D){return this.imod(D.ushln(this.shift))},z.prototype.convertFrom=function(D){var R=this.imod(D.mul(this.rinv));return R.red=null,R},z.prototype.imul=function(D,R){if(D.isZero()||R.isZero())return D.words[0]=0,D.length=1,D;var B=D.imul(R),F=B.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),H=B.isub(F).iushrn(this.shift),G=H;return H.cmp(this.m)>=0?G=H.isub(this.m):H.cmpn(0)<0&&(G=H.iadd(this.m)),G._forceRed(this)},z.prototype.mul=function(D,R){if(D.isZero()||R.isZero())return new t(0)._forceRed(this);var B=D.mul(R),F=B.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),H=B.isub(F).iushrn(this.shift),G=H;return H.cmp(this.m)>=0?G=H.isub(this.m):H.cmpn(0)<0&&(G=H.iadd(this.m)),G._forceRed(this)},z.prototype.invm=function(D){var R=this.imod(D._invmp(this.m).mul(this.r2));return R._forceRed(this)}})(typeof S>"u"||S,this)},{buffer:2}],34:[function(v,S,M){S.exports=e;function e(a){var n,r,t,c=a.length,o=0;for(n=0;n<c;++n)o+=a[n].length;var i=new Array(o),y=0;for(n=0;n<c;++n){var p=a[n],g=p.length;for(r=0;r<g;++r){var h=i[y++]=new Array(g-1),m=0;for(t=0;t<g;++t)t!==r&&(h[m++]=p[t]);if(r&1){var u=h[1];h[1]=h[0],h[0]=u}}}return i}},{}],35:[function(v,S,M){S.exports=g;var e=v("typedarray-pool"),a=v("./lib/sweep"),n=v("./lib/intersect");function r(h,m){for(var u=0;u<h;++u)if(!(m[u]<=m[u+h]))return!0;return!1}function t(h,m,u,_){for(var s=0,A=0,b=0,f=h.length;b<f;++b){var x=h[b];if(!r(m,x)){for(var l=0;l<2*m;++l)u[s++]=x[l];_[A++]=b}}return A}function c(h,m,u,_){var s=h.length,A=m.length;if(!(s<=0||A<=0)){var b=h[0].length>>>1;if(!(b<=0)){var f,x=e.mallocDouble(2*b*s),l=e.mallocInt32(s);if(s=t(h,b,x,l),s>0){if(b===1&&_)a.init(s),f=a.sweepComplete(b,u,0,s,x,l,0,s,x,l);else{var L=e.mallocDouble(2*b*A),T=e.mallocInt32(A);A=t(m,b,L,T),A>0&&(a.init(s+A),b===1?f=a.sweepBipartite(b,u,0,s,x,l,0,A,L,T):f=n(b,u,_,s,x,l,A,L,T),e.free(L),e.free(T))}e.free(x),e.free(l)}return f}}}var o;function i(h,m){o.push([h,m])}function y(h){return o=[],c(h,h,i,!0),o}function p(h,m){return o=[],c(h,m,i,!1),o}function g(h,m,u){switch(arguments.length){case 1:return y(h);case 2:return typeof m=="function"?c(h,h,m,!0):p(h,m);case 3:return c(h,m,u,!1);default:throw new Error("box-intersect: Invalid arguments")}}},{"./lib/intersect":37,"./lib/sweep":41,"typedarray-pool":308}],36:[function(v,S,M){function e(){function r(o,i,y,p,g,h,m,u,_,s,A){for(var b=2*o,f=p,x=b*p;f<g;++f,x+=b){var l=h[i+x],L=h[i+x+o],T=m[f];e:for(var k=u,P=b*u;k<_;++k,P+=b){var z=s[i+P],I=s[i+P+o],D=A[k];if(!(I<l||L<z)){for(var R=i+1;R<o;++R){var B=h[R+x],F=h[R+o+x],H=s[R+P],G=s[R+o+P];if(F<H||G<B)continue e}var J=y(T,D);if(J!==void 0)return J}}}}function t(o,i,y,p,g,h,m,u,_,s,A){for(var b=2*o,f=u,x=b*u;f<_;++f,x+=b){var l=s[i+x],L=s[i+x+o],T=A[f];e:for(var k=p,P=b*p;k<g;++k,P+=b){var z=h[i+P],I=h[i+P+o],D=m[k];if(!(L<z||I<l)){for(var R=i+1;R<o;++R){var B=h[R+P],F=h[R+o+P],H=s[R+x],G=s[R+o+x];if(F<H||G<B)continue e}var J=y(D,T);if(J!==void 0)return J}}}}function c(o,i,y,p,g,h,m,u,_,s,A){return g-p>_-u?r(o,i,y,p,g,h,m,u,_,s,A):t(o,i,y,p,g,h,m,u,_,s,A)}return c}function a(){function r(y,p,g,h,m,u,_,s,A,b,f){for(var x=2*y,l=h,L=x*h;l<m;++l,L+=x){var T=u[p+L],k=u[p+L+y],P=_[l];e:for(var z=s,I=x*s;z<A;++z,I+=x){var D=b[p+I],R=f[z];if(!(D<=T||k<D)){for(var B=p+1;B<y;++B){var F=u[B+L],H=u[B+y+L],G=b[B+I],J=b[B+y+I];if(H<G||J<F)continue e}var X=g(R,P);if(X!==void 0)return X}}}}function t(y,p,g,h,m,u,_,s,A,b,f){for(var x=2*y,l=h,L=x*h;l<m;++l,L+=x){var T=u[p+L],k=u[p+L+y],P=_[l];e:for(var z=s,I=x*s;z<A;++z,I+=x){var D=b[p+I],R=f[z];if(!(D<T||k<D)){for(var B=p+1;B<y;++B){var F=u[B+L],H=u[B+y+L],G=b[B+I],J=b[B+y+I];if(H<G||J<F)continue e}var X=g(P,R);if(X!==void 0)return X}}}}function c(y,p,g,h,m,u,_,s,A,b,f){for(var x=2*y,l=s,L=x*s;l<A;++l,L+=x){var T=b[p+L],k=f[l];e:for(var P=h,z=x*h;P<m;++P,z+=x){var I=u[p+z],D=u[p+z+y],R=_[P];if(!(T<=I||D<T)){for(var B=p+1;B<y;++B){var F=u[B+z],H=u[B+y+z],G=b[B+L],J=b[B+y+L];if(H<G||J<F)continue e}var X=g(k,R);if(X!==void 0)return X}}}}function o(y,p,g,h,m,u,_,s,A,b,f){for(var x=2*y,l=s,L=x*s;l<A;++l,L+=x){var T=b[p+L],k=f[l];e:for(var P=h,z=x*h;P<m;++P,z+=x){var I=u[p+z],D=u[p+z+y],R=_[P];if(!(T<I||D<T)){for(var B=p+1;B<y;++B){var F=u[B+z],H=u[B+y+z],G=b[B+L],J=b[B+y+L];if(H<G||J<F)continue e}var X=g(R,k);if(X!==void 0)return X}}}}function i(y,p,g,h,m,u,_,s,A,b,f,x){return u-m>b-A?h?r(y,p,g,m,u,_,s,A,b,f,x):t(y,p,g,m,u,_,s,A,b,f,x):h?c(y,p,g,m,u,_,s,A,b,f,x):o(y,p,g,m,u,_,s,A,b,f,x)}return i}function n(r){return r?e():a()}M.partial=n(!1),M.full=n(!0)},{}],37:[function(v,S,M){S.exports=I;var e=v("typedarray-pool"),a=v("bit-twiddle"),n=v("./brute"),r=n.partial,t=n.full,c=v("./sweep"),o=v("./median"),i=v("./partition"),y=128,p=1<<22,g=1<<22,h=i("!(lo>=p0)&&!(p1>=hi)"),m=i("lo===p0"),u=i("lo<p0"),_=i("hi<=p0"),s=i("lo<=p0&&p0<=hi"),A=i("lo<p0&&p0<=hi"),b=6,f=2,x=1024,l=e.mallocInt32(x),L=e.mallocDouble(x);function T(D,R){var B=8*a.log2(R+1)*(D+1)|0,F=a.nextPow2(b*B);l.length<F&&(e.free(l),l=e.mallocInt32(F));var H=a.nextPow2(f*B);L.length<H&&(e.free(L),L=e.mallocDouble(H))}function k(D,R,B,F,H,G,J,X,Y){var Z=b*D;l[Z]=R,l[Z+1]=B,l[Z+2]=F,l[Z+3]=H,l[Z+4]=G,l[Z+5]=J;var oe=f*D;L[oe]=X,L[oe+1]=Y}function P(D,R,B,F,H,G,J,X,Y,Z,oe){var re=2*D,se=Y*re,N=Z[se+R];e:for(var U=H,q=H*re;U<G;++U,q+=re){var $=J[q+R],W=J[q+R+D];if(!(N<$||W<N)&&!(F&&N===$)){for(var K=X[U],ne=R+1;ne<D;++ne){var $=J[q+ne],W=J[q+ne+D],ae=Z[se+ne],ie=Z[se+ne+D];if(W<ae||ie<$)continue e}var le;if(F?le=B(oe,K):le=B(K,oe),le!==void 0)return le}}}function z(D,R,B,F,H,G,J,X,Y,Z){var oe=2*D,re=X*oe,se=Y[re+R];e:for(var N=F,U=F*oe;N<H;++N,U+=oe){var q=J[N];if(q!==Z){var $=G[U+R],W=G[U+R+D];if(!(se<$||W<se)){for(var K=R+1;K<D;++K){var $=G[U+K],W=G[U+K+D],ne=Y[re+K],ae=Y[re+K+D];if(W<ne||ae<$)continue e}var ie=B(q,Z);if(ie!==void 0)return ie}}}}function I(D,R,B,F,H,G,J,X,Y){T(D,F+J);var Z=0,oe=2*D,re;for(k(Z++,0,0,F,0,J,B?16:0,-1/0,1/0),B||k(Z++,0,0,J,0,F,1,-1/0,1/0);Z>0;){Z-=1;var se=Z*b,N=l[se],U=l[se+1],q=l[se+2],$=l[se+3],W=l[se+4],K=l[se+5],ne=Z*f,ae=L[ne],ie=L[ne+1],le=K&1,ye=!!(K&16),ue=H,pe=G,ge=X,Te=Y;if(le&&(ue=X,pe=Y,ge=H,Te=G),!(K&2&&(q=u(D,N,U,q,ue,pe,ie),U>=q))&&!(K&4&&(U=_(D,N,U,q,ue,pe,ae),U>=q))){var _e=q-U,ze=W-$;if(ye){if(D*_e*(_e+ze)<g){if(re=c.scanComplete(D,N,R,U,q,ue,pe,$,W,ge,Te),re!==void 0)return re;continue}}else if(D*Math.min(_e,ze)<y){if(re=r(D,N,R,le,U,q,ue,pe,$,W,ge,Te),re!==void 0)return re;continue}else if(D*_e*ze<p){if(re=c.scanBipartite(D,N,R,le,U,q,ue,pe,$,W,ge,Te),re!==void 0)return re;continue}var Oe=h(D,N,U,q,ue,pe,ae,ie);if(U<Oe)if(D*(Oe-U)<y){if(re=t(D,N+1,R,U,Oe,ue,pe,$,W,ge,Te),re!==void 0)return re}else if(N===D-2){if(le?re=c.sweepBipartite(D,R,$,W,ge,Te,U,Oe,ue,pe):re=c.sweepBipartite(D,R,U,Oe,ue,pe,$,W,ge,Te),re!==void 0)return re}else k(Z++,N+1,U,Oe,$,W,le,-1/0,1/0),k(Z++,N+1,$,W,U,Oe,le^1,-1/0,1/0);if(Oe<q){var Ye=o(D,N,$,W,ge,Te),be=ge[oe*Ye+N],Pe=m(D,N,Ye,W,ge,Te,be);if(Pe<W&&k(Z++,N,Oe,q,Pe,W,(le|4)+(ye?16:0),be,ie),$<Ye&&k(Z++,N,Oe,q,$,Ye,(le|2)+(ye?16:0),ae,be),Ye+1===Pe){if(ye?re=z(D,N,R,Oe,q,ue,pe,Ye,ge,Te[Ye]):re=P(D,N,R,le,Oe,q,ue,pe,Ye,ge,Te[Ye]),re!==void 0)return re}else if(Ye<Pe){var Ge;if(ye){if(Ge=s(D,N,Oe,q,ue,pe,be),Oe<Ge){var Qe=m(D,N,Oe,Ge,ue,pe,be);if(N===D-2){if(Oe<Qe&&(re=c.sweepComplete(D,R,Oe,Qe,ue,pe,Ye,Pe,ge,Te),re!==void 0)||Qe<Ge&&(re=c.sweepBipartite(D,R,Qe,Ge,ue,pe,Ye,Pe,ge,Te),re!==void 0))return re}else Oe<Qe&&k(Z++,N+1,Oe,Qe,Ye,Pe,16,-1/0,1/0),Qe<Ge&&(k(Z++,N+1,Qe,Ge,Ye,Pe,0,-1/0,1/0),k(Z++,N+1,Ye,Pe,Qe,Ge,1,-1/0,1/0))}}else le?Ge=A(D,N,Oe,q,ue,pe,be):Ge=s(D,N,Oe,q,ue,pe,be),Oe<Ge&&(N===D-2?le?re=c.sweepBipartite(D,R,Ye,Pe,ge,Te,Oe,Ge,ue,pe):re=c.sweepBipartite(D,R,Oe,Ge,ue,pe,Ye,Pe,ge,Te):(k(Z++,N+1,Oe,Ge,Ye,Pe,le,-1/0,1/0),k(Z++,N+1,Ye,Pe,Oe,Ge,le^1,-1/0,1/0)))}}}}}},{"./brute":36,"./median":38,"./partition":39,"./sweep":41,"bit-twiddle":32,"typedarray-pool":308}],38:[function(v,S,M){S.exports=t;var e=v("./partition"),a=e("lo<p0"),n=8;function r(c,o,i,y,p,g){for(var h=2*c,m=h*(i+1)+o,u=i+1;u<y;++u,m+=h)for(var _=p[m],s=u,A=h*(u-1);s>i&&p[A+o]>_;--s,A-=h){for(var b=A,f=A+h,x=0;x<h;++x,++b,++f){var l=p[b];p[b]=p[f],p[f]=l}var L=g[s];g[s]=g[s-1],g[s-1]=L}}function t(c,o,i,y,p,g){if(y<=i+1)return i;for(var h=i,m=y,u=y+i>>>1,_=2*c,s=u,A=p[_*u+o];h<m;){if(m-h<n){r(c,o,h,m,p,g),A=p[_*u+o];break}var b=m-h,f=Math.random()*b+h|0,x=p[_*f+o],l=Math.random()*b+h|0,L=p[_*l+o],T=Math.random()*b+h|0,k=p[_*T+o];x<=L?k>=L?(s=l,A=L):x>=k?(s=f,A=x):(s=T,A=k):L>=k?(s=l,A=L):k>=x?(s=f,A=x):(s=T,A=k);for(var I=_*(m-1),D=_*s,P=0;P<_;++P,++I,++D){var z=p[I];p[I]=p[D],p[D]=z}var R=g[m-1];g[m-1]=g[s],g[s]=R,s=a(c,o,h,m-1,p,g,A);for(var I=_*(m-1),D=_*s,P=0;P<_;++P,++I,++D){var z=p[I];p[I]=p[D],p[D]=z}var R=g[m-1];if(g[m-1]=g[s],g[s]=R,u<s){for(m=s-1;h<m&&p[_*(m-1)+o]===A;)m-=1;m+=1}else if(s<u)for(h=s+1;h<m&&p[_*h+o]===A;)h+=1;else break}return a(c,o,i,u,p,g,p[_*u+o])}},{"./partition":39}],39:[function(v,S,M){S.exports=a;var e={"lo===p0":n,"lo<p0":r,"lo<=p0":t,"hi<=p0":c,"lo<p0&&p0<=hi":i,"lo<=p0&&p0<=hi":o,"!(lo>=p0)&&!(p1>=hi)":y};function a(p){return e[p]}function n(p,g,h,m,u,_,s){for(var A=2*p,b=A*h,f=b,x=h,l=g,L=p+g,T=h;m>T;++T,b+=A){var k=u[b+l];if(k===s)if(x===T)x+=1,f+=A;else{for(var P=0;A>P;++P){var z=u[b+P];u[b+P]=u[f],u[f++]=z}var I=_[T];_[T]=_[x],_[x++]=I}}return x}function r(p,g,h,m,u,_,s){for(var A=2*p,b=A*h,f=b,x=h,l=g,L=p+g,T=h;m>T;++T,b+=A){var k=u[b+l];if(k<s)if(x===T)x+=1,f+=A;else{for(var P=0;A>P;++P){var z=u[b+P];u[b+P]=u[f],u[f++]=z}var I=_[T];_[T]=_[x],_[x++]=I}}return x}function t(p,g,h,m,u,_,s){for(var A=2*p,b=A*h,f=b,x=h,l=g,L=p+g,T=h;m>T;++T,b+=A){var k=u[b+L];if(k<=s)if(x===T)x+=1,f+=A;else{for(var P=0;A>P;++P){var z=u[b+P];u[b+P]=u[f],u[f++]=z}var I=_[T];_[T]=_[x],_[x++]=I}}return x}function c(p,g,h,m,u,_,s){for(var A=2*p,b=A*h,f=b,x=h,l=g,L=p+g,T=h;m>T;++T,b+=A){var k=u[b+L];if(k<=s)if(x===T)x+=1,f+=A;else{for(var P=0;A>P;++P){var z=u[b+P];u[b+P]=u[f],u[f++]=z}var I=_[T];_[T]=_[x],_[x++]=I}}return x}function o(p,g,h,m,u,_,s){for(var A=2*p,b=A*h,f=b,x=h,l=g,L=p+g,T=h;m>T;++T,b+=A){var k=u[b+l],P=u[b+L];if(k<=s&&s<=P)if(x===T)x+=1,f+=A;else{for(var z=0;A>z;++z){var I=u[b+z];u[b+z]=u[f],u[f++]=I}var D=_[T];_[T]=_[x],_[x++]=D}}return x}function i(p,g,h,m,u,_,s){for(var A=2*p,b=A*h,f=b,x=h,l=g,L=p+g,T=h;m>T;++T,b+=A){var k=u[b+l],P=u[b+L];if(k<s&&s<=P)if(x===T)x+=1,f+=A;else{for(var z=0;A>z;++z){var I=u[b+z];u[b+z]=u[f],u[f++]=I}var D=_[T];_[T]=_[x],_[x++]=D}}return x}function y(p,g,h,m,u,_,s,A){for(var b=2*p,f=b*h,x=f,l=h,L=g,T=p+g,k=h;m>k;++k,f+=b){var P=u[f+L],z=u[f+T];if(!(P>=s)&&!(A>=z))if(l===k)l+=1,x+=b;else{for(var I=0;b>I;++I){var D=u[f+I];u[f+I]=u[x],u[x++]=D}var R=_[k];_[k]=_[l],_[l++]=R}}return l}},{}],40:[function(v,S,M){S.exports=a;var e=32;function a(g,h){h<=4*e?n(0,h-1,g):p(0,h-1,g)}function n(g,h,m){for(var u=2*(g+1),_=g+1;_<=h;++_){for(var s=m[u++],A=m[u++],b=_,f=u-2;b-- >g;){var x=m[f-2],l=m[f-1];if(x<s)break;if(x===s&&l<A)break;m[f]=x,m[f+1]=l,f-=2}m[f]=s,m[f+1]=A}}function r(g,h,m){g*=2,h*=2;var u=m[g],_=m[g+1];m[g]=m[h],m[g+1]=m[h+1],m[h]=u,m[h+1]=_}function t(g,h,m){g*=2,h*=2,m[g]=m[h],m[g+1]=m[h+1]}function c(g,h,m,u){g*=2,h*=2,m*=2;var _=u[g],s=u[g+1];u[g]=u[h],u[g+1]=u[h+1],u[h]=u[m],u[h+1]=u[m+1],u[m]=_,u[m+1]=s}function o(g,h,m,u,_){g*=2,h*=2,_[g]=_[h],_[h]=m,_[g+1]=_[h+1],_[h+1]=u}function i(g,h,m){g*=2,h*=2;var u=m[g],_=m[h];return u<_?!1:u===_?m[g+1]>m[h+1]:!0}function y(g,h,m,u){g*=2;var _=u[g];return _<h?!0:_===h?u[g+1]<m:!1}function p(g,h,m){var u=(h-g+1)/6|0,_=g+u,s=h-u,A=g+h>>1,b=A-u,f=A+u,x=_,l=b,L=A,T=f,k=s,P=g+1,z=h-1,I=0;i(x,l,m)&&(I=x,x=l,l=I),i(T,k,m)&&(I=T,T=k,k=I),i(x,L,m)&&(I=x,x=L,L=I),i(l,L,m)&&(I=l,l=L,L=I),i(x,T,m)&&(I=x,x=T,T=I),i(L,T,m)&&(I=L,L=T,T=I),i(l,k,m)&&(I=l,l=k,k=I),i(l,L,m)&&(I=l,l=L,L=I),i(T,k,m)&&(I=T,T=k,k=I);for(var D=m[2*l],R=m[2*l+1],B=m[2*T],F=m[2*T+1],H=2*x,G=2*L,J=2*k,X=2*_,Y=2*A,Z=2*s,oe=0;oe<2;++oe){var re=m[H+oe],se=m[G+oe],N=m[J+oe];m[X+oe]=re,m[Y+oe]=se,m[Z+oe]=N}t(b,g,m),t(f,h,m);for(var U=P;U<=z;++U)if(y(U,D,R,m))U!==P&&r(U,P,m),++P;else if(!y(U,B,F,m))for(;;)if(y(z,B,F,m)){y(z,D,R,m)?(c(U,P,z,m),++P,--z):(r(U,z,m),--z);break}else{if(--z<U)break;continue}o(g,P-1,D,R,m),o(h,z+1,B,F,m),P-2-g<=e?n(g,P-2,m):p(g,P-2,m),h-(z+2)<=e?n(z+2,h,m):p(z+2,h,m),z-P<=e?n(P,z,m):p(P,z,m)}},{}],41:[function(v,S,M){S.exports={init:m,sweepBipartite:s,sweepComplete:A,scanBipartite:b,scanComplete:f};var e=v("typedarray-pool"),a=v("bit-twiddle"),n=v("./sort"),r=1<<28,t=1024,c=e.mallocInt32(t),o=e.mallocInt32(t),i=e.mallocInt32(t),y=e.mallocInt32(t),p=e.mallocInt32(t),g=e.mallocInt32(t),h=e.mallocDouble(t*8);function m(x){var l=a.nextPow2(x);c.length<l&&(e.free(c),c=e.mallocInt32(l)),o.length<l&&(e.free(o),o=e.mallocInt32(l)),i.length<l&&(e.free(i),i=e.mallocInt32(l)),y.length<l&&(e.free(y),y=e.mallocInt32(l)),p.length<l&&(e.free(p),p=e.mallocInt32(l)),g.length<l&&(e.free(g),g=e.mallocInt32(l));var L=8*l;h.length<L&&(e.free(h),h=e.mallocDouble(L))}function u(x,l,L,T){var k=l[T],P=x[L-1];x[k]=P,l[P]=k}function _(x,l,L,T){x[L]=T,l[T]=L}function s(x,l,L,T,k,P,z,I,D,R){for(var B=0,F=2*x,H=x-1,G=F-1,J=L;J<T;++J){var X=P[J],Y=F*J;h[B++]=k[Y+H],h[B++]=-(X+1),h[B++]=k[Y+G],h[B++]=X}for(var J=z;J<I;++J){var X=R[J]+r,Z=F*J;h[B++]=D[Z+H],h[B++]=-X,h[B++]=D[Z+G],h[B++]=X}var oe=B>>>1;n(h,oe);for(var re=0,se=0,J=0;J<oe;++J){var N=h[2*J+1]|0;if(N>=r)N=N-r|0,u(i,y,se--,N);else if(N>=0)u(c,o,re--,N);else if(N<=-r){N=-N-r|0;for(var U=0;U<re;++U){var q=l(c[U],N);if(q!==void 0)return q}_(i,y,se++,N)}else{N=-N-1|0;for(var U=0;U<se;++U){var q=l(N,i[U]);if(q!==void 0)return q}_(c,o,re++,N)}}}function A(x,l,L,T,k,P,z,I,D,R){for(var B=0,F=2*x,H=x-1,G=F-1,J=L;J<T;++J){var X=P[J]+1<<1,Y=F*J;h[B++]=k[Y+H],h[B++]=-X,h[B++]=k[Y+G],h[B++]=X}for(var J=z;J<I;++J){var X=R[J]+1<<1,Z=F*J;h[B++]=D[Z+H],h[B++]=-X|1,h[B++]=D[Z+G],h[B++]=X|1}var oe=B>>>1;n(h,oe);for(var re=0,se=0,N=0,J=0;J<oe;++J){var U=h[2*J+1]|0,q=U&1;if(J<oe-1&&U>>1===h[2*J+3]>>1&&(q=2,J+=1),U<0){for(var $=-(U>>1)-1,W=0;W<N;++W){var K=l(p[W],$);if(K!==void 0)return K}if(q!==0)for(var W=0;W<re;++W){var K=l(c[W],$);if(K!==void 0)return K}if(q!==1)for(var W=0;W<se;++W){var K=l(i[W],$);if(K!==void 0)return K}q===0?_(c,o,re++,$):q===1?_(i,y,se++,$):q===2&&_(p,g,N++,$)}else{var $=(U>>1)-1;q===0?u(c,o,re--,$):q===1?u(i,y,se--,$):q===2&&u(p,g,N--,$)}}}function b(x,l,L,T,k,P,z,I,D,R,B,F){var H=0,G=2*x,J=l,X=l+x,Y=1,Z=1;T?Z=r:Y=r;for(var oe=k;oe<P;++oe){var re=oe+Y,se=G*oe;h[H++]=z[se+J],h[H++]=-re,h[H++]=z[se+X],h[H++]=re}for(var oe=D;oe<R;++oe){var re=oe+Z,N=G*oe;h[H++]=B[N+J],h[H++]=-re}var U=H>>>1;n(h,U);for(var q=0,oe=0;oe<U;++oe){var $=h[2*oe+1]|0;if($<0){var re=-$,W=!1;if(re>=r?(W=!T,re-=r):(W=!!T,re-=1),W)_(c,o,q++,re);else{var K=F[re],ne=G*re,ae=B[ne+l+1],ie=B[ne+l+1+x];e:for(var le=0;le<q;++le){var ye=c[le],ue=G*ye;if(!(ie<z[ue+l+1]||z[ue+l+1+x]<ae)){for(var pe=l+2;pe<x;++pe)if(B[ne+pe+x]<z[ue+pe]||z[ue+pe+x]<B[ne+pe])continue e;var ge=I[ye],Te;if(T?Te=L(K,ge):Te=L(ge,K),Te!==void 0)return Te}}}}else u(c,o,q--,$-Y)}}function f(x,l,L,T,k,P,z,I,D,R,B){for(var F=0,H=2*x,G=l,J=l+x,X=T;X<k;++X){var Y=X+r,Z=H*X;h[F++]=P[Z+G],h[F++]=-Y,h[F++]=P[Z+J],h[F++]=Y}for(var X=I;X<D;++X){var Y=X+1,oe=H*X;h[F++]=R[oe+G],h[F++]=-Y}var re=F>>>1;n(h,re);for(var se=0,X=0;X<re;++X){var N=h[2*X+1]|0;if(N<0){var Y=-N;if(Y>=r)c[se++]=Y-r;else{Y-=1;var U=B[Y],q=H*Y,$=R[q+l+1],W=R[q+l+1+x];e:for(var K=0;K<se;++K){var ne=c[K],ae=z[ne];if(ae===U)break;var ie=H*ne;if(!(W<P[ie+l+1]||P[ie+l+1+x]<$)){for(var le=l+2;le<x;++le)if(R[q+le+x]<P[ie+le]||P[ie+le+x]<R[q+le])continue e;var ye=L(ae,U);if(ye!==void 0)return ye}}}}else{for(var Y=N-r,K=se-1;K>=0;--K)if(c[K]===Y){for(var le=K+1;le<se;++le)c[le-1]=c[le];break}--se}}}},{"./sort":40,"bit-twiddle":32,"typedarray-pool":308}],42:[function(v,S,M){var e=v("./lib/monotone"),a=v("./lib/triangulation"),n=v("./lib/delaunay"),r=v("./lib/filter");S.exports=y;function t(p){return[Math.min(p[0],p[1]),Math.max(p[0],p[1])]}function c(p,g){return p[0]-g[0]||p[1]-g[1]}function o(p){return p.map(t).sort(c)}function i(p,g,h){return g in p?p[g]:h}function y(p,g,h){Array.isArray(g)?(h=h||{},g=g||[]):(h=g||{},g=[]);var m=!!i(h,"delaunay",!0),u=!!i(h,"interior",!0),_=!!i(h,"exterior",!0),s=!!i(h,"infinity",!1);if(!u&&!_||p.length===0)return[];var A=e(p,g);if(m||u!==_||s){for(var b=a(p.length,o(g)),f=0;f<A.length;++f){var x=A[f];b.addTriangle(x[0],x[1],x[2])}return m&&n(p,b),_?u?s?r(b,0,s):b.cells():r(b,1,s):r(b,-1)}else return A}},{"./lib/delaunay":43,"./lib/filter":44,"./lib/monotone":45,"./lib/triangulation":46}],43:[function(v,S,M){var e=v("robust-in-sphere")[4];v("binary-search-bounds"),S.exports=n;function a(r,t,c,o,i,y){var p=t.opposite(o,i);if(!(p<0)){if(i<o){var g=o;o=i,i=g,g=y,y=p,p=g}t.isConstraint(o,i)||e(r[o],r[i],r[y],r[p])<0&&c.push(o,i)}}function n(r,t){for(var c=[],o=r.length,i=t.stars,y=0;y<o;++y)for(var p=i[y],g=1;g<p.length;g+=2){var h=p[g];if(!(h<y)&&!t.isConstraint(y,h)){for(var m=p[g-1],u=-1,_=1;_<p.length;_+=2)if(p[_-1]===h){u=p[_];break}u<0||e(r[y],r[h],r[m],r[u])<0&&c.push(y,h)}}for(;c.length>0;){for(var h=c.pop(),y=c.pop(),m=-1,u=-1,p=i[y],s=1;s<p.length;s+=2){var A=p[s-1],b=p[s];A===h?u=b:b===h&&(m=A)}m<0||u<0||e(r[y],r[h],r[m],r[u])>=0||(t.flip(y,h),a(r,t,c,m,y,u),a(r,t,c,y,u,m),a(r,t,c,u,h,m),a(r,t,c,h,m,u))}}},{"binary-search-bounds":31,"robust-in-sphere":282}],44:[function(v,S,M){var e=v("binary-search-bounds");S.exports=o;function a(i,y,p,g,h,m,u){this.cells=i,this.neighbor=y,this.flags=g,this.constraint=p,this.active=h,this.next=m,this.boundary=u}var n=a.prototype;function r(i,y){return i[0]-y[0]||i[1]-y[1]||i[2]-y[2]}n.locate=function(){var i=[0,0,0];return function(y,p,g){var h=y,m=p,u=g;return p<g?p<y&&(h=p,m=g,u=y):g<y&&(h=g,m=y,u=p),h<0?-1:(i[0]=h,i[1]=m,i[2]=u,e.eq(this.cells,i,r))}}();function t(i,y){for(var p=i.cells(),g=p.length,h=0;h<g;++h){var m=p[h],u=m[0],_=m[1],s=m[2];_<s?_<u&&(m[0]=_,m[1]=s,m[2]=u):s<u&&(m[0]=s,m[1]=u,m[2]=_)}p.sort(r);for(var A=new Array(g),h=0;h<A.length;++h)A[h]=0;var b=[],f=[],x=new Array(3*g),l=new Array(3*g),L=null;y&&(L=[]);for(var T=new a(p,x,l,A,b,f,L),h=0;h<g;++h)for(var m=p[h],k=0;k<3;++k){var u=m[k],_=m[(k+1)%3],P=x[3*h+k]=T.locate(_,u,i.opposite(_,u)),z=l[3*h+k]=i.isConstraint(u,_);P<0&&(z?f.push(h):(b.push(h),A[h]=1),y&&L.push([_,u,-1]))}return T}function c(i,y,p){for(var g=0,h=0;h<i.length;++h)y[h]===p&&(i[g++]=i[h]);return i.length=g,i}function o(i,y,p){var g=t(i,p);if(y===0)return p?g.cells.concat(g.boundary):g.cells;for(var h=1,m=g.active,u=g.next,_=g.flags,s=g.cells,A=g.constraint,b=g.neighbor;m.length>0||u.length>0;){for(;m.length>0;){var f=m.pop();if(_[f]!==-h){_[f]=h,s[f];for(var x=0;x<3;++x){var l=b[3*f+x];l>=0&&_[l]===0&&(A[3*f+x]?u.push(l):(m.push(l),_[l]=h))}}}var L=u;u=m,m=L,u.length=0,h=-h}var T=c(s,_,y);return p?T.concat(g.boundary):T}},{"binary-search-bounds":31}],45:[function(v,S,M){var e=v("binary-search-bounds"),a=v("robust-orientation")[3],n=0,r=1,t=2;S.exports=u;function c(_,s,A,b,f){this.a=_,this.b=s,this.idx=A,this.lowerIds=b,this.upperIds=f}function o(_,s,A,b){this.a=_,this.b=s,this.type=A,this.idx=b}function i(_,s){var A=_.a[0]-s.a[0]||_.a[1]-s.a[1]||_.type-s.type;return A||_.type!==n&&(A=a(_.a,_.b,s.b),A)?A:_.idx-s.idx}function y(_,s){return a(_.a,_.b,s)}function p(_,s,A,b,f){for(var x=e.lt(s,b,y),l=e.gt(s,b,y),L=x;L<l;++L){for(var T=s[L],k=T.lowerIds,z=k.length;z>1&&a(A[k[z-2]],A[k[z-1]],b)>0;)_.push([k[z-1],k[z-2],f]),z-=1;k.length=z,k.push(f);for(var P=T.upperIds,z=P.length;z>1&&a(A[P[z-2]],A[P[z-1]],b)<0;)_.push([P[z-2],P[z-1],f]),z-=1;P.length=z,P.push(f)}}function g(_,s){var A;return _.a[0]<s.a[0]?A=a(_.a,_.b,s.a):A=a(s.b,s.a,_.a),A||(s.b[0]<_.b[0]?A=a(_.a,_.b,s.b):A=a(s.b,s.a,_.b),A||_.idx-s.idx)}function h(_,s,A){var b=e.le(_,A,g),f=_[b],x=f.upperIds,l=x[x.length-1];f.upperIds=[l],_.splice(b+1,0,new c(A.a,A.b,A.idx,[l],x))}function m(_,s,A){var b=A.a;A.a=A.b,A.b=b;var f=e.eq(_,A,g),x=_[f],l=_[f-1];l.upperIds=x.upperIds,_.splice(f,1)}function u(_,s){for(var A=_.length,b=s.length,f=[],x=0;x<A;++x)f.push(new o(_[x],null,n,x));for(var x=0;x<b;++x){var l=s[x],L=_[l[0]],T=_[l[1]];L[0]<T[0]?f.push(new o(L,T,t,x),new o(T,L,r,x)):L[0]>T[0]&&f.push(new o(T,L,t,x),new o(L,T,r,x))}f.sort(i);for(var k=f[0].a[0]-(1+Math.abs(f[0].a[0]))*Math.pow(2,-52),P=[new c([k,1],[k,0],-1,[],[])],z=[],x=0,I=f.length;x<I;++x){var D=f[x],R=D.type;R===n?p(z,P,_,D.a,D.idx):R===t?h(P,_,D):m(P,_,D)}return z}},{"binary-search-bounds":31,"robust-orientation":284}],46:[function(v,S,M){var e=v("binary-search-bounds");S.exports=t;function a(c,o){this.stars=c,this.edges=o}var n=a.prototype;function r(c,o,i){for(var y=1,p=c.length;y<p;y+=2)if(c[y-1]===o&&c[y]===i){c[y-1]=c[p-2],c[y]=c[p-1],c.length=p-2;return}}n.isConstraint=function(){var c=[0,0];function o(i,y){return i[0]-y[0]||i[1]-y[1]}return function(i,y){return c[0]=Math.min(i,y),c[1]=Math.max(i,y),e.eq(this.edges,c,o)>=0}}(),n.removeTriangle=function(c,o,i){var y=this.stars;r(y[c],o,i),r(y[o],i,c),r(y[i],c,o)},n.addTriangle=function(c,o,i){var y=this.stars;y[c].push(o,i),y[o].push(i,c),y[i].push(c,o)},n.opposite=function(c,o){for(var i=this.stars[o],y=1,p=i.length;y<p;y+=2)if(i[y]===c)return i[y-1];return-1},n.flip=function(c,o){var i=this.opposite(c,o),y=this.opposite(o,c);this.removeTriangle(c,o,i),this.removeTriangle(o,c,y),this.addTriangle(c,y,i),this.addTriangle(o,i,y)},n.edges=function(){for(var c=this.stars,o=[],i=0,y=c.length;i<y;++i)for(var p=c[i],g=0,h=p.length;g<h;g+=2)o.push([p[g],p[g+1]]);return o},n.cells=function(){for(var c=this.stars,o=[],i=0,y=c.length;i<y;++i)for(var p=c[i],g=0,h=p.length;g<h;g+=2){var m=p[g],u=p[g+1];i<Math.min(m,u)&&o.push([i,m,u])}return o};function t(c,o){for(var i=new Array(c),y=0;y<c;++y)i[y]=[];return new a(i,o)}},{"binary-search-bounds":31}],47:[function(v,S,M){S.exports=e;function e(a){for(var n=1,r=1;r<a.length;++r)for(var t=0;t<r;++t)if(a[r]<a[t])n=-n;else if(a[t]===a[r])return 0;return n}},{}],48:[function(v,S,M){var e=v("dup"),a=v("robust-linear-solve");function n(c,o){for(var i=0,y=c.length,p=0;p<y;++p)i+=c[p]*o[p];return i}function r(c){var o=c.length;if(o===0)return[];c[0].length;var i=e([c.length+1,c.length+1],1),y=e([c.length+1],1);i[o][o]=0;for(var p=0;p<o;++p){for(var g=0;g<=p;++g)i[g][p]=i[p][g]=2*n(c[p],c[g]);y[p]=n(c[p],c[p])}for(var h=a(i,y),m=0,u=h[o+1],p=0;p<u.length;++p)m+=u[p];for(var _=new Array(o),p=0;p<o;++p){for(var u=h[p],s=0,g=0;g<u.length;++g)s+=u[g];_[p]=s/m}return _}function t(c){if(c.length===0)return[];for(var o=c[0].length,i=e([o]),y=r(c),p=0;p<c.length;++p)for(var g=0;g<o;++g)i[g]+=c[p][g]*y[p];return i}t.barycenetric=r,S.exports=t},{dup:65,"robust-linear-solve":283}],49:[function(v,S,M){S.exports=a;var e=v("circumcenter");function a(n){for(var r=e(n),t=0,c=0;c<n.length;++c)for(var o=n[c],i=0;i<r.length;++i)t+=Math.pow(o[i]-r[i],2);return Math.sqrt(t/n.length)}},{circumcenter:48}],50:[function(v,S,M){S.exports=L;var e=v("union-find"),a=v("box-intersect"),n=v("robust-segment-intersect"),r=v("big-rat"),t=v("big-rat/cmp"),c=v("big-rat/to-float"),o=v("rat-vec"),i=v("nextafter"),y=v("./lib/rat-seg-intersect");function p(T){var k=c(T);return[i(k,-1/0),i(k,1/0)]}function g(T,k){for(var P=new Array(k.length),z=0;z<k.length;++z){var I=k[z],D=T[I[0]],R=T[I[1]];P[z]=[i(Math.min(D[0],R[0]),-1/0),i(Math.min(D[1],R[1]),-1/0),i(Math.max(D[0],R[0]),1/0),i(Math.max(D[1],R[1]),1/0)]}return P}function h(T){for(var k=new Array(T.length),P=0;P<T.length;++P){var z=T[P];k[P]=[i(z[0],-1/0),i(z[1],-1/0),i(z[0],1/0),i(z[1],1/0)]}return k}function m(T,k,P){var z=[];return a(P,function(I,D){var R=k[I],B=k[D];if(!(R[0]===B[0]||R[0]===B[1]||R[1]===B[0]||R[1]===B[1])){var F=T[R[0]],H=T[R[1]],G=T[B[0]],J=T[B[1]];n(F,H,G,J)&&z.push([I,D])}}),z}function u(T,k,P,z){var I=[];return a(P,z,function(D,R){var B=k[D];if(!(B[0]===R||B[1]===R)){var F=T[R],H=T[B[0]],G=T[B[1]];n(H,G,F,F)&&I.push([D,R])}}),I}function _(T,k,P,z,I){var D,R,B=T.map(function(ne){return[r(ne[0]),r(ne[1])]});for(D=0;D<P.length;++D){var F=P[D];R=F[0];var H=F[1],G=k[R],J=k[H],X=y(o(T[G[0]]),o(T[G[1]]),o(T[J[0]]),o(T[J[1]]));if(!!X){var Y=T.length;T.push([c(X[0]),c(X[1])]),B.push(X),z.push([R,Y],[H,Y])}}for(z.sort(function(ne,ae){if(ne[0]!==ae[0])return ne[0]-ae[0];var ie=B[ne[1]],le=B[ae[1]];return t(ie[0],le[0])||t(ie[1],le[1])}),D=z.length-1;D>=0;--D){var Z=z[D];R=Z[0];var oe=k[R],re=oe[0],se=oe[1],N=T[re],U=T[se];if((N[0]-U[0]||N[1]-U[1])<0){var q=re;re=se,se=q}oe[0]=re;var $=oe[1]=Z[1],W;for(I&&(W=oe[2]);D>0&&z[D-1][0]===R;){var Z=z[--D],K=Z[1];I?k.push([$,K,W]):k.push([$,K]),$=K}I?k.push([$,se,W]):k.push([$,se])}return B}function s(T,k,P){for(var z=k.length,I=new e(z),D=[],R=0;R<k.length;++R){var B=k[R],F=p(B[0]),H=p(B[1]);D.push([i(F[0],-1/0),i(H[0],-1/0),i(F[1],1/0),i(H[1],1/0)])}a(D,function(Z,oe){I.link(Z,oe)});for(var G=!0,J=new Array(z),R=0;R<z;++R){var X=I.find(R);X!==R&&(G=!1,T[X]=[Math.min(T[R][0],T[X][0]),Math.min(T[R][1],T[X][1])])}if(G)return null;for(var Y=0,R=0;R<z;++R){var X=I.find(R);X===R?(J[R]=Y,T[Y++]=T[R]):J[R]=-1}T.length=Y;for(var R=0;R<z;++R)J[R]<0&&(J[R]=J[I.find(R)]);return J}function A(T,k){return T[0]-k[0]||T[1]-k[1]}function b(T,k){var P=T[0]-k[0]||T[1]-k[1];return P||(T[2]<k[2]?-1:T[2]>k[2]?1:0)}function f(T,k,P){if(T.length!==0){if(k)for(var z=0;z<T.length;++z){var I=T[z],D=k[I[0]],R=k[I[1]];I[0]=Math.min(D,R),I[1]=Math.max(D,R)}else for(var z=0;z<T.length;++z){var I=T[z],D=I[0],R=I[1];I[0]=Math.min(D,R),I[1]=Math.max(D,R)}P?T.sort(b):T.sort(A);for(var B=1,z=1;z<T.length;++z){var F=T[z-1],H=T[z];H[0]===F[0]&&H[1]===F[1]&&(!P||H[2]===F[2])||(T[B++]=H)}T.length=B}}function x(T,k,P){var z=s(T,[],h(T));return f(k,z,P),!!z}function l(T,k,P){var z=g(T,k),I=m(T,k,z),D=h(T),R=u(T,k,z,D),B=_(T,k,I,R,P),F=s(T,B);return f(k,F,P),F?!0:I.length>0||R.length>0}function L(T,k,P){var z;if(P){z=k;for(var I=new Array(k.length),D=0;D<k.length;++D){var R=k[D];I[D]=[R[0],R[1],P[D]]}k=I}for(var B=x(T,k,!!P);l(T,k,!!P);)B=!0;if(!!P&&B){z.length=0,P.length=0;for(var D=0;D<k.length;++D){var R=k[D];z.push([R[0],R[1]]),P.push(R[2])}}return B}},{"./lib/rat-seg-intersect":51,"big-rat":18,"big-rat/cmp":16,"big-rat/to-float":30,"box-intersect":35,nextafter:260,"rat-vec":273,"robust-segment-intersect":287,"union-find":309}],51:[function(v,S,M){S.exports=y;var e=v("big-rat/mul"),a=v("big-rat/div"),n=v("big-rat/sub"),r=v("big-rat/sign"),t=v("rat-vec/sub"),c=v("rat-vec/add"),o=v("rat-vec/muls");function i(p,g){return n(e(p[0],g[1]),e(p[1],g[0]))}function y(p,g,h,m){var u=t(g,p),_=t(m,h),s=i(u,_);if(r(s)===0)return null;var A=t(p,h),b=i(_,A),f=a(b,s),x=o(u,f),l=c(p,x);return l}},{"big-rat/div":17,"big-rat/mul":27,"big-rat/sign":28,"big-rat/sub":29,"rat-vec/add":272,"rat-vec/muls":274,"rat-vec/sub":275}],52:[function(v,S,M){S.exports={jet:[{index:0,rgb:[0,0,131]},{index:.125,rgb:[0,60,170]},{index:.375,rgb:[5,255,255]},{index:.625,rgb:[255,255,0]},{index:.875,rgb:[250,0,0]},{index:1,rgb:[128,0,0]}],hsv:[{index:0,rgb:[255,0,0]},{index:.169,rgb:[253,255,2]},{index:.173,rgb:[247,255,2]},{index:.337,rgb:[0,252,4]},{index:.341,rgb:[0,252,10]},{index:.506,rgb:[1,249,255]},{index:.671,rgb:[2,0,253]},{index:.675,rgb:[8,0,253]},{index:.839,rgb:[255,0,251]},{index:.843,rgb:[255,0,245]},{index:1,rgb:[255,0,6]}],hot:[{index:0,rgb:[0,0,0]},{index:.3,rgb:[230,0,0]},{index:.6,rgb:[255,210,0]},{index:1,rgb:[255,255,255]}],spring:[{index:0,rgb:[255,0,255]},{index:1,rgb:[255,255,0]}],summer:[{index:0,rgb:[0,128,102]},{index:1,rgb:[255,255,102]}],autumn:[{index:0,rgb:[255,0,0]},{index:1,rgb:[255,255,0]}],winter:[{index:0,rgb:[0,0,255]},{index:1,rgb:[0,255,128]}],bone:[{index:0,rgb:[0,0,0]},{index:.376,rgb:[84,84,116]},{index:.753,rgb:[169,200,200]},{index:1,rgb:[255,255,255]}],copper:[{index:0,rgb:[0,0,0]},{index:.804,rgb:[255,160,102]},{index:1,rgb:[255,199,127]}],greys:[{index:0,rgb:[0,0,0]},{index:1,rgb:[255,255,255]}],yignbu:[{index:0,rgb:[8,29,88]},{index:.125,rgb:[37,52,148]},{index:.25,rgb:[34,94,168]},{index:.375,rgb:[29,145,192]},{index:.5,rgb:[65,182,196]},{index:.625,rgb:[127,205,187]},{index:.75,rgb:[199,233,180]},{index:.875,rgb:[237,248,217]},{index:1,rgb:[255,255,217]}],greens:[{index:0,rgb:[0,68,27]},{index:.125,rgb:[0,109,44]},{index:.25,rgb:[35,139,69]},{index:.375,rgb:[65,171,93]},{index:.5,rgb:[116,196,118]},{index:.625,rgb:[161,217,155]},{index:.75,rgb:[199,233,192]},{index:.875,rgb:[229,245,224]},{index:1,rgb:[247,252,245]}],yiorrd:[{index:0,rgb:[128,0,38]},{index:.125,rgb:[189,0,38]},{index:.25,rgb:[227,26,28]},{index:.375,rgb:[252,78,42]},{index:.5,rgb:[253,141,60]},{index:.625,rgb:[254,178,76]},{index:.75,rgb:[254,217,118]},{index:.875,rgb:[255,237,160]},{index:1,rgb:[255,255,204]}],bluered:[{index:0,rgb:[0,0,255]},{index:1,rgb:[255,0,0]}],rdbu:[{index:0,rgb:[5,10,172]},{index:.35,rgb:[106,137,247]},{index:.5,rgb:[190,190,190]},{index:.6,rgb:[220,170,132]},{index:.7,rgb:[230,145,90]},{index:1,rgb:[178,10,28]}],picnic:[{index:0,rgb:[0,0,255]},{index:.1,rgb:[51,153,255]},{index:.2,rgb:[102,204,255]},{index:.3,rgb:[153,204,255]},{index:.4,rgb:[204,204,255]},{index:.5,rgb:[255,255,255]},{index:.6,rgb:[255,204,255]},{index:.7,rgb:[255,153,255]},{index:.8,rgb:[255,102,204]},{index:.9,rgb:[255,102,102]},{index:1,rgb:[255,0,0]}],rainbow:[{index:0,rgb:[150,0,90]},{index:.125,rgb:[0,0,200]},{index:.25,rgb:[0,25,255]},{index:.375,rgb:[0,152,255]},{index:.5,rgb:[44,255,150]},{index:.625,rgb:[151,255,0]},{index:.75,rgb:[255,234,0]},{index:.875,rgb:[255,111,0]},{index:1,rgb:[255,0,0]}],portland:[{index:0,rgb:[12,51,131]},{index:.25,rgb:[10,136,186]},{index:.5,rgb:[242,211,56]},{index:.75,rgb:[242,143,56]},{index:1,rgb:[217,30,30]}],blackbody:[{index:0,rgb:[0,0,0]},{index:.2,rgb:[230,0,0]},{index:.4,rgb:[230,210,0]},{index:.7,rgb:[255,255,255]},{index:1,rgb:[160,200,255]}],earth:[{index:0,rgb:[0,0,130]},{index:.1,rgb:[0,180,180]},{index:.2,rgb:[40,210,40]},{index:.4,rgb:[230,230,50]},{index:.6,rgb:[120,70,20]},{index:1,rgb:[255,255,255]}],electric:[{index:0,rgb:[0,0,0]},{index:.15,rgb:[30,0,100]},{index:.4,rgb:[120,0,100]},{index:.6,rgb:[160,90,0]},{index:.8,rgb:[230,200,0]},{index:1,rgb:[255,250,220]}],alpha:[{index:0,rgb:[255,255,255,0]},{index:1,rgb:[255,255,255,1]}],viridis:[{index:0,rgb:[68,1,84]},{index:.13,rgb:[71,44,122]},{index:.25,rgb:[59,81,139]},{index:.38,rgb:[44,113,142]},{index:.5,rgb:[33,144,141]},{index:.63,rgb:[39,173,129]},{index:.75,rgb:[92,200,99]},{index:.88,rgb:[170,220,50]},{index:1,rgb:[253,231,37]}],inferno:[{index:0,rgb:[0,0,4]},{index:.13,rgb:[31,12,72]},{index:.25,rgb:[85,15,109]},{index:.38,rgb:[136,34,106]},{index:.5,rgb:[186,54,85]},{index:.63,rgb:[227,89,51]},{index:.75,rgb:[249,140,10]},{index:.88,rgb:[249,201,50]},{index:1,rgb:[252,255,164]}],magma:[{index:0,rgb:[0,0,4]},{index:.13,rgb:[28,16,68]},{index:.25,rgb:[79,18,123]},{index:.38,rgb:[129,37,129]},{index:.5,rgb:[181,54,122]},{index:.63,rgb:[229,80,100]},{index:.75,rgb:[251,135,97]},{index:.88,rgb:[254,194,135]},{index:1,rgb:[252,253,191]}],plasma:[{index:0,rgb:[13,8,135]},{index:.13,rgb:[75,3,161]},{index:.25,rgb:[125,3,168]},{index:.38,rgb:[168,34,150]},{index:.5,rgb:[203,70,121]},{index:.63,rgb:[229,107,93]},{index:.75,rgb:[248,148,65]},{index:.88,rgb:[253,195,40]},{index:1,rgb:[240,249,33]}],warm:[{index:0,rgb:[125,0,179]},{index:.13,rgb:[172,0,187]},{index:.25,rgb:[219,0,170]},{index:.38,rgb:[255,0,130]},{index:.5,rgb:[255,63,74]},{index:.63,rgb:[255,123,0]},{index:.75,rgb:[234,176,0]},{index:.88,rgb:[190,228,0]},{index:1,rgb:[147,255,0]}],cool:[{index:0,rgb:[125,0,179]},{index:.13,rgb:[116,0,218]},{index:.25,rgb:[98,74,237]},{index:.38,rgb:[68,146,231]},{index:.5,rgb:[0,204,197]},{index:.63,rgb:[0,247,146]},{index:.75,rgb:[0,255,88]},{index:.88,rgb:[40,255,8]},{index:1,rgb:[147,255,0]}],"rainbow-soft":[{index:0,rgb:[125,0,179]},{index:.1,rgb:[199,0,180]},{index:.2,rgb:[255,0,121]},{index:.3,rgb:[255,108,0]},{index:.4,rgb:[222,194,0]},{index:.5,rgb:[150,255,0]},{index:.6,rgb:[0,255,55]},{index:.7,rgb:[0,246,150]},{index:.8,rgb:[50,167,222]},{index:.9,rgb:[103,51,235]},{index:1,rgb:[124,0,186]}],bathymetry:[{index:0,rgb:[40,26,44]},{index:.13,rgb:[59,49,90]},{index:.25,rgb:[64,76,139]},{index:.38,rgb:[63,110,151]},{index:.5,rgb:[72,142,158]},{index:.63,rgb:[85,174,163]},{index:.75,rgb:[120,206,163]},{index:.88,rgb:[187,230,172]},{index:1,rgb:[253,254,204]}],cdom:[{index:0,rgb:[47,15,62]},{index:.13,rgb:[87,23,86]},{index:.25,rgb:[130,28,99]},{index:.38,rgb:[171,41,96]},{index:.5,rgb:[206,67,86]},{index:.63,rgb:[230,106,84]},{index:.75,rgb:[242,149,103]},{index:.88,rgb:[249,193,135]},{index:1,rgb:[254,237,176]}],chlorophyll:[{index:0,rgb:[18,36,20]},{index:.13,rgb:[25,63,41]},{index:.25,rgb:[24,91,59]},{index:.38,rgb:[13,119,72]},{index:.5,rgb:[18,148,80]},{index:.63,rgb:[80,173,89]},{index:.75,rgb:[132,196,122]},{index:.88,rgb:[175,221,162]},{index:1,rgb:[215,249,208]}],density:[{index:0,rgb:[54,14,36]},{index:.13,rgb:[89,23,80]},{index:.25,rgb:[110,45,132]},{index:.38,rgb:[120,77,178]},{index:.5,rgb:[120,113,213]},{index:.63,rgb:[115,151,228]},{index:.75,rgb:[134,185,227]},{index:.88,rgb:[177,214,227]},{index:1,rgb:[230,241,241]}],"freesurface-blue":[{index:0,rgb:[30,4,110]},{index:.13,rgb:[47,14,176]},{index:.25,rgb:[41,45,236]},{index:.38,rgb:[25,99,212]},{index:.5,rgb:[68,131,200]},{index:.63,rgb:[114,156,197]},{index:.75,rgb:[157,181,203]},{index:.88,rgb:[200,208,216]},{index:1,rgb:[241,237,236]}],"freesurface-red":[{index:0,rgb:[60,9,18]},{index:.13,rgb:[100,17,27]},{index:.25,rgb:[142,20,29]},{index:.38,rgb:[177,43,27]},{index:.5,rgb:[192,87,63]},{index:.63,rgb:[205,125,105]},{index:.75,rgb:[216,162,148]},{index:.88,rgb:[227,199,193]},{index:1,rgb:[241,237,236]}],oxygen:[{index:0,rgb:[64,5,5]},{index:.13,rgb:[106,6,15]},{index:.25,rgb:[144,26,7]},{index:.38,rgb:[168,64,3]},{index:.5,rgb:[188,100,4]},{index:.63,rgb:[206,136,11]},{index:.75,rgb:[220,174,25]},{index:.88,rgb:[231,215,44]},{index:1,rgb:[248,254,105]}],par:[{index:0,rgb:[51,20,24]},{index:.13,rgb:[90,32,35]},{index:.25,rgb:[129,44,34]},{index:.38,rgb:[159,68,25]},{index:.5,rgb:[182,99,19]},{index:.63,rgb:[199,134,22]},{index:.75,rgb:[212,171,35]},{index:.88,rgb:[221,210,54]},{index:1,rgb:[225,253,75]}],phase:[{index:0,rgb:[145,105,18]},{index:.13,rgb:[184,71,38]},{index:.25,rgb:[186,58,115]},{index:.38,rgb:[160,71,185]},{index:.5,rgb:[110,97,218]},{index:.63,rgb:[50,123,164]},{index:.75,rgb:[31,131,110]},{index:.88,rgb:[77,129,34]},{index:1,rgb:[145,105,18]}],salinity:[{index:0,rgb:[42,24,108]},{index:.13,rgb:[33,50,162]},{index:.25,rgb:[15,90,145]},{index:.38,rgb:[40,118,137]},{index:.5,rgb:[59,146,135]},{index:.63,rgb:[79,175,126]},{index:.75,rgb:[120,203,104]},{index:.88,rgb:[193,221,100]},{index:1,rgb:[253,239,154]}],temperature:[{index:0,rgb:[4,35,51]},{index:.13,rgb:[23,51,122]},{index:.25,rgb:[85,59,157]},{index:.38,rgb:[129,79,143]},{index:.5,rgb:[175,95,130]},{index:.63,rgb:[222,112,101]},{index:.75,rgb:[249,146,66]},{index:.88,rgb:[249,196,65]},{index:1,rgb:[232,250,91]}],turbidity:[{index:0,rgb:[34,31,27]},{index:.13,rgb:[65,50,41]},{index:.25,rgb:[98,69,52]},{index:.38,rgb:[131,89,57]},{index:.5,rgb:[161,112,59]},{index:.63,rgb:[185,140,66]},{index:.75,rgb:[202,174,88]},{index:.88,rgb:[216,209,126]},{index:1,rgb:[233,246,171]}],"velocity-blue":[{index:0,rgb:[17,32,64]},{index:.13,rgb:[35,52,116]},{index:.25,rgb:[29,81,156]},{index:.38,rgb:[31,113,162]},{index:.5,rgb:[50,144,169]},{index:.63,rgb:[87,173,176]},{index:.75,rgb:[149,196,189]},{index:.88,rgb:[203,221,211]},{index:1,rgb:[254,251,230]}],"velocity-green":[{index:0,rgb:[23,35,19]},{index:.13,rgb:[24,64,38]},{index:.25,rgb:[11,95,45]},{index:.38,rgb:[39,123,35]},{index:.5,rgb:[95,146,12]},{index:.63,rgb:[152,165,18]},{index:.75,rgb:[201,186,69]},{index:.88,rgb:[233,216,137]},{index:1,rgb:[255,253,205]}],cubehelix:[{index:0,rgb:[0,0,0]},{index:.07,rgb:[22,5,59]},{index:.13,rgb:[60,4,105]},{index:.2,rgb:[109,1,135]},{index:.27,rgb:[161,0,147]},{index:.33,rgb:[210,2,142]},{index:.4,rgb:[251,11,123]},{index:.47,rgb:[255,29,97]},{index:.53,rgb:[255,54,69]},{index:.6,rgb:[255,85,46]},{index:.67,rgb:[255,120,34]},{index:.73,rgb:[255,157,37]},{index:.8,rgb:[241,191,57]},{index:.87,rgb:[224,220,93]},{index:.93,rgb:[218,241,142]},{index:1,rgb:[227,253,198]}]}},{}],53:[function(v,S,M){var e=v("./colorScale"),a=v("lerp");S.exports=n;function n(o){var i,y,p,g,h,m,u,_,f,s,A;if(o||(o={}),_=(o.nshades||72)-1,u=o.format||"hex",m=o.colormap,m||(m="jet"),typeof m=="string"){if(m=m.toLowerCase(),!e[m])throw Error(m+" not a supported colorscale");h=e[m]}else if(Array.isArray(m))h=m.slice();else throw Error("unsupported colormap option",m);if(h.length>_+1)throw new Error(m+" map requires nshades to be at least size "+h.length);Array.isArray(o.alpha)?o.alpha.length!==2?s=[1,1]:s=o.alpha.slice():typeof o.alpha=="number"?s=[o.alpha,o.alpha]:s=[1,1],i=h.map(function(L){return Math.round(L.index*_)}),s[0]=Math.min(Math.max(s[0],0),1),s[1]=Math.min(Math.max(s[1],0),1);var b=h.map(function(L,T){var k=h[T].index,P=h[T].rgb.slice();return P.length===4&&P[3]>=0&&P[3]<=1||(P[3]=s[0]+(s[1]-s[0])*k),P}),f=[];for(A=0;A<i.length-1;++A){g=i[A+1]-i[A],y=b[A],p=b[A+1];for(var x=0;x<g;x++){var l=x/g;f.push([Math.round(a(y[0],p[0],l)),Math.round(a(y[1],p[1],l)),Math.round(a(y[2],p[2],l)),a(y[3],p[3],l)])}}return f.push(h[h.length-1].rgb.concat(s[1])),u==="hex"?f=f.map(t):u==="rgbaString"?f=f.map(c):u==="float"&&(f=f.map(r)),f}function r(o){return[o[0]/255,o[1]/255,o[2]/255,o[3]]}function t(o){for(var i,y="#",p=0;p<3;++p)i=o[p],i=i.toString(16),y+=("00"+i).substr(i.length);return y}function c(o){return"rgba("+o.join(",")+")"}},{"./colorScale":52,lerp:240}],54:[function(v,S,M){S.exports=o;var e=v("robust-orientation"),a=v("signum"),n=v("two-sum"),r=v("robust-product"),t=v("robust-sum");function c(i,y,p){var g=n(i[0],-y[0]),h=n(i[1],-y[1]),m=n(p[0],-y[0]),u=n(p[1],-y[1]),_=t(r(g,m),r(h,u));return _[_.length-1]>=0}function o(i,y,p,g){var h=e(y,p,g);if(h===0){var m=a(e(i,y,p)),u=a(e(i,y,g));if(m===u){if(m===0){var _=c(i,y,p),s=c(i,y,g);return _===s?0:_?1:-1}return 0}else{if(u===0)return m>0||c(i,y,g)?-1:1;if(m===0)return u>0||c(i,y,p)?1:-1}return a(u-m)}var A=e(i,y,p);if(A>0)return h>0&&e(i,y,g)>0?1:-1;if(A<0)return h>0||e(i,y,g)>0?1:-1;var b=e(i,y,g);return b>0||c(i,y,p)?1:-1}},{"robust-orientation":284,"robust-product":285,"robust-sum":289,signum:55,"two-sum":307}],55:[function(v,S,M){S.exports=function(a){return a<0?-1:a>0?1:0}},{}],56:[function(v,S,M){S.exports=n;var e=Math.min;function a(r,t){return r-t}function n(r,t){var c=r.length,o=r.length-t.length;if(o)return o;switch(c){case 0:return 0;case 1:return r[0]-t[0];case 2:return r[0]+r[1]-t[0]-t[1]||e(r[0],r[1])-e(t[0],t[1]);case 3:var i=r[0]+r[1],y=t[0]+t[1];if(o=i+r[2]-(y+t[2]),o)return o;var p=e(r[0],r[1]),g=e(t[0],t[1]);return e(p,r[2])-e(g,t[2])||e(p+r[2],i)-e(g+t[2],y);case 4:var h=r[0],m=r[1],u=r[2],_=r[3],s=t[0],A=t[1],b=t[2],f=t[3];return h+m+u+_-(s+A+b+f)||e(h,m,u,_)-e(s,A,b,f,s)||e(h+m,h+u,h+_,m+u,m+_,u+_)-e(s+A,s+b,s+f,A+b,A+f,b+f)||e(h+m+u,h+m+_,h+u+_,m+u+_)-e(s+A+b,s+A+f,s+b+f,A+b+f);default:for(var x=r.slice().sort(a),l=t.slice().sort(a),L=0;L<c;++L)if(o=x[L]-l[L],o)return o;return 0}}},{}],57:[function(v,S,M){var e=v("compare-cell"),a=v("cell-orientation");S.exports=n;function n(r,t){return e(r,t)||a(r)-a(t)}},{"cell-orientation":47,"compare-cell":56}],58:[function(v,S,M){var e=v("./lib/ch1d"),a=v("./lib/ch2d"),n=v("./lib/chnd");S.exports=r;function r(t){var c=t.length;if(c===0)return[];if(c===1)return[[0]];var o=t[0].length;return o===0?[]:o===1?e(t):o===2?a(t):n(t,o)}},{"./lib/ch1d":59,"./lib/ch2d":60,"./lib/chnd":61}],59:[function(v,S,M){S.exports=e;function e(a){for(var n=0,r=0,t=1;t<a.length;++t)a[t][0]<a[n][0]&&(n=t),a[t][0]>a[r][0]&&(r=t);return n<r?[[n],[r]]:n>r?[[r],[n]]:[[n]]}},{}],60:[function(v,S,M){S.exports=a;var e=v("monotone-convex-hull-2d");function a(n){var r=e(n),t=r.length;if(t<=2)return[];for(var c=new Array(t),o=r[t-1],i=0;i<t;++i){var y=r[i];c[i]=[o,y],o=y}return c}},{"monotone-convex-hull-2d":246}],61:[function(v,S,M){S.exports=t;var e=v("incremental-convex-hull"),a=v("affine-hull");function n(c,o){for(var i=c.length,y=new Array(i),p=0;p<o.length;++p)y[p]=c[o[p]];for(var g=o.length,p=0;p<i;++p)o.indexOf(p)<0&&(y[g++]=c[p]);return y}function r(c,o){for(var i=c.length,y=o.length,p=0;p<i;++p)for(var g=c[p],h=0;h<g.length;++h){var m=g[h];if(m<y)g[h]=o[m];else{m=m-y;for(var u=0;u<y;++u)m>=o[u]&&(m+=1);g[h]=m}}return c}function t(c,o){try{return e(c,!0)}catch{var i=a(c);if(i.length<=o)return[];var y=n(c,i),p=e(y,!0);return r(p,i)}}},{"affine-hull":10,"incremental-convex-hull":233}],62:[function(v,S,M){function e(n,r,t,c,o,i){var y=6*o*o-6*o,p=3*o*o-4*o+1,g=-6*o*o+6*o,h=3*o*o-2*o;if(n.length){i||(i=new Array(n.length));for(var m=n.length-1;m>=0;--m)i[m]=y*n[m]+p*r[m]+g*t[m]+h*c[m];return i}return y*n+p*r+g*t[m]+h*c}function a(n,r,t,c,o,i){var y=o-1,p=o*o,g=y*y,h=(1+2*o)*g,m=o*g,u=p*(3-2*o),_=p*y;if(n.length){i||(i=new Array(n.length));for(var s=n.length-1;s>=0;--s)i[s]=h*n[s]+m*r[s]+u*t[s]+_*c[s];return i}return h*n+m*r+u*t+_*c}S.exports=a,S.exports.derivative=e},{}],63:[function(v,S,M){var e=v("incremental-convex-hull"),a=v("uniq");S.exports=c;function n(o,i){this.point=o,this.index=i}function r(o,i){for(var y=o.point,p=i.point,g=y.length,h=0;h<g;++h){var m=p[h]-y[h];if(m)return m}return 0}function t(o,i,y){if(o===1)return y?[[-1,0]]:[];var p=i.map(function(_,s){return[_[0],s]});p.sort(function(_,s){return _[0]-s[0]});for(var g=new Array(o-1),h=1;h<o;++h){var m=p[h-1],u=p[h];g[h-1]=[m[1],u[1]]}return y&&g.push([-1,g[0][1]],[g[o-1][1],-1]),g}function c(o,i){var y=o.length;if(y===0)return[];var p=o[0].length;if(p<1)return[];if(p===1)return t(y,o,i);for(var g=new Array(y),h=1,m=0;m<y;++m){for(var u=o[m],_=new Array(p+1),s=0,A=0;A<p;++A){var b=u[A];_[A]=b,s+=b*b}_[p]=s,g[m]=new n(_,m),h=Math.max(s,h)}a(g,r),y=g.length;for(var f=new Array(y+p+1),x=new Array(y+p+1),l=(p+1)*(p+1)*h,L=new Array(p+1),m=0;m<=p;++m)L[m]=0;L[p]=l,f[0]=L.slice(),x[0]=-1;for(var m=0;m<=p;++m){var _=L.slice();_[m]=1,f[m+1]=_,x[m+1]=-1}for(var m=0;m<y;++m){var T=g[m];f[m+p+1]=T.point,x[m+p+1]=T.index}var k=e(f,!1);if(i?k=k.filter(function(P){for(var z=0,I=0;I<=p;++I){var D=x[P[I]];if(D<0&&++z>=2)return!1;P[I]=D}return!0}):k=k.filter(function(P){for(var z=0;z<=p;++z){var I=x[P[z]];if(I<0)return!1;P[z]=I}return!0}),p&1)for(var m=0;m<k.length;++m){var T=k[m],_=T[0];T[0]=T[1],T[1]=_}return k}},{"incremental-convex-hull":233,uniq:310}],64:[function(v,S,M){(function(e){(function(){var a=!1;if(typeof Float64Array<"u"){var n=new Float64Array(1),r=new Uint32Array(n.buffer);if(n[0]=1,a=!0,r[1]===1072693248){let c=function(y,p){return r[0]=y,r[1]=p,n[0]},o=function(y){return n[0]=y,r[0]},i=function(y){return n[0]=y,r[1]};S.exports=function(p){return n[0]=p,[r[0],r[1]]},S.exports.pack=c,S.exports.lo=o,S.exports.hi=i}else if(r[0]===1072693248){let c=function(y,p){return r[1]=y,r[0]=p,n[0]},o=function(y){return n[0]=y,r[1]},i=function(y){return n[0]=y,r[0]};S.exports=function(p){return n[0]=p,[r[1],r[0]]},S.exports.pack=c,S.exports.lo=o,S.exports.hi=i}else a=!1}if(!a){let c=function(y,p){return t.writeUInt32LE(y,0,!0),t.writeUInt32LE(p,4,!0),t.readDoubleLE(0,!0)},o=function(y){return t.writeDoubleLE(y,0,!0),t.readUInt32LE(0,!0)},i=function(y){return t.writeDoubleLE(y,0,!0),t.readUInt32LE(4,!0)};var t=new e(8);S.exports=function(p){return t.writeDoubleLE(p,0,!0),[t.readUInt32LE(0,!0),t.readUInt32LE(4,!0)]},S.exports.pack=c,S.exports.lo=o,S.exports.hi=i}S.exports.sign=function(c){return S.exports.hi(c)>>>31},S.exports.exponent=function(c){var o=S.exports.hi(c);return(o<<1>>>21)-1023},S.exports.fraction=function(c){var o=S.exports.lo(c),i=S.exports.hi(c),y=i&(1<<20)-1;return i&2146435072&&(y+=1<<20),[o,y]},S.exports.denormalized=function(c){var o=S.exports.hi(c);return!(o&2146435072)}}).call(this)}).call(this,v("buffer").Buffer)},{buffer:3}],65:[function(v,S,M){function e(r,t,c){var o=r[c]|0;if(o<=0)return[];var i=new Array(o),y;if(c===r.length-1)for(y=0;y<o;++y)i[y]=t;else for(y=0;y<o;++y)i[y]=e(r,t,c+1);return i}function a(r,t){var c,o;for(c=new Array(r),o=0;o<r;++o)c[o]=t;return c}function n(r,t){switch(typeof t>"u"&&(t=0),typeof r){case"number":if(r>0)return a(r|0,t);break;case"object":if(typeof r.length=="number")return e(r,t,0);break}return[]}S.exports=n},{}],66:[function(v,S,M){S.exports=a;var e=v("uniq");function a(n,r){var t=n.length;if(typeof r!="number"){r=0;for(var c=0;c<t;++c){var o=n[c];r=Math.max(r,o[0],o[1])}r=(r|0)+1}r=r|0;for(var i=new Array(r),c=0;c<r;++c)i[c]=[];for(var c=0;c<t;++c){var o=n[c];i[o[0]].push(o[1]),i[o[1]].push(o[0])}for(var y=0;y<r;++y)e(i[y],function(p,g){return p-g});return i}},{uniq:310}],67:[function(v,S,M){S.exports=e;function e(a,n,r){var t=n||0,c=r||1;return[[a[12]+a[0],a[13]+a[1],a[14]+a[2],a[15]+a[3]],[a[12]-a[0],a[13]-a[1],a[14]-a[2],a[15]-a[3]],[a[12]+a[4],a[13]+a[5],a[14]+a[6],a[15]+a[7]],[a[12]-a[4],a[13]-a[5],a[14]-a[6],a[15]-a[7]],[t*a[12]+a[8],t*a[13]+a[9],t*a[14]+a[10],t*a[15]+a[11]],[c*a[12]-a[8],c*a[13]-a[9],c*a[14]-a[10],c*a[15]-a[11]]]}},{}],68:[function(v,S,M){S.exports=o;var e=v("cubic-hermite"),a=v("binary-search-bounds");function n(i,y,p){return Math.min(y,Math.max(i,p))}function r(i,y,p){this.dimension=i.length,this.bounds=[new Array(this.dimension),new Array(this.dimension)];for(var g=0;g<this.dimension;++g)this.bounds[0][g]=-1/0,this.bounds[1][g]=1/0;this._state=i.slice().reverse(),this._velocity=y.slice().reverse(),this._time=[p],this._scratch=[i.slice(),i.slice(),i.slice(),i.slice(),i.slice()]}var t=r.prototype;t.flush=function(i){var y=a.gt(this._time,i)-1;y<=0||(this._time.splice(0,y),this._state.splice(0,y*this.dimension),this._velocity.splice(0,y*this.dimension))},t.curve=function(i){var y=this._time,p=y.length,g=a.le(y,i),h=this._scratch[0],m=this._state,u=this._velocity,_=this.dimension,s=this.bounds;if(g<0)for(var A=_-1,b=0;b<_;++b,--A)h[b]=m[A];else if(g>=p-1)for(var A=m.length-1,f=i-y[p-1],b=0;b<_;++b,--A)h[b]=m[A]+f*u[A];else{for(var A=_*(g+1)-1,x=y[g],l=y[g+1],L=l-x||1,T=this._scratch[1],k=this._scratch[2],P=this._scratch[3],z=this._scratch[4],I=!0,b=0;b<_;++b,--A)T[b]=m[A],P[b]=u[A]*L,k[b]=m[A+_],z[b]=u[A+_]*L,I=I&&T[b]===k[b]&&P[b]===z[b]&&P[b]===0;if(I)for(var b=0;b<_;++b)h[b]=T[b];else e(T,P,k,z,(i-x)/L,h)}for(var D=s[0],R=s[1],b=0;b<_;++b)h[b]=n(D[b],R[b],h[b]);return h},t.dcurve=function(i){var y=this._time,p=y.length,g=a.le(y,i),h=this._scratch[0],m=this._state,u=this._velocity,_=this.dimension;if(g>=p-1){var s=m.length-1;i-y[p-1];for(var A=0;A<_;++A,--s)h[A]=u[s]}else{for(var s=_*(g+1)-1,b=y[g],f=y[g+1],x=f-b||1,l=this._scratch[1],L=this._scratch[2],T=this._scratch[3],k=this._scratch[4],P=!0,A=0;A<_;++A,--s)l[A]=m[s],T[A]=u[s]*x,L[A]=m[s+_],k[A]=u[s+_]*x,P=P&&l[A]===L[A]&&T[A]===k[A]&&T[A]===0;if(P)for(var A=0;A<_;++A)h[A]=0;else{e.derivative(l,T,L,k,(i-b)/x,h);for(var A=0;A<_;++A)h[A]/=x}}return h},t.lastT=function(){var i=this._time;return i[i.length-1]},t.stable=function(){for(var i=this._velocity,y=i.length,p=this.dimension-1;p>=0;--p)if(i[--y])return!1;return!0},t.jump=function(i){var y=this.lastT(),p=this.dimension;if(!(i<y||arguments.length!==p+1)){var g=this._state,h=this._velocity,m=g.length-this.dimension,u=this.bounds,_=u[0],s=u[1];this._time.push(y,i);for(var A=0;A<2;++A)for(var b=0;b<p;++b)g.push(g[m++]),h.push(0);this._time.push(i);for(var b=p;b>0;--b)g.push(n(_[b-1],s[b-1],arguments[b])),h.push(0)}},t.push=function(i){var y=this.lastT(),p=this.dimension;if(!(i<y||arguments.length!==p+1)){var g=this._state,h=this._velocity,m=g.length-this.dimension,u=i-y,_=this.bounds,s=_[0],A=_[1],b=u>1e-6?1/u:0;this._time.push(i);for(var f=p;f>0;--f){var x=n(s[f-1],A[f-1],arguments[f]);g.push(x),h.push((x-g[m++])*b)}}},t.set=function(i){var y=this.dimension;if(!(i<this.lastT()||arguments.length!==y+1)){var p=this._state,g=this._velocity,h=this.bounds,m=h[0],u=h[1];this._time.push(i);for(var _=y;_>0;--_)p.push(n(m[_-1],u[_-1],arguments[_])),g.push(0)}},t.move=function(i){var y=this.lastT(),p=this.dimension;if(!(i<=y||arguments.length!==p+1)){var g=this._state,h=this._velocity,m=g.length-this.dimension,u=this.bounds,_=u[0],s=u[1],A=i-y,b=A>1e-6?1/A:0;this._time.push(i);for(var f=p;f>0;--f){var x=arguments[f];g.push(n(_[f-1],s[f-1],g[m++]+x)),h.push(x*b)}}},t.idle=function(i){var y=this.lastT();if(!(i<y)){var p=this.dimension,g=this._state,h=this._velocity,m=g.length-p,u=this.bounds,_=u[0],s=u[1],A=i-y;this._time.push(i);for(var b=p-1;b>=0;--b)g.push(n(_[b],s[b],g[m]+A*h[m])),h.push(0),m+=1}};function c(i){for(var y=new Array(i),p=0;p<i;++p)y[p]=0;return y}function o(i,y,p){switch(arguments.length){case 0:return new r([0],[0],0);case 1:if(typeof i=="number"){var g=c(i);return new r(g,g,0)}else return new r(i,c(i.length),0);case 2:if(typeof y=="number"){var g=c(i.length);return new r(i,g,+y)}else p=0;case 3:if(i.length!==y.length)throw new Error("state and velocity lengths must match");return new r(i,y,p)}}},{"binary-search-bounds":31,"cubic-hermite":62}],69:[function(v,S,M){S.exports=A;var e=0,a=1;function n(b,f,x,l,L,T){this._color=b,this.key=f,this.value=x,this.left=l,this.right=L,this._count=T}function r(b){return new n(b._color,b.key,b.value,b.left,b.right,b._count)}function t(b,f){return new n(b,f.key,f.value,f.left,f.right,f._count)}function c(b){b._count=1+(b.left?b.left._count:0)+(b.right?b.right._count:0)}function o(b,f){this._compare=b,this.root=f}var i=o.prototype;Object.defineProperty(i,"keys",{get:function(){var b=[];return this.forEach(function(f,x){b.push(f)}),b}}),Object.defineProperty(i,"values",{get:function(){var b=[];return this.forEach(function(f,x){b.push(x)}),b}}),Object.defineProperty(i,"length",{get:function(){return this.root?this.root._count:0}}),i.insert=function(b,f){for(var x=this._compare,l=this.root,L=[],T=[];l;){var k=x(b,l.key);L.push(l),T.push(k),k<=0?l=l.left:l=l.right}L.push(new n(e,b,f,null,null,1));for(var P=L.length-2;P>=0;--P){var l=L[P];T[P]<=0?L[P]=new n(l._color,l.key,l.value,L[P+1],l.right,l._count+1):L[P]=new n(l._color,l.key,l.value,l.left,L[P+1],l._count+1)}for(var P=L.length-1;P>1;--P){var z=L[P-1],l=L[P];if(z._color===a||l._color===a)break;var I=L[P-2];if(I.left===z)if(z.left===l){var D=I.right;if(D&&D._color===e)z._color=a,I.right=t(a,D),I._color=e,P-=1;else{if(I._color=e,I.left=z.right,z._color=a,z.right=I,L[P-2]=z,L[P-1]=l,c(I),c(z),P>=3){var R=L[P-3];R.left===I?R.left=z:R.right=z}break}}else{var D=I.right;if(D&&D._color===e)z._color=a,I.right=t(a,D),I._color=e,P-=1;else{if(z.right=l.left,I._color=e,I.left=l.right,l._color=a,l.left=z,l.right=I,L[P-2]=l,L[P-1]=z,c(I),c(z),c(l),P>=3){var R=L[P-3];R.left===I?R.left=l:R.right=l}break}}else if(z.right===l){var D=I.left;if(D&&D._color===e)z._color=a,I.left=t(a,D),I._color=e,P-=1;else{if(I._color=e,I.right=z.left,z._color=a,z.left=I,L[P-2]=z,L[P-1]=l,c(I),c(z),P>=3){var R=L[P-3];R.right===I?R.right=z:R.left=z}break}}else{var D=I.left;if(D&&D._color===e)z._color=a,I.left=t(a,D),I._color=e,P-=1;else{if(z.left=l.right,I._color=e,I.right=l.left,l._color=a,l.right=z,l.left=I,L[P-2]=l,L[P-1]=z,c(I),c(z),c(l),P>=3){var R=L[P-3];R.right===I?R.right=l:R.left=l}break}}}return L[0]._color=a,new o(x,L[0])};function y(b,f){if(f.left){var x=y(b,f.left);if(x)return x}var x=b(f.key,f.value);if(x)return x;if(f.right)return y(b,f.right)}function p(b,f,x,l){var L=f(b,l.key);if(L<=0){if(l.left){var T=p(b,f,x,l.left);if(T)return T}var T=x(l.key,l.value);if(T)return T}if(l.right)return p(b,f,x,l.right)}function g(b,f,x,l,L){var T=x(b,L.key),k=x(f,L.key),P;if(T<=0&&(L.left&&(P=g(b,f,x,l,L.left),P)||k>0&&(P=l(L.key,L.value),P)))return P;if(k>0&&L.right)return g(b,f,x,l,L.right)}i.forEach=function(f,x,l){if(!!this.root)switch(arguments.length){case 1:return y(f,this.root);case 2:return p(x,this._compare,f,this.root);case 3:return this._compare(x,l)>=0?void 0:g(x,l,this._compare,f,this.root)}},Object.defineProperty(i,"begin",{get:function(){for(var b=[],f=this.root;f;)b.push(f),f=f.left;return new h(this,b)}}),Object.defineProperty(i,"end",{get:function(){for(var b=[],f=this.root;f;)b.push(f),f=f.right;return new h(this,b)}}),i.at=function(b){if(b<0)return new h(this,[]);for(var f=this.root,x=[];;){if(x.push(f),f.left){if(b<f.left._count){f=f.left;continue}b-=f.left._count}if(!b)return new h(this,x);if(b-=1,f.right){if(b>=f.right._count)break;f=f.right}else break}return new h(this,[])},i.ge=function(b){for(var f=this._compare,x=this.root,l=[],L=0;x;){var T=f(b,x.key);l.push(x),T<=0&&(L=l.length),T<=0?x=x.left:x=x.right}return l.length=L,new h(this,l)},i.gt=function(b){for(var f=this._compare,x=this.root,l=[],L=0;x;){var T=f(b,x.key);l.push(x),T<0&&(L=l.length),T<0?x=x.left:x=x.right}return l.length=L,new h(this,l)},i.lt=function(b){for(var f=this._compare,x=this.root,l=[],L=0;x;){var T=f(b,x.key);l.push(x),T>0&&(L=l.length),T<=0?x=x.left:x=x.right}return l.length=L,new h(this,l)},i.le=function(b){for(var f=this._compare,x=this.root,l=[],L=0;x;){var T=f(b,x.key);l.push(x),T>=0&&(L=l.length),T<0?x=x.left:x=x.right}return l.length=L,new h(this,l)},i.find=function(b){for(var f=this._compare,x=this.root,l=[];x;){var L=f(b,x.key);if(l.push(x),L===0)return new h(this,l);L<=0?x=x.left:x=x.right}return new h(this,[])},i.remove=function(b){var f=this.find(b);return f?f.remove():this},i.get=function(b){for(var f=this._compare,x=this.root;x;){var l=f(b,x.key);if(l===0)return x.value;l<=0?x=x.left:x=x.right}};function h(b,f){this.tree=b,this._stack=f}var m=h.prototype;Object.defineProperty(m,"valid",{get:function(){return this._stack.length>0}}),Object.defineProperty(m,"node",{get:function(){return this._stack.length>0?this._stack[this._stack.length-1]:null},enumerable:!0}),m.clone=function(){return new h(this.tree,this._stack.slice())};function u(b,f){b.key=f.key,b.value=f.value,b.left=f.left,b.right=f.right,b._color=f._color,b._count=f._count}function _(b){for(var f,x,l,L,T=b.length-1;T>=0;--T){if(f=b[T],T===0){f._color=a;return}if(x=b[T-1],x.left===f){if(l=x.right,l.right&&l.right._color===e){if(l=x.right=r(l),L=l.right=r(l.right),x.right=l.left,l.left=x,l.right=L,l._color=x._color,f._color=a,x._color=a,L._color=a,c(x),c(l),T>1){var k=b[T-2];k.left===x?k.left=l:k.right=l}b[T-1]=l;return}else if(l.left&&l.left._color===e){if(l=x.right=r(l),L=l.left=r(l.left),x.right=L.left,l.left=L.right,L.left=x,L.right=l,L._color=x._color,x._color=a,l._color=a,f._color=a,c(x),c(l),c(L),T>1){var k=b[T-2];k.left===x?k.left=L:k.right=L}b[T-1]=L;return}if(l._color===a)if(x._color===e){x._color=a,x.right=t(e,l);return}else{x.right=t(e,l);continue}else{if(l=r(l),x.right=l.left,l.left=x,l._color=x._color,x._color=e,c(x),c(l),T>1){var k=b[T-2];k.left===x?k.left=l:k.right=l}b[T-1]=l,b[T]=x,T+1<b.length?b[T+1]=f:b.push(f),T=T+2}}else{if(l=x.left,l.left&&l.left._color===e){if(l=x.left=r(l),L=l.left=r(l.left),x.left=l.right,l.right=x,l.left=L,l._color=x._color,f._color=a,x._color=a,L._color=a,c(x),c(l),T>1){var k=b[T-2];k.right===x?k.right=l:k.left=l}b[T-1]=l;return}else if(l.right&&l.right._color===e){if(l=x.left=r(l),L=l.right=r(l.right),x.left=L.right,l.right=L.left,L.right=x,L.left=l,L._color=x._color,x._color=a,l._color=a,f._color=a,c(x),c(l),c(L),T>1){var k=b[T-2];k.right===x?k.right=L:k.left=L}b[T-1]=L;return}if(l._color===a)if(x._color===e){x._color=a,x.left=t(e,l);return}else{x.left=t(e,l);continue}else{if(l=r(l),x.left=l.right,l.right=x,l._color=x._color,x._color=e,c(x),c(l),T>1){var k=b[T-2];k.right===x?k.right=l:k.left=l}b[T-1]=l,b[T]=x,T+1<b.length?b[T+1]=f:b.push(f),T=T+2}}}}m.remove=function(){var b=this._stack;if(b.length===0)return this.tree;var f=new Array(b.length),x=b[b.length-1];f[f.length-1]=new n(x._color,x.key,x.value,x.left,x.right,x._count);for(var l=b.length-2;l>=0;--l){var x=b[l];x.left===b[l+1]?f[l]=new n(x._color,x.key,x.value,f[l+1],x.right,x._count):f[l]=new n(x._color,x.key,x.value,x.left,f[l+1],x._count)}if(x=f[f.length-1],x.left&&x.right){var L=f.length;for(x=x.left;x.right;)f.push(x),x=x.right;var T=f[L-1];f.push(new n(x._color,T.key,T.value,x.left,x.right,x._count)),f[L-1].key=x.key,f[L-1].value=x.value;for(var l=f.length-2;l>=L;--l)x=f[l],f[l]=new n(x._color,x.key,x.value,x.left,f[l+1],x._count);f[L-1].left=f[L]}if(x=f[f.length-1],x._color===e){var k=f[f.length-2];k.left===x?k.left=null:k.right===x&&(k.right=null),f.pop();for(var l=0;l<f.length;++l)f[l]._count--;return new o(this.tree._compare,f[0])}else if(x.left||x.right){x.left?u(x,x.left):x.right&&u(x,x.right),x._color=a;for(var l=0;l<f.length-1;++l)f[l]._count--;return new o(this.tree._compare,f[0])}else{if(f.length===1)return new o(this.tree._compare,null);for(var l=0;l<f.length;++l)f[l]._count--;var P=f[f.length-2];_(f),P.left===x?P.left=null:P.right=null}return new o(this.tree._compare,f[0])},Object.defineProperty(m,"key",{get:function(){if(this._stack.length>0)return this._stack[this._stack.length-1].key},enumerable:!0}),Object.defineProperty(m,"value",{get:function(){if(this._stack.length>0)return this._stack[this._stack.length-1].value},enumerable:!0}),Object.defineProperty(m,"index",{get:function(){var b=0,f=this._stack;if(f.length===0){var x=this.tree.root;return x?x._count:0}else f[f.length-1].left&&(b=f[f.length-1].left._count);for(var l=f.length-2;l>=0;--l)f[l+1]===f[l].right&&(++b,f[l].left&&(b+=f[l].left._count));return b},enumerable:!0}),m.next=function(){var b=this._stack;if(b.length!==0){var f=b[b.length-1];if(f.right)for(f=f.right;f;)b.push(f),f=f.left;else for(b.pop();b.length>0&&b[b.length-1].right===f;)f=b[b.length-1],b.pop()}},Object.defineProperty(m,"hasNext",{get:function(){var b=this._stack;if(b.length===0)return!1;if(b[b.length-1].right)return!0;for(var f=b.length-1;f>0;--f)if(b[f-1].left===b[f])return!0;return!1}}),m.update=function(b){var f=this._stack;if(f.length===0)throw new Error("Can't update empty node!");var x=new Array(f.length),l=f[f.length-1];x[x.length-1]=new n(l._color,l.key,b,l.left,l.right,l._count);for(var L=f.length-2;L>=0;--L)l=f[L],l.left===f[L+1]?x[L]=new n(l._color,l.key,l.value,x[L+1],l.right,l._count):x[L]=new n(l._color,l.key,l.value,l.left,x[L+1],l._count);return new o(this.tree._compare,x[0])},m.prev=function(){var b=this._stack;if(b.length!==0){var f=b[b.length-1];if(f.left)for(f=f.left;f;)b.push(f),f=f.right;else for(b.pop();b.length>0&&b[b.length-1].left===f;)f=b[b.length-1],b.pop()}},Object.defineProperty(m,"hasPrev",{get:function(){var b=this._stack;if(b.length===0)return!1;if(b[b.length-1].left)return!0;for(var f=b.length-1;f>0;--f)if(b[f-1].right===b[f])return!0;return!1}});function s(b,f){return b<f?-1:b>f?1:0}function A(b){return new o(b||s,null)}},{}],70:[function(v,S,M){S.exports=f;var e=v("./lib/text.js"),a=v("./lib/lines.js"),n=v("./lib/background.js"),r=v("./lib/cube.js"),t=v("./lib/ticks.js"),c=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);function o(x,l){return x[0]=l[0],x[1]=l[1],x[2]=l[2],x}function i(x){this.gl=x,this.pixelRatio=1,this.bounds=[[-10,-10,-10],[10,10,10]],this.ticks=[[],[],[]],this.autoTicks=!0,this.tickSpacing=[1,1,1],this.tickEnable=[!0,!0,!0],this.tickFont=["sans-serif","sans-serif","sans-serif"],this.tickSize=[12,12,12],this.tickAngle=[0,0,0],this.tickAlign=["auto","auto","auto"],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickPad=[10,10,10],this.lastCubeProps={cubeEdges:[0,0,0],axis:[0,0,0]},this.labels=["x","y","z"],this.labelEnable=[!0,!0,!0],this.labelFont="sans-serif",this.labelSize=[20,20,20],this.labelAngle=[0,0,0],this.labelAlign=["auto","auto","auto"],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labelPad=[10,10,10],this.lineEnable=[!0,!0,!0],this.lineMirror=[!1,!1,!1],this.lineWidth=[1,1,1],this.lineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.lineTickEnable=[!0,!0,!0],this.lineTickMirror=[!1,!1,!1],this.lineTickLength=[0,0,0],this.lineTickWidth=[1,1,1],this.lineTickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.gridEnable=[!0,!0,!0],this.gridWidth=[1,1,1],this.gridColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroEnable=[!0,!0,!0],this.zeroLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroLineWidth=[2,2,2],this.backgroundEnable=[!1,!1,!1],this.backgroundColor=[[.8,.8,.8,.5],[.8,.8,.8,.5],[.8,.8,.8,.5]],this._firstInit=!0,this._text=null,this._lines=null,this._background=n(x)}var y=i.prototype;y.update=function(x){x=x||{};function l(G,J,X){if(X in x){var Y=x[X],Z=this[X],oe;(G?Array.isArray(Y)&&Array.isArray(Y[0]):Array.isArray(Y))?this[X]=oe=[J(Y[0]),J(Y[1]),J(Y[2])]:this[X]=oe=[J(Y),J(Y),J(Y)];for(var re=0;re<3;++re)if(oe[re]!==Z[re])return!0}return!1}var L=l.bind(this,!1,Number),T=l.bind(this,!1,Boolean),k=l.bind(this,!1,String),P=l.bind(this,!0,function(G){if(Array.isArray(G)){if(G.length===3)return[+G[0],+G[1],+G[2],1];if(G.length===4)return[+G[0],+G[1],+G[2],+G[3]]}return[0,0,0,1]}),z,I=!1,D=!1;if("bounds"in x)for(var R=x.bounds,B=0;B<2;++B)for(var F=0;F<3;++F)R[B][F]!==this.bounds[B][F]&&(D=!0),this.bounds[B][F]=R[B][F];if("ticks"in x){z=x.ticks,I=!0,this.autoTicks=!1;for(var B=0;B<3;++B)this.tickSpacing[B]=0}else L("tickSpacing")&&(this.autoTicks=!0,D=!0);if(this._firstInit&&("ticks"in x||"tickSpacing"in x||(this.autoTicks=!0),D=!0,I=!0,this._firstInit=!1),D&&this.autoTicks&&(z=t.create(this.bounds,this.tickSpacing),I=!0),I){for(var B=0;B<3;++B)z[B].sort(function(J,X){return J.x-X.x});t.equal(z,this.ticks)?I=!1:this.ticks=z}T("tickEnable"),k("tickFont")&&(I=!0),L("tickSize"),L("tickAngle"),L("tickPad"),P("tickColor");var H=k("labels");k("labelFont")&&(H=!0),T("labelEnable"),L("labelSize"),L("labelPad"),P("labelColor"),T("lineEnable"),T("lineMirror"),L("lineWidth"),P("lineColor"),T("lineTickEnable"),T("lineTickMirror"),L("lineTickLength"),L("lineTickWidth"),P("lineTickColor"),T("gridEnable"),L("gridWidth"),P("gridColor"),T("zeroEnable"),P("zeroLineColor"),L("zeroLineWidth"),T("backgroundEnable"),P("backgroundColor"),this._text?this._text&&(H||I)&&this._text.update(this.bounds,this.labels,this.labelFont,this.ticks,this.tickFont):this._text=e(this.gl,this.bounds,this.labels,this.labelFont,this.ticks,this.tickFont),this._lines&&I&&(this._lines.dispose(),this._lines=null),this._lines||(this._lines=a(this.gl,this.bounds,this.ticks))};function p(){this.primalOffset=[0,0,0],this.primalMinor=[0,0,0],this.mirrorOffset=[0,0,0],this.mirrorMinor=[0,0,0]}var g=[new p,new p,new p];function h(x,l,L,T,k){for(var P=x.primalOffset,z=x.primalMinor,I=x.mirrorOffset,D=x.mirrorMinor,R=T[l],B=0;B<3;++B)if(l!==B){var F=P,H=I,G=z,J=D;R&1<<B&&(F=I,H=P,G=D,J=z),F[B]=L[0][B],H[B]=L[1][B],k[B]>0?(G[B]=-1,J[B]=0):(G[B]=0,J[B]=1)}}var m=[0,0,0],u={model:c,view:c,projection:c,_ortho:!1};y.isOpaque=function(){return!0},y.isTransparent=function(){return!1},y.drawTransparent=function(x){};var _=0,s=[0,0,0],A=[0,0,0],b=[0,0,0];y.draw=function(x){x=x||u;for(var Z=this.gl,l=x.model||c,L=x.view||c,T=x.projection||c,k=this.bounds,P=x._ortho||!1,z=r(l,L,T,k,P),I=z.cubeEdges,D=z.axis,R=L[12],B=L[13],F=L[14],H=L[15],G=P?2:1,J=G*this.pixelRatio*(T[3]*R+T[7]*B+T[11]*F+T[15]*H)/Z.drawingBufferHeight,X=0;X<3;++X)this.lastCubeProps.cubeEdges[X]=I[X],this.lastCubeProps.axis[X]=D[X];for(var Y=g,X=0;X<3;++X)h(g[X],X,this.bounds,I,D);for(var Z=this.gl,oe=m,X=0;X<3;++X)this.backgroundEnable[X]?oe[X]=D[X]:oe[X]=0;this._background.draw(l,L,T,k,oe,this.backgroundColor),this._lines.bind(l,L,T,this);for(var X=0;X<3;++X){var re=[0,0,0];D[X]>0?re[X]=k[1][X]:re[X]=k[0][X];for(var se=0;se<2;++se){var N=(X+1+se)%3,U=(X+1+(se^1))%3;this.gridEnable[N]&&this._lines.drawGrid(N,U,this.bounds,re,this.gridColor[N],this.gridWidth[N]*this.pixelRatio)}for(var se=0;se<2;++se){var N=(X+1+se)%3,U=(X+1+(se^1))%3;this.zeroEnable[U]&&Math.min(k[0][U],k[1][U])<=0&&Math.max(k[0][U],k[1][U])>=0&&this._lines.drawZero(N,U,this.bounds,re,this.zeroLineColor[U],this.zeroLineWidth[U]*this.pixelRatio)}}for(var X=0;X<3;++X){this.lineEnable[X]&&this._lines.drawAxisLine(X,this.bounds,Y[X].primalOffset,this.lineColor[X],this.lineWidth[X]*this.pixelRatio),this.lineMirror[X]&&this._lines.drawAxisLine(X,this.bounds,Y[X].mirrorOffset,this.lineColor[X],this.lineWidth[X]*this.pixelRatio);for(var q=o(s,Y[X].primalMinor),$=o(A,Y[X].mirrorMinor),W=this.lineTickLength,se=0;se<3;++se){var K=J/l[5*se];q[se]*=W[se]*K,$[se]*=W[se]*K}this.lineTickEnable[X]&&this._lines.drawAxisTicks(X,Y[X].primalOffset,q,this.lineTickColor[X],this.lineTickWidth[X]*this.pixelRatio),this.lineTickMirror[X]&&this._lines.drawAxisTicks(X,Y[X].mirrorOffset,$,this.lineTickColor[X],this.lineTickWidth[X]*this.pixelRatio)}this._lines.unbind(),this._text.bind(l,L,T,this.pixelRatio);var ne,ae=.5,ie,le;function ye(ze){le=[0,0,0],le[ze]=1}function ue(ze,Oe,Ye){var be=(ze+1)%3,Pe=(ze+2)%3,Ge=Oe[be],Qe=Oe[Pe],Be=Ye[be],Le=Ye[Pe];if(Ge>0&&Le>0){ye(be);return}else if(Ge>0&&Le<0){ye(be);return}else if(Ge<0&&Le>0){ye(be);return}else if(Ge<0&&Le<0){ye(be);return}else if(Qe>0&&Be>0){ye(Pe);return}else if(Qe>0&&Be<0){ye(Pe);return}else if(Qe<0&&Be>0){ye(Pe);return}else if(Qe<0&&Be<0){ye(Pe);return}}for(var X=0;X<3;++X){for(var pe=Y[X].primalMinor,ge=Y[X].mirrorMinor,Te=o(b,Y[X].primalOffset),se=0;se<3;++se)this.lineTickEnable[X]&&(Te[se]+=J*pe[se]*Math.max(this.lineTickLength[se],0)/l[5*se]);var _e=[0,0,0];if(_e[X]=1,this.tickEnable[X]){this.tickAngle[X]===-3600?(this.tickAngle[X]=0,this.tickAlign[X]="auto"):this.tickAlign[X]=-1,ie=1,ne=[this.tickAlign[X],ae,ie],ne[0]==="auto"?ne[0]=_:ne[0]=parseInt(""+ne[0]),le=[0,0,0],ue(X,pe,ge);for(var se=0;se<3;++se)Te[se]+=J*pe[se]*this.tickPad[se]/l[5*se];this._text.drawTicks(X,this.tickSize[X],this.tickAngle[X],Te,this.tickColor[X],_e,le,ne)}if(this.labelEnable[X]){ie=0,le=[0,0,0],this.labels[X].length>4&&(ye(X),ie=1),ne=[this.labelAlign[X],ae,ie],ne[0]==="auto"?ne[0]=_:ne[0]=parseInt(""+ne[0]);for(var se=0;se<3;++se)Te[se]+=J*pe[se]*this.labelPad[se]/l[5*se];Te[X]+=.5*(k[0][X]+k[1][X]),this._text.drawLabel(X,this.labelSize[X],this.labelAngle[X],Te,this.labelColor[X],[0,0,0],le,ne)}}this._text.unbind()},y.dispose=function(){this._text.dispose(),this._lines.dispose(),this._background.dispose(),this._lines=null,this._text=null,this._background=null,this.gl=null};function f(x,l){var L=new i(x);return L.update(l),L}},{"./lib/background.js":71,"./lib/cube.js":72,"./lib/lines.js":73,"./lib/text.js":75,"./lib/ticks.js":76}],71:[function(v,S,M){S.exports=c;var e=v("gl-buffer"),a=v("gl-vao"),n=v("./shaders").bg;function r(o,i,y,p){this.gl=o,this.buffer=i,this.vao=y,this.shader=p}var t=r.prototype;t.draw=function(o,i,y,p,g,h){for(var m=!1,u=0;u<3;++u)m=m||g[u];if(!!m){var _=this.gl;_.enable(_.POLYGON_OFFSET_FILL),_.polygonOffset(1,2),this.shader.bind(),this.shader.uniforms={model:o,view:i,projection:y,bounds:p,enable:g,colors:h},this.vao.bind(),this.vao.draw(this.gl.TRIANGLES,36),this.vao.unbind(),_.disable(_.POLYGON_OFFSET_FILL)}},t.dispose=function(){this.vao.dispose(),this.buffer.dispose(),this.shader.dispose()};function c(o){for(var i=[],y=[],p=0,g=0;g<3;++g)for(var h=(g+1)%3,m=(g+2)%3,u=[0,0,0],_=[0,0,0],s=-1;s<=1;s+=2){y.push(p,p+2,p+1,p+1,p+2,p+3),u[g]=s,_[g]=s;for(var A=-1;A<=1;A+=2){u[h]=A;for(var b=-1;b<=1;b+=2)u[m]=b,i.push(u[0],u[1],u[2],_[0],_[1],_[2]),p+=1}var f=h;h=m,m=f}var x=e(o,new Float32Array(i)),l=e(o,new Uint16Array(y),o.ELEMENT_ARRAY_BUFFER),L=a(o,[{buffer:x,type:o.FLOAT,size:3,offset:0,stride:24},{buffer:x,type:o.FLOAT,size:3,offset:12,stride:24}],l),T=n(o);return T.attributes.position.location=0,T.attributes.normal.location=1,new r(o,x,L,T)}},{"./shaders":74,"gl-buffer":78,"gl-vao":150}],72:[function(v,S,M){S.exports=s;var e=v("bit-twiddle"),a=v("gl-mat4/multiply"),n=v("split-polygon"),r=v("robust-orientation"),t=new Array(16),c=new Array(8),o=new Array(8),i=new Array(3),y=[0,0,0];(function(){for(var A=0;A<8;++A)c[A]=[1,1,1,1],o[A]=[1,1,1]})();function p(A,b,f){for(var x=0;x<4;++x){A[x]=f[12+x];for(var l=0;l<3;++l)A[x]+=b[l]*f[4*l+x]}}var g=[[0,0,1,0,0],[0,0,-1,1,0],[0,-1,0,1,0],[0,1,0,1,0],[-1,0,0,1,0],[1,0,0,1,0]];function h(A){for(var b=0;b<g.length;++b)if(A=n.positive(A,g[b]),A.length<3)return 0;for(var f=A[0],x=f[0]/f[3],l=f[1]/f[3],L=0,b=1;b+1<A.length;++b){var T=A[b],k=A[b+1],P=T[0]/T[3],z=T[1]/T[3],I=k[0]/k[3],D=k[1]/k[3],R=P-x,B=z-l,F=I-x,H=D-l;L+=Math.abs(R*H-B*F)}return L}var m=[1,1,1],u=[0,0,0],_={cubeEdges:m,axis:u};function s(A,b,f,x,l){a(t,b,A),a(t,f,t);for(var L=0,T=0;T<2;++T){i[2]=x[T][2];for(var k=0;k<2;++k){i[1]=x[k][1];for(var P=0;P<2;++P)i[0]=x[P][0],p(c[L],i,t),L+=1}}for(var z=-1,T=0;T<8;++T){for(var I=c[T][3],D=0;D<3;++D)o[T][D]=c[T][D]/I;l&&(o[T][2]*=-1),I<0&&(z<0||o[T][2]<o[z][2])&&(z=T)}if(z<0){z=0;for(var R=0;R<3;++R){for(var B=(R+2)%3,F=(R+1)%3,H=-1,G=-1,J=0;J<2;++J){var X=J<<R,Y=X+(J<<B)+(1-J<<F),Z=X+(1-J<<B)+(J<<F);r(o[X],o[Y],o[Z],y)<0||(J?H=1:G=1)}if(H<0||G<0){G>H&&(z|=1<<R);continue}for(var J=0;J<2;++J){var X=J<<R,Y=X+(J<<B)+(1-J<<F),Z=X+(1-J<<B)+(J<<F),oe=h([c[X],c[Y],c[Z],c[X+(1<<B)+(1<<F)]]);J?H=oe:G=oe}if(G>H){z|=1<<R;continue}}}for(var re=7^z,se=-1,T=0;T<8;++T)T===z||T===re||(se<0||o[se][1]>o[T][1])&&(se=T);for(var N=-1,T=0;T<3;++T){var U=se^1<<T;if(!(U===z||U===re)){N<0&&(N=U);var F=o[U];F[0]<o[N][0]&&(N=U)}}for(var q=-1,T=0;T<3;++T){var U=se^1<<T;if(!(U===z||U===re||U===N)){q<0&&(q=U);var F=o[U];F[0]>o[q][0]&&(q=U)}}var $=m;$[0]=$[1]=$[2]=0,$[e.log2(N^se)]=se&N,$[e.log2(se^q)]=se&q;var W=q^7;W===z||W===re?(W=N^7,$[e.log2(q^W)]=W&q):$[e.log2(N^W)]=W&N;for(var K=u,ne=z,R=0;R<3;++R)ne&1<<R?K[R]=-1:K[R]=1;return _}},{"bit-twiddle":32,"gl-mat4/multiply":100,"robust-orientation":284,"split-polygon":300}],73:[function(v,S,M){S.exports=m;var e=v("gl-buffer"),a=v("gl-vao"),n=v("./shaders").line,r=[0,0,0],t=[0,0,0],c=[0,0,0],o=[0,0,0],i=[1,1];function y(u){return u[0]=u[1]=u[2]=0,u}function p(u,_){return u[0]=_[0],u[1]=_[1],u[2]=_[2],u}function g(u,_,s,A,b,f,x,l){this.gl=u,this.vertBuffer=_,this.vao=s,this.shader=A,this.tickCount=b,this.tickOffset=f,this.gridCount=x,this.gridOffset=l}var h=g.prototype;h.bind=function(u,_,s){this.shader.bind(),this.shader.uniforms.model=u,this.shader.uniforms.view=_,this.shader.uniforms.projection=s,i[0]=this.gl.drawingBufferWidth,i[1]=this.gl.drawingBufferHeight,this.shader.uniforms.screenShape=i,this.vao.bind()},h.unbind=function(){this.vao.unbind()},h.drawAxisLine=function(u,_,s,A,b){var f=y(t);this.shader.uniforms.majorAxis=t,f[u]=_[1][u]-_[0][u],this.shader.uniforms.minorAxis=f;var x=p(o,s);x[u]+=_[0][u],this.shader.uniforms.offset=x,this.shader.uniforms.lineWidth=b,this.shader.uniforms.color=A;var l=y(c);l[(u+2)%3]=1,this.shader.uniforms.screenAxis=l,this.vao.draw(this.gl.TRIANGLES,6);var l=y(c);l[(u+1)%3]=1,this.shader.uniforms.screenAxis=l,this.vao.draw(this.gl.TRIANGLES,6)},h.drawAxisTicks=function(u,_,s,A,b){if(!!this.tickCount[u]){var f=y(r);f[u]=1,this.shader.uniforms.majorAxis=f,this.shader.uniforms.offset=_,this.shader.uniforms.minorAxis=s,this.shader.uniforms.color=A,this.shader.uniforms.lineWidth=b;var x=y(c);x[u]=1,this.shader.uniforms.screenAxis=x,this.vao.draw(this.gl.TRIANGLES,this.tickCount[u],this.tickOffset[u])}},h.drawGrid=function(u,_,s,A,b,f){if(!!this.gridCount[u]){var x=y(t);x[_]=s[1][_]-s[0][_],this.shader.uniforms.minorAxis=x;var l=p(o,A);l[_]+=s[0][_],this.shader.uniforms.offset=l;var L=y(r);L[u]=1,this.shader.uniforms.majorAxis=L;var T=y(c);T[u]=1,this.shader.uniforms.screenAxis=T,this.shader.uniforms.lineWidth=f,this.shader.uniforms.color=b,this.vao.draw(this.gl.TRIANGLES,this.gridCount[u],this.gridOffset[u])}},h.drawZero=function(u,_,s,A,b,f){var x=y(t);this.shader.uniforms.majorAxis=x,x[u]=s[1][u]-s[0][u],this.shader.uniforms.minorAxis=x;var l=p(o,A);l[u]+=s[0][u],this.shader.uniforms.offset=l;var L=y(c);L[_]=1,this.shader.uniforms.screenAxis=L,this.shader.uniforms.lineWidth=f,this.shader.uniforms.color=b,this.vao.draw(this.gl.TRIANGLES,6)},h.dispose=function(){this.vao.dispose(),this.vertBuffer.dispose(),this.shader.dispose()};function m(u,_,s){var A=[],b=[0,0,0],f=[0,0,0],x=[0,0,0],l=[0,0,0];A.push(0,0,1,0,1,1,0,0,-1,0,0,-1,0,1,1,0,1,-1);for(var L=0;L<3;++L){for(var P=A.length/3|0,T=0;T<s[L].length;++T){var k=+s[L][T].x;A.push(k,0,1,k,1,1,k,0,-1,k,0,-1,k,1,1,k,1,-1)}var I=A.length/3|0;b[L]=P,f[L]=I-P;for(var P=A.length/3|0,z=0;z<s[L].length;++z){var k=+s[L][z].x;A.push(k,0,1,k,1,1,k,0,-1,k,0,-1,k,1,1,k,1,-1)}var I=A.length/3|0;x[L]=P,l[L]=I-P}var D=e(u,new Float32Array(A)),R=a(u,[{buffer:D,type:u.FLOAT,size:3,stride:0,offset:0}]),B=n(u);return B.attributes.position.location=0,new g(u,D,R,B,f,b,l,x)}},{"./shaders":74,"gl-buffer":78,"gl-vao":150}],74:[function(v,S,M){var e=v("glslify"),a=v("gl-shader"),n=e([`precision highp float;
#define GLSLIFY 1

attribute vec3 position;

uniform mat4 model, view, projection;
uniform vec3 offset, majorAxis, minorAxis, screenAxis;
uniform float lineWidth;
uniform vec2 screenShape;

vec3 project(vec3 p) {
  vec4 pp = projection * view * model * vec4(p, 1.0);
  return pp.xyz / max(pp.w, 0.0001);
}

void main() {
  vec3 major = position.x * majorAxis;
  vec3 minor = position.y * minorAxis;

  vec3 vPosition = major + minor + offset;
  vec3 pPosition = project(vPosition);
  vec3 offset = project(vPosition + screenAxis * position.z);

  vec2 screen = normalize((offset - pPosition).xy * screenShape) / screenShape;

  gl_Position = vec4(pPosition + vec3(0.5 * screen * lineWidth, 0), 1.0);
}
`]),r=e([`precision highp float;
#define GLSLIFY 1

uniform vec4 color;
void main() {
  gl_FragColor = color;
}`]);M.line=function(y){return a(y,n,r,null,[{name:"position",type:"vec3"}])};var t=e([`precision highp float;
#define GLSLIFY 1

attribute vec3 position;

uniform mat4 model, view, projection;
uniform vec3 offset, axis, alignDir, alignOpt;
uniform float scale, angle, pixelScale;
uniform vec2 resolution;

vec3 project(vec3 p) {
  vec4 pp = projection * view * model * vec4(p, 1.0);
  return pp.xyz / max(pp.w, 0.0001);
}

float computeViewAngle(vec3 a, vec3 b) {
  vec3 A = project(a);
  vec3 B = project(b);

  return atan(
    (B.y - A.y) * resolution.y,
    (B.x - A.x) * resolution.x
  );
}

const float PI = 3.141592;
const float TWO_PI = 2.0 * PI;
const float HALF_PI = 0.5 * PI;
const float ONE_AND_HALF_PI = 1.5 * PI;

int option = int(floor(alignOpt.x + 0.001));
float hv_ratio =       alignOpt.y;
bool enableAlign =    (alignOpt.z != 0.0);

float mod_angle(float a) {
  return mod(a, PI);
}

float positive_angle(float a) {
  return mod_angle((a < 0.0) ?
    a + TWO_PI :
    a
  );
}

float look_upwards(float a) {
  float b = positive_angle(a);
  return ((b > HALF_PI) && (b <= ONE_AND_HALF_PI)) ?
    b - PI :
    b;
}

float look_horizontal_or_vertical(float a, float ratio) {
  // ratio controls the ratio between being horizontal to (vertical + horizontal)
  // if ratio is set to 0.5 then it is 50%, 50%.
  // when using a higher ratio e.g. 0.75 the result would
  // likely be more horizontal than vertical.

  float b = positive_angle(a);

  return
    (b < (      ratio) * HALF_PI) ? 0.0 :
    (b < (2.0 - ratio) * HALF_PI) ? -HALF_PI :
    (b < (2.0 + ratio) * HALF_PI) ? 0.0 :
    (b < (4.0 - ratio) * HALF_PI) ? HALF_PI :
                                    0.0;
}

float roundTo(float a, float b) {
  return float(b * floor((a + 0.5 * b) / b));
}

float look_round_n_directions(float a, int n) {
  float b = positive_angle(a);
  float div = TWO_PI / float(n);
  float c = roundTo(b, div);
  return look_upwards(c);
}

float applyAlignOption(float rawAngle, float delta) {
  return
    (option >  2) ? look_round_n_directions(rawAngle + delta, option) :       // option 3-n: round to n directions
    (option == 2) ? look_horizontal_or_vertical(rawAngle + delta, hv_ratio) : // horizontal or vertical
    (option == 1) ? rawAngle + delta :       // use free angle, and flip to align with one direction of the axis
    (option == 0) ? look_upwards(rawAngle) : // use free angle, and stay upwards
    (option ==-1) ? 0.0 :                    // useful for backward compatibility, all texts remains horizontal
                    rawAngle;                // otherwise return back raw input angle
}

bool isAxisTitle = (axis.x == 0.0) &&
                   (axis.y == 0.0) &&
                   (axis.z == 0.0);

void main() {
  //Compute world offset
  float axisDistance = position.z;
  vec3 dataPosition = axisDistance * axis + offset;

  float beta = angle; // i.e. user defined attributes for each tick

  float axisAngle;
  float clipAngle;
  float flip;

  if (enableAlign) {
    axisAngle = (isAxisTitle) ? HALF_PI :
                      computeViewAngle(dataPosition, dataPosition + axis);
    clipAngle = computeViewAngle(dataPosition, dataPosition + alignDir);

    axisAngle += (sin(axisAngle) < 0.0) ? PI : 0.0;
    clipAngle += (sin(clipAngle) < 0.0) ? PI : 0.0;

    flip = (dot(vec2(cos(axisAngle), sin(axisAngle)),
                vec2(sin(clipAngle),-cos(clipAngle))) > 0.0) ? 1.0 : 0.0;

    beta += applyAlignOption(clipAngle, flip * PI);
  }

  //Compute plane offset
  vec2 planeCoord = position.xy * pixelScale;

  mat2 planeXform = scale * mat2(
     cos(beta), sin(beta),
    -sin(beta), cos(beta)
  );

  vec2 viewOffset = 2.0 * planeXform * planeCoord / resolution;

  //Compute clip position
  vec3 clipPosition = project(dataPosition);

  //Apply text offset in clip coordinates
  clipPosition += vec3(viewOffset, 0.0);

  //Done
  gl_Position = vec4(clipPosition, 1.0);
}`]),c=e([`precision highp float;
#define GLSLIFY 1

uniform vec4 color;
void main() {
  gl_FragColor = color;
}`]);M.text=function(y){return a(y,t,c,null,[{name:"position",type:"vec3"}])};var o=e([`precision highp float;
#define GLSLIFY 1

attribute vec3 position;
attribute vec3 normal;

uniform mat4 model, view, projection;
uniform vec3 enable;
uniform vec3 bounds[2];

varying vec3 colorChannel;

void main() {

  vec3 signAxis = sign(bounds[1] - bounds[0]);

  vec3 realNormal = signAxis * normal;

  if(dot(realNormal, enable) > 0.0) {
    vec3 minRange = min(bounds[0], bounds[1]);
    vec3 maxRange = max(bounds[0], bounds[1]);
    vec3 nPosition = mix(minRange, maxRange, 0.5 * (position + 1.0));
    gl_Position = projection * view * model * vec4(nPosition, 1.0);
  } else {
    gl_Position = vec4(0,0,0,0);
  }

  colorChannel = abs(realNormal);
}`]),i=e([`precision highp float;
#define GLSLIFY 1

uniform vec4 colors[3];

varying vec3 colorChannel;

void main() {
  gl_FragColor = colorChannel.x * colors[0] +
                 colorChannel.y * colors[1] +
                 colorChannel.z * colors[2];
}`]);M.bg=function(y){return a(y,o,i,null,[{name:"position",type:"vec3"},{name:"normal",type:"vec3"}])}},{"gl-shader":132,glslify:231}],75:[function(v,S,M){(function(e){(function(){S.exports=m;var a=v("gl-buffer"),n=v("gl-vao"),r=v("vectorize-text"),t=v("./shaders").text,c=window||e.global||{},o=c.__TEXT_CACHE||{};c.__TEXT_CACHE={};var i=3;function y(u,_,s,A){this.gl=u,this.shader=_,this.buffer=s,this.vao=A,this.tickOffset=this.tickCount=this.labelOffset=this.labelCount=null}var p=y.prototype,g=[0,0];p.bind=function(u,_,s,A){this.vao.bind(),this.shader.bind();var b=this.shader.uniforms;b.model=u,b.view=_,b.projection=s,b.pixelScale=A,g[0]=this.gl.drawingBufferWidth,g[1]=this.gl.drawingBufferHeight,this.shader.uniforms.resolution=g},p.unbind=function(){this.vao.unbind()},p.update=function(u,_,s,A,b){var f=[];function x(R,B,F,H,G,J){var X=o[F];X||(X=o[F]={});var Y=X[B];Y||(Y=X[B]=h(B,{triangles:!0,font:F,textAlign:"center",textBaseline:"middle",lineSpacing:G,styletags:J}));for(var Z=(H||12)/12,oe=Y.positions,re=Y.cells,se=0,N=re.length;se<N;++se)for(var U=re[se],q=2;q>=0;--q){var $=oe[U[q]];f.push(Z*$[0],-Z*$[1],R)}}for(var l=[0,0,0],L=[0,0,0],T=[0,0,0],k=[0,0,0],P=1.25,z={breaklines:!0,bolds:!0,italics:!0,subscripts:!0,superscripts:!0},I=0;I<3;++I){T[I]=f.length/i|0,x(.5*(u[0][I]+u[1][I]),_[I],s[I],12,P,z),k[I]=(f.length/i|0)-T[I],l[I]=f.length/i|0;for(var D=0;D<A[I].length;++D)!A[I][D].text||x(A[I][D].x,A[I][D].text,A[I][D].font||b,A[I][D].fontSize||12,P,z);L[I]=(f.length/i|0)-l[I]}this.buffer.update(f),this.tickOffset=l,this.tickCount=L,this.labelOffset=T,this.labelCount=k},p.drawTicks=function(u,_,s,A,b,f,x,l){!this.tickCount[u]||(this.shader.uniforms.axis=f,this.shader.uniforms.color=b,this.shader.uniforms.angle=s,this.shader.uniforms.scale=_,this.shader.uniforms.offset=A,this.shader.uniforms.alignDir=x,this.shader.uniforms.alignOpt=l,this.vao.draw(this.gl.TRIANGLES,this.tickCount[u],this.tickOffset[u]))},p.drawLabel=function(u,_,s,A,b,f,x,l){!this.labelCount[u]||(this.shader.uniforms.axis=f,this.shader.uniforms.color=b,this.shader.uniforms.angle=s,this.shader.uniforms.scale=_,this.shader.uniforms.offset=A,this.shader.uniforms.alignDir=x,this.shader.uniforms.alignOpt=l,this.vao.draw(this.gl.TRIANGLES,this.labelCount[u],this.labelOffset[u]))},p.dispose=function(){this.shader.dispose(),this.vao.dispose(),this.buffer.dispose()};function h(u,_){try{return r(u,_)}catch(s){return console.warn('error vectorizing text:"'+u+'" error:',s),{cells:[],positions:[]}}}function m(u,_,s,A,b,f){var x=a(u),l=n(u,[{buffer:x,size:3}]),L=t(u);L.attributes.position.location=0;var T=new y(u,L,x,l);return T.update(_,s,A,b,f),T}}).call(this)}).call(this,v("_process"))},{"./shaders":74,_process:5,"gl-buffer":78,"gl-vao":150,"vectorize-text":311}],76:[function(v,S,M){M.create=a,M.equal=n;function e(r,t){var c=r+"",o=c.indexOf("."),i=0;o>=0&&(i=c.length-o-1);var y=Math.pow(10,i),p=Math.round(r*t*y),g=p+"";if(g.indexOf("e")>=0)return g;var h=p/y,m=p%y;p<0?(h=-Math.ceil(h)|0,m=-m|0):(h=Math.floor(h)|0,m=m|0);var u=""+h;if(p<0&&(u="-"+u),i){for(var _=""+m;_.length<i;)_="0"+_;return u+"."+_}else return u}function a(r,t){for(var c=[],o=0;o<3;++o){var i=[];.5*(r[0][o]+r[1][o]);for(var y=0;y*t[o]<=r[1][o];++y)i.push({x:y*t[o],text:e(t[o],y)});for(var y=-1;y*t[o]>=r[0][o];--y)i.push({x:y*t[o],text:e(t[o],y)});c.push(i)}return c}function n(r,t){for(var c=0;c<3;++c){if(r[c].length!==t[c].length)return!1;for(var o=0;o<r[c].length;++o){var i=r[c][o],y=t[c][o];if(i.x!==y.x||i.text!==y.text||i.font!==y.font||i.fontColor!==y.fontColor||i.fontSize!==y.fontSize||i.dx!==y.dx||i.dy!==y.dy)return!1}}return!0}},{}],77:[function(v,S,M){S.exports=_;var e=v("extract-frustum-planes"),a=v("split-polygon"),n=v("./lib/cube.js"),r=v("gl-mat4/multiply"),t=v("gl-mat4/transpose"),c=v("gl-vec4/transformMat4"),o=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),i=new Float32Array(16);function y(s,A,b){this.lo=s,this.hi=A,this.pixelsPerDataUnit=b}var p=[0,0,0,1],g=[0,0,0,1];function h(s,A,b,f,x){for(var l=0;l<3;++l){for(var L=p,T=g,k=0;k<3;++k)T[k]=L[k]=b[k];T[3]=L[3]=1,T[l]+=1,c(T,T,A),T[3]<0&&(s[l]=1/0),L[l]-=1,c(L,L,A),L[3]<0&&(s[l]=1/0);var P=(L[0]/L[3]-T[0]/T[3])*f,z=(L[1]/L[3]-T[1]/T[3])*x;s[l]=.25*Math.sqrt(P*P+z*z)}return s}var m=[new y(1/0,-1/0,1/0),new y(1/0,-1/0,1/0),new y(1/0,-1/0,1/0)],u=[0,0,0];function _(s,A,b,f,z){var l=A.model||o,L=A.view||o,T=A.projection||o,k=A._ortho||!1,P=s.bounds,z=z||n(l,L,T,P,k),I=z.axis;r(i,L,l),r(i,T,i);for(var D=m,R=0;R<3;++R)D[R].lo=1/0,D[R].hi=-1/0,D[R].pixelsPerDataUnit=1/0;var B=e(t(i,i));t(i,i);for(var F=0;F<3;++F){var H=(F+1)%3,G=(F+2)%3,J=u;e:for(var R=0;R<2;++R){var X=[];if(I[F]<0!=!!R){J[F]=P[R][F];for(var Y=0;Y<2;++Y){J[H]=P[Y^R][H];for(var Z=0;Z<2;++Z)J[G]=P[Z^Y^R][G],X.push(J.slice())}for(var oe=k?5:4,Y=oe;Y===oe;++Y){if(X.length===0)continue e;X=a.positive(X,B[Y])}for(var Y=0;Y<X.length;++Y)for(var G=X[Y],re=h(u,i,G,b,f),Z=0;Z<3;++Z)D[Z].lo=Math.min(D[Z].lo,G[Z]),D[Z].hi=Math.max(D[Z].hi,G[Z]),Z!==F&&(D[Z].pixelsPerDataUnit=Math.min(D[Z].pixelsPerDataUnit,Math.abs(re[Z])))}}}return D}},{"./lib/cube.js":72,"extract-frustum-planes":67,"gl-mat4/multiply":100,"gl-mat4/transpose":109,"gl-vec4/transformMat4":221,"split-polygon":300}],78:[function(v,S,M){var e=v("typedarray-pool"),a=v("ndarray-ops"),n=v("ndarray"),r=["uint8","uint8_clamped","uint16","uint32","int8","int16","int32","float32"];function t(g,h,m,u,_){this.gl=g,this.type=h,this.handle=m,this.length=u,this.usage=_}var c=t.prototype;c.bind=function(){this.gl.bindBuffer(this.type,this.handle)},c.unbind=function(){this.gl.bindBuffer(this.type,null)},c.dispose=function(){this.gl.deleteBuffer(this.handle)};function o(g,h,m,u,_,s){var A=_.length*_.BYTES_PER_ELEMENT;if(s<0)return g.bufferData(h,_,u),A;if(A+s>m)throw new Error("gl-buffer: If resizing buffer, must not specify offset");return g.bufferSubData(h,s,_),m}function i(g,h){for(var m=e.malloc(g.length,h),u=g.length,_=0;_<u;++_)m[_]=g[_];return m}function y(g,h){for(var m=1,u=h.length-1;u>=0;--u){if(h[u]!==m)return!1;m*=g[u]}return!0}c.update=function(g,h){if(typeof h!="number"&&(h=-1),this.bind(),typeof g=="object"&&typeof g.shape<"u"){var m=g.dtype;if(r.indexOf(m)<0&&(m="float32"),this.type===this.gl.ELEMENT_ARRAY_BUFFER){var u=gl.getExtension("OES_element_index_uint");u&&m!=="uint16"?m="uint32":m="uint16"}if(m===g.dtype&&y(g.shape,g.stride))g.offset===0&&g.data.length===g.shape[0]?this.length=o(this.gl,this.type,this.length,this.usage,g.data,h):this.length=o(this.gl,this.type,this.length,this.usage,g.data.subarray(g.offset,g.shape[0]),h);else{var _=e.malloc(g.size,m),s=n(_,g.shape);a.assign(s,g),h<0?this.length=o(this.gl,this.type,this.length,this.usage,_,h):this.length=o(this.gl,this.type,this.length,this.usage,_.subarray(0,g.size),h),e.free(_)}}else if(Array.isArray(g)){var A;this.type===this.gl.ELEMENT_ARRAY_BUFFER?A=i(g,"uint16"):A=i(g,"float32"),h<0?this.length=o(this.gl,this.type,this.length,this.usage,A,h):this.length=o(this.gl,this.type,this.length,this.usage,A.subarray(0,g.length),h),e.free(A)}else if(typeof g=="object"&&typeof g.length=="number")this.length=o(this.gl,this.type,this.length,this.usage,g,h);else if(typeof g=="number"||g===void 0){if(h>=0)throw new Error("gl-buffer: Cannot specify offset when resizing buffer");g=g|0,g<=0&&(g=1),this.gl.bufferData(this.type,g|0,this.usage),this.length=g}else throw new Error("gl-buffer: Invalid data type")};function p(g,h,m,u){if(m=m||g.ARRAY_BUFFER,u=u||g.DYNAMIC_DRAW,m!==g.ARRAY_BUFFER&&m!==g.ELEMENT_ARRAY_BUFFER)throw new Error("gl-buffer: Invalid type for webgl buffer, must be either gl.ARRAY_BUFFER or gl.ELEMENT_ARRAY_BUFFER");if(u!==g.DYNAMIC_DRAW&&u!==g.STATIC_DRAW&&u!==g.STREAM_DRAW)throw new Error("gl-buffer: Invalid usage for buffer, must be either gl.DYNAMIC_DRAW, gl.STATIC_DRAW or gl.STREAM_DRAW");var _=g.createBuffer(),s=new t(g,m,_,0,u);return s.update(h),s}S.exports=p},{ndarray:259,"ndarray-ops":254,"typedarray-pool":308}],79:[function(v,S,M){var e=v("gl-vec3");S.exports=function(n,r){var t=n.positions,c=n.vectors,o={positions:[],vertexIntensity:[],vertexIntensityBounds:n.vertexIntensityBounds,vectors:[],cells:[],coneOffset:n.coneOffset,colormap:n.colormap};if(n.positions.length===0)return r&&(r[0]=[0,0,0],r[1]=[0,0,0]),o;for(var i=0,y=1/0,p=-1/0,g=1/0,h=-1/0,m=1/0,u=-1/0,_=null,s=null,A=[],b=1/0,f=!1,x=0;x<t.length;x++){var l=t[x];y=Math.min(l[0],y),p=Math.max(l[0],p),g=Math.min(l[1],g),h=Math.max(l[1],h),m=Math.min(l[2],m),u=Math.max(l[2],u);var L=c[x];if(e.length(L)>i&&(i=e.length(L)),x){var T=2*e.distance(_,l)/(e.length(s)+e.length(L));T?(b=Math.min(b,T),f=!1):f=!0}f||(_=l,s=L),A.push(L)}var k=[y,g,m],P=[p,h,u];r&&(r[0]=k,r[1]=P),i===0&&(i=1);var z=1/i;isFinite(b)||(b=1),o.vectorScale=b;var I=n.coneSize||.5;n.absoluteConeSize&&(I=n.absoluteConeSize*z),o.coneScale=I;for(var x=0,D=0;x<t.length;x++)for(var l=t[x],R=l[0],B=l[1],F=l[2],H=A[x],G=e.length(H)*z,J=0,X=8;J<X;J++){o.positions.push([R,B,F,D++]),o.positions.push([R,B,F,D++]),o.positions.push([R,B,F,D++]),o.positions.push([R,B,F,D++]),o.positions.push([R,B,F,D++]),o.positions.push([R,B,F,D++]),o.vectors.push(H),o.vectors.push(H),o.vectors.push(H),o.vectors.push(H),o.vectors.push(H),o.vectors.push(H),o.vertexIntensity.push(G,G,G),o.vertexIntensity.push(G,G,G);var Y=o.positions.length;o.cells.push([Y-6,Y-5,Y-4],[Y-3,Y-2,Y-1])}return o};var a=v("./lib/shaders");S.exports.createMesh=v("./create_mesh"),S.exports.createConeMesh=function(n,r){return S.exports.createMesh(n,r,{shaders:a,traceType:"cone"})}},{"./create_mesh":80,"./lib/shaders":81,"gl-vec3":169}],80:[function(v,S,M){var e=v("gl-shader"),a=v("gl-buffer"),n=v("gl-vao"),r=v("gl-texture2d"),t=v("gl-mat4/multiply"),c=v("gl-mat4/invert"),o=v("ndarray"),i=v("colormap"),y=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function p(A,b,f,x,l,L,T,k,P,z,I){this.gl=A,this.pixelRatio=1,this.cells=[],this.positions=[],this.intensity=[],this.texture=b,this.dirty=!0,this.triShader=f,this.pickShader=x,this.trianglePositions=l,this.triangleVectors=L,this.triangleColors=k,this.triangleUVs=P,this.triangleIds=T,this.triangleVAO=z,this.triangleCount=0,this.pickId=1,this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.lightPosition=[1e5,1e5,0],this.ambientLight=.8,this.diffuseLight=.8,this.specularLight=2,this.roughness=.5,this.fresnel=1.5,this.opacity=1,this.traceType=I,this.tubeScale=1,this.coneScale=2,this.vectorScale=1,this.coneOffset=.25,this._model=y,this._view=y,this._projection=y,this._resolution=[1,1]}var g=p.prototype;g.isOpaque=function(){return this.opacity>=1},g.isTransparent=function(){return this.opacity<1},g.pickSlots=1,g.setPickBase=function(A){this.pickId=A};function h(A){for(var b=i({colormap:A,nshades:256,format:"rgba"}),f=new Uint8Array(256*4),x=0;x<256;++x){for(var l=b[x],L=0;L<3;++L)f[4*x+L]=l[L];f[4*x+3]=l[3]*255}return o(f,[256,256,4],[4,0,1])}function m(A){for(var b=A.length,f=new Array(b),x=0;x<b;++x)f[x]=A[x][2];return f}g.update=function(A){A=A||{};var b=this.gl;this.dirty=!0,"lightPosition"in A&&(this.lightPosition=A.lightPosition),"opacity"in A&&(this.opacity=A.opacity),"ambient"in A&&(this.ambientLight=A.ambient),"diffuse"in A&&(this.diffuseLight=A.diffuse),"specular"in A&&(this.specularLight=A.specular),"roughness"in A&&(this.roughness=A.roughness),"fresnel"in A&&(this.fresnel=A.fresnel),A.tubeScale!==void 0&&(this.tubeScale=A.tubeScale),A.vectorScale!==void 0&&(this.vectorScale=A.vectorScale),A.coneScale!==void 0&&(this.coneScale=A.coneScale),A.coneOffset!==void 0&&(this.coneOffset=A.coneOffset),A.colormap&&(this.texture.shape=[256,256],this.texture.minFilter=b.LINEAR_MIPMAP_LINEAR,this.texture.magFilter=b.LINEAR,this.texture.setPixels(h(A.colormap)),this.texture.generateMipmap());var f=A.cells,x=A.positions,l=A.vectors;if(!x||!f||!l)return;var L=[],T=[],k=[],P=[],z=[];this.cells=f,this.positions=x,this.vectors=l;var I=A.meshColor||[1,1,1,1],D=A.vertexIntensity,R=1/0,B=-1/0;if(D)if(A.vertexIntensityBounds)R=+A.vertexIntensityBounds[0],B=+A.vertexIntensityBounds[1];else for(var F=0;F<D.length;++F){var H=D[F];R=Math.min(R,H),B=Math.max(B,H)}else for(var F=0;F<x.length;++F){var H=x[F][2];R=Math.min(R,H),B=Math.max(B,H)}D?this.intensity=D:this.intensity=m(x),this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]];for(var F=0;F<x.length;++F)for(var G=x[F],J=0;J<3;++J)isNaN(G[J])||!isFinite(G[J])||(this.bounds[0][J]=Math.min(this.bounds[0][J],G[J]),this.bounds[1][J]=Math.max(this.bounds[1][J],G[J]));var X=0;e:for(var F=0;F<f.length;++F){var Y=f[F];switch(Y.length){case 3:for(var J=0;J<3;++J)for(var Z=Y[J],G=x[Z],oe=0;oe<3;++oe)if(isNaN(G[oe])||!isFinite(G[oe]))continue e;for(var J=0;J<3;++J){var Z=Y[2-J],G=x[Z];L.push(G[0],G[1],G[2],G[3]);var re=l[Z];T.push(re[0],re[1],re[2],re[3]||0);var se=I;se.length===3?k.push(se[0],se[1],se[2],1):k.push(se[0],se[1],se[2],se[3]);var N;D?N=[(D[Z]-R)/(B-R),0]:N=[(G[2]-R)/(B-R),0],P.push(N[0],N[1]),z.push(F)}X+=1;break}}this.triangleCount=X,this.trianglePositions.update(L),this.triangleVectors.update(T),this.triangleColors.update(k),this.triangleUVs.update(P),this.triangleIds.update(new Uint32Array(z))},g.drawTransparent=g.draw=function(A){A=A||{};for(var b=this.gl,f=A.model||y,x=A.view||y,l=A.projection||y,L=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],T=0;T<3;++T)L[0][T]=Math.max(L[0][T],this.clipBounds[0][T]),L[1][T]=Math.min(L[1][T],this.clipBounds[1][T]);var k={model:f,view:x,projection:l,inverseModel:y.slice(),clipBounds:L,kambient:this.ambientLight,kdiffuse:this.diffuseLight,kspecular:this.specularLight,roughness:this.roughness,fresnel:this.fresnel,eyePosition:[0,0,0],lightPosition:[0,0,0],opacity:this.opacity,tubeScale:this.tubeScale,vectorScale:this.vectorScale,coneScale:this.coneScale,coneOffset:this.coneOffset,texture:0};k.inverseModel=c(k.inverseModel,k.model),b.disable(b.CULL_FACE),this.texture.bind(0);var P=new Array(16);t(P,k.view,k.model),t(P,k.projection,P),c(P,P);for(var T=0;T<3;++T)k.eyePosition[T]=P[12+T]/P[15];for(var z=P[15],T=0;T<3;++T)z+=this.lightPosition[T]*P[4*T+3];for(var T=0;T<3;++T){for(var I=P[12+T],D=0;D<3;++D)I+=P[4*D+T]*this.lightPosition[D];k.lightPosition[T]=I/z}if(this.triangleCount>0){var R=this.triShader;R.bind(),R.uniforms=k,this.triangleVAO.bind(),b.drawArrays(b.TRIANGLES,0,this.triangleCount*3),this.triangleVAO.unbind()}},g.drawPick=function(A){A=A||{};for(var b=this.gl,f=A.model||y,x=A.view||y,l=A.projection||y,L=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],T=0;T<3;++T)L[0][T]=Math.max(L[0][T],this.clipBounds[0][T]),L[1][T]=Math.min(L[1][T],this.clipBounds[1][T]);this._model=[].slice.call(f),this._view=[].slice.call(x),this._projection=[].slice.call(l),this._resolution=[b.drawingBufferWidth,b.drawingBufferHeight];var k={model:f,view:x,projection:l,clipBounds:L,tubeScale:this.tubeScale,vectorScale:this.vectorScale,coneScale:this.coneScale,coneOffset:this.coneOffset,pickId:this.pickId/255},P=this.pickShader;P.bind(),P.uniforms=k,this.triangleCount>0&&(this.triangleVAO.bind(),b.drawArrays(b.TRIANGLES,0,this.triangleCount*3),this.triangleVAO.unbind())},g.pick=function(A){if(!A||A.id!==this.pickId)return null;var b=A.value[0]+256*A.value[1]+65536*A.value[2],f=this.cells[b],x=this.positions[f[1]].slice(0,3),l={position:x,dataCoordinate:x,index:Math.floor(f[1]/48)};return this.traceType==="cone"?l.index=Math.floor(f[1]/48):this.traceType==="streamtube"&&(l.intensity=this.intensity[f[1]],l.velocity=this.vectors[f[1]].slice(0,3),l.divergence=this.vectors[f[1]][3],l.index=b),l},g.dispose=function(){this.texture.dispose(),this.triShader.dispose(),this.pickShader.dispose(),this.triangleVAO.dispose(),this.trianglePositions.dispose(),this.triangleVectors.dispose(),this.triangleColors.dispose(),this.triangleUVs.dispose(),this.triangleIds.dispose()};function u(A,b){var f=e(A,b.meshShader.vertex,b.meshShader.fragment,null,b.meshShader.attributes);return f.attributes.position.location=0,f.attributes.color.location=2,f.attributes.uv.location=3,f.attributes.vector.location=4,f}function _(A,b){var f=e(A,b.pickShader.vertex,b.pickShader.fragment,null,b.pickShader.attributes);return f.attributes.position.location=0,f.attributes.id.location=1,f.attributes.vector.location=4,f}function s(A,b,f){var x=f.shaders;arguments.length===1&&(b=A,A=b.gl);var l=u(A,x),L=_(A,x),T=r(A,o(new Uint8Array([255,255,255,255]),[1,1,4]));T.generateMipmap(),T.minFilter=A.LINEAR_MIPMAP_LINEAR,T.magFilter=A.LINEAR;var k=a(A),P=a(A),z=a(A),I=a(A),D=a(A),R=n(A,[{buffer:k,type:A.FLOAT,size:4},{buffer:D,type:A.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:z,type:A.FLOAT,size:4},{buffer:I,type:A.FLOAT,size:2},{buffer:P,type:A.FLOAT,size:4}]),B=new p(A,T,l,L,k,P,D,z,I,R,f.traceType||"cone");return B.update(b),B}S.exports=s},{colormap:53,"gl-buffer":78,"gl-mat4/invert":98,"gl-mat4/multiply":100,"gl-shader":132,"gl-texture2d":146,"gl-vao":150,ndarray:259}],81:[function(v,S,M){var e=v("glslify"),a=e([`precision highp float;

precision highp float;
#define GLSLIFY 1

vec3 getOrthogonalVector(vec3 v) {
  // Return up-vector for only-z vector.
  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).
  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.
  // Assign z = 0, x = -b, y = a:
  // a*-b + b*a + c*0 = -ba + ba + 0 = 0
  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {
    return normalize(vec3(-v.y, v.x, 0.0));
  } else {
    return normalize(vec3(0.0, v.z, -v.y));
  }
}

// Calculate the cone vertex and normal at the given index.
//
// The returned vertex is for a cone with its top at origin and height of 1.0,
// pointing in the direction of the vector attribute.
//
// Each cone is made up of a top vertex, a center base vertex and base perimeter vertices.
// These vertices are used to make up the triangles of the cone by the following:
//   segment + 0 top vertex
//   segment + 1 perimeter vertex a+1
//   segment + 2 perimeter vertex a
//   segment + 3 center base vertex
//   segment + 4 perimeter vertex a
//   segment + 5 perimeter vertex a+1
// Where segment is the number of the radial segment * 6 and a is the angle at that radial segment.
// To go from index to segment, floor(index / 6)
// To go from segment to angle, 2*pi * (segment/segmentCount)
// To go from index to segment index, index - (segment*6)
//
vec3 getConePosition(vec3 d, float rawIndex, float coneOffset, out vec3 normal) {

  const float segmentCount = 8.0;

  float index = rawIndex - floor(rawIndex /
    (segmentCount * 6.0)) *
    (segmentCount * 6.0);

  float segment = floor(0.001 + index/6.0);
  float segmentIndex = index - (segment*6.0);

  normal = -normalize(d);

  if (segmentIndex > 2.99 && segmentIndex < 3.01) {
    return mix(vec3(0.0), -d, coneOffset);
  }

  float nextAngle = (
    (segmentIndex > 0.99 &&  segmentIndex < 1.01) ||
    (segmentIndex > 4.99 &&  segmentIndex < 5.01)
  ) ? 1.0 : 0.0;
  float angle = 2.0 * 3.14159 * ((segment + nextAngle) / segmentCount);

  vec3 v1 = mix(d, vec3(0.0), coneOffset);
  vec3 v2 = v1 - d;

  vec3 u = getOrthogonalVector(d);
  vec3 v = normalize(cross(u, d));

  vec3 x = u * cos(angle) * length(d)*0.25;
  vec3 y = v * sin(angle) * length(d)*0.25;
  vec3 v3 = v2 + x + y;
  if (segmentIndex < 3.0) {
    vec3 tx = u * sin(angle);
    vec3 ty = v * -cos(angle);
    vec3 tangent = tx + ty;
    normal = normalize(cross(v3 - v1, tangent));
  }

  if (segmentIndex == 0.0) {
    return mix(d, vec3(0.0), coneOffset);
  }
  return v3;
}

attribute vec3 vector;
attribute vec4 color, position;
attribute vec2 uv;

uniform float vectorScale, coneScale, coneOffset;
uniform mat4 model, view, projection, inverseModel;
uniform vec3 eyePosition, lightPosition;

varying vec3 f_normal, f_lightDirection, f_eyeDirection, f_data, f_position;
varying vec4 f_color;
varying vec2 f_uv;

void main() {
  // Scale the vector magnitude to stay constant with
  // model & view changes.
  vec3 normal;
  vec3 XYZ = getConePosition(mat3(model) * ((vectorScale * coneScale) * vector), position.w, coneOffset, normal);
  vec4 conePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);

  //Lighting geometry parameters
  vec4 cameraCoordinate = view * conePosition;
  cameraCoordinate.xyz /= cameraCoordinate.w;
  f_lightDirection = lightPosition - cameraCoordinate.xyz;
  f_eyeDirection   = eyePosition - cameraCoordinate.xyz;
  f_normal = normalize((vec4(normal, 0.0) * inverseModel).xyz);

  // vec4 m_position  = model * vec4(conePosition, 1.0);
  vec4 t_position  = view * conePosition;
  gl_Position      = projection * t_position;

  f_color          = color;
  f_data           = conePosition.xyz;
  f_position       = position.xyz;
  f_uv             = uv;
}
`]),n=e([`#extension GL_OES_standard_derivatives : enable

precision highp float;
#define GLSLIFY 1

float beckmannDistribution(float x, float roughness) {
  float NdotH = max(x, 0.0001);
  float cos2Alpha = NdotH * NdotH;
  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;
  float roughness2 = roughness * roughness;
  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;
  return exp(tan2Alpha / roughness2) / denom;
}

float cookTorranceSpecular(
  vec3 lightDirection,
  vec3 viewDirection,
  vec3 surfaceNormal,
  float roughness,
  float fresnel) {

  float VdotN = max(dot(viewDirection, surfaceNormal), 0.0);
  float LdotN = max(dot(lightDirection, surfaceNormal), 0.0);

  //Half angle vector
  vec3 H = normalize(lightDirection + viewDirection);

  //Geometric term
  float NdotH = max(dot(surfaceNormal, H), 0.0);
  float VdotH = max(dot(viewDirection, H), 0.000001);
  float LdotH = max(dot(lightDirection, H), 0.000001);
  float G1 = (2.0 * NdotH * VdotN) / VdotH;
  float G2 = (2.0 * NdotH * LdotN) / LdotH;
  float G = min(1.0, min(G1, G2));
  
  //Distribution term
  float D = beckmannDistribution(NdotH, roughness);

  //Fresnel term
  float F = pow(1.0 - VdotN, fresnel);

  //Multiply terms and done
  return  G * F * D / max(3.14159265 * VdotN, 0.000001);
}

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 clipBounds[2];
uniform float roughness, fresnel, kambient, kdiffuse, kspecular, opacity;
uniform sampler2D texture;

varying vec3 f_normal, f_lightDirection, f_eyeDirection, f_data, f_position;
varying vec4 f_color;
varying vec2 f_uv;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;
  vec3 N = normalize(f_normal);
  vec3 L = normalize(f_lightDirection);
  vec3 V = normalize(f_eyeDirection);

  if(gl_FrontFacing) {
    N = -N;
  }

  float specular = min(1.0, max(0.0, cookTorranceSpecular(L, V, N, roughness, fresnel)));
  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);

  vec4 surfaceColor = f_color * texture2D(texture, f_uv);
  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);

  gl_FragColor = litColor * opacity;
}
`]),r=e([`precision highp float;

precision highp float;
#define GLSLIFY 1

vec3 getOrthogonalVector(vec3 v) {
  // Return up-vector for only-z vector.
  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).
  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.
  // Assign z = 0, x = -b, y = a:
  // a*-b + b*a + c*0 = -ba + ba + 0 = 0
  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {
    return normalize(vec3(-v.y, v.x, 0.0));
  } else {
    return normalize(vec3(0.0, v.z, -v.y));
  }
}

// Calculate the cone vertex and normal at the given index.
//
// The returned vertex is for a cone with its top at origin and height of 1.0,
// pointing in the direction of the vector attribute.
//
// Each cone is made up of a top vertex, a center base vertex and base perimeter vertices.
// These vertices are used to make up the triangles of the cone by the following:
//   segment + 0 top vertex
//   segment + 1 perimeter vertex a+1
//   segment + 2 perimeter vertex a
//   segment + 3 center base vertex
//   segment + 4 perimeter vertex a
//   segment + 5 perimeter vertex a+1
// Where segment is the number of the radial segment * 6 and a is the angle at that radial segment.
// To go from index to segment, floor(index / 6)
// To go from segment to angle, 2*pi * (segment/segmentCount)
// To go from index to segment index, index - (segment*6)
//
vec3 getConePosition(vec3 d, float rawIndex, float coneOffset, out vec3 normal) {

  const float segmentCount = 8.0;

  float index = rawIndex - floor(rawIndex /
    (segmentCount * 6.0)) *
    (segmentCount * 6.0);

  float segment = floor(0.001 + index/6.0);
  float segmentIndex = index - (segment*6.0);

  normal = -normalize(d);

  if (segmentIndex > 2.99 && segmentIndex < 3.01) {
    return mix(vec3(0.0), -d, coneOffset);
  }

  float nextAngle = (
    (segmentIndex > 0.99 &&  segmentIndex < 1.01) ||
    (segmentIndex > 4.99 &&  segmentIndex < 5.01)
  ) ? 1.0 : 0.0;
  float angle = 2.0 * 3.14159 * ((segment + nextAngle) / segmentCount);

  vec3 v1 = mix(d, vec3(0.0), coneOffset);
  vec3 v2 = v1 - d;

  vec3 u = getOrthogonalVector(d);
  vec3 v = normalize(cross(u, d));

  vec3 x = u * cos(angle) * length(d)*0.25;
  vec3 y = v * sin(angle) * length(d)*0.25;
  vec3 v3 = v2 + x + y;
  if (segmentIndex < 3.0) {
    vec3 tx = u * sin(angle);
    vec3 ty = v * -cos(angle);
    vec3 tangent = tx + ty;
    normal = normalize(cross(v3 - v1, tangent));
  }

  if (segmentIndex == 0.0) {
    return mix(d, vec3(0.0), coneOffset);
  }
  return v3;
}

attribute vec4 vector;
attribute vec4 position;
attribute vec4 id;

uniform mat4 model, view, projection;
uniform float vectorScale, coneScale, coneOffset;

varying vec3 f_position;
varying vec4 f_id;

void main() {
  vec3 normal;
  vec3 XYZ = getConePosition(mat3(model) * ((vectorScale * coneScale) * vector.xyz), position.w, coneOffset, normal);
  vec4 conePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);
  gl_Position = projection * view * conePosition;
  f_id        = id;
  f_position  = position.xyz;
}
`]),t=e([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3  clipBounds[2];
uniform float pickId;

varying vec3 f_position;
varying vec4 f_id;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;

  gl_FragColor = vec4(pickId, f_id.xyz);
}`]);M.meshShader={vertex:a,fragment:n,attributes:[{name:"position",type:"vec4"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"},{name:"vector",type:"vec3"}]},M.pickShader={vertex:r,fragment:t,attributes:[{name:"position",type:"vec4"},{name:"id",type:"vec4"},{name:"vector",type:"vec3"}]}},{glslify:231}],82:[function(v,S,M){S.exports={0:"NONE",1:"ONE",2:"LINE_LOOP",3:"LINE_STRIP",4:"TRIANGLES",5:"TRIANGLE_STRIP",6:"TRIANGLE_FAN",256:"DEPTH_BUFFER_BIT",512:"NEVER",513:"LESS",514:"EQUAL",515:"LEQUAL",516:"GREATER",517:"NOTEQUAL",518:"GEQUAL",519:"ALWAYS",768:"SRC_COLOR",769:"ONE_MINUS_SRC_COLOR",770:"SRC_ALPHA",771:"ONE_MINUS_SRC_ALPHA",772:"DST_ALPHA",773:"ONE_MINUS_DST_ALPHA",774:"DST_COLOR",775:"ONE_MINUS_DST_COLOR",776:"SRC_ALPHA_SATURATE",1024:"STENCIL_BUFFER_BIT",1028:"FRONT",1029:"BACK",1032:"FRONT_AND_BACK",1280:"INVALID_ENUM",1281:"INVALID_VALUE",1282:"INVALID_OPERATION",1285:"OUT_OF_MEMORY",1286:"INVALID_FRAMEBUFFER_OPERATION",2304:"CW",2305:"CCW",2849:"LINE_WIDTH",2884:"CULL_FACE",2885:"CULL_FACE_MODE",2886:"FRONT_FACE",2928:"DEPTH_RANGE",2929:"DEPTH_TEST",2930:"DEPTH_WRITEMASK",2931:"DEPTH_CLEAR_VALUE",2932:"DEPTH_FUNC",2960:"STENCIL_TEST",2961:"STENCIL_CLEAR_VALUE",2962:"STENCIL_FUNC",2963:"STENCIL_VALUE_MASK",2964:"STENCIL_FAIL",2965:"STENCIL_PASS_DEPTH_FAIL",2966:"STENCIL_PASS_DEPTH_PASS",2967:"STENCIL_REF",2968:"STENCIL_WRITEMASK",2978:"VIEWPORT",3024:"DITHER",3042:"BLEND",3088:"SCISSOR_BOX",3089:"SCISSOR_TEST",3106:"COLOR_CLEAR_VALUE",3107:"COLOR_WRITEMASK",3317:"UNPACK_ALIGNMENT",3333:"PACK_ALIGNMENT",3379:"MAX_TEXTURE_SIZE",3386:"MAX_VIEWPORT_DIMS",3408:"SUBPIXEL_BITS",3410:"RED_BITS",3411:"GREEN_BITS",3412:"BLUE_BITS",3413:"ALPHA_BITS",3414:"DEPTH_BITS",3415:"STENCIL_BITS",3553:"TEXTURE_2D",4352:"DONT_CARE",4353:"FASTEST",4354:"NICEST",5120:"BYTE",5121:"UNSIGNED_BYTE",5122:"SHORT",5123:"UNSIGNED_SHORT",5124:"INT",5125:"UNSIGNED_INT",5126:"FLOAT",5386:"INVERT",5890:"TEXTURE",6401:"STENCIL_INDEX",6402:"DEPTH_COMPONENT",6406:"ALPHA",6407:"RGB",6408:"RGBA",6409:"LUMINANCE",6410:"LUMINANCE_ALPHA",7680:"KEEP",7681:"REPLACE",7682:"INCR",7683:"DECR",7936:"VENDOR",7937:"RENDERER",7938:"VERSION",9728:"NEAREST",9729:"LINEAR",9984:"NEAREST_MIPMAP_NEAREST",9985:"LINEAR_MIPMAP_NEAREST",9986:"NEAREST_MIPMAP_LINEAR",9987:"LINEAR_MIPMAP_LINEAR",10240:"TEXTURE_MAG_FILTER",10241:"TEXTURE_MIN_FILTER",10242:"TEXTURE_WRAP_S",10243:"TEXTURE_WRAP_T",10497:"REPEAT",10752:"POLYGON_OFFSET_UNITS",16384:"COLOR_BUFFER_BIT",32769:"CONSTANT_COLOR",32770:"ONE_MINUS_CONSTANT_COLOR",32771:"CONSTANT_ALPHA",32772:"ONE_MINUS_CONSTANT_ALPHA",32773:"BLEND_COLOR",32774:"FUNC_ADD",32777:"BLEND_EQUATION_RGB",32778:"FUNC_SUBTRACT",32779:"FUNC_REVERSE_SUBTRACT",32819:"UNSIGNED_SHORT_4_4_4_4",32820:"UNSIGNED_SHORT_5_5_5_1",32823:"POLYGON_OFFSET_FILL",32824:"POLYGON_OFFSET_FACTOR",32854:"RGBA4",32855:"RGB5_A1",32873:"TEXTURE_BINDING_2D",32926:"SAMPLE_ALPHA_TO_COVERAGE",32928:"SAMPLE_COVERAGE",32936:"SAMPLE_BUFFERS",32937:"SAMPLES",32938:"SAMPLE_COVERAGE_VALUE",32939:"SAMPLE_COVERAGE_INVERT",32968:"BLEND_DST_RGB",32969:"BLEND_SRC_RGB",32970:"BLEND_DST_ALPHA",32971:"BLEND_SRC_ALPHA",33071:"CLAMP_TO_EDGE",33170:"GENERATE_MIPMAP_HINT",33189:"DEPTH_COMPONENT16",33306:"DEPTH_STENCIL_ATTACHMENT",33635:"UNSIGNED_SHORT_5_6_5",33648:"MIRRORED_REPEAT",33901:"ALIASED_POINT_SIZE_RANGE",33902:"ALIASED_LINE_WIDTH_RANGE",33984:"TEXTURE0",33985:"TEXTURE1",33986:"TEXTURE2",33987:"TEXTURE3",33988:"TEXTURE4",33989:"TEXTURE5",33990:"TEXTURE6",33991:"TEXTURE7",33992:"TEXTURE8",33993:"TEXTURE9",33994:"TEXTURE10",33995:"TEXTURE11",33996:"TEXTURE12",33997:"TEXTURE13",33998:"TEXTURE14",33999:"TEXTURE15",34e3:"TEXTURE16",34001:"TEXTURE17",34002:"TEXTURE18",34003:"TEXTURE19",34004:"TEXTURE20",34005:"TEXTURE21",34006:"TEXTURE22",34007:"TEXTURE23",34008:"TEXTURE24",34009:"TEXTURE25",34010:"TEXTURE26",34011:"TEXTURE27",34012:"TEXTURE28",34013:"TEXTURE29",34014:"TEXTURE30",34015:"TEXTURE31",34016:"ACTIVE_TEXTURE",34024:"MAX_RENDERBUFFER_SIZE",34041:"DEPTH_STENCIL",34055:"INCR_WRAP",34056:"DECR_WRAP",34067:"TEXTURE_CUBE_MAP",34068:"TEXTURE_BINDING_CUBE_MAP",34069:"TEXTURE_CUBE_MAP_POSITIVE_X",34070:"TEXTURE_CUBE_MAP_NEGATIVE_X",34071:"TEXTURE_CUBE_MAP_POSITIVE_Y",34072:"TEXTURE_CUBE_MAP_NEGATIVE_Y",34073:"TEXTURE_CUBE_MAP_POSITIVE_Z",34074:"TEXTURE_CUBE_MAP_NEGATIVE_Z",34076:"MAX_CUBE_MAP_TEXTURE_SIZE",34338:"VERTEX_ATTRIB_ARRAY_ENABLED",34339:"VERTEX_ATTRIB_ARRAY_SIZE",34340:"VERTEX_ATTRIB_ARRAY_STRIDE",34341:"VERTEX_ATTRIB_ARRAY_TYPE",34342:"CURRENT_VERTEX_ATTRIB",34373:"VERTEX_ATTRIB_ARRAY_POINTER",34466:"NUM_COMPRESSED_TEXTURE_FORMATS",34467:"COMPRESSED_TEXTURE_FORMATS",34660:"BUFFER_SIZE",34661:"BUFFER_USAGE",34816:"STENCIL_BACK_FUNC",34817:"STENCIL_BACK_FAIL",34818:"STENCIL_BACK_PASS_DEPTH_FAIL",34819:"STENCIL_BACK_PASS_DEPTH_PASS",34877:"BLEND_EQUATION_ALPHA",34921:"MAX_VERTEX_ATTRIBS",34922:"VERTEX_ATTRIB_ARRAY_NORMALIZED",34930:"MAX_TEXTURE_IMAGE_UNITS",34962:"ARRAY_BUFFER",34963:"ELEMENT_ARRAY_BUFFER",34964:"ARRAY_BUFFER_BINDING",34965:"ELEMENT_ARRAY_BUFFER_BINDING",34975:"VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",35040:"STREAM_DRAW",35044:"STATIC_DRAW",35048:"DYNAMIC_DRAW",35632:"FRAGMENT_SHADER",35633:"VERTEX_SHADER",35660:"MAX_VERTEX_TEXTURE_IMAGE_UNITS",35661:"MAX_COMBINED_TEXTURE_IMAGE_UNITS",35663:"SHADER_TYPE",35664:"FLOAT_VEC2",35665:"FLOAT_VEC3",35666:"FLOAT_VEC4",35667:"INT_VEC2",35668:"INT_VEC3",35669:"INT_VEC4",35670:"BOOL",35671:"BOOL_VEC2",35672:"BOOL_VEC3",35673:"BOOL_VEC4",35674:"FLOAT_MAT2",35675:"FLOAT_MAT3",35676:"FLOAT_MAT4",35678:"SAMPLER_2D",35680:"SAMPLER_CUBE",35712:"DELETE_STATUS",35713:"COMPILE_STATUS",35714:"LINK_STATUS",35715:"VALIDATE_STATUS",35716:"INFO_LOG_LENGTH",35717:"ATTACHED_SHADERS",35718:"ACTIVE_UNIFORMS",35719:"ACTIVE_UNIFORM_MAX_LENGTH",35720:"SHADER_SOURCE_LENGTH",35721:"ACTIVE_ATTRIBUTES",35722:"ACTIVE_ATTRIBUTE_MAX_LENGTH",35724:"SHADING_LANGUAGE_VERSION",35725:"CURRENT_PROGRAM",36003:"STENCIL_BACK_REF",36004:"STENCIL_BACK_VALUE_MASK",36005:"STENCIL_BACK_WRITEMASK",36006:"FRAMEBUFFER_BINDING",36007:"RENDERBUFFER_BINDING",36048:"FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",36049:"FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",36050:"FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",36051:"FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",36053:"FRAMEBUFFER_COMPLETE",36054:"FRAMEBUFFER_INCOMPLETE_ATTACHMENT",36055:"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",36057:"FRAMEBUFFER_INCOMPLETE_DIMENSIONS",36061:"FRAMEBUFFER_UNSUPPORTED",36064:"COLOR_ATTACHMENT0",36096:"DEPTH_ATTACHMENT",36128:"STENCIL_ATTACHMENT",36160:"FRAMEBUFFER",36161:"RENDERBUFFER",36162:"RENDERBUFFER_WIDTH",36163:"RENDERBUFFER_HEIGHT",36164:"RENDERBUFFER_INTERNAL_FORMAT",36168:"STENCIL_INDEX8",36176:"RENDERBUFFER_RED_SIZE",36177:"RENDERBUFFER_GREEN_SIZE",36178:"RENDERBUFFER_BLUE_SIZE",36179:"RENDERBUFFER_ALPHA_SIZE",36180:"RENDERBUFFER_DEPTH_SIZE",36181:"RENDERBUFFER_STENCIL_SIZE",36194:"RGB565",36336:"LOW_FLOAT",36337:"MEDIUM_FLOAT",36338:"HIGH_FLOAT",36339:"LOW_INT",36340:"MEDIUM_INT",36341:"HIGH_INT",36346:"SHADER_COMPILER",36347:"MAX_VERTEX_UNIFORM_VECTORS",36348:"MAX_VARYING_VECTORS",36349:"MAX_FRAGMENT_UNIFORM_VECTORS",37440:"UNPACK_FLIP_Y_WEBGL",37441:"UNPACK_PREMULTIPLY_ALPHA_WEBGL",37442:"CONTEXT_LOST_WEBGL",37443:"UNPACK_COLORSPACE_CONVERSION_WEBGL",37444:"BROWSER_DEFAULT_WEBGL"}},{}],83:[function(v,S,M){var e=v("./1.0/numbers");S.exports=function(n){return e[n]}},{"./1.0/numbers":82}],84:[function(v,S,M){S.exports=p;var e=v("gl-buffer"),a=v("gl-vao"),n=v("./shaders/index"),r=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function t(g,h,m,u){this.gl=g,this.shader=u,this.buffer=h,this.vao=m,this.pixelRatio=1,this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.lineWidth=[1,1,1],this.capSize=[10,10,10],this.lineCount=[0,0,0],this.lineOffset=[0,0,0],this.opacity=1,this.hasAlpha=!1}var c=t.prototype;c.isOpaque=function(){return!this.hasAlpha},c.isTransparent=function(){return this.hasAlpha},c.drawTransparent=c.draw=function(g){var h=this.gl,m=this.shader.uniforms;this.shader.bind();var u=m.view=g.view||r,_=m.projection=g.projection||r;m.model=g.model||r,m.clipBounds=this.clipBounds,m.opacity=this.opacity;var s=u[12],A=u[13],b=u[14],f=u[15],x=g._ortho||!1,l=x?2:1,L=l*this.pixelRatio*(_[3]*s+_[7]*A+_[11]*b+_[15]*f)/h.drawingBufferHeight;this.vao.bind();for(var T=0;T<3;++T)h.lineWidth(this.lineWidth[T]*this.pixelRatio),m.capSize=this.capSize[T]*L,this.lineCount[T]&&h.drawArrays(h.LINES,this.lineOffset[T],this.lineCount[T]);this.vao.unbind()};function o(g,h){for(var m=0;m<3;++m)g[0][m]=Math.min(g[0][m],h[m]),g[1][m]=Math.max(g[1][m],h[m])}var i=function(){for(var g=new Array(3),h=0;h<3;++h){for(var m=[],u=1;u<=2;++u)for(var _=-1;_<=1;_+=2){var s=(u+h)%3,A=[0,0,0];A[s]=_,m.push(A)}g[h]=m}return g}();function y(g,h,m,u){for(var _=i[u],s=0;s<_.length;++s){var A=_[s];g.push(h[0],h[1],h[2],m[0],m[1],m[2],m[3],A[0],A[1],A[2])}return _.length}c.update=function(g){g=g||{},"lineWidth"in g&&(this.lineWidth=g.lineWidth,Array.isArray(this.lineWidth)||(this.lineWidth=[this.lineWidth,this.lineWidth,this.lineWidth])),"capSize"in g&&(this.capSize=g.capSize,Array.isArray(this.capSize)||(this.capSize=[this.capSize,this.capSize,this.capSize])),this.hasAlpha=!1,"opacity"in g&&(this.opacity=+g.opacity,this.opacity<1&&(this.hasAlpha=!0));var h=g.color||[[0,0,0],[0,0,0],[0,0,0]],m=g.position,u=g.error;if(Array.isArray(h[0])||(h=[h,h,h]),m&&u){var _=[],s=m.length,A=0;this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.lineCount=[0,0,0];for(var b=0;b<3;++b){this.lineOffset[b]=A;e:for(var f=0;f<s;++f){for(var x=m[f],l=0;l<3;++l)if(isNaN(x[l])||!isFinite(x[l]))continue e;var L=u[f],T=h[b];if(Array.isArray(T[0])&&(T=h[f]),T.length===3?T=[T[0],T[1],T[2],1]:T.length===4&&(T=[T[0],T[1],T[2],T[3]],!this.hasAlpha&&T[3]<1&&(this.hasAlpha=!0)),!(isNaN(L[0][b])||isNaN(L[1][b]))){if(L[0][b]<0){var k=x.slice();k[b]+=L[0][b],_.push(x[0],x[1],x[2],T[0],T[1],T[2],T[3],0,0,0,k[0],k[1],k[2],T[0],T[1],T[2],T[3],0,0,0),o(this.bounds,k),A+=2+y(_,k,T,b)}if(L[1][b]>0){var k=x.slice();k[b]+=L[1][b],_.push(x[0],x[1],x[2],T[0],T[1],T[2],T[3],0,0,0,k[0],k[1],k[2],T[0],T[1],T[2],T[3],0,0,0),o(this.bounds,k),A+=2+y(_,k,T,b)}}}this.lineCount[b]=A-this.lineOffset[b]}this.buffer.update(_)}},c.dispose=function(){this.shader.dispose(),this.buffer.dispose(),this.vao.dispose()};function p(g){var h=g.gl,m=e(h),u=a(h,[{buffer:m,type:h.FLOAT,size:3,offset:0,stride:40},{buffer:m,type:h.FLOAT,size:4,offset:12,stride:40},{buffer:m,type:h.FLOAT,size:3,offset:28,stride:40}]),_=n(h);_.attributes.position.location=0,_.attributes.color.location=1,_.attributes.offset.location=2;var s=new t(h,m,u,_);return s.update(g),s}},{"./shaders/index":85,"gl-buffer":78,"gl-vao":150}],85:[function(v,S,M){var e=v("glslify"),a=v("gl-shader"),n=e([`precision highp float;
#define GLSLIFY 1

attribute vec3 position, offset;
attribute vec4 color;
uniform mat4 model, view, projection;
uniform float capSize;
varying vec4 fragColor;
varying vec3 fragPosition;

void main() {
  vec4 worldPosition  = model * vec4(position, 1.0);
  worldPosition       = (worldPosition / worldPosition.w) + vec4(capSize * offset, 0.0);
  gl_Position         = projection * view * worldPosition;
  fragColor           = color;
  fragPosition        = position;
}`]),r=e([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 clipBounds[2];
uniform float opacity;
varying vec3 fragPosition;
varying vec4 fragColor;

void main() {
  if (
    outOfRange(clipBounds[0], clipBounds[1], fragPosition) ||
    fragColor.a * opacity == 0.
  ) discard;

  gl_FragColor = opacity * fragColor;
}`]);S.exports=function(t){return a(t,n,r,null,[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"offset",type:"vec3"}])}},{"gl-shader":132,glslify:231}],86:[function(v,S,M){var e=v("gl-texture2d");S.exports=A;var a=null,n,r,t,c;function o(b){var f=b.getParameter(b.FRAMEBUFFER_BINDING),x=b.getParameter(b.RENDERBUFFER_BINDING),l=b.getParameter(b.TEXTURE_BINDING_2D);return[f,x,l]}function i(b,f){b.bindFramebuffer(b.FRAMEBUFFER,f[0]),b.bindRenderbuffer(b.RENDERBUFFER,f[1]),b.bindTexture(b.TEXTURE_2D,f[2])}function y(b,f){var x=b.getParameter(f.MAX_COLOR_ATTACHMENTS_WEBGL);a=new Array(x+1);for(var l=0;l<=x;++l){for(var L=new Array(x),T=0;T<l;++T)L[T]=b.COLOR_ATTACHMENT0+T;for(var T=l;T<x;++T)L[T]=b.NONE;a[l]=L}}function p(b){switch(b){case n:throw new Error("gl-fbo: Framebuffer unsupported");case r:throw new Error("gl-fbo: Framebuffer incomplete attachment");case t:throw new Error("gl-fbo: Framebuffer incomplete dimensions");case c:throw new Error("gl-fbo: Framebuffer incomplete missing attachment");default:throw new Error("gl-fbo: Framebuffer failed for unspecified reason")}}function g(b,f,x,l,L,T){if(!l)return null;var k=e(b,f,x,L,l);return k.magFilter=b.NEAREST,k.minFilter=b.NEAREST,k.mipSamples=1,k.bind(),b.framebufferTexture2D(b.FRAMEBUFFER,T,b.TEXTURE_2D,k.handle,0),k}function h(b,f,x,l,L){var T=b.createRenderbuffer();return b.bindRenderbuffer(b.RENDERBUFFER,T),b.renderbufferStorage(b.RENDERBUFFER,l,f,x),b.framebufferRenderbuffer(b.FRAMEBUFFER,L,b.RENDERBUFFER,T),T}function m(b){var f=o(b.gl),x=b.gl,l=b.handle=x.createFramebuffer(),L=b._shape[0],T=b._shape[1],k=b.color.length,P=b._ext,z=b._useStencil,I=b._useDepth,D=b._colorType;x.bindFramebuffer(x.FRAMEBUFFER,l);for(var R=0;R<k;++R)b.color[R]=g(x,L,T,D,x.RGBA,x.COLOR_ATTACHMENT0+R);k===0?(b._color_rb=h(x,L,T,x.RGBA4,x.COLOR_ATTACHMENT0),P&&P.drawBuffersWEBGL(a[0])):k>1&&P.drawBuffersWEBGL(a[k]);var B=x.getExtension("WEBGL_depth_texture");B?z?b.depth=g(x,L,T,B.UNSIGNED_INT_24_8_WEBGL,x.DEPTH_STENCIL,x.DEPTH_STENCIL_ATTACHMENT):I&&(b.depth=g(x,L,T,x.UNSIGNED_SHORT,x.DEPTH_COMPONENT,x.DEPTH_ATTACHMENT)):I&&z?b._depth_rb=h(x,L,T,x.DEPTH_STENCIL,x.DEPTH_STENCIL_ATTACHMENT):I?b._depth_rb=h(x,L,T,x.DEPTH_COMPONENT16,x.DEPTH_ATTACHMENT):z&&(b._depth_rb=h(x,L,T,x.STENCIL_INDEX,x.STENCIL_ATTACHMENT));var F=x.checkFramebufferStatus(x.FRAMEBUFFER);if(F!==x.FRAMEBUFFER_COMPLETE){b._destroyed=!0,x.bindFramebuffer(x.FRAMEBUFFER,null),x.deleteFramebuffer(b.handle),b.handle=null,b.depth&&(b.depth.dispose(),b.depth=null),b._depth_rb&&(x.deleteRenderbuffer(b._depth_rb),b._depth_rb=null);for(var R=0;R<b.color.length;++R)b.color[R].dispose(),b.color[R]=null;b._color_rb&&(x.deleteRenderbuffer(b._color_rb),b._color_rb=null),i(x,f),p(F)}i(x,f)}function u(b,f,x,l,L,T,k,P){this.gl=b,this._shape=[f|0,x|0],this._destroyed=!1,this._ext=P,this.color=new Array(L);for(var z=0;z<L;++z)this.color[z]=null;this._color_rb=null,this.depth=null,this._depth_rb=null,this._colorType=l,this._useDepth=T,this._useStencil=k;var I=this,D=[f|0,x|0];Object.defineProperties(D,{0:{get:function(){return I._shape[0]},set:function(R){return I.width=R}},1:{get:function(){return I._shape[1]},set:function(R){return I.height=R}}}),this._shapeVector=D,m(this)}var _=u.prototype;function s(b,f,x){if(b._destroyed)throw new Error("gl-fbo: Can't resize destroyed FBO");if(!(b._shape[0]===f&&b._shape[1]===x)){var l=b.gl,L=l.getParameter(l.MAX_RENDERBUFFER_SIZE);if(f<0||f>L||x<0||x>L)throw new Error("gl-fbo: Can't resize FBO, invalid dimensions");b._shape[0]=f,b._shape[1]=x;for(var T=o(l),k=0;k<b.color.length;++k)b.color[k].shape=b._shape;b._color_rb&&(l.bindRenderbuffer(l.RENDERBUFFER,b._color_rb),l.renderbufferStorage(l.RENDERBUFFER,l.RGBA4,b._shape[0],b._shape[1])),b.depth&&(b.depth.shape=b._shape),b._depth_rb&&(l.bindRenderbuffer(l.RENDERBUFFER,b._depth_rb),b._useDepth&&b._useStencil?l.renderbufferStorage(l.RENDERBUFFER,l.DEPTH_STENCIL,b._shape[0],b._shape[1]):b._useDepth?l.renderbufferStorage(l.RENDERBUFFER,l.DEPTH_COMPONENT16,b._shape[0],b._shape[1]):b._useStencil&&l.renderbufferStorage(l.RENDERBUFFER,l.STENCIL_INDEX,b._shape[0],b._shape[1])),l.bindFramebuffer(l.FRAMEBUFFER,b.handle);var P=l.checkFramebufferStatus(l.FRAMEBUFFER);P!==l.FRAMEBUFFER_COMPLETE&&(b.dispose(),i(l,T),p(P)),i(l,T)}}Object.defineProperties(_,{shape:{get:function(){return this._destroyed?[0,0]:this._shapeVector},set:function(b){if(Array.isArray(b)||(b=[b|0,b|0]),b.length!==2)throw new Error("gl-fbo: Shape vector must be length 2");var f=b[0]|0,x=b[1]|0;return s(this,f,x),[f,x]},enumerable:!1},width:{get:function(){return this._destroyed?0:this._shape[0]},set:function(b){return b=b|0,s(this,b,this._shape[1]),b},enumerable:!1},height:{get:function(){return this._destroyed?0:this._shape[1]},set:function(b){return b=b|0,s(this,this._shape[0],b),b},enumerable:!1}}),_.bind=function(){if(!this._destroyed){var b=this.gl;b.bindFramebuffer(b.FRAMEBUFFER,this.handle),b.viewport(0,0,this._shape[0],this._shape[1])}},_.dispose=function(){if(!this._destroyed){this._destroyed=!0;var b=this.gl;b.deleteFramebuffer(this.handle),this.handle=null,this.depth&&(this.depth.dispose(),this.depth=null),this._depth_rb&&(b.deleteRenderbuffer(this._depth_rb),this._depth_rb=null);for(var f=0;f<this.color.length;++f)this.color[f].dispose(),this.color[f]=null;this._color_rb&&(b.deleteRenderbuffer(this._color_rb),this._color_rb=null)}};function A(b,f,x,l){n||(n=b.FRAMEBUFFER_UNSUPPORTED,r=b.FRAMEBUFFER_INCOMPLETE_ATTACHMENT,t=b.FRAMEBUFFER_INCOMPLETE_DIMENSIONS,c=b.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT);var L=b.getExtension("WEBGL_draw_buffers");if(!a&&L&&y(b,L),Array.isArray(f)&&(l=x,x=f[1]|0,f=f[0]|0),typeof f!="number")throw new Error("gl-fbo: Missing shape parameter");var T=b.getParameter(b.MAX_RENDERBUFFER_SIZE);if(f<0||f>T||x<0||x>T)throw new Error("gl-fbo: Parameters are too large for FBO");l=l||{};var k=1;if("color"in l){if(k=Math.max(l.color|0,0),k<0)throw new Error("gl-fbo: Must specify a nonnegative number of colors");if(k>1)if(L){if(k>b.getParameter(L.MAX_COLOR_ATTACHMENTS_WEBGL))throw new Error("gl-fbo: Context does not support "+k+" draw buffers")}else throw new Error("gl-fbo: Multiple draw buffer extension not supported")}var P=b.UNSIGNED_BYTE,z=b.getExtension("OES_texture_float");if(l.float&&k>0){if(!z)throw new Error("gl-fbo: Context does not support floating point textures");P=b.FLOAT}else l.preferFloat&&k>0&&z&&(P=b.FLOAT);var I=!0;"depth"in l&&(I=!!l.depth);var D=!1;return"stencil"in l&&(D=!!l.stencil),new u(b,f,x,P,k,I,D,L)}},{"gl-texture2d":146}],87:[function(v,S,M){var e=v("sprintf-js").sprintf,a=v("gl-constants/lookup"),n=v("glsl-shader-name"),r=v("add-line-numbers");S.exports=t;function t(c,o,i){var y=n(o)||"of unknown name (see npm glsl-shader-name)",p="unknown type";i!==void 0&&(p=i===a.FRAGMENT_SHADER?"fragment":"vertex");for(var g=e(`Error compiling %s shader %s:
`,p,y),h=e("%s%s",g,c),m=c.split(`
`),u={},_=0;_<m.length;_++){var s=m[_];if(!(s===""||s==="\0")){var A=parseInt(s.split(":")[2]);if(isNaN(A))throw new Error(e("Could not parse error: %s",s));u[A]=s}}for(var b=r(o).split(`
`),_=0;_<b.length;_++)if(!(!u[_+3]&&!u[_+2]&&!u[_+1])){var f=b[_];if(g+=f+`
`,u[_+1]){var x=u[_+1];x=x.substr(x.split(":",3).join(":").length+1).trim(),g+=e(`^^^ %s

`,x)}}return{long:g.trim(),short:h.trim()}}},{"add-line-numbers":9,"gl-constants/lookup":83,"glsl-shader-name":223,"sprintf-js":301}],88:[function(v,S,M){S.exports=p;var e=v("binary-search-bounds"),a=v("iota-array"),n=v("typedarray-pool"),r=v("gl-shader"),t=v("gl-buffer"),c=v("./lib/shaders");function o(g,h,m,u,_,s,A){this.plot=g,this.shader=h,this.pickShader=m,this.positionBuffer=u,this.weightBuffer=_,this.colorBuffer=s,this.idBuffer=A,this.xData=[],this.yData=[],this.shape=[0,0],this.bounds=[1/0,1/0,-1/0,-1/0],this.pickOffset=0}var i=o.prototype,y=[0,0,1,0,0,1,1,0,1,1,0,1];i.draw=function(){var g=[1,0,0,0,1,0,0,0,1];return function(){var h=this.plot,m=this.shader,u=this.bounds,_=this.numVertices;if(!(_<=0)){var s=h.gl,A=h.dataBox,b=u[2]-u[0],f=u[3]-u[1],x=A[2]-A[0],l=A[3]-A[1];g[0]=2*b/x,g[4]=2*f/l,g[6]=2*(u[0]-A[0])/x-1,g[7]=2*(u[1]-A[1])/l-1,m.bind();var L=m.uniforms;L.viewTransform=g,L.shape=this.shape;var T=m.attributes;this.positionBuffer.bind(),T.position.pointer(),this.weightBuffer.bind(),T.weight.pointer(s.UNSIGNED_BYTE,!1),this.colorBuffer.bind(),T.color.pointer(s.UNSIGNED_BYTE,!0),s.drawArrays(s.TRIANGLES,0,_)}}}(),i.drawPick=function(){var g=[1,0,0,0,1,0,0,0,1],h=[0,0,0,0];return function(m){var u=this.plot,_=this.pickShader,s=this.bounds,A=this.numVertices;if(!(A<=0)){var b=u.gl,f=u.dataBox,x=s[2]-s[0],l=s[3]-s[1],L=f[2]-f[0],T=f[3]-f[1];g[0]=2*x/L,g[4]=2*l/T,g[6]=2*(s[0]-f[0])/L-1,g[7]=2*(s[1]-f[1])/T-1;for(var k=0;k<4;++k)h[k]=m>>k*8&255;this.pickOffset=m,_.bind();var P=_.uniforms;P.viewTransform=g,P.pickOffset=h,P.shape=this.shape;var z=_.attributes;return this.positionBuffer.bind(),z.position.pointer(),this.weightBuffer.bind(),z.weight.pointer(b.UNSIGNED_BYTE,!1),this.idBuffer.bind(),z.pickId.pointer(b.UNSIGNED_BYTE,!1),b.drawArrays(b.TRIANGLES,0,A),m+this.shape[0]*this.shape[1]}}}(),i.pick=function(g,h,m){var u=this.pickOffset,_=this.shape[0]*this.shape[1];if(m<u||m>=u+_)return null;var s=m-u,A=this.xData,b=this.yData;return{object:this,pointId:s,dataCoord:[A[s%this.shape[0]],b[s/this.shape[0]|0]]}},i.update=function(g){g=g||{};var h=g.shape||[0,0],m=g.x||a(h[0]),u=g.y||a(h[1]),_=g.z||new Float32Array(h[0]*h[1]),s=g.zsmooth!==!1;this.xData=m,this.yData=u;var A=g.colorLevels||[0],b=g.colorValues||[0,0,0,1],f=A.length,x=this.bounds,l,L,T,k;s?(l=x[0]=m[0],L=x[1]=u[0],T=x[2]=m[m.length-1],k=x[3]=u[u.length-1]):(l=x[0]=m[0]+(m[1]-m[0])/2,L=x[1]=u[0]+(u[1]-u[0])/2,T=x[2]=m[m.length-1]+(m[m.length-1]-m[m.length-2])/2,k=x[3]=u[u.length-1]+(u[u.length-1]-u[u.length-2])/2);var P=1/(T-l),z=1/(k-L),I=h[0],D=h[1];this.shape=[I,D];var R=(s?(I-1)*(D-1):I*D)*(y.length>>>1);this.numVertices=R;for(var B=n.mallocUint8(R*4),F=n.mallocFloat32(R*2),H=n.mallocUint8(R*2),G=n.mallocUint32(R),J=0,X=s?I-1:I,Y=s?D-1:D,Z=0;Z<Y;++Z){var oe,re;s?(oe=z*(u[Z]-L),re=z*(u[Z+1]-L)):(oe=Z<D-1?z*(u[Z]-(u[Z+1]-u[Z])/2-L):z*(u[Z]-(u[Z]-u[Z-1])/2-L),re=Z<D-1?z*(u[Z]+(u[Z+1]-u[Z])/2-L):z*(u[Z]+(u[Z]-u[Z-1])/2-L));for(var se=0;se<X;++se){var N,U;s?(N=P*(m[se]-l),U=P*(m[se+1]-l)):(N=se<I-1?P*(m[se]-(m[se+1]-m[se])/2-l):P*(m[se]-(m[se]-m[se-1])/2-l),U=se<I-1?P*(m[se]+(m[se+1]-m[se])/2-l):P*(m[se]+(m[se]-m[se-1])/2-l));for(var q=0;q<y.length;q+=2){var $=y[q],W=y[q+1],K=s?(Z+W)*I+(se+$):Z*I+se,ne=_[K],ae=e.le(A,ne),ie,le,ye,ue;if(ae<0)ie=b[0],le=b[1],ye=b[2],ue=b[3];else if(ae===f-1)ie=b[4*f-4],le=b[4*f-3],ye=b[4*f-2],ue=b[4*f-1];else{var pe=(ne-A[ae])/(A[ae+1]-A[ae]),ge=1-pe,Te=4*ae,_e=4*(ae+1);ie=ge*b[Te]+pe*b[_e],le=ge*b[Te+1]+pe*b[_e+1],ye=ge*b[Te+2]+pe*b[_e+2],ue=ge*b[Te+3]+pe*b[_e+3]}B[4*J]=255*ie,B[4*J+1]=255*le,B[4*J+2]=255*ye,B[4*J+3]=255*ue,F[2*J]=N*.5+U*.5,F[2*J+1]=oe*.5+re*.5,H[2*J]=$,H[2*J+1]=W,G[J]=Z*I+se,J+=1}}}this.positionBuffer.update(F),this.weightBuffer.update(H),this.colorBuffer.update(B),this.idBuffer.update(G),n.free(F),n.free(B),n.free(H),n.free(G)},i.dispose=function(){this.shader.dispose(),this.pickShader.dispose(),this.positionBuffer.dispose(),this.weightBuffer.dispose(),this.colorBuffer.dispose(),this.idBuffer.dispose(),this.plot.removeObject(this)};function p(g,h){var m=g.gl,u=r(m,c.vertex,c.fragment),_=r(m,c.pickVertex,c.pickFragment),s=t(m),A=t(m),b=t(m),f=t(m),x=new o(g,u,_,s,A,b,f);return x.update(h),g.addObject(x),x}},{"./lib/shaders":89,"binary-search-bounds":31,"gl-buffer":78,"gl-shader":132,"iota-array":235,"typedarray-pool":308}],89:[function(v,S,M){var e=v("glslify");S.exports={fragment:e([`precision lowp float;
#define GLSLIFY 1
varying vec4 fragColor;
void main() {
  gl_FragColor = vec4(fragColor.rgb * fragColor.a, fragColor.a);
}
`]),vertex:e([`precision mediump float;
#define GLSLIFY 1

attribute vec2 position;
attribute vec4 color;
attribute vec2 weight;

uniform vec2 shape;
uniform mat3 viewTransform;

varying vec4 fragColor;

void main() {
  vec3 vPosition = viewTransform * vec3( position + (weight-.5)/(shape-1.) , 1.0);
  fragColor = color;
  gl_Position = vec4(vPosition.xy, 0, vPosition.z);
}
`]),pickFragment:e([`precision mediump float;
#define GLSLIFY 1

varying vec4 fragId;
varying vec2 vWeight;

uniform vec2 shape;
uniform vec4 pickOffset;

void main() {
  vec2 d = step(.5, vWeight);
  vec4 id = fragId + pickOffset;
  id.x += d.x + d.y*shape.x;

  id.y += floor(id.x / 256.0);
  id.x -= floor(id.x / 256.0) * 256.0;

  id.z += floor(id.y / 256.0);
  id.y -= floor(id.y / 256.0) * 256.0;

  id.w += floor(id.z / 256.0);
  id.z -= floor(id.z / 256.0) * 256.0;

  gl_FragColor = id/255.;
}
`]),pickVertex:e([`precision mediump float;
#define GLSLIFY 1

attribute vec2 position;
attribute vec4 pickId;
attribute vec2 weight;

uniform vec2 shape;
uniform mat3 viewTransform;

varying vec4 fragId;
varying vec2 vWeight;

void main() {
  vWeight = weight;

  fragId = pickId;

  vec3 vPosition = viewTransform * vec3( position + (weight-.5)/(shape-1.) , 1.0);
  gl_Position = vec4(vPosition.xy, 0, vPosition.z);
}
`])}},{glslify:231}],90:[function(v,S,M){var e=v("glslify"),a=v("gl-shader"),n=e([`precision highp float;
#define GLSLIFY 1

attribute vec3 position, nextPosition;
attribute float arcLength, lineWidth;
attribute vec4 color;

uniform vec2 screenShape;
uniform float pixelRatio;
uniform mat4 model, view, projection;

varying vec4 fragColor;
varying vec3 worldPosition;
varying float pixelArcLength;

vec4 project(vec3 p) {
  return projection * view * model * vec4(p, 1.0);
}

void main() {
  vec4 startPoint = project(position);
  vec4 endPoint   = project(nextPosition);

  vec2 A = startPoint.xy / startPoint.w;
  vec2 B =   endPoint.xy /   endPoint.w;

  float clipAngle = atan(
    (B.y - A.y) * screenShape.y,
    (B.x - A.x) * screenShape.x
  );

  vec2 offset = 0.5 * pixelRatio * lineWidth * vec2(
    sin(clipAngle),
    -cos(clipAngle)
  ) / screenShape;

  gl_Position = vec4(startPoint.xy + startPoint.w * offset, startPoint.zw);

  worldPosition = position;
  pixelArcLength = arcLength;
  fragColor = color;
}
`]),r=e([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3      clipBounds[2];
uniform sampler2D dashTexture;
uniform float     dashScale;
uniform float     opacity;

varying vec3    worldPosition;
varying float   pixelArcLength;
varying vec4    fragColor;

void main() {
  if (
    outOfRange(clipBounds[0], clipBounds[1], worldPosition) ||
    fragColor.a * opacity == 0.
  ) discard;

  float dashWeight = texture2D(dashTexture, vec2(dashScale * pixelArcLength, 0)).r;
  if(dashWeight < 0.5) {
    discard;
  }
  gl_FragColor = fragColor * opacity;
}
`]),t=e([`precision highp float;
#define GLSLIFY 1

#define FLOAT_MAX  1.70141184e38
#define FLOAT_MIN  1.17549435e-38

// https://github.com/mikolalysenko/glsl-read-float/blob/master/index.glsl
vec4 packFloat(float v) {
  float av = abs(v);

  //Handle special cases
  if(av < FLOAT_MIN) {
    return vec4(0.0, 0.0, 0.0, 0.0);
  } else if(v > FLOAT_MAX) {
    return vec4(127.0, 128.0, 0.0, 0.0) / 255.0;
  } else if(v < -FLOAT_MAX) {
    return vec4(255.0, 128.0, 0.0, 0.0) / 255.0;
  }

  vec4 c = vec4(0,0,0,0);

  //Compute exponent and mantissa
  float e = floor(log2(av));
  float m = av * pow(2.0, -e) - 1.0;

  //Unpack mantissa
  c[1] = floor(128.0 * m);
  m -= c[1] / 128.0;
  c[2] = floor(32768.0 * m);
  m -= c[2] / 32768.0;
  c[3] = floor(8388608.0 * m);

  //Unpack exponent
  float ebias = e + 127.0;
  c[0] = floor(ebias / 2.0);
  ebias -= c[0] * 2.0;
  c[1] += floor(ebias) * 128.0;

  //Unpack sign bit
  c[0] += 128.0 * step(0.0, -v);

  //Scale back to range
  return c / 255.0;
}

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform float pickId;
uniform vec3 clipBounds[2];

varying vec3 worldPosition;
varying float pixelArcLength;
varying vec4 fragColor;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], worldPosition)) discard;

  gl_FragColor = vec4(pickId/255.0, packFloat(pixelArcLength).xyz);
}`]),c=[{name:"position",type:"vec3"},{name:"nextPosition",type:"vec3"},{name:"arcLength",type:"float"},{name:"lineWidth",type:"float"},{name:"color",type:"vec4"}];M.createShader=function(o){return a(o,n,r,null,c)},M.createPickShader=function(o){return a(o,n,t,null,c)}},{"gl-shader":132,glslify:231}],91:[function(v,S,M){S.exports=b;var e=v("gl-buffer"),a=v("gl-vao"),n=v("gl-texture2d"),r=new Uint8Array(4),t=new Float32Array(r.buffer);function c(f,x,l,L){return r[0]=L,r[1]=l,r[2]=x,r[3]=f,t[0]}var o=v("binary-search-bounds"),i=v("ndarray"),y=v("./lib/shaders"),p=y.createShader,g=y.createPickShader,h=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function m(f,x){for(var l=0,L=0;L<3;++L){var T=f[L]-x[L];l+=T*T}return Math.sqrt(l)}function u(f){for(var x=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],l=0;l<3;++l)x[0][l]=Math.max(f[0][l],x[0][l]),x[1][l]=Math.min(f[1][l],x[1][l]);return x}function _(f,x,l,L){this.arcLength=f,this.position=x,this.index=l,this.dataCoordinate=L}function s(f,x,l,L,T,k){this.gl=f,this.shader=x,this.pickShader=l,this.buffer=L,this.vao=T,this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.points=[],this.arcLength=[],this.vertexCount=0,this.bounds=[[0,0,0],[0,0,0]],this.pickId=0,this.lineWidth=1,this.texture=k,this.dashScale=1,this.opacity=1,this.hasAlpha=!1,this.dirty=!0,this.pixelRatio=1}var A=s.prototype;A.isTransparent=function(){return this.hasAlpha},A.isOpaque=function(){return!this.hasAlpha},A.pickSlots=1,A.setPickBase=function(f){this.pickId=f},A.drawTransparent=A.draw=function(f){if(!!this.vertexCount){var x=this.gl,l=this.shader,L=this.vao;l.bind(),l.uniforms={model:f.model||h,view:f.view||h,projection:f.projection||h,clipBounds:u(this.clipBounds),dashTexture:this.texture.bind(),dashScale:this.dashScale/this.arcLength[this.arcLength.length-1],opacity:this.opacity,screenShape:[x.drawingBufferWidth,x.drawingBufferHeight],pixelRatio:this.pixelRatio},L.bind(),L.draw(x.TRIANGLE_STRIP,this.vertexCount),L.unbind()}},A.drawPick=function(f){if(!!this.vertexCount){var x=this.gl,l=this.pickShader,L=this.vao;l.bind(),l.uniforms={model:f.model||h,view:f.view||h,projection:f.projection||h,pickId:this.pickId,clipBounds:u(this.clipBounds),screenShape:[x.drawingBufferWidth,x.drawingBufferHeight],pixelRatio:this.pixelRatio},L.bind(),L.draw(x.TRIANGLE_STRIP,this.vertexCount),L.unbind()}},A.update=function(f){var x,l;this.dirty=!0;var L=!!f.connectGaps;"dashScale"in f&&(this.dashScale=f.dashScale),this.hasAlpha=!1,"opacity"in f&&(this.opacity=+f.opacity,this.opacity<1&&(this.hasAlpha=!0));var T=[],k=[],P=[],z=0,I=0,D=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],R=f.position||f.positions;if(R){var B=f.color||f.colors||[0,0,0,1],F=f.lineWidth||1,H=!1;e:for(x=1;x<R.length;++x){var G=R[x-1],J=R[x];for(k.push(z),P.push(G.slice()),l=0;l<3;++l){if(isNaN(G[l])||isNaN(J[l])||!isFinite(G[l])||!isFinite(J[l])){if(!L&&T.length>0){for(var X=0;X<24;++X)T.push(T[T.length-12]);I+=2,H=!0}continue e}D[0][l]=Math.min(D[0][l],G[l],J[l]),D[1][l]=Math.max(D[1][l],G[l],J[l])}var Y,Z;Array.isArray(B[0])?(Y=B.length>x-1?B[x-1]:B.length>0?B[B.length-1]:[0,0,0,1],Z=B.length>x?B[x]:B.length>0?B[B.length-1]:[0,0,0,1]):Y=Z=B,Y.length===3&&(Y=[Y[0],Y[1],Y[2],1]),Z.length===3&&(Z=[Z[0],Z[1],Z[2],1]),!this.hasAlpha&&Y[3]<1&&(this.hasAlpha=!0);var oe;Array.isArray(F)?oe=F.length>x-1?F[x-1]:F.length>0?F[F.length-1]:[0,0,0,1]:oe=F;var re=z;if(z+=m(G,J),H){for(l=0;l<2;++l)T.push(G[0],G[1],G[2],J[0],J[1],J[2],re,oe,Y[0],Y[1],Y[2],Y[3]);I+=2,H=!1}T.push(G[0],G[1],G[2],J[0],J[1],J[2],re,oe,Y[0],Y[1],Y[2],Y[3],G[0],G[1],G[2],J[0],J[1],J[2],re,-oe,Y[0],Y[1],Y[2],Y[3],J[0],J[1],J[2],G[0],G[1],G[2],z,-oe,Z[0],Z[1],Z[2],Z[3],J[0],J[1],J[2],G[0],G[1],G[2],z,oe,Z[0],Z[1],Z[2],Z[3]),I+=4}}if(this.buffer.update(T),k.push(z),P.push(R[R.length-1].slice()),this.bounds=D,this.vertexCount=I,this.points=P,this.arcLength=k,"dashes"in f){var se=f.dashes,N=se.slice();for(N.unshift(0),x=1;x<N.length;++x)N[x]=N[x-1]+N[x];var U=i(new Array(256*4),[256,1,4]);for(x=0;x<256;++x){for(l=0;l<4;++l)U.set(x,0,l,0);o.le(N,N[N.length-1]*x/255)&1?U.set(x,0,0,0):U.set(x,0,0,255)}this.texture.setPixels(U)}},A.dispose=function(){this.shader.dispose(),this.vao.dispose(),this.buffer.dispose()},A.pick=function(f){if(!f||f.id!==this.pickId)return null;var x=c(f.value[0],f.value[1],f.value[2],0),l=o.le(this.arcLength,x);if(l<0)return null;if(l===this.arcLength.length-1)return new _(this.arcLength[this.arcLength.length-1],this.points[this.points.length-1].slice(),l);for(var L=this.points[l],T=this.points[Math.min(l+1,this.points.length-1)],k=(x-this.arcLength[l])/(this.arcLength[l+1]-this.arcLength[l]),P=1-k,z=[0,0,0],I=0;I<3;++I)z[I]=P*L[I]+k*T[I];var D=Math.min(k<.5?l:l+1,this.points.length-1);return new _(x,z,D,this.points[D])};function b(f){var x=f.gl||f.scene&&f.scene.gl,l=p(x);l.attributes.position.location=0,l.attributes.nextPosition.location=1,l.attributes.arcLength.location=2,l.attributes.lineWidth.location=3,l.attributes.color.location=4;var L=g(x);L.attributes.position.location=0,L.attributes.nextPosition.location=1,L.attributes.arcLength.location=2,L.attributes.lineWidth.location=3,L.attributes.color.location=4;for(var T=e(x),k=a(x,[{buffer:T,size:3,offset:0,stride:48},{buffer:T,size:3,offset:12,stride:48},{buffer:T,size:1,offset:24,stride:48},{buffer:T,size:1,offset:28,stride:48},{buffer:T,size:4,offset:32,stride:48}]),P=i(new Array(256*4),[256,1,4]),z=0;z<256*4;++z)P.data[z]=255;var I=n(x,P);I.wrap=x.REPEAT;var D=new s(x,l,L,T,k,I);return D.update(f),D}},{"./lib/shaders":90,"binary-search-bounds":31,"gl-buffer":78,"gl-texture2d":146,"gl-vao":150,ndarray:259}],92:[function(v,S,M){S.exports=e;function e(a){var n=new Float32Array(16);return n[0]=a[0],n[1]=a[1],n[2]=a[2],n[3]=a[3],n[4]=a[4],n[5]=a[5],n[6]=a[6],n[7]=a[7],n[8]=a[8],n[9]=a[9],n[10]=a[10],n[11]=a[11],n[12]=a[12],n[13]=a[13],n[14]=a[14],n[15]=a[15],n}},{}],93:[function(v,S,M){S.exports=e;function e(){var a=new Float32Array(16);return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}},{}],94:[function(v,S,M){S.exports=e;function e(a){var n=a[0],r=a[1],t=a[2],c=a[3],o=a[4],i=a[5],y=a[6],p=a[7],g=a[8],h=a[9],m=a[10],u=a[11],_=a[12],s=a[13],A=a[14],b=a[15],f=n*i-r*o,x=n*y-t*o,l=n*p-c*o,L=r*y-t*i,T=r*p-c*i,k=t*p-c*y,P=g*s-h*_,z=g*A-m*_,I=g*b-u*_,D=h*A-m*s,R=h*b-u*s,B=m*b-u*A;return f*B-x*R+l*D+L*I-T*z+k*P}},{}],95:[function(v,S,M){S.exports=e;function e(a,n){var r=n[0],t=n[1],c=n[2],o=n[3],i=r+r,y=t+t,p=c+c,g=r*i,h=t*i,m=t*y,u=c*i,_=c*y,s=c*p,A=o*i,b=o*y,f=o*p;return a[0]=1-m-s,a[1]=h+f,a[2]=u-b,a[3]=0,a[4]=h-f,a[5]=1-g-s,a[6]=_+A,a[7]=0,a[8]=u+b,a[9]=_-A,a[10]=1-g-m,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}},{}],96:[function(v,S,M){S.exports=e;function e(a,n,r){var t=n[0],c=n[1],o=n[2],i=n[3],y=t+t,p=c+c,g=o+o,h=t*y,m=t*p,u=t*g,_=c*p,s=c*g,A=o*g,b=i*y,f=i*p,x=i*g;return a[0]=1-(_+A),a[1]=m+x,a[2]=u-f,a[3]=0,a[4]=m-x,a[5]=1-(h+A),a[6]=s+b,a[7]=0,a[8]=u+f,a[9]=s-b,a[10]=1-(h+_),a[11]=0,a[12]=r[0],a[13]=r[1],a[14]=r[2],a[15]=1,a}},{}],97:[function(v,S,M){S.exports=e;function e(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}},{}],98:[function(v,S,M){S.exports=e;function e(a,n){var r=n[0],t=n[1],c=n[2],o=n[3],i=n[4],y=n[5],p=n[6],g=n[7],h=n[8],m=n[9],u=n[10],_=n[11],s=n[12],A=n[13],b=n[14],f=n[15],x=r*y-t*i,l=r*p-c*i,L=r*g-o*i,T=t*p-c*y,k=t*g-o*y,P=c*g-o*p,z=h*A-m*s,I=h*b-u*s,D=h*f-_*s,R=m*b-u*A,B=m*f-_*A,F=u*f-_*b,H=x*F-l*B+L*R+T*D-k*I+P*z;return H?(H=1/H,a[0]=(y*F-p*B+g*R)*H,a[1]=(c*B-t*F-o*R)*H,a[2]=(A*P-b*k+f*T)*H,a[3]=(u*k-m*P-_*T)*H,a[4]=(p*D-i*F-g*I)*H,a[5]=(r*F-c*D+o*I)*H,a[6]=(b*L-s*P-f*l)*H,a[7]=(h*P-u*L+_*l)*H,a[8]=(i*B-y*D+g*z)*H,a[9]=(t*D-r*B-o*z)*H,a[10]=(s*k-A*L+f*x)*H,a[11]=(m*L-h*k-_*x)*H,a[12]=(y*I-i*R-p*z)*H,a[13]=(r*R-t*I+c*z)*H,a[14]=(A*l-s*T-b*x)*H,a[15]=(h*T-m*l+u*x)*H,a):null}},{}],99:[function(v,S,M){var e=v("./identity");S.exports=a;function a(n,r,t,c){var o,i,y,p,g,h,m,u,_,s,A=r[0],b=r[1],f=r[2],x=c[0],l=c[1],L=c[2],T=t[0],k=t[1],P=t[2];return Math.abs(A-T)<1e-6&&Math.abs(b-k)<1e-6&&Math.abs(f-P)<1e-6?e(n):(m=A-T,u=b-k,_=f-P,s=1/Math.sqrt(m*m+u*u+_*_),m*=s,u*=s,_*=s,o=l*_-L*u,i=L*m-x*_,y=x*u-l*m,s=Math.sqrt(o*o+i*i+y*y),s?(s=1/s,o*=s,i*=s,y*=s):(o=0,i=0,y=0),p=u*y-_*i,g=_*o-m*y,h=m*i-u*o,s=Math.sqrt(p*p+g*g+h*h),s?(s=1/s,p*=s,g*=s,h*=s):(p=0,g=0,h=0),n[0]=o,n[1]=p,n[2]=m,n[3]=0,n[4]=i,n[5]=g,n[6]=u,n[7]=0,n[8]=y,n[9]=h,n[10]=_,n[11]=0,n[12]=-(o*A+i*b+y*f),n[13]=-(p*A+g*b+h*f),n[14]=-(m*A+u*b+_*f),n[15]=1,n)}},{"./identity":97}],100:[function(v,S,M){S.exports=e;function e(a,n,r){var t=n[0],c=n[1],o=n[2],i=n[3],y=n[4],p=n[5],g=n[6],h=n[7],m=n[8],u=n[9],_=n[10],s=n[11],A=n[12],b=n[13],f=n[14],x=n[15],l=r[0],L=r[1],T=r[2],k=r[3];return a[0]=l*t+L*y+T*m+k*A,a[1]=l*c+L*p+T*u+k*b,a[2]=l*o+L*g+T*_+k*f,a[3]=l*i+L*h+T*s+k*x,l=r[4],L=r[5],T=r[6],k=r[7],a[4]=l*t+L*y+T*m+k*A,a[5]=l*c+L*p+T*u+k*b,a[6]=l*o+L*g+T*_+k*f,a[7]=l*i+L*h+T*s+k*x,l=r[8],L=r[9],T=r[10],k=r[11],a[8]=l*t+L*y+T*m+k*A,a[9]=l*c+L*p+T*u+k*b,a[10]=l*o+L*g+T*_+k*f,a[11]=l*i+L*h+T*s+k*x,l=r[12],L=r[13],T=r[14],k=r[15],a[12]=l*t+L*y+T*m+k*A,a[13]=l*c+L*p+T*u+k*b,a[14]=l*o+L*g+T*_+k*f,a[15]=l*i+L*h+T*s+k*x,a}},{}],101:[function(v,S,M){S.exports=e;function e(a,n,r,t,c,o,i){var y=1/(n-r),p=1/(t-c),g=1/(o-i);return a[0]=-2*y,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=-2*p,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=2*g,a[11]=0,a[12]=(n+r)*y,a[13]=(c+t)*p,a[14]=(i+o)*g,a[15]=1,a}},{}],102:[function(v,S,M){S.exports=e;function e(a,n,r,t,c){var o=1/Math.tan(n/2),i=1/(t-c);return a[0]=o/r,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=o,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=(c+t)*i,a[11]=-1,a[12]=0,a[13]=0,a[14]=2*c*t*i,a[15]=0,a}},{}],103:[function(v,S,M){S.exports=e;function e(a,n,r,t){var c=t[0],o=t[1],i=t[2],y=Math.sqrt(c*c+o*o+i*i),p,g,h,m,u,_,s,A,b,f,x,l,L,T,k,P,z,I,D,R,B,F,H,G;return Math.abs(y)<1e-6?null:(y=1/y,c*=y,o*=y,i*=y,p=Math.sin(r),g=Math.cos(r),h=1-g,m=n[0],u=n[1],_=n[2],s=n[3],A=n[4],b=n[5],f=n[6],x=n[7],l=n[8],L=n[9],T=n[10],k=n[11],P=c*c*h+g,z=o*c*h+i*p,I=i*c*h-o*p,D=c*o*h-i*p,R=o*o*h+g,B=i*o*h+c*p,F=c*i*h+o*p,H=o*i*h-c*p,G=i*i*h+g,a[0]=m*P+A*z+l*I,a[1]=u*P+b*z+L*I,a[2]=_*P+f*z+T*I,a[3]=s*P+x*z+k*I,a[4]=m*D+A*R+l*B,a[5]=u*D+b*R+L*B,a[6]=_*D+f*R+T*B,a[7]=s*D+x*R+k*B,a[8]=m*F+A*H+l*G,a[9]=u*F+b*H+L*G,a[10]=_*F+f*H+T*G,a[11]=s*F+x*H+k*G,n!==a&&(a[12]=n[12],a[13]=n[13],a[14]=n[14],a[15]=n[15]),a)}},{}],104:[function(v,S,M){S.exports=e;function e(a,n,r){var t=Math.sin(r),c=Math.cos(r),o=n[4],i=n[5],y=n[6],p=n[7],g=n[8],h=n[9],m=n[10],u=n[11];return n!==a&&(a[0]=n[0],a[1]=n[1],a[2]=n[2],a[3]=n[3],a[12]=n[12],a[13]=n[13],a[14]=n[14],a[15]=n[15]),a[4]=o*c+g*t,a[5]=i*c+h*t,a[6]=y*c+m*t,a[7]=p*c+u*t,a[8]=g*c-o*t,a[9]=h*c-i*t,a[10]=m*c-y*t,a[11]=u*c-p*t,a}},{}],105:[function(v,S,M){S.exports=e;function e(a,n,r){var t=Math.sin(r),c=Math.cos(r),o=n[0],i=n[1],y=n[2],p=n[3],g=n[8],h=n[9],m=n[10],u=n[11];return n!==a&&(a[4]=n[4],a[5]=n[5],a[6]=n[6],a[7]=n[7],a[12]=n[12],a[13]=n[13],a[14]=n[14],a[15]=n[15]),a[0]=o*c-g*t,a[1]=i*c-h*t,a[2]=y*c-m*t,a[3]=p*c-u*t,a[8]=o*t+g*c,a[9]=i*t+h*c,a[10]=y*t+m*c,a[11]=p*t+u*c,a}},{}],106:[function(v,S,M){S.exports=e;function e(a,n,r){var t=Math.sin(r),c=Math.cos(r),o=n[0],i=n[1],y=n[2],p=n[3],g=n[4],h=n[5],m=n[6],u=n[7];return n!==a&&(a[8]=n[8],a[9]=n[9],a[10]=n[10],a[11]=n[11],a[12]=n[12],a[13]=n[13],a[14]=n[14],a[15]=n[15]),a[0]=o*c+g*t,a[1]=i*c+h*t,a[2]=y*c+m*t,a[3]=p*c+u*t,a[4]=g*c-o*t,a[5]=h*c-i*t,a[6]=m*c-y*t,a[7]=u*c-p*t,a}},{}],107:[function(v,S,M){S.exports=e;function e(a,n,r){var t=r[0],c=r[1],o=r[2];return a[0]=n[0]*t,a[1]=n[1]*t,a[2]=n[2]*t,a[3]=n[3]*t,a[4]=n[4]*c,a[5]=n[5]*c,a[6]=n[6]*c,a[7]=n[7]*c,a[8]=n[8]*o,a[9]=n[9]*o,a[10]=n[10]*o,a[11]=n[11]*o,a[12]=n[12],a[13]=n[13],a[14]=n[14],a[15]=n[15],a}},{}],108:[function(v,S,M){S.exports=e;function e(a,n,r){var t=r[0],c=r[1],o=r[2],i,y,p,g,h,m,u,_,s,A,b,f;return n===a?(a[12]=n[0]*t+n[4]*c+n[8]*o+n[12],a[13]=n[1]*t+n[5]*c+n[9]*o+n[13],a[14]=n[2]*t+n[6]*c+n[10]*o+n[14],a[15]=n[3]*t+n[7]*c+n[11]*o+n[15]):(i=n[0],y=n[1],p=n[2],g=n[3],h=n[4],m=n[5],u=n[6],_=n[7],s=n[8],A=n[9],b=n[10],f=n[11],a[0]=i,a[1]=y,a[2]=p,a[3]=g,a[4]=h,a[5]=m,a[6]=u,a[7]=_,a[8]=s,a[9]=A,a[10]=b,a[11]=f,a[12]=i*t+h*c+s*o+n[12],a[13]=y*t+m*c+A*o+n[13],a[14]=p*t+u*c+b*o+n[14],a[15]=g*t+_*c+f*o+n[15]),a}},{}],109:[function(v,S,M){S.exports=e;function e(a,n){if(a===n){var r=n[1],t=n[2],c=n[3],o=n[6],i=n[7],y=n[11];a[1]=n[4],a[2]=n[8],a[3]=n[12],a[4]=r,a[6]=n[9],a[7]=n[13],a[8]=t,a[9]=o,a[11]=n[14],a[12]=c,a[13]=i,a[14]=y}else a[0]=n[0],a[1]=n[4],a[2]=n[8],a[3]=n[12],a[4]=n[1],a[5]=n[5],a[6]=n[9],a[7]=n[13],a[8]=n[2],a[9]=n[6],a[10]=n[10],a[11]=n[14],a[12]=n[3],a[13]=n[7],a[14]=n[11],a[15]=n[15];return a}},{}],110:[function(v,S,M){var e=v("barycentric"),a=v("polytope-closest-point/lib/closest_point_2d.js");S.exports=o;function n(i,y){for(var p=[0,0,0,0],g=0;g<4;++g)for(var h=0;h<4;++h)p[h]+=i[4*g+h]*y[g];return p}function r(i,y,p,g,h){for(var m=n(g,n(p,n(y,[i[0],i[1],i[2],1]))),u=0;u<3;++u)m[u]/=m[3];return[.5*h[0]*(1+m[0]),.5*h[1]*(1-m[1])]}function t(i,y){if(i.length===2){for(var p=0,g=0,h=0;h<2;++h)p+=Math.pow(y[h]-i[0][h],2),g+=Math.pow(y[h]-i[1][h],2);return p=Math.sqrt(p),g=Math.sqrt(g),p+g<1e-6?[1,0]:[g/(p+g),p/(g+p)]}else if(i.length===3){var m=[0,0];return a(i[0],i[1],i[2],y,m),e(i,m)}return[]}function c(i,y){for(var p=[0,0,0],g=0;g<i.length;++g)for(var h=i[g],m=y[g],u=0;u<3;++u)p[u]+=m*h[u];return p}function o(i,y,p,g,h,m){if(i.length===1)return[0,i[0].slice()];for(var u=new Array(i.length),_=0;_<i.length;++_)u[_]=r(i[_],p,g,h,m);for(var s=0,A=1/0,_=0;_<u.length;++_){for(var b=0,f=0;f<2;++f)b+=Math.pow(u[_][f]-y[f],2);b<A&&(A=b,s=_)}for(var x=t(u,y),l=0,_=0;_<3;++_){if(x[_]<-.001||x[_]>1.0001)return null;l+=x[_]}return Math.abs(l-1)>.001?null:[s,c(i,x),x]}},{barycentric:14,"polytope-closest-point/lib/closest_point_2d.js":270}],111:[function(v,S,M){var e=v("glslify"),a=e([`precision highp float;
#define GLSLIFY 1

attribute vec3 position, normal;
attribute vec4 color;
attribute vec2 uv;

uniform mat4 model
           , view
           , projection
           , inverseModel;
uniform vec3 eyePosition
           , lightPosition;

varying vec3 f_normal
           , f_lightDirection
           , f_eyeDirection
           , f_data;
varying vec4 f_color;
varying vec2 f_uv;

vec4 project(vec3 p) {
  return projection * view * model * vec4(p, 1.0);
}

void main() {
  gl_Position      = project(position);

  //Lighting geometry parameters
  vec4 cameraCoordinate = view * vec4(position , 1.0);
  cameraCoordinate.xyz /= cameraCoordinate.w;
  f_lightDirection = lightPosition - cameraCoordinate.xyz;
  f_eyeDirection   = eyePosition - cameraCoordinate.xyz;
  f_normal  = normalize((vec4(normal, 0.0) * inverseModel).xyz);

  f_color          = color;
  f_data           = position;
  f_uv             = uv;
}
`]),n=e([`#extension GL_OES_standard_derivatives : enable

precision highp float;
#define GLSLIFY 1

float beckmannDistribution(float x, float roughness) {
  float NdotH = max(x, 0.0001);
  float cos2Alpha = NdotH * NdotH;
  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;
  float roughness2 = roughness * roughness;
  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;
  return exp(tan2Alpha / roughness2) / denom;
}

float cookTorranceSpecular(
  vec3 lightDirection,
  vec3 viewDirection,
  vec3 surfaceNormal,
  float roughness,
  float fresnel) {

  float VdotN = max(dot(viewDirection, surfaceNormal), 0.0);
  float LdotN = max(dot(lightDirection, surfaceNormal), 0.0);

  //Half angle vector
  vec3 H = normalize(lightDirection + viewDirection);

  //Geometric term
  float NdotH = max(dot(surfaceNormal, H), 0.0);
  float VdotH = max(dot(viewDirection, H), 0.000001);
  float LdotH = max(dot(lightDirection, H), 0.000001);
  float G1 = (2.0 * NdotH * VdotN) / VdotH;
  float G2 = (2.0 * NdotH * LdotN) / LdotH;
  float G = min(1.0, min(G1, G2));
  
  //Distribution term
  float D = beckmannDistribution(NdotH, roughness);

  //Fresnel term
  float F = pow(1.0 - VdotN, fresnel);

  //Multiply terms and done
  return  G * F * D / max(3.14159265 * VdotN, 0.000001);
}

//#pragma glslify: beckmann = require(glsl-specular-beckmann) // used in gl-surface3d

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 clipBounds[2];
uniform float roughness
            , fresnel
            , kambient
            , kdiffuse
            , kspecular;
uniform sampler2D texture;

varying vec3 f_normal
           , f_lightDirection
           , f_eyeDirection
           , f_data;
varying vec4 f_color;
varying vec2 f_uv;

void main() {
  if (f_color.a == 0.0 ||
    outOfRange(clipBounds[0], clipBounds[1], f_data)
  ) discard;

  vec3 N = normalize(f_normal);
  vec3 L = normalize(f_lightDirection);
  vec3 V = normalize(f_eyeDirection);

  if(gl_FrontFacing) {
    N = -N;
  }

  float specular = min(1.0, max(0.0, cookTorranceSpecular(L, V, N, roughness, fresnel)));
  //float specular = max(0.0, beckmann(L, V, N, roughness)); // used in gl-surface3d

  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);

  vec4 surfaceColor = vec4(f_color.rgb, 1.0) * texture2D(texture, f_uv);
  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);

  gl_FragColor = litColor * f_color.a;
}
`]),r=e([`precision highp float;
#define GLSLIFY 1

attribute vec3 position;
attribute vec4 color;
attribute vec2 uv;

uniform mat4 model, view, projection;

varying vec4 f_color;
varying vec3 f_data;
varying vec2 f_uv;

void main() {
  gl_Position = projection * view * model * vec4(position, 1.0);
  f_color = color;
  f_data  = position;
  f_uv    = uv;
}`]),t=e([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 clipBounds[2];
uniform sampler2D texture;
uniform float opacity;

varying vec4 f_color;
varying vec3 f_data;
varying vec2 f_uv;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], f_data)) discard;

  gl_FragColor = f_color * texture2D(texture, f_uv) * opacity;
}`]),c=e([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

attribute vec3 position;
attribute vec4 color;
attribute vec2 uv;
attribute float pointSize;

uniform mat4 model, view, projection;
uniform vec3 clipBounds[2];

varying vec4 f_color;
varying vec2 f_uv;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], position)) {

    gl_Position = vec4(0.0, 0.0 ,0.0 ,0.0);
  } else {
    gl_Position = projection * view * model * vec4(position, 1.0);
  }
  gl_PointSize = pointSize;
  f_color = color;
  f_uv = uv;
}`]),o=e([`precision highp float;
#define GLSLIFY 1

uniform sampler2D texture;
uniform float opacity;

varying vec4 f_color;
varying vec2 f_uv;

void main() {
  vec2 pointR = gl_PointCoord.xy - vec2(0.5, 0.5);
  if(dot(pointR, pointR) > 0.25) {
    discard;
  }
  gl_FragColor = f_color * texture2D(texture, f_uv) * opacity;
}`]),i=e([`precision highp float;
#define GLSLIFY 1

attribute vec3 position;
attribute vec4 id;

uniform mat4 model, view, projection;

varying vec3 f_position;
varying vec4 f_id;

void main() {
  gl_Position = projection * view * model * vec4(position, 1.0);
  f_id        = id;
  f_position  = position;
}`]),y=e([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3  clipBounds[2];
uniform float pickId;

varying vec3 f_position;
varying vec4 f_id;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;

  gl_FragColor = vec4(pickId, f_id.xyz);
}`]),p=e([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

attribute vec3  position;
attribute float pointSize;
attribute vec4  id;

uniform mat4 model, view, projection;
uniform vec3 clipBounds[2];

varying vec3 f_position;
varying vec4 f_id;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], position)) {

    gl_Position = vec4(0.0, 0.0, 0.0, 0.0);
  } else {
    gl_Position  = projection * view * model * vec4(position, 1.0);
    gl_PointSize = pointSize;
  }
  f_id         = id;
  f_position   = position;
}`]),g=e([`precision highp float;
#define GLSLIFY 1

attribute vec3 position;

uniform mat4 model, view, projection;

void main() {
  gl_Position = projection * view * model * vec4(position, 1.0);
}`]),h=e([`precision highp float;
#define GLSLIFY 1

uniform vec3 contourColor;

void main() {
  gl_FragColor = vec4(contourColor, 1.0);
}
`]);M.meshShader={vertex:a,fragment:n,attributes:[{name:"position",type:"vec3"},{name:"normal",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"}]},M.wireShader={vertex:r,fragment:t,attributes:[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"}]},M.pointShader={vertex:c,fragment:o,attributes:[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"},{name:"pointSize",type:"float"}]},M.pickShader={vertex:i,fragment:y,attributes:[{name:"position",type:"vec3"},{name:"id",type:"vec4"}]},M.pointPickShader={vertex:p,fragment:y,attributes:[{name:"position",type:"vec3"},{name:"pointSize",type:"float"},{name:"id",type:"vec4"}]},M.contourShader={vertex:g,fragment:h,attributes:[{name:"position",type:"vec3"}]}},{glslify:231}],112:[function(v,S,M){var e=1e-6,a=1e-6,n=v("gl-shader"),r=v("gl-buffer"),t=v("gl-vao"),c=v("gl-texture2d"),o=v("normals"),i=v("gl-mat4/multiply"),y=v("gl-mat4/invert"),p=v("ndarray"),g=v("colormap"),h=v("simplicial-complex-contour"),m=v("typedarray-pool"),u=v("./lib/shaders"),_=v("./lib/closest-point"),s=u.meshShader,A=u.wireShader,b=u.pointShader,f=u.pickShader,x=u.pointPickShader,l=u.contourShader,L=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function T(X,Y,Z,oe,re,se,N,U,q,$,W,K,ne,ae,ie,le,ye,ue,pe,ge,Te,_e,ze,Oe,Ye,be,Pe){this.gl=X,this.pixelRatio=1,this.cells=[],this.positions=[],this.intensity=[],this.texture=Y,this.dirty=!0,this.triShader=Z,this.lineShader=oe,this.pointShader=re,this.pickShader=se,this.pointPickShader=N,this.contourShader=U,this.trianglePositions=q,this.triangleColors=W,this.triangleNormals=ne,this.triangleUVs=K,this.triangleIds=$,this.triangleVAO=ae,this.triangleCount=0,this.lineWidth=1,this.edgePositions=ie,this.edgeColors=ye,this.edgeUVs=ue,this.edgeIds=le,this.edgeVAO=pe,this.edgeCount=0,this.pointPositions=ge,this.pointColors=_e,this.pointUVs=ze,this.pointSizes=Oe,this.pointIds=Te,this.pointVAO=Ye,this.pointCount=0,this.contourLineWidth=1,this.contourPositions=be,this.contourVAO=Pe,this.contourCount=0,this.contourColor=[0,0,0],this.contourEnable=!0,this.pickVertex=!0,this.pickId=1,this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.lightPosition=[1e5,1e5,0],this.ambientLight=.8,this.diffuseLight=.8,this.specularLight=2,this.roughness=.5,this.fresnel=1.5,this.opacity=1,this.hasAlpha=!1,this.opacityscale=!1,this._model=L,this._view=L,this._projection=L,this._resolution=[1,1]}var k=T.prototype;k.isOpaque=function(){return!this.hasAlpha},k.isTransparent=function(){return this.hasAlpha},k.pickSlots=1,k.setPickBase=function(X){this.pickId=X};function P(X,Y){if(!Y||!Y.length)return 1;for(var Z=0;Z<Y.length;++Z){if(Y.length<2)return 1;if(Y[Z][0]===X)return Y[Z][1];if(Y[Z][0]>X&&Z>0){var oe=(Y[Z][0]-X)/(Y[Z][0]-Y[Z-1][0]);return Y[Z][1]*(1-oe)+oe*Y[Z-1][1]}}return 1}function z(X,Y){for(var Z=g({colormap:X,nshades:256,format:"rgba"}),oe=new Uint8Array(256*4),re=0;re<256;++re){for(var se=Z[re],N=0;N<3;++N)oe[4*re+N]=se[N];Y?oe[4*re+3]=255*P(re/255,Y):oe[4*re+3]=255*se[3]}return p(oe,[256,256,4],[4,0,1])}function I(X){for(var Y=X.length,Z=new Array(Y),oe=0;oe<Y;++oe)Z[oe]=X[oe][2];return Z}k.highlight=function(X){if(!X||!this.contourEnable){this.contourCount=0;return}for(var Y=h(this.cells,this.intensity,X.intensity),Z=Y.cells,oe=Y.vertexIds,re=Y.vertexWeights,se=Z.length,N=m.mallocFloat32(2*3*se),U=0,q=0;q<se;++q)for(var $=Z[q],W=0;W<2;++W){var K=$[0];$.length===2&&(K=$[W]);for(var ne=oe[K][0],ae=oe[K][1],ie=re[K],le=1-ie,ye=this.positions[ne],ue=this.positions[ae],pe=0;pe<3;++pe)N[U++]=ie*ye[pe]+le*ue[pe]}this.contourCount=U/3|0,this.contourPositions.update(N.subarray(0,U)),m.free(N)},k.update=function(X){X=X||{};var Y=this.gl;this.dirty=!0,"contourEnable"in X&&(this.contourEnable=X.contourEnable),"contourColor"in X&&(this.contourColor=X.contourColor),"lineWidth"in X&&(this.lineWidth=X.lineWidth),"lightPosition"in X&&(this.lightPosition=X.lightPosition),this.hasAlpha=!1,"opacity"in X&&(this.opacity=X.opacity,this.opacity<1&&(this.hasAlpha=!0)),"opacityscale"in X&&(this.opacityscale=X.opacityscale,this.hasAlpha=!0),"ambient"in X&&(this.ambientLight=X.ambient),"diffuse"in X&&(this.diffuseLight=X.diffuse),"specular"in X&&(this.specularLight=X.specular),"roughness"in X&&(this.roughness=X.roughness),"fresnel"in X&&(this.fresnel=X.fresnel),X.texture?(this.texture.dispose(),this.texture=c(Y,X.texture)):X.colormap&&(this.texture.shape=[256,256],this.texture.minFilter=Y.LINEAR_MIPMAP_LINEAR,this.texture.magFilter=Y.LINEAR,this.texture.setPixels(z(X.colormap,this.opacityscale)),this.texture.generateMipmap());var Z=X.cells,oe=X.positions;if(!oe||!Z)return;var re=[],se=[],N=[],U=[],q=[],$=[],W=[],K=[],ne=[],ae=[],ie=[],le=[],ye=[],ue=[];this.cells=Z,this.positions=oe;var pe=X.vertexNormals,ge=X.cellNormals,Te=X.vertexNormalsEpsilon===void 0?e:X.vertexNormalsEpsilon,_e=X.faceNormalsEpsilon===void 0?a:X.faceNormalsEpsilon;X.useFacetNormals&&!ge&&(ge=o.faceNormals(Z,oe,_e)),!ge&&!pe&&(pe=o.vertexNormals(Z,oe,Te));var ze=X.vertexColors,Oe=X.cellColors,Ye=X.meshColor||[1,1,1,1],be=X.vertexUVs,Pe=X.vertexIntensity,Ge=X.cellUVs,Qe=X.cellIntensity,Be=1/0,Le=-1/0;if(!be&&!Ge)if(Pe)if(X.vertexIntensityBounds)Be=+X.vertexIntensityBounds[0],Le=+X.vertexIntensityBounds[1];else for(var He=0;He<Pe.length;++He){var vt=Pe[He];Be=Math.min(Be,vt),Le=Math.max(Le,vt)}else if(Qe)if(X.cellIntensityBounds)Be=+X.cellIntensityBounds[0],Le=+X.cellIntensityBounds[1];else for(var He=0;He<Qe.length;++He){var vt=Qe[He];Be=Math.min(Be,vt),Le=Math.max(Le,vt)}else for(var He=0;He<oe.length;++He){var vt=oe[He][2];Be=Math.min(Be,vt),Le=Math.max(Le,vt)}Pe?this.intensity=Pe:Qe?this.intensity=Qe:this.intensity=I(oe),this.pickVertex=!(Qe||Oe);var Rt=X.pointSizes,rr=X.pointSize||1;this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]];for(var He=0;He<oe.length;++He)for(var Lt=oe[He],Ft=0;Ft<3;++Ft)isNaN(Lt[Ft])||!isFinite(Lt[Ft])||(this.bounds[0][Ft]=Math.min(this.bounds[0][Ft],Lt[Ft]),this.bounds[1][Ft]=Math.max(this.bounds[1][Ft],Lt[Ft]));var Gt=0,Dt=0,kt=0;e:for(var He=0;He<Z.length;++He){var Ue=Z[He];switch(Ue.length){case 1:for(var qe=Ue[0],Lt=oe[qe],Ft=0;Ft<3;++Ft)if(isNaN(Lt[Ft])||!isFinite(Lt[Ft]))continue e;ae.push(Lt[0],Lt[1],Lt[2]);var Ve;ze?Ve=ze[qe]:Oe?Ve=Oe[He]:Ve=Ye,this.opacityscale&&Pe?se.push(Ve[0],Ve[1],Ve[2],this.opacity*P((Pe[qe]-Be)/(Le-Be),this.opacityscale)):Ve.length===3?ie.push(Ve[0],Ve[1],Ve[2],this.opacity):(ie.push(Ve[0],Ve[1],Ve[2],Ve[3]*this.opacity),Ve[3]<1&&(this.hasAlpha=!0));var Ae;be?Ae=be[qe]:Pe?Ae=[(Pe[qe]-Be)/(Le-Be),0]:Ge?Ae=Ge[He]:Qe?Ae=[(Qe[He]-Be)/(Le-Be),0]:Ae=[(Lt[2]-Be)/(Le-Be),0],le.push(Ae[0],Ae[1]),Rt?ye.push(Rt[qe]):ye.push(rr),ue.push(He),kt+=1;break;case 2:for(var Ft=0;Ft<2;++Ft)for(var qe=Ue[Ft],Lt=oe[qe],Ne=0;Ne<3;++Ne)if(isNaN(Lt[Ne])||!isFinite(Lt[Ne]))continue e;for(var Ft=0;Ft<2;++Ft){var qe=Ue[Ft],Lt=oe[qe];$.push(Lt[0],Lt[1],Lt[2]);var Ve;ze?Ve=ze[qe]:Oe?Ve=Oe[He]:Ve=Ye,this.opacityscale&&Pe?se.push(Ve[0],Ve[1],Ve[2],this.opacity*P((Pe[qe]-Be)/(Le-Be),this.opacityscale)):Ve.length===3?W.push(Ve[0],Ve[1],Ve[2],this.opacity):(W.push(Ve[0],Ve[1],Ve[2],Ve[3]*this.opacity),Ve[3]<1&&(this.hasAlpha=!0));var Ae;be?Ae=be[qe]:Pe?Ae=[(Pe[qe]-Be)/(Le-Be),0]:Ge?Ae=Ge[He]:Qe?Ae=[(Qe[He]-Be)/(Le-Be),0]:Ae=[(Lt[2]-Be)/(Le-Be),0],K.push(Ae[0],Ae[1]),ne.push(He)}Dt+=1;break;case 3:for(var Ft=0;Ft<3;++Ft)for(var qe=Ue[Ft],Lt=oe[qe],Ne=0;Ne<3;++Ne)if(isNaN(Lt[Ne])||!isFinite(Lt[Ne]))continue e;for(var Ft=0;Ft<3;++Ft){var qe=Ue[2-Ft],Lt=oe[qe];re.push(Lt[0],Lt[1],Lt[2]);var Ve;ze?Ve=ze[qe]:Oe?Ve=Oe[He]:Ve=Ye,Ve?this.opacityscale&&Pe?se.push(Ve[0],Ve[1],Ve[2],this.opacity*P((Pe[qe]-Be)/(Le-Be),this.opacityscale)):Ve.length===3?se.push(Ve[0],Ve[1],Ve[2],this.opacity):(se.push(Ve[0],Ve[1],Ve[2],Ve[3]*this.opacity),Ve[3]<1&&(this.hasAlpha=!0)):se.push(.5,.5,.5,1);var Ae;be?Ae=be[qe]:Pe?Ae=[(Pe[qe]-Be)/(Le-Be),0]:Ge?Ae=Ge[He]:Qe?Ae=[(Qe[He]-Be)/(Le-Be),0]:Ae=[(Lt[2]-Be)/(Le-Be),0],U.push(Ae[0],Ae[1]);var Xe;pe?Xe=pe[qe]:Xe=ge[He],N.push(Xe[0],Xe[1],Xe[2]),q.push(He)}Gt+=1;break}}this.pointCount=kt,this.edgeCount=Dt,this.triangleCount=Gt,this.pointPositions.update(ae),this.pointColors.update(ie),this.pointUVs.update(le),this.pointSizes.update(ye),this.pointIds.update(new Uint32Array(ue)),this.edgePositions.update($),this.edgeColors.update(W),this.edgeUVs.update(K),this.edgeIds.update(new Uint32Array(ne)),this.trianglePositions.update(re),this.triangleColors.update(se),this.triangleUVs.update(U),this.triangleNormals.update(N),this.triangleIds.update(new Uint32Array(q))},k.drawTransparent=k.draw=function(X){X=X||{};for(var Y=this.gl,Z=X.model||L,oe=X.view||L,re=X.projection||L,se=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],N=0;N<3;++N)se[0][N]=Math.max(se[0][N],this.clipBounds[0][N]),se[1][N]=Math.min(se[1][N],this.clipBounds[1][N]);var U={model:Z,view:oe,projection:re,inverseModel:L.slice(),clipBounds:se,kambient:this.ambientLight,kdiffuse:this.diffuseLight,kspecular:this.specularLight,roughness:this.roughness,fresnel:this.fresnel,eyePosition:[0,0,0],lightPosition:[0,0,0],contourColor:this.contourColor,texture:0};U.inverseModel=y(U.inverseModel,U.model),Y.disable(Y.CULL_FACE),this.texture.bind(0);var q=new Array(16);i(q,U.view,U.model),i(q,U.projection,q),y(q,q);for(var N=0;N<3;++N)U.eyePosition[N]=q[12+N]/q[15];for(var $=q[15],N=0;N<3;++N)$+=this.lightPosition[N]*q[4*N+3];for(var N=0;N<3;++N){for(var W=q[12+N],K=0;K<3;++K)W+=q[4*K+N]*this.lightPosition[K];U.lightPosition[N]=W/$}if(this.triangleCount>0){var ne=this.triShader;ne.bind(),ne.uniforms=U,this.triangleVAO.bind(),Y.drawArrays(Y.TRIANGLES,0,this.triangleCount*3),this.triangleVAO.unbind()}if(this.edgeCount>0&&this.lineWidth>0){var ne=this.lineShader;ne.bind(),ne.uniforms=U,this.edgeVAO.bind(),Y.lineWidth(this.lineWidth*this.pixelRatio),Y.drawArrays(Y.LINES,0,this.edgeCount*2),this.edgeVAO.unbind()}if(this.pointCount>0){var ne=this.pointShader;ne.bind(),ne.uniforms=U,this.pointVAO.bind(),Y.drawArrays(Y.POINTS,0,this.pointCount),this.pointVAO.unbind()}if(this.contourEnable&&this.contourCount>0&&this.contourLineWidth>0){var ne=this.contourShader;ne.bind(),ne.uniforms=U,this.contourVAO.bind(),Y.drawArrays(Y.LINES,0,this.contourCount),this.contourVAO.unbind()}},k.drawPick=function(X){X=X||{};for(var Y=this.gl,Z=X.model||L,oe=X.view||L,re=X.projection||L,se=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],N=0;N<3;++N)se[0][N]=Math.max(se[0][N],this.clipBounds[0][N]),se[1][N]=Math.min(se[1][N],this.clipBounds[1][N]);this._model=[].slice.call(Z),this._view=[].slice.call(oe),this._projection=[].slice.call(re),this._resolution=[Y.drawingBufferWidth,Y.drawingBufferHeight];var U={model:Z,view:oe,projection:re,clipBounds:se,pickId:this.pickId/255},q=this.pickShader;if(q.bind(),q.uniforms=U,this.triangleCount>0&&(this.triangleVAO.bind(),Y.drawArrays(Y.TRIANGLES,0,this.triangleCount*3),this.triangleVAO.unbind()),this.edgeCount>0&&(this.edgeVAO.bind(),Y.lineWidth(this.lineWidth*this.pixelRatio),Y.drawArrays(Y.LINES,0,this.edgeCount*2),this.edgeVAO.unbind()),this.pointCount>0){var q=this.pointPickShader;q.bind(),q.uniforms=U,this.pointVAO.bind(),Y.drawArrays(Y.POINTS,0,this.pointCount),this.pointVAO.unbind()}},k.pick=function(X){if(!X||X.id!==this.pickId)return null;for(var Y=X.value[0]+256*X.value[1]+65536*X.value[2],Z=this.cells[Y],oe=this.positions,re=new Array(Z.length),se=0;se<Z.length;++se)re[se]=oe[Z[se]];var N=X.coord[0],U=X.coord[1];if(!this.pickVertex){var q=this.positions[Z[0]],$=this.positions[Z[1]],W=this.positions[Z[2]],K=[(q[0]+$[0]+W[0])/3,(q[1]+$[1]+W[1])/3,(q[2]+$[2]+W[2])/3];return{_cellCenter:!0,position:[N,U],index:Y,cell:Z,cellId:Y,intensity:this.intensity[Y],dataCoordinate:K}}var ne=_(re,[N*this.pixelRatio,this._resolution[1]-U*this.pixelRatio],this._model,this._view,this._projection,this._resolution);if(!ne)return null;for(var ae=ne[2],ie=0,se=0;se<Z.length;++se)ie+=ae[se]*this.intensity[Z[se]];return{position:ne[1],index:Z[ne[0]],cell:Z,cellId:Y,intensity:ie,dataCoordinate:this.positions[Z[ne[0]]]}},k.dispose=function(){this.texture.dispose(),this.triShader.dispose(),this.lineShader.dispose(),this.pointShader.dispose(),this.pickShader.dispose(),this.pointPickShader.dispose(),this.triangleVAO.dispose(),this.trianglePositions.dispose(),this.triangleColors.dispose(),this.triangleUVs.dispose(),this.triangleNormals.dispose(),this.triangleIds.dispose(),this.edgeVAO.dispose(),this.edgePositions.dispose(),this.edgeColors.dispose(),this.edgeUVs.dispose(),this.edgeIds.dispose(),this.pointVAO.dispose(),this.pointPositions.dispose(),this.pointColors.dispose(),this.pointUVs.dispose(),this.pointSizes.dispose(),this.pointIds.dispose(),this.contourVAO.dispose(),this.contourPositions.dispose(),this.contourShader.dispose()};function D(X){var Y=n(X,s.vertex,s.fragment);return Y.attributes.position.location=0,Y.attributes.color.location=2,Y.attributes.uv.location=3,Y.attributes.normal.location=4,Y}function R(X){var Y=n(X,A.vertex,A.fragment);return Y.attributes.position.location=0,Y.attributes.color.location=2,Y.attributes.uv.location=3,Y}function B(X){var Y=n(X,b.vertex,b.fragment);return Y.attributes.position.location=0,Y.attributes.color.location=2,Y.attributes.uv.location=3,Y.attributes.pointSize.location=4,Y}function F(X){var Y=n(X,f.vertex,f.fragment);return Y.attributes.position.location=0,Y.attributes.id.location=1,Y}function H(X){var Y=n(X,x.vertex,x.fragment);return Y.attributes.position.location=0,Y.attributes.id.location=1,Y.attributes.pointSize.location=4,Y}function G(X){var Y=n(X,l.vertex,l.fragment);return Y.attributes.position.location=0,Y}function J(X,Y){arguments.length===1&&(Y=X,X=Y.gl);var Z=X.getExtension("OES_standard_derivatives")||X.getExtension("MOZ_OES_standard_derivatives")||X.getExtension("WEBKIT_OES_standard_derivatives");if(!Z)throw new Error("derivatives not supported");var oe=D(X),re=R(X),se=B(X),N=F(X),U=H(X),q=G(X),$=c(X,p(new Uint8Array([255,255,255,255]),[1,1,4]));$.generateMipmap(),$.minFilter=X.LINEAR_MIPMAP_LINEAR,$.magFilter=X.LINEAR;var W=r(X),K=r(X),ne=r(X),ae=r(X),ie=r(X),le=t(X,[{buffer:W,type:X.FLOAT,size:3},{buffer:ie,type:X.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:K,type:X.FLOAT,size:4},{buffer:ne,type:X.FLOAT,size:2},{buffer:ae,type:X.FLOAT,size:3}]),ye=r(X),ue=r(X),pe=r(X),ge=r(X),Te=t(X,[{buffer:ye,type:X.FLOAT,size:3},{buffer:ge,type:X.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:ue,type:X.FLOAT,size:4},{buffer:pe,type:X.FLOAT,size:2}]),_e=r(X),ze=r(X),Oe=r(X),Ye=r(X),be=r(X),Pe=t(X,[{buffer:_e,type:X.FLOAT,size:3},{buffer:be,type:X.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:ze,type:X.FLOAT,size:4},{buffer:Oe,type:X.FLOAT,size:2},{buffer:Ye,type:X.FLOAT,size:1}]),Ge=r(X),Qe=t(X,[{buffer:Ge,type:X.FLOAT,size:3}]),Be=new T(X,$,oe,re,se,N,U,q,W,ie,K,ne,ae,le,ye,ge,ue,pe,Te,_e,be,ze,Oe,Ye,Pe,Ge,Qe);return Be.update(Y),Be}S.exports=J},{"./lib/closest-point":110,"./lib/shaders":111,colormap:53,"gl-buffer":78,"gl-mat4/invert":98,"gl-mat4/multiply":100,"gl-shader":132,"gl-texture2d":146,"gl-vao":150,ndarray:259,normals:261,"simplicial-complex-contour":291,"typedarray-pool":308}],113:[function(v,S,M){S.exports=c;var e=v("gl-buffer"),a=v("gl-shader"),n=v("./shaders");function r(o,i,y){this.plot=o,this.vbo=i,this.shader=y}var t=r.prototype;t.bind=function(){var o=this.shader;this.vbo.bind(),this.shader.bind(),o.attributes.coord.pointer(),o.uniforms.screenBox=this.plot.screenBox},t.drawBox=function(){var o=[0,0],i=[0,0];return function(y,p,g,h,m){var u=this.plot,_=this.shader,s=u.gl;o[0]=y,o[1]=p,i[0]=g,i[1]=h,_.uniforms.lo=o,_.uniforms.hi=i,_.uniforms.color=m,s.drawArrays(s.TRIANGLE_STRIP,0,4)}}(),t.dispose=function(){this.vbo.dispose(),this.shader.dispose()};function c(o){var i=o.gl,y=e(i,[0,0,0,1,1,0,1,1]),p=a(i,n.boxVert,n.lineFrag);return new r(o,y,p)}},{"./shaders":116,"gl-buffer":78,"gl-shader":132}],114:[function(v,S,M){S.exports=i;var e=v("gl-buffer"),a=v("gl-shader"),n=v("binary-search-bounds"),r=v("./shaders");function t(y,p,g,h){this.plot=y,this.vbo=p,this.shader=g,this.tickShader=h,this.ticks=[[],[]]}function c(y,p){return y-p}var o=t.prototype;o.draw=function(){var y=[0,0],p=[0,0],g=[0,0];return function(){for(var h=this.plot,m=this.vbo,u=this.shader,_=this.ticks,s=h.gl,A=h._tickBounds,b=h.dataBox,f=h.viewBox,x=h.gridLineWidth,l=h.gridLineColor,L=h.gridLineEnable,T=h.pixelRatio,k=0;k<2;++k){var P=A[k],z=A[k+2],I=z-P,D=.5*(b[k+2]+b[k]),R=b[k+2]-b[k];p[k]=2*I/R,y[k]=2*(P-D)/R}u.bind(),m.bind(),u.attributes.dataCoord.pointer(),u.uniforms.dataShift=y,u.uniforms.dataScale=p;for(var B=0,k=0;k<2;++k){g[0]=g[1]=0,g[k]=1,u.uniforms.dataAxis=g,u.uniforms.lineWidth=x[k]/(f[k+2]-f[k])*T,u.uniforms.color=l[k];var F=_[k].length*6;L[k]&&F&&s.drawArrays(s.TRIANGLES,B,F),B+=F}}}(),o.drawTickMarks=function(){var y=[0,0],p=[0,0],g=[1,0],h=[0,1],m=[0,0],u=[0,0];return function(){for(var _=this.plot,s=this.vbo,A=this.tickShader,b=this.ticks,f=_.gl,x=_._tickBounds,l=_.dataBox,L=_.viewBox,T=_.pixelRatio,k=_.screenBox,P=k[2]-k[0],z=k[3]-k[1],I=L[2]-L[0],D=L[3]-L[1],R=0;R<2;++R){var B=x[R],F=x[R+2],H=F-B,G=.5*(l[R+2]+l[R]),J=l[R+2]-l[R];p[R]=2*H/J,y[R]=2*(B-G)/J}p[0]*=I/P,y[0]*=I/P,p[1]*=D/z,y[1]*=D/z,A.bind(),s.bind(),A.attributes.dataCoord.pointer();var X=A.uniforms;X.dataShift=y,X.dataScale=p;var Y=_.tickMarkLength,Z=_.tickMarkWidth,oe=_.tickMarkColor,re=0,se=b[0].length*6,N=Math.min(n.ge(b[0],(l[0]-x[0])/(x[2]-x[0]),c),b[0].length),U=Math.min(n.gt(b[0],(l[2]-x[0])/(x[2]-x[0]),c),b[0].length),q=re+6*N,$=6*Math.max(0,U-N),W=Math.min(n.ge(b[1],(l[1]-x[1])/(x[3]-x[1]),c),b[1].length),K=Math.min(n.gt(b[1],(l[3]-x[1])/(x[3]-x[1]),c),b[1].length),ne=se+6*W,ae=6*Math.max(0,K-W);m[0]=2*(L[0]-Y[1])/P-1,m[1]=(L[3]+L[1])/z-1,u[0]=Y[1]*T/P,u[1]=Z[1]*T/z,ae&&(X.color=oe[1],X.tickScale=u,X.dataAxis=h,X.screenOffset=m,f.drawArrays(f.TRIANGLES,ne,ae)),m[0]=(L[2]+L[0])/P-1,m[1]=2*(L[1]-Y[0])/z-1,u[0]=Z[0]*T/P,u[1]=Y[0]*T/z,$&&(X.color=oe[0],X.tickScale=u,X.dataAxis=g,X.screenOffset=m,f.drawArrays(f.TRIANGLES,q,$)),m[0]=2*(L[2]+Y[3])/P-1,m[1]=(L[3]+L[1])/z-1,u[0]=Y[3]*T/P,u[1]=Z[3]*T/z,ae&&(X.color=oe[3],X.tickScale=u,X.dataAxis=h,X.screenOffset=m,f.drawArrays(f.TRIANGLES,ne,ae)),m[0]=(L[2]+L[0])/P-1,m[1]=2*(L[3]+Y[2])/z-1,u[0]=Z[2]*T/P,u[1]=Y[2]*T/z,$&&(X.color=oe[2],X.tickScale=u,X.dataAxis=g,X.screenOffset=m,f.drawArrays(f.TRIANGLES,q,$))}}(),o.update=function(){var y=[1,1,-1,-1,1,-1],p=[1,-1,1,1,-1,-1];return function(g){var h=g.ticks,m=g.bounds,u=new Float32Array(6*3*(h[0].length+h[1].length));this.plot.zeroLineEnable;for(var _=0,s=[[],[]],A=0;A<2;++A)for(var b=s[A],f=h[A],x=m[A],l=m[A+2],L=0;L<f.length;++L){var T=(f[L].x-x)/(l-x);b.push(T);for(var k=0;k<6;++k)u[_++]=T,u[_++]=y[k],u[_++]=p[k]}this.ticks=s,this.vbo.update(u)}}(),o.dispose=function(){this.vbo.dispose(),this.shader.dispose(),this.tickShader.dispose()};function i(y){var p=y.gl,g=e(p),h=a(p,r.gridVert,r.gridFrag),m=a(p,r.tickVert,r.gridFrag),u=new t(y,g,h,m);return u}},{"./shaders":116,"binary-search-bounds":31,"gl-buffer":78,"gl-shader":132}],115:[function(v,S,M){S.exports=c;var e=v("gl-buffer"),a=v("gl-shader"),n=v("./shaders");function r(o,i,y){this.plot=o,this.vbo=i,this.shader=y}var t=r.prototype;t.bind=function(){var o=this.shader;this.vbo.bind(),this.shader.bind(),o.attributes.coord.pointer(),o.uniforms.screenBox=this.plot.screenBox},t.drawLine=function(){var o=[0,0],i=[0,0];return function(y,p,g,h,m,u){var _=this.plot,s=this.shader,A=_.gl;o[0]=y,o[1]=p,i[0]=g,i[1]=h,s.uniforms.start=o,s.uniforms.end=i,s.uniforms.width=m*_.pixelRatio,s.uniforms.color=u,A.drawArrays(A.TRIANGLE_STRIP,0,4)}}(),t.dispose=function(){this.vbo.dispose(),this.shader.dispose()};function c(o){var i=o.gl,y=e(i,[-1,-1,-1,1,1,-1,1,1]),p=a(i,n.lineVert,n.lineFrag),g=new r(o,y,p);return g}},{"./shaders":116,"gl-buffer":78,"gl-shader":132}],116:[function(v,S,M){var e=v("glslify"),a=e([`precision lowp float;
#define GLSLIFY 1
uniform vec4 color;
void main() {
  gl_FragColor = vec4(color.xyz * color.w, color.w);
}
`]);S.exports={lineVert:e([`precision mediump float;
#define GLSLIFY 1

attribute vec2 coord;

uniform vec4 screenBox;
uniform vec2 start, end;
uniform float width;

vec2 perp(vec2 v) {
  return vec2(v.y, -v.x);
}

vec2 screen(vec2 v) {
  return 2.0 * (v - screenBox.xy) / (screenBox.zw - screenBox.xy) - 1.0;
}

void main() {
  vec2 delta = normalize(perp(start - end));
  vec2 offset = mix(start, end, 0.5 * (coord.y+1.0));
  gl_Position = vec4(screen(offset + 0.5 * width * delta * coord.x), 0, 1);
}
`]),lineFrag:a,textVert:e([`#define GLSLIFY 1
attribute vec3 textCoordinate;

uniform vec2 dataScale, dataShift, dataAxis, screenOffset, textScale;
uniform float angle;

void main() {
  float dataOffset  = textCoordinate.z;
  vec2 glyphOffset  = textCoordinate.xy;
  mat2 glyphMatrix = mat2(cos(angle), sin(angle), -sin(angle), cos(angle));
  vec2 screenCoordinate = dataAxis * (dataScale * dataOffset + dataShift) +
    glyphMatrix * glyphOffset * textScale + screenOffset;
  gl_Position = vec4(screenCoordinate, 0, 1);
}
`]),textFrag:a,gridVert:e([`precision mediump float;
#define GLSLIFY 1

attribute vec3 dataCoord;

uniform vec2 dataAxis, dataShift, dataScale;
uniform float lineWidth;

void main() {
  vec2 pos = dataAxis * (dataScale * dataCoord.x + dataShift);
  pos += 10.0 * dataCoord.y * vec2(dataAxis.y, -dataAxis.x) + dataCoord.z * lineWidth;
  gl_Position = vec4(pos, 0, 1);
}
`]),gridFrag:a,boxVert:e([`precision mediump float;
#define GLSLIFY 1

attribute vec2 coord;

uniform vec4 screenBox;
uniform vec2 lo, hi;

vec2 screen(vec2 v) {
  return 2.0 * (v - screenBox.xy) / (screenBox.zw - screenBox.xy) - 1.0;
}

void main() {
  gl_Position = vec4(screen(mix(lo, hi, coord)), 0, 1);
}
`]),tickVert:e([`precision mediump float;
#define GLSLIFY 1

attribute vec3 dataCoord;

uniform vec2 dataAxis, dataShift, dataScale, screenOffset, tickScale;

void main() {
  vec2 pos = dataAxis * (dataScale * dataCoord.x + dataShift);
  gl_Position = vec4(pos + tickScale*dataCoord.yz + screenOffset, 0, 1);
}
`])}},{glslify:231}],117:[function(v,S,M){S.exports=i;var e=v("gl-buffer"),a=v("gl-shader"),n=v("text-cache"),r=v("binary-search-bounds"),t=v("./shaders");function c(y,p,g){this.plot=y,this.vbo=p,this.shader=g,this.tickOffset=[[],[]],this.tickX=[[],[]],this.labelOffset=[0,0],this.labelCount=[0,0]}var o=c.prototype;o.drawTicks=function(){var y=[0,0],p=[0,0],g=[0,0];return function(h){var m=this.plot,u=this.shader,_=this.tickX[h],s=this.tickOffset[h],A=m.gl,b=m.viewBox,f=m.dataBox,x=m.screenBox,l=m.pixelRatio,L=m.tickEnable,T=m.tickPad,k=m.tickColor,P=m.tickAngle,z=m.labelEnable,I=m.labelPad,D=m.labelColor,R=m.labelAngle,B=this.labelOffset[h],F=this.labelCount[h],H=r.lt(_,f[h]),G=r.le(_,f[h+2]);y[0]=y[1]=0,y[h]=1,p[h]=(b[2+h]+b[h])/(x[2+h]-x[h])-1;var J=2/x[2+(h^1)]-x[h^1];p[h^1]=J*b[h^1]-1,L[h]&&(p[h^1]-=J*l*T[h],H<G&&s[G]>s[H]&&(u.uniforms.dataAxis=y,u.uniforms.screenOffset=p,u.uniforms.color=k[h],u.uniforms.angle=P[h],A.drawArrays(A.TRIANGLES,s[H],s[G]-s[H]))),z[h]&&F&&(p[h^1]-=J*l*I[h],u.uniforms.dataAxis=g,u.uniforms.screenOffset=p,u.uniforms.color=D[h],u.uniforms.angle=R[h],A.drawArrays(A.TRIANGLES,B,F)),p[h^1]=J*b[2+(h^1)]-1,L[h+2]&&(p[h^1]+=J*l*T[h+2],H<G&&s[G]>s[H]&&(u.uniforms.dataAxis=y,u.uniforms.screenOffset=p,u.uniforms.color=k[h+2],u.uniforms.angle=P[h+2],A.drawArrays(A.TRIANGLES,s[H],s[G]-s[H]))),z[h+2]&&F&&(p[h^1]+=J*l*I[h+2],u.uniforms.dataAxis=g,u.uniforms.screenOffset=p,u.uniforms.color=D[h+2],u.uniforms.angle=R[h+2],A.drawArrays(A.TRIANGLES,B,F))}}(),o.drawTitle=function(){var y=[0,0],p=[0,0];return function(){var g=this.plot,h=this.shader,m=g.gl,u=g.screenBox,_=g.titleCenter,s=g.titleAngle,A=g.titleColor,b=g.pixelRatio;if(!!this.titleCount){for(var f=0;f<2;++f)p[f]=2*(_[f]*b-u[f])/(u[2+f]-u[f])-1;h.bind(),h.uniforms.dataAxis=y,h.uniforms.screenOffset=p,h.uniforms.angle=s,h.uniforms.color=A,m.drawArrays(m.TRIANGLES,this.titleOffset,this.titleCount)}}}(),o.bind=function(){var y=[0,0],p=[0,0],g=[0,0];return function(){var h=this.plot,m=this.shader,u=h._tickBounds,_=h.dataBox,s=h.screenBox,A=h.viewBox;m.bind();for(var b=0;b<2;++b){var f=u[b],x=u[b+2],l=x-f,L=.5*(_[b+2]+_[b]),T=_[b+2]-_[b],k=A[b],P=A[b+2],z=P-k,I=s[b],D=s[b+2],R=D-I;p[b]=2*l/T*z/R,y[b]=2*(f-L)/T*z/R}g[1]=2*h.pixelRatio/(s[3]-s[1]),g[0]=g[1]*(s[3]-s[1])/(s[2]-s[0]),m.uniforms.dataScale=p,m.uniforms.dataShift=y,m.uniforms.textScale=g,this.vbo.bind(),m.attributes.textCoordinate.pointer()}}(),o.update=function(y){var p=[],g=y.ticks,h=y.bounds,m,u,_,s,A;for(A=0;A<2;++A){var b=[Math.floor(p.length/3)],f=[-1/0],x=g[A];for(m=0;m<x.length;++m){var l=x[m],L=l.x,T=l.text,k=l.font||"sans-serif";s=l.fontSize||12;for(var P=1/(h[A+2]-h[A]),z=h[A],I=T.split(`
`),D=0;D<I.length;D++)for(_=n(k,I[D]).data,u=0;u<_.length;u+=2)p.push(_[u]*s,-_[u+1]*s-D*s*1.2,(L-z)*P);b.push(Math.floor(p.length/3)),f.push(L)}this.tickOffset[A]=b,this.tickX[A]=f}for(A=0;A<2;++A){for(this.labelOffset[A]=Math.floor(p.length/3),_=n(y.labelFont[A],y.labels[A],{textAlign:"center"}).data,s=y.labelSize[A],m=0;m<_.length;m+=2)p.push(_[m]*s,-_[m+1]*s,0);this.labelCount[A]=Math.floor(p.length/3)-this.labelOffset[A]}for(this.titleOffset=Math.floor(p.length/3),_=n(y.titleFont,y.title).data,s=y.titleSize,m=0;m<_.length;m+=2)p.push(_[m]*s,-_[m+1]*s,0);this.titleCount=Math.floor(p.length/3)-this.titleOffset,this.vbo.update(p)},o.dispose=function(){this.vbo.dispose(),this.shader.dispose()};function i(y){var p=y.gl,g=e(p),h=a(p,t.textVert,t.textFrag),m=new c(y,g,h);return m}},{"./shaders":116,"binary-search-bounds":31,"gl-buffer":78,"gl-shader":132,"text-cache":303}],118:[function(v,S,M){S.exports=p;var e=v("gl-select-static"),a=v("./lib/grid"),n=v("./lib/text"),r=v("./lib/line"),t=v("./lib/box");function c(g,h){this.gl=g,this.pickBuffer=h,this.screenBox=[0,0,g.drawingBufferWidth,g.drawingBufferHeight],this.viewBox=[0,0,0,0],this.dataBox=[-10,-10,10,10],this.gridLineEnable=[!0,!0],this.gridLineWidth=[1,1],this.gridLineColor=[[0,0,0,1],[0,0,0,1]],this.pixelRatio=1,this.tickMarkLength=[0,0,0,0],this.tickMarkWidth=[0,0,0,0],this.tickMarkColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickPad=[15,15,15,15],this.tickAngle=[0,0,0,0],this.tickEnable=[!0,!0,!0,!0],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labelPad=[15,15,15,15],this.labelAngle=[0,Math.PI/2,0,3*Math.PI/2],this.labelEnable=[!0,!0,!0,!0],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.titleCenter=[0,0],this.titleEnable=!0,this.titleAngle=0,this.titleColor=[0,0,0,1],this.borderColor=[0,0,0,0],this.backgroundColor=[0,0,0,0],this.zeroLineEnable=[!0,!0],this.zeroLineWidth=[4,4],this.zeroLineColor=[[0,0,0,1],[0,0,0,1]],this.borderLineEnable=[!0,!0,!0,!0],this.borderLineWidth=[2,2,2,2],this.borderLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.grid=null,this.text=null,this.line=null,this.box=null,this.objects=[],this.overlays=[],this._tickBounds=[1/0,1/0,-1/0,-1/0],this.static=!1,this.dirty=!1,this.pickDirty=!1,this.pickDelay=120,this.pickRadius=10,this._pickTimeout=null,this._drawPick=this.drawPick.bind(this),this._depthCounter=0}var o=c.prototype;o.setDirty=function(){this.dirty=this.pickDirty=!0},o.setOverlayDirty=function(){this.dirty=!0},o.nextDepthValue=function(){return this._depthCounter++/65536},o.draw=function(){return function(){var g=this.gl,h=this.screenBox,m=this.viewBox,u=this.dataBox,_=this.pixelRatio,s=this.grid,A=this.line,b=this.text,f=this.objects;if(this._depthCounter=0,this.pickDirty&&(this._pickTimeout&&clearTimeout(this._pickTimeout),this.pickDirty=!1,this._pickTimeout=setTimeout(this._drawPick,this.pickDelay)),!!this.dirty){if(this.dirty=!1,g.bindFramebuffer(g.FRAMEBUFFER,null),g.enable(g.SCISSOR_TEST),g.disable(g.DEPTH_TEST),g.depthFunc(g.LESS),g.depthMask(!1),g.enable(g.BLEND),g.blendEquation(g.FUNC_ADD,g.FUNC_ADD),g.blendFunc(g.ONE,g.ONE_MINUS_SRC_ALPHA),this.borderColor){g.scissor(h[0],h[1],h[2]-h[0],h[3]-h[1]);var x=this.borderColor;g.clearColor(x[0]*x[3],x[1]*x[3],x[2]*x[3],x[3]),g.clear(g.COLOR_BUFFER_BIT|g.DEPTH_BUFFER_BIT)}g.scissor(m[0],m[1],m[2]-m[0],m[3]-m[1]),g.viewport(m[0],m[1],m[2]-m[0],m[3]-m[1]);var l=this.backgroundColor;g.clearColor(l[0]*l[3],l[1]*l[3],l[2]*l[3],l[3]),g.clear(g.COLOR_BUFFER_BIT),s.draw();var L=this.zeroLineEnable,T=this.zeroLineColor,k=this.zeroLineWidth;if(L[0]||L[1]){A.bind();for(var P=0;P<2;++P)if(!(!L[P]||!(u[P]<=0&&u[P+2]>=0))){var z=h[P]-u[P]*(h[P+2]-h[P])/(u[P+2]-u[P]);P===0?A.drawLine(z,h[1],z,h[3],k[P],T[P]):A.drawLine(h[0],z,h[2],z,k[P],T[P])}}for(var P=0;P<f.length;++P)f[P].draw();g.viewport(h[0],h[1],h[2]-h[0],h[3]-h[1]),g.scissor(h[0],h[1],h[2]-h[0],h[3]-h[1]),this.grid.drawTickMarks(),A.bind();var I=this.borderLineEnable,D=this.borderLineWidth,R=this.borderLineColor;I[1]&&A.drawLine(m[0],m[1]-.5*D[1]*_,m[0],m[3]+.5*D[3]*_,D[1],R[1]),I[0]&&A.drawLine(m[0]-.5*D[0]*_,m[1],m[2]+.5*D[2]*_,m[1],D[0],R[0]),I[3]&&A.drawLine(m[2],m[1]-.5*D[1]*_,m[2],m[3]+.5*D[3]*_,D[3],R[3]),I[2]&&A.drawLine(m[0]-.5*D[0]*_,m[3],m[2]+.5*D[2]*_,m[3],D[2],R[2]),b.bind();for(var P=0;P<2;++P)b.drawTicks(P);this.titleEnable&&b.drawTitle();for(var B=this.overlays,P=0;P<B.length;++P)B[P].draw();g.disable(g.SCISSOR_TEST),g.disable(g.BLEND),g.depthMask(!0)}}}(),o.drawPick=function(){return function(){if(!this.static){var g=this.pickBuffer;this.gl,this._pickTimeout=null,g.begin();for(var h=1,m=this.objects,u=0;u<m.length;++u)h=m[u].drawPick(h);g.end()}}}(),o.pick=function(){return function(g,h){if(!this.static){var m=this.pixelRatio,u=this.pickPixelRatio,_=this.viewBox,s=Math.round((g-_[0]/m)*u)|0,A=Math.round((h-_[1]/m)*u)|0,b=this.pickBuffer.query(s,A,this.pickRadius);if(!b)return null;for(var f=b.id+(b.value[0]<<8)+(b.value[1]<<16)+(b.value[2]<<24),x=this.objects,l=0;l<x.length;++l){var L=x[l].pick(s,A,f);if(L)return L}return null}}}();function i(g){for(var h=g.slice(),m=0;m<h.length;++m)h[m]=h[m].slice();return h}function y(g,h){return g.x-h.x}o.setScreenBox=function(g){var h=this.screenBox,m=this.pixelRatio;h[0]=Math.round(g[0]*m)|0,h[1]=Math.round(g[1]*m)|0,h[2]=Math.round(g[2]*m)|0,h[3]=Math.round(g[3]*m)|0,this.setDirty()},o.setDataBox=function(g){var h=this.dataBox,m=h[0]!==g[0]||h[1]!==g[1]||h[2]!==g[2]||h[3]!==g[3];m&&(h[0]=g[0],h[1]=g[1],h[2]=g[2],h[3]=g[3],this.setDirty())},o.setViewBox=function(g){var h=this.pixelRatio,m=this.viewBox;m[0]=Math.round(g[0]*h)|0,m[1]=Math.round(g[1]*h)|0,m[2]=Math.round(g[2]*h)|0,m[3]=Math.round(g[3]*h)|0;var u=this.pickPixelRatio;this.pickBuffer.shape=[Math.round((g[2]-g[0])*u)|0,Math.round((g[3]-g[1])*u)|0],this.setDirty()},o.update=function(g){g=g||{};var h=this.gl;this.pixelRatio=g.pixelRatio||1;var m=this.pixelRatio;this.pickPixelRatio=Math.max(m,1),this.setScreenBox(g.screenBox||[0,0,h.drawingBufferWidth/m,h.drawingBufferHeight/m]),this.screenBox,this.setViewBox(g.viewBox||[.125*(this.screenBox[2]-this.screenBox[0])/m,.125*(this.screenBox[3]-this.screenBox[1])/m,.875*(this.screenBox[2]-this.screenBox[0])/m,.875*(this.screenBox[3]-this.screenBox[1])/m]);var u=this.viewBox,_=(u[2]-u[0])/(u[3]-u[1]);this.setDataBox(g.dataBox||[-10,-10/_,10,10/_]),this.borderColor=g.borderColor!==!1?(g.borderColor||[0,0,0,0]).slice():!1,this.backgroundColor=(g.backgroundColor||[0,0,0,0]).slice(),this.gridLineEnable=(g.gridLineEnable||[!0,!0]).slice(),this.gridLineWidth=(g.gridLineWidth||[1,1]).slice(),this.gridLineColor=i(g.gridLineColor||[[.5,.5,.5,1],[.5,.5,.5,1]]),this.zeroLineEnable=(g.zeroLineEnable||[!0,!0]).slice(),this.zeroLineWidth=(g.zeroLineWidth||[4,4]).slice(),this.zeroLineColor=i(g.zeroLineColor||[[0,0,0,1],[0,0,0,1]]),this.tickMarkLength=(g.tickMarkLength||[0,0,0,0]).slice(),this.tickMarkWidth=(g.tickMarkWidth||[0,0,0,0]).slice(),this.tickMarkColor=i(g.tickMarkColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]),this.titleCenter=(g.titleCenter||[.5*(u[0]+u[2])/m,(u[3]+120)/m]).slice(),this.titleEnable=!("titleEnable"in g)||!!g.titleEnable,this.titleAngle=g.titleAngle||0,this.titleColor=(g.titleColor||[0,0,0,1]).slice(),this.labelPad=(g.labelPad||[15,15,15,15]).slice(),this.labelAngle=(g.labelAngle||[0,Math.PI/2,0,3*Math.PI/2]).slice(),this.labelEnable=(g.labelEnable||[!0,!0,!0,!0]).slice(),this.labelColor=i(g.labelColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]),this.tickPad=(g.tickPad||[15,15,15,15]).slice(),this.tickAngle=(g.tickAngle||[0,0,0,0]).slice(),this.tickEnable=(g.tickEnable||[!0,!0,!0,!0]).slice(),this.tickColor=i(g.tickColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]),this.borderLineEnable=(g.borderLineEnable||[!0,!0,!0,!0]).slice(),this.borderLineWidth=(g.borderLineWidth||[2,2,2,2]).slice(),this.borderLineColor=i(g.borderLineColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]);var s=g.ticks||[[],[]],A=this._tickBounds;A[0]=A[1]=1/0,A[2]=A[3]=-1/0;for(var b=0;b<2;++b){var f=s[b].slice(0);f.length!==0&&(f.sort(y),A[b]=Math.min(A[b],f[0].x),A[b+2]=Math.max(A[b+2],f[f.length-1].x))}this.grid.update({bounds:A,ticks:s}),this.text.update({bounds:A,ticks:s,labels:g.labels||["x","y"],labelSize:g.labelSize||[12,12],labelFont:g.labelFont||["sans-serif","sans-serif"],title:g.title||"",titleSize:g.titleSize||18,titleFont:g.titleFont||"sans-serif"}),this.static=!!g.static,this.setDirty()},o.dispose=function(){this.box.dispose(),this.grid.dispose(),this.text.dispose(),this.line.dispose();for(var g=this.objects.length-1;g>=0;--g)this.objects[g].dispose();this.objects.length=0;for(var g=this.overlays.length-1;g>=0;--g)this.overlays[g].dispose();this.overlays.length=0,this.gl=null},o.addObject=function(g){this.objects.indexOf(g)<0&&(this.objects.push(g),this.setDirty())},o.removeObject=function(g){for(var h=this.objects,m=0;m<h.length;++m)if(h[m]===g){h.splice(m,1),this.setDirty();break}},o.addOverlay=function(g){this.overlays.indexOf(g)<0&&(this.overlays.push(g),this.setOverlayDirty())},o.removeOverlay=function(g){for(var h=this.overlays,m=0;m<h.length;++m)if(h[m]===g){h.splice(m,1),this.setOverlayDirty();break}};function p(g){var h=g.gl,m=e(h,[h.drawingBufferWidth,h.drawingBufferHeight]),u=new c(h,m);return u.grid=a(u),u.text=n(u),u.line=r(u),u.box=t(u),u.update(g),u}},{"./lib/box":113,"./lib/grid":114,"./lib/line":115,"./lib/text":117,"gl-select-static":131}],119:[function(v,S,M){S.exports=o;var e=v("right-now"),a=v("3d-view"),n=v("mouse-change"),r=v("mouse-wheel"),t=v("mouse-event-offset"),c=v("has-passive-events");function o(i,y){i=i||document.body,y=y||{};var p=[.01,1/0];"distanceLimits"in y&&(p[0]=y.distanceLimits[0],p[1]=y.distanceLimits[1]),"zoomMin"in y&&(p[0]=y.zoomMin),"zoomMax"in y&&(p[1]=y.zoomMax);var g=a({center:y.center||[0,0,0],up:y.up||[0,1,0],eye:y.eye||[0,0,10],mode:y.mode||"orbit",distanceLimits:p}),h=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],m=0,u=i.clientWidth,_=i.clientHeight,s={keyBindingMode:"rotate",enableWheel:!0,view:g,element:i,delay:y.delay||16,rotateSpeed:y.rotateSpeed||1,zoomSpeed:y.zoomSpeed||1,translateSpeed:y.translateSpeed||1,flipX:!!y.flipX,flipY:!!y.flipY,modes:g.modes,_ortho:y._ortho||y.projection&&y.projection.type==="orthographic"||!1,tick:function(){var A=e(),b=this.delay,f=A-2*b;g.idle(A-b),g.recalcMatrix(f),g.flush(A-(100+b*2));for(var x=!0,l=g.computedMatrix,L=0;L<16;++L)x=x&&h[L]===l[L],h[L]=l[L];var T=i.clientWidth===u&&i.clientHeight===_;return u=i.clientWidth,_=i.clientHeight,x?!T:(m=Math.exp(g.computedRadius[0]),!0)},lookAt:function(A,b,f){g.lookAt(g.lastT(),A,b,f)},rotate:function(A,b,f){g.rotate(g.lastT(),A,b,f)},pan:function(A,b,f){g.pan(g.lastT(),A,b,f)},translate:function(A,b,f){g.translate(g.lastT(),A,b,f)}};return Object.defineProperties(s,{matrix:{get:function(){return g.computedMatrix},set:function(A){return g.setMatrix(g.lastT(),A),g.computedMatrix},enumerable:!0},mode:{get:function(){return g.getMode()},set:function(A){var b=g.computedUp.slice(),f=g.computedEye.slice(),x=g.computedCenter.slice();if(g.setMode(A),A==="turntable"){var l=e();g._active.lookAt(l,f,x,b),g._active.lookAt(l+500,f,x,[0,0,1]),g._active.flush(l)}return g.getMode()},enumerable:!0},center:{get:function(){return g.computedCenter},set:function(A){return g.lookAt(g.lastT(),null,A),g.computedCenter},enumerable:!0},eye:{get:function(){return g.computedEye},set:function(A){return g.lookAt(g.lastT(),A),g.computedEye},enumerable:!0},up:{get:function(){return g.computedUp},set:function(A){return g.lookAt(g.lastT(),null,null,A),g.computedUp},enumerable:!0},distance:{get:function(){return m},set:function(A){return g.setDistance(g.lastT(),A),A},enumerable:!0},distanceLimits:{get:function(){return g.getDistanceLimits(p)},set:function(A){return g.setDistanceLimits(A),A},enumerable:!0}}),i.addEventListener("contextmenu",function(A){return A.preventDefault(),!1}),s._lastX=-1,s._lastY=-1,s._lastMods={shift:!1,control:!1,alt:!1,meta:!1},s.enableMouseListeners=function(){s.mouseListener=n(i,A),i.addEventListener("touchstart",function(b){var f=t(b.changedTouches[0],i);A(0,f[0],f[1],s._lastMods),A(1,f[0],f[1],s._lastMods)},c?{passive:!0}:!1),i.addEventListener("touchmove",function(b){var f=t(b.changedTouches[0],i);A(1,f[0],f[1],s._lastMods),b.preventDefault()},c?{passive:!1}:!1),i.addEventListener("touchend",function(b){A(0,s._lastX,s._lastY,s._lastMods)},c?{passive:!0}:!1);function A(b,f,x,l){var L=s.keyBindingMode;if(L!==!1){var T=L==="rotate",k=L==="pan",P=L==="zoom",z=!!l.control,I=!!l.alt,D=!!l.shift,R=!!(b&1),B=!!(b&2),F=!!(b&4),H=1/i.clientHeight,G=H*(f-s._lastX),J=H*(x-s._lastY),X=s.flipX?1:-1,Y=s.flipY?1:-1,Z=Math.PI*s.rotateSpeed,oe=e();if(s._lastX!==-1&&s._lastY!==-1&&((T&&R&&!z&&!I&&!D||R&&!z&&!I&&D)&&g.rotate(oe,X*Z*G,-Y*Z*J,0),(k&&R&&!z&&!I&&!D||B||R&&z&&!I&&!D)&&g.pan(oe,-s.translateSpeed*G*m,s.translateSpeed*J*m,0),P&&R&&!z&&!I&&!D||F||R&&!z&&I&&!D)){var re=-s.zoomSpeed*J/window.innerHeight*(oe-g.lastT())*100;g.pan(oe,0,0,m*(Math.exp(re)-1))}return s._lastX=f,s._lastY=x,s._lastMods=l,!0}}s.wheelListener=r(i,function(b,f){if(s.keyBindingMode!==!1&&!!s.enableWheel){var x=s.flipX?1:-1,l=s.flipY?1:-1,L=e();if(Math.abs(b)>Math.abs(f))g.rotate(L,0,0,-b*x*Math.PI*s.rotateSpeed/window.innerWidth);else if(!s._ortho){var T=-s.zoomSpeed*l*f/window.innerHeight*(L-g.lastT())/20;g.pan(L,0,0,m*(Math.exp(T)-1))}}},!0)},s.enableMouseListeners(),s}},{"3d-view":7,"has-passive-events":232,"mouse-change":247,"mouse-event-offset":248,"mouse-wheel":250,"right-now":278}],120:[function(v,S,M){var e=v("glslify"),a=v("gl-shader"),n=e([`precision mediump float;
#define GLSLIFY 1
attribute vec2 position;
varying vec2 uv;
void main() {
  uv = position;
  gl_Position = vec4(position, 0, 1);
}`]),r=e([`precision mediump float;
#define GLSLIFY 1

uniform sampler2D accumBuffer;
varying vec2 uv;

void main() {
  vec4 accum = texture2D(accumBuffer, 0.5 * (uv + 1.0));
  gl_FragColor = min(vec4(1,1,1,1), accum);
}`]);S.exports=function(t){return a(t,n,r,null,[{name:"position",type:"vec2"}])}},{"gl-shader":132,glslify:231}],121:[function(v,S,M){var e=v("./camera.js"),a=v("gl-axes3d"),n=v("gl-axes3d/properties"),r=v("gl-spikes3d"),t=v("gl-select-static"),c=v("gl-fbo"),o=v("a-big-triangle"),i=v("mouse-change"),y=v("gl-mat4/perspective"),p=v("gl-mat4/ortho"),g=v("./lib/shader"),h=v("is-mobile")({tablet:!0,featureDetect:!0});S.exports={createScene:A,createCamera:e};function m(){this.mouse=[-1,-1],this.screen=null,this.distance=1/0,this.index=null,this.dataCoordinate=null,this.dataPosition=null,this.object=null,this.data=null}function u(f,x){var l=null;try{l=f.getContext("webgl",x),l||(l=f.getContext("experimental-webgl",x))}catch{return null}return l}function _(f){var x=Math.round(Math.log(Math.abs(f))/Math.log(10));if(x<0){var l=Math.round(Math.pow(10,-x));return Math.ceil(f*l)/l}else if(x>0){var l=Math.round(Math.pow(10,x));return Math.ceil(f/l)*l}return Math.ceil(f)}function s(f){return typeof f=="boolean"?f:!0}function A(f){f=f||{},f.camera=f.camera||{};var x=f.canvas;if(!x)if(x=document.createElement("canvas"),f.container){var l=f.container;l.appendChild(x)}else document.body.appendChild(x);var L=f.gl;if(L||(f.glOptions&&(h=!!f.glOptions.preserveDrawingBuffer),L=u(x,f.glOptions||{premultipliedAlpha:!0,antialias:!0,preserveDrawingBuffer:h})),!L)throw new Error("webgl not supported");var T=f.bounds||[[-10,-10,-10],[10,10,10]],k=new m,P=c(L,L.drawingBufferWidth,L.drawingBufferHeight,{preferFloat:!h}),z=g(L),I=f.cameraObject&&f.cameraObject._ortho===!0||f.camera.projection&&f.camera.projection.type==="orthographic"||!1,D={eye:f.camera.eye||[2,0,0],center:f.camera.center||[0,0,0],up:f.camera.up||[0,1,0],zoomMin:f.camera.zoomMax||.1,zoomMax:f.camera.zoomMin||100,mode:f.camera.mode||"turntable",_ortho:I},R=f.axes||{},B=a(L,R);B.enable=!R.disable;var F=f.spikes||{},H=r(L,F),G=[],J=[],X=[],Y=[],Z=!0,N=!0,oe=new Array(16),re=new Array(16),se={view:null,projection:oe,model:re,_ortho:!1},N=!0,U=[L.drawingBufferWidth,L.drawingBufferHeight],q=f.cameraObject||e(x,D),$={gl:L,contextLost:!1,pixelRatio:f.pixelRatio||1,canvas:x,selection:k,camera:q,axes:B,axesPixels:null,spikes:H,bounds:T,objects:G,shape:U,aspect:f.aspectRatio||[1,1,1],pickRadius:f.pickRadius||10,zNear:f.zNear||.01,zFar:f.zFar||1e3,fovy:f.fovy||Math.PI/4,clearColor:f.clearColor||[0,0,0,0],autoResize:s(f.autoResize),autoBounds:s(f.autoBounds),autoScale:!!f.autoScale,autoCenter:s(f.autoCenter),clipToBounds:s(f.clipToBounds),snapToData:!!f.snapToData,onselect:f.onselect||null,onrender:f.onrender||null,onclick:f.onclick||null,cameraParams:se,oncontextloss:null,mouseListener:null,_stopped:!1,getAspectratio:function(){return{x:this.aspect[0],y:this.aspect[1],z:this.aspect[2]}},setAspectratio:function(ge){this.aspect[0]=ge.x,this.aspect[1]=ge.y,this.aspect[2]=ge.z,N=!0},setBounds:function(ge,Te){this.bounds[0][ge]=Te.min,this.bounds[1][ge]=Te.max},setClearColor:function(ge){this.clearColor=ge},clearRGBA:function(){this.gl.clearColor(this.clearColor[0],this.clearColor[1],this.clearColor[2],this.clearColor[3]),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT)}},W=[L.drawingBufferWidth/$.pixelRatio|0,L.drawingBufferHeight/$.pixelRatio|0];function K(){if(!$._stopped&&!!$.autoResize){var ge=x.parentNode,Te=1,_e=1;ge&&ge!==document.body?(Te=ge.clientWidth,_e=ge.clientHeight):(Te=window.innerWidth,_e=window.innerHeight);var ze=Math.ceil(Te*$.pixelRatio)|0,Oe=Math.ceil(_e*$.pixelRatio)|0;if(ze!==x.width||Oe!==x.height){x.width=ze,x.height=Oe;var Ye=x.style;Ye.position=Ye.position||"absolute",Ye.left="0px",Ye.top="0px",Ye.width=Te+"px",Ye.height=_e+"px",Z=!0}}}$.autoResize&&K(),window.addEventListener("resize",K);function ne(){for(var ge=G.length,Te=Y.length,_e=0;_e<Te;++_e)X[_e]=0;e:for(var _e=0;_e<ge;++_e){var ze=G[_e],Oe=ze.pickSlots;if(!Oe){J[_e]=-1;continue}for(var Ye=0;Ye<Te;++Ye)if(X[Ye]+Oe<255){J[_e]=Ye,ze.setPickBase(X[Ye]+1),X[Ye]+=Oe;continue e}var be=t(L,U);J[_e]=Te,Y.push(be),X.push(Oe),ze.setPickBase(1),Te+=1}for(;Te>0&&X[Te-1]===0;)X.pop(),Y.pop().dispose()}$.update=function(ge){$._stopped||(Z=!0,N=!0)},$.add=function(ge){$._stopped||(ge.axes=B,G.push(ge),J.push(-1),Z=!0,N=!0,ne())},$.remove=function(ge){if(!$._stopped){var Te=G.indexOf(ge);Te<0||(G.splice(Te,1),J.pop(),Z=!0,N=!0,ne())}},$.dispose=function(){if(!$._stopped&&($._stopped=!0,window.removeEventListener("resize",K),x.removeEventListener("webglcontextlost",ae),$.mouseListener.enabled=!1,!$.contextLost)){B.dispose(),H.dispose();for(var ge=0;ge<G.length;++ge)G[ge].dispose();P.dispose();for(var ge=0;ge<Y.length;++ge)Y[ge].dispose();z.dispose(),L=null,B=null,H=null,G=[]}},$._mouseRotating=!1,$._prevButtons=0,$.enableMouseListeners=function(){$.mouseListener=i(x,function(ge,Te,_e){if(!$._stopped){var ze=Y.length,Oe=G.length,Ye=k.object;k.distance=1/0,k.mouse[0]=Te,k.mouse[1]=_e,k.object=null,k.screen=null,k.dataCoordinate=k.dataPosition=null;var be=!1;if(ge&&$._prevButtons)$._mouseRotating=!0;else{$._mouseRotating&&(N=!0),$._mouseRotating=!1;for(var Pe=0;Pe<ze;++Pe){var Ge=Y[Pe].query(Te,W[1]-_e-1,$.pickRadius);if(Ge){if(Ge.distance>k.distance)continue;for(var Qe=0;Qe<Oe;++Qe){var Be=G[Qe];if(J[Qe]===Pe){var Le=Be.pick(Ge);Le&&(k.buttons=ge,k.screen=Ge.coord,k.distance=Ge.distance,k.object=Be,k.index=Le.distance,k.dataPosition=Le.position,k.dataCoordinate=Le.dataCoordinate,k.data=Le,be=!0)}}}}}Ye&&Ye!==k.object&&(Ye.highlight&&Ye.highlight(null),Z=!0),k.object&&(k.object.highlight&&k.object.highlight(k.data),Z=!0),be=be||k.object!==Ye,be&&$.onselect&&$.onselect(k),ge&1&&!($._prevButtons&1)&&$.onclick&&$.onclick(k),$._prevButtons=ge}})};function ae(){if($.contextLost)return!0;L.isContextLost()&&($.contextLost=!0,$.mouseListener.enabled=!1,$.selection.object=null,$.oncontextloss&&$.oncontextloss())}x.addEventListener("webglcontextlost",ae);function ie(){if(!ae()){L.colorMask(!0,!0,!0,!0),L.depthMask(!0),L.disable(L.BLEND),L.enable(L.DEPTH_TEST),L.depthFunc(L.LEQUAL);for(var ge=G.length,Te=Y.length,_e=0;_e<Te;++_e){var ze=Y[_e];ze.shape=W,ze.begin();for(var Oe=0;Oe<ge;++Oe)if(J[Oe]===_e){var Ye=G[Oe];Ye.drawPick&&(Ye.pixelRatio=1,Ye.drawPick(se))}ze.end()}}}var le=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],ye=[le[0].slice(),le[1].slice()];function ue(){if(!ae()){K();var ge=$.camera.tick();se.view=$.camera.matrix,Z=Z||ge,N=N||ge,B.pixelRatio=$.pixelRatio,H.pixelRatio=$.pixelRatio;var Te=G.length,_e=le[0],ze=le[1];_e[0]=_e[1]=_e[2]=1/0,ze[0]=ze[1]=ze[2]=-1/0;for(var Oe=0;Oe<Te;++Oe){var Ye=G[Oe];Ye.pixelRatio=$.pixelRatio,Ye.axes=$.axes,Z=Z||!!Ye.dirty,N=N||!!Ye.dirty;var be=Ye.bounds;if(be)for(var Pe=be[0],Ge=be[1],Qe=0;Qe<3;++Qe)_e[Qe]=Math.min(_e[Qe],Pe[Qe]),ze[Qe]=Math.max(ze[Qe],Ge[Qe])}var Be=$.bounds;if($.autoBounds)for(var Qe=0;Qe<3;++Qe){if(ze[Qe]<_e[Qe])_e[Qe]=-1,ze[Qe]=1;else{_e[Qe]===ze[Qe]&&(_e[Qe]-=1,ze[Qe]+=1);var Le=.05*(ze[Qe]-_e[Qe]);_e[Qe]=_e[Qe]-Le,ze[Qe]=ze[Qe]+Le}Be[0][Qe]=_e[Qe],Be[1][Qe]=ze[Qe]}for(var He=!1,Qe=0;Qe<3;++Qe)He=He||ye[0][Qe]!==Be[0][Qe]||ye[1][Qe]!==Be[1][Qe],ye[0][Qe]=Be[0][Qe],ye[1][Qe]=Be[1][Qe];if(N=N||He,Z=Z||He,!!Z){if(He){for(var vt=[0,0,0],Oe=0;Oe<3;++Oe)vt[Oe]=_((Be[1][Oe]-Be[0][Oe])/10);B.autoTicks?B.update({bounds:Be,tickSpacing:vt}):B.update({bounds:Be})}var Rt=L.drawingBufferWidth,rr=L.drawingBufferHeight;U[0]=Rt,U[1]=rr,W[0]=Math.max(Rt/$.pixelRatio,1)|0,W[1]=Math.max(rr/$.pixelRatio,1)|0,b($,I);for(var Oe=0;Oe<Te;++Oe){var Ye=G[Oe];Ye.axesBounds=Be,$.clipToBounds&&(Ye.clipBounds=Be)}k.object&&($.snapToData?H.position=k.dataCoordinate:H.position=k.dataPosition,H.bounds=Be),N&&(N=!1,ie()),$.axesPixels=n($.axes,se,Rt,rr),$.onrender&&$.onrender(),L.bindFramebuffer(L.FRAMEBUFFER,null),L.viewport(0,0,Rt,rr),$.clearRGBA(),L.depthMask(!0),L.colorMask(!0,!0,!0,!0),L.enable(L.DEPTH_TEST),L.depthFunc(L.LEQUAL),L.disable(L.BLEND),L.disable(L.CULL_FACE);var Lt=!1;B.enable&&(Lt=Lt||B.isTransparent(),B.draw(se)),H.axes=B,k.object&&H.draw(se),L.disable(L.CULL_FACE);for(var Oe=0;Oe<Te;++Oe){var Ye=G[Oe];Ye.axes=B,Ye.pixelRatio=$.pixelRatio,Ye.isOpaque&&Ye.isOpaque()&&Ye.draw(se),Ye.isTransparent&&Ye.isTransparent()&&(Lt=!0)}if(Lt){P.shape=U,P.bind(),L.clear(L.DEPTH_BUFFER_BIT),L.colorMask(!1,!1,!1,!1),L.depthMask(!0),L.depthFunc(L.LESS),B.enable&&B.isTransparent()&&B.drawTransparent(se);for(var Oe=0;Oe<Te;++Oe){var Ye=G[Oe];Ye.isOpaque&&Ye.isOpaque()&&Ye.draw(se)}L.enable(L.BLEND),L.blendEquation(L.FUNC_ADD),L.blendFunc(L.ONE,L.ONE_MINUS_SRC_ALPHA),L.colorMask(!0,!0,!0,!0),L.depthMask(!1),L.clearColor(0,0,0,0),L.clear(L.COLOR_BUFFER_BIT),B.isTransparent()&&B.drawTransparent(se);for(var Oe=0;Oe<Te;++Oe){var Ye=G[Oe];Ye.isTransparent&&Ye.isTransparent()&&Ye.drawTransparent(se)}L.bindFramebuffer(L.FRAMEBUFFER,null),L.blendFunc(L.ONE,L.ONE_MINUS_SRC_ALPHA),L.disable(L.DEPTH_TEST),z.bind(),P.color[0].bind(0),z.uniforms.accumBuffer=0,o(L),L.disable(L.BLEND)}Z=!1;for(var Oe=0;Oe<Te;++Oe)G[Oe].dirty=!1}}}function pe(){$._stopped||$.contextLost||(ue(),requestAnimationFrame(pe))}return $.enableMouseListeners(),pe(),$.redraw=function(){$._stopped||(Z=!0,ue())},$}function b(f,x){var l=f.bounds,L=f.cameraParams,T=L.projection,k=L.model,P=f.gl.drawingBufferWidth,z=f.gl.drawingBufferHeight,I=f.zNear,D=f.zFar,R=f.fovy,B=P/z;x?(p(T,-B,B,-1,1,I,D),L._ortho=!0):(y(T,R,B,I,D),L._ortho=!1);for(var F=0;F<16;++F)k[F]=0;k[15]=1;for(var H=0,F=0;F<3;++F)H=Math.max(H,l[1][F]-l[0][F]);for(var F=0;F<3;++F)f.autoScale?k[5*F]=f.aspect[F]/(l[1][F]-l[0][F]):k[5*F]=1/H,f.autoCenter&&(k[12+F]=-k[5*F]*.5*(l[0][F]+l[1][F]))}},{"./camera.js":119,"./lib/shader":120,"a-big-triangle":8,"gl-axes3d":70,"gl-axes3d/properties":77,"gl-fbo":86,"gl-mat4/ortho":101,"gl-mat4/perspective":102,"gl-select-static":131,"gl-spikes3d":141,"is-mobile":238,"mouse-change":247}],122:[function(v,S,M){var e=v("glslify");M.pointVertex=e([`precision mediump float;
#define GLSLIFY 1

attribute vec2 position;

uniform mat3 matrix;
uniform float pointSize;
uniform float pointCloud;

highp float rand(vec2 co) {
  highp float a = 12.9898;
  highp float b = 78.233;
  highp float c = 43758.5453;
  highp float d = dot(co.xy, vec2(a, b));
  highp float e = mod(d, 3.14);
  return fract(sin(e) * c);
}

void main() {
  vec3 hgPosition = matrix * vec3(position, 1);
  gl_Position  = vec4(hgPosition.xy, 0, hgPosition.z);
    // if we don't jitter the point size a bit, overall point cloud
    // saturation 'jumps' on zooming, which is disturbing and confusing
  gl_PointSize = pointSize * ((19.5 + rand(position)) / 20.0);
  if(pointCloud != 0.0) { // pointCloud is truthy
    // get the same square surface as circle would be
    gl_PointSize *= 0.886;
  }
}`]),M.pointFragment=e([`precision mediump float;
#define GLSLIFY 1

uniform vec4 color, borderColor;
uniform float centerFraction;
uniform float pointCloud;

void main() {
  float radius;
  vec4 baseColor;
  if(pointCloud != 0.0) { // pointCloud is truthy
    if(centerFraction == 1.0) {
      gl_FragColor = color;
    } else {
      gl_FragColor = mix(borderColor, color, centerFraction);
    }
  } else {
    radius = length(2.0 * gl_PointCoord.xy - 1.0);
    if(radius > 1.0) {
      discard;
    }
    baseColor = mix(borderColor, color, step(radius, centerFraction));
    gl_FragColor = vec4(baseColor.rgb * baseColor.a, baseColor.a);
  }
}
`]),M.pickVertex=e([`precision mediump float;
#define GLSLIFY 1

attribute vec2 position;
attribute vec4 pickId;

uniform mat3 matrix;
uniform float pointSize;
uniform vec4 pickOffset;

varying vec4 fragId;

void main() {
  vec3 hgPosition = matrix * vec3(position, 1);
  gl_Position  = vec4(hgPosition.xy, 0, hgPosition.z);
  gl_PointSize = pointSize;

  vec4 id = pickId + pickOffset;
  id.y += floor(id.x / 256.0);
  id.x -= floor(id.x / 256.0) * 256.0;

  id.z += floor(id.y / 256.0);
  id.y -= floor(id.y / 256.0) * 256.0;

  id.w += floor(id.z / 256.0);
  id.z -= floor(id.z / 256.0) * 256.0;

  fragId = id;
}
`]),M.pickFragment=e([`precision mediump float;
#define GLSLIFY 1

varying vec4 fragId;

void main() {
  float radius = length(2.0 * gl_PointCoord.xy - 1.0);
  if(radius > 1.0) {
    discard;
  }
  gl_FragColor = fragId / 255.0;
}
`])},{glslify:231}],123:[function(v,S,M){var e=v("gl-shader"),a=v("gl-buffer"),n=v("typedarray-pool"),r=v("./lib/shader");S.exports=i;function t(y,p,g,h,m){this.plot=y,this.offsetBuffer=p,this.pickBuffer=g,this.shader=h,this.pickShader=m,this.sizeMin=.5,this.sizeMinCap=2,this.sizeMax=20,this.areaRatio=1,this.pointCount=0,this.color=[1,0,0,1],this.borderColor=[0,0,0,1],this.blend=!1,this.pickOffset=0,this.points=null}var c=t.prototype;c.dispose=function(){this.shader.dispose(),this.pickShader.dispose(),this.offsetBuffer.dispose(),this.pickBuffer.dispose(),this.plot.removeObject(this)},c.update=function(y){var p;y=y||{};function g(b,f){return b in y?y[b]:f}this.sizeMin=g("sizeMin",.5),this.sizeMax=g("sizeMax",20),this.color=g("color",[1,0,0,1]).slice(),this.areaRatio=g("areaRatio",1),this.borderColor=g("borderColor",[0,0,0,1]).slice(),this.blend=g("blend",!1);var h=y.positions.length>>>1,m=y.positions instanceof Float32Array,u=y.idToIndex instanceof Int32Array&&y.idToIndex.length>=h,_=y.positions,s=m?_:n.mallocFloat32(_.length),A=u?y.idToIndex:n.mallocInt32(h);if(m||s.set(_),!u)for(s.set(_),p=0;p<h;p++)A[p]=p;this.points=_,this.offsetBuffer.update(s),this.pickBuffer.update(A),m||n.free(s),u||n.free(A),this.pointCount=h,this.pickOffset=0};function o(y,p){var g=0,h=y.length>>>1,m;for(m=0;m<h;m++){var u=y[m*2],_=y[m*2+1];u>=p[0]&&u<=p[2]&&_>=p[1]&&_<=p[3]&&g++}return g}c.unifiedDraw=function(){var y=[1,0,0,0,1,0,0,0,1],p=[0,0,0,0];return function(g){var h=g!==void 0,m=h?this.pickShader:this.shader,u=this.plot.gl,_=this.plot.dataBox;if(this.pointCount===0)return g;var s=_[2]-_[0],A=_[3]-_[1],b=o(this.points,_),f=this.plot.pickPixelRatio*Math.max(Math.min(this.sizeMinCap,this.sizeMin),Math.min(this.sizeMax,this.sizeMax/Math.pow(b,.33333)));y[0]=2/s,y[4]=2/A,y[6]=-2*_[0]/s-1,y[7]=-2*_[1]/A-1,this.offsetBuffer.bind(),m.bind(),m.attributes.position.pointer(),m.uniforms.matrix=y,m.uniforms.color=this.color,m.uniforms.borderColor=this.borderColor,m.uniforms.pointCloud=f<5,m.uniforms.pointSize=f,m.uniforms.centerFraction=Math.min(1,Math.max(0,Math.sqrt(1-this.areaRatio))),h&&(p[0]=g&255,p[1]=g>>8&255,p[2]=g>>16&255,p[3]=g>>24&255,this.pickBuffer.bind(),m.attributes.pickId.pointer(u.UNSIGNED_BYTE),m.uniforms.pickOffset=p,this.pickOffset=g);var x=u.getParameter(u.BLEND),l=u.getParameter(u.DITHER);return x&&!this.blend&&u.disable(u.BLEND),l&&u.disable(u.DITHER),u.drawArrays(u.POINTS,0,this.pointCount),x&&!this.blend&&u.enable(u.BLEND),l&&u.enable(u.DITHER),g+this.pointCount}}(),c.draw=c.unifiedDraw,c.drawPick=c.unifiedDraw,c.pick=function(y,p,g){var h=this.pickOffset,m=this.pointCount;if(g<h||g>=h+m)return null;var u=g-h,_=this.points;return{object:this,pointId:u,dataCoord:[_[2*u],_[2*u+1]]}};function i(y,p){var g=y.gl,h=a(g),m=a(g),u=e(g,r.pointVertex,r.pointFragment),_=e(g,r.pickVertex,r.pickFragment),s=new t(y,h,m,u,_);return s.update(p),y.addObject(s),s}},{"./lib/shader":122,"gl-buffer":78,"gl-shader":132,"typedarray-pool":308}],124:[function(v,S,M){S.exports=e;function e(a,n,r,t){var c=n[0],o=n[1],i=n[2],y=n[3],p=r[0],g=r[1],h=r[2],m=r[3],u,_,s,A,b;return _=c*p+o*g+i*h+y*m,_<0&&(_=-_,p=-p,g=-g,h=-h,m=-m),1-_>1e-6?(u=Math.acos(_),s=Math.sin(u),A=Math.sin((1-t)*u)/s,b=Math.sin(t*u)/s):(A=1-t,b=t),a[0]=A*c+b*p,a[1]=A*o+b*g,a[2]=A*i+b*h,a[3]=A*y+b*m,a}},{}],125:[function(v,S,M){S.exports=function(e){return!e&&e!==0?"":e.toString()}},{}],126:[function(v,S,M){var e=v("vectorize-text");S.exports=n;var a={};function n(r,t,c){var o=a[t];if(o||(o=a[t]={}),r in o)return o[r];var i={textAlign:"center",textBaseline:"middle",lineHeight:1,font:t,lineSpacing:1.25,styletags:{breaklines:!0,bolds:!0,italics:!0,subscripts:!0,superscripts:!0}};i.triangles=!0;var y=e(r,i);i.triangles=!1;var p=e(r,i),g,h;if(c&&c!==1){for(g=0;g<y.positions.length;++g)for(h=0;h<y.positions[g].length;++h)y.positions[g][h]/=c;for(g=0;g<p.positions.length;++g)for(h=0;h<p.positions[g].length;++h)p.positions[g][h]/=c}var m=[[1/0,1/0],[-1/0,-1/0]],u=p.positions.length;for(g=0;g<u;++g){var _=p.positions[g];for(h=0;h<2;++h)m[0][h]=Math.min(m[0][h],_[h]),m[1][h]=Math.max(m[1][h],_[h])}return o[r]=[y,p,m]}},{"vectorize-text":311}],127:[function(v,S,M){var e=v("gl-shader"),a=v("glslify"),n=a([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

attribute vec3 position;
attribute vec4 color;
attribute vec2 glyph;
attribute vec4 id;

uniform vec4 highlightId;
uniform float highlightScale;
uniform mat4 model, view, projection;
uniform vec3 clipBounds[2];

varying vec4 interpColor;
varying vec4 pickId;
varying vec3 dataCoordinate;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], position)) {

    gl_Position = vec4(0,0,0,0);
  } else {
    float scale = 1.0;
    if(distance(highlightId, id) < 0.0001) {
      scale = highlightScale;
    }

    vec4 worldPosition = model * vec4(position, 1);
    vec4 viewPosition = view * worldPosition;
    viewPosition = viewPosition / viewPosition.w;
    vec4 clipPosition = projection * (viewPosition + scale * vec4(glyph.x, -glyph.y, 0, 0));

    gl_Position = clipPosition;
    interpColor = color;
    pickId = id;
    dataCoordinate = position;
  }
}`]),r=a([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

attribute vec3 position;
attribute vec4 color;
attribute vec2 glyph;
attribute vec4 id;

uniform mat4 model, view, projection;
uniform vec2 screenSize;
uniform vec3 clipBounds[2];
uniform float highlightScale, pixelRatio;
uniform vec4 highlightId;

varying vec4 interpColor;
varying vec4 pickId;
varying vec3 dataCoordinate;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], position)) {

    gl_Position = vec4(0,0,0,0);
  } else {
    float scale = pixelRatio;
    if(distance(highlightId.bgr, id.bgr) < 0.001) {
      scale *= highlightScale;
    }

    vec4 worldPosition = model * vec4(position, 1.0);
    vec4 viewPosition = view * worldPosition;
    vec4 clipPosition = projection * viewPosition;
    clipPosition /= clipPosition.w;

    gl_Position = clipPosition + vec4(screenSize * scale * vec2(glyph.x, -glyph.y), 0.0, 0.0);
    interpColor = color;
    pickId = id;
    dataCoordinate = position;
  }
}`]),t=a([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

attribute vec3 position;
attribute vec4 color;
attribute vec2 glyph;
attribute vec4 id;

uniform float highlightScale;
uniform vec4 highlightId;
uniform vec3 axes[2];
uniform mat4 model, view, projection;
uniform vec2 screenSize;
uniform vec3 clipBounds[2];
uniform float scale, pixelRatio;

varying vec4 interpColor;
varying vec4 pickId;
varying vec3 dataCoordinate;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], position)) {

    gl_Position = vec4(0,0,0,0);
  } else {
    float lscale = pixelRatio * scale;
    if(distance(highlightId, id) < 0.0001) {
      lscale *= highlightScale;
    }

    vec4 clipCenter   = projection * view * model * vec4(position, 1);
    vec3 dataPosition = position + 0.5*lscale*(axes[0] * glyph.x + axes[1] * glyph.y) * clipCenter.w * screenSize.y;
    vec4 clipPosition = projection * view * model * vec4(dataPosition, 1);

    gl_Position = clipPosition;
    interpColor = color;
    pickId = id;
    dataCoordinate = dataPosition;
  }
}
`]),c=a([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 fragClipBounds[2];
uniform float opacity;

varying vec4 interpColor;
varying vec3 dataCoordinate;

void main() {
  if (
    outOfRange(fragClipBounds[0], fragClipBounds[1], dataCoordinate) ||
    interpColor.a * opacity == 0.
  ) discard;
  gl_FragColor = interpColor * opacity;
}
`]),o=a([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 fragClipBounds[2];
uniform float pickGroup;

varying vec4 pickId;
varying vec3 dataCoordinate;

void main() {
  if (outOfRange(fragClipBounds[0], fragClipBounds[1], dataCoordinate)) discard;

  gl_FragColor = vec4(pickGroup, pickId.bgr);
}`]),i=[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"glyph",type:"vec2"},{name:"id",type:"vec4"}],y={vertex:n,fragment:c,attributes:i},p={vertex:r,fragment:c,attributes:i},g={vertex:t,fragment:c,attributes:i},h={vertex:n,fragment:o,attributes:i},m={vertex:r,fragment:o,attributes:i},u={vertex:t,fragment:o,attributes:i};function _(s,A){var b=e(s,A),f=b.attributes;return f.position.location=0,f.color.location=1,f.glyph.location=2,f.id.location=3,b}M.createPerspective=function(s){return _(s,y)},M.createOrtho=function(s){return _(s,p)},M.createProject=function(s){return _(s,g)},M.createPickPerspective=function(s){return _(s,h)},M.createPickOrtho=function(s){return _(s,m)},M.createPickProject=function(s){return _(s,u)}},{"gl-shader":132,glslify:231}],128:[function(v,S,M){var e=v("is-string-blank"),a=v("gl-buffer"),n=v("gl-vao"),r=v("typedarray-pool"),t=v("gl-mat4/multiply"),c=v("./lib/shaders"),o=v("./lib/glyphs"),i=v("./lib/get-simple-string"),y=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];S.exports=J;function p(X,Y){var Z=X[0],oe=X[1],re=X[2],se=X[3];return X[0]=Y[0]*Z+Y[4]*oe+Y[8]*re+Y[12]*se,X[1]=Y[1]*Z+Y[5]*oe+Y[9]*re+Y[13]*se,X[2]=Y[2]*Z+Y[6]*oe+Y[10]*re+Y[14]*se,X[3]=Y[3]*Z+Y[7]*oe+Y[11]*re+Y[15]*se,X}function g(X,Y,Z,oe){return p(oe,oe),p(oe,oe),p(oe,oe)}function h(X,Y){this.index=X,this.dataCoordinate=this.position=Y}function m(X){return X===!0||X>1?1:X}function u(X,Y,Z,oe,re,se,N,U,q,$,W,K){this.gl=X,this.pixelRatio=1,this.shader=Y,this.orthoShader=Z,this.projectShader=oe,this.pointBuffer=re,this.colorBuffer=se,this.glyphBuffer=N,this.idBuffer=U,this.vao=q,this.vertexCount=0,this.lineVertexCount=0,this.opacity=1,this.hasAlpha=!1,this.lineWidth=0,this.projectScale=[2/3,2/3,2/3],this.projectOpacity=[1,1,1],this.projectHasAlpha=!1,this.pickId=0,this.pickPerspectiveShader=$,this.pickOrthoShader=W,this.pickProjectShader=K,this.points=[],this._selectResult=new h(0,[0,0,0]),this.useOrtho=!0,this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.axesProject=[!0,!0,!0],this.axesBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.highlightId=[1,1,1,1],this.highlightScale=2,this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.dirty=!0}var _=u.prototype;_.pickSlots=1,_.setPickBase=function(X){this.pickId=X},_.isTransparent=function(){if(this.hasAlpha)return!0;for(var X=0;X<3;++X)if(this.axesProject[X]&&this.projectHasAlpha)return!0;return!1},_.isOpaque=function(){if(!this.hasAlpha)return!0;for(var X=0;X<3;++X)if(this.axesProject[X]&&!this.projectHasAlpha)return!0;return!1};var s=[0,0],A=[0,0,0],b=[0,0,0],f=[0,0,0,1],x=[0,0,0,1],l=y.slice(),L=[0,0,0],T=[[0,0,0],[0,0,0]];function k(X){return X[0]=X[1]=X[2]=0,X}function P(X,Y){return X[0]=Y[0],X[1]=Y[1],X[2]=Y[2],X[3]=1,X}function z(X,Y,Z,oe){return X[0]=Y[0],X[1]=Y[1],X[2]=Y[2],X[Z]=oe,X}function I(X){for(var Y=T,Z=0;Z<2;++Z)for(var oe=0;oe<3;++oe)Y[Z][oe]=Math.max(Math.min(X[Z][oe],1e8),-1e8);return Y}function D(X,Y,Z,oe){var re=Y.axesProject,se=Y.gl,N=X.uniforms,U=Z.model||y,q=Z.view||y,$=Z.projection||y,W=Y.axesBounds,K=I(Y.clipBounds),ne;Y.axes&&Y.axes.lastCubeProps?ne=Y.axes.lastCubeProps.axis:ne=[1,1,1],s[0]=2/se.drawingBufferWidth,s[1]=2/se.drawingBufferHeight,X.bind(),N.view=q,N.projection=$,N.screenSize=s,N.highlightId=Y.highlightId,N.highlightScale=Y.highlightScale,N.clipBounds=K,N.pickGroup=Y.pickId/255,N.pixelRatio=oe;for(var ae=0;ae<3;++ae)if(!!re[ae]){N.scale=Y.projectScale[ae],N.opacity=Y.projectOpacity[ae];for(var ie=l,le=0;le<16;++le)ie[le]=0;for(var le=0;le<4;++le)ie[5*le]=1;ie[5*ae]=0,ne[ae]<0?ie[12+ae]=W[0][ae]:ie[12+ae]=W[1][ae],t(ie,U,ie),N.model=ie;var ye=(ae+1)%3,ue=(ae+2)%3,pe=k(A),ge=k(b);pe[ye]=1,ge[ue]=1;var Te=g($,q,U,P(f,pe)),_e=g($,q,U,P(x,ge));if(Math.abs(Te[1])>Math.abs(_e[1])){var ze=Te;Te=_e,_e=ze,ze=pe,pe=ge,ge=ze;var Oe=ye;ye=ue,ue=Oe}Te[0]<0&&(pe[ye]=-1),_e[1]>0&&(ge[ue]=-1);for(var Ye=0,be=0,le=0;le<4;++le)Ye+=Math.pow(U[4*ye+le],2),be+=Math.pow(U[4*ue+le],2);pe[ye]/=Math.sqrt(Ye),ge[ue]/=Math.sqrt(be),N.axes[0]=pe,N.axes[1]=ge,N.fragClipBounds[0]=z(L,K[0],ae,-1e8),N.fragClipBounds[1]=z(L,K[1],ae,1e8),Y.vao.bind(),Y.vao.draw(se.TRIANGLES,Y.vertexCount),Y.lineWidth>0&&(se.lineWidth(Y.lineWidth*oe),Y.vao.draw(se.LINES,Y.lineVertexCount,Y.vertexCount)),Y.vao.unbind()}}var R=[-1e8,-1e8,-1e8],B=[1e8,1e8,1e8],F=[R,B];function H(X,Y,Z,oe,re,se,N){var U=Z.gl;if((se===Z.projectHasAlpha||N)&&D(Y,Z,oe,re),se===Z.hasAlpha||N){X.bind();var q=X.uniforms;q.model=oe.model||y,q.view=oe.view||y,q.projection=oe.projection||y,s[0]=2/U.drawingBufferWidth,s[1]=2/U.drawingBufferHeight,q.screenSize=s,q.highlightId=Z.highlightId,q.highlightScale=Z.highlightScale,q.fragClipBounds=F,q.clipBounds=Z.axes.bounds,q.opacity=Z.opacity,q.pickGroup=Z.pickId/255,q.pixelRatio=re,Z.vao.bind(),Z.vao.draw(U.TRIANGLES,Z.vertexCount),Z.lineWidth>0&&(U.lineWidth(Z.lineWidth*re),Z.vao.draw(U.LINES,Z.lineVertexCount,Z.vertexCount)),Z.vao.unbind()}}_.draw=function(X){var Y=this.useOrtho?this.orthoShader:this.shader;H(Y,this.projectShader,this,X,this.pixelRatio,!1,!1)},_.drawTransparent=function(X){var Y=this.useOrtho?this.orthoShader:this.shader;H(Y,this.projectShader,this,X,this.pixelRatio,!0,!1)},_.drawPick=function(X){var Y=this.useOrtho?this.pickOrthoShader:this.pickPerspectiveShader;H(Y,this.pickProjectShader,this,X,1,!0,!0)},_.pick=function(X){if(!X||X.id!==this.pickId)return null;var Y=X.value[2]+(X.value[1]<<8)+(X.value[0]<<16);if(Y>=this.pointCount||Y<0)return null;var Z=this.points[Y],oe=this._selectResult;oe.index=Y;for(var re=0;re<3;++re)oe.position[re]=oe.dataCoordinate[re]=Z[re];return oe},_.highlight=function(X){if(!X)this.highlightId=[1,1,1,1];else{var Y=X.index,Z=Y&255,oe=Y>>8&255,re=Y>>16&255;this.highlightId=[Z/255,oe/255,re/255,0]}};function G(X,Y,Z,oe){var re;Array.isArray(X)?Y<X.length?re=X[Y]:re=void 0:re=X,re=i(re);var se=!0;e(re)&&(re="\u25BC",se=!1);var N=o(re,Z,oe);return{mesh:N[0],lines:N[1],bounds:N[2],visible:se}}_.update=function(X){if(X=X||{},"perspective"in X&&(this.useOrtho=!X.perspective),"orthographic"in X&&(this.useOrtho=!!X.orthographic),"lineWidth"in X&&(this.lineWidth=X.lineWidth),"project"in X)if(Array.isArray(X.project))this.axesProject=X.project;else{var Y=!!X.project;this.axesProject=[Y,Y,Y]}if("projectScale"in X)if(Array.isArray(X.projectScale))this.projectScale=X.projectScale.slice();else{var Z=+X.projectScale;this.projectScale=[Z,Z,Z]}if(this.projectHasAlpha=!1,"projectOpacity"in X){if(Array.isArray(X.projectOpacity))this.projectOpacity=X.projectOpacity.slice();else{var Z=+X.projectOpacity;this.projectOpacity=[Z,Z,Z]}for(var oe=0;oe<3;++oe)this.projectOpacity[oe]=m(this.projectOpacity[oe]),this.projectOpacity[oe]<1&&(this.projectHasAlpha=!0)}this.hasAlpha=!1,"opacity"in X&&(this.opacity=m(X.opacity),this.opacity<1&&(this.hasAlpha=!0)),this.dirty=!0;var re=X.position,se=X.font||"normal",N=X.alignment||[0,0],U,q;if(N.length===2)U=N[0],q=N[1];else{U=[],q=[];for(var oe=0;oe<N.length;++oe)U[oe]=N[oe][0],q[oe]=N[oe][1]}var $=[1/0,1/0,1/0],W=[-1/0,-1/0,-1/0],K=X.glyph,ne=X.color,ae=X.size,ie=X.angle,le=X.lineColor,ye=-1,ue=0,pe=0,ge=0;if(re.length){ge=re.length;e:for(var oe=0;oe<ge;++oe){for(var Te=re[oe],_e=0;_e<3;++_e)if(isNaN(Te[_e])||!isFinite(Te[_e]))continue e;var ze=G(K,oe,se,this.pixelRatio),Oe=ze.mesh,Ye=ze.lines,be=ze.bounds;ue+=Oe.cells.length*3,pe+=Ye.edges.length*2}}var Pe=ue+pe,Ge=r.mallocFloat(3*Pe),Qe=r.mallocFloat(4*Pe),Be=r.mallocFloat(2*Pe),Le=r.mallocUint32(Pe);if(Pe>0){var He=0,vt=ue,Rt=[0,0,0,1],rr=[0,0,0,1],Lt=Array.isArray(ne)&&Array.isArray(ne[0]),Ft=Array.isArray(le)&&Array.isArray(le[0]);e:for(var oe=0;oe<ge;++oe){ye+=1;for(var Te=re[oe],_e=0;_e<3;++_e){if(isNaN(Te[_e])||!isFinite(Te[_e]))continue e;W[_e]=Math.max(W[_e],Te[_e]),$[_e]=Math.min($[_e],Te[_e])}var ze=G(K,oe,se,this.pixelRatio),Oe=ze.mesh,Ye=ze.lines,be=ze.bounds,Gt=ze.visible;if(!Gt)Rt=[1,1,1,0];else if(Array.isArray(ne)){var Dt;if(Lt?oe<ne.length?Dt=ne[oe]:Dt=[0,0,0,0]:Dt=ne,Dt.length===3){for(var _e=0;_e<3;++_e)Rt[_e]=Dt[_e];Rt[3]=1}else if(Dt.length===4){for(var _e=0;_e<4;++_e)Rt[_e]=Dt[_e];!this.hasAlpha&&Dt[3]<1&&(this.hasAlpha=!0)}}else Rt[0]=Rt[1]=Rt[2]=0,Rt[3]=1;if(!Gt)rr=[1,1,1,0];else if(Array.isArray(le)){var Dt;if(Ft?oe<le.length?Dt=le[oe]:Dt=[0,0,0,0]:Dt=le,Dt.length===3){for(var _e=0;_e<3;++_e)rr[_e]=Dt[_e];rr[_e]=1}else if(Dt.length===4){for(var _e=0;_e<4;++_e)rr[_e]=Dt[_e];!this.hasAlpha&&Dt[3]<1&&(this.hasAlpha=!0)}}else rr[0]=rr[1]=rr[2]=0,rr[3]=1;var kt=.5;Gt?Array.isArray(ae)?oe<ae.length?kt=+ae[oe]:kt=12:ae?kt=+ae:this.useOrtho&&(kt=12):kt=0;var Ue=0;Array.isArray(ie)?oe<ie.length?Ue=+ie[oe]:Ue=0:ie&&(Ue=+ie);for(var qe=Math.cos(Ue),Ve=Math.sin(Ue),Te=re[oe],_e=0;_e<3;++_e)W[_e]=Math.max(W[_e],Te[_e]),$[_e]=Math.min($[_e],Te[_e]);var Ae=U,Ne=q,Ae=0;Array.isArray(U)?oe<U.length?Ae=U[oe]:Ae=0:U&&(Ae=U);var Ne=0;Array.isArray(q)?oe<q.length?Ne=q[oe]:Ne=0:q&&(Ne=q),Ae*=Ae>0?1-be[0][0]:Ae<0?1+be[1][0]:1,Ne*=Ne>0?1-be[0][1]:Ne<0?1+be[1][1]:1;for(var Xe=[Ae,Ne],Kt=Oe.cells||[],Nt=Oe.positions||[],_e=0;_e<Kt.length;++_e)for(var Je=Kt[_e],_t=0;_t<3;++_t){for(var mt=0;mt<3;++mt)Ge[3*He+mt]=Te[mt];for(var mt=0;mt<4;++mt)Qe[4*He+mt]=Rt[mt];Le[He]=ye;var Ot=Nt[Je[_t]];Be[2*He]=kt*(qe*Ot[0]-Ve*Ot[1]+Xe[0]),Be[2*He+1]=kt*(Ve*Ot[0]+qe*Ot[1]+Xe[1]),He+=1}for(var Kt=Ye.edges,Nt=Ye.positions,_e=0;_e<Kt.length;++_e)for(var Je=Kt[_e],_t=0;_t<2;++_t){for(var mt=0;mt<3;++mt)Ge[3*vt+mt]=Te[mt];for(var mt=0;mt<4;++mt)Qe[4*vt+mt]=rr[mt];Le[vt]=ye;var Ot=Nt[Je[_t]];Be[2*vt]=kt*(qe*Ot[0]-Ve*Ot[1]+Xe[0]),Be[2*vt+1]=kt*(Ve*Ot[0]+qe*Ot[1]+Xe[1]),vt+=1}}}this.bounds=[$,W],this.points=re,this.pointCount=re.length,this.vertexCount=ue,this.lineVertexCount=pe,this.pointBuffer.update(Ge),this.colorBuffer.update(Qe),this.glyphBuffer.update(Be),this.idBuffer.update(Le),r.free(Ge),r.free(Qe),r.free(Be),r.free(Le)},_.dispose=function(){this.shader.dispose(),this.orthoShader.dispose(),this.pickPerspectiveShader.dispose(),this.pickOrthoShader.dispose(),this.vao.dispose(),this.pointBuffer.dispose(),this.colorBuffer.dispose(),this.glyphBuffer.dispose(),this.idBuffer.dispose()};function J(X){var Y=X.gl,Z=c.createPerspective(Y),oe=c.createOrtho(Y),re=c.createProject(Y),se=c.createPickPerspective(Y),N=c.createPickOrtho(Y),U=c.createPickProject(Y),q=a(Y),$=a(Y),W=a(Y),K=a(Y),ne=n(Y,[{buffer:q,size:3,type:Y.FLOAT},{buffer:$,size:4,type:Y.FLOAT},{buffer:W,size:2,type:Y.FLOAT},{buffer:K,size:4,type:Y.UNSIGNED_BYTE,normalized:!0}]),ae=new u(Y,Z,oe,re,q,$,W,K,ne,se,N,U);return ae.update(X),ae}},{"./lib/get-simple-string":125,"./lib/glyphs":126,"./lib/shaders":127,"gl-buffer":78,"gl-mat4/multiply":100,"gl-vao":150,"is-string-blank":239,"typedarray-pool":308}],129:[function(v,S,M){var e=v("glslify");M.boxVertex=e([`precision mediump float;
#define GLSLIFY 1

attribute vec2 vertex;

uniform vec2 cornerA, cornerB;

void main() {
  gl_Position = vec4(mix(cornerA, cornerB, vertex), 0, 1);
}
`]),M.boxFragment=e([`precision mediump float;
#define GLSLIFY 1

uniform vec4 color;

void main() {
  gl_FragColor = color;
}
`])},{glslify:231}],130:[function(v,S,M){var e=v("gl-shader"),a=v("gl-buffer"),n=v("./lib/shaders");S.exports=c;function r(o,i,y){this.plot=o,this.boxBuffer=i,this.boxShader=y,this.enabled=!0,this.selectBox=[1/0,1/0,-1/0,-1/0],this.borderColor=[0,0,0,1],this.innerFill=!1,this.innerColor=[0,0,0,.25],this.outerFill=!0,this.outerColor=[0,0,0,.5],this.borderWidth=10}var t=r.prototype;t.draw=function(){if(!!this.enabled){var o=this.plot,i=this.selectBox,y=this.borderWidth;this.innerFill;var p=this.innerColor;this.outerFill;var g=this.outerColor,h=this.borderColor,m=o.box,u=o.screenBox,_=o.dataBox,s=o.viewBox,A=o.pixelRatio,b=(i[0]-_[0])*(s[2]-s[0])/(_[2]-_[0])+s[0],f=(i[1]-_[1])*(s[3]-s[1])/(_[3]-_[1])+s[1],x=(i[2]-_[0])*(s[2]-s[0])/(_[2]-_[0])+s[0],l=(i[3]-_[1])*(s[3]-s[1])/(_[3]-_[1])+s[1];if(b=Math.max(b,s[0]),f=Math.max(f,s[1]),x=Math.min(x,s[2]),l=Math.min(l,s[3]),!(x<b||l<f)){m.bind();var L=u[2]-u[0],T=u[3]-u[1];if(this.outerFill&&(m.drawBox(0,0,L,f,g),m.drawBox(0,f,b,l,g),m.drawBox(0,l,L,T,g),m.drawBox(x,f,L,l,g)),this.innerFill&&m.drawBox(b,f,x,l,p),y>0){var k=y*A;m.drawBox(b-k,f-k,x+k,f+k,h),m.drawBox(b-k,l-k,x+k,l+k,h),m.drawBox(b-k,f-k,b+k,l+k,h),m.drawBox(x-k,f-k,x+k,l+k,h)}}}},t.update=function(o){o=o||{},this.innerFill=!!o.innerFill,this.outerFill=!!o.outerFill,this.innerColor=(o.innerColor||[0,0,0,.5]).slice(),this.outerColor=(o.outerColor||[0,0,0,.5]).slice(),this.borderColor=(o.borderColor||[0,0,0,1]).slice(),this.borderWidth=o.borderWidth||0,this.selectBox=(o.selectBox||this.selectBox).slice()},t.dispose=function(){this.boxBuffer.dispose(),this.boxShader.dispose(),this.plot.removeOverlay(this)};function c(o,i){var y=o.gl,p=a(y,[0,0,0,1,1,0,1,1]),g=e(y,n.boxVertex,n.boxFragment),h=new r(o,p,g);return h.update(i),o.addOverlay(h),h}},{"./lib/shaders":129,"gl-buffer":78,"gl-shader":132}],131:[function(v,S,M){S.exports=y;var e=v("gl-fbo"),a=v("typedarray-pool"),n=v("ndarray"),r=v("bit-twiddle").nextPow2,t=function(p,g,h){for(var m=1e8,u=-1,_=-1,s=p.shape[0],A=p.shape[1],b=0;b<s;b++)for(var f=0;f<A;f++){var x=p.get(b,f,0),l=p.get(b,f,1),L=p.get(b,f,2),T=p.get(b,f,3);if(x<255||l<255||L<255||T<255){var k=g-b,P=h-f,z=k*k+P*P;z<m&&(m=z,u=b,_=f)}}return[u,_,m]};function c(p,g,h,m,u){this.coord=[p,g],this.id=h,this.value=m,this.distance=u}function o(p,g,h){this.gl=p,this.fbo=g,this.buffer=h,this._readTimeout=null;var m=this;this._readCallback=function(){!m.gl||(g.bind(),p.readPixels(0,0,g.shape[0],g.shape[1],p.RGBA,p.UNSIGNED_BYTE,m.buffer),m._readTimeout=null)}}var i=o.prototype;Object.defineProperty(i,"shape",{get:function(){return this.gl?this.fbo.shape.slice():[0,0]},set:function(p){if(!!this.gl){this.fbo.shape=p;var g=this.fbo.shape[0],h=this.fbo.shape[1];if(h*g*4>this.buffer.length){a.free(this.buffer);for(var m=this.buffer=a.mallocUint8(r(h*g*4)),u=0;u<h*g*4;++u)m[u]=255}return p}}}),i.begin=function(){var p=this.gl;this.shape,p&&(this.fbo.bind(),p.clearColor(1,1,1,1),p.clear(p.COLOR_BUFFER_BIT|p.DEPTH_BUFFER_BIT))},i.end=function(){var p=this.gl;!p||(p.bindFramebuffer(p.FRAMEBUFFER,null),this._readTimeout||clearTimeout(this._readTimeout),this._readTimeout=setTimeout(this._readCallback,1))},i.query=function(p,g,h){if(!this.gl)return null;var m=this.fbo.shape.slice();p=p|0,g=g|0,typeof h!="number"&&(h=1);var u=Math.min(Math.max(p-h,0),m[0])|0,_=Math.min(Math.max(p+h,0),m[0])|0,s=Math.min(Math.max(g-h,0),m[1])|0,A=Math.min(Math.max(g+h,0),m[1])|0;if(_<=u||A<=s)return null;var b=[_-u,A-s],f=n(this.buffer,[b[0],b[1],4],[4,m[0]*4,1],4*(u+m[0]*s)),x=t(f.hi(b[0],b[1],1),h,h),l=x[0],L=x[1];if(l<0||Math.pow(this.radius,2)<x[2])return null;var T=f.get(l,L,0),k=f.get(l,L,1),P=f.get(l,L,2),z=f.get(l,L,3);return new c(l+u|0,L+s|0,T,[k,P,z],Math.sqrt(x[2]))},i.dispose=function(){!this.gl||(this.fbo.dispose(),a.free(this.buffer),this.gl=null,this._readTimeout&&clearTimeout(this._readTimeout))};function y(p,g){var h=g[0],m=g[1],u={},_=e(p,h,m,u),s=a.mallocUint8(h*m*4);return new o(p,_,s)}},{"bit-twiddle":32,"gl-fbo":86,ndarray:259,"typedarray-pool":308}],132:[function(v,S,M){var e=v("./lib/create-uniforms"),a=v("./lib/create-attributes"),n=v("./lib/reflect"),r=v("./lib/shader-cache"),t=v("./lib/runtime-reflect"),c=v("./lib/GLError");function o(g){this.gl=g,this.gl.lastAttribCount=0,this._vref=this._fref=this._relink=this.vertShader=this.fragShader=this.program=this.attributes=this.uniforms=this.types=null}var i=o.prototype;i.bind=function(){this.program||this._relink();var g,h=this.gl.getProgramParameter(this.program,this.gl.ACTIVE_ATTRIBUTES),m=this.gl.lastAttribCount;if(h>m)for(g=m;g<h;g++)this.gl.enableVertexAttribArray(g);else if(m>h)for(g=h;g<m;g++)this.gl.disableVertexAttribArray(g);this.gl.lastAttribCount=h,this.gl.useProgram(this.program)},i.dispose=function(){for(var g=this.gl.lastAttribCount,h=0;h<g;h++)this.gl.disableVertexAttribArray(h);this.gl.lastAttribCount=0,this._fref&&this._fref.dispose(),this._vref&&this._vref.dispose(),this.attributes=this.types=this.vertShader=this.fragShader=this.program=this._relink=this._fref=this._vref=null};function y(g,h){return g.name<h.name?-1:1}i.update=function(g,h,m,u){if(!h||arguments.length===1){var _=g;g=_.vertex,h=_.fragment,m=_.uniforms,u=_.attributes}var s=this,A=s.gl,b=s._vref;s._vref=r.shader(A,A.VERTEX_SHADER,g),b&&b.dispose(),s.vertShader=s._vref.shader;var f=this._fref;if(s._fref=r.shader(A,A.FRAGMENT_SHADER,h),f&&f.dispose(),s.fragShader=s._fref.shader,!m||!u){var x=A.createProgram();if(A.attachShader(x,s.fragShader),A.attachShader(x,s.vertShader),A.linkProgram(x),!A.getProgramParameter(x,A.LINK_STATUS)){var l=A.getProgramInfoLog(x);throw new c(l,"Error linking program:"+l)}m=m||t.uniforms(A,x),u=u||t.attributes(A,x),A.deleteProgram(x)}u=u.slice(),u.sort(y);var L=[],T=[],k=[],P;for(P=0;P<u.length;++P){var z=u[P];if(z.type.indexOf("mat")>=0){for(var I=z.type.charAt(z.type.length-1)|0,D=new Array(I),R=0;R<I;++R)D[R]=k.length,T.push(z.name+"["+R+"]"),typeof z.location=="number"?k.push(z.location+R):Array.isArray(z.location)&&z.location.length===I&&typeof z.location[R]=="number"?k.push(z.location[R]|0):k.push(-1);L.push({name:z.name,type:z.type,locations:D})}else L.push({name:z.name,type:z.type,locations:[k.length]}),T.push(z.name),typeof z.location=="number"?k.push(z.location|0):k.push(-1)}var B=0;for(P=0;P<k.length;++P)if(k[P]<0){for(;k.indexOf(B)>=0;)B+=1;k[P]=B}var F=new Array(m.length);function H(){s.program=r.program(A,s._vref,s._fref,T,k);for(var G=0;G<m.length;++G)F[G]=A.getUniformLocation(s.program,m[G].name)}H(),s._relink=H,s.types={uniforms:n(m),attributes:n(u)},s.attributes=a(A,s,L,k),Object.defineProperty(s,"uniforms",e(A,s,m,F))};function p(g,h,m,u,_){var s=new o(g);return s.update(h,m,u,_),s}S.exports=p},{"./lib/GLError":133,"./lib/create-attributes":134,"./lib/create-uniforms":135,"./lib/reflect":136,"./lib/runtime-reflect":137,"./lib/shader-cache":138}],133:[function(v,S,M){function e(a,n,r){this.shortMessage=n||"",this.longMessage=r||"",this.rawError=a||"",this.message="gl-shader: "+(n||a||"")+(r?`
`+r:""),this.stack=new Error().stack}e.prototype=new Error,e.prototype.name="GLError",e.prototype.constructor=e,S.exports=e},{}],134:[function(v,S,M){S.exports=o;var e=v("./GLError");function a(i,y,p,g,h,m){this._gl=i,this._wrapper=y,this._index=p,this._locations=g,this._dimension=h,this._constFunc=m}var n=a.prototype;n.pointer=function(y,p,g,h){var m=this,u=m._gl,_=m._locations[m._index];u.vertexAttribPointer(_,m._dimension,y||u.FLOAT,!!p,g||0,h||0),u.enableVertexAttribArray(_)},n.set=function(i,y,p,g){return this._constFunc(this._locations[this._index],i,y,p,g)},Object.defineProperty(n,"location",{get:function(){return this._locations[this._index]},set:function(i){return i!==this._locations[this._index]&&(this._locations[this._index]=i|0,this._wrapper.program=null),i|0}});var r=[function(i,y,p){return p.length===void 0?i.vertexAttrib1f(y,p):i.vertexAttrib1fv(y,p)},function(i,y,p,g){return p.length===void 0?i.vertexAttrib2f(y,p,g):i.vertexAttrib2fv(y,p)},function(i,y,p,g,h){return p.length===void 0?i.vertexAttrib3f(y,p,g,h):i.vertexAttrib3fv(y,p)},function(i,y,p,g,h,m){return p.length===void 0?i.vertexAttrib4f(y,p,g,h,m):i.vertexAttrib4fv(y,p)}];function t(i,y,p,g,h,m,u){var _=r[h],s=new a(i,y,p,g,h,_);Object.defineProperty(m,u,{set:function(A){return i.disableVertexAttribArray(g[p]),_(i,g[p],A),A},get:function(){return s},enumerable:!0})}function c(i,y,p,g,h,m,u){for(var _=new Array(h),s=new Array(h),A=0;A<h;++A)t(i,y,p[A],g,h,_,A),s[A]=_[A];Object.defineProperty(_,"location",{set:function(x){if(Array.isArray(x))for(var l=0;l<h;++l)s[l].location=x[l];else for(var l=0;l<h;++l)s[l].location=x+l;return x},get:function(){for(var x=new Array(h),l=0;l<h;++l)x[l]=g[p[l]];return x},enumerable:!0}),_.pointer=function(x,l,L,T){x=x||i.FLOAT,l=!!l,L=L||h*h,T=T||0;for(var k=0;k<h;++k){var P=g[p[k]];i.vertexAttribPointer(P,h,x,l,L,T+k*h),i.enableVertexAttribArray(P)}};var b=new Array(h),f=i["vertexAttrib"+h+"fv"];Object.defineProperty(m,u,{set:function(x){for(var l=0;l<h;++l){var L=g[p[l]];if(i.disableVertexAttribArray(L),Array.isArray(x[0]))f.call(i,L,x[l]);else{for(var T=0;T<h;++T)b[T]=x[h*l+T];f.call(i,L,b)}}return x},get:function(){return _},enumerable:!0})}function o(i,y,p,g){for(var h={},m=0,u=p.length;m<u;++m){var _=p[m],s=_.name,A=_.type,b=_.locations;switch(A){case"bool":case"int":case"float":t(i,y,b[0],g,1,h,s);break;default:if(A.indexOf("vec")>=0){var f=A.charCodeAt(A.length-1)-48;if(f<2||f>4)throw new e("","Invalid data type for attribute "+s+": "+A);t(i,y,b[0],g,f,h,s)}else if(A.indexOf("mat")>=0){var f=A.charCodeAt(A.length-1)-48;if(f<2||f>4)throw new e("","Invalid data type for attribute "+s+": "+A);c(i,y,b,g,f,h,s)}else throw new e("","Unknown data type for attribute "+s+": "+A);break}}return h}},{"./GLError":133}],135:[function(v,S,M){var e=v("./reflect"),a=v("./GLError");S.exports=t;function n(c){return function(){return c}}function r(c,o){for(var i=new Array(c),y=0;y<c;++y)i[y]=o;return i}function t(c,o,i,y){function p(A){return function(b,f,x){return b.getUniform(f.program,x[A])}}function g(A){return function(f){for(var x=h("",A),l=0;l<x.length;++l){var L=x[l],T=L[0],k=L[1];if(y[k]){var P=f;if(typeof T=="string"&&(T.indexOf(".")===0||T.indexOf("[")===0)){var z=T;if(T.indexOf(".")===0&&(z=T.slice(1)),z.indexOf("]")===z.length-1){var I=z.indexOf("["),D=z.slice(0,I),R=z.slice(I+1,z.length-1);P=D?f[D][R]:f[R]}else P=f[z]}var B=i[k].type,F;switch(B){case"bool":case"int":case"sampler2D":case"samplerCube":c.uniform1i(y[k],P);break;case"float":c.uniform1f(y[k],P);break;default:var H=B.indexOf("vec");if(0<=H&&H<=1&&B.length===4+H){if(F=B.charCodeAt(B.length-1)-48,F<2||F>4)throw new a("","Invalid data type");switch(B.charAt(0)){case"b":case"i":c["uniform"+F+"iv"](y[k],P);break;case"v":c["uniform"+F+"fv"](y[k],P);break;default:throw new a("","Unrecognized data type for vector "+name+": "+B)}}else if(B.indexOf("mat")===0&&B.length===4){if(F=B.charCodeAt(B.length-1)-48,F<2||F>4)throw new a("","Invalid uniform dimension type for matrix "+name+": "+B);c["uniformMatrix"+F+"fv"](y[k],!1,P);break}else throw new a("","Unknown uniform data type for "+name+": "+B)}}}}}function h(A,b){if(typeof b!="object")return[[A,b]];var f=[];for(var x in b){var l=b[x],L=A;parseInt(x)+""===x?L+="["+x+"]":L+="."+x,typeof l=="object"?f.push.apply(f,h(L,l)):f.push([L,l])}return f}function m(A){switch(A){case"bool":return!1;case"int":case"sampler2D":case"samplerCube":return 0;case"float":return 0;default:var b=A.indexOf("vec");if(0<=b&&b<=1&&A.length===4+b){var f=A.charCodeAt(A.length-1)-48;if(f<2||f>4)throw new a("","Invalid data type");return A.charAt(0)==="b"?r(f,!1):r(f,0)}else if(A.indexOf("mat")===0&&A.length===4){var f=A.charCodeAt(A.length-1)-48;if(f<2||f>4)throw new a("","Invalid uniform dimension type for matrix "+name+": "+A);return r(f*f,0)}else throw new a("","Unknown uniform data type for "+name+": "+A)}}function u(A,b,f){if(typeof f=="object"){var x=_(f);Object.defineProperty(A,b,{get:n(x),set:g(f),enumerable:!0,configurable:!1})}else y[f]?Object.defineProperty(A,b,{get:p(f),set:g(f),enumerable:!0,configurable:!1}):A[b]=m(i[f].type)}function _(A){var b;if(Array.isArray(A)){b=new Array(A.length);for(var f=0;f<A.length;++f)u(b,f,A[f])}else{b={};for(var x in A)u(b,x,A[x])}return b}var s=e(i,!0);return{get:n(_(s)),set:g(s),enumerable:!0,configurable:!0}}},{"./GLError":133,"./reflect":136}],136:[function(v,S,M){S.exports=e;function e(a,n){for(var r={},t=0;t<a.length;++t)for(var c=a[t].name,o=c.split("."),i=r,y=0;y<o.length;++y){var p=o[y].split("[");if(p.length>1){p[0]in i||(i[p[0]]=[]),i=i[p[0]];for(var g=1;g<p.length;++g){var h=parseInt(p[g]);g<p.length-1||y<o.length-1?(h in i||(g<p.length-1?i[h]=[]:i[h]={}),i=i[h]):n?i[h]=t:i[h]=a[t].type}}else y<o.length-1?(p[0]in i||(i[p[0]]={}),i=i[p[0]]):n?i[p[0]]=t:i[p[0]]=a[t].type}return r}},{}],137:[function(v,S,M){M.uniforms=r,M.attributes=t;var e={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube"},a=null;function n(c,o){if(!a){var i=Object.keys(e);a={};for(var y=0;y<i.length;++y){var p=i[y];a[c[p]]=e[p]}}return a[o]}function r(c,o){for(var i=c.getProgramParameter(o,c.ACTIVE_UNIFORMS),y=[],p=0;p<i;++p){var g=c.getActiveUniform(o,p);if(g){var h=n(c,g.type);if(g.size>1)for(var m=0;m<g.size;++m)y.push({name:g.name.replace("[0]","["+m+"]"),type:h});else y.push({name:g.name,type:h})}}return y}function t(c,o){for(var i=c.getProgramParameter(o,c.ACTIVE_ATTRIBUTES),y=[],p=0;p<i;++p){var g=c.getActiveAttrib(o,p);g&&y.push({name:g.name,type:n(c,g.type)})}return y}},{}],138:[function(v,S,M){M.shader=h,M.program=m;var e=v("./GLError"),a=v("gl-format-compiler-error"),n=typeof WeakMap>"u"?v("weakmap-shim"):WeakMap,r=new n,t=0;function c(u,_,s,A,b,f,x){this.id=u,this.src=_,this.type=s,this.shader=A,this.count=f,this.programs=[],this.cache=x}c.prototype.dispose=function(){if(--this.count===0){for(var u=this.cache,_=u.gl,s=this.programs,A=0,b=s.length;A<b;++A){var f=u.programs[s[A]];f&&(delete u.programs[A],_.deleteProgram(f))}_.deleteShader(this.shader),delete u.shaders[this.type===_.FRAGMENT_SHADER|0][this.src]}};function o(u){this.gl=u,this.shaders=[{},{}],this.programs={}}var i=o.prototype;function y(u,_,s){var A=u.createShader(_);if(u.shaderSource(A,s),u.compileShader(A),!u.getShaderParameter(A,u.COMPILE_STATUS)){var b=u.getShaderInfoLog(A);try{var f=a(b,s,_)}catch(x){throw console.warn("Failed to format compiler error: "+x),new e(b,`Error compiling shader:
`+b)}throw new e(b,f.short,f.long)}return A}i.getShaderReference=function(u,_){var s=this.gl,A=this.shaders[u===s.FRAGMENT_SHADER|0],b=A[_];if(!b||!s.isShader(b.shader)){var f=y(s,u,_);b=A[_]=new c(t++,_,u,f,[],1,this)}else b.count+=1;return b};function p(u,_,s,A,b){var f=u.createProgram();u.attachShader(f,_),u.attachShader(f,s);for(var x=0;x<A.length;++x)u.bindAttribLocation(f,b[x],A[x]);if(u.linkProgram(f),!u.getProgramParameter(f,u.LINK_STATUS)){var l=u.getProgramInfoLog(f);throw new e(l,"Error linking program: "+l)}return f}i.getProgram=function(u,_,s,A){var b=[u.id,_.id,s.join(":"),A.join(":")].join("@"),f=this.programs[b];return(!f||!this.gl.isProgram(f))&&(this.programs[b]=f=p(this.gl,u.shader,_.shader,s,A),u.programs.push(b),_.programs.push(b)),f};function g(u){var _=r.get(u);return _||(_=new o(u),r.set(u,_)),_}function h(u,_,s){return g(u).getShaderReference(_,s)}function m(u,_,s,A,b){return g(u).getProgram(_,s,A,b)}},{"./GLError":133,"gl-format-compiler-error":87,"weakmap-shim":316}],139:[function(v,S,M){S.exports=n;function e(r){this.plot=r,this.enable=[!0,!0,!1,!1],this.width=[1,1,1,1],this.color=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.center=[1/0,1/0]}var a=e.prototype;a.update=function(r){r=r||{},this.enable=(r.enable||[!0,!0,!1,!1]).slice(),this.width=(r.width||[1,1,1,1]).slice(),this.color=(r.color||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]).map(function(t){return t.slice()}),this.center=(r.center||[1/0,1/0]).slice(),this.plot.setOverlayDirty()},a.draw=function(){var r=this.enable,t=this.width,c=this.color,o=this.center,i=this.plot,y=i.line,p=i.dataBox,g=i.viewBox;if(y.bind(),p[0]<=o[0]&&o[0]<=p[2]&&p[1]<=o[1]&&o[1]<=p[3]){var h=g[0]+(o[0]-p[0])/(p[2]-p[0])*(g[2]-g[0]),m=g[1]+(o[1]-p[1])/(p[3]-p[1])*(g[3]-g[1]);r[0]&&y.drawLine(h,m,g[0],m,t[0],c[0]),r[1]&&y.drawLine(h,m,h,g[1],t[1],c[1]),r[2]&&y.drawLine(h,m,g[2],m,t[2],c[2]),r[3]&&y.drawLine(h,m,h,g[3],t[3],c[3])}},a.dispose=function(){this.plot.removeOverlay(this)};function n(r,t){var c=new e(r);return c.update(t),r.addOverlay(c),c}},{}],140:[function(v,S,M){var e=v("glslify"),a=v("gl-shader"),n=e([`precision mediump float;
#define GLSLIFY 1

attribute vec3 position, color;
attribute float weight;

uniform mat4 model, view, projection;
uniform vec3 coordinates[3];
uniform vec4 colors[3];
uniform vec2 screenShape;
uniform float lineWidth;

varying vec4 fragColor;

void main() {
  vec3 vertexPosition = mix(coordinates[0],
    mix(coordinates[2], coordinates[1], 0.5 * (position + 1.0)), abs(position));

  vec4 clipPos = projection * view * model * vec4(vertexPosition, 1.0);
  vec2 clipOffset = (projection * view * model * vec4(color, 0.0)).xy;
  vec2 delta = weight * clipOffset * screenShape;
  vec2 lineOffset = normalize(vec2(delta.y, -delta.x)) / screenShape;

  gl_Position   = vec4(clipPos.xy + clipPos.w * 0.5 * lineWidth * lineOffset, clipPos.z, clipPos.w);
  fragColor     = color.x * colors[0] + color.y * colors[1] + color.z * colors[2];
}
`]),r=e([`precision mediump float;
#define GLSLIFY 1

varying vec4 fragColor;

void main() {
  gl_FragColor = fragColor;
}`]);S.exports=function(t){return a(t,n,r,null,[{name:"position",type:"vec3"},{name:"color",type:"vec3"},{name:"weight",type:"float"}])}},{"gl-shader":132,glslify:231}],141:[function(v,S,M){var e=v("gl-buffer"),a=v("gl-vao"),n=v("./shaders/index");S.exports=p;var r=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function t(g,h,m,u){this.gl=g,this.buffer=h,this.vao=m,this.shader=u,this.pixelRatio=1,this.bounds=[[-1e3,-1e3,-1e3],[1e3,1e3,1e3]],this.position=[0,0,0],this.lineWidth=[2,2,2],this.colors=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.enabled=[!0,!0,!0],this.drawSides=[!0,!0,!0],this.axes=null}var c=t.prototype,o=[0,0,0],i=[0,0,0],y=[0,0];c.isTransparent=function(){return!1},c.drawTransparent=function(g){},c.draw=function(g){var h=this.gl,m=this.vao,u=this.shader;m.bind(),u.bind();var _=g.model||r,s=g.view||r,A=g.projection||r,b;this.axes&&(b=this.axes.lastCubeProps.axis);for(var f=o,x=i,l=0;l<3;++l)b&&b[l]<0?(f[l]=this.bounds[0][l],x[l]=this.bounds[1][l]):(f[l]=this.bounds[1][l],x[l]=this.bounds[0][l]);y[0]=h.drawingBufferWidth,y[1]=h.drawingBufferHeight,u.uniforms.model=_,u.uniforms.view=s,u.uniforms.projection=A,u.uniforms.coordinates=[this.position,f,x],u.uniforms.colors=this.colors,u.uniforms.screenShape=y;for(var l=0;l<3;++l)u.uniforms.lineWidth=this.lineWidth[l]*this.pixelRatio,this.enabled[l]&&(m.draw(h.TRIANGLES,6,6*l),this.drawSides[l]&&m.draw(h.TRIANGLES,12,18+12*l));m.unbind()},c.update=function(g){!g||("bounds"in g&&(this.bounds=g.bounds),"position"in g&&(this.position=g.position),"lineWidth"in g&&(this.lineWidth=g.lineWidth),"colors"in g&&(this.colors=g.colors),"enabled"in g&&(this.enabled=g.enabled),"drawSides"in g&&(this.drawSides=g.drawSides))},c.dispose=function(){this.vao.dispose(),this.buffer.dispose(),this.shader.dispose()};function p(g,h){var m=[];function u(f,x,l,L,T,k){var P=[f,x,l,0,0,0,1];P[L+3]=1,P[L]=T,m.push.apply(m,P),P[6]=-1,m.push.apply(m,P),P[L]=k,m.push.apply(m,P),m.push.apply(m,P),P[6]=1,m.push.apply(m,P),P[L]=T,m.push.apply(m,P)}u(0,0,0,0,0,1),u(0,0,0,1,0,1),u(0,0,0,2,0,1),u(1,0,0,1,-1,1),u(1,0,0,2,-1,1),u(0,1,0,0,-1,1),u(0,1,0,2,-1,1),u(0,0,1,0,-1,1),u(0,0,1,1,-1,1);var _=e(g,m),s=a(g,[{type:g.FLOAT,buffer:_,size:3,offset:0,stride:28},{type:g.FLOAT,buffer:_,size:3,offset:12,stride:28},{type:g.FLOAT,buffer:_,size:1,offset:24,stride:28}]),A=n(g);A.attributes.position.location=0,A.attributes.color.location=1,A.attributes.weight.location=2;var b=new t(g,_,s,A);return b.update(h),b}},{"./shaders/index":140,"gl-buffer":78,"gl-vao":150}],142:[function(v,S,M){var e=v("glslify"),a=e([`precision highp float;

precision highp float;
#define GLSLIFY 1

vec3 getOrthogonalVector(vec3 v) {
  // Return up-vector for only-z vector.
  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).
  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.
  // Assign z = 0, x = -b, y = a:
  // a*-b + b*a + c*0 = -ba + ba + 0 = 0
  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {
    return normalize(vec3(-v.y, v.x, 0.0));
  } else {
    return normalize(vec3(0.0, v.z, -v.y));
  }
}

// Calculate the tube vertex and normal at the given index.
//
// The returned vertex is for a tube ring with its center at origin, radius of length(d), pointing in the direction of d.
//
// Each tube segment is made up of a ring of vertices.
// These vertices are used to make up the triangles of the tube by connecting them together in the vertex array.
// The indexes of tube segments run from 0 to 8.
//
vec3 getTubePosition(vec3 d, float index, out vec3 normal) {
  float segmentCount = 8.0;

  float angle = 2.0 * 3.14159 * (index / segmentCount);

  vec3 u = getOrthogonalVector(d);
  vec3 v = normalize(cross(u, d));

  vec3 x = u * cos(angle) * length(d);
  vec3 y = v * sin(angle) * length(d);
  vec3 v3 = x + y;

  normal = normalize(v3);

  return v3;
}

attribute vec4 vector;
attribute vec4 color, position;
attribute vec2 uv;

uniform float vectorScale, tubeScale;
uniform mat4 model, view, projection, inverseModel;
uniform vec3 eyePosition, lightPosition;

varying vec3 f_normal, f_lightDirection, f_eyeDirection, f_data, f_position;
varying vec4 f_color;
varying vec2 f_uv;

void main() {
  // Scale the vector magnitude to stay constant with
  // model & view changes.
  vec3 normal;
  vec3 XYZ = getTubePosition(mat3(model) * (tubeScale * vector.w * normalize(vector.xyz)), position.w, normal);
  vec4 tubePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);

  //Lighting geometry parameters
  vec4 cameraCoordinate = view * tubePosition;
  cameraCoordinate.xyz /= cameraCoordinate.w;
  f_lightDirection = lightPosition - cameraCoordinate.xyz;
  f_eyeDirection   = eyePosition - cameraCoordinate.xyz;
  f_normal = normalize((vec4(normal, 0.0) * inverseModel).xyz);

  // vec4 m_position  = model * vec4(tubePosition, 1.0);
  vec4 t_position  = view * tubePosition;
  gl_Position      = projection * t_position;

  f_color          = color;
  f_data           = tubePosition.xyz;
  f_position       = position.xyz;
  f_uv             = uv;
}
`]),n=e([`#extension GL_OES_standard_derivatives : enable

precision highp float;
#define GLSLIFY 1

float beckmannDistribution(float x, float roughness) {
  float NdotH = max(x, 0.0001);
  float cos2Alpha = NdotH * NdotH;
  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;
  float roughness2 = roughness * roughness;
  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;
  return exp(tan2Alpha / roughness2) / denom;
}

float cookTorranceSpecular(
  vec3 lightDirection,
  vec3 viewDirection,
  vec3 surfaceNormal,
  float roughness,
  float fresnel) {

  float VdotN = max(dot(viewDirection, surfaceNormal), 0.0);
  float LdotN = max(dot(lightDirection, surfaceNormal), 0.0);

  //Half angle vector
  vec3 H = normalize(lightDirection + viewDirection);

  //Geometric term
  float NdotH = max(dot(surfaceNormal, H), 0.0);
  float VdotH = max(dot(viewDirection, H), 0.000001);
  float LdotH = max(dot(lightDirection, H), 0.000001);
  float G1 = (2.0 * NdotH * VdotN) / VdotH;
  float G2 = (2.0 * NdotH * LdotN) / LdotH;
  float G = min(1.0, min(G1, G2));
  
  //Distribution term
  float D = beckmannDistribution(NdotH, roughness);

  //Fresnel term
  float F = pow(1.0 - VdotN, fresnel);

  //Multiply terms and done
  return  G * F * D / max(3.14159265 * VdotN, 0.000001);
}

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 clipBounds[2];
uniform float roughness, fresnel, kambient, kdiffuse, kspecular, opacity;
uniform sampler2D texture;

varying vec3 f_normal, f_lightDirection, f_eyeDirection, f_data, f_position;
varying vec4 f_color;
varying vec2 f_uv;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;
  vec3 N = normalize(f_normal);
  vec3 L = normalize(f_lightDirection);
  vec3 V = normalize(f_eyeDirection);

  if(gl_FrontFacing) {
    N = -N;
  }

  float specular = min(1.0, max(0.0, cookTorranceSpecular(L, V, N, roughness, fresnel)));
  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);

  vec4 surfaceColor = f_color * texture2D(texture, f_uv);
  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);

  gl_FragColor = litColor * opacity;
}
`]),r=e([`precision highp float;

precision highp float;
#define GLSLIFY 1

vec3 getOrthogonalVector(vec3 v) {
  // Return up-vector for only-z vector.
  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).
  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.
  // Assign z = 0, x = -b, y = a:
  // a*-b + b*a + c*0 = -ba + ba + 0 = 0
  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {
    return normalize(vec3(-v.y, v.x, 0.0));
  } else {
    return normalize(vec3(0.0, v.z, -v.y));
  }
}

// Calculate the tube vertex and normal at the given index.
//
// The returned vertex is for a tube ring with its center at origin, radius of length(d), pointing in the direction of d.
//
// Each tube segment is made up of a ring of vertices.
// These vertices are used to make up the triangles of the tube by connecting them together in the vertex array.
// The indexes of tube segments run from 0 to 8.
//
vec3 getTubePosition(vec3 d, float index, out vec3 normal) {
  float segmentCount = 8.0;

  float angle = 2.0 * 3.14159 * (index / segmentCount);

  vec3 u = getOrthogonalVector(d);
  vec3 v = normalize(cross(u, d));

  vec3 x = u * cos(angle) * length(d);
  vec3 y = v * sin(angle) * length(d);
  vec3 v3 = x + y;

  normal = normalize(v3);

  return v3;
}

attribute vec4 vector;
attribute vec4 position;
attribute vec4 id;

uniform mat4 model, view, projection;
uniform float tubeScale;

varying vec3 f_position;
varying vec4 f_id;

void main() {
  vec3 normal;
  vec3 XYZ = getTubePosition(mat3(model) * (tubeScale * vector.w * normalize(vector.xyz)), position.w, normal);
  vec4 tubePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);

  gl_Position = projection * view * tubePosition;
  f_id        = id;
  f_position  = position.xyz;
}
`]),t=e([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3  clipBounds[2];
uniform float pickId;

varying vec3 f_position;
varying vec4 f_id;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;

  gl_FragColor = vec4(pickId, f_id.xyz);
}`]);M.meshShader={vertex:a,fragment:n,attributes:[{name:"position",type:"vec4"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"},{name:"vector",type:"vec4"}]},M.pickShader={vertex:r,fragment:t,attributes:[{name:"position",type:"vec4"},{name:"id",type:"vec4"},{name:"vector",type:"vec4"}]}},{glslify:231}],143:[function(v,S,M){var e=v("gl-vec3"),a=v("gl-vec4"),n=["xyz","xzy","yxz","yzx","zxy","zyx"],r=function(m,u,_,s){for(var A=m.points,b=m.velocities,f=m.divergences,x=[],l=[],L=[],T=[],k=[],P=[],z=0,I=0,D=a.create(),R=a.create(),B=8,F=0;F<A.length;F++){var H=A[F],G=b[F],J=f[F];u===0&&(J=_*.05),I=e.length(G)/s,D=a.create(),e.copy(D,G),D[3]=J;for(var X=0;X<B;X++)k[X]=[H[0],H[1],H[2],X];if(T.length>0)for(var X=0;X<B;X++){var Y=(X+1)%B;x.push(T[X],k[X],k[Y],k[Y],T[Y],T[X]),L.push(R,D,D,D,R,R),P.push(z,I,I,I,z,z);var Z=x.length;l.push([Z-6,Z-5,Z-4],[Z-3,Z-2,Z-1])}var oe=T;T=k,k=oe;var re=R;R=D,D=re;var se=z;z=I,I=se}return{positions:x,cells:l,vectors:L,vertexIntensity:P}},t=function(m,u,_,s){for(var A=0,b=0;b<m.length;b++)for(var f=m[b].velocities,x=0;x<f.length;x++)A=Math.max(A,e.length(f[x]));for(var l=m.map(function(F){return r(F,_,s,A)}),L=[],T=[],k=[],P=[],b=0;b<l.length;b++){var z=l[b],I=L.length;L=L.concat(z.positions),k=k.concat(z.vectors),P=P.concat(z.vertexIntensity);for(var x=0;x<z.cells.length;x++){var D=z.cells[x],R=[];T.push(R);for(var B=0;B<D.length;B++)R.push(D[B]+I)}}return{positions:L,cells:T,vectors:k,vertexIntensity:P,colormap:u}},c=function(m,u){var _=m.length,s;for(s=0;s<_;s++){var A=m[s];if(A===u)return s;if(A>u)return s-1}return s},o=function(m,u,_){return m<u?u:m>_?_:m},i=function(m,u,_){var s=u.vectors,A=u.meshgrid,b=m[0],f=m[1],x=m[2],l=A[0].length,L=A[1].length,T=A[2].length,k=c(A[0],b),P=c(A[1],f),z=c(A[2],x),I=k+1,D=P+1,R=z+1;if(k=o(k,0,l-1),I=o(I,0,l-1),P=o(P,0,L-1),D=o(D,0,L-1),z=o(z,0,T-1),R=o(R,0,T-1),k<0||P<0||z<0||I>l-1||D>L-1||R>T-1)return e.create();var B=A[0][k],F=A[0][I],H=A[1][P],G=A[1][D],J=A[2][z],X=A[2][R],Y=(b-B)/(F-B),Z=(f-H)/(G-H),oe=(x-J)/(X-J);isFinite(Y)||(Y=.5),isFinite(Z)||(Z=.5),isFinite(oe)||(oe=.5);var re,se,N,U,q,$;switch(_.reversedX&&(k=l-1-k,I=l-1-I),_.reversedY&&(P=L-1-P,D=L-1-D),_.reversedZ&&(z=T-1-z,R=T-1-R),_.filled){case 5:q=z,$=R,N=P*T,U=D*T,re=k*T*L,se=I*T*L;break;case 4:q=z,$=R,re=k*T,se=I*T,N=P*T*l,U=D*T*l;break;case 3:N=P,U=D,q=z*L,$=R*L,re=k*L*T,se=I*L*T;break;case 2:N=P,U=D,re=k*L,se=I*L,q=z*L*l,$=R*L*l;break;case 1:re=k,se=I,q=z*l,$=R*l,N=P*l*T,U=D*l*T;break;default:re=k,se=I,N=P*l,U=D*l,q=z*l*L,$=R*l*L;break}var W=s[re+N+q],K=s[re+N+$],ne=s[re+U+q],ae=s[re+U+$],ie=s[se+N+q],le=s[se+N+$],ye=s[se+U+q],ue=s[se+U+$],pe=e.create(),ge=e.create(),Te=e.create(),_e=e.create();e.lerp(pe,W,ie,Y),e.lerp(ge,K,le,Y),e.lerp(Te,ne,ye,Y),e.lerp(_e,ae,ue,Y);var ze=e.create(),Oe=e.create();e.lerp(ze,pe,Te,Z),e.lerp(Oe,ge,_e,Z);var Ye=e.create();return e.lerp(Ye,ze,Oe,oe),Ye},y=function(m){var u=1/0;m.sort(function(b,f){return b-f});for(var _=m.length,s=1;s<_;s++){var A=Math.abs(m[s]-m[s-1]);A<u&&(u=A)}return u},p=function(m){for(var u=[],_=[],s=[],A={},b={},f={},x=m.length,l=0;l<x;l++){var L=m[l],T=L[0],k=L[1],P=L[2];A[T]||(u.push(T),A[T]=!0),b[k]||(_.push(k),b[k]=!0),f[P]||(s.push(P),f[P]=!0)}var z=y(u),I=y(_),D=y(s),R=Math.min(z,I,D);return isFinite(R)?R:1};S.exports=function(m,u){var _=m.startingPositions,s=m.maxLength||1e3,A=m.tubeSize||1,b=m.absoluteTubeSize,f=m.gridFill||"+x+y+z",x={};f.indexOf("-x")!==-1&&(x.reversedX=!0),f.indexOf("-y")!==-1&&(x.reversedY=!0),f.indexOf("-z")!==-1&&(x.reversedZ=!0),x.filled=n.indexOf(f.replace(/-/g,"").replace(/\+/g,""));var l=m.getVelocity||function(le){return i(le,m,x)},L=m.getDivergence||function(le,ye){var ue=e.create(),pe=1e-4;e.add(ue,le,[pe,0,0]);var ge=l(ue);e.subtract(ge,ge,ye),e.scale(ge,ge,1/pe),e.add(ue,le,[0,pe,0]);var Te=l(ue);e.subtract(Te,Te,ye),e.scale(Te,Te,1/pe),e.add(ue,le,[0,0,pe]);var _e=l(ue);return e.subtract(_e,_e,ye),e.scale(_e,_e,1/pe),e.add(ue,ge,Te),e.add(ue,ue,_e),ue},T=[],k=u[0][0],P=u[0][1],z=u[0][2],I=u[1][0],D=u[1][1],R=u[1][2],B=function(le){var ye=le[0],ue=le[1],pe=le[2];return!(ye<k||ye>I||ue<P||ue>D||pe<z||pe>R)},F=e.distance(u[0],u[1]),H=10*F/s,G=H*H,J=1,X=0,Y=_.length;Y>1&&(J=p(_));for(var Z=0;Z<Y;Z++){var oe=e.create();e.copy(oe,_[Z]);var re=[oe],se=[],N=l(oe),U=oe;se.push(N);var q=[],$=L(oe,N),W=e.length($);isFinite(W)&&W>X&&(X=W),q.push(W),T.push({points:re,velocities:se,divergences:q});for(var K=0;K<s*100&&re.length<s&&B(oe);){K++;var ne=e.clone(N),ae=e.squaredLength(ne);if(ae===0)break;if(ae>G&&e.scale(ne,ne,H/Math.sqrt(ae)),e.add(ne,ne,oe),N=l(ne),e.squaredDistance(U,ne)-G>-1e-4*G){re.push(ne),U=ne,se.push(N);var $=L(ne,N),W=e.length($);isFinite(W)&&W>X&&(X=W),q.push(W)}oe=ne}}var ie=t(T,m.colormap,X,J);return b?ie.tubeScale=b:(X===0&&(X=1),ie.tubeScale=A*.5*J/X),ie};var g=v("./lib/shaders"),h=v("gl-cone3d").createMesh;S.exports.createTubeMesh=function(m,u){return h(m,u,{shaders:g,traceType:"streamtube"})}},{"./lib/shaders":142,"gl-cone3d":79,"gl-vec3":169,"gl-vec4":205}],144:[function(v,S,M){var e=v("gl-shader"),a=v("glslify"),n=a([`precision highp float;
#define GLSLIFY 1

attribute vec4 uv;
attribute vec3 f;
attribute vec3 normal;

uniform vec3 objectOffset;
uniform mat4 model, view, projection, inverseModel;
uniform vec3 lightPosition, eyePosition;
uniform sampler2D colormap;

varying float value, kill;
varying vec3 worldCoordinate;
varying vec2 planeCoordinate;
varying vec3 lightDirection, eyeDirection, surfaceNormal;
varying vec4 vColor;

void main() {
  vec3 localCoordinate = vec3(uv.zw, f.x);
  worldCoordinate = objectOffset + localCoordinate;
  vec4 worldPosition = model * vec4(worldCoordinate, 1.0);
  vec4 clipPosition = projection * view * worldPosition;
  gl_Position = clipPosition;
  kill = f.y;
  value = f.z;
  planeCoordinate = uv.xy;

  vColor = texture2D(colormap, vec2(value, value));

  //Lighting geometry parameters
  vec4 cameraCoordinate = view * worldPosition;
  cameraCoordinate.xyz /= cameraCoordinate.w;
  lightDirection = lightPosition - cameraCoordinate.xyz;
  eyeDirection   = eyePosition - cameraCoordinate.xyz;
  surfaceNormal  = normalize((vec4(normal,0) * inverseModel).xyz);
}
`]),r=a([`precision highp float;
#define GLSLIFY 1

float beckmannDistribution(float x, float roughness) {
  float NdotH = max(x, 0.0001);
  float cos2Alpha = NdotH * NdotH;
  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;
  float roughness2 = roughness * roughness;
  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;
  return exp(tan2Alpha / roughness2) / denom;
}

float beckmannSpecular(
  vec3 lightDirection,
  vec3 viewDirection,
  vec3 surfaceNormal,
  float roughness) {
  return beckmannDistribution(dot(surfaceNormal, normalize(lightDirection + viewDirection)), roughness);
}

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 lowerBound, upperBound;
uniform float contourTint;
uniform vec4 contourColor;
uniform sampler2D colormap;
uniform vec3 clipBounds[2];
uniform float roughness, fresnel, kambient, kdiffuse, kspecular, opacity;
uniform float vertexColor;

varying float value, kill;
varying vec3 worldCoordinate;
varying vec3 lightDirection, eyeDirection, surfaceNormal;
varying vec4 vColor;

void main() {
  if (
    kill > 0.0 ||
    vColor.a == 0.0 ||
    outOfRange(clipBounds[0], clipBounds[1], worldCoordinate)
  ) discard;

  vec3 N = normalize(surfaceNormal);
  vec3 V = normalize(eyeDirection);
  vec3 L = normalize(lightDirection);

  if(gl_FrontFacing) {
    N = -N;
  }

  float specular = max(beckmannSpecular(L, V, N, roughness), 0.);
  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);

  //decide how to interpolate color \u2014 in vertex or in fragment
  vec4 surfaceColor =
    step(vertexColor, .5) * texture2D(colormap, vec2(value, value)) +
    step(.5, vertexColor) * vColor;

  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);

  gl_FragColor = mix(litColor, contourColor, contourTint) * opacity;
}
`]),t=a([`precision highp float;
#define GLSLIFY 1

attribute vec4 uv;
attribute float f;

uniform vec3 objectOffset;
uniform mat3 permutation;
uniform mat4 model, view, projection;
uniform float height, zOffset;
uniform sampler2D colormap;

varying float value, kill;
varying vec3 worldCoordinate;
varying vec2 planeCoordinate;
varying vec3 lightDirection, eyeDirection, surfaceNormal;
varying vec4 vColor;

void main() {
  vec3 dataCoordinate = permutation * vec3(uv.xy, height);
  worldCoordinate = objectOffset + dataCoordinate;
  vec4 worldPosition = model * vec4(worldCoordinate, 1.0);

  vec4 clipPosition = projection * view * worldPosition;
  clipPosition.z += zOffset;

  gl_Position = clipPosition;
  value = f + objectOffset.z;
  kill = -1.0;
  planeCoordinate = uv.zw;

  vColor = texture2D(colormap, vec2(value, value));

  //Don't do lighting for contours
  surfaceNormal   = vec3(1,0,0);
  eyeDirection    = vec3(0,1,0);
  lightDirection  = vec3(0,0,1);
}
`]),c=a([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec2 shape;
uniform vec3 clipBounds[2];
uniform float pickId;

varying float value, kill;
varying vec3 worldCoordinate;
varying vec2 planeCoordinate;
varying vec3 surfaceNormal;

vec2 splitFloat(float v) {
  float vh = 255.0 * v;
  float upper = floor(vh);
  float lower = fract(vh);
  return vec2(upper / 255.0, floor(lower * 16.0) / 16.0);
}

void main() {
  if ((kill > 0.0) ||
      (outOfRange(clipBounds[0], clipBounds[1], worldCoordinate))) discard;

  vec2 ux = splitFloat(planeCoordinate.x / shape.x);
  vec2 uy = splitFloat(planeCoordinate.y / shape.y);
  gl_FragColor = vec4(pickId, ux.x, uy.x, ux.y + (uy.y/16.0));
}
`]);M.createShader=function(o){var i=e(o,n,r,null,[{name:"uv",type:"vec4"},{name:"f",type:"vec3"},{name:"normal",type:"vec3"}]);return i.attributes.uv.location=0,i.attributes.f.location=1,i.attributes.normal.location=2,i},M.createPickShader=function(o){var i=e(o,n,c,null,[{name:"uv",type:"vec4"},{name:"f",type:"vec3"},{name:"normal",type:"vec3"}]);return i.attributes.uv.location=0,i.attributes.f.location=1,i.attributes.normal.location=2,i},M.createContourShader=function(o){var i=e(o,t,r,null,[{name:"uv",type:"vec4"},{name:"f",type:"float"}]);return i.attributes.uv.location=0,i.attributes.f.location=1,i},M.createPickContourShader=function(o){var i=e(o,t,c,null,[{name:"uv",type:"vec4"},{name:"f",type:"float"}]);return i.attributes.uv.location=0,i.attributes.f.location=1,i}},{"gl-shader":132,glslify:231}],145:[function(v,S,M){S.exports=se;var e=v("bit-twiddle"),a=v("gl-buffer"),n=v("gl-vao"),r=v("gl-texture2d"),t=v("typedarray-pool"),c=v("colormap"),o=v("ndarray-ops"),i=v("ndarray-pack"),y=v("ndarray"),p=v("surface-nets"),g=v("gl-mat4/multiply"),h=v("gl-mat4/invert"),m=v("binary-search-bounds"),u=v("ndarray-gradient"),_=v("./lib/shaders"),s=_.createShader,A=_.createContourShader,b=_.createPickShader,f=_.createPickContourShader,x=4*(4+3+3),l=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],L=[[0,0],[0,1],[1,0],[1,1],[1,0],[0,1]],T=[[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0]];(function(){for(var N=0;N<3;++N){var U=T[N],q=(N+1)%3,$=(N+2)%3;U[q+0]=1,U[$+3]=1,U[N+6]=1}})();function k(N,U,q,$,W){this.position=N,this.index=U,this.uv=q,this.level=$,this.dataCoordinate=W}var P=256;function z(N,U,q,$,W,K,ne,ae,ie,le,ye,ue,pe,ge,Te){this.gl=N,this.shape=U,this.bounds=q,this.objectOffset=Te,this.intensityBounds=[],this._shader=$,this._pickShader=W,this._coordinateBuffer=K,this._vao=ne,this._colorMap=ae,this._contourShader=ie,this._contourPickShader=le,this._contourBuffer=ye,this._contourVAO=ue,this._contourOffsets=[[],[],[]],this._contourCounts=[[],[],[]],this._vertexCount=0,this._pickResult=new k([0,0,0],[0,0],[0,0],[0,0,0],[0,0,0]),this._dynamicBuffer=pe,this._dynamicVAO=ge,this._dynamicOffsets=[0,0,0],this._dynamicCounts=[0,0,0],this.contourWidth=[1,1,1],this.contourLevels=[[1],[1],[1]],this.contourTint=[0,0,0],this.contourColor=[[.5,.5,.5,1],[.5,.5,.5,1],[.5,.5,.5,1]],this.showContour=!0,this.showSurface=!0,this.enableHighlight=[!0,!0,!0],this.highlightColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.highlightTint=[1,1,1],this.highlightLevel=[-1,-1,-1],this.enableDynamic=[!0,!0,!0],this.dynamicLevel=[NaN,NaN,NaN],this.dynamicColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.dynamicTint=[1,1,1],this.dynamicWidth=[1,1,1],this.axesBounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.surfaceProject=[!1,!1,!1],this.contourProject=[[!1,!1,!1],[!1,!1,!1],[!1,!1,!1]],this.colorBounds=[!1,!1],this._field=[y(t.mallocFloat(1024),[0,0]),y(t.mallocFloat(1024),[0,0]),y(t.mallocFloat(1024),[0,0])],this.pickId=1,this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.snapToData=!1,this.pixelRatio=1,this.opacity=1,this.lightPosition=[10,1e4,0],this.ambientLight=.8,this.diffuseLight=.8,this.specularLight=2,this.roughness=.5,this.fresnel=1.5,this.vertexColor=0,this.dirty=!0}var I=z.prototype;I.genColormap=function(N,U){var q=!1,$=i([c({colormap:N,nshades:P,format:"rgba"}).map(function(W,K){var ne=U?D(K/255,U):W[3];return ne<1&&(q=!0),[W[0],W[1],W[2],255*ne]})]);return o.divseq($,255),this.hasAlphaScale=q,$},I.isTransparent=function(){return this.opacity<1||this.hasAlphaScale},I.isOpaque=function(){return!this.isTransparent()},I.pickSlots=1,I.setPickBase=function(N){this.pickId=N};function D(N,U){if(!U||!U.length)return 1;for(var q=0;q<U.length;++q){if(U.length<2)return 1;if(U[q][0]===N)return U[q][1];if(U[q][0]>N&&q>0){var $=(U[q][0]-N)/(U[q][0]-U[q-1][0]);return U[q][1]*(1-$)+$*U[q-1][1]}}return 1}var R=[0,0,0],B={showSurface:!1,showContour:!1,projections:[l.slice(),l.slice(),l.slice()],clipBounds:[[[0,0,0],[0,0,0]],[[0,0,0],[0,0,0]],[[0,0,0],[0,0,0]]]};function F(N,U){var q,$,W,K=U.axes&&U.axes.lastCubeProps.axis||R,ne=U.showSurface,ae=U.showContour;for(q=0;q<3;++q)for(ne=ne||U.surfaceProject[q],$=0;$<3;++$)ae=ae||U.contourProject[q][$];for(q=0;q<3;++q){var ie=B.projections[q];for($=0;$<16;++$)ie[$]=0;for($=0;$<4;++$)ie[5*$]=1;ie[5*q]=0,ie[12+q]=U.axesBounds[+(K[q]>0)][q],g(ie,N.model,ie);var le=B.clipBounds[q];for(W=0;W<2;++W)for($=0;$<3;++$)le[W][$]=N.clipBounds[W][$];le[0][q]=-1e8,le[1][q]=1e8}return B.showSurface=ne,B.showContour=ae,B}var H={model:l,view:l,projection:l,inverseModel:l.slice(),lowerBound:[0,0,0],upperBound:[0,0,0],colorMap:0,clipBounds:[[0,0,0],[0,0,0]],height:0,contourTint:0,contourColor:[0,0,0,1],permutation:[1,0,0,0,1,0,0,0,1],zOffset:-1e-4,objectOffset:[0,0,0],kambient:1,kdiffuse:1,kspecular:1,lightPosition:[1e3,1e3,1e3],eyePosition:[0,0,0],roughness:1,fresnel:1,opacity:1,vertexColor:0},G=l.slice(),J=[1,0,0,0,1,0,0,0,1];function X(N,U){N=N||{};var q=this.gl;q.disable(q.CULL_FACE),this._colorMap.bind(0);var $=H;$.model=N.model||l,$.view=N.view||l,$.projection=N.projection||l,$.lowerBound=[this.bounds[0][0],this.bounds[0][1],this.colorBounds[0]||this.bounds[0][2]],$.upperBound=[this.bounds[1][0],this.bounds[1][1],this.colorBounds[1]||this.bounds[1][2]],$.objectOffset=this.objectOffset,$.contourColor=this.contourColor[0],$.inverseModel=h($.inverseModel,$.model);for(var W=0;W<2;++W)for(var K=$.clipBounds[W],ne=0;ne<3;++ne)K[ne]=Math.min(Math.max(this.clipBounds[W][ne],-1e8),1e8);$.kambient=this.ambientLight,$.kdiffuse=this.diffuseLight,$.kspecular=this.specularLight,$.roughness=this.roughness,$.fresnel=this.fresnel,$.opacity=this.opacity,$.height=0,$.permutation=J,$.vertexColor=this.vertexColor;var ae=G;for(g(ae,$.view,$.model),g(ae,$.projection,ae),h(ae,ae),W=0;W<3;++W)$.eyePosition[W]=ae[12+W]/ae[15];var ie=ae[15];for(W=0;W<3;++W)ie+=this.lightPosition[W]*ae[4*W+3];for(W=0;W<3;++W){var le=ae[12+W];for(ne=0;ne<3;++ne)le+=ae[4*ne+W]*this.lightPosition[ne];$.lightPosition[W]=le/ie}var ye=F($,this);if(ye.showSurface){for(this._shader.bind(),this._shader.uniforms=$,this._vao.bind(),this.showSurface&&this._vertexCount&&this._vao.draw(q.TRIANGLES,this._vertexCount),W=0;W<3;++W)!this.surfaceProject[W]||!this.vertexCount||(this._shader.uniforms.model=ye.projections[W],this._shader.uniforms.clipBounds=ye.clipBounds[W],this._vao.draw(q.TRIANGLES,this._vertexCount));this._vao.unbind()}if(ye.showContour){var ue=this._contourShader;$.kambient=1,$.kdiffuse=0,$.kspecular=0,$.opacity=1,ue.bind(),ue.uniforms=$;var pe=this._contourVAO;for(pe.bind(),W=0;W<3;++W)for(ue.uniforms.permutation=T[W],q.lineWidth(this.contourWidth[W]*this.pixelRatio),ne=0;ne<this.contourLevels[W].length;++ne)ne===this.highlightLevel[W]?(ue.uniforms.contourColor=this.highlightColor[W],ue.uniforms.contourTint=this.highlightTint[W]):(ne===0||ne-1===this.highlightLevel[W])&&(ue.uniforms.contourColor=this.contourColor[W],ue.uniforms.contourTint=this.contourTint[W]),this._contourCounts[W][ne]&&(ue.uniforms.height=this.contourLevels[W][ne],pe.draw(q.LINES,this._contourCounts[W][ne],this._contourOffsets[W][ne]));for(W=0;W<3;++W)for(ue.uniforms.model=ye.projections[W],ue.uniforms.clipBounds=ye.clipBounds[W],ne=0;ne<3;++ne)if(!!this.contourProject[W][ne]){ue.uniforms.permutation=T[ne],q.lineWidth(this.contourWidth[ne]*this.pixelRatio);for(var ge=0;ge<this.contourLevels[ne].length;++ge)ge===this.highlightLevel[ne]?(ue.uniforms.contourColor=this.highlightColor[ne],ue.uniforms.contourTint=this.highlightTint[ne]):(ge===0||ge-1===this.highlightLevel[ne])&&(ue.uniforms.contourColor=this.contourColor[ne],ue.uniforms.contourTint=this.contourTint[ne]),this._contourCounts[ne][ge]&&(ue.uniforms.height=this.contourLevels[ne][ge],pe.draw(q.LINES,this._contourCounts[ne][ge],this._contourOffsets[ne][ge]))}for(pe.unbind(),pe=this._dynamicVAO,pe.bind(),W=0;W<3;++W)if(this._dynamicCounts[W]!==0)for(ue.uniforms.model=$.model,ue.uniforms.clipBounds=$.clipBounds,ue.uniforms.permutation=T[W],q.lineWidth(this.dynamicWidth[W]*this.pixelRatio),ue.uniforms.contourColor=this.dynamicColor[W],ue.uniforms.contourTint=this.dynamicTint[W],ue.uniforms.height=this.dynamicLevel[W],pe.draw(q.LINES,this._dynamicCounts[W],this._dynamicOffsets[W]),ne=0;ne<3;++ne)!this.contourProject[ne][W]||(ue.uniforms.model=ye.projections[ne],ue.uniforms.clipBounds=ye.clipBounds[ne],pe.draw(q.LINES,this._dynamicCounts[W],this._dynamicOffsets[W]));pe.unbind()}}I.draw=function(N){return X.call(this,N,!1)},I.drawTransparent=function(N){return X.call(this,N,!0)};var Y={model:l,view:l,projection:l,inverseModel:l,clipBounds:[[0,0,0],[0,0,0]],height:0,shape:[0,0],pickId:0,lowerBound:[0,0,0],upperBound:[0,0,0],zOffset:0,objectOffset:[0,0,0],permutation:[1,0,0,0,1,0,0,0,1],lightPosition:[0,0,0],eyePosition:[0,0,0]};I.drawPick=function(N){N=N||{};var U=this.gl;U.disable(U.CULL_FACE);var q=Y;q.model=N.model||l,q.view=N.view||l,q.projection=N.projection||l,q.shape=this._field[2].shape,q.pickId=this.pickId/255,q.lowerBound=this.bounds[0],q.upperBound=this.bounds[1],q.objectOffset=this.objectOffset,q.permutation=J;for(var $=0;$<2;++$)for(var W=q.clipBounds[$],K=0;K<3;++K)W[K]=Math.min(Math.max(this.clipBounds[$][K],-1e8),1e8);var ne=F(q,this);if(ne.showSurface){for(this._pickShader.bind(),this._pickShader.uniforms=q,this._vao.bind(),this._vao.draw(U.TRIANGLES,this._vertexCount),$=0;$<3;++$)!this.surfaceProject[$]||(this._pickShader.uniforms.model=ne.projections[$],this._pickShader.uniforms.clipBounds=ne.clipBounds[$],this._vao.draw(U.TRIANGLES,this._vertexCount));this._vao.unbind()}if(ne.showContour){var ae=this._contourPickShader;ae.bind(),ae.uniforms=q;var ie=this._contourVAO;for(ie.bind(),K=0;K<3;++K)for(U.lineWidth(this.contourWidth[K]*this.pixelRatio),ae.uniforms.permutation=T[K],$=0;$<this.contourLevels[K].length;++$)this._contourCounts[K][$]&&(ae.uniforms.height=this.contourLevels[K][$],ie.draw(U.LINES,this._contourCounts[K][$],this._contourOffsets[K][$]));for($=0;$<3;++$)for(ae.uniforms.model=ne.projections[$],ae.uniforms.clipBounds=ne.clipBounds[$],K=0;K<3;++K)if(!!this.contourProject[$][K]){ae.uniforms.permutation=T[K],U.lineWidth(this.contourWidth[K]*this.pixelRatio);for(var le=0;le<this.contourLevels[K].length;++le)this._contourCounts[K][le]&&(ae.uniforms.height=this.contourLevels[K][le],ie.draw(U.LINES,this._contourCounts[K][le],this._contourOffsets[K][le]))}ie.unbind()}},I.pick=function(N){if(!N||N.id!==this.pickId)return null;var U=this._field[2].shape,q=this._pickResult,$=U[0]*(N.value[0]+(N.value[2]>>4)/16)/255,W=Math.floor($),K=$-W,ne=U[1]*(N.value[1]+(N.value[2]&15)/16)/255,ae=Math.floor(ne),ie=ne-ae;W+=1,ae+=1;var le=q.position;le[0]=le[1]=le[2]=0;for(var ye=0;ye<2;++ye)for(var ue=ye?K:1-K,pe=0;pe<2;++pe)for(var ge=pe?ie:1-ie,Te=W+ye,_e=ae+pe,ze=ue*ge,Oe=0;Oe<3;++Oe)le[Oe]+=this._field[Oe].get(Te,_e)*ze;for(var Ye=this._pickResult.level,be=0;be<3;++be)if(Ye[be]=m.le(this.contourLevels[be],le[be]),Ye[be]<0)this.contourLevels[be].length>0&&(Ye[be]=0);else if(Ye[be]<this.contourLevels[be].length-1){var Pe=this.contourLevels[be][Ye[be]],Ge=this.contourLevels[be][Ye[be]+1];Math.abs(Pe-le[be])>Math.abs(Ge-le[be])&&(Ye[be]+=1)}for(q.index[0]=K<.5?W:W+1,q.index[1]=ie<.5?ae:ae+1,q.uv[0]=$/U[0],q.uv[1]=ne/U[1],Oe=0;Oe<3;++Oe)q.dataCoordinate[Oe]=this._field[Oe].get(q.index[0],q.index[1]);return q},I.padField=function(N,U){var q=U.shape.slice(),$=N.shape.slice();o.assign(N.lo(1,1).hi(q[0],q[1]),U),o.assign(N.lo(1).hi(q[0],1),U.hi(q[0],1)),o.assign(N.lo(1,$[1]-1).hi(q[0],1),U.lo(0,q[1]-1).hi(q[0],1)),o.assign(N.lo(0,1).hi(1,q[1]),U.hi(1)),o.assign(N.lo($[0]-1,1).hi(1,q[1]),U.lo(q[0]-1)),N.set(0,0,U.get(0,0)),N.set(0,$[1]-1,U.get(0,q[1]-1)),N.set($[0]-1,0,U.get(q[0]-1,0)),N.set($[0]-1,$[1]-1,U.get(q[0]-1,q[1]-1))};function Z(N,U){return Array.isArray(N)?[U(N[0]),U(N[1]),U(N[2])]:[U(N),U(N),U(N)]}function oe(N){return Array.isArray(N)?N.length===3?[N[0],N[1],N[2],1]:[N[0],N[1],N[2],N[3]]:[0,0,0,1]}function re(N){if(Array.isArray(N)){if(Array.isArray(N))return[oe(N[0]),oe(N[1]),oe(N[2])];var U=oe(N);return[U.slice(),U.slice(),U.slice()]}}I.update=function(N){N=N||{},this.objectOffset=N.objectOffset||this.objectOffset,this.dirty=!0,"contourWidth"in N&&(this.contourWidth=Z(N.contourWidth,Number)),"showContour"in N&&(this.showContour=Z(N.showContour,Boolean)),"showSurface"in N&&(this.showSurface=!!N.showSurface),"contourTint"in N&&(this.contourTint=Z(N.contourTint,Boolean)),"contourColor"in N&&(this.contourColor=re(N.contourColor)),"contourProject"in N&&(this.contourProject=Z(N.contourProject,function(it){return Z(it,Boolean)})),"surfaceProject"in N&&(this.surfaceProject=N.surfaceProject),"dynamicColor"in N&&(this.dynamicColor=re(N.dynamicColor)),"dynamicTint"in N&&(this.dynamicTint=Z(N.dynamicTint,Number)),"dynamicWidth"in N&&(this.dynamicWidth=Z(N.dynamicWidth,Number)),"opacity"in N&&(this.opacity=N.opacity),"opacityscale"in N&&(this.opacityscale=N.opacityscale),"colorBounds"in N&&(this.colorBounds=N.colorBounds),"vertexColor"in N&&(this.vertexColor=N.vertexColor?1:0),"colormap"in N&&this._colorMap.setPixels(this.genColormap(N.colormap,this.opacityscale));var U=N.field||N.coords&&N.coords[2]||null,q=!1;if(U||(this._field[2].shape[0]||this._field[2].shape[2]?U=this._field[2].lo(1,1).hi(this._field[2].shape[0]-2,this._field[2].shape[1]-2):U=this._field[2].hi(0,0)),"field"in N||"coords"in N){var $=(U.shape[0]+2)*(U.shape[1]+2);$>this._field[2].data.length&&(t.freeFloat(this._field[2].data),this._field[2].data=t.mallocFloat(e.nextPow2($))),this._field[2]=y(this._field[2].data,[U.shape[0]+2,U.shape[1]+2]),this.padField(this._field[2],U),this.shape=U.shape.slice();for(var W=this.shape,K=0;K<2;++K)this._field[2].size>this._field[K].data.length&&(t.freeFloat(this._field[K].data),this._field[K].data=t.mallocFloat(this._field[2].size)),this._field[K]=y(this._field[K].data,[W[0]+2,W[1]+2]);if(N.coords){var ne=N.coords;if(!Array.isArray(ne)||ne.length!==3)throw new Error("gl-surface: invalid coordinates for x/y");for(K=0;K<2;++K){var ae=ne[K];for(pe=0;pe<2;++pe)if(ae.shape[pe]!==W[pe])throw new Error("gl-surface: coords have incorrect shape");this.padField(this._field[K],ae)}}else if(N.ticks){var ie=N.ticks;if(!Array.isArray(ie)||ie.length!==2)throw new Error("gl-surface: invalid ticks");for(K=0;K<2;++K){var le=ie[K];if((Array.isArray(le)||le.length)&&(le=y(le)),le.shape[0]!==W[K])throw new Error("gl-surface: invalid tick length");var ye=y(le.data,W);ye.stride[K]=le.stride[0],ye.stride[K^1]=0,this.padField(this._field[K],ye)}}else{for(K=0;K<2;++K){var ue=[0,0];ue[K]=1,this._field[K]=y(this._field[K].data,[W[0]+2,W[1]+2],ue,0)}this._field[0].set(0,0,0);for(var pe=0;pe<W[0];++pe)this._field[0].set(pe+1,0,pe);for(this._field[0].set(W[0]+1,0,W[0]-1),this._field[1].set(0,0,0),pe=0;pe<W[1];++pe)this._field[1].set(0,pe+1,pe);this._field[1].set(0,W[1]+1,W[1]-1)}var ge=this._field,Te=y(t.mallocFloat(ge[2].size*3*2),[3,W[0]+2,W[1]+2,2]);for(K=0;K<3;++K)u(Te.pick(K),ge[K],"mirror");var _e=y(t.mallocFloat(ge[2].size*3),[W[0]+2,W[1]+2,3]);for(K=0;K<W[0]+2;++K)for(pe=0;pe<W[1]+2;++pe){var ze=Te.get(0,K,pe,0),Oe=Te.get(0,K,pe,1),Ye=Te.get(1,K,pe,0),be=Te.get(1,K,pe,1),Pe=Te.get(2,K,pe,0),Ge=Te.get(2,K,pe,1),Qe=Ye*Ge-be*Pe,Be=Pe*Oe-Ge*ze,Le=ze*be-Oe*Ye,He=Math.sqrt(Qe*Qe+Be*Be+Le*Le);He<1e-8?(He=Math.max(Math.abs(Qe),Math.abs(Be),Math.abs(Le)),He<1e-8?(Le=1,Be=Qe=0,He=1):He=1/He):He=1/Math.sqrt(He),_e.set(K,pe,0,Qe*He),_e.set(K,pe,1,Be*He),_e.set(K,pe,2,Le*He)}t.free(Te.data);var vt=[1/0,1/0,1/0],Rt=[-1/0,-1/0,-1/0],rr=1/0,Lt=-1/0,Ft=(W[0]-1)*(W[1]-1)*6,Gt=t.mallocFloat(e.nextPow2(10*Ft)),Dt=0,kt=0;for(K=0;K<W[0]-1;++K){e:for(pe=0;pe<W[1]-1;++pe){for(var Ue=0;Ue<2;++Ue)for(var qe=0;qe<2;++qe)for(var Ve=0;Ve<3;++Ve){var Ae=this._field[Ve].get(1+K+Ue,1+pe+qe);if(isNaN(Ae)||!isFinite(Ae))continue e}for(Ve=0;Ve<6;++Ve){var Ne=K+L[Ve][0],Xe=pe+L[Ve][1],Je=this._field[0].get(Ne+1,Xe+1),_t=this._field[1].get(Ne+1,Xe+1);Ae=this._field[2].get(Ne+1,Xe+1),Qe=_e.get(Ne+1,Xe+1,0),Be=_e.get(Ne+1,Xe+1,1),Le=_e.get(Ne+1,Xe+1,2),N.intensity&&(mt=N.intensity.get(Ne,Xe));var mt=N.intensity?N.intensity.get(Ne,Xe):Ae+this.objectOffset[2];Gt[Dt++]=Ne,Gt[Dt++]=Xe,Gt[Dt++]=Je,Gt[Dt++]=_t,Gt[Dt++]=Ae,Gt[Dt++]=0,Gt[Dt++]=mt,Gt[Dt++]=Qe,Gt[Dt++]=Be,Gt[Dt++]=Le,vt[0]=Math.min(vt[0],Je+this.objectOffset[0]),vt[1]=Math.min(vt[1],_t+this.objectOffset[1]),vt[2]=Math.min(vt[2],Ae+this.objectOffset[2]),rr=Math.min(rr,mt),Rt[0]=Math.max(Rt[0],Je+this.objectOffset[0]),Rt[1]=Math.max(Rt[1],_t+this.objectOffset[1]),Rt[2]=Math.max(Rt[2],Ae+this.objectOffset[2]),Lt=Math.max(Lt,mt),kt+=1}}}for(N.intensityBounds&&(rr=+N.intensityBounds[0],Lt=+N.intensityBounds[1]),K=6;K<Dt;K+=10)Gt[K]=(Gt[K]-rr)/(Lt-rr);this._vertexCount=kt,this._coordinateBuffer.update(Gt.subarray(0,Dt)),t.freeFloat(Gt),t.free(_e.data),this.bounds=[vt,Rt],this.intensity=N.intensity||this._field[2],(this.intensityBounds[0]!==rr||this.intensityBounds[1]!==Lt)&&(q=!0),this.intensityBounds=[rr,Lt]}if("levels"in N){var Ot=N.levels;for(Array.isArray(Ot[0])?Ot=Ot.slice():Ot=[[],[],Ot],K=0;K<3;++K)Ot[K]=Ot[K].slice(),Ot[K].sort(function(it,ct){return it-ct});for(K=0;K<3;++K)for(pe=0;pe<Ot[K].length;++pe)Ot[K][pe]-=this.objectOffset[K];e:for(K=0;K<3;++K){if(Ot[K].length!==this.contourLevels[K].length){q=!0;break}for(pe=0;pe<Ot[K].length;++pe)if(Ot[K][pe]!==this.contourLevels[K][pe]){q=!0;break e}}this.contourLevels=Ot}if(q){ge=this._field,W=this.shape;for(var Kt=[],Nt=0;Nt<3;++Nt){var Wt=this.contourLevels[Nt],qt=[],Yt=[],fr=[0,0,0];for(K=0;K<Wt.length;++K){var Yr=p(this._field[Nt],Wt[K]);qt.push(Kt.length/5|0),kt=0;e:for(pe=0;pe<Yr.cells.length;++pe){var hn=Yr.cells[pe];for(Ve=0;Ve<2;++Ve){var Qr=Yr.positions[hn[Ve]],at=Qr[0],Jt=Math.floor(at)|0,Zt=at-Jt,Ut=Qr[1],_r=Math.floor(Ut)|0,rt=Ut-_r,Ke=!1;t:for(var st=0;st<3;++st){fr[st]=0;var lt=(Nt+st+1)%3;for(Ue=0;Ue<2;++Ue){var wt=Ue?Zt:1-Zt;for(Ne=Math.min(Math.max(Jt+Ue,0),W[0])|0,qe=0;qe<2;++qe){var Pt=qe?rt:1-rt;if(Xe=Math.min(Math.max(_r+qe,0),W[1])|0,st<2?Ae=this._field[lt].get(Ne,Xe):Ae=(this.intensity.get(Ne,Xe)-this.intensityBounds[0])/(this.intensityBounds[1]-this.intensityBounds[0]),!isFinite(Ae)||isNaN(Ae)){Ke=!0;break t}var ke=wt*Pt;fr[st]+=ke*Ae}}}if(!Ke)Kt.push(fr[0],fr[1],Qr[0],Qr[1],fr[2]),kt+=1;else{if(Ve>0){for(var Se=0;Se<5;++Se)Kt.pop();kt-=1}continue e}}}Yt.push(kt)}this._contourOffsets[Nt]=qt,this._contourCounts[Nt]=Yt}var nt=t.mallocFloat(Kt.length);for(K=0;K<Kt.length;++K)nt[K]=Kt[K];this._contourBuffer.update(nt),t.freeFloat(nt)}},I.dispose=function(){this._shader.dispose(),this._vao.dispose(),this._coordinateBuffer.dispose(),this._colorMap.dispose(),this._contourBuffer.dispose(),this._contourVAO.dispose(),this._contourShader.dispose(),this._contourPickShader.dispose(),this._dynamicBuffer.dispose(),this._dynamicVAO.dispose();for(var N=0;N<3;++N)t.freeFloat(this._field[N].data)},I.highlight=function(N){var U;if(!N){this._dynamicCounts=[0,0,0],this.dyanamicLevel=[NaN,NaN,NaN],this.highlightLevel=[-1,-1,-1];return}for(U=0;U<3;++U)this.enableHighlight[U]?this.highlightLevel[U]=N.level[U]:this.highlightLevel[U]=-1;var q;for(this.snapToData?q=N.dataCoordinate:q=N.position,U=0;U<3;++U)q[U]-=this.objectOffset[U];if(!((!this.enableDynamic[0]||q[0]===this.dynamicLevel[0])&&(!this.enableDynamic[1]||q[1]===this.dynamicLevel[1])&&(!this.enableDynamic[2]||q[2]===this.dynamicLevel[2]))){for(var $=0,W=this.shape,K=t.mallocFloat(12*W[0]*W[1]),ne=0;ne<3;++ne){if(!this.enableDynamic[ne]){this.dynamicLevel[ne]=NaN,this._dynamicCounts[ne]=0;continue}this.dynamicLevel[ne]=q[ne];var ae=(ne+1)%3,ie=(ne+2)%3,le=this._field[ne],ye=this._field[ae],ue=this._field[ie],pe=p(le,q[ne]),ge=pe.cells,Te=pe.positions;for(this._dynamicOffsets[ne]=$,U=0;U<ge.length;++U)for(var _e=ge[U],ze=0;ze<2;++ze){var Oe=Te[_e[ze]],Ye=+Oe[0],be=Ye|0,Pe=Math.min(be+1,W[0])|0,Ge=Ye-be,Qe=1-Ge,Be=+Oe[1],Le=Be|0,He=Math.min(Le+1,W[1])|0,vt=Be-Le,Rt=1-vt,rr=Qe*Rt,Lt=Qe*vt,Ft=Ge*Rt,Gt=Ge*vt,Dt=rr*ye.get(be,Le)+Lt*ye.get(be,He)+Ft*ye.get(Pe,Le)+Gt*ye.get(Pe,He),kt=rr*ue.get(be,Le)+Lt*ue.get(be,He)+Ft*ue.get(Pe,Le)+Gt*ue.get(Pe,He);if(isNaN(Dt)||isNaN(kt)){ze&&($-=1);break}K[2*$+0]=Dt,K[2*$+1]=kt,$+=1}this._dynamicCounts[ne]=$-this._dynamicOffsets[ne]}this._dynamicBuffer.update(K.subarray(0,2*$)),t.freeFloat(K)}};function se(N){var U=N.gl,q=s(U),$=b(U),W=A(U),K=f(U),ne=a(U),ae=n(U,[{buffer:ne,size:4,stride:x,offset:0},{buffer:ne,size:3,stride:x,offset:16},{buffer:ne,size:3,stride:x,offset:28}]),ie=a(U),le=n(U,[{buffer:ie,size:4,stride:20,offset:0},{buffer:ie,size:1,stride:20,offset:16}]),ye=a(U),ue=n(U,[{buffer:ye,size:2,type:U.FLOAT}]),pe=r(U,1,P,U.RGBA,U.UNSIGNED_BYTE);pe.minFilter=U.LINEAR,pe.magFilter=U.LINEAR;var ge=new z(U,[0,0],[[0,0,0],[0,0,0]],q,$,ne,ae,pe,W,K,ie,le,ye,ue,[0,0,0]),Te={levels:[[],[],[]]};for(var _e in N)Te[_e]=N[_e];return Te.colormap=Te.colormap||"jet",ge.update(Te),ge}},{"./lib/shaders":144,"binary-search-bounds":31,"bit-twiddle":32,colormap:53,"gl-buffer":78,"gl-mat4/invert":98,"gl-mat4/multiply":100,"gl-texture2d":146,"gl-vao":150,ndarray:259,"ndarray-gradient":252,"ndarray-ops":254,"ndarray-pack":255,"surface-nets":302,"typedarray-pool":308}],146:[function(v,S,M){var e=v("ndarray"),a=v("ndarray-ops"),n=v("typedarray-pool");S.exports=f;var r=null,t=null,c=null;function o(x){r=[x.LINEAR,x.NEAREST_MIPMAP_LINEAR,x.LINEAR_MIPMAP_NEAREST,x.LINEAR_MIPMAP_NEAREST],t=[x.NEAREST,x.LINEAR,x.NEAREST_MIPMAP_NEAREST,x.NEAREST_MIPMAP_LINEAR,x.LINEAR_MIPMAP_NEAREST,x.LINEAR_MIPMAP_LINEAR],c=[x.REPEAT,x.CLAMP_TO_EDGE,x.MIRRORED_REPEAT]}function i(x){return typeof HTMLCanvasElement<"u"&&x instanceof HTMLCanvasElement||typeof HTMLImageElement<"u"&&x instanceof HTMLImageElement||typeof HTMLVideoElement<"u"&&x instanceof HTMLVideoElement||typeof ImageData<"u"&&x instanceof ImageData}var y=function(x,l){a.muls(x,l,255)};function p(x,l,L){var T=x.gl,k=T.getParameter(T.MAX_TEXTURE_SIZE);if(l<0||l>k||L<0||L>k)throw new Error("gl-texture2d: Invalid texture size");return x._shape=[l,L],x.bind(),T.texImage2D(T.TEXTURE_2D,0,x.format,l,L,0,x.format,x.type,null),x._mipLevels=[0],x}function g(x,l,L,T,k,P){this.gl=x,this.handle=l,this.format=k,this.type=P,this._shape=[L,T],this._mipLevels=[0],this._magFilter=x.NEAREST,this._minFilter=x.NEAREST,this._wrapS=x.CLAMP_TO_EDGE,this._wrapT=x.CLAMP_TO_EDGE,this._anisoSamples=1;var z=this,I=[this._wrapS,this._wrapT];Object.defineProperties(I,[{get:function(){return z._wrapS},set:function(R){return z.wrapS=R}},{get:function(){return z._wrapT},set:function(R){return z.wrapT=R}}]),this._wrapVector=I;var D=[this._shape[0],this._shape[1]];Object.defineProperties(D,[{get:function(){return z._shape[0]},set:function(R){return z.width=R}},{get:function(){return z._shape[1]},set:function(R){return z.height=R}}]),this._shapeVector=D}var h=g.prototype;Object.defineProperties(h,{minFilter:{get:function(){return this._minFilter},set:function(x){this.bind();var l=this.gl;if(this.type===l.FLOAT&&r.indexOf(x)>=0&&(l.getExtension("OES_texture_float_linear")||(x=l.NEAREST)),t.indexOf(x)<0)throw new Error("gl-texture2d: Unknown filter mode "+x);return l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,x),this._minFilter=x}},magFilter:{get:function(){return this._magFilter},set:function(x){this.bind();var l=this.gl;if(this.type===l.FLOAT&&r.indexOf(x)>=0&&(l.getExtension("OES_texture_float_linear")||(x=l.NEAREST)),t.indexOf(x)<0)throw new Error("gl-texture2d: Unknown filter mode "+x);return l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MAG_FILTER,x),this._magFilter=x}},mipSamples:{get:function(){return this._anisoSamples},set:function(x){var l=this._anisoSamples;if(this._anisoSamples=Math.max(x,1)|0,l!==this._anisoSamples){var L=this.gl.getExtension("EXT_texture_filter_anisotropic");L&&this.gl.texParameterf(this.gl.TEXTURE_2D,L.TEXTURE_MAX_ANISOTROPY_EXT,this._anisoSamples)}return this._anisoSamples}},wrapS:{get:function(){return this._wrapS},set:function(x){if(this.bind(),c.indexOf(x)<0)throw new Error("gl-texture2d: Unknown wrap mode "+x);return this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,x),this._wrapS=x}},wrapT:{get:function(){return this._wrapT},set:function(x){if(this.bind(),c.indexOf(x)<0)throw new Error("gl-texture2d: Unknown wrap mode "+x);return this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,x),this._wrapT=x}},wrap:{get:function(){return this._wrapVector},set:function(x){if(Array.isArray(x)||(x=[x,x]),x.length!==2)throw new Error("gl-texture2d: Must specify wrap mode for rows and columns");for(var l=0;l<2;++l)if(c.indexOf(x[l])<0)throw new Error("gl-texture2d: Unknown wrap mode "+x);this._wrapS=x[0],this._wrapT=x[1];var L=this.gl;return this.bind(),L.texParameteri(L.TEXTURE_2D,L.TEXTURE_WRAP_S,this._wrapS),L.texParameteri(L.TEXTURE_2D,L.TEXTURE_WRAP_T,this._wrapT),x}},shape:{get:function(){return this._shapeVector},set:function(x){if(!Array.isArray(x))x=[x|0,x|0];else if(x.length!==2)throw new Error("gl-texture2d: Invalid texture shape");return p(this,x[0]|0,x[1]|0),[x[0]|0,x[1]|0]}},width:{get:function(){return this._shape[0]},set:function(x){return x=x|0,p(this,x,this._shape[1]),x}},height:{get:function(){return this._shape[1]},set:function(x){return x=x|0,p(this,this._shape[0],x),x}}}),h.bind=function(x){var l=this.gl;return x!==void 0&&l.activeTexture(l.TEXTURE0+(x|0)),l.bindTexture(l.TEXTURE_2D,this.handle),x!==void 0?x|0:l.getParameter(l.ACTIVE_TEXTURE)-l.TEXTURE0},h.dispose=function(){this.gl.deleteTexture(this.handle)},h.generateMipmap=function(){this.bind(),this.gl.generateMipmap(this.gl.TEXTURE_2D);for(var x=Math.min(this._shape[0],this._shape[1]),l=0;x>0;++l,x>>>=1)this._mipLevels.indexOf(l)<0&&this._mipLevels.push(l)},h.setPixels=function(x,l,L,T){var k=this.gl;this.bind(),Array.isArray(l)?(T=L,L=l[1]|0,l=l[0]|0):(l=l||0,L=L||0),T=T||0;var P=i(x)?x:x.raw;if(P){var z=this._mipLevels.indexOf(T)<0;z?(k.texImage2D(k.TEXTURE_2D,0,this.format,this.format,this.type,P),this._mipLevels.push(T)):k.texSubImage2D(k.TEXTURE_2D,T,l,L,this.format,this.type,P)}else if(x.shape&&x.stride&&x.data){if(x.shape.length<2||l+x.shape[1]>this._shape[1]>>>T||L+x.shape[0]>this._shape[0]>>>T||l<0||L<0)throw new Error("gl-texture2d: Texture dimensions are out of bounds");u(k,l,L,T,this.format,this.type,this._mipLevels,x)}else throw new Error("gl-texture2d: Unsupported data type")};function m(x,l){return x.length===3?l[2]===1&&l[1]===x[0]*x[2]&&l[0]===x[2]:l[0]===1&&l[1]===x[0]}function u(x,l,L,T,k,P,z,I){var D=I.dtype,R=I.shape.slice();if(R.length<2||R.length>3)throw new Error("gl-texture2d: Invalid ndarray, must be 2d or 3d");var B=0,F=0,H=m(R,I.stride.slice());if(D==="float32"?B=x.FLOAT:D==="float64"?(B=x.FLOAT,H=!1,D="float32"):D==="uint8"?B=x.UNSIGNED_BYTE:(B=x.UNSIGNED_BYTE,H=!1,D="uint8"),R.length===2)F=x.LUMINANCE,R=[R[0],R[1],1],I=e(I.data,R,[I.stride[0],I.stride[1],1],I.offset);else if(R.length===3){if(R[2]===1)F=x.ALPHA;else if(R[2]===2)F=x.LUMINANCE_ALPHA;else if(R[2]===3)F=x.RGB;else if(R[2]===4)F=x.RGBA;else throw new Error("gl-texture2d: Invalid shape for pixel coords");R[2]}else throw new Error("gl-texture2d: Invalid shape for texture");if((F===x.LUMINANCE||F===x.ALPHA)&&(k===x.LUMINANCE||k===x.ALPHA)&&(F=k),F!==k)throw new Error("gl-texture2d: Incompatible texture format for setPixels");var G=I.size,J=z.indexOf(T)<0;if(J&&z.push(T),B===P&&H)I.offset===0&&I.data.length===G?J?x.texImage2D(x.TEXTURE_2D,T,k,R[0],R[1],0,k,P,I.data):x.texSubImage2D(x.TEXTURE_2D,T,l,L,R[0],R[1],k,P,I.data):J?x.texImage2D(x.TEXTURE_2D,T,k,R[0],R[1],0,k,P,I.data.subarray(I.offset,I.offset+G)):x.texSubImage2D(x.TEXTURE_2D,T,l,L,R[0],R[1],k,P,I.data.subarray(I.offset,I.offset+G));else{var X;P===x.FLOAT?X=n.mallocFloat32(G):X=n.mallocUint8(G);var Y=e(X,R,[R[2],R[2]*R[0],1]);B===x.FLOAT&&P===x.UNSIGNED_BYTE?y(Y,I):a.assign(Y,I),J?x.texImage2D(x.TEXTURE_2D,T,k,R[0],R[1],0,k,P,X.subarray(0,G)):x.texSubImage2D(x.TEXTURE_2D,T,l,L,R[0],R[1],k,P,X.subarray(0,G)),P===x.FLOAT?n.freeFloat32(X):n.freeUint8(X)}}function _(x){var l=x.createTexture();return x.bindTexture(x.TEXTURE_2D,l),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MIN_FILTER,x.NEAREST),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MAG_FILTER,x.NEAREST),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_S,x.CLAMP_TO_EDGE),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_T,x.CLAMP_TO_EDGE),l}function s(x,l,L,T,k){var P=x.getParameter(x.MAX_TEXTURE_SIZE);if(l<0||l>P||L<0||L>P)throw new Error("gl-texture2d: Invalid texture shape");if(k===x.FLOAT&&!x.getExtension("OES_texture_float"))throw new Error("gl-texture2d: Floating point textures not supported on this platform");var z=_(x);return x.texImage2D(x.TEXTURE_2D,0,T,l,L,0,T,k,null),new g(x,z,l,L,T,k)}function A(x,l,L,T,k,P){var z=_(x);return x.texImage2D(x.TEXTURE_2D,0,k,k,P,l),new g(x,z,L,T,k,P)}function b(x,l){var L=l.dtype,T=l.shape.slice(),k=x.getParameter(x.MAX_TEXTURE_SIZE);if(T[0]<0||T[0]>k||T[1]<0||T[1]>k)throw new Error("gl-texture2d: Invalid texture size");var P=m(T,l.stride.slice()),z=0;L==="float32"?z=x.FLOAT:L==="float64"?(z=x.FLOAT,P=!1,L="float32"):L==="uint8"?z=x.UNSIGNED_BYTE:(z=x.UNSIGNED_BYTE,P=!1,L="uint8");var I=0;if(T.length===2)I=x.LUMINANCE,T=[T[0],T[1],1],l=e(l.data,T,[l.stride[0],l.stride[1],1],l.offset);else if(T.length===3)if(T[2]===1)I=x.ALPHA;else if(T[2]===2)I=x.LUMINANCE_ALPHA;else if(T[2]===3)I=x.RGB;else if(T[2]===4)I=x.RGBA;else throw new Error("gl-texture2d: Invalid shape for pixel coords");else throw new Error("gl-texture2d: Invalid shape for texture");z===x.FLOAT&&!x.getExtension("OES_texture_float")&&(z=x.UNSIGNED_BYTE,P=!1);var D,R,B=l.size;if(P)l.offset===0&&l.data.length===B?D=l.data:D=l.data.subarray(l.offset,l.offset+B);else{var F=[T[2],T[2]*T[0],1];R=n.malloc(B,L);var H=e(R,T,F,0);(L==="float32"||L==="float64")&&z===x.UNSIGNED_BYTE?y(H,l):a.assign(H,l),D=R.subarray(0,B)}var G=_(x);return x.texImage2D(x.TEXTURE_2D,0,I,T[0],T[1],0,I,z,D),P||n.free(R),new g(x,G,T[0],T[1],I,z)}function f(x){if(arguments.length<=1)throw new Error("gl-texture2d: Missing arguments for texture2d constructor");if(r||o(x),typeof arguments[1]=="number")return s(x,arguments[1],arguments[2],arguments[3]||x.RGBA,arguments[4]||x.UNSIGNED_BYTE);if(Array.isArray(arguments[1]))return s(x,arguments[1][0]|0,arguments[1][1]|0,arguments[2]||x.RGBA,arguments[3]||x.UNSIGNED_BYTE);if(typeof arguments[1]=="object"){var l=arguments[1],L=i(l)?l:l.raw;if(L)return A(x,L,l.width|0,l.height|0,arguments[2]||x.RGBA,arguments[3]||x.UNSIGNED_BYTE);if(l.shape&&l.data&&l.stride)return b(x,l)}throw new Error("gl-texture2d: Invalid arguments for texture2d constructor")}},{ndarray:259,"ndarray-ops":254,"typedarray-pool":308}],147:[function(v,S,M){function e(a,n,r){n?n.bind():a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,null);var t=a.getParameter(a.MAX_VERTEX_ATTRIBS)|0;if(r){if(r.length>t)throw new Error("gl-vao: Too many vertex attributes");for(var c=0;c<r.length;++c){var o=r[c];if(o.buffer){var i=o.buffer,y=o.size||4,p=o.type||a.FLOAT,g=!!o.normalized,h=o.stride||0,m=o.offset||0;i.bind(),a.enableVertexAttribArray(c),a.vertexAttribPointer(c,y,p,g,h,m)}else{if(typeof o=="number")a.vertexAttrib1f(c,o);else if(o.length===1)a.vertexAttrib1f(c,o[0]);else if(o.length===2)a.vertexAttrib2f(c,o[0],o[1]);else if(o.length===3)a.vertexAttrib3f(c,o[0],o[1],o[2]);else if(o.length===4)a.vertexAttrib4f(c,o[0],o[1],o[2],o[3]);else throw new Error("gl-vao: Invalid vertex attribute");a.disableVertexAttribArray(c)}}for(;c<t;++c)a.disableVertexAttribArray(c)}else{a.bindBuffer(a.ARRAY_BUFFER,null);for(var c=0;c<t;++c)a.disableVertexAttribArray(c)}}S.exports=e},{}],148:[function(v,S,M){var e=v("./do-bind.js");function a(r){this.gl=r,this._elements=null,this._attributes=null,this._elementsType=r.UNSIGNED_SHORT}a.prototype.bind=function(){e(this.gl,this._elements,this._attributes)},a.prototype.update=function(r,t,c){this._elements=t,this._attributes=r,this._elementsType=c||this.gl.UNSIGNED_SHORT},a.prototype.dispose=function(){},a.prototype.unbind=function(){},a.prototype.draw=function(r,t,c){c=c||0;var o=this.gl;this._elements?o.drawElements(r,t,this._elementsType,c):o.drawArrays(r,c,t)};function n(r){return new a(r)}S.exports=n},{"./do-bind.js":147}],149:[function(v,S,M){var e=v("./do-bind.js");function a(t,c,o,i,y,p){this.location=t,this.dimension=c,this.a=o,this.b=i,this.c=y,this.d=p}a.prototype.bind=function(t){switch(this.dimension){case 1:t.vertexAttrib1f(this.location,this.a);break;case 2:t.vertexAttrib2f(this.location,this.a,this.b);break;case 3:t.vertexAttrib3f(this.location,this.a,this.b,this.c);break;case 4:t.vertexAttrib4f(this.location,this.a,this.b,this.c,this.d);break}};function n(t,c,o){this.gl=t,this._ext=c,this.handle=o,this._attribs=[],this._useElements=!1,this._elementsType=t.UNSIGNED_SHORT}n.prototype.bind=function(){this._ext.bindVertexArrayOES(this.handle);for(var t=0;t<this._attribs.length;++t)this._attribs[t].bind(this.gl)},n.prototype.unbind=function(){this._ext.bindVertexArrayOES(null)},n.prototype.dispose=function(){this._ext.deleteVertexArrayOES(this.handle)},n.prototype.update=function(t,c,o){if(this.bind(),e(this.gl,c,t),this.unbind(),this._attribs.length=0,t)for(var i=0;i<t.length;++i){var y=t[i];typeof y=="number"?this._attribs.push(new a(i,1,y)):Array.isArray(y)&&this._attribs.push(new a(i,y.length,y[0],y[1],y[2],y[3]))}this._useElements=!!c,this._elementsType=o||this.gl.UNSIGNED_SHORT},n.prototype.draw=function(t,c,o){o=o||0;var i=this.gl;this._useElements?i.drawElements(t,c,this._elementsType,o):i.drawArrays(t,o,c)};function r(t,c){return new n(t,c,c.createVertexArrayOES())}S.exports=r},{"./do-bind.js":147}],150:[function(v,S,M){var e=v("./lib/vao-native.js"),a=v("./lib/vao-emulated.js");function n(t){this.bindVertexArrayOES=t.bindVertexArray.bind(t),this.createVertexArrayOES=t.createVertexArray.bind(t),this.deleteVertexArrayOES=t.deleteVertexArray.bind(t)}function r(t,c,o,i){var y=t.createVertexArray?new n(t):t.getExtension("OES_vertex_array_object"),p;return y?p=e(t,y):p=a(t),p.update(c,o,i),p}S.exports=r},{"./lib/vao-emulated.js":148,"./lib/vao-native.js":149}],151:[function(v,S,M){S.exports=e;function e(a,n,r){return a[0]=n[0]+r[0],a[1]=n[1]+r[1],a[2]=n[2]+r[2],a}},{}],152:[function(v,S,M){S.exports=r;var e=v("./fromValues"),a=v("./normalize"),n=v("./dot");function r(t,c){var o=e(t[0],t[1],t[2]),i=e(c[0],c[1],c[2]);a(o,o),a(i,i);var y=n(o,i);return y>1?0:Math.acos(y)}},{"./dot":162,"./fromValues":168,"./normalize":179}],153:[function(v,S,M){S.exports=e;function e(a,n){return a[0]=Math.ceil(n[0]),a[1]=Math.ceil(n[1]),a[2]=Math.ceil(n[2]),a}},{}],154:[function(v,S,M){S.exports=e;function e(a){var n=new Float32Array(3);return n[0]=a[0],n[1]=a[1],n[2]=a[2],n}},{}],155:[function(v,S,M){S.exports=e;function e(a,n){return a[0]=n[0],a[1]=n[1],a[2]=n[2],a}},{}],156:[function(v,S,M){S.exports=e;function e(){var a=new Float32Array(3);return a[0]=0,a[1]=0,a[2]=0,a}},{}],157:[function(v,S,M){S.exports=e;function e(a,n,r){var t=n[0],c=n[1],o=n[2],i=r[0],y=r[1],p=r[2];return a[0]=c*p-o*y,a[1]=o*i-t*p,a[2]=t*y-c*i,a}},{}],158:[function(v,S,M){S.exports=v("./distance")},{"./distance":159}],159:[function(v,S,M){S.exports=e;function e(a,n){var r=n[0]-a[0],t=n[1]-a[1],c=n[2]-a[2];return Math.sqrt(r*r+t*t+c*c)}},{}],160:[function(v,S,M){S.exports=v("./divide")},{"./divide":161}],161:[function(v,S,M){S.exports=e;function e(a,n,r){return a[0]=n[0]/r[0],a[1]=n[1]/r[1],a[2]=n[2]/r[2],a}},{}],162:[function(v,S,M){S.exports=e;function e(a,n){return a[0]*n[0]+a[1]*n[1]+a[2]*n[2]}},{}],163:[function(v,S,M){S.exports=1e-6},{}],164:[function(v,S,M){S.exports=a;var e=v("./epsilon");function a(n,r){var t=n[0],c=n[1],o=n[2],i=r[0],y=r[1],p=r[2];return Math.abs(t-i)<=e*Math.max(1,Math.abs(t),Math.abs(i))&&Math.abs(c-y)<=e*Math.max(1,Math.abs(c),Math.abs(y))&&Math.abs(o-p)<=e*Math.max(1,Math.abs(o),Math.abs(p))}},{"./epsilon":163}],165:[function(v,S,M){S.exports=e;function e(a,n){return a[0]===n[0]&&a[1]===n[1]&&a[2]===n[2]}},{}],166:[function(v,S,M){S.exports=e;function e(a,n){return a[0]=Math.floor(n[0]),a[1]=Math.floor(n[1]),a[2]=Math.floor(n[2]),a}},{}],167:[function(v,S,M){S.exports=a;var e=v("./create")();function a(n,r,t,c,o,i){var y,p;for(r||(r=3),t||(t=0),c?p=Math.min(c*r+t,n.length):p=n.length,y=t;y<p;y+=r)e[0]=n[y],e[1]=n[y+1],e[2]=n[y+2],o(e,e,i),n[y]=e[0],n[y+1]=e[1],n[y+2]=e[2];return n}},{"./create":156}],168:[function(v,S,M){S.exports=e;function e(a,n,r){var t=new Float32Array(3);return t[0]=a,t[1]=n,t[2]=r,t}},{}],169:[function(v,S,M){S.exports={EPSILON:v("./epsilon"),create:v("./create"),clone:v("./clone"),angle:v("./angle"),fromValues:v("./fromValues"),copy:v("./copy"),set:v("./set"),equals:v("./equals"),exactEquals:v("./exactEquals"),add:v("./add"),subtract:v("./subtract"),sub:v("./sub"),multiply:v("./multiply"),mul:v("./mul"),divide:v("./divide"),div:v("./div"),min:v("./min"),max:v("./max"),floor:v("./floor"),ceil:v("./ceil"),round:v("./round"),scale:v("./scale"),scaleAndAdd:v("./scaleAndAdd"),distance:v("./distance"),dist:v("./dist"),squaredDistance:v("./squaredDistance"),sqrDist:v("./sqrDist"),length:v("./length"),len:v("./len"),squaredLength:v("./squaredLength"),sqrLen:v("./sqrLen"),negate:v("./negate"),inverse:v("./inverse"),normalize:v("./normalize"),dot:v("./dot"),cross:v("./cross"),lerp:v("./lerp"),random:v("./random"),transformMat4:v("./transformMat4"),transformMat3:v("./transformMat3"),transformQuat:v("./transformQuat"),rotateX:v("./rotateX"),rotateY:v("./rotateY"),rotateZ:v("./rotateZ"),forEach:v("./forEach")}},{"./add":151,"./angle":152,"./ceil":153,"./clone":154,"./copy":155,"./create":156,"./cross":157,"./dist":158,"./distance":159,"./div":160,"./divide":161,"./dot":162,"./epsilon":163,"./equals":164,"./exactEquals":165,"./floor":166,"./forEach":167,"./fromValues":168,"./inverse":170,"./len":171,"./length":172,"./lerp":173,"./max":174,"./min":175,"./mul":176,"./multiply":177,"./negate":178,"./normalize":179,"./random":180,"./rotateX":181,"./rotateY":182,"./rotateZ":183,"./round":184,"./scale":185,"./scaleAndAdd":186,"./set":187,"./sqrDist":188,"./sqrLen":189,"./squaredDistance":190,"./squaredLength":191,"./sub":192,"./subtract":193,"./transformMat3":194,"./transformMat4":195,"./transformQuat":196}],170:[function(v,S,M){S.exports=e;function e(a,n){return a[0]=1/n[0],a[1]=1/n[1],a[2]=1/n[2],a}},{}],171:[function(v,S,M){S.exports=v("./length")},{"./length":172}],172:[function(v,S,M){S.exports=e;function e(a){var n=a[0],r=a[1],t=a[2];return Math.sqrt(n*n+r*r+t*t)}},{}],173:[function(v,S,M){S.exports=e;function e(a,n,r,t){var c=n[0],o=n[1],i=n[2];return a[0]=c+t*(r[0]-c),a[1]=o+t*(r[1]-o),a[2]=i+t*(r[2]-i),a}},{}],174:[function(v,S,M){S.exports=e;function e(a,n,r){return a[0]=Math.max(n[0],r[0]),a[1]=Math.max(n[1],r[1]),a[2]=Math.max(n[2],r[2]),a}},{}],175:[function(v,S,M){S.exports=e;function e(a,n,r){return a[0]=Math.min(n[0],r[0]),a[1]=Math.min(n[1],r[1]),a[2]=Math.min(n[2],r[2]),a}},{}],176:[function(v,S,M){S.exports=v("./multiply")},{"./multiply":177}],177:[function(v,S,M){S.exports=e;function e(a,n,r){return a[0]=n[0]*r[0],a[1]=n[1]*r[1],a[2]=n[2]*r[2],a}},{}],178:[function(v,S,M){S.exports=e;function e(a,n){return a[0]=-n[0],a[1]=-n[1],a[2]=-n[2],a}},{}],179:[function(v,S,M){S.exports=e;function e(a,n){var r=n[0],t=n[1],c=n[2],o=r*r+t*t+c*c;return o>0&&(o=1/Math.sqrt(o),a[0]=n[0]*o,a[1]=n[1]*o,a[2]=n[2]*o),a}},{}],180:[function(v,S,M){S.exports=e;function e(a,n){n=n||1;var r=Math.random()*2*Math.PI,t=Math.random()*2-1,c=Math.sqrt(1-t*t)*n;return a[0]=Math.cos(r)*c,a[1]=Math.sin(r)*c,a[2]=t*n,a}},{}],181:[function(v,S,M){S.exports=e;function e(a,n,r,t){var c=r[1],o=r[2],i=n[1]-c,y=n[2]-o,p=Math.sin(t),g=Math.cos(t);return a[0]=n[0],a[1]=c+i*g-y*p,a[2]=o+i*p+y*g,a}},{}],182:[function(v,S,M){S.exports=e;function e(a,n,r,t){var c=r[0],o=r[2],i=n[0]-c,y=n[2]-o,p=Math.sin(t),g=Math.cos(t);return a[0]=c+y*p+i*g,a[1]=n[1],a[2]=o+y*g-i*p,a}},{}],183:[function(v,S,M){S.exports=e;function e(a,n,r,t){var c=r[0],o=r[1],i=n[0]-c,y=n[1]-o,p=Math.sin(t),g=Math.cos(t);return a[0]=c+i*g-y*p,a[1]=o+i*p+y*g,a[2]=n[2],a}},{}],184:[function(v,S,M){S.exports=e;function e(a,n){return a[0]=Math.round(n[0]),a[1]=Math.round(n[1]),a[2]=Math.round(n[2]),a}},{}],185:[function(v,S,M){S.exports=e;function e(a,n,r){return a[0]=n[0]*r,a[1]=n[1]*r,a[2]=n[2]*r,a}},{}],186:[function(v,S,M){S.exports=e;function e(a,n,r,t){return a[0]=n[0]+r[0]*t,a[1]=n[1]+r[1]*t,a[2]=n[2]+r[2]*t,a}},{}],187:[function(v,S,M){S.exports=e;function e(a,n,r,t){return a[0]=n,a[1]=r,a[2]=t,a}},{}],188:[function(v,S,M){S.exports=v("./squaredDistance")},{"./squaredDistance":190}],189:[function(v,S,M){S.exports=v("./squaredLength")},{"./squaredLength":191}],190:[function(v,S,M){S.exports=e;function e(a,n){var r=n[0]-a[0],t=n[1]-a[1],c=n[2]-a[2];return r*r+t*t+c*c}},{}],191:[function(v,S,M){S.exports=e;function e(a){var n=a[0],r=a[1],t=a[2];return n*n+r*r+t*t}},{}],192:[function(v,S,M){S.exports=v("./subtract")},{"./subtract":193}],193:[function(v,S,M){S.exports=e;function e(a,n,r){return a[0]=n[0]-r[0],a[1]=n[1]-r[1],a[2]=n[2]-r[2],a}},{}],194:[function(v,S,M){S.exports=e;function e(a,n,r){var t=n[0],c=n[1],o=n[2];return a[0]=t*r[0]+c*r[3]+o*r[6],a[1]=t*r[1]+c*r[4]+o*r[7],a[2]=t*r[2]+c*r[5]+o*r[8],a}},{}],195:[function(v,S,M){S.exports=e;function e(a,n,r){var t=n[0],c=n[1],o=n[2],i=r[3]*t+r[7]*c+r[11]*o+r[15];return i=i||1,a[0]=(r[0]*t+r[4]*c+r[8]*o+r[12])/i,a[1]=(r[1]*t+r[5]*c+r[9]*o+r[13])/i,a[2]=(r[2]*t+r[6]*c+r[10]*o+r[14])/i,a}},{}],196:[function(v,S,M){S.exports=e;function e(a,n,r){var t=n[0],c=n[1],o=n[2],i=r[0],y=r[1],p=r[2],g=r[3],h=g*t+y*o-p*c,m=g*c+p*t-i*o,u=g*o+i*c-y*t,_=-i*t-y*c-p*o;return a[0]=h*g+_*-i+m*-p-u*-y,a[1]=m*g+_*-y+u*-i-h*-p,a[2]=u*g+_*-p+h*-y-m*-i,a}},{}],197:[function(v,S,M){S.exports=e;function e(a,n,r){return a[0]=n[0]+r[0],a[1]=n[1]+r[1],a[2]=n[2]+r[2],a[3]=n[3]+r[3],a}},{}],198:[function(v,S,M){S.exports=e;function e(a){var n=new Float32Array(4);return n[0]=a[0],n[1]=a[1],n[2]=a[2],n[3]=a[3],n}},{}],199:[function(v,S,M){S.exports=e;function e(a,n){return a[0]=n[0],a[1]=n[1],a[2]=n[2],a[3]=n[3],a}},{}],200:[function(v,S,M){S.exports=e;function e(){var a=new Float32Array(4);return a[0]=0,a[1]=0,a[2]=0,a[3]=0,a}},{}],201:[function(v,S,M){S.exports=e;function e(a,n){var r=n[0]-a[0],t=n[1]-a[1],c=n[2]-a[2],o=n[3]-a[3];return Math.sqrt(r*r+t*t+c*c+o*o)}},{}],202:[function(v,S,M){S.exports=e;function e(a,n,r){return a[0]=n[0]/r[0],a[1]=n[1]/r[1],a[2]=n[2]/r[2],a[3]=n[3]/r[3],a}},{}],203:[function(v,S,M){S.exports=e;function e(a,n){return a[0]*n[0]+a[1]*n[1]+a[2]*n[2]+a[3]*n[3]}},{}],204:[function(v,S,M){S.exports=e;function e(a,n,r,t){var c=new Float32Array(4);return c[0]=a,c[1]=n,c[2]=r,c[3]=t,c}},{}],205:[function(v,S,M){S.exports={create:v("./create"),clone:v("./clone"),fromValues:v("./fromValues"),copy:v("./copy"),set:v("./set"),add:v("./add"),subtract:v("./subtract"),multiply:v("./multiply"),divide:v("./divide"),min:v("./min"),max:v("./max"),scale:v("./scale"),scaleAndAdd:v("./scaleAndAdd"),distance:v("./distance"),squaredDistance:v("./squaredDistance"),length:v("./length"),squaredLength:v("./squaredLength"),negate:v("./negate"),inverse:v("./inverse"),normalize:v("./normalize"),dot:v("./dot"),lerp:v("./lerp"),random:v("./random"),transformMat4:v("./transformMat4"),transformQuat:v("./transformQuat")}},{"./add":197,"./clone":198,"./copy":199,"./create":200,"./distance":201,"./divide":202,"./dot":203,"./fromValues":204,"./inverse":206,"./length":207,"./lerp":208,"./max":209,"./min":210,"./multiply":211,"./negate":212,"./normalize":213,"./random":214,"./scale":215,"./scaleAndAdd":216,"./set":217,"./squaredDistance":218,"./squaredLength":219,"./subtract":220,"./transformMat4":221,"./transformQuat":222}],206:[function(v,S,M){S.exports=e;function e(a,n){return a[0]=1/n[0],a[1]=1/n[1],a[2]=1/n[2],a[3]=1/n[3],a}},{}],207:[function(v,S,M){S.exports=e;function e(a){var n=a[0],r=a[1],t=a[2],c=a[3];return Math.sqrt(n*n+r*r+t*t+c*c)}},{}],208:[function(v,S,M){S.exports=e;function e(a,n,r,t){var c=n[0],o=n[1],i=n[2],y=n[3];return a[0]=c+t*(r[0]-c),a[1]=o+t*(r[1]-o),a[2]=i+t*(r[2]-i),a[3]=y+t*(r[3]-y),a}},{}],209:[function(v,S,M){S.exports=e;function e(a,n,r){return a[0]=Math.max(n[0],r[0]),a[1]=Math.max(n[1],r[1]),a[2]=Math.max(n[2],r[2]),a[3]=Math.max(n[3],r[3]),a}},{}],210:[function(v,S,M){S.exports=e;function e(a,n,r){return a[0]=Math.min(n[0],r[0]),a[1]=Math.min(n[1],r[1]),a[2]=Math.min(n[2],r[2]),a[3]=Math.min(n[3],r[3]),a}},{}],211:[function(v,S,M){S.exports=e;function e(a,n,r){return a[0]=n[0]*r[0],a[1]=n[1]*r[1],a[2]=n[2]*r[2],a[3]=n[3]*r[3],a}},{}],212:[function(v,S,M){S.exports=e;function e(a,n){return a[0]=-n[0],a[1]=-n[1],a[2]=-n[2],a[3]=-n[3],a}},{}],213:[function(v,S,M){S.exports=e;function e(a,n){var r=n[0],t=n[1],c=n[2],o=n[3],i=r*r+t*t+c*c+o*o;return i>0&&(i=1/Math.sqrt(i),a[0]=r*i,a[1]=t*i,a[2]=c*i,a[3]=o*i),a}},{}],214:[function(v,S,M){var e=v("./normalize"),a=v("./scale");S.exports=n;function n(r,t){return t=t||1,r[0]=Math.random(),r[1]=Math.random(),r[2]=Math.random(),r[3]=Math.random(),e(r,r),a(r,r,t),r}},{"./normalize":213,"./scale":215}],215:[function(v,S,M){S.exports=e;function e(a,n,r){return a[0]=n[0]*r,a[1]=n[1]*r,a[2]=n[2]*r,a[3]=n[3]*r,a}},{}],216:[function(v,S,M){S.exports=e;function e(a,n,r,t){return a[0]=n[0]+r[0]*t,a[1]=n[1]+r[1]*t,a[2]=n[2]+r[2]*t,a[3]=n[3]+r[3]*t,a}},{}],217:[function(v,S,M){S.exports=e;function e(a,n,r,t,c){return a[0]=n,a[1]=r,a[2]=t,a[3]=c,a}},{}],218:[function(v,S,M){S.exports=e;function e(a,n){var r=n[0]-a[0],t=n[1]-a[1],c=n[2]-a[2],o=n[3]-a[3];return r*r+t*t+c*c+o*o}},{}],219:[function(v,S,M){S.exports=e;function e(a){var n=a[0],r=a[1],t=a[2],c=a[3];return n*n+r*r+t*t+c*c}},{}],220:[function(v,S,M){S.exports=e;function e(a,n,r){return a[0]=n[0]-r[0],a[1]=n[1]-r[1],a[2]=n[2]-r[2],a[3]=n[3]-r[3],a}},{}],221:[function(v,S,M){S.exports=e;function e(a,n,r){var t=n[0],c=n[1],o=n[2],i=n[3];return a[0]=r[0]*t+r[4]*c+r[8]*o+r[12]*i,a[1]=r[1]*t+r[5]*c+r[9]*o+r[13]*i,a[2]=r[2]*t+r[6]*c+r[10]*o+r[14]*i,a[3]=r[3]*t+r[7]*c+r[11]*o+r[15]*i,a}},{}],222:[function(v,S,M){S.exports=e;function e(a,n,r){var t=n[0],c=n[1],o=n[2],i=r[0],y=r[1],p=r[2],g=r[3],h=g*t+y*o-p*c,m=g*c+p*t-i*o,u=g*o+i*c-y*t,_=-i*t-y*c-p*o;return a[0]=h*g+_*-i+m*-p-u*-y,a[1]=m*g+_*-y+u*-i-h*-p,a[2]=u*g+_*-p+h*-y-m*-i,a[3]=n[3],a}},{}],223:[function(v,S,M){var e=v("glsl-tokenizer"),a=v("atob-lite");S.exports=n;function n(r){for(var t=Array.isArray(r)?r:e(r),c=0;c<t.length;c++){var o=t[c];if(o.type==="preprocessor"){var i=o.data.match(/\#define\s+SHADER_NAME(_B64)?\s+(.+)$/);if(!!i&&!!i[2]){var y=i[1],p=i[2];return(y?a(p):p).trim()}}}}},{"atob-lite":13,"glsl-tokenizer":230}],224:[function(v,S,M){S.exports=l;var e=v("./lib/literals"),a=v("./lib/operators"),n=v("./lib/builtins"),r=v("./lib/literals-300es"),t=v("./lib/builtins-300es"),c=999,o=9999,i=0,y=1,p=2,g=3,h=4,m=5,u=6,_=7,s=8,A=9,b=10,f=11,x=["block-comment","line-comment","preprocessor","operator","integer","float","ident","builtin","keyword","whitespace","eof","integer"];function l(L){var T=0,k=0,P=c,z,I,D=[],R=[],B=1,F=0,H=0,G=!1,J=!1,X="",Y;L=L||{};var Z=n,oe=e;L.version==="300 es"&&(Z=t,oe=r);for(var re={},se={},T=0;T<Z.length;T++)re[Z[T]]=!0;for(var T=0;T<oe.length;T++)se[oe[T]]=!0;return function(Te){return R=[],Te!==null?U(Te):q()};function N(Te){Te.length&&R.push({type:x[P],data:Te,position:H,line:B,column:F})}function U(Te){T=0,Te.toString&&(Te=Te.toString()),X+=Te.replace(/\r\n/g,`
`),Y=X.length;for(var _e;z=X[T],T<Y;){switch(_e=T,P){case i:T=ae();break;case y:T=ne();break;case p:T=K();break;case g:T=ie();break;case h:T=ue();break;case f:T=ye();break;case m:T=pe();break;case o:T=ge();break;case A:T=W();break;case c:T=$();break}if(_e!==T)switch(X[_e]){case`
`:F=0,++B;break;default:++F;break}}return k+=T,X=X.slice(T),R}function q(Te){return D.length&&N(D.join("")),P=b,N("(eof)"),R}function $(){return D=D.length?[]:D,I==="/"&&z==="*"?(H=k+T-1,P=i,I=z,T+1):I==="/"&&z==="/"?(H=k+T-1,P=y,I=z,T+1):z==="#"?(P=p,H=k+T,T):/\s/.test(z)?(P=A,H=k+T,T):(G=/\d/.test(z),J=/[^\w_]/.test(z),H=k+T,P=G?h:J?g:o,T)}function W(){return/[^\s]/g.test(z)?(N(D.join("")),P=c,T):(D.push(z),I=z,T+1)}function K(){return(z==="\r"||z===`
`)&&I!=="\\"?(N(D.join("")),P=c,T):(D.push(z),I=z,T+1)}function ne(){return K()}function ae(){return z==="/"&&I==="*"?(D.push(z),N(D.join("")),P=c,T+1):(D.push(z),I=z,T+1)}function ie(){if(I==="."&&/\d/.test(z))return P=m,T;if(I==="/"&&z==="*")return P=i,T;if(I==="/"&&z==="/")return P=y,T;if(z==="."&&D.length){for(;le(D););return P=m,T}if(z===";"||z===")"||z==="("){if(D.length)for(;le(D););return N(z),P=c,T+1}var Te=D.length===2&&z!=="=";if(/[\w_\d\s]/.test(z)||Te){for(;le(D););return P=c,T}return D.push(z),I=z,T+1}function le(Te){var _e=0,ze,Oe;do{if(ze=a.indexOf(Te.slice(0,Te.length+_e).join("")),Oe=a[ze],ze===-1){if(_e--+Te.length>0)continue;Oe=Te.slice(0,1).join("")}return N(Oe),H+=Oe.length,D=D.slice(Oe.length),D.length}while(1)}function ye(){return/[^a-fA-F0-9]/.test(z)?(N(D.join("")),P=c,T):(D.push(z),I=z,T+1)}function ue(){return z==="."||/[eE]/.test(z)?(D.push(z),P=m,I=z,T+1):z==="x"&&D.length===1&&D[0]==="0"?(P=f,D.push(z),I=z,T+1):/[^\d]/.test(z)?(N(D.join("")),P=c,T):(D.push(z),I=z,T+1)}function pe(){return z==="f"&&(D.push(z),I=z,T+=1),/[eE]/.test(z)||(z==="-"||z==="+")&&/[eE]/.test(I)?(D.push(z),I=z,T+1):/[^\d]/.test(z)?(N(D.join("")),P=c,T):(D.push(z),I=z,T+1)}function ge(){if(/[^\d\w_]/.test(z)){var Te=D.join("");return se[Te]?P=s:re[Te]?P=_:P=u,N(D.join("")),P=c,T}return D.push(z),I=z,T+1}}},{"./lib/builtins":226,"./lib/builtins-300es":225,"./lib/literals":228,"./lib/literals-300es":227,"./lib/operators":229}],225:[function(v,S,M){var e=v("./builtins");e=e.slice().filter(function(a){return!/^(gl\_|texture)/.test(a)}),S.exports=e.concat(["gl_VertexID","gl_InstanceID","gl_Position","gl_PointSize","gl_FragCoord","gl_FrontFacing","gl_FragDepth","gl_PointCoord","gl_MaxVertexAttribs","gl_MaxVertexUniformVectors","gl_MaxVertexOutputVectors","gl_MaxFragmentInputVectors","gl_MaxVertexTextureImageUnits","gl_MaxCombinedTextureImageUnits","gl_MaxTextureImageUnits","gl_MaxFragmentUniformVectors","gl_MaxDrawBuffers","gl_MinProgramTexelOffset","gl_MaxProgramTexelOffset","gl_DepthRangeParameters","gl_DepthRange","trunc","round","roundEven","isnan","isinf","floatBitsToInt","floatBitsToUint","intBitsToFloat","uintBitsToFloat","packSnorm2x16","unpackSnorm2x16","packUnorm2x16","unpackUnorm2x16","packHalf2x16","unpackHalf2x16","outerProduct","transpose","determinant","inverse","texture","textureSize","textureProj","textureLod","textureOffset","texelFetch","texelFetchOffset","textureProjOffset","textureLodOffset","textureProjLod","textureProjLodOffset","textureGrad","textureGradOffset","textureProjGrad","textureProjGradOffset"])},{"./builtins":226}],226:[function(v,S,M){S.exports=["abs","acos","all","any","asin","atan","ceil","clamp","cos","cross","dFdx","dFdy","degrees","distance","dot","equal","exp","exp2","faceforward","floor","fract","gl_BackColor","gl_BackLightModelProduct","gl_BackLightProduct","gl_BackMaterial","gl_BackSecondaryColor","gl_ClipPlane","gl_ClipVertex","gl_Color","gl_DepthRange","gl_DepthRangeParameters","gl_EyePlaneQ","gl_EyePlaneR","gl_EyePlaneS","gl_EyePlaneT","gl_Fog","gl_FogCoord","gl_FogFragCoord","gl_FogParameters","gl_FragColor","gl_FragCoord","gl_FragData","gl_FragDepth","gl_FragDepthEXT","gl_FrontColor","gl_FrontFacing","gl_FrontLightModelProduct","gl_FrontLightProduct","gl_FrontMaterial","gl_FrontSecondaryColor","gl_LightModel","gl_LightModelParameters","gl_LightModelProducts","gl_LightProducts","gl_LightSource","gl_LightSourceParameters","gl_MaterialParameters","gl_MaxClipPlanes","gl_MaxCombinedTextureImageUnits","gl_MaxDrawBuffers","gl_MaxFragmentUniformComponents","gl_MaxLights","gl_MaxTextureCoords","gl_MaxTextureImageUnits","gl_MaxTextureUnits","gl_MaxVaryingFloats","gl_MaxVertexAttribs","gl_MaxVertexTextureImageUnits","gl_MaxVertexUniformComponents","gl_ModelViewMatrix","gl_ModelViewMatrixInverse","gl_ModelViewMatrixInverseTranspose","gl_ModelViewMatrixTranspose","gl_ModelViewProjectionMatrix","gl_ModelViewProjectionMatrixInverse","gl_ModelViewProjectionMatrixInverseTranspose","gl_ModelViewProjectionMatrixTranspose","gl_MultiTexCoord0","gl_MultiTexCoord1","gl_MultiTexCoord2","gl_MultiTexCoord3","gl_MultiTexCoord4","gl_MultiTexCoord5","gl_MultiTexCoord6","gl_MultiTexCoord7","gl_Normal","gl_NormalMatrix","gl_NormalScale","gl_ObjectPlaneQ","gl_ObjectPlaneR","gl_ObjectPlaneS","gl_ObjectPlaneT","gl_Point","gl_PointCoord","gl_PointParameters","gl_PointSize","gl_Position","gl_ProjectionMatrix","gl_ProjectionMatrixInverse","gl_ProjectionMatrixInverseTranspose","gl_ProjectionMatrixTranspose","gl_SecondaryColor","gl_TexCoord","gl_TextureEnvColor","gl_TextureMatrix","gl_TextureMatrixInverse","gl_TextureMatrixInverseTranspose","gl_TextureMatrixTranspose","gl_Vertex","greaterThan","greaterThanEqual","inversesqrt","length","lessThan","lessThanEqual","log","log2","matrixCompMult","max","min","mix","mod","normalize","not","notEqual","pow","radians","reflect","refract","sign","sin","smoothstep","sqrt","step","tan","texture2D","texture2DLod","texture2DProj","texture2DProjLod","textureCube","textureCubeLod","texture2DLodEXT","texture2DProjLodEXT","textureCubeLodEXT","texture2DGradEXT","texture2DProjGradEXT","textureCubeGradEXT"]},{}],227:[function(v,S,M){var e=v("./literals");S.exports=e.slice().concat(["layout","centroid","smooth","case","mat2x2","mat2x3","mat2x4","mat3x2","mat3x3","mat3x4","mat4x2","mat4x3","mat4x4","uvec2","uvec3","uvec4","samplerCubeShadow","sampler2DArray","sampler2DArrayShadow","isampler2D","isampler3D","isamplerCube","isampler2DArray","usampler2D","usampler3D","usamplerCube","usampler2DArray","coherent","restrict","readonly","writeonly","resource","atomic_uint","noperspective","patch","sample","subroutine","common","partition","active","filter","image1D","image2D","image3D","imageCube","iimage1D","iimage2D","iimage3D","iimageCube","uimage1D","uimage2D","uimage3D","uimageCube","image1DArray","image2DArray","iimage1DArray","iimage2DArray","uimage1DArray","uimage2DArray","image1DShadow","image2DShadow","image1DArrayShadow","image2DArrayShadow","imageBuffer","iimageBuffer","uimageBuffer","sampler1DArray","sampler1DArrayShadow","isampler1D","isampler1DArray","usampler1D","usampler1DArray","isampler2DRect","usampler2DRect","samplerBuffer","isamplerBuffer","usamplerBuffer","sampler2DMS","isampler2DMS","usampler2DMS","sampler2DMSArray","isampler2DMSArray","usampler2DMSArray"])},{"./literals":228}],228:[function(v,S,M){S.exports=["precision","highp","mediump","lowp","attribute","const","uniform","varying","break","continue","do","for","while","if","else","in","out","inout","float","int","uint","void","bool","true","false","discard","return","mat2","mat3","mat4","vec2","vec3","vec4","ivec2","ivec3","ivec4","bvec2","bvec3","bvec4","sampler1D","sampler2D","sampler3D","samplerCube","sampler1DShadow","sampler2DShadow","struct","asm","class","union","enum","typedef","template","this","packed","goto","switch","default","inline","noinline","volatile","public","static","extern","external","interface","long","short","double","half","fixed","unsigned","input","output","hvec2","hvec3","hvec4","dvec2","dvec3","dvec4","fvec2","fvec3","fvec4","sampler2DRect","sampler3DRect","sampler2DRectShadow","sizeof","cast","namespace","using"]},{}],229:[function(v,S,M){S.exports=["<<=",">>=","++","--","<<",">>","<=",">=","==","!=","&&","||","+=","-=","*=","/=","%=","&=","^^","^=","|=","(",")","[","]",".","!","~","*","/","%","+","-","<",">","&","^","|","?",":","=",",",";","{","}"]},{}],230:[function(v,S,M){var e=v("./index");S.exports=a;function a(n,r){var t=e(r),c=[];return c=c.concat(t(n)),c=c.concat(t(null)),c}},{"./index":224}],231:[function(v,S,M){S.exports=function(e){typeof e=="string"&&(e=[e]);for(var a=[].slice.call(arguments,1),n=[],r=0;r<e.length-1;r++)n.push(e[r],a[r]||"");return n.push(e[r]),n.join("")}},{}],232:[function(v,S,M){var e=v("is-browser");function a(){var n=!1;try{var r=Object.defineProperty({},"passive",{get:function(){n=!0}});window.addEventListener("test",null,r),window.removeEventListener("test",null,r)}catch{n=!1}return n}S.exports=e&&a()},{"is-browser":236}],233:[function(v,S,M){S.exports=g;var e=v("robust-orientation"),a=v("simplicial-complex").compareCells;function n(h,m,u){this.vertices=h,this.adjacent=m,this.boundary=u,this.lastVisited=-1}n.prototype.flip=function(){var h=this.vertices[0];this.vertices[0]=this.vertices[1],this.vertices[1]=h;var m=this.adjacent[0];this.adjacent[0]=this.adjacent[1],this.adjacent[1]=m};function r(h,m,u){this.vertices=h,this.cell=m,this.index=u}function t(h,m){return a(h.vertices,m.vertices)}function c(h){return function(){var m=this.tuple;return h.apply(this,m)}}function o(h){var m=e[h+1];return m||(m=e),c(m)}var i=[];function y(h,m,u){this.dimension=h,this.vertices=m,this.simplices=u,this.interior=u.filter(function(A){return!A.boundary}),this.tuple=new Array(h+1);for(var _=0;_<=h;++_)this.tuple[_]=this.vertices[_];var s=i[h];s||(s=i[h]=o(h)),this.orient=s}var p=y.prototype;p.handleBoundaryDegeneracy=function(h,m){var u=this.dimension,_=this.vertices.length-1,s=this.tuple,A=this.vertices,b=[h];for(h.lastVisited=-_;b.length>0;){h=b.pop();for(var f=h.adjacent,x=0;x<=u;++x){var l=f[x];if(!(!l.boundary||l.lastVisited<=-_)){for(var L=l.vertices,T=0;T<=u;++T){var k=L[T];k<0?s[T]=m:s[T]=A[k]}var P=this.orient();if(P>0)return l;l.lastVisited=-_,P===0&&b.push(l)}}}return null},p.walk=function(h,m){var u=this.vertices.length-1,_=this.dimension,s=this.vertices,A=this.tuple,b=m?this.interior.length*Math.random()|0:this.interior.length-1,f=this.interior[b];e:for(;!f.boundary;){for(var x=f.vertices,l=f.adjacent,L=0;L<=_;++L)A[L]=s[x[L]];f.lastVisited=u;for(var L=0;L<=_;++L){var T=l[L];if(!(T.lastVisited>=u)){var k=A[L];A[L]=h;var P=this.orient();if(A[L]=k,P<0){f=T;continue e}else T.boundary?T.lastVisited=-u:T.lastVisited=u}}return}return f},p.addPeaks=function(h,m){var u=this.vertices.length-1,_=this.dimension,s=this.vertices,A=this.tuple,b=this.interior,f=this.simplices,x=[m];m.lastVisited=u,m.vertices[m.vertices.indexOf(-1)]=u,m.boundary=!1,b.push(m);for(var l=[];x.length>0;){var m=x.pop(),L=m.vertices,T=m.adjacent,k=L.indexOf(u);if(!(k<0)){for(var P=0;P<=_;++P)if(P!==k){var z=T[P];if(!(!z.boundary||z.lastVisited>=u)){var I=z.vertices;if(z.lastVisited!==-u){for(var D=0,R=0;R<=_;++R)I[R]<0?(D=R,A[R]=h):A[R]=s[I[R]];var B=this.orient();if(B>0){I[D]=u,z.boundary=!1,b.push(z),x.push(z),z.lastVisited=u;continue}else z.lastVisited=-u}var F=z.adjacent,H=L.slice(),G=T.slice(),J=new n(H,G,!0);f.push(J);var X=F.indexOf(m);if(!(X<0)){F[X]=J,G[k]=z,H[P]=-1,G[P]=m,T[P]=J,J.flip();for(var R=0;R<=_;++R){var Y=H[R];if(!(Y<0||Y===u)){for(var Z=new Array(_-1),oe=0,re=0;re<=_;++re){var se=H[re];se<0||re===R||(Z[oe++]=se)}l.push(new r(Z,J,R))}}}}}}}l.sort(t);for(var P=0;P+1<l.length;P+=2){var N=l[P],U=l[P+1],q=N.index,$=U.index;q<0||$<0||(N.cell.adjacent[N.index]=U.cell,U.cell.adjacent[U.index]=N.cell)}},p.insert=function(h,m){var u=this.vertices;u.push(h);var _=this.walk(h,m);if(!!_){for(var s=this.dimension,A=this.tuple,b=0;b<=s;++b){var f=_.vertices[b];f<0?A[b]=h:A[b]=u[f]}var x=this.orient(A);x<0||x===0&&(_=this.handleBoundaryDegeneracy(_,h),!_)||this.addPeaks(h,_)}},p.boundary=function(){for(var h=this.dimension,m=[],u=this.simplices,_=u.length,s=0;s<_;++s){var A=u[s];if(A.boundary){for(var b=new Array(h),f=A.vertices,x=0,l=0,L=0;L<=h;++L)f[L]>=0?b[x++]=f[L]:l=L&1;if(l===(h&1)){var T=b[0];b[0]=b[1],b[1]=T}m.push(b)}}return m};function g(h,m){var u=h.length;if(u===0)throw new Error("Must have at least d+1 points");var _=h[0].length;if(u<=_)throw new Error("Must input at least d+1 points");var s=h.slice(0,_+1),A=e.apply(void 0,s);if(A===0)throw new Error("Input not in general position");for(var b=new Array(_+1),f=0;f<=_;++f)b[f]=f;A<0&&(b[0]=1,b[1]=0);for(var x=new n(b,new Array(_+1),!1),l=x.adjacent,L=new Array(_+2),f=0;f<=_;++f){for(var T=b.slice(),k=0;k<=_;++k)k===f&&(T[k]=-1);var P=T[0];T[0]=T[1],T[1]=P;var z=new n(T,new Array(_+1),!0);l[f]=z,L[f]=z}L[_+1]=x;for(var f=0;f<=_;++f)for(var T=l[f].vertices,I=l[f].adjacent,k=0;k<=_;++k){var D=T[k];if(D<0){I[k]=x;continue}for(var R=0;R<=_;++R)l[R].vertices.indexOf(D)<0&&(I[k]=l[R])}for(var B=new y(_,s,L),F=!!m,f=_+1;f<u;++f)B.insert(h[f],F);return B.boundary()}},{"robust-orientation":284,"simplicial-complex":293}],234:[function(v,S,M){var e=v("binary-search-bounds"),a=0,n=1,r=2;S.exports=x;function t(l,L,T,k,P){this.mid=l,this.left=L,this.right=T,this.leftPoints=k,this.rightPoints=P,this.count=(L?L.count:0)+(T?T.count:0)+k.length}var c=t.prototype;function o(l,L){l.mid=L.mid,l.left=L.left,l.right=L.right,l.leftPoints=L.leftPoints,l.rightPoints=L.rightPoints,l.count=L.count}function i(l,L){var T=A(L);l.mid=T.mid,l.left=T.left,l.right=T.right,l.leftPoints=T.leftPoints,l.rightPoints=T.rightPoints,l.count=T.count}function y(l,L){var T=l.intervals([]);T.push(L),i(l,T)}function p(l,L){var T=l.intervals([]),k=T.indexOf(L);return k<0?a:(T.splice(k,1),i(l,T),n)}c.intervals=function(l){return l.push.apply(l,this.leftPoints),this.left&&this.left.intervals(l),this.right&&this.right.intervals(l),l},c.insert=function(l){var L=this.count-this.leftPoints.length;if(this.count+=1,l[1]<this.mid)this.left?4*(this.left.count+1)>3*(L+1)?y(this,l):this.left.insert(l):this.left=A([l]);else if(l[0]>this.mid)this.right?4*(this.right.count+1)>3*(L+1)?y(this,l):this.right.insert(l):this.right=A([l]);else{var T=e.ge(this.leftPoints,l,_),k=e.ge(this.rightPoints,l,s);this.leftPoints.splice(T,0,l),this.rightPoints.splice(k,0,l)}},c.remove=function(l){var L=this.count-this.leftPoints;if(l[1]<this.mid){if(!this.left)return a;var T=this.right?this.right.count:0;if(4*T>3*(L-1))return p(this,l);var k=this.left.remove(l);return k===r?(this.left=null,this.count-=1,n):(k===n&&(this.count-=1),k)}else if(l[0]>this.mid){if(!this.right)return a;var P=this.left?this.left.count:0;if(4*P>3*(L-1))return p(this,l);var k=this.right.remove(l);return k===r?(this.right=null,this.count-=1,n):(k===n&&(this.count-=1),k)}else{if(this.count===1)return this.leftPoints[0]===l?r:a;if(this.leftPoints.length===1&&this.leftPoints[0]===l){if(this.left&&this.right){for(var z=this,I=this.left;I.right;)z=I,I=I.right;if(z===this)I.right=this.right;else{var D=this.left,k=this.right;z.count-=I.count,z.right=I.left,I.left=D,I.right=k}o(this,I),this.count=(this.left?this.left.count:0)+(this.right?this.right.count:0)+this.leftPoints.length}else this.left?o(this,this.left):o(this,this.right);return n}for(var D=e.ge(this.leftPoints,l,_);D<this.leftPoints.length&&this.leftPoints[D][0]===l[0];++D)if(this.leftPoints[D]===l){this.count-=1,this.leftPoints.splice(D,1);for(var k=e.ge(this.rightPoints,l,s);k<this.rightPoints.length&&this.rightPoints[k][1]===l[1];++k)if(this.rightPoints[k]===l)return this.rightPoints.splice(k,1),n}return a}};function g(l,L,T){for(var k=0;k<l.length&&l[k][0]<=L;++k){var P=T(l[k]);if(P)return P}}function h(l,L,T){for(var k=l.length-1;k>=0&&l[k][1]>=L;--k){var P=T(l[k]);if(P)return P}}function m(l,L){for(var T=0;T<l.length;++T){var k=L(l[T]);if(k)return k}}c.queryPoint=function(l,L){if(l<this.mid){if(this.left){var T=this.left.queryPoint(l,L);if(T)return T}return g(this.leftPoints,l,L)}else if(l>this.mid){if(this.right){var T=this.right.queryPoint(l,L);if(T)return T}return h(this.rightPoints,l,L)}else return m(this.leftPoints,L)},c.queryInterval=function(l,L,T){if(l<this.mid&&this.left){var k=this.left.queryInterval(l,L,T);if(k)return k}if(L>this.mid&&this.right){var k=this.right.queryInterval(l,L,T);if(k)return k}return L<this.mid?g(this.leftPoints,L,T):l>this.mid?h(this.rightPoints,l,T):m(this.leftPoints,T)};function u(l,L){return l-L}function _(l,L){var T=l[0]-L[0];return T||l[1]-L[1]}function s(l,L){var T=l[1]-L[1];return T||l[0]-L[0]}function A(l){if(l.length===0)return null;for(var L=[],T=0;T<l.length;++T)L.push(l[T][0],l[T][1]);L.sort(u);for(var k=L[L.length>>1],P=[],z=[],I=[],T=0;T<l.length;++T){var D=l[T];D[1]<k?P.push(D):k<D[0]?z.push(D):I.push(D)}var R=I,B=I.slice();return R.sort(_),B.sort(s),new t(k,A(P),A(z),R,B)}function b(l){this.root=l}var f=b.prototype;f.insert=function(l){this.root?this.root.insert(l):this.root=new t(l[0],null,null,[l],[l])},f.remove=function(l){if(this.root){var L=this.root.remove(l);return L===r&&(this.root=null),L!==a}return!1},f.queryPoint=function(l,L){if(this.root)return this.root.queryPoint(l,L)},f.queryInterval=function(l,L,T){if(l<=L&&this.root)return this.root.queryInterval(l,L,T)},Object.defineProperty(f,"count",{get:function(){return this.root?this.root.count:0}}),Object.defineProperty(f,"intervals",{get:function(){return this.root?this.root.intervals([]):[]}});function x(l){return!l||l.length===0?new b(null):new b(A(l))}},{"binary-search-bounds":31}],235:[function(v,S,M){function e(a){for(var n=new Array(a),r=0;r<a;++r)n[r]=r;return n}S.exports=e},{}],236:[function(v,S,M){S.exports=!0},{}],237:[function(v,S,M){/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */S.exports=function(n){return n!=null&&(e(n)||a(n)||!!n._isBuffer)};function e(n){return!!n.constructor&&typeof n.constructor.isBuffer=="function"&&n.constructor.isBuffer(n)}function a(n){return typeof n.readFloatLE=="function"&&typeof n.slice=="function"&&e(n.slice(0,0))}},{}],238:[function(v,S,M){S.exports=n,S.exports.isMobile=n,S.exports.default=n;var e=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i,a=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino|android|ipad|playbook|silk/i;function n(r){r||(r={});var t=r.ua;if(!t&&typeof navigator<"u"&&(t=navigator.userAgent),t&&t.headers&&typeof t.headers["user-agent"]=="string"&&(t=t.headers["user-agent"]),typeof t!="string")return!1;var c=r.tablet?a.test(t):e.test(t);return!c&&r.tablet&&r.featureDetect&&navigator&&navigator.maxTouchPoints>1&&t.indexOf("Macintosh")!==-1&&t.indexOf("Safari")!==-1&&(c=!0),c}},{}],239:[function(v,S,M){S.exports=function(e){for(var a=e.length,n,r=0;r<a;r++)if(n=e.charCodeAt(r),(n<9||n>13)&&n!==32&&n!==133&&n!==160&&n!==5760&&n!==6158&&(n<8192||n>8205)&&n!==8232&&n!==8233&&n!==8239&&n!==8287&&n!==8288&&n!==12288&&n!==65279)return!1;return!0}},{}],240:[function(v,S,M){function e(a,n,r){return a*(1-r)+n*r}S.exports=e},{}],241:[function(v,S,M){var e=v("./normalize"),a=v("gl-mat4/create"),n=v("gl-mat4/clone"),r=v("gl-mat4/determinant"),t=v("gl-mat4/invert"),c=v("gl-mat4/transpose"),o={length:v("gl-vec3/length"),normalize:v("gl-vec3/normalize"),dot:v("gl-vec3/dot"),cross:v("gl-vec3/cross")},i=a(),y=a(),p=[0,0,0,0],g=[[0,0,0],[0,0,0],[0,0,0]],h=[0,0,0];S.exports=function(A,b,f,x,l,L){if(b||(b=[0,0,0]),f||(f=[0,0,0]),x||(x=[0,0,0]),l||(l=[0,0,0,1]),L||(L=[0,0,0,1]),!e(i,A)||(n(y,i),y[3]=0,y[7]=0,y[11]=0,y[15]=1,Math.abs(r(y)<1e-8)))return!1;var T=i[3],k=i[7],P=i[11],z=i[12],I=i[13],D=i[14],R=i[15];if(T!==0||k!==0||P!==0){p[0]=T,p[1]=k,p[2]=P,p[3]=R;var B=t(y,y);if(!B)return!1;c(y,y),m(l,p,y)}else l[0]=l[1]=l[2]=0,l[3]=1;if(b[0]=z,b[1]=I,b[2]=D,u(g,i),f[0]=o.length(g[0]),o.normalize(g[0],g[0]),x[0]=o.dot(g[0],g[1]),_(g[1],g[1],g[0],1,-x[0]),f[1]=o.length(g[1]),o.normalize(g[1],g[1]),x[0]/=f[1],x[1]=o.dot(g[0],g[2]),_(g[2],g[2],g[0],1,-x[1]),x[2]=o.dot(g[1],g[2]),_(g[2],g[2],g[1],1,-x[2]),f[2]=o.length(g[2]),o.normalize(g[2],g[2]),x[1]/=f[2],x[2]/=f[2],o.cross(h,g[1],g[2]),o.dot(g[0],h)<0)for(var F=0;F<3;F++)f[F]*=-1,g[F][0]*=-1,g[F][1]*=-1,g[F][2]*=-1;return L[0]=.5*Math.sqrt(Math.max(1+g[0][0]-g[1][1]-g[2][2],0)),L[1]=.5*Math.sqrt(Math.max(1-g[0][0]+g[1][1]-g[2][2],0)),L[2]=.5*Math.sqrt(Math.max(1-g[0][0]-g[1][1]+g[2][2],0)),L[3]=.5*Math.sqrt(Math.max(1+g[0][0]+g[1][1]+g[2][2],0)),g[2][1]>g[1][2]&&(L[0]=-L[0]),g[0][2]>g[2][0]&&(L[1]=-L[1]),g[1][0]>g[0][1]&&(L[2]=-L[2]),!0};function m(s,A,b){var f=A[0],x=A[1],l=A[2],L=A[3];return s[0]=b[0]*f+b[4]*x+b[8]*l+b[12]*L,s[1]=b[1]*f+b[5]*x+b[9]*l+b[13]*L,s[2]=b[2]*f+b[6]*x+b[10]*l+b[14]*L,s[3]=b[3]*f+b[7]*x+b[11]*l+b[15]*L,s}function u(s,A){s[0][0]=A[0],s[0][1]=A[1],s[0][2]=A[2],s[1][0]=A[4],s[1][1]=A[5],s[1][2]=A[6],s[2][0]=A[8],s[2][1]=A[9],s[2][2]=A[10]}function _(s,A,b,f,x){s[0]=A[0]*f+b[0]*x,s[1]=A[1]*f+b[1]*x,s[2]=A[2]*f+b[2]*x}},{"./normalize":242,"gl-mat4/clone":92,"gl-mat4/create":93,"gl-mat4/determinant":94,"gl-mat4/invert":98,"gl-mat4/transpose":109,"gl-vec3/cross":157,"gl-vec3/dot":162,"gl-vec3/length":172,"gl-vec3/normalize":179}],242:[function(v,S,M){S.exports=function(a,n){var r=n[15];if(r===0)return!1;for(var t=1/r,c=0;c<16;c++)a[c]=n[c]*t;return!0}},{}],243:[function(v,S,M){var e=v("gl-vec3/lerp"),a=v("mat4-recompose"),n=v("mat4-decompose"),r=v("gl-mat4/determinant"),t=v("quat-slerp"),c=p(),o=p(),i=p();S.exports=y;function y(m,u,_,s){if(r(u)===0||r(_)===0)return!1;var A=n(u,c.translate,c.scale,c.skew,c.perspective,c.quaternion),b=n(_,o.translate,o.scale,o.skew,o.perspective,o.quaternion);return!A||!b?!1:(e(i.translate,c.translate,o.translate,s),e(i.skew,c.skew,o.skew,s),e(i.scale,c.scale,o.scale,s),e(i.perspective,c.perspective,o.perspective,s),t(i.quaternion,c.quaternion,o.quaternion,s),a(m,i.translate,i.scale,i.skew,i.perspective,i.quaternion),!0)}function p(){return{translate:g(),scale:g(1),skew:g(),perspective:h(),quaternion:h()}}function g(m){return[m||0,m||0,m||0]}function h(){return[0,0,0,1]}},{"gl-mat4/determinant":94,"gl-vec3/lerp":173,"mat4-decompose":241,"mat4-recompose":244,"quat-slerp":271}],244:[function(v,S,M){var e={identity:v("gl-mat4/identity"),translate:v("gl-mat4/translate"),multiply:v("gl-mat4/multiply"),create:v("gl-mat4/create"),scale:v("gl-mat4/scale"),fromRotationTranslation:v("gl-mat4/fromRotationTranslation")};e.create();var a=e.create();S.exports=function(r,t,c,o,i,y){return e.identity(r),e.fromRotationTranslation(r,y,t),r[3]=i[0],r[7]=i[1],r[11]=i[2],r[15]=i[3],e.identity(a),o[2]!==0&&(a[9]=o[2],e.multiply(r,r,a)),o[1]!==0&&(a[9]=0,a[8]=o[1],e.multiply(r,r,a)),o[0]!==0&&(a[8]=0,a[4]=o[0],e.multiply(r,r,a)),e.scale(r,r,c),r}},{"gl-mat4/create":93,"gl-mat4/fromRotationTranslation":96,"gl-mat4/identity":97,"gl-mat4/multiply":100,"gl-mat4/scale":107,"gl-mat4/translate":108}],245:[function(v,S,M){var e=v("binary-search-bounds"),a=v("mat4-interpolate"),n=v("gl-mat4/invert"),r=v("gl-mat4/rotateX"),t=v("gl-mat4/rotateY"),c=v("gl-mat4/rotateZ"),o=v("gl-mat4/lookAt"),i=v("gl-mat4/translate");v("gl-mat4/scale");var y=v("gl-vec3/normalize"),p=[0,0,0];S.exports=u;function g(_){this._components=_.slice(),this._time=[0],this.prevMatrix=_.slice(),this.nextMatrix=_.slice(),this.computedMatrix=_.slice(),this.computedInverse=_.slice(),this.computedEye=[0,0,0],this.computedUp=[0,0,0],this.computedCenter=[0,0,0],this.computedRadius=[0],this._limits=[-1/0,1/0]}var h=g.prototype;h.recalcMatrix=function(_){var s=this._time,A=e.le(s,_),b=this.computedMatrix;if(!(A<0)){var f=this._components;if(A===s.length-1)for(var x=16*A,l=0;l<16;++l)b[l]=f[x++];else{for(var L=s[A+1]-s[A],x=16*A,T=this.prevMatrix,k=!0,l=0;l<16;++l)T[l]=f[x++];for(var P=this.nextMatrix,l=0;l<16;++l)P[l]=f[x++],k=k&&T[l]===P[l];if(L<1e-6||k)for(var l=0;l<16;++l)b[l]=T[l];else a(b,T,P,(_-s[A])/L)}var z=this.computedUp;z[0]=b[1],z[1]=b[5],z[2]=b[9],y(z,z);var I=this.computedInverse;n(I,b);var D=this.computedEye,R=I[15];D[0]=I[12]/R,D[1]=I[13]/R,D[2]=I[14]/R;for(var B=this.computedCenter,F=Math.exp(this.computedRadius[0]),l=0;l<3;++l)B[l]=D[l]-b[2+4*l]*F}},h.idle=function(_){if(!(_<this.lastT())){for(var s=this._components,A=s.length-16,b=0;b<16;++b)s.push(s[A++]);this._time.push(_)}},h.flush=function(_){var s=e.gt(this._time,_)-2;s<0||(this._time.splice(0,s),this._components.splice(0,16*s))},h.lastT=function(){return this._time[this._time.length-1]},h.lookAt=function(_,s,A,b){this.recalcMatrix(_),s=s||this.computedEye,A=A||p,b=b||this.computedUp,this.setMatrix(_,o(this.computedMatrix,s,A,b));for(var f=0,x=0;x<3;++x)f+=Math.pow(A[x]-s[x],2);f=Math.log(Math.sqrt(f)),this.computedRadius[0]=f},h.rotate=function(_,s,A,b){this.recalcMatrix(_);var f=this.computedInverse;s&&t(f,f,s),A&&r(f,f,A),b&&c(f,f,b),this.setMatrix(_,n(this.computedMatrix,f))};var m=[0,0,0];h.pan=function(_,s,A,b){m[0]=-(s||0),m[1]=-(A||0),m[2]=-(b||0),this.recalcMatrix(_);var f=this.computedInverse;i(f,f,m),this.setMatrix(_,n(f,f))},h.translate=function(_,s,A,b){m[0]=s||0,m[1]=A||0,m[2]=b||0,this.recalcMatrix(_);var f=this.computedMatrix;i(f,f,m),this.setMatrix(_,f)},h.setMatrix=function(_,s){if(!(_<this.lastT())){this._time.push(_);for(var A=0;A<16;++A)this._components.push(s[A])}},h.setDistance=function(_,s){this.computedRadius[0]=s},h.setDistanceLimits=function(_,s){var A=this._limits;A[0]=_,A[1]=s},h.getDistanceLimits=function(_){var s=this._limits;return _?(_[0]=s[0],_[1]=s[1],_):s};function u(_){_=_||{};var s=_.matrix||[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return new g(s)}},{"binary-search-bounds":31,"gl-mat4/invert":98,"gl-mat4/lookAt":99,"gl-mat4/rotateX":104,"gl-mat4/rotateY":105,"gl-mat4/rotateZ":106,"gl-mat4/scale":107,"gl-mat4/translate":108,"gl-vec3/normalize":179,"mat4-interpolate":243}],246:[function(v,S,M){S.exports=a;var e=v("robust-orientation")[3];function a(n){var r=n.length;if(r<3){for(var h=new Array(r),t=0;t<r;++t)h[t]=t;return r===2&&n[0][0]===n[1][0]&&n[0][1]===n[1][1]?[0]:h}for(var c=new Array(r),t=0;t<r;++t)c[t]=t;c.sort(function(s,A){var b=n[s][0]-n[A][0];return b||n[s][1]-n[A][1]});for(var o=[c[0],c[1]],i=[c[0],c[1]],t=2;t<r;++t){for(var y=c[t],p=n[y],g=o.length;g>1&&e(n[o[g-2]],n[o[g-1]],p)<=0;)g-=1,o.pop();for(o.push(y),g=i.length;g>1&&e(n[i[g-2]],n[i[g-1]],p)>=0;)g-=1,i.pop();i.push(y)}for(var h=new Array(i.length+o.length-2),m=0,t=0,u=o.length;t<u;++t)h[m++]=o[t];for(var _=i.length-2;_>0;--_)h[m++]=i[_];return h}},{"robust-orientation":284}],247:[function(v,S,M){S.exports=a;var e=v("mouse-event");function a(n,r){r||(r=n,n=window);var t=0,c=0,o=0,i={shift:!1,alt:!1,control:!1,meta:!1},y=!1;function p(l){var L=!1;return"altKey"in l&&(L=L||l.altKey!==i.alt,i.alt=!!l.altKey),"shiftKey"in l&&(L=L||l.shiftKey!==i.shift,i.shift=!!l.shiftKey),"ctrlKey"in l&&(L=L||l.ctrlKey!==i.control,i.control=!!l.ctrlKey),"metaKey"in l&&(L=L||l.metaKey!==i.meta,i.meta=!!l.metaKey),L}function g(l,L){var T=e.x(L),k=e.y(L);"buttons"in L&&(l=L.buttons|0),(l!==t||T!==c||k!==o||p(L))&&(t=l|0,c=T||0,o=k||0,r&&r(t,c,o,i))}function h(l){g(0,l)}function m(){(t||c||o||i.shift||i.alt||i.meta||i.control)&&(c=o=0,t=0,i.shift=i.alt=i.control=i.meta=!1,r&&r(0,0,0,i))}function u(l){p(l)&&r&&r(t,c,o,i)}function _(l){e.buttons(l)===0?g(0,l):g(t,l)}function s(l){g(t|e.buttons(l),l)}function A(l){g(t&~e.buttons(l),l)}function b(){y||(y=!0,n.addEventListener("mousemove",_),n.addEventListener("mousedown",s),n.addEventListener("mouseup",A),n.addEventListener("mouseleave",h),n.addEventListener("mouseenter",h),n.addEventListener("mouseout",h),n.addEventListener("mouseover",h),n.addEventListener("blur",m),n.addEventListener("keyup",u),n.addEventListener("keydown",u),n.addEventListener("keypress",u),n!==window&&(window.addEventListener("blur",m),window.addEventListener("keyup",u),window.addEventListener("keydown",u),window.addEventListener("keypress",u)))}function f(){!y||(y=!1,n.removeEventListener("mousemove",_),n.removeEventListener("mousedown",s),n.removeEventListener("mouseup",A),n.removeEventListener("mouseleave",h),n.removeEventListener("mouseenter",h),n.removeEventListener("mouseout",h),n.removeEventListener("mouseover",h),n.removeEventListener("blur",m),n.removeEventListener("keyup",u),n.removeEventListener("keydown",u),n.removeEventListener("keypress",u),n!==window&&(window.removeEventListener("blur",m),window.removeEventListener("keyup",u),window.removeEventListener("keydown",u),window.removeEventListener("keypress",u)))}b();var x={element:n};return Object.defineProperties(x,{enabled:{get:function(){return y},set:function(l){l?b():f()},enumerable:!0},buttons:{get:function(){return t},enumerable:!0},x:{get:function(){return c},enumerable:!0},y:{get:function(){return o},enumerable:!0},mods:{get:function(){return i},enumerable:!0}}),x}},{"mouse-event":249}],248:[function(v,S,M){var e={left:0,top:0};S.exports=a;function a(r,t,c){t=t||r.currentTarget||r.srcElement,Array.isArray(c)||(c=[0,0]);var o=r.clientX||0,i=r.clientY||0,y=n(t);return c[0]=o-y.left,c[1]=i-y.top,c}function n(r){return r===window||r===document||r===document.body?e:r.getBoundingClientRect()}},{}],249:[function(v,S,M){function e(t){if(typeof t=="object"){if("buttons"in t)return t.buttons;if("which"in t){var c=t.which;if(c===2)return 4;if(c===3)return 2;if(c>0)return 1<<c-1}else if("button"in t){var c=t.button;if(c===1)return 4;if(c===2)return 2;if(c>=0)return 1<<c}}return 0}M.buttons=e;function a(t){return t.target||t.srcElement||window}M.element=a;function n(t){if(typeof t=="object"){if("offsetX"in t)return t.offsetX;var c=a(t),o=c.getBoundingClientRect();return t.clientX-o.left}return 0}M.x=n;function r(t){if(typeof t=="object"){if("offsetY"in t)return t.offsetY;var c=a(t),o=c.getBoundingClientRect();return t.clientY-o.top}return 0}M.y=r},{}],250:[function(v,S,M){var e=v("to-px");S.exports=a;function a(n,r,t){typeof n=="function"&&(t=!!r,r=n,n=window);var c=e("ex",n),o=function(i){t&&i.preventDefault();var y=i.deltaX||0,p=i.deltaY||0,g=i.deltaZ||0,h=i.deltaMode,m=1;switch(h){case 1:m=c;break;case 2:m=window.innerHeight;break}if(y*=m,p*=m,g*=m,y||p||g)return r(y,p,g,i)};return n.addEventListener("wheel",o),o}},{"to-px":304}],251:[function(v,S,M){var e=v("typedarray-pool");S.exports=r;var a={"false,0,1":function(c,o,i,y,p){return function(h,m,u,_){var s=h.shape[0]|0,A=h.shape[1]|0,b=h.data,f=h.offset|0,x=h.stride[0]|0,l=h.stride[1]|0,L=f,T,k=-x|0,P=0,z=-l|0,I=0,D=-x-l|0,R=0,B=x|0,F=l-x*s|0,H=0,G=0,J=0,X=2*s|0,Y=y(X),Z=y(X),oe=0,re=0,se=-1,N=-1,U=0,q=-s|0,$=s|0,W=0,K=-s-1|0,ne=s-1|0,ae=0,ie=0,le=0;for(H=0;H<s;++H)Y[oe++]=i(b[L],m,u,_),L+=B;if(L+=F,A>0){if(G=1,Y[oe++]=i(b[L],m,u,_),L+=B,s>0)for(H=1,T=b[L],re=Y[oe]=i(T,m,u,_),U=Y[oe+se],W=Y[oe+q],ae=Y[oe+K],(re!==U||re!==W||re!==ae)&&(P=b[L+k],I=b[L+z],R=b[L+D],c(H,G,T,P,I,R,re,U,W,ae,m,u,_),ie=Z[oe]=J++),oe+=1,L+=B,H=2;H<s;++H)T=b[L],re=Y[oe]=i(T,m,u,_),U=Y[oe+se],W=Y[oe+q],ae=Y[oe+K],(re!==U||re!==W||re!==ae)&&(P=b[L+k],I=b[L+z],R=b[L+D],c(H,G,T,P,I,R,re,U,W,ae,m,u,_),ie=Z[oe]=J++,ae!==U&&o(Z[oe+se],ie,R,P,ae,U,m,u,_)),oe+=1,L+=B;for(L+=F,oe=0,le=se,se=N,N=le,le=q,q=$,$=le,le=K,K=ne,ne=le,G=2;G<A;++G){if(Y[oe++]=i(b[L],m,u,_),L+=B,s>0)for(H=1,T=b[L],re=Y[oe]=i(T,m,u,_),U=Y[oe+se],W=Y[oe+q],ae=Y[oe+K],(re!==U||re!==W||re!==ae)&&(P=b[L+k],I=b[L+z],R=b[L+D],c(H,G,T,P,I,R,re,U,W,ae,m,u,_),ie=Z[oe]=J++,ae!==W&&o(Z[oe+q],ie,I,R,W,ae,m,u,_)),oe+=1,L+=B,H=2;H<s;++H)T=b[L],re=Y[oe]=i(T,m,u,_),U=Y[oe+se],W=Y[oe+q],ae=Y[oe+K],(re!==U||re!==W||re!==ae)&&(P=b[L+k],I=b[L+z],R=b[L+D],c(H,G,T,P,I,R,re,U,W,ae,m,u,_),ie=Z[oe]=J++,ae!==W&&o(Z[oe+q],ie,I,R,W,ae,m,u,_),ae!==U&&o(Z[oe+se],ie,R,P,ae,U,m,u,_)),oe+=1,L+=B;G&1&&(oe=0),le=se,se=N,N=le,le=q,q=$,$=le,le=K,K=ne,ne=le,L+=F}}p(Z),p(Y)}},"false,1,0":function(c,o,i,y,p){return function(h,m,u,_){var s=h.shape[0]|0,A=h.shape[1]|0,b=h.data,f=h.offset|0,x=h.stride[0]|0,l=h.stride[1]|0,L=f,T,k=-x|0,P=0,z=-l|0,I=0,D=-x-l|0,R=0,B=l|0,F=x-l*A|0,H=0,G=0,J=0,X=2*A|0,Y=y(X),Z=y(X),oe=0,re=0,se=-1,N=-1,U=0,q=-A|0,$=A|0,W=0,K=-A-1|0,ne=A-1|0,ae=0,ie=0,le=0;for(G=0;G<A;++G)Y[oe++]=i(b[L],m,u,_),L+=B;if(L+=F,s>0){if(H=1,Y[oe++]=i(b[L],m,u,_),L+=B,A>0)for(G=1,T=b[L],re=Y[oe]=i(T,m,u,_),W=Y[oe+q],U=Y[oe+se],ae=Y[oe+K],(re!==W||re!==U||re!==ae)&&(P=b[L+k],I=b[L+z],R=b[L+D],c(H,G,T,P,I,R,re,W,U,ae,m,u,_),ie=Z[oe]=J++),oe+=1,L+=B,G=2;G<A;++G)T=b[L],re=Y[oe]=i(T,m,u,_),W=Y[oe+q],U=Y[oe+se],ae=Y[oe+K],(re!==W||re!==U||re!==ae)&&(P=b[L+k],I=b[L+z],R=b[L+D],c(H,G,T,P,I,R,re,W,U,ae,m,u,_),ie=Z[oe]=J++,ae!==U&&o(Z[oe+se],ie,I,R,U,ae,m,u,_)),oe+=1,L+=B;for(L+=F,oe=0,le=q,q=$,$=le,le=se,se=N,N=le,le=K,K=ne,ne=le,H=2;H<s;++H){if(Y[oe++]=i(b[L],m,u,_),L+=B,A>0)for(G=1,T=b[L],re=Y[oe]=i(T,m,u,_),W=Y[oe+q],U=Y[oe+se],ae=Y[oe+K],(re!==W||re!==U||re!==ae)&&(P=b[L+k],I=b[L+z],R=b[L+D],c(H,G,T,P,I,R,re,W,U,ae,m,u,_),ie=Z[oe]=J++,ae!==W&&o(Z[oe+q],ie,R,P,ae,W,m,u,_)),oe+=1,L+=B,G=2;G<A;++G)T=b[L],re=Y[oe]=i(T,m,u,_),W=Y[oe+q],U=Y[oe+se],ae=Y[oe+K],(re!==W||re!==U||re!==ae)&&(P=b[L+k],I=b[L+z],R=b[L+D],c(H,G,T,P,I,R,re,W,U,ae,m,u,_),ie=Z[oe]=J++,ae!==U&&o(Z[oe+se],ie,I,R,U,ae,m,u,_),ae!==W&&o(Z[oe+q],ie,R,P,ae,W,m,u,_)),oe+=1,L+=B;H&1&&(oe=0),le=q,q=$,$=le,le=se,se=N,N=le,le=K,K=ne,ne=le,L+=F}}p(Z),p(Y)}}};function n(t,c,o,i,y,p){var g=[p,y].join(","),h=a[g];return h(t,c,o,e.mallocUint32,e.freeUint32)}function r(t){function c(m){throw new Error("ndarray-extract-contour: "+m)}typeof t!="object"&&c("Must specify arguments");var o=t.order;Array.isArray(o)||c("Must specify order");var i=t.arrayArguments||1;i<1&&c("Must have at least one array argument");var y=t.scalarArguments||0;y<0&&c("Scalar arg count must be > 0"),typeof t.vertex!="function"&&c("Must specify vertex creation function"),typeof t.cell!="function"&&c("Must specify cell creation function"),typeof t.phase!="function"&&c("Must specify phase function");for(var p=t.getters||[],g=new Array(i),h=0;h<i;++h)p.indexOf(h)>=0?g[h]=!0:g[h]=!1;return n(t.vertex,t.cell,t.phase,y,o,g)}},{"typedarray-pool":308}],252:[function(v,S,M){var e=v("dup"),a={zero:function(u,_,s,A){var b=u[0],f=s[0];A|=0;var x=0,l=f;for(x=0;x<b;++x)_[A]=0,A+=l},fdTemplate1:function(u,_,s,A,b,f,x){var l=u[0],L=s[0],T=f[0],k=-1*L,P=L;A|=0,x|=0;var z=0,I=L,D=T;for(z=0;z<l;++z)b[x]=.5*(_[A+k]-_[A+P]),A+=I,x+=D},fdTemplate2:function(u,_,s,A,b,f,x,l,L,T){var k=u[0],P=u[1],z=s[0],I=s[1],D=f[0],R=f[1],B=L[0],F=L[1],H=-1*z,G=z,J=-1*I,X=I;A|=0,x|=0,T|=0;var Y=0,Z=0,oe=I,re=z-P*I,se=R,N=D-P*R,U=F,q=B-P*F;for(Z=0;Z<k;++Z){for(Y=0;Y<P;++Y)b[x]=.5*(_[A+H]-_[A+G]),l[T]=.5*(_[A+J]-_[A+X]),A+=oe,x+=se,T+=U;A+=re,x+=N,T+=q}}},n={cdiff:function(u){var _={};return function(A,b,f){var x=A.dtype,l=A.order,L=b.dtype,T=b.order,k=f.dtype,P=f.order,z=[x,l.join(),L,T.join(),k,P.join()].join(),I=_[z];return I||(_[z]=I=u([x,l,L,T,k,P])),I(A.shape.slice(0),A.data,A.stride,A.offset|0,b.data,b.stride,b.offset|0,f.data,f.stride,f.offset|0)}},zero:function(u){var _={};return function(A){var b=A.dtype,f=A.order,x=[b,f.join()].join(),l=_[x];return l||(_[x]=l=u([b,f])),l(A.shape.slice(0),A.data,A.stride,A.offset|0)}},fdTemplate1:function(u){var _={};return function(A,b){var f=A.dtype,x=A.order,l=b.dtype,L=b.order,T=[f,x.join(),l,L.join()].join(),k=_[T];return k||(_[T]=k=u([f,x,l,L])),k(A.shape.slice(0),A.data,A.stride,A.offset|0,b.data,b.stride,b.offset|0)}},fdTemplate2:function(u){var _={};return function(A,b,f){var x=A.dtype,l=A.order,L=b.dtype,T=b.order,k=f.dtype,P=f.order,z=[x,l.join(),L,T.join(),k,P.join()].join(),I=_[z];return I||(_[z]=I=u([x,l,L,T,k,P])),I(A.shape.slice(0),A.data,A.stride,A.offset|0,b.data,b.stride,b.offset|0,f.data,f.stride,f.offset|0)}}};function r(u){var _=n[u.funcName];return _(t.bind(void 0,u))}function t(u){return a[u.funcName]}function c(u){return r({funcName:u.funcName})}var o={},i={},y=c({funcName:"cdiff"}),p=c({funcName:"zero"});function g(u){return u in o?o[u]:o[u]=c({funcName:"fdTemplate"+u})}function h(u,_,s,A){return function(b,f){var x=f.shape.slice();return x[0]>2&&x[1]>2&&A(f.pick(-1,-1).lo(1,1).hi(x[0]-2,x[1]-2),b.pick(-1,-1,0).lo(1,1).hi(x[0]-2,x[1]-2),b.pick(-1,-1,1).lo(1,1).hi(x[0]-2,x[1]-2)),x[1]>2&&(s(f.pick(0,-1).lo(1).hi(x[1]-2),b.pick(0,-1,1).lo(1).hi(x[1]-2)),_(b.pick(0,-1,0).lo(1).hi(x[1]-2))),x[1]>2&&(s(f.pick(x[0]-1,-1).lo(1).hi(x[1]-2),b.pick(x[0]-1,-1,1).lo(1).hi(x[1]-2)),_(b.pick(x[0]-1,-1,0).lo(1).hi(x[1]-2))),x[0]>2&&(s(f.pick(-1,0).lo(1).hi(x[0]-2),b.pick(-1,0,0).lo(1).hi(x[0]-2)),_(b.pick(-1,0,1).lo(1).hi(x[0]-2))),x[0]>2&&(s(f.pick(-1,x[1]-1).lo(1).hi(x[0]-2),b.pick(-1,x[1]-1,0).lo(1).hi(x[0]-2)),_(b.pick(-1,x[1]-1,1).lo(1).hi(x[0]-2))),b.set(0,0,0,0),b.set(0,0,1,0),b.set(x[0]-1,0,0,0),b.set(x[0]-1,0,1,0),b.set(0,x[1]-1,0,0),b.set(0,x[1]-1,1,0),b.set(x[0]-1,x[1]-1,0,0),b.set(x[0]-1,x[1]-1,1,0),b}}function m(u){var _=u.join(),x=i[_];if(x)return x;for(var s=u.length,A=[y,p],b=1;b<=s;++b)A.push(g(b));var f=h,x=f.apply(void 0,A);return i[_]=x,x}S.exports=function(_,s,A){if(Array.isArray(A)||(typeof A=="string"?A=e(s.dimension,A):A=e(s.dimension,"clamp")),s.size===0)return _;if(s.dimension===0)return _.set(0),_;var b=m(A);return b(_,s)}},{dup:65}],253:[function(v,S,M){function e(c,o){var i=Math.floor(o),y=o-i,p=0<=i&&i<c.shape[0],g=0<=i+1&&i+1<c.shape[0],h=p?+c.get(i):0,m=g?+c.get(i+1):0;return(1-y)*h+y*m}function a(c,o,i){var y=Math.floor(o),p=o-y,g=0<=y&&y<c.shape[0],h=0<=y+1&&y+1<c.shape[0],m=Math.floor(i),u=i-m,_=0<=m&&m<c.shape[1],s=0<=m+1&&m+1<c.shape[1],A=g&&_?c.get(y,m):0,b=g&&s?c.get(y,m+1):0,f=h&&_?c.get(y+1,m):0,x=h&&s?c.get(y+1,m+1):0;return(1-u)*((1-p)*A+p*f)+u*((1-p)*b+p*x)}function n(c,o,i,y){var p=Math.floor(o),g=o-p,h=0<=p&&p<c.shape[0],m=0<=p+1&&p+1<c.shape[0],u=Math.floor(i),_=i-u,s=0<=u&&u<c.shape[1],A=0<=u+1&&u+1<c.shape[1],b=Math.floor(y),f=y-b,x=0<=b&&b<c.shape[2],l=0<=b+1&&b+1<c.shape[2],L=h&&s&&x?c.get(p,u,b):0,T=h&&A&&x?c.get(p,u+1,b):0,k=m&&s&&x?c.get(p+1,u,b):0,P=m&&A&&x?c.get(p+1,u+1,b):0,z=h&&s&&l?c.get(p,u,b+1):0,I=h&&A&&l?c.get(p,u+1,b+1):0,D=m&&s&&l?c.get(p+1,u,b+1):0,R=m&&A&&l?c.get(p+1,u+1,b+1):0;return(1-f)*((1-_)*((1-g)*L+g*k)+_*((1-g)*T+g*P))+f*((1-_)*((1-g)*z+g*D)+_*((1-g)*I+g*R))}function r(c){var o=c.shape.length|0,i=new Array(o),y=new Array(o),p=new Array(o),g=new Array(o),h,m;for(h=0;h<o;++h)m=+arguments[h+1],i[h]=Math.floor(m),y[h]=m-i[h],p[h]=0<=i[h]&&i[h]<c.shape[h],g[h]=0<=i[h]+1&&i[h]+1<c.shape[h];var u=0,_,s,A;e:for(h=0;h<1<<o;++h){for(s=1,A=c.offset,_=0;_<o;++_)if(h&1<<_){if(!g[_])continue e;s*=y[_],A+=c.stride[_]*(i[_]+1)}else{if(!p[_])continue e;s*=1-y[_],A+=c.stride[_]*i[_]}u+=s*c.data[A]}return u}function t(c,o,i,y){switch(c.shape.length){case 0:return 0;case 1:return e(c,o);case 2:return a(c,o,i);case 3:return n(c,o,i,y);default:return r.apply(void 0,arguments)}}S.exports=t,S.exports.d1=e,S.exports.d2=a,S.exports.d3=n},{}],254:[function(v,S,M){var e={"float64,2,1,0":function(){return function(y,p,g,h,m){var u=y[0],_=y[1],s=y[2],A=g[0],b=g[1],f=g[2];h|=0;var x=0,l=0,L=0,T=f,k=b-s*f,P=A-_*b;for(L=0;L<u;++L){for(l=0;l<_;++l){for(x=0;x<s;++x)p[h]/=m,h+=T;h+=k}h+=P}}},"uint8,2,0,1,float64,2,1,0":function(){return function(y,p,g,h,m,u,_,s){var A=y[0],b=y[1],f=y[2],x=g[0],l=g[1],L=g[2],T=u[0],k=u[1],P=u[2];h|=0,_|=0;for(var z=h,I=_,D=y[0]|0;D>0;){D<64?(A=D,D=0):(A=64,D-=64);for(var R=y[1]|0;R>0;){R<64?(b=R,R=0):(b=64,R-=64),h=z+D*x+R*l,_=I+D*T+R*k;var B=0,F=0,H=0,G=L,J=x-f*L,X=l-A*x,Y=P,Z=T-f*P,oe=k-A*T;for(H=0;H<b;++H){for(F=0;F<A;++F){for(B=0;B<f;++B)p[h]=m[_]*s,h+=G,_+=Y;h+=J,_+=Z}h+=X,_+=oe}}}}},"float32,1,0,float32,1,0":function(){return function(y,p,g,h,m,u,_){var s=y[0],A=y[1],b=g[0],f=g[1],x=u[0],l=u[1];h|=0,_|=0;var L=0,T=0,k=f,P=b-A*f,z=l,I=x-A*l;for(T=0;T<s;++T){for(L=0;L<A;++L)p[h]=m[_],h+=k,_+=z;h+=P,_+=I}}},"float32,1,0,float32,0,1":function(){return function(y,p,g,h,m,u,_){var s=y[0],A=y[1],b=g[0],f=g[1],x=u[0],l=u[1];h|=0,_|=0;for(var L=h,T=_,k=y[1]|0;k>0;){k<64?(A=k,k=0):(A=64,k-=64);for(var P=y[0]|0;P>0;){P<64?(s=P,P=0):(s=64,P-=64),h=L+k*f+P*b,_=T+k*l+P*x;var z=0,I=0,D=f,R=b-A*f,B=l,F=x-A*l;for(I=0;I<s;++I){for(z=0;z<A;++z)p[h]=m[_],h+=D,_+=B;h+=R,_+=F}}}}},"uint8,2,0,1,uint8,1,2,0":function(){return function(y,p,g,h,m,u,_){var s=y[0],A=y[1],b=y[2],f=g[0],x=g[1],l=g[2],L=u[0],T=u[1],k=u[2];h|=0,_|=0;for(var P=h,z=_,I=y[2]|0;I>0;){I<64?(b=I,I=0):(b=64,I-=64);for(var D=y[0]|0;D>0;){D<64?(s=D,D=0):(s=64,D-=64);for(var R=y[1]|0;R>0;){R<64?(A=R,R=0):(A=64,R-=64),h=P+I*l+D*f+R*x,_=z+I*k+D*L+R*T;var B=0,F=0,H=0,G=l,J=f-b*l,X=x-s*f,Y=k,Z=L-b*k,oe=T-s*L;for(H=0;H<A;++H){for(F=0;F<s;++F){for(B=0;B<b;++B)p[h]=m[_],h+=G,_+=Y;h+=J,_+=Z}h+=X,_+=oe}}}}}},"uint8,2,0,1,array,2,0,1":function(){return function(y,p,g,h,m,u,_){var s=y[0],A=y[1],b=y[2],f=g[0],x=g[1],l=g[2],L=u[0],T=u[1],k=u[2];h|=0,_|=0;var P=0,z=0,I=0,D=l,R=f-b*l,B=x-s*f,F=k,H=L-b*k,G=T-s*L;for(I=0;I<A;++I){for(z=0;z<s;++z){for(P=0;P<b;++P)p[h]=m[_],h+=D,_+=F;h+=R,_+=H}h+=B,_+=G}}}};function a(i,y){var p=y.join(","),g=e[p];return g()}var n=a,r={mul:function(i){var y={};return function(g,h,m){var u=g.dtype,_=g.order,s=h.dtype,A=h.order,b=m.dtype,f=m.order,x=[u,_.join(),s,A.join(),b,f.join()].join(),l=y[x];return l||(y[x]=l=i([u,_,s,A,b,f])),l(g.shape.slice(0),g.data,g.stride,g.offset|0,h.data,h.stride,h.offset|0,m.data,m.stride,m.offset|0)}},muls:function(i){var y={};return function(g,h,m){var u=g.dtype,_=g.order,s=h.dtype,A=h.order,b=[u,_.join(),s,A.join()].join(),f=y[b];return f||(y[b]=f=i([u,_,s,A])),f(g.shape.slice(0),g.data,g.stride,g.offset|0,h.data,h.stride,h.offset|0,m)}},mulseq:function(i){var y={};return function(g,h){var m=g.dtype,u=g.order,_=[m,u.join()].join(),s=y[_];return s||(y[_]=s=i([m,u])),s(g.shape.slice(0),g.data,g.stride,g.offset|0,h)}},div:function(i){var y={};return function(g,h,m){var u=g.dtype,_=g.order,s=h.dtype,A=h.order,b=m.dtype,f=m.order,x=[u,_.join(),s,A.join(),b,f.join()].join(),l=y[x];return l||(y[x]=l=i([u,_,s,A,b,f])),l(g.shape.slice(0),g.data,g.stride,g.offset|0,h.data,h.stride,h.offset|0,m.data,m.stride,m.offset|0)}},divs:function(i){var y={};return function(g,h,m){var u=g.dtype,_=g.order,s=h.dtype,A=h.order,b=[u,_.join(),s,A.join()].join(),f=y[b];return f||(y[b]=f=i([u,_,s,A])),f(g.shape.slice(0),g.data,g.stride,g.offset|0,h.data,h.stride,h.offset|0,m)}},divseq:function(i){var y={};return function(g,h){var m=g.dtype,u=g.order,_=[m,u.join()].join(),s=y[_];return s||(y[_]=s=i([m,u])),s(g.shape.slice(0),g.data,g.stride,g.offset|0,h)}},assign:function(i){var y={};return function(g,h){var m=g.dtype,u=g.order,_=h.dtype,s=h.order,A=[m,u.join(),_,s.join()].join(),b=y[A];return b||(y[A]=b=i([m,u,_,s])),b(g.shape.slice(0),g.data,g.stride,g.offset|0,h.data,h.stride,h.offset|0)}}};function t(i){var y=r[i.funcName];return y(n.bind(void 0,i))}function c(i){return t({funcName:i.funcName})}var o={mul:"*",div:"/"};(function(){for(var i in o)M[i]=c({funcName:i}),M[i+"s"]=c({funcName:i+"s"}),M[i+"seq"]=c({funcName:i+"seq"})})(),M.assign=c({funcName:"assign"})},{}],255:[function(v,S,M){var e=v("ndarray"),a=v("./doConvert.js");S.exports=function(r,t){for(var c=[],o=r,i=1;Array.isArray(o);)c.push(o.length),i*=o.length,o=o[0];return c.length===0?e():(t||(t=e(new Float64Array(i),c)),a(t,r),t)}},{"./doConvert.js":256,ndarray:259}],256:[function(v,S,M){function e(){return function(o,i,y,p,g){var h=o[0],m=o[1],u=o[2],_=y[0],s=y[1],A=y[2],b=[0,0,0];p|=0;var f=0,x=0,l=0,L=A,T=s-u*A,k=_-m*s;for(l=0;l<h;++l){for(x=0;x<m;++x){for(f=0;f<u;++f){{var P=g,z;for(z=0;z<b.length-1;++z)P=P[b[z]];i[p]=P[b[b.length-1]]}p+=L,++b[2]}p+=T,b[2]-=u,++b[1]}p+=k,b[1]-=m,++b[0]}}}function a(){return e()}var n=a;function r(o){var i={};return function(p,g){var h=p.dtype,m=p.order,u=[h,m.join()].join(),_=i[u];return _||(i[u]=_=o([h,m])),_(p.shape.slice(0),p.data,p.stride,p.offset|0,g)}}function t(o){return r(n.bind(void 0,o))}function c(o){return t({funcName:o.funcName})}S.exports=c({funcName:"convert"})},{}],257:[function(v,S,M){var e=v("typedarray-pool");function a(y){switch(y){case"uint32":return[e.mallocUint32,e.freeUint32];default:return null}}var n={"uint32,1,0":function(y,p){return function(h,m,u,_,s,A,b,f,x,l,L){var T,k,P,z=h*s+_,I,D=y(f),R,B,F,H;for(T=h+1;T<=m;++T){for(k=T,z+=s,P=z,R=0,B=z,I=0;I<f;++I)D[R++]=u[B],B+=x;e:for(;k-- >h;){R=0,B=P-s;t:for(I=0;I<f;++I){if(F=u[B],H=D[R],F<H)break e;if(F>H)break t;B+=l,R+=L}for(R=P,B=P-s,I=0;I<f;++I)u[R]=u[B],R+=x,B+=x;P-=s}for(R=P,B=0,I=0;I<f;++I)u[R]=D[B++],R+=x}p(D)}}};function r(y,p){var g=a(p),h=[p,y].join(","),m=n[h];return g?m(g[0],g[1]):m()}var t={"uint32,1,0":function(y,p,g){return function h(m,u,_,s,A,b,f,x,l,L,T){var k=(u-m+1)/6|0,P=m+k,z=u-k,I=m+u>>1,D=I-k,R=I+k,B=P,F=D,H=I,G=R,J=z,X=m+1,Y=u-1,Z=!0,oe,re,se,N,U,q,$,W,K,ne=0,ae=0,ie=0,le,ye,ue,pe,ge,Te,_e,ze,Oe,Ye,be,Pe,Ge,Qe,Be,Le,He=x,vt=p(He),Rt=p(He);ye=A*B,ue=A*F,Le=s;e:for(le=0;le<x;++le){if($=ye+Le,W=ue+Le,ie=_[$]-_[W],ie>0){re=B,B=F,F=re;break e}if(ie<0)break e;Le+=L}ye=A*G,ue=A*J,Le=s;e:for(le=0;le<x;++le){if($=ye+Le,W=ue+Le,ie=_[$]-_[W],ie>0){re=G,G=J,J=re;break e}if(ie<0)break e;Le+=L}ye=A*B,ue=A*H,Le=s;e:for(le=0;le<x;++le){if($=ye+Le,W=ue+Le,ie=_[$]-_[W],ie>0){re=B,B=H,H=re;break e}if(ie<0)break e;Le+=L}ye=A*F,ue=A*H,Le=s;e:for(le=0;le<x;++le){if($=ye+Le,W=ue+Le,ie=_[$]-_[W],ie>0){re=F,F=H,H=re;break e}if(ie<0)break e;Le+=L}ye=A*B,ue=A*G,Le=s;e:for(le=0;le<x;++le){if($=ye+Le,W=ue+Le,ie=_[$]-_[W],ie>0){re=B,B=G,G=re;break e}if(ie<0)break e;Le+=L}ye=A*H,ue=A*G,Le=s;e:for(le=0;le<x;++le){if($=ye+Le,W=ue+Le,ie=_[$]-_[W],ie>0){re=H,H=G,G=re;break e}if(ie<0)break e;Le+=L}ye=A*F,ue=A*J,Le=s;e:for(le=0;le<x;++le){if($=ye+Le,W=ue+Le,ie=_[$]-_[W],ie>0){re=F,F=J,J=re;break e}if(ie<0)break e;Le+=L}ye=A*F,ue=A*H,Le=s;e:for(le=0;le<x;++le){if($=ye+Le,W=ue+Le,ie=_[$]-_[W],ie>0){re=F,F=H,H=re;break e}if(ie<0)break e;Le+=L}ye=A*G,ue=A*J,Le=s;e:for(le=0;le<x;++le){if($=ye+Le,W=ue+Le,ie=_[$]-_[W],ie>0){re=G,G=J,J=re;break e}if(ie<0)break e;Le+=L}for(ye=A*B,ue=A*F,pe=A*H,ge=A*G,Te=A*J,_e=A*P,ze=A*I,Oe=A*z,Be=0,Le=s,le=0;le<x;++le)$=ye+Le,W=ue+Le,K=pe+Le,Ye=ge+Le,be=Te+Le,Pe=_e+Le,Ge=ze+Le,Qe=Oe+Le,vt[Be]=_[W],Rt[Be]=_[Ye],Z=Z&&vt[Be]===Rt[Be],se=_[$],N=_[K],U=_[be],_[Pe]=se,_[Ge]=N,_[Qe]=U,++Be,Le+=l;for(ye=A*D,ue=A*m,Le=s,le=0;le<x;++le)$=ye+Le,W=ue+Le,_[$]=_[W],Le+=l;for(ye=A*R,ue=A*u,Le=s,le=0;le<x;++le)$=ye+Le,W=ue+Le,_[$]=_[W],Le+=l;if(Z)for(q=X;q<=Y;++q){$=s+q*A,Be=0;e:for(le=0;le<x;++le){if(ie=_[$]-vt[Be],ie!==0)break e;Be+=T,$+=L}if(ie!==0)if(ie<0){if(q!==X)for(ye=A*q,ue=A*X,Le=s,le=0;le<x;++le)$=ye+Le,W=ue+Le,oe=_[$],_[$]=_[W],_[W]=oe,Le+=l;++X}else for(;;){$=s+Y*A,Be=0;e:for(le=0;le<x;++le){if(ie=_[$]-vt[Be],ie!==0)break e;Be+=T,$+=L}if(ie>0)Y--;else if(ie<0){for(ye=A*q,ue=A*X,pe=A*Y,Le=s,le=0;le<x;++le)$=ye+Le,W=ue+Le,K=pe+Le,oe=_[$],_[$]=_[W],_[W]=_[K],_[K]=oe,Le+=l;++X,--Y;break}else{for(ye=A*q,ue=A*Y,Le=s,le=0;le<x;++le)$=ye+Le,W=ue+Le,oe=_[$],_[$]=_[W],_[W]=oe,Le+=l;--Y;break}}}else for(q=X;q<=Y;++q){$=s+q*A,Be=0;e:for(le=0;le<x;++le){if(ne=_[$]-vt[Be],ne!==0)break e;Be+=T,$+=L}if(ne<0){if(q!==X)for(ye=A*q,ue=A*X,Le=s,le=0;le<x;++le)$=ye+Le,W=ue+Le,oe=_[$],_[$]=_[W],_[W]=oe,Le+=l;++X}else{$=s+q*A,Be=0;e:for(le=0;le<x;++le){if(ae=_[$]-Rt[Be],ae!==0)break e;Be+=T,$+=L}if(ae>0)for(;;){$=s+Y*A,Be=0;e:for(le=0;le<x;++le){if(ie=_[$]-Rt[Be],ie!==0)break e;Be+=T,$+=L}if(ie>0){if(--Y<q)break;continue}else{$=s+Y*A,Be=0;e:for(le=0;le<x;++le){if(ie=_[$]-vt[Be],ie!==0)break e;Be+=T,$+=L}if(ie<0){for(ye=A*q,ue=A*X,pe=A*Y,Le=s,le=0;le<x;++le)$=ye+Le,W=ue+Le,K=pe+Le,oe=_[$],_[$]=_[W],_[W]=_[K],_[K]=oe,Le+=l;++X,--Y}else{for(ye=A*q,ue=A*Y,Le=s,le=0;le<x;++le)$=ye+Le,W=ue+Le,oe=_[$],_[$]=_[W],_[W]=oe,Le+=l;--Y}break}}}}for(ye=A*m,ue=A*(X-1),Be=0,Le=s,le=0;le<x;++le)$=ye+Le,W=ue+Le,_[$]=_[W],_[W]=vt[Be],++Be,Le+=l;for(ye=A*u,ue=A*(Y+1),Be=0,Le=s,le=0;le<x;++le)$=ye+Le,W=ue+Le,_[$]=_[W],_[W]=Rt[Be],++Be,Le+=l;if(X-2-m<=32?y(m,X-2,_,s,A,b,f,x,l,L,T):h(m,X-2,_,s,A,b,f,x,l,L,T),u-(Y+2)<=32?y(Y+2,u,_,s,A,b,f,x,l,L,T):h(Y+2,u,_,s,A,b,f,x,l,L,T),Z){g(vt),g(Rt);return}if(X<P&&Y>z){e:for(;;){for($=s+X*A,Be=0,Le=s,le=0;le<x;++le){if(_[$]!==vt[Be])break e;++Be,$+=l}++X}e:for(;;){for($=s+Y*A,Be=0,Le=s,le=0;le<x;++le){if(_[$]!==Rt[Be])break e;++Be,$+=l}--Y}for(q=X;q<=Y;++q){$=s+q*A,Be=0;e:for(le=0;le<x;++le){if(ne=_[$]-vt[Be],ne!==0)break e;Be+=T,$+=L}if(ne===0){if(q!==X)for(ye=A*q,ue=A*X,Le=s,le=0;le<x;++le)$=ye+Le,W=ue+Le,oe=_[$],_[$]=_[W],_[W]=oe,Le+=l;++X}else{$=s+q*A,Be=0;e:for(le=0;le<x;++le){if(ae=_[$]-Rt[Be],ae!==0)break e;Be+=T,$+=L}if(ae===0)for(;;){$=s+Y*A,Be=0;e:for(le=0;le<x;++le){if(ie=_[$]-Rt[Be],ie!==0)break e;Be+=T,$+=L}if(ie===0){if(--Y<q)break;continue}else{$=s+Y*A,Be=0;e:for(le=0;le<x;++le){if(ie=_[$]-vt[Be],ie!==0)break e;Be+=T,$+=L}if(ie<0){for(ye=A*q,ue=A*X,pe=A*Y,Le=s,le=0;le<x;++le)$=ye+Le,W=ue+Le,K=pe+Le,oe=_[$],_[$]=_[W],_[W]=_[K],_[K]=oe,Le+=l;++X,--Y}else{for(ye=A*q,ue=A*Y,Le=s,le=0;le<x;++le)$=ye+Le,W=ue+Le,oe=_[$],_[$]=_[W],_[W]=oe,Le+=l;--Y}break}}}}}g(vt),g(Rt),Y-X<=32?y(X,Y,_,s,A,b,f,x,l,L,T):h(X,Y,_,s,A,b,f,x,l,L,T)}}};function c(y,p,g){var h=a(p),m=[p,y].join(","),u=t[m];return y.length>1&&h?u(g,h[0],h[1]):u(g)}var o={"uint32,1,0":function(y,p){return function(g){var h=g.data,m=g.offset|0,u=g.shape,_=g.stride,s=_[0]|0,A=u[0]|0,b=_[1]|0,f=u[1]|0,x=b,l=b,L=1;A<=32?y(0,A-1,h,m,s,b,A,f,x,l,L):p(0,A-1,h,m,s,b,A,f,x,l,L)}}};function i(y,p){var g=[p,y].join(","),h=o[g],m=r(y,p),u=c(y,p,m);return h(m,u)}S.exports=i},{"typedarray-pool":308}],258:[function(v,S,M){var e=v("./lib/compile_sort.js"),a={};function n(r){var t=r.order,c=r.dtype,o=[t,c],i=o.join(":"),y=a[i];return y||(a[i]=y=e(t,c)),y(r),r}S.exports=n},{"./lib/compile_sort.js":257}],259:[function(v,S,M){var e=v("is-buffer"),a=typeof Float64Array<"u";function n(p,g){return p[0]-g[0]}function r(){var p=this.stride,g=new Array(p.length),h;for(h=0;h<g.length;++h)g[h]=[Math.abs(p[h]),h];g.sort(n);var m=new Array(g.length);for(h=0;h<m.length;++h)m[h]=g[h][1];return m}var t={T:function(p){function g(m){this.data=m}var h=g.prototype;return h.dtype=p,h.index=function(){return-1},h.size=0,h.dimension=-1,h.shape=h.stride=h.order=[],h.lo=h.hi=h.transpose=h.step=function(){return new g(this.data)},h.get=h.set=function(){},h.pick=function(){return null},function(u){return new g(u)}},0:function(p,g){function h(u,_){this.data=u,this.offset=_}var m=h.prototype;return m.dtype=p,m.index=function(){return this.offset},m.dimension=0,m.size=1,m.shape=m.stride=m.order=[],m.lo=m.hi=m.transpose=m.step=function(){return new h(this.data,this.offset)},m.pick=function(){return g(this.data)},m.valueOf=m.get=function(){return p==="generic"?this.data.get(this.offset):this.data[this.offset]},m.set=function(_){return p==="generic"?this.data.set(this.offset,_):this.data[this.offset]=_},function(_,s,A,b){return new h(_,b)}},1:function(p,g,h){function m(_,s,A,b){this.data=_,this.shape=[s],this.stride=[A],this.offset=b|0}var u=m.prototype;return u.dtype=p,u.dimension=1,Object.defineProperty(u,"size",{get:function(){return this.shape[0]}}),u.order=[0],u.set=function(s,A){return p==="generic"?this.data.set(this.offset+this.stride[0]*s,A):this.data[this.offset+this.stride[0]*s]=A},u.get=function(s){return p==="generic"?this.data.get(this.offset+this.stride[0]*s):this.data[this.offset+this.stride[0]*s]},u.index=function(s){return this.offset+this.stride[0]*s},u.hi=function(s){return new m(this.data,typeof s!="number"||s<0?this.shape[0]:s|0,this.stride[0],this.offset)},u.lo=function(s){var A=this.offset,b=0,f=this.shape[0],x=this.stride[0];return typeof s=="number"&&s>=0&&(b=s|0,A+=x*b,f-=b),new m(this.data,f,x,A)},u.step=function(s){var A=this.shape[0],b=this.stride[0],f=this.offset,x=0,l=Math.ceil;return typeof s=="number"&&(x=s|0,x<0?(f+=b*(A-1),A=l(-A/x)):A=l(A/x),b*=x),new m(this.data,A,b,f)},u.transpose=function(s){s=s===void 0?0:s|0;var A=this.shape,b=this.stride;return new m(this.data,A[s],b[s],this.offset)},u.pick=function(s){var A=[],b=[],f=this.offset;typeof s=="number"&&s>=0?f=f+this.stride[0]*s|0:(A.push(this.shape[0]),b.push(this.stride[0]));var x=g[A.length+1];return x(this.data,A,b,f)},function(s,A,b,f){return new m(s,A[0],b[0],f)}},2:function(p,g,h){function m(_,s,A,b,f,x){this.data=_,this.shape=[s,A],this.stride=[b,f],this.offset=x|0}var u=m.prototype;return u.dtype=p,u.dimension=2,Object.defineProperty(u,"size",{get:function(){return this.shape[0]*this.shape[1]}}),Object.defineProperty(u,"order",{get:function(){return Math.abs(this.stride[0])>Math.abs(this.stride[1])?[1,0]:[0,1]}}),u.set=function(s,A,b){return p==="generic"?this.data.set(this.offset+this.stride[0]*s+this.stride[1]*A,b):this.data[this.offset+this.stride[0]*s+this.stride[1]*A]=b},u.get=function(s,A){return p==="generic"?this.data.get(this.offset+this.stride[0]*s+this.stride[1]*A):this.data[this.offset+this.stride[0]*s+this.stride[1]*A]},u.index=function(s,A){return this.offset+this.stride[0]*s+this.stride[1]*A},u.hi=function(s,A){return new m(this.data,typeof s!="number"||s<0?this.shape[0]:s|0,typeof A!="number"||A<0?this.shape[1]:A|0,this.stride[0],this.stride[1],this.offset)},u.lo=function(s,A){var b=this.offset,f=0,x=this.shape[0],l=this.shape[1],L=this.stride[0],T=this.stride[1];return typeof s=="number"&&s>=0&&(f=s|0,b+=L*f,x-=f),typeof A=="number"&&A>=0&&(f=A|0,b+=T*f,l-=f),new m(this.data,x,l,L,T,b)},u.step=function(s,A){var b=this.shape[0],f=this.shape[1],x=this.stride[0],l=this.stride[1],L=this.offset,T=0,k=Math.ceil;return typeof s=="number"&&(T=s|0,T<0?(L+=x*(b-1),b=k(-b/T)):b=k(b/T),x*=T),typeof A=="number"&&(T=A|0,T<0?(L+=l*(f-1),f=k(-f/T)):f=k(f/T),l*=T),new m(this.data,b,f,x,l,L)},u.transpose=function(s,A){s=s===void 0?0:s|0,A=A===void 0?1:A|0;var b=this.shape,f=this.stride;return new m(this.data,b[s],b[A],f[s],f[A],this.offset)},u.pick=function(s,A){var b=[],f=[],x=this.offset;typeof s=="number"&&s>=0?x=x+this.stride[0]*s|0:(b.push(this.shape[0]),f.push(this.stride[0])),typeof A=="number"&&A>=0?x=x+this.stride[1]*A|0:(b.push(this.shape[1]),f.push(this.stride[1]));var l=g[b.length+1];return l(this.data,b,f,x)},function(s,A,b,f){return new m(s,A[0],A[1],b[0],b[1],f)}},3:function(p,g,h){function m(_,s,A,b,f,x,l,L){this.data=_,this.shape=[s,A,b],this.stride=[f,x,l],this.offset=L|0}var u=m.prototype;return u.dtype=p,u.dimension=3,Object.defineProperty(u,"size",{get:function(){return this.shape[0]*this.shape[1]*this.shape[2]}}),Object.defineProperty(u,"order",{get:function(){var s=Math.abs(this.stride[0]),A=Math.abs(this.stride[1]),b=Math.abs(this.stride[2]);return s>A?A>b?[2,1,0]:s>b?[1,2,0]:[1,0,2]:s>b?[2,0,1]:b>A?[0,1,2]:[0,2,1]}}),u.set=function(s,A,b,f){return p==="generic"?this.data.set(this.offset+this.stride[0]*s+this.stride[1]*A+this.stride[2]*b,f):this.data[this.offset+this.stride[0]*s+this.stride[1]*A+this.stride[2]*b]=f},u.get=function(s,A,b){return p==="generic"?this.data.get(this.offset+this.stride[0]*s+this.stride[1]*A+this.stride[2]*b):this.data[this.offset+this.stride[0]*s+this.stride[1]*A+this.stride[2]*b]},u.index=function(s,A,b){return this.offset+this.stride[0]*s+this.stride[1]*A+this.stride[2]*b},u.hi=function(s,A,b){return new m(this.data,typeof s!="number"||s<0?this.shape[0]:s|0,typeof A!="number"||A<0?this.shape[1]:A|0,typeof b!="number"||b<0?this.shape[2]:b|0,this.stride[0],this.stride[1],this.stride[2],this.offset)},u.lo=function(s,A,b){var f=this.offset,x=0,l=this.shape[0],L=this.shape[1],T=this.shape[2],k=this.stride[0],P=this.stride[1],z=this.stride[2];return typeof s=="number"&&s>=0&&(x=s|0,f+=k*x,l-=x),typeof A=="number"&&A>=0&&(x=A|0,f+=P*x,L-=x),typeof b=="number"&&b>=0&&(x=b|0,f+=z*x,T-=x),new m(this.data,l,L,T,k,P,z,f)},u.step=function(s,A,b){var f=this.shape[0],x=this.shape[1],l=this.shape[2],L=this.stride[0],T=this.stride[1],k=this.stride[2],P=this.offset,z=0,I=Math.ceil;return typeof s=="number"&&(z=s|0,z<0?(P+=L*(f-1),f=I(-f/z)):f=I(f/z),L*=z),typeof A=="number"&&(z=A|0,z<0?(P+=T*(x-1),x=I(-x/z)):x=I(x/z),T*=z),typeof b=="number"&&(z=b|0,z<0?(P+=k*(l-1),l=I(-l/z)):l=I(l/z),k*=z),new m(this.data,f,x,l,L,T,k,P)},u.transpose=function(s,A,b){s=s===void 0?0:s|0,A=A===void 0?1:A|0,b=b===void 0?2:b|0;var f=this.shape,x=this.stride;return new m(this.data,f[s],f[A],f[b],x[s],x[A],x[b],this.offset)},u.pick=function(s,A,b){var f=[],x=[],l=this.offset;typeof s=="number"&&s>=0?l=l+this.stride[0]*s|0:(f.push(this.shape[0]),x.push(this.stride[0])),typeof A=="number"&&A>=0?l=l+this.stride[1]*A|0:(f.push(this.shape[1]),x.push(this.stride[1])),typeof b=="number"&&b>=0?l=l+this.stride[2]*b|0:(f.push(this.shape[2]),x.push(this.stride[2]));var L=g[f.length+1];return L(this.data,f,x,l)},function(s,A,b,f){return new m(s,A[0],A[1],A[2],b[0],b[1],b[2],f)}},4:function(p,g,h){function m(_,s,A,b,f,x,l,L,T,k){this.data=_,this.shape=[s,A,b,f],this.stride=[x,l,L,T],this.offset=k|0}var u=m.prototype;return u.dtype=p,u.dimension=4,Object.defineProperty(u,"size",{get:function(){return this.shape[0]*this.shape[1]*this.shape[2]*this.shape[3]}}),Object.defineProperty(u,"order",{get:h}),u.set=function(s,A,b,f,x){return p==="generic"?this.data.set(this.offset+this.stride[0]*s+this.stride[1]*A+this.stride[2]*b+this.stride[3]*f,x):this.data[this.offset+this.stride[0]*s+this.stride[1]*A+this.stride[2]*b+this.stride[3]*f]=x},u.get=function(s,A,b,f){return p==="generic"?this.data.get(this.offset+this.stride[0]*s+this.stride[1]*A+this.stride[2]*b+this.stride[3]*f):this.data[this.offset+this.stride[0]*s+this.stride[1]*A+this.stride[2]*b+this.stride[3]*f]},u.index=function(s,A,b,f){return this.offset+this.stride[0]*s+this.stride[1]*A+this.stride[2]*b+this.stride[3]*f},u.hi=function(s,A,b,f){return new m(this.data,typeof s!="number"||s<0?this.shape[0]:s|0,typeof A!="number"||A<0?this.shape[1]:A|0,typeof b!="number"||b<0?this.shape[2]:b|0,typeof f!="number"||f<0?this.shape[3]:f|0,this.stride[0],this.stride[1],this.stride[2],this.stride[3],this.offset)},u.lo=function(s,A,b,f){var x=this.offset,l=0,L=this.shape[0],T=this.shape[1],k=this.shape[2],P=this.shape[3],z=this.stride[0],I=this.stride[1],D=this.stride[2],R=this.stride[3];return typeof s=="number"&&s>=0&&(l=s|0,x+=z*l,L-=l),typeof A=="number"&&A>=0&&(l=A|0,x+=I*l,T-=l),typeof b=="number"&&b>=0&&(l=b|0,x+=D*l,k-=l),typeof f=="number"&&f>=0&&(l=f|0,x+=R*l,P-=l),new m(this.data,L,T,k,P,z,I,D,R,x)},u.step=function(s,A,b,f){var x=this.shape[0],l=this.shape[1],L=this.shape[2],T=this.shape[3],k=this.stride[0],P=this.stride[1],z=this.stride[2],I=this.stride[3],D=this.offset,R=0,B=Math.ceil;return typeof s=="number"&&(R=s|0,R<0?(D+=k*(x-1),x=B(-x/R)):x=B(x/R),k*=R),typeof A=="number"&&(R=A|0,R<0?(D+=P*(l-1),l=B(-l/R)):l=B(l/R),P*=R),typeof b=="number"&&(R=b|0,R<0?(D+=z*(L-1),L=B(-L/R)):L=B(L/R),z*=R),typeof f=="number"&&(R=f|0,R<0?(D+=I*(T-1),T=B(-T/R)):T=B(T/R),I*=R),new m(this.data,x,l,L,T,k,P,z,I,D)},u.transpose=function(s,A,b,f){s=s===void 0?0:s|0,A=A===void 0?1:A|0,b=b===void 0?2:b|0,f=f===void 0?3:f|0;var x=this.shape,l=this.stride;return new m(this.data,x[s],x[A],x[b],x[f],l[s],l[A],l[b],l[f],this.offset)},u.pick=function(s,A,b,f){var x=[],l=[],L=this.offset;typeof s=="number"&&s>=0?L=L+this.stride[0]*s|0:(x.push(this.shape[0]),l.push(this.stride[0])),typeof A=="number"&&A>=0?L=L+this.stride[1]*A|0:(x.push(this.shape[1]),l.push(this.stride[1])),typeof b=="number"&&b>=0?L=L+this.stride[2]*b|0:(x.push(this.shape[2]),l.push(this.stride[2])),typeof f=="number"&&f>=0?L=L+this.stride[3]*f|0:(x.push(this.shape[3]),l.push(this.stride[3]));var T=g[x.length+1];return T(this.data,x,l,L)},function(s,A,b,f){return new m(s,A[0],A[1],A[2],A[3],b[0],b[1],b[2],b[3],f)}},5:function(g,h,m){function u(s,A,b,f,x,l,L,T,k,P,z,I){this.data=s,this.shape=[A,b,f,x,l],this.stride=[L,T,k,P,z],this.offset=I|0}var _=u.prototype;return _.dtype=g,_.dimension=5,Object.defineProperty(_,"size",{get:function(){return this.shape[0]*this.shape[1]*this.shape[2]*this.shape[3]*this.shape[4]}}),Object.defineProperty(_,"order",{get:m}),_.set=function(A,b,f,x,l,L){return g==="generic"?this.data.set(this.offset+this.stride[0]*A+this.stride[1]*b+this.stride[2]*f+this.stride[3]*x+this.stride[4]*l,L):this.data[this.offset+this.stride[0]*A+this.stride[1]*b+this.stride[2]*f+this.stride[3]*x+this.stride[4]*l]=L},_.get=function(A,b,f,x,l){return g==="generic"?this.data.get(this.offset+this.stride[0]*A+this.stride[1]*b+this.stride[2]*f+this.stride[3]*x+this.stride[4]*l):this.data[this.offset+this.stride[0]*A+this.stride[1]*b+this.stride[2]*f+this.stride[3]*x+this.stride[4]*l]},_.index=function(A,b,f,x,l){return this.offset+this.stride[0]*A+this.stride[1]*b+this.stride[2]*f+this.stride[3]*x+this.stride[4]*l},_.hi=function(A,b,f,x,l){return new u(this.data,typeof A!="number"||A<0?this.shape[0]:A|0,typeof b!="number"||b<0?this.shape[1]:b|0,typeof f!="number"||f<0?this.shape[2]:f|0,typeof x!="number"||x<0?this.shape[3]:x|0,typeof l!="number"||l<0?this.shape[4]:l|0,this.stride[0],this.stride[1],this.stride[2],this.stride[3],this.stride[4],this.offset)},_.lo=function(A,b,f,x,l){var L=this.offset,T=0,k=this.shape[0],P=this.shape[1],z=this.shape[2],I=this.shape[3],D=this.shape[4],R=this.stride[0],B=this.stride[1],F=this.stride[2],H=this.stride[3],G=this.stride[4];return typeof A=="number"&&A>=0&&(T=A|0,L+=R*T,k-=T),typeof b=="number"&&b>=0&&(T=b|0,L+=B*T,P-=T),typeof f=="number"&&f>=0&&(T=f|0,L+=F*T,z-=T),typeof x=="number"&&x>=0&&(T=x|0,L+=H*T,I-=T),typeof l=="number"&&l>=0&&(T=l|0,L+=G*T,D-=T),new u(this.data,k,P,z,I,D,R,B,F,H,G,L)},_.step=function(A,b,f,x,l){var L=this.shape[0],T=this.shape[1],k=this.shape[2],P=this.shape[3],z=this.shape[4],I=this.stride[0],D=this.stride[1],R=this.stride[2],B=this.stride[3],F=this.stride[4],H=this.offset,G=0,J=Math.ceil;return typeof A=="number"&&(G=A|0,G<0?(H+=I*(L-1),L=J(-L/G)):L=J(L/G),I*=G),typeof b=="number"&&(G=b|0,G<0?(H+=D*(T-1),T=J(-T/G)):T=J(T/G),D*=G),typeof f=="number"&&(G=f|0,G<0?(H+=R*(k-1),k=J(-k/G)):k=J(k/G),R*=G),typeof x=="number"&&(G=x|0,G<0?(H+=B*(P-1),P=J(-P/G)):P=J(P/G),B*=G),typeof l=="number"&&(G=l|0,G<0?(H+=F*(z-1),z=J(-z/G)):z=J(z/G),F*=G),new u(this.data,L,T,k,P,z,I,D,R,B,F,H)},_.transpose=function(A,b,f,x,l){A=A===void 0?0:A|0,b=b===void 0?1:b|0,f=f===void 0?2:f|0,x=x===void 0?3:x|0,l=l===void 0?4:l|0;var L=this.shape,T=this.stride;return new u(this.data,L[A],L[b],L[f],L[x],L[l],T[A],T[b],T[f],T[x],T[l],this.offset)},_.pick=function(A,b,f,x,l){var L=[],T=[],k=this.offset;typeof A=="number"&&A>=0?k=k+this.stride[0]*A|0:(L.push(this.shape[0]),T.push(this.stride[0])),typeof b=="number"&&b>=0?k=k+this.stride[1]*b|0:(L.push(this.shape[1]),T.push(this.stride[1])),typeof f=="number"&&f>=0?k=k+this.stride[2]*f|0:(L.push(this.shape[2]),T.push(this.stride[2])),typeof x=="number"&&x>=0?k=k+this.stride[3]*x|0:(L.push(this.shape[3]),T.push(this.stride[3])),typeof l=="number"&&l>=0?k=k+this.stride[4]*l|0:(L.push(this.shape[4]),T.push(this.stride[4]));var P=h[L.length+1];return P(this.data,L,T,k)},function(A,b,f,x){return new u(A,b[0],b[1],b[2],b[3],b[4],f[0],f[1],f[2],f[3],f[4],x)}}};function c(p,g){var h=g===-1?"T":String(g),m=t[h];return g===-1?m(p):g===0?m(p,i[p][0]):m(p,i[p],r)}function o(p){if(e(p))return"buffer";if(a)switch(Object.prototype.toString.call(p)){case"[object Float64Array]":return"float64";case"[object Float32Array]":return"float32";case"[object Int8Array]":return"int8";case"[object Int16Array]":return"int16";case"[object Int32Array]":return"int32";case"[object Uint8ClampedArray]":return"uint8_clamped";case"[object Uint8Array]":return"uint8";case"[object Uint16Array]":return"uint16";case"[object Uint32Array]":return"uint32";case"[object BigInt64Array]":return"bigint64";case"[object BigUint64Array]":return"biguint64"}return Array.isArray(p)?"array":"generic"}var i={generic:[],buffer:[],array:[],float32:[],float64:[],int8:[],int16:[],int32:[],uint8_clamped:[],uint8:[],uint16:[],uint32:[],bigint64:[],biguint64:[]};function y(p,g,h,m){if(p===void 0){var f=i.array[0];return f([])}else typeof p=="number"&&(p=[p]);g===void 0&&(g=[p.length]);var u=g.length;if(h===void 0){h=new Array(u);for(var _=u-1,s=1;_>=0;--_)h[_]=s,s*=g[_]}if(m===void 0){m=0;for(var _=0;_<u;++_)h[_]<0&&(m-=(g[_]-1)*h[_])}for(var A=o(p),b=i[A];b.length<=u+1;)b.push(c(A,b.length-1));var f=b[u+1];return f(p,g,h,m)}S.exports=y},{"is-buffer":237}],260:[function(v,S,M){var e=v("double-bits"),a=Math.pow(2,-1074),n=-1>>>0;S.exports=r;function r(t,c){if(isNaN(t)||isNaN(c))return NaN;if(t===c)return t;if(t===0)return c<0?-a:a;var o=e.hi(t),i=e.lo(t);return c>t==t>0?i===n?(o+=1,i=0):i+=1:i===0?(i=n,o-=1):i-=1,e.pack(i,o)}},{"double-bits":64}],261:[function(v,S,M){var e=1e-6,a=1e-6;M.vertexNormals=function(n,r,t){for(var c=r.length,o=new Array(c),i=t===void 0?e:t,y=0;y<c;++y)o[y]=[0,0,0];for(var y=0;y<n.length;++y)for(var p=n[y],g=0,h=p[p.length-1],m=p[0],u=0;u<p.length;++u){g=h,h=m,m=p[(u+1)%p.length];for(var _=r[g],s=r[h],A=r[m],b=new Array(3),f=0,x=new Array(3),l=0,L=0;L<3;++L)b[L]=_[L]-s[L],f+=b[L]*b[L],x[L]=A[L]-s[L],l+=x[L]*x[L];if(f*l>i)for(var T=o[h],k=1/Math.sqrt(f*l),L=0;L<3;++L){var P=(L+1)%3,z=(L+2)%3;T[L]+=k*(x[P]*b[z]-x[z]*b[P])}}for(var y=0;y<c;++y){for(var T=o[y],I=0,L=0;L<3;++L)I+=T[L]*T[L];if(I>i)for(var k=1/Math.sqrt(I),L=0;L<3;++L)T[L]*=k;else for(var L=0;L<3;++L)T[L]=0}return o},M.faceNormals=function(n,r,t){for(var c=n.length,o=new Array(c),i=t===void 0?a:t,y=0;y<c;++y){for(var p=n[y],g=new Array(3),h=0;h<3;++h)g[h]=r[p[h]];for(var m=new Array(3),u=new Array(3),h=0;h<3;++h)m[h]=g[1][h]-g[0][h],u[h]=g[2][h]-g[0][h];for(var _=new Array(3),s=0,h=0;h<3;++h){var A=(h+1)%3,b=(h+2)%3;_[h]=m[A]*u[b]-m[b]*u[A],s+=_[h]*_[h]}s>i?s=1/Math.sqrt(s):s=0;for(var h=0;h<3;++h)_[h]*=s;o[y]=_}return o}},{}],262:[function(v,S,M){S.exports=e;function e(a,n,r,t,c,o,i,y,p,g){var h=n+o+g;if(m>0){var m=Math.sqrt(h+1);a[0]=.5*(i-p)/m,a[1]=.5*(y-t)/m,a[2]=.5*(r-o)/m,a[3]=.5*m}else{var u=Math.max(n,o,g),m=Math.sqrt(2*u-h+1);n>=u?(a[0]=.5*m,a[1]=.5*(c+r)/m,a[2]=.5*(y+t)/m,a[3]=.5*(i-p)/m):o>=u?(a[0]=.5*(r+c)/m,a[1]=.5*m,a[2]=.5*(p+i)/m,a[3]=.5*(y-t)/m):(a[0]=.5*(t+y)/m,a[1]=.5*(i+p)/m,a[2]=.5*m,a[3]=.5*(r-c)/m)}return a}},{}],263:[function(v,S,M){S.exports=g;var e=v("filtered-vector"),a=v("gl-mat4/lookAt"),n=v("gl-mat4/fromQuat"),r=v("gl-mat4/invert"),t=v("./lib/quatFromFrame");function c(h,m,u){return Math.sqrt(Math.pow(h,2)+Math.pow(m,2)+Math.pow(u,2))}function o(h,m,u,_){return Math.sqrt(Math.pow(h,2)+Math.pow(m,2)+Math.pow(u,2)+Math.pow(_,2))}function i(h,m){var u=m[0],_=m[1],s=m[2],A=m[3],b=o(u,_,s,A);b>1e-6?(h[0]=u/b,h[1]=_/b,h[2]=s/b,h[3]=A/b):(h[0]=h[1]=h[2]=0,h[3]=1)}function y(h,m,u){this.radius=e([u]),this.center=e(m),this.rotation=e(h),this.computedRadius=this.radius.curve(0),this.computedCenter=this.center.curve(0),this.computedRotation=this.rotation.curve(0),this.computedUp=[.1,0,0],this.computedEye=[.1,0,0],this.computedMatrix=[.1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.recalcMatrix(0)}var p=y.prototype;p.lastT=function(){return Math.max(this.radius.lastT(),this.center.lastT(),this.rotation.lastT())},p.recalcMatrix=function(h){this.radius.curve(h),this.center.curve(h),this.rotation.curve(h);var m=this.computedRotation;i(m,m);var u=this.computedMatrix;n(u,m);var _=this.computedCenter,s=this.computedEye,A=this.computedUp,b=Math.exp(this.computedRadius[0]);s[0]=_[0]+b*u[2],s[1]=_[1]+b*u[6],s[2]=_[2]+b*u[10],A[0]=u[1],A[1]=u[5],A[2]=u[9];for(var f=0;f<3;++f){for(var x=0,l=0;l<3;++l)x+=u[f+4*l]*s[l];u[12+f]=-x}},p.getMatrix=function(h,m){this.recalcMatrix(h);var u=this.computedMatrix;if(m){for(var _=0;_<16;++_)m[_]=u[_];return m}return u},p.idle=function(h){this.center.idle(h),this.radius.idle(h),this.rotation.idle(h)},p.flush=function(h){this.center.flush(h),this.radius.flush(h),this.rotation.flush(h)},p.pan=function(h,m,u,_){m=m||0,u=u||0,_=_||0,this.recalcMatrix(h);var s=this.computedMatrix,A=s[1],b=s[5],f=s[9],x=c(A,b,f);A/=x,b/=x,f/=x;var l=s[0],L=s[4],T=s[8],k=l*A+L*b+T*f;l-=A*k,L-=b*k,T-=f*k;var P=c(l,L,T);l/=P,L/=P,T/=P,s[2],s[6],s[10];var z=l*m+A*u,I=L*m+b*u,D=T*m+f*u;this.center.move(h,z,I,D);var R=Math.exp(this.computedRadius[0]);R=Math.max(1e-4,R+_),this.radius.set(h,Math.log(R))},p.rotate=function(h,m,u,_){this.recalcMatrix(h),m=m||0,u=u||0;var s=this.computedMatrix,A=s[0],b=s[4],f=s[8],x=s[1],l=s[5],L=s[9],T=s[2],k=s[6],P=s[10],z=m*A+u*x,I=m*b+u*l,D=m*f+u*L,R=-(k*D-P*I),B=-(P*z-T*D),F=-(T*I-k*z),H=Math.sqrt(Math.max(0,1-Math.pow(R,2)-Math.pow(B,2)-Math.pow(F,2))),G=o(R,B,F,H);G>1e-6?(R/=G,B/=G,F/=G,H/=G):(R=B=F=0,H=1);var J=this.computedRotation,X=J[0],Y=J[1],Z=J[2],oe=J[3],re=X*H+oe*R+Y*F-Z*B,se=Y*H+oe*B+Z*R-X*F,N=Z*H+oe*F+X*B-Y*R,U=oe*H-X*R-Y*B-Z*F;if(_){R=T,B=k,F=P;var q=Math.sin(_)/c(R,B,F);R*=q,B*=q,F*=q,H=Math.cos(m),re=re*H+U*R+se*F-N*B,se=se*H+U*B+N*R-re*F,N=N*H+U*F+re*B-se*R,U=U*H-re*R-se*B-N*F}var $=o(re,se,N,U);$>1e-6?(re/=$,se/=$,N/=$,U/=$):(re=se=N=0,U=1),this.rotation.set(h,re,se,N,U)},p.lookAt=function(h,m,u,_){this.recalcMatrix(h),u=u||this.computedCenter,m=m||this.computedEye,_=_||this.computedUp;var s=this.computedMatrix;a(s,m,u,_);var A=this.computedRotation;t(A,s[0],s[1],s[2],s[4],s[5],s[6],s[8],s[9],s[10]),i(A,A),this.rotation.set(h,A[0],A[1],A[2],A[3]);for(var b=0,f=0;f<3;++f)b+=Math.pow(u[f]-m[f],2);this.radius.set(h,.5*Math.log(Math.max(b,1e-6))),this.center.set(h,u[0],u[1],u[2])},p.translate=function(h,m,u,_){this.center.move(h,m||0,u||0,_||0)},p.setMatrix=function(h,m){var u=this.computedRotation;t(u,m[0],m[1],m[2],m[4],m[5],m[6],m[8],m[9],m[10]),i(u,u),this.rotation.set(h,u[0],u[1],u[2],u[3]);var _=this.computedMatrix;r(_,m);var s=_[15];if(Math.abs(s)>1e-6){var A=_[12]/s,b=_[13]/s,f=_[14]/s;this.recalcMatrix(h);var x=Math.exp(this.computedRadius[0]);this.center.set(h,A-_[2]*x,b-_[6]*x,f-_[10]*x),this.radius.idle(h)}else this.center.idle(h),this.radius.idle(h)},p.setDistance=function(h,m){m>0&&this.radius.set(h,Math.log(m))},p.setDistanceLimits=function(h,m){h>0?h=Math.log(h):h=-1/0,m>0?m=Math.log(m):m=1/0,m=Math.max(m,h),this.radius.bounds[0][0]=h,this.radius.bounds[1][0]=m},p.getDistanceLimits=function(h){var m=this.radius.bounds;return h?(h[0]=Math.exp(m[0][0]),h[1]=Math.exp(m[1][0]),h):[Math.exp(m[0][0]),Math.exp(m[1][0])]},p.toJSON=function(){return this.recalcMatrix(this.lastT()),{center:this.computedCenter.slice(),rotation:this.computedRotation.slice(),distance:Math.log(this.computedRadius[0]),zoomMin:this.radius.bounds[0][0],zoomMax:this.radius.bounds[1][0]}},p.fromJSON=function(h){var m=this.lastT(),u=h.center;u&&this.center.set(m,u[0],u[1],u[2]);var _=h.rotation;_&&this.rotation.set(m,_[0],_[1],_[2],_[3]);var s=h.distance;s&&s>0&&this.radius.set(m,Math.log(s)),this.setDistanceLimits(h.zoomMin,h.zoomMax)};function g(h){h=h||{};var m=h.center||[0,0,0],u=h.rotation||[0,0,0,1],_=h.radius||1;m=[].slice.call(m,0,3),u=[].slice.call(u,0,4),i(u,u);var s=new y(u,m,Math.log(_));return s.setDistanceLimits(h.zoomMin,h.zoomMax),("eye"in h||"up"in h)&&s.lookAt(0,h.eye,h.center,h.up),s}},{"./lib/quatFromFrame":262,"filtered-vector":68,"gl-mat4/fromQuat":95,"gl-mat4/invert":98,"gl-mat4/lookAt":99}],264:[function(v,S,M){var e=v("repeat-string");S.exports=function(n,r,t){return t=typeof t<"u"?t+"":" ",e(t,r)+n}},{"repeat-string":277}],265:[function(v,S,M){S.exports=function(a,n){n||(n=[0,""]),a=String(a);var r=parseFloat(a,10);return n[0]=r,n[1]=a.match(/[\d.\-\+]*\s*(.*)/)[1]||"",n}},{}],266:[function(v,S,M){S.exports=a;var e=v("compare-angle");function a(n,r){for(var t=r.length|0,c=n.length,o=[new Array(t),new Array(t)],i=0;i<t;++i)o[0][i]=[],o[1][i]=[];for(var i=0;i<c;++i){var y=n[i];o[0][y[0]].push(y),o[1][y[1]].push(y)}for(var p=[],i=0;i<t;++i)o[0][i].length+o[1][i].length===0&&p.push([i]);function g(b,f){var x=o[f][b[f]];x.splice(x.indexOf(b),1)}function h(b,f,x){for(var l,L,T,k=0;k<2;++k)if(o[k][f].length>0){l=o[k][f][0],T=k;break}L=l[T^1];for(var P=0;P<2;++P)for(var z=o[P][f],I=0;I<z.length;++I){var D=z[I],R=D[P^1],B=e(r[b],r[f],r[L],r[R]);B>0&&(l=D,L=R,T=P)}return x||l&&g(l,T),L}function m(b,f){var x=o[f][b][0],l=[b];g(x,f);for(var L=x[f^1];;){for(;L!==b;)l.push(L),L=h(l[l.length-2],L,!1);if(o[0][b].length+o[1][b].length===0)break;var T=l[l.length-1],k=b,P=l[1],z=h(T,k,!0);if(e(r[T],r[k],r[P],r[z])<0)break;l.push(b),L=h(T,k)}return l}function u(b,f){return f[1]===f[f.length-1]}for(var i=0;i<t;++i)for(var _=0;_<2;++_){for(var s=[];o[_][i].length>0;){o[0][i].length;var A=m(i,_);u(s,A)?s.push.apply(s,A):(s.length>0&&p.push(s),s=A)}s.length>0&&p.push(s)}return p}},{"compare-angle":54}],267:[function(v,S,M){S.exports=a;var e=v("edges-to-adjacency-list");function a(n,r){for(var t=e(n,r.length),c=new Array(r.length),o=new Array(r.length),i=[],y=0;y<r.length;++y){var p=t[y].length;o[y]=p,c[y]=!0,p<=1&&i.push(y)}for(;i.length>0;){var g=i.pop();c[g]=!1;for(var h=t[g],y=0;y<h.length;++y){var m=h[y];--o[m]===0&&i.push(m)}}for(var u=new Array(r.length),_=[],y=0;y<r.length;++y)if(c[y]){var g=_.length;u[y]=g,_.push(r[y])}else u[y]=-1;for(var s=[],y=0;y<n.length;++y){var A=n[y];c[A[0]]&&c[A[1]]&&s.push([u[A[0]],u[A[1]]])}return[s,_]}},{"edges-to-adjacency-list":66}],268:[function(v,S,M){S.exports=p;var e=v("edges-to-adjacency-list"),a=v("planar-dual"),n=v("point-in-big-polygon"),r=v("two-product"),t=v("robust-sum"),c=v("uniq"),o=v("./lib/trim-leaves");function i(g,h){for(var m=new Array(g),u=0;u<g;++u)m[u]=h;return m}function y(g){for(var h=new Array(g),m=0;m<g;++m)h[m]=[];return h}function p(g,h){var U=o(g,h);g=U[0],h=U[1];var m=h.length;g.length;for(var u=e(g,h.length),_=0;_<m;++_)if(u[_].length%2===1)throw new Error("planar-graph-to-polyline: graph must be manifold");var s=a(g,h);function A(ie){for(var le=ie.length,ye=[0],ue=0;ue<le;++ue){var pe=h[ie[ue]],ge=h[ie[(ue+1)%le]],Te=r(-pe[0],pe[1]),_e=r(-pe[0],ge[1]),ze=r(ge[0],pe[1]),Oe=r(ge[0],ge[1]);ye=t(ye,t(t(Te,_e),t(ze,Oe)))}return ye[ye.length-1]>0}s=s.filter(A);for(var b=s.length,f=new Array(b),x=new Array(b),_=0;_<b;++_){f[_]=_;var l=new Array(b),L=s[_].map(function(le){return h[le]}),T=n([L]),k=0;e:for(var P=0;P<b;++P)if(l[P]=0,_!==P){for(var z=s[P],I=z.length,D=0;D<I;++D){var R=T(h[z[D]]);if(R!==0){R<0&&(l[P]=1,k+=1);continue e}}l[P]=1,k+=1}x[_]=[k,_,l]}x.sort(function(ie,le){return le[0]-ie[0]});for(var _=0;_<b;++_)for(var l=x[_],B=l[1],F=l[2],P=0;P<b;++P)F[P]&&(f[P]=B);for(var H=y(b),_=0;_<b;++_)H[_].push(f[_]),H[f[_]].push(_);for(var G={},J=i(m,!1),_=0;_<b;++_)for(var z=s[_],I=z.length,P=0;P<I;++P){var X=z[P],Y=z[(P+1)%I],Z=Math.min(X,Y)+":"+Math.max(X,Y);if(Z in G){var oe=G[Z];H[oe].push(_),H[_].push(oe),J[X]=J[Y]=!0}else G[Z]=_}function re(ie){for(var le=ie.length,ye=0;ye<le;++ye)if(!J[ie[ye]])return!1;return!0}for(var se=[],N=i(b,-1),_=0;_<b;++_)f[_]===_&&!re(s[_])?(se.push(_),N[_]=0):N[_]=-1;for(var U=[];se.length>0;){var q=se.pop(),$=H[q];c($,function(ie,le){return ie-le});var W=$.length,K=N[q],ne;if(K===0){var z=s[q];ne=[z]}for(var _=0;_<W;++_){var ae=$[_];if(!(N[ae]>=0)&&(N[ae]=K^1,se.push(ae),K===0)){var z=s[ae];re(z)||(z.reverse(),ne.push(z))}}K===0&&U.push(ne)}return U}},{"./lib/trim-leaves":267,"edges-to-adjacency-list":66,"planar-dual":266,"point-in-big-polygon":269,"robust-sum":289,"two-product":306,uniq:310}],269:[function(v,S,M){S.exports=h;var e=v("robust-orientation")[3],a=v("slab-decomposition"),n=v("interval-tree-1d"),r=v("binary-search-bounds");function t(){return!0}function c(m){return function(u,_){var s=m[u];return s?!!s.queryPoint(_,t):!1}}function o(m){for(var u={},_=0;_<m.length;++_){var s=m[_],A=s[0][0],b=s[0][1],f=s[1][1],x=[Math.min(b,f),Math.max(b,f)];A in u?u[A].push(x):u[A]=[x]}for(var l={},L=Object.keys(u),_=0;_<L.length;++_){var T=u[L[_]];l[L[_]]=n(T)}return c(l)}function i(m,u){return function(_){var s=r.le(u,_[0]);if(s<0)return 1;var A=m[s];if(!A)if(s>0&&u[s]===_[0])A=m[s-1];else return 1;for(var b=1;A;){var f=A.key,x=e(_,f[0],f[1]);if(f[0][0]<f[1][0])if(x<0)A=A.left;else if(x>0)b=-1,A=A.right;else return 0;else if(x>0)A=A.left;else if(x<0)b=1,A=A.right;else return 0}return b}}function y(m){return 1}function p(m){return function(_){return m(_[0],_[1])?0:1}}function g(m,u){return function(s){return m(s[0],s[1])?0:u(s)}}function h(m){for(var u=m.length,_=[],s=[],A=0;A<u;++A)for(var b=m[A],f=b.length,x=f-1,l=0;l<f;x=l++){var L=b[x],T=b[l];L[0]===T[0]?s.push([L,T]):_.push([L,T])}if(_.length===0)return s.length===0?y:p(o(s));var k=a(_),P=i(k.slabs,k.coordinates);return s.length===0?P:g(o(s),P)}},{"binary-search-bounds":31,"interval-tree-1d":234,"robust-orientation":284,"slab-decomposition":299}],270:[function(v,S,M){var e=new Float64Array(4),a=new Float64Array(4),n=new Float64Array(4);function r(t,c,o,i,y){e.length<i.length&&(e=new Float64Array(i.length),a=new Float64Array(i.length),n=new Float64Array(i.length));for(var p=0;p<i.length;++p)e[p]=t[p]-i[p],a[p]=c[p]-t[p],n[p]=o[p]-t[p];for(var g=0,h=0,m=0,u=0,_=0,s=0,p=0;p<i.length;++p){var A=a[p],b=n[p],f=e[p];g+=A*A,h+=A*b,m+=b*b,u+=f*A,_+=f*b,s+=f*f}var x=Math.abs(g*m-h*h),l=h*_-m*u,L=h*u-g*_,T;if(l+L<=x)if(l<0)L<0&&u<0?(L=0,-u>=g?(l=1,T=g+2*u+s):(l=-u/g,T=u*l+s)):(l=0,_>=0?(L=0,T=s):-_>=m?(L=1,T=m+2*_+s):(L=-_/m,T=_*L+s));else if(L<0)L=0,u>=0?(l=0,T=s):-u>=g?(l=1,T=g+2*u+s):(l=-u/g,T=u*l+s);else{var k=1/x;l*=k,L*=k,T=l*(g*l+h*L+2*u)+L*(h*l+m*L+2*_)+s}else{var P,z,I,D;l<0?(P=h+u,z=m+_,z>P?(I=z-P,D=g-2*h+m,I>=D?(l=1,L=0,T=g+2*u+s):(l=I/D,L=1-l,T=l*(g*l+h*L+2*u)+L*(h*l+m*L+2*_)+s)):(l=0,z<=0?(L=1,T=m+2*_+s):_>=0?(L=0,T=s):(L=-_/m,T=_*L+s))):L<0?(P=h+_,z=g+u,z>P?(I=z-P,D=g-2*h+m,I>=D?(L=1,l=0,T=m+2*_+s):(L=I/D,l=1-L,T=l*(g*l+h*L+2*u)+L*(h*l+m*L+2*_)+s)):(L=0,z<=0?(l=1,T=g+2*u+s):u>=0?(l=0,T=s):(l=-u/g,T=u*l+s))):(I=m+_-h-u,I<=0?(l=0,L=1,T=m+2*_+s):(D=g-2*h+m,I>=D?(l=1,L=0,T=g+2*u+s):(l=I/D,L=1-l,T=l*(g*l+h*L+2*u)+L*(h*l+m*L+2*_)+s)))}for(var R=1-l-L,p=0;p<i.length;++p)y[p]=R*t[p]+l*c[p]+L*o[p];return T<0?0:T}S.exports=r},{}],271:[function(v,S,M){S.exports=v("gl-quat/slerp")},{"gl-quat/slerp":124}],272:[function(v,S,M){var e=v("big-rat/add");S.exports=a;function a(n,r){for(var t=n.length,c=new Array(t),o=0;o<t;++o)c[o]=e(n[o],r[o]);return c}},{"big-rat/add":15}],273:[function(v,S,M){S.exports=a;var e=v("big-rat");function a(n){for(var r=new Array(n.length),t=0;t<n.length;++t)r[t]=e(n[t]);return r}},{"big-rat":18}],274:[function(v,S,M){var e=v("big-rat"),a=v("big-rat/mul");S.exports=n;function n(r,t){for(var c=e(t),o=r.length,i=new Array(o),y=0;y<o;++y)i[y]=a(r[y],c);return i}},{"big-rat":18,"big-rat/mul":27}],275:[function(v,S,M){var e=v("big-rat/sub");S.exports=a;function a(n,r){for(var t=n.length,c=new Array(t),o=0;o<t;++o)c[o]=e(n[o],r[o]);return c}},{"big-rat/sub":29}],276:[function(v,S,M){var e=v("compare-cell"),a=v("compare-oriented-cell"),n=v("cell-orientation");S.exports=r;function r(t){t.sort(a);for(var c=t.length,o=0,i=0;i<c;++i){var y=t[i],p=n(y);if(p!==0){if(o>0){var g=t[o-1];if(e(y,g)===0&&n(g)!==p){o-=1;continue}}t[o++]=y}}return t.length=o,t}},{"cell-orientation":47,"compare-cell":56,"compare-oriented-cell":57}],277:[function(v,S,M){var e="",a;S.exports=n;function n(r,t){if(typeof r!="string")throw new TypeError("expected a string");if(t===1)return r;if(t===2)return r+r;var c=r.length*t;if(a!==r||typeof a>"u")a=r,e="";else if(e.length>=c)return e.substr(0,c);for(;c>e.length&&t>1;)t&1&&(e+=r),t>>=1,r+=r;return e+=r,e=e.substr(0,c),e}},{}],278:[function(v,S,M){(function(e){(function(){S.exports=e.performance&&e.performance.now?function(){return performance.now()}:Date.now||function(){return+new Date}}).call(this)}).call(this,typeof w<"u"?w:typeof self<"u"?self:typeof window<"u"?window:{})},{}],279:[function(v,S,M){S.exports=e;function e(a){for(var n=a.length,r=a[a.length-1],t=n,c=n-2;c>=0;--c){var o=r,i=a[c];r=o+i;var y=r-o,p=i-y;p&&(a[--t]=r,r=p)}for(var g=0,c=t;c<n;++c){var o=a[c],i=r;r=o+i;var y=r-o,p=i-y;p&&(a[g++]=p)}return a[g++]=r,a.length=g,a}},{}],280:[function(v,S,M){var e=v("two-product"),a=v("robust-sum"),n=v("robust-scale"),r=v("robust-compress"),t=6;function c(u,_,s,A){return function(f){return A(u(s(f[0][0],f[1][1]),s(-f[0][1],f[1][0])))}}function o(u,_,s,A){return function(f){return A(u(_(u(s(f[1][1],f[2][2]),s(-f[1][2],f[2][1])),f[0][0]),u(_(u(s(f[1][0],f[2][2]),s(-f[1][2],f[2][0])),-f[0][1]),_(u(s(f[1][0],f[2][1]),s(-f[1][1],f[2][0])),f[0][2]))))}}function i(u,_,s,A){return function(f){return A(u(u(_(u(_(u(s(f[2][2],f[3][3]),s(-f[2][3],f[3][2])),f[1][1]),u(_(u(s(f[2][1],f[3][3]),s(-f[2][3],f[3][1])),-f[1][2]),_(u(s(f[2][1],f[3][2]),s(-f[2][2],f[3][1])),f[1][3]))),f[0][0]),_(u(_(u(s(f[2][2],f[3][3]),s(-f[2][3],f[3][2])),f[1][0]),u(_(u(s(f[2][0],f[3][3]),s(-f[2][3],f[3][0])),-f[1][2]),_(u(s(f[2][0],f[3][2]),s(-f[2][2],f[3][0])),f[1][3]))),-f[0][1])),u(_(u(_(u(s(f[2][1],f[3][3]),s(-f[2][3],f[3][1])),f[1][0]),u(_(u(s(f[2][0],f[3][3]),s(-f[2][3],f[3][0])),-f[1][1]),_(u(s(f[2][0],f[3][1]),s(-f[2][1],f[3][0])),f[1][3]))),f[0][2]),_(u(_(u(s(f[2][1],f[3][2]),s(-f[2][2],f[3][1])),f[1][0]),u(_(u(s(f[2][0],f[3][2]),s(-f[2][2],f[3][0])),-f[1][1]),_(u(s(f[2][0],f[3][1]),s(-f[2][1],f[3][0])),f[1][2]))),-f[0][3]))))}}function y(u,_,s,A){return function(f){return A(u(u(_(u(u(_(u(_(u(s(f[3][3],f[4][4]),s(-f[3][4],f[4][3])),f[2][2]),u(_(u(s(f[3][2],f[4][4]),s(-f[3][4],f[4][2])),-f[2][3]),_(u(s(f[3][2],f[4][3]),s(-f[3][3],f[4][2])),f[2][4]))),f[1][1]),_(u(_(u(s(f[3][3],f[4][4]),s(-f[3][4],f[4][3])),f[2][1]),u(_(u(s(f[3][1],f[4][4]),s(-f[3][4],f[4][1])),-f[2][3]),_(u(s(f[3][1],f[4][3]),s(-f[3][3],f[4][1])),f[2][4]))),-f[1][2])),u(_(u(_(u(s(f[3][2],f[4][4]),s(-f[3][4],f[4][2])),f[2][1]),u(_(u(s(f[3][1],f[4][4]),s(-f[3][4],f[4][1])),-f[2][2]),_(u(s(f[3][1],f[4][2]),s(-f[3][2],f[4][1])),f[2][4]))),f[1][3]),_(u(_(u(s(f[3][2],f[4][3]),s(-f[3][3],f[4][2])),f[2][1]),u(_(u(s(f[3][1],f[4][3]),s(-f[3][3],f[4][1])),-f[2][2]),_(u(s(f[3][1],f[4][2]),s(-f[3][2],f[4][1])),f[2][3]))),-f[1][4]))),f[0][0]),_(u(u(_(u(_(u(s(f[3][3],f[4][4]),s(-f[3][4],f[4][3])),f[2][2]),u(_(u(s(f[3][2],f[4][4]),s(-f[3][4],f[4][2])),-f[2][3]),_(u(s(f[3][2],f[4][3]),s(-f[3][3],f[4][2])),f[2][4]))),f[1][0]),_(u(_(u(s(f[3][3],f[4][4]),s(-f[3][4],f[4][3])),f[2][0]),u(_(u(s(f[3][0],f[4][4]),s(-f[3][4],f[4][0])),-f[2][3]),_(u(s(f[3][0],f[4][3]),s(-f[3][3],f[4][0])),f[2][4]))),-f[1][2])),u(_(u(_(u(s(f[3][2],f[4][4]),s(-f[3][4],f[4][2])),f[2][0]),u(_(u(s(f[3][0],f[4][4]),s(-f[3][4],f[4][0])),-f[2][2]),_(u(s(f[3][0],f[4][2]),s(-f[3][2],f[4][0])),f[2][4]))),f[1][3]),_(u(_(u(s(f[3][2],f[4][3]),s(-f[3][3],f[4][2])),f[2][0]),u(_(u(s(f[3][0],f[4][3]),s(-f[3][3],f[4][0])),-f[2][2]),_(u(s(f[3][0],f[4][2]),s(-f[3][2],f[4][0])),f[2][3]))),-f[1][4]))),-f[0][1])),u(_(u(u(_(u(_(u(s(f[3][3],f[4][4]),s(-f[3][4],f[4][3])),f[2][1]),u(_(u(s(f[3][1],f[4][4]),s(-f[3][4],f[4][1])),-f[2][3]),_(u(s(f[3][1],f[4][3]),s(-f[3][3],f[4][1])),f[2][4]))),f[1][0]),_(u(_(u(s(f[3][3],f[4][4]),s(-f[3][4],f[4][3])),f[2][0]),u(_(u(s(f[3][0],f[4][4]),s(-f[3][4],f[4][0])),-f[2][3]),_(u(s(f[3][0],f[4][3]),s(-f[3][3],f[4][0])),f[2][4]))),-f[1][1])),u(_(u(_(u(s(f[3][1],f[4][4]),s(-f[3][4],f[4][1])),f[2][0]),u(_(u(s(f[3][0],f[4][4]),s(-f[3][4],f[4][0])),-f[2][1]),_(u(s(f[3][0],f[4][1]),s(-f[3][1],f[4][0])),f[2][4]))),f[1][3]),_(u(_(u(s(f[3][1],f[4][3]),s(-f[3][3],f[4][1])),f[2][0]),u(_(u(s(f[3][0],f[4][3]),s(-f[3][3],f[4][0])),-f[2][1]),_(u(s(f[3][0],f[4][1]),s(-f[3][1],f[4][0])),f[2][3]))),-f[1][4]))),f[0][2]),u(_(u(u(_(u(_(u(s(f[3][2],f[4][4]),s(-f[3][4],f[4][2])),f[2][1]),u(_(u(s(f[3][1],f[4][4]),s(-f[3][4],f[4][1])),-f[2][2]),_(u(s(f[3][1],f[4][2]),s(-f[3][2],f[4][1])),f[2][4]))),f[1][0]),_(u(_(u(s(f[3][2],f[4][4]),s(-f[3][4],f[4][2])),f[2][0]),u(_(u(s(f[3][0],f[4][4]),s(-f[3][4],f[4][0])),-f[2][2]),_(u(s(f[3][0],f[4][2]),s(-f[3][2],f[4][0])),f[2][4]))),-f[1][1])),u(_(u(_(u(s(f[3][1],f[4][4]),s(-f[3][4],f[4][1])),f[2][0]),u(_(u(s(f[3][0],f[4][4]),s(-f[3][4],f[4][0])),-f[2][1]),_(u(s(f[3][0],f[4][1]),s(-f[3][1],f[4][0])),f[2][4]))),f[1][2]),_(u(_(u(s(f[3][1],f[4][2]),s(-f[3][2],f[4][1])),f[2][0]),u(_(u(s(f[3][0],f[4][2]),s(-f[3][2],f[4][0])),-f[2][1]),_(u(s(f[3][0],f[4][1]),s(-f[3][1],f[4][0])),f[2][2]))),-f[1][4]))),-f[0][3]),_(u(u(_(u(_(u(s(f[3][2],f[4][3]),s(-f[3][3],f[4][2])),f[2][1]),u(_(u(s(f[3][1],f[4][3]),s(-f[3][3],f[4][1])),-f[2][2]),_(u(s(f[3][1],f[4][2]),s(-f[3][2],f[4][1])),f[2][3]))),f[1][0]),_(u(_(u(s(f[3][2],f[4][3]),s(-f[3][3],f[4][2])),f[2][0]),u(_(u(s(f[3][0],f[4][3]),s(-f[3][3],f[4][0])),-f[2][2]),_(u(s(f[3][0],f[4][2]),s(-f[3][2],f[4][0])),f[2][3]))),-f[1][1])),u(_(u(_(u(s(f[3][1],f[4][3]),s(-f[3][3],f[4][1])),f[2][0]),u(_(u(s(f[3][0],f[4][3]),s(-f[3][3],f[4][0])),-f[2][1]),_(u(s(f[3][0],f[4][1]),s(-f[3][1],f[4][0])),f[2][3]))),f[1][2]),_(u(_(u(s(f[3][1],f[4][2]),s(-f[3][2],f[4][1])),f[2][0]),u(_(u(s(f[3][0],f[4][2]),s(-f[3][2],f[4][0])),-f[2][1]),_(u(s(f[3][0],f[4][1]),s(-f[3][1],f[4][0])),f[2][2]))),-f[1][3]))),f[0][4])))))}}function p(u){var _=u===2?c:u===3?o:u===4?i:u===5?y:void 0;return _(a,n,e,r)}var g=[function(){return[0]},function(_){return[_[0][0]]}];function h(u,_,s,A,b,f,x,l){return function(T){switch(T.length){case 0:return u(T);case 1:return _(T);case 2:return s(T);case 3:return A(T);case 4:return b(T);case 5:return f(T)}var k=x[T.length];return k||(k=x[T.length]=l(T.length)),k(T)}}function m(){for(;g.length<t;)g.push(p(g.length));S.exports=h.apply(void 0,g.concat([g,p]));for(var u=0;u<g.length;++u)S.exports[u]=g[u]}m()},{"robust-compress":279,"robust-scale":286,"robust-sum":289,"two-product":306}],281:[function(v,S,M){var e=v("two-product"),a=v("robust-sum");S.exports=n;function n(r,t){for(var c=e(r[0],t[0]),o=1;o<r.length;++o)c=a(c,e(r[o],t[o]));return c}},{"robust-sum":289,"two-product":306}],282:[function(v,S,M){var e=v("two-product"),a=v("robust-sum"),n=v("robust-subtract"),r=v("robust-scale"),t=6;function c(b){var f=b===3?p:b===4?g:b===5?h:m;return f(a,n,e,r)}function o(){return 0}function i(){return 0}function y(){return 0}function p(b,f,x,l){function L(T,k,P){var z=x(T[0],T[0]),I=l(z,k[0]),D=l(z,P[0]),R=x(k[0],k[0]),B=l(R,T[0]),F=l(R,P[0]),H=x(P[0],P[0]),G=l(H,T[0]),J=l(H,k[0]),X=b(f(J,F),f(B,I)),Y=f(G,D),Z=f(X,Y);return Z[Z.length-1]}return L}function g(b,f,x,l){function L(T,k,P,z){var I=b(x(T[0],T[0]),x(T[1],T[1])),D=l(I,k[0]),R=l(I,P[0]),B=l(I,z[0]),F=b(x(k[0],k[0]),x(k[1],k[1])),H=l(F,T[0]),G=l(F,P[0]),J=l(F,z[0]),X=b(x(P[0],P[0]),x(P[1],P[1])),Y=l(X,T[0]),Z=l(X,k[0]),oe=l(X,z[0]),re=b(x(z[0],z[0]),x(z[1],z[1])),se=l(re,T[0]),N=l(re,k[0]),U=l(re,P[0]),q=b(b(l(f(U,oe),k[1]),b(l(f(N,J),-P[1]),l(f(Z,G),z[1]))),b(l(f(N,J),T[1]),b(l(f(se,B),-k[1]),l(f(H,D),z[1])))),$=b(b(l(f(U,oe),T[1]),b(l(f(se,B),-P[1]),l(f(Y,R),z[1]))),b(l(f(Z,G),T[1]),b(l(f(Y,R),-k[1]),l(f(H,D),P[1])))),W=f(q,$);return W[W.length-1]}return L}function h(b,f,x,l){function L(T,k,P,z,I){var D=b(x(T[0],T[0]),b(x(T[1],T[1]),x(T[2],T[2]))),R=l(D,k[0]),B=l(D,P[0]),F=l(D,z[0]),H=l(D,I[0]),G=b(x(k[0],k[0]),b(x(k[1],k[1]),x(k[2],k[2]))),J=l(G,T[0]),X=l(G,P[0]),Y=l(G,z[0]),Z=l(G,I[0]),oe=b(x(P[0],P[0]),b(x(P[1],P[1]),x(P[2],P[2]))),re=l(oe,T[0]),se=l(oe,k[0]),N=l(oe,z[0]),U=l(oe,I[0]),q=b(x(z[0],z[0]),b(x(z[1],z[1]),x(z[2],z[2]))),$=l(q,T[0]),W=l(q,k[0]),K=l(q,P[0]),ne=l(q,I[0]),ae=b(x(I[0],I[0]),b(x(I[1],I[1]),x(I[2],I[2]))),ie=l(ae,T[0]),le=l(ae,k[0]),ye=l(ae,P[0]),ue=l(ae,z[0]),pe=b(b(b(l(b(l(f(ue,ne),P[1]),b(l(f(ye,U),-z[1]),l(f(K,N),I[1]))),k[2]),b(l(b(l(f(ue,ne),k[1]),b(l(f(le,Z),-z[1]),l(f(W,Y),I[1]))),-P[2]),l(b(l(f(ye,U),k[1]),b(l(f(le,Z),-P[1]),l(f(se,X),I[1]))),z[2]))),b(l(b(l(f(K,N),k[1]),b(l(f(W,Y),-P[1]),l(f(se,X),z[1]))),-I[2]),b(l(b(l(f(ue,ne),k[1]),b(l(f(le,Z),-z[1]),l(f(W,Y),I[1]))),T[2]),l(b(l(f(ue,ne),T[1]),b(l(f(ie,H),-z[1]),l(f($,F),I[1]))),-k[2])))),b(b(l(b(l(f(le,Z),T[1]),b(l(f(ie,H),-k[1]),l(f(J,R),I[1]))),z[2]),b(l(b(l(f(W,Y),T[1]),b(l(f($,F),-k[1]),l(f(J,R),z[1]))),-I[2]),l(b(l(f(K,N),k[1]),b(l(f(W,Y),-P[1]),l(f(se,X),z[1]))),T[2]))),b(l(b(l(f(K,N),T[1]),b(l(f($,F),-P[1]),l(f(re,B),z[1]))),-k[2]),b(l(b(l(f(W,Y),T[1]),b(l(f($,F),-k[1]),l(f(J,R),z[1]))),P[2]),l(b(l(f(se,X),T[1]),b(l(f(re,B),-k[1]),l(f(J,R),P[1]))),-z[2]))))),ge=b(b(b(l(b(l(f(ue,ne),P[1]),b(l(f(ye,U),-z[1]),l(f(K,N),I[1]))),T[2]),l(b(l(f(ue,ne),T[1]),b(l(f(ie,H),-z[1]),l(f($,F),I[1]))),-P[2])),b(l(b(l(f(ye,U),T[1]),b(l(f(ie,H),-P[1]),l(f(re,B),I[1]))),z[2]),l(b(l(f(K,N),T[1]),b(l(f($,F),-P[1]),l(f(re,B),z[1]))),-I[2]))),b(b(l(b(l(f(ye,U),k[1]),b(l(f(le,Z),-P[1]),l(f(se,X),I[1]))),T[2]),l(b(l(f(ye,U),T[1]),b(l(f(ie,H),-P[1]),l(f(re,B),I[1]))),-k[2])),b(l(b(l(f(le,Z),T[1]),b(l(f(ie,H),-k[1]),l(f(J,R),I[1]))),P[2]),l(b(l(f(se,X),T[1]),b(l(f(re,B),-k[1]),l(f(J,R),P[1]))),-I[2])))),Te=f(pe,ge);return Te[Te.length-1]}return L}function m(b,f,x,l){function L(T,k,P,z,I,D){var R=b(b(x(T[0],T[0]),x(T[1],T[1])),b(x(T[2],T[2]),x(T[3],T[3]))),B=l(R,k[0]),F=l(R,P[0]),H=l(R,z[0]),G=l(R,I[0]),J=l(R,D[0]),X=b(b(x(k[0],k[0]),x(k[1],k[1])),b(x(k[2],k[2]),x(k[3],k[3]))),Y=l(X,T[0]),Z=l(X,P[0]),oe=l(X,z[0]),re=l(X,I[0]),se=l(X,D[0]),N=b(b(x(P[0],P[0]),x(P[1],P[1])),b(x(P[2],P[2]),x(P[3],P[3]))),U=l(N,T[0]),q=l(N,k[0]),$=l(N,z[0]),W=l(N,I[0]),K=l(N,D[0]),ne=b(b(x(z[0],z[0]),x(z[1],z[1])),b(x(z[2],z[2]),x(z[3],z[3]))),ae=l(ne,T[0]),ie=l(ne,k[0]),le=l(ne,P[0]),ye=l(ne,I[0]),ue=l(ne,D[0]),pe=b(b(x(I[0],I[0]),x(I[1],I[1])),b(x(I[2],I[2]),x(I[3],I[3]))),ge=l(pe,T[0]),Te=l(pe,k[0]),_e=l(pe,P[0]),ze=l(pe,z[0]),Oe=l(pe,D[0]),Ye=b(b(x(D[0],D[0]),x(D[1],D[1])),b(x(D[2],D[2]),x(D[3],D[3]))),be=l(Ye,T[0]),Pe=l(Ye,k[0]),Ge=l(Ye,P[0]),Qe=l(Ye,z[0]),Be=l(Ye,I[0]),Le=b(b(b(l(b(b(l(b(l(f(Be,Oe),z[1]),b(l(f(Qe,ue),-I[1]),l(f(ze,ye),D[1]))),P[2]),l(b(l(f(Be,Oe),P[1]),b(l(f(Ge,K),-I[1]),l(f(_e,W),D[1]))),-z[2])),b(l(b(l(f(Qe,ue),P[1]),b(l(f(Ge,K),-z[1]),l(f(le,$),D[1]))),I[2]),l(b(l(f(ze,ye),P[1]),b(l(f(_e,W),-z[1]),l(f(le,$),I[1]))),-D[2]))),k[3]),b(l(b(b(l(b(l(f(Be,Oe),z[1]),b(l(f(Qe,ue),-I[1]),l(f(ze,ye),D[1]))),k[2]),l(b(l(f(Be,Oe),k[1]),b(l(f(Pe,se),-I[1]),l(f(Te,re),D[1]))),-z[2])),b(l(b(l(f(Qe,ue),k[1]),b(l(f(Pe,se),-z[1]),l(f(ie,oe),D[1]))),I[2]),l(b(l(f(ze,ye),k[1]),b(l(f(Te,re),-z[1]),l(f(ie,oe),I[1]))),-D[2]))),-P[3]),l(b(b(l(b(l(f(Be,Oe),P[1]),b(l(f(Ge,K),-I[1]),l(f(_e,W),D[1]))),k[2]),l(b(l(f(Be,Oe),k[1]),b(l(f(Pe,se),-I[1]),l(f(Te,re),D[1]))),-P[2])),b(l(b(l(f(Ge,K),k[1]),b(l(f(Pe,se),-P[1]),l(f(q,Z),D[1]))),I[2]),l(b(l(f(_e,W),k[1]),b(l(f(Te,re),-P[1]),l(f(q,Z),I[1]))),-D[2]))),z[3]))),b(b(l(b(b(l(b(l(f(Qe,ue),P[1]),b(l(f(Ge,K),-z[1]),l(f(le,$),D[1]))),k[2]),l(b(l(f(Qe,ue),k[1]),b(l(f(Pe,se),-z[1]),l(f(ie,oe),D[1]))),-P[2])),b(l(b(l(f(Ge,K),k[1]),b(l(f(Pe,se),-P[1]),l(f(q,Z),D[1]))),z[2]),l(b(l(f(le,$),k[1]),b(l(f(ie,oe),-P[1]),l(f(q,Z),z[1]))),-D[2]))),-I[3]),l(b(b(l(b(l(f(ze,ye),P[1]),b(l(f(_e,W),-z[1]),l(f(le,$),I[1]))),k[2]),l(b(l(f(ze,ye),k[1]),b(l(f(Te,re),-z[1]),l(f(ie,oe),I[1]))),-P[2])),b(l(b(l(f(_e,W),k[1]),b(l(f(Te,re),-P[1]),l(f(q,Z),I[1]))),z[2]),l(b(l(f(le,$),k[1]),b(l(f(ie,oe),-P[1]),l(f(q,Z),z[1]))),-I[2]))),D[3])),b(l(b(b(l(b(l(f(Be,Oe),z[1]),b(l(f(Qe,ue),-I[1]),l(f(ze,ye),D[1]))),k[2]),l(b(l(f(Be,Oe),k[1]),b(l(f(Pe,se),-I[1]),l(f(Te,re),D[1]))),-z[2])),b(l(b(l(f(Qe,ue),k[1]),b(l(f(Pe,se),-z[1]),l(f(ie,oe),D[1]))),I[2]),l(b(l(f(ze,ye),k[1]),b(l(f(Te,re),-z[1]),l(f(ie,oe),I[1]))),-D[2]))),T[3]),l(b(b(l(b(l(f(Be,Oe),z[1]),b(l(f(Qe,ue),-I[1]),l(f(ze,ye),D[1]))),T[2]),l(b(l(f(Be,Oe),T[1]),b(l(f(be,J),-I[1]),l(f(ge,G),D[1]))),-z[2])),b(l(b(l(f(Qe,ue),T[1]),b(l(f(be,J),-z[1]),l(f(ae,H),D[1]))),I[2]),l(b(l(f(ze,ye),T[1]),b(l(f(ge,G),-z[1]),l(f(ae,H),I[1]))),-D[2]))),-k[3])))),b(b(b(l(b(b(l(b(l(f(Be,Oe),k[1]),b(l(f(Pe,se),-I[1]),l(f(Te,re),D[1]))),T[2]),l(b(l(f(Be,Oe),T[1]),b(l(f(be,J),-I[1]),l(f(ge,G),D[1]))),-k[2])),b(l(b(l(f(Pe,se),T[1]),b(l(f(be,J),-k[1]),l(f(Y,B),D[1]))),I[2]),l(b(l(f(Te,re),T[1]),b(l(f(ge,G),-k[1]),l(f(Y,B),I[1]))),-D[2]))),z[3]),l(b(b(l(b(l(f(Qe,ue),k[1]),b(l(f(Pe,se),-z[1]),l(f(ie,oe),D[1]))),T[2]),l(b(l(f(Qe,ue),T[1]),b(l(f(be,J),-z[1]),l(f(ae,H),D[1]))),-k[2])),b(l(b(l(f(Pe,se),T[1]),b(l(f(be,J),-k[1]),l(f(Y,B),D[1]))),z[2]),l(b(l(f(ie,oe),T[1]),b(l(f(ae,H),-k[1]),l(f(Y,B),z[1]))),-D[2]))),-I[3])),b(l(b(b(l(b(l(f(ze,ye),k[1]),b(l(f(Te,re),-z[1]),l(f(ie,oe),I[1]))),T[2]),l(b(l(f(ze,ye),T[1]),b(l(f(ge,G),-z[1]),l(f(ae,H),I[1]))),-k[2])),b(l(b(l(f(Te,re),T[1]),b(l(f(ge,G),-k[1]),l(f(Y,B),I[1]))),z[2]),l(b(l(f(ie,oe),T[1]),b(l(f(ae,H),-k[1]),l(f(Y,B),z[1]))),-I[2]))),D[3]),l(b(b(l(b(l(f(Qe,ue),P[1]),b(l(f(Ge,K),-z[1]),l(f(le,$),D[1]))),k[2]),l(b(l(f(Qe,ue),k[1]),b(l(f(Pe,se),-z[1]),l(f(ie,oe),D[1]))),-P[2])),b(l(b(l(f(Ge,K),k[1]),b(l(f(Pe,se),-P[1]),l(f(q,Z),D[1]))),z[2]),l(b(l(f(le,$),k[1]),b(l(f(ie,oe),-P[1]),l(f(q,Z),z[1]))),-D[2]))),T[3]))),b(b(l(b(b(l(b(l(f(Qe,ue),P[1]),b(l(f(Ge,K),-z[1]),l(f(le,$),D[1]))),T[2]),l(b(l(f(Qe,ue),T[1]),b(l(f(be,J),-z[1]),l(f(ae,H),D[1]))),-P[2])),b(l(b(l(f(Ge,K),T[1]),b(l(f(be,J),-P[1]),l(f(U,F),D[1]))),z[2]),l(b(l(f(le,$),T[1]),b(l(f(ae,H),-P[1]),l(f(U,F),z[1]))),-D[2]))),-k[3]),l(b(b(l(b(l(f(Qe,ue),k[1]),b(l(f(Pe,se),-z[1]),l(f(ie,oe),D[1]))),T[2]),l(b(l(f(Qe,ue),T[1]),b(l(f(be,J),-z[1]),l(f(ae,H),D[1]))),-k[2])),b(l(b(l(f(Pe,se),T[1]),b(l(f(be,J),-k[1]),l(f(Y,B),D[1]))),z[2]),l(b(l(f(ie,oe),T[1]),b(l(f(ae,H),-k[1]),l(f(Y,B),z[1]))),-D[2]))),P[3])),b(l(b(b(l(b(l(f(Ge,K),k[1]),b(l(f(Pe,se),-P[1]),l(f(q,Z),D[1]))),T[2]),l(b(l(f(Ge,K),T[1]),b(l(f(be,J),-P[1]),l(f(U,F),D[1]))),-k[2])),b(l(b(l(f(Pe,se),T[1]),b(l(f(be,J),-k[1]),l(f(Y,B),D[1]))),P[2]),l(b(l(f(q,Z),T[1]),b(l(f(U,F),-k[1]),l(f(Y,B),P[1]))),-D[2]))),-z[3]),l(b(b(l(b(l(f(le,$),k[1]),b(l(f(ie,oe),-P[1]),l(f(q,Z),z[1]))),T[2]),l(b(l(f(le,$),T[1]),b(l(f(ae,H),-P[1]),l(f(U,F),z[1]))),-k[2])),b(l(b(l(f(ie,oe),T[1]),b(l(f(ae,H),-k[1]),l(f(Y,B),z[1]))),P[2]),l(b(l(f(q,Z),T[1]),b(l(f(U,F),-k[1]),l(f(Y,B),P[1]))),-z[2]))),D[3]))))),He=b(b(b(l(b(b(l(b(l(f(Be,Oe),z[1]),b(l(f(Qe,ue),-I[1]),l(f(ze,ye),D[1]))),P[2]),l(b(l(f(Be,Oe),P[1]),b(l(f(Ge,K),-I[1]),l(f(_e,W),D[1]))),-z[2])),b(l(b(l(f(Qe,ue),P[1]),b(l(f(Ge,K),-z[1]),l(f(le,$),D[1]))),I[2]),l(b(l(f(ze,ye),P[1]),b(l(f(_e,W),-z[1]),l(f(le,$),I[1]))),-D[2]))),T[3]),b(l(b(b(l(b(l(f(Be,Oe),z[1]),b(l(f(Qe,ue),-I[1]),l(f(ze,ye),D[1]))),T[2]),l(b(l(f(Be,Oe),T[1]),b(l(f(be,J),-I[1]),l(f(ge,G),D[1]))),-z[2])),b(l(b(l(f(Qe,ue),T[1]),b(l(f(be,J),-z[1]),l(f(ae,H),D[1]))),I[2]),l(b(l(f(ze,ye),T[1]),b(l(f(ge,G),-z[1]),l(f(ae,H),I[1]))),-D[2]))),-P[3]),l(b(b(l(b(l(f(Be,Oe),P[1]),b(l(f(Ge,K),-I[1]),l(f(_e,W),D[1]))),T[2]),l(b(l(f(Be,Oe),T[1]),b(l(f(be,J),-I[1]),l(f(ge,G),D[1]))),-P[2])),b(l(b(l(f(Ge,K),T[1]),b(l(f(be,J),-P[1]),l(f(U,F),D[1]))),I[2]),l(b(l(f(_e,W),T[1]),b(l(f(ge,G),-P[1]),l(f(U,F),I[1]))),-D[2]))),z[3]))),b(b(l(b(b(l(b(l(f(Qe,ue),P[1]),b(l(f(Ge,K),-z[1]),l(f(le,$),D[1]))),T[2]),l(b(l(f(Qe,ue),T[1]),b(l(f(be,J),-z[1]),l(f(ae,H),D[1]))),-P[2])),b(l(b(l(f(Ge,K),T[1]),b(l(f(be,J),-P[1]),l(f(U,F),D[1]))),z[2]),l(b(l(f(le,$),T[1]),b(l(f(ae,H),-P[1]),l(f(U,F),z[1]))),-D[2]))),-I[3]),l(b(b(l(b(l(f(ze,ye),P[1]),b(l(f(_e,W),-z[1]),l(f(le,$),I[1]))),T[2]),l(b(l(f(ze,ye),T[1]),b(l(f(ge,G),-z[1]),l(f(ae,H),I[1]))),-P[2])),b(l(b(l(f(_e,W),T[1]),b(l(f(ge,G),-P[1]),l(f(U,F),I[1]))),z[2]),l(b(l(f(le,$),T[1]),b(l(f(ae,H),-P[1]),l(f(U,F),z[1]))),-I[2]))),D[3])),b(l(b(b(l(b(l(f(Be,Oe),P[1]),b(l(f(Ge,K),-I[1]),l(f(_e,W),D[1]))),k[2]),l(b(l(f(Be,Oe),k[1]),b(l(f(Pe,se),-I[1]),l(f(Te,re),D[1]))),-P[2])),b(l(b(l(f(Ge,K),k[1]),b(l(f(Pe,se),-P[1]),l(f(q,Z),D[1]))),I[2]),l(b(l(f(_e,W),k[1]),b(l(f(Te,re),-P[1]),l(f(q,Z),I[1]))),-D[2]))),T[3]),l(b(b(l(b(l(f(Be,Oe),P[1]),b(l(f(Ge,K),-I[1]),l(f(_e,W),D[1]))),T[2]),l(b(l(f(Be,Oe),T[1]),b(l(f(be,J),-I[1]),l(f(ge,G),D[1]))),-P[2])),b(l(b(l(f(Ge,K),T[1]),b(l(f(be,J),-P[1]),l(f(U,F),D[1]))),I[2]),l(b(l(f(_e,W),T[1]),b(l(f(ge,G),-P[1]),l(f(U,F),I[1]))),-D[2]))),-k[3])))),b(b(b(l(b(b(l(b(l(f(Be,Oe),k[1]),b(l(f(Pe,se),-I[1]),l(f(Te,re),D[1]))),T[2]),l(b(l(f(Be,Oe),T[1]),b(l(f(be,J),-I[1]),l(f(ge,G),D[1]))),-k[2])),b(l(b(l(f(Pe,se),T[1]),b(l(f(be,J),-k[1]),l(f(Y,B),D[1]))),I[2]),l(b(l(f(Te,re),T[1]),b(l(f(ge,G),-k[1]),l(f(Y,B),I[1]))),-D[2]))),P[3]),l(b(b(l(b(l(f(Ge,K),k[1]),b(l(f(Pe,se),-P[1]),l(f(q,Z),D[1]))),T[2]),l(b(l(f(Ge,K),T[1]),b(l(f(be,J),-P[1]),l(f(U,F),D[1]))),-k[2])),b(l(b(l(f(Pe,se),T[1]),b(l(f(be,J),-k[1]),l(f(Y,B),D[1]))),P[2]),l(b(l(f(q,Z),T[1]),b(l(f(U,F),-k[1]),l(f(Y,B),P[1]))),-D[2]))),-I[3])),b(l(b(b(l(b(l(f(_e,W),k[1]),b(l(f(Te,re),-P[1]),l(f(q,Z),I[1]))),T[2]),l(b(l(f(_e,W),T[1]),b(l(f(ge,G),-P[1]),l(f(U,F),I[1]))),-k[2])),b(l(b(l(f(Te,re),T[1]),b(l(f(ge,G),-k[1]),l(f(Y,B),I[1]))),P[2]),l(b(l(f(q,Z),T[1]),b(l(f(U,F),-k[1]),l(f(Y,B),P[1]))),-I[2]))),D[3]),l(b(b(l(b(l(f(ze,ye),P[1]),b(l(f(_e,W),-z[1]),l(f(le,$),I[1]))),k[2]),l(b(l(f(ze,ye),k[1]),b(l(f(Te,re),-z[1]),l(f(ie,oe),I[1]))),-P[2])),b(l(b(l(f(_e,W),k[1]),b(l(f(Te,re),-P[1]),l(f(q,Z),I[1]))),z[2]),l(b(l(f(le,$),k[1]),b(l(f(ie,oe),-P[1]),l(f(q,Z),z[1]))),-I[2]))),T[3]))),b(b(l(b(b(l(b(l(f(ze,ye),P[1]),b(l(f(_e,W),-z[1]),l(f(le,$),I[1]))),T[2]),l(b(l(f(ze,ye),T[1]),b(l(f(ge,G),-z[1]),l(f(ae,H),I[1]))),-P[2])),b(l(b(l(f(_e,W),T[1]),b(l(f(ge,G),-P[1]),l(f(U,F),I[1]))),z[2]),l(b(l(f(le,$),T[1]),b(l(f(ae,H),-P[1]),l(f(U,F),z[1]))),-I[2]))),-k[3]),l(b(b(l(b(l(f(ze,ye),k[1]),b(l(f(Te,re),-z[1]),l(f(ie,oe),I[1]))),T[2]),l(b(l(f(ze,ye),T[1]),b(l(f(ge,G),-z[1]),l(f(ae,H),I[1]))),-k[2])),b(l(b(l(f(Te,re),T[1]),b(l(f(ge,G),-k[1]),l(f(Y,B),I[1]))),z[2]),l(b(l(f(ie,oe),T[1]),b(l(f(ae,H),-k[1]),l(f(Y,B),z[1]))),-I[2]))),P[3])),b(l(b(b(l(b(l(f(_e,W),k[1]),b(l(f(Te,re),-P[1]),l(f(q,Z),I[1]))),T[2]),l(b(l(f(_e,W),T[1]),b(l(f(ge,G),-P[1]),l(f(U,F),I[1]))),-k[2])),b(l(b(l(f(Te,re),T[1]),b(l(f(ge,G),-k[1]),l(f(Y,B),I[1]))),P[2]),l(b(l(f(q,Z),T[1]),b(l(f(U,F),-k[1]),l(f(Y,B),P[1]))),-I[2]))),-z[3]),l(b(b(l(b(l(f(le,$),k[1]),b(l(f(ie,oe),-P[1]),l(f(q,Z),z[1]))),T[2]),l(b(l(f(le,$),T[1]),b(l(f(ae,H),-P[1]),l(f(U,F),z[1]))),-k[2])),b(l(b(l(f(ie,oe),T[1]),b(l(f(ae,H),-k[1]),l(f(Y,B),z[1]))),P[2]),l(b(l(f(q,Z),T[1]),b(l(f(U,F),-k[1]),l(f(Y,B),P[1]))),-z[2]))),I[3]))))),vt=f(Le,He);return vt[vt.length-1]}return L}var u=[o,i,y];function _(b){var f=u[b.length];return f||(f=u[b.length]=c(b.length)),f.apply(void 0,b)}function s(b,f,x,l,L,T,k,P){function z(I,D,R,B,F,H){switch(arguments.length){case 0:case 1:return 0;case 2:return l(I,D);case 3:return L(I,D,R);case 4:return T(I,D,R,B);case 5:return k(I,D,R,B,F);case 6:return P(I,D,R,B,F,H)}for(var G=new Array(arguments.length),J=0;J<arguments.length;++J)G[J]=arguments[J];return b(G)}return z}function A(){for(;u.length<=t;)u.push(c(u.length));S.exports=s.apply(void 0,[_].concat(u));for(var b=0;b<=t;++b)S.exports[b]=u[b]}A()},{"robust-scale":286,"robust-subtract":288,"robust-sum":289,"two-product":306}],283:[function(v,S,M){var e=v("robust-determinant"),a=6;function n(u){var _=u===2?c:u===3?o:u===4?i:u===5?y:p;return u<6?_(e[u]):_(e)}function r(){return[[0]]}function t(u,_){return[[_[0]],[u[0][0]]]}function c(u){return function(s,A){return[u([[+A[0],+s[0][1]],[+A[1],+s[1][1]]]),u([[+s[0][0],+A[0]],[+s[1][0],+A[1]]]),u(s)]}}function o(u){return function(s,A){return[u([[+A[0],+s[0][1],+s[0][2]],[+A[1],+s[1][1],+s[1][2]],[+A[2],+s[2][1],+s[2][2]]]),u([[+s[0][0],+A[0],+s[0][2]],[+s[1][0],+A[1],+s[1][2]],[+s[2][0],+A[2],+s[2][2]]]),u([[+s[0][0],+s[0][1],+A[0]],[+s[1][0],+s[1][1],+A[1]],[+s[2][0],+s[2][1],+A[2]]]),u(s)]}}function i(u){return function(s,A){return[u([[+A[0],+s[0][1],+s[0][2],+s[0][3]],[+A[1],+s[1][1],+s[1][2],+s[1][3]],[+A[2],+s[2][1],+s[2][2],+s[2][3]],[+A[3],+s[3][1],+s[3][2],+s[3][3]]]),u([[+s[0][0],+A[0],+s[0][2],+s[0][3]],[+s[1][0],+A[1],+s[1][2],+s[1][3]],[+s[2][0],+A[2],+s[2][2],+s[2][3]],[+s[3][0],+A[3],+s[3][2],+s[3][3]]]),u([[+s[0][0],+s[0][1],+A[0],+s[0][3]],[+s[1][0],+s[1][1],+A[1],+s[1][3]],[+s[2][0],+s[2][1],+A[2],+s[2][3]],[+s[3][0],+s[3][1],+A[3],+s[3][3]]]),u([[+s[0][0],+s[0][1],+s[0][2],+A[0]],[+s[1][0],+s[1][1],+s[1][2],+A[1]],[+s[2][0],+s[2][1],+s[2][2],+A[2]],[+s[3][0],+s[3][1],+s[3][2],+A[3]]]),u(s)]}}function y(u){return function(s,A){return[u([[+A[0],+s[0][1],+s[0][2],+s[0][3],+s[0][4]],[+A[1],+s[1][1],+s[1][2],+s[1][3],+s[1][4]],[+A[2],+s[2][1],+s[2][2],+s[2][3],+s[2][4]],[+A[3],+s[3][1],+s[3][2],+s[3][3],+s[3][4]],[+A[4],+s[4][1],+s[4][2],+s[4][3],+s[4][4]]]),u([[+s[0][0],+A[0],+s[0][2],+s[0][3],+s[0][4]],[+s[1][0],+A[1],+s[1][2],+s[1][3],+s[1][4]],[+s[2][0],+A[2],+s[2][2],+s[2][3],+s[2][4]],[+s[3][0],+A[3],+s[3][2],+s[3][3],+s[3][4]],[+s[4][0],+A[4],+s[4][2],+s[4][3],+s[4][4]]]),u([[+s[0][0],+s[0][1],+A[0],+s[0][3],+s[0][4]],[+s[1][0],+s[1][1],+A[1],+s[1][3],+s[1][4]],[+s[2][0],+s[2][1],+A[2],+s[2][3],+s[2][4]],[+s[3][0],+s[3][1],+A[3],+s[3][3],+s[3][4]],[+s[4][0],+s[4][1],+A[4],+s[4][3],+s[4][4]]]),u([[+s[0][0],+s[0][1],+s[0][2],+A[0],+s[0][4]],[+s[1][0],+s[1][1],+s[1][2],+A[1],+s[1][4]],[+s[2][0],+s[2][1],+s[2][2],+A[2],+s[2][4]],[+s[3][0],+s[3][1],+s[3][2],+A[3],+s[3][4]],[+s[4][0],+s[4][1],+s[4][2],+A[4],+s[4][4]]]),u([[+s[0][0],+s[0][1],+s[0][2],+s[0][3],+A[0]],[+s[1][0],+s[1][1],+s[1][2],+s[1][3],+A[1]],[+s[2][0],+s[2][1],+s[2][2],+s[2][3],+A[2]],[+s[3][0],+s[3][1],+s[3][2],+s[3][3],+A[3]],[+s[4][0],+s[4][1],+s[4][2],+s[4][3],+A[4]]]),u(s)]}}function p(u){return function(s,A){return[u([[+A[0],+s[0][1],+s[0][2],+s[0][3],+s[0][4],+s[0][5]],[+A[1],+s[1][1],+s[1][2],+s[1][3],+s[1][4],+s[1][5]],[+A[2],+s[2][1],+s[2][2],+s[2][3],+s[2][4],+s[2][5]],[+A[3],+s[3][1],+s[3][2],+s[3][3],+s[3][4],+s[3][5]],[+A[4],+s[4][1],+s[4][2],+s[4][3],+s[4][4],+s[4][5]],[+A[5],+s[5][1],+s[5][2],+s[5][3],+s[5][4],+s[5][5]]]),u([[+s[0][0],+A[0],+s[0][2],+s[0][3],+s[0][4],+s[0][5]],[+s[1][0],+A[1],+s[1][2],+s[1][3],+s[1][4],+s[1][5]],[+s[2][0],+A[2],+s[2][2],+s[2][3],+s[2][4],+s[2][5]],[+s[3][0],+A[3],+s[3][2],+s[3][3],+s[3][4],+s[3][5]],[+s[4][0],+A[4],+s[4][2],+s[4][3],+s[4][4],+s[4][5]],[+s[5][0],+A[5],+s[5][2],+s[5][3],+s[5][4],+s[5][5]]]),u([[+s[0][0],+s[0][1],+A[0],+s[0][3],+s[0][4],+s[0][5]],[+s[1][0],+s[1][1],+A[1],+s[1][3],+s[1][4],+s[1][5]],[+s[2][0],+s[2][1],+A[2],+s[2][3],+s[2][4],+s[2][5]],[+s[3][0],+s[3][1],+A[3],+s[3][3],+s[3][4],+s[3][5]],[+s[4][0],+s[4][1],+A[4],+s[4][3],+s[4][4],+s[4][5]],[+s[5][0],+s[5][1],+A[5],+s[5][3],+s[5][4],+s[5][5]]]),u([[+s[0][0],+s[0][1],+s[0][2],+A[0],+s[0][4],+s[0][5]],[+s[1][0],+s[1][1],+s[1][2],+A[1],+s[1][4],+s[1][5]],[+s[2][0],+s[2][1],+s[2][2],+A[2],+s[2][4],+s[2][5]],[+s[3][0],+s[3][1],+s[3][2],+A[3],+s[3][4],+s[3][5]],[+s[4][0],+s[4][1],+s[4][2],+A[4],+s[4][4],+s[4][5]],[+s[5][0],+s[5][1],+s[5][2],+A[5],+s[5][4],+s[5][5]]]),u([[+s[0][0],+s[0][1],+s[0][2],+s[0][3],+A[0],+s[0][5]],[+s[1][0],+s[1][1],+s[1][2],+s[1][3],+A[1],+s[1][5]],[+s[2][0],+s[2][1],+s[2][2],+s[2][3],+A[2],+s[2][5]],[+s[3][0],+s[3][1],+s[3][2],+s[3][3],+A[3],+s[3][5]],[+s[4][0],+s[4][1],+s[4][2],+s[4][3],+A[4],+s[4][5]],[+s[5][0],+s[5][1],+s[5][2],+s[5][3],+A[5],+s[5][5]]]),u([[+s[0][0],+s[0][1],+s[0][2],+s[0][3],+s[0][4],+A[0]],[+s[1][0],+s[1][1],+s[1][2],+s[1][3],+s[1][4],+A[1]],[+s[2][0],+s[2][1],+s[2][2],+s[2][3],+s[2][4],+A[2]],[+s[3][0],+s[3][1],+s[3][2],+s[3][3],+s[3][4],+A[3]],[+s[4][0],+s[4][1],+s[4][2],+s[4][3],+s[4][4],+A[4]],[+s[5][0],+s[5][1],+s[5][2],+s[5][3],+s[5][4],+A[5]]]),u(s)]}}var g=[r,t];function h(u,_,s,A,b,f,x,l){return function(T,k){switch(T.length){case 0:return u(T,k);case 1:return _(T,k);case 2:return s(T,k);case 3:return A(T,k);case 4:return b(T,k);case 5:return f(T,k)}var P=x[T.length];return P||(P=x[T.length]=l(T.length)),P(T,k)}}function m(){for(;g.length<a;)g.push(n(g.length));S.exports=h.apply(void 0,g.concat([g,n]));for(var u=0;u<a;++u)S.exports[u]=g[u]}m()},{"robust-determinant":280}],284:[function(v,S,M){var e=v("two-product"),a=v("robust-sum"),n=v("robust-scale"),r=v("robust-subtract"),t=5,c=11102230246251565e-32,o=(3+16*c)*c,i=(7+56*c)*c;function y(f,x,l,L){return function(k,P,z){var I=f(f(x(P[1],z[0]),x(-z[1],P[0])),f(x(k[1],P[0]),x(-P[1],k[0]))),D=f(x(k[1],z[0]),x(-z[1],k[0])),R=L(I,D);return R[R.length-1]}}function p(f,x,l,L){return function(k,P,z,I){var D=f(f(l(f(x(z[1],I[0]),x(-I[1],z[0])),P[2]),f(l(f(x(P[1],I[0]),x(-I[1],P[0])),-z[2]),l(f(x(P[1],z[0]),x(-z[1],P[0])),I[2]))),f(l(f(x(P[1],I[0]),x(-I[1],P[0])),k[2]),f(l(f(x(k[1],I[0]),x(-I[1],k[0])),-P[2]),l(f(x(k[1],P[0]),x(-P[1],k[0])),I[2])))),R=f(f(l(f(x(z[1],I[0]),x(-I[1],z[0])),k[2]),f(l(f(x(k[1],I[0]),x(-I[1],k[0])),-z[2]),l(f(x(k[1],z[0]),x(-z[1],k[0])),I[2]))),f(l(f(x(P[1],z[0]),x(-z[1],P[0])),k[2]),f(l(f(x(k[1],z[0]),x(-z[1],k[0])),-P[2]),l(f(x(k[1],P[0]),x(-P[1],k[0])),z[2])))),B=L(D,R);return B[B.length-1]}}function g(f,x,l,L){return function(k,P,z,I,D){var R=f(f(f(l(f(l(f(x(I[1],D[0]),x(-D[1],I[0])),z[2]),f(l(f(x(z[1],D[0]),x(-D[1],z[0])),-I[2]),l(f(x(z[1],I[0]),x(-I[1],z[0])),D[2]))),P[3]),f(l(f(l(f(x(I[1],D[0]),x(-D[1],I[0])),P[2]),f(l(f(x(P[1],D[0]),x(-D[1],P[0])),-I[2]),l(f(x(P[1],I[0]),x(-I[1],P[0])),D[2]))),-z[3]),l(f(l(f(x(z[1],D[0]),x(-D[1],z[0])),P[2]),f(l(f(x(P[1],D[0]),x(-D[1],P[0])),-z[2]),l(f(x(P[1],z[0]),x(-z[1],P[0])),D[2]))),I[3]))),f(l(f(l(f(x(z[1],I[0]),x(-I[1],z[0])),P[2]),f(l(f(x(P[1],I[0]),x(-I[1],P[0])),-z[2]),l(f(x(P[1],z[0]),x(-z[1],P[0])),I[2]))),-D[3]),f(l(f(l(f(x(I[1],D[0]),x(-D[1],I[0])),P[2]),f(l(f(x(P[1],D[0]),x(-D[1],P[0])),-I[2]),l(f(x(P[1],I[0]),x(-I[1],P[0])),D[2]))),k[3]),l(f(l(f(x(I[1],D[0]),x(-D[1],I[0])),k[2]),f(l(f(x(k[1],D[0]),x(-D[1],k[0])),-I[2]),l(f(x(k[1],I[0]),x(-I[1],k[0])),D[2]))),-P[3])))),f(f(l(f(l(f(x(P[1],D[0]),x(-D[1],P[0])),k[2]),f(l(f(x(k[1],D[0]),x(-D[1],k[0])),-P[2]),l(f(x(k[1],P[0]),x(-P[1],k[0])),D[2]))),I[3]),f(l(f(l(f(x(P[1],I[0]),x(-I[1],P[0])),k[2]),f(l(f(x(k[1],I[0]),x(-I[1],k[0])),-P[2]),l(f(x(k[1],P[0]),x(-P[1],k[0])),I[2]))),-D[3]),l(f(l(f(x(z[1],I[0]),x(-I[1],z[0])),P[2]),f(l(f(x(P[1],I[0]),x(-I[1],P[0])),-z[2]),l(f(x(P[1],z[0]),x(-z[1],P[0])),I[2]))),k[3]))),f(l(f(l(f(x(z[1],I[0]),x(-I[1],z[0])),k[2]),f(l(f(x(k[1],I[0]),x(-I[1],k[0])),-z[2]),l(f(x(k[1],z[0]),x(-z[1],k[0])),I[2]))),-P[3]),f(l(f(l(f(x(P[1],I[0]),x(-I[1],P[0])),k[2]),f(l(f(x(k[1],I[0]),x(-I[1],k[0])),-P[2]),l(f(x(k[1],P[0]),x(-P[1],k[0])),I[2]))),z[3]),l(f(l(f(x(P[1],z[0]),x(-z[1],P[0])),k[2]),f(l(f(x(k[1],z[0]),x(-z[1],k[0])),-P[2]),l(f(x(k[1],P[0]),x(-P[1],k[0])),z[2]))),-I[3]))))),B=f(f(f(l(f(l(f(x(I[1],D[0]),x(-D[1],I[0])),z[2]),f(l(f(x(z[1],D[0]),x(-D[1],z[0])),-I[2]),l(f(x(z[1],I[0]),x(-I[1],z[0])),D[2]))),k[3]),l(f(l(f(x(I[1],D[0]),x(-D[1],I[0])),k[2]),f(l(f(x(k[1],D[0]),x(-D[1],k[0])),-I[2]),l(f(x(k[1],I[0]),x(-I[1],k[0])),D[2]))),-z[3])),f(l(f(l(f(x(z[1],D[0]),x(-D[1],z[0])),k[2]),f(l(f(x(k[1],D[0]),x(-D[1],k[0])),-z[2]),l(f(x(k[1],z[0]),x(-z[1],k[0])),D[2]))),I[3]),l(f(l(f(x(z[1],I[0]),x(-I[1],z[0])),k[2]),f(l(f(x(k[1],I[0]),x(-I[1],k[0])),-z[2]),l(f(x(k[1],z[0]),x(-z[1],k[0])),I[2]))),-D[3]))),f(f(l(f(l(f(x(z[1],D[0]),x(-D[1],z[0])),P[2]),f(l(f(x(P[1],D[0]),x(-D[1],P[0])),-z[2]),l(f(x(P[1],z[0]),x(-z[1],P[0])),D[2]))),k[3]),l(f(l(f(x(z[1],D[0]),x(-D[1],z[0])),k[2]),f(l(f(x(k[1],D[0]),x(-D[1],k[0])),-z[2]),l(f(x(k[1],z[0]),x(-z[1],k[0])),D[2]))),-P[3])),f(l(f(l(f(x(P[1],D[0]),x(-D[1],P[0])),k[2]),f(l(f(x(k[1],D[0]),x(-D[1],k[0])),-P[2]),l(f(x(k[1],P[0]),x(-P[1],k[0])),D[2]))),z[3]),l(f(l(f(x(P[1],z[0]),x(-z[1],P[0])),k[2]),f(l(f(x(k[1],z[0]),x(-z[1],k[0])),-P[2]),l(f(x(k[1],P[0]),x(-P[1],k[0])),z[2]))),-D[3])))),F=L(R,B);return F[F.length-1]}}function h(f){var x=f===3?y:f===4?p:g;return x(a,e,n,r)}var m=h(3),u=h(4),_=[function(){return 0},function(){return 0},function(x,l){return l[0]-x[0]},function(x,l,L){var T=(x[1]-L[1])*(l[0]-L[0]),k=(x[0]-L[0])*(l[1]-L[1]),P=T-k,z;if(T>0){if(k<=0)return P;z=T+k}else if(T<0){if(k>=0)return P;z=-(T+k)}else return P;var I=o*z;return P>=I||P<=-I?P:m(x,l,L)},function(x,l,L,T){var k=x[0]-T[0],P=l[0]-T[0],z=L[0]-T[0],I=x[1]-T[1],D=l[1]-T[1],R=L[1]-T[1],B=x[2]-T[2],F=l[2]-T[2],H=L[2]-T[2],G=P*R,J=z*D,X=z*I,Y=k*R,Z=k*D,oe=P*I,re=B*(G-J)+F*(X-Y)+H*(Z-oe),se=(Math.abs(G)+Math.abs(J))*Math.abs(B)+(Math.abs(X)+Math.abs(Y))*Math.abs(F)+(Math.abs(Z)+Math.abs(oe))*Math.abs(H),N=i*se;return re>N||-re>N?re:u(x,l,L,T)}];function s(f){var x=_[f.length];return x||(x=_[f.length]=h(f.length)),x.apply(void 0,f)}function A(f,x,l,L,T,k,P){return function(I,D,R,B,F){switch(arguments.length){case 0:case 1:return 0;case 2:return L(I,D);case 3:return T(I,D,R);case 4:return k(I,D,R,B);case 5:return P(I,D,R,B,F)}for(var H=new Array(arguments.length),G=0;G<arguments.length;++G)H[G]=arguments[G];return f(H)}}function b(){for(;_.length<=t;)_.push(h(_.length));S.exports=A.apply(void 0,[s].concat(_));for(var f=0;f<=t;++f)S.exports[f]=_[f]}b()},{"robust-scale":286,"robust-subtract":288,"robust-sum":289,"two-product":306}],285:[function(v,S,M){var e=v("robust-sum"),a=v("robust-scale");S.exports=n;function n(r,t){if(r.length===1)return a(t,r[0]);if(t.length===1)return a(r,t[0]);if(r.length===0||t.length===0)return[0];var c=[0];if(r.length<t.length)for(var o=0;o<r.length;++o)c=e(c,a(t,r[o]));else for(var o=0;o<t.length;++o)c=e(c,a(r,t[o]));return c}},{"robust-scale":286,"robust-sum":289}],286:[function(v,S,M){var e=v("two-product"),a=v("two-sum");S.exports=n;function n(r,t){var c=r.length;if(c===1){var o=e(r[0],t);return o[0]?o:[o[1]]}var i=new Array(2*c),y=[.1,.1],p=[.1,.1],g=0;e(r[0],t,y),y[0]&&(i[g++]=y[0]);for(var h=1;h<c;++h){e(r[h],t,p);var m=y[1];a(m,p[0],y),y[0]&&(i[g++]=y[0]);var u=p[1],_=y[1],s=u+_,A=s-u,b=_-A;y[1]=s,b&&(i[g++]=b)}return y[1]&&(i[g++]=y[1]),g===0&&(i[g++]=0),i.length=g,i}},{"two-product":306,"two-sum":307}],287:[function(v,S,M){S.exports=n;var e=v("robust-orientation")[3];function a(r,t,c,o){for(var i=0;i<2;++i){var y=r[i],p=t[i],g=Math.min(y,p),h=Math.max(y,p),m=c[i],u=o[i],_=Math.min(m,u),s=Math.max(m,u);if(s<g||h<_)return!1}return!0}function n(r,t,c,o){var i=e(r,c,o),y=e(t,c,o);if(i>0&&y>0||i<0&&y<0)return!1;var p=e(c,r,t),g=e(o,r,t);return p>0&&g>0||p<0&&g<0?!1:i===0&&y===0&&p===0&&g===0?a(r,t,c,o):!0}},{"robust-orientation":284}],288:[function(v,S,M){S.exports=a;function e(n,r){var t=n+r,c=t-n,o=t-c,i=r-c,y=n-o,p=y+i;return p?[p,t]:[t]}function a(n,r){var t=n.length|0,c=r.length|0;if(t===1&&c===1)return e(n[0],-r[0]);var o=t+c,i=new Array(o),y=0,p=0,g=0,h=Math.abs,m=n[p],u=h(m),_=-r[g],s=h(_),A,b;u<s?(b=m,p+=1,p<t&&(m=n[p],u=h(m))):(b=_,g+=1,g<c&&(_=-r[g],s=h(_))),p<t&&u<s||g>=c?(A=m,p+=1,p<t&&(m=n[p],u=h(m))):(A=_,g+=1,g<c&&(_=-r[g],s=h(_)));for(var f=A+b,x=f-A,l=b-x,L=l,T=f,k,P,z,I,D;p<t&&g<c;)u<s?(A=m,p+=1,p<t&&(m=n[p],u=h(m))):(A=_,g+=1,g<c&&(_=-r[g],s=h(_))),b=L,f=A+b,x=f-A,l=b-x,l&&(i[y++]=l),k=T+f,P=k-T,z=k-P,I=f-P,D=T-z,L=D+I,T=k;for(;p<t;)A=m,b=L,f=A+b,x=f-A,l=b-x,l&&(i[y++]=l),k=T+f,P=k-T,z=k-P,I=f-P,D=T-z,L=D+I,T=k,p+=1,p<t&&(m=n[p]);for(;g<c;)A=_,b=L,f=A+b,x=f-A,l=b-x,l&&(i[y++]=l),k=T+f,P=k-T,z=k-P,I=f-P,D=T-z,L=D+I,T=k,g+=1,g<c&&(_=-r[g]);return L&&(i[y++]=L),T&&(i[y++]=T),y||(i[y++]=0),i.length=y,i}},{}],289:[function(v,S,M){S.exports=a;function e(n,r){var t=n+r,c=t-n,o=t-c,i=r-c,y=n-o,p=y+i;return p?[p,t]:[t]}function a(n,r){var t=n.length|0,c=r.length|0;if(t===1&&c===1)return e(n[0],r[0]);var o=t+c,i=new Array(o),y=0,p=0,g=0,h=Math.abs,m=n[p],u=h(m),_=r[g],s=h(_),A,b;u<s?(b=m,p+=1,p<t&&(m=n[p],u=h(m))):(b=_,g+=1,g<c&&(_=r[g],s=h(_))),p<t&&u<s||g>=c?(A=m,p+=1,p<t&&(m=n[p],u=h(m))):(A=_,g+=1,g<c&&(_=r[g],s=h(_)));for(var f=A+b,x=f-A,l=b-x,L=l,T=f,k,P,z,I,D;p<t&&g<c;)u<s?(A=m,p+=1,p<t&&(m=n[p],u=h(m))):(A=_,g+=1,g<c&&(_=r[g],s=h(_))),b=L,f=A+b,x=f-A,l=b-x,l&&(i[y++]=l),k=T+f,P=k-T,z=k-P,I=f-P,D=T-z,L=D+I,T=k;for(;p<t;)A=m,b=L,f=A+b,x=f-A,l=b-x,l&&(i[y++]=l),k=T+f,P=k-T,z=k-P,I=f-P,D=T-z,L=D+I,T=k,p+=1,p<t&&(m=n[p]);for(;g<c;)A=_,b=L,f=A+b,x=f-A,l=b-x,l&&(i[y++]=l),k=T+f,P=k-T,z=k-P,I=f-P,D=T-z,L=D+I,T=k,g+=1,g<c&&(_=r[g]);return L&&(i[y++]=L),T&&(i[y++]=T),y||(i[y++]=0),i.length=y,i}},{}],290:[function(v,S,M){S.exports=n;var e=v("boundary-cells"),a=v("reduce-simplicial-complex");function n(r){return a(e(r))}},{"boundary-cells":34,"reduce-simplicial-complex":276}],291:[function(v,S,M){S.exports=g;var e=v("ndarray"),a=v("typedarray-pool"),n=v("ndarray-sort"),r=v("./lib/codegen");function t(h){for(var m=h.length,u=0,_=0;_<m;++_)u=Math.max(u,h[_].length)|0;return u-1}function c(h,m){for(var u=h.length,_=a.mallocUint8(u),s=0;s<u;++s)_[s]=h[s]<m|0;return _}function o(h,m){for(var u=h.length,_=m*(m+1)/2*u|0,s=a.mallocUint32(_*2),A=0,b=0;b<u;++b)for(var f=h[b],m=f.length,x=0;x<m;++x)for(var l=0;l<x;++l){var L=f[l],T=f[x];s[A++]=Math.min(L,T)|0,s[A++]=Math.max(L,T)|0}var k=A/2|0;n(e(s,[k,2]));for(var P=2,b=2;b<A;b+=2)s[b-2]===s[b]&&s[b-1]===s[b+1]||(s[P++]=s[b],s[P++]=s[b+1]);return e(s,[P/2|0,2])}function i(h,m,u,_){for(var s=h.data,A=h.shape[0],b=a.mallocDouble(A),f=0,x=0;x<A;++x){var l=s[2*x],L=s[2*x+1];if(u[l]!==u[L]){var T=m[l],k=m[L];s[2*f]=l,s[2*f+1]=L,b[f++]=(k-_)/(k-T)}}return h.shape[0]=f,e(b,[f])}function y(h,m){var u=a.mallocInt32(m*2),_=h.shape[0],s=h.data;u[0]=0;for(var A=0,b=0;b<_;++b){var f=s[2*b];if(f!==A){for(u[2*A+1]=b;++A<f;)u[2*A]=b,u[2*A+1]=b;u[2*A]=b}}for(u[2*A+1]=_;++A<m;)u[2*A]=u[2*A+1]=_;return u}function p(h){for(var m=h.shape[0]|0,u=h.data,_=new Array(m),s=0;s<m;++s)_[s]=[u[2*s],u[2*s+1]];return _}function g(h,m,u,_){u=u||0,typeof _>"u"&&(_=t(h));var s=h.length;if(s===0||_<1)return{cells:[],vertexIds:[],vertexWeights:[]};var A=c(m,+u),b=o(h,_),f=i(b,m,A,+u),x=y(b,m.length|0),l=r(_)(h,b.data,x,A),L=p(b),T=[].slice.call(f.data,0,f.shape[0]);return a.free(A),a.free(b.data),a.free(f.data),a.free(x),{cells:l,vertexIds:L,vertexWeights:T}}},{"./lib/codegen":292,ndarray:259,"ndarray-sort":258,"typedarray-pool":308}],292:[function(v,S,M){S.exports=a;var e=[function(){function r(t,c,o,i){for(var y=t.length,p=[],g=0;g<y;++g){var h=t[g];h.length}return p}return r},function(){function r(c,o,i,y){for(var p=Math.min(i,y)|0,g=Math.max(i,y)|0,h=c[2*p],m=c[2*p+1];h<m;){var u=h+m>>1,_=o[2*u+1];if(_===g)return u;g<_?m=u:h=u+1}return h}function t(c,o,i,y){for(var p=c.length,g=[],h=0;h<p;++h){var m=c[h],u=m.length;if(u===2){var _=(y[m[0]]<<0)+(y[m[1]]<<1);if(_===0||_===3)continue;switch(_){case 0:break;case 1:g.push([r(i,o,m[0],m[1])]);break;case 2:g.push([r(i,o,m[1],m[0])]);break}}}return g}return t},function(){function r(c,o,i,y){for(var p=Math.min(i,y)|0,g=Math.max(i,y)|0,h=c[2*p],m=c[2*p+1];h<m;){var u=h+m>>1,_=o[2*u+1];if(_===g)return u;g<_?m=u:h=u+1}return h}function t(c,o,i,y){for(var p=c.length,g=[],h=0;h<p;++h){var m=c[h],u=m.length;if(u===3){var _=(y[m[0]]<<0)+(y[m[1]]<<1)+(y[m[2]]<<2);if(_===0||_===7)continue;switch(_){case 0:break;case 1:g.push([r(i,o,m[0],m[2]),r(i,o,m[0],m[1])]);break;case 2:g.push([r(i,o,m[1],m[0]),r(i,o,m[1],m[2])]);break;case 3:g.push([r(i,o,m[0],m[2]),r(i,o,m[1],m[2])]);break;case 4:g.push([r(i,o,m[2],m[1]),r(i,o,m[2],m[0])]);break;case 5:g.push([r(i,o,m[2],m[1]),r(i,o,m[0],m[1])]);break;case 6:g.push([r(i,o,m[1],m[0]),r(i,o,m[2],m[0])]);break}}else if(u===2){var _=(y[m[0]]<<0)+(y[m[1]]<<1);if(_===0||_===3)continue;switch(_){case 0:break;case 1:g.push([r(i,o,m[0],m[1])]);break;case 2:g.push([r(i,o,m[1],m[0])]);break}}}return g}return t},function(){function r(c,o,i,y){for(var p=Math.min(i,y)|0,g=Math.max(i,y)|0,h=c[2*p],m=c[2*p+1];h<m;){var u=h+m>>1,_=o[2*u+1];if(_===g)return u;g<_?m=u:h=u+1}return h}function t(c,o,i,y){for(var p=c.length,g=[],h=0;h<p;++h){var m=c[h],u=m.length;if(u===4){var _=(y[m[0]]<<0)+(y[m[1]]<<1)+(y[m[2]]<<2)+(y[m[3]]<<3);if(_===0||_===15)continue;switch(_){case 0:break;case 1:g.push([r(i,o,m[0],m[1]),r(i,o,m[0],m[2]),r(i,o,m[0],m[3])]);break;case 2:g.push([r(i,o,m[1],m[2]),r(i,o,m[1],m[0]),r(i,o,m[1],m[3])]);break;case 3:g.push([r(i,o,m[1],m[2]),r(i,o,m[0],m[2]),r(i,o,m[0],m[3])],[r(i,o,m[1],m[3]),r(i,o,m[1],m[2]),r(i,o,m[0],m[3])]);break;case 4:g.push([r(i,o,m[2],m[0]),r(i,o,m[2],m[1]),r(i,o,m[2],m[3])]);break;case 5:g.push([r(i,o,m[0],m[1]),r(i,o,m[2],m[1]),r(i,o,m[0],m[3])],[r(i,o,m[2],m[1]),r(i,o,m[2],m[3]),r(i,o,m[0],m[3])]);break;case 6:g.push([r(i,o,m[2],m[0]),r(i,o,m[1],m[0]),r(i,o,m[1],m[3])],[r(i,o,m[2],m[3]),r(i,o,m[2],m[0]),r(i,o,m[1],m[3])]);break;case 7:g.push([r(i,o,m[0],m[3]),r(i,o,m[1],m[3]),r(i,o,m[2],m[3])]);break;case 8:g.push([r(i,o,m[3],m[1]),r(i,o,m[3],m[0]),r(i,o,m[3],m[2])]);break;case 9:g.push([r(i,o,m[3],m[1]),r(i,o,m[0],m[1]),r(i,o,m[0],m[2])],[r(i,o,m[3],m[2]),r(i,o,m[3],m[1]),r(i,o,m[0],m[2])]);break;case 10:g.push([r(i,o,m[1],m[0]),r(i,o,m[3],m[0]),r(i,o,m[1],m[2])],[r(i,o,m[3],m[0]),r(i,o,m[3],m[2]),r(i,o,m[1],m[2])]);break;case 11:g.push([r(i,o,m[1],m[2]),r(i,o,m[0],m[2]),r(i,o,m[3],m[2])]);break;case 12:g.push([r(i,o,m[3],m[0]),r(i,o,m[2],m[0]),r(i,o,m[2],m[1])],[r(i,o,m[3],m[1]),r(i,o,m[3],m[0]),r(i,o,m[2],m[1])]);break;case 13:g.push([r(i,o,m[0],m[1]),r(i,o,m[2],m[1]),r(i,o,m[3],m[1])]);break;case 14:g.push([r(i,o,m[2],m[0]),r(i,o,m[1],m[0]),r(i,o,m[3],m[0])]);break}}else if(u===3){var _=(y[m[0]]<<0)+(y[m[1]]<<1)+(y[m[2]]<<2);if(_===0||_===7)continue;switch(_){case 0:break;case 1:g.push([r(i,o,m[0],m[2]),r(i,o,m[0],m[1])]);break;case 2:g.push([r(i,o,m[1],m[0]),r(i,o,m[1],m[2])]);break;case 3:g.push([r(i,o,m[0],m[2]),r(i,o,m[1],m[2])]);break;case 4:g.push([r(i,o,m[2],m[1]),r(i,o,m[2],m[0])]);break;case 5:g.push([r(i,o,m[2],m[1]),r(i,o,m[0],m[1])]);break;case 6:g.push([r(i,o,m[1],m[0]),r(i,o,m[2],m[0])]);break}}else if(u===2){var _=(y[m[0]]<<0)+(y[m[1]]<<1);if(_===0||_===3)continue;switch(_){case 0:break;case 1:g.push([r(i,o,m[0],m[1])]);break;case 2:g.push([r(i,o,m[1],m[0])]);break}}}return g}return t}];function a(n){return e[n]()}},{}],293:[function(v,S,M){var e=v("bit-twiddle"),a=v("union-find");function n(f){for(var x=0,l=Math.max,L=0,T=f.length;L<T;++L)x=l(x,f[L].length);return x-1}M.dimension=n;function r(f){for(var x=-1,l=Math.max,L=0,T=f.length;L<T;++L)for(var k=f[L],P=0,z=k.length;P<z;++P)x=l(x,k[P]);return x+1}M.countVertices=r;function t(f){for(var x=new Array(f.length),l=0,L=f.length;l<L;++l)x[l]=f[l].slice(0);return x}M.cloneCells=t;function c(f,x){var l=f.length,L=f.length-x.length,T=Math.min;if(L)return L;switch(l){case 0:return 0;case 1:return f[0]-x[0];case 2:var D=f[0]+f[1]-x[0]-x[1];return D||T(f[0],f[1])-T(x[0],x[1]);case 3:var k=f[0]+f[1],P=x[0]+x[1];if(D=k+f[2]-(P+x[2]),D)return D;var z=T(f[0],f[1]),I=T(x[0],x[1]),D=T(z,f[2])-T(I,x[2]);return D||T(z+f[2],k)-T(I+x[2],P);default:var R=f.slice(0);R.sort();var B=x.slice(0);B.sort();for(var F=0;F<l;++F)if(L=R[F]-B[F],L)return L;return 0}}M.compareCells=c;function o(f,x){return c(f[0],x[0])}function i(f,x){if(x){for(var l=f.length,L=new Array(l),T=0;T<l;++T)L[T]=[f[T],x[T]];L.sort(o);for(var T=0;T<l;++T)f[T]=L[T][0],x[T]=L[T][1];return f}else return f.sort(c),f}M.normalize=i;function y(f){if(f.length===0)return[];for(var x=1,l=f.length,L=1;L<l;++L){var T=f[L];if(c(T,f[L-1])){if(L===x){x++;continue}f[x++]=T}}return f.length=x,f}M.unique=y;function p(f,x){for(var l=0,L=f.length-1,T=-1;l<=L;){var k=l+L>>1,P=c(f[k],x);P<=0?(P===0&&(T=k),l=k+1):P>0&&(L=k-1)}return T}M.findCell=p;function g(f,x){for(var l=new Array(f.length),L=0,T=l.length;L<T;++L)l[L]=[];for(var k=[],L=0,P=x.length;L<P;++L)for(var z=x[L],I=z.length,D=1,R=1<<I;D<R;++D){k.length=e.popCount(D);for(var B=0,F=0;F<I;++F)D&1<<F&&(k[B++]=z[F]);var H=p(f,k);if(!(H<0))for(;l[H++].push(L),!(H>=f.length||c(f[H],k)!==0););}return l}M.incidence=g;function h(f,x){if(!x)return g(y(u(f,0)),f);for(var l=new Array(x),L=0;L<x;++L)l[L]=[];for(var L=0,T=f.length;L<T;++L)for(var k=f[L],P=0,z=k.length;P<z;++P)l[k[P]].push(L);return l}M.dual=h;function m(f){for(var x=[],l=0,L=f.length;l<L;++l)for(var T=f[l],k=T.length|0,P=1,z=1<<k;P<z;++P){for(var I=[],D=0;D<k;++D)P>>>D&1&&I.push(T[D]);x.push(I)}return i(x)}M.explode=m;function u(f,x){if(x<0)return[];for(var l=[],L=(1<<x+1)-1,T=0;T<f.length;++T)for(var k=f[T],P=L;P<1<<k.length;P=e.nextCombination(P)){for(var z=new Array(x+1),I=0,D=0;D<k.length;++D)P&1<<D&&(z[I++]=k[D]);l.push(z)}return i(l)}M.skeleton=u;function _(f){for(var x=[],l=0,L=f.length;l<L;++l)for(var T=f[l],k=0,P=T.length;k<P;++k){for(var z=new Array(T.length-1),I=0,D=0;I<P;++I)I!==k&&(z[D++]=T[I]);x.push(z)}return i(x)}M.boundary=_;function s(f,x){for(var l=new a(x),L=0;L<f.length;++L)for(var T=f[L],k=0;k<T.length;++k)for(var P=k+1;P<T.length;++P)l.link(T[k],T[P]);for(var z=[],I=l.ranks,L=0;L<I.length;++L)I[L]=-1;for(var L=0;L<f.length;++L){var D=l.find(f[L][0]);I[D]<0?(I[D]=z.length,z.push([f[L].slice(0)])):z[I[D]].push(f[L].slice(0))}return z}function A(f){for(var x=y(i(u(f,0))),l=new a(x.length),L=0;L<f.length;++L)for(var T=f[L],k=0;k<T.length;++k)for(var P=p(x,[T[k]]),z=k+1;z<T.length;++z)l.link(P,p(x,[T[z]]));for(var I=[],D=l.ranks,L=0;L<D.length;++L)D[L]=-1;for(var L=0;L<f.length;++L){var R=l.find(p(x,[f[L][0]]));D[R]<0?(D[R]=I.length,I.push([f[L].slice(0)])):I[D[R]].push(f[L].slice(0))}return I}function b(f,x){return x?s(f,x):A(f)}M.connectedComponents=b},{"bit-twiddle":32,"union-find":309}],294:[function(v,S,M){arguments[4][32][0].apply(M,arguments)},{dup:32}],295:[function(v,S,M){arguments[4][293][0].apply(M,arguments)},{"bit-twiddle":294,dup:293,"union-find":296}],296:[function(v,S,M){S.exports=e;function e(a){this.roots=new Array(a),this.ranks=new Array(a);for(var n=0;n<a;++n)this.roots[n]=n,this.ranks[n]=0}e.prototype.length=function(){return this.roots.length},e.prototype.makeSet=function(){var a=this.roots.length;return this.roots.push(a),this.ranks.push(0),a},e.prototype.find=function(a){for(var n=this.roots;n[a]!==a;){var r=n[a];n[a]=n[r],a=r}return a},e.prototype.link=function(a,n){var r=this.find(a),t=this.find(n);if(r!==t){var c=this.ranks,o=this.roots,i=c[r],y=c[t];i<y?o[r]=t:y<i?o[t]=r:(o[t]=r,++c[r])}}},{}],297:[function(v,S,M){S.exports=r;var e=v("robust-orientation"),a=v("simplicial-complex");function n(t,c,o){var i=Math.abs(e(t,c,o)),y=Math.sqrt(Math.pow(c[0]-o[0],2)+Math.pow(c[1]-o[1],2));return i/y}function r(t,c,o){for(var i=c.length,y=t.length,p=new Array(i),g=new Array(i),h=new Array(i),m=new Array(i),u=0;u<i;++u)p[u]=g[u]=-1,h[u]=1/0,m[u]=!1;for(var u=0;u<y;++u){var _=t[u];if(_.length!==2)throw new Error("Input must be a graph");var s=_[1],A=_[0];g[A]!==-1?g[A]=-2:g[A]=s,p[s]!==-1?p[s]=-2:p[s]=A}function b(X){if(m[X])return 1/0;var Y=p[X],Z=g[X];return Y<0||Z<0?1/0:n(c[X],c[Y],c[Z])}function f(X,Y){var Z=I[X],oe=I[Y];I[X]=oe,I[Y]=Z,D[Z]=Y,D[oe]=X}function x(X){return h[I[X]]}function l(X){return X&1?X-1>>1:(X>>1)-1}function L(X){for(var Y=x(X);;){var Z=Y,oe=2*X+1,re=2*(X+1),se=X;if(oe<B){var N=x(oe);N<Z&&(se=oe,Z=N)}if(re<B){var U=x(re);U<Z&&(se=re)}if(se===X)return X;f(X,se),X=se}}function T(X){for(var Y=x(X);X>0;){var Z=l(X);if(Z>=0){var oe=x(Z);if(Y<oe){f(X,Z),X=Z;continue}}return X}}function k(){if(B>0){var X=I[0];return f(0,B-1),B-=1,L(0),X}return-1}function P(X,Y){var Z=I[X];return h[Z]===Y?X:(h[Z]=-1/0,T(X),k(),h[Z]=Y,B+=1,T(B-1))}function z(X){if(!m[X]){m[X]=!0;var Y=p[X],Z=g[X];p[Z]>=0&&(p[Z]=Y),g[Y]>=0&&(g[Y]=Z),D[Y]>=0&&P(D[Y],b(Y)),D[Z]>=0&&P(D[Z],b(Z))}}for(var I=[],D=new Array(i),u=0;u<i;++u){var R=h[u]=b(u);R<1/0?(D[u]=I.length,I.push(u)):D[u]=-1}for(var B=I.length,u=B>>1;u>=0;--u)L(u);for(;;){var F=k();if(F<0||h[F]>o)break;z(F)}for(var H=[],u=0;u<i;++u)m[u]||(D[u]=H.length,H.push(c[u].slice()));H.length;function G(X,Y){if(X[Y]<0)return Y;var Z=Y,oe=Y;do{var re=X[oe];if(!m[oe]||re<0||re===oe||(oe=re,re=X[oe],!m[oe]||re<0||re===oe))break;oe=re,Z=X[Z]}while(Z!==oe);for(var se=Y;se!==oe;se=X[se])X[se]=oe;return oe}var J=[];return t.forEach(function(X){var Y=G(p,X[0]),Z=G(g,X[1]);if(Y>=0&&Z>=0&&Y!==Z){var oe=D[Y],re=D[Z];oe!==re&&J.push([oe,re])}}),a.unique(a.normalize(J)),{positions:H,edges:J}}},{"robust-orientation":284,"simplicial-complex":295}],298:[function(v,S,M){S.exports=n;var e=v("robust-orientation");function a(r,t){var c,o;if(t[0][0]<t[1][0])c=t[0],o=t[1];else if(t[0][0]>t[1][0])c=t[1],o=t[0];else{var i=Math.min(r[0][1],r[1][1]),y=Math.max(r[0][1],r[1][1]),p=Math.min(t[0][1],t[1][1]),g=Math.max(t[0][1],t[1][1]);return y<p?y-p:i>g?i-g:y-g}var h,m;r[0][1]<r[1][1]?(h=r[0],m=r[1]):(h=r[1],m=r[0]);var u=e(o,c,h);return u||(u=e(o,c,m),u)?u:m-o}function n(r,t){var c,o;if(t[0][0]<t[1][0])c=t[0],o=t[1];else if(t[0][0]>t[1][0])c=t[1],o=t[0];else return a(t,r);var i,y;if(r[0][0]<r[1][0])i=r[0],y=r[1];else if(r[0][0]>r[1][0])i=r[1],y=r[0];else return-a(r,t);var p=e(c,o,y),g=e(c,o,i);if(p<0){if(g<=0)return p}else if(p>0){if(g>=0)return p}else if(g)return g;if(p=e(y,i,o),g=e(y,i,c),p<0){if(g<=0)return p}else if(p>0){if(g>=0)return p}else if(g)return g;return o[0]-y[0]}},{"robust-orientation":284}],299:[function(v,S,M){S.exports=g;var e=v("binary-search-bounds"),a=v("functional-red-black-tree"),n=v("robust-orientation"),r=v("./lib/order-segments");function t(h,m,u){this.slabs=h,this.coordinates=m,this.horizontal=u}var c=t.prototype;function o(h,m){return h.y-m}function i(h,m){for(var u=null;h;){var _=h.key,s,A;_[0][0]<_[1][0]?(s=_[0],A=_[1]):(s=_[1],A=_[0]);var b=n(s,A,m);if(b<0)h=h.left;else if(b>0)if(m[0]!==_[1][0])u=h,h=h.right;else{var f=i(h.right,m);if(f)return f;h=h.left}else{if(m[0]!==_[1][0])return h;var f=i(h.right,m);if(f)return f;h=h.left}}return u}c.castUp=function(h){var m=e.le(this.coordinates,h[0]);if(m<0)return-1;this.slabs[m];var u=i(this.slabs[m],h),_=-1;if(u&&(_=u.value),this.coordinates[m]===h[0]){var s=null;if(u&&(s=u.key),m>0){var A=i(this.slabs[m-1],h);A&&(s?r(A.key,s)>0&&(s=A.key,_=A.value):(_=A.value,s=A.key))}var b=this.horizontal[m];if(b.length>0){var f=e.ge(b,h[1],o);if(f<b.length){var x=b[f];if(h[1]===x.y){if(x.closed)return x.index;for(;f<b.length-1&&b[f+1].y===h[1];)if(f=f+1,x=b[f],x.closed)return x.index;if(x.y===h[1]&&!x.start){if(f=f+1,f>=b.length)return _;x=b[f]}}if(x.start)if(s){var l=n(s[0],s[1],[h[0],x.y]);s[0][0]>s[1][0]&&(l=-l),l>0&&(_=x.index)}else _=x.index;else x.y!==h[1]&&(_=x.index)}}}return _};function y(h,m,u,_){this.y=h,this.index=m,this.start=u,this.closed=_}function p(h,m,u,_){this.x=h,this.segment=m,this.create=u,this.index=_}function g(h){for(var m=h.length,u=2*m,_=new Array(u),s=0;s<m;++s){var A=h[s],b=A[0][0]<A[1][0];_[2*s]=new p(A[0][0],A,b,s),_[2*s+1]=new p(A[1][0],A,!b,s)}_.sort(function(z,I){var D=z.x-I.x;return D||(D=z.create-I.create,D)?D:Math.min(z.segment[0][1],z.segment[1][1])-Math.min(I.segment[0][1],I.segment[1][1])});for(var f=a(r),x=[],l=[],L=[],s=0;s<u;){for(var T=_[s].x,k=[];s<u;){var P=_[s];if(P.x!==T)break;s+=1,P.segment[0][0]===P.x&&P.segment[1][0]===P.x?P.create&&(P.segment[0][1]<P.segment[1][1]?(k.push(new y(P.segment[0][1],P.index,!0,!0)),k.push(new y(P.segment[1][1],P.index,!1,!1))):(k.push(new y(P.segment[1][1],P.index,!0,!1)),k.push(new y(P.segment[0][1],P.index,!1,!0)))):P.create?f=f.insert(P.segment,P.index):f=f.remove(P.segment)}x.push(f.root),l.push(T),L.push(k)}return new t(x,l,L)}},{"./lib/order-segments":298,"binary-search-bounds":31,"functional-red-black-tree":69,"robust-orientation":284}],300:[function(v,S,M){var e=v("robust-dot-product"),a=v("robust-sum");S.exports=t,S.exports.positive=c,S.exports.negative=o;function n(i,y){var p=a(e(i,y),[y[y.length-1]]);return p[p.length-1]}function r(i,y,p,g){var h=g-y,m=-y/h;m<0?m=0:m>1&&(m=1);for(var u=1-m,_=i.length,s=new Array(_),A=0;A<_;++A)s[A]=m*i[A]+u*p[A];return s}function t(i,y){for(var p=[],g=[],h=n(i[i.length-1],y),m=i[i.length-1],u=i[0],_=0;_<i.length;++_,m=u){u=i[_];var s=n(u,y);if(h<0&&s>0||h>0&&s<0){var A=r(m,s,u,h);p.push(A),g.push(A.slice())}s<0?g.push(u.slice()):s>0?p.push(u.slice()):(p.push(u.slice()),g.push(u.slice())),h=s}return{positive:p,negative:g}}function c(i,y){for(var p=[],g=n(i[i.length-1],y),h=i[i.length-1],m=i[0],u=0;u<i.length;++u,h=m){m=i[u];var _=n(m,y);(g<0&&_>0||g>0&&_<0)&&p.push(r(h,_,m,g)),_>=0&&p.push(m.slice()),g=_}return p}function o(i,y){for(var p=[],g=n(i[i.length-1],y),h=i[i.length-1],m=i[0],u=0;u<i.length;++u,h=m){m=i[u];var _=n(m,y);(g<0&&_>0||g>0&&_<0)&&p.push(r(h,_,m,g)),_<=0&&p.push(m.slice()),g=_}return p}},{"robust-dot-product":281,"robust-sum":289}],301:[function(v,S,M){(function(){var e={not_string:/[^s]/,not_bool:/[^t]/,not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[+-]/};function a(o){return r(c(o),arguments)}function n(o,i){return a.apply(null,[o].concat(i||[]))}function r(o,i){var y=1,p=o.length,g,h="",m,u,_,s,A,b,f,x;for(m=0;m<p;m++)if(typeof o[m]=="string")h+=o[m];else if(typeof o[m]=="object"){if(_=o[m],_.keys)for(g=i[y],u=0;u<_.keys.length;u++){if(g==null)throw new Error(a('[sprintf] Cannot access property "%s" of undefined value "%s"',_.keys[u],_.keys[u-1]));g=g[_.keys[u]]}else _.param_no?g=i[_.param_no]:g=i[y++];if(e.not_type.test(_.type)&&e.not_primitive.test(_.type)&&g instanceof Function&&(g=g()),e.numeric_arg.test(_.type)&&typeof g!="number"&&isNaN(g))throw new TypeError(a("[sprintf] expecting number but found %T",g));switch(e.number.test(_.type)&&(f=g>=0),_.type){case"b":g=parseInt(g,10).toString(2);break;case"c":g=String.fromCharCode(parseInt(g,10));break;case"d":case"i":g=parseInt(g,10);break;case"j":g=JSON.stringify(g,null,_.width?parseInt(_.width):0);break;case"e":g=_.precision?parseFloat(g).toExponential(_.precision):parseFloat(g).toExponential();break;case"f":g=_.precision?parseFloat(g).toFixed(_.precision):parseFloat(g);break;case"g":g=_.precision?String(Number(g.toPrecision(_.precision))):parseFloat(g);break;case"o":g=(parseInt(g,10)>>>0).toString(8);break;case"s":g=String(g),g=_.precision?g.substring(0,_.precision):g;break;case"t":g=String(!!g),g=_.precision?g.substring(0,_.precision):g;break;case"T":g=Object.prototype.toString.call(g).slice(8,-1).toLowerCase(),g=_.precision?g.substring(0,_.precision):g;break;case"u":g=parseInt(g,10)>>>0;break;case"v":g=g.valueOf(),g=_.precision?g.substring(0,_.precision):g;break;case"x":g=(parseInt(g,10)>>>0).toString(16);break;case"X":g=(parseInt(g,10)>>>0).toString(16).toUpperCase();break}e.json.test(_.type)?h+=g:(e.number.test(_.type)&&(!f||_.sign)?(x=f?"+":"-",g=g.toString().replace(e.sign,"")):x="",A=_.pad_char?_.pad_char==="0"?"0":_.pad_char.charAt(1):" ",b=_.width-(x+g).length,s=_.width&&b>0?A.repeat(b):"",h+=_.align?x+g+s:A==="0"?x+s+g:s+x+g)}return h}var t=Object.create(null);function c(o){if(t[o])return t[o];for(var i=o,y,p=[],g=0;i;){if((y=e.text.exec(i))!==null)p.push(y[0]);else if((y=e.modulo.exec(i))!==null)p.push("%");else if((y=e.placeholder.exec(i))!==null){if(y[2]){g|=1;var h=[],m=y[2],u=[];if((u=e.key.exec(m))!==null)for(h.push(u[1]);(m=m.substring(u[0].length))!=="";)if((u=e.key_access.exec(m))!==null)h.push(u[1]);else if((u=e.index_access.exec(m))!==null)h.push(u[1]);else throw new SyntaxError("[sprintf] failed to parse named argument key");else throw new SyntaxError("[sprintf] failed to parse named argument key");y[2]=h}else g|=2;if(g===3)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");p.push({placeholder:y[0],param_no:y[1],keys:y[2],sign:y[3],pad_char:y[4],align:y[5],width:y[6],precision:y[7],type:y[8]})}else throw new SyntaxError("[sprintf] unexpected placeholder");i=i.substring(y[0].length)}return t[o]=p}typeof M<"u"&&(M.sprintf=a,M.vsprintf=n),typeof window<"u"&&(window.sprintf=a,window.vsprintf=n)})()},{}],302:[function(v,S,M){S.exports=o;var e=v("ndarray-extract-contour"),a=v("zero-crossings"),n={"2d":function(i,y,p){var g=i({order:y,scalarArguments:3,getters:p==="generic"?[0]:void 0,phase:function(m,u,_,s){return m>s|0},vertex:function(m,u,_,s,A,b,f,x,l,L,T,k,P){var z=(f<<0)+(x<<1)+(l<<2)+(L<<3)|0;if(!(z===0||z===15))switch(z){case 0:T.push([m-.5,u-.5]);break;case 1:T.push([m-.25-.25*(s+_-2*P)/(_-s),u-.25-.25*(A+_-2*P)/(_-A)]);break;case 2:T.push([m-.75-.25*(-s-_+2*P)/(s-_),u-.25-.25*(b+s-2*P)/(s-b)]);break;case 3:T.push([m-.5,u-.5-.5*(A+_+b+s-4*P)/(_-A+s-b)]);break;case 4:T.push([m-.25-.25*(b+A-2*P)/(A-b),u-.75-.25*(-A-_+2*P)/(A-_)]);break;case 5:T.push([m-.5-.5*(s+_+b+A-4*P)/(_-s+A-b),u-.5]);break;case 6:T.push([m-.5-.25*(-s-_+b+A)/(s-_+A-b),u-.5-.25*(-A-_+b+s)/(A-_+s-b)]);break;case 7:T.push([m-.75-.25*(b+A-2*P)/(A-b),u-.75-.25*(b+s-2*P)/(s-b)]);break;case 8:T.push([m-.75-.25*(-b-A+2*P)/(b-A),u-.75-.25*(-b-s+2*P)/(b-s)]);break;case 9:T.push([m-.5-.25*(s+_+-b-A)/(_-s+b-A),u-.5-.25*(A+_+-b-s)/(_-A+b-s)]);break;case 10:T.push([m-.5-.5*(-s-_+-b-A+4*P)/(s-_+b-A),u-.5]);break;case 11:T.push([m-.25-.25*(-b-A+2*P)/(b-A),u-.75-.25*(A+_-2*P)/(_-A)]);break;case 12:T.push([m-.5,u-.5-.5*(-A-_+-b-s+4*P)/(A-_+b-s)]);break;case 13:T.push([m-.75-.25*(s+_-2*P)/(_-s),u-.25-.25*(-b-s+2*P)/(b-s)]);break;case 14:T.push([m-.25-.25*(-s-_+2*P)/(s-_),u-.25-.25*(-A-_+2*P)/(A-_)]);break;case 15:T.push([m-.5,u-.5]);break}},cell:function(m,u,_,s,A,b,f,x,l){A?x.push([m,u]):x.push([u,m])}});return function(h,m){var u=[],_=[];return g(h,u,_,m),{positions:u,cells:_}}}};function r(i,y){var p=i.length+"d",g=n[p];if(g)return g(e,i,y)}function t(i,y){for(var p=a(i,y),g=p.length,h=new Array(g),m=new Array(g),u=0;u<g;++u)h[u]=[p[u]],m[u]=[u];return{positions:h,cells:m}}var c={};function o(i,h){if(i.dimension<=0)return{positions:[],cells:[]};if(i.dimension===1)return t(i,h);var p=i.order.join()+"-"+i.dtype,g=c[p],h=+h||0;return g||(g=c[p]=r(i.order,i.dtype)),g(i,h)}},{"ndarray-extract-contour":251,"zero-crossings":318}],303:[function(v,S,M){(function(e){(function(){S.exports=c;var a=v("vectorize-text"),n=window||e.global||{},r=n.__TEXT_CACHE||{};n.__TEXT_CACHE={};function t(o){for(var i=o.cells,y=o.positions,p=new Float32Array(i.length*6),g=0,h=0,m=0;m<i.length;++m)for(var u=i[m],_=0;_<3;++_){var s=y[u[_]];p[g++]=s[0],p[g++]=s[1]+1.4,h=Math.max(s[0],h)}return{data:p,shape:h}}function c(o,i,p){var p=p||{},g=r[o];g||(g=r[o]={" ":{data:new Float32Array(0),shape:.2}});var h=g[i];if(!h)if(i.length<=1||!/\d/.test(i))h=g[i]=t(a(i,{triangles:!0,font:o,textAlign:p.textAlign||"left",textBaseline:"alphabetic",styletags:{breaklines:!0,bolds:!0,italics:!0,subscripts:!0,superscripts:!0}}));else{for(var m=i.split(/(\d|\s)/),u=new Array(m.length),_=0,s=0,A=0;A<m.length;++A)u[A]=c(o,m[A]),_+=u[A].data.length,s+=u[A].shape,A>0&&(s+=.02);for(var b=new Float32Array(_),f=0,x=-.5*s,A=0;A<u.length;++A){for(var l=u[A].data,L=0;L<l.length;L+=2)b[f++]=l[L]+x,b[f++]=l[L+1];x+=u[A].shape+.02}h=g[i]={data:b,shape:s}}return h}}).call(this)}).call(this,v("_process"))},{_process:5,"vectorize-text":311}],304:[function(v,S,M){var e=v("parse-unit");S.exports=t;var a=96;function n(c,o){var i=e(getComputedStyle(c).getPropertyValue(o));return i[0]*t(i[1],c)}function r(c,o){var i=document.createElement("div");i.style["font-size"]="128"+c,o.appendChild(i);var y=n(i,"font-size")/128;return o.removeChild(i),y}function t(c,o){switch(o=o||document.body,c=(c||"px").trim().toLowerCase(),(o===window||o===document)&&(o=document.body),c){case"%":return o.clientHeight/100;case"ch":case"ex":return r(c,o);case"em":return n(o,"font-size");case"rem":return n(document.body,"font-size");case"vw":return window.innerWidth/100;case"vh":return window.innerHeight/100;case"vmin":return Math.min(window.innerWidth,window.innerHeight)/100;case"vmax":return Math.max(window.innerWidth,window.innerHeight)/100;case"in":return a;case"cm":return a/2.54;case"mm":return a/25.4;case"pt":return a/72;case"pc":return a/6}return 1}},{"parse-unit":265}],305:[function(v,S,M){S.exports=m;var e=v("filtered-vector"),a=v("gl-mat4/invert"),n=v("gl-mat4/rotate"),r=v("gl-vec3/cross"),t=v("gl-vec3/normalize"),c=v("gl-vec3/dot");function o(u,_,s){return Math.sqrt(Math.pow(u,2)+Math.pow(_,2)+Math.pow(s,2))}function i(u){return Math.min(1,Math.max(-1,u))}function y(u){var _=Math.abs(u[0]),s=Math.abs(u[1]),A=Math.abs(u[2]),b=[0,0,0];_>Math.max(s,A)?b[2]=1:s>Math.max(_,A)?b[0]=1:b[1]=1;for(var f=0,x=0,l=0;l<3;++l)f+=u[l]*u[l],x+=b[l]*u[l];for(var l=0;l<3;++l)b[l]-=x/f*u[l];return t(b,b),b}function p(u,_,s,A,b,f,x,l){this.center=e(s),this.up=e(A),this.right=e(b),this.radius=e([f]),this.angle=e([x,l]),this.angle.bounds=[[-1/0,-Math.PI/2],[1/0,Math.PI/2]],this.setDistanceLimits(u,_),this.computedCenter=this.center.curve(0),this.computedUp=this.up.curve(0),this.computedRight=this.right.curve(0),this.computedRadius=this.radius.curve(0),this.computedAngle=this.angle.curve(0),this.computedToward=[0,0,0],this.computedEye=[0,0,0],this.computedMatrix=new Array(16);for(var L=0;L<16;++L)this.computedMatrix[L]=.5;this.recalcMatrix(0)}var g=p.prototype;g.setDistanceLimits=function(u,_){u>0?u=Math.log(u):u=-1/0,_>0?_=Math.log(_):_=1/0,_=Math.max(_,u),this.radius.bounds[0][0]=u,this.radius.bounds[1][0]=_},g.getDistanceLimits=function(u){var _=this.radius.bounds[0];return u?(u[0]=Math.exp(_[0][0]),u[1]=Math.exp(_[1][0]),u):[Math.exp(_[0][0]),Math.exp(_[1][0])]},g.recalcMatrix=function(u){this.center.curve(u),this.up.curve(u),this.right.curve(u),this.radius.curve(u),this.angle.curve(u);for(var _=this.computedUp,s=this.computedRight,A=0,b=0,f=0;f<3;++f)b+=_[f]*s[f],A+=_[f]*_[f];for(var x=Math.sqrt(A),l=0,f=0;f<3;++f)s[f]-=_[f]*b/A,l+=s[f]*s[f],_[f]/=x;for(var L=Math.sqrt(l),f=0;f<3;++f)s[f]/=L;var T=this.computedToward;r(T,_,s),t(T,T);for(var k=Math.exp(this.computedRadius[0]),P=this.computedAngle[0],z=this.computedAngle[1],I=Math.cos(P),D=Math.sin(P),R=Math.cos(z),B=Math.sin(z),F=this.computedCenter,H=I*R,G=D*R,J=B,X=-I*B,Y=-D*B,Z=R,oe=this.computedEye,re=this.computedMatrix,f=0;f<3;++f){var se=H*s[f]+G*T[f]+J*_[f];re[4*f+1]=X*s[f]+Y*T[f]+Z*_[f],re[4*f+2]=se,re[4*f+3]=0}var N=re[1],U=re[5],q=re[9],$=re[2],W=re[6],K=re[10],ne=U*K-q*W,ae=q*$-N*K,ie=N*W-U*$,le=o(ne,ae,ie);ne/=le,ae/=le,ie/=le,re[0]=ne,re[4]=ae,re[8]=ie;for(var f=0;f<3;++f)oe[f]=F[f]+re[2+4*f]*k;for(var f=0;f<3;++f){for(var l=0,ye=0;ye<3;++ye)l+=re[f+4*ye]*oe[ye];re[12+f]=-l}re[15]=1},g.getMatrix=function(u,_){this.recalcMatrix(u);var s=this.computedMatrix;if(_){for(var A=0;A<16;++A)_[A]=s[A];return _}return s};var h=[0,0,0];g.rotate=function(u,_,s,A){if(this.angle.move(u,_,s),A){this.recalcMatrix(u);var b=this.computedMatrix;h[0]=b[2],h[1]=b[6],h[2]=b[10];for(var f=this.computedUp,x=this.computedRight,l=this.computedToward,L=0;L<3;++L)b[4*L]=f[L],b[4*L+1]=x[L],b[4*L+2]=l[L];n(b,b,A,h);for(var L=0;L<3;++L)f[L]=b[4*L],x[L]=b[4*L+1];this.up.set(u,f[0],f[1],f[2]),this.right.set(u,x[0],x[1],x[2])}},g.pan=function(u,_,s,A){_=_||0,s=s||0,A=A||0,this.recalcMatrix(u);var b=this.computedMatrix;Math.exp(this.computedRadius[0]);var f=b[1],x=b[5],l=b[9],L=o(f,x,l);f/=L,x/=L,l/=L;var T=b[0],k=b[4],P=b[8],z=T*f+k*x+P*l;T-=f*z,k-=x*z,P-=l*z;var I=o(T,k,P);T/=I,k/=I,P/=I;var D=T*_+f*s,R=k*_+x*s,B=P*_+l*s;this.center.move(u,D,R,B);var F=Math.exp(this.computedRadius[0]);F=Math.max(1e-4,F+A),this.radius.set(u,Math.log(F))},g.translate=function(u,_,s,A){this.center.move(u,_||0,s||0,A||0)},g.setMatrix=function(u,_,s,A){var b=1;typeof s=="number"&&(b=s|0),(b<0||b>3)&&(b=1);var f=(b+2)%3;_||(this.recalcMatrix(u),_=this.computedMatrix);var x=_[b],l=_[b+4],L=_[b+8];if(A){var k=Math.abs(x),P=Math.abs(l),z=Math.abs(L),I=Math.max(k,P,z);k===I?(x=x<0?-1:1,l=L=0):z===I?(L=L<0?-1:1,x=l=0):(l=l<0?-1:1,x=L=0)}else{var T=o(x,l,L);x/=T,l/=T,L/=T}var D=_[f],R=_[f+4],B=_[f+8],F=D*x+R*l+B*L;D-=x*F,R-=l*F,B-=L*F;var H=o(D,R,B);D/=H,R/=H,B/=H;var G=l*B-L*R,J=L*D-x*B,X=x*R-l*D,Y=o(G,J,X);G/=Y,J/=Y,X/=Y,this.center.jump(u,Te,_e,ze),this.radius.idle(u),this.up.jump(u,x,l,L),this.right.jump(u,D,R,B);var Z,oe;if(b===2){var re=_[1],se=_[5],N=_[9],U=re*D+se*R+N*B,q=re*G+se*J+N*X;ne<0?Z=-Math.PI/2:Z=Math.PI/2,oe=Math.atan2(q,U)}else{var $=_[2],W=_[6],K=_[10],ne=$*x+W*l+K*L,ae=$*D+W*R+K*B,ie=$*G+W*J+K*X;Z=Math.asin(i(ne)),oe=Math.atan2(ie,ae)}this.angle.jump(u,oe,Z),this.recalcMatrix(u);var le=_[2],ye=_[6],ue=_[10],pe=this.computedMatrix;a(pe,_);var ge=pe[15],Te=pe[12]/ge,_e=pe[13]/ge,ze=pe[14]/ge,Oe=Math.exp(this.computedRadius[0]);this.center.jump(u,Te-le*Oe,_e-ye*Oe,ze-ue*Oe)},g.lastT=function(){return Math.max(this.center.lastT(),this.up.lastT(),this.right.lastT(),this.radius.lastT(),this.angle.lastT())},g.idle=function(u){this.center.idle(u),this.up.idle(u),this.right.idle(u),this.radius.idle(u),this.angle.idle(u)},g.flush=function(u){this.center.flush(u),this.up.flush(u),this.right.flush(u),this.radius.flush(u),this.angle.flush(u)},g.setDistance=function(u,_){_>0&&this.radius.set(u,Math.log(_))},g.lookAt=function(u,_,s,A){this.recalcMatrix(u),_=_||this.computedEye,s=s||this.computedCenter,A=A||this.computedUp;var b=A[0],f=A[1],x=A[2],l=o(b,f,x);if(!(l<1e-6)){b/=l,f/=l,x/=l;var L=_[0]-s[0],T=_[1]-s[1],k=_[2]-s[2],P=o(L,T,k);if(!(P<1e-6)){L/=P,T/=P,k/=P;var z=this.computedRight,I=z[0],D=z[1],R=z[2],B=b*I+f*D+x*R;I-=B*b,D-=B*f,R-=B*x;var F=o(I,D,R);if(!(F<.01&&(I=f*k-x*T,D=x*L-b*k,R=b*T-f*L,F=o(I,D,R),F<1e-6))){I/=F,D/=F,R/=F,this.up.set(u,b,f,x),this.right.set(u,I,D,R),this.center.set(u,s[0],s[1],s[2]),this.radius.set(u,Math.log(P));var H=f*R-x*D,G=x*I-b*R,J=b*D-f*I,X=o(H,G,J);H/=X,G/=X,J/=X;var Y=b*L+f*T+x*k,Z=I*L+D*T+R*k,oe=H*L+G*T+J*k,re=Math.asin(i(Y)),se=Math.atan2(oe,Z),N=this.angle._state,U=N[N.length-1],q=N[N.length-2];U=U%(2*Math.PI);var $=Math.abs(U+2*Math.PI-se),W=Math.abs(U-se),K=Math.abs(U-2*Math.PI-se);$<W&&(U+=2*Math.PI),K<W&&(U-=2*Math.PI),this.angle.jump(this.angle.lastT(),U,q),this.angle.set(u,se,re)}}}};function m(u){u=u||{};var _=u.center||[0,0,0],s=u.up||[0,1,0],A=u.right||y(s),b=u.radius||1,f=u.theta||0,x=u.phi||0;if(_=[].slice.call(_,0,3),s=[].slice.call(s,0,3),t(s,s),A=[].slice.call(A,0,3),t(A,A),"eye"in u){var l=u.eye,L=[l[0]-_[0],l[1]-_[1],l[2]-_[2]];r(A,L,s),o(A[0],A[1],A[2])<1e-6?A=y(s):t(A,A),b=o(L[0],L[1],L[2]);var T=c(s,L)/b,k=c(A,L)/b;x=Math.acos(T),f=Math.acos(k)}return b=Math.log(b),new p(u.zoomMin,u.zoomMax,_,s,A,b,f,x)}},{"filtered-vector":68,"gl-mat4/invert":98,"gl-mat4/rotate":103,"gl-vec3/cross":157,"gl-vec3/dot":162,"gl-vec3/normalize":179}],306:[function(v,S,M){S.exports=a;var e=+(Math.pow(2,27)+1);function a(n,r,t){var c=n*r,o=e*n,i=o-n,y=o-i,p=n-y,g=e*r,h=g-r,m=g-h,u=r-m,_=c-y*m,s=_-p*m,A=s-y*u,b=p*u-A;return t?(t[0]=b,t[1]=c,t):[b,c]}},{}],307:[function(v,S,M){S.exports=e;function e(a,n,r){var t=a+n,c=t-a,o=t-c,i=n-c,y=a-o;return r?(r[0]=y+i,r[1]=t,r):[y+i,t]}},{}],308:[function(v,S,M){(function(e){(function(){var a=v("bit-twiddle"),n=v("dup"),r=v("buffer").Buffer;e.__TYPEDARRAY_POOL||(e.__TYPEDARRAY_POOL={UINT8:n([32,0]),UINT16:n([32,0]),UINT32:n([32,0]),BIGUINT64:n([32,0]),INT8:n([32,0]),INT16:n([32,0]),INT32:n([32,0]),BIGINT64:n([32,0]),FLOAT:n([32,0]),DOUBLE:n([32,0]),DATA:n([32,0]),UINT8C:n([32,0]),BUFFER:n([32,0])});var t=typeof Uint8ClampedArray<"u",c=typeof BigUint64Array<"u",o=typeof BigInt64Array<"u",i=e.__TYPEDARRAY_POOL;i.UINT8C||(i.UINT8C=n([32,0])),i.BIGUINT64||(i.BIGUINT64=n([32,0])),i.BIGINT64||(i.BIGINT64=n([32,0])),i.BUFFER||(i.BUFFER=n([32,0]));var y=i.DATA,p=i.BUFFER;M.free=function(D){if(r.isBuffer(D))p[a.log2(D.length)].push(D);else{if(Object.prototype.toString.call(D)!=="[object ArrayBuffer]"&&(D=D.buffer),!D)return;var R=D.length||D.byteLength,B=a.log2(R)|0;y[B].push(D)}};function g(I){if(!!I){var D=I.length||I.byteLength,R=a.log2(D);y[R].push(I)}}function h(I){g(I.buffer)}M.freeUint8=M.freeUint16=M.freeUint32=M.freeBigUint64=M.freeInt8=M.freeInt16=M.freeInt32=M.freeBigInt64=M.freeFloat32=M.freeFloat=M.freeFloat64=M.freeDouble=M.freeUint8Clamped=M.freeDataView=h,M.freeArrayBuffer=g,M.freeBuffer=function(D){p[a.log2(D.length)].push(D)},M.malloc=function(D,R){if(R===void 0||R==="arraybuffer")return m(D);switch(R){case"uint8":return u(D);case"uint16":return _(D);case"uint32":return s(D);case"int8":return A(D);case"int16":return b(D);case"int32":return f(D);case"float":case"float32":return x(D);case"double":case"float64":return l(D);case"uint8_clamped":return L(D);case"bigint64":return k(D);case"biguint64":return T(D);case"buffer":return z(D);case"data":case"dataview":return P(D);default:return null}return null};function m(D){var D=a.nextPow2(D),R=a.log2(D),B=y[R];return B.length>0?B.pop():new ArrayBuffer(D)}M.mallocArrayBuffer=m;function u(I){return new Uint8Array(m(I),0,I)}M.mallocUint8=u;function _(I){return new Uint16Array(m(2*I),0,I)}M.mallocUint16=_;function s(I){return new Uint32Array(m(4*I),0,I)}M.mallocUint32=s;function A(I){return new Int8Array(m(I),0,I)}M.mallocInt8=A;function b(I){return new Int16Array(m(2*I),0,I)}M.mallocInt16=b;function f(I){return new Int32Array(m(4*I),0,I)}M.mallocInt32=f;function x(I){return new Float32Array(m(4*I),0,I)}M.mallocFloat32=M.mallocFloat=x;function l(I){return new Float64Array(m(8*I),0,I)}M.mallocFloat64=M.mallocDouble=l;function L(I){return t?new Uint8ClampedArray(m(I),0,I):u(I)}M.mallocUint8Clamped=L;function T(I){return c?new BigUint64Array(m(8*I),0,I):null}M.mallocBigUint64=T;function k(I){return o?new BigInt64Array(m(8*I),0,I):null}M.mallocBigInt64=k;function P(I){return new DataView(m(I),0,I)}M.mallocDataView=P;function z(I){I=a.nextPow2(I);var D=a.log2(I),R=p[D];return R.length>0?R.pop():new r(I)}M.mallocBuffer=z,M.clearCache=function(){for(var D=0;D<32;++D)i.UINT8[D].length=0,i.UINT16[D].length=0,i.UINT32[D].length=0,i.INT8[D].length=0,i.INT16[D].length=0,i.INT32[D].length=0,i.FLOAT[D].length=0,i.DOUBLE[D].length=0,i.BIGUINT64[D].length=0,i.BIGINT64[D].length=0,i.UINT8C[D].length=0,y[D].length=0,p[D].length=0}}).call(this)}).call(this,typeof w<"u"?w:typeof self<"u"?self:typeof window<"u"?window:{})},{"bit-twiddle":32,buffer:3,dup:65}],309:[function(v,S,M){S.exports=e;function e(n){this.roots=new Array(n),this.ranks=new Array(n);for(var r=0;r<n;++r)this.roots[r]=r,this.ranks[r]=0}var a=e.prototype;Object.defineProperty(a,"length",{get:function(){return this.roots.length}}),a.makeSet=function(){var n=this.roots.length;return this.roots.push(n),this.ranks.push(0),n},a.find=function(n){for(var r=n,t=this.roots;t[n]!==n;)n=t[n];for(;t[r]!==n;){var c=t[r];t[r]=n,r=c}return n},a.link=function(n,r){var t=this.find(n),c=this.find(r);if(t!==c){var o=this.ranks,i=this.roots,y=o[t],p=o[c];y<p?i[t]=c:p<y?i[c]=t:(i[c]=t,++o[t])}}},{}],310:[function(v,S,M){function e(r,t){for(var c=1,o=r.length,i=r[0],y=r[0],p=1;p<o;++p)if(y=i,i=r[p],t(i,y)){if(p===c){c++;continue}r[c++]=i}return r.length=c,r}function a(r){for(var t=1,c=r.length,o=r[0],i=r[0],y=1;y<c;++y,i=o)if(i=o,o=r[y],o!==i){if(y===t){t++;continue}r[t++]=o}return r.length=t,r}function n(r,t,c){return r.length===0?r:t?(c||r.sort(t),e(r,t)):(c||r.sort(),a(r))}S.exports=n},{}],311:[function(v,S,M){S.exports=r;var e=v("./lib/vtext"),a=null,n=null;typeof document<"u"&&(a=document.createElement("canvas"),a.width=8192,a.height=1024,n=a.getContext("2d"));function r(t,c){return(typeof c!="object"||c===null)&&(c={}),e(t,c.canvas||a,c.context||n,c)}},{"./lib/vtext":312}],312:[function(v,S,M){S.exports=T,S.exports.processPixels=L;var e=v("surface-nets"),a=v("ndarray"),n=v("simplify-planar-graph"),r=v("clean-pslg"),t=v("cdt2d"),c=v("planar-graph-to-polyline"),o="b",i="b|",y="i",p="i|",g="sup",h="+",m="+1",u="sub",_="-",s="-1";function A(k,P,z,I){for(var D="<"+k+">",R="</"+k+">",B=D.length,F=R.length,H=P[0]===h||P[0]===_,G=0,J=-F;G>-1&&(G=z.indexOf(D,G),!(G===-1||(J=z.indexOf(R,G+B),J===-1)||J<=G));){for(var X=G;X<J+F;++X)if(X<G+B||X>=J)I[X]=null,z=z.substr(0,X)+" "+z.substr(X+1);else if(I[X]!==null){var Y=I[X].indexOf(P[0]);Y===-1?I[X]+=P:H&&(I[X]=I[X].substr(0,Y+1)+(1+parseInt(I[X][Y+1]))+I[X].substr(Y+2))}var Z=G+B,oe=z.substr(Z,J-Z),re=oe.indexOf(D);re!==-1?G=re:G=J+F}return I}function b(k,P,z){for(var I=P.textAlign||"start",D=P.textBaseline||"alphabetic",R=[1<<30,1<<30],B=[0,0],F=k.length,H=0;H<F;++H)for(var G=k[H],J=0;J<2;++J)R[J]=Math.min(R[J],G[J])|0,B[J]=Math.max(B[J],G[J])|0;var X=0;switch(I){case"center":X=-.5*(R[0]+B[0]);break;case"right":case"end":X=-B[0];break;case"left":case"start":X=-R[0];break;default:throw new Error("vectorize-text: Unrecognized textAlign: '"+I+"'")}var Y=0;switch(D){case"hanging":case"top":Y=-R[1];break;case"middle":Y=-.5*(R[1]+B[1]);break;case"alphabetic":case"ideographic":Y=-3*z;break;case"bottom":Y=-B[1];break;default:throw new Error("vectorize-text: Unrecoginized textBaseline: '"+D+"'")}var Z=1/z;return"lineHeight"in P?Z*=+P.lineHeight:"width"in P?Z=P.width/(B[0]-R[0]):"height"in P&&(Z=P.height/(B[1]-R[1])),k.map(function(oe){return[Z*(oe[0]+X),Z*(oe[1]+Y)]})}function f(k,P,z,I,D,R){z=z.replace(/\n/g,""),R.breaklines===!0?z=z.replace(/\<br\>/g,`
`):z=z.replace(/\<br\>/g," ");var B="",F=[];for(U=0;U<z.length;++U)F[U]=B;R.bolds===!0&&(F=A(o,i,z,F)),R.italics===!0&&(F=A(y,p,z,F)),R.superscripts===!0&&(F=A(g,m,z,F)),R.subscripts===!0&&(F=A(u,s,z,F));var H=[],G="";for(U=0;U<z.length;++U)F[U]!==null&&(G+=z[U],H.push(F[U]));var J=G.split(`
`),X=J.length,Y=Math.round(D*I),Z=I,oe=I*2,re=0,se=X*Y+oe;k.height<se&&(k.height=se),P.fillStyle="#000",P.fillRect(0,0,k.width,k.height),P.fillStyle="#fff";var N,U,q,$,W,K=0,ne="";function ae(){if(ne!==""){var ze=P.measureText(ne).width;P.fillText(ne,Z+q,oe+$),q+=ze}}function ie(){return""+Math.round(W)+"px "}function le(ze,Oe){var Ye=""+P.font;if(R.subscripts===!0){var be=ze.indexOf(_),Pe=Oe.indexOf(_),Ge=be>-1?parseInt(ze[1+be]):0,Qe=Pe>-1?parseInt(Oe[1+Pe]):0;Ge!==Qe&&(Ye=Ye.replace(ie(),"?px "),W*=Math.pow(.75,Qe-Ge),Ye=Ye.replace("?px ",ie())),$+=.25*Y*(Qe-Ge)}if(R.superscripts===!0){var Be=ze.indexOf(h),Le=Oe.indexOf(h),He=Be>-1?parseInt(ze[1+Be]):0,vt=Le>-1?parseInt(Oe[1+Le]):0;He!==vt&&(Ye=Ye.replace(ie(),"?px "),W*=Math.pow(.75,vt-He),Ye=Ye.replace("?px ",ie())),$-=.25*Y*(vt-He)}if(R.bolds===!0){var Rt=ze.indexOf(i)>-1,rr=Oe.indexOf(i)>-1;!Rt&&rr&&(Lt?Ye=Ye.replace("italic ","italic bold "):Ye="bold "+Ye),Rt&&!rr&&(Ye=Ye.replace("bold ",""))}if(R.italics===!0){var Lt=ze.indexOf(p)>-1,Ft=Oe.indexOf(p)>-1;!Lt&&Ft&&(Ye="italic "+Ye),Lt&&!Ft&&(Ye=Ye.replace("italic ",""))}P.font=Ye}for(N=0;N<X;++N){var ye=J[N]+`
`;for(q=0,$=N*Y,W=I,ne="",U=0;U<ye.length;++U){var ue=U+K<H.length?H[U+K]:H[H.length-1];B===ue?ne+=ye[U]:(ae(),ne=ye[U],ue!==void 0&&(le(B,ue),B=ue))}ae(),K+=ye.length;var pe=Math.round(q+2*Z)|0;re<pe&&(re=pe)}var ge=re,Te=oe+Y*X,_e=a(P.getImageData(0,0,ge,Te).data,[Te,ge,4]);return _e.pick(-1,-1,0).transpose(1,0)}function x(k,P){var z=e(k,128);return P?n(z.cells,z.positions,.25):{edges:z.cells,positions:z.positions}}function l(k,P,z,I){var D=x(k,I),R=b(D.positions,P,z),B=D.edges,F=P.orientation==="ccw";if(r(R,B),P.polygons||P.polygon||P.polyline){for(var H=c(B,R),G=new Array(H.length),J=0;J<H.length;++J){for(var X=H[J],Y=new Array(X.length),Z=0;Z<X.length;++Z){for(var oe=X[Z],re=new Array(oe.length),se=0;se<oe.length;++se)re[se]=R[oe[se]].slice();F&&re.reverse(),Y[Z]=re}G[J]=Y}return G}else return P.triangles||P.triangulate||P.triangle?{cells:t(R,B,{delaunay:!1,exterior:!1,interior:!0}),positions:R}:{edges:B,positions:R}}function L(k,P,z){try{return l(k,P,z,!0)}catch{}try{return l(k,P,z,!1)}catch{}return P.polygons||P.polyline||P.polygon?[]:P.triangles||P.triangulate||P.triangle?{cells:[],positions:[]}:{edges:[],positions:[]}}function T(k,P,z,I){var D=64,R=1.25,B={breaklines:!1,bolds:!1,italics:!1,subscripts:!1,superscripts:!1};I&&(I.size&&I.size>0&&(D=I.size),I.lineSpacing&&I.lineSpacing>0&&(R=I.lineSpacing),I.styletags&&I.styletags.breaklines&&(B.breaklines=!!I.styletags.breaklines),I.styletags&&I.styletags.bolds&&(B.bolds=!!I.styletags.bolds),I.styletags&&I.styletags.italics&&(B.italics=!!I.styletags.italics),I.styletags&&I.styletags.subscripts&&(B.subscripts=!!I.styletags.subscripts),I.styletags&&I.styletags.superscripts&&(B.superscripts=!!I.styletags.superscripts)),z.font=[I.fontStyle,I.fontVariant,I.fontWeight,D+"px",I.font].filter(function(H){return H}).join(" "),z.textAlign="start",z.textBaseline="alphabetic",z.direction="ltr";var F=f(P,z,k,D,R,B);return L(F,I,D)}},{cdt2d:42,"clean-pslg":50,ndarray:259,"planar-graph-to-polyline":268,"simplify-planar-graph":297,"surface-nets":302}],313:[function(v,S,M){(function(){if(typeof ses<"u"&&ses.ok&&!ses.ok())return;function a(L){L.permitHostObjects___&&L.permitHostObjects___(a)}typeof ses<"u"&&(ses.weakMapPermitHostObjects=a);var n=!1;if(typeof WeakMap=="function"){var r=WeakMap;if(!(typeof navigator<"u"&&/Firefox/.test(navigator.userAgent))){var t=new r,c=Object.freeze({});if(t.set(c,1),t.get(c)!==1)n=!0;else{S.exports=WeakMap;return}}}var o=Object.getOwnPropertyNames,i=Object.defineProperty,y=Object.isExtensible,p="weakmap:",g=p+"ident:"+Math.random()+"___";if(typeof crypto<"u"&&typeof crypto.getRandomValues=="function"&&typeof ArrayBuffer=="function"&&typeof Uint8Array=="function"){var h=new ArrayBuffer(25),m=new Uint8Array(h);crypto.getRandomValues(m),g=p+"rand:"+Array.prototype.map.call(m,function(L){return(L%36).toString(36)}).join("")+"___"}function u(L){return!(L.substr(0,p.length)==p&&L.substr(L.length-3)==="___")}if(i(Object,"getOwnPropertyNames",{value:function(T){return o(T).filter(u)}}),"getPropertyNames"in Object){var _=Object.getPropertyNames;i(Object,"getPropertyNames",{value:function(T){return _(T).filter(u)}})}function s(L){if(L!==Object(L))throw new TypeError("Not an object: "+L);var T=L[g];if(T&&T.key===L)return T;if(!!y(L)){T={key:L};try{return i(L,g,{value:T,writable:!1,enumerable:!1,configurable:!1}),T}catch{return}}}(function(){var L=Object.freeze;i(Object,"freeze",{value:function(z){return s(z),L(z)}});var T=Object.seal;i(Object,"seal",{value:function(z){return s(z),T(z)}});var k=Object.preventExtensions;i(Object,"preventExtensions",{value:function(z){return s(z),k(z)}})})();function A(L){return L.prototype=null,Object.freeze(L)}var b=!1;function f(){!b&&typeof console<"u"&&(b=!0,console.warn("WeakMap should be invoked as new WeakMap(), not WeakMap(). This will be an error in the future."))}var x=0,l=function(){this instanceof l||f();var L=[],T=[],k=x++;function P(R,B){var F,H=s(R);return H?k in H?H[k]:B:(F=L.indexOf(R),F>=0?T[F]:B)}function z(R){var B=s(R);return B?k in B:L.indexOf(R)>=0}function I(R,B){var F,H=s(R);return H?H[k]=B:(F=L.indexOf(R),F>=0?T[F]=B:(F=L.length,T[F]=B,L[F]=R)),this}function D(R){var B=s(R),F,H;return B?k in B&&delete B[k]:(F=L.indexOf(R),F<0?!1:(H=L.length-1,L[F]=void 0,T[F]=T[H],L[F]=L[H],L.length=H,T.length=H,!0))}return Object.create(l.prototype,{get___:{value:A(P)},has___:{value:A(z)},set___:{value:A(I)},delete___:{value:A(D)}})};l.prototype=Object.create(Object.prototype,{get:{value:function(T,k){return this.get___(T,k)},writable:!0,configurable:!0},has:{value:function(T){return this.has___(T)},writable:!0,configurable:!0},set:{value:function(T,k){return this.set___(T,k)},writable:!0,configurable:!0},delete:{value:function(T){return this.delete___(T)},writable:!0,configurable:!0}}),typeof r=="function"?function(){n&&typeof Proxy<"u"&&(Proxy=void 0);function L(){this instanceof l||f();var T=new r,k=void 0,P=!1;function z(B,F){return k?T.has(B)?T.get(B):k.get___(B,F):T.get(B,F)}function I(B){return T.has(B)||(k?k.has___(B):!1)}var D;n?D=function(B,F){return T.set(B,F),T.has(B)||(k||(k=new l),k.set(B,F)),this}:D=function(B,F){if(P)try{T.set(B,F)}catch{k||(k=new l),k.set___(B,F)}else T.set(B,F);return this};function R(B){var F=!!T.delete(B);return k&&k.delete___(B)||F}return Object.create(l.prototype,{get___:{value:A(z)},has___:{value:A(I)},set___:{value:A(D)},delete___:{value:A(R)},permitHostObjects___:{value:A(function(B){if(B===a)P=!0;else throw new Error("bogus call to permitHostObjects___")})}})}L.prototype=l.prototype,S.exports=L,Object.defineProperty(WeakMap.prototype,"constructor",{value:WeakMap,enumerable:!1,configurable:!0,writable:!0})}():(typeof Proxy<"u"&&(Proxy=void 0),S.exports=l)})()},{}],314:[function(v,S,M){var e=v("./hidden-store.js");S.exports=a;function a(){var n={};return function(r){if((typeof r!="object"||r===null)&&typeof r!="function")throw new Error("Weakmap-shim: Key must be object");var t=r.valueOf(n);return t&&t.identity===n?t:e(r,n)}}},{"./hidden-store.js":315}],315:[function(v,S,M){S.exports=e;function e(a,n){var r={identity:n},t=a.valueOf;return Object.defineProperty(a,"valueOf",{value:function(c){return c!==n?t.apply(this,arguments):r},writable:!0}),r}},{}],316:[function(v,S,M){var e=v("./create-store.js");S.exports=a;function a(){var n=e();return{get:function(r,t){var c=n(r);return c.hasOwnProperty("value")?c.value:t},set:function(r,t){return n(r).value=t,this},has:function(r){return"value"in n(r)},delete:function(r){return delete n(r).value}}}},{"./create-store.js":314}],317:[function(v,S,M){function e(){return function(o,i,y,p,g,h){var m=o[0],u=y[0],_=[0],s=u;p|=0;var A=0,b=u;for(A=0;A<m;++A){{var f=i[p]-h,x=i[p+s]-h;f>=0!=x>=0&&g.push(_[0]+.5+.5*(f+x)/(f-x))}p+=b,++_[0]}}}function a(){return e()}var n=a;function r(o){var i={};return function(p,g,h){var m=p.dtype,u=p.order,_=[m,u.join()].join(),s=i[_];return s||(i[_]=s=o([m,u])),s(p.shape.slice(0),p.data,p.stride,p.offset|0,g,h)}}function t(o){return r(n.bind(void 0,o))}function c(o){return t({funcName:o.funcName})}S.exports=c({funcName:"zeroCrossings"})},{}],318:[function(v,S,M){S.exports=a;var e=v("./lib/zc-core");function a(n,r){var t=[];return r=+r||0,e(n.hi(n.shape[0]-1),t,r),t}},{"./lib/zc-core":317}]},{},[6])(6)})}).call(this)}).call(this,typeof To<"u"?To:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[27])(27)})})(Hv);(function(Zo){Object.defineProperty(Zo,"__esModule",{value:!0}),Zo.default=void 0;var Au=ee(Uv),d=ee(Hv.exports);function ee(v){return v&&v.__esModule?v:{default:v}}var te=(0,Au.default)(d.default),w=te;Zo.default=w})(Nv);const N0=F0(Nv);function Vv({data:Zo,isLoading:Au}){return bc(O0,{className:"VisualizationLoader",isLoading:!!Au,children:bc("div",{className:"PlotlyVisualizer",children:B0.isEmpty(Zo==null?void 0:Zo.data)?bc("div",{children:"No Tracked Figures"}):bc("div",{className:"PlotlyVisualizer__chart",children:bc(N0,{data:Zo==null?void 0:Zo.data,layout:Zo==null?void 0:Zo.layout,frames:Zo==null?void 0:Zo.frames,useResizeHandler:!0})})})})}Vv.displayName="PlotlyVisualizer";const H0=Bv.exports.memo(Vv);export{H0 as default};
